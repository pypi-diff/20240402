# Comparing `tmp/rucio-34.0.0rc2.tar.gz` & `tmp/rucio-34.1.0.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "rucio-34.0.0rc2.tar", last modified: Thu Mar 14 14:43:02 2024, max compression
+gzip compressed data, was "rucio-34.1.0.tar", last modified: Tue Apr  2 13:57:05 2024, max compression
```

## Comparing `rucio-34.0.0rc2.tar` & `rucio-34.1.0.tar`

### file list

```diff
@@ -1,650 +1,650 @@
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.433225 rucio-34.0.0rc2/
--rwxr-xr-x   0 root         (0) root         (0)     4487 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/AUTHORS.rst
--rw-r--r--   0 root         (0) root         (0)       87 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/ChangeLog
--rw-r--r--   0 root         (0) root         (0)    11357 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/LICENSE
--rw-r--r--   0 root         (0) root         (0)      934 2024-03-14 14:42:58.000000 rucio-34.0.0rc2/MANIFEST.in
--rw-r--r--   0 root         (0) root         (0)     2802 2024-03-14 14:43:02.433225 rucio-34.0.0rc2/PKG-INFO
--rw-r--r--   0 root         (0) root         (0)     1982 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/README.rst
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.331225 rucio-34.0.0rc2/bin/
--rwxr-xr-x   0 root         (0) root         (0)   127445 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/bin/rucio
--rwxr-xr-x   0 root         (0) root         (0)     2844 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/bin/rucio-abacus-account
--rwxr-xr-x   0 root         (0) root         (0)     1847 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/bin/rucio-abacus-collection-replica
--rwxr-xr-x   0 root         (0) root         (0)     2591 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/bin/rucio-abacus-rse
--rwxr-xr-x   0 root         (0) root         (0)   133730 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/bin/rucio-admin
--rwxr-xr-x   0 root         (0) root         (0)     3209 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/bin/rucio-atropos
--rwxr-xr-x   0 root         (0) root         (0)     5873 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/bin/rucio-auditor
--rwxr-xr-x   0 root         (0) root         (0)     2032 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/bin/rucio-automatix
--rwxr-xr-x   0 root         (0) root         (0)     3127 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/bin/rucio-bb8
--rwxr-xr-x   0 root         (0) root         (0)     6124 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/bin/rucio-c3po
--rwxr-xr-x   0 root         (0) root         (0)     5087 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/bin/rucio-cache-client
--rwxr-xr-x   0 root         (0) root         (0)     1386 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/bin/rucio-cache-consumer
--rwxr-xr-x   0 root         (0) root         (0)     2370 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/bin/rucio-conveyor-finisher
--rwxr-xr-x   0 root         (0) root         (0)     2863 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/bin/rucio-conveyor-poller
--rwxr-xr-x   0 root         (0) root         (0)     1783 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/bin/rucio-conveyor-preparer
--rwxr-xr-x   0 root         (0) root         (0)     1706 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/bin/rucio-conveyor-receiver
--rwxr-xr-x   0 root         (0) root         (0)     3409 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/bin/rucio-conveyor-stager
--rwxr-xr-x   0 root         (0) root         (0)     6774 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/bin/rucio-conveyor-submitter
--rwxr-xr-x   0 root         (0) root         (0)     3883 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/bin/rucio-conveyor-throttler
--rwxr-xr-x   0 root         (0) root         (0)     2570 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/bin/rucio-dark-reaper
--rwxr-xr-x   0 root         (0) root         (0)     6493 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/bin/rucio-dumper
--rwxr-xr-x   0 root         (0) root         (0)     1438 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/bin/rucio-follower
--rwxr-xr-x   0 root         (0) root         (0)     2011 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/bin/rucio-hermes
--rwxr-xr-x   0 root         (0) root         (0)     4673 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/bin/rucio-judge-cleaner
--rwxr-xr-x   0 root         (0) root         (0)     7494 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/bin/rucio-judge-evaluator
--rwxr-xr-x   0 root         (0) root         (0)     1695 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/bin/rucio-judge-injector
--rwxr-xr-x   0 root         (0) root         (0)     1699 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/bin/rucio-judge-repairer
--rwxr-xr-x   0 root         (0) root         (0)     1806 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/bin/rucio-kronos
--rwxr-xr-x   0 root         (0) root         (0)     2284 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/bin/rucio-minos
--rwxr-xr-x   0 root         (0) root         (0)     2021 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/bin/rucio-minos-temporary-expiration
--rwxr-xr-x   0 root         (0) root         (0)     5649 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/bin/rucio-necromancer
--rwxr-xr-x   0 root         (0) root         (0)     2812 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/bin/rucio-oauth-manager
--rwxr-xr-x   0 root         (0) root         (0)     4094 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/bin/rucio-reaper
--rwxr-xr-x   0 root         (0) root         (0)    19013 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/bin/rucio-replica-recoverer
--rwxr-xr-x   0 root         (0) root         (0)     2375 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/bin/rucio-rse-decommissioner
--rwxr-xr-x   0 root         (0) root         (0)     3944 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/bin/rucio-storage-consistency-actions
--rwxr-xr-x   0 root         (0) root         (0)     3388 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/bin/rucio-transmogrifier
--rwxr-xr-x   0 root         (0) root         (0)     2744 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/bin/rucio-undertaker
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.332224 rucio-34.0.0rc2/etc/
--rw-r--r--   0 root         (0) root         (0)     1764 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/etc/alembic.ini.template
--rw-r--r--   0 root         (0) root         (0)     1922 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/etc/alembic_offline.ini.template
--rw-r--r--   0 root         (0) root         (0)       96 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/etc/globus-config.yml.template
--rw-r--r--   0 root         (0) root         (0)      807 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/etc/ldap.cfg.template
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.333224 rucio-34.0.0rc2/etc/mail_templates/
--rw-r--r--   0 root         (0) root         (0)     1210 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/etc/mail_templates/rule_approval_request.tmpl
--rw-r--r--   0 root         (0) root         (0)      105 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/etc/mail_templates/rule_approved_admin.tmpl
--rw-r--r--   0 root         (0) root         (0)      499 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/etc/mail_templates/rule_approved_user.tmpl
--rw-r--r--   0 root         (0) root         (0)      120 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/etc/mail_templates/rule_denied_admin.tmpl
--rw-r--r--   0 root         (0) root         (0)      493 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/etc/mail_templates/rule_denied_user.tmpl
--rw-r--r--   0 root         (0) root         (0)      546 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/etc/mail_templates/rule_ok_notification.tmpl
--rwxr-xr-x   0 root         (0) root         (0)      543 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/etc/rse-accounts.cfg.template
--rw-r--r--   0 root         (0) root         (0)     1311 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/etc/rucio.cfg.atlas.client.template
--rw-r--r--   0 root         (0) root         (0)     8534 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/etc/rucio.cfg.template
--rw-r--r--   0 root         (0) root         (0)     7477 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/etc/rucio_multi_vo.cfg.template
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.314224 rucio-34.0.0rc2/lib/
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.333224 rucio-34.0.0rc2/lib/rucio/
--rw-r--r--   0 root         (0) root         (0)      684 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/__init__.py
--rw-r--r--   0 root         (0) root         (0)      714 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/alembicrevision.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.337225 rucio-34.0.0rc2/lib/rucio/api/
--rw-r--r--   0 root         (0) root         (0)      642 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/api/__init__.py
--rw-r--r--   0 root         (0) root         (0)     9316 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/api/account.py
--rw-r--r--   0 root         (0) root         (0)    11419 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/api/account_limit.py
--rw-r--r--   0 root         (0) root         (0)    12914 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/api/authentication.py
--rw-r--r--   0 root         (0) root         (0)     8678 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/api/config.py
--rw-r--r--   0 root         (0) root         (0)     2932 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/api/credential.py
--rw-r--r--   0 root         (0) root         (0)    28285 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/api/did.py
--rw-r--r--   0 root         (0) root         (0)     3230 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/api/dirac.py
--rw-r--r--   0 root         (0) root         (0)     2129 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/api/exporter.py
--rw-r--r--   0 root         (0) root         (0)     2675 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/api/heartbeat.py
--rw-r--r--   0 root         (0) root         (0)     6853 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/api/identity.py
--rw-r--r--   0 root         (0) root         (0)     1755 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/api/importer.py
--rw-r--r--   0 root         (0) root         (0)     3709 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/api/lifetime_exception.py
--rw-r--r--   0 root         (0) root         (0)     4652 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/api/lock.py
--rw-r--r--   0 root         (0) root         (0)     3596 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/api/meta_conventions.py
--rw-r--r--   0 root         (0) root         (0)     2689 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/api/permission.py
--rw-r--r--   0 root         (0) root         (0)     2519 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/api/quarantined_replica.py
--rw-r--r--   0 root         (0) root         (0)    22422 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/api/replica.py
--rw-r--r--   0 root         (0) root         (0)    10574 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/api/request.py
--rw-r--r--   0 root         (0) root         (0)    23605 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/api/rse.py
--rw-r--r--   0 root         (0) root         (0)    15962 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/api/rule.py
--rw-r--r--   0 root         (0) root         (0)     3027 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/api/scope.py
--rw-r--r--   0 root         (0) root         (0)    10561 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/api/subscription.py
--rw-r--r--   0 root         (0) root         (0)     4583 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/api/vo.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.342224 rucio-34.0.0rc2/lib/rucio/client/
--rw-r--r--   0 root         (0) root         (0)      684 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/client/__init__.py
--rw-r--r--   0 root         (0) root         (0)    16412 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/client/accountclient.py
--rw-r--r--   0 root         (0) root         (0)     6020 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/client/accountlimitclient.py
--rw-r--r--   0 root         (0) root         (0)    47163 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/client/baseclient.py
--rw-r--r--   0 root         (0) root         (0)     3103 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/client/client.py
--rw-r--r--   0 root         (0) root         (0)     4460 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/client/configclient.py
--rw-r--r--   0 root         (0) root         (0)     2048 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/client/credentialclient.py
--rw-r--r--   0 root         (0) root         (0)    27734 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/client/didclient.py
--rw-r--r--   0 root         (0) root         (0)     2173 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/client/diracclient.py
--rw-r--r--   0 root         (0) root         (0)    86127 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/client/downloadclient.py
--rw-r--r--   0 root         (0) root         (0)     1634 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/client/exportclient.py
--rw-r--r--   0 root         (0) root         (0)     1669 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/client/fileclient.py
--rw-r--r--   0 root         (0) root         (0)     1528 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/client/importclient.py
--rw-r--r--   0 root         (0) root         (0)     2881 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/client/lifetimeclient.py
--rw-r--r--   0 root         (0) root         (0)     3973 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/client/lockclient.py
--rw-r--r--   0 root         (0) root         (0)     5214 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/client/metaconventionsclient.py
--rw-r--r--   0 root         (0) root         (0)     1414 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/client/pingclient.py
--rw-r--r--   0 root         (0) root         (0)    19343 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/client/replicaclient.py
--rw-r--r--   0 root         (0) root         (0)     4256 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/client/requestclient.py
--rw-r--r--   0 root         (0) root         (0)    27183 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/client/rseclient.py
--rw-r--r--   0 root         (0) root         (0)    12741 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/client/ruleclient.py
--rw-r--r--   0 root         (0) root         (0)     3206 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/client/scopeclient.py
--rw-r--r--   0 root         (0) root         (0)     8030 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/client/subscriptionclient.py
--rw-r--r--   0 root         (0) root         (0)     2701 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/client/touchclient.py
--rw-r--r--   0 root         (0) root         (0)    46674 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/client/uploadclient.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.345224 rucio-34.0.0rc2/lib/rucio/common/
--rw-r--r--   0 root         (0) root         (0)      642 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/common/__init__.py
--rw-r--r--   0 root         (0) root         (0)     2297 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/common/cache.py
--rw-r--r--   0 root         (0) root         (0)    24306 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/common/config.py
--rw-r--r--   0 root         (0) root         (0)     3324 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/common/constants.py
--rw-r--r--   0 root         (0) root         (0)      750 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/common/constraints.py
--rwxr-xr-x   0 root         (0) root         (0)     6323 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/common/didtype.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.346225 rucio-34.0.0rc2/lib/rucio/common/dumper/
--rw-r--r--   0 root         (0) root         (0)     9183 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/common/dumper/__init__.py
--rw-r--r--   0 root         (0) root         (0)    16097 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/common/dumper/consistency.py
--rw-r--r--   0 root         (0) root         (0)     9913 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/common/dumper/data_models.py
--rw-r--r--   0 root         (0) root         (0)     1947 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/common/dumper/path_parsing.py
--rw-r--r--   0 root         (0) root         (0)    32369 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/common/exception.py
--rw-r--r--   0 root         (0) root         (0)     1422 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/common/extra.py
--rw-r--r--   0 root         (0) root         (0)    15070 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/common/logging.py
--rw-r--r--   0 root         (0) root         (0)    45324 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/common/pcache.py
--rw-r--r--   0 root         (0) root         (0)     6083 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/common/plugins.py
--rw-r--r--   0 root         (0) root         (0)     3037 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/common/policy.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.348224 rucio-34.0.0rc2/lib/rucio/common/schema/
--rw-r--r--   0 root         (0) root         (0)     5176 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/common/schema/__init__.py
--rw-r--r--   0 root         (0) root         (0)    15613 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/common/schema/atlas.py
--rw-r--r--   0 root         (0) root         (0)    15430 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/common/schema/belleii.py
--rw-r--r--   0 root         (0) root         (0)    18547 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/common/schema/cms.py
--rw-r--r--   0 root         (0) root         (0)    15011 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/common/schema/domatpc.py
--rw-r--r--   0 root         (0) root         (0)    15950 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/common/schema/escape.py
--rw-r--r--   0 root         (0) root         (0)    16265 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/common/schema/generic.py
--rw-r--r--   0 root         (0) root         (0)    15492 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/common/schema/generic_multi_vo.py
--rw-r--r--   0 root         (0) root         (0)    15301 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/common/schema/icecube.py
--rw-r--r--   0 root         (0) root         (0)    15909 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/common/schema/lsst.py
--rw-r--r--   0 root         (0) root         (0)     5438 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/common/stomp_utils.py
--rw-r--r--   0 root         (0) root         (0)     1665 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/common/stopwatch.py
--rw-r--r--   0 root         (0) root         (0)     4929 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/common/test_rucio_server.py
--rw-r--r--   0 root         (0) root         (0)     5034 2024-03-14 13:16:59.000000 rucio-34.0.0rc2/lib/rucio/common/types.py
--rw-r--r--   0 root         (0) root         (0)    79130 2024-03-14 13:16:59.000000 rucio-34.0.0rc2/lib/rucio/common/utils.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.357225 rucio-34.0.0rc2/lib/rucio/core/
--rw-r--r--   0 root         (0) root         (0)      642 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/core/__init__.py
--rw-r--r--   0 root         (0) root         (0)    14976 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/core/account.py
--rw-r--r--   0 root         (0) root         (0)     6317 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/core/account_counter.py
--rw-r--r--   0 root         (0) root         (0)    14302 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/core/account_limit.py
--rw-r--r--   0 root         (0) root         (0)    19833 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/core/authentication.py
--rw-r--r--   0 root         (0) root         (0)    13304 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/core/config.py
--rw-r--r--   0 root         (0) root         (0)     8160 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/core/credential.py
--rw-r--r--   0 root         (0) root         (0)   124855 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/core/did.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.359225 rucio-34.0.0rc2/lib/rucio/core/did_meta_plugins/
--rw-r--r--   0 root         (0) root         (0)    11757 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/core/did_meta_plugins/__init__.py
--rw-r--r--   0 root         (0) root         (0)    17498 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/core/did_meta_plugins/did_column_meta.py
--rw-r--r--   0 root         (0) root         (0)     4109 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/core/did_meta_plugins/did_meta_plugin_interface.py
--rw-r--r--   0 root         (0) root         (0)    29337 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/core/did_meta_plugins/filter_engine.py
--rw-r--r--   0 root         (0) root         (0)     9269 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/core/did_meta_plugins/json_meta.py
--rw-r--r--   0 root         (0) root         (0)     7500 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/core/did_meta_plugins/mongo_meta.py
--rw-r--r--   0 root         (0) root         (0)    13774 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/core/did_meta_plugins/postgres_meta.py
--rw-r--r--   0 root         (0) root         (0)     9430 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/core/dirac.py
--rw-r--r--   0 root         (0) root         (0)     5457 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/core/distance.py
--rw-r--r--   0 root         (0) root         (0)     1803 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/core/exporter.py
--rw-r--r--   0 root         (0) root         (0)    10364 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/core/heartbeat.py
--rw-r--r--   0 root         (0) root         (0)    11878 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/core/identity.py
--rw-r--r--   0 root         (0) root         (0)    13797 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/core/importer.py
--rw-r--r--   0 root         (0) root         (0)    15257 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/core/lifetime_exception.py
--rw-r--r--   0 root         (0) root         (0)    22831 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/core/lock.py
--rw-r--r--   0 root         (0) root         (0)     9716 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/core/message.py
--rw-r--r--   0 root         (0) root         (0)     8789 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/core/meta_conventions.py
--rw-r--r--   0 root         (0) root         (0)    15825 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/core/monitor.py
--rw-r--r--   0 root         (0) root         (0)     5419 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/core/naming_convention.py
--rw-r--r--   0 root         (0) root         (0)     4914 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/core/nongrid_trace.py
--rw-r--r--   0 root         (0) root         (0)    69880 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/core/oidc.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.361225 rucio-34.0.0rc2/lib/rucio/core/permission/
--rw-r--r--   0 root         (0) root         (0)     3933 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/core/permission/__init__.py
--rw-r--r--   0 root         (0) root         (0)    55449 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/core/permission/atlas.py
--rw-r--r--   0 root         (0) root         (0)    46931 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/core/permission/belleii.py
--rw-r--r--   0 root         (0) root         (0)    46779 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/core/permission/cms.py
--rw-r--r--   0 root         (0) root         (0)    43126 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/core/permission/escape.py
--rw-r--r--   0 root         (0) root         (0)    45329 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/core/permission/generic.py
--rw-r--r--   0 root         (0) root         (0)    45875 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/core/permission/generic_multi_vo.py
--rw-r--r--   0 root         (0) root         (0)     8053 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/core/quarantined_replica.py
--rw-r--r--   0 root         (0) root         (0)   177410 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/core/replica.py
--rw-r--r--   0 root         (0) root         (0)    15444 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/core/replica_sorter.py
--rw-r--r--   0 root         (0) root         (0)   115997 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/core/request.py
--rw-r--r--   0 root         (0) root         (0)    67977 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/core/rse.py
--rw-r--r--   0 root         (0) root         (0)     5534 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/core/rse_counter.py
--rw-r--r--   0 root         (0) root         (0)    15401 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/core/rse_expression_parser.py
--rw-r--r--   0 root         (0) root         (0)    13958 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/core/rse_selector.py
--rw-r--r--   0 root         (0) root         (0)   208082 2024-03-14 13:16:59.000000 rucio-34.0.0rc2/lib/rucio/core/rule.py
--rw-r--r--   0 root         (0) root         (0)    92195 2024-03-14 13:16:59.000000 rucio-34.0.0rc2/lib/rucio/core/rule_grouping.py
--rw-r--r--   0 root         (0) root         (0)     5388 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/core/scope.py
--rw-r--r--   0 root         (0) root         (0)    15254 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/core/subscription.py
--rw-r--r--   0 root         (0) root         (0)    18691 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/core/topology.py
--rw-r--r--   0 root         (0) root         (0)    13131 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/core/trace.py
--rw-r--r--   0 root         (0) root         (0)    64210 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/core/transfer.py
--rw-r--r--   0 root         (0) root         (0)     5531 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/core/vo.py
--rw-r--r--   0 root         (0) root         (0)     5094 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/core/volatile_replica.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.361225 rucio-34.0.0rc2/lib/rucio/daemons/
--rw-r--r--   0 root         (0) root         (0)      642 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/daemons/__init__.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.362225 rucio-34.0.0rc2/lib/rucio/daemons/abacus/
--rw-r--r--   0 root         (0) root         (0)      642 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/daemons/abacus/__init__.py
--rw-r--r--   0 root         (0) root         (0)     3760 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/daemons/abacus/account.py
--rw-r--r--   0 root         (0) root         (0)     3880 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/daemons/abacus/collection_replica.py
--rw-r--r--   0 root         (0) root         (0)     3620 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/daemons/abacus/rse.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.362225 rucio-34.0.0rc2/lib/rucio/daemons/atropos/
--rw-r--r--   0 root         (0) root         (0)      642 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/daemons/atropos/__init__.py
--rw-r--r--   0 root         (0) root         (0)    10583 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/daemons/atropos/atropos.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.362225 rucio-34.0.0rc2/lib/rucio/daemons/auditor/
--rw-r--r--   0 root         (0) root         (0)    10105 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/daemons/auditor/__init__.py
--rw-r--r--   0 root         (0) root         (0)     2920 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/daemons/auditor/hdfs.py
--rw-r--r--   0 root         (0) root         (0)     8687 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/daemons/auditor/srmdumps.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.363225 rucio-34.0.0rc2/lib/rucio/daemons/automatix/
--rw-r--r--   0 root         (0) root         (0)      642 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/daemons/automatix/__init__.py
--rw-r--r--   0 root         (0) root         (0)     9938 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/daemons/automatix/automatix.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.363225 rucio-34.0.0rc2/lib/rucio/daemons/badreplicas/
--rw-r--r--   0 root         (0) root         (0)      642 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/daemons/badreplicas/__init__.py
--rw-r--r--   0 root         (0) root         (0)    15858 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/daemons/badreplicas/minos.py
--rw-r--r--   0 root         (0) root         (0)     8684 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/daemons/badreplicas/minos_temporary_expiration.py
--rw-r--r--   0 root         (0) root         (0)     9947 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/daemons/badreplicas/necromancer.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.364225 rucio-34.0.0rc2/lib/rucio/daemons/bb8/
--rw-r--r--   0 root         (0) root         (0)      642 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/daemons/bb8/__init__.py
--rw-r--r--   0 root         (0) root         (0)    13095 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/daemons/bb8/bb8.py
--rw-r--r--   0 root         (0) root         (0)    26621 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/daemons/bb8/common.py
--rw-r--r--   0 root         (0) root         (0)     6668 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/daemons/bb8/nuclei_background_rebalance.py
--rw-r--r--   0 root         (0) root         (0)     6546 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/daemons/bb8/t2_background_rebalance.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.365225 rucio-34.0.0rc2/lib/rucio/daemons/c3po/
--rw-r--r--   0 root         (0) root         (0)      642 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/daemons/c3po/__init__.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.365225 rucio-34.0.0rc2/lib/rucio/daemons/c3po/algorithms/
--rw-r--r--   0 root         (0) root         (0)      642 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/daemons/c3po/algorithms/__init__.py
--rw-r--r--   0 root         (0) root         (0)     4595 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/daemons/c3po/algorithms/simple.py
--rw-r--r--   0 root         (0) root         (0)     4675 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/daemons/c3po/algorithms/t2_free_space.py
--rw-r--r--   0 root         (0) root         (0)     4798 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/daemons/c3po/algorithms/t2_free_space_only_pop.py
--rw-r--r--   0 root         (0) root         (0)    12175 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/daemons/c3po/algorithms/t2_free_space_only_pop_with_network.py
--rw-r--r--   0 root         (0) root         (0)    15033 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/daemons/c3po/c3po.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.367225 rucio-34.0.0rc2/lib/rucio/daemons/c3po/collectors/
--rw-r--r--   0 root         (0) root         (0)      642 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/daemons/c3po/collectors/__init__.py
--rw-r--r--   0 root         (0) root         (0)     3301 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/daemons/c3po/collectors/agis.py
--rw-r--r--   0 root         (0) root         (0)     2134 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/daemons/c3po/collectors/free_space.py
--rw-r--r--   0 root         (0) root         (0)     1674 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/daemons/c3po/collectors/jedi_did.py
--rw-r--r--   0 root         (0) root         (0)     1370 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/daemons/c3po/collectors/mock_did.py
--rw-r--r--   0 root         (0) root         (0)     2100 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/daemons/c3po/collectors/network_metrics.py
--rw-r--r--   0 root         (0) root         (0)     3858 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/daemons/c3po/collectors/workload.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.368225 rucio-34.0.0rc2/lib/rucio/daemons/c3po/utils/
--rw-r--r--   0 root         (0) root         (0)      642 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/daemons/c3po/utils/__init__.py
--rw-r--r--   0 root         (0) root         (0)     1418 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/daemons/c3po/utils/dataset_cache.py
--rw-r--r--   0 root         (0) root         (0)     1555 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/daemons/c3po/utils/expiring_dataset_cache.py
--rw-r--r--   0 root         (0) root         (0)     1628 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/daemons/c3po/utils/expiring_list.py
--rw-r--r--   0 root         (0) root         (0)     2464 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/daemons/c3po/utils/popularity.py
--rw-r--r--   0 root         (0) root         (0)     2119 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/daemons/c3po/utils/timeseries.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.368225 rucio-34.0.0rc2/lib/rucio/daemons/cache/
--rw-r--r--   0 root         (0) root         (0)      642 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/daemons/cache/__init__.py
--rw-r--r--   0 root         (0) root         (0)     6744 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/daemons/cache/consumer.py
--rw-r--r--   0 root         (0) root         (0)    14971 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/daemons/common.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.370225 rucio-34.0.0rc2/lib/rucio/daemons/conveyor/
--rw-r--r--   0 root         (0) root         (0)      642 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/daemons/conveyor/__init__.py
--rw-r--r--   0 root         (0) root         (0)    25806 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/daemons/conveyor/common.py
--rw-r--r--   0 root         (0) root         (0)    23646 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/daemons/conveyor/finisher.py
--rw-r--r--   0 root         (0) root         (0)    16244 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/daemons/conveyor/poller.py
--rw-r--r--   0 root         (0) root         (0)     7485 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/daemons/conveyor/preparer.py
--rw-r--r--   0 root         (0) root         (0)     8331 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/daemons/conveyor/receiver.py
--rw-r--r--   0 root         (0) root         (0)     3851 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/daemons/conveyor/stager.py
--rw-r--r--   0 root         (0) root         (0)    16363 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/daemons/conveyor/submitter.py
--rw-r--r--   0 root         (0) root         (0)    20441 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/daemons/conveyor/throttler.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.370225 rucio-34.0.0rc2/lib/rucio/daemons/follower/
--rw-r--r--   0 root         (0) root         (0)      642 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/daemons/follower/__init__.py
--rw-r--r--   0 root         (0) root         (0)     3379 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/daemons/follower/follower.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.370225 rucio-34.0.0rc2/lib/rucio/daemons/hermes/
--rw-r--r--   0 root         (0) root         (0)      642 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/daemons/hermes/__init__.py
--rw-r--r--   0 root         (0) root         (0)    26460 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/daemons/hermes/hermes.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.371225 rucio-34.0.0rc2/lib/rucio/daemons/judge/
--rw-r--r--   0 root         (0) root         (0)      642 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/daemons/judge/__init__.py
--rw-r--r--   0 root         (0) root         (0)     5782 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/daemons/judge/cleaner.py
--rw-r--r--   0 root         (0) root         (0)     7180 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/daemons/judge/evaluator.py
--rw-r--r--   0 root         (0) root         (0)     6414 2024-03-14 13:16:59.000000 rucio-34.0.0rc2/lib/rucio/daemons/judge/injector.py
--rw-r--r--   0 root         (0) root         (0)     5320 2024-03-14 13:16:59.000000 rucio-34.0.0rc2/lib/rucio/daemons/judge/repairer.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.372225 rucio-34.0.0rc2/lib/rucio/daemons/oauthmanager/
--rw-r--r--   0 root         (0) root         (0)      642 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/daemons/oauthmanager/__init__.py
--rw-r--r--   0 root         (0) root         (0)     8871 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/daemons/oauthmanager/oauthmanager.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.372225 rucio-34.0.0rc2/lib/rucio/daemons/reaper/
--rw-r--r--   0 root         (0) root         (0)      642 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/daemons/reaper/__init__.py
--rw-r--r--   0 root         (0) root         (0)    11410 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/daemons/reaper/dark_reaper.py
--rw-r--r--   0 root         (0) root         (0)    35696 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/daemons/reaper/reaper.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.372225 rucio-34.0.0rc2/lib/rucio/daemons/replicarecoverer/
--rw-r--r--   0 root         (0) root         (0)      642 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/daemons/replicarecoverer/__init__.py
--rwxr-xr-x   0 root         (0) root         (0)    32955 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/daemons/replicarecoverer/suspicious_replica_recoverer.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.373225 rucio-34.0.0rc2/lib/rucio/daemons/rsedecommissioner/
--rw-r--r--   0 root         (0) root         (0)      642 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/daemons/rsedecommissioner/__init__.py
--rw-r--r--   0 root         (0) root         (0)     2695 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/daemons/rsedecommissioner/config.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.374225 rucio-34.0.0rc2/lib/rucio/daemons/rsedecommissioner/profiles/
--rw-r--r--   0 root         (0) root         (0)      887 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/daemons/rsedecommissioner/profiles/__init__.py
--rw-r--r--   0 root         (0) root         (0)     2245 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/daemons/rsedecommissioner/profiles/atlas.py
--rw-r--r--   0 root         (0) root         (0)    16293 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/daemons/rsedecommissioner/profiles/generic.py
--rw-r--r--   0 root         (0) root         (0)     2951 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/daemons/rsedecommissioner/profiles/types.py
--rw-r--r--   0 root         (0) root         (0)    10382 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/daemons/rsedecommissioner/rse_decommissioner.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.374225 rucio-34.0.0rc2/lib/rucio/daemons/storage/
--rw-r--r--   0 root         (0) root         (0)      642 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/daemons/storage/__init__.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.374225 rucio-34.0.0rc2/lib/rucio/daemons/storage/consistency/
--rw-r--r--   0 root         (0) root         (0)      642 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/daemons/storage/consistency/__init__.py
--rw-r--r--   0 root         (0) root         (0)    29596 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/daemons/storage/consistency/actions.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.375225 rucio-34.0.0rc2/lib/rucio/daemons/tracer/
--rw-r--r--   0 root         (0) root         (0)      642 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/daemons/tracer/__init__.py
--rw-r--r--   0 root         (0) root         (0)    23772 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/daemons/tracer/kronos.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.375225 rucio-34.0.0rc2/lib/rucio/daemons/transmogrifier/
--rw-r--r--   0 root         (0) root         (0)      642 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/daemons/transmogrifier/__init__.py
--rw-r--r--   0 root         (0) root         (0)    30552 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/daemons/transmogrifier/transmogrifier.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.375225 rucio-34.0.0rc2/lib/rucio/daemons/undertaker/
--rw-r--r--   0 root         (0) root         (0)      642 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/daemons/undertaker/__init__.py
--rw-r--r--   0 root         (0) root         (0)     5240 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/daemons/undertaker/undertaker.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.376225 rucio-34.0.0rc2/lib/rucio/db/
--rw-r--r--   0 root         (0) root         (0)      642 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/__init__.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.377225 rucio-34.0.0rc2/lib/rucio/db/sqla/
--rw-r--r--   0 root         (0) root         (0)     2154 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/__init__.py
--rw-r--r--   0 root         (0) root         (0)     4175 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/constants.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.377225 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/
--rw-r--r--   0 root         (0) root         (0)      642 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/__init__.py
--rw-r--r--   0 root         (0) root         (0)     3569 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/env.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.399225 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/
--rw-r--r--   0 root         (0) root         (0)     3364 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/01eaf73ab656_add_new_rule_notification_state_progress.py
--rw-r--r--   0 root         (0) root         (0)     1847 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/0437a40dbfd1_add_eol_at_in_rules.py
--rw-r--r--   0 root         (0) root         (0)     2690 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/0f1adb7a599a_create_transfer_hops_table.py
--rw-r--r--   0 root         (0) root         (0)     1559 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/102efcf145f4_added_stuck_at_column_to_rules.py
--rw-r--r--   0 root         (0) root         (0)     5322 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/13d4f70c66a9_introduce_transfer_limits.py
--rw-r--r--   0 root         (0) root         (0)     3684 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/140fef722e91_cleanup_distances_table.py
--rw-r--r--   0 root         (0) root         (0)     1574 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/14ec5aeb64cf_add_request_external_host.py
--rw-r--r--   0 root         (0) root         (0)     2342 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/156fb5b5a14_add_request_type_to_requests_idx.py
--rw-r--r--   0 root         (0) root         (0)     2840 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/1677d4d803c8_split_rse_availability_into_multiple.py
--rw-r--r--   0 root         (0) root         (0)     1285 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/16a0aca82e12_create_index_on_table_replicas_path.py
--rw-r--r--   0 root         (0) root         (0)     1702 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/1803333ac20f_adding_provenance_and_phys_group.py
--rw-r--r--   0 root         (0) root         (0)     2699 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/1a29d6a9504c_add_didtype_chck_to_requests.py
--rw-r--r--   0 root         (0) root         (0)     1339 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/1a80adff031a_create_index_on_rules_hist_recent.py
--rw-r--r--   0 root         (0) root         (0)     8518 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/1c45d9730ca6_increase_identity_length.py
--rw-r--r--   0 root         (0) root         (0)     3327 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/1d1215494e95_add_quarantined_replicas_table.py
--rw-r--r--   0 root         (0) root         (0)     3806 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/1d96f484df21_asynchronous_rules_and_rule_approval.py
--rw-r--r--   0 root         (0) root         (0)     1572 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/1f46c5f240ac_add_bytes_column_to_bad_replicas.py
--rw-r--r--   0 root         (0) root         (0)     1716 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/1fc15ab60d43_add_message_history_table.py
--rw-r--r--   0 root         (0) root         (0)     4386 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/2190e703eb6e_move_rse_settings_to_rse_attributes.py
--rw-r--r--   0 root         (0) root         (0)     3038 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/21d6b9dc9961_add_mismatch_scheme_state_to_requests.py
--rw-r--r--   0 root         (0) root         (0)     1523 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/22cf51430c78_add_availability_column_to_table_rses.py
--rw-r--r--   0 root         (0) root         (0)     2831 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/22d887e4ec0a_create_sources_table.py
--rw-r--r--   0 root         (0) root         (0)     2348 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/25821a8a45a3_remove_unique_constraint_on_requests.py
--rw-r--r--   0 root         (0) root         (0)     1425 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/25fc855625cf_added_unique_constraint_to_rules.py
--rw-r--r--   0 root         (0) root         (0)     1561 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/269fee20dee9_add_repair_cnt_to_locks.py
--rw-r--r--   0 root         (0) root         (0)     1667 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/271a46ea6244_add_ignore_availability_column_to_rules.py
--rw-r--r--   0 root         (0) root         (0)     2298 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/277b5fbb41d3_switch_heartbeats_executable.py
--rw-r--r--   0 root         (0) root         (0)     1243 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/27e3a68927fb_remove_replicas_tombstone_and_replicas_.py
--rw-r--r--   0 root         (0) root         (0)     1734 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/2854cd9e168_added_rule_id_column.py
--rw-r--r--   0 root         (0) root         (0)     1748 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/295289b5a800_processed_by_and__at_in_requests.py
--rw-r--r--   0 root         (0) root         (0)     1721 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/2962ece31cf4_add_nbaccesses_column_in_the_did_table.py
--rw-r--r--   0 root         (0) root         (0)     2256 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/2af3291ec4c_added_replicas_history_table.py
--rw-r--r--   0 root         (0) root         (0)     1812 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/2b69addda658_add_columns_for_third_party_copy_read_.py
--rw-r--r--   0 root         (0) root         (0)     2911 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/2b8e7bcb4783_add_config_table.py
--rw-r--r--   0 root         (0) root         (0)     1580 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/2ba5229cb54c_add_submitted_at_to_requests_table.py
--rw-r--r--   0 root         (0) root         (0)     1599 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/2cbee484dcf9_added_column_volume_to_rse_transfer_.py
--rw-r--r--   0 root         (0) root         (0)     1782 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/2edee4a83846_add_source_to_requests_and_requests_.py
--rw-r--r--   0 root         (0) root         (0)     1793 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/2eef46be23d4_change_tokens_pk.py
--rw-r--r--   0 root         (0) root         (0)     1333 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/2f648fc909f3_index_in_rule_history_on_scope_name.py
--rw-r--r--   0 root         (0) root         (0)     3277 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/3082b8cef557_add_naming_convention_table_and_closed_.py
--rw-r--r--   0 root         (0) root         (0)     2044 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/30fa38b6434e_add_index_on_service_column_in_the_message_table.py
--rw-r--r--   0 root         (0) root         (0)     3906 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/3152492b110b_added_staging_area_column.py
--rw-r--r--   0 root         (0) root         (0)     2563 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/32c7d2783f7e_create_bad_replicas_table.py
--rw-r--r--   0 root         (0) root         (0)     4022 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/3345511706b8_replicas_table_pk_definition_is_in_.py
--rw-r--r--   0 root         (0) root         (0)     1495 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/35ef10d1e11b_change_index_on_table_requests.py
--rw-r--r--   0 root         (0) root         (0)     2867 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/379a19b5332d_create_rse_limits_table.py
--rw-r--r--   0 root         (0) root         (0)     7553 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/384b96aa0f60_created_rule_history_tables.py
--rw-r--r--   0 root         (0) root         (0)     2422 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/3ac1660a1a72_extend_distance_table.py
--rw-r--r--   0 root         (0) root         (0)     3666 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/3ad36e2268b0_create_collection_replicas_updates_table.py
--rw-r--r--   0 root         (0) root         (0)     2711 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/3c9df354071b_extend_waiting_request_state.py
--rw-r--r--   0 root         (0) root         (0)     1474 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/3d9813fab443_add_a_new_state_lost_in_badfilesstatus.py
--rw-r--r--   0 root         (0) root         (0)     1586 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/40ad39ce3160_add_transferred_at_to_requests_table.py
--rw-r--r--   0 root         (0) root         (0)     2801 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/4207be2fd914_add_notification_column_to_rules.py
--rw-r--r--   0 root         (0) root         (0)     1312 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/42db2617c364_create_index_on_requests_external_id.py
--rw-r--r--   0 root         (0) root         (0)     1577 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/436827b13f82_added_column_activity_to_table_requests.py
--rw-r--r--   0 root         (0) root         (0)     1669 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/44278720f774_update_requests_typ_sta_upd_idx_index.py
--rw-r--r--   0 root         (0) root         (0)     3732 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/45378a1e76a8_create_collection_replica_table.py
--rw-r--r--   0 root         (0) root         (0)     1445 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/469d262be19_removing_created_at_index.py
--rw-r--r--   0 root         (0) root         (0)     2474 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/4783c1f49cb4_create_distance_table.py
--rw-r--r--   0 root         (0) root         (0)     1717 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/49a21b4d4357_create_index_on_table_tokens.py
--rw-r--r--   0 root         (0) root         (0)     1611 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/4a2cbedda8b9_add_source_replica_expression_column_to_.py
--rw-r--r--   0 root         (0) root         (0)     2034 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/4a7182d9578b_added_bytes_length_accessed_at_columns.py
--rw-r--r--   0 root         (0) root         (0)     1297 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/4bab9edd01fc_create_index_on_requests_rule_id.py
--rw-r--r--   0 root         (0) root         (0)     2807 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/4c3a4acfe006_new_attr_account_table.py
--rw-r--r--   0 root         (0) root         (0)     1624 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/4cf0a2e127d4_adding_transient_metadata.py
--rw-r--r--   0 root         (0) root         (0)     2500 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/4df2c5ddabc0_remove_temporary_dids.py
--rw-r--r--   0 root         (0) root         (0)     1567 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/50280c53117c_add_qos_class_to_rse.py
--rw-r--r--   0 root         (0) root         (0)     1442 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/52153819589c_add_rse_id_to_replicas_table.py
--rw-r--r--   0 root         (0) root         (0)     1552 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/52fd9f4916fa_added_activity_to_rules.py
--rw-r--r--   0 root         (0) root         (0)     1742 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/53b479c3cb0f_fix_did_meta_table_missing_updated_at_.py
--rw-r--r--   0 root         (0) root         (0)     1855 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/5673b4b6e843_add_wfms_metadata_to_rule_tables.py
--rw-r--r--   0 root         (0) root         (0)     2387 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/575767d9f89_added_source_history_table.py
--rw-r--r--   0 root         (0) root         (0)     1727 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/58bff7008037_add_started_at_to_requests.py
--rw-r--r--   0 root         (0) root         (0)     6151 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/58c8b78301ab_rename_callback_to_message.py
--rw-r--r--   0 root         (0) root         (0)     2316 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/5f139f77382a_added_child_rule_id_column.py
--rw-r--r--   0 root         (0) root         (0)     1690 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/688ef1840840_adding_did_meta_table.py
--rw-r--r--   0 root         (0) root         (0)     1995 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/6e572a9bfbf3_add_new_split_container_column_to_rules.py
--rw-r--r--   0 root         (0) root         (0)     1585 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/70587619328_add_comment_column_for_subscriptions.py
--rw-r--r--   0 root         (0) root         (0)     1387 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/739064d31565_remove_history_table_pks.py
--rw-r--r--   0 root         (0) root         (0)     5073 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/7541902bf173_add_didsfollowed_and_followevents_table.py
--rw-r--r--   0 root         (0) root         (0)     3592 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/7ec22226cdbf_new_replica_state_for_temporary_.py
--rw-r--r--   0 root         (0) root         (0)     1921 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/810a41685bc1_added_columns_rse_transfer_limits.py
--rw-r--r--   0 root         (0) root         (0)     1914 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/83f991c63a93_correct_rse_expression_length.py
--rw-r--r--   0 root         (0) root         (0)     1687 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/8523998e2e76_increase_size_of_extended_attributes_.py
--rw-r--r--   0 root         (0) root         (0)     2171 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/8ea9122275b1_adding_missing_function_based_indices.py
--rw-r--r--   0 root         (0) root         (0)     1741 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/90f47792bb76_add_clob_payload_to_messages.py
--rw-r--r--   0 root         (0) root         (0)     3168 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/914b8f02df38_new_table_for_lifetime_model_exceptions.py
--rw-r--r--   0 root         (0) root         (0)     1775 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/94a5961ddbf2_add_estimator_columns.py
--rw-r--r--   0 root         (0) root         (0)     5062 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/9a1b149a2044_add_saml_identity_type.py
--rw-r--r--   0 root         (0) root         (0)     1962 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/9a45bc4ea66d_add_vp_table.py
--rw-r--r--   0 root         (0) root         (0)     3714 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/9eb936a81eb1_true_is_true.py
--rw-r--r--   0 root         (0) root         (0)     2663 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/a08fa8de1545_transfer_stats_table.py
--rw-r--r--   0 root         (0) root         (0)     3167 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/a118956323f8_added_vo_table_and_vo_col_to_rse.py
--rw-r--r--   0 root         (0) root         (0)     1755 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/a193a275255c_add_status_column_in_messages.py
--rw-r--r--   0 root         (0) root         (0)     5862 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/a5f6f6e928a7_1_7_0.py
--rw-r--r--   0 root         (0) root         (0)     2619 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/a616581ee47_added_columns_to_table_requests.py
--rw-r--r--   0 root         (0) root         (0)     2219 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/a6eb23955c28_state_idx_non_functional.py
--rw-r--r--   0 root         (0) root         (0)     2223 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/a74275a1ad30_added_global_quota_table.py
--rw-r--r--   0 root         (0) root         (0)     2800 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/a93e4e47bda_heartbeats.py
--rw-r--r--   0 root         (0) root         (0)     1907 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/ae2a56fcc89_added_comment_column_to_rules.py
--rw-r--r--   0 root         (0) root         (0)     1572 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/b4293a99f344_added_column_identity_to_table_tokens.py
--rw-r--r--   0 root         (0) root         (0)     5433 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/b7d287de34fd_removal_of_replicastate_source.py
--rw-r--r--   0 root         (0) root         (0)     1375 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/b818052fa670_add_index_to_quarantined_replicas.py
--rw-r--r--   0 root         (0) root         (0)     1611 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/b8caac94d7f0_add_comments_column_for_subscriptions_.py
--rw-r--r--   0 root         (0) root         (0)     7442 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/b96a1c7e1cc4_new_bad_pfns_table_and_bad_replicas_.py
--rw-r--r--   0 root         (0) root         (0)     3754 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/bb695f45c04_extend_request_state.py
--rw-r--r--   0 root         (0) root         (0)     2117 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/bc68e9946deb_add_staging_timestamps_to_request.py
--rw-r--r--   0 root         (0) root         (0)     2984 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/bf3baa1c1474_correct_pk_and_idx_for_history_tables.py
--rw-r--r--   0 root         (0) root         (0)     2145 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/c0937668555f_add_qos_policy_map_table.py
--rw-r--r--   0 root         (0) root         (0)     1556 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/c129ccdb2d5_add_lumiblocknr_to_dids.py
--rw-r--r--   0 root         (0) root         (0)     2858 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/ccdbcd48206e_add_did_type_column_index_on_did_meta_.py
--rw-r--r--   0 root         (0) root         (0)     1771 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/cebad904c4dd_new_payload_column_for_heartbeats.py
--rw-r--r--   0 root         (0) root         (0)     9635 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/d1189a09c6e0_oauth2_0_and_jwt_feature_support_adding_.py
--rw-r--r--   0 root         (0) root         (0)     4791 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/d23453595260_extend_request_state_for_preparer.py
--rw-r--r--   0 root         (0) root         (0)     1762 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/d6dceb1de2d_added_purge_column_to_rules.py
--rw-r--r--   0 root         (0) root         (0)     1619 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/d6e2c3b2cf26_remove_third_party_copy_column_from_rse.py
--rw-r--r--   0 root         (0) root         (0)     5313 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/d91002c5841_new_account_limits_table.py
--rw-r--r--   0 root         (0) root         (0)     2455 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/e138c364ebd0_extending_columns_for_filter_and_.py
--rw-r--r--   0 root         (0) root         (0)     4915 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/e59300c8b179_support_for_archive.py
--rw-r--r--   0 root         (0) root         (0)      921 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/f1b14a8c2ac1_postgres_use_check_constraints.py
--rw-r--r--   0 root         (0) root         (0)     2971 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/f41ffe206f37_oracle_global_temporary_tables.py
--rw-r--r--   0 root         (0) root         (0)     1974 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/f85a2962b021_adding_transfertool_column_to_requests_.py
--rw-r--r--   0 root         (0) root         (0)     1642 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/fa7a7d78b602_increase_refresh_token_size.py
--rw-r--r--   0 root         (0) root         (0)     1134 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/fb28a95fe288_add_replicas_rse_id_tombstone_idx.py
--rw-r--r--   0 root         (0) root         (0)     1920 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/fe1a65b176c9_set_third_party_copy_read_and_write_.py
--rw-r--r--   0 root         (0) root         (0)     1625 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/fe8ea2fa9788_added_third_party_copy_column_to_rse_.py
--rw-r--r--   0 root         (0) root         (0)   112291 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/models.py
--rw-r--r--   0 root         (0) root         (0)     1682 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/sautils.py
--rw-r--r--   0 root         (0) root         (0)    17797 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/session.py
--rw-r--r--   0 root         (0) root         (0)     6112 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/types.py
--rw-r--r--   0 root         (0) root         (0)    21450 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/db/sqla/util.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.399225 rucio-34.0.0rc2/lib/rucio/rse/
--rw-r--r--   0 root         (0) root         (0)     3327 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/rse/__init__.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.402225 rucio-34.0.0rc2/lib/rucio/rse/protocols/
--rw-r--r--   0 root         (0) root         (0)      642 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/rse/protocols/__init__.py
--rw-r--r--   0 root         (0) root         (0)     7223 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/rse/protocols/bittorrent.py
--rw-r--r--   0 root         (0) root         (0)     4627 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/rse/protocols/cache.py
--rw-r--r--   0 root         (0) root         (0)     4249 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/rse/protocols/dummy.py
--rw-r--r--   0 root         (0) root         (0)    29117 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/rse/protocols/gfal.py
--rw-r--r--   0 root         (0) root         (0)     9704 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/rse/protocols/globus.py
--rw-r--r--   0 root         (0) root         (0)     3433 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/rse/protocols/gsiftp.py
--rw-r--r--   0 root         (0) root         (0)     2999 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/rse/protocols/http_cache.py
--rw-r--r--   0 root         (0) root         (0)     4519 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/rse/protocols/mock.py
--rw-r--r--   0 root         (0) root         (0)     7248 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/rse/protocols/ngarc.py
--rw-r--r--   0 root         (0) root         (0)    10418 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/rse/protocols/posix.py
--rw-r--r--   0 root         (0) root         (0)    22682 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/rse/protocols/protocol.py
--rw-r--r--   0 root         (0) root         (0)    15280 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/rse/protocols/rclone.py
--rw-r--r--   0 root         (0) root         (0)     5523 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/rse/protocols/rfio.py
--rw-r--r--   0 root         (0) root         (0)    14675 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/rse/protocols/srm.py
--rw-r--r--   0 root         (0) root         (0)    17491 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/rse/protocols/ssh.py
--rw-r--r--   0 root         (0) root         (0)     8151 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/rse/protocols/storm.py
--rw-r--r--   0 root         (0) root         (0)    22206 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/rse/protocols/webdav.py
--rw-r--r--   0 root         (0) root         (0)    12591 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/rse/protocols/xrootd.py
--rw-r--r--   0 root         (0) root         (0)    37286 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/rse/rsemanager.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.403225 rucio-34.0.0rc2/lib/rucio/tests/
--rw-r--r--   0 root         (0) root         (0)      642 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/tests/__init__.py
--rw-r--r--   0 root         (0) root         (0)     7831 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/tests/common.py
--rw-r--r--   0 root         (0) root         (0)     5068 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/tests/common_server.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.404225 rucio-34.0.0rc2/lib/rucio/transfertool/
--rw-r--r--   0 root         (0) root         (0)      642 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/transfertool/__init__.py
--rw-r--r--   0 root         (0) root         (0)     8322 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/transfertool/bittorrent.py
--rw-r--r--   0 root         (0) root         (0)     1735 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/transfertool/bittorrent_driver.py
--rw-r--r--   0 root         (0) root         (0)     4961 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/transfertool/bittorrent_driver_qbittorrent.py
--rw-r--r--   0 root         (0) root         (0)    72286 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/transfertool/fts3.py
--rw-r--r--   0 root         (0) root         (0)     5782 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/transfertool/fts3_plugins.py
--rw-r--r--   0 root         (0) root         (0)     7679 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/transfertool/globus.py
--rw-r--r--   0 root         (0) root         (0)     8435 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/transfertool/globus_library.py
--rw-r--r--   0 root         (0) root         (0)     2883 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/transfertool/mock.py
--rw-r--r--   0 root         (0) root         (0)     7801 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/transfertool/transfertool.py
--rw-r--r--   0 root         (0) root         (0)      243 2024-03-14 13:17:06.000000 rucio-34.0.0rc2/lib/rucio/vcsversion.py
--rw-r--r--   0 root         (0) root         (0)     1573 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/version.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.404225 rucio-34.0.0rc2/lib/rucio/web/
--rw-r--r--   0 root         (0) root         (0)      642 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/web/__init__.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.405225 rucio-34.0.0rc2/lib/rucio/web/rest/
--rwxr-xr-x   0 root         (0) root         (0)      642 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/web/rest/__init__.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.405225 rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/
--rw-r--r--   0 root         (0) root         (0)      642 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/__init__.py
--rw-r--r--   0 root         (0) root         (0)     1023 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/authenticated_bp.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.411225 rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/
--rw-r--r--   0 root         (0) root         (0)      642 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/__init__.py
--rw-r--r--   0 root         (0) root         (0)     7826 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/accountlimits.py
--rw-r--r--   0 root         (0) root         (0)    37031 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/accounts.py
--rw-r--r--   0 root         (0) root         (0)     3374 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/archives.py
--rw-r--r--   0 root         (0) root         (0)    61566 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/auth.py
--rw-r--r--   0 root         (0) root         (0)    16179 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/common.py
--rw-r--r--   0 root         (0) root         (0)    10156 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/config.py
--rw-r--r--   0 root         (0) root         (0)     7747 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/credentials.py
--rw-r--r--   0 root         (0) root         (0)    77767 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/dids.py
--rw-r--r--   0 root         (0) root         (0)     4742 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/dirac.py
--rw-r--r--   0 root         (0) root         (0)     2686 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/export.py
--rw-r--r--   0 root         (0) root         (0)     4650 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/heartbeats.py
--rw-r--r--   0 root         (0) root         (0)     7924 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/identities.py
--rw-r--r--   0 root         (0) root         (0)     5281 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/import.py
--rw-r--r--   0 root         (0) root         (0)    12043 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/lifetime_exceptions.py
--rw-r--r--   0 root         (0) root         (0)    13020 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/locks.py
--rw-r--r--   0 root         (0) root         (0)     2885 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/main.py
--rw-r--r--   0 root         (0) root         (0)     7814 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/meta_conventions.py
--rw-r--r--   0 root         (0) root         (0)     1274 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/metrics.py
--rw-r--r--   0 root         (0) root         (0)     3154 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/nongrid_traces.py
--rw-r--r--   0 root         (0) root         (0)     3125 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/ping.py
--rw-r--r--   0 root         (0) root         (0)    13360 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/redirect.py
--rw-r--r--   0 root         (0) root         (0)    72691 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/replicas.py
--rw-r--r--   0 root         (0) root         (0)    41630 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/requests.py
--rw-r--r--   0 root         (0) root         (0)    81835 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/rses.py
--rw-r--r--   0 root         (0) root         (0)    31808 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/rules.py
--rw-r--r--   0 root         (0) root         (0)     5098 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/scopes.py
--rw-r--r--   0 root         (0) root         (0)    24191 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/subscriptions.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.411225 rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/templates/
--rw-r--r--   0 root         (0) root         (0)     2254 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/templates/auth_crash.html
--rw-r--r--   0 root         (0) root         (0)     2139 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/templates/auth_granted.html
--rw-r--r--   0 root         (0) root         (0)     3236 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/traces.py
--rw-r--r--   0 root         (0) root         (0)     9184 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/vos.py
--rw-r--r--   0 root         (0) root         (0)      749 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/lib/rucio/web/rest/main.py
--rw-r--r--   0 root         (0) root         (0)     1040 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/lib/rucio/web/rest/metrics.py
--rw-r--r--   0 root         (0) root         (0)     1034 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/lib/rucio/web/rest/ping.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.429225 rucio-34.0.0rc2/lib/rucio.egg-info/
--rw-r--r--   0 root         (0) root         (0)    25997 2024-03-14 14:43:02.000000 rucio-34.0.0rc2/lib/rucio.egg-info/SOURCES.txt
--rw-r--r--   0 root         (0) root         (0)    16384 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/pylintrc
--rw-r--r--   0 root         (0) root         (0)       90 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/pyproject.toml
--rw-r--r--   0 root         (0) root         (0)     5048 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/requirements.txt
--rw-r--r--   0 root         (0) root         (0)      206 2024-03-14 14:43:02.434225 rucio-34.0.0rc2/setup.cfg
--rw-r--r--   0 root         (0) root         (0)     2956 2024-03-14 14:42:58.000000 rucio-34.0.0rc2/setup.py
--rw-r--r--   0 root         (0) root         (0)     4803 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/setuputil.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.428225 rucio-34.0.0rc2/tests/
--rw-r--r--   0 root         (0) root         (0)     3708 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_abacus_account.py
--rw-r--r--   0 root         (0) root         (0)    10703 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/tests/test_abacus_collection_replica.py
--rw-r--r--   0 root         (0) root         (0)     3255 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_abacus_rse.py
--rw-r--r--   0 root         (0) root         (0)    15944 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/tests/test_account.py
--rw-r--r--   0 root         (0) root         (0)     9834 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_account_limits.py
--rw-r--r--   0 root         (0) root         (0)    20552 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_api_external_representation.py
--rw-r--r--   0 root         (0) root         (0)    13376 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_archive.py
--rw-r--r--   0 root         (0) root         (0)     4120 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_auditor.py
--rw-r--r--   0 root         (0) root         (0)     2213 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_auditor_hdfs.py
--rw-r--r--   0 root         (0) root         (0)     4225 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_auditor_srmdumps.py
--rw-r--r--   0 root         (0) root         (0)    15088 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/tests/test_authentication.py
--rw-r--r--   0 root         (0) root         (0)     3488 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_automatix.py
--rw-r--r--   0 root         (0) root         (0)    23358 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_bad_replica.py
--rw-r--r--   0 root         (0) root         (0)    12468 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_bb8.py
--rw-r--r--   0 root         (0) root         (0)     6975 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/tests/test_belleii.py
--rwxr-xr-x   0 root         (0) root         (0)   107211 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_bin_rucio.py
--rw-r--r--   0 root         (0) root         (0)     2089 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_boolean.py
--rw-r--r--   0 root         (0) root         (0)     6954 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_clients.py
--rw-r--r--   0 root         (0) root         (0)     1889 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_common_types.py
--rw-r--r--   0 root         (0) root         (0)     6966 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_config.py
--rw-r--r--   0 root         (0) root         (0)    96530 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/tests/test_conveyor.py
--rw-r--r--   0 root         (0) root         (0)    22661 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/tests/test_conveyor_submitter.py
--rw-r--r--   0 root         (0) root         (0)     6971 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_counter.py
--rw-r--r--   0 root         (0) root         (0)     7703 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_credential.py
--rw-r--r--   0 root         (0) root         (0)     7361 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_curl.py
--rw-r--r--   0 root         (0) root         (0)     2642 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/tests/test_daemons.py
--rw-r--r--   0 root         (0) root         (0)    28217 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/tests/test_dataset_replicas.py
--rw-r--r--   0 root         (0) root         (0)     2759 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_db.py
--rw-r--r--   0 root         (0) root         (0)    55589 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/tests/test_did.py
--rw-r--r--   0 root         (0) root         (0)    29541 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_did_meta_plugins.py
--rw-r--r--   0 root         (0) root         (0)     4209 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_didtype.py
--rw-r--r--   0 root         (0) root         (0)    35378 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_download.py
--rw-r--r--   0 root         (0) root         (0)     7203 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_dumper.py
--rw-r--r--   0 root         (0) root         (0)    16658 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_dumper_consistency.py
--rw-r--r--   0 root         (0) root         (0)    10907 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_dumper_data_model.py
--rw-r--r--   0 root         (0) root         (0)     3158 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_dumper_path_parsing.py
--rw-r--r--   0 root         (0) root         (0)    38325 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_filter_engine.py
--rw-r--r--   0 root         (0) root         (0)     7977 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_heartbeat.py
--rw-r--r--   0 root         (0) root         (0)    10138 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_hermes.py
--rw-r--r--   0 root         (0) root         (0)     5843 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_identity.py
--rw-r--r--   0 root         (0) root         (0)    18578 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_impl_upload_download.py
--rw-r--r--   0 root         (0) root         (0)    57259 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/tests/test_import_export.py
--rw-r--r--   0 root         (0) root         (0)     5281 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_judge_cleaner.py
--rw-r--r--   0 root         (0) root         (0)    22299 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_judge_evaluator.py
--rw-r--r--   0 root         (0) root         (0)    11070 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_judge_injector.py
--rw-r--r--   0 root         (0) root         (0)    20482 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_judge_repairer.py
--rw-r--r--   0 root         (0) root         (0)    12205 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_lifetime.py
--rw-r--r--   0 root         (0) root         (0)     5879 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_message.py
--rw-r--r--   0 root         (0) root         (0)     6323 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/tests/test_meta_conventions.py
--rw-r--r--   0 root         (0) root         (0)     1790 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_meta_did.py
--rw-r--r--   0 root         (0) root         (0)      983 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_module_import.py
--rw-r--r--   0 root         (0) root         (0)     2058 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_monitor.py
--rw-r--r--   0 root         (0) root         (0)    54268 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/tests/test_multi_vo.py
--rw-r--r--   0 root         (0) root         (0)     2911 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_naming_convention.py
--rw-r--r--   0 root         (0) root         (0)    11606 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_oauthmanager.py
--rw-r--r--   0 root         (0) root         (0)   108519 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/tests/test_oidc.py
--rw-r--r--   0 root         (0) root         (0)     4508 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/tests/test_permission.py
--rw-r--r--   0 root         (0) root         (0)     4147 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_pfns.py
--rw-r--r--   0 root         (0) root         (0)     1165 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_ping.py
--rw-r--r--   0 root         (0) root         (0)     7607 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_preparer.py
--rw-r--r--   0 root         (0) root         (0)     2765 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_qos.py
--rw-r--r--   0 root         (0) root         (0)     2053 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_quarantined_replica.py
--rw-r--r--   0 root         (0) root         (0)    27544 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/tests/test_reaper.py
--rw-r--r--   0 root         (0) root         (0)     6464 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_redirect.py
--rw-r--r--   0 root         (0) root         (0)    62616 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_replica.py
--rw-r--r--   0 root         (0) root         (0)    38899 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/tests/test_replica_recoverer.py
--rw-r--r--   0 root         (0) root         (0)    22764 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/tests/test_replica_sorting.py
--rw-r--r--   0 root         (0) root         (0)    17208 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/tests/test_request.py
--rw-r--r--   0 root         (0) root         (0)    13002 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/tests/test_root_proxy.py
--rw-r--r--   0 root         (0) root         (0)    75277 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/tests/test_rse.py
--rw-r--r--   0 root         (0) root         (0)    13230 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_rse_expression_parser.py
--rw-r--r--   0 root         (0) root         (0)     8966 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_rse_lfn2path.py
--rw-r--r--   0 root         (0) root         (0)     4300 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_rse_protocol_gfal2.py
--rw-r--r--   0 root         (0) root         (0)     3845 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_rse_protocol_gfal2_impl.py
--rw-r--r--   0 root         (0) root         (0)     3290 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_rse_protocol_posix.py
--rw-r--r--   0 root         (0) root         (0)     3713 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_rse_protocol_rclone.py
--rw-r--r--   0 root         (0) root         (0)     4822 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_rse_protocol_rsync.py
--rw-r--r--   0 root         (0) root         (0)     4002 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_rse_protocol_srm.py
--rw-r--r--   0 root         (0) root         (0)     4678 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_rse_protocol_ssh.py
--rw-r--r--   0 root         (0) root         (0)     3038 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_rse_protocol_webdav.py
--rw-r--r--   0 root         (0) root         (0)     3803 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_rse_protocol_xrootd.py
--rw-r--r--   0 root         (0) root         (0)     7770 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_rse_selector.py
--rw-r--r--   0 root         (0) root         (0)      891 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_rucio_server.py
--rw-r--r--   0 root         (0) root         (0)    90893 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/tests/test_rule.py
--rw-r--r--   0 root         (0) root         (0)    13873 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_schema_cms.py
--rw-r--r--   0 root         (0) root         (0)     7510 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_scope.py
--rw-r--r--   0 root         (0) root         (0)    48716 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/tests/test_subscription.py
--rw-r--r--   0 root         (0) root         (0)    55640 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_throttler.py
--rw-r--r--   0 root         (0) root         (0)     5064 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/tests/test_tpc.py
--rw-r--r--   0 root         (0) root         (0)     3204 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tests/test_trace.py
--rw-r--r--   0 root         (0) root         (0)    25277 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/tests/test_transfer.py
--rw-r--r--   0 root         (0) root         (0)     8949 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/tests/test_transfer_plugins.py
--rw-r--r--   0 root         (0) root         (0)     8436 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/tests/test_undertaker.py
--rw-r--r--   0 root         (0) root         (0)    15549 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/tests/test_upload.py
--rw-r--r--   0 root         (0) root         (0)     7451 2024-03-14 13:07:01.000000 rucio-34.0.0rc2/tests/test_utils.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2024-03-14 14:43:02.429225 rucio-34.0.0rc2/tools/
--rwxr-xr-x   0 root         (0) root         (0)     1284 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/tools/bootstrap.py
--rw-r--r--   0 root         (0) root         (0)     6189 2024-03-13 10:19:28.000000 rucio-34.0.0rc2/tools/merge_rucio_configs.py
--rwxr-xr-x   0 root         (0) root         (0)     1374 2023-07-27 12:40:37.000000 rucio-34.0.0rc2/tools/reset_database.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.199252 rucio-34.1.0/
+-rwxr-xr-x   0 root         (0) root         (0)     4487 2024-03-19 15:04:29.000000 rucio-34.1.0/AUTHORS.rst
+-rw-r--r--   0 root         (0) root         (0)       87 2023-07-27 12:40:37.000000 rucio-34.1.0/ChangeLog
+-rw-r--r--   0 root         (0) root         (0)    11357 2023-07-27 12:40:37.000000 rucio-34.1.0/LICENSE
+-rw-r--r--   0 root         (0) root         (0)      934 2024-04-02 13:57:01.000000 rucio-34.1.0/MANIFEST.in
+-rw-r--r--   0 root         (0) root         (0)     2799 2024-04-02 13:57:05.199252 rucio-34.1.0/PKG-INFO
+-rw-r--r--   0 root         (0) root         (0)     1982 2024-04-02 11:45:19.000000 rucio-34.1.0/README.rst
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.069251 rucio-34.1.0/bin/
+-rwxr-xr-x   0 root         (0) root         (0)   127075 2024-03-21 13:32:52.000000 rucio-34.1.0/bin/rucio
+-rwxr-xr-x   0 root         (0) root         (0)     2820 2024-03-21 13:32:52.000000 rucio-34.1.0/bin/rucio-abacus-account
+-rwxr-xr-x   0 root         (0) root         (0)     1823 2024-03-21 13:32:52.000000 rucio-34.1.0/bin/rucio-abacus-collection-replica
+-rwxr-xr-x   0 root         (0) root         (0)     2567 2024-03-21 13:32:52.000000 rucio-34.1.0/bin/rucio-abacus-rse
+-rwxr-xr-x   0 root         (0) root         (0)   133531 2024-03-21 13:32:52.000000 rucio-34.1.0/bin/rucio-admin
+-rwxr-xr-x   0 root         (0) root         (0)     3185 2024-03-21 13:32:52.000000 rucio-34.1.0/bin/rucio-atropos
+-rwxr-xr-x   0 root         (0) root         (0)     5849 2024-03-21 13:32:52.000000 rucio-34.1.0/bin/rucio-auditor
+-rwxr-xr-x   0 root         (0) root         (0)     2008 2024-03-21 13:32:52.000000 rucio-34.1.0/bin/rucio-automatix
+-rwxr-xr-x   0 root         (0) root         (0)     3103 2024-03-21 13:32:52.000000 rucio-34.1.0/bin/rucio-bb8
+-rwxr-xr-x   0 root         (0) root         (0)     6100 2024-03-21 13:32:52.000000 rucio-34.1.0/bin/rucio-c3po
+-rwxr-xr-x   0 root         (0) root         (0)     5063 2024-03-21 13:32:52.000000 rucio-34.1.0/bin/rucio-cache-client
+-rwxr-xr-x   0 root         (0) root         (0)     1362 2024-03-21 13:32:52.000000 rucio-34.1.0/bin/rucio-cache-consumer
+-rwxr-xr-x   0 root         (0) root         (0)     2346 2024-03-21 13:32:52.000000 rucio-34.1.0/bin/rucio-conveyor-finisher
+-rwxr-xr-x   0 root         (0) root         (0)     2839 2024-03-21 13:32:52.000000 rucio-34.1.0/bin/rucio-conveyor-poller
+-rwxr-xr-x   0 root         (0) root         (0)     1759 2024-03-21 13:32:52.000000 rucio-34.1.0/bin/rucio-conveyor-preparer
+-rwxr-xr-x   0 root         (0) root         (0)     1682 2024-03-21 13:32:52.000000 rucio-34.1.0/bin/rucio-conveyor-receiver
+-rwxr-xr-x   0 root         (0) root         (0)     3385 2024-03-21 13:32:52.000000 rucio-34.1.0/bin/rucio-conveyor-stager
+-rwxr-xr-x   0 root         (0) root         (0)     6750 2024-03-21 13:32:52.000000 rucio-34.1.0/bin/rucio-conveyor-submitter
+-rwxr-xr-x   0 root         (0) root         (0)     3859 2024-03-21 13:32:52.000000 rucio-34.1.0/bin/rucio-conveyor-throttler
+-rwxr-xr-x   0 root         (0) root         (0)     2546 2024-03-21 13:32:52.000000 rucio-34.1.0/bin/rucio-dark-reaper
+-rwxr-xr-x   0 root         (0) root         (0)     6463 2024-03-21 13:32:52.000000 rucio-34.1.0/bin/rucio-dumper
+-rwxr-xr-x   0 root         (0) root         (0)     1414 2024-03-21 13:32:52.000000 rucio-34.1.0/bin/rucio-follower
+-rwxr-xr-x   0 root         (0) root         (0)     1987 2024-03-21 13:32:52.000000 rucio-34.1.0/bin/rucio-hermes
+-rwxr-xr-x   0 root         (0) root         (0)     4649 2024-03-21 13:32:52.000000 rucio-34.1.0/bin/rucio-judge-cleaner
+-rwxr-xr-x   0 root         (0) root         (0)     7470 2024-03-21 13:32:52.000000 rucio-34.1.0/bin/rucio-judge-evaluator
+-rwxr-xr-x   0 root         (0) root         (0)     1671 2024-03-21 13:32:52.000000 rucio-34.1.0/bin/rucio-judge-injector
+-rwxr-xr-x   0 root         (0) root         (0)     1675 2024-03-21 13:32:52.000000 rucio-34.1.0/bin/rucio-judge-repairer
+-rwxr-xr-x   0 root         (0) root         (0)     1782 2024-03-21 13:32:52.000000 rucio-34.1.0/bin/rucio-kronos
+-rwxr-xr-x   0 root         (0) root         (0)     2260 2024-03-21 13:32:52.000000 rucio-34.1.0/bin/rucio-minos
+-rwxr-xr-x   0 root         (0) root         (0)     1997 2024-03-21 13:32:52.000000 rucio-34.1.0/bin/rucio-minos-temporary-expiration
+-rwxr-xr-x   0 root         (0) root         (0)     5625 2024-03-21 13:32:52.000000 rucio-34.1.0/bin/rucio-necromancer
+-rwxr-xr-x   0 root         (0) root         (0)     2788 2024-03-21 13:32:52.000000 rucio-34.1.0/bin/rucio-oauth-manager
+-rwxr-xr-x   0 root         (0) root         (0)     4070 2024-03-21 13:32:52.000000 rucio-34.1.0/bin/rucio-reaper
+-rwxr-xr-x   0 root         (0) root         (0)    18989 2024-03-21 13:32:52.000000 rucio-34.1.0/bin/rucio-replica-recoverer
+-rwxr-xr-x   0 root         (0) root         (0)     2351 2024-03-21 13:32:52.000000 rucio-34.1.0/bin/rucio-rse-decommissioner
+-rwxr-xr-x   0 root         (0) root         (0)     3920 2024-03-21 13:32:52.000000 rucio-34.1.0/bin/rucio-storage-consistency-actions
+-rwxr-xr-x   0 root         (0) root         (0)     3364 2024-03-21 13:32:52.000000 rucio-34.1.0/bin/rucio-transmogrifier
+-rwxr-xr-x   0 root         (0) root         (0)     2720 2024-03-21 13:32:52.000000 rucio-34.1.0/bin/rucio-undertaker
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.071251 rucio-34.1.0/etc/
+-rw-r--r--   0 root         (0) root         (0)     1764 2023-07-27 12:40:37.000000 rucio-34.1.0/etc/alembic.ini.template
+-rw-r--r--   0 root         (0) root         (0)     1922 2023-07-27 12:40:37.000000 rucio-34.1.0/etc/alembic_offline.ini.template
+-rw-r--r--   0 root         (0) root         (0)       96 2023-07-27 12:40:37.000000 rucio-34.1.0/etc/globus-config.yml.template
+-rw-r--r--   0 root         (0) root         (0)      807 2023-07-27 12:40:37.000000 rucio-34.1.0/etc/ldap.cfg.template
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.073251 rucio-34.1.0/etc/mail_templates/
+-rw-r--r--   0 root         (0) root         (0)     1210 2024-03-13 10:19:28.000000 rucio-34.1.0/etc/mail_templates/rule_approval_request.tmpl
+-rw-r--r--   0 root         (0) root         (0)      105 2023-07-27 12:40:37.000000 rucio-34.1.0/etc/mail_templates/rule_approved_admin.tmpl
+-rw-r--r--   0 root         (0) root         (0)      499 2023-07-27 12:40:37.000000 rucio-34.1.0/etc/mail_templates/rule_approved_user.tmpl
+-rw-r--r--   0 root         (0) root         (0)      120 2023-07-27 12:40:37.000000 rucio-34.1.0/etc/mail_templates/rule_denied_admin.tmpl
+-rw-r--r--   0 root         (0) root         (0)      493 2023-07-27 12:40:37.000000 rucio-34.1.0/etc/mail_templates/rule_denied_user.tmpl
+-rw-r--r--   0 root         (0) root         (0)      546 2023-07-27 12:40:37.000000 rucio-34.1.0/etc/mail_templates/rule_ok_notification.tmpl
+-rwxr-xr-x   0 root         (0) root         (0)      543 2023-07-27 12:40:37.000000 rucio-34.1.0/etc/rse-accounts.cfg.template
+-rw-r--r--   0 root         (0) root         (0)     1311 2023-07-27 12:40:37.000000 rucio-34.1.0/etc/rucio.cfg.atlas.client.template
+-rw-r--r--   0 root         (0) root         (0)     8534 2024-03-13 10:19:28.000000 rucio-34.1.0/etc/rucio.cfg.template
+-rw-r--r--   0 root         (0) root         (0)     7477 2024-03-13 10:19:28.000000 rucio-34.1.0/etc/rucio_multi_vo.cfg.template
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.047251 rucio-34.1.0/lib/
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.074251 rucio-34.1.0/lib/rucio/
+-rw-r--r--   0 root         (0) root         (0)      660 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/__init__.py
+-rw-r--r--   0 root         (0) root         (0)      690 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/alembicrevision.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.080251 rucio-34.1.0/lib/rucio/api/
+-rw-r--r--   0 root         (0) root         (0)      618 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/api/__init__.py
+-rw-r--r--   0 root         (0) root         (0)     9292 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/api/account.py
+-rw-r--r--   0 root         (0) root         (0)    11395 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/api/account_limit.py
+-rw-r--r--   0 root         (0) root         (0)    12890 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/api/authentication.py
+-rw-r--r--   0 root         (0) root         (0)     8654 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/api/config.py
+-rw-r--r--   0 root         (0) root         (0)     2908 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/api/credential.py
+-rw-r--r--   0 root         (0) root         (0)    28937 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/api/did.py
+-rw-r--r--   0 root         (0) root         (0)     3206 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/api/dirac.py
+-rw-r--r--   0 root         (0) root         (0)     2105 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/api/exporter.py
+-rw-r--r--   0 root         (0) root         (0)     2651 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/api/heartbeat.py
+-rw-r--r--   0 root         (0) root         (0)     6830 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/api/identity.py
+-rw-r--r--   0 root         (0) root         (0)     1731 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/api/importer.py
+-rw-r--r--   0 root         (0) root         (0)     3685 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/api/lifetime_exception.py
+-rw-r--r--   0 root         (0) root         (0)     4628 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/api/lock.py
+-rw-r--r--   0 root         (0) root         (0)     3573 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/api/meta_conventions.py
+-rw-r--r--   0 root         (0) root         (0)     2665 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/api/permission.py
+-rw-r--r--   0 root         (0) root         (0)     2495 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/api/quarantined_replica.py
+-rw-r--r--   0 root         (0) root         (0)    22398 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/api/replica.py
+-rw-r--r--   0 root         (0) root         (0)    10550 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/api/request.py
+-rw-r--r--   0 root         (0) root         (0)    23582 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/api/rse.py
+-rw-r--r--   0 root         (0) root         (0)    15938 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/api/rule.py
+-rw-r--r--   0 root         (0) root         (0)     3003 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/api/scope.py
+-rw-r--r--   0 root         (0) root         (0)    10537 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/api/subscription.py
+-rw-r--r--   0 root         (0) root         (0)     4559 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/api/vo.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.087251 rucio-34.1.0/lib/rucio/client/
+-rw-r--r--   0 root         (0) root         (0)      660 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/client/__init__.py
+-rw-r--r--   0 root         (0) root         (0)    16353 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/client/accountclient.py
+-rw-r--r--   0 root         (0) root         (0)     5961 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/client/accountlimitclient.py
+-rw-r--r--   0 root         (0) root         (0)    47057 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/client/baseclient.py
+-rw-r--r--   0 root         (0) root         (0)     3079 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/client/client.py
+-rw-r--r--   0 root         (0) root         (0)     4401 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/client/configclient.py
+-rw-r--r--   0 root         (0) root         (0)     1989 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/client/credentialclient.py
+-rw-r--r--   0 root         (0) root         (0)    28378 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/client/didclient.py
+-rw-r--r--   0 root         (0) root         (0)     2114 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/client/diracclient.py
+-rw-r--r--   0 root         (0) root         (0)    86065 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/client/downloadclient.py
+-rw-r--r--   0 root         (0) root         (0)     1575 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/client/exportclient.py
+-rw-r--r--   0 root         (0) root         (0)     1610 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/client/fileclient.py
+-rw-r--r--   0 root         (0) root         (0)     1469 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/client/importclient.py
+-rw-r--r--   0 root         (0) root         (0)     2822 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/client/lifetimeclient.py
+-rw-r--r--   0 root         (0) root         (0)     3914 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/client/lockclient.py
+-rw-r--r--   0 root         (0) root         (0)     5195 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/client/metaconventionsclient.py
+-rw-r--r--   0 root         (0) root         (0)     1390 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/client/pingclient.py
+-rw-r--r--   0 root         (0) root         (0)    19284 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/client/replicaclient.py
+-rw-r--r--   0 root         (0) root         (0)     4197 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/client/requestclient.py
+-rw-r--r--   0 root         (0) root         (0)    27124 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/client/rseclient.py
+-rw-r--r--   0 root         (0) root         (0)    12682 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/client/ruleclient.py
+-rw-r--r--   0 root         (0) root         (0)     3147 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/client/scopeclient.py
+-rw-r--r--   0 root         (0) root         (0)     7971 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/client/subscriptionclient.py
+-rw-r--r--   0 root         (0) root         (0)     2642 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/client/touchclient.py
+-rw-r--r--   0 root         (0) root         (0)    46563 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/client/uploadclient.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.092251 rucio-34.1.0/lib/rucio/common/
+-rw-r--r--   0 root         (0) root         (0)      618 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/common/__init__.py
+-rw-r--r--   0 root         (0) root         (0)     2234 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/common/cache.py
+-rw-r--r--   0 root         (0) root         (0)    24282 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/common/config.py
+-rw-r--r--   0 root         (0) root         (0)     3300 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/common/constants.py
+-rw-r--r--   0 root         (0) root         (0)      726 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/common/constraints.py
+-rwxr-xr-x   0 root         (0) root         (0)     6291 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/common/didtype.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.093251 rucio-34.1.0/lib/rucio/common/dumper/
+-rw-r--r--   0 root         (0) root         (0)     9151 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/common/dumper/__init__.py
+-rw-r--r--   0 root         (0) root         (0)    16073 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/common/dumper/consistency.py
+-rw-r--r--   0 root         (0) root         (0)     9687 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/common/dumper/data_models.py
+-rw-r--r--   0 root         (0) root         (0)     1923 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/common/dumper/path_parsing.py
+-rw-r--r--   0 root         (0) root         (0)    32345 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/common/exception.py
+-rw-r--r--   0 root         (0) root         (0)     1398 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/common/extra.py
+-rw-r--r--   0 root         (0) root         (0)    15046 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/common/logging.py
+-rw-r--r--   0 root         (0) root         (0)    45297 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/common/pcache.py
+-rw-r--r--   0 root         (0) root         (0)     6056 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/common/plugins.py
+-rw-r--r--   0 root         (0) root         (0)     3013 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/common/policy.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.096251 rucio-34.1.0/lib/rucio/common/schema/
+-rw-r--r--   0 root         (0) root         (0)     5152 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/common/schema/__init__.py
+-rw-r--r--   0 root         (0) root         (0)    15589 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/common/schema/atlas.py
+-rw-r--r--   0 root         (0) root         (0)    15406 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/common/schema/belleii.py
+-rw-r--r--   0 root         (0) root         (0)    18523 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/common/schema/cms.py
+-rw-r--r--   0 root         (0) root         (0)    14987 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/common/schema/domatpc.py
+-rw-r--r--   0 root         (0) root         (0)    15926 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/common/schema/escape.py
+-rw-r--r--   0 root         (0) root         (0)    16241 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/common/schema/generic.py
+-rw-r--r--   0 root         (0) root         (0)    15468 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/common/schema/generic_multi_vo.py
+-rw-r--r--   0 root         (0) root         (0)    15277 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/common/schema/icecube.py
+-rw-r--r--   0 root         (0) root         (0)    15885 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/common/schema/lsst.py
+-rw-r--r--   0 root         (0) root         (0)     5414 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/common/stomp_utils.py
+-rw-r--r--   0 root         (0) root         (0)     1641 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/common/stopwatch.py
+-rw-r--r--   0 root         (0) root         (0)     4935 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/common/test_rucio_server.py
+-rw-r--r--   0 root         (0) root         (0)     5069 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/common/types.py
+-rw-r--r--   0 root         (0) root         (0)    79094 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/common/utils.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.108251 rucio-34.1.0/lib/rucio/core/
+-rw-r--r--   0 root         (0) root         (0)      618 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/core/__init__.py
+-rw-r--r--   0 root         (0) root         (0)    14952 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/core/account.py
+-rw-r--r--   0 root         (0) root         (0)     6293 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/core/account_counter.py
+-rw-r--r--   0 root         (0) root         (0)    14278 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/core/account_limit.py
+-rw-r--r--   0 root         (0) root         (0)    19785 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/core/authentication.py
+-rw-r--r--   0 root         (0) root         (0)    13462 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/core/config.py
+-rw-r--r--   0 root         (0) root         (0)     8161 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/core/credential.py
+-rw-r--r--   0 root         (0) root         (0)   125614 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/core/did.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.110252 rucio-34.1.0/lib/rucio/core/did_meta_plugins/
+-rw-r--r--   0 root         (0) root         (0)    11733 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/core/did_meta_plugins/__init__.py
+-rw-r--r--   0 root         (0) root         (0)    17475 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/core/did_meta_plugins/did_column_meta.py
+-rw-r--r--   0 root         (0) root         (0)     4078 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/core/did_meta_plugins/did_meta_plugin_interface.py
+-rw-r--r--   0 root         (0) root         (0)    29313 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/core/did_meta_plugins/filter_engine.py
+-rw-r--r--   0 root         (0) root         (0)     9245 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/core/did_meta_plugins/json_meta.py
+-rw-r--r--   0 root         (0) root         (0)     7453 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/core/did_meta_plugins/mongo_meta.py
+-rw-r--r--   0 root         (0) root         (0)    13727 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/core/did_meta_plugins/postgres_meta.py
+-rw-r--r--   0 root         (0) root         (0)     9406 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/core/dirac.py
+-rw-r--r--   0 root         (0) root         (0)     5695 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/core/distance.py
+-rw-r--r--   0 root         (0) root         (0)     1875 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/core/exporter.py
+-rw-r--r--   0 root         (0) root         (0)    10340 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/core/heartbeat.py
+-rw-r--r--   0 root         (0) root         (0)    11836 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/core/identity.py
+-rw-r--r--   0 root         (0) root         (0)    13839 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/core/importer.py
+-rw-r--r--   0 root         (0) root         (0)    15235 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/core/lifetime_exception.py
+-rw-r--r--   0 root         (0) root         (0)    22807 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/core/lock.py
+-rw-r--r--   0 root         (0) root         (0)     9693 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/core/message.py
+-rw-r--r--   0 root         (0) root         (0)     8691 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/core/meta_conventions.py
+-rw-r--r--   0 root         (0) root         (0)    15768 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/core/monitor.py
+-rw-r--r--   0 root         (0) root         (0)     5395 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/core/naming_convention.py
+-rw-r--r--   0 root         (0) root         (0)     4890 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/core/nongrid_trace.py
+-rw-r--r--   0 root         (0) root         (0)    69762 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/core/oidc.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.112252 rucio-34.1.0/lib/rucio/core/permission/
+-rw-r--r--   0 root         (0) root         (0)     3910 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/core/permission/__init__.py
+-rw-r--r--   0 root         (0) root         (0)    55427 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/core/permission/atlas.py
+-rw-r--r--   0 root         (0) root         (0)    46908 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/core/permission/belleii.py
+-rw-r--r--   0 root         (0) root         (0)    46757 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/core/permission/cms.py
+-rw-r--r--   0 root         (0) root         (0)    43104 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/core/permission/escape.py
+-rw-r--r--   0 root         (0) root         (0)    45307 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/core/permission/generic.py
+-rw-r--r--   0 root         (0) root         (0)    45853 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/core/permission/generic_multi_vo.py
+-rw-r--r--   0 root         (0) root         (0)     8029 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/core/quarantined_replica.py
+-rw-r--r--   0 root         (0) root         (0)   177307 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/core/replica.py
+-rw-r--r--   0 root         (0) root         (0)    15420 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/core/replica_sorter.py
+-rw-r--r--   0 root         (0) root         (0)   116242 2024-04-02 11:36:32.000000 rucio-34.1.0/lib/rucio/core/request.py
+-rw-r--r--   0 root         (0) root         (0)    67929 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/core/rse.py
+-rw-r--r--   0 root         (0) root         (0)     5510 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/core/rse_counter.py
+-rw-r--r--   0 root         (0) root         (0)    15369 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/core/rse_expression_parser.py
+-rw-r--r--   0 root         (0) root         (0)    13932 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/core/rse_selector.py
+-rw-r--r--   0 root         (0) root         (0)   208340 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/core/rule.py
+-rw-r--r--   0 root         (0) root         (0)    92255 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/core/rule_grouping.py
+-rw-r--r--   0 root         (0) root         (0)     5364 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/core/scope.py
+-rw-r--r--   0 root         (0) root         (0)    15232 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/core/subscription.py
+-rw-r--r--   0 root         (0) root         (0)    18667 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/core/topology.py
+-rw-r--r--   0 root         (0) root         (0)    13107 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/core/trace.py
+-rw-r--r--   0 root         (0) root         (0)    64150 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/core/transfer.py
+-rw-r--r--   0 root         (0) root         (0)     5507 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/core/vo.py
+-rw-r--r--   0 root         (0) root         (0)     5070 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/core/volatile_replica.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.112252 rucio-34.1.0/lib/rucio/daemons/
+-rw-r--r--   0 root         (0) root         (0)      618 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/__init__.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.113252 rucio-34.1.0/lib/rucio/daemons/abacus/
+-rw-r--r--   0 root         (0) root         (0)      618 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/abacus/__init__.py
+-rw-r--r--   0 root         (0) root         (0)     3736 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/abacus/account.py
+-rw-r--r--   0 root         (0) root         (0)     3856 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/abacus/collection_replica.py
+-rw-r--r--   0 root         (0) root         (0)     3596 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/abacus/rse.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.114251 rucio-34.1.0/lib/rucio/daemons/atropos/
+-rw-r--r--   0 root         (0) root         (0)      618 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/atropos/__init__.py
+-rw-r--r--   0 root         (0) root         (0)    10559 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/atropos/atropos.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.115252 rucio-34.1.0/lib/rucio/daemons/auditor/
+-rw-r--r--   0 root         (0) root         (0)     9998 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/auditor/__init__.py
+-rw-r--r--   0 root         (0) root         (0)     2865 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/auditor/hdfs.py
+-rw-r--r--   0 root         (0) root         (0)     8616 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/auditor/srmdumps.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.115252 rucio-34.1.0/lib/rucio/daemons/automatix/
+-rw-r--r--   0 root         (0) root         (0)      618 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/automatix/__init__.py
+-rw-r--r--   0 root         (0) root         (0)     9914 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/automatix/automatix.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.116252 rucio-34.1.0/lib/rucio/daemons/badreplicas/
+-rw-r--r--   0 root         (0) root         (0)      618 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/badreplicas/__init__.py
+-rw-r--r--   0 root         (0) root         (0)    15768 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/badreplicas/minos.py
+-rw-r--r--   0 root         (0) root         (0)     8626 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/badreplicas/minos_temporary_expiration.py
+-rw-r--r--   0 root         (0) root         (0)     9892 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/badreplicas/necromancer.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.118252 rucio-34.1.0/lib/rucio/daemons/bb8/
+-rw-r--r--   0 root         (0) root         (0)      618 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/bb8/__init__.py
+-rw-r--r--   0 root         (0) root         (0)    13071 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/bb8/bb8.py
+-rw-r--r--   0 root         (0) root         (0)    26597 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/bb8/common.py
+-rw-r--r--   0 root         (0) root         (0)     6644 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/bb8/nuclei_background_rebalance.py
+-rw-r--r--   0 root         (0) root         (0)     6522 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/bb8/t2_background_rebalance.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.118252 rucio-34.1.0/lib/rucio/daemons/c3po/
+-rw-r--r--   0 root         (0) root         (0)      618 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/c3po/__init__.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.120252 rucio-34.1.0/lib/rucio/daemons/c3po/algorithms/
+-rw-r--r--   0 root         (0) root         (0)      618 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/c3po/algorithms/__init__.py
+-rw-r--r--   0 root         (0) root         (0)     4571 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/c3po/algorithms/simple.py
+-rw-r--r--   0 root         (0) root         (0)     4651 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/c3po/algorithms/t2_free_space.py
+-rw-r--r--   0 root         (0) root         (0)     4774 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/c3po/algorithms/t2_free_space_only_pop.py
+-rw-r--r--   0 root         (0) root         (0)    12151 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/c3po/algorithms/t2_free_space_only_pop_with_network.py
+-rw-r--r--   0 root         (0) root         (0)    15009 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/c3po/c3po.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.121252 rucio-34.1.0/lib/rucio/daemons/c3po/collectors/
+-rw-r--r--   0 root         (0) root         (0)      618 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/c3po/collectors/__init__.py
+-rw-r--r--   0 root         (0) root         (0)     3261 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/c3po/collectors/agis.py
+-rw-r--r--   0 root         (0) root         (0)     2094 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/c3po/collectors/free_space.py
+-rw-r--r--   0 root         (0) root         (0)     1648 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/daemons/c3po/collectors/jedi_did.py
+-rw-r--r--   0 root         (0) root         (0)     1338 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/c3po/collectors/mock_did.py
+-rw-r--r--   0 root         (0) root         (0)     2068 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/c3po/collectors/network_metrics.py
+-rw-r--r--   0 root         (0) root         (0)     3818 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/c3po/collectors/workload.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.123252 rucio-34.1.0/lib/rucio/daemons/c3po/utils/
+-rw-r--r--   0 root         (0) root         (0)      618 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/c3po/utils/__init__.py
+-rw-r--r--   0 root         (0) root         (0)     1386 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/c3po/utils/dataset_cache.py
+-rw-r--r--   0 root         (0) root         (0)     1523 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/c3po/utils/expiring_dataset_cache.py
+-rw-r--r--   0 root         (0) root         (0)     1596 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/c3po/utils/expiring_list.py
+-rw-r--r--   0 root         (0) root         (0)     2440 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/c3po/utils/popularity.py
+-rw-r--r--   0 root         (0) root         (0)     2087 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/c3po/utils/timeseries.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.123252 rucio-34.1.0/lib/rucio/daemons/cache/
+-rw-r--r--   0 root         (0) root         (0)      642 2023-07-27 12:40:37.000000 rucio-34.1.0/lib/rucio/daemons/cache/__init__.py
+-rw-r--r--   0 root         (0) root         (0)     6744 2024-03-13 10:19:28.000000 rucio-34.1.0/lib/rucio/daemons/cache/consumer.py
+-rw-r--r--   0 root         (0) root         (0)    14947 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/common.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.126252 rucio-34.1.0/lib/rucio/daemons/conveyor/
+-rw-r--r--   0 root         (0) root         (0)      618 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/conveyor/__init__.py
+-rw-r--r--   0 root         (0) root         (0)    25768 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/conveyor/common.py
+-rw-r--r--   0 root         (0) root         (0)    23644 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/conveyor/finisher.py
+-rw-r--r--   0 root         (0) root         (0)    16242 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/conveyor/poller.py
+-rw-r--r--   0 root         (0) root         (0)     7462 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/conveyor/preparer.py
+-rw-r--r--   0 root         (0) root         (0)     8289 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/daemons/conveyor/receiver.py
+-rw-r--r--   0 root         (0) root         (0)     3827 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/conveyor/stager.py
+-rw-r--r--   0 root         (0) root         (0)    16333 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/conveyor/submitter.py
+-rw-r--r--   0 root         (0) root         (0)    20351 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/conveyor/throttler.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.127252 rucio-34.1.0/lib/rucio/daemons/follower/
+-rw-r--r--   0 root         (0) root         (0)      618 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/follower/__init__.py
+-rw-r--r--   0 root         (0) root         (0)     3355 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/follower/follower.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.127252 rucio-34.1.0/lib/rucio/daemons/hermes/
+-rw-r--r--   0 root         (0) root         (0)      618 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/hermes/__init__.py
+-rw-r--r--   0 root         (0) root         (0)    26436 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/hermes/hermes.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.129252 rucio-34.1.0/lib/rucio/daemons/judge/
+-rw-r--r--   0 root         (0) root         (0)      618 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/judge/__init__.py
+-rw-r--r--   0 root         (0) root         (0)     5758 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/judge/cleaner.py
+-rw-r--r--   0 root         (0) root         (0)     7156 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/judge/evaluator.py
+-rw-r--r--   0 root         (0) root         (0)     6352 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/judge/injector.py
+-rw-r--r--   0 root         (0) root         (0)     5296 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/judge/repairer.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.129252 rucio-34.1.0/lib/rucio/daemons/oauthmanager/
+-rw-r--r--   0 root         (0) root         (0)      618 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/oauthmanager/__init__.py
+-rw-r--r--   0 root         (0) root         (0)     8815 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/oauthmanager/oauthmanager.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.130252 rucio-34.1.0/lib/rucio/daemons/reaper/
+-rw-r--r--   0 root         (0) root         (0)      618 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/reaper/__init__.py
+-rw-r--r--   0 root         (0) root         (0)    11222 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/reaper/dark_reaper.py
+-rw-r--r--   0 root         (0) root         (0)    35532 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/reaper/reaper.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.131252 rucio-34.1.0/lib/rucio/daemons/replicarecoverer/
+-rw-r--r--   0 root         (0) root         (0)      618 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/replicarecoverer/__init__.py
+-rwxr-xr-x   0 root         (0) root         (0)    33150 2024-04-02 11:24:52.000000 rucio-34.1.0/lib/rucio/daemons/replicarecoverer/suspicious_replica_recoverer.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.131252 rucio-34.1.0/lib/rucio/daemons/rsedecommissioner/
+-rw-r--r--   0 root         (0) root         (0)      618 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/rsedecommissioner/__init__.py
+-rw-r--r--   0 root         (0) root         (0)     2671 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/rsedecommissioner/config.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.132252 rucio-34.1.0/lib/rucio/daemons/rsedecommissioner/profiles/
+-rw-r--r--   0 root         (0) root         (0)      863 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/rsedecommissioner/profiles/__init__.py
+-rw-r--r--   0 root         (0) root         (0)     2221 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/rsedecommissioner/profiles/atlas.py
+-rw-r--r--   0 root         (0) root         (0)    16231 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/rsedecommissioner/profiles/generic.py
+-rw-r--r--   0 root         (0) root         (0)     2927 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/rsedecommissioner/profiles/types.py
+-rw-r--r--   0 root         (0) root         (0)    10358 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/rsedecommissioner/rse_decommissioner.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.133252 rucio-34.1.0/lib/rucio/daemons/storage/
+-rw-r--r--   0 root         (0) root         (0)      618 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/storage/__init__.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.133252 rucio-34.1.0/lib/rucio/daemons/storage/consistency/
+-rw-r--r--   0 root         (0) root         (0)      618 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/storage/consistency/__init__.py
+-rw-r--r--   0 root         (0) root         (0)    29563 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/storage/consistency/actions.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.134252 rucio-34.1.0/lib/rucio/daemons/tracer/
+-rw-r--r--   0 root         (0) root         (0)      618 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/tracer/__init__.py
+-rw-r--r--   0 root         (0) root         (0)    23764 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/tracer/kronos.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.134252 rucio-34.1.0/lib/rucio/daemons/transmogrifier/
+-rw-r--r--   0 root         (0) root         (0)      618 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/transmogrifier/__init__.py
+-rw-r--r--   0 root         (0) root         (0)    30528 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/transmogrifier/transmogrifier.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.135252 rucio-34.1.0/lib/rucio/daemons/undertaker/
+-rw-r--r--   0 root         (0) root         (0)      618 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/undertaker/__init__.py
+-rw-r--r--   0 root         (0) root         (0)     5216 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/daemons/undertaker/undertaker.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.135252 rucio-34.1.0/lib/rucio/db/
+-rw-r--r--   0 root         (0) root         (0)      618 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/__init__.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.137252 rucio-34.1.0/lib/rucio/db/sqla/
+-rw-r--r--   0 root         (0) root         (0)     2130 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/__init__.py
+-rw-r--r--   0 root         (0) root         (0)     4151 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/constants.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.138252 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/
+-rw-r--r--   0 root         (0) root         (0)      618 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/__init__.py
+-rw-r--r--   0 root         (0) root         (0)     3545 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/env.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.163252 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/
+-rw-r--r--   0 root         (0) root         (0)     3340 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/01eaf73ab656_add_new_rule_notification_state_progress.py
+-rw-r--r--   0 root         (0) root         (0)     1821 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/0437a40dbfd1_add_eol_at_in_rules.py
+-rw-r--r--   0 root         (0) root         (0)     2640 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/0f1adb7a599a_create_transfer_hops_table.py
+-rw-r--r--   0 root         (0) root         (0)     1533 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/102efcf145f4_added_stuck_at_column_to_rules.py
+-rw-r--r--   0 root         (0) root         (0)     5272 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/13d4f70c66a9_introduce_transfer_limits.py
+-rw-r--r--   0 root         (0) root         (0)     3659 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/140fef722e91_cleanup_distances_table.py
+-rw-r--r--   0 root         (0) root         (0)     1548 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/14ec5aeb64cf_add_request_external_host.py
+-rw-r--r--   0 root         (0) root         (0)     2291 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/156fb5b5a14_add_request_type_to_requests_idx.py
+-rw-r--r--   0 root         (0) root         (0)     2816 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/1677d4d803c8_split_rse_availability_into_multiple.py
+-rw-r--r--   0 root         (0) root         (0)     1260 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/16a0aca82e12_create_index_on_table_replicas_path.py
+-rw-r--r--   0 root         (0) root         (0)     1678 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/1803333ac20f_adding_provenance_and_phys_group.py
+-rw-r--r--   0 root         (0) root         (0)     2675 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/1a29d6a9504c_add_didtype_chck_to_requests.py
+-rw-r--r--   0 root         (0) root         (0)     1314 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/1a80adff031a_create_index_on_rules_hist_recent.py
+-rw-r--r--   0 root         (0) root         (0)     8494 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/1c45d9730ca6_increase_identity_length.py
+-rw-r--r--   0 root         (0) root         (0)     3277 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/1d1215494e95_add_quarantined_replicas_table.py
+-rw-r--r--   0 root         (0) root         (0)     3782 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/1d96f484df21_asynchronous_rules_and_rule_approval.py
+-rw-r--r--   0 root         (0) root         (0)     1546 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/1f46c5f240ac_add_bytes_column_to_bad_replicas.py
+-rw-r--r--   0 root         (0) root         (0)     1692 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/1fc15ab60d43_add_message_history_table.py
+-rw-r--r--   0 root         (0) root         (0)     4360 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/2190e703eb6e_move_rse_settings_to_rse_attributes.py
+-rw-r--r--   0 root         (0) root         (0)     3014 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/21d6b9dc9961_add_mismatch_scheme_state_to_requests.py
+-rw-r--r--   0 root         (0) root         (0)     1497 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/22cf51430c78_add_availability_column_to_table_rses.py
+-rw-r--r--   0 root         (0) root         (0)     2781 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/22d887e4ec0a_create_sources_table.py
+-rw-r--r--   0 root         (0) root         (0)     2297 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/25821a8a45a3_remove_unique_constraint_on_requests.py
+-rw-r--r--   0 root         (0) root         (0)     1400 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/25fc855625cf_added_unique_constraint_to_rules.py
+-rw-r--r--   0 root         (0) root         (0)     1535 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/269fee20dee9_add_repair_cnt_to_locks.py
+-rw-r--r--   0 root         (0) root         (0)     1641 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/271a46ea6244_add_ignore_availability_column_to_rules.py
+-rw-r--r--   0 root         (0) root         (0)     2274 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/277b5fbb41d3_switch_heartbeats_executable.py
+-rw-r--r--   0 root         (0) root         (0)     1219 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/27e3a68927fb_remove_replicas_tombstone_and_replicas_.py
+-rw-r--r--   0 root         (0) root         (0)     1710 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/2854cd9e168_added_rule_id_column.py
+-rw-r--r--   0 root         (0) root         (0)     1723 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/295289b5a800_processed_by_and__at_in_requests.py
+-rw-r--r--   0 root         (0) root         (0)     1695 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/2962ece31cf4_add_nbaccesses_column_in_the_did_table.py
+-rw-r--r--   0 root         (0) root         (0)     2206 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/2af3291ec4c_added_replicas_history_table.py
+-rw-r--r--   0 root         (0) root         (0)     1787 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/2b69addda658_add_columns_for_third_party_copy_read_.py
+-rw-r--r--   0 root         (0) root         (0)     2837 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/2b8e7bcb4783_add_config_table.py
+-rw-r--r--   0 root         (0) root         (0)     1554 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/2ba5229cb54c_add_submitted_at_to_requests_table.py
+-rw-r--r--   0 root         (0) root         (0)     1571 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/2cbee484dcf9_added_column_volume_to_rse_transfer_.py
+-rw-r--r--   0 root         (0) root         (0)     1758 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/2edee4a83846_add_source_to_requests_and_requests_.py
+-rw-r--r--   0 root         (0) root         (0)     1768 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/2eef46be23d4_change_tokens_pk.py
+-rw-r--r--   0 root         (0) root         (0)     1308 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/2f648fc909f3_index_in_rule_history_on_scope_name.py
+-rw-r--r--   0 root         (0) root         (0)     3227 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/3082b8cef557_add_naming_convention_table_and_closed_.py
+-rw-r--r--   0 root         (0) root         (0)     2019 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/30fa38b6434e_add_index_on_service_column_in_the_message_table.py
+-rw-r--r--   0 root         (0) root         (0)     3882 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/3152492b110b_added_staging_area_column.py
+-rw-r--r--   0 root         (0) root         (0)     2513 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/32c7d2783f7e_create_bad_replicas_table.py
+-rw-r--r--   0 root         (0) root         (0)     3997 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/3345511706b8_replicas_table_pk_definition_is_in_.py
+-rw-r--r--   0 root         (0) root         (0)     1470 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/35ef10d1e11b_change_index_on_table_requests.py
+-rw-r--r--   0 root         (0) root         (0)     2817 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/379a19b5332d_create_rse_limits_table.py
+-rw-r--r--   0 root         (0) root         (0)     7527 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/384b96aa0f60_created_rule_history_tables.py
+-rw-r--r--   0 root         (0) root         (0)     2396 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/3ac1660a1a72_extend_distance_table.py
+-rw-r--r--   0 root         (0) root         (0)     3592 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/3ad36e2268b0_create_collection_replicas_updates_table.py
+-rw-r--r--   0 root         (0) root         (0)     2687 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/3c9df354071b_extend_waiting_request_state.py
+-rw-r--r--   0 root         (0) root         (0)     1450 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/3d9813fab443_add_a_new_state_lost_in_badfilesstatus.py
+-rw-r--r--   0 root         (0) root         (0)     1560 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/40ad39ce3160_add_transferred_at_to_requests_table.py
+-rw-r--r--   0 root         (0) root         (0)     2777 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/4207be2fd914_add_notification_column_to_rules.py
+-rw-r--r--   0 root         (0) root         (0)     1287 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/42db2617c364_create_index_on_requests_external_id.py
+-rw-r--r--   0 root         (0) root         (0)     1551 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/436827b13f82_added_column_activity_to_table_requests.py
+-rw-r--r--   0 root         (0) root         (0)     1644 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/44278720f774_update_requests_typ_sta_upd_idx_index.py
+-rw-r--r--   0 root         (0) root         (0)     3682 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/45378a1e76a8_create_collection_replica_table.py
+-rw-r--r--   0 root         (0) root         (0)     1420 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/469d262be19_removing_created_at_index.py
+-rw-r--r--   0 root         (0) root         (0)     2424 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/4783c1f49cb4_create_distance_table.py
+-rw-r--r--   0 root         (0) root         (0)     1666 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/49a21b4d4357_create_index_on_table_tokens.py
+-rw-r--r--   0 root         (0) root         (0)     1585 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/4a2cbedda8b9_add_source_replica_expression_column_to_.py
+-rw-r--r--   0 root         (0) root         (0)     2008 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/4a7182d9578b_added_bytes_length_accessed_at_columns.py
+-rw-r--r--   0 root         (0) root         (0)     1272 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/4bab9edd01fc_create_index_on_requests_rule_id.py
+-rw-r--r--   0 root         (0) root         (0)     2757 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/4c3a4acfe006_new_attr_account_table.py
+-rw-r--r--   0 root         (0) root         (0)     1598 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/4cf0a2e127d4_adding_transient_metadata.py
+-rw-r--r--   0 root         (0) root         (0)     2476 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/4df2c5ddabc0_remove_temporary_dids.py
+-rw-r--r--   0 root         (0) root         (0)     1542 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/50280c53117c_add_qos_class_to_rse.py
+-rw-r--r--   0 root         (0) root         (0)     1417 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/52153819589c_add_rse_id_to_replicas_table.py
+-rw-r--r--   0 root         (0) root         (0)     1526 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/52fd9f4916fa_added_activity_to_rules.py
+-rw-r--r--   0 root         (0) root         (0)     1716 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/53b479c3cb0f_fix_did_meta_table_missing_updated_at_.py
+-rw-r--r--   0 root         (0) root         (0)     1829 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/5673b4b6e843_add_wfms_metadata_to_rule_tables.py
+-rw-r--r--   0 root         (0) root         (0)     2363 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/575767d9f89_added_source_history_table.py
+-rw-r--r--   0 root         (0) root         (0)     1701 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/58bff7008037_add_started_at_to_requests.py
+-rw-r--r--   0 root         (0) root         (0)     6101 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/58c8b78301ab_rename_callback_to_message.py
+-rw-r--r--   0 root         (0) root         (0)     2266 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/5f139f77382a_added_child_rule_id_column.py
+-rw-r--r--   0 root         (0) root         (0)     1666 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/688ef1840840_adding_did_meta_table.py
+-rw-r--r--   0 root         (0) root         (0)     1969 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/6e572a9bfbf3_add_new_split_container_column_to_rules.py
+-rw-r--r--   0 root         (0) root         (0)     1559 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/70587619328_add_comment_column_for_subscriptions.py
+-rw-r--r--   0 root         (0) root         (0)     1363 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/739064d31565_remove_history_table_pks.py
+-rw-r--r--   0 root         (0) root         (0)     5023 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/7541902bf173_add_didsfollowed_and_followevents_table.py
+-rw-r--r--   0 root         (0) root         (0)     3568 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/7ec22226cdbf_new_replica_state_for_temporary_.py
+-rw-r--r--   0 root         (0) root         (0)     1893 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/810a41685bc1_added_columns_rse_transfer_limits.py
+-rw-r--r--   0 root         (0) root         (0)     1889 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/83f991c63a93_correct_rse_expression_length.py
+-rw-r--r--   0 root         (0) root         (0)     1661 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/8523998e2e76_increase_size_of_extended_attributes_.py
+-rw-r--r--   0 root         (0) root         (0)     2147 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/8ea9122275b1_adding_missing_function_based_indices.py
+-rw-r--r--   0 root         (0) root         (0)     1715 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/90f47792bb76_add_clob_payload_to_messages.py
+-rw-r--r--   0 root         (0) root         (0)     3118 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/914b8f02df38_new_table_for_lifetime_model_exceptions.py
+-rw-r--r--   0 root         (0) root         (0)     1749 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/94a5961ddbf2_add_estimator_columns.py
+-rw-r--r--   0 root         (0) root         (0)     5038 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/9a1b149a2044_add_saml_identity_type.py
+-rw-r--r--   0 root         (0) root         (0)     1938 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/9a45bc4ea66d_add_vp_table.py
+-rw-r--r--   0 root         (0) root         (0)     3689 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/9eb936a81eb1_true_is_true.py
+-rw-r--r--   0 root         (0) root         (0)     2614 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/a08fa8de1545_transfer_stats_table.py
+-rw-r--r--   0 root         (0) root         (0)     3117 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/a118956323f8_added_vo_table_and_vo_col_to_rse.py
+-rw-r--r--   0 root         (0) root         (0)     1730 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/a193a275255c_add_status_column_in_messages.py
+-rw-r--r--   0 root         (0) root         (0)     5836 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/a5f6f6e928a7_1_7_0.py
+-rw-r--r--   0 root         (0) root         (0)     2595 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/a616581ee47_added_columns_to_table_requests.py
+-rw-r--r--   0 root         (0) root         (0)     2195 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/a6eb23955c28_state_idx_non_functional.py
+-rw-r--r--   0 root         (0) root         (0)     2173 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/a74275a1ad30_added_global_quota_table.py
+-rw-r--r--   0 root         (0) root         (0)     2726 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/a93e4e47bda_heartbeats.py
+-rw-r--r--   0 root         (0) root         (0)     1883 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/ae2a56fcc89_added_comment_column_to_rules.py
+-rw-r--r--   0 root         (0) root         (0)     1546 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/b4293a99f344_added_column_identity_to_table_tokens.py
+-rw-r--r--   0 root         (0) root         (0)     5407 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/b7d287de34fd_removal_of_replicastate_source.py
+-rw-r--r--   0 root         (0) root         (0)     1348 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/b818052fa670_add_index_to_quarantined_replicas.py
+-rw-r--r--   0 root         (0) root         (0)     1585 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/b8caac94d7f0_add_comments_column_for_subscriptions_.py
+-rw-r--r--   0 root         (0) root         (0)     7344 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/b96a1c7e1cc4_new_bad_pfns_table_and_bad_replicas_.py
+-rw-r--r--   0 root         (0) root         (0)     3704 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/bb695f45c04_extend_request_state.py
+-rw-r--r--   0 root         (0) root         (0)     2091 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/bc68e9946deb_add_staging_timestamps_to_request.py
+-rw-r--r--   0 root         (0) root         (0)     2934 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/bf3baa1c1474_correct_pk_and_idx_for_history_tables.py
+-rw-r--r--   0 root         (0) root         (0)     2121 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/c0937668555f_add_qos_policy_map_table.py
+-rw-r--r--   0 root         (0) root         (0)     1530 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/c129ccdb2d5_add_lumiblocknr_to_dids.py
+-rw-r--r--   0 root         (0) root         (0)     2784 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/ccdbcd48206e_add_did_type_column_index_on_did_meta_.py
+-rw-r--r--   0 root         (0) root         (0)     1747 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/cebad904c4dd_new_payload_column_for_heartbeats.py
+-rw-r--r--   0 root         (0) root         (0)     9561 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/d1189a09c6e0_oauth2_0_and_jwt_feature_support_adding_.py
+-rw-r--r--   0 root         (0) root         (0)     4748 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/d23453595260_extend_request_state_for_preparer.py
+-rw-r--r--   0 root         (0) root         (0)     1736 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/d6dceb1de2d_added_purge_column_to_rules.py
+-rw-r--r--   0 root         (0) root         (0)     1594 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/d6e2c3b2cf26_remove_third_party_copy_column_from_rse.py
+-rw-r--r--   0 root         (0) root         (0)     5263 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/d91002c5841_new_account_limits_table.py
+-rw-r--r--   0 root         (0) root         (0)     2429 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/e138c364ebd0_extending_columns_for_filter_and_.py
+-rw-r--r--   0 root         (0) root         (0)     4865 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/e59300c8b179_support_for_archive.py
+-rw-r--r--   0 root         (0) root         (0)      897 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/f1b14a8c2ac1_postgres_use_check_constraints.py
+-rw-r--r--   0 root         (0) root         (0)     2947 2024-03-21 13:32:52.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/f41ffe206f37_oracle_global_temporary_tables.py
+-rw-r--r--   0 root         (0) root         (0)     1949 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/f85a2962b021_adding_transfertool_column_to_requests_.py
+-rw-r--r--   0 root         (0) root         (0)     1617 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/fa7a7d78b602_increase_refresh_token_size.py
+-rw-r--r--   0 root         (0) root         (0)     1110 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/fb28a95fe288_add_replicas_rse_id_tombstone_idx.py
+-rw-r--r--   0 root         (0) root         (0)     1896 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/fe1a65b176c9_set_third_party_copy_read_and_write_.py
+-rw-r--r--   0 root         (0) root         (0)     1599 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/fe8ea2fa9788_added_third_party_copy_column_to_rse_.py
+-rw-r--r--   0 root         (0) root         (0)   112135 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/models.py
+-rw-r--r--   0 root         (0) root         (0)     1658 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/sautils.py
+-rw-r--r--   0 root         (0) root         (0)    17773 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/session.py
+-rw-r--r--   0 root         (0) root         (0)     6088 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/types.py
+-rw-r--r--   0 root         (0) root         (0)    21427 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/db/sqla/util.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.164252 rucio-34.1.0/lib/rucio/rse/
+-rw-r--r--   0 root         (0) root         (0)     3303 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/rse/__init__.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.167252 rucio-34.1.0/lib/rucio/rse/protocols/
+-rw-r--r--   0 root         (0) root         (0)      618 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/rse/protocols/__init__.py
+-rw-r--r--   0 root         (0) root         (0)     7198 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/rse/protocols/bittorrent.py
+-rw-r--r--   0 root         (0) root         (0)     4603 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/rse/protocols/cache.py
+-rw-r--r--   0 root         (0) root         (0)     4225 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/rse/protocols/dummy.py
+-rw-r--r--   0 root         (0) root         (0)    29093 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/rse/protocols/gfal.py
+-rw-r--r--   0 root         (0) root         (0)     9680 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/rse/protocols/globus.py
+-rw-r--r--   0 root         (0) root         (0)     3409 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/rse/protocols/gsiftp.py
+-rw-r--r--   0 root         (0) root         (0)     2975 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/rse/protocols/http_cache.py
+-rw-r--r--   0 root         (0) root         (0)     4495 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/rse/protocols/mock.py
+-rw-r--r--   0 root         (0) root         (0)     7224 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/rse/protocols/ngarc.py
+-rw-r--r--   0 root         (0) root         (0)    10394 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/rse/protocols/posix.py
+-rw-r--r--   0 root         (0) root         (0)    22650 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/rse/protocols/protocol.py
+-rw-r--r--   0 root         (0) root         (0)    15256 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/rse/protocols/rclone.py
+-rw-r--r--   0 root         (0) root         (0)     5499 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/rse/protocols/rfio.py
+-rw-r--r--   0 root         (0) root         (0)    14651 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/rse/protocols/srm.py
+-rw-r--r--   0 root         (0) root         (0)    17467 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/rse/protocols/ssh.py
+-rw-r--r--   0 root         (0) root         (0)     8127 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/rse/protocols/storm.py
+-rw-r--r--   0 root         (0) root         (0)    22166 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/rse/protocols/webdav.py
+-rw-r--r--   0 root         (0) root         (0)    12567 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/rse/protocols/xrootd.py
+-rw-r--r--   0 root         (0) root         (0)    37238 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/rse/rsemanager.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.167252 rucio-34.1.0/lib/rucio/tests/
+-rw-r--r--   0 root         (0) root         (0)      618 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/tests/__init__.py
+-rw-r--r--   0 root         (0) root         (0)     7837 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/tests/common.py
+-rw-r--r--   0 root         (0) root         (0)     5045 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/tests/common_server.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.169252 rucio-34.1.0/lib/rucio/transfertool/
+-rw-r--r--   0 root         (0) root         (0)      618 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/transfertool/__init__.py
+-rw-r--r--   0 root         (0) root         (0)     8299 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/transfertool/bittorrent.py
+-rw-r--r--   0 root         (0) root         (0)     1711 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/transfertool/bittorrent_driver.py
+-rw-r--r--   0 root         (0) root         (0)     4940 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/transfertool/bittorrent_driver_qbittorrent.py
+-rw-r--r--   0 root         (0) root         (0)    72072 2024-04-02 11:45:21.000000 rucio-34.1.0/lib/rucio/transfertool/fts3.py
+-rw-r--r--   0 root         (0) root         (0)     6136 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/transfertool/fts3_plugins.py
+-rw-r--r--   0 root         (0) root         (0)     7656 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/transfertool/globus.py
+-rw-r--r--   0 root         (0) root         (0)     8411 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/transfertool/globus_library.py
+-rw-r--r--   0 root         (0) root         (0)     2859 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/transfertool/mock.py
+-rw-r--r--   0 root         (0) root         (0)     7753 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/transfertool/transfertool.py
+-rw-r--r--   0 root         (0) root         (0)      244 2024-04-02 11:50:17.000000 rucio-34.1.0/lib/rucio/vcsversion.py
+-rw-r--r--   0 root         (0) root         (0)     1549 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/version.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.169252 rucio-34.1.0/lib/rucio/web/
+-rw-r--r--   0 root         (0) root         (0)      618 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/web/__init__.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.170252 rucio-34.1.0/lib/rucio/web/rest/
+-rwxr-xr-x   0 root         (0) root         (0)      618 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/web/rest/__init__.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.170252 rucio-34.1.0/lib/rucio/web/rest/flaskapi/
+-rw-r--r--   0 root         (0) root         (0)      618 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/web/rest/flaskapi/__init__.py
+-rw-r--r--   0 root         (0) root         (0)      999 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/web/rest/flaskapi/authenticated_bp.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.176252 rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/
+-rw-r--r--   0 root         (0) root         (0)      618 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/__init__.py
+-rw-r--r--   0 root         (0) root         (0)     7790 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/accountlimits.py
+-rw-r--r--   0 root         (0) root         (0)    36983 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/accounts.py
+-rw-r--r--   0 root         (0) root         (0)     3344 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/archives.py
+-rw-r--r--   0 root         (0) root         (0)    61575 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/auth.py
+-rw-r--r--   0 root         (0) root         (0)    16147 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/common.py
+-rw-r--r--   0 root         (0) root         (0)    10143 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/config.py
+-rw-r--r--   0 root         (0) root         (0)     7718 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/credentials.py
+-rw-r--r--   0 root         (0) root         (0)    80863 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/dids.py
+-rw-r--r--   0 root         (0) root         (0)     4706 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/dirac.py
+-rw-r--r--   0 root         (0) root         (0)     2656 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/export.py
+-rw-r--r--   0 root         (0) root         (0)     4620 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/heartbeats.py
+-rw-r--r--   0 root         (0) root         (0)     7894 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/identities.py
+-rw-r--r--   0 root         (0) root         (0)     5257 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/import.py
+-rw-r--r--   0 root         (0) root         (0)    12007 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/lifetime_exceptions.py
+-rw-r--r--   0 root         (0) root         (0)    12990 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/locks.py
+-rw-r--r--   0 root         (0) root         (0)     2861 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/main.py
+-rw-r--r--   0 root         (0) root         (0)     7784 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/meta_conventions.py
+-rw-r--r--   0 root         (0) root         (0)     1250 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/metrics.py
+-rw-r--r--   0 root         (0) root         (0)     3131 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/nongrid_traces.py
+-rw-r--r--   0 root         (0) root         (0)     3096 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/ping.py
+-rw-r--r--   0 root         (0) root         (0)    13331 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/redirect.py
+-rw-r--r--   0 root         (0) root         (0)    72710 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/replicas.py
+-rw-r--r--   0 root         (0) root         (0)    41600 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/requests.py
+-rw-r--r--   0 root         (0) root         (0)    81945 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/rses.py
+-rw-r--r--   0 root         (0) root         (0)    31870 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/rules.py
+-rw-r--r--   0 root         (0) root         (0)     5068 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/scopes.py
+-rw-r--r--   0 root         (0) root         (0)    24149 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/subscriptions.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.177252 rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/templates/
+-rw-r--r--   0 root         (0) root         (0)     2254 2023-07-27 12:40:37.000000 rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/templates/auth_crash.html
+-rw-r--r--   0 root         (0) root         (0)     2139 2023-07-27 12:40:37.000000 rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/templates/auth_granted.html
+-rw-r--r--   0 root         (0) root         (0)     3213 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/traces.py
+-rw-r--r--   0 root         (0) root         (0)     9154 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/vos.py
+-rw-r--r--   0 root         (0) root         (0)      725 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/web/rest/main.py
+-rw-r--r--   0 root         (0) root         (0)     1016 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/web/rest/metrics.py
+-rw-r--r--   0 root         (0) root         (0)     1010 2024-03-21 13:32:51.000000 rucio-34.1.0/lib/rucio/web/rest/ping.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.194252 rucio-34.1.0/lib/rucio.egg-info/
+-rw-r--r--   0 root         (0) root         (0)    25997 2024-04-02 13:57:05.000000 rucio-34.1.0/lib/rucio.egg-info/SOURCES.txt
+-rw-r--r--   0 root         (0) root         (0)    16384 2024-03-13 10:19:28.000000 rucio-34.1.0/pylintrc
+-rw-r--r--   0 root         (0) root         (0)     1235 2024-03-21 13:32:52.000000 rucio-34.1.0/pyproject.toml
+-rw-r--r--   0 root         (0) root         (0)     5048 2024-03-19 15:04:29.000000 rucio-34.1.0/requirements.txt
+-rw-r--r--   0 root         (0) root         (0)      206 2024-04-02 13:57:05.199252 rucio-34.1.0/setup.cfg
+-rw-r--r--   0 root         (0) root         (0)     2932 2024-04-02 13:57:01.000000 rucio-34.1.0/setup.py
+-rw-r--r--   0 root         (0) root         (0)     4778 2024-03-21 13:32:51.000000 rucio-34.1.0/setuputil.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.194252 rucio-34.1.0/tests/
+-rw-r--r--   0 root         (0) root         (0)     3682 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_abacus_account.py
+-rw-r--r--   0 root         (0) root         (0)    10677 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_abacus_collection_replica.py
+-rw-r--r--   0 root         (0) root         (0)     3229 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_abacus_rse.py
+-rw-r--r--   0 root         (0) root         (0)    15920 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_account.py
+-rw-r--r--   0 root         (0) root         (0)     9811 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_account_limits.py
+-rw-r--r--   0 root         (0) root         (0)    20523 2024-04-02 11:36:32.000000 rucio-34.1.0/tests/test_api_external_representation.py
+-rw-r--r--   0 root         (0) root         (0)    13352 2024-03-21 13:32:51.000000 rucio-34.1.0/tests/test_archive.py
+-rw-r--r--   0 root         (0) root         (0)     4074 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_auditor.py
+-rw-r--r--   0 root         (0) root         (0)     2181 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_auditor_hdfs.py
+-rw-r--r--   0 root         (0) root         (0)     4201 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_auditor_srmdumps.py
+-rw-r--r--   0 root         (0) root         (0)    15058 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_authentication.py
+-rw-r--r--   0 root         (0) root         (0)     3464 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_automatix.py
+-rw-r--r--   0 root         (0) root         (0)    23264 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_bad_replica.py
+-rw-r--r--   0 root         (0) root         (0)    12425 2024-04-02 11:36:32.000000 rucio-34.1.0/tests/test_bb8.py
+-rw-r--r--   0 root         (0) root         (0)     6947 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_belleii.py
+-rwxr-xr-x   0 root         (0) root         (0)   107413 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_bin_rucio.py
+-rw-r--r--   0 root         (0) root         (0)     2065 2024-03-21 13:32:51.000000 rucio-34.1.0/tests/test_boolean.py
+-rw-r--r--   0 root         (0) root         (0)     6929 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_clients.py
+-rw-r--r--   0 root         (0) root         (0)     1865 2024-03-21 13:32:51.000000 rucio-34.1.0/tests/test_common_types.py
+-rw-r--r--   0 root         (0) root         (0)     6942 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_config.py
+-rw-r--r--   0 root         (0) root         (0)    96558 2024-04-02 11:36:32.000000 rucio-34.1.0/tests/test_conveyor.py
+-rw-r--r--   0 root         (0) root         (0)    23797 2024-04-02 11:36:32.000000 rucio-34.1.0/tests/test_conveyor_submitter.py
+-rw-r--r--   0 root         (0) root         (0)     6947 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_counter.py
+-rw-r--r--   0 root         (0) root         (0)     7679 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_credential.py
+-rw-r--r--   0 root         (0) root         (0)     7337 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_curl.py
+-rw-r--r--   0 root         (0) root         (0)     2618 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_daemons.py
+-rw-r--r--   0 root         (0) root         (0)    28187 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_dataset_replicas.py
+-rw-r--r--   0 root         (0) root         (0)     2736 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_db.py
+-rw-r--r--   0 root         (0) root         (0)    58823 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_did.py
+-rw-r--r--   0 root         (0) root         (0)    29517 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_did_meta_plugins.py
+-rw-r--r--   0 root         (0) root         (0)     4185 2024-03-21 13:32:51.000000 rucio-34.1.0/tests/test_didtype.py
+-rw-r--r--   0 root         (0) root         (0)    35315 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_download.py
+-rw-r--r--   0 root         (0) root         (0)     7118 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_dumper.py
+-rw-r--r--   0 root         (0) root         (0)    16419 2024-03-21 13:32:51.000000 rucio-34.1.0/tests/test_dumper_consistency.py
+-rw-r--r--   0 root         (0) root         (0)    10867 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_dumper_data_model.py
+-rw-r--r--   0 root         (0) root         (0)     3082 2024-03-21 13:32:51.000000 rucio-34.1.0/tests/test_dumper_path_parsing.py
+-rw-r--r--   0 root         (0) root         (0)    38301 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_filter_engine.py
+-rw-r--r--   0 root         (0) root         (0)     7953 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_heartbeat.py
+-rw-r--r--   0 root         (0) root         (0)    10106 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_hermes.py
+-rw-r--r--   0 root         (0) root         (0)     5819 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_identity.py
+-rw-r--r--   0 root         (0) root         (0)    18584 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_impl_upload_download.py
+-rw-r--r--   0 root         (0) root         (0)    57223 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_import_export.py
+-rw-r--r--   0 root         (0) root         (0)     5258 2024-04-02 11:36:32.000000 rucio-34.1.0/tests/test_judge_cleaner.py
+-rw-r--r--   0 root         (0) root         (0)    22277 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_judge_evaluator.py
+-rw-r--r--   0 root         (0) root         (0)    11050 2024-04-02 11:36:32.000000 rucio-34.1.0/tests/test_judge_injector.py
+-rw-r--r--   0 root         (0) root         (0)    20428 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_judge_repairer.py
+-rw-r--r--   0 root         (0) root         (0)    12180 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_lifetime.py
+-rw-r--r--   0 root         (0) root         (0)     5855 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_message.py
+-rw-r--r--   0 root         (0) root         (0)     6299 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_meta_conventions.py
+-rw-r--r--   0 root         (0) root         (0)     1766 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_meta_did.py
+-rw-r--r--   0 root         (0) root         (0)      957 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_module_import.py
+-rw-r--r--   0 root         (0) root         (0)     2034 2024-03-21 13:32:51.000000 rucio-34.1.0/tests/test_monitor.py
+-rw-r--r--   0 root         (0) root         (0)    54264 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_multi_vo.py
+-rw-r--r--   0 root         (0) root         (0)     2759 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_naming_convention.py
+-rw-r--r--   0 root         (0) root         (0)    11582 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_oauthmanager.py
+-rw-r--r--   0 root         (0) root         (0)   108356 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_oidc.py
+-rw-r--r--   0 root         (0) root         (0)     4484 2024-03-21 13:32:51.000000 rucio-34.1.0/tests/test_permission.py
+-rw-r--r--   0 root         (0) root         (0)     4123 2024-03-21 13:32:51.000000 rucio-34.1.0/tests/test_pfns.py
+-rw-r--r--   0 root         (0) root         (0)     1141 2024-03-21 13:32:51.000000 rucio-34.1.0/tests/test_ping.py
+-rw-r--r--   0 root         (0) root         (0)     7583 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_preparer.py
+-rw-r--r--   0 root         (0) root         (0)     2741 2024-03-21 13:32:51.000000 rucio-34.1.0/tests/test_qos.py
+-rw-r--r--   0 root         (0) root         (0)     2023 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_quarantined_replica.py
+-rw-r--r--   0 root         (0) root         (0)    27487 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_reaper.py
+-rw-r--r--   0 root         (0) root         (0)     6440 2024-03-21 13:32:51.000000 rucio-34.1.0/tests/test_redirect.py
+-rw-r--r--   0 root         (0) root         (0)    62385 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_replica.py
+-rw-r--r--   0 root         (0) root         (0)    38873 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_replica_recoverer.py
+-rw-r--r--   0 root         (0) root         (0)    22741 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_replica_sorting.py
+-rw-r--r--   0 root         (0) root         (0)    17184 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_request.py
+-rw-r--r--   0 root         (0) root         (0)    12978 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_root_proxy.py
+-rw-r--r--   0 root         (0) root         (0)    75019 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_rse.py
+-rw-r--r--   0 root         (0) root         (0)    13184 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_rse_expression_parser.py
+-rw-r--r--   0 root         (0) root         (0)     8941 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_rse_lfn2path.py
+-rw-r--r--   0 root         (0) root         (0)     4277 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_rse_protocol_gfal2.py
+-rw-r--r--   0 root         (0) root         (0)     3822 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_rse_protocol_gfal2_impl.py
+-rw-r--r--   0 root         (0) root         (0)     3267 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_rse_protocol_posix.py
+-rw-r--r--   0 root         (0) root         (0)     3690 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_rse_protocol_rclone.py
+-rw-r--r--   0 root         (0) root         (0)     4799 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_rse_protocol_rsync.py
+-rw-r--r--   0 root         (0) root         (0)     3979 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_rse_protocol_srm.py
+-rw-r--r--   0 root         (0) root         (0)     4655 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_rse_protocol_ssh.py
+-rw-r--r--   0 root         (0) root         (0)     3015 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_rse_protocol_webdav.py
+-rw-r--r--   0 root         (0) root         (0)     3780 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_rse_protocol_xrootd.py
+-rw-r--r--   0 root         (0) root         (0)     7746 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_rse_selector.py
+-rw-r--r--   0 root         (0) root         (0)      867 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_rucio_server.py
+-rw-r--r--   0 root         (0) root         (0)    91864 2024-04-02 11:36:32.000000 rucio-34.1.0/tests/test_rule.py
+-rw-r--r--   0 root         (0) root         (0)    13848 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_schema_cms.py
+-rw-r--r--   0 root         (0) root         (0)     7486 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_scope.py
+-rw-r--r--   0 root         (0) root         (0)    48328 2024-04-02 11:36:32.000000 rucio-34.1.0/tests/test_subscription.py
+-rw-r--r--   0 root         (0) root         (0)    55587 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_throttler.py
+-rw-r--r--   0 root         (0) root         (0)     5011 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_tpc.py
+-rw-r--r--   0 root         (0) root         (0)     3181 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_trace.py
+-rw-r--r--   0 root         (0) root         (0)    25254 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_transfer.py
+-rw-r--r--   0 root         (0) root         (0)     8923 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_transfer_plugins.py
+-rw-r--r--   0 root         (0) root         (0)     8412 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_undertaker.py
+-rw-r--r--   0 root         (0) root         (0)    15526 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_upload.py
+-rw-r--r--   0 root         (0) root         (0)     7427 2024-03-21 13:32:52.000000 rucio-34.1.0/tests/test_utils.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2024-04-02 13:57:05.194252 rucio-34.1.0/tools/
+-rwxr-xr-x   0 root         (0) root         (0)     1259 2024-03-21 13:32:51.000000 rucio-34.1.0/tools/bootstrap.py
+-rw-r--r--   0 root         (0) root         (0)     6163 2024-03-21 13:32:51.000000 rucio-34.1.0/tools/merge_rucio_configs.py
+-rwxr-xr-x   0 root         (0) root         (0)     1351 2024-03-21 13:32:51.000000 rucio-34.1.0/tools/reset_database.py
```

### Comparing `rucio-34.0.0rc2/AUTHORS.rst` & `rucio-34.1.0/AUTHORS.rst`

 * *Files identical despite different names*

### Comparing `rucio-34.0.0rc2/LICENSE` & `rucio-34.1.0/LICENSE`

 * *Files identical despite different names*

### Comparing `rucio-34.0.0rc2/MANIFEST.in` & `rucio-34.1.0/MANIFEST.in`

 * *Files identical despite different names*

### Comparing `rucio-34.0.0rc2/PKG-INFO` & `rucio-34.1.0/PKG-INFO`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: rucio
-Version: 34.0.0rc2
+Version: 34.1.0
 Summary: Rucio Package
 Home-page: https://rucio.cern.ch/
 Author: Rucio
 Author-email: rucio-dev@cern.ch
 License: Apache License, Version 2.0
 Classifier: Development Status :: 5 - Production/Stable
 Classifier: License :: OSI Approved :: Apache Software License
```

### Comparing `rucio-34.0.0rc2/README.rst` & `rucio-34.1.0/README.rst`

 * *Files identical despite different names*

### Comparing `rucio-34.0.0rc2/bin/rucio` & `rucio-34.1.0/bin/rucio`

 * *Files 0% similar despite different names*

```diff
@@ -1,9 +1,8 @@
 #!/usr/bin/env python
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -23,35 +22,48 @@
 import signal
 import subprocess
 import sys
 import time
 import traceback
 import unittest
 import uuid
+from configparser import NoOptionError, NoSectionError
 from copy import deepcopy
 from datetime import datetime
 from functools import wraps
 
-from configparser import NoOptionError, NoSectionError
 from tabulate import tabulate
 
 # rucio module has the same name as this executable module, so this rule fails. pylint: disable=no-name-in-module
 from rucio import version
 from rucio.client import Client
 from rucio.common.config import config_get, config_get_float
-from rucio.common.exception import (DataIdentifierAlreadyExists, AccessDenied, DataIdentifierNotFound, InvalidObject,
-                                    RSENotFound, InvalidRSEExpression, InputValidationError, DuplicateContent,
-                                    RuleNotFound, CannotAuthenticate, MissingDependency, UnsupportedOperation,
-                                    RucioException, DuplicateRule, InvalidType, DuplicateCriteriaInDIDFilter,
-                                    DIDFilterSyntaxError)
+from rucio.common.constants import ReplicaState
+from rucio.common.exception import (
+    AccessDenied,
+    CannotAuthenticate,
+    DataIdentifierAlreadyExists,
+    DataIdentifierNotFound,
+    DIDFilterSyntaxError,
+    DuplicateContent,
+    DuplicateCriteriaInDIDFilter,
+    DuplicateRule,
+    InputValidationError,
+    InvalidObject,
+    InvalidRSEExpression,
+    InvalidType,
+    MissingDependency,
+    RSENotFound,
+    RucioException,
+    RuleNotFound,
+    UnsupportedOperation,
+)
 from rucio.common.extra import import_extras
 from rucio.common.test_rucio_server import TestRucioServer
-from rucio.common.utils import sizefmt, Color, detect_client_location, chunks, parse_did_filter_from_string, \
-    parse_did_filter_from_string_fe, extract_scope, setup_logger, StoreAndDeprecateWarningAction
-from rucio.common.constants import ReplicaState
+from rucio.common.utils import Color, StoreAndDeprecateWarningAction, chunks, detect_client_location, extract_scope, parse_did_filter_from_string, parse_did_filter_from_string_fe, setup_logger, sizefmt
 
 EXTRA_MODULES = import_extras(['argcomplete'])
 
 if EXTRA_MODULES['argcomplete']:
     import argcomplete  # pylint: disable=E0401
 
 SUCCESS = 0
@@ -484,15 +496,15 @@
     if args.fromfile:
         if len(dids) > 1:
             logger.error("If --fromfile option is active, only one file is supported. The file should contain a list of dids, one per line.")
             return FAILURE
         try:
             f = open(dids[0], 'r')
             dids = [did.rstrip() for did in f.readlines()]
-        except IOError:
+        except OSError:
             logger.error("Can't open file '" + dids[0] + "'.")
             return FAILURE
 
     dids = [{'scope': get_scope(did, client)[0], 'name': get_scope(did, client)[1]} for did in dids]
     if len(dids) <= limit:
         client.attach_dids(scope=scope, name=name, dids=dids)
     else:
@@ -1330,17 +1342,14 @@
 @exception_handler
 def info_rule(args):
     """
     %(prog)s rule-info [options] <ruleid>
 
     Retrieve information about a rule.
     """
-    if args.estimate_ttc:
-        logger.error('"--estimate-ttc" is deprecated!')
-        return FAILURE
     client = get_client(args)
     if args.examine:
         analysis = client.examine_replication_rule(rule_id=args.rule_id)
         print('Status of the replication rule: %s' % analysis['rule_error'])
         if analysis['transfers']:
             print('STUCK Requests:')
             for transfer in analysis['transfers']:
@@ -2348,15 +2357,14 @@
     delete_rule_parser.add_argument('--account', dest='rule_account', action='store', help='The account of the rule that must be deleted')
 
     # Info replication rule subparser
     info_rule_parser = subparsers.add_parser('rule-info', help='Retrieve information about a rule.')
     info_rule_parser.set_defaults(function=info_rule)
     info_rule_parser.add_argument(dest='rule_id', action='store', help='The rule ID')
     info_rule_parser.add_argument('--examine', dest='examine', action='store_true', help='Detailed analysis of transfer errors')
-    info_rule_parser.add_argument('--estimate-ttc', dest='estimate_ttc', action='store_true', help='Deprecated, specifying this will cause the program to fail.')
 
     # The list_rules command
     list_rules_parser = subparsers.add_parser('list-rules', help='List replication rules.', formatter_class=argparse.RawDescriptionHelpFormatter, epilog='''Usage example
 """""""""""""
 
 You can list the rules for a particular DID::
```

### Comparing `rucio-34.0.0rc2/bin/rucio-abacus-account` & `rucio-34.1.0/bin/rucio-abacus-account`

 * *Files 5% similar despite different names*

```diff
@@ -1,9 +1,8 @@
 #!/usr/bin/env python3
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/bin/rucio-abacus-collection-replica` & `rucio-34.1.0/bin/rucio-abacus-collection-replica`

 * *Files 6% similar despite different names*

```diff
@@ -1,9 +1,8 @@
 #!/usr/bin/env python3
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/bin/rucio-abacus-rse` & `rucio-34.1.0/bin/rucio-abacus-rse`

 * *Files 1% similar despite different names*

```diff
@@ -1,9 +1,8 @@
 #!/usr/bin/env python3
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/bin/rucio-admin` & `rucio-34.1.0/bin/rucio-admin`

 * *Files 0% similar despite different names*

```diff
@@ -1,9 +1,8 @@
 #!/usr/bin/env python
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -21,33 +20,44 @@
 import logging
 import math
 import os
 import signal
 import sys
 import time
 import traceback
-from textwrap import dedent
+from configparser import NoOptionError, NoSectionError
 from functools import wraps
+from textwrap import dedent
 
-from configparser import NoOptionError, NoSectionError
 from tabulate import tabulate
 
 from rucio import version
 from rucio.client import Client
 from rucio.common.config import config_get
-from rucio.common.exception import (AccountNotFound, DataIdentifierAlreadyExists, AccessDenied,
-                                    DataIdentifierNotFound, InvalidObject, ReplicaNotFound,
-                                    RSENotFound, RSEOperationNotSupported, InvalidRSEExpression,
-                                    DuplicateContent, RuleNotFound, CannotAuthenticate,
-                                    Duplicate, ReplicaIsLocked, ConfigNotFound, ScopeNotFound,
-                                    InputValidationError)
+from rucio.common.exception import (
+    AccessDenied,
+    AccountNotFound,
+    CannotAuthenticate,
+    ConfigNotFound,
+    DataIdentifierAlreadyExists,
+    DataIdentifierNotFound,
+    Duplicate,
+    DuplicateContent,
+    InputValidationError,
+    InvalidObject,
+    InvalidRSEExpression,
+    ReplicaIsLocked,
+    ReplicaNotFound,
+    RSENotFound,
+    RSEOperationNotSupported,
+    RuleNotFound,
+    ScopeNotFound,
+)
 from rucio.common.extra import import_extras
-from rucio.common.utils import (chunks, construct_surl, sizefmt, get_bytes_value_from_string,
-                                render_json, parse_response, extract_scope, clean_surls,
-                                StoreAndDeprecateWarningAction)
+from rucio.common.utils import StoreAndDeprecateWarningAction, chunks, clean_surls, construct_surl, extract_scope, get_bytes_value_from_string, parse_response, render_json, sizefmt
 from rucio.rse import rsemanager as rsemgr
 
 EXTRA_MODULES = import_extras(['argcomplete'])
 
 if EXTRA_MODULES['argcomplete']:
     import argcomplete  # pylint: disable=E0401
 
@@ -1273,15 +1283,15 @@
         with open(import_file_path) as import_file:
             data_string = import_file.read()
             data = parse_response(data_string)
     except ValueError as error:
         print('There was problem with decoding your file.')
         print(error)
         return FAILURE
-    except IOError as error:
+    except OSError as error:
         print('There was a problem with reading your file.')
         print(error)
         return FAILURE
 
     if data:
         client.import_data(data)
         print('Data successfully imported.')
@@ -1305,15 +1315,15 @@
     data = client.export_data()
     try:
         with open(destination_file_path, 'w+') as destination_file:
             destination_file.write(render_json(**data))
             print('File successfully written.')
         print('Data successfully exported to %s' % args.file_path)
         return SUCCESS
-    except IOError as error:
+    except OSError as error:
         print('There was a problem with reading your file.')
         print(error)
         return FAILURE
 
 
 @exception_handler
 def set_tombstone(args):
```

### Comparing `rucio-34.0.0rc2/bin/rucio-atropos` & `rucio-34.1.0/bin/rucio-atropos`

 * *Files 4% similar despite different names*

```diff
@@ -1,9 +1,8 @@
 #!/usr/bin/env python3
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/bin/rucio-auditor` & `rucio-34.1.0/bin/rucio-auditor`

 * *Files 2% similar despite different names*

```diff
@@ -1,9 +1,8 @@
 #!/usr/bin/env python3
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -20,15 +19,15 @@
 import os
 import signal
 import sys
 import textwrap
 import time
 from datetime import datetime
 from functools import partial
-from multiprocessing import Queue, Process, Event, Pipe
+from multiprocessing import Event, Pipe, Process, Queue
 
 import rucio.common.config as config
 import rucio.common.dumper as dumper
 import rucio.daemons.auditor
 from rucio.client.rseclient import RSEClient
```

### Comparing `rucio-34.0.0rc2/bin/rucio-automatix` & `rucio-34.1.0/bin/rucio-automatix`

 * *Files 2% similar despite different names*

```diff
@@ -1,9 +1,8 @@
 #!/usr/bin/env python3
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/bin/rucio-bb8` & `rucio-34.1.0/bin/rucio-bb8`

 * *Files 5% similar despite different names*

```diff
@@ -1,9 +1,8 @@
 #!/usr/bin/env python3
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/bin/rucio-c3po` & `rucio-34.1.0/bin/rucio-c3po`

 * *Files 1% similar despite different names*

```diff
@@ -1,9 +1,8 @@
 #!/usr/bin/env python3
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/bin/rucio-cache-client` & `rucio-34.1.0/bin/rucio-cache-client`

 * *Files 2% similar despite different names*

```diff
@@ -1,9 +1,8 @@
 #!/usr/bin/env python3
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/bin/rucio-cache-consumer` & `rucio-34.1.0/bin/rucio-cache-consumer`

 * *Files 7% similar despite different names*

```diff
@@ -1,9 +1,8 @@
 #!/usr/bin/env python3
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/bin/rucio-conveyor-finisher` & `rucio-34.1.0/bin/rucio-conveyor-finisher`

 * *Files 1% similar despite different names*

```diff
@@ -1,9 +1,8 @@
 #!/usr/bin/env python3
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/bin/rucio-conveyor-poller` & `rucio-34.1.0/bin/rucio-conveyor-poller`

 * *Files 4% similar despite different names*

```diff
@@ -1,9 +1,8 @@
 #!/usr/bin/env python3
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/bin/rucio-conveyor-preparer` & `rucio-34.1.0/bin/rucio-conveyor-preparer`

 * *Files 6% similar despite different names*

```diff
@@ -1,9 +1,8 @@
 #!/usr/bin/env python
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/bin/rucio-conveyor-receiver` & `rucio-34.1.0/bin/rucio-conveyor-receiver`

 * *Files 9% similar despite different names*

```diff
@@ -1,9 +1,8 @@
 #!/usr/bin/env python3
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/bin/rucio-conveyor-stager` & `rucio-34.1.0/bin/rucio-conveyor-stager`

 * *Files 2% similar despite different names*

```diff
@@ -1,9 +1,8 @@
 #!/usr/bin/env python3
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/bin/rucio-conveyor-submitter` & `rucio-34.1.0/bin/rucio-conveyor-submitter`

 * *Files 1% similar despite different names*

```diff
@@ -1,9 +1,8 @@
 #!/usr/bin/env python3
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/bin/rucio-conveyor-throttler` & `rucio-34.1.0/bin/rucio-conveyor-throttler`

 * *Files 1% similar despite different names*

```diff
@@ -1,9 +1,8 @@
 #!/usr/bin/env python3
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/bin/rucio-dark-reaper` & `rucio-34.1.0/bin/rucio-dark-reaper`

 * *Files 2% similar despite different names*

```diff
@@ -1,9 +1,8 @@
 #!/usr/bin/env python3
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/bin/rucio-dumper` & `rucio-34.1.0/bin/rucio-dumper`

 * *Files 2% similar despite different names*

```diff
@@ -1,9 +1,8 @@
 #!/usr/bin/env python3
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -14,19 +13,19 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import argparse
 import datetime
 import logging
 import sys
+
 import tabulate
 
 import rucio.common.dumper.consistency as consistency
 import rucio.common.dumper.data_models as data_models
-
 from rucio.common.dumper import error
 
 logger = logging.getLogger('rucio-dumper')
 libs_logger = logging.getLogger('dumper')
 logger.setLevel(logging.WARNING)
 libs_logger.setLevel(logging.WARNING)
 
@@ -126,29 +125,29 @@
             data_dict[key].append(record)
 
         if 'sum' in args and args.sum:
             assert args.sum in set(record_type.get_fieldnames())
             fields.append(args.sum)
             data = []
             for key, value in data_dict.items():
-                total = sum((getattr(x, args.sum) for x in value))
+                total = sum(getattr(x, args.sum) for x in value)
                 # FIXME: Ugly hack to have some result
                 setattr(value[0], args.sum, total)
                 data.append(value[0])
         else:
             data = data_dict.values()
 
     if args.fields:
         _show_fields = args.fields.split(',')
-        if not all((f in fields for f in _show_fields)):
+        if not all(f in fields for f in _show_fields):
             error('Invalid field in --fields argument')
         fields = _show_fields
     elif args.hide:
         _hide_fields = args.hide.split(',')
-        if not all((f in fields for f in _hide_fields)):
+        if not all(f in fields for f in _hide_fields):
             error('Invalid field in --hide argument')
         fields = [f for f in fields if f not in _hide_fields]
 
     if args.csv:
         print(record_type.csv_header(fields))
         for record in data:
             print(record.csv(fields))
```

### Comparing `rucio-34.0.0rc2/bin/rucio-follower` & `rucio-34.1.0/bin/rucio-follower`

 * *Files 10% similar despite different names*

```diff
@@ -1,9 +1,8 @@
 #!/usr/bin/env python3
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/bin/rucio-hermes` & `rucio-34.1.0/bin/rucio-hermes`

 * *Files 2% similar despite different names*

```diff
@@ -1,9 +1,8 @@
 #!/usr/bin/env python3
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/bin/rucio-judge-cleaner` & `rucio-34.1.0/bin/rucio-judge-cleaner`

 * *Files 2% similar despite different names*

```diff
@@ -1,9 +1,8 @@
 #!/usr/bin/env python3
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/bin/rucio-judge-evaluator` & `rucio-34.1.0/bin/rucio-judge-evaluator`

 * *Files 0% similar despite different names*

```diff
@@ -1,9 +1,8 @@
 #!/usr/bin/env python3
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/bin/rucio-judge-injector` & `rucio-34.1.0/bin/rucio-judge-injector`

 * *Files 4% similar despite different names*

```diff
@@ -1,9 +1,8 @@
 #!/usr/bin/env python3
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/bin/rucio-judge-repairer` & `rucio-34.1.0/bin/rucio-judge-repairer`

 * *Files 4% similar despite different names*

```diff
@@ -1,9 +1,8 @@
 #!/usr/bin/env python3
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/bin/rucio-kronos` & `rucio-34.1.0/bin/rucio-kronos`

 * *Files 3% similar despite different names*

```diff
@@ -1,9 +1,8 @@
 #!/usr/bin/env python3
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/bin/rucio-minos` & `rucio-34.1.0/bin/rucio-minos`

 * *Files 6% similar despite different names*

```diff
@@ -1,9 +1,8 @@
 #!/usr/bin/env python3
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/bin/rucio-minos-temporary-expiration` & `rucio-34.1.0/bin/rucio-minos-temporary-expiration`

 * *Files 2% similar despite different names*

```diff
@@ -1,9 +1,8 @@
 #!/usr/bin/env python3
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/bin/rucio-necromancer` & `rucio-34.1.0/bin/rucio-necromancer`

 * *Files 0% similar despite different names*

```diff
@@ -1,9 +1,8 @@
 #!/usr/bin/env python3
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/bin/rucio-oauth-manager` & `rucio-34.1.0/bin/rucio-oauth-manager`

 * *Files 2% similar despite different names*

```diff
@@ -1,9 +1,8 @@
 #!/usr/bin/env python3
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/bin/rucio-reaper` & `rucio-34.1.0/bin/rucio-reaper`

 * *Files 1% similar despite different names*

```diff
@@ -1,9 +1,8 @@
 #!/usr/bin/env python3
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/bin/rucio-replica-recoverer` & `rucio-34.1.0/bin/rucio-replica-recoverer`

 * *Files 1% similar despite different names*

```diff
@@ -1,9 +1,8 @@
 #!/usr/bin/env python3
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/bin/rucio-rse-decommissioner` & `rucio-34.1.0/bin/rucio-rse-decommissioner`

 * *Files 3% similar despite different names*

```diff
@@ -1,9 +1,8 @@
 #!/usr/bin/env python3
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/bin/rucio-storage-consistency-actions` & `rucio-34.1.0/bin/rucio-storage-consistency-actions`

 * *Files 1% similar despite different names*

```diff
@@ -1,9 +1,8 @@
 #!/usr/bin/env python3
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/bin/rucio-transmogrifier` & `rucio-34.1.0/bin/rucio-transmogrifier`

 * *Files 2% similar despite different names*

```diff
@@ -1,9 +1,8 @@
 #!/usr/bin/env python3
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/bin/rucio-undertaker` & `rucio-34.1.0/bin/rucio-undertaker`

 * *Files 2% similar despite different names*

```diff
@@ -1,9 +1,8 @@
 #!/usr/bin/env python3
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/etc/alembic.ini.template` & `rucio-34.1.0/etc/alembic.ini.template`

 * *Files identical despite different names*

### Comparing `rucio-34.0.0rc2/etc/alembic_offline.ini.template` & `rucio-34.1.0/etc/alembic_offline.ini.template`

 * *Files identical despite different names*

### Comparing `rucio-34.0.0rc2/etc/ldap.cfg.template` & `rucio-34.1.0/etc/ldap.cfg.template`

 * *Files identical despite different names*

### Comparing `rucio-34.0.0rc2/etc/mail_templates/rule_approval_request.tmpl` & `rucio-34.1.0/etc/mail_templates/rule_approval_request.tmpl`

 * *Files identical despite different names*

### Comparing `rucio-34.0.0rc2/etc/mail_templates/rule_ok_notification.tmpl` & `rucio-34.1.0/etc/mail_templates/rule_ok_notification.tmpl`

 * *Files identical despite different names*

### Comparing `rucio-34.0.0rc2/etc/rse-accounts.cfg.template` & `rucio-34.1.0/etc/rse-accounts.cfg.template`

 * *Files identical despite different names*

### Comparing `rucio-34.0.0rc2/etc/rucio.cfg.atlas.client.template` & `rucio-34.1.0/etc/rucio.cfg.atlas.client.template`

 * *Files identical despite different names*

### Comparing `rucio-34.0.0rc2/etc/rucio.cfg.template` & `rucio-34.1.0/etc/rucio.cfg.template`

 * *Files identical despite different names*

### Comparing `rucio-34.0.0rc2/etc/rucio_multi_vo.cfg.template` & `rucio-34.1.0/etc/rucio_multi_vo.cfg.template`

 * *Files identical despite different names*

### Comparing `rucio-34.0.0rc2/lib/rucio/__init__.py` & `rucio-34.1.0/lib/rucio/__init__.py`

 * *Files 7% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/alembicrevision.py` & `rucio-34.1.0/lib/rucio/common/constraints.py`

 * *Files 12% similar despite different names*

```diff
@@ -1,16 +1,17 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-ALEMBIC_REVISION = 'a08fa8de1545'  # the current alembic head revision
+# List of authorized value types for key
+AUTHORIZED_VALUE_TYPES = (float, int, str)
+STRING_TYPES = (str, )
```

### Comparing `rucio-34.0.0rc2/lib/rucio/api/__init__.py` & `rucio-34.1.0/lib/rucio/daemons/cache/__init__.py`

 * *Files identical despite different names*

### Comparing `rucio-34.0.0rc2/lib/rucio/api/account.py` & `rucio-34.1.0/lib/rucio/api/account.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/api/account_limit.py` & `rucio-34.1.0/lib/rucio/api/account_limit.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/api/authentication.py` & `rucio-34.1.0/lib/rucio/api/authentication.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/api/config.py` & `rucio-34.1.0/lib/rucio/api/config.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/api/credential.py` & `rucio-34.1.0/lib/rucio/api/credential.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/api/did.py` & `rucio-34.1.0/lib/rucio/api/did.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -19,21 +18,22 @@
 import rucio.api.permission
 from rucio.common.constants import RESERVED_KEYS
 from rucio.common.exception import RucioException
 from rucio.common.schema import validate_schema
 from rucio.common.types import InternalAccount, InternalScope
 from rucio.common.utils import api_update_return_dict
 from rucio.core import did, naming_convention
-from rucio.core.rse import get_rse_id
 from rucio.core import meta_conventions as meta_convention_core
+from rucio.core.rse import get_rse_id
 from rucio.db.sqla.constants import DIDType
 from rucio.db.sqla.session import read_session, stream_session, transactional_session
 
 if TYPE_CHECKING:
-    from typing import Any, Optional
+    from typing import Any, Iterator, Optional
+
     from sqlalchemy.orm import Session
 
 
 @stream_session
 def list_dids(scope, filters, did_type='collection', ignore_case=False, limit=None, offset=None, long=False, recursive=False, vo='def', *, session: "Session"):
     """
     List dids in a scope.
@@ -325,14 +325,32 @@
     dids = did.list_content_history(scope=scope, name=name, session=session)
 
     for d in dids:
         yield api_update_return_dict(d, session=session)
 
 
 @stream_session
+def bulk_list_files(dids: "list[dict[str, Any]]", long: bool = False, vo: str = 'def', *, session: "Session") -> "Iterator[dict[str, Any]]":
+    """
+    List file contents of a list of data identifiers.
+
+    :param dids:       A list of DIDs.
+    :param long:       A boolean to choose if more metadata are returned or not.
+    :param vo:         The VO to act on.
+    :param session:    The database session in use.
+    """
+
+    for did_ in dids:
+        did_['scope'] = InternalScope(did_['scope'], vo=vo)
+
+    for file_ in did.bulk_list_files(dids=dids, long=long, session=session):
+        yield api_update_return_dict(file_, session=session)
+
+
+@stream_session
 def list_files(scope, name, long, vo='def', *, session: "Session"):
     """
     List data identifier file contents.
 
     :param scope: The scope name.
     :param name: The data identifier name.
     :param long:       A boolean to choose if GUID is returned or not.
```

### Comparing `rucio-34.0.0rc2/lib/rucio/api/dirac.py` & `rucio-34.1.0/lib/rucio/api/dirac.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/api/exporter.py` & `rucio-34.1.0/lib/rucio/api/exporter.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/api/heartbeat.py` & `rucio-34.1.0/lib/rucio/api/heartbeat.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/api/identity.py` & `rucio-34.1.0/lib/rucio/api/identity.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -24,14 +23,15 @@
 from rucio.common.types import InternalAccount
 from rucio.core import identity
 from rucio.db.sqla.constants import IdentityType
 from rucio.db.sqla.session import read_session, transactional_session
 
 if TYPE_CHECKING:
     from typing import Optional
+
     from sqlalchemy.orm import Session
 
 
 @transactional_session
 def add_identity(identity_key, id_type, email, password=None, *, session: "Session"):
     """
     Creates a user identity.
```

### Comparing `rucio-34.0.0rc2/lib/rucio/api/importer.py` & `rucio-34.1.0/lib/rucio/api/importer.py`

 * *Files 8% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/api/lifetime_exception.py` & `rucio-34.1.0/lib/rucio/api/lifetime_exception.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/api/lock.py` & `rucio-34.1.0/lib/rucio/api/lock.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/api/meta_conventions.py` & `rucio-34.1.0/lib/rucio/api/meta_conventions.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,32 +1,32 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-from typing import TYPE_CHECKING, Union, Optional
+from typing import TYPE_CHECKING, Optional, Union
 
 from rucio.api.permission import has_permission
 from rucio.common.exception import AccessDenied
 from rucio.core import meta_conventions
-from rucio.db.sqla.session import read_session, transactional_session
 from rucio.db.sqla.constants import KeyType
+from rucio.db.sqla.session import read_session, transactional_session
 
 if TYPE_CHECKING:
     from sqlalchemy.orm import Session
+
     from rucio.common.types import InternalAccount
 
 
 @read_session
 def list_keys(*, session: "Session"):
     """
     Lists all keys for DID Metadata Conventions.
```

### Comparing `rucio-34.0.0rc2/lib/rucio/api/permission.py` & `rucio-34.1.0/lib/rucio/api/permission.py`

 * *Files 3% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/api/quarantined_replica.py` & `rucio-34.1.0/lib/rucio/api/quarantined_replica.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/api/replica.py` & `rucio-34.1.0/lib/rucio/api/replica.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/api/request.py` & `rucio-34.1.0/lib/rucio/api/request.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/api/rse.py` & `rucio-34.1.0/lib/rucio/api/rse.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -22,14 +21,15 @@
 from rucio.core import distance as distance_module
 from rucio.core import rse as rse_module
 from rucio.core.rse_expression_parser import parse_expression
 from rucio.db.sqla.session import read_session, stream_session, transactional_session
 
 if TYPE_CHECKING:
     from typing import Optional
+
     from sqlalchemy.orm import Session
 
 
 @transactional_session
 def add_rse(rse, issuer, vo='def', deterministic=True, volatile=False, city=None, region_code=None,
             country_name=None, continent=None, time_zone=None, ISP=None,
             staging_area=False, rse_type=None, latitude=None, longitude=None, ASN=None,
```

### Comparing `rucio-34.0.0rc2/lib/rucio/api/rule.py` & `rucio-34.1.0/lib/rucio/api/rule.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,23 +1,22 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-from typing import Any, TYPE_CHECKING
+from typing import TYPE_CHECKING, Any
 
 from rucio.api.permission import has_permission
 from rucio.common.config import config_get_bool
 from rucio.common.exception import AccessDenied
 from rucio.common.schema import validate_schema
 from rucio.common.types import InternalAccount, InternalScope
 from rucio.common.utils import api_update_return_dict
```

### Comparing `rucio-34.0.0rc2/lib/rucio/api/scope.py` & `rucio-34.1.0/lib/rucio/api/scope.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/api/subscription.py` & `rucio-34.1.0/lib/rucio/api/subscription.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -14,15 +13,15 @@
 # limitations under the License.
 
 from collections import namedtuple
 from json import dumps, loads
 from typing import TYPE_CHECKING
 
 from rucio.api.permission import has_permission
-from rucio.common.exception import InvalidObject, AccessDenied
+from rucio.common.exception import AccessDenied, InvalidObject
 from rucio.common.schema import validate_schema
 from rucio.common.types import InternalAccount, InternalScope
 from rucio.core import subscription
 from rucio.db.sqla.session import read_session, stream_session, transactional_session
 
 if TYPE_CHECKING:
     from sqlalchemy.orm import Session
```

### Comparing `rucio-34.0.0rc2/lib/rucio/api/vo.py` & `rucio-34.1.0/lib/rucio/api/vo.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/client/__init__.py` & `rucio-34.1.0/lib/rucio/client/__init__.py`

 * *Files 8% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/client/accountclient.py` & `rucio-34.1.0/lib/rucio/client/accountclient.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -14,16 +13,15 @@
 # limitations under the License.
 
 from json import dumps
 from urllib.parse import quote_plus
 
 from requests.status_codes import codes
 
-from rucio.client.baseclient import BaseClient
-from rucio.client.baseclient import choice
+from rucio.client.baseclient import BaseClient, choice
 from rucio.common.utils import build_url
 
 
 class AccountClient(BaseClient):
 
     """Account client class for working with rucio accounts"""
```

### Comparing `rucio-34.0.0rc2/lib/rucio/client/accountlimitclient.py` & `rucio-34.1.0/lib/rucio/client/accountlimitclient.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -14,16 +13,15 @@
 # limitations under the License.
 
 from json import dumps
 from urllib.parse import quote_plus
 
 from requests.status_codes import codes
 
-from rucio.client.baseclient import BaseClient
-from rucio.client.baseclient import choice
+from rucio.client.baseclient import BaseClient, choice
 from rucio.common.utils import build_url
 
 
 class AccountLimitClient(BaseClient):
 
     """Account limit client class for working with account limits"""
```

### Comparing `rucio-34.0.0rc2/lib/rucio/client/baseclient.py` & `rucio-34.1.0/lib/rucio/client/baseclient.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -20,32 +19,30 @@
 import errno
 import getpass
 import os
 import random
 import sys
 import time
 from configparser import NoOptionError, NoSectionError
-from os import environ, fdopen, path, makedirs, geteuid
+from os import environ, fdopen, geteuid, makedirs, path
 from shutil import move
 from tempfile import mkstemp
 from urllib.parse import urlparse
 
 from dogpile.cache import make_region
-from requests import Session, Response
+from requests import Response, Session
 from requests.exceptions import ConnectionError
 from requests.status_codes import codes
 
 from rucio import version
 from rucio.common import exception
 from rucio.common.config import config_get, config_get_bool, config_get_int
-from rucio.common.exception import (CannotAuthenticate, ClientProtocolNotSupported,
-                                    NoAuthInformation, MissingClientParameter,
-                                    MissingModuleException, ServerConnectionException)
+from rucio.common.exception import CannotAuthenticate, ClientProtocolNotSupported, MissingClientParameter, MissingModuleException, NoAuthInformation, ServerConnectionException
 from rucio.common.extra import import_extras
-from rucio.common.utils import build_url, get_tmp_dir, my_key_generator, parse_response, ssh_sign, setup_logger
+from rucio.common.utils import build_url, get_tmp_dir, my_key_generator, parse_response, setup_logger, ssh_sign
 
 EXTRA_MODULES = import_extras(['requests_kerberos'])
 
 if EXTRA_MODULES['requests_kerberos']:
     from requests_kerberos import HTTPKerberosAuth  # pylint: disable=import-error
 
 LOG = setup_logger(module_name=__name__)
@@ -66,15 +63,15 @@
 
     :param hosts: Lost of hosts
     :return: A randomly selected host.
     """
     return random.choice(hosts)
 
 
-class BaseClient(object):
+class BaseClient:
 
     """Main client class for accessing Rucio resources. Handles the authentication."""
 
     AUTH_RETRIES, REQUEST_RETRIES = 2, 3
     TOKEN_PATH_PREFIX = get_tmp_dir() + '/.rucio_'
     TOKEN_PREFIX = 'auth_token_'
     TOKEN_EXP_PREFIX = 'auth_token_exp_'
@@ -411,15 +408,15 @@
                     # do not do this for successful requests because the caller may be expecting streamed response
                     self.logger.debug("Response text (length=%d): [%s]" % (len(result.text), result.text))
             except ConnectionError as error:
                 self.logger.error('ConnectionError: ' + str(error))
                 if retry > self.request_retries:
                     raise
                 continue
-            except IOError as error:
+            except OSError as error:
                 # Handle Broken Pipe
                 # While in python3 we can directly catch 'BrokenPipeError', in python2 it doesn't exist.
                 if getattr(error, 'errno') != errno.EPIPE:
                     raise
                 self.logger.error('BrokenPipe: ' + str(error))
                 if retry > self.request_retries:
                     raise
@@ -858,15 +855,15 @@
         if not path.exists(self.token_file):
             return False
 
         try:
             token_file_handler = open(self.token_file, 'r')
             self.auth_token = token_file_handler.readline()
             self.headers['X-Rucio-Auth-Token'] = self.auth_token
-        except IOError as error:
+        except OSError as error:
             print("I/O error({0}): {1}".format(error.errno, error.strerror))
         except Exception:
             raise
         if self.auth_oidc_refresh_active and self.auth_type == 'oidc':
             self.__refresh_token_OIDC()
         self.logger.debug('got token from file')
         return True
@@ -889,15 +886,15 @@
                 f_token.write(self.auth_token)
             move(file_n, self.token_file)
             if self.auth_type == 'oidc' and self.token_exp_epoch and self.auth_oidc_refresh_active:
                 file_d, file_n = mkstemp(dir=self.token_path)
                 with fdopen(file_d, "w") as f_exp_epoch:
                     f_exp_epoch.write(str(self.token_exp_epoch))
                 move(file_n, self.token_exp_epoch_file)
-        except IOError as error:
+        except OSError as error:
             print("I/O error({0}): {1}".format(error.errno, error.strerror))
         except Exception:
             raise
 
     def __authenticate(self):
         """
         Main method for authentication. It first tries to read a locally saved token. If not available it requests a new one.
```

### Comparing `rucio-34.0.0rc2/lib/rucio/client/client.py` & `rucio-34.1.0/lib/rucio/client/client.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/client/configclient.py` & `rucio-34.1.0/lib/rucio/client/configclient.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -13,16 +12,15 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 from json import dumps
 
 from requests.status_codes import codes
 
-from rucio.client.baseclient import BaseClient
-from rucio.client.baseclient import choice
+from rucio.client.baseclient import BaseClient, choice
 from rucio.common.utils import build_url
 
 
 class ConfigClient(BaseClient):
 
     """Client class for working with the configuration"""
```

### Comparing `rucio-34.0.0rc2/lib/rucio/client/credentialclient.py` & `rucio-34.1.0/lib/rucio/client/credentialclient.py`

 * *Files 3% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -11,16 +10,15 @@
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 from requests.status_codes import codes
 
-from rucio.client.baseclient import BaseClient
-from rucio.client.baseclient import choice
+from rucio.client.baseclient import BaseClient, choice
 from rucio.common.utils import build_url
 
 
 class CredentialClient(BaseClient):
     """Credential client class for working with URL signing"""
 
     CREDENTIAL_BASEURL = 'credentials'
```

### Comparing `rucio-34.0.0rc2/lib/rucio/client/didclient.py` & `rucio-34.1.0/lib/rucio/client/didclient.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -11,22 +10,22 @@
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 from datetime import datetime
 from json import dumps
+from typing import Any, Optional
 from urllib.parse import quote_plus
 
 from requests.status_codes import codes
 
-from rucio.client.baseclient import BaseClient
-from rucio.client.baseclient import choice
+from rucio.client.baseclient import BaseClient, choice
 from rucio.common.exception import DeprecationError
-from rucio.common.utils import build_url, render_json, render_json_list, date_to_str
+from rucio.common.utils import build_url, date_to_str, render_json, render_json_list
 
 
 class DIDClient(BaseClient):
 
     """DataIdentifier client class for working with data identifiers"""
 
     DIDS_BASEURL = 'dids'
@@ -338,15 +337,15 @@
         url = build_url(choice(self.list_hosts), path=path)
         r = self._send_request(url, type_='GET')
         if r.status_code == codes.ok:
             return self._load_json_data(r)
         exc_cls, exc_msg = self._get_exception(headers=r.headers, status_code=r.status_code, data=r.content)
         raise exc_cls(exc_msg)
 
-    def list_files(self, scope, name, long=None):
+    def list_files(self, scope: str, name: str, long: Optional[bool] = None):
         """
         List data identifier file contents.
 
         :param scope: The scope name.
         :param name: The data identifier name.
         :param long: A boolean to choose if GUID is returned or not.
         """
@@ -360,14 +359,32 @@
         r = self._send_request(url, type_='GET')
         if r.status_code == codes.ok:
             return self._load_json_data(r)
         else:
             exc_cls, exc_msg = self._get_exception(headers=r.headers, status_code=r.status_code, data=r.content)
             raise exc_cls(exc_msg)
 
+    def bulk_list_files(self, dids: list[dict[str, Any]]):
+        """
+        List data identifier file contents.
+
+        :param dids: The list of DIDs.
+        """
+
+        data = {'dids': dids}
+        path = '/'.join([self.DIDS_BASEURL, 'bulkfiles'])
+        url = build_url(choice(self.list_hosts), path=path)
+
+        r = self._send_request(url, type_='POST', data=dumps(data), stream=True)
+        if r.status_code == codes.ok:
+            return self._load_json_data(r)
+        else:
+            exc_cls, exc_msg = self._get_exception(headers=r.headers, status_code=r.status_code, data=r.content)
+            raise exc_cls(exc_msg)
+
     def get_did(self, scope, name, dynamic=False, dynamic_depth=None):
         """
         Retrieve a single data identifier.
 
         :param scope: The scope name.
         :param name: The data identifier name.
         :param dynamic_depth: The DID type as string ('FILE'/'DATASET') at which to stop the dynamic
```

### Comparing `rucio-34.0.0rc2/lib/rucio/client/diracclient.py` & `rucio-34.1.0/lib/rucio/client/diracclient.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -13,16 +12,15 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 from json import dumps
 
 from requests.status_codes import codes
 
-from rucio.client.baseclient import BaseClient
-from rucio.client.baseclient import choice
+from rucio.client.baseclient import BaseClient, choice
 from rucio.common.utils import build_url
 
 
 class DiracClient(BaseClient):
 
     """DataIdentifier client class for working with data identifiers"""
```

### Comparing `rucio-34.0.0rc2/lib/rucio/client/downloadclient.py` & `rucio-34.1.0/lib/rucio/client/downloadclient.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -19,26 +18,24 @@
 import logging
 import os
 import random
 import shutil
 import signal
 import subprocess
 import time
-from queue import Queue, Empty, deque
+from queue import Empty, Queue, deque
 from threading import Thread
 
 from rucio import version
 from rucio.client.client import Client
 from rucio.common.config import config_get
 from rucio.common.didtype import DID
-from rucio.common.exception import (InputValidationError, NoFilesDownloaded, NotAllFilesDownloaded, RucioException)
+from rucio.common.exception import InputValidationError, NoFilesDownloaded, NotAllFilesDownloaded, RucioException
 from rucio.common.pcache import Pcache
-from rucio.common.utils import GLOBALLY_SUPPORTED_CHECKSUMS, CHECKSUM_ALGO_DICT, PREFERRED_CHECKSUM
-from rucio.common.utils import adler32, detect_client_location, generate_uuid, parse_replicas_from_string, \
-    send_trace, sizefmt, execute, parse_replicas_from_file, extract_scope
+from rucio.common.utils import CHECKSUM_ALGO_DICT, GLOBALLY_SUPPORTED_CHECKSUMS, PREFERRED_CHECKSUM, adler32, detect_client_location, execute, extract_scope, generate_uuid, parse_replicas_from_file, parse_replicas_from_string, send_trace, sizefmt
 from rucio.rse import rsemanager as rsemgr
 
 
 @enum.unique
 class FileDownloadState(str, enum.Enum):
     """
     The state a file can be in before/while/after downloading.
```

### Comparing `rucio-34.0.0rc2/lib/rucio/client/exportclient.py` & `rucio-34.1.0/lib/rucio/client/exportclient.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -11,16 +10,15 @@
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 from requests.status_codes import codes
 
-from rucio.client.baseclient import BaseClient
-from rucio.client.baseclient import choice
+from rucio.client.baseclient import BaseClient, choice
 from rucio.common.utils import build_url, parse_response
 
 
 class ExportClient(BaseClient):
     """RSE client class for exporting data from Rucio"""
 
     EXPORT_BASEURL = 'export'
```

### Comparing `rucio-34.0.0rc2/lib/rucio/client/fileclient.py` & `rucio-34.1.0/lib/rucio/client/fileclient.py`

 * *Files 7% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -14,16 +13,15 @@
 # limitations under the License.
 
 from json import loads
 from urllib.parse import quote_plus
 
 from requests.status_codes import codes
 
-from rucio.client.baseclient import BaseClient
-from rucio.client.baseclient import choice
+from rucio.client.baseclient import BaseClient, choice
 from rucio.common.utils import build_url
 
 
 class FileClient(BaseClient):
     """Dataset client class for working with dataset"""
 
     BASEURL = 'files'
```

### Comparing `rucio-34.0.0rc2/lib/rucio/client/importclient.py` & `rucio-34.1.0/lib/rucio/client/importclient.py`

 * *Files 11% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -11,16 +10,15 @@
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 from requests.status_codes import codes
 
-from rucio.client.baseclient import BaseClient
-from rucio.client.baseclient import choice
+from rucio.client.baseclient import BaseClient, choice
 from rucio.common.utils import build_url, render_json
 
 
 class ImportClient(BaseClient):
     """RSE client class for importing data into Rucio"""
 
     IMPORT_BASEURL = 'import'
```

### Comparing `rucio-34.0.0rc2/lib/rucio/client/lifetimeclient.py` & `rucio-34.1.0/lib/rucio/client/lifetimeclient.py`

 * *Files 3% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -13,16 +12,15 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 from json import loads
 
 from requests.status_codes import codes
 
-from rucio.client.baseclient import BaseClient
-from rucio.client.baseclient import choice
+from rucio.client.baseclient import BaseClient, choice
 from rucio.common.utils import build_url, render_json
 
 
 class LifetimeClient(BaseClient):
 
     """Lifetime client class for working with Lifetime Model exceptions"""
```

### Comparing `rucio-34.0.0rc2/lib/rucio/client/lockclient.py` & `rucio-34.1.0/lib/rucio/client/lockclient.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -13,16 +12,15 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 from urllib.parse import quote_plus
 
 from requests.status_codes import codes
 
-from rucio.client.baseclient import BaseClient
-from rucio.client.baseclient import choice
+from rucio.client.baseclient import BaseClient, choice
 from rucio.common.utils import build_url, render_json
 
 
 class LockClient(BaseClient):
 
     """Lock client class for working with rucio locks"""
```

### Comparing `rucio-34.0.0rc2/lib/rucio/client/metaconventionsclient.py` & `rucio-34.1.0/lib/rucio/client/metaconventionsclient.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -10,32 +9,33 @@
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 from json import dumps, loads
+from typing import TYPE_CHECKING, Optional, Union
 from urllib.parse import quote_plus
 
 from requests.status_codes import codes
 
-from rucio.client.baseclient import BaseClient
-from rucio.client.baseclient import choice
+from rucio.client.baseclient import BaseClient, choice
 from rucio.common.utils import build_url
-from rucio.db.sqla.constants import KeyType
-from typing import Union, Optional
+
+if TYPE_CHECKING:
+    from rucio.db.sqla.constants import KeyType
 
 
 class MetaConventionClient(BaseClient):
 
     """Metadata client class for working with data identifier attributes"""
 
     META_BASEURL = 'meta_conventions'
 
-    def add_key(self, key: str, key_type: Union[KeyType, str], value_type: Optional[str] = None, value_regexp: Optional[str] = None) -> Optional[bool]:
+    def add_key(self, key: str, key_type: Union['KeyType', str], value_type: Optional[str] = None, value_regexp: Optional[str] = None) -> Optional[bool]:
         """
         Sends the request to add an allowed key for DID metadata (update the DID Metadata Conventions table with a new key).
 
         :param key: the name for the new key.
         :param key_type: the type of the key: all(container, dataset, file), collection(dataset or container), file, derived(compute from file for collection).
         :param value_type: the type of the value, if defined.
         :param value_regexp: the regular expression that values should match, if defined.
```

### Comparing `rucio-34.0.0rc2/lib/rucio/client/pingclient.py` & `rucio-34.1.0/lib/rucio/client/pingclient.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/client/replicaclient.py` & `rucio-34.1.0/lib/rucio/client/replicaclient.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -15,17 +14,16 @@
 
 from datetime import datetime
 from json import dumps, loads
 from urllib.parse import quote_plus
 
 from requests.status_codes import codes
 
-from rucio.client.baseclient import BaseClient
-from rucio.client.baseclient import choice
-from rucio.common.utils import build_url, render_json, chunks
+from rucio.client.baseclient import BaseClient, choice
+from rucio.common.utils import build_url, chunks, render_json
 
 
 class ReplicaClient(BaseClient):
     """Replica client class for working with replicas"""
 
     REPLICAS_BASEURL = 'replicas'
     REPLICAS_CHUNK_SIZE = 1000
```

### Comparing `rucio-34.0.0rc2/lib/rucio/client/requestclient.py` & `rucio-34.1.0/lib/rucio/client/requestclient.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -13,16 +12,15 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 from urllib.parse import quote_plus
 
 from requests.status_codes import codes
 
-from rucio.client.baseclient import BaseClient
-from rucio.client.baseclient import choice
+from rucio.client.baseclient import BaseClient, choice
 from rucio.common.utils import build_url
 
 
 class RequestClient(BaseClient):
 
     REQUEST_BASEURL = 'requests'
```

### Comparing `rucio-34.0.0rc2/lib/rucio/client/rseclient.py` & `rucio-34.1.0/lib/rucio/client/rseclient.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -14,16 +13,15 @@
 # limitations under the License.
 
 from json import dumps, loads
 from urllib.parse import quote
 
 from requests.status_codes import codes
 
-from rucio.client.baseclient import BaseClient
-from rucio.client.baseclient import choice
+from rucio.client.baseclient import BaseClient, choice
 from rucio.common.utils import build_url
 
 
 class RSEClient(BaseClient):
     """RSE client class for working with rucio RSEs"""
 
     RSE_BASEURL = 'rses'
```

### Comparing `rucio-34.0.0rc2/lib/rucio/client/ruleclient.py` & `rucio-34.1.0/lib/rucio/client/ruleclient.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -15,16 +14,15 @@
 
 from json import dumps, loads
 from typing import Any, Optional, Union
 from urllib.parse import quote_plus
 
 from requests.status_codes import codes
 
-from rucio.client.baseclient import BaseClient
-from rucio.client.baseclient import choice
+from rucio.client.baseclient import BaseClient, choice
 from rucio.common.utils import build_url
 
 
 class RuleClient(BaseClient):
 
     """RuleClient class for working with replication rules"""
```

### Comparing `rucio-34.0.0rc2/lib/rucio/client/scopeclient.py` & `rucio-34.1.0/lib/rucio/client/scopeclient.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -14,16 +13,15 @@
 # limitations under the License.
 
 from json import loads
 from urllib.parse import quote_plus
 
 from requests.status_codes import codes
 
-from rucio.client.baseclient import BaseClient
-from rucio.client.baseclient import choice
+from rucio.client.baseclient import BaseClient, choice
 from rucio.common.utils import build_url
 
 
 class ScopeClient(BaseClient):
 
     """Scope client class for working with rucio scopes"""
```

### Comparing `rucio-34.0.0rc2/lib/rucio/client/subscriptionclient.py` & `rucio-34.1.0/lib/rucio/client/subscriptionclient.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -13,16 +12,15 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 from json import dumps
 
 from requests.status_codes import codes
 
-from rucio.client.baseclient import BaseClient
-from rucio.client.baseclient import choice
+from rucio.client.baseclient import BaseClient, choice
 from rucio.common.utils import build_url
 
 
 class SubscriptionClient(BaseClient):
 
     """SubscriptionClient class for working with subscriptions"""
```

### Comparing `rucio-34.0.0rc2/lib/rucio/client/touchclient.py` & `rucio-34.1.0/lib/rucio/client/touchclient.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -13,16 +12,15 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 from json import dumps
 
 from requests import post
 
-from rucio.client.baseclient import BaseClient
-from rucio.client.baseclient import choice
+from rucio.client.baseclient import BaseClient, choice
 from rucio.common.exception import RucioException, UnsupportedDIDType
 
 
 class TouchClient(BaseClient):
 
     """
     Touch client class to send a trace that can be used to
```

### Comparing `rucio-34.0.0rc2/lib/rucio/client/uploadclient.py` & `rucio-34.1.0/lib/rucio/client/uploadclient.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -21,21 +20,31 @@
 import os.path
 import random
 import socket
 import time
 
 from rucio import version
 from rucio.client.client import Client
-from rucio.common.config import config_get_int, config_get, config_get_bool
-from rucio.common.exception import (RucioException, RSEWriteBlocked, DataIdentifierAlreadyExists, RSEOperationNotSupported,
-                                    DataIdentifierNotFound, NoFilesUploaded, NotAllFilesUploaded, FileReplicaAlreadyExists,
-                                    ResourceTemporaryUnavailable, ServiceUnavailable, InputValidationError, RSEChecksumUnavailable,
-                                    ScopeNotFound)
-from rucio.common.utils import (adler32, detect_client_location, execute, generate_uuid, make_valid_did, md5, send_trace,
-                                retry, bittorrent_v2_merkle_sha256, GLOBALLY_SUPPORTED_CHECKSUMS)
+from rucio.common.config import config_get, config_get_bool, config_get_int
+from rucio.common.exception import (
+    DataIdentifierAlreadyExists,
+    DataIdentifierNotFound,
+    FileReplicaAlreadyExists,
+    InputValidationError,
+    NoFilesUploaded,
+    NotAllFilesUploaded,
+    ResourceTemporaryUnavailable,
+    RSEChecksumUnavailable,
+    RSEOperationNotSupported,
+    RSEWriteBlocked,
+    RucioException,
+    ScopeNotFound,
+    ServiceUnavailable,
+)
+from rucio.common.utils import GLOBALLY_SUPPORTED_CHECKSUMS, adler32, bittorrent_v2_merkle_sha256, detect_client_location, execute, generate_uuid, make_valid_did, md5, retry, send_trace
 from rucio.rse import rsemanager as rsemgr
 
 
 class UploadClient:
 
     def __init__(self, _client=None, logger=None, tracing=True):
         """
```

### Comparing `rucio-34.0.0rc2/lib/rucio/common/__init__.py` & `rucio-34.1.0/lib/rucio/api/__init__.py`

 * *Files 9% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/common/cache.py` & `rucio-34.1.0/lib/rucio/common/cache.py`

 * *Files 9% similar despite different names*

```diff
@@ -1,22 +1,20 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
-from __future__ import absolute_import
 
 from typing import TYPE_CHECKING
 
 from dogpile.cache import make_region
 
 from rucio.common.config import config_get
 from rucio.common.utils import is_client
@@ -32,15 +30,15 @@
 try:
     if is_client():
         ENABLE_CACHING = False
     else:
         import pymemcache
         _mc_client = pymemcache.Client(CACHE_URL, connect_timeout=1, timeout=1)
         _mc_client.version()
-except IOError:
+except OSError:
     ENABLE_CACHING = False
 except ImportError:
     ENABLE_CACHING = False
 finally:
     if _mc_client:
         _mc_client.close()
```

### Comparing `rucio-34.0.0rc2/lib/rucio/common/config.py` & `rucio-34.1.0/lib/rucio/common/config.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -15,15 +14,15 @@
 
 """Provides functions to access the local configuration. The configuration locations are provided by get_config_dirs."""
 
 import configparser
 import json
 import os
 from collections.abc import Callable
-from typing import TYPE_CHECKING, overload, Optional, TypeVar, Union
+from typing import TYPE_CHECKING, Optional, TypeVar, Union, overload
 
 from rucio.common import exception
 from rucio.common.exception import ConfigNotFound, DatabaseException
 
 _T = TypeVar('_T')
 _U = TypeVar('_U')
```

### Comparing `rucio-34.0.0rc2/lib/rucio/common/constants.py` & `rucio-34.1.0/lib/rucio/common/constants.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/common/constraints.py` & `rucio-34.1.0/tests/test_module_import.py`

 * *Files 22% similar despite different names*

```diff
@@ -1,18 +1,26 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-# List of authorized value types for key
-AUTHORIZED_VALUE_TYPES = (float, int, str)
-STRING_TYPES = (str, )
+from rucio.common.utils import execute
+
+
+class TestModuleImport:
+    def test_import(self):
+        """ """
+        cmd = 'rucio --version'
+        exitcode, out, err = execute(cmd)
+        assert 'ImportError' not in err
+        assert 'ImportError' not in out
+        assert 'Exception' not in err
+        assert 'Exception' not in out
```

### Comparing `rucio-34.0.0rc2/lib/rucio/common/didtype.py` & `rucio-34.1.0/lib/rucio/common/didtype.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -16,15 +15,15 @@
 """
 DID type to represent a did and to simplify operations on it
 """
 
 from rucio.common.exception import DIDError
 
 
-class DID(object):
+class DID:
 
     """
     Class used to store a DID
     Given an object did of type DID
     scope is stored in did.scope
     name is stored in did.name
     """
```

### Comparing `rucio-34.0.0rc2/lib/rucio/common/dumper/__init__.py` & `rucio-34.1.0/lib/rucio/common/dumper/__init__.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -35,15 +34,15 @@
     def __init__(self, msg='', code=None):
         self.code = code
         if code is not None:
             msg = '{0} (Status {1})'.format(msg, code)
         super(HTTPDownloadFailed, self).__init__(msg)
 
 
-class LogPipeHandler(logging.Handler, object):
+class LogPipeHandler(logging.Handler):
     def __init__(self, pipe):
         super(LogPipeHandler, self).__init__()
         self.pipe = pipe
 
     def emit(self, record):
         self.pipe.send(self.format(record))
```

### Comparing `rucio-34.0.0rc2/lib/rucio/common/dumper/consistency.py` & `rucio-34.1.0/lib/rucio/common/dumper/consistency.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -17,15 +16,15 @@
 import logging
 import os
 import re
 import subprocess
 import tempfile
 
 from rucio.common import dumper
-from rucio.common.dumper import error, DUMPS_CACHE_DIR, data_models, path_parsing
+from rucio.common.dumper import DUMPS_CACHE_DIR, data_models, error, path_parsing
 
 subcommands = ['consistency', 'consistency-manual']
 
 
 class Consistency(data_models.DataModel):
     SCHEMA = (
         ('apparent_status', str),
```

### Comparing `rucio-34.0.0rc2/lib/rucio/common/dumper/data_models.py` & `rucio-34.1.0/lib/rucio/common/dumper/data_models.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -23,24 +22,18 @@
 import logging
 import operator
 import os
 import re
 
 from tabulate import tabulate
 
-from rucio.common.dumper import DUMPS_CACHE_DIR
-from rucio.common.dumper import HTTPDownloadFailed
-from rucio.common.dumper import get_requests_session
-from rucio.common.dumper import http_download_to_file
-from rucio.common.dumper import smart_open
-from rucio.common.dumper import temp_file
-from rucio.common.dumper import to_datetime
+from rucio.common.dumper import DUMPS_CACHE_DIR, HTTPDownloadFailed, get_requests_session, http_download_to_file, smart_open, temp_file, to_datetime
 
 
-class DataModel(object):
+class DataModel:
     """
     Data model for the dumps
     """
 
     BASE_URL = 'https://rucio-hadoop.cern.ch/'
     _FIELD_NAMES = None
     SCHEMA = []
@@ -270,15 +263,15 @@
         super(Replica, self).__init__(*args)
 
         if len(args) == 8:
             logger.warning('Missing parameter\nrse: %s\ndataset: %s\n', self.rse, self.name)
         assert len(args) <= 9
 
 
-class Filter(object):
+class Filter:
     _Condition = collections.namedtuple('_Condition', ('comparator', 'attribute', 'expected'))
 
     def __init__(self, filter_str, record_class):
         '''
         Filter objects allow to match a DataModel subclass instance against
         one or more conditions.
```

### Comparing `rucio-34.0.0rc2/lib/rucio/common/dumper/path_parsing.py` & `rucio-34.1.0/lib/rucio/common/dumper/path_parsing.py`

 * *Files 8% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/common/exception.py` & `rucio-34.1.0/lib/rucio/common/exception.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/common/extra.py` & `rucio-34.1.0/lib/rucio/common/extra.py`

 * *Files 5% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/common/logging.py` & `rucio-34.1.0/lib/rucio/common/logging.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/common/pcache.py` & `rucio-34.1.0/lib/rucio/common/pcache.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,9 +1,8 @@
 #!/usr/bin/env python
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -11,27 +10,26 @@
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import errno
+import fcntl
 import getopt
 import os
 import re
 import signal
 import subprocess
 import sys
 import time
 from socket import gethostname
 from urllib.parse import urlencode
 from urllib.request import urlopen
 
-import fcntl
-
 # The pCache Version
 pcacheversion = "4.2.3"
 
 # Log message levels
 DEBUG, INFO, WARN, ERROR = "DEBUG", "INFO ", "WARN ", "ERROR"
 
 # filename for locking
@@ -256,15 +254,15 @@
                 if arg == 'None':
                     self.guid = None
                 else:
                     self.guid = arg
             elif opt in ("-r", "--retry"):
                 self.max_retries = int(arg)
             elif opt in ("-V", "--version"):
-                print((str(self.version)))
+                print(str(self.version))
                 sys.exit(0)
             elif opt in ("-l", "--log"):
                 self.log_file = arg
             elif opt in ("-v", "--verbose"):
                 self.verbose = True
             elif opt in ("-d", "--debug"):
                 self.debug = True
@@ -1125,27 +1123,27 @@
 
     def lock_file(self, name, blocking=True):
         if name in self.locks:
             self.log(DEBUG, "lock_file: %s already locked", name)
             return
         try:
             f = open(name, 'w')
-        except IOError as e:
+        except OSError as e:
             self.log(ERROR, "open: %s", e)
             return e.errno
 
         self.locks[name] = f
         flag = fcntl.LOCK_EX
         if not blocking:
             flag |= fcntl.LOCK_NB
         while True:
             try:
                 status = fcntl.lockf(f, flag)
                 break
-            except IOError as e:
+            except OSError as e:
                 if e.errno in (errno.EAGAIN, errno.EACCES) and not blocking:
                     f.close()
                     del self.locks[name]
                     return e.errno
                 if e.errno != errno.EINTR:
                     status = e.errno
                     self.log(ERROR, "lockf: %s", e)
```

### Comparing `rucio-34.0.0rc2/lib/rucio/common/plugins.py` & `rucio-34.1.0/lib/rucio/common/plugins.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,24 +11,23 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import importlib
 import os
 from configparser import NoOptionError, NoSectionError
-from typing import Any, Callable, Dict, TypeVar, Type
+from typing import Any, Callable, Dict, Type, TypeVar
 
 from rucio.common import config
 from rucio.common.exception import InvalidAlgorithmName
 
-
 PolicyPackageAlgorithmsT = TypeVar('PolicyPackageAlgorithmsT', bound='PolicyPackageAlgorithms')
 
 
-class PolicyPackageAlgorithms():
+class PolicyPackageAlgorithms:
     """
     Base class for Rucio Policy Package Algorithms
 
     ALGORITHMS is of type Dict[str, Dict[str. Callable[..., Any]]]
     where the key is the algorithm type and the value is a dictionary of algorithm names and their callables
     """
     _ALGORITHMS: Dict[str, Dict[str, Callable[..., Any]]] = {}
```

### Comparing `rucio-34.0.0rc2/lib/rucio/common/policy.py` & `rucio-34.1.0/lib/rucio/common/policy.py`

 * *Files 3% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/common/schema/__init__.py` & `rucio-34.1.0/lib/rucio/common/schema/__init__.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/common/schema/atlas.py` & `rucio-34.1.0/lib/rucio/common/schema/atlas.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,23 +1,22 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-from jsonschema import validate, ValidationError
+from jsonschema import ValidationError, validate
 
 from rucio.common.exception import InvalidObject
 
 ACCOUNT_LENGTH = 25
 
 ACCOUNT = {"description": "Account name",
            "type": "string",
```

### Comparing `rucio-34.0.0rc2/lib/rucio/common/schema/belleii.py` & `rucio-34.1.0/lib/rucio/common/schema/belleii.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,23 +1,22 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-from jsonschema import validate, ValidationError
+from jsonschema import ValidationError, validate
 
 from rucio.common.exception import InvalidObject
 
 ACCOUNT_LENGTH = 25
 
 ACCOUNT = {"description": "Account name",
            "type": "string",
```

### Comparing `rucio-34.0.0rc2/lib/rucio/common/schema/cms.py` & `rucio-34.1.0/lib/rucio/common/schema/cms.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,23 +1,22 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-from jsonschema import validate, ValidationError
+from jsonschema import ValidationError, validate
 
 from rucio.common.exception import InvalidObject
 
 ACCOUNT_LENGTH = 25
 
 ACCOUNT = {"description": "Account name",
            "type": "string",
```

### Comparing `rucio-34.0.0rc2/lib/rucio/common/schema/domatpc.py` & `rucio-34.1.0/lib/rucio/common/schema/domatpc.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,23 +1,22 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-from jsonschema import validate, ValidationError
+from jsonschema import ValidationError, validate
 
 from rucio.common.exception import InvalidObject
 
 ACCOUNT_LENGTH = 25
 
 ACCOUNT = {"description": "Account name",
            "type": "string",
```

### Comparing `rucio-34.0.0rc2/lib/rucio/common/schema/escape.py` & `rucio-34.1.0/lib/rucio/common/schema/escape.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,23 +1,22 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-from jsonschema import validate, ValidationError
+from jsonschema import ValidationError, validate
 
 from rucio.common.exception import InvalidObject
 
 ACCOUNT_LENGTH = 25
 
 ACCOUNT = {"description": "Account name",
            "type": "string",
```

### Comparing `rucio-34.0.0rc2/lib/rucio/common/schema/generic.py` & `rucio-34.1.0/lib/rucio/common/schema/generic.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,23 +1,22 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-from jsonschema import validate, ValidationError
+from jsonschema import ValidationError, validate
 
 from rucio.common.exception import InvalidObject
 
 ACCOUNT_LENGTH = 25
 
 ACCOUNT = {"description": "Account name",
            "type": "string",
```

### Comparing `rucio-34.0.0rc2/lib/rucio/common/schema/generic_multi_vo.py` & `rucio-34.1.0/lib/rucio/common/schema/generic_multi_vo.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,23 +1,22 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-from jsonschema import validate, ValidationError
+from jsonschema import ValidationError, validate
 
 from rucio.common.exception import InvalidObject
 
 ACCOUNT_LENGTH = 29
 
 ACCOUNT = {"description": "Account name",
            "type": "string",
```

### Comparing `rucio-34.0.0rc2/lib/rucio/common/schema/icecube.py` & `rucio-34.1.0/lib/rucio/common/schema/icecube.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,23 +1,22 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-from jsonschema import validate, ValidationError
+from jsonschema import ValidationError, validate
 
 from rucio.common.exception import InvalidObject
 
 ACCOUNT_LENGTH = 25
 
 ACCOUNT = {"description": "Account name",
            "type": "string",
```

### Comparing `rucio-34.0.0rc2/lib/rucio/common/schema/lsst.py` & `rucio-34.1.0/lib/rucio/common/schema/lsst.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,23 +1,22 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-from jsonschema import validate, ValidationError
+from jsonschema import ValidationError, validate
 
 from rucio.common.exception import InvalidObject
 
 ACCOUNT_LENGTH = 25
 
 ACCOUNT = {"description": "Account name",
            "type": "string",
```

### Comparing `rucio-34.0.0rc2/lib/rucio/common/stomp_utils.py` & `rucio-34.1.0/lib/rucio/common/stomp_utils.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/common/stopwatch.py` & `rucio-34.1.0/lib/rucio/common/stopwatch.py`

 * *Files 5% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/common/test_rucio_server.py` & `rucio-34.1.0/lib/rucio/common/test_rucio_server.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -13,15 +12,16 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import unittest
 from os import remove
 from os.path import basename
 
-from rucio.common.utils import generate_uuid as uuid, execute
+from rucio.common.utils import execute
+from rucio.common.utils import generate_uuid as uuid
 
 
 def file_generator(size=2048, namelen=10):
     """ Create a bogus file and returns it's name.
     :param size: size in bytes
     :returns: The name of the generated file.
     """
```

### Comparing `rucio-34.0.0rc2/lib/rucio/common/types.py` & `rucio-34.1.0/lib/rucio/common/types.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,15 +11,15 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 from typing import Any, Callable, Literal, Optional, TypedDict, Union
 
 
-class InternalType(object):
+class InternalType:
     '''
     Base for Internal representations of string types
     '''
     def __init__(self, value, vo='def', fromExternal=True):
         if value is None:
             self.external = None
             self.internal = None
@@ -170,7 +169,12 @@
     lifetime: Optional[int]
     locked: bool
     subscription_id: Optional[str]
     source_replica_expression: Optional[str]
     activity: str
     notify: Optional[Literal['Y', 'N', 'C', 'P']]
     purge_replicas: bool
+
+
+class DIDDict(TypedDict):
+    name: str
+    scope: InternalScope
```

### Comparing `rucio-34.0.0rc2/lib/rucio/common/utils.py` & `rucio-34.1.0/lib/rucio/common/utils.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -21,42 +20,41 @@
 import getpass
 import hashlib
 import io
 import ipaddress
 import itertools
 import json
 import logging
+import math
+import mmap
 import os
 import os.path
 import re
 import signal
 import socket
 import subprocess
 import tempfile
 import threading
 import time
+import zlib
 from collections import OrderedDict
 from collections.abc import Callable, Sequence
 from enum import Enum
 from functools import partial, wraps
 from io import StringIO
 from itertools import zip_longest
 from typing import TYPE_CHECKING, Optional, Type, TypeVar
-from urllib.parse import urlparse, urlencode, quote, parse_qsl, urlunparse
+from urllib.parse import parse_qsl, quote, urlencode, urlparse, urlunparse
 from uuid import uuid4 as uuid
 from xml.etree import ElementTree
 
-import math
-import mmap
 import requests
-import zlib
 
 from rucio.common.config import config_get, config_has_section
-from rucio.common.exception import MissingModuleException, InvalidType, InputValidationError, MetalinkJsonParsingError, RucioException, \
-    DuplicateCriteriaInDIDFilter, DIDFilterSyntaxError, PolicyPackageVersionError
+from rucio.common.exception import DIDFilterSyntaxError, DuplicateCriteriaInDIDFilter, InputValidationError, InvalidType, MetalinkJsonParsingError, MissingModuleException, PolicyPackageVersionError, RucioException
 from rucio.common.extra import import_extras
 from rucio.common.plugins import PolicyPackageAlgorithms
 from rucio.common.types import InternalAccount, InternalScope
 
 EXTRA_MODULES = import_extras(['paramiko'])
 
 if EXTRA_MODULES['paramiko']:
@@ -576,15 +574,15 @@
     """
     try:
         if isinstance(vallist, list):
             return str(" ".join(vallist))
         else:
             return str(vallist)
     except:
-        return str('')
+        return ''
 
 
 def date_to_str(date):
     """ Converts a datetime value to the corresponding RFC-1123 string.
 
     :param date: the datetime value to convert.
     """
@@ -1656,15 +1654,15 @@
     :param action: Function, that should run periodically.
     :param graceful_stop: Threading event used to check for graceful stop.
     """
     def start():
         while not graceful_stop.is_set():
             starttime = time.time()
             action()
-            time.sleep(interval - ((time.time() - starttime)))
+            time.sleep(interval - (time.time() - starttime))
     t = threading.Thread(target=start)
     return t
 
 
 def run_cmd_process(cmd, timeout=3600):
     """
     shell command parser with timeout
@@ -2059,14 +2057,15 @@
 
         self.container[self.heap[pos]].pos = pos
         return heap_changed
 
 
 def check_policy_package_version(package):
     import importlib
+
     from rucio.version import version_string
     '''
     Checks that the Rucio version supported by the policy package is compatible
     with this version. Raises an exception if not.
     :param package: the fully qualified name of the policy package
     '''
     try:
```

### Comparing `rucio-34.0.0rc2/lib/rucio/core/__init__.py` & `rucio-34.1.0/lib/rucio/common/__init__.py`

 * *Files 9% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/core/account.py` & `rucio-34.1.0/lib/rucio/core/account.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -15,26 +14,26 @@
 
 from datetime import datetime
 from enum import Enum
 from re import match
 from traceback import format_exc
 from typing import TYPE_CHECKING
 
-from sqlalchemy import select, and_
+from sqlalchemy import and_, select
 from sqlalchemy.exc import IntegrityError
 from sqlalchemy.orm import exc
 
 import rucio.core.account_counter
 import rucio.core.rse
 from rucio.common import exception
 from rucio.common.config import config_get_bool
 from rucio.core.vo import vo_exists
 from rucio.db.sqla import models
 from rucio.db.sqla.constants import AccountStatus, AccountType
-from rucio.db.sqla.session import read_session, transactional_session, stream_session
+from rucio.db.sqla.session import read_session, stream_session, transactional_session
 
 if TYPE_CHECKING:
     from sqlalchemy.orm import Session
 
 
 @transactional_session
 def add_account(account, type_, email, *, session: "Session"):
```

### Comparing `rucio-34.0.0rc2/lib/rucio/core/account_counter.py` & `rucio-34.1.0/lib/rucio/core/account_counter.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -11,18 +10,18 @@
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 import datetime
 from typing import TYPE_CHECKING
 
-from sqlalchemy import literal, insert, select
+from sqlalchemy import insert, literal, select
 from sqlalchemy.orm.exc import NoResultFound
 
-from rucio.db.sqla import models, filter_thread_work
+from rucio.db.sqla import filter_thread_work, models
 from rucio.db.sqla.session import read_session, transactional_session
 
 if TYPE_CHECKING:
     from sqlalchemy.orm import Session
 
 MAX_COUNTERS = 10
```

### Comparing `rucio-34.0.0rc2/lib/rucio/core/account_limit.py` & `rucio-34.1.0/lib/rucio/core/account_limit.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,15 +11,15 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 from typing import TYPE_CHECKING
 
 from sqlalchemy.orm.exc import NoResultFound
-from sqlalchemy.sql import func, select, literal
+from sqlalchemy.sql import func, literal, select
 from sqlalchemy.sql.expression import and_, or_
 
 from rucio.core.account import get_all_rse_usages_per_account
 from rucio.core.rse import get_rse_name
 from rucio.core.rse_expression_parser import parse_expression
 from rucio.db.sqla import models
 from rucio.db.sqla.session import read_session, transactional_session
```

### Comparing `rucio-34.0.0rc2/lib/rucio/core/authentication.py` & `rucio-34.1.0/lib/rucio/core/authentication.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -26,26 +25,26 @@
 from dogpile.cache import make_region
 from dogpile.cache.api import NO_VALUE
 from sqlalchemy import delete, null, or_, select
 
 from rucio.common.cache import make_region_memcached
 from rucio.common.config import config_get_bool
 from rucio.common.exception import CannotAuthenticate, RucioException
-from rucio.common.utils import chunks, generate_uuid, date_to_str
+from rucio.common.utils import chunks, date_to_str, generate_uuid
 from rucio.core.account import account_exists
 from rucio.core.oidc import validate_jwt
-from rucio.db.sqla import filter_thread_work
-from rucio.db.sqla import models
+from rucio.db.sqla import filter_thread_work, models
 from rucio.db.sqla.constants import IdentityType
 from rucio.db.sqla.session import read_session, transactional_session
 
 if TYPE_CHECKING:
-    from sqlalchemy.orm import Session
     from typing import Any, Union
 
+    from sqlalchemy.orm import Session
+
 
 def strip_x509_proxy_attributes(dn: str) -> str:
     """Strip X509 proxy attributes from a DN.
 
     When an X509 VOMS proxy certificate is produced, an additional Common Name
     attribute is added to the subject of the original certificate.  Its value
     can take different forms.  For proxy versions 3 and later (the default), the
```

### Comparing `rucio-34.0.0rc2/lib/rucio/core/config.py` & `rucio-34.1.0/lib/rucio/core/config.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -31,41 +30,41 @@
 
 
 REGION = make_region_memcached(expiration_time=900)
 
 SECTIONS_CACHE_KEY = 'sections'
 
 
-def _has_section_cache_key(section):
+def _has_section_cache_key(section: str) -> str:
     return 'has_section_%s' % section
 
 
-def _options_cache_key(section):
+def _options_cache_key(section: str) -> str:
     return 'options_%s' % section
 
 
-def _has_option_cache_key(section, option):
+def _has_option_cache_key(section: str, option: str) -> str:
     return 'has_option_%s_%s' % (section, option)
 
 
-def _items_cache_key(section):
+def _items_cache_key(section: str) -> str:
     return 'items_%s' % section
 
 
-def _value_cache_key(section, option):
+def _value_cache_key(section: str, option: str) -> str:
     return 'get_%s_%s' % (section, option)
 
 
 @read_session
 def sections(
         *,
         use_cache: bool = True,
         expiration_time: int = 900,
         session: "Session"
-):
+) -> list[str]:
     """
     Return a list of the sections available.
 
     :param use_cache: Boolean if the cache should be used.
     :param expiration_time: Time after that the cached value gets ignored.
     :param session: The database session in use.
     :returns: ['section_name', ...]
@@ -79,15 +78,15 @@
         all_sections = [section[0] for section in query]
         write_to_cache(SECTIONS_CACHE_KEY, all_sections)
 
     return all_sections
 
 
 @transactional_session
-def add_section(section: str, *, session: "Session"):
+def add_section(section: str, *, session: "Session") -> None:
     """
     Add a section to the configuration.
     :param session: The database session in use.
     :param section: The name of the section.
     """
 
     raise NotImplementedError('Irrelevant - sections cannot exist without options')
@@ -147,21 +146,21 @@
         options = [option[0] for option in query]
         write_to_cache(options_key, options)
     return options
 
 
 @read_session
 def has_option(
-        section,
-        option,
+        section: str,
+        option: str,
         *,
-        use_cache=True,
-        expiration_time=900,
+        use_cache: bool = True,
+        expiration_time: int = 900,
         session: "Session"
-):
+) -> bool:
     """
     Check if the given section exists and contains the given option.
 
     :param section: The name of the section.
     :param option: The name of the option.
     :param use_cache: Boolean if the cache should be used.
     :param expiration_time: Time after that the cached value gets ignored.
@@ -256,15 +255,15 @@
 @transactional_session
 def set(
         section: str,
         option: str,
         value: Any,
         *,
         session: "Session"
-):
+) -> None:
     """
     Set the given option to the specified value. If the option doesn't exist, it is created.
 
     :param section: The name of the section.
     :param option: The name of the option.
     :param value: The content of the value.
     :param session: The database session in use.
@@ -349,38 +348,38 @@
             delete_from_cache(key=_has_section_cache_key(section))
         delete_from_cache(key=_items_cache_key(section))
         delete_from_cache(key=_has_option_cache_key(section, option))
         delete_from_cache(key=_value_cache_key(section, option))
         return True
 
 
-def read_from_cache(key, expiration_time=900):
+def read_from_cache(key: str, expiration_time: int = 900) -> Any:
     """
     Try to read a value from a cache.
 
     :param key: Key that stores the value.
     :param expiration_time: Time in seconds that a value should not be older than.
     """
     key = key.replace(' ', '')
     value = REGION.get(key, expiration_time=expiration_time)
     return value
 
 
-def write_to_cache(key, value):
+def write_to_cache(key: str, value: Any) -> None:
     """
     Set a value on a key in a cache.
 
     :param key: Key that stores the value.
     :param value: Value to be stored.
     """
     key = key.replace(' ', '')
     REGION.set(key, value)
 
 
-def delete_from_cache(key):
+def delete_from_cache(key: str) -> None:
     """
     Delete from cache any data stored for the given key
 
     :param key: Key that stores the value.
     """
     key = key.replace(' ', '')
     REGION.delete(key)
```

### Comparing `rucio-34.0.0rc2/lib/rucio/core/credential.py` & `rucio-34.1.0/lib/rucio/core/credential.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -14,15 +13,15 @@
 # limitations under the License.
 
 import base64
 import datetime
 import hmac
 import time
 from hashlib import sha1
-from urllib.parse import urlparse, urlencode
+from urllib.parse import urlencode, urlparse
 
 import boto3
 from botocore.client import Config
 from dogpile.cache.api import NO_VALUE
 from google.oauth2.service_account import Credentials
 
 from rucio.common.cache import make_region_memcached
@@ -33,15 +32,15 @@
 
 CREDS_GCS = None
 
 REGION = make_region_memcached(expiration_time=900)
 METRICS = MetricManager(module=__name__)
 
 
-def get_signed_url(rse_id: str, service: str, operation: str, url: str, lifetime=600) -> str:
+def get_signed_url(rse_id: str, service: str, operation: str, url: str, lifetime: int = 600) -> str:
     """
     Get a signed URL for a particular service and operation.
 
     The signed URL will be valid for 1 hour but can be overriden.
 
     :param rse_id: The ID of the RSE that the URL points to.
     :param service: The service to authorise, either 'gcs', 's3' or 'swift'.
@@ -83,16 +82,16 @@
 
         # special case to test signature, force epoch time
         if lifetime is None:
             lifetime = 0
         else:
             # GCS is timezone-sensitive, don't use UTC
             # has to be converted to Unixtime
-            lifetime = datetime.datetime.now() + datetime.timedelta(seconds=lifetime)
-            lifetime = int(time.mktime(lifetime.timetuple()))
+            lifetime_datetime = datetime.datetime.now() + datetime.timedelta(seconds=lifetime)
+            lifetime = int(time.mktime(lifetime_datetime.timetuple()))
 
         # sign the path only
         path = components.path
 
         # assemble message to sign
         to_sign = "%s\n\n\n%s\n%s" % (operation, lifetime, path)
```

### Comparing `rucio-34.0.0rc2/lib/rucio/core/did.py` & `rucio-34.1.0/lib/rucio/core/did.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -17,42 +16,43 @@
 import random
 from datetime import datetime, timedelta
 from enum import Enum
 from hashlib import md5
 from re import match
 from typing import TYPE_CHECKING
 
-from sqlalchemy import and_, or_, exists, update, delete, insert
+from sqlalchemy import and_, delete, exists, insert, or_, update
 from sqlalchemy.exc import DatabaseError, IntegrityError
 from sqlalchemy.orm.exc import NoResultFound
-from sqlalchemy.sql import not_, func
-from sqlalchemy.sql.expression import bindparam, case, select, true, false, null
+from sqlalchemy.sql import func, not_
+from sqlalchemy.sql.expression import bindparam, case, false, null, select, true
 
 import rucio.core.replica  # import add_replicas
 import rucio.core.rule
 from rucio.common import exception
 from rucio.common.config import config_get_bool, config_get_int
-from rucio.common.utils import is_archive, chunks
+from rucio.common.utils import chunks, is_archive
 from rucio.core import did_meta_plugins
 from rucio.core.message import add_message
 from rucio.core.monitor import MetricManager
 from rucio.core.naming_convention import validate_name
-from rucio.db.sqla import models, filter_thread_work
-from rucio.db.sqla.constants import DIDType, DIDReEvaluation, DIDAvailability, RuleState, BadFilesStatus
-from rucio.db.sqla.session import read_session, transactional_session, stream_session
+from rucio.db.sqla import filter_thread_work, models
+from rucio.db.sqla.constants import BadFilesStatus, DIDAvailability, DIDReEvaluation, DIDType, RuleState
+from rucio.db.sqla.session import read_session, stream_session, transactional_session
 from rucio.db.sqla.util import temp_table_mngr
 
 if TYPE_CHECKING:
-    from collections.abc import Callable, Sequence
+    from collections.abc import Iterator, Sequence
     from typing import Any, Optional, Union
+
     from sqlalchemy.orm import Session
     from sqlalchemy.schema import Table
-    from rucio.common.types import InternalAccount, InternalScope
 
-    LoggerFunction = Callable[..., Any]
+    from rucio.common.types import InternalAccount, InternalScope, LoggerFunction
+
 
 METRICS = MetricManager(module=__name__)
 
 
 @read_session
 def list_expired_dids(
         worker_number: int = None,
@@ -1884,15 +1884,34 @@
     for row in session.execute(stmt):
         result.append({'scope': row.scope, 'name': row.name})
 
     return result
 
 
 @stream_session
-def list_files(scope, name, long=False, *, session: "Session"):
+def bulk_list_files(dids: "list[dict[str, Any]]", long: bool = False, *, session: "Session") -> "Optional[Iterator[dict[str, Any]]]":
+    """
+    List file contents of a list of data identifier.
+
+    :param dids:       A list of DIDs.
+    :param long:       A boolean to choose if more metadata are returned or not.
+    :param session:    The database session in use.
+    """
+    for did in dids:
+        try:
+            for file_dict in list_files(scope=did['scope'], name=did['name'], long=long, session=session):
+                file_dict['parent_scope'] = did['scope']
+                file_dict['parent_name'] = did['name']
+                yield file_dict
+        except exception.DataIdentifierNotFound:
+            pass
+
+
+@stream_session
+def list_files(scope: "InternalScope", name: str, long: bool = False, *, session: "Session") -> "Iterator[dict[str, Any]]":
     """
     List data identifier file contents.
 
     :param scope:      The scope name.
     :param name:       The data identifier name.
     :param long:       A boolean to choose if more metadata are returned or not.
     :param session:    The database session in use.
```

### Comparing `rucio-34.0.0rc2/lib/rucio/core/did_meta_plugins/__init__.py` & `rucio-34.1.0/lib/rucio/core/did_meta_plugins/__init__.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/core/did_meta_plugins/did_column_meta.py` & `rucio-34.1.0/lib/rucio/core/did_meta_plugins/did_column_meta.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -13,30 +12,31 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import operator
 from datetime import datetime, timedelta
 from typing import TYPE_CHECKING
 
-from sqlalchemy import update, inspect
+from sqlalchemy import inspect, update
 from sqlalchemy.exc import CompileError, InvalidRequestError
 from sqlalchemy.orm.exc import NoResultFound
 from sqlalchemy.sql import func
 from sqlalchemy.sql.expression import true
 
 from rucio.common import exception
 from rucio.core import account_counter, rse_counter
 from rucio.core.did_meta_plugins.did_meta_plugin_interface import DidMetaPlugin
 from rucio.core.did_meta_plugins.filter_engine import FilterEngine
 from rucio.db.sqla import models
 from rucio.db.sqla.constants import DIDType
-from rucio.db.sqla.session import stream_session, read_session, transactional_session
+from rucio.db.sqla.session import read_session, stream_session, transactional_session
 
 if TYPE_CHECKING:
     from typing import Optional
+
     from sqlalchemy.orm import Session
 
 
 class DidColumnMeta(DidMetaPlugin):
     """
     A metadata plugin to interact with the base did table metadata.
     """
```

### Comparing `rucio-34.0.0rc2/lib/rucio/core/did_meta_plugins/did_meta_plugin_interface.py` & `rucio-34.1.0/lib/rucio/core/did_meta_plugins/did_meta_plugin_interface.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -16,18 +15,19 @@
 from abc import ABCMeta, abstractmethod
 from typing import TYPE_CHECKING
 
 from rucio.db.sqla.session import transactional_session
 
 if TYPE_CHECKING:
     from typing import Optional
+
     from sqlalchemy.orm import Session
 
 
-class DidMetaPlugin(object, metaclass=ABCMeta):
+class DidMetaPlugin(metaclass=ABCMeta):
     """
     Interface for plugins managing metadata of DIDs
     """
 
     def __init__(self):
         """
         Initializes the plugin
```

### Comparing `rucio-34.0.0rc2/lib/rucio/core/did_meta_plugins/filter_engine.py` & `rucio-34.1.0/lib/rucio/core/did_meta_plugins/filter_engine.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,20 +11,20 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import ast
 import fnmatch
 import operator
-from datetime import datetime, timedelta, date
+from datetime import date, datetime, timedelta
 from importlib import import_module
 from typing import TYPE_CHECKING
 
 import sqlalchemy
-from sqlalchemy import cast, or_, and_
+from sqlalchemy import and_, cast, or_
 from sqlalchemy.sql.expression import text
 
 from rucio.common import exception
 from rucio.common.utils import parse_did_filter_from_string_fe
 from rucio.db.sqla.constants import DIDType
 from rucio.db.sqla.session import read_session
```

### Comparing `rucio-34.0.0rc2/lib/rucio/core/did_meta_plugins/json_meta.py` & `rucio-34.1.0/lib/rucio/core/did_meta_plugins/json_meta.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -11,25 +10,25 @@
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import json as json_lib
 import operator
-from typing import TYPE_CHECKING, cast, Any
+from typing import TYPE_CHECKING, Any, cast
 
 from sqlalchemy.exc import DataError
 from sqlalchemy.orm.exc import NoResultFound
 
 from rucio.common import exception
 from rucio.core.did_meta_plugins.did_meta_plugin_interface import DidMetaPlugin
 from rucio.core.did_meta_plugins.filter_engine import FilterEngine
 from rucio.db.sqla import models
 from rucio.db.sqla.constants import DIDType
-from rucio.db.sqla.session import read_session, transactional_session, stream_session
+from rucio.db.sqla.session import read_session, stream_session, transactional_session
 from rucio.db.sqla.util import json_implemented
 
 if TYPE_CHECKING:
     from sqlalchemy.orm import Session
 
 
 class JSONDidMeta(DidMetaPlugin):
```

### Comparing `rucio-34.0.0rc2/lib/rucio/core/did_meta_plugins/mongo_meta.py` & `rucio-34.1.0/lib/rucio/core/did_meta_plugins/mongo_meta.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -14,22 +13,22 @@
 # limitations under the License.
 
 import operator
 from typing import TYPE_CHECKING
 
 import pymongo
 
-from rucio.common import config
-from rucio.common import exception
+from rucio.common import config, exception
 from rucio.common.types import InternalScope
 from rucio.core.did_meta_plugins.did_meta_plugin_interface import DidMetaPlugin
 from rucio.core.did_meta_plugins.filter_engine import FilterEngine
 
 if TYPE_CHECKING:
     from typing import Optional
+
     from sqlalchemy.orm import Session
 
 IMMUTABLE_KEYS = [
     '_id',              # index key
     'scope',            # generated on insert
     'name',             # generated on insert
     'vo'                # generated on insert
```

### Comparing `rucio-34.0.0rc2/lib/rucio/core/did_meta_plugins/postgres_meta.py` & `rucio-34.1.0/lib/rucio/core/did_meta_plugins/postgres_meta.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -16,22 +15,22 @@
 import json
 import operator
 from typing import TYPE_CHECKING
 
 import psycopg2
 import psycopg2.extras
 
-from rucio.common import config
-from rucio.common import exception
+from rucio.common import config, exception
 from rucio.common.types import InternalScope
 from rucio.core.did_meta_plugins.did_meta_plugin_interface import DidMetaPlugin
 from rucio.core.did_meta_plugins.filter_engine import FilterEngine
 
 if TYPE_CHECKING:
     from typing import Optional
+
     from sqlalchemy.orm import Session
 
 
 class ExternalPostgresDidMeta(DidMetaPlugin):
     # TODO: column-based plugin? mixed-mode (json & columns)?
     pass
```

### Comparing `rucio-34.0.0rc2/lib/rucio/core/dirac.py` & `rucio-34.1.0/lib/rucio/core/dirac.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -17,24 +16,24 @@
 from json import loads
 from json.decoder import JSONDecodeError
 from typing import TYPE_CHECKING, Optional
 
 from sqlalchemy.orm.exc import NoResultFound
 
 from rucio.common.config import config_get
-from rucio.common.exception import InvalidType, UnsupportedOperation, ConfigNotFound, RucioException
-from rucio.common.types import InternalScope, InternalAccount
+from rucio.common.exception import ConfigNotFound, InvalidType, RucioException, UnsupportedOperation
+from rucio.common.types import InternalAccount, InternalScope
 from rucio.common.utils import extract_scope
 from rucio.core.did import add_did, attach_dids_to_dids
 from rucio.core.replica import add_replicas
 from rucio.core.rule import add_rule, list_rules, update_rule
 from rucio.core.scope import list_scopes
 from rucio.db.sqla import models
 from rucio.db.sqla.constants import DIDType
-from rucio.db.sqla.session import transactional_session, read_session
+from rucio.db.sqla.session import read_session, transactional_session
 
 if TYPE_CHECKING:
     from sqlalchemy.orm import Session
 
 
 @read_session
 def _exists(scope, name, *, session: "Session"):
```

### Comparing `rucio-34.0.0rc2/lib/rucio/core/distance.py` & `rucio-34.1.0/lib/rucio/core/distance.py`

 * *Files 10% similar despite different names*

```diff
@@ -1,37 +1,36 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-from typing import TYPE_CHECKING
+from typing import TYPE_CHECKING, Any, Optional
 
 from sqlalchemy.exc import DatabaseError, IntegrityError
 from sqlalchemy.orm import aliased
 
 from rucio.common import exception
-from rucio.db.sqla.models import Distance, RSE
-from rucio.db.sqla.session import transactional_session, read_session
+from rucio.db.sqla.models import RSE, Distance
+from rucio.db.sqla.session import read_session, transactional_session
 
 if TYPE_CHECKING:
     from sqlalchemy.orm import Session
 
 
 @transactional_session
-def add_distance(src_rse_id, dest_rse_id, distance=None, *, session: "Session"):
+def add_distance(src_rse_id: str, dest_rse_id: str, distance: Optional[int] = None, *, session: "Session") -> None:
     """
     Add a src-dest distance.
 
     :param src_rse_id: The source RSE ID.
     :param dest_rse_id: The destination RSE ID.
     :param distance: Distance as an integer.
     :param session: The database session to use.
@@ -43,17 +42,17 @@
     except IntegrityError:
         raise exception.Duplicate()
     except DatabaseError as error:
         raise exception.RucioException(error.args)
 
 
 @read_session
-def get_distances(src_rse_id=None, dest_rse_id=None, *, session: "Session") -> list[dict]:
+def get_distances(src_rse_id: Optional[str] = None, dest_rse_id: Optional[str] = None, *, session: "Session") -> list[dict[str, Any]]:
     """
-    Get distances between rses.
+    Get distances between RSEs.
 
     :param src_rse_id: The source RSE ID.
     :param dest_rse_id: The destination RSE ID.
     :param session: The database session to use.
 
     :returns distance: List of dictionaries.
     """
@@ -74,17 +73,17 @@
                 distances.append(t2)
         return distances
     except IntegrityError as error:
         raise exception.RucioException(error.args)
 
 
 @transactional_session
-def delete_distances(src_rse_id=None, dest_rse_id=None, *, session: "Session"):
+def delete_distances(src_rse_id: Optional[str] = None, dest_rse_id: Optional[str] = None, *, session: "Session") -> None:
     """
-    Delete distances with the given RSE ids.
+    Delete distances with the given RSE IDs.
 
     :param src_rse_id: The source RSE ID.
     :param dest_rse_id: The destination RSE ID.
     :param session: The database session to use.
     """
 
     try:
@@ -97,17 +96,17 @@
 
         query.delete()
     except IntegrityError as error:
         raise exception.RucioException(error.args)
 
 
 @transactional_session
-def update_distances(src_rse_id=None, dest_rse_id=None, distance=None, *, session: "Session"):
+def update_distances(src_rse_id: Optional[str] = None, dest_rse_id: Optional[str] = None, distance: Optional[str] = None, *, session: "Session") -> None:
     """
-    Update distances with the given RSE ids.
+    Update distances with the given RSE IDs.
 
     :param src_rse_id: The source RSE ID.
     :param dest_rse_id: The destination RSE ID.
     :param distance: The new distance to set
     :param session: The database session to use.
     """
     try:
@@ -118,26 +117,26 @@
             query = query.filter(Distance.dest_rse_id == dest_rse_id)
         query.update({Distance.distance: distance})
     except IntegrityError as error:
         raise exception.RucioException(error.args)
 
 
 @read_session
-def list_distances(filter_={}, *, session: "Session"):
+def list_distances(filter_: dict[str, Any] = {}, *, session: "Session") -> list[dict[str, Any]]:
     """
     Get distances between all the RSEs.
 
     :param filter_: dictionary to filter distances.
     :param session: The database session in use.
     """
     return [distance.to_dict() for distance in session.query(Distance).all()]
 
 
 @read_session
-def export_distances(vo='def', *, session: "Session"):
+def export_distances(vo: str = 'def', *, session: "Session") -> dict[str, Any]:
     """
     Export distances between all the RSEs using RSE ids.
     :param vo: The VO to export.
     :param session: The database session to use.
     :returns distance: dictionary of dictionaries with all the distances.
     """
```

### Comparing `rucio-34.0.0rc2/lib/rucio/core/exporter.py` & `rucio-34.1.0/lib/rucio/core/exporter.py`

 * *Files 6% similar despite different names*

```diff
@@ -1,33 +1,33 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-from typing import TYPE_CHECKING
+from typing import TYPE_CHECKING, Any
 
-from rucio.core import rse as rse_module, distance as distance_module
+from rucio.core import distance as distance_module
+from rucio.core import rse as rse_module
 from rucio.db.sqla.session import transactional_session
 
 if TYPE_CHECKING:
     from sqlalchemy.orm import Session
 
 
 @transactional_session
-def export_rses(vo='def', *, session: "Session"):
+def export_rses(vo: str = 'def', *, session: "Session") -> dict[str, dict[str, Any]]:
     """
     Export RSE data.
 
     :param vo: The VO to export.
     :param session: database session in use.
     """
     data = {}
@@ -35,15 +35,15 @@
         rse_id = rse['id']
         data[rse_id] = rse_module.export_rse(rse_id, session=session)
 
     return data
 
 
 @transactional_session
-def export_data(vo='def', distance=True, *, session: "Session"):
+def export_data(vo: str = 'def', distance: bool = True, *, session: "Session") -> dict[str, Any]:
     """
     Export data.
 
     :param vo: The VO to export.
     :param distance: To enable the reporting of distance.
     :param session: database session in use.
     """
```

### Comparing `rucio-34.0.0rc2/lib/rucio/core/heartbeat.py` & `rucio-34.1.0/lib/rucio/core/heartbeat.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/core/identity.py` & `rucio-34.1.0/lib/rucio/core/identity.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,16 +11,15 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import hashlib
 import os
 from re import match
-from typing import Optional
-from typing import TYPE_CHECKING
+from typing import TYPE_CHECKING, Optional
 
 from sqlalchemy import select, true
 from sqlalchemy.exc import IntegrityError
 
 from rucio.common import exception
 from rucio.common.types import InternalAccount
 from rucio.core.account import account_exists
```

### Comparing `rucio-34.0.0rc2/lib/rucio/core/importer.py` & `rucio-34.1.0/lib/rucio/core/importer.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -14,17 +13,20 @@
 # limitations under the License.
 
 from typing import TYPE_CHECKING
 
 from rucio.common.config import config_get
 from rucio.common.exception import RSEOperationNotSupported
 from rucio.common.types import InternalAccount
-from rucio.core import rse as rse_module, distance as distance_module, account as account_module, identity as identity_module
+from rucio.core import account as account_module
+from rucio.core import distance as distance_module
+from rucio.core import identity as identity_module
+from rucio.core import rse as rse_module
 from rucio.db.sqla import models
-from rucio.db.sqla.constants import RSEType, AccountType, IdentityType
+from rucio.db.sqla.constants import AccountType, IdentityType, RSEType
 from rucio.db.sqla.session import transactional_session
 
 if TYPE_CHECKING:
     from sqlalchemy.orm import Session
 
 
 @transactional_session
```

### Comparing `rucio-34.0.0rc2/lib/rucio/core/lifetime_exception.py` & `rucio-34.1.0/lib/rucio/core/lifetime_exception.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -20,28 +19,30 @@
 
 from sqlalchemy import or_, select, update
 from sqlalchemy.exc import IntegrityError
 from sqlalchemy.orm.exc import NoResultFound
 
 import rucio.common.policy
 from rucio.common.config import config_get, config_get_int, config_get_list
-from rucio.common.exception import RucioException, LifetimeExceptionDuplicate, LifetimeExceptionNotFound, UnsupportedOperation, ConfigNotFound
+from rucio.common.exception import ConfigNotFound, LifetimeExceptionDuplicate, LifetimeExceptionNotFound, RucioException, UnsupportedOperation
 from rucio.common.utils import generate_uuid, str_to_date
 from rucio.core.message import add_message
 from rucio.core.rse import list_rse_attributes
 from rucio.db.sqla import models
 from rucio.db.sqla.constants import DIDType, LifetimeExceptionsState
-from rucio.db.sqla.session import transactional_session, stream_session, read_session
+from rucio.db.sqla.session import read_session, stream_session, transactional_session
 
 if TYPE_CHECKING:
     from collections.abc import Iterator
     from typing import Any, Optional, Union
-    from rucio.common.types import InternalAccount, InternalScope
+
     from sqlalchemy.orm import Session
 
+    from rucio.common.types import InternalAccount, InternalScope
+
 
 @stream_session
 def list_exceptions(
         exception_id: 'Optional[str]',
         states: 'list[LifetimeExceptionsState]',
         *,
         session: 'Session',
```

### Comparing `rucio-34.0.0rc2/lib/rucio/core/lock.py` & `rucio-34.1.0/lib/rucio/core/lock.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -22,17 +21,17 @@
 
 import rucio.core.did
 import rucio.core.rule
 from rucio.common.exception import DataIdentifierNotFound
 from rucio.common.types import InternalScope
 from rucio.core.lifetime_exception import define_eol
 from rucio.core.rse import get_rse_attribute, get_rse_name
-from rucio.db.sqla import models, filter_thread_work
-from rucio.db.sqla.constants import LockState, RuleState, RuleGrouping, DIDType, RuleNotification
-from rucio.db.sqla.session import read_session, transactional_session, stream_session
+from rucio.db.sqla import filter_thread_work, models
+from rucio.db.sqla.constants import DIDType, LockState, RuleGrouping, RuleNotification, RuleState
+from rucio.db.sqla.session import read_session, stream_session, transactional_session
 
 if TYPE_CHECKING:
     from sqlalchemy.orm import Session
 
 
 @stream_session
 def get_dataset_locks(scope, name, *, session: "Session"):
```

### Comparing `rucio-34.0.0rc2/lib/rucio/core/message.py` & `rucio-34.1.0/lib/rucio/core/message.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,27 +11,28 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import json
 from typing import TYPE_CHECKING
 
-from sqlalchemy import or_, delete, update, insert
+from sqlalchemy import delete, insert, or_, update
 from sqlalchemy.exc import IntegrityError
 
 from rucio.common.config import config_get_list
-from rucio.common.constants import HermesService, MAX_MESSAGE_LENGTH
+from rucio.common.constants import MAX_MESSAGE_LENGTH, HermesService
 from rucio.common.exception import InvalidObject, RucioException
 from rucio.common.utils import APIEncoder, chunks
 from rucio.db.sqla import filter_thread_work
 from rucio.db.sqla.models import Message, MessageHistory
 from rucio.db.sqla.session import transactional_session
 
 if TYPE_CHECKING:
     from typing import Any, Optional
+
     from sqlalchemy.orm import Session
 
     MessageType = dict[str, Any]
     MessagesListType = list[MessageType]
 
 
 @transactional_session
```

### Comparing `rucio-34.0.0rc2/lib/rucio/core/meta_conventions.py` & `rucio-34.1.0/lib/rucio/core/meta_conventions.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,21 +11,19 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 from re import match
 from typing import TYPE_CHECKING, Optional, Union
 
-from sqlalchemy import select, and_
+from sqlalchemy import and_, select
 from sqlalchemy.exc import IntegrityError, NoResultFound
 
 from rucio.common.constraints import AUTHORIZED_VALUE_TYPES
-from rucio.common.exception import (Duplicate, RucioException,
-                                    KeyNotFound, InvalidValueForKey, UnsupportedValueType,
-                                    InvalidObject, UnsupportedKeyType)
+from rucio.common.exception import Duplicate, InvalidObject, InvalidValueForKey, KeyNotFound, RucioException, UnsupportedKeyType, UnsupportedValueType
 from rucio.db.sqla import models
 from rucio.db.sqla.constants import DIDType, KeyType
 from rucio.db.sqla.session import read_session, transactional_session
 
 if TYPE_CHECKING:
     from sqlalchemy.orm import Session
```

### Comparing `rucio-34.0.0rc2/lib/rucio/core/monitor.py` & `rucio-34.1.0/lib/rucio/core/monitor.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -13,31 +12,30 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 """
 Graphite and prometheus metrics
 """
 
-import __main__ as main
 import atexit
 import logging
 import os
 import string
 from abc import abstractmethod
 from collections.abc import Callable, Iterable, Sequence
 from datetime import datetime, timedelta
 from functools import wraps
 from pathlib import Path
 from threading import Lock
 from typing import Any, Optional, TypeVar, Union
 
-from prometheus_client import (Counter, Gauge, Histogram, REGISTRY, CollectorRegistry, generate_latest, multiprocess,
-                               push_to_gateway, start_http_server, values)
+from prometheus_client import REGISTRY, CollectorRegistry, Counter, Gauge, Histogram, generate_latest, multiprocess, push_to_gateway, start_http_server, values
 from statsd import StatsClient
 
+import __main__ as main
 from rucio.common.config import config_get, config_get_bool, config_get_int
 from rucio.common.stopwatch import Stopwatch
 from rucio.common.utils import retrying
 
 _T = TypeVar('_T')
 _M = TypeVar('_M', bound="_MultiMetric")
```

### Comparing `rucio-34.0.0rc2/lib/rucio/core/naming_convention.py` & `rucio-34.1.0/lib/rucio/core/naming_convention.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,31 +1,30 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-from re import match, compile, error
+from re import compile, error, match
 from traceback import format_exc
 from typing import TYPE_CHECKING
 
 from dogpile.cache.api import NO_VALUE
 from sqlalchemy.exc import IntegrityError
 
 from rucio.common.cache import make_region_memcached
-from rucio.common.exception import Duplicate, RucioException, InvalidObject
+from rucio.common.exception import Duplicate, InvalidObject, RucioException
 from rucio.db.sqla import models
 from rucio.db.sqla.constants import KeyType
 from rucio.db.sqla.session import read_session, transactional_session
 
 if TYPE_CHECKING:
     from sqlalchemy.orm import Session
```

### Comparing `rucio-34.0.0rc2/lib/rucio/core/nongrid_trace.py` & `rucio-34.1.0/lib/rucio/core/nongrid_trace.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/core/oidc.py` & `rucio-34.1.0/lib/rucio/core/oidc.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -16,44 +15,41 @@
 import hashlib
 import json
 import logging
 import random
 import subprocess
 import traceback
 from datetime import datetime, timedelta
-from typing import Any, Final, TYPE_CHECKING, Optional
-from urllib.parse import urljoin, urlparse, parse_qs
+from math import floor
+from typing import TYPE_CHECKING, Any, Final, Optional
+from urllib.parse import parse_qs, urljoin, urlparse
 
 import requests
 from dogpile.cache.api import NoValue
 from jwkest.jws import JWS
 from jwkest.jwt import JWT
-from math import floor
 from oic import rndstr
 from oic.oauth2.message import CCAccessTokenRequest
-from oic.oic import Client, Grant, Token, REQUEST2ENDPOINT
-from oic.oic.message import (AccessTokenResponse, AuthorizationResponse,
-                             Message, RegistrationResponse)
+from oic.oic import REQUEST2ENDPOINT, Client, Grant, Token
+from oic.oic.message import AccessTokenResponse, AuthorizationResponse, Message, RegistrationResponse
 from oic.utils import time_util
 from oic.utils.authn.client import CLIENT_AUTHN_METHOD
 from sqlalchemy import delete, select, update
 from sqlalchemy.sql.expression import true
 
 from rucio.common import types
 from rucio.common.cache import make_region_memcached
 from rucio.common.config import config_get, config_get_int
-from rucio.common.exception import (CannotAuthenticate, CannotAuthorize,
-                                    RucioException)
+from rucio.common.exception import CannotAuthenticate, CannotAuthorize, RucioException
 from rucio.common.stopwatch import Stopwatch
 from rucio.common.utils import all_oidc_req_claims_present, build_url, val_to_space_sep_str
 from rucio.core.account import account_exists
 from rucio.core.identity import exist_identity_account, get_default_account
 from rucio.core.monitor import MetricManager
-from rucio.db.sqla import filter_thread_work
-from rucio.db.sqla import models
+from rucio.db.sqla import filter_thread_work, models
 from rucio.db.sqla.constants import IdentityType
 from rucio.db.sqla.session import read_session, transactional_session
 
 if TYPE_CHECKING:
     from sqlalchemy.orm import Session
 
 # The WLCG Common JWT Profile dictates that the lifetime of access and ID tokens
```

### Comparing `rucio-34.0.0rc2/lib/rucio/core/permission/__init__.py` & `rucio-34.1.0/lib/rucio/core/permission/__init__.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -19,14 +18,15 @@
 from typing import TYPE_CHECKING
 
 from rucio.common import config, exception
 from rucio.common.utils import check_policy_package_version
 
 if TYPE_CHECKING:
     from typing import Optional
+
     from sqlalchemy.orm import Session
 
 # dictionary of permission modules for each VO
 permission_modules = {}
 
 try:
     multivo = config.config_get_bool('common', 'multi_vo')
```

### Comparing `rucio-34.0.0rc2/lib/rucio/core/permission/atlas.py` & `rucio-34.1.0/lib/rucio/core/permission/atlas.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -13,24 +12,26 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 from typing import TYPE_CHECKING
 
 import rucio.core.did
 import rucio.core.scope
-from rucio.core.account import list_account_attributes, has_account_attribute
+from rucio.core.account import has_account_attribute, list_account_attributes
 from rucio.core.identity import exist_identity_account
 from rucio.core.rse import list_rse_attributes
 from rucio.core.rse_expression_parser import parse_expression
 from rucio.core.rule import get_rule
-from rucio.db.sqla.constants import IdentityType, BadPFNStatus
+from rucio.db.sqla.constants import BadPFNStatus, IdentityType
 
 if TYPE_CHECKING:
     from typing import Optional
+
     from sqlalchemy.orm import Session
+
     from rucio.common.types import InternalAccount
 
 
 def has_permission(issuer, action, kwargs, *, session: "Optional[Session]" = None):
     """
     Checks if an account has the specified permission to
     execute an action with parameters.
```

### Comparing `rucio-34.0.0rc2/lib/rucio/core/permission/belleii.py` & `rucio-34.1.0/lib/rucio/core/permission/belleii.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -13,26 +12,27 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 from typing import TYPE_CHECKING
 
 import rucio.core.scope
 from rucio.common.config import config_get
-from rucio.common.types import InternalScope, InternalAccount
+from rucio.common.types import InternalAccount, InternalScope
 from rucio.core.account import has_account_attribute, list_account_attributes
 from rucio.core.did import get_metadata
 from rucio.core.identity import exist_identity_account
 from rucio.core.lifetime_exception import list_exceptions
 from rucio.core.rse import list_rse_attributes
 from rucio.core.rse_expression_parser import parse_expression
 from rucio.core.rule import get_rule
 from rucio.db.sqla.constants import IdentityType
 
 if TYPE_CHECKING:
     from typing import Optional
+
     from sqlalchemy.orm import Session
 
 
 def has_permission(issuer: "InternalAccount", action: str, kwargs: dict, *, session: "Optional[Session]" = None) -> bool:
     """
     Checks if an account has the specified permission to
     execute an action with parameters.
```

### Comparing `rucio-34.0.0rc2/lib/rucio/core/permission/cms.py` & `rucio-34.1.0/lib/rucio/core/permission/cms.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -22,15 +21,17 @@
 from rucio.core.rse import list_rse_attributes
 from rucio.core.rse_expression_parser import parse_expression
 from rucio.core.rule import get_rule
 from rucio.db.sqla.constants import IdentityType
 
 if TYPE_CHECKING:
     from typing import Optional
+
     from sqlalchemy.orm import Session
+
     from rucio.common.types import InternalAccount
 
 
 def has_permission(issuer, action, kwargs, *, session: "Optional[Session]" = None):
     """
     Checks if an account has the specified permission to
     execute an action with parameters.
```

### Comparing `rucio-34.0.0rc2/lib/rucio/core/permission/escape.py` & `rucio-34.1.0/lib/rucio/core/permission/escape.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,24 +11,26 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 from typing import TYPE_CHECKING
 
 import rucio.core.scope
-from rucio.core.account import list_account_attributes, has_account_attribute
+from rucio.core.account import has_account_attribute, list_account_attributes
 from rucio.core.identity import exist_identity_account
 from rucio.core.lifetime_exception import list_exceptions
 from rucio.core.rse import list_rse_attributes
 from rucio.core.rse_expression_parser import parse_expression
 from rucio.db.sqla.constants import IdentityType
 
 if TYPE_CHECKING:
     from typing import Optional
+
     from sqlalchemy.orm import Session
+
     from rucio.common.types import InternalAccount
 
 
 def has_permission(issuer, action, kwargs, *, session: "Optional[Session]" = None):
     """
     Checks if an account has the specified permission to
     execute an action with parameters.
```

### Comparing `rucio-34.0.0rc2/lib/rucio/core/permission/generic.py` & `rucio-34.1.0/lib/rucio/core/permission/generic.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,24 +11,26 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 from typing import TYPE_CHECKING
 
 import rucio.core.scope
-from rucio.core.account import list_account_attributes, has_account_attribute
+from rucio.core.account import has_account_attribute, list_account_attributes
 from rucio.core.identity import exist_identity_account
 from rucio.core.lifetime_exception import list_exceptions
 from rucio.core.rse import list_rse_attributes
 from rucio.core.rse_expression_parser import parse_expression
 from rucio.db.sqla.constants import IdentityType
 
 if TYPE_CHECKING:
     from typing import Optional
+
     from sqlalchemy.orm import Session
+
     from rucio.common.types import InternalAccount
 
 
 def has_permission(issuer, action, kwargs, *, session: "Optional[Session]" = None):
     """
     Checks if an account has the specified permission to
     execute an action with parameters.
```

### Comparing `rucio-34.0.0rc2/lib/rucio/core/permission/generic_multi_vo.py` & `rucio-34.1.0/lib/rucio/core/permission/generic_multi_vo.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,25 +11,27 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 from typing import TYPE_CHECKING
 
 import rucio.core.scope
-from rucio.core.account import list_account_attributes, has_account_attribute
+from rucio.core.account import has_account_attribute, list_account_attributes
 from rucio.core.identity import exist_identity_account
 from rucio.core.lifetime_exception import list_exceptions
 from rucio.core.rse import list_rse_attributes
 from rucio.core.rse_expression_parser import parse_expression
 from rucio.core.rule import get_rule
 from rucio.db.sqla.constants import IdentityType
 
 if TYPE_CHECKING:
     from typing import Optional
+
     from sqlalchemy.orm import Session
+
     from rucio.common.types import InternalAccount
 
 
 def has_permission(issuer, action, kwargs, *, session: "Optional[Session]" = None):
     """
     Checks if an account has the specified permission to
     execute an action with parameters.
```

### Comparing `rucio-34.0.0rc2/lib/rucio/core/quarantined_replica.py` & `rucio-34.1.0/lib/rucio/core/quarantined_replica.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,31 +1,30 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-from collections.abc import Iterable
 import datetime
+from collections.abc import Iterable
 from typing import TYPE_CHECKING, Any, Optional
 
 from sqlalchemy import and_, or_
 from sqlalchemy.sql.expression import false, insert
 
 from rucio.common.utils import chunks
-from rucio.db.sqla import models, filter_thread_work
+from rucio.db.sqla import filter_thread_work, models
 from rucio.db.sqla.session import read_session, transactional_session
 
 if TYPE_CHECKING:
     from sqlalchemy.orm import Session
 
 
 @transactional_session
```

### Comparing `rucio-34.0.0rc2/lib/rucio/core/replica.py` & `rucio-34.1.0/lib/rucio/core/replica.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -11,64 +10,64 @@
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 import copy
 import heapq
 import logging
+import math
 import random
 from collections import defaultdict, namedtuple
 from curses.ascii import isprint
 from datetime import datetime, timedelta
 from hashlib import sha256
 from itertools import groupby
 from json import dumps
 from re import match
 from struct import unpack
 from traceback import format_exc
 from typing import TYPE_CHECKING
 
-import math
 import requests
 from dogpile.cache.api import NO_VALUE
-from sqlalchemy import func, and_, or_, exists, not_, update, delete, insert, union
+from sqlalchemy import and_, delete, exists, func, insert, not_, or_, union, update
 from sqlalchemy.exc import DatabaseError, IntegrityError
 from sqlalchemy.orm import aliased
 from sqlalchemy.orm.exc import FlushError, NoResultFound
 from sqlalchemy.sql import label
-from sqlalchemy.sql.expression import case, select, text, false, true, null, literal, literal_column
+from sqlalchemy.sql.expression import case, false, literal, literal_column, null, select, text, true
 
 import rucio.core.did
 import rucio.core.lock
 from rucio.common import exception
 from rucio.common.cache import make_region_memcached
 from rucio.common.config import config_get, config_get_bool
 from rucio.common.constants import SuspiciousAvailability
 from rucio.common.types import InternalScope
-from rucio.common.utils import chunks, clean_surls, str_to_date, add_url_query
+from rucio.common.utils import add_url_query, chunks, clean_surls, str_to_date
 from rucio.core.credential import get_signed_url
 from rucio.core.message import add_messages
 from rucio.core.monitor import MetricManager
-from rucio.core.rse import get_rse, get_rse_name, get_rse_attribute, get_rse_vo, list_rses
+from rucio.core.rse import get_rse, get_rse_attribute, get_rse_name, get_rse_vo, list_rses
 from rucio.core.rse_counter import decrease, increase
 from rucio.core.rse_expression_parser import parse_expression
-from rucio.db.sqla import models, filter_thread_work
-from rucio.db.sqla.constants import (DIDType, ReplicaState, OBSOLETE, DIDAvailability,
-                                     BadFilesStatus, RuleState, BadPFNStatus)
-from rucio.db.sqla.session import (read_session, stream_session, transactional_session,
-                                   DEFAULT_SCHEMA_NAME, BASE)
+from rucio.db.sqla import filter_thread_work, models
+from rucio.db.sqla.constants import OBSOLETE, BadFilesStatus, BadPFNStatus, DIDAvailability, DIDType, ReplicaState, RuleState
+from rucio.db.sqla.session import BASE, DEFAULT_SCHEMA_NAME, read_session, stream_session, transactional_session
 from rucio.db.sqla.util import temp_table_mngr
 from rucio.rse import rsemanager as rsemgr
 
 if TYPE_CHECKING:
     from collections.abc import Iterator, Sequence
-    from rucio.rse.protocols.protocol import RSEProtocol
     from typing import Any, Optional
+
     from sqlalchemy.orm import Session
 
+    from rucio.rse.protocols.protocol import RSEProtocol
+
 REGION = make_region_memcached(expiration_time=60)
 METRICS = MetricManager(module=__name__)
 
 
 ScopeName = namedtuple('ScopeName', ['scope', 'name'])
 Association = namedtuple('Association', ['scope', 'name', 'child_scope', 'child_name'])
 
@@ -91,15 +90,15 @@
             rse_clause.append(models.BadReplicas.rse_id == rse['id'])
     elif filter_:
         # Ensure we limit results to current VO even if we don't specify an RSE expression
         for rse in list_rses(filters=filter_, session=session):
             rse_clause.append(models.BadReplicas.rse_id == rse['id'])
 
     if session.bind.dialect.name == 'oracle':
-        to_days = func.trunc(models.BadReplicas.created_at, str('DD'))
+        to_days = func.trunc(models.BadReplicas.created_at, 'DD')
     elif session.bind.dialect.name == 'mysql':
         to_days = func.date(models.BadReplicas.created_at)
     elif session.bind.dialect.name == 'postgresql':
         to_days = func.date_trunc('day', models.BadReplicas.created_at)
     else:
         to_days = func.strftime(models.BadReplicas.created_at, '%Y-%m-%d')
     query = session.query(func.count(), to_days, models.BadReplicas.rse_id, models.BadReplicas.state, models.BadReplicas.reason)
```

### Comparing `rucio-34.0.0rc2/lib/rucio/core/replica_sorter.py` & `rucio-34.1.0/lib/rucio/core/replica_sorter.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -15,23 +14,23 @@
 
 import random
 import shutil
 import socket
 import tarfile
 from collections import OrderedDict
 from datetime import datetime, timedelta
+from math import asin, cos, radians, sin, sqrt
 from pathlib import Path
 from tempfile import TemporaryDirectory, TemporaryFile
 from typing import TYPE_CHECKING, Union
 from urllib.parse import urlparse
 
 import geoip2.database
 import requests
 from dogpile.cache.api import NO_VALUE
-from math import asin, cos, radians, sin, sqrt
 
 from rucio.common import utils
 from rucio.common.cache import make_region_memcached
 from rucio.common.config import config_get, config_get_bool, config_get_int
 from rucio.common.exception import InvalidRSEExpression
 from rucio.core.rse_expression_parser import parse_expression
```

### Comparing `rucio-34.0.0rc2/lib/rucio/core/request.py` & `rucio-34.1.0/lib/rucio/core/request.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -19,43 +18,45 @@
 import logging
 import math
 import random
 import threading
 import traceback
 import uuid
 from abc import ABCMeta, abstractmethod
-from collections import namedtuple, defaultdict
-from collections.abc import Sequence, Mapping, Iterator
+from collections import defaultdict, namedtuple
+from collections.abc import Iterator, Mapping, Sequence
 from dataclasses import dataclass
 from typing import TYPE_CHECKING, Any, Optional, Union
 
-from sqlalchemy import and_, or_, update, select, delete, exists, insert
+from sqlalchemy import and_, delete, exists, insert, or_, select, update
 from sqlalchemy.exc import IntegrityError
 from sqlalchemy.orm import aliased
-from sqlalchemy.sql.expression import asc, true, false, null, func
+from sqlalchemy.sql.expression import asc, false, func, null, true
+from sqlalchemy.sql.functions import coalesce
 
 from rucio.common.config import config_get_bool, config_get_int
-from rucio.common.exception import RequestNotFound, RucioException, UnsupportedOperation, InvalidRSEExpression
+from rucio.common.exception import InvalidRSEExpression, RequestNotFound, RucioException, UnsupportedOperation
 from rucio.common.types import InternalAccount, InternalScope
-from rucio.common.utils import generate_uuid, chunks
+from rucio.common.utils import chunks, generate_uuid
 from rucio.core.distance import get_distances
 from rucio.core.message import add_message, add_messages
 from rucio.core.monitor import MetricManager
-from rucio.core.rse import get_rse_attribute, get_rse_name, get_rse_vo, RseData, RseCollection
+from rucio.core.rse import RseCollection, RseData, get_rse_attribute, get_rse_name, get_rse_vo
 from rucio.core.rse_expression_parser import parse_expression
-from rucio.db.sqla import models, filter_thread_work
-from rucio.db.sqla.constants import RequestState, RequestType, LockState, RequestErrMsg, ReplicaState, TransferLimitDirection
-from rucio.db.sqla.session import read_session, transactional_session, stream_session
+from rucio.db.sqla import filter_thread_work, models
+from rucio.db.sqla.constants import LockState, ReplicaState, RequestErrMsg, RequestState, RequestType, TransferLimitDirection
+from rucio.db.sqla.session import read_session, stream_session, transactional_session
 from rucio.db.sqla.util import temp_table_mngr
 
 RequestAndState = namedtuple('RequestAndState', ['request_id', 'request_state'])
 
 if TYPE_CHECKING:
 
     from sqlalchemy.orm import Session
+
     from rucio.rse.protocols.protocol import RSEProtocol
 
 """
 The core request.py is specifically for handling requests.
 Requests accessed by external_id (So called transfers), are covered in the core transfer.py
 """
 
@@ -447,21 +448,21 @@
     :param ignore_availability: Ignore blocklisted RSEs
     :param session: Database session to use.
     :returns: List of RequestWithSources objects.
     """
 
     if partition_hash_var is None:
         partition_hash_var = 'requests.id'
-
     if request_state is None:
         request_state = RequestState.QUEUED
-
     if request_type is None:
         request_type = [RequestType.TRANSFER]
 
+    now = datetime.datetime.utcnow()
+
     sub_requests = select(
         models.Request.id,
         models.Request.request_type,
         models.Request.rule_id,
         models.Request.scope,
         models.Request.name,
         models.Request.md5,
@@ -479,14 +480,19 @@
         models.Request.priority,
         models.Request.transfertool
     ).with_hint(
         models.Request, "INDEX(REQUESTS REQUESTS_TYP_STA_UPD_IDX)", 'oracle'
     ).where(
         models.Request.state == request_state,
         models.Request.request_type.in_(request_type)
+    ).outerjoin(
+        models.ReplicationRule,
+        models.Request.rule_id == models.ReplicationRule.id
+    ).where(
+        coalesce(models.ReplicationRule.expires_at, now) >= now
     ).join(
         models.RSE,
         models.RSE.id == models.Request.dest_rse_id
     ).where(
         models.RSE.deleted == false()
     ).outerjoin(
         models.TransferHop,
```

### Comparing `rucio-34.0.0rc2/lib/rucio/core/rse.py` & `rucio-34.1.0/lib/rucio/core/rse.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -10,36 +9,35 @@
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import json
-from collections.abc import Iterator, Iterable
+from collections.abc import Iterable, Iterator
 from datetime import datetime
 from io import StringIO
 from re import match
-from typing import Any, Generic, Optional, TypeVar, Union, TYPE_CHECKING
+from typing import TYPE_CHECKING, Any, Generic, Optional, TypeVar, Union
 
 import sqlalchemy
 from dogpile.cache.api import NO_VALUE
 from sqlalchemy.exc import DatabaseError, IntegrityError, OperationalError
 from sqlalchemy.orm import aliased
 from sqlalchemy.orm.exc import FlushError
-from sqlalchemy.sql.expression import or_, and_, desc, true, false, func, select, delete
+from sqlalchemy.sql.expression import and_, delete, desc, false, func, or_, select, true
 
-from rucio.common import exception, utils
+from rucio.common import exception, types, utils
 from rucio.common.cache import make_region_memcached
 from rucio.common.config import get_lfn2pfn_algorithm_default
-from rucio.common import types
 from rucio.common.utils import CHECKSUM_KEY, GLOBALLY_SUPPORTED_CHECKSUMS, Availability
 from rucio.core.rse_counter import add_counter, get_counter
 from rucio.db.sqla import models
-from rucio.db.sqla.constants import RSEType, ReplicaState
-from rucio.db.sqla.session import read_session, transactional_session, stream_session
+from rucio.db.sqla.constants import ReplicaState, RSEType
+from rucio.db.sqla.session import read_session, stream_session, transactional_session
 from rucio.db.sqla.util import temp_table_mngr
 
 if TYPE_CHECKING:
     from sqlalchemy.orm import Session
 
 T = TypeVar('T', bound="RseData")
```

### Comparing `rucio-34.0.0rc2/lib/rucio/core/rse_counter.py` & `rucio-34.1.0/lib/rucio/core/rse_counter.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -13,15 +12,15 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 from typing import TYPE_CHECKING
 
 from sqlalchemy.orm.exc import NoResultFound
 
 from rucio.common.exception import CounterNotFound
-from rucio.db.sqla import models, filter_thread_work
+from rucio.db.sqla import filter_thread_work, models
 from rucio.db.sqla.session import read_session, transactional_session
 
 if TYPE_CHECKING:
     from sqlalchemy.orm import Session
 
 
 @transactional_session
```

### Comparing `rucio-34.0.0rc2/lib/rucio/core/rse_expression_parser.py` & `rucio-34.1.0/lib/rucio/core/rse_expression_parser.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -18,15 +17,15 @@
 from hashlib import sha256
 from typing import TYPE_CHECKING
 
 from dogpile.cache.api import NoValue
 
 from rucio.common.cache import make_region_memcached
 from rucio.common.exception import InvalidRSEExpression, RSEWriteBlocked
-from rucio.core.rse import list_rses, get_rses_with_attribute, get_rse_attribute
+from rucio.core.rse import get_rse_attribute, get_rses_with_attribute, list_rses
 from rucio.db.sqla.session import transactional_session
 
 if TYPE_CHECKING:
     from sqlalchemy.orm import Session
 
 
 DEFAULT_RSE_ATTRIBUTE = r'([A-Za-z0-9]+([_-][A-Za-z0-9]+)*)'
@@ -205,15 +204,15 @@
             open_parantheses -= 1
         if (open_parantheses == 0):
             return expression[1:i]
         i = i + 1
     raise SystemError('This point in the code should not be reachable')
 
 
-class BaseExpressionElement(object, metaclass=abc.ABCMeta):
+class BaseExpressionElement(metaclass=abc.ABCMeta):
     @abc.abstractmethod
     def resolve_elements(self, session):
         """
         Resolve the ExpressionElement and return a set of RSE ids
 
         :param session:  Database session in use
         :returns:        (Set of RSE ids, Dictionary of RSE dicts)
```

### Comparing `rucio-34.0.0rc2/lib/rucio/core/rse_selector.py` & `rucio-34.1.0/lib/rucio/core/rse_selector.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,38 +1,37 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-from random import uniform, shuffle
+from random import shuffle, uniform
 from typing import TYPE_CHECKING
 
 from rucio.common.exception import InsufficientAccountLimit, InsufficientTargetRSEs, InvalidRuleWeight, RSEOverQuota
-from rucio.core.account import has_account_attribute, get_usage, get_all_rse_usages_per_account
-from rucio.core.account_limit import get_local_account_limit, get_global_account_limits
-from rucio.core.rse import list_rse_attributes, has_rse_attribute, get_rse_limits
+from rucio.core.account import get_all_rse_usages_per_account, get_usage, has_account_attribute
+from rucio.core.account_limit import get_global_account_limits, get_local_account_limit
+from rucio.core.rse import get_rse_limits, has_rse_attribute, list_rse_attributes
 from rucio.core.rse_counter import get_counter as get_rse_counter
 from rucio.core.rse_expression_parser import parse_expression
 from rucio.db.sqla.session import read_session
 
 if TYPE_CHECKING:
     from sqlalchemy.orm import Session
 
 
-class RSESelector():
+class RSESelector:
     """
     Representation of the RSE selector
     """
 
     @read_session
     def __init__(self, account, rses, weight, copies, ignore_account_limit=False, *, session: "Session"):
         """
```

### Comparing `rucio-34.0.0rc2/lib/rucio/core/rule.py` & `rucio-34.1.0/lib/rucio/core/rule.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -11,62 +10,81 @@
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import json
 import logging
-from collections.abc import Iterable, Iterator, Sequence
+from collections.abc import Iterator, Sequence
 from configparser import NoOptionError, NoSectionError
 from copy import deepcopy
 from datetime import datetime, timedelta
 from os import path
 from re import match
 from string import Template
 from typing import TYPE_CHECKING, Any, Callable, Literal, Optional, Type, TypeVar, Union
 
 from dogpile.cache.api import NoValue
 from sqlalchemy import delete, desc, select, update
-from sqlalchemy.exc import IntegrityError, StatementError
-from sqlalchemy.exc import NoResultFound  # https://pydoc.dev/sqlalchemy/latest/sqlalchemy.exc.NoResultFound.html
+from sqlalchemy.exc import (
+    IntegrityError,
+    NoResultFound,  # https://pydoc.dev/sqlalchemy/latest/sqlalchemy.exc.NoResultFound.html
+    StatementError,
+)
 from sqlalchemy.sql import func
-from sqlalchemy.sql.expression import and_, or_, true, null, tuple_, false
+from sqlalchemy.sql.expression import and_, false, null, or_, true, tuple_
 
 import rucio.core.did
 import rucio.core.lock  # import get_replica_locks, get_files_and_replica_locks_of_dataset
 import rucio.core.replica  # import get_and_lock_file_replicas, get_and_lock_file_replicas_for_dataset
 from rucio.common.cache import make_region_memcached
 from rucio.common.config import config_get
-from rucio.common.exception import (InvalidRSEExpression, InvalidReplicationRule, InsufficientAccountLimit,
-                                    DataIdentifierNotFound, RuleNotFound, InputValidationError, RSEOverQuota,
-                                    ReplicationRuleCreationTemporaryFailed, InsufficientTargetRSEs, RucioException,
-                                    InvalidRuleWeight, StagingAreaRuleRequiresLifetime, DuplicateRule,
-                                    InvalidObject, RSEWriteBlocked, RuleReplaceFailed, RequestNotFound,
-                                    ManualRuleApprovalBlocked, UnsupportedOperation, UndefinedPolicy, InvalidValueForKey,
-                                    InvalidSourceReplicaExpression)
+from rucio.common.exception import (
+    DataIdentifierNotFound,
+    DuplicateRule,
+    InputValidationError,
+    InsufficientAccountLimit,
+    InsufficientTargetRSEs,
+    InvalidObject,
+    InvalidReplicationRule,
+    InvalidRSEExpression,
+    InvalidRuleWeight,
+    InvalidSourceReplicaExpression,
+    InvalidValueForKey,
+    ManualRuleApprovalBlocked,
+    ReplicationRuleCreationTemporaryFailed,
+    RequestNotFound,
+    RSEOverQuota,
+    RSEWriteBlocked,
+    RucioException,
+    RuleNotFound,
+    RuleReplaceFailed,
+    StagingAreaRuleRequiresLifetime,
+    UndefinedPolicy,
+    UnsupportedOperation,
+)
 from rucio.common.plugins import PolicyPackageAlgorithms
-from rucio.common.policy import policy_filter, get_scratchdisk_lifetime
+from rucio.common.policy import get_scratchdisk_lifetime, policy_filter
 from rucio.common.schema import validate_schema
-from rucio.common.types import InternalScope, InternalAccount, LoggerFunction, RuleDict
-from rucio.common.utils import str_to_date, sizefmt, chunks
-from rucio.core import account_counter, rse_counter, request as request_core, transfer as transfer_core
-from rucio.core.account import get_account
-from rucio.core.account import has_account_attribute
+from rucio.common.types import DIDDict, InternalAccount, InternalScope, LoggerFunction, RuleDict
+from rucio.common.utils import chunks, sizefmt, str_to_date
+from rucio.core import account_counter, rse_counter
+from rucio.core import request as request_core
+from rucio.core import transfer as transfer_core
+from rucio.core.account import get_account, has_account_attribute
 from rucio.core.lifetime_exception import define_eol
 from rucio.core.message import add_message
 from rucio.core.monitor import MetricManager
-from rucio.core.rse import get_rse_name, list_rse_attributes, get_rse, get_rse_usage
+from rucio.core.rse import get_rse, get_rse_name, get_rse_usage, list_rse_attributes
 from rucio.core.rse_expression_parser import parse_expression
 from rucio.core.rse_selector import RSESelector
-from rucio.core.rule_grouping import apply_rule_grouping, repair_stuck_locks_and_apply_rule_grouping, create_transfer_dict, apply_rule
-from rucio.db.sqla import models, filter_thread_work
-from rucio.db.sqla.constants import (LockState, ReplicaState, RuleState, RuleGrouping,
-                                     DIDAvailability, DIDReEvaluation, DIDType, BadFilesStatus,
-                                     RequestType, RuleNotification, OBSOLETE, RSEType)
-from rucio.db.sqla.session import read_session, transactional_session, stream_session
+from rucio.core.rule_grouping import apply_rule, apply_rule_grouping, create_transfer_dict, repair_stuck_locks_and_apply_rule_grouping
+from rucio.db.sqla import filter_thread_work, models
+from rucio.db.sqla.constants import OBSOLETE, BadFilesStatus, DIDAvailability, DIDReEvaluation, DIDType, LockState, ReplicaState, RequestType, RSEType, RuleGrouping, RuleNotification, RuleState
+from rucio.db.sqla.session import read_session, stream_session, transactional_session
 
 if TYPE_CHECKING:
     from sqlalchemy.orm import Session
 
 
 REGION = make_region_memcached(expiration_time=900)
 METRICS = MetricManager(module=__name__)
@@ -140,15 +158,15 @@
                 auto_approve = True
 
         return auto_approve
 
 
 @transactional_session
 def add_rule(
-    dids: Sequence[dict[str, Any]],
+    dids: Sequence[DIDDict],
     account: InternalAccount,
     copies: int,
     rse_expression: str,
     grouping: Literal['ALL', 'DATASET', 'NONE'],
     weight: Optional[str],
     lifetime: Optional[int],
     locked: bool,
@@ -454,15 +472,15 @@
                    new_rule.locks_replicating_cnt, new_rule.locks_stuck_cnt, new_rule.scope, new_rule.name, str(new_rule.state))
 
     return rule_ids
 
 
 @transactional_session
 def add_rules(
-    dids: Sequence[dict[str, Any]],
+    dids: Sequence[DIDDict],
     rules: Sequence[RuleDict],
     *,
     session: "Session",
     logger: LoggerFunction = logging.log
 ) -> dict[tuple[InternalScope, str], list[str]]:
     """
     Adds a list of replication rules to every did in dids
@@ -1080,32 +1098,37 @@
     List replication rules a file is affected from.
 
     :param scope:   Scope of the file.
     :param name:    Name of the file.
     :param session: The database session in use.
     :raises:        RucioException
     """
-
     rucio.core.did.get_did(scope=scope, name=name, session=session)  # Check if the did acually exists
     stmt = select(
-        models.ReplicationRule
+        models.ReplicationRule,
+        models.DataIdentifier.bytes
     ).distinct(
     ).join(
         models.ReplicaLock,
         models.ReplicationRule.id == models.ReplicaLock.rule_id
+    ).join(
+        models.DataIdentifier,
+        and_(models.ReplicationRule.scope == models.DataIdentifier.scope,
+             models.ReplicationRule.name == models.DataIdentifier.name)
     ).with_hint(
         models.ReplicaLock, 'INDEX(LOCKS LOCKS_PK)', 'oracle'
     ).where(
         and_(models.ReplicaLock.scope == scope,
              models.ReplicaLock.name == name)
     )
-
     try:
-        for result in session.execute(stmt).yield_per(5):
-            yield result[0].to_dict()
+        for rule, data_identifier_bytes in session.execute(stmt).yield_per(5):
+            d = rule.to_dict()
+            d['bytes'] = data_identifier_bytes
+            yield d
     except StatementError as exc:
         raise RucioException('Badly formatted input (IDs?)') from exc
 
 
 @transactional_session
 def delete_rule(
     rule_id: str,
@@ -2082,15 +2105,15 @@
 
 
 @read_session
 def get_updated_dids(
     total_workers: int,
     worker_number: int,
     limit: int = 100,
-    blocked_dids: Iterable[tuple[str, str]] = [],
+    blocked_dids: Sequence[tuple[str, str]] = [],
     *,
     session: "Session"
 ) -> list[tuple[str, InternalScope, str, DIDReEvaluation]]:
     """
     Get updated dids.
 
     :param total_workers:      Number of total workers.
@@ -2109,16 +2132,16 @@
 
     # Remove blocked dids from query, but only do the first 30 ones, not to overload the query
     if blocked_dids:
         chunk = list(chunks(blocked_dids, 30))[0]
         stmt = stmt.where(tuple_(models.UpdatedDID.scope, models.UpdatedDID.name).notin_(chunk))
 
     if limit:
-        fetched_dids = stmt.order_by(models.UpdatedDID.created_at).limit(limit).all()
-        filtered_dids = [did for did in fetched_dids if (did.scope, did.name) not in blocked_dids]
+        fetched_dids = session.execute(stmt.order_by(models.UpdatedDID.created_at).limit(limit)).all()
+        filtered_dids = [did._tuple() for did in fetched_dids if (did.scope, did.name) not in blocked_dids]
         if len(fetched_dids) == limit and not filtered_dids:
             return get_updated_dids(total_workers=total_workers,
                                     worker_number=worker_number,
                                     limit=None,
                                     blocked_dids=blocked_dids,
                                     session=session)
         else:
@@ -2764,15 +2787,15 @@
         except NoOptionError as ex:
             logger(logging.ERROR, "Missing configuration option 'mailtemplatedir'.", exc_info=ex)
             return
 
         try:
             with open(template_path, 'r') as templatefile:
                 template = Template(templatefile.read())
-        except IOError as ex:
+        except OSError as ex:
             logger(logging.ERROR, "Couldn't open file '%s'", template_path, exc_info=ex)
             return
 
         email = get_account(account=rule.account, session=session).email
         if not email:
             logger(logging.INFO, 'No email associated with rule ID %s.', rule.id)
             return
@@ -2832,15 +2855,15 @@
                                       updated_at=rule.updated_at, child_rule_id=rule.child_rule_id, eol_at=rule.eol_at,
                                       split_container=rule.split_container, meta=rule.meta).save(session=session)
 
 
 @transactional_session
 def approve_rule(
     rule_id: str,
-    approver: Optional[str] = None,
+    approver: str = '',
     notify_approvers: bool = True,
     *,
     session: "Session"
 ) -> None:
     """
     Approve a specific replication rule.
 
@@ -2903,15 +2926,15 @@
     except StatementError as exc:
         raise RucioException('Badly formatted rule id (%s)' % (rule_id)) from exc
 
 
 @transactional_session
 def deny_rule(
     rule_id: str,
-    approver: Optional[str] = None,
+    approver: str = '',
     reason: Optional[str] = None,
     *,
     session: "Session"
 ) -> None:
     """
     Deny a specific replication rule.
 
@@ -3185,16 +3208,16 @@
         yield rule.to_dict()
 
 
 @transactional_session
 def __find_missing_locks_and_create_them(
     datasetfiles: Sequence[dict[str, Any]],
     locks: dict[tuple[InternalScope, str], Sequence[models.ReplicaLock]],
-    replicas: dict[tuple[InternalScope, str], Any],
-    source_replicas: dict[tuple[InternalScope, str], Any],
+    replicas: dict[tuple[InternalScope, str], Sequence[models.CollectionReplica]],
+    source_replicas: dict[tuple[InternalScope, str], Sequence[models.CollectionReplica]],
     rseselector: RSESelector,
     rule: models.ReplicationRule,
     source_rses: Sequence[str],
     *,
     session: "Session",
     logger: LoggerFunction = logging.log
 ) -> None:
@@ -3294,16 +3317,16 @@
     logger(logging.DEBUG, "Finished finding surplus locks for rule %s [%d/%d/%d]", str(rule.id), rule.locks_ok_cnt, rule.locks_replicating_cnt, rule.locks_stuck_cnt)
 
 
 @transactional_session
 def __find_stuck_locks_and_repair_them(
     datasetfiles: Sequence[dict[str, Any]],
     locks: dict[tuple[InternalScope, str], Sequence[models.ReplicaLock]],
-    replicas: dict[tuple[InternalScope, str], Any],
-    source_replicas: dict[tuple[InternalScope, str], Any],
+    replicas: dict[tuple[InternalScope, str], Sequence[models.CollectionReplica]],
+    source_replicas: dict[tuple[InternalScope, str], Sequence[models.CollectionReplica]],
     rseselector: RSESelector,
     rule: models.ReplicationRule,
     source_rses: Sequence[str],
     *,
     session: "Session",
     logger: LoggerFunction = logging.log
 ) -> None:
@@ -4047,16 +4070,16 @@
     return datasetfiles, locks, replicas, source_replicas
 
 
 @transactional_session
 def __create_locks_replicas_transfers(
     datasetfiles: Sequence[dict[str, Any]],
     locks: dict[tuple[InternalScope, str], Sequence[models.ReplicaLock]],
-    replicas: dict[tuple[InternalScope, str], Any],
-    source_replicas: dict[tuple[InternalScope, str], Any],
+    replicas: dict[tuple[InternalScope, str], Sequence[models.CollectionReplica]],
+    source_replicas: dict[tuple[InternalScope, str], Sequence[models.CollectionReplica]],
     rseselector: RSESelector,
     rule: models.ReplicationRule,
     preferred_rse_ids: Sequence[str] = [],
     source_rses: Sequence[str] = [],
     *,
     session: "Session",
     logger: LoggerFunction = logging.log
```

### Comparing `rucio-34.0.0rc2/lib/rucio/core/rule_grouping.py` & `rucio-34.1.0/lib/rucio/core/rule_grouping.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -23,31 +22,32 @@
 
 import rucio.core.did
 import rucio.core.lock
 import rucio.core.replica
 from rucio.common.config import config_get_int
 from rucio.common.exception import InsufficientTargetRSEs
 from rucio.common.types import InternalScope
-from rucio.core import account_counter, rse_counter, request as request_core
-from rucio.core.rse_selector import RSESelector
+from rucio.core import account_counter, rse_counter
+from rucio.core import request as request_core
 from rucio.core.rse import get_rse, get_rse_attribute, get_rse_name
+from rucio.core.rse_selector import RSESelector
 from rucio.db.sqla import models
-from rucio.db.sqla.constants import LockState, RuleGrouping, ReplicaState, RequestType, DIDType, OBSOLETE
+from rucio.db.sqla.constants import OBSOLETE, DIDType, LockState, ReplicaState, RequestType, RuleGrouping
 from rucio.db.sqla.session import transactional_session
 
 if TYPE_CHECKING:
     from sqlalchemy.orm import Session
 
 
 @transactional_session
 def apply_rule_grouping(
     datasetfiles: Sequence[dict[str, Any]],
     locks: dict[tuple[InternalScope, str], models.ReplicaLock],
-    replicas: dict[tuple[InternalScope, str], Any],
-    source_replicas: dict[tuple[InternalScope, str], Any],
+    replicas: dict[tuple[InternalScope, str], Sequence[models.CollectionReplica]],
+    source_replicas: dict[tuple[InternalScope, str], Sequence[models.CollectionReplica]],
     rseselector: RSESelector, rule: models.ReplicationRule,
     preferred_rse_ids: Sequence[str] = [],
     source_rses: Sequence[str] = [],
     *,
     session: "Session"
 ) -> tuple[dict[str, list[dict[str, models.RSEFileAssociation]]],
            dict[str, list[dict[str, models.ReplicaLock]]],
```

### Comparing `rucio-34.0.0rc2/lib/rucio/core/scope.py` & `rucio-34.1.0/lib/rucio/core/scope.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/core/subscription.py` & `rucio-34.1.0/lib/rucio/core/subscription.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -22,23 +21,25 @@
 
 from sqlalchemy import func
 from sqlalchemy.exc import IntegrityError, StatementError
 from sqlalchemy.orm import aliased
 from sqlalchemy.orm.exc import NoResultFound
 
 from rucio.common.config import config_get
-from rucio.common.exception import SubscriptionNotFound, SubscriptionDuplicate, RucioException
+from rucio.common.exception import RucioException, SubscriptionDuplicate, SubscriptionNotFound
 from rucio.db.sqla import models
 from rucio.db.sqla.constants import SubscriptionState
-from rucio.db.sqla.session import transactional_session, stream_session, read_session
+from rucio.db.sqla.session import read_session, stream_session, transactional_session
 
 if TYPE_CHECKING:
     from collections.abc import Callable, Iterator
     from typing import Any, Optional
+
     from sqlalchemy.orm import Session
+
     from rucio.common.types import InternalAccount
     LoggerFunction = Callable[..., Any]
     SubscriptionType = dict
 
 
 @transactional_session
 def add_subscription(name: str,
```

### Comparing `rucio-34.0.0rc2/lib/rucio/core/topology.py` & `rucio-34.1.0/lib/rucio/core/topology.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -16,37 +15,37 @@
 import datetime
 import itertools
 import logging
 import threading
 import weakref
 from collections.abc import Callable, Iterable, Iterator
 from decimal import Decimal
-from typing import TYPE_CHECKING, cast, Any, Generic, Optional, TypeVar, Union
+from typing import TYPE_CHECKING, Any, Generic, Optional, TypeVar, Union, cast
 
 from sqlalchemy import and_, select
 
-from rucio.common.config import config_get_int, config_get
-from rucio.common.exception import NoDistance, RSEProtocolNotSupported, InvalidRSEExpression
+from rucio.common.config import config_get, config_get_int
+from rucio.common.exception import InvalidRSEExpression, NoDistance, RSEProtocolNotSupported
 from rucio.common.utils import PriorityQueue
 from rucio.core.rse import RseCollection, RseData
 from rucio.core.rse_expression_parser import parse_expression
 from rucio.db.sqla import models
 from rucio.db.sqla.session import read_session, transactional_session
 from rucio.rse import rsemanager as rsemgr
 
 LoggerFunction = Callable[..., Any]
 _Number = Union[int, Decimal]
 TN = TypeVar("TN", bound="Node")
 TE = TypeVar("TE", bound="Edge")
 
 if TYPE_CHECKING:
-    from sqlalchemy.orm import Session
-
     from typing import Protocol
 
+    from sqlalchemy.orm import Session
+
     class _StateProvider(Protocol):
         @property
         def cost(self) -> _Number:
             ...
 
         @property
         def enabled(self) -> bool:
```

### Comparing `rucio-34.0.0rc2/lib/rucio/core/trace.py` & `rucio-34.1.0/lib/rucio/core/trace.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -20,20 +19,20 @@
 import ipaddress
 import json
 import logging.handlers
 import random
 import socket
 
 import stomp
-from jsonschema import validate, ValidationError, Draft7Validator
+from jsonschema import Draft7Validator, ValidationError, validate
 
 from rucio.common.config import config_get, config_get_int
 from rucio.common.exception import InvalidObject
 from rucio.common.logging import rucio_log_formatter
-from rucio.common.schema.generic import UUID, TIME_ENTRY, IPv4orIPv6
+from rucio.common.schema.generic import TIME_ENTRY, UUID, IPv4orIPv6
 from rucio.core.monitor import MetricManager
 
 METRICS = MetricManager(module=__name__)
 
 CONFIG_COMMON_LOGLEVEL = getattr(logging, config_get('common', 'loglevel', raise_exception=False, default='DEBUG').upper())
 
 CONFIG_TRACE_LOGLEVEL = getattr(logging, config_get('trace', 'loglevel', raise_exception=False, default='DEBUG').upper())
```

### Comparing `rucio-34.0.0rc2/lib/rucio/core/transfer.py` & `rucio-34.1.0/lib/rucio/core/transfer.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -27,38 +26,40 @@
 from dogpile.cache.api import NoValue
 from sqlalchemy import select, update
 from sqlalchemy.exc import IntegrityError
 
 from rucio.common import constants
 from rucio.common.config import config_get, config_get_list
 from rucio.common.constants import SUPPORTED_PROTOCOLS
-from rucio.common.exception import (InvalidRSEExpression,
-                                    RequestNotFound, RSEProtocolNotSupported,
-                                    RucioException, UnsupportedOperation)
+from rucio.common.exception import InvalidRSEExpression, RequestNotFound, RSEProtocolNotSupported, RucioException, UnsupportedOperation
 from rucio.common.utils import construct_surl
-from rucio.core import did, message as message_core, request as request_core
+from rucio.core import did
+from rucio.core import message as message_core
+from rucio.core import request as request_core
 from rucio.core.account import list_accounts
 from rucio.core.monitor import MetricManager
-from rucio.core.request import transition_request_state, RequestWithSources, RequestSource, TransferDestination, DirectTransfer
+from rucio.core.request import DirectTransfer, RequestSource, RequestWithSources, TransferDestination, transition_request_state
 from rucio.core.rse import RseData
 from rucio.core.rse_expression_parser import parse_expression
 from rucio.db.sqla import models
 from rucio.db.sqla.constants import DIDType, RequestState, RequestType, TransferLimitDirection
-from rucio.db.sqla.session import read_session, transactional_session, stream_session
+from rucio.db.sqla.session import read_session, stream_session, transactional_session
 from rucio.rse import rsemanager as rsemgr
-from rucio.transfertool.transfertool import TransferStatusReport, Transfertool
 from rucio.transfertool.bittorrent import BittorrentTransfertool
 from rucio.transfertool.fts3 import FTS3Transfertool
 from rucio.transfertool.globus import GlobusTransferTool
 from rucio.transfertool.mock import MockTransfertool
+from rucio.transfertool.transfertool import TransferStatusReport, Transfertool
 
 if TYPE_CHECKING:
-    from collections.abc import Callable, Iterator, Iterable, Mapping, Sequence
+    from collections.abc import Callable, Iterable, Iterator, Mapping, Sequence
     from typing import Any, Optional, Type
+
     from sqlalchemy.orm import Session
+
     from rucio.common.types import InternalAccount
     from rucio.core.topology import Topology
     from rucio.rse.protocols.protocol import RSEProtocol
 
     LoggerFunction = Callable[..., Any]
 
 """
@@ -922,15 +923,15 @@
         or an integer which gives the cost of the given source under the current strategy
         (smaller cost: higher priority).
         If `None` is returned, it will be interpreted as sys.maxsize (i.e. very low priority).
         This is done to avoid requiring an explicit integer in filter-only strategies.
         """
         pass
 
-    class _ClassNameDescriptor(object):
+    class _ClassNameDescriptor:
         """
         Automatically set the external_name of the strategy to the class name.
         """
         def __get__(self, obj, objtype=None):
             if objtype is not None:
                 return objtype.__name__
             return type(obj).__name__
```

### Comparing `rucio-34.0.0rc2/lib/rucio/core/vo.py` & `rucio-34.1.0/lib/rucio/core/vo.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -16,15 +15,15 @@
 import re
 from typing import TYPE_CHECKING
 
 from sqlalchemy.exc import DatabaseError, IntegrityError
 from sqlalchemy.orm.exc import NoResultFound
 
 from rucio.common import exception
-from rucio.common.config import config_get_bool, config_get
+from rucio.common.config import config_get, config_get_bool
 from rucio.common.types import InternalAccount
 from rucio.db.sqla import models
 from rucio.db.sqla.constants import AccountType, IdentityType
 from rucio.db.sqla.session import read_session, transactional_session
 
 # Format for long VO names
 LONG_VO_RE = re.compile(r"^[a-zA-Z0-9\.\-]+$")
```

### Comparing `rucio-34.0.0rc2/lib/rucio/core/volatile_replica.py` & `rucio-34.1.0/lib/rucio/core/volatile_replica.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -13,15 +12,15 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 from collections.abc import Iterable
 from datetime import datetime
 from typing import TYPE_CHECKING, Any
 
-from sqlalchemy import and_, or_, exists, update, insert
+from sqlalchemy import and_, exists, insert, or_, update
 from sqlalchemy.orm.exc import NoResultFound
 from sqlalchemy.sql.expression import select
 
 from rucio.common import exception
 from rucio.core.rse import get_rse_name
 from rucio.db.sqla import models
 from rucio.db.sqla.constants import ReplicaState
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/__init__.py` & `rucio-34.1.0/lib/rucio/core/__init__.py`

 * *Files 9% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/abacus/__init__.py` & `rucio-34.1.0/lib/rucio/daemons/__init__.py`

 * *Files 9% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/abacus/account.py` & `rucio-34.1.0/lib/rucio/daemons/abacus/account.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -22,15 +21,15 @@
 import time
 from typing import TYPE_CHECKING
 
 import rucio.db.sqla.util
 from rucio.common import exception
 from rucio.common.logging import setup_logging
 from rucio.common.utils import get_thread_with_periodic_running_function
-from rucio.core.account_counter import get_updated_account_counters, update_account_counter, fill_account_counter_history_table
+from rucio.core.account_counter import fill_account_counter_history_table, get_updated_account_counters, update_account_counter
 from rucio.daemons.common import run_daemon
 
 if TYPE_CHECKING:
     from types import FrameType
     from typing import Optional
 
 graceful_stop = threading.Event()
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/abacus/collection_replica.py` & `rucio-34.1.0/lib/rucio/daemons/abacus/collection_replica.py`

 * *Files 5% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/abacus/rse.py` & `rucio-34.1.0/lib/rucio/daemons/abacus/rse.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -22,15 +21,15 @@
 import time
 from typing import TYPE_CHECKING
 
 import rucio.db.sqla.util
 from rucio.common import exception
 from rucio.common.logging import setup_logging
 from rucio.common.utils import get_thread_with_periodic_running_function
-from rucio.core.rse_counter import get_updated_rse_counters, update_rse_counter, fill_rse_counter_history_table
+from rucio.core.rse_counter import fill_rse_counter_history_table, get_updated_rse_counters, update_rse_counter
 from rucio.daemons.common import run_daemon
 
 if TYPE_CHECKING:
     from types import FrameType
     from typing import Optional
 
 graceful_stop = threading.Event()
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/atropos/__init__.py` & `rucio-34.1.0/lib/rucio/daemons/abacus/__init__.py`

 * *Files 9% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/atropos/atropos.py` & `rucio-34.1.0/lib/rucio/daemons/atropos/atropos.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/auditor/__init__.py` & `rucio-34.1.0/lib/rucio/daemons/auditor/__init__.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -14,29 +13,25 @@
 # limitations under the License.
 
 import bz2
 import glob
 import logging
 import os
 import queue as Queue
-from datetime import datetime
-from datetime import timedelta
-
 import select
+from datetime import datetime, timedelta
 
 from rucio.common import config
-from rucio.common.dumper import LogPipeHandler
-from rucio.common.dumper import mkdir
-from rucio.common.dumper import temp_file
+from rucio.common.dumper import LogPipeHandler, mkdir, temp_file
 from rucio.common.dumper.consistency import Consistency
 from rucio.common.types import InternalAccount, InternalScope
 from rucio.common.utils import chunks
 from rucio.core.quarantined_replica import add_quarantined_replicas
 from rucio.core.replica import declare_bad_file_replicas, list_replicas
-from rucio.core.rse import get_rse_usage, get_rse_id
+from rucio.core.rse import get_rse_id, get_rse_usage
 from rucio.daemons.auditor import srmdumps
 from rucio.daemons.auditor.hdfs import ReplicaFromHDFS
 from rucio.db.sqla.constants import BadFilesStatus
 
 
 def consistency(rse, delta, configuration, cache_dir, results_dir):
     logger = logging.getLogger('auditor-worker')
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/auditor/hdfs.py` & `rucio-34.1.0/lib/rucio/daemons/auditor/hdfs.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -17,28 +16,27 @@
 import logging
 import os
 import re
 import shutil
 import subprocess
 import tempfile
 
-from rucio.common.dumper import DUMPS_CACHE_DIR
-from rucio.common.dumper import temp_file
+from rucio.common.dumper import DUMPS_CACHE_DIR, temp_file
 from rucio.common.dumper.data_models import Replica
 
 
 def _hdfs_get(src_url, dst_path):
     cmd = ['hadoop', 'fs', '-get', src_url, dst_path]
     get = subprocess.Popen(
         cmd,
         stderr=subprocess.PIPE,
     )
     _, stderr = get.communicate()
     if get.returncode != 0:
-        raise IOError('_hdfs_get(): "{0}": {1}. Return code {2}'.format(
+        raise OSError('_hdfs_get(): "{0}": {1}. Return code {2}'.format(
             ' '.join(cmd),
             stderr,
             get.returncode,
         ))
 
 
 class ReplicaFromHDFS(Replica):
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/auditor/srmdumps.py` & `rucio-34.1.0/lib/rucio/daemons/auditor/srmdumps.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -23,24 +22,23 @@
 import os
 import re
 
 import gfal2
 import requests
 
 from rucio.common.config import get_config_dirs
-from rucio.common.dumper import DUMPS_CACHE_DIR
-from rucio.common.dumper import http_download_to_file, gfal_download_to_file, ddmendpoint_url, temp_file
+from rucio.common.dumper import DUMPS_CACHE_DIR, ddmendpoint_url, gfal_download_to_file, http_download_to_file, temp_file
 
 CHUNK_SIZE = 10485760
 
 __DUMPERCONFIGDIRS = (os.path.join(confdir, 'auditor') for confdir in get_config_dirs())
 __DUMPERCONFIGDIRS = list(filter(os.path.exists, __DUMPERCONFIGDIRS))
 
 
-class Parser(ConfigParser.RawConfigParser, object):
+class Parser(ConfigParser.RawConfigParser):
     '''
     RawConfigParser subclass that doesn't modify the the name of the options
     and removes any quotes arround the string values.
     '''
     remove_quotes_re = re.compile(r"^'(.+)'$")
     remove_double_quotes_re = re.compile(r'^"(.+)"$')
 
@@ -108,15 +106,15 @@
     '''
     Returns a list of the urls contained in `base_url`.
     '''
     ctxt = gfal2.creat_context()  # pylint: disable=no-member
     return ['/'.join((base_url, f)) for f in ctxt.listdir(str(base_url))]
 
 
-class _LinkCollector(HTMLParser.HTMLParser, object):
+class _LinkCollector(HTMLParser.HTMLParser):
     def __init__(self):
         super(_LinkCollector, self).__init__()
         self.links = []
 
     def handle_starttag(self, tag, attrs):
         if tag == 'a':
             self.links.append(
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/automatix/__init__.py` & `rucio-34.1.0/lib/rucio/daemons/atropos/__init__.py`

 * *Files 9% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/automatix/automatix.py` & `rucio-34.1.0/lib/rucio/daemons/automatix/automatix.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -24,15 +23,15 @@
 from os import remove, rmdir
 from typing import TYPE_CHECKING
 
 import rucio.db.sqla.util
 from rucio.client import Client
 from rucio.client.uploadclient import UploadClient
 from rucio.common import exception
-from rucio.common.config import config_get, config_get_int, config_get_bool
+from rucio.common.config import config_get, config_get_bool, config_get_int
 from rucio.common.logging import setup_logging
 from rucio.common.stopwatch import Stopwatch
 from rucio.common.types import InternalScope
 from rucio.common.utils import execute, generate_uuid
 from rucio.core.monitor import MetricManager
 from rucio.core.scope import list_scopes
 from rucio.core.vo import map_vo
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/badreplicas/__init__.py` & `rucio-34.1.0/lib/rucio/daemons/automatix/__init__.py`

 * *Files 9% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/badreplicas/minos.py` & `rucio-34.1.0/lib/rucio/daemons/badreplicas/minos.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -11,43 +10,41 @@
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import functools
 import logging
+import math
 import re
 import threading
 from collections.abc import Callable
 from datetime import datetime
 from typing import TYPE_CHECKING
 
-import math
 from sqlalchemy.exc import DatabaseError
 
 import rucio.db.sqla.util
 from rucio.common.config import config_get_int
-from rucio.common.exception import UnsupportedOperation, DataIdentifierNotFound, ReplicaNotFound, DatabaseException
+from rucio.common.exception import DatabaseException, DataIdentifierNotFound, ReplicaNotFound, UnsupportedOperation
 from rucio.common.logging import setup_logging
 from rucio.common.utils import chunks
 from rucio.core.did import get_metadata
-from rucio.core.replica import (get_bad_pfns, get_pfn_to_rse, declare_bad_file_replicas,
-                                get_did_from_pfns, update_replicas_states, bulk_add_bad_replicas,
-                                bulk_delete_bad_pfns, get_replicas_state)
+from rucio.core.replica import bulk_add_bad_replicas, bulk_delete_bad_pfns, declare_bad_file_replicas, get_bad_pfns, get_did_from_pfns, get_pfn_to_rse, get_replicas_state, update_replicas_states
 from rucio.core.rse import get_rse_name
 from rucio.daemons.common import run_daemon
 from rucio.db.sqla.constants import MYSQL_LOCK_WAIT_TIMEOUT_EXCEEDED, ORACLE_DEADLOCK_DETECTED_REGEX, ORACLE_RESOURCE_BUSY_REGEX, BadFilesStatus, BadPFNStatus, ReplicaState
 from rucio.db.sqla.session import get_session
 
 if TYPE_CHECKING:
     from types import FrameType
     from typing import Optional
 
-    from rucio.daemons.common import HeartbeatHandler
     from rucio.common.types import InternalAccount
+    from rucio.daemons.common import HeartbeatHandler
 
 graceful_stop = threading.Event()
 DAEMON_NAME = 'minos'
 
 
 def __classify_bad_pfns(pfns: list) -> tuple[dict, dict]:
     """
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/badreplicas/minos_temporary_expiration.py` & `rucio-34.1.0/lib/rucio/daemons/badreplicas/minos_temporary_expiration.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -11,30 +10,29 @@
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import functools
 import logging
+import math
 import re
 import threading
 import traceback
 from typing import TYPE_CHECKING
 
-import math
 from sqlalchemy.exc import DatabaseError
 
 import rucio.db.sqla.util
 from rucio.common import exception
-from rucio.common.exception import DataIdentifierNotFound, ReplicaNotFound, DatabaseException
+from rucio.common.exception import DatabaseException, DataIdentifierNotFound, ReplicaNotFound
 from rucio.common.logging import setup_logging
 from rucio.common.utils import chunks
 from rucio.core.did import get_metadata
-from rucio.core.replica import (update_replicas_states, get_replicas_state,
-                                bulk_delete_bad_replicas, list_expired_temporary_unavailable_replicas)
+from rucio.core.replica import bulk_delete_bad_replicas, get_replicas_state, list_expired_temporary_unavailable_replicas, update_replicas_states
 from rucio.daemons.common import run_daemon
 from rucio.db.sqla.constants import MYSQL_LOCK_WAIT_TIMEOUT_EXCEEDED, ORACLE_DEADLOCK_DETECTED_REGEX, ORACLE_RESOURCE_BUSY_REGEX, BadFilesStatus, ReplicaState
 from rucio.db.sqla.session import get_session
 
 if TYPE_CHECKING:
     from types import FrameType
     from typing import Optional
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/badreplicas/necromancer.py` & `rucio-34.1.0/lib/rucio/daemons/badreplicas/necromancer.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -27,17 +26,16 @@
 import rucio.db.sqla.util
 from rucio.common import exception
 from rucio.common.cache import make_region_memcached
 from rucio.common.config import config_get_int
 from rucio.common.exception import DatabaseException
 from rucio.common.logging import setup_logging
 from rucio.core.monitor import MetricManager
-from rucio.core.replica import list_bad_replicas, get_replicas_state, get_bad_replicas_backlog
-from rucio.core.rule import (update_rules_for_lost_replica, update_rules_for_bad_replica,
-                             get_evaluation_backlog)
+from rucio.core.replica import get_bad_replicas_backlog, get_replicas_state, list_bad_replicas
+from rucio.core.rule import get_evaluation_backlog, update_rules_for_bad_replica, update_rules_for_lost_replica
 from rucio.daemons.common import run_daemon
 from rucio.db.sqla.constants import MYSQL_LOCK_WAIT_TIMEOUT_EXCEEDED, ORACLE_DEADLOCK_DETECTED_REGEX, ORACLE_RESOURCE_BUSY_REGEX, ReplicaState
 
 if TYPE_CHECKING:
     from types import FrameType
     from typing import Optional
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/bb8/__init__.py` & `rucio-34.1.0/lib/rucio/daemons/badreplicas/__init__.py`

 * *Files 9% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/bb8/bb8.py` & `rucio-34.1.0/lib/rucio/daemons/bb8/bb8.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -22,18 +21,18 @@
 import socket
 import threading
 from typing import TYPE_CHECKING
 
 from rucio.common.config import config_get_float
 from rucio.common.exception import InvalidRSEExpression
 from rucio.common.logging import setup_logging
-from rucio.core.heartbeat import sanity_check, list_payload_counts
+from rucio.core.heartbeat import list_payload_counts, sanity_check
 from rucio.core.rse import get_rse_usage
 from rucio.core.rse_expression_parser import parse_expression
-from rucio.daemons.bb8.common import rebalance_rse, get_active_locks
+from rucio.daemons.bb8.common import get_active_locks, rebalance_rse
 from rucio.daemons.common import run_daemon
 
 if TYPE_CHECKING:
     from types import FrameType
     from typing import Optional
 
     from rucio.daemons.common import HeartbeatHandler
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/bb8/common.py` & `rucio-34.1.0/lib/rucio/daemons/bb8/common.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -10,38 +9,38 @@
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import logging
-from datetime import datetime, date, timedelta
+from datetime import date, datetime, timedelta
 from string import Template
 
 from requests import get
-from sqlalchemy import func, and_, or_, cast, BigInteger
+from sqlalchemy import BigInteger, and_, cast, func, or_
 from sqlalchemy.orm import aliased
 from sqlalchemy.sql.expression import case, select
 
-from rucio.common.config import config_get, config_get_int, config_get_bool
+from rucio.common.config import config_get, config_get_bool, config_get_int
 from rucio.common.exception import (
-    InsufficientTargetRSEs,
-    RuleNotFound,
     DuplicateRule,
     InsufficientAccountLimit,
+    InsufficientTargetRSEs,
+    RuleNotFound,
 )
 from rucio.common.types import InternalAccount, InternalScope
 from rucio.core.lock import get_dataset_locks
-from rucio.core.rse import list_rse_attributes, get_rse_name, get_rse_vo
+from rucio.core.rse import get_rse_name, get_rse_vo, list_rse_attributes
 from rucio.core.rse_expression_parser import parse_expression
 from rucio.core.rse_selector import RSESelector
-from rucio.core.rule import get_rule, add_rule, update_rule
+from rucio.core.rule import add_rule, get_rule, update_rule
 from rucio.db.sqla import models
-from rucio.db.sqla.constants import DIDType, RuleState, RuleGrouping, LockState
-from rucio.db.sqla.session import transactional_session, read_session
+from rucio.db.sqla.constants import DIDType, LockState, RuleGrouping, RuleState
+from rucio.db.sqla.session import read_session, transactional_session
 
 
 @transactional_session
 def rebalance_rule(
     parent_rule,
     activity,
     rse_expression,
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/bb8/nuclei_background_rebalance.py` & `rucio-34.1.0/lib/rucio/daemons/bb8/nuclei_background_rebalance.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -15,15 +14,15 @@
 
 """
 This script is to be used to background rebalance ATLAS t2 datadisks
 """
 
 from sqlalchemy import or_
 
-from rucio.core.rse import get_rse_usage, get_rse_attribute
+from rucio.core.rse import get_rse_attribute, get_rse_usage
 from rucio.core.rse_expression_parser import parse_expression
 from rucio.daemons.bb8.common import rebalance_rse
 from rucio.db.sqla import models
 from rucio.db.sqla.constants import RuleState
 from rucio.db.sqla.session import get_session
 
 tolerance = 0.15
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/bb8/t2_background_rebalance.py` & `rucio-34.1.0/lib/rucio/daemons/bb8/t2_background_rebalance.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -15,15 +14,15 @@
 
 """
 This script is to be used to background rebalance ATLAS t2 datadisks
 """
 
 from sqlalchemy import or_
 
-from rucio.core.rse import get_rse_usage, get_rse_attribute
+from rucio.core.rse import get_rse_attribute, get_rse_usage
 from rucio.core.rse_expression_parser import parse_expression
 from rucio.daemons.bb8.common import rebalance_rse
 from rucio.db.sqla import models
 from rucio.db.sqla.constants import RuleState
 from rucio.db.sqla.session import get_session
 
 tolerance = 0.1
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/c3po/__init__.py` & `rucio-34.1.0/lib/rucio/daemons/bb8/__init__.py`

 * *Files 9% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/c3po/algorithms/__init__.py` & `rucio-34.1.0/lib/rucio/daemons/c3po/__init__.py`

 * *Files 9% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/c3po/algorithms/simple.py` & `rucio-34.1.0/lib/rucio/daemons/c3po/algorithms/simple.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/c3po/algorithms/t2_free_space.py` & `rucio-34.1.0/lib/rucio/daemons/c3po/algorithms/t2_free_space.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -16,15 +15,15 @@
 import logging
 from operator import itemgetter
 
 from rucio.common.config import config_get, config_get_int
 from rucio.common.exception import DataIdentifierNotFound
 from rucio.core.did import get_did
 from rucio.core.replica import list_dataset_replicas
-from rucio.core.rse import list_rse_attributes, get_rse_name
+from rucio.core.rse import get_rse_name, list_rse_attributes
 from rucio.core.rse_expression_parser import parse_expression
 from rucio.daemons.c3po.collectors.free_space import FreeSpaceCollector
 from rucio.daemons.c3po.utils.dataset_cache import DatasetCache
 from rucio.daemons.c3po.utils.popularity import get_popularity
 from rucio.db.sqla.constants import ReplicaState
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/c3po/algorithms/t2_free_space_only_pop.py` & `rucio-34.1.0/lib/rucio/daemons/c3po/algorithms/t2_free_space_only_pop.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -16,15 +15,15 @@
 import logging
 from operator import itemgetter
 
 from rucio.common.config import config_get, config_get_int
 from rucio.common.exception import DataIdentifierNotFound
 from rucio.core.did import get_did
 from rucio.core.replica import list_dataset_replicas
-from rucio.core.rse import list_rse_attributes, get_rse_name
+from rucio.core.rse import get_rse_name, list_rse_attributes
 from rucio.core.rse_expression_parser import parse_expression
 from rucio.daemons.c3po.collectors.free_space import FreeSpaceCollector
 from rucio.daemons.c3po.utils.expiring_dataset_cache import ExpiringDatasetCache
 from rucio.daemons.c3po.utils.popularity import get_popularity
 from rucio.db.sqla.constants import ReplicaState
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/c3po/algorithms/t2_free_space_only_pop_with_network.py` & `rucio-34.1.0/lib/rucio/daemons/c3po/algorithms/t2_free_space_only_pop_with_network.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -16,15 +15,15 @@
 import logging
 from operator import itemgetter
 
 from rucio.common.config import config_get, config_get_int
 from rucio.common.exception import DataIdentifierNotFound
 from rucio.core.did import get_did
 from rucio.core.replica import list_dataset_replicas
-from rucio.core.rse import list_rse_attributes, get_rse, get_rse_name
+from rucio.core.rse import get_rse, get_rse_name, list_rse_attributes
 from rucio.core.rse_expression_parser import parse_expression
 from rucio.daemons.c3po.collectors.free_space import FreeSpaceCollector
 from rucio.daemons.c3po.collectors.network_metrics import NetworkMetricsCollector
 from rucio.daemons.c3po.utils.dataset_cache import DatasetCache
 from rucio.daemons.c3po.utils.expiring_dataset_cache import ExpiringDatasetCache
 from rucio.daemons.c3po.utils.popularity import get_popularity
 from rucio.daemons.c3po.utils.timeseries import RedisTimeSeries
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/c3po/c3po.py` & `rucio-34.1.0/lib/rucio/daemons/c3po/c3po.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/c3po/collectors/__init__.py` & `rucio-34.1.0/lib/rucio/daemons/c3po/algorithms/__init__.py`

 * *Files 9% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/c3po/collectors/agis.py` & `rucio-34.1.0/lib/rucio/daemons/c3po/collectors/agis.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -16,19 +15,19 @@
 from json import loads
 
 from requests import get
 
 from rucio.common.config import config_get
 
 
-class MappingCollector(object):
+class MappingCollector:
     """
     Provides mappings from PanDA / DDM resources to ATLAS sites and back.
     """
-    class _MappingCollector(object):
+    class _MappingCollector:
         '''
         _MappingCollector
         '''
 
         def __init__(self):
             '''
             __init__
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/c3po/collectors/free_space.py` & `rucio-34.1.0/lib/rucio/daemons/c3po/collectors/free_space.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -13,23 +12,23 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 """
 Collector to get the SRM free and used information for DATADISK RSEs.
 """
 
-from rucio.db.sqla.models import RSEUsage, RSEAttrAssociation
+from rucio.db.sqla.models import RSEAttrAssociation, RSEUsage
 from rucio.db.sqla.session import read_session
 
 
-class FreeSpaceCollector(object):
+class FreeSpaceCollector:
     """
     Collector to get the SRM free and used information for DATADISK RSEs.
     """
-    class _FreeSpaceCollector(object):
+    class _FreeSpaceCollector:
         """
         Hidden implementation
         """
         def __init__(self):
             self.rses = {}
 
         @read_session
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/c3po/collectors/jedi_did.py` & `rucio-34.1.0/lib/rucio/daemons/c3po/collectors/jedi_did.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -14,15 +13,15 @@
 # limitations under the License.
 
 import logging
 
 from rucio.db.sqla.session import read_session
 
 
-class JediDIDCollector():
+class JediDIDCollector:
     def __init__(self, queue):
         self.queue = queue
         self.max_tid = 0
 
     @read_session
     def get_dids(self, *, session=None):
         query = """select t.jeditaskid, t.username, t.status, d.datasetname from ATLAS_PANDA.JEDI_TASKS t
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/c3po/collectors/mock_did.py` & `rucio-34.1.0/lib/rucio/daemons/c3po/collectors/mock_did.py`

 * *Files 11% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -16,15 +15,15 @@
 """
 Mock DID collector
 """
 
 from random import choice
 
 
-class MockDIDCollector(object):
+class MockDIDCollector:
     """
     Simple collector that reads dids from a file. Used to
     test the interface.
     """
     def __init__(self, queue):
         self._queue = queue
         self._read_file('/opt/rucio/etc/dids_mc15_13TeV.csv')
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/c3po/collectors/network_metrics.py` & `rucio-34.1.0/lib/rucio/daemons/c3po/collectors/network_metrics.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -16,15 +15,15 @@
 from json import loads
 
 from redis import StrictRedis
 
 from rucio.common.config import config_get, config_get_int
 
 
-class NetworkMetricsCollector(object):
+class NetworkMetricsCollector:
     """
     Collector to get the bandwidth metrics between two sites.
     """
 
     def __init__(self):
         self._r = StrictRedis(host=config_get('c3po-network-metrics', 'redis_host'), port=config_get_int('c3po-network-metrics', 'redis_port'))
         self._prefix = config_get('c3po-network-metrics', 'prefix')
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/c3po/collectors/workload.py` & `rucio-34.1.0/lib/rucio/daemons/c3po/collectors/workload.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -23,21 +22,21 @@
 
 from requests import get
 
 from rucio.common.config import config_get, config_get_int
 from rucio.daemons.c3po.utils.timeseries import RedisTimeSeries
 
 
-class WorkloadCollector(object):
+class WorkloadCollector:
     """
     Collector to retrieve the workload from PanDA. It stores it as a time series in Redis and provides
     the average and maximum number of running jobs for a sliding window.
     """
 
-    class __WorkloadCollector(object):
+    class __WorkloadCollector:
         """
         Private class needed implement singleton.
         """
         def __init__(self, delete_keys=False):
             self._avg_jobs = {}
             self._cur_jobs = {}
             self._max_jobs = {}
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/c3po/utils/__init__.py` & `rucio-34.1.0/lib/rucio/daemons/c3po/collectors/__init__.py`

 * *Files 9% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/c3po/utils/dataset_cache.py` & `rucio-34.1.0/lib/rucio/daemons/c3po/utils/dataset_cache.py`

 * *Files 8% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -14,15 +13,15 @@
 # limitations under the License.
 
 from uuid import uuid4
 
 from rucio.daemons.c3po.utils.timeseries import RedisTimeSeries
 
 
-class DatasetCache(object):
+class DatasetCache:
     """
     Utility to count the accesses of the datasets during the last day.
     """
     def __init__(self, redis_host, redis_port, timeout=1, prefix='did_cache', delete_keys=False):
         self._prefix = prefix + '_' + str(uuid4()).split('-')[0]
         self._tms = RedisTimeSeries(redis_host, redis_port, timeout, self._prefix)
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/c3po/utils/expiring_dataset_cache.py` & `rucio-34.1.0/lib/rucio/daemons/c3po/utils/expiring_dataset_cache.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -17,15 +16,15 @@
 Expiring Dataset Cache
 """
 from uuid import uuid4
 
 from redis import StrictRedis
 
 
-class ExpiringDatasetCache(object):
+class ExpiringDatasetCache:
     """
     Cache with expiring values to keep track of recently created replicas.
     """
     def __init__(self, redis_host, redis_port, timeout=1, prefix='expiring_did_cache'):
         self._redis = StrictRedis(host=redis_host, port=redis_port)
         self._prefix = prefix + '_' + str(uuid4()).split('-')[0]
         self._timeout = timeout
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/c3po/utils/expiring_list.py` & `rucio-34.1.0/lib/rucio/daemons/c3po/utils/expiring_list.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -17,15 +16,15 @@
 Utility classes for C3PO
 """
 
 from collections import deque
 from threading import Lock, Timer
 
 
-class ExpiringList(object):
+class ExpiringList:
     """
     Simple list with time based element expiration
     """
 
     def __init__(self, timeout=1):
         self._lock = Lock()
         self._timeout = timeout
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/c3po/utils/popularity.py` & `rucio-34.1.0/lib/rucio/daemons/c3po/utils/popularity.py`

 * *Files 6% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/c3po/utils/timeseries.py` & `rucio-34.1.0/lib/rucio/daemons/c3po/utils/timeseries.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -18,15 +17,15 @@
 """
 
 from time import time
 
 from redis import StrictRedis
 
 
-class RedisTimeSeries(object):
+class RedisTimeSeries:
     """
     Redis time series abstraction
     """
 
     def __init__(self, redis_host, redis_port, window, prefix):
         self._redis = StrictRedis(host=redis_host, port=redis_port)
         self._prefix = prefix
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/cache/__init__.py` & `rucio-34.1.0/lib/rucio/daemons/c3po/utils/__init__.py`

 * *Files 9% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/cache/consumer.py` & `rucio-34.1.0/lib/rucio/daemons/cache/consumer.py`

 * *Files identical despite different names*

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/common.py` & `rucio-34.1.0/lib/rucio/daemons/common.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/conveyor/__init__.py` & `rucio-34.1.0/lib/rucio/daemons/conveyor/__init__.py`

 * *Files 9% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/conveyor/common.py` & `rucio-34.1.0/lib/rucio/daemons/conveyor/common.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -21,39 +20,41 @@
 import functools
 import itertools
 import logging
 import re
 from typing import TYPE_CHECKING
 
 from rucio.common.config import config_get_bool
-from rucio.common.exception import (InvalidRSEExpression, TransferToolTimeout, TransferToolWrongAnswer, RequestNotFound,
-                                    DuplicateFileTransferSubmission, VONotFound, DatabaseException)
+from rucio.common.exception import DatabaseException, DuplicateFileTransferSubmission, InvalidRSEExpression, RequestNotFound, TransferToolTimeout, TransferToolWrongAnswer, VONotFound
 from rucio.common.stopwatch import Stopwatch
-from rucio.core import request as request_core, transfer as transfer_core
+from rucio.core import request as request_core
+from rucio.core import transfer as transfer_core
 from rucio.core.monitor import MetricManager
 from rucio.core.replica import add_replicas, tombstone_from_delay, update_replica_state
-from rucio.core.request import transition_request_state, queue_requests
+from rucio.core.request import queue_requests, transition_request_state
 from rucio.core.rse import list_rses
 from rucio.core.rse_expression_parser import parse_expression
 from rucio.core.transfer import build_transfer_paths
 from rucio.core.vo import list_vos
 from rucio.db.sqla import models
-from rucio.db.sqla.constants import RequestState, ReplicaState
+from rucio.db.sqla.constants import ReplicaState, RequestState
 from rucio.db.sqla.session import transactional_session
 from rucio.rse import rsemanager as rsemgr
 
 if TYPE_CHECKING:
     from collections.abc import Callable, Sequence
-    from typing import Optional, Mapping
+    from typing import Mapping, Optional
+
+    from sqlalchemy.orm import Session
+
     from rucio.common.types import InternalAccount
     from rucio.core.request import DirectTransfer, RequestWithSources
     from rucio.core.topology import Topology
     from rucio.core.transfer import ProtocolFactory
     from rucio.transfertool.transfertool import TransferToolBuilder
-    from sqlalchemy.orm import Session
 
 METRICS = MetricManager(module=__name__)
 
 
 def pick_and_prepare_submission_path(
         requests_with_sources: "Mapping[str, RequestWithSources]",
         topology: "Topology",
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/conveyor/finisher.py` & `rucio-34.1.0/lib/rucio/daemons/conveyor/finisher.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -28,27 +27,28 @@
 from urllib.parse import urlparse
 
 from dogpile.cache.api import NoValue
 from sqlalchemy.exc import DatabaseError
 
 import rucio.db.sqla.util
 from rucio.common.cache import make_region_memcached
-from rucio.common.config import config_get_list, config_get_bool
-from rucio.common.exception import DatabaseException, UnsupportedOperation, ReplicaNotFound, RequestNotFound, RSEProtocolNotSupported
+from rucio.common.config import config_get_bool, config_get_list
+from rucio.common.exception import DatabaseException, ReplicaNotFound, RequestNotFound, RSEProtocolNotSupported, UnsupportedOperation
 from rucio.common.logging import setup_logging
 from rucio.common.stopwatch import Stopwatch
 from rucio.common.types import InternalAccount
 from rucio.common.utils import chunks
-from rucio.core import request as request_core, replica as replica_core
+from rucio.core import replica as replica_core
+from rucio.core import request as request_core
 from rucio.core.monitor import MetricManager
 from rucio.core.rse import list_rses
+from rucio.core.topology import ExpiringObjectCache, Topology
 from rucio.core.transfer import ProtocolFactory
-from rucio.core.topology import Topology, ExpiringObjectCache
-from rucio.daemons.common import db_workqueue, ProducerConsumerDaemon
-from rucio.db.sqla.constants import MYSQL_LOCK_WAIT_TIMEOUT_EXCEEDED, ORACLE_DEADLOCK_DETECTED_REGEX, ORACLE_RESOURCE_BUSY_REGEX, RequestState, RequestType, ReplicaState, BadFilesStatus
+from rucio.daemons.common import ProducerConsumerDaemon, db_workqueue
+from rucio.db.sqla.constants import MYSQL_LOCK_WAIT_TIMEOUT_EXCEEDED, ORACLE_DEADLOCK_DETECTED_REGEX, ORACLE_RESOURCE_BUSY_REGEX, BadFilesStatus, ReplicaState, RequestState, RequestType
 from rucio.db.sqla.session import transactional_session
 
 if TYPE_CHECKING:
     from rucio.daemons.common import HeartbeatHandler
 
 GRACEFUL_STOP = threading.Event()
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/conveyor/poller.py` & `rucio-34.1.0/lib/rucio/daemons/conveyor/poller.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -35,21 +34,22 @@
 import rucio.db.sqla.util
 from rucio.common.config import config_get, config_get_bool
 from rucio.common.exception import DatabaseException, TransferToolTimeout, TransferToolWrongAnswer
 from rucio.common.logging import setup_logging
 from rucio.common.stopwatch import Stopwatch
 from rucio.common.types import InternalAccount
 from rucio.common.utils import dict_chunks
-from rucio.core import transfer as transfer_core, request as request_core
+from rucio.core import request as request_core
+from rucio.core import transfer as transfer_core
 from rucio.core.monitor import MetricManager
-from rucio.core.topology import Topology, ExpiringObjectCache
-from rucio.daemons.common import db_workqueue, ProducerConsumerDaemon
+from rucio.core.topology import ExpiringObjectCache, Topology
+from rucio.daemons.common import ProducerConsumerDaemon, db_workqueue
 from rucio.db.sqla.constants import MYSQL_LOCK_WAIT_TIMEOUT_EXCEEDED, ORACLE_DEADLOCK_DETECTED_REGEX, ORACLE_RESOURCE_BUSY_REGEX, RequestState, RequestType
-from rucio.transfertool.transfertool import Transfertool
 from rucio.transfertool.fts3 import FTS3Transfertool
+from rucio.transfertool.transfertool import Transfertool
 
 if TYPE_CHECKING:
     from rucio.daemons.common import HeartbeatHandler
 
 GRACEFUL_STOP = threading.Event()
 METRICS = MetricManager(module=__name__)
 DAEMON_NAME = 'conveyor-poller'
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/conveyor/preparer.py` & `rucio-34.1.0/lib/rucio/daemons/conveyor/preparer.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -21,22 +20,23 @@
 
 import rucio.db.sqla.util
 from rucio.common import exception
 from rucio.common.config import config_get_list
 from rucio.common.exception import RucioException
 from rucio.common.logging import setup_logging
 from rucio.core import transfer as transfer_core
-from rucio.core.request import transition_requests_state_if_possible, list_and_mark_transfer_requests_and_source_replicas
-from rucio.core.topology import Topology, ExpiringObjectCache
-from rucio.core.transfer import prepare_transfers, list_transfer_admin_accounts, build_transfer_paths, ProtocolFactory
-from rucio.daemons.common import db_workqueue, ProducerConsumerDaemon
+from rucio.core.request import list_and_mark_transfer_requests_and_source_replicas, transition_requests_state_if_possible
+from rucio.core.topology import ExpiringObjectCache, Topology
+from rucio.core.transfer import ProtocolFactory, build_transfer_paths, list_transfer_admin_accounts, prepare_transfers
+from rucio.daemons.common import ProducerConsumerDaemon, db_workqueue
 from rucio.db.sqla.constants import RequestState, RequestType
 
 if TYPE_CHECKING:
     from sqlalchemy.orm import Session
+
     from rucio.daemons.common import HeartbeatHandler
 
 GRACEFUL_STOP = threading.Event()
 DAEMON_NAME = 'conveyor-preparer'
 
 
 def stop(signum: Optional[int] = None, frame: Optional[FrameType] = None) -> None:
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/conveyor/receiver.py` & `rucio-34.1.0/lib/rucio/daemons/conveyor/receiver.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -29,29 +28,29 @@
 import stomp
 
 import rucio.db.sqla.util
 from rucio.common import exception
 from rucio.common.config import config_get, config_get_bool, config_get_int
 from rucio.common.logging import setup_logging
 from rucio.common.policy import get_policy
-from rucio.core import transfer as transfer_core
 from rucio.core import request as request_core
+from rucio.core import transfer as transfer_core
 from rucio.core.monitor import MetricManager
 from rucio.daemons.common import HeartbeatHandler
 from rucio.db.sqla.session import transactional_session
 from rucio.transfertool.fts3 import FTS3CompletionMessageTransferStatusReport
 
 logging.getLogger("stomp").setLevel(logging.CRITICAL)
 
 METRICS = MetricManager(module=__name__)
 GRACEFUL_STOP = threading.Event()
 DAEMON_NAME = 'conveyor-receiver'
 
 
-class Receiver(object):
+class Receiver:
 
     def __init__(self, broker, id_, total_threads, transfer_stats_manager: request_core.TransferStatsManager, all_vos=False):
         self.__all_vos = all_vos
         self.__broker = broker
         self.__id = id_
         self.__total_threads = total_threads
         self._transfer_stats_manager = transfer_stats_manager
@@ -67,17 +66,17 @@
         if not self.__all_vos:
             if 'vo' not in msg or msg['vo'] != get_policy():
                 return
 
         if 'job_metadata' in msg.keys() \
            and isinstance(msg['job_metadata'], dict) \
            and 'issuer' in msg['job_metadata'].keys() \
-           and str(msg['job_metadata']['issuer']) == str('rucio'):
+           and str(msg['job_metadata']['issuer']) == 'rucio':
 
-            if 'job_state' in msg.keys() and (str(msg['job_state']) != str('ACTIVE') or msg.get('job_multihop', False) is True):
+            if 'job_state' in msg.keys() and (str(msg['job_state']) != 'ACTIVE' or msg.get('job_multihop', False) is True):
                 METRICS.counter('message_rucio').inc()
 
                 self._perform_request_update(msg)
 
     @transactional_session
     def _perform_request_update(self, msg, *, session=None, logger=logging.log):
         external_host = msg.get('endpnt', None)
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/conveyor/stager.py` & `rucio-34.1.0/lib/rucio/daemons/conveyor/stager.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/conveyor/submitter.py` & `rucio-34.1.0/lib/rucio/daemons/conveyor/submitter.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -20,26 +19,25 @@
 import threading
 from collections.abc import Mapping
 from types import FrameType
 from typing import TYPE_CHECKING, Any, Optional
 
 import rucio.db.sqla.util
 from rucio.common import exception
-from rucio.common.config import config_get, config_get_bool, config_get_int, config_get_list, config_get_float
+from rucio.common.config import config_get, config_get_bool, config_get_float, config_get_int, config_get_list
 from rucio.common.logging import setup_logging
 from rucio.common.schema import get_schema_value
 from rucio.common.stopwatch import Stopwatch
 from rucio.core.monitor import MetricManager
 from rucio.core.request import list_and_mark_transfer_requests_and_source_replicas
-from rucio.core.topology import Topology, ExpiringObjectCache
-from rucio.core.transfer import DEFAULT_MULTIHOP_TOMBSTONE_DELAY, list_transfer_admin_accounts, transfer_path_str, \
-    TRANSFERTOOL_CLASSES_BY_NAME, ProtocolFactory
-from rucio.daemons.common import db_workqueue, ProducerConsumerDaemon
-from rucio.daemons.conveyor.common import submit_transfer, get_conveyor_rses, pick_and_prepare_submission_path
-from rucio.db.sqla.constants import RequestType, RequestState
+from rucio.core.topology import ExpiringObjectCache, Topology
+from rucio.core.transfer import DEFAULT_MULTIHOP_TOMBSTONE_DELAY, TRANSFERTOOL_CLASSES_BY_NAME, ProtocolFactory, list_transfer_admin_accounts, transfer_path_str
+from rucio.daemons.common import ProducerConsumerDaemon, db_workqueue
+from rucio.daemons.conveyor.common import get_conveyor_rses, pick_and_prepare_submission_path, submit_transfer
+from rucio.db.sqla.constants import RequestState, RequestType
 from rucio.transfertool.fts3 import FTS3Transfertool
 from rucio.transfertool.globus import GlobusTransferTool
 
 if TYPE_CHECKING:
     from rucio.daemons.common import HeartbeatHandler
 
 METRICS = MetricManager(module=__name__)
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/conveyor/throttler.py` & `rucio-34.1.0/lib/rucio/daemons/conveyor/throttler.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -13,33 +12,31 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 """
 Conveyor throttler is a daemon to manage rucio internal queue.
 """
 import logging
+import math
 import threading
 import traceback
 from collections import defaultdict
 from types import FrameType
 from typing import TYPE_CHECKING, Optional
 
-import math
 from sqlalchemy import null
 
 import rucio.db.sqla.util
 from rucio.common import exception
 from rucio.common.logging import setup_logging
 from rucio.core.monitor import MetricManager
-from rucio.core.request import (get_request_stats, release_all_waiting_requests, release_waiting_requests_fifo,
-                                release_waiting_requests_grouped_fifo, set_transfer_limit_stats, re_sync_all_transfer_limits,
-                                reset_stale_waiting_requests)
+from rucio.core.request import get_request_stats, re_sync_all_transfer_limits, release_all_waiting_requests, release_waiting_requests_fifo, release_waiting_requests_grouped_fifo, reset_stale_waiting_requests, set_transfer_limit_stats
 from rucio.core.rse import RseCollection
 from rucio.core.transfer import applicable_rse_transfer_limits
-from rucio.daemons.common import db_workqueue, ProducerConsumerDaemon
+from rucio.daemons.common import ProducerConsumerDaemon, db_workqueue
 from rucio.db.sqla.constants import RequestState, TransferLimitDirection
 
 if TYPE_CHECKING:
     from rucio.daemons.common import HeartbeatHandler
 
 GRACEFUL_STOP = threading.Event()
 METRICS = MetricManager(module=__name__)
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/follower/__init__.py` & `rucio-34.1.0/lib/rucio/daemons/follower/__init__.py`

 * *Files 9% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/follower/follower.py` & `rucio-34.1.0/lib/rucio/daemons/follower/follower.py`

 * *Files 7% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -21,15 +20,15 @@
 from typing import TYPE_CHECKING
 
 import rucio.db.sqla.util
 from rucio.common import exception
 from rucio.common.logging import setup_logging
 from rucio.common.utils import get_thread_with_periodic_running_function
 from rucio.core.did import create_reports
-from rucio.core.heartbeat import live, die, sanity_check
+from rucio.core.heartbeat import die, live, sanity_check
 
 if TYPE_CHECKING:
     from types import FrameType
     from typing import Optional
 
 graceful_stop = threading.Event()
 DAEMON_NAME = 'rucio-follower'
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/hermes/__init__.py` & `rucio-34.1.0/lib/rucio/daemons/hermes/__init__.py`

 * *Files 9% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/hermes/hermes.py` & `rucio-34.1.0/lib/rucio/daemons/hermes/hermes.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -31,28 +30,28 @@
 import time
 from configparser import NoOptionError, NoSectionError
 from email.mime.text import MIMEText
 from typing import TYPE_CHECKING
 
 import requests
 import stomp
+from requests.auth import HTTPBasicAuth
 
 import rucio.db.sqla.util
 from rucio.common.config import (
     config_get,
     config_get_bool,
     config_get_int,
     config_get_list,
 )
 from rucio.common.exception import DatabaseException
 from rucio.common.logging import setup_logging
 from rucio.core.message import delete_messages, retrieve_messages
 from rucio.core.monitor import MetricManager
 from rucio.daemons.common import run_daemon
-from requests.auth import HTTPBasicAuth
 
 if TYPE_CHECKING:
     from collections.abc import Callable
     from types import FrameType
     from typing import Optional
 
     from rucio.daemons.common import HeartbeatHandler
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/judge/__init__.py` & `rucio-34.1.0/lib/rucio/daemons/judge/__init__.py`

 * *Files 9% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/judge/cleaner.py` & `rucio-34.1.0/lib/rucio/daemons/judge/cleaner.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -21,25 +20,25 @@
 import threading
 import time
 from copy import deepcopy
 from datetime import datetime, timedelta
 from random import randint
 from re import match
 from typing import TYPE_CHECKING
-from rucio.db.sqla.constants import ORACLE_CONNECTION_LOST_CONTACT_REGEX, ORACLE_RESOURCE_BUSY_REGEX
 
 from sqlalchemy.exc import DatabaseError
 
 import rucio.db.sqla.util
 from rucio.common import exception
-from rucio.common.exception import DatabaseException, UnsupportedOperation, RuleNotFound
+from rucio.common.exception import DatabaseException, RuleNotFound, UnsupportedOperation
 from rucio.common.logging import setup_logging
 from rucio.core.monitor import MetricManager
 from rucio.core.rule import delete_rule, get_expired_rules
 from rucio.daemons.common import run_daemon
+from rucio.db.sqla.constants import ORACLE_CONNECTION_LOST_CONTACT_REGEX, ORACLE_RESOURCE_BUSY_REGEX
 from rucio.db.sqla.util import get_db_time
 
 if TYPE_CHECKING:
     from types import FrameType
     from typing import Optional
 
 METRICS = MetricManager(module=__name__)
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/judge/evaluator.py` & `rucio-34.1.0/lib/rucio/daemons/judge/evaluator.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -22,26 +21,26 @@
 import threading
 import time
 import traceback
 from datetime import datetime, timedelta
 from random import randint
 from re import match
 from typing import TYPE_CHECKING
-from rucio.db.sqla.constants import ORACLE_CONNECTION_LOST_CONTACT_REGEX, ORACLE_RESOURCE_BUSY_REGEX, ORACLE_UNIQUE_CONSTRAINT_VIOLATED_REGEX
 
 from sqlalchemy.exc import DatabaseError
 from sqlalchemy.orm.exc import FlushError
 
 import rucio.db.sqla.util
 from rucio.common.exception import DatabaseException, DataIdentifierNotFound, ReplicationRuleCreationTemporaryFailed
 from rucio.common.logging import setup_logging
 from rucio.common.types import InternalScope
 from rucio.core.monitor import MetricManager
-from rucio.core.rule import re_evaluate_did, get_updated_dids, delete_updated_did
+from rucio.core.rule import delete_updated_did, get_updated_dids, re_evaluate_did
 from rucio.daemons.common import run_daemon
+from rucio.db.sqla.constants import ORACLE_CONNECTION_LOST_CONTACT_REGEX, ORACLE_RESOURCE_BUSY_REGEX, ORACLE_UNIQUE_CONSTRAINT_VIOLATED_REGEX
 
 if TYPE_CHECKING:
     from types import FrameType
     from typing import Optional
 
 METRICS = MetricManager(module=__name__)
 graceful_stop = threading.Event()
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/judge/injector.py` & `rucio-34.1.0/lib/rucio/daemons/judge/injector.py`

 * *Files 3% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -21,25 +20,24 @@
 import threading
 import time
 from copy import deepcopy
 from datetime import datetime, timedelta
 from random import randint
 from re import match
 from typing import TYPE_CHECKING
-from rucio.db.sqla.constants import ORACLE_CONNECTION_LOST_CONTACT_REGEX, ORACLE_RESOURCE_BUSY_REGEX
 
 from sqlalchemy.exc import DatabaseError
 
 import rucio.db.sqla.util
-from rucio.common.exception import (DatabaseException, RuleNotFound, RSEWriteBlocked,
-                                    ReplicationRuleCreationTemporaryFailed, InsufficientAccountLimit)
+from rucio.common.exception import DatabaseException, InsufficientAccountLimit, ReplicationRuleCreationTemporaryFailed, RSEWriteBlocked, RuleNotFound
 from rucio.common.logging import setup_logging
 from rucio.core.monitor import MetricManager
-from rucio.core.rule import inject_rule, get_injected_rules, update_rule
+from rucio.core.rule import get_injected_rules, inject_rule, update_rule
 from rucio.daemons.common import run_daemon
+from rucio.db.sqla.constants import ORACLE_CONNECTION_LOST_CONTACT_REGEX, ORACLE_RESOURCE_BUSY_REGEX
 
 if TYPE_CHECKING:
     from types import FrameType
     from typing import Optional
 
 METRICS = MetricManager(module=__name__)
 graceful_stop = threading.Event()
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/judge/repairer.py` & `rucio-34.1.0/lib/rucio/daemons/judge/repairer.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -22,25 +21,25 @@
 import time
 import traceback
 from copy import deepcopy
 from datetime import datetime, timedelta
 from random import randint
 from re import match
 from typing import TYPE_CHECKING
-from rucio.db.sqla.constants import ORACLE_CONNECTION_LOST_CONTACT_REGEX, ORACLE_RESOURCE_BUSY_REGEX
 
 from sqlalchemy.exc import DatabaseError
 
 import rucio.db.sqla.util
 from rucio.common import exception
 from rucio.common.exception import DatabaseException
 from rucio.common.logging import setup_logging
 from rucio.core.monitor import MetricManager
-from rucio.core.rule import repair_rule, get_stuck_rules
+from rucio.core.rule import get_stuck_rules, repair_rule
 from rucio.daemons.common import run_daemon
+from rucio.db.sqla.constants import ORACLE_CONNECTION_LOST_CONTACT_REGEX, ORACLE_RESOURCE_BUSY_REGEX
 
 if TYPE_CHECKING:
     from types import FrameType
     from typing import Optional
 
 METRICS = MetricManager(module=__name__)
 graceful_stop = threading.Event()
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/oauthmanager/__init__.py` & `rucio-34.1.0/lib/rucio/daemons/oauthmanager/__init__.py`

 * *Files 9% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/oauthmanager/oauthmanager.py` & `rucio-34.1.0/lib/rucio/daemons/oauthmanager/oauthmanager.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -28,27 +27,26 @@
 
 import functools
 import logging
 import threading
 import traceback
 from re import match
 from typing import TYPE_CHECKING
-from rucio.db.sqla.constants import ORACLE_CONNECTION_LOST_CONTACT_REGEX
 
 from sqlalchemy.exc import DatabaseError
 
 import rucio.db.sqla.util
 from rucio.common.exception import DatabaseException
 from rucio.common.logging import setup_logging
 from rucio.common.stopwatch import Stopwatch
 from rucio.core.authentication import delete_expired_tokens
 from rucio.core.monitor import MetricManager
 from rucio.core.oidc import delete_expired_oauthrequests, refresh_jwt_tokens
-from rucio.daemons.common import HeartbeatHandler
-from rucio.daemons.common import run_daemon
+from rucio.daemons.common import HeartbeatHandler, run_daemon
+from rucio.db.sqla.constants import ORACLE_CONNECTION_LOST_CONTACT_REGEX
 
 if TYPE_CHECKING:
     from types import FrameType
     from typing import Optional
 
 METRICS = MetricManager(module=__name__)
 graceful_stop = threading.Event()
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/reaper/__init__.py` & `rucio-34.1.0/lib/rucio/daemons/reaper/__init__.py`

 * *Files 9% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/reaper/dark_reaper.py` & `rucio-34.1.0/lib/rucio/daemons/reaper/dark_reaper.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -26,23 +25,19 @@
 import traceback
 from typing import TYPE_CHECKING
 
 import rucio.core.rse as rse_core
 import rucio.db.sqla.util
 from rucio.common import exception
 from rucio.common.config import config_get_bool
-from rucio.common.exception import (SourceNotFound, ServiceUnavailable,
-                                    RSEAccessDenied, ResourceTemporaryUnavailable,
-                                    RSENotFound, VONotFound)
+from rucio.common.exception import ResourceTemporaryUnavailable, RSEAccessDenied, RSENotFound, ServiceUnavailable, SourceNotFound, VONotFound
 from rucio.common.logging import setup_logging
 from rucio.core.message import add_message
 from rucio.core.monitor import MetricManager
-from rucio.core.quarantined_replica import (list_quarantined_replicas,
-                                            delete_quarantined_replicas,
-                                            list_rses_with_quarantined_replicas)
+from rucio.core.quarantined_replica import delete_quarantined_replicas, list_quarantined_replicas, list_rses_with_quarantined_replicas
 from rucio.core.rse_expression_parser import parse_expression
 from rucio.core.vo import list_vos
 from rucio.daemons.common import run_daemon
 from rucio.rse import rsemanager as rsemgr
 
 if TYPE_CHECKING:
     from collections.abc import Sequence
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/reaper/reaper.py` & `rucio-34.1.0/lib/rucio/daemons/reaper/reaper.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -21,38 +20,34 @@
 import logging
 import random
 import threading
 import time
 import traceback
 from configparser import NoOptionError, NoSectionError
 from datetime import datetime, timedelta
+from math import log2
 from typing import TYPE_CHECKING
 
 from dogpile.cache.api import NoValue
-from math import log2
 from sqlalchemy.exc import DatabaseError, IntegrityError
 
 import rucio.db.sqla.util
 from rucio.common.cache import make_region_memcached
 from rucio.common.config import config_get_bool, config_get_int
-from rucio.common.exception import (DatabaseException, RSENotFound,
-                                    ReplicaUnAvailable, ReplicaNotFound, ServiceUnavailable,
-                                    RSEAccessDenied, ResourceTemporaryUnavailable, SourceNotFound,
-                                    VONotFound, RSEProtocolNotSupported)
+from rucio.common.exception import DatabaseException, ReplicaNotFound, ReplicaUnAvailable, ResourceTemporaryUnavailable, RSEAccessDenied, RSENotFound, RSEProtocolNotSupported, ServiceUnavailable, SourceNotFound, VONotFound
 from rucio.common.logging import setup_logging
 from rucio.common.stopwatch import Stopwatch
 from rucio.common.utils import chunks
 from rucio.core.credential import get_signed_url
 from rucio.core.heartbeat import list_payload_counts
 from rucio.core.message import add_message
 from rucio.core.monitor import MetricManager
 from rucio.core.oidc import request_token
-from rucio.core.replica import list_and_mark_unlocked_replicas, delete_replicas
-from rucio.core.rse import (determine_audience_for_rse, determine_scope_for_rse,
-                            list_rses, RseData)
+from rucio.core.replica import delete_replicas, list_and_mark_unlocked_replicas
+from rucio.core.rse import RseData, determine_audience_for_rse, determine_scope_for_rse, list_rses
 from rucio.core.rse_expression_parser import parse_expression
 from rucio.core.rule import get_evaluation_backlog
 from rucio.core.vo import list_vos
 from rucio.daemons.common import run_daemon
 from rucio.rse import rsemanager as rsemgr
 
 if TYPE_CHECKING:
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/replicarecoverer/__init__.py` & `rucio-34.1.0/lib/rucio/daemons/replicarecoverer/__init__.py`

 * *Files 9% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/replicarecoverer/suspicious_replica_recoverer.py` & `rucio-34.1.0/lib/rucio/daemons/replicarecoverer/suspicious_replica_recoverer.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,9 +1,8 @@
 #!/usr/bin/env python3
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -28,15 +27,15 @@
 import time
 from datetime import datetime, timedelta
 from typing import TYPE_CHECKING, Any, Optional
 
 import rucio.db.sqla.util
 from rucio.common.config import config_get_bool
 from rucio.common.constants import SuspiciousAvailability
-from rucio.common.exception import DatabaseException, VONotFound
+from rucio.common.exception import DatabaseException, DuplicateRule, VONotFound
 from rucio.common.logging import setup_logging
 from rucio.common.types import InternalAccount
 from rucio.core.did import get_metadata
 from rucio.core.replica import (
     add_bad_pfns,
     declare_bad_file_replicas,
     get_suspicious_files,
@@ -357,18 +356,21 @@
                                     break
                     if action:
                         # Rules will be created for these replicas.
                         dids = {'scope': file_scope, 'name': file_name, 'rse': rse_key}
                         dids_nattempts_1.append(dids)
             if active_mode:
                 if len(dids_nattempts_1) > 0:
-                    add_rule(dids=dids_nattempts_1, account=InternalAccount('root', vo=vo), copies=nattempts, rse_expression='type=SCRATCHDISK', grouping=None, weight=None, lifetime=5 * 24 * 3600, locked=False, subscription_id=None)
-                    logger(logging.INFO, 'Rules have been created for %i replicas on %s.', len(dids_nattempts_1), rse_key)
+                    try:
+                        add_rule(dids=dids_nattempts_1, account=InternalAccount('root', vo=vo), copies=nattempts, rse_expression='type=SCRATCHDISK', grouping=None, weight=None, lifetime=5 * 24 * 3600, locked=False, subscription_id=None)
+                        logger(logging.INFO, 'Rules have been created for %i replicas on %s.', len(dids_nattempts_1), rse_key)
+                    except DuplicateRule:
+                        logger(logging.INFO, 'Tried to create rules on %s, but it already exists.', rse_key)
                 else:
-                    logger(logging.INFO, 'No rules have been created for replicas on %s.', rse_key)
+                    logger(logging.INFO, 'No replicas on %s have nattmepts=1, so no rules have been created.', rse_key)
                 if len(files_to_be_declared_bad_nattempts_1) > 0:
                     logger(logging.INFO, 'Ready to declare %s bad replica(s) with nattempts=1 on %s (RSE id: %s).', len(files_to_be_declared_bad_nattempts_1), rse_key, str(rse_id))
                     declare_bad_file_replicas(replicas=files_to_be_declared_bad_nattempts_1, reason='Suspicious. Automatic recovery.', issuer=InternalAccount('root', vo=vo), session=None)
                 else:
                     logger(logging.INFO, 'No suspicious replica(s) with nattempts=1 on %s (RSE id: %s) have been declared bad.', rse_key, str(rse_id))
             else:
                 logger(logging.INFO, 'No replicas on %s with nattempts=1.', rse_key)
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/rsedecommissioner/__init__.py` & `rucio-34.1.0/lib/rucio/daemons/rsedecommissioner/__init__.py`

 * *Files 9% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/rsedecommissioner/config.py` & `rucio-34.1.0/lib/rucio/daemons/rsedecommissioner/config.py`

 * *Files 5% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/rsedecommissioner/profiles/__init__.py` & `rucio-34.1.0/lib/rucio/daemons/rsedecommissioner/profiles/__init__.py`

 * *Files 23% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/rsedecommissioner/profiles/atlas.py` & `rucio-34.1.0/lib/rucio/daemons/rsedecommissioner/profiles/atlas.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/rsedecommissioner/profiles/generic.py` & `rucio-34.1.0/lib/rucio/daemons/rsedecommissioner/profiles/generic.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -17,16 +16,15 @@
 import logging
 from collections.abc import Callable, Iterable
 from datetime import datetime, timedelta
 from typing import Any
 
 from sqlalchemy.exc import NoResultFound
 
-from rucio.common.exception import (Duplicate, RequestNotFound, ReplicaNotFound, RucioException,
-                                    RuleNotFound, RuleReplaceFailed, UnsupportedOperation)
+from rucio.common.exception import Duplicate, ReplicaNotFound, RequestNotFound, RucioException, RuleNotFound, RuleReplaceFailed, UnsupportedOperation
 from rucio.core.lock import get_replica_locks, get_replica_locks_for_rule_id
 from rucio.core.replica import list_replicas_per_rse, set_tombstone, update_replica_state
 from rucio.core.request import get_request_by_did
 from rucio.core.rse import add_rse_attribute, update_rse
 from rucio.core.rule import list_rules_for_rse_decommissioning, move_rule, update_rule
 from rucio.db.sqla.constants import ReplicaState
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/rsedecommissioner/profiles/types.py` & `rucio-34.1.0/lib/rucio/daemons/rsedecommissioner/profiles/types.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/rsedecommissioner/rse_decommissioner.py` & `rucio-34.1.0/lib/rucio/daemons/rsedecommissioner/rse_decommissioner.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -16,27 +15,27 @@
 """
 RSE-Decommissioner is a daemon that clears RSEs to be decommissioning. The
 actual operations (e.g. just delete all replicas, move the replicas to specific
 RSEs, etc.) that are performed on the RSEs depend on the "decommissioning
 profile", which must be specified for each RSE upon triggering decommissioning.
 """
 
-from collections.abc import Callable
 import logging
 import random
 import socket
 import threading
+from collections.abc import Callable
 from types import FrameType
 from typing import TYPE_CHECKING, Any, Optional, Union
 
 from rucio.common.config import config_get_int
-from rucio.common.logging import setup_logging
 from rucio.common.exception import RucioException
+from rucio.common.logging import setup_logging
 from rucio.core.heartbeat import sanity_check
-from rucio.core.rse import get_rses_with_attribute, get_rse_attribute
+from rucio.core.rse import get_rse_attribute, get_rses_with_attribute
 from rucio.daemons.common import run_daemon
 from rucio.db.sqla.constants import RuleState
 
 from .config import DecommissioningStatus, InvalidStatusName, attr_to_config, set_status
 from .profiles import PROFILE_MAP
 from .profiles.types import DecommissioningProfile, HandlerOutcome
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/storage/__init__.py` & `rucio-34.1.0/lib/rucio/daemons/storage/__init__.py`

 * *Files 9% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/storage/consistency/__init__.py` & `rucio-34.1.0/lib/rucio/daemons/storage/consistency/__init__.py`

 * *Files 9% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/storage/consistency/actions.py` & `rucio-34.1.0/lib/rucio/daemons/storage/consistency/actions.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -33,25 +32,26 @@
 from sqlalchemy.exc import DatabaseError, IntegrityError
 from sqlalchemy.orm.exc import FlushError
 
 from rucio.common import exception
 from rucio.common.logging import formatted_logger, setup_logging
 from rucio.common.types import InternalAccount, InternalScope
 from rucio.common.utils import daemon_sleep
-from rucio.core.heartbeat import live, die, sanity_check
+from rucio.core.heartbeat import die, live, sanity_check
 from rucio.core.monitor import MetricManager
 from rucio.core.quarantined_replica import add_quarantined_replicas
 from rucio.core.replica import __exist_replicas, update_replicas_states
-from rucio.core.rse import list_rses, get_rse_id
+from rucio.core.rse import get_rse_id, list_rses
+
 # FIXME: these are needed by local version of declare_bad_file_replicas()
 # TODO: remove after move of this code to core/replica.py - see https://github.com/rucio/rucio/pull/5068
 from rucio.db.sqla import models
-from rucio.db.sqla.constants import (ReplicaState, BadFilesStatus)
+from rucio.db.sqla.constants import BadFilesStatus, ReplicaState
 from rucio.db.sqla.session import transactional_session
-from rucio.rse.rsemanager import lfns2pfns, get_rse_info, parse_pfns
+from rucio.rse.rsemanager import get_rse_info, lfns2pfns, parse_pfns
 
 if TYPE_CHECKING:
     from types import FrameType
     from typing import Optional
 
 METRICS = MetricManager(module=__name__)
 graceful_stop = threading.Event()
@@ -118,15 +118,15 @@
 
     return unknown_replicas
 
 
 # TODO: This is Igor's Stats class.It will be factored out as a separate class in a future version of the code.
 # - Igor Mandrichenko <ivm@fnal.gov>, 2018
 
-class Stats(object):
+class Stats:
 
     def __init__(self, path):
         self.path = path
         self.Data = {}
 
     def __getitem__(self, name):
         return self.Data[name]
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/tracer/__init__.py` & `rucio-34.1.0/lib/rucio/daemons/tracer/__init__.py`

 * *Files 9% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/tracer/kronos.py` & `rucio-34.1.0/lib/rucio/daemons/tracer/kronos.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -18,34 +17,35 @@
 """
 
 import functools
 import logging
 import re
 from configparser import NoOptionError, NoSectionError
 from datetime import datetime
-from json import loads as jloads, dumps as jdumps
+from json import dumps as jdumps
+from json import loads as jloads
 from queue import Queue
 from threading import Event, Thread
 from time import time
 from typing import TYPE_CHECKING
 
 import rucio.db.sqla.util
 from rucio.common.config import config_get, config_get_bool, config_get_int, config_get_list
-from rucio.common.exception import RSENotFound, DatabaseException
+from rucio.common.exception import DatabaseException, RSENotFound
 from rucio.common.logging import setup_logging
 from rucio.common.stomp_utils import StompConnectionManager
 from rucio.common.stopwatch import Stopwatch
 from rucio.common.types import InternalAccount, InternalScope
-from rucio.core.did import touch_dids, list_parent_dids
+from rucio.core.did import list_parent_dids, touch_dids
 from rucio.core.lock import touch_dataset_locks
 from rucio.core.monitor import MetricManager
-from rucio.core.replica import touch_replica, touch_collection_replicas, declare_bad_file_replicas
+from rucio.core.replica import declare_bad_file_replicas, touch_collection_replicas, touch_replica
 from rucio.core.rse import get_rse_id
 from rucio.daemons.common import HeartbeatHandler, run_daemon
-from rucio.db.sqla.constants import DIDType, BadFilesStatus
+from rucio.db.sqla.constants import BadFilesStatus, DIDType
 
 if TYPE_CHECKING:
     from types import FrameType
     from typing import Optional
 
 
 logging.getLogger("stomp").setLevel(logging.CRITICAL)
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/transmogrifier/__init__.py` & `rucio-34.1.0/lib/rucio/daemons/transmogrifier/__init__.py`

 * *Files 9% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/transmogrifier/transmogrifier.py` & `rucio-34.1.0/lib/rucio/daemons/transmogrifier/transmogrifier.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -16,52 +15,52 @@
 import functools
 import logging
 import re
 import threading
 import time
 from collections.abc import Callable
 from datetime import datetime
-from json import loads, dumps
+from json import dumps, loads
 from typing import TYPE_CHECKING
 
 import rucio.db.sqla.util
 from rucio.common.config import config_get
 from rucio.common.exception import (
     DatabaseException,
-    InvalidReplicationRule,
     DuplicateRule,
-    InvalidRSEExpression,
-    InsufficientTargetRSEs,
     InsufficientAccountLimit,
-    RSEOverQuota,
+    InsufficientTargetRSEs,
+    InvalidReplicationRule,
+    InvalidRSEExpression,
     InvalidRuleWeight,
+    RSEOverQuota,
     StagingAreaRuleRequiresLifetime,
-    SubscriptionWrongParameter,
     SubscriptionNotFound,
+    SubscriptionWrongParameter,
 )
 from rucio.common.logging import setup_logging
 from rucio.common.stopwatch import Stopwatch
 from rucio.common.types import InternalAccount
 from rucio.common.utils import chunks
-from rucio.core.did import list_new_dids, set_new_dids, get_metadata
+from rucio.core.did import get_metadata, list_new_dids, set_new_dids
 from rucio.core.monitor import MetricManager
-from rucio.core.rse import list_rses, rse_exists, get_rse_id, list_rse_attributes
+from rucio.core.rse import get_rse_id, list_rse_attributes, list_rses, rse_exists
 from rucio.core.rse_expression_parser import parse_expression
 from rucio.core.rse_selector import resolve_rse_expression
-from rucio.core.rule import add_rule, list_rules, get_rule
+from rucio.core.rule import add_rule, get_rule, list_rules
 from rucio.core.subscription import list_subscriptions, update_subscription
 from rucio.daemons.common import run_daemon
 from rucio.db.sqla.constants import DIDType, SubscriptionState
 
 if TYPE_CHECKING:
     from types import FrameType
     from typing import Optional
 
-    from rucio.daemons.common import HeartbeatHandler
     from rucio.common.types import InternalScope
+    from rucio.daemons.common import HeartbeatHandler
 
 METRICS = MetricManager(module=__name__)
 graceful_stop = threading.Event()
 DAEMON_NAME = "transmogrifier"
 
 RULES_COMMENT_LENGTH = 255
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/undertaker/__init__.py` & `rucio-34.1.0/lib/rucio/daemons/undertaker/__init__.py`

 * *Files 9% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/daemons/undertaker/undertaker.py` & `rucio-34.1.0/lib/rucio/daemons/undertaker/undertaker.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -24,24 +23,24 @@
 from copy import deepcopy
 from datetime import datetime, timedelta
 from random import randint
 from re import match
 from typing import TYPE_CHECKING
 
 from sqlalchemy.exc import DatabaseError
-from rucio.db.sqla.constants import MYSQL_LOCK_NOWAIT_REGEX, ORACLE_RESOURCE_BUSY_REGEX, PSQL_LOCK_NOT_AVAILABLE_REGEX
 
 import rucio.db.sqla.util
-from rucio.common.exception import DatabaseException, UnsupportedOperation, RuleNotFound
+from rucio.common.exception import DatabaseException, RuleNotFound, UnsupportedOperation
 from rucio.common.logging import setup_logging
 from rucio.common.types import InternalAccount
 from rucio.common.utils import chunks
-from rucio.core.did import list_expired_dids, delete_dids
+from rucio.core.did import delete_dids, list_expired_dids
 from rucio.core.monitor import MetricManager
-from rucio.daemons.common import run_daemon, HeartbeatHandler
+from rucio.daemons.common import HeartbeatHandler, run_daemon
+from rucio.db.sqla.constants import MYSQL_LOCK_NOWAIT_REGEX, ORACLE_RESOURCE_BUSY_REGEX, PSQL_LOCK_NOT_AVAILABLE_REGEX
 
 if TYPE_CHECKING:
     from types import FrameType
     from typing import Optional
 
 logging.getLogger("requests").setLevel(logging.CRITICAL)
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/__init__.py` & `rucio-34.1.0/lib/rucio/db/__init__.py`

 * *Files 9% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/__init__.py` & `rucio-34.1.0/lib/rucio/db/sqla/__init__.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/constants.py` & `rucio-34.1.0/lib/rucio/db/sqla/constants.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/__init__.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/__init__.py`

 * *Files 9% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/env.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/env.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/01eaf73ab656_add_new_rule_notification_state_progress.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/01eaf73ab656_add_new_rule_notification_state_progress.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/0437a40dbfd1_add_eol_at_in_rules.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/0437a40dbfd1_add_eol_at_in_rules.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,19 +11,17 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 ''' add eol_at in rules '''
 
 import sqlalchemy as sa
-
 from alembic import context
 from alembic.op import add_column, drop_column
 
-
 # Alembic revision identifiers
 revision = '0437a40dbfd1'
 down_revision = 'a5f6f6e928a7'
 
 
 def upgrade():
     '''
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/0f1adb7a599a_create_transfer_hops_table.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/0f1adb7a599a_create_transfer_hops_table.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -15,16 +14,15 @@
 
 ''' create transfer hops table '''
 
 import datetime
 
 import sqlalchemy as sa
 from alembic import context
-from alembic.op import (create_table, create_primary_key, create_foreign_key,
-                        create_check_constraint, create_index, drop_table)
+from alembic.op import create_check_constraint, create_foreign_key, create_index, create_primary_key, create_table, drop_table
 
 from rucio.db.sqla.types import GUID
 
 # Alembic revision identifiers
 revision = '0f1adb7a599a'
 down_revision = '9a45bc4ea66d'
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/102efcf145f4_added_stuck_at_column_to_rules.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/102efcf145f4_added_stuck_at_column_to_rules.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,19 +11,17 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 ''' added stuck_at column to rules '''
 
 import sqlalchemy as sa
-
 from alembic import context
 from alembic.op import add_column, drop_column
 
-
 # Alembic revision identifiers
 revision = '102efcf145f4'
 down_revision = '70587619328'
 
 
 def upgrade():
     '''
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/13d4f70c66a9_introduce_transfer_limits.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/13d4f70c66a9_introduce_transfer_limits.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -14,16 +13,15 @@
 # limitations under the License.
 
 ''' introduce transfer limits '''
 import datetime
 
 import sqlalchemy as sa
 from alembic import context
-from alembic.op import (create_table, create_primary_key, create_foreign_key,
-                        create_index, create_check_constraint, drop_table)
+from alembic.op import create_check_constraint, create_foreign_key, create_index, create_primary_key, create_table, drop_table
 
 from rucio.db.sqla.constants import TransferLimitDirection
 from rucio.db.sqla.types import GUID
 
 # Alembic revision identifiers
 revision = '13d4f70c66a9'
 down_revision = '83f991c63a93'
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/140fef722e91_cleanup_distances_table.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/140fef722e91_cleanup_distances_table.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,17 +11,16 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 ''' cleanup distances table '''
 
 import sqlalchemy as sa
-
 from alembic import context
-from alembic.op import add_column, drop_column, alter_column
+from alembic.op import add_column, alter_column, drop_column
 
 # Alembic revision identifiers
 revision = '140fef722e91'
 down_revision = '13d4f70c66a9'
 
 
 def upgrade():
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/14ec5aeb64cf_add_request_external_host.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/14ec5aeb64cf_add_request_external_host.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,19 +11,17 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 ''' add request external_host '''
 
 import sqlalchemy as sa
-
 from alembic import context
 from alembic.op import add_column, drop_column
 
-
 # Alembic revision identifiers
 revision = '14ec5aeb64cf'
 down_revision = '52fd9f4916fa'
 
 
 def upgrade():
     '''
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/156fb5b5a14_add_request_type_to_requests_idx.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/156fb5b5a14_add_request_type_to_requests_idx.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,17 +11,15 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 ''' add request_type to requests idx '''
 
 from alembic import context
-from alembic.op import (create_foreign_key, create_unique_constraint, create_index,
-                        drop_constraint, drop_index)
-
+from alembic.op import create_foreign_key, create_index, create_unique_constraint, drop_constraint, drop_index
 
 # Alembic revision identifiers
 revision = '156fb5b5a14'
 down_revision = '1a29d6a9504c'
 
 
 def upgrade():
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/1677d4d803c8_split_rse_availability_into_multiple.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/1677d4d803c8_split_rse_availability_into_multiple.py`

 * *Files 8% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/16a0aca82e12_create_index_on_table_replicas_path.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/2f648fc909f3_index_in_rule_history_on_scope_name.py`

 * *Files 12% similar despite different names*

```diff
@@ -1,42 +1,40 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-''' create index on table replicas(path) '''
+''' index in rule_history on scope, name '''
 
 from alembic import context
 from alembic.op import create_index, drop_index
 
-
 # Alembic revision identifiers
-revision = '16a0aca82e12'
-down_revision = None
+revision = '2f648fc909f3'
+down_revision = 'bb695f45c04'
 
 
 def upgrade():
     '''
     Upgrade the database to this revision
     '''
 
     if context.get_context().dialect.name in ['oracle', 'mysql', 'postgresql']:
-        create_index('REPLICAS_PATH_IDX', 'replicas', ['path'])
+        create_index('RULES_HISTORY_SCOPENAME_IDX', 'rules_history', ['scope', 'name'])
 
 
 def downgrade():
     '''
     Downgrade the database to the previous revision
     '''
 
     if context.get_context().dialect.name in ['oracle', 'mysql', 'postgresql']:
-        drop_index('REPLICAS_PATH_IDX', 'replicas')
+        drop_index('RULES_HISTORY_SCOPENAME_IDX', 'rules_history')
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/1803333ac20f_adding_provenance_and_phys_group.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/1803333ac20f_adding_provenance_and_phys_group.py`

 * *Files 5% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/1a29d6a9504c_add_didtype_chck_to_requests.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/1a29d6a9504c_add_didtype_chck_to_requests.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/1a80adff031a_create_index_on_rules_hist_recent.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/1a80adff031a_create_index_on_rules_hist_recent.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -14,15 +13,14 @@
 # limitations under the License.
 
 ''' create index on rules_hist_recent '''
 
 from alembic import context
 from alembic.op import create_index, drop_index
 
-
 # Alembic revision identifiers
 revision = '1a80adff031a'
 down_revision = '3ad36e2268b0'
 
 
 def upgrade():
     '''
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/1c45d9730ca6_increase_identity_length.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/1c45d9730ca6_increase_identity_length.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/1d1215494e95_add_quarantined_replicas_table.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/1d1215494e95_add_quarantined_replicas_table.py`

 * *Files 5% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -15,16 +14,15 @@
 
 ''' add quarantined_replicas table '''
 
 import datetime
 
 import sqlalchemy as sa
 from alembic import context
-from alembic.op import (create_table, create_primary_key, create_foreign_key,
-                        create_check_constraint, drop_table)
+from alembic.op import create_check_constraint, create_foreign_key, create_primary_key, create_table, drop_table
 
 from rucio.common.schema import get_schema_value
 from rucio.db.sqla.types import GUID
 
 # Alembic revision identifiers
 revision = '1d1215494e95'
 down_revision = '575767d9f89'
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/1d96f484df21_asynchronous_rules_and_rule_approval.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/1d96f484df21_asynchronous_rules_and_rule_approval.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/1f46c5f240ac_add_bytes_column_to_bad_replicas.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/1f46c5f240ac_add_bytes_column_to_bad_replicas.py`

 * *Files 3% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,19 +11,17 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 ''' add bytes column to bad_replicas '''
 
 import sqlalchemy as sa
-
 from alembic import context
 from alembic.op import add_column, drop_column
 
-
 # Alembic revision identifiers
 revision = '1f46c5f240ac'
 down_revision = '688ef1840840'
 
 
 def upgrade():
     '''
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/1fc15ab60d43_add_message_history_table.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/1fc15ab60d43_add_message_history_table.py`

 * *Files 3% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/2190e703eb6e_move_rse_settings_to_rse_attributes.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/2190e703eb6e_move_rse_settings_to_rse_attributes.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -81,15 +80,15 @@
                     sa.column("updated_at"),
                 )
                 .select_from(rse_table)
                 .where(sa.column(setting) != None)  # noqa: E711
             )
 
             conn.execute(
-                sa.insert((get_rse_attr_association())).from_select(
+                sa.insert(get_rse_attr_association()).from_select(
                     ["rse_id", "key", "value", "created_at", "updated_at"], select_stmt
                 )
             )
 
 
 def downgrade():
     """
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/21d6b9dc9961_add_mismatch_scheme_state_to_requests.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/21d6b9dc9961_add_mismatch_scheme_state_to_requests.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/22cf51430c78_add_availability_column_to_table_rses.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/22cf51430c78_add_availability_column_to_table_rses.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,19 +11,17 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 ''' add availability column to table RSEs '''
 
 import sqlalchemy as sa
-
 from alembic import context
 from alembic.op import add_column, drop_column
 
-
 # Alembic revision identifiers
 revision = '22cf51430c78'
 down_revision = '49a21b4d4357'
 
 
 def upgrade():
     '''
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/22d887e4ec0a_create_sources_table.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/22d887e4ec0a_create_sources_table.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -15,16 +14,15 @@
 
 ''' create sources table '''
 
 import datetime
 
 import sqlalchemy as sa
 from alembic import context
-from alembic.op import (create_table, create_primary_key, create_foreign_key,
-                        create_check_constraint, create_index, drop_table)
+from alembic.op import create_check_constraint, create_foreign_key, create_index, create_primary_key, create_table, drop_table
 
 from rucio.db.sqla.types import GUID
 
 # Alembic revision identifiers
 revision = '22d887e4ec0a'
 down_revision = '1a80adff031a'
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/25821a8a45a3_remove_unique_constraint_on_requests.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/25821a8a45a3_remove_unique_constraint_on_requests.py`

 * *Files 5% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,17 +11,15 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 ''' remove unique constraint on requests '''
 
 from alembic import context
-from alembic.op import (create_foreign_key, create_index, drop_index,
-                        drop_constraint, create_unique_constraint)
-
+from alembic.op import create_foreign_key, create_index, create_unique_constraint, drop_constraint, drop_index
 
 # Alembic revision identifiers
 revision = '25821a8a45a3'
 down_revision = '1803333ac20f'
 
 
 def upgrade():
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/25fc855625cf_added_unique_constraint_to_rules.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/25fc855625cf_added_unique_constraint_to_rules.py`

 * *Files 7% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -14,15 +13,14 @@
 # limitations under the License.
 
 ''' added unique constraint to rules '''
 
 from alembic import context
 from alembic.op import create_index, drop_index
 
-
 # Alembic revision identifiers
 revision = '25fc855625cf'
 down_revision = '4a7182d9578b'
 
 
 def upgrade():
     '''
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/269fee20dee9_add_repair_cnt_to_locks.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/52fd9f4916fa_added_activity_to_rules.py`

 * *Files 9% similar despite different names*

```diff
@@ -1,46 +1,43 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-''' add repair_cnt to locks '''
+''' added share to rules '''
 
 import sqlalchemy as sa
-
 from alembic import context
 from alembic.op import add_column, drop_column
 
-
 # Alembic revision identifiers
-revision = '269fee20dee9'
-down_revision = '1d96f484df21'
+revision = '52fd9f4916fa'
+down_revision = '4a2cbedda8b9'
 
 
 def upgrade():
     '''
     Upgrade the database to this revision
     '''
 
     if context.get_context().dialect.name in ['oracle', 'mysql', 'postgresql']:
         schema = context.get_context().version_table_schema if context.get_context().version_table_schema else ''
-        add_column('locks', sa.Column('repair_cnt', sa.BigInteger()), schema=schema)
+        add_column('rules', sa.Column('activity', sa.String(50)), schema=schema)
 
 
 def downgrade():
     '''
     Downgrade the database to the previous revision
     '''
 
     if context.get_context().dialect.name in ['oracle', 'mysql', 'postgresql']:
         schema = context.get_context().version_table_schema if context.get_context().version_table_schema else ''
-        drop_column('locks', 'repair_cnt', schema=schema)
+        drop_column('rules', 'activity', schema=schema)
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/271a46ea6244_add_ignore_availability_column_to_rules.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/271a46ea6244_add_ignore_availability_column_to_rules.py`

 * *Files 8% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,19 +11,17 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 ''' add ignore_availability column to rules '''
 
 import sqlalchemy as sa
-
 from alembic import context
 from alembic.op import add_column, drop_column
 
-
 # Alembic revision identifiers
 revision = '271a46ea6244'
 down_revision = 'd6dceb1de2d'
 
 
 def upgrade():
     '''
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/277b5fbb41d3_switch_heartbeats_executable.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/277b5fbb41d3_switch_heartbeats_executable.py`

 * *Files 11% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -13,15 +12,15 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 ''' switch heartbeats executable '''
 
 import sqlalchemy as sa
 from alembic import context
-from alembic.op import create_primary_key, add_column, drop_constraint, drop_column
+from alembic.op import add_column, create_primary_key, drop_column, drop_constraint
 
 from rucio.db.sqla.models import String
 
 # Alembic revision identifiers
 revision = '277b5fbb41d3'
 down_revision = '44278720f774'
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/27e3a68927fb_remove_replicas_tombstone_and_replicas_.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/27e3a68927fb_remove_replicas_tombstone_and_replicas_.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/2854cd9e168_added_rule_id_column.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/2854cd9e168_added_rule_id_column.py`

 * *Files 3% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/295289b5a800_processed_by_and__at_in_requests.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/295289b5a800_processed_by_and__at_in_requests.py`

 * *Files 3% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,15 +11,14 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 """ processed_by and _at in requests """
 
 import sqlalchemy as sa
-
 from alembic import context
 from alembic.op import add_column, drop_column
 
 # Alembic revision identifiers
 revision = '295289b5a800'
 down_revision = 'a6eb23955c28'
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/2962ece31cf4_add_nbaccesses_column_in_the_did_table.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/2962ece31cf4_add_nbaccesses_column_in_the_did_table.py`

 * *Files 3% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,19 +11,17 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 ''' add access_cnt column in the DID table '''
 
 import sqlalchemy as sa
-
 from alembic import context
 from alembic.op import add_column, drop_column
 
-
 # Alembic revision identifiers
 revision = '2962ece31cf4'
 down_revision = '94a5961ddbf2'
 
 
 def upgrade():
     '''
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/2af3291ec4c_added_replicas_history_table.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/2af3291ec4c_added_replicas_history_table.py`

 * *Files 3% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -13,16 +12,15 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 ''' added replicas history table '''
 
 import sqlalchemy as sa
 from alembic import context
-from alembic.op import (create_table, create_primary_key, create_foreign_key,
-                        create_check_constraint, drop_constraint, drop_table)
+from alembic.op import create_check_constraint, create_foreign_key, create_primary_key, create_table, drop_constraint, drop_table
 
 from rucio.db.sqla.types import GUID
 
 # Alembic revision identifiers
 revision = '2af3291ec4c'
 down_revision = '32c7d2783f7e'
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/2b69addda658_add_columns_for_third_party_copy_read_.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/2b69addda658_add_columns_for_third_party_copy_read_.py`

 * *Files 6% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,15 +11,14 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 ''' Add columns for third_party_copy_read and third_party_copy_write '''
 
 import sqlalchemy as sa
-
 from alembic import context
 from alembic.op import add_column, drop_column
 
 # Alembic revision identifiers
 revision = '2b69addda658'
 down_revision = 'bc68e9946deb'
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/2b8e7bcb4783_add_config_table.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/2b8e7bcb4783_add_config_table.py`

 * *Files 5% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -15,17 +14,15 @@
 
 ''' add config table '''
 
 import datetime
 
 import sqlalchemy as sa
 from alembic import context
-from alembic.op import (create_table, create_primary_key,
-                        create_check_constraint,
-                        drop_constraint, drop_table)
+from alembic.op import create_check_constraint, create_primary_key, create_table, drop_constraint, drop_table
 
 # Alembic revision identifiers
 revision = '2b8e7bcb4783'
 down_revision = 'd91002c5841'
 
 
 def upgrade():
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/2ba5229cb54c_add_submitted_at_to_requests_table.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/2ba5229cb54c_add_submitted_at_to_requests_table.py`

 * *Files 6% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,19 +11,17 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 ''' add_submitted_at_to_requests_table '''
 
 import sqlalchemy as sa
-
 from alembic import context
 from alembic.op import add_column, drop_column
 
-
 # Alembic revision identifiers
 revision = '2ba5229cb54c'
 down_revision = '22d887e4ec0a'
 
 
 def upgrade():
     '''
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/2cbee484dcf9_added_column_volume_to_rse_transfer_.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/2cbee484dcf9_added_column_volume_to_rse_transfer_.py`

 * *Files 3% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,18 +11,16 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 ''' added column volume to rse_transfer_limits '''
 
 import sqlalchemy as sa
-
 from alembic import context
-from alembic.op import (drop_column, add_column)
-
+from alembic.op import add_column, drop_column
 
 # Alembic revision identifiers
 revision = '2cbee484dcf9'
 down_revision = 'cebad904c4dd'
 
 
 def upgrade():
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/2edee4a83846_add_source_to_requests_and_requests_.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/2edee4a83846_add_source_to_requests_and_requests_.py`

 * *Files 6% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/2eef46be23d4_change_tokens_pk.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/2eef46be23d4_change_tokens_pk.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,16 +11,15 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 ''' change tokens pk '''
 
 from alembic import context
-from alembic.op import create_primary_key, create_foreign_key, drop_constraint
-
+from alembic.op import create_foreign_key, create_primary_key, drop_constraint
 
 # Alembic revision identifiers
 revision = '2eef46be23d4'
 down_revision = '58c8b78301ab'
 
 
 def upgrade():
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/2f648fc909f3_index_in_rule_history_on_scope_name.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/4bab9edd01fc_create_index_on_requests_rule_id.py`

 * *Files 12% similar despite different names*

```diff
@@ -1,42 +1,40 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-''' index in rule_history on scope, name '''
+''' create index on requests.rule_id '''
 
 from alembic import context
 from alembic.op import create_index, drop_index
 
-
 # Alembic revision identifiers
-revision = '2f648fc909f3'
-down_revision = 'bb695f45c04'
+revision = '4bab9edd01fc'
+down_revision = 'ae2a56fcc89'
 
 
 def upgrade():
     '''
     Upgrade the database to this revision
     '''
 
     if context.get_context().dialect.name in ['oracle', 'mysql', 'postgresql']:
-        create_index('RULES_HISTORY_SCOPENAME_IDX', 'rules_history', ['scope', 'name'])
+        create_index('REQUESTS_RULEID_IDX', 'requests', ['rule_id'])
 
 
 def downgrade():
     '''
     Downgrade the database to the previous revision
     '''
 
     if context.get_context().dialect.name in ['oracle', 'mysql', 'postgresql']:
-        drop_index('RULES_HISTORY_SCOPENAME_IDX', 'rules_history')
+        drop_index('REQUESTS_RULEID_IDX', 'requests')
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/3082b8cef557_add_naming_convention_table_and_closed_.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/3082b8cef557_add_naming_convention_table_and_closed_.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -15,16 +14,15 @@
 
 ''' add convention table and closed_at to dids '''
 
 import datetime
 
 import sqlalchemy as sa
 from alembic import context
-from alembic.op import (create_table, create_primary_key, create_foreign_key, add_column,
-                        create_check_constraint, drop_column, drop_table)
+from alembic.op import add_column, create_check_constraint, create_foreign_key, create_primary_key, create_table, drop_column, drop_table
 
 from rucio.common.schema import get_schema_value
 from rucio.db.sqla.constants import KeyType
 
 # Alembic revision identifiers
 revision = '3082b8cef557'
 down_revision = '269fee20dee9'
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/30fa38b6434e_add_index_on_service_column_in_the_message_table.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/30fa38b6434e_add_index_on_service_column_in_the_message_table.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -11,17 +10,16 @@
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 ''' Add index on service column in the message table '''
 import sqlalchemy as sa
-
 from alembic import context
-from alembic.op import create_index, drop_index, alter_column
+from alembic.op import alter_column, create_index, drop_index
 
 # Alembic revision identifiers
 revision = '30fa38b6434e'
 down_revision = 'e138c364ebd0'
 
 
 def upgrade():
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/3152492b110b_added_staging_area_column.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/3152492b110b_added_staging_area_column.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -13,15 +12,15 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 ''' added staging_area column '''
 
 import sqlalchemy as sa
 from alembic import context, op
-from alembic.op import add_column, create_check_constraint, drop_constraint, drop_column
+from alembic.op import add_column, create_check_constraint, drop_column, drop_constraint
 
 from rucio.db.sqla.util import try_drop_constraint
 
 # Alembic revision identifiers
 revision = '3152492b110b'
 down_revision = '22cf51430c78'
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/32c7d2783f7e_create_bad_replicas_table.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/32c7d2783f7e_create_bad_replicas_table.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -15,16 +14,15 @@
 
 ''' create bad replicas table '''
 
 import datetime
 
 import sqlalchemy as sa
 from alembic import context
-from alembic.op import (create_table, create_primary_key, create_foreign_key,
-                        create_check_constraint, create_index, drop_table)
+from alembic.op import create_check_constraint, create_foreign_key, create_index, create_primary_key, create_table, drop_table
 
 from rucio.db.sqla.types import GUID
 
 # Alembic revision identifiers
 revision = '32c7d2783f7e'
 down_revision = '384b96aa0f60'
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/3345511706b8_replicas_table_pk_definition_is_in_.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/3345511706b8_replicas_table_pk_definition_is_in_.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,16 +11,15 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 ''' replicas table PK definition is in wrong order '''
 
 from alembic import context
-from alembic.op import create_primary_key, drop_constraint, create_foreign_key, drop_index
-
+from alembic.op import create_foreign_key, create_primary_key, drop_constraint, drop_index
 
 # revision identifiers used by alembic
 revision = '3345511706b8'
 down_revision = '01eaf73ab656'
 
 
 def upgrade():
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/35ef10d1e11b_change_index_on_table_requests.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/35ef10d1e11b_change_index_on_table_requests.py`

 * *Files 6% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -14,15 +13,14 @@
 # limitations under the License.
 
 ''' change index on table requests '''
 
 from alembic import context
 from alembic.op import create_index, drop_index
 
-
 # Alembic revision identifiers
 revision = '35ef10d1e11b'
 down_revision = '3152492b110b'
 
 
 def upgrade():
     '''
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/379a19b5332d_create_rse_limits_table.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/379a19b5332d_create_rse_limits_table.py`

 * *Files 5% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -15,16 +14,15 @@
 
 ''' create rse transfer limits table '''
 
 import datetime
 
 import sqlalchemy as sa
 from alembic import context
-from alembic.op import (create_table, create_primary_key, create_foreign_key,
-                        create_check_constraint, drop_table)
+from alembic.op import create_check_constraint, create_foreign_key, create_primary_key, create_table, drop_table
 
 from rucio.db.sqla.types import GUID
 
 # Alembic revision identifiers
 revision = '379a19b5332d'
 down_revision = '58bff7008037'
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/384b96aa0f60_created_rule_history_tables.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/384b96aa0f60_created_rule_history_tables.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -15,17 +14,17 @@
 
 ''' created rule history tables '''
 
 import datetime
 
 import sqlalchemy as sa
 from alembic import context
-from alembic.op import create_table, create_index, drop_table, drop_index, create_primary_key
+from alembic.op import create_index, create_primary_key, create_table, drop_index, drop_table
 
-from rucio.db.sqla.constants import (DIDType, RuleGrouping, RuleState, RuleNotification)
+from rucio.db.sqla.constants import DIDType, RuleGrouping, RuleNotification, RuleState
 from rucio.db.sqla.types import GUID
 
 # Alembic revision identifiers
 revision = '384b96aa0f60'
 down_revision = '4cf0a2e127d4'
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/3ac1660a1a72_extend_distance_table.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/3ac1660a1a72_extend_distance_table.py`

 * *Files 5% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,19 +11,17 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 ''' extend distance table '''
 
 import sqlalchemy as sa
-
 from alembic import context
 from alembic.op import add_column, drop_column
 
-
 # Alembic revision identifiers
 revision = '3ac1660a1a72'
 down_revision = '5673b4b6e843'
 
 
 def upgrade():
     '''
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/3ad36e2268b0_create_collection_replicas_updates_table.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/3ad36e2268b0_create_collection_replicas_updates_table.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -15,17 +14,15 @@
 
 ''' create collection_replicas_updates table '''
 
 import datetime
 
 import sqlalchemy as sa
 from alembic import context
-from alembic.op import (create_table, create_primary_key, add_column,
-                        create_check_constraint, create_index,
-                        drop_constraint, drop_column, drop_table, drop_index)
+from alembic.op import add_column, create_check_constraint, create_index, create_primary_key, create_table, drop_column, drop_constraint, drop_index, drop_table
 
 from rucio.db.sqla.constants import DIDType
 from rucio.db.sqla.types import GUID
 
 # Alembic revision identifiers
 revision = '3ad36e2268b0'
 down_revision = '42db2617c364'
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/3c9df354071b_extend_waiting_request_state.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/3c9df354071b_extend_waiting_request_state.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/3d9813fab443_add_a_new_state_lost_in_badfilesstatus.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/3d9813fab443_add_a_new_state_lost_in_badfilesstatus.py`

 * *Files 9% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/40ad39ce3160_add_transferred_at_to_requests_table.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/5673b4b6e843_add_wfms_metadata_to_rule_tables.py`

 * *Files 10% similar despite different names*

```diff
@@ -1,46 +1,47 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-''' add_transferred_at_to_requests_table '''
+''' add metadata to rule tables '''
 
 import sqlalchemy as sa
-
 from alembic import context
 from alembic.op import add_column, drop_column
 
-
 # Alembic revision identifiers
-revision = '40ad39ce3160'
-down_revision = '2ba5229cb54c'
+revision = '5673b4b6e843'
+down_revision = 'e59300c8b179'
 
 
 def upgrade():
     '''
     Upgrade the database to this revision
     '''
 
     if context.get_context().dialect.name in ['oracle', 'mysql', 'postgresql']:
         schema = context.get_context().version_table_schema if context.get_context().version_table_schema else ''
-        add_column('requests', sa.Column('transferred_at', sa.DateTime()), schema=schema)
+        add_column('rules', sa.Column('meta', sa.String(4000)), schema=schema)
+        add_column('rules_history', sa.Column('meta', sa.String(4000)), schema=schema)
+        add_column('rules_hist_recent', sa.Column('meta', sa.String(4000)), schema=schema)
 
 
 def downgrade():
     '''
     Downgrade the database to the previous revision
     '''
 
     if context.get_context().dialect.name in ['oracle', 'mysql', 'postgresql']:
         schema = context.get_context().version_table_schema if context.get_context().version_table_schema else ''
-        drop_column('requests', 'transferred_at', schema=schema)
+        drop_column('rules', 'meta', schema=schema)
+        drop_column('rules_history', 'meta', schema=schema)
+        drop_column('rules_hist_recent', 'meta', schema=schema)
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/4207be2fd914_add_notification_column_to_rules.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/4207be2fd914_add_notification_column_to_rules.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/42db2617c364_create_index_on_requests_external_id.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/739064d31565_remove_history_table_pks.py`

 * *Files 14% similar despite different names*

```diff
@@ -1,42 +1,41 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-''' create index on requests.external_id '''
+''' remove history table pks '''
 
 from alembic import context
-from alembic.op import create_index, drop_index
-
+from alembic.op import create_primary_key, drop_constraint
 
 # Alembic revision identifiers
-revision = '42db2617c364'
-down_revision = '4bab9edd01fc'
+revision = '739064d31565'
+down_revision = 'ccdbcd48206e'
 
 
 def upgrade():
     '''
     Upgrade the database to this revision
     '''
 
     if context.get_context().dialect.name in ['oracle', 'mysql', 'postgresql']:
-        create_index('REQUESTS_EXTERNALID_UQ', 'requests', ['external_id'])
+        # CONFIGS_HISTORY
+        drop_constraint('CONFIGS_HISTORY_PK', 'configs_history', type_='primary')
 
 
 def downgrade():
     '''
     Downgrade the database to the previous revision
     '''
 
     if context.get_context().dialect.name in ['oracle', 'mysql', 'postgresql']:
-        drop_index('REQUESTS_EXTERNALID_UQ', 'requests')
+        create_primary_key('CONFIGS_HISTORY_PK', 'configs_history', ['section', 'opt', 'updated_at'])
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/436827b13f82_added_column_activity_to_table_requests.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/436827b13f82_added_column_activity_to_table_requests.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,19 +11,17 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 ''' added column activity to table requests '''
 
 import sqlalchemy as sa
-
 from alembic import context
 from alembic.op import add_column, drop_column
 
-
 # Alembic revision identifiers
 revision = '436827b13f82'
 down_revision = '102efcf145f4'
 
 
 def upgrade():
     '''
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/44278720f774_update_requests_typ_sta_upd_idx_index.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/44278720f774_update_requests_typ_sta_upd_idx_index.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -14,15 +13,14 @@
 # limitations under the License.
 
 ''' update REQUESTS_TYP_STA_UPD_IDX index '''
 
 from alembic import context
 from alembic.op import create_index, drop_index
 
-
 # Alembic revision identifiers
 revision = '44278720f774'
 down_revision = '40ad39ce3160'
 
 
 def upgrade():
     '''
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/45378a1e76a8_create_collection_replica_table.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/45378a1e76a8_create_collection_replica_table.py`

 * *Files 6% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -15,18 +14,17 @@
 
 ''' create collection replica table '''
 
 import datetime
 
 import sqlalchemy as sa
 from alembic import context
-from alembic.op import (create_table, create_primary_key, create_foreign_key,
-                        create_check_constraint, create_index, drop_table)
+from alembic.op import create_check_constraint, create_foreign_key, create_index, create_primary_key, create_table, drop_table
 
-from rucio.db.sqla.constants import ReplicaState, DIDType
+from rucio.db.sqla.constants import DIDType, ReplicaState
 from rucio.db.sqla.types import GUID
 from rucio.db.sqla.util import try_drop_constraint
 
 # Alembic revision identifiers
 revision = '45378a1e76a8'
 down_revision = 'a93e4e47bda'
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/469d262be19_removing_created_at_index.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/469d262be19_removing_created_at_index.py`

 * *Files 12% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -14,15 +13,14 @@
 # limitations under the License.
 
 ''' removing created_at index '''
 
 from alembic import context
 from alembic.op import create_index, drop_index
 
-
 revision = '469d262be19'
 down_revision = '16a0aca82e12'
 
 
 def upgrade():
     '''
     Upgrade the database to this revision
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/4783c1f49cb4_create_distance_table.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/4783c1f49cb4_create_distance_table.py`

 * *Files 8% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -15,16 +14,15 @@
 
 ''' create distance table '''
 
 import datetime
 
 import sqlalchemy as sa
 from alembic import context
-from alembic.op import (create_table, create_primary_key, create_foreign_key,
-                        create_check_constraint, create_index, drop_table)
+from alembic.op import create_check_constraint, create_foreign_key, create_index, create_primary_key, create_table, drop_table
 
 from rucio.db.sqla.types import GUID
 
 # Alembic revision identifiers
 revision = '4783c1f49cb4'
 down_revision = '277b5fbb41d3'
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/49a21b4d4357_create_index_on_table_tokens.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/49a21b4d4357_create_index_on_table_tokens.py`

 * *Files 5% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,17 +11,15 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 ''' add tokens index '''
 
 from alembic import context
-from alembic.op import (create_foreign_key, create_index,
-                        drop_constraint, drop_index)
-
+from alembic.op import create_foreign_key, create_index, drop_constraint, drop_index
 
 # Alembic revision identifiers
 revision = '49a21b4d4357'
 down_revision = '2eef46be23d4'
 
 
 def upgrade():
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/4a2cbedda8b9_add_source_replica_expression_column_to_.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/4a2cbedda8b9_add_source_replica_expression_column_to_.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,19 +11,17 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 ''' add_source_replica_expression_column_to_rules '''
 
 import sqlalchemy as sa
-
 from alembic import context
 from alembic.op import add_column, drop_column
 
-
 # Alembic revision identifiers
 revision = '4a2cbedda8b9'
 down_revision = 'a616581ee47'
 
 
 def upgrade():
     '''
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/4a7182d9578b_added_bytes_length_accessed_at_columns.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/4a7182d9578b_added_bytes_length_accessed_at_columns.py`

 * *Files 6% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,19 +11,17 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 ''' added bytes, length, accessed_at columns '''
 
 import sqlalchemy as sa
-
 from alembic import context
 from alembic.op import add_column, drop_column
 
-
 # Alembic revision identifiers
 revision = '4a7182d9578b'
 down_revision = 'c129ccdb2d5'
 
 
 def upgrade():
     '''
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/4bab9edd01fc_create_index_on_requests_rule_id.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/b818052fa670_add_index_to_quarantined_replicas.py`

 * *Files 15% similar despite different names*

```diff
@@ -1,42 +1,40 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-''' create index on requests.rule_id '''
+''' add index to quarantined replicas '''
 
 from alembic import context
 from alembic.op import create_index, drop_index
 
-
-# Alembic revision identifiers
-revision = '4bab9edd01fc'
-down_revision = 'ae2a56fcc89'
+# revision identifiers, used by Alembic.
+revision = 'b818052fa670'
+down_revision = '2962ece31cf4'
 
 
 def upgrade():
     '''
     Upgrade the database to this revision
     '''
 
     if context.get_context().dialect.name in ['oracle', 'mysql', 'postgresql']:
-        create_index('REQUESTS_RULEID_IDX', 'requests', ['rule_id'])
+        create_index('QUARANTINED_REPLICAS_PATH_IDX', 'quarantined_replicas', ['path', 'rse_id'], unique=True)
 
 
 def downgrade():
     '''
     Downgrade the database to the previous revision
     '''
 
     if context.get_context().dialect.name in ['oracle', 'mysql', 'postgresql']:
-        drop_index('REQUESTS_RULEID_IDX', 'requests')
+        drop_index('QUARANTINED_REPLICAS_PATH_IDX', 'quarantined_replicas')
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/4c3a4acfe006_new_attr_account_table.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/4c3a4acfe006_new_attr_account_table.py`

 * *Files 3% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -15,16 +14,15 @@
 
 ''' new attr account table '''
 
 import datetime
 
 import sqlalchemy as sa
 from alembic import context
-from alembic.op import (create_table, create_primary_key, create_foreign_key,
-                        create_check_constraint, create_index, drop_table)
+from alembic.op import create_check_constraint, create_foreign_key, create_index, create_primary_key, create_table, drop_table
 
 # Alembic revision identifiers
 revision = '4c3a4acfe006'
 down_revision = '25fc855625cf'
 
 
 def upgrade():
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/4cf0a2e127d4_adding_transient_metadata.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/4cf0a2e127d4_adding_transient_metadata.py`

 * *Files 8% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,19 +11,17 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 ''' adding transient metadata '''
 
 import sqlalchemy as sa
-
 from alembic import context
 from alembic.op import add_column, drop_column
 
-
 # Alembic revision identifiers
 revision = '4cf0a2e127d4'
 down_revision = '271a46ea6244'
 
 
 def upgrade():
     '''
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/4df2c5ddabc0_remove_temporary_dids.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/4df2c5ddabc0_remove_temporary_dids.py`

 * *Files 3% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -16,15 +15,15 @@
 ''' remove temporary dids '''
 
 import sqlalchemy as sa
 from alembic import context
 from alembic.op import create_index, create_primary_key, create_table, drop_table
 
 from rucio.common.schema import get_schema_value
-from rucio.db.sqla.types import InternalScopeString, GUID
+from rucio.db.sqla.types import GUID, InternalScopeString
 
 # Alembic revision identifiers
 revision = '4df2c5ddabc0'
 down_revision = '27e3a68927fb'
 
 
 def upgrade():
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/50280c53117c_add_qos_class_to_rse.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/50280c53117c_add_qos_class_to_rse.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,15 +11,14 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 ''' add qos class to rse '''
 
 import sqlalchemy as sa
-
 from alembic import context
 from alembic.op import add_column, drop_column
 
 # Alembic revision identifiers
 revision = '50280c53117c'
 down_revision = 'c0937668555f'
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/52153819589c_add_rse_id_to_replicas_table.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/52153819589c_add_rse_id_to_replicas_table.py`

 * *Files 10% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -15,15 +14,14 @@
 
 ''' add_rse_id_to_replicas_table '''
 
 
 from alembic import context
 from alembic.op import create_foreign_key, create_index, drop_constraint, drop_index
 
-
 # Alembic revision identifiers
 revision = '52153819589c'
 down_revision = '30fa38b6434e'
 
 
 def upgrade():
     '''
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/52fd9f4916fa_added_activity_to_rules.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/b4293a99f344_added_column_identity_to_table_tokens.py`

 * *Files 7% similar despite different names*

```diff
@@ -1,46 +1,43 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-''' added share to rules '''
+''' added column identity to table tokens '''
 
 import sqlalchemy as sa
-
 from alembic import context
 from alembic.op import add_column, drop_column
 
-
 # Alembic revision identifiers
-revision = '52fd9f4916fa'
-down_revision = '4a2cbedda8b9'
+revision = 'b4293a99f344'
+down_revision = '3ac1660a1a72'
 
 
 def upgrade():
     '''
     Upgrade the database to this revision
     '''
 
     if context.get_context().dialect.name in ['oracle', 'mysql', 'postgresql']:
         schema = context.get_context().version_table_schema if context.get_context().version_table_schema else ''
-        add_column('rules', sa.Column('activity', sa.String(50)), schema=schema)
+        add_column('tokens', sa.Column('identity', sa.String(255)), schema=schema)
 
 
 def downgrade():
     '''
     Downgrade the database to the previous revision
     '''
 
     if context.get_context().dialect.name in ['oracle', 'mysql', 'postgresql']:
         schema = context.get_context().version_table_schema if context.get_context().version_table_schema else ''
-        drop_column('rules', 'activity', schema=schema)
+        drop_column('tokens', 'identity', schema=schema)
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/53b479c3cb0f_fix_did_meta_table_missing_updated_at_.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/53b479c3cb0f_fix_did_meta_table_missing_updated_at_.py`

 * *Files 3% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,19 +11,17 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 ''' fix did_meta table missing updated_at, created_at columns '''
 
 import sqlalchemy as sa
-
 from alembic import context
 from alembic.op import add_column, drop_column
 
-
 # Alembic revision identifiers
 revision = '53b479c3cb0f'
 down_revision = '2cbee484dcf9'
 
 
 def upgrade():
     '''
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/5673b4b6e843_add_wfms_metadata_to_rule_tables.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/ae2a56fcc89_added_comment_column_to_rules.py`

 * *Files 10% similar despite different names*

```diff
@@ -1,50 +1,49 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-''' add metadata to rule tables '''
+''' added comment column to rules '''
 
 import sqlalchemy as sa
-
 from alembic import context
 from alembic.op import add_column, drop_column
 
+from rucio.db.sqla.models import String
 
 # Alembic revision identifiers
-revision = '5673b4b6e843'
-down_revision = 'e59300c8b179'
+revision = 'ae2a56fcc89'
+down_revision = '45378a1e76a8'
 
 
 def upgrade():
     '''
     Upgrade the database to this revision
     '''
 
     if context.get_context().dialect.name in ['oracle', 'mysql', 'postgresql']:
         schema = context.get_context().version_table_schema if context.get_context().version_table_schema else ''
-        add_column('rules', sa.Column('meta', sa.String(4000)), schema=schema)
-        add_column('rules_history', sa.Column('meta', sa.String(4000)), schema=schema)
-        add_column('rules_hist_recent', sa.Column('meta', sa.String(4000)), schema=schema)
+        add_column('rules', sa.Column('comments', String(255)), schema=schema)
+        add_column('rules_hist_recent', sa.Column('comments', String(255)), schema=schema)
+        add_column('rules_history', sa.Column('comments', String(255)), schema=schema)
 
 
 def downgrade():
     '''
     Downgrade the database to the previous revision
     '''
 
     if context.get_context().dialect.name in ['oracle', 'mysql', 'postgresql']:
         schema = context.get_context().version_table_schema if context.get_context().version_table_schema else ''
-        drop_column('rules', 'meta', schema=schema)
-        drop_column('rules_history', 'meta', schema=schema)
-        drop_column('rules_hist_recent', 'meta', schema=schema)
+        drop_column('rules', 'comments', schema=schema)
+        drop_column('rules_hist_recent', 'comments', schema=schema)
+        drop_column('rules_history', 'comments', schema=schema)
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/575767d9f89_added_source_history_table.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/575767d9f89_added_source_history_table.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -13,15 +12,15 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 ''' added source history table '''
 
 import sqlalchemy as sa
 from alembic import context
-from alembic.op import create_table, add_column, drop_column, drop_table
+from alembic.op import add_column, create_table, drop_column, drop_table
 
 from rucio.db.sqla.types import GUID
 
 # Alembic revision identifiers
 revision = '575767d9f89'
 down_revision = '379a19b5332d'
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/58bff7008037_add_started_at_to_requests.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/58bff7008037_add_started_at_to_requests.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,19 +11,17 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 ''' add started_at to requests '''
 
 import sqlalchemy as sa
-
 from alembic import context
 from alembic.op import add_column, drop_column
 
-
 # Alembic revision identifiers
 revision = '58bff7008037'
 down_revision = '3c9df354071b'
 
 
 def upgrade():
     '''
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/58c8b78301ab_rename_callback_to_message.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/58c8b78301ab_rename_callback_to_message.py`

 * *Files 5% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,16 +11,15 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 ''' rename callback to message '''
 
 from alembic import context, op
-from alembic.op import (create_primary_key, create_check_constraint,
-                        drop_constraint, rename_table)
+from alembic.op import create_check_constraint, create_primary_key, drop_constraint, rename_table
 
 from rucio.db.sqla.util import try_drop_constraint
 
 # Alembic revision identifiers
 revision = '58c8b78301ab'
 down_revision = '2b8e7bcb4783'
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/5f139f77382a_added_child_rule_id_column.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/5f139f77382a_added_child_rule_id_column.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -13,16 +12,15 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 ''' added child_rule_id column '''
 
 import sqlalchemy as sa
 from alembic import context
-from alembic.op import (create_foreign_key, add_column, create_index,
-                        drop_constraint, drop_column, drop_index)
+from alembic.op import add_column, create_foreign_key, create_index, drop_column, drop_constraint, drop_index
 
 from rucio.db.sqla.types import GUID
 
 # Alembic revision identifiers
 revision = '5f139f77382a'
 down_revision = '1d1215494e95'
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/688ef1840840_adding_did_meta_table.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/688ef1840840_adding_did_meta_table.py`

 * *Files 8% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -13,15 +12,15 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 ''' adding did_meta table '''
 
 import sqlalchemy as sa
 from alembic import context
-from alembic.op import create_primary_key, create_table, create_foreign_key, drop_table
+from alembic.op import create_foreign_key, create_primary_key, create_table, drop_table
 
 from rucio.db.sqla.types import JSON
 
 # Alembic revision identifiers
 revision = '688ef1840840'
 down_revision = 'b818052fa670'
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/6e572a9bfbf3_add_new_split_container_column_to_rules.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/6e572a9bfbf3_add_new_split_container_column_to_rules.py`

 * *Files 6% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,19 +11,17 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 ''' add new split_container column to rules '''
 
 import sqlalchemy as sa
-
 from alembic import context
 from alembic.op import add_column, drop_column
 
-
 # Alembic revision identifiers
 revision = '6e572a9bfbf3'
 down_revision = '914b8f02df38'
 
 
 def upgrade():
     '''
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/70587619328_add_comment_column_for_subscriptions.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/70587619328_add_comment_column_for_subscriptions.py`

 * *Files 6% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,19 +11,17 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 ''' add comment column for subscriptions '''
 
 import sqlalchemy as sa
-
 from alembic import context
 from alembic.op import add_column, drop_column
 
-
 # Alembic revision identifiers
 revision = '70587619328'
 down_revision = '4207be2fd914'
 
 
 def upgrade():
     '''
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/739064d31565_remove_history_table_pks.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/42db2617c364_create_index_on_requests_external_id.py`

 * *Files 15% similar despite different names*

```diff
@@ -1,42 +1,40 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-''' remove history table pks '''
+''' create index on requests.external_id '''
 
 from alembic import context
-from alembic.op import drop_constraint, create_primary_key
+from alembic.op import create_index, drop_index
 
 # Alembic revision identifiers
-revision = '739064d31565'
-down_revision = 'ccdbcd48206e'
+revision = '42db2617c364'
+down_revision = '4bab9edd01fc'
 
 
 def upgrade():
     '''
     Upgrade the database to this revision
     '''
 
     if context.get_context().dialect.name in ['oracle', 'mysql', 'postgresql']:
-        # CONFIGS_HISTORY
-        drop_constraint('CONFIGS_HISTORY_PK', 'configs_history', type_='primary')
+        create_index('REQUESTS_EXTERNALID_UQ', 'requests', ['external_id'])
 
 
 def downgrade():
     '''
     Downgrade the database to the previous revision
     '''
 
     if context.get_context().dialect.name in ['oracle', 'mysql', 'postgresql']:
-        create_primary_key('CONFIGS_HISTORY_PK', 'configs_history', ['section', 'opt', 'updated_at'])
+        drop_index('REQUESTS_EXTERNALID_UQ', 'requests')
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/7541902bf173_add_didsfollowed_and_followevents_table.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/7541902bf173_add_didsfollowed_and_followevents_table.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -15,16 +14,15 @@
 
 ''' add DidsFollowed and FollowEvents table '''
 
 import datetime
 
 import sqlalchemy as sa
 from alembic import context
-from alembic.op import (create_table, create_primary_key, create_check_constraint,
-                        create_foreign_key, create_index, drop_table)
+from alembic.op import create_check_constraint, create_foreign_key, create_index, create_primary_key, create_table, drop_table
 
 from rucio.db.sqla.constants import DIDType
 
 # Alembic revision identifiers
 revision = '7541902bf173'
 down_revision = 'a74275a1ad30'
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/7ec22226cdbf_new_replica_state_for_temporary_.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/7ec22226cdbf_new_replica_state_for_temporary_.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/810a41685bc1_added_columns_rse_transfer_limits.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/810a41685bc1_added_columns_rse_transfer_limits.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,18 +11,16 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 ''' added_columns_rse_transfer_limits '''
 
 import sqlalchemy as sa
-
 from alembic import context
-from alembic.op import (add_column, drop_column)
-
+from alembic.op import add_column, drop_column
 
 # Alembic revision identifiers
 revision = '810a41685bc1'
 down_revision = '7541902bf173'
 
 
 def upgrade():
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/83f991c63a93_correct_rse_expression_length.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/83f991c63a93_correct_rse_expression_length.py`

 * *Files 6% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,15 +11,14 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 ''' correct rse_expression length '''
 
 import sqlalchemy as sa
-
 from alembic import context
 from alembic.op import alter_column
 
 # Alembic revision identifiers
 revision = '83f991c63a93'
 down_revision = '2190e703eb6e'
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/8523998e2e76_increase_size_of_extended_attributes_.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/8523998e2e76_increase_size_of_extended_attributes_.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,19 +11,17 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 ''' increase size of extended_attributes column '''
 
 import sqlalchemy as sa
-
 from alembic import context
 from alembic.op import alter_column
 
-
 # Alembic revision identifiers
 revision = '8523998e2e76'
 down_revision = '7ec22226cdbf'
 
 
 def upgrade():
     '''
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/8ea9122275b1_adding_missing_function_based_indices.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/8ea9122275b1_adding_missing_function_based_indices.py`

 * *Files 5% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,15 +11,15 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 ''' Adding missing function based indices '''
 
 from alembic import context
-from alembic.op import create_index, drop_index, drop_constraint, create_foreign_key
+from alembic.op import create_foreign_key, create_index, drop_constraint, drop_index
 
 # Alembic revision identifiers
 revision = '8ea9122275b1'
 down_revision = '50280c53117c'
 
 
 def upgrade():
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/90f47792bb76_add_clob_payload_to_messages.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/90f47792bb76_add_clob_payload_to_messages.py`

 * *Files 3% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,19 +11,17 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 ''' add clob payload to messages '''
 
 import sqlalchemy as sa
-
 from alembic import context
 from alembic.op import add_column, drop_column
 
-
 # Alembic revision identifiers
 revision = '90f47792bb76'
 down_revision = 'bf3baa1c1474'
 
 
 def upgrade():
     '''
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/914b8f02df38_new_table_for_lifetime_model_exceptions.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/914b8f02df38_new_table_for_lifetime_model_exceptions.py`

 * *Files 8% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -15,16 +14,15 @@
 
 ''' new table for lifetime model exceptions '''
 
 import datetime
 
 import sqlalchemy as sa
 from alembic import context
-from alembic.op import (create_table, create_primary_key,
-                        create_check_constraint, drop_table)
+from alembic.op import create_check_constraint, create_primary_key, create_table, drop_table
 
 from rucio.db.sqla.constants import DIDType, LifetimeExceptionsState
 from rucio.db.sqla.types import GUID
 
 # Alembic revision identifiers
 revision = '914b8f02df38'
 down_revision = 'fe8ea2fa9788'
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/94a5961ddbf2_add_estimator_columns.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/94a5961ddbf2_add_estimator_columns.py`

 * *Files 3% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,19 +11,17 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 ''' add estimator columns to request table '''
 
 import sqlalchemy as sa
-
 from alembic import context
 from alembic.op import add_column, drop_column
 
-
 # Alembic revision identifiers
 revision = '94a5961ddbf2'
 down_revision = '1c45d9730ca6'
 
 
 def upgrade():
     '''
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/9a1b149a2044_add_saml_identity_type.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/9a1b149a2044_add_saml_identity_type.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/9a45bc4ea66d_add_vp_table.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/9a45bc4ea66d_add_vp_table.py`

 * *Files 8% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -13,15 +12,15 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 ''' add VP table '''
 
 import sqlalchemy as sa
 from alembic import context
-from alembic.op import create_primary_key, create_table, create_foreign_key, drop_table
+from alembic.op import create_foreign_key, create_primary_key, create_table, drop_table
 
 from rucio.common.schema import get_schema_value
 from rucio.db.sqla.types import JSON
 
 # Alembic revision identifiers
 revision = '9a45bc4ea66d'
 down_revision = '739064d31565'
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/9eb936a81eb1_true_is_true.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/9eb936a81eb1_true_is_true.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -13,15 +12,14 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 ''' true is true '''
 
 from alembic import context, op
 
-
 # Alembic revision identifiers
 revision = '9eb936a81eb1'
 down_revision = 'b96a1c7e1cc4'
 
 
 # IMPORTANT: Only execute this after you're running the new release.
 #            Do not change the values while still running the previous release.
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/a08fa8de1545_transfer_stats_table.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/a08fa8de1545_transfer_stats_table.py`

 * *Files 5% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -15,18 +14,18 @@
 
 ''' transfer_stats table '''
 
 import datetime
 
 import sqlalchemy as sa
 from alembic import context
-from alembic.op import (create_table, create_primary_key, create_foreign_key,
-                        create_index, create_check_constraint, drop_table)
+from alembic.op import create_check_constraint, create_foreign_key, create_index, create_primary_key, create_table, drop_table
 
 from rucio.db.sqla.types import GUID
+
 # Alembic revision identifiers
 revision = 'a08fa8de1545'
 down_revision = '4df2c5ddabc0'
 
 
 def upgrade():
     if context.get_context().dialect.name in ['oracle', 'mysql', 'postgresql']:
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/a118956323f8_added_vo_table_and_vo_col_to_rse.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/a118956323f8_added_vo_table_and_vo_col_to_rse.py`

 * *Files 6% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -15,16 +14,15 @@
 
 ''' Added vo table and vo col to rse '''
 
 import datetime
 
 import sqlalchemy as sa
 from alembic import context
-from alembic.op import (add_column, create_primary_key, create_table, create_unique_constraint,
-                        drop_column, drop_constraint, drop_table, bulk_insert)
+from alembic.op import add_column, bulk_insert, create_primary_key, create_table, create_unique_constraint, drop_column, drop_constraint, drop_table
 from sqlalchemy import String
 
 # Alembic revision identifiers
 revision = 'a118956323f8'
 down_revision = 'd1189a09c6e0'
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/a193a275255c_add_status_column_in_messages.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/a193a275255c_add_status_column_in_messages.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,15 +11,14 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 ''' Add status column in messages '''
 
 import sqlalchemy as sa
-
 from alembic import context
 from alembic.op import add_column, drop_column
 
 # Alembic revision identifiers
 revision = 'a193a275255c'
 down_revision = 'a118956323f8'
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/a5f6f6e928a7_1_7_0.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/a5f6f6e928a7_1_7_0.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,18 +11,16 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 ''' add columns for 1.7.0 release '''
 
 import sqlalchemy as sa
-
 from alembic import context
-from alembic.op import create_check_constraint, create_foreign_key, add_column, drop_column, drop_constraint
-
+from alembic.op import add_column, create_check_constraint, create_foreign_key, drop_column, drop_constraint
 
 # Alembic revision identifiers
 revision = 'a5f6f6e928a7'
 down_revision = '21d6b9dc9961'
 
 
 def upgrade():
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/a616581ee47_added_columns_to_table_requests.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/a616581ee47_added_columns_to_table_requests.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/a6eb23955c28_state_idx_non_functional.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/a6eb23955c28_state_idx_non_functional.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/a74275a1ad30_added_global_quota_table.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/a74275a1ad30_added_global_quota_table.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -15,16 +14,15 @@
 
 ''' added global acount limits table '''
 
 import datetime
 
 import sqlalchemy as sa
 from alembic import context
-from alembic.op import (create_primary_key, create_check_constraint,
-                        create_table, drop_table, create_foreign_key)
+from alembic.op import create_check_constraint, create_foreign_key, create_primary_key, create_table, drop_table
 
 # Alembic revision identifiers
 revision = 'a74275a1ad30'
 down_revision = '2b69addda658'
 
 table_name = 'account_glob_limits'
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/a93e4e47bda_heartbeats.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/a93e4e47bda_heartbeats.py`

 * *Files 3% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -15,17 +14,15 @@
 
 ''' added heartbeats '''
 
 import datetime
 
 import sqlalchemy as sa
 from alembic import context
-from alembic.op import (create_table, create_primary_key,
-                        create_check_constraint, create_index,
-                        drop_constraint, drop_table)
+from alembic.op import create_check_constraint, create_index, create_primary_key, create_table, drop_constraint, drop_table
 
 # Alembic revision identifiers
 revision = 'a93e4e47bda'
 down_revision = '2af3291ec4c'
 
 
 def upgrade():
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/ae2a56fcc89_added_comment_column_to_rules.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/40ad39ce3160_add_transferred_at_to_requests_table.py`

 * *Files 12% similar despite different names*

```diff
@@ -1,50 +1,43 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-''' added comment column to rules '''
+''' add_transferred_at_to_requests_table '''
 
 import sqlalchemy as sa
 from alembic import context
 from alembic.op import add_column, drop_column
 
-from rucio.db.sqla.models import String
-
 # Alembic revision identifiers
-revision = 'ae2a56fcc89'
-down_revision = '45378a1e76a8'
+revision = '40ad39ce3160'
+down_revision = '2ba5229cb54c'
 
 
 def upgrade():
     '''
     Upgrade the database to this revision
     '''
 
     if context.get_context().dialect.name in ['oracle', 'mysql', 'postgresql']:
         schema = context.get_context().version_table_schema if context.get_context().version_table_schema else ''
-        add_column('rules', sa.Column('comments', String(255)), schema=schema)
-        add_column('rules_hist_recent', sa.Column('comments', String(255)), schema=schema)
-        add_column('rules_history', sa.Column('comments', String(255)), schema=schema)
+        add_column('requests', sa.Column('transferred_at', sa.DateTime()), schema=schema)
 
 
 def downgrade():
     '''
     Downgrade the database to the previous revision
     '''
 
     if context.get_context().dialect.name in ['oracle', 'mysql', 'postgresql']:
         schema = context.get_context().version_table_schema if context.get_context().version_table_schema else ''
-        drop_column('rules', 'comments', schema=schema)
-        drop_column('rules_hist_recent', 'comments', schema=schema)
-        drop_column('rules_history', 'comments', schema=schema)
+        drop_column('requests', 'transferred_at', schema=schema)
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/b4293a99f344_added_column_identity_to_table_tokens.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/c129ccdb2d5_add_lumiblocknr_to_dids.py`

 * *Files 7% similar despite different names*

```diff
@@ -1,46 +1,43 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-''' added column identity to table tokens '''
+''' add lumiblocknr to dids '''
 
 import sqlalchemy as sa
-
 from alembic import context
 from alembic.op import add_column, drop_column
 
-
 # Alembic revision identifiers
-revision = 'b4293a99f344'
-down_revision = '3ac1660a1a72'
+revision = 'c129ccdb2d5'
+down_revision = '156fb5b5a14'
 
 
 def upgrade():
     '''
     Upgrade the database to this revision
     '''
 
     if context.get_context().dialect.name in ['oracle', 'mysql', 'postgresql']:
         schema = context.get_context().version_table_schema if context.get_context().version_table_schema else ''
-        add_column('tokens', sa.Column('identity', sa.String(255)), schema=schema)
+        add_column('dids', sa.Column('lumiblocknr', sa.Integer()), schema=schema)
 
 
 def downgrade():
     '''
     Downgrade the database to the previous revision
     '''
 
     if context.get_context().dialect.name in ['oracle', 'mysql', 'postgresql']:
         schema = context.get_context().version_table_schema if context.get_context().version_table_schema else ''
-        drop_column('tokens', 'identity', schema=schema)
+        drop_column('dids', 'lumiblocknr', schema=schema)
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/b7d287de34fd_removal_of_replicastate_source.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/b7d287de34fd_removal_of_replicastate_source.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,15 +11,15 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 ''' Removal of ReplicaState.SOURCE '''
 
 from alembic import context, op
-from alembic.op import (create_check_constraint)
+from alembic.op import create_check_constraint
 
 from rucio.db.sqla.util import try_drop_constraint
 
 # Alembic revision identifiers
 revision = 'b7d287de34fd'
 down_revision = 'f1b14a8c2ac1'
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/b818052fa670_add_index_to_quarantined_replicas.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/d6dceb1de2d_added_purge_column_to_rules.py`

 * *Files 21% similar despite different names*

```diff
@@ -1,42 +1,44 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-''' add index to quarantined replicas '''
+''' added purge column to rules '''
 
+import sqlalchemy as sa
 from alembic import context
-from alembic.op import (create_index, drop_index)
+from alembic.op import add_column, create_check_constraint, drop_column
 
-
-# revision identifiers, used by Alembic.
-revision = 'b818052fa670'
-down_revision = '2962ece31cf4'
+# Alembic revision identifiers
+revision = 'd6dceb1de2d'
+down_revision = '25821a8a45a3'
 
 
 def upgrade():
     '''
     Upgrade the database to this revision
     '''
 
     if context.get_context().dialect.name in ['oracle', 'mysql', 'postgresql']:
-        create_index('QUARANTINED_REPLICAS_PATH_IDX', 'quarantined_replicas', ['path', 'rse_id'], unique=True)
+        schema = context.get_context().version_table_schema if context.get_context().version_table_schema else ''
+        add_column('rules', sa.Column('purge_replicas', sa.Boolean(name='RULES_PURGE_REPLICAS_CHK', create_constraint=True), default=False), schema=schema)
+        create_check_constraint('RULES_PURGE_REPLICAS_NN', 'rules', "PURGE_REPLICAS IS NOT NULL")
 
 
 def downgrade():
     '''
     Downgrade the database to the previous revision
     '''
 
     if context.get_context().dialect.name in ['oracle', 'mysql', 'postgresql']:
-        drop_index('QUARANTINED_REPLICAS_PATH_IDX', 'quarantined_replicas')
+        schema = context.get_context().version_table_schema if context.get_context().version_table_schema else ''
+        drop_column('rules', 'purge_replicas', schema=schema)
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/b8caac94d7f0_add_comments_column_for_subscriptions_.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/b8caac94d7f0_add_comments_column_for_subscriptions_.py`

 * *Files 6% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,19 +11,17 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 ''' add comments column for subscriptions_history '''
 
 import sqlalchemy as sa
-
 from alembic import context
 from alembic.op import add_column, drop_column
 
-
 # Alembic revision identifiers
 revision = 'b8caac94d7f0'
 down_revision = '8523998e2e76'
 
 
 def upgrade():
     '''
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/b96a1c7e1cc4_new_bad_pfns_table_and_bad_replicas_.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/b96a1c7e1cc4_new_bad_pfns_table_and_bad_replicas_.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -15,18 +14,15 @@
 
 ''' new bad_pfns table and bad_replicas changes '''
 
 import datetime
 
 import sqlalchemy as sa
 from alembic import context, op
-from alembic.op import (create_primary_key, create_check_constraint,
-                        drop_constraint, create_table, create_foreign_key,
-                        add_column, create_index, drop_table, drop_column,
-                        drop_index)
+from alembic.op import add_column, create_check_constraint, create_foreign_key, create_index, create_primary_key, create_table, drop_column, drop_constraint, drop_index, drop_table
 
 from rucio.db.sqla.constants import BadPFNStatus
 from rucio.db.sqla.util import try_drop_constraint
 
 # Alembic revision identifiers
 revision = 'b96a1c7e1cc4'
 down_revision = '1f46c5f240ac'
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/bb695f45c04_extend_request_state.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/bb695f45c04_extend_request_state.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -13,16 +12,15 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 ''' extend request state '''
 
 import sqlalchemy as sa
 from alembic import context, op
-from alembic.op import (add_column, create_check_constraint,
-                        drop_constraint, drop_column)
+from alembic.op import add_column, create_check_constraint, drop_column, drop_constraint
 
 from rucio.db.sqla.util import try_drop_constraint
 
 # Alembic revision identifiers
 revision = 'bb695f45c04'
 down_revision = '3082b8cef557'
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/bc68e9946deb_add_staging_timestamps_to_request.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/bc68e9946deb_add_staging_timestamps_to_request.py`

 * *Files 3% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -13,19 +12,17 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 
 ''' add staging timestamps to request '''
 
 import sqlalchemy as sa
-
 from alembic import context
 from alembic.op import add_column, drop_column
 
-
 # Alembic revision identifiers
 revision = 'bc68e9946deb'
 down_revision = '9a1b149a2044'
 
 
 def upgrade():
     '''
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/bf3baa1c1474_correct_pk_and_idx_for_history_tables.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/bf3baa1c1474_correct_pk_and_idx_for_history_tables.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -13,16 +12,15 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 ''' correct PK and IDX for history tables '''
 
 import sqlalchemy as sa
 from alembic import context
-from alembic.op import (create_primary_key, drop_constraint,
-                        drop_index, drop_column, add_column)
+from alembic.op import add_column, create_primary_key, drop_column, drop_constraint, drop_index
 
 from rucio.db.sqla.types import GUID
 
 # Alembic revision identifiers
 revision = 'bf3baa1c1474'
 down_revision = '9eb936a81eb1'
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/c0937668555f_add_qos_policy_map_table.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/c0937668555f_add_qos_policy_map_table.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -15,15 +14,15 @@
 
 ''' add qos policy map table '''
 
 import datetime
 
 import sqlalchemy as sa
 from alembic import context
-from alembic.op import create_table, create_primary_key, create_foreign_key, drop_table, create_check_constraint
+from alembic.op import create_check_constraint, create_foreign_key, create_primary_key, create_table, drop_table
 
 from rucio.db.sqla.types import GUID
 
 # Alembic revision identifiers
 revision = 'c0937668555f'
 down_revision = 'a193a275255c'
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/c129ccdb2d5_add_lumiblocknr_to_dids.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/cebad904c4dd_new_payload_column_for_heartbeats.py`

 * *Files 11% similar despite different names*

```diff
@@ -1,46 +1,47 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-''' add lumiblocknr to dids '''
+''' New payload column for heartbeats '''
 
 import sqlalchemy as sa
-
 from alembic import context
-from alembic.op import add_column, drop_column
+from alembic.op import add_column, create_index, drop_column, drop_index
 
+from rucio.db.sqla.models import String
 
 # Alembic revision identifiers
-revision = 'c129ccdb2d5'
-down_revision = '156fb5b5a14'
+revision = 'cebad904c4dd'
+down_revision = 'b7d287de34fd'
 
 
 def upgrade():
     '''
     Upgrade the database to this revision
     '''
 
     if context.get_context().dialect.name in ['oracle', 'mysql', 'postgresql']:
         schema = context.get_context().version_table_schema if context.get_context().version_table_schema else ''
-        add_column('dids', sa.Column('lumiblocknr', sa.Integer()), schema=schema)
+        drop_index('HEARTBEATS_UPDATED_AT', 'heartbeats')
+        add_column('heartbeats', sa.Column('payload', String(3000)), schema=schema)
 
 
 def downgrade():
     '''
     Downgrade the database to the previous revision
     '''
 
     if context.get_context().dialect.name in ['oracle', 'mysql', 'postgresql']:
         schema = context.get_context().version_table_schema if context.get_context().version_table_schema else ''
-        drop_column('dids', 'lumiblocknr', schema=schema)
+        create_index('HEARTBEATS_UPDATED_AT', 'heartbeats', ['updated_at'])
+        drop_column('heartbeats', 'payload', schema=schema)
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/ccdbcd48206e_add_did_type_column_index_on_did_meta_.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/ccdbcd48206e_add_did_type_column_index_on_did_meta_.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -13,17 +12,15 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 ''' Add did_type column + index on did_meta table '''
 
 import sqlalchemy as sa
 from alembic.context import get_context
-from alembic.op import (add_column, drop_column,
-                        create_index, drop_index,
-                        execute)
+from alembic.op import add_column, create_index, drop_column, drop_index, execute
 
 from rucio.db.sqla.constants import DIDType
 from rucio.db.sqla.util import try_drop_constraint
 
 # Alembic revision identifiers
 revision = 'ccdbcd48206e'
 down_revision = '52153819589c'
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/cebad904c4dd_new_payload_column_for_heartbeats.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/fa7a7d78b602_increase_refresh_token_size.py`

 * *Files 16% similar despite different names*

```diff
@@ -1,48 +1,43 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-''' New payload column for heartbeats '''
+''' increase refresh token size '''
 
 import sqlalchemy as sa
 from alembic import context
-from alembic.op import add_column, drop_column, create_index, drop_index
-
-from rucio.db.sqla.models import String
+from alembic.op import alter_column
 
 # Alembic revision identifiers
-revision = 'cebad904c4dd'
-down_revision = 'b7d287de34fd'
+revision = 'fa7a7d78b602'
+down_revision = '1677d4d803c8'
 
 
 def upgrade():
     '''
     Upgrade the database to this revision
     '''
 
     if context.get_context().dialect.name in ['oracle', 'mysql', 'postgresql']:
         schema = context.get_context().version_table_schema if context.get_context().version_table_schema else ''
-        drop_index('HEARTBEATS_UPDATED_AT', 'heartbeats')
-        add_column('heartbeats', sa.Column('payload', String(3000)), schema=schema)
+        alter_column('tokens', 'refresh_token', existing_type=sa.String(315), type_=sa.String(3072), schema=schema)
 
 
 def downgrade():
     '''
     Downgrade the database to the previous revision
     '''
 
     if context.get_context().dialect.name in ['oracle', 'mysql', 'postgresql']:
         schema = context.get_context().version_table_schema if context.get_context().version_table_schema else ''
-        create_index('HEARTBEATS_UPDATED_AT', 'heartbeats', ['updated_at'])
-        drop_column('heartbeats', 'payload', schema=schema)
+        alter_column('tokens', 'refresh_token', existing_type=sa.String(3072), type_=sa.String(315), schema=schema)
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/d1189a09c6e0_oauth2_0_and_jwt_feature_support_adding_.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/d1189a09c6e0_oauth2_0_and_jwt_feature_support_adding_.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -15,17 +14,15 @@
 
 ''' OAuth2.0 and JWT feature support; adding table oauth_requests & several columns to tokens table '''
 
 import datetime
 
 import sqlalchemy as sa
 from alembic import context
-from alembic.op import (add_column, alter_column, drop_column,
-                        create_table, create_primary_key, create_index,
-                        create_check_constraint, drop_table, execute)
+from alembic.op import add_column, alter_column, create_check_constraint, create_index, create_primary_key, create_table, drop_column, drop_table, execute
 
 from rucio.db.sqla.types import InternalAccountString
 from rucio.db.sqla.util import try_drop_constraint
 
 # Alembic revision identifiers
 revision = 'd1189a09c6e0'
 down_revision = '810a41685bc1'
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/d23453595260_extend_request_state_for_preparer.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/d23453595260_extend_request_state_for_preparer.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -13,16 +12,15 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 """
 Add PREPARING state to Request model.
 """
 
-from alembic import context
-from alembic import op
+from alembic import context, op
 
 from rucio.db.sqla.util import try_drop_constraint
 
 # Alembic revision identifiers
 revision = 'd23453595260'
 down_revision = '8ea9122275b1'
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/d6dceb1de2d_added_purge_column_to_rules.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/269fee20dee9_add_repair_cnt_to_locks.py`

 * *Files 8% similar despite different names*

```diff
@@ -1,47 +1,43 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-''' added purge column to rules '''
+''' add repair_cnt to locks '''
 
 import sqlalchemy as sa
-
 from alembic import context
-from alembic.op import add_column, drop_column, create_check_constraint
-
+from alembic.op import add_column, drop_column
 
 # Alembic revision identifiers
-revision = 'd6dceb1de2d'
-down_revision = '25821a8a45a3'
+revision = '269fee20dee9'
+down_revision = '1d96f484df21'
 
 
 def upgrade():
     '''
     Upgrade the database to this revision
     '''
 
     if context.get_context().dialect.name in ['oracle', 'mysql', 'postgresql']:
         schema = context.get_context().version_table_schema if context.get_context().version_table_schema else ''
-        add_column('rules', sa.Column('purge_replicas', sa.Boolean(name='RULES_PURGE_REPLICAS_CHK', create_constraint=True), default=False), schema=schema)
-        create_check_constraint('RULES_PURGE_REPLICAS_NN', 'rules', "PURGE_REPLICAS IS NOT NULL")
+        add_column('locks', sa.Column('repair_cnt', sa.BigInteger()), schema=schema)
 
 
 def downgrade():
     '''
     Downgrade the database to the previous revision
     '''
 
     if context.get_context().dialect.name in ['oracle', 'mysql', 'postgresql']:
         schema = context.get_context().version_table_schema if context.get_context().version_table_schema else ''
-        drop_column('rules', 'purge_replicas', schema=schema)
+        drop_column('locks', 'repair_cnt', schema=schema)
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/d6e2c3b2cf26_remove_third_party_copy_column_from_rse.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/d6e2c3b2cf26_remove_third_party_copy_column_from_rse.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,15 +11,14 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 ''' remove third_party_copy column from rse '''
 
 import sqlalchemy as sa
-
 from alembic import context
 from alembic.op import add_column, drop_column
 
 # Alembic revision identifiers
 revision = 'd6e2c3b2cf26'
 down_revision = 'fa7a7d78b602'
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/d91002c5841_new_account_limits_table.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/d91002c5841_new_account_limits_table.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -15,16 +14,15 @@
 
 ''' new account_limits table '''
 
 import datetime
 
 import sqlalchemy as sa
 from alembic import context
-from alembic.op import (create_check_constraint, create_table, create_primary_key,
-                        create_foreign_key, drop_table)
+from alembic.op import create_check_constraint, create_foreign_key, create_primary_key, create_table, drop_table
 
 from rucio.db.sqla.types import GUID
 
 # Alembic revision identifiers
 revision = 'd91002c5841'
 down_revision = '469d262be19'
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/e138c364ebd0_extending_columns_for_filter_and_.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/e138c364ebd0_extending_columns_for_filter_and_.py`

 * *Files 8% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,19 +11,17 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 ''' Extending columns for filter and replication_rules in subscriptions '''
 
 import sqlalchemy as sa
-
 from alembic import context
 from alembic.op import alter_column
 
-
 # Alembic revision identifiers
 revision = 'e138c364ebd0'
 down_revision = 'f85a2962b021'
 
 
 def upgrade():
     '''
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/e59300c8b179_support_for_archive.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/e59300c8b179_support_for_archive.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -15,16 +14,15 @@
 
 ''' support for archive '''
 
 import datetime
 
 import sqlalchemy as sa
 from alembic import context
-from alembic.op import (create_table, create_primary_key, create_foreign_key, add_column,
-                        create_index, drop_column, drop_table)
+from alembic.op import add_column, create_foreign_key, create_index, create_primary_key, create_table, drop_column, drop_table
 
 from rucio.db.sqla.models import String
 from rucio.db.sqla.types import GUID
 
 # Alembic revision identifiers
 revision = 'e59300c8b179'
 down_revision = '6e572a9bfbf3'
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/f1b14a8c2ac1_postgres_use_check_constraints.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/f1b14a8c2ac1_postgres_use_check_constraints.py`

 * *Files 14% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/f41ffe206f37_oracle_global_temporary_tables.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/f41ffe206f37_oracle_global_temporary_tables.py`

 * *Files 6% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -16,15 +15,15 @@
 ''' oracle_global_temporary_tables '''
 
 import sqlalchemy as sa
 from alembic import context
 from alembic.op import create_table, drop_table
 
 from rucio.common.schema import get_schema_value
-from rucio.db.sqla.types import InternalScopeString, String, GUID
+from rucio.db.sqla.types import GUID, InternalScopeString, String
 
 # Alembic revision identifiers
 revision = 'f41ffe206f37'
 down_revision = 'd6e2c3b2cf26'
 
 
 def upgrade():
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/f85a2962b021_adding_transfertool_column_to_requests_.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/f85a2962b021_adding_transfertool_column_to_requests_.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,17 +11,16 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 ''' adding transfertool column and index to requests table'''
 
 import sqlalchemy as sa
-
 from alembic import context
-from alembic.op import add_column, drop_column, create_index, drop_index
+from alembic.op import add_column, create_index, drop_column, drop_index
 
 # Alembic revision identifiers
 revision = 'f85a2962b021'
 down_revision = 'd23453595260'
 
 
 def upgrade():
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/fa7a7d78b602_increase_refresh_token_size.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/fe8ea2fa9788_added_third_party_copy_column_to_rse_.py`

 * *Files 10% similar despite different names*

```diff
@@ -1,45 +1,43 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-''' increase refresh token size '''
+''' add third_party_copy column to rse_protocols '''
 
 import sqlalchemy as sa
-
 from alembic import context
-from alembic.op import alter_column
+from alembic.op import add_column, drop_column
 
 # Alembic revision identifiers
-revision = 'fa7a7d78b602'
-down_revision = '1677d4d803c8'
+revision = 'fe8ea2fa9788'
+down_revision = '0437a40dbfd1'
 
 
 def upgrade():
     '''
     Upgrade the database to this revision
     '''
 
     if context.get_context().dialect.name in ['oracle', 'mysql', 'postgresql']:
         schema = context.get_context().version_table_schema if context.get_context().version_table_schema else ''
-        alter_column('tokens', 'refresh_token', existing_type=sa.String(315), type_=sa.String(3072), schema=schema)
+        add_column('rse_protocols', sa.Column('third_party_copy', sa.Integer, server_default='0'), schema=schema)
 
 
 def downgrade():
     '''
     Downgrade the database to the previous revision
     '''
 
     if context.get_context().dialect.name in ['oracle', 'mysql', 'postgresql']:
         schema = context.get_context().version_table_schema if context.get_context().version_table_schema else ''
-        alter_column('tokens', 'refresh_token', existing_type=sa.String(3072), type_=sa.String(315), schema=schema)
+        drop_column('rse_protocols', 'third_party_copy', schema=schema)
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/fb28a95fe288_add_replicas_rse_id_tombstone_idx.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/fb28a95fe288_add_replicas_rse_id_tombstone_idx.py`

 * *Files 10% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/migrate_repo/versions/fe1a65b176c9_set_third_party_copy_read_and_write_.py` & `rucio-34.1.0/lib/rucio/db/sqla/migrate_repo/versions/fe1a65b176c9_set_third_party_copy_read_and_write_.py`

 * *Files 8% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,15 +11,15 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 ''' set third_party_copy_read and write fields '''
 
 from alembic import context
-from alembic.op import execute, alter_column  # pylint: disable=no-member
+from alembic.op import alter_column, execute  # pylint: disable=no-member
 
 # Alembic revision identifiers
 revision = 'fe1a65b176c9'
 down_revision = '0f1adb7a599a'
 
 
 def upgrade():
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/models.py` & `rucio-34.1.0/lib/rucio/db/sqla/models.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -13,36 +12,51 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import uuid
 from datetime import datetime, timedelta
 from typing import Any, Optional, Union
 
-from sqlalchemy import BigInteger, Boolean, DateTime, Enum, Float, Integer, SmallInteger, String, Text, event, UniqueConstraint
+from sqlalchemy import BigInteger, Boolean, DateTime, Enum, Float, Integer, SmallInteger, String, Text, UniqueConstraint, event
 from sqlalchemy.engine import Engine
 from sqlalchemy.ext.compiler import compiles
 from sqlalchemy.ext.declarative import declared_attr
-from sqlalchemy.orm import mapped_column, object_mapper, relationship, Mapped
-from sqlalchemy.schema import Index, ForeignKeyConstraint, PrimaryKeyConstraint, CheckConstraint, Table
+from sqlalchemy.orm import Mapped, mapped_column, object_mapper, relationship
+from sqlalchemy.schema import CheckConstraint, ForeignKeyConstraint, Index, PrimaryKeyConstraint, Table
 from sqlalchemy.sql import Delete
 from sqlalchemy.types import LargeBinary
 
 from rucio.common import utils
 from rucio.common.schema import get_schema_value
 from rucio.common.types import InternalAccount, InternalScope
-from rucio.db.sqla.constants import (AccountStatus, AccountType, DIDAvailability, DIDType, DIDReEvaluation,
-                                     KeyType, IdentityType, LockState, RuleGrouping, BadFilesStatus,
-                                     RuleState, ReplicaState, RequestState, RequestType, RSEType,
-                                     ScopeStatus, SubscriptionState, RuleNotification, LifetimeExceptionsState,
-                                     BadPFNStatus, TransferLimitDirection)
+from rucio.db.sqla.constants import (
+    AccountStatus,
+    AccountType,
+    BadFilesStatus,
+    BadPFNStatus,
+    DIDAvailability,
+    DIDReEvaluation,
+    DIDType,
+    IdentityType,
+    KeyType,
+    LifetimeExceptionsState,
+    LockState,
+    ReplicaState,
+    RequestState,
+    RequestType,
+    RSEType,
+    RuleGrouping,
+    RuleNotification,
+    RuleState,
+    ScopeStatus,
+    SubscriptionState,
+    TransferLimitDirection,
+)
 from rucio.db.sqla.session import BASE
-from rucio.db.sqla.types import GUID, BooleanString, JSON
-from rucio.db.sqla.types import InternalAccountString
-from rucio.db.sqla.types import InternalScopeString
-
+from rucio.db.sqla.types import GUID, JSON, BooleanString, InternalAccountString, InternalScopeString
 
 # SQLAlchemy defines the corresponding code behind TYPE_CHECKING
 # https://github.com/sqlalchemy/sqlalchemy/blob/d9acd6223299c118464d30abfa483e26a536239d/lib/sqlalchemy/orm/base.py#L814
 # And pylint/astroid don't have an option to evaluate this code
 # https://github.com/pylint-dev/astroid/issues/1332
 # So we get this error all over the place: `E1136: Value 'Mapped' is unsubscriptable (unsubscriptable-object)`
 #
@@ -164,15 +178,15 @@
         const.name = "REQUESTS_HISTORY_DIDTYPE_CHK"
     elif const.name == 'REQUESTS_DIDTYPE_CHK' and table.name.upper() == 'REQUESTS_HISTORY':
         const.name = "REQUESTS_HISTORY_DIDTYPE_CHK"
     elif const.name == 'REQUESTS_STATE_CHK' and table.name.upper() == 'REQUESTS_HISTORY':
         const.name = "REQUESTS_HISTORY_STATE_CHK"
 
 
-class ModelBase(object):
+class ModelBase:
     """Base class for Rucio Models"""
     __table_initialized__ = False
 
     @declared_attr
     def __table_args__(cls):  # pylint: disable=no-self-argument
         # exception for CERN Oracle identifier length limitations
         # pylint: disable=maybe-no-member
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/sautils.py` & `rucio-34.1.0/lib/rucio/db/sqla/sautils.py`

 * *Files 6% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -15,15 +14,15 @@
 
 '''
 SQLAlchemy utilities
 
 '''
 
 from sqlalchemy.ext.compiler import compiles
-from sqlalchemy.sql.expression import Executable, ClauseElement
+from sqlalchemy.sql.expression import ClauseElement, Executable
 
 
 class InsertFromSelect(Executable, ClauseElement):
     def __init__(self, insert_spec, select):
         self.insert_spec = insert_spec
         self.select = select
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/session.py` & `rucio-34.1.0/lib/rucio/db/sqla/session.py`

 * *Files 3% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -15,27 +14,27 @@
 
 import copy
 import logging
 import os
 import sys
 from datetime import datetime, timedelta
 from functools import update_wrapper
-from inspect import isgeneratorfunction, getfullargspec
+from inspect import getfullargspec, isgeneratorfunction
 from os.path import basename
-from time import sleep
 from threading import Lock
+from time import sleep
 from typing import TYPE_CHECKING
 
-from sqlalchemy import create_engine, event, MetaData, text
-from sqlalchemy.exc import DatabaseError, DisconnectionError, OperationalError, TimeoutError, SQLAlchemyError
-from sqlalchemy.orm import DeclarativeBase, sessionmaker, scoped_session, Session
-from sqlalchemy.pool import QueuePool, SingletonThreadPool, NullPool
+from sqlalchemy import MetaData, create_engine, event, text
+from sqlalchemy.exc import DatabaseError, DisconnectionError, OperationalError, SQLAlchemyError, TimeoutError
+from sqlalchemy.orm import DeclarativeBase, Session, scoped_session, sessionmaker
+from sqlalchemy.pool import NullPool, QueuePool, SingletonThreadPool
 
 from rucio.common.config import config_get
-from rucio.common.exception import RucioException, DatabaseException, InputValidationError
+from rucio.common.exception import DatabaseException, InputValidationError, RucioException
 from rucio.common.extra import import_extras
 from rucio.common.utils import retrying
 
 EXTRA_MODULES = import_extras(['MySQLdb', 'pymysql'])
 
 if TYPE_CHECKING:
     from collections.abc import Callable
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/types.py` & `rucio-34.1.0/lib/rucio/db/sqla/types.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -13,18 +12,18 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import uuid
 
 import sqlalchemy.types as types
 from sqlalchemy.dialects.mysql import BINARY
-from sqlalchemy.dialects.oracle import RAW, CLOB
-from sqlalchemy.dialects.postgresql import UUID, JSONB
+from sqlalchemy.dialects.oracle import CLOB, RAW
+from sqlalchemy.dialects.postgresql import JSONB, UUID
 from sqlalchemy.sql import operators
-from sqlalchemy.types import TypeDecorator, CHAR, String
+from sqlalchemy.types import CHAR, String, TypeDecorator
 
 from rucio.common.exception import InvalidType
 from rucio.common.types import InternalAccount, InternalScope
 
 
 class GUID(TypeDecorator):
     """
```

### Comparing `rucio-34.0.0rc2/lib/rucio/db/sqla/util.py` & `rucio-34.1.0/lib/rucio/db/sqla/util.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -19,37 +18,38 @@
 from os import urandom
 from typing import TYPE_CHECKING
 
 import sqlalchemy
 from alembic import command, op
 from alembic.config import Config
 from dogpile.cache.api import NoValue
-from sqlalchemy import func, inspect, Column, PrimaryKeyConstraint
+from sqlalchemy import Column, PrimaryKeyConstraint, func, inspect
 from sqlalchemy.dialects.postgresql.base import PGInspector
-from sqlalchemy.exc import IntegrityError, DatabaseError
+from sqlalchemy.exc import DatabaseError, IntegrityError
 from sqlalchemy.orm import declarative_base
-from sqlalchemy.schema import CreateSchema, MetaData, Table, CreateTable, DropTable, ForeignKeyConstraint, DropConstraint
+from sqlalchemy.schema import CreateSchema, CreateTable, DropConstraint, DropTable, ForeignKeyConstraint, MetaData, Table
 from sqlalchemy.sql.ddl import DropSchema
 from sqlalchemy.sql.expression import select, text
 
 from rucio import alembicrevision
 from rucio.common.cache import make_region_memcached
 from rucio.common.config import config_get, config_get_list
 from rucio.common.schema import get_schema_value
 from rucio.common.types import InternalAccount
 from rucio.common.utils import generate_uuid
 from rucio.db.sqla import models
 from rucio.db.sqla.constants import AccountStatus, AccountType, IdentityType
-from rucio.db.sqla.session import get_engine, get_session, get_dump_engine
+from rucio.db.sqla.session import get_dump_engine, get_engine, get_session
 from rucio.db.sqla.types import InternalScopeString, String
 
 if TYPE_CHECKING:
     from typing import Optional, Union  # noqa: F401
-    from sqlalchemy.orm import Session  # noqa: F401
+
     from sqlalchemy.engine import Inspector  # noqa: F401
+    from sqlalchemy.orm import Session  # noqa: F401
 
 REGION = make_region_memcached(expiration_time=600, memcached_expire_time=3660)
 
 
 def build_database():
     """ Applies the schema to the database. Run this command once to build the database. """
     engine = get_engine()
```

### Comparing `rucio-34.0.0rc2/lib/rucio/rse/__init__.py` & `rucio-34.1.0/lib/rucio/rse/__init__.py`

 * *Files 6% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -43,16 +42,16 @@
     return CredentialClient(vo=vo).get_signed_url(rse, service, op, url)
 
 
 def get_signed_url_server(rse, service, op, url, vo='def'):
     '''
     get_signed_url_server
     '''
-    from rucio.core.rse import get_rse_id
     from rucio.core.credential import get_signed_url
+    from rucio.core.rse import get_rse_id
 
     rse_id = get_rse_id(rse=rse, vo=vo)
     return get_signed_url(rse_id, service, op, url)
 
 
 def rse_key_generator(namespace, fn, **kwargs):
     '''
@@ -74,17 +73,17 @@
     RSE_REGION = make_region(function_key_generator=rse_key_generator).configure(
         'dogpile.cache.memory',
         expiration_time=900)
     setattr(rsemanager, 'RSE_REGION', RSE_REGION)
 
 
 if rsemanager.SERVER_MODE:   # pylint:disable=no-member
-    from rucio.core.rse import get_rse_protocols, get_rse_id
-    from rucio.core.vo import map_vo
     from rucio.common.cache import make_region_memcached
+    from rucio.core.rse import get_rse_id, get_rse_protocols
+    from rucio.core.vo import map_vo
 
     def tmp_rse_info(rse=None, vo='def', rse_id=None, session=None):
         if rse_id is None:
             # This can be called directly by client tools if they're co-located on a server
             # i.e. running rucio cli on a server and during the test suite.
             # We have to map to VO name here for this situations, despite this nominally
             # not being a client interface.
```

### Comparing `rucio-34.0.0rc2/lib/rucio/rse/protocols/__init__.py` & `rucio-34.1.0/lib/rucio/rse/protocols/__init__.py`

 * *Files 9% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/rse/protocols/bittorrent.py` & `rucio-34.1.0/lib/rucio/rse/protocols/bittorrent.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -13,22 +12,21 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import base64
 import logging
 import os.path
 import time
-from urllib.parse import urlparse, urlencode, parse_qs
+from urllib.parse import parse_qs, urlencode, urlparse
 
 from rucio.common import exception
+from rucio.common.extra import import_extras
 from rucio.common.utils import construct_torrent, resolve_ip
-from rucio.rse.protocols.protocol import RSEProtocol
 from rucio.rse import rsemanager
-
-from rucio.common.extra import import_extras
+from rucio.rse.protocols.protocol import RSEProtocol
 
 EXTRA_MODULES = import_extras(['libtorrent'])
 
 lt = None
 if EXTRA_MODULES['libtorrent']:
     import libtorrent as lt  # pylint: disable=E0401
```

### Comparing `rucio-34.0.0rc2/lib/rucio/rse/protocols/cache.py` & `rucio-34.1.0/lib/rucio/rse/protocols/cache.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/rse/protocols/dummy.py` & `rucio-34.1.0/lib/rucio/rse/protocols/dummy.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/rse/protocols/gfal.py` & `rucio-34.1.0/lib/rucio/rse/protocols/gfal.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -18,15 +17,15 @@
 import logging
 import os
 import re
 import subprocess
 import urllib.parse as urlparse
 from threading import Timer
 
-from rucio.common import exception, config
+from rucio.common import config, exception
 from rucio.common.constraints import STRING_TYPES
 from rucio.common.utils import GLOBALLY_SUPPORTED_CHECKSUMS, PREFERRED_CHECKSUM
 from rucio.rse.protocols import protocol
 
 try:
     import gfal2  # pylint: disable=import-error
 except:
```

### Comparing `rucio-34.0.0rc2/lib/rucio/rse/protocols/globus.py` & `rucio-34.1.0/lib/rucio/rse/protocols/globus.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -16,15 +15,15 @@
 import logging
 from urllib.parse import urlparse
 
 from rucio.common import exception
 from rucio.common.extra import import_extras
 from rucio.core.rse import get_rse_attribute
 from rucio.rse.protocols.protocol import RSEProtocol
-from rucio.transfertool.globus_library import get_transfer_client, send_delete_task, send_bulk_delete_task
+from rucio.transfertool.globus_library import get_transfer_client, send_bulk_delete_task, send_delete_task
 
 EXTRA_MODULES = import_extras(['globus_sdk'])
 
 if EXTRA_MODULES['globus_sdk']:
     from globus_sdk import TransferAPIError  # pylint: disable=import-error
```

### Comparing `rucio-34.0.0rc2/lib/rucio/rse/protocols/gsiftp.py` & `rucio-34.1.0/lib/rucio/rse/protocols/gsiftp.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/rse/protocols/http_cache.py` & `rucio-34.1.0/lib/rucio/rse/protocols/http_cache.py`

 * *Files 12% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/rse/protocols/mock.py` & `rucio-34.1.0/lib/rucio/rse/protocols/mock.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/rse/protocols/ngarc.py` & `rucio-34.1.0/lib/rucio/rse/protocols/ngarc.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/rse/protocols/posix.py` & `rucio-34.1.0/lib/rucio/rse/protocols/posix.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -67,20 +66,20 @@
 
             :raises DestinationNotAccessible: if the destination storage was not accessible.
             :raises ServiceUnavailable: if some generic error occured in the library.
             :raises SourceNotFound: if the source file was not found on the referred storage.
          """
         try:
             shutil.copy(self.pfn2path(pfn), dest)
-        except IOError as e:
+        except OSError as e:
             try:  # To check if the error happend local or remote
                 with open(dest, 'wb'):
                     pass
                 call(['rm', '-rf', dest])
-            except IOError as e:
+            except OSError as e:
                 if e.errno == 2:
                     raise exception.DestinationNotAccessible(e)
                 else:
                     raise exception.ServiceUnavailable(e)
             if e.errno == 2:
                 raise exception.SourceNotFound(e)
             else:
@@ -106,15 +105,15 @@
         else:
             sf = source
         try:
             dirs = os.path.dirname(target)
             if not os.path.exists(dirs):
                 os.makedirs(dirs)
             shutil.copy(sf, target)
-        except IOError as e:
+        except OSError as e:
             if e.errno == 2:
                 raise exception.SourceNotFound(e)
             elif not self.exists(self.rse['prefix']):
                 path = ''
                 for p in self.rse['prefix'].split('/'):
                     path += p + '/'
                     os.mkdir(path)
@@ -148,15 +147,15 @@
         """
         path = self.pfn2path(pfn)
         new_path = self.pfn2path(new_pfn)
         try:
             if not os.path.exists(os.path.dirname(new_path)):
                 os.makedirs(os.path.dirname(new_path))
             os.rename(path, new_path)
-        except IOError as e:
+        except OSError as e:
             if e.errno == 2:
                 if self.exists(self.pfn2path(path)):
                     raise exception.SourceNotFound(e)
                 else:
                     raise exception.DestinationNotAccessible(e)
             else:
                 raise exception.ServiceUnavailable(e)
```

### Comparing `rucio-34.0.0rc2/lib/rucio/rse/protocols/protocol.py` & `rucio-34.1.0/lib/rucio/rse/protocols/protocol.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -17,16 +16,16 @@
 This module defines the base class for implementing a transfer protocol,
 along with some of the default methods for LFN2PFN translations.
 """
 
 import hashlib
 import logging
 from configparser import NoOptionError, NoSectionError
-from urllib.parse import urlparse
 from typing import TypeVar
+from urllib.parse import urlparse
 
 from rucio.common import config, exception
 from rucio.common.plugins import PolicyPackageAlgorithms
 from rucio.rse import rsemanager
 
 if getattr(rsemanager, 'CLIENT_MODE', None):
     from rucio.client.rseclient import RSEClient
@@ -258,15 +257,15 @@
         algorithm_callable = super()._get_one_algorithm(RSEDeterministicTranslation._algorithm_type, algorithm)
         return algorithm_callable(scope, name, self.rse, self.rse_attributes, self.protocol_attributes)
 
 
 RSEDeterministicTranslation._module_init_()  # pylint: disable=protected-access
 
 
-class RSEProtocol(object):
+class RSEProtocol:
     """ This class is virtual and acts as a base to inherit new protocols from. It further provides some common functionality which applies for the amjority of the protocols."""
 
     def __init__(self, protocol_attr, rse_settings, logger=logging.log):
         """ Initializes the object with information about the referred RSE.
 
             :param protocol_attr:  Properties of the requested protocol.
             :param rse_settting:   The RSE settings.
```

### Comparing `rucio-34.0.0rc2/lib/rucio/rse/protocols/rclone.py` & `rucio-34.1.0/lib/rucio/rse/protocols/rclone.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -15,15 +14,15 @@
 
 import json
 import logging
 import os
 
 from rucio.common import exception
 from rucio.common.config import get_config_dirs
-from rucio.common.utils import execute, PREFERRED_CHECKSUM
+from rucio.common.utils import PREFERRED_CHECKSUM, execute
 from rucio.rse.protocols import protocol
 
 
 def load_conf_file(file_name):
     config_dir = next(filter(lambda d: os.path.exists(os.path.join(d, file_name)), get_config_dirs()))
     with open(os.path.join(config_dir, file_name)) as f:
         return json.load(f)
```

### Comparing `rucio-34.0.0rc2/lib/rucio/rse/protocols/rfio.py` & `rucio-34.1.0/lib/rucio/rse/protocols/rfio.py`

 * *Files 5% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/rse/protocols/srm.py` & `rucio-34.1.0/lib/rucio/rse/protocols/srm.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/rse/protocols/ssh.py` & `rucio-34.1.0/lib/rucio/rse/protocols/ssh.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -14,15 +13,15 @@
 # limitations under the License.
 
 import logging
 import os
 import re
 
 from rucio.common import exception
-from rucio.common.utils import execute, PREFERRED_CHECKSUM
+from rucio.common.utils import PREFERRED_CHECKSUM, execute
 from rucio.rse.protocols import protocol
 
 
 class Default(protocol.RSEProtocol):
     """ Implementing access to RSEs using the SSH protocol."""
 
     def __init__(self, protocol_attr, rse_settings, logger=logging.log):
```

### Comparing `rucio-34.0.0rc2/lib/rucio/rse/protocols/storm.py` & `rucio-34.1.0/lib/rucio/rse/protocols/storm.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/rse/protocols/webdav.py` & `rucio-34.1.0/lib/rucio/rse/protocols/webdav.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,19 +11,19 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import os
 import sys
 import xml.etree.ElementTree as ET
+from dataclasses import dataclass
 from typing import Optional
 from urllib.parse import urlparse
 
 import requests
-from dataclasses import dataclass
 from requests.adapters import HTTPAdapter
 from urllib3.poolmanager import PoolManager
 
 from rucio.common import exception
 from rucio.rse.protocols import protocol
 
 
@@ -36,15 +35,15 @@
         self.poolmanager = PoolManager(num_pools=connections,
                                        maxsize=maxsize,
                                        block=block,
                                        cert_reqs="CERT_REQUIRED",
                                        ca_cert_dir="/etc/grid-security/certificates")
 
 
-class UploadInChunks(object):
+class UploadInChunks:
     '''
     Class to upload by chunks.
     '''
 
     def __init__(self, filename, chunksize, progressbar=False):
         self.__totalsize = os.path.getsize(filename)
         self.__readsofar = 0
@@ -69,15 +68,15 @@
         except OSError as error:
             raise exception.SourceNotFound(error)
 
     def __len__(self):
         return self.__totalsize
 
 
-class IterableToFileAdapter(object):
+class IterableToFileAdapter:
     '''
     Class IterableToFileAdapter
     '''
     def __init__(self, iterable):
         self.iterator = iter(iterable)
         self.length = len(iterable)
 
@@ -328,21 +327,21 @@
                     elif result.status_code in [401, ]:
                         raise exception.RSEAccessDenied()
                     else:
                         # catchall exception
                         raise exception.RucioException(result.status_code, result.text)
                 except requests.exceptions.ConnectionError as error:
                     raise exception.ServiceUnavailable(error)
-                except IOError as error:
+                except OSError as error:
                     raise exception.SourceNotFound(error)
         except requests.exceptions.ConnectionError as error:
             raise exception.ServiceUnavailable(error)
         except requests.exceptions.ReadTimeout as error:
             raise exception.ServiceUnavailable(error)
-        except IOError as error:
+        except OSError as error:
             raise exception.SourceNotFound(error)
 
     def rename(self, pfn, new_pfn):
         """ Allows to rename a file stored inside the connected RSE.
 
             :param pfn:      Current physical file name
             :param new_pfn  New physical file name
```

### Comparing `rucio-34.0.0rc2/lib/rucio/rse/protocols/xrootd.py` & `rucio-34.1.0/lib/rucio/rse/protocols/xrootd.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -13,15 +12,15 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import logging
 import os
 
 from rucio.common import exception
-from rucio.common.utils import execute, PREFERRED_CHECKSUM
+from rucio.common.utils import PREFERRED_CHECKSUM, execute
 from rucio.rse.protocols import protocol
 
 
 class Default(protocol.RSEProtocol):
     """ Implementing access to RSEs using the XRootD protocol using GSI authentication."""
 
     @property
```

### Comparing `rucio-34.0.0rc2/lib/rucio/rse/rsemanager.py` & `rucio-34.1.0/lib/rucio/rse/rsemanager.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -15,20 +14,19 @@
 
 import copy
 import logging
 import random
 from time import sleep
 from urllib.parse import urlparse
 
-from rucio.common import exception, utils, constants
-from rucio.common import types
+from rucio.common import constants, exception, types, utils
 from rucio.common.config import config_get_int
 from rucio.common.constraints import STRING_TYPES
 from rucio.common.logging import formatted_logger
-from rucio.common.utils import make_valid_did, GLOBALLY_SUPPORTED_CHECKSUMS
+from rucio.common.utils import GLOBALLY_SUPPORTED_CHECKSUMS, make_valid_did
 
 
 def get_rse_info(rse=None, vo='def', rse_id=None, session=None) -> types.RSESettingsDict:
     """
         Returns all protocol related RSE attributes.
         Call with either rse and vo, or (in server mode) rse_id
```

### Comparing `rucio-34.0.0rc2/lib/rucio/tests/__init__.py` & `rucio-34.1.0/lib/rucio/tests/__init__.py`

 * *Files 9% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/tests/common.py` & `rucio-34.1.0/lib/rucio/tests/common.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -16,22 +15,23 @@
 import contextlib
 import itertools
 import json
 import os
 import tempfile
 from collections import namedtuple
 from random import choice, choices
-from string import ascii_uppercase, ascii_letters, digits
+from string import ascii_letters, ascii_uppercase, digits
 from typing import Optional
 
 import pytest
 import requests
 
 from rucio.common.config import config_get, config_get_bool, get_config_dirs
-from rucio.common.utils import generate_uuid as uuid, execute
+from rucio.common.utils import execute
+from rucio.common.utils import generate_uuid as uuid
 
 skip_rse_tests_with_accounts = pytest.mark.skipif(not any(os.path.exists(os.path.join(d, 'rse-accounts.cfg')) for d in get_config_dirs()),
                                                   reason='fails if no rse-accounts.cfg found')
 skiplimitedsql = pytest.mark.skipif('RDBMS' in os.environ and os.environ['RDBMS'] == 'sqlite',
                                     reason="does not work in SQLite because of missing features")
 skip_multivo = pytest.mark.skipif('SUITE' in os.environ and os.environ['SUITE'] == 'multi_vo',
                                   reason="does not work for multiVO")
```

### Comparing `rucio-34.0.0rc2/lib/rucio/tests/common_server.py` & `rucio-34.1.0/lib/rucio/tests/common_server.py`

 * *Files 5% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -16,15 +15,16 @@
 
 from sqlalchemy import and_, delete, exists, select
 from sqlalchemy.orm import aliased
 
 from rucio.core import config as core_config
 from rucio.core.vo import map_vo
 from rucio.db.sqla import models
-from rucio.db.sqla.session import transactional_session, get_session
+from rucio.db.sqla.session import get_session, transactional_session
+
 from .common import get_long_vo
 
 # Functions containing server-only includes that can't be included in client tests
 # For each table, get the foreign key constraints from all other tables towards this table.
 INBOUND_FOREIGN_KEYS = {}
 for __table in models.BASE.metadata.tables.values():
     for __fk in __table.foreign_key_constraints:
```

### Comparing `rucio-34.0.0rc2/lib/rucio/transfertool/__init__.py` & `rucio-34.1.0/lib/rucio/transfertool/__init__.py`

 * *Files 9% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/transfertool/bittorrent.py` & `rucio-34.1.0/lib/rucio/transfertool/bittorrent.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -20,15 +19,16 @@
 from typing import TYPE_CHECKING, Any, Mapping, Optional, Type
 
 from rucio.common import types
 from rucio.common.config import config_get
 from rucio.common.extra import import_extras
 from rucio.common.utils import construct_torrent
 from rucio.core.did_meta_plugins import get_metadata
-from rucio.transfertool.transfertool import Transfertool, TransferToolBuilder, TransferStatusReport
+from rucio.transfertool.transfertool import TransferStatusReport, Transfertool, TransferToolBuilder
+
 from .bittorrent_driver import BittorrentDriver
 
 if TYPE_CHECKING:
     from rucio.core.request import DirectTransfer
     from rucio.core.rse import RseData
 
 DRIVER_NAME_RSE_ATTRIBUTE = 'bittorrent_driver'
```

### Comparing `rucio-34.0.0rc2/lib/rucio/transfertool/bittorrent_driver.py` & `rucio-34.1.0/lib/rucio/transfertool/bittorrent_driver.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/transfertool/bittorrent_driver_qbittorrent.py` & `rucio-34.1.0/lib/rucio/transfertool/bittorrent_driver_qbittorrent.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -11,30 +10,33 @@
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import logging
 from collections.abc import Sequence
-from typing import TYPE_CHECKING, cast, Optional
+from typing import TYPE_CHECKING, Optional, cast
 from urllib.parse import urlparse
 
 import qbittorrentapi
 
 from rucio.common import types
 from rucio.common.config import get_rse_credentials
 from rucio.common.utils import resolve_ip
 from rucio.core.oidc import request_token
 from rucio.db.sqla.constants import RequestState
 from rucio.transfertool.transfertool import TransferStatusReport
+
 from .bittorrent_driver import BittorrentDriver
 
 if TYPE_CHECKING:
     from typing import Type
+
     from sqlalchemy.orm import Session
+
     from rucio.core.rse import RseData
 
 
 class QBittorrentTransferStatusReport(TransferStatusReport):
 
     supported_db_fields = [
         'state',
```

### Comparing `rucio-34.0.0rc2/lib/rucio/transfertool/fts3.py` & `rucio-34.1.0/lib/rucio/transfertool/fts3.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -28,31 +27,31 @@
 import requests
 from dogpile.cache.api import NoValue
 from requests.adapters import ReadTimeout
 from requests.packages.urllib3 import disable_warnings  # pylint: disable=import-error
 
 from rucio.common.cache import make_region_memcached
 from rucio.common.config import config_get, config_get_bool, config_get_int, config_get_list
-from rucio.common.constants import FTS_JOB_TYPE, FTS_STATE, FTS_COMPLETE_STATE
-from rucio.common.exception import TransferToolTimeout, TransferToolWrongAnswer, DuplicateFileTransferSubmission
+from rucio.common.constants import FTS_COMPLETE_STATE, FTS_JOB_TYPE, FTS_STATE
+from rucio.common.exception import DuplicateFileTransferSubmission, TransferToolTimeout, TransferToolWrongAnswer
 from rucio.common.stopwatch import Stopwatch
-from rucio.common.utils import APIEncoder, chunks, PREFERRED_CHECKSUM, deep_merge_dict
+from rucio.common.utils import PREFERRED_CHECKSUM, APIEncoder, chunks, deep_merge_dict
 from rucio.core.monitor import MetricManager
 from rucio.core.oidc import request_token
 from rucio.core.request import get_source_rse, get_transfer_error
-from rucio.core.rse import (determine_audience_for_rse, determine_scope_for_rse,
-                            get_rse_supported_checksums_from_attributes)
+from rucio.core.rse import determine_audience_for_rse, determine_scope_for_rse, get_rse_supported_checksums_from_attributes
 from rucio.db.sqla.constants import RequestState
-from rucio.transfertool.transfertool import Transfertool, TransferToolBuilder, TransferStatusReport
 from rucio.transfertool.fts3_plugins import FTS3TapeMetadataPlugin
+from rucio.transfertool.transfertool import TransferStatusReport, Transfertool, TransferToolBuilder
 
 if TYPE_CHECKING:
+    from sqlalchemy.orm import Session
+
     from rucio.core.request import DirectTransfer
     from rucio.core.rse import RseData
-    from sqlalchemy.orm import Session
 
 logging.getLogger("requests").setLevel(logging.CRITICAL)
 disable_warnings()
 
 REGION_SHORT = make_region_memcached(expiration_time=900)
 METRICS = MetricManager(module=__name__)
 
@@ -650,15 +649,15 @@
         super().__init__(external_host=external_host, request_id=request_id)
 
         self.fts_message = fts_message
 
         self._transfer_id = fts_message.get('tr_id').split("__")[-1]
 
         self._file_metadata = fts_message['file_metadata']
-        self._multi_sources = str(fts_message.get('job_metadata', {}).get('multi_sources', '')).lower() == str('true')
+        self._multi_sources = str(fts_message.get('job_metadata', {}).get('multi_sources', '')).lower() == 'true'
         self._src_url = fts_message.get('src_url', None)
         self._dst_url = fts_message.get('dst_url', None)
 
     def initialize(self, session: "Session", logger: Callable = logging.log) -> None:
 
         fts_message = self.fts_message
         request_id = self.request_id
@@ -721,15 +720,15 @@
 
         self.job_response = job_response
         self.file_response = file_response
 
         self._transfer_id = job_response.get('job_id')
 
         self._file_metadata = file_response['file_metadata']
-        self._multi_sources = str(job_response['job_metadata'].get('multi_sources', '')).lower() == str('true')
+        self._multi_sources = str(job_response['job_metadata'].get('multi_sources', '')).lower() == 'true'
         self._src_url = file_response.get('source_surl', None)
         self._dst_url = file_response.get('dest_surl', None)
         self.logger = logging.log
 
     def initialize(self, session: "Session", logger=logging.log) -> None:
 
         self.logger = logger
@@ -829,17 +828,15 @@
 
         tape_plugins = config_get_list("transfers", "fts3tape_metadata_plugins", False, "[]")
         self.tape_metadata_plugins = [FTS3TapeMetadataPlugin(plugin.strip(" ")) for plugin in tape_plugins]
 
         self.token = None
         if oidc_support:
             fts_hostname = urlparse(external_host).hostname
-            # FIXME: At the time of writing, it is not yet finalised what
-            # audience and/or scope is required by FTS.
-            token = request_token(audience='https://wlcg.cern.ch/jwt/v1/any', scope='fts')
+            token = request_token(audience=fts_hostname, scope='fts')
             if token is not None:
                 self.logger(logging.INFO, 'Using a token to authenticate with FTS instance %s', fts_hostname)
                 self.token = token
             else:
                 self.logger(logging.WARNING, 'Failed to procure a token to authenticate with FTS instance %s', fts_hostname)
 
         self.deterministic_id = config_get_bool('conveyor', 'use_deterministic_id', False, False)
```

### Comparing `rucio-34.0.0rc2/lib/rucio/transfertool/fts3_plugins.py` & `rucio-34.1.0/lib/rucio/transfertool/fts3_plugins.py`

 * *Files 12% similar despite different names*

```diff
@@ -1,32 +1,33 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-import logging
 import json
+import logging
 import sys
 from configparser import NoSectionError
-from typing import Any, Callable, Optional
+from typing import Any, Callable, Optional, Type, TypeVar
 
 from rucio.common.config import config_get_int, config_get_items
 from rucio.common.exception import InvalidRequest
 from rucio.common.plugins import PolicyPackageAlgorithms
 
+FTS3TapeMetadataPluginType = TypeVar('FTS3TapeMetadataPluginType', bound='FTS3TapeMetadataPlugin')
+
 
 class FTS3TapeMetadataPlugin(PolicyPackageAlgorithms):
     """
     Add a "archive_metadata" field to a file's transfer parameters.
     Plugins are registered during initialization and called during a transfer with FTS3
     """
 
@@ -35,18 +36,14 @@
     DEFAULT = "def"
 
     def __init__(self, policy_algorithm: str) -> None:
         """
         :param policy_algorithm: policy algorithm indentifier - choose from any of the policy package algorithms registered under the `fts3_tape_metadata_plugins` group.
         """
         super().__init__()
-        self.register("activity", func=self._activity_hints, init_func=self._init_instance_activity_hints)
-        self.register(self.DEFAULT, func=lambda x: self._collocation(self._default, x))
-        self.register("test", func=lambda x: self._collocation(self._test_collocation, x))
-
         self.transfer_limit = config_get_int(
             "transfers",
             option="metadata_byte_limit",
             raise_exception=False,
             default=4096,
         )
 
@@ -58,15 +55,24 @@
         # If the policy has a supplied and registered init function
         if self._supports(self._HINTS_NAME, policy_algorithm):
             self._get_one_algorithm(self._HINTS_NAME, name=policy_algorithm)()
 
         self.set_in_hints = self._get_one_algorithm(self.ALGORITHM_NAME, name=policy_algorithm)
 
     @classmethod
-    def register(cls, name: str, func: Callable, init_func: Optional[Callable] = None) -> None:
+    def _module_init(cls: Type[FTS3TapeMetadataPluginType]) -> None:
+        cls.register(
+            "activity",
+            func=lambda x: cls._activity_hints(cls, x),  # type: ignore
+            init_func=lambda: cls._init_instance_activity_hints(cls))  # type: ignore
+        cls.register(cls.DEFAULT, func=lambda x: cls._collocation(cls, cls._default, x))  # type: ignore
+        cls.register("test", func=lambda x: cls._collocation(cls, cls._test_collocation, x))  # type: ignore
+
+    @classmethod
+    def register(cls: Type[FTS3TapeMetadataPluginType], name: str, func: Callable, init_func: Optional[Callable] = None) -> None:
         """
         Register a fts3 transfer plugin
 
         :param name: name to register under
         :param func: function called by the plugin
         :param init_func: Initialization requirements for the plugin, defaults to None
         """
@@ -134,8 +140,8 @@
         """
         hints = self.set_in_hints(hint_kwargs)
         self._verify_in_format(hints)
         return {"archive_metadata": hints}
 
 
 # Register the policies
-FTS3TapeMetadataPlugin("")
+FTS3TapeMetadataPlugin._module_init()
```

### Comparing `rucio-34.0.0rc2/lib/rucio/transfertool/globus.py` & `rucio-34.1.0/lib/rucio/transfertool/globus.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -13,16 +12,17 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import logging
 
 from rucio.common.utils import chunks
 from rucio.db.sqla.constants import RequestState
-from rucio.transfertool.transfertool import Transfertool, TransferToolBuilder, TransferStatusReport
-from .globus_library import bulk_submit_xfer, submit_xfer, bulk_check_xfers
+from rucio.transfertool.transfertool import TransferStatusReport, Transfertool, TransferToolBuilder
+
+from .globus_library import bulk_check_xfers, bulk_submit_xfer, submit_xfer
 
 
 def bulk_group_transfers(transfer_paths, policy='single', group_bulk=200):
     """
     Group transfers in bulk based on certain criterias
 
     :param transfer_paths:  List of (potentially multihop) transfer paths to group. Each path is a list of single-hop transfers.
```

### Comparing `rucio-34.0.0rc2/lib/rucio/transfertool/globus_library.py` & `rucio-34.1.0/lib/rucio/transfertool/globus_library.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -20,16 +19,16 @@
 from rucio.common.config import config_get, config_get_int, get_config_dirs
 from rucio.common.extra import import_extras
 from rucio.core.monitor import MetricManager
 
 EXTRA_MODULES = import_extras(['globus_sdk'])
 
 if EXTRA_MODULES['globus_sdk']:
-    from globus_sdk import NativeAppAuthClient, RefreshTokenAuthorizer, TransferClient, TransferData, DeleteData  # pylint: disable=import-error
     import yaml  # pylint: disable=import-error
+    from globus_sdk import DeleteData, NativeAppAuthClient, RefreshTokenAuthorizer, TransferClient, TransferData  # pylint: disable=import-error
 
 METRICS = MetricManager(module=__name__)
 
 GLOBUS_AUTH_APP = config_get('conveyor', 'globus_auth_app', False, None)
 
 
 def load_config(cfg_file='globus-config.yml', logger=logging.log):
```

### Comparing `rucio-34.0.0rc2/lib/rucio/transfertool/mock.py` & `rucio-34.1.0/lib/rucio/transfertool/mock.py`

 * *Files 8% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -16,15 +15,15 @@
 import itertools
 import logging
 import uuid
 from collections.abc import Sequence
 from typing import TYPE_CHECKING, Any, Optional
 
 from rucio.db.sqla.constants import RequestState
-from rucio.transfertool.transfertool import Transfertool, TransferToolBuilder, TransferStatusReport
+from rucio.transfertool.transfertool import TransferStatusReport, Transfertool, TransferToolBuilder
 
 if TYPE_CHECKING:
     from rucio.db.sqla.session import Session
 
 
 class MockTransferStatusReport(TransferStatusReport):
```

### Comparing `rucio-34.0.0rc2/lib/rucio/transfertool/transfertool.py` & `rucio-34.1.0/lib/rucio/transfertool/transfertool.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -19,19 +18,19 @@
 
 from rucio.common.constants import SUPPORTED_PROTOCOLS
 from rucio.core.request import get_request
 
 if TYPE_CHECKING:
     from typing import Optional
 
-    from rucio.core.rse import RseData
     from rucio.core.request import DirectTransfer
+    from rucio.core.rse import RseData
 
 
-class TransferToolBuilder(object):
+class TransferToolBuilder:
     """
     Builder for Transfertool objects.
     Stores the parameters needed to create the Transfertool object of the given type/class.
 
     Implements __hash__ and __eq__ to allow using it as key in dictionaries and group transfers
     by common transfertool.
     """
@@ -50,15 +49,15 @@
 
     def make_transfertool(self, **additional_kwargs):
         all_kwargs = dict(self.fixed_kwargs)
         all_kwargs.update(additional_kwargs)
         return self.transfertool_class(**all_kwargs)
 
 
-class TransferStatusReport(object, metaclass=ABCMeta):
+class TransferStatusReport(metaclass=ABCMeta):
     """
     Allows to compute the changes which have to be applied to the database
     to reflect the current status reported by the external transfertool into
     the database.
     """
 
     supported_db_fields = [
@@ -110,15 +109,15 @@
         for field in self.supported_db_fields:
             field_value = getattr(self, field)
             if field_value:
                 updates[field] = field_value
         return updates
 
 
-class Transfertool(object, metaclass=ABCMeta):
+class Transfertool(metaclass=ABCMeta):
     """
     Interface definition of the Rucio transfertool
     """
 
     external_name = ''
     required_rse_attrs = ()
     supported_schemes = set(SUPPORTED_PROTOCOLS).difference(('magnet', ))
```

### Comparing `rucio-34.0.0rc2/lib/rucio/version.py` & `rucio-34.1.0/lib/rucio/version.py`

 * *Files 15% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/web/__init__.py` & `rucio-34.1.0/lib/rucio/web/__init__.py`

 * *Files 9% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/web/rest/__init__.py` & `rucio-34.1.0/lib/rucio/web/rest/__init__.py`

 * *Files 9% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/__init__.py` & `rucio-34.1.0/lib/rucio/web/rest/flaskapi/__init__.py`

 * *Files 9% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/authenticated_bp.py` & `rucio-34.1.0/lib/rucio/web/rest/flaskapi/authenticated_bp.py`

 * *Files 9% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/__init__.py` & `rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/__init__.py`

 * *Files 9% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/accountlimits.py` & `rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/accountlimits.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -11,20 +10,18 @@
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 from flask import Flask, request
 
-from rucio.api.account_limit import set_local_account_limit, delete_local_account_limit, set_global_account_limit, \
-    delete_global_account_limit
-from rucio.common.exception import RSENotFound, AccessDenied, AccountNotFound
+from rucio.api.account_limit import delete_global_account_limit, delete_local_account_limit, set_global_account_limit, set_local_account_limit
+from rucio.common.exception import AccessDenied, AccountNotFound, RSENotFound
 from rucio.web.rest.flaskapi.authenticated_bp import AuthenticatedBlueprint
-from rucio.web.rest.flaskapi.v1.common import response_headers, ErrorHandlingMethodView, \
-    generate_http_error_flask, json_parameters, param_get
+from rucio.web.rest.flaskapi.v1.common import ErrorHandlingMethodView, generate_http_error_flask, json_parameters, param_get, response_headers
 
 
 class LocalAccountLimit(ErrorHandlingMethodView):
     def post(self, account, rse):
         """
         ---
         summary: Create or update a local accont limit
```

### Comparing `rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/accounts.py` & `rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/accounts.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,29 +11,25 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 from datetime import datetime
 from json import dumps
 
-from flask import Flask, Response, request, redirect, jsonify
+from flask import Flask, Response, jsonify, redirect, request
 
-from rucio.api.account import add_account, del_account, get_account_info, list_accounts, list_identities, \
-    list_account_attributes, add_account_attribute, del_account_attribute, update_account, get_usage_history
-from rucio.api.account_limit import get_local_account_limits, get_local_account_limit, get_local_account_usage, \
-    get_global_account_limit, get_global_account_limits, get_global_account_usage
+from rucio.api.account import add_account, add_account_attribute, del_account, del_account_attribute, get_account_info, get_usage_history, list_account_attributes, list_accounts, list_identities, update_account
+from rucio.api.account_limit import get_global_account_limit, get_global_account_limits, get_global_account_usage, get_local_account_limit, get_local_account_limits, get_local_account_usage
 from rucio.api.identity import add_account_identity, del_account_identity
 from rucio.api.rule import list_replication_rules
 from rucio.api.scope import add_scope, get_scopes
-from rucio.common.exception import AccountNotFound, Duplicate, AccessDenied, RuleNotFound, RSENotFound, \
-    IdentityError, CounterNotFound, ScopeNotFound, InvalidObject
+from rucio.common.exception import AccessDenied, AccountNotFound, CounterNotFound, Duplicate, IdentityError, InvalidObject, RSENotFound, RuleNotFound, ScopeNotFound
 from rucio.common.utils import APIEncoder, render_json
 from rucio.web.rest.flaskapi.authenticated_bp import AuthenticatedBlueprint
-from rucio.web.rest.flaskapi.v1.common import response_headers, check_accept_header_wrapper_flask, \
-    try_stream, generate_http_error_flask, ErrorHandlingMethodView, json_parameters, param_get
+from rucio.web.rest.flaskapi.v1.common import ErrorHandlingMethodView, check_accept_header_wrapper_flask, generate_http_error_flask, json_parameters, param_get, response_headers, try_stream
 
 
 class Attributes(ErrorHandlingMethodView):
 
     @check_accept_header_wrapper_flask(['application/json'])
     def get(self, account):
         """
```

### Comparing `rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/archives.py` & `rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/archives.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -15,16 +14,15 @@
 
 from json import dumps
 
 from flask import Flask, request
 
 from rucio.api.did import list_archive_content
 from rucio.web.rest.flaskapi.authenticated_bp import AuthenticatedBlueprint
-from rucio.web.rest.flaskapi.v1.common import response_headers, check_accept_header_wrapper_flask, \
-    parse_scope_name, try_stream, generate_http_error_flask, ErrorHandlingMethodView
+from rucio.web.rest.flaskapi.v1.common import ErrorHandlingMethodView, check_accept_header_wrapper_flask, generate_http_error_flask, parse_scope_name, response_headers, try_stream
 
 
 class Archive(ErrorHandlingMethodView):
     """ REST APIs for archive. """
 
     @check_accept_header_wrapper_flask(['application/x-json-stream'])
     def get(self, scope_name):
```

### Comparing `rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/auth.py` & `rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/auth.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -16,36 +15,47 @@
 import base64
 import json
 import logging
 import time
 from typing import TYPE_CHECKING
 from urllib.parse import urlparse
 
-from flask import Flask, Blueprint, request, Response, redirect, render_template
+from flask import Blueprint, Flask, Response, redirect, render_template, request
 from werkzeug.datastructures import Headers
 
-from rucio.api.authentication import get_auth_token_user_pass, get_auth_token_gss, get_auth_token_x509, \
-    get_auth_token_ssh, get_ssh_challenge_token, validate_auth_token, get_auth_oidc, redirect_auth_oidc, \
-    get_token_oidc, refresh_cli_auth_token, get_auth_token_saml
+from rucio.api.authentication import (
+    get_auth_oidc,
+    get_auth_token_gss,
+    get_auth_token_saml,
+    get_auth_token_ssh,
+    get_auth_token_user_pass,
+    get_auth_token_x509,
+    get_ssh_challenge_token,
+    get_token_oidc,
+    redirect_auth_oidc,
+    refresh_cli_auth_token,
+    validate_auth_token,
+)
 from rucio.common.config import config_get
-from rucio.common.exception import AccessDenied, IdentityError, IdentityNotFound, CannotAuthenticate, CannotAuthorize
+from rucio.common.exception import AccessDenied, CannotAuthenticate, CannotAuthorize, IdentityError, IdentityNotFound
 from rucio.common.extra import import_extras
 from rucio.common.utils import date_to_str
 from rucio.core.authentication import strip_x509_proxy_attributes
-from rucio.web.rest.flaskapi.v1.common import check_accept_header_wrapper_flask, error_headers, \
-    extract_vo, generate_http_error_flask, ErrorHandlingMethodView, get_account_from_verified_identity
+from rucio.web.rest.flaskapi.v1.common import ErrorHandlingMethodView, check_accept_header_wrapper_flask, error_headers, extract_vo, generate_http_error_flask, get_account_from_verified_identity
 
 if TYPE_CHECKING:
     from typing import Optional, Union
+
     from rucio.web.rest.flaskapi.v1.common import HeadersType
 
 EXTRA_MODULES = import_extras(['onelogin'])
 
 if EXTRA_MODULES['onelogin']:
     from onelogin.saml2.auth import OneLogin_Saml2_Auth  # pylint: disable=import-error
+
     from rucio.web.ui.flask.common.utils import prepare_saml_request
 
 
 class UserPass(ErrorHandlingMethodView):
     """
     Authenticate a Rucio account temporarily via username and password.
     """
```

### Comparing `rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/common.py` & `rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/common.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -25,29 +24,29 @@
 import flask
 from flask.views import MethodView
 from werkzeug.datastructures import Headers
 from werkzeug.exceptions import HTTPException
 from werkzeug.wrappers import Request, Response
 
 from rucio.api.authentication import validate_auth_token
-from rucio.api.identity import list_accounts_for_identity, get_default_account, verify_identity
+from rucio.api.identity import get_default_account, list_accounts_for_identity, verify_identity
 from rucio.common import config
-from rucio.common.exception import DatabaseException, IdentityError, RucioException, CannotAuthenticate, UnsupportedRequestedContentType
+from rucio.common.exception import CannotAuthenticate, DatabaseException, IdentityError, RucioException, UnsupportedRequestedContentType
 from rucio.common.schema import get_schema_value
 from rucio.common.utils import generate_uuid, render_json
 from rucio.core.vo import map_vo
 
 if TYPE_CHECKING:
     from collections.abc import Callable, Iterable, Sequence
-    from typing import Optional, Union, Literal, Any
+    from typing import Any, Literal, Optional, Union
 
     HeadersType = Union[Headers, dict[str, str], Sequence[tuple[str, str]]]
 
 
-class CORSMiddleware(object):
+class CORSMiddleware:
     """
     WebUI 2.0 makes preflight requests to the API, which are not handled by the API.
     This middleware intercepts the preflight OPTIONS requests and returns a 200 OK response.
     """
 
     def __init__(self, app: flask.Flask) -> None:
         self.app = app
```

### Comparing `rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/config.py` & `rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/config.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,29 +1,28 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-from flask import Flask, request as request, jsonify
+from flask import Flask, jsonify
+from flask import request as request
 
 from rucio.api import config
-from rucio.common.exception import ConfigurationError, AccessDenied, ConfigNotFound
+from rucio.common.exception import AccessDenied, ConfigNotFound, ConfigurationError
 from rucio.web.rest.flaskapi.authenticated_bp import AuthenticatedBlueprint
-from rucio.web.rest.flaskapi.v1.common import response_headers, check_accept_header_wrapper_flask, \
-    generate_http_error_flask, ErrorHandlingMethodView, json_parameters
+from rucio.web.rest.flaskapi.v1.common import ErrorHandlingMethodView, check_accept_header_wrapper_flask, generate_http_error_flask, json_parameters, response_headers
 
 
 class Config(ErrorHandlingMethodView):
     """ REST API for full configuration. """
 
     @check_accept_header_wrapper_flask(['application/json'])
     def get(self):
```

### Comparing `rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/credentials.py` & `rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/credentials.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -17,19 +16,19 @@
 
 from flask import Flask, request
 from werkzeug.datastructures import Headers
 
 from rucio.api.credential import get_signed_url
 from rucio.common.exception import CannotAuthenticate
 from rucio.web.rest.flaskapi.authenticated_bp import AuthenticatedBlueprint
-from rucio.web.rest.flaskapi.v1.common import check_accept_header_wrapper_flask, extract_vo, \
-    generate_http_error_flask, ErrorHandlingMethodView, response_headers
+from rucio.web.rest.flaskapi.v1.common import ErrorHandlingMethodView, check_accept_header_wrapper_flask, extract_vo, generate_http_error_flask, response_headers
 
 if TYPE_CHECKING:
     from typing import Optional
+
     from rucio.web.rest.flaskapi.v1.common import HeadersType
 
 
 class SignURL(ErrorHandlingMethodView):
     """
     Request a signed URL.
     """
```

### Comparing `rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/dids.py` & `rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/dids.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -14,28 +13,68 @@
 # limitations under the License.
 
 import ast
 from json import dumps
 
 from flask import Flask, Response, request
 
-from rucio.api.did import add_did, add_dids, list_content, list_content_history, list_dids, \
-    list_files, scope_list, get_did, set_metadata, get_metadata, get_metadata_bulk, set_status, attach_dids, \
-    detach_dids, attach_dids_to_dids, get_dataset_by_guid, list_parent_dids, create_did_sample, list_new_dids, \
-    resurrect, get_users_following_did, remove_did_from_followed, add_did_to_followed, delete_metadata, \
-    set_metadata_bulk, set_dids_metadata_bulk
-from rucio.api.rule import list_replication_rules, list_associated_replication_rules_for_file
-from rucio.common.exception import ScopeNotFound, DatabaseException, DataIdentifierNotFound, DataIdentifierAlreadyExists, \
-    DuplicateContent, AccessDenied, KeyNotFound, Duplicate, InvalidValueForKey, UnsupportedStatus, \
-    UnsupportedOperation, RSENotFound, RuleNotFound, InvalidMetadata, InvalidPath, FileAlreadyExists, InvalidObject, FileConsistencyMismatch
-from rucio.common.utils import render_json, APIEncoder
+from rucio.api.did import (
+    add_did,
+    add_did_to_followed,
+    add_dids,
+    attach_dids,
+    attach_dids_to_dids,
+    bulk_list_files,
+    create_did_sample,
+    delete_metadata,
+    detach_dids,
+    get_dataset_by_guid,
+    get_did,
+    get_metadata,
+    get_metadata_bulk,
+    get_users_following_did,
+    list_content,
+    list_content_history,
+    list_dids,
+    list_files,
+    list_new_dids,
+    list_parent_dids,
+    remove_did_from_followed,
+    resurrect,
+    scope_list,
+    set_dids_metadata_bulk,
+    set_metadata,
+    set_metadata_bulk,
+    set_status,
+)
+from rucio.api.rule import list_associated_replication_rules_for_file, list_replication_rules
+from rucio.common.exception import (
+    AccessDenied,
+    DatabaseException,
+    DataIdentifierAlreadyExists,
+    DataIdentifierNotFound,
+    Duplicate,
+    DuplicateContent,
+    FileAlreadyExists,
+    FileConsistencyMismatch,
+    InvalidMetadata,
+    InvalidObject,
+    InvalidPath,
+    InvalidValueForKey,
+    KeyNotFound,
+    RSENotFound,
+    RuleNotFound,
+    ScopeNotFound,
+    UnsupportedOperation,
+    UnsupportedStatus,
+)
+from rucio.common.utils import APIEncoder, parse_response, render_json
 from rucio.db.sqla.constants import DIDType
 from rucio.web.rest.flaskapi.authenticated_bp import AuthenticatedBlueprint
-from rucio.web.rest.flaskapi.v1.common import response_headers, check_accept_header_wrapper_flask, \
-    parse_scope_name, try_stream, generate_http_error_flask, ErrorHandlingMethodView, json_parameters, json_list, param_get, json_parse
+from rucio.web.rest.flaskapi.v1.common import ErrorHandlingMethodView, check_accept_header_wrapper_flask, generate_http_error_flask, json_list, json_parameters, json_parse, param_get, parse_scope_name, response_headers, try_stream
 
 
 class Scope(ErrorHandlingMethodView):
 
     @check_accept_header_wrapper_flask(['application/x-json-stream'])
     def get(self, scope):
         """
@@ -1107,14 +1146,94 @@
             return try_stream(generate(vo=request.environ.get('vo')))
         except ValueError as error:
             return generate_http_error_flask(400, error)
         except DataIdentifierNotFound as error:
             return generate_http_error_flask(404, error)
 
 
+class BulkFiles(ErrorHandlingMethodView):
+
+    @check_accept_header_wrapper_flask(['application/x-json-stream'])
+    def post(self):
+        """
+        ---
+        summary: List files bulk
+        description: List files in multiple dids
+        tags:
+          - Data Identifiers
+        requestBody:
+          content:
+            application/json:
+              schema:
+                type: array
+                items:
+                  description: One did to list files.
+                  type: object
+                  required:
+                    - scope
+                    - name
+                  properties:
+                    scope:
+                      description: The did scope.
+                      type: string
+                    name:
+                      description: The did name.
+                      type: string
+        responses:
+          201:
+            description: OK
+            content:
+              application/x-json-stream:
+                schema:
+                  description: All collections file content.
+                  type: array
+                  items:
+                    description: Collections file content.
+                    type: object
+                    properties:
+                      parent_scope:
+                        description: The scope of the parent did.
+                        type: string
+                      parent_name:
+                        description: The name of the parent did.
+                        type: string
+                      scope:
+                        description: The scope of the did.
+                        type: string
+                      name:
+                        description: The name of the did.
+                        type: string
+                      bytes:
+                        description: The size of the did in bytes.
+                        type: integer
+                      guid:
+                        description: The guid of the did.
+                        type: string
+                      events:
+                        description: The number of events of the did.
+                        type: integer
+                      adler32:
+                        description: The adler32 checksum.
+                        type: string
+          401:
+            description: Invalid Auth Token
+        """
+        parameters = json_parameters(parse_response)
+        dids = param_get(parameters, 'dids', default=[])
+        try:
+            def generate(vo):
+                for did in bulk_list_files(dids=dids, vo=vo):
+                    yield render_json(**did) + '\n'
+
+            return try_stream(generate(vo=request.environ.get('vo')))
+        except AccessDenied as error:
+            return generate_http_error_flask(401, error)
+        return 'Created', 201
+
+
 class Parents(ErrorHandlingMethodView):
 
     @check_accept_header_wrapper_flask(['application/x-json-stream'])
     def get(self, scope_name):
         """
         ---
         summary: Get Parents
@@ -2191,14 +2310,16 @@
     bp.add_url_rule('/attachments', view_func=attachements_view, methods=['post', ])
     new_dids_view = NewDIDs.as_view('new_dids')
     bp.add_url_rule('/new', view_func=new_dids_view, methods=['get', ])
     resurrect_view = Resurrect.as_view('resurrect')
     bp.add_url_rule('/resurrect', view_func=resurrect_view, methods=['post', ])
     bulkmeta_view = BulkMeta.as_view('bulkmeta')
     bp.add_url_rule('/bulkmeta', view_func=bulkmeta_view, methods=['post', ])
+    files_view = BulkFiles.as_view('bulkfiles')
+    bp.add_url_rule('/bulkfiles', view_func=files_view, methods=['post', ])
 
     bp.after_request(response_headers)
     return bp
 
 
 def make_doc():
     """ Only used for sphinx documentation """
```

### Comparing `rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/dirac.py` & `rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/dirac.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,20 +11,18 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 from flask import Flask, request
 
 from rucio.api.dirac import add_files
-from rucio.common.exception import AccessDenied, DataIdentifierAlreadyExists, DatabaseException, \
-    Duplicate, InvalidPath, ResourceTemporaryUnavailable, RSENotFound, UnsupportedOperation
+from rucio.common.exception import AccessDenied, DatabaseException, DataIdentifierAlreadyExists, Duplicate, InvalidPath, ResourceTemporaryUnavailable, RSENotFound, UnsupportedOperation
 from rucio.common.utils import parse_response
 from rucio.web.rest.flaskapi.authenticated_bp import AuthenticatedBlueprint
-from rucio.web.rest.flaskapi.v1.common import response_headers, generate_http_error_flask, \
-    ErrorHandlingMethodView, json_parameters, param_get
+from rucio.web.rest.flaskapi.v1.common import ErrorHandlingMethodView, generate_http_error_flask, json_parameters, param_get, response_headers
 
 
 class AddFiles(ErrorHandlingMethodView):
 
     def post(self):
         """
         ---
```

### Comparing `rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/export.py` & `rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/export.py`

 * *Files 3% similar despite different names*

```diff
@@ -1,29 +1,27 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-from flask import Flask, request, Response
+from flask import Flask, Response, request
 
 from rucio.api.exporter import export_data
 from rucio.common.utils import render_json
 from rucio.web.rest.flaskapi.authenticated_bp import AuthenticatedBlueprint
-from rucio.web.rest.flaskapi.v1.common import response_headers, check_accept_header_wrapper_flask, \
-    ErrorHandlingMethodView
+from rucio.web.rest.flaskapi.v1.common import ErrorHandlingMethodView, check_accept_header_wrapper_flask, response_headers
 
 
 class Export(ErrorHandlingMethodView):
     """ Export data. """
 
     @check_accept_header_wrapper_flask(['application/json'])
     def get(self):
```

### Comparing `rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/heartbeats.py` & `rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/heartbeats.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -13,20 +12,19 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import json
 
 from flask import Flask, Response, request
 
-from rucio.api.heartbeat import list_heartbeats, create_heartbeat
-from rucio.common.exception import UnsupportedValueType, UnsupportedKeyType, KeyNotFound, AccessDenied
+from rucio.api.heartbeat import create_heartbeat, list_heartbeats
+from rucio.common.exception import AccessDenied, KeyNotFound, UnsupportedKeyType, UnsupportedValueType
 from rucio.common.utils import APIEncoder
 from rucio.web.rest.flaskapi.authenticated_bp import AuthenticatedBlueprint
-from rucio.web.rest.flaskapi.v1.common import response_headers, check_accept_header_wrapper_flask, \
-    ErrorHandlingMethodView, json_parameters, param_get, generate_http_error_flask
+from rucio.web.rest.flaskapi.v1.common import ErrorHandlingMethodView, check_accept_header_wrapper_flask, generate_http_error_flask, json_parameters, param_get, response_headers
 
 
 class Heartbeat(ErrorHandlingMethodView):
     """ REST API for Heartbeats. """
 
     @check_accept_header_wrapper_flask(['application/json'])
     def get(self):
```

### Comparing `rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/identities.py` & `rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/identities.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,28 +1,26 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-from flask import Flask, request, jsonify
+from flask import Flask, jsonify, request
 
-from rucio.api.identity import add_identity, add_account_identity, list_accounts_for_identity
+from rucio.api.identity import add_account_identity, add_identity, list_accounts_for_identity
 from rucio.web.rest.flaskapi.authenticated_bp import AuthenticatedBlueprint
-from rucio.web.rest.flaskapi.v1.common import response_headers, check_accept_header_wrapper_flask, \
-    ErrorHandlingMethodView
+from rucio.web.rest.flaskapi.v1.common import ErrorHandlingMethodView, check_accept_header_wrapper_flask, response_headers
 
 
 class UserPass(ErrorHandlingMethodView):
     """ Manage a username/password identity for an account. """
 
     def put(self, account):
         """
```

### Comparing `rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/import.py` & `rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/import.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -14,15 +13,15 @@
 # limitations under the License.
 
 from flask import Flask, request
 
 from rucio.api.importer import import_data
 from rucio.common.utils import parse_response
 from rucio.web.rest.flaskapi.authenticated_bp import AuthenticatedBlueprint
-from rucio.web.rest.flaskapi.v1.common import response_headers, ErrorHandlingMethodView, json_parameters
+from rucio.web.rest.flaskapi.v1.common import ErrorHandlingMethodView, json_parameters, response_headers
 
 
 class Import(ErrorHandlingMethodView):
     """ Import data. """
 
     def post(self):
         """
```

### Comparing `rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/lifetime_exceptions.py` & `rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/lifetime_exceptions.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -13,21 +12,19 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 from json import dumps
 
 from flask import Flask, Response, request
 
-from rucio.api.lifetime_exception import list_exceptions, add_exception, update_exception
-from rucio.common.exception import LifetimeExceptionNotFound, UnsupportedOperation, InvalidObject, AccessDenied, \
-    LifetimeExceptionDuplicate
+from rucio.api.lifetime_exception import add_exception, list_exceptions, update_exception
+from rucio.common.exception import AccessDenied, InvalidObject, LifetimeExceptionDuplicate, LifetimeExceptionNotFound, UnsupportedOperation
 from rucio.common.utils import APIEncoder
 from rucio.web.rest.flaskapi.authenticated_bp import AuthenticatedBlueprint
-from rucio.web.rest.flaskapi.v1.common import response_headers, check_accept_header_wrapper_flask, \
-    try_stream, generate_http_error_flask, ErrorHandlingMethodView, json_parameters, param_get
+from rucio.web.rest.flaskapi.v1.common import ErrorHandlingMethodView, check_accept_header_wrapper_flask, generate_http_error_flask, json_parameters, param_get, response_headers, try_stream
 
 
 class LifetimeException(ErrorHandlingMethodView):
     """ REST APIs for Lifetime Model exception. """
 
     @check_accept_header_wrapper_flask(['application/x-json-stream'])
     def get(self):
```

### Comparing `rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/locks.py` & `rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/locks.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -11,20 +10,19 @@
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 from flask import Flask, request
 
-from rucio.api.lock import get_dataset_locks_by_rse, get_dataset_locks, get_dataset_locks_bulk
+from rucio.api.lock import get_dataset_locks, get_dataset_locks_bulk, get_dataset_locks_by_rse
 from rucio.common.exception import RSENotFound
 from rucio.common.utils import render_json
 from rucio.web.rest.flaskapi.authenticated_bp import AuthenticatedBlueprint
-from rucio.web.rest.flaskapi.v1.common import check_accept_header_wrapper_flask, parse_scope_name, try_stream, \
-    response_headers, generate_http_error_flask, ErrorHandlingMethodView, json_parse
+from rucio.web.rest.flaskapi.v1.common import ErrorHandlingMethodView, check_accept_header_wrapper_flask, generate_http_error_flask, json_parse, parse_scope_name, response_headers, try_stream
 
 
 class LockByRSE(ErrorHandlingMethodView):
     """ REST APIs for dataset locks. """
 
     @check_accept_header_wrapper_flask(['application/x-json-stream'])
     def get(self, rse):
```

### Comparing `rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/main.py` & `rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/main.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,9 +1,8 @@
 #!/usr/bin/env python3
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -11,21 +10,21 @@
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import importlib
+import logging
 
 from flask import Flask
 
 from rucio.common.config import config_get
 from rucio.common.exception import ConfigurationError
 from rucio.common.logging import setup_logging
-import logging
 from rucio.web.rest.flaskapi.v1.common import CORSMiddleware
 
 DEFAULT_ENDPOINTS = [
     'accountlimits',
     'accounts',
     'auth',
     'config',
```

### Comparing `rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/meta_conventions.py` & `rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/meta_conventions.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,29 +1,27 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-from flask import Flask, request, jsonify
+from flask import Flask, jsonify, request
 
 from rucio.api.meta_conventions import add_key, add_value, list_keys, list_values
-from rucio.common.exception import Duplicate, InvalidValueForKey, KeyNotFound, UnsupportedValueType, UnsupportedKeyType
+from rucio.common.exception import Duplicate, InvalidValueForKey, KeyNotFound, UnsupportedKeyType, UnsupportedValueType
 from rucio.web.rest.flaskapi.authenticated_bp import AuthenticatedBlueprint
-from rucio.web.rest.flaskapi.v1.common import check_accept_header_wrapper_flask, response_headers, \
-    generate_http_error_flask, ErrorHandlingMethodView, json_parameters, param_get
+from rucio.web.rest.flaskapi.v1.common import ErrorHandlingMethodView, check_accept_header_wrapper_flask, generate_http_error_flask, json_parameters, param_get, response_headers
 
 
 class MetaConventions(ErrorHandlingMethodView):
     """ REST APIs for managing data identifier attribute metadata key formats. """
 
     @check_accept_header_wrapper_flask(['application/json'])
     def get(self):
```

### Comparing `rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/metrics.py` & `rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/metrics.py`

 * *Files 10% similar despite different names*

```diff
@@ -1,23 +1,22 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-from flask import Flask, Blueprint
+from flask import Blueprint, Flask
 
 from rucio.core.monitor import generate_prometheus_metrics
 from rucio.web.rest.flaskapi.v1.common import ErrorHandlingMethodView
 
 
 class Metrics(ErrorHandlingMethodView):
     def get(self):
```

### Comparing `rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/nongrid_traces.py` & `rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/nongrid_traces.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,22 +11,23 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import time
 from typing import TYPE_CHECKING
 
-from flask import Flask, Blueprint, request
+from flask import Blueprint, Flask, request
 from werkzeug.datastructures import Headers
 
 from rucio.core.nongrid_trace import trace
-from rucio.web.rest.flaskapi.v1.common import response_headers, ErrorHandlingMethodView, json_parameters
+from rucio.web.rest.flaskapi.v1.common import ErrorHandlingMethodView, json_parameters, response_headers
 
 if TYPE_CHECKING:
     from typing import Optional
+
     from rucio.web.rest.flaskapi.v1.common import HeadersType
 
 
 class XAODTrace(ErrorHandlingMethodView):
 
     def get_headers(self) -> "Optional[HeadersType]":
         headers = Headers()
```

### Comparing `rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/ping.py` & `rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/ping.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -11,23 +10,23 @@
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 from typing import TYPE_CHECKING
 
-from flask import Flask, Blueprint, jsonify, request
+from flask import Blueprint, Flask, jsonify, request
 from werkzeug.datastructures import Headers
 
 from rucio import version
-from rucio.web.rest.flaskapi.v1.common import response_headers, check_accept_header_wrapper_flask, \
-    ErrorHandlingMethodView
+from rucio.web.rest.flaskapi.v1.common import ErrorHandlingMethodView, check_accept_header_wrapper_flask, response_headers
 
 if TYPE_CHECKING:
     from typing import Optional
+
     from rucio.web.rest.flaskapi.v1.common import HeadersType
 
 
 class Ping(ErrorHandlingMethodView):
 
     def get_headers(self) -> "Optional[HeadersType]":
         headers = Headers()
```

### Comparing `rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/redirect.py` & `rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/redirect.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,25 +11,25 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import itertools
 from typing import TYPE_CHECKING
 
-from flask import Flask, Blueprint, request, redirect
+from flask import Blueprint, Flask, redirect, request
 from werkzeug.datastructures import Headers
 
 from rucio.api.replica import list_replicas
 from rucio.common.exception import DataIdentifierNotFound, ReplicaNotFound
 from rucio.core.replica_sorter import site_selector, sort_replicas
-from rucio.web.rest.flaskapi.v1.common import check_accept_header_wrapper_flask, parse_scope_name, try_stream, \
-    extract_vo, generate_http_error_flask, ErrorHandlingMethodView
+from rucio.web.rest.flaskapi.v1.common import ErrorHandlingMethodView, check_accept_header_wrapper_flask, extract_vo, generate_http_error_flask, parse_scope_name, try_stream
 
 if TYPE_CHECKING:
     from typing import Optional
+
     from rucio.web.rest.flaskapi.v1.common import HeadersType
 
 
 class MetaLinkRedirector(ErrorHandlingMethodView):
 
     def get_headers(self) -> "Optional[HeadersType]":
         headers = Headers()
```

### Comparing `rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/replicas.py` & `rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/replicas.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -18,28 +17,41 @@
 from json import dumps, loads
 from urllib.parse import parse_qs, unquote
 from xml.sax.saxutils import escape
 
 from flask import Flask, Response, request
 
 from rucio.api.quarantined_replica import quarantine_file_replicas
-from rucio.api.replica import add_replicas, list_replicas, list_dataset_replicas, list_dataset_replicas_bulk, \
-    delete_replicas, get_did_from_pfns, update_replicas_states, declare_bad_file_replicas, add_bad_dids, add_bad_pfns, \
-    get_suspicious_files, declare_suspicious_file_replicas, list_bad_replicas_status, get_bad_replicas_summary, \
-    list_datasets_per_rse, set_tombstone, list_dataset_replicas_vp
+from rucio.api.replica import (
+    add_bad_dids,
+    add_bad_pfns,
+    add_replicas,
+    declare_bad_file_replicas,
+    declare_suspicious_file_replicas,
+    delete_replicas,
+    get_bad_replicas_summary,
+    get_did_from_pfns,
+    get_suspicious_files,
+    list_bad_replicas_status,
+    list_dataset_replicas,
+    list_dataset_replicas_bulk,
+    list_dataset_replicas_vp,
+    list_datasets_per_rse,
+    list_replicas,
+    set_tombstone,
+    update_replicas_states,
+)
 from rucio.common.config import config_get, config_get_int
 from rucio.common.constants import SUPPORTED_PROTOCOLS
-from rucio.common.exception import AccessDenied, DataIdentifierAlreadyExists, InvalidType, DataIdentifierNotFound, \
-    Duplicate, InvalidPath, ResourceTemporaryUnavailable, RSENotFound, ReplicaNotFound, InvalidObject, ScopeNotFound, ReplicaIsLocked
-from rucio.common.utils import parse_response, APIEncoder, render_json_list
+from rucio.common.exception import AccessDenied, DataIdentifierAlreadyExists, DataIdentifierNotFound, Duplicate, InvalidObject, InvalidPath, InvalidType, ReplicaIsLocked, ReplicaNotFound, ResourceTemporaryUnavailable, RSENotFound, ScopeNotFound
+from rucio.common.utils import APIEncoder, parse_response, render_json_list
 from rucio.core.replica_sorter import sort_replicas
 from rucio.db.sqla.constants import BadFilesStatus
 from rucio.web.rest.flaskapi.authenticated_bp import AuthenticatedBlueprint
-from rucio.web.rest.flaskapi.v1.common import check_accept_header_wrapper_flask, try_stream, parse_scope_name, \
-    response_headers, generate_http_error_flask, ErrorHandlingMethodView, json_parameters, param_get
+from rucio.web.rest.flaskapi.v1.common import ErrorHandlingMethodView, check_accept_header_wrapper_flask, generate_http_error_flask, json_parameters, param_get, parse_scope_name, response_headers, try_stream
 
 
 def _sorted_with_priorities(replicas, sorted_pfns, limit=None):
     """
     Pick up to "limit" replicas from "replicas" in the order given by sorted_pfns.
     Sets the corresponding priority in returned replicas.
```

### Comparing `rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/requests.py` & `rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/requests.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -10,27 +9,26 @@
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import json
+from typing import TYPE_CHECKING
 
 import flask
 from flask import Flask, Response
-from typing import TYPE_CHECKING
 
 from rucio.api import request
 from rucio.common.exception import RequestNotFound
 from rucio.common.utils import APIEncoder, render_json
 from rucio.core.rse import get_rses_with_attribute_value
 from rucio.db.sqla.constants import RequestState
 from rucio.web.rest.flaskapi.authenticated_bp import AuthenticatedBlueprint
-from rucio.web.rest.flaskapi.v1.common import check_accept_header_wrapper_flask, parse_scope_name, try_stream, \
-    response_headers, generate_http_error_flask, ErrorHandlingMethodView
+from rucio.web.rest.flaskapi.v1.common import ErrorHandlingMethodView, check_accept_header_wrapper_flask, generate_http_error_flask, parse_scope_name, response_headers, try_stream
 
 if TYPE_CHECKING:
     from typing import Iterator
 
 
 class RequestGet(ErrorHandlingMethodView):
     """ REST API to get requests. """
```

### Comparing `rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/rses.py` & `rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/rses.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -11,29 +10,65 @@
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 from json import dumps
 
-from flask import Flask, Response, request, jsonify
+from flask import Flask, Response, jsonify, request
 
 from rucio.api.account_limit import get_rse_account_usage
-from rucio.api.rse import add_rse, update_rse, list_rses, del_rse, add_rse_attribute, list_rse_attributes, \
-    del_rse_attribute, add_protocol, get_rse_protocols, del_protocols, update_protocols, get_rse, set_rse_usage, \
-    get_rse_usage, list_rse_usage_history, set_rse_limits, get_rse_limits, delete_rse_limits, parse_rse_expression, \
-    add_distance, get_distance, update_distance, delete_distance, list_qos_policies, add_qos_policy, delete_qos_policy
-from rucio.common.exception import Duplicate, AccessDenied, RSENotFound, RSEOperationNotSupported, \
-    RSEProtocolNotSupported, InvalidObject, RSEProtocolDomainNotSupported, RSEProtocolPriorityError, \
-    InvalidRSEExpression, RSEAttributeNotFound, CounterNotFound, InvalidPath, ReplicaNotFound, InputValidationError
-from rucio.common.utils import Availability, render_json, APIEncoder
+from rucio.api.rse import (
+    add_distance,
+    add_protocol,
+    add_qos_policy,
+    add_rse,
+    add_rse_attribute,
+    del_protocols,
+    del_rse,
+    del_rse_attribute,
+    delete_distance,
+    delete_qos_policy,
+    delete_rse_limits,
+    get_distance,
+    get_rse,
+    get_rse_limits,
+    get_rse_protocols,
+    get_rse_usage,
+    list_qos_policies,
+    list_rse_attributes,
+    list_rse_usage_history,
+    list_rses,
+    parse_rse_expression,
+    set_rse_limits,
+    set_rse_usage,
+    update_distance,
+    update_protocols,
+    update_rse,
+)
+from rucio.common.exception import (
+    AccessDenied,
+    CounterNotFound,
+    Duplicate,
+    InputValidationError,
+    InvalidObject,
+    InvalidPath,
+    InvalidRSEExpression,
+    ReplicaNotFound,
+    RSEAttributeNotFound,
+    RSENotFound,
+    RSEOperationNotSupported,
+    RSEProtocolDomainNotSupported,
+    RSEProtocolNotSupported,
+    RSEProtocolPriorityError,
+)
+from rucio.common.utils import APIEncoder, Availability, render_json
 from rucio.rse import rsemanager
 from rucio.web.rest.flaskapi.authenticated_bp import AuthenticatedBlueprint
-from rucio.web.rest.flaskapi.v1.common import response_headers, check_accept_header_wrapper_flask, \
-    try_stream, generate_http_error_flask, ErrorHandlingMethodView, json_parameters, param_get
+from rucio.web.rest.flaskapi.v1.common import ErrorHandlingMethodView, check_accept_header_wrapper_flask, generate_http_error_flask, json_parameters, param_get, response_headers, try_stream
 
 
 class RSEs(ErrorHandlingMethodView):
     """ List all RSEs in the database. """
 
     @check_accept_header_wrapper_flask(['application/x-json-stream'])
     def get(self):
```

### Comparing `rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/rules.py` & `rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/rules.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,28 +11,52 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 from json import dumps
 from typing import Any
 
-from flask import Flask, request, Response
+from flask import Flask, Response, request
 
 from rucio.api.lock import get_replica_locks_for_rule_id
-from rucio.api.rule import add_replication_rule, delete_replication_rule, get_replication_rule, \
-    update_replication_rule, reduce_replication_rule, list_replication_rule_history, \
-    list_replication_rule_full_history, list_replication_rules, examine_replication_rule, move_replication_rule
-from rucio.common.exception import InputValidationError, InsufficientAccountLimit, RuleNotFound, AccessDenied, InvalidRSEExpression, \
-    InvalidReplicationRule, DataIdentifierNotFound, InsufficientTargetRSEs, ReplicationRuleCreationTemporaryFailed, \
-    InvalidRuleWeight, StagingAreaRuleRequiresLifetime, DuplicateRule, InvalidObject, AccountNotFound, \
-    RuleReplaceFailed, ScratchDiskLifetimeConflict, ManualRuleApprovalBlocked, UnsupportedOperation
-from rucio.common.utils import render_json, APIEncoder
+from rucio.api.rule import (
+    add_replication_rule,
+    delete_replication_rule,
+    examine_replication_rule,
+    get_replication_rule,
+    list_replication_rule_full_history,
+    list_replication_rule_history,
+    list_replication_rules,
+    move_replication_rule,
+    reduce_replication_rule,
+    update_replication_rule,
+)
+from rucio.common.exception import (
+    AccessDenied,
+    AccountNotFound,
+    DataIdentifierNotFound,
+    DuplicateRule,
+    InputValidationError,
+    InsufficientAccountLimit,
+    InsufficientTargetRSEs,
+    InvalidObject,
+    InvalidReplicationRule,
+    InvalidRSEExpression,
+    InvalidRuleWeight,
+    ManualRuleApprovalBlocked,
+    ReplicationRuleCreationTemporaryFailed,
+    RuleNotFound,
+    RuleReplaceFailed,
+    ScratchDiskLifetimeConflict,
+    StagingAreaRuleRequiresLifetime,
+    UnsupportedOperation,
+)
+from rucio.common.utils import APIEncoder, render_json
 from rucio.web.rest.flaskapi.authenticated_bp import AuthenticatedBlueprint
-from rucio.web.rest.flaskapi.v1.common import check_accept_header_wrapper_flask, parse_scope_name, try_stream, \
-    response_headers, generate_http_error_flask, ErrorHandlingMethodView, json_parameters, param_get
+from rucio.web.rest.flaskapi.v1.common import ErrorHandlingMethodView, check_accept_header_wrapper_flask, generate_http_error_flask, json_parameters, param_get, parse_scope_name, response_headers, try_stream
 
 
 class Rule(ErrorHandlingMethodView):
     """ REST APIs for replication rules. """
 
     @check_accept_header_wrapper_flask(['application/json'])
     def get(self, rule_id):
```

### Comparing `rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/scopes.py` & `rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/scopes.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,29 +1,27 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-from flask import Flask, request, jsonify
+from flask import Flask, jsonify, request
 
-from rucio.api.scope import add_scope, list_scopes, get_scopes
+from rucio.api.scope import add_scope, get_scopes, list_scopes
 from rucio.common.exception import AccountNotFound, Duplicate, ScopeNotFound
 from rucio.web.rest.flaskapi.authenticated_bp import AuthenticatedBlueprint
-from rucio.web.rest.flaskapi.v1.common import check_accept_header_wrapper_flask, response_headers, \
-    generate_http_error_flask, ErrorHandlingMethodView
+from rucio.web.rest.flaskapi.v1.common import ErrorHandlingMethodView, check_accept_header_wrapper_flask, generate_http_error_flask, response_headers
 
 
 class Scope(ErrorHandlingMethodView):
 
     @check_accept_header_wrapper_flask(['application/json'])
     def get(self):
         """
```

### Comparing `rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/subscriptions.py` & `rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/subscriptions.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -14,22 +13,19 @@
 # limitations under the License.
 
 from json import dumps
 
 from flask import Flask, Response, request
 
 from rucio.api.rule import list_replication_rules
-from rucio.api.subscription import list_subscriptions, add_subscription, update_subscription, \
-    list_subscription_rule_states, get_subscription_by_id
-from rucio.common.exception import InvalidObject, SubscriptionDuplicate, SubscriptionNotFound, RuleNotFound, \
-    AccessDenied
-from rucio.common.utils import render_json, APIEncoder
+from rucio.api.subscription import add_subscription, get_subscription_by_id, list_subscription_rule_states, list_subscriptions, update_subscription
+from rucio.common.exception import AccessDenied, InvalidObject, RuleNotFound, SubscriptionDuplicate, SubscriptionNotFound
+from rucio.common.utils import APIEncoder, render_json
 from rucio.web.rest.flaskapi.authenticated_bp import AuthenticatedBlueprint
-from rucio.web.rest.flaskapi.v1.common import check_accept_header_wrapper_flask, try_stream, \
-    response_headers, generate_http_error_flask, ErrorHandlingMethodView, json_parameters, param_get
+from rucio.web.rest.flaskapi.v1.common import ErrorHandlingMethodView, check_accept_header_wrapper_flask, generate_http_error_flask, json_parameters, param_get, response_headers, try_stream
 
 
 class Subscription(ErrorHandlingMethodView):
     """ REST APIs for subscriptions. """
 
     @check_accept_header_wrapper_flask(['application/x-json-stream'])
     def get(self, account=None, name=None):
```

### Comparing `rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/templates/auth_crash.html` & `rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/templates/auth_crash.html`

 * *Files identical despite different names*

### Comparing `rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/templates/auth_granted.html` & `rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/templates/auth_granted.html`

 * *Files identical despite different names*

### Comparing `rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/traces.py` & `rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/traces.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -15,22 +14,23 @@
 
 
 import calendar
 import datetime
 import uuid
 from typing import TYPE_CHECKING
 
-from flask import Flask, Blueprint, request
+from flask import Blueprint, Flask, request
 from werkzeug.datastructures import Headers
 
 from rucio.core.trace import trace
-from rucio.web.rest.flaskapi.v1.common import response_headers, ErrorHandlingMethodView, json_parameters
+from rucio.web.rest.flaskapi.v1.common import ErrorHandlingMethodView, json_parameters, response_headers
 
 if TYPE_CHECKING:
     from typing import Optional
+
     from rucio.web.rest.flaskapi.v1.common import HeadersType
 
 
 class Trace(ErrorHandlingMethodView):
 
     def get_headers(self) -> "Optional[HeadersType]":
         headers = Headers()
```

### Comparing `rucio-34.0.0rc2/lib/rucio/web/rest/flaskapi/v1/vos.py` & `rucio-34.1.0/lib/rucio/web/rest/flaskapi/v1/vos.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,19 +11,18 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 from flask import Flask, request
 
 from rucio.api.vo import add_vo, list_vos, recover_vo_root_identity, update_vo
-from rucio.common.exception import AccessDenied, AccountNotFound, Duplicate, VONotFound, UnsupportedOperation
+from rucio.common.exception import AccessDenied, AccountNotFound, Duplicate, UnsupportedOperation, VONotFound
 from rucio.common.utils import render_json
 from rucio.web.rest.flaskapi.authenticated_bp import AuthenticatedBlueprint
-from rucio.web.rest.flaskapi.v1.common import response_headers, check_accept_header_wrapper_flask, \
-    try_stream, generate_http_error_flask, ErrorHandlingMethodView, json_parameters, param_get
+from rucio.web.rest.flaskapi.v1.common import ErrorHandlingMethodView, check_accept_header_wrapper_flask, generate_http_error_flask, json_parameters, param_get, response_headers, try_stream
 
 
 class VOs(ErrorHandlingMethodView):
     """ List all the VOs in the database. """
 
     @check_accept_header_wrapper_flask(['application/x-json-stream'])
     def get(self):
```

### Comparing `rucio-34.0.0rc2/lib/rucio/web/rest/main.py` & `rucio-34.1.0/lib/rucio/web/rest/main.py`

 * *Files 14% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/web/rest/metrics.py` & `rucio-34.1.0/lib/rucio/web/rest/metrics.py`

 * *Files 12% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio/web/rest/ping.py` & `rucio-34.1.0/lib/rucio/web/rest/ping.py`

 * *Files 9% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/lib/rucio.egg-info/SOURCES.txt` & `rucio-34.1.0/lib/rucio.egg-info/SOURCES.txt`

 * *Files identical despite different names*

### Comparing `rucio-34.0.0rc2/pylintrc` & `rucio-34.1.0/pylintrc`

 * *Files identical despite different names*

### Comparing `rucio-34.0.0rc2/requirements.txt` & `rucio-34.1.0/requirements.txt`

 * *Files identical despite different names*

### Comparing `rucio-34.0.0rc2/setup.py` & `rucio-34.1.0/setup.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -14,25 +13,25 @@
 # limitations under the License.
 
 import glob
 import os
 import shutil
 import sys
 
-from setuptools import setup, find_packages
+from setuptools import find_packages, setup
 
 if sys.version_info < (3, 9):
     print('ERROR: Rucio Server requires at least Python 3.9 to run.')
     sys.exit(1)
 
 try:
-    from setuputil import server_requirements_table, match_define_requirements, get_rucio_version
+    from setuputil import get_rucio_version, match_define_requirements, server_requirements_table
 except ImportError:
     sys.path.append(os.path.abspath(os.path.dirname(__file__)))
-    from setuputil import server_requirements_table, match_define_requirements, get_rucio_version
+    from setuputil import get_rucio_version, match_define_requirements, server_requirements_table
 
 install_requires, extras_require = match_define_requirements(server_requirements_table)
 
 name = 'rucio'
 packages = find_packages(where='lib')
 description = "Rucio Package"
 data_files = [
```

### Comparing `rucio-34.0.0rc2/setuputil.py` & `rucio-34.1.0/setuputil.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,16 +11,15 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import subprocess
 import sys
 
-from pkg_resources import safe_name, parse_requirements
-
+from pkg_resources import parse_requirements, safe_name
 
 clients_requirements_table = {
     'install_requires': [
         'requests',
         'urllib3',
         'dogpile.cache',
         'tabulate',
```

### Comparing `rucio-34.0.0rc2/tests/test_abacus_account.py` & `rucio-34.1.0/tests/test_abacus_account.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -24,15 +23,15 @@
 from rucio.daemons.judge import cleaner
 from rucio.daemons.reaper import reaper
 from rucio.db.sqla import models
 from rucio.db.sqla.session import get_session
 
 
 @pytest.mark.noparallel(reason='uses daemon, failing in parallel to other tests, updates account')
-class TestAbacusAccount2():
+class TestAbacusAccount2:
 
     def test_abacus_account(self, vo, root_account, mock_scope, rse_factory, did_factory, rucio_client):
         """ ABACUS (ACCOUNT): Test update of account usage """
         session = get_session()
         session.query(models.UpdatedAccountCounter).delete()  # pylint: disable=no-member
         session.query(models.AccountUsage).delete()  # pylint: disable=no-member
         session.commit()  # pylint: disable=no-member
```

### Comparing `rucio-34.0.0rc2/tests/test_abacus_collection_replica.py` & `rucio-34.1.0/tests/test_abacus_collection_replica.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -26,15 +25,15 @@
 from rucio.daemons.undertaker import undertaker
 from rucio.db.sqla import models, session
 from rucio.db.sqla.constants import DIDType, ReplicaState
 from rucio.tests.common import did_name_generator
 
 
 @pytest.mark.noparallel(reason='uses daemons, fails when run in parallel')
-class TestAbacusCollectionReplica():
+class TestAbacusCollectionReplica:
 
     def test_abacus_collection_replica_cleanup(self, vo, mock_scope, rse_factory, did_client, jdoe_account):
         """ ABACUS (COLLECTION REPLICA): Test if the cleanup procedure works correctly. """
         collection_replica.run(once=True)
         db_session = session.get_session()
         rse1, rse_id1 = rse_factory.make_rse()
         rse2, rse_id2 = rse_factory.make_rse()
```

### Comparing `rucio-34.0.0rc2/tests/test_abacus_rse.py` & `rucio-34.1.0/tests/test_abacus_rse.py`

 * *Files 6% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -21,15 +20,15 @@
 from rucio.daemons.judge import cleaner
 from rucio.daemons.reaper import reaper
 from rucio.db.sqla import models
 from rucio.db.sqla.session import get_session
 
 
 @pytest.mark.noparallel(reason='uses daemon, failing in parallel to other tests')
-class TestAbacusRSE():
+class TestAbacusRSE:
 
     def test_abacus_rse(self, vo, mock_scope, rse_factory, did_factory, rucio_client):
         """ ABACUS (RSE): Test update of RSE usage. """
         # Get RSE usage of all sources
         session = get_session()
         session.query(models.UpdatedRSECounter).delete()  # pylint: disable=no-member
         session.query(models.RSEUsage).delete()  # pylint: disable=no-member
```

### Comparing `rucio-34.0.0rc2/tests/test_account.py` & `rucio-34.1.0/tests/test_account.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -13,23 +12,23 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 from json import loads
 
 import pytest
 
-from rucio.api.account import add_account, account_exists, del_account, update_account, get_account_info
+from rucio.api.account import account_exists, add_account, del_account, get_account_info, update_account
 from rucio.common.config import config_get
 from rucio.common.exception import AccountNotFound, Duplicate, InvalidObject
 from rucio.common.types import InternalAccount
 from rucio.common.utils import generate_uuid as uuid
-from rucio.core.account import list_identities, add_account_attribute, list_account_attributes, del_account_attribute
+from rucio.core.account import add_account_attribute, del_account_attribute, list_account_attributes, list_identities
 from rucio.core.identity import add_account_identity, add_identity
 from rucio.db.sqla.constants import AccountStatus, IdentityType
-from rucio.tests.common import account_name_generator, headers, auth, vohdr, loginhdr, skip_non_belleii
+from rucio.tests.common import account_name_generator, auth, headers, loginhdr, skip_non_belleii, vohdr
 
 
 class TestAccountCoreApi:
 
     def test_create_and_check_for_user(self, vo):
         """ ACCOUNT (CORE): Test the creation, query, and deletion of an account """
         usr = account_name_generator()
```

### Comparing `rucio-34.0.0rc2/tests/test_account_limits.py` & `rucio-34.1.0/tests/test_account_limits.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -10,14 +9,15 @@
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import pytest
+
 from rucio.core import account_limit
 
 
 @pytest.fixture
 def account(random_account):
     yield random_account
```

### Comparing `rucio-34.0.0rc2/tests/test_api_external_representation.py` & `rucio-34.1.0/tests/test_api_external_representation.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -26,26 +25,25 @@
 from rucio.api.account import add_account, get_account_info, list_accounts
 from rucio.api.did import add_did, add_did_to_followed, attach_dids_to_dids, get_users_following_did, scope_list
 from rucio.api.exporter import export_data
 from rucio.api.identity import add_account_identity, list_accounts_for_identity
 from rucio.api.replica import add_replicas, get_did_from_pfns, list_replicas
 from rucio.api.request import get_request_by_did, list_requests, queue_requests
 from rucio.api.rule import add_replication_rule
-from rucio.api.scope import add_scope, list_scopes, get_scopes
-from rucio.api.subscription import add_subscription, list_subscriptions, list_subscription_rule_states, \
-    get_subscription_by_id
+from rucio.api.scope import add_scope, get_scopes, list_scopes
+from rucio.api.subscription import add_subscription, get_subscription_by_id, list_subscription_rule_states, list_subscriptions
 from rucio.common.config import config_get_bool
 from rucio.common.types import InternalScope
 from rucio.common.utils import api_update_return_dict, generate_uuid
 from rucio.core.vo import add_vo, vo_exists
 from rucio.daemons.abacus import rse as abacus_rse
 from rucio.daemons.judge import cleaner
 from rucio.daemons.reaper import reaper
 from rucio.db.sqla import constants
-from rucio.tests.common import rse_name_generator, did_name_generator
+from rucio.tests.common import did_name_generator, rse_name_generator
 
 
 @pytest.fixture(scope='class')
 def vo2():
     if config_get_bool('common', 'multi_vo', raise_exception=False, default=False):
         vo2 = 'new'
         if not vo_exists(vo=vo2):
@@ -438,15 +436,15 @@
         add_did(new_scope_name, did, 'DATASET', 'root', account=new_acc_name, rse=self.rse3_name, vo=test_vo)
 
         sub_id = add_subscription(sub, new_acc_name, {'account': [new_acc_name], 'scope': [new_scope_name]},
                                   [{'copies': 1, 'rse_expression': self.rse3_name, 'weight': 0, 'activity': 'Functional Test',
                                     'source_replica_expression': self.rse4_name}],
                                   '', False, 0, 0, 3, 'root', vo=test_vo)
         add_replication_rule(dids=[{'scope': new_scope_name, 'name': did}], copies=1, rse_expression=self.rse3_name, weight=None,
-                             lifetime=180, grouping='DATASET', account=new_acc_name, locked=False, subscription_id=sub_id,
+                             lifetime=None, grouping='DATASET', account=new_acc_name, locked=False, subscription_id=sub_id,
                              source_replica_expression=self.rse4_name, activity='Functional Test', notify=None,
                              purge_replicas=False, ignore_availability=False, comment='', ask_approval=False, asynchronous=False,
                              delay_injection=None, priority=0, split_container=False, meta='', issuer='root', vo=test_vo)
 
         out = list_subscriptions(sub, vo=test_vo)
         out = list(out)
         assert 0 != len(out)
```

### Comparing `rucio-34.0.0rc2/tests/test_archive.py` & `rucio-34.1.0/tests/test_archive.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -10,17 +9,17 @@
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 from rucio.common.utils import generate_uuid
+from rucio.core.did import attach_dids, get_metadata
 from rucio.core.replica import add_replicas, delete_replicas
 from rucio.core.rse import add_protocol, update_rse
-from rucio.core.did import attach_dids, get_metadata
 
 
 def test_add_and_list_archive(rse_factory, replica_client, did_client, mock_scope):
     """  ARCHIVE (CLIENT): Add files to archive and list the content """
     rse, _ = rse_factory.make_mock_rse()
     scope = mock_scope.external
     archive_files = ['file_' + generate_uuid() + '.zip' for _ in range(2)]
```

### Comparing `rucio-34.0.0rc2/tests/test_auditor.py` & `rucio-34.1.0/tests/test_auditor.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -14,16 +13,15 @@
 # limitations under the License.
 
 import bz2
 import collections
 import multiprocessing
 import os
 import tempfile
-from datetime import datetime
-from datetime import timedelta
+from datetime import datetime, timedelta
 from unittest import mock
 
 import pytest
 
 from rucio.daemons import auditor
 
 
@@ -105,15 +103,15 @@
     queue.put(('RSE_SHOULD_WORK', 1))
     queue.put(('RSE_WITH_ERROR', 1))
     wr_pipe = collections.namedtuple('FakePipe', ('send', 'close'))(
         lambda _: None,
         lambda: None,
     )
 
-    class MockMultiProcessing():
+    class MockMultiProcessing:
         def is_set(self):
             return queue.empty()
     terminate = MockMultiProcessing()
     auditor.check(queue, retry, terminate, wr_pipe, None, None, 3, False)
 
     assert queue.empty()
     assert retry.get() == ('RSE_WITH_EXCEPTION', 0)
```

### Comparing `rucio-34.0.0rc2/tests/test_auditor_hdfs.py` & `rucio-34.1.0/tests/test_auditor_hdfs.py`

 * *Files 5% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -19,15 +18,15 @@
 from unittest import mock
 
 import pytest
 
 from rucio.daemons.auditor import hdfs
 
 
-class FakeHDFSGet(object):
+class FakeHDFSGet:
     def __init__(self, files=[]):
         self.files = files
 
     def __call__(self, src_path, dst_dir):
         # src_path is ignored, it is assumed a directory is requested
         for content, name in self.files:
             with open(os.path.join(dst_dir, name), 'w') as fichier:
```

### Comparing `rucio-34.0.0rc2/tests/test_auditor_srmdumps.py` & `rucio-34.1.0/tests/test_auditor_srmdumps.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/tests/test_authentication.py` & `rucio-34.1.0/tests/test_authentication.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -10,29 +9,28 @@
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import base64
-
 import datetime
+import time
+
 import pytest
 from requests import session
-import time
 
-from rucio.api.authentication import get_auth_token_user_pass, get_auth_token_ssh, get_ssh_challenge_token, \
-    get_auth_token_saml
-from rucio.common.exception import Duplicate, AccessDenied, CannotAuthenticate
+from rucio.api.authentication import get_auth_token_saml, get_auth_token_ssh, get_auth_token_user_pass, get_ssh_challenge_token
+from rucio.common.exception import AccessDenied, CannotAuthenticate, Duplicate
 from rucio.common.utils import ssh_sign
-from rucio.core.identity import add_account_identity, del_account_identity
 from rucio.core.authentication import strip_x509_proxy_attributes
+from rucio.core.identity import add_account_identity, del_account_identity
 from rucio.db.sqla import models
 from rucio.db.sqla.constants import IdentityType
-from rucio.tests.common import headers, hdrdict, loginhdr, vohdr
+from rucio.tests.common import hdrdict, headers, loginhdr, vohdr
 
 PUBLIC_KEY = "ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEAq5LySllrQFpPL"\
              "614sulXQ7wnIr1aGhGtl8b+HCB/0FhMSMTHwSjX78UbfqEorZ"\
              "V16rXrWPgUpvcbp2hqctw6eCbxwqcgu3uGWaeS5A0iWRw7oXU"\
              "h6ydnVy89zGzX1FJFFDZ+AgiZ3ytp55tg1bjqqhK1OSC0pJxd"\
              "Ne878TRVVo5MLI0S/rZY2UovCSGFaQG2iLj14wz/YqI7NFMUu"\
              "JFR4e6xmNsOP7fCZ4bGMsmnhR0GmY0dWYTupNiP5WdYXAfKEx"\
```

### Comparing `rucio-34.0.0rc2/tests/test_automatix.py` & `rucio-34.1.0/tests/test_automatix.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -11,23 +10,23 @@
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import json
 import os
+import tempfile
 from random import choice
 from string import ascii_uppercase
-import tempfile
 
 import pytest
 
-from rucio.common.config import config_add_section, config_has_section, config_set, config_remove_option
+from rucio.common.config import config_add_section, config_has_section, config_remove_option, config_set
 from rucio.common.types import InternalScope
-from rucio.core.did import list_dids, list_files, get_metadata
+from rucio.core.did import get_metadata, list_dids, list_files
 from rucio.core.scope import add_scope
 from rucio.daemons.automatix.automatix import automatix
 from rucio.rse import rsemanager as rsemgr
 from rucio.tests.common import scope_name_generator
 
 
 @pytest.mark.noparallel(reason='changes global configuration value')
```

### Comparing `rucio-34.0.0rc2/tests/test_bad_replica.py` & `rucio-34.1.0/tests/test_bad_replica.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -14,27 +13,25 @@
 # limitations under the License.
 
 from datetime import datetime, timedelta
 from json import dumps, loads
 
 import pytest
 
-from rucio.common.exception import RucioException, UnsupportedOperation, InvalidType
-from rucio.common.utils import generate_uuid, clean_surls
-from rucio.core.did import delete_dids
-from rucio.core.replica import (add_replicas, get_replicas_state, list_replicas,
-                                declare_bad_file_replicas, list_bad_replicas, get_bad_pfns,
-                                get_bad_replicas_backlog, list_bad_replicas_status, get_pfn_to_rse)
 from rucio.client.rseclient import RSEClient
+from rucio.common.exception import InvalidType, RucioException, UnsupportedOperation
+from rucio.common.utils import clean_surls, generate_uuid
+from rucio.core.did import delete_dids
+from rucio.core.replica import add_replicas, declare_bad_file_replicas, get_bad_pfns, get_bad_replicas_backlog, get_pfn_to_rse, get_replicas_state, list_bad_replicas, list_bad_replicas_status, list_replicas
 from rucio.daemons.badreplicas.minos import run as minos_run
 from rucio.daemons.badreplicas.minos_temporary_expiration import run as minos_temp_run
-from rucio.daemons.badreplicas.necromancer import run as necromancer_run
 from rucio.daemons.badreplicas.necromancer import REGION
-from rucio.db.sqla.constants import DIDType, ReplicaState, BadPFNStatus, BadFilesStatus
-from rucio.tests.common import headers, auth
+from rucio.daemons.badreplicas.necromancer import run as necromancer_run
+from rucio.db.sqla.constants import BadFilesStatus, BadPFNStatus, DIDType, ReplicaState
+from rucio.tests.common import auth, headers
 
 
 @pytest.fixture
 def rse_client():
     return RSEClient()
 
 
@@ -246,15 +243,15 @@
         for badrep in bad_replicas:
             if badrep['rse_id'] == rse3_id:
                 if badrep['scope'].external == rep['scope'] and badrep['name'] == rep['name']:
                     nbbadrep += 1
     assert len(replicas) == nbbadrep
 
     list_rep.extend(['srm://%s.cern.ch/test_%s/%s/%s' % (rse2_id, rse2_id, tmp_scope, generate_uuid()), ])
-    with pytest.raises(InvalidType):    
+    with pytest.raises(InvalidType):
         # this should fail becase the replica list will now contain a mix of PFNs and dictionaries
         replica_client.declare_bad_file_replicas(list_rep, 'This is a good reason')
 
 
 def test_client_add_suspicious_replicas(rse_factory, replica_client):
     """ REPLICA (CLIENT): Add suspicious replicas"""
     tmp_scope = 'mock'
```

### Comparing `rucio-34.0.0rc2/tests/test_bb8.py` & `rucio-34.1.0/tests/test_bb8.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -15,27 +14,28 @@
 
 from datetime import datetime, timedelta
 
 import pytest
 
 from rucio.common.exception import RuleNotFound, UnsupportedOperation
 from rucio.core.account_limit import set_local_account_limit
-from rucio.core.did import attach_dids, set_status, set_metadata
+from rucio.core.did import attach_dids, set_metadata, set_status
 from rucio.core.lock import successful_transfer
 from rucio.core.replica import add_replicas
 from rucio.core.rse import add_rse_attribute, fill_rse_expired, get_rse_usage, set_rse_usage
-from rucio.core.rule import add_rule, get_rule, delete_rule, update_rule
 from rucio.core.rse_expression_parser import REGION
+from rucio.core.rule import add_rule, delete_rule, get_rule, update_rule
 from rucio.daemons.abacus.rse import run as run_abacus
-from rucio.daemons.bb8.common import rebalance_rule
 from rucio.daemons.bb8.bb8 import run as bb8_run
+from rucio.daemons.bb8.common import rebalance_rule
 from rucio.daemons.judge.cleaner import rule_cleaner
 from rucio.daemons.judge.evaluator import re_evaluator
 from rucio.daemons.undertaker import undertaker
 from rucio.db.sqla.constants import RuleState
+
 from .test_rule import create_files, tag_generator
 
 
 @pytest.mark.noparallel(reason='uses daemons')
 def test_bb8_rebalance_rule(vo, root_account, jdoe_account, rse_factory, mock_scope, did_factory):
     """BB8: Test the rebalance rule method"""
     rse1, rse1_id = rse_factory.make_posix_rse()
@@ -155,18 +155,18 @@
     nb_files3 = 3
     nb_files4 = 2
     file_size = 1 * base_unit
     rule_to_rebalance = None
 
     # Add one secondary file
     files = create_files(1, mock_scope, rse1_id, bytes_=1)
-    add_rule(dids=[{'scope': mock_scope, 'name': files[0]['name']}], account=jdoe_account, copies=1, rse_expression=rse1, grouping='DATASET', weight=None, lifetime=-86400, locked=False, subscription_id=None)[0]
+    add_rule(dids=[{'scope': mock_scope, 'name': files[0]['name']}], account=jdoe_account, copies=1, rse_expression=rse1, grouping='DATASET', weight=None, lifetime=-1, locked=False, subscription_id=None)[0]
     for cnt in range(3, tot_rses):
         add_replicas(rses[cnt][1], files, jdoe_account)
-        add_rule(dids=[{'scope': mock_scope, 'name': files[0]['name']}], account=jdoe_account, copies=1, rse_expression=rses[cnt][0], grouping='DATASET', weight=None, lifetime=-86400, locked=False, subscription_id=None)[0]
+        add_rule(dids=[{'scope': mock_scope, 'name': files[0]['name']}], account=jdoe_account, copies=1, rse_expression=rses[cnt][0], grouping='DATASET', weight=None, lifetime=-1, locked=False, subscription_id=None)[0]
     rule_cleaner(once=True)
 
     # Create dataset 1 of 800 GB and create a rule on RSE 1 and RSE 3
     files = create_files(nb_files1, mock_scope, rse1_id, bytes_=file_size)
     attach_dids(mock_scope, dsn[0], files, jdoe_account)
 
     rule_id = add_rule(dids=[{'scope': mock_scope, 'name': dsn[0]}], account=jdoe_account, copies=1, rse_expression=rse1, grouping='DATASET', weight=None, lifetime=None, locked=False, subscription_id=None)[0]
@@ -192,30 +192,30 @@
     attach_dids(mock_scope, dsn[2], files, jdoe_account)
 
     rule_id = add_rule(dids=[{'scope': mock_scope, 'name': dsn[2]}], account=jdoe_account, copies=1, rse_expression=rse1, grouping='DATASET', weight=None, lifetime=None, locked=False, subscription_id=None)[0]
     rule_to_rebalance = rule_id
     rules.append(rule_id)
 
     add_replicas(rse3_id, files, jdoe_account)
-    rule_id = add_rule(dids=[{'scope': mock_scope, 'name': dsn[2]}], account=jdoe_account, copies=1, rse_expression=rse3, grouping='DATASET', weight=None, lifetime=-86400, locked=False, subscription_id=None)[0]
+    rule_id = add_rule(dids=[{'scope': mock_scope, 'name': dsn[2]}], account=jdoe_account, copies=1, rse_expression=rse3, grouping='DATASET', weight=None, lifetime=-1, locked=False, subscription_id=None)[0]
     rule_cleaner(once=True)
     try:
         rule = get_rule(rule_id)
     except:
         pytest.raises(RuleNotFound, get_rule, rule_id)
 
     # Create dataset 4 of 200 GB and create a rule on RSE 3. The copy on RSE 2 is secondary
     files = create_files(nb_files4, mock_scope, rse3_id, bytes_=file_size)
     attach_dids(mock_scope, dsn[3], files, jdoe_account)
 
     rule_id = add_rule(dids=[{'scope': mock_scope, 'name': dsn[3]}], account=jdoe_account, copies=1, rse_expression=rse3, grouping='DATASET', weight=None, lifetime=None, locked=False, subscription_id=None)[0]
     rules.append(rule_id)
 
     add_replicas(rse2_id, files, jdoe_account)
-    rule_id = add_rule(dids=[{'scope': mock_scope, 'name': dsn[3]}], account=jdoe_account, copies=1, rse_expression=rse2, grouping='DATASET', weight=None, lifetime=-86400, locked=False, subscription_id=None)[0]
+    rule_id = add_rule(dids=[{'scope': mock_scope, 'name': dsn[3]}], account=jdoe_account, copies=1, rse_expression=rse2, grouping='DATASET', weight=None, lifetime=-1, locked=False, subscription_id=None)[0]
     rule_cleaner(once=True)
     try:
         rule = get_rule(rule_id)
     except:
         pytest.raises(RuleNotFound, get_rule, rule_id)
 
     for dataset in dsn:
@@ -258,13 +258,13 @@
         else:
             assert (rule['child_rule_id'] is not None)
             assert (rule['expires_at'] <= datetime.utcnow() + timedelta(seconds=1))  # timedelta needed to prevent failure due to rounding effects
             child_rule_id = rule['child_rule_id']
             child_rule = get_rule(child_rule_id)
             assert (child_rule['rse_expression'] == rse2)
             # For teardown, delete child rule
-            update_rule(child_rule_id, {'lifetime': -86400})
+            update_rule(child_rule_id, {'lifetime': -1})
     rule_cleaner(once=True)
 
     for dataset in dsn:
         set_metadata(mock_scope, dataset, 'lifetime', -86400)
     undertaker.run(once=True)
```

### Comparing `rucio-34.0.0rc2/tests/test_belleii.py` & `rucio-34.1.0/tests/test_belleii.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -15,15 +14,15 @@
 
 from datetime import datetime
 
 import pytest
 
 from rucio.common.exception import InvalidObject
 from rucio.common.schema.belleii import validate_schema
-from rucio.common.utils import generate_uuid, extract_scope
+from rucio.common.utils import extract_scope, generate_uuid
 from rucio.core.config import set as config_set
 from rucio.tests.common import did_name_generator, skip_non_belleii
 
 
 @skip_non_belleii
 def test_dirac_addfile(rse_factory, did_factory, root_account, did_client, dirac_client, rse_client, replica_client):
     """ DIRAC (CLIENT): Test the functionality of the addfile method """
@@ -102,15 +101,15 @@
     dataset_meta = {'project': 'data13_hip', 'run_number': 300000, 'mykey': 'myvalue'}
     container_meta = {'containerkey': 'containervalue'}
     parents_metadata = {dataset: dataset_meta, container: container_meta}
     dirac_client.add_files(lfns=lfns, ignore_availability=False, parents_metadata=parents_metadata)
     replicas = [rep for rep in replica_client.list_replicas(dids=files)]
     for replica in replicas:
         assert {'scope': replica['scope'], 'name': replica['name'], 'rse': list(replica['rses'].keys())[0]} in reps
-    
+
     # check if metadata if properly created for file and parents
     for lfn in lfns:
         scope, name = extract_scope(lfn['lfn'], [])
         metadata = did_client.get_metadata(scope, name, plugin='ALL')
         assert all(item in metadata.items() for item in lfn_meta.items())
         dsn_scope, dsn_name = extract_scope(dataset, [])
         metadata = did_client.get_metadata(dsn_scope, dsn_name, plugin='ALL')
```

### Comparing `rucio-34.0.0rc2/tests/test_bin_rucio.py` & `rucio-34.1.0/tests/test_bin_rucio.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -14,30 +13,30 @@
 # limitations under the License.
 
 import os
 import random
 import re
 import tempfile
 from datetime import datetime, timedelta
-from os import remove, unlink, listdir, rmdir, stat, path, environ
+from os import environ, listdir, path, remove, rmdir, stat, unlink
 
 import pytest
 
 from rucio.client.accountlimitclient import AccountLimitClient
+from rucio.client.configclient import ConfigClient
 from rucio.client.didclient import DIDClient
+from rucio.client.lifetimeclient import LifetimeClient
 from rucio.client.replicaclient import ReplicaClient
 from rucio.client.rseclient import RSEClient
 from rucio.client.ruleclient import RuleClient
-from rucio.client.configclient import ConfigClient
-from rucio.client.lifetimeclient import LifetimeClient
 from rucio.common.config import config_get, config_get_bool
-from rucio.common.types import InternalScope, InternalAccount
+from rucio.common.types import InternalAccount, InternalScope
 from rucio.common.utils import generate_uuid, get_tmp_dir, md5, render_json
 from rucio.rse import rsemanager as rsemgr
-from rucio.tests.common import execute, account_name_generator, rse_name_generator, file_generator, scope_name_generator, get_long_vo
+from rucio.tests.common import account_name_generator, execute, file_generator, get_long_vo, rse_name_generator, scope_name_generator
 
 
 class TestBinRucio:
 
     def conf_vo(self):
         self.vo = {}
         if config_get_bool('common', 'multi_vo', raise_exception=False, default=False):
@@ -358,15 +357,15 @@
         assert upload_string_1 in out or upload_string_1 in err
         assert upload_string_2 in out or upload_string_2 in err
         assert upload_string_3 in out or upload_string_3 in err
 
         # removing replica -> file on RSE should be overwritten
         # (simulating an upload error, where a part of the file is uploaded but the replica is not registered)
         if 'SUITE' not in environ or environ['SUITE'] != 'client':
-            from rucio.db.sqla import session, models
+            from rucio.db.sqla import models, session
             db_session = session.get_session()
             internal_scope = InternalScope(self.user, **self.vo)
             db_session.query(models.RSEFileAssociation).filter_by(name=tmp_file1_name, scope=internal_scope).delete()
             db_session.query(models.ReplicaLock).filter_by(name=tmp_file1_name, scope=internal_scope).delete()
             db_session.query(models.ReplicationRule).filter_by(name=tmp_file1_name, scope=internal_scope).delete()
             db_session.query(models.DidMeta).filter_by(name=tmp_file1_name, scope=internal_scope).delete()
             db_session.query(models.DataIdentifier).filter_by(name=tmp_file1_name, scope=internal_scope).delete()
@@ -681,19 +680,23 @@
         # add files
         cmd = 'rucio upload --rse {0} --scope {1} {2}'.format(self.def_rse, self.user, tmp_file1)
         print(self.marker + cmd)
         exitcode, out, err = execute(cmd)
         print(out, err)
 
         # download files
+        download_dir = "/temp"
         replica_pfn = list(self.replica_client.list_replicas([{'scope': self.user, 'name': name}]))[0]['rses'][self.def_rse][0]
-        cmd = 'rucio -v download --rse {0} --pfn {1} {2}:{3}'.format(self.def_rse, replica_pfn, self.user, name)
+        cmd = f'rucio -v download  --dir {download_dir} --rse {self.def_rse} --pfn {replica_pfn} {self.user}:{name}'
         exitcode, out, err = execute(cmd)
-        print(out, err)
-        assert re.search('Total files.*1', out) is not None
+
+        if "Access to local destination denied." in err:  # Known issue - see #6506
+            assert False, "test `test_download_pfn` unable to access file {self.user}/{name} in {download_dir}"
+        else:
+            assert re.search('Total files.*1', out) is not None
 
         try:
             for i in listdir('data13_hip'):
                 unlink('data13_hip/%s' % i)
             rmdir('data13_hip')
         except Exception:
             pass
@@ -1828,17 +1831,17 @@
         self.account_client.set_local_account_limit(account, rse, -1)
         self.account_client.set_global_account_limit(account, rse_exp, -1)
 
     @pytest.mark.noparallel(reason='modifies account limit on pre-defined RSE')
     @pytest.mark.skipif('SUITE' in os.environ and os.environ['SUITE'] == 'client', reason='uses abacus daemon and core functions')
     def test_list_account_usage(self):
         """ CLIENT (USER): list account usage. """
-        from rucio.db.sqla import session, models
         from rucio.core.account_counter import increase
         from rucio.daemons.abacus import account as abacus_account
+        from rucio.db.sqla import models, session
 
         db_session = session.get_session()
         db_session.query(models.AccountUsage).delete()
         db_session.query(models.AccountLimit).delete()
         db_session.query(models.AccountGlobalLimit).delete()
         db_session.query(models.UpdatedAccountCounter).delete()
         db_session.commit()
```

### Comparing `rucio-34.0.0rc2/tests/test_boolean.py` & `rucio-34.1.0/tests/test_boolean.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/tests/test_clients.py` & `rucio-34.1.0/tests/test_clients.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -10,22 +9,21 @@
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 from datetime import datetime, timedelta
-
 from os import rename
 
 import pytest
 
 from rucio.client.baseclient import BaseClient
 from rucio.client.client import Client
-from rucio.common.config import config_get, config_set, Config
+from rucio.common.config import Config, config_get, config_set
 from rucio.common.exception import CannotAuthenticate, ClientProtocolNotSupported, RucioException
 from rucio.common.utils import execute
 from tests.mocks.mock_http_server import MockServer
 
 
 @pytest.fixture
 def client_token_path_override(file_config_mock, function_scope_prefix, tmp_path):
```

### Comparing `rucio-34.0.0rc2/tests/test_common_types.py` & `rucio-34.1.0/tests/test_common_types.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,23 +1,22 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-from rucio.common.types import InternalScope, InternalAccount, InternalType
+from rucio.common.types import InternalAccount, InternalScope, InternalType
 
 
 class TestInternalType:
     """ Test the base InternalType class """
 
     def test_equality(self, vo):
         """ INTERNAL TYPES: Equality """
```

### Comparing `rucio-34.0.0rc2/tests/test_config.py` & `rucio-34.1.0/tests/test_config.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/tests/test_conveyor.py` & `rucio-34.1.0/tests/test_conveyor.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -14,48 +13,49 @@
 # limitations under the License.
 import logging
 import threading
 import time
 from datetime import datetime, timedelta
 from tempfile import TemporaryDirectory
 from unittest.mock import patch
-from urllib.parse import urlencode, urlparse, parse_qsl, urlunparse
-from sqlalchemy import update
+from urllib.parse import parse_qsl, urlencode, urlparse, urlunparse
 
 import pytest
+from sqlalchemy import update
 
 import rucio.daemons.reaper.reaper
-from rucio.common.types import InternalAccount
-from rucio.common.utils import generate_uuid, adler32
 from rucio.common.exception import ReplicaNotFound, RequestNotFound
+from rucio.common.types import InternalAccount
+from rucio.common.utils import adler32, generate_uuid
 from rucio.core import config as core_config
 from rucio.core import did as did_core
 from rucio.core import distance as distance_core
 from rucio.core import lock as lock_core
 from rucio.core import message as message_core
 from rucio.core import replica as replica_core
 from rucio.core import request as request_core
 from rucio.core import rse as rse_core
 from rucio.core import rule as rule_core
 from rucio.core.account_limit import set_local_account_limit
 from rucio.daemons.conveyor.finisher import finisher
 from rucio.daemons.conveyor.poller import poller
 from rucio.daemons.conveyor.preparer import preparer
-from rucio.daemons.conveyor.submitter import submitter
+from rucio.daemons.conveyor.receiver import GRACEFUL_STOP as receiver_graceful_stop
+from rucio.daemons.conveyor.receiver import Receiver, receiver
 from rucio.daemons.conveyor.stager import stager
+from rucio.daemons.conveyor.submitter import submitter
 from rucio.daemons.conveyor.throttler import throttler
-from rucio.daemons.conveyor.receiver import receiver, GRACEFUL_STOP as receiver_graceful_stop, Receiver
 from rucio.daemons.reaper.reaper import reaper
 from rucio.db.sqla import models
-from rucio.db.sqla.constants import LockState, RequestState, RequestType, ReplicaState, RSEType, RuleState
+from rucio.db.sqla.constants import LockState, ReplicaState, RequestState, RequestType, RSEType, RuleState
 from rucio.db.sqla.session import read_session, transactional_session
 from rucio.tests.common import skip_rse_tests_with_accounts
 from rucio.transfertool.fts3 import FTS3Transfertool
-from tests.ruciopytest import NoParallelGroups
 from tests.mocks.mock_http_server import MockServer
+from tests.ruciopytest import NoParallelGroups
 
 MAX_POLL_WAIT_SECONDS = 100
 TEST_FTS_HOST = 'https://fts:8446'
 
 
 @transactional_session
 def __update_request(request_id, *, session=None, **kwargs):
@@ -125,17 +125,18 @@
         .filter(models.Source.rse_id == src_rse_id) \
         .first()
 
 
 @pytest.fixture
 def scitags_mock(core_config_mock):
     """Run a mock http server which always returns the content of scitags.json from test/inputs"""
-    from tests.inputs import SCITAGS_JSON
     from pathlib import Path
 
+    from tests.inputs import SCITAGS_JSON
+
     class _SendScitagsJson(MockServer.Handler):
         def do_GET(self):
             file_content = Path(SCITAGS_JSON).read_text()
             self.send_code_and_message(200, {'Content-Type': 'application/json'}, file_content)
 
     with MockServer(_SendScitagsJson) as mock_server:
         core_config.set('packet-marking', 'enabled', True)
@@ -171,23 +172,23 @@
     dst_rse_name = 'XRD4'
     dst_rse_id = rse_core.get_rse_id(rse=dst_rse_name, vo=vo)
 
     all_rses = [src_rse1_id, src_rse2_id, jump_rse_id, dst_rse_id]
     did = did_factory.upload_test_file(src_rse1_name)
 
     # Copy replica to a second source. To avoid the special case of having a unique last replica, which could be handled in a special (more careful) way
-    rule_core.add_rule(dids=[did], account=root_account, copies=1, rse_expression=src_rse2_name, grouping='ALL', weight=None, lifetime=3600, locked=False, subscription_id=None)
+    rule_core.add_rule(dids=[did], account=root_account, copies=1, rse_expression=src_rse2_name, grouping='ALL', weight=None, lifetime=None, locked=False, subscription_id=None)
     submitter(once=True, rses=[{'id': rse_id} for rse_id in all_rses], partition_wait_time=0, transfertype='single', filter_transfertool=None)
     replica = __wait_for_replica_transfer(dst_rse_id=src_rse2_id, **did)
     assert replica['state'] == ReplicaState.AVAILABLE
 
     rse_core.set_rse_limits(rse_id=jump_rse_id, name='MinFreeSpace', value=1)
     rse_core.set_rse_usage(rse_id=jump_rse_id, source='storage', used=1, free=0)
     try:
-        rule_core.add_rule(dids=[did], account=root_account, copies=1, rse_expression=dst_rse_name, grouping='ALL', weight=None, lifetime=3600, locked=False, subscription_id=None)
+        rule_core.add_rule(dids=[did], account=root_account, copies=1, rse_expression=dst_rse_name, grouping='ALL', weight=None, lifetime=None, locked=False, subscription_id=None)
 
         # Submit transfers to FTS
         # Ensure a replica was created on the intermediary host with epoch tombstone
         submitter(once=True, rses=[{'id': rse_id} for rse_id in all_rses], partition_wait_time=0, transfertype='single', filter_transfertool=None)
         request = request_core.get_request_by_did(rse_id=jump_rse_id, **did)
         assert request['state'] == RequestState.SUBMITTED
         replica = replica_core.get_replica(rse_id=jump_rse_id, **did)
@@ -570,15 +571,15 @@
         dst_rse = 'XRD4'
         dst_rse_id = rse_core.get_rse_id(rse=dst_rse, vo=vo)
 
         all_rses = [src_rse_id, jump_rse_id, dst_rse_id]
 
         did = did_factory.upload_test_file(src_rse)
         rule_priority = 5
-        rule_core.add_rule(dids=[did], account=root_account, copies=1, rse_expression=dst_rse, grouping='ALL', weight=None, lifetime=3600, locked=False, subscription_id=None, priority=rule_priority)
+        rule_core.add_rule(dids=[did], account=root_account, copies=1, rse_expression=dst_rse, grouping='ALL', weight=None, lifetime=None, locked=False, subscription_id=None, priority=rule_priority)
         submitter(once=True, rses=[{'id': rse_id} for rse_id in all_rses], group_bulk=2, partition_wait_time=0, transfertype='single', filter_transfertool=None)
 
         request = __wait_for_state_transition(dst_rse_id=jump_rse_id, run_poller=False, **did)
         assert request['state'] == RequestState.DONE
         request = __wait_for_state_transition(dst_rse_id=dst_rse_id, run_poller=False, **did)
         assert request['state'] == RequestState.DONE
 
@@ -682,16 +683,16 @@
     distance_core.add_distance(src_rse_id, dst_rse_id1, distance=10)
     distance_core.add_distance(src_rse_id, dst_rse_id2, distance=10)
     # Set limits only for one of the RSEs
     request_core.set_transfer_limit(dst_rse1, max_transfers=1, activity='all_activities', strategy='fifo')
 
     did1 = did_factory.upload_test_file(src_rse)
     did2 = did_factory.upload_test_file(src_rse)
-    rule_core.add_rule(dids=[did1], account=root_account, copies=1, rse_expression=dst_rse1, grouping='ALL', weight=None, lifetime=3600, locked=False, subscription_id=None)
-    rule_core.add_rule(dids=[did2], account=root_account, copies=1, rse_expression=dst_rse1, grouping='ALL', weight=None, lifetime=3600, locked=False, subscription_id=None)
+    rule_core.add_rule(dids=[did1], account=root_account, copies=1, rse_expression=dst_rse1, grouping='ALL', weight=None, lifetime=None, locked=False, subscription_id=None)
+    rule_core.add_rule(dids=[did2], account=root_account, copies=1, rse_expression=dst_rse1, grouping='ALL', weight=None, lifetime=None, locked=False, subscription_id=None)
     rule_core.add_rule(dids=[did1], account=root_account, copies=1, rse_expression=dst_rse2, grouping='ALL', weight=None, lifetime=None, locked=False, subscription_id=None)
 
     request = request_core.get_request_by_did(rse_id=dst_rse_id1, **did1)
     assert request['state'] == RequestState.PREPARING
     request = request_core.get_request_by_did(rse_id=dst_rse_id1, **did2)
     assert request['state'] == RequestState.PREPARING
     request = request_core.get_request_by_did(rse_id=dst_rse_id2, **did1)
@@ -752,17 +753,17 @@
     assert request['state'] == RequestState.QUEUED
 
     # Check that resetting stale waiting requests works properly
     request_core.set_transfer_limit(dst_rse2, max_transfers=1, activity='all_activities', strategy='fifo')
     did3 = did_factory.upload_test_file(src_rse)
     did4 = did_factory.upload_test_file(src_rse)
     rule_core.add_rule(dids=[did3], account=root_account, copies=1, rse_expression=dst_rse2, grouping='ALL',
-                       weight=None, lifetime=3600, locked=False, subscription_id=None)
+                       weight=None, lifetime=None, locked=False, subscription_id=None)
     rule_core.add_rule(dids=[did4], account=root_account, copies=1, rse_expression=dst_rse2, grouping='ALL',
-                       weight=None, lifetime=3600, locked=False, subscription_id=None)
+                       weight=None, lifetime=None, locked=False, subscription_id=None)
     request3 = request_core.get_request_by_did(rse_id=dst_rse_id2, **did3)
     request4 = request_core.get_request_by_did(rse_id=dst_rse_id2, **did4)
     assert request3['state'] == RequestState.PREPARING
     assert request4['state'] == RequestState.PREPARING
 
     # Run the preparer so requests are in waiting state
     preparer(once=True, sleep_time=1, bulk=100, partition_wait_time=0, ignore_availability=False)
@@ -886,15 +887,15 @@
 
     distance_core.add_distance(src_rse_id, dst_rse_id, distance=10)
     rse_core.add_rse_attribute(dst_rse_id, 'staging_required', True)
     rse_core.add_rse_attribute(dst_rse_id, 'maximum_pin_lifetime', maximum_pin_lifetime)
 
     did = did_factory.upload_test_file(rse_name=src_rse)
 
-    rule1_id = rule_core.add_rule(dids=[did], account=root_account, copies=1, rse_expression=dst_rse, grouping='ALL', weight=None, lifetime=-1, locked=False, subscription_id=None)[0]
+    rule1_id = rule_core.add_rule(dids=[did], account=root_account, copies=1, rse_expression=dst_rse, grouping='ALL', weight=None, lifetime=None, locked=False, subscription_id=None)[0]
     request = request_core.get_request_by_did(rse_id=dst_rse_id, **did)
 
     assert request['request_type'] == RequestType.TRANSFER
 
     submitter(once=True, rses=[{'id': dst_rse_id}], partition_wait_time=0, transfertools=['mock'], transfertype='single', filter_transfertool=None)
 
     assert lock_core.get_replica_locks_for_rule_id(rule_id=rule1_id)[0]['state'] == LockState.REPLICATING
@@ -907,15 +908,15 @@
 
     # assert all replicas available
     for rse_id in all_rses:
         assert replica_core.get_replica(rse_id=rse_id, **did)['state'] == ReplicaState.AVAILABLE
 
     # now test a second rule, different account
     set_local_account_limit(jdoe_account, dst_rse_id, bytes_=-1)
-    rule2_id = rule_core.add_rule(dids=[did], account=jdoe_account, copies=1, rse_expression=dst_rse, grouping='ALL', weight=None, lifetime=-1, locked=False, subscription_id=None, source_replica_expression=dst_rse)[0]
+    rule2_id = rule_core.add_rule(dids=[did], account=jdoe_account, copies=1, rse_expression=dst_rse, grouping='ALL', weight=None, lifetime=None, locked=False, subscription_id=None, source_replica_expression=dst_rse)[0]
     request = request_core.get_request_by_did(rse_id=dst_rse_id, **did)
 
     assert request['request_type'] == RequestType.STAGEIN
 
     stager(once=True, rses=[{'id': dst_rse_id}])
 
     assert request['attributes']['lifetime'] == str(maximum_pin_lifetime)
@@ -947,15 +948,15 @@
 
     distance_core.add_distance(src_rse_id, dst_rse_id, distance=10)
     rse_core.add_rse_attribute(dst_rse_id, 'staging_required', True)
     rse_core.add_rse_attribute(dst_rse_id, 'maximum_pin_lifetime', maximum_pin_lifetime)
 
     did = did_factory.upload_test_file(rse_name=src_rse)
 
-    rule1_id = rule_core.add_rule(dids=[did], account=root_account, copies=1, rse_expression=dst_rse, grouping='ALL', weight=None, lifetime=-1, locked=False, subscription_id=None)[0]
+    rule1_id = rule_core.add_rule(dids=[did], account=root_account, copies=1, rse_expression=dst_rse, grouping='ALL', weight=None, lifetime=None, locked=False, subscription_id=None)[0]
     request = request_core.get_request_by_did(rse_id=dst_rse_id, **did)
 
     assert request['request_type'] == RequestType.TRANSFER
 
     submitter(once=True, rses=[{'id': dst_rse_id}], partition_wait_time=0, transfertools=['mock'], transfertype='single', filter_transfertool=None)
 
     assert lock_core.get_replica_locks_for_rule_id(rule_id=rule1_id)[0]['state'] == LockState.REPLICATING
@@ -968,15 +969,15 @@
     lock_core.failed_transfer(scope=did['scope'], name=did['name'], rse_id=dst_rse_id)
 
     assert rule_core.get_rule(rule1_id)['state'] == RuleState.STUCK
     assert lock_core.get_replica_locks_for_rule_id(rule_id=rule1_id)[0]['state'] == LockState.STUCK
 
     # now test a second rule, different account
     set_local_account_limit(jdoe_account, dst_rse_id, bytes_=-1)
-    rule2_id = rule_core.add_rule(dids=[did], account=jdoe_account, copies=1, rse_expression=dst_rse, grouping='ALL', weight=None, lifetime=-1, locked=False, subscription_id=None, source_replica_expression=dst_rse)[0]
+    rule2_id = rule_core.add_rule(dids=[did], account=jdoe_account, copies=1, rse_expression=dst_rse, grouping='ALL', weight=None, lifetime=None, locked=False, subscription_id=None, source_replica_expression=dst_rse)[0]
     request = request_core.get_request_by_did(rse_id=dst_rse_id, **did)
 
     # since the first rule is STUCK assert a transfer not stagein
     assert request['request_type'] == RequestType.TRANSFER
 
     submitter(once=True, rses=[{'id': dst_rse_id}], partition_wait_time=0, transfertools=['mock'], transfertype='single', filter_transfertool=None)
```

### Comparing `rucio-34.0.0rc2/tests/test_conveyor_submitter.py` & `rucio-34.1.0/tests/test_conveyor_submitter.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,41 +1,40 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-import pytest
-
 import itertools
 from datetime import datetime, timedelta
 from random import randint
 from unittest.mock import patch
+
+import pytest
 from sqlalchemy import delete
 
 from rucio.common.exception import RequestNotFound
+from rucio.core import config as core_config
 from rucio.core import distance as distance_core
+from rucio.core import replica as replica_core
 from rucio.core import request as request_core
 from rucio.core import rse as rse_core
-from rucio.core import replica as replica_core
 from rucio.core import rule as rule_core
-from rucio.core import config as core_config
 from rucio.daemons.conveyor.submitter import submitter
 from rucio.daemons.reaper.reaper import reaper
-from rucio.db.sqla.models import Request, Source
 from rucio.db.sqla.constants import RequestState
+from rucio.db.sqla.models import Request, Source
 from rucio.db.sqla.session import read_session, transactional_session
 from tests.ruciopytest import NoParallelGroups
 
 
 @pytest.mark.noparallel(groups=[NoParallelGroups.SUBMITTER])
 def test_request_submitted_in_order(rse_factory, did_factory, root_account):
 
@@ -91,14 +90,35 @@
         assert request_core.get_request(request_id=request['id'])['state'] == RequestState.SUBMITTED
 
     # Requests must be submitted in the order of their creation
     assert requests_id_in_submission_order == [r['id'] for r in requests]
 
 
 @pytest.mark.noparallel(groups=[NoParallelGroups.SUBMITTER])
+def test_skip_requests_from_expired_rules(rse_factory, did_factory, root_account):
+    src_rse_name, src_rse_id = rse_factory.make_posix_rse()
+    dst_rse_name, dst_rse_id = rse_factory.make_posix_rse()
+    distance_core.add_distance(src_rse_id, dst_rse_id, distance=10)
+
+    did = did_factory.upload_test_file(rse_name=src_rse_name)
+    rule = rule_core.add_rule(dids=[did], account=root_account, copies=1,
+                              rse_expression=dst_rse_name, grouping='ALL',
+                              weight=None, lifetime=-1, locked=False,
+                              subscription_id=None)[0]
+    request = request_core.get_request_by_did(rse_id=dst_rse_id, **did)
+    assert request_core.get_request(request_id=request['id'])['state'] == RequestState.QUEUED
+
+    submitter(once=True,
+              rses=[{'id': rse_id} for rse_id in (src_rse_id, dst_rse_id)],
+              partition_wait_time=None, transfertools=['mock'],
+              transfertype='single', filter_transfertool=None)
+    assert request_core.get_request(request_id=request['id'])['state'] == RequestState.QUEUED
+
+
+@pytest.mark.noparallel(groups=[NoParallelGroups.SUBMITTER])
 @pytest.mark.parametrize("core_config_mock", [
     # Run test twice: with, and without, temp tables
     {
         "table_content": [
             ('transfers', 'multihop_rse_expression', '*'),
         ]
     }
```

### Comparing `rucio-34.0.0rc2/tests/test_counter.py` & `rucio-34.1.0/tests/test_counter.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/tests/test_credential.py` & `rucio-34.1.0/tests/test_credential.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/tests/test_curl.py` & `rucio-34.1.0/tests/test_curl.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -15,15 +14,15 @@
 
 import json
 import os
 
 import pytest
 
 from rucio.common.config import config_get, config_get_bool
-from rucio.tests.common import account_name_generator, rse_name_generator, execute, get_long_vo
+from rucio.tests.common import account_name_generator, execute, get_long_vo, rse_name_generator
 
 
 class TestCurlRucio:
     '''
     class TestCurlRucio
     '''
```

### Comparing `rucio-34.0.0rc2/tests/test_daemons.py` & `rucio-34.1.0/tests/test_daemons.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -21,15 +20,15 @@
 from rucio.common import exception
 from rucio.daemons.abacus import account, collection_replica, rse
 from rucio.daemons.atropos import atropos
 from rucio.daemons.automatix import automatix
 from rucio.daemons.badreplicas import minos, minos_temporary_expiration, necromancer
 from rucio.daemons.c3po import c3po
 from rucio.daemons.cache import consumer
-from rucio.daemons.conveyor import finisher, poller, receiver, stager, submitter, throttler, preparer
+from rucio.daemons.conveyor import finisher, poller, preparer, receiver, stager, submitter, throttler
 from rucio.daemons.follower import follower
 from rucio.daemons.hermes import hermes
 from rucio.daemons.judge import cleaner, evaluator, injector, repairer
 from rucio.daemons.oauthmanager import oauthmanager
 from rucio.daemons.reaper import dark_reaper, reaper
 from rucio.daemons.replicarecoverer import suspicious_replica_recoverer
 from rucio.daemons.tracer import kronos
```

### Comparing `rucio-34.0.0rc2/tests/test_dataset_replicas.py` & `rucio-34.1.0/tests/test_dataset_replicas.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -17,21 +16,20 @@
 from sqlalchemy.orm.exc import NoResultFound
 
 from rucio.client.didclient import DIDClient
 from rucio.client.replicaclient import ReplicaClient
 from rucio.client.ruleclient import RuleClient
 from rucio.common.exception import InvalidObject
 from rucio.common.schema import get_schema_value
-from rucio.core.did import attach_dids, add_dids
-from rucio.core.replica import list_datasets_per_rse, update_collection_replica, \
-    get_cleaned_updated_collection_replicas, delete_replicas, add_replicas
-from rucio.core.rse import add_rse, del_rse, add_protocol, get_rse_id
-from rucio.db.sqla import models, constants
+from rucio.core.did import add_dids, attach_dids
+from rucio.core.replica import add_replicas, delete_replicas, get_cleaned_updated_collection_replicas, list_datasets_per_rse, update_collection_replica
+from rucio.core.rse import add_protocol, add_rse, del_rse, get_rse_id
+from rucio.db.sqla import constants, models
 from rucio.db.sqla.constants import ReplicaState
-from rucio.tests.common import rse_name_generator, did_name_generator
+from rucio.tests.common import did_name_generator, rse_name_generator
 
 
 class TestDatasetReplicaClient:
 
     @pytest.mark.noparallel(reason='uses pre-defined RSE')
     def test_list_dataset_replicas(self):
         """ REPLICA (CLIENT): List dataset replicas."""
```

### Comparing `rucio-34.0.0rc2/tests/test_db.py` & `rucio-34.1.0/tests/test_db.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,28 +1,28 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-import pytest
 from unittest.mock import patch
 
+import pytest
 from sqlalchemy import text
-from rucio.db.sqla.session import get_session, _get_engine_poolclass, NullPool, QueuePool, SingletonThreadPool
+
 from rucio.common.exception import InputValidationError
+from rucio.db.sqla.session import NullPool, QueuePool, SingletonThreadPool, _get_engine_poolclass, get_session
 
 
 def test_db_connection():
     """ DB (CORE): Test db connection """
     session = get_session()
     if session.bind.dialect.name == 'oracle':
         session.execute(text('select 1 from dual'))
@@ -39,16 +39,16 @@
     with pytest.raises(InputValidationError, match='Unknown poolclass: unknown'):
         _get_engine_poolclass('unknown')
 
 
 @pytest.mark.noparallel(reason='Changes an internal method of MethodView.')
 def test_pooloverload():
     """ DB (WEB): Test response to a DatabaseException due to Pool Overflow """
-    from rucio.web.rest.flaskapi.v1.ping import Ping
     from rucio.common.exception import DatabaseException
+    from rucio.web.rest.flaskapi.v1.ping import Ping
 
     # Create a new ErrorHandlingMethodView as_view
     ping_view = Ping.as_view('ping')
 
     # specification for the mock we create to replace flask.request
     # without specifying this, _is_async_obj is run which triggers flask RuntimeError
     class T:
```

### Comparing `rucio-34.0.0rc2/tests/test_did.py` & `rucio-34.1.0/tests/test_did.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -13,30 +12,43 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 from datetime import datetime, timedelta
 
 import pytest
 
-from rucio.api import did
-from rucio.api import scope
-from rucio.db.sqla.util import json_implemented
+from rucio.api import did, scope
 from rucio.common import exception
-from rucio.common.exception import (DataIdentifierNotFound, DataIdentifierAlreadyExists,
-                                    InvalidPath, UnsupportedOperation,
-                                    UnsupportedStatus, ScopeNotFound, FileAlreadyExists, FileConsistencyMismatch)
+from rucio.common.exception import DataIdentifierAlreadyExists, DataIdentifierNotFound, FileAlreadyExists, FileConsistencyMismatch, InvalidPath, ScopeNotFound, UnsupportedOperation, UnsupportedStatus
 from rucio.common.types import InternalScope
 from rucio.common.utils import generate_uuid
-from rucio.core.did import (list_dids, add_did, delete_dids, get_did_atime, touch_dids, attach_dids, detach_dids,
-                            get_metadata, set_metadata, get_did, get_did_access_cnt, add_did_to_followed,
-                            get_users_following_did, remove_did_from_followed, set_status, list_new_dids,
-                            set_new_dids)
+from rucio.core.did import (
+    add_did,
+    add_did_to_followed,
+    attach_dids,
+    bulk_list_files,
+    delete_dids,
+    detach_dids,
+    get_did,
+    get_did_access_cnt,
+    get_did_atime,
+    get_metadata,
+    get_users_following_did,
+    list_dids,
+    list_new_dids,
+    remove_did_from_followed,
+    set_metadata,
+    set_new_dids,
+    set_status,
+    touch_dids,
+)
 from rucio.core.replica import add_replica, get_replica
 from rucio.db.sqla.constants import DIDType
-from rucio.tests.common import rse_name_generator, scope_name_generator, did_name_generator
+from rucio.db.sqla.util import json_implemented
+from rucio.tests.common import did_name_generator, rse_name_generator, scope_name_generator
 
 
 def skip_without_json():
     if not json_implemented():
         pytest.skip("JSON support is not implemented in this database")
 
 
@@ -249,14 +261,43 @@
         new_dids = [did for did in list_new_dids(did_type=None, thread=None, total_threads=None, chunk_size=100000, session=None)]
         assert {'scope': mock_scope, 'name': dsn, 'did_type': DIDType.DATASET} not in new_dids
 
         set_status(mock_scope, dsn, open=False)
         new_dids = [did for did in list_new_dids(did_type=None, thread=None, total_threads=None, chunk_size=100000, session=None)]
         assert {'scope': mock_scope, 'name': dsn, 'did_type': DIDType.DATASET} in new_dids
 
+    def test_bulk_list_files(self, mock_scope, root_account, rse_factory, did_factory):
+        """ Test the bulk_list_files method"""
+        _, rse_id = rse_factory.make_mock_rse()
+        nb_datasets = 5
+        nb_files = 10
+        # Try listing existing datasets
+        datasets = [did_factory.make_dataset() for _ in range(nb_datasets)]
+        files = []
+        for dataset in datasets:
+            new_files = []
+            for _ in range(nb_files):
+                new_files.append({'scope': mock_scope, 'name': did_name_generator('file'), 'bytes': 1, 'adler32': '0cc737eb', 'events': None, 'guid': None})
+            attach_dids(scope=dataset['scope'], name=dataset['name'], rse_id=rse_id, dids=new_files, account=root_account)
+            for file_ in new_files:
+                file_['parent_scope'] = dataset['scope']
+                file_['parent_name'] = dataset['name']
+            files.extend(new_files)
+        result = [file_ for file_ in bulk_list_files(datasets)]
+        assert len(result) == len(files)
+        for file_ in files:
+            assert file_ in result
+        # Try listing non-existing datasets
+        non_existing_datasets = [{'scope': mock_scope, 'name': did_name_generator('dataset')} for _ in range(nb_datasets)]
+        datasets.extend(non_existing_datasets)
+        parent_datasets = [(dataset['parent_scope'], dataset['parent_name']) for dataset in result]
+        assert len(result) == len(files)
+        for dataset in non_existing_datasets:
+            assert (dataset['scope'], dataset['name']) not in parent_datasets
+
 
 class TestDIDApi:
 
     @pytest.mark.dirty
     def test_list_new_dids(self, vo):
         """ DATA IDENTIFIERS (API): List new identifiers """
         tmp_scope = scope_name_generator()
@@ -1099,14 +1140,44 @@
         assert len(list_meta) == 12
         list_dids = []
         for idx in range(4):
             list_dids.append({'scope': scope, 'name': cnt[idx]})
         list_meta = [_ for _ in did_client.get_metadata_bulk(list_dids)]
         assert len(list_meta) == 0
 
+    def test_bulk_list_files(self, did_client, mock_scope, root_account, rse_factory, did_factory):
+        """ Test the bulk_list_files method"""
+        _, rse_id = rse_factory.make_mock_rse()
+        nb_datasets = 5
+        # Try listing existing datasets
+        datasets = [did_factory.make_dataset() for _ in range(nb_datasets)]
+        external_datasets = [{'scope': dataset['scope'].external, 'name': dataset['name']} for dataset in datasets]
+        files = []
+        for dataset in datasets:
+            new_files = []
+            for _ in range(10):
+                new_files.append({'scope': mock_scope, 'name': did_name_generator('file'), 'bytes': 1, 'adler32': '0cc737eb', 'events': None, 'guid': None})
+            attach_dids(scope=dataset['scope'], name=dataset['name'], rse_id=rse_id, dids=new_files, account=root_account)
+            for file_ in new_files:
+                file_['scope'] = dataset['scope'].external
+                file_['parent_scope'] = dataset['scope'].external
+                file_['parent_name'] = dataset['name']
+            files.extend(new_files)
+        result = [files for files in did_client.bulk_list_files(external_datasets)]
+        assert len(result) == len(files)
+        for file_ in files:
+            assert file_ in result
+        # Try listing non-existing datasets
+        non_existing_datasets = [{'scope': mock_scope.external, 'name': did_name_generator('dataset')} for _ in range(nb_datasets)]
+        datasets.extend(non_existing_datasets)
+        parent_datasets = [(dataset['parent_scope'], dataset['parent_name']) for dataset in result]
+        assert len(result) == len(files)
+        for dataset in non_existing_datasets:
+            assert (dataset['scope'], dataset['name']) not in parent_datasets
+
 
 @pytest.mark.noparallel(reason='uses mock scope')
 def test_bulk_get_meta_inheritance(vo, rse_factory, mock_scope, did_factory, rucio_client):
     """ DATA IDENTIFIERS (CLIENT): Add metadata for a hierarchical list of DIDs and check that the metadata are inherited"""
     skip_without_json()
     key = 'generic_metadata'
     nb_dids = 4
```

### Comparing `rucio-34.0.0rc2/tests/test_did_meta_plugins.py` & `rucio-34.1.0/tests/test_did_meta_plugins.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -16,20 +15,20 @@
 from copy import deepcopy
 
 import pytest
 
 from rucio.client.didclient import DIDClient
 from rucio.common.exception import KeyNotFound
 from rucio.common.utils import generate_uuid
-from rucio.core.did import add_did, delete_dids, set_metadata_bulk, set_dids_metadata_bulk
-from rucio.core.did_meta_plugins import list_dids, get_metadata, set_metadata
+from rucio.core.did import add_did, delete_dids, set_dids_metadata_bulk, set_metadata_bulk
+from rucio.core.did_meta_plugins import get_metadata, list_dids, set_metadata
 from rucio.core.did_meta_plugins.mongo_meta import MongoDidMeta
 from rucio.core.did_meta_plugins.postgres_meta import ExternalPostgresJSONDidMeta
 from rucio.db.sqla.util import json_implemented
-from rucio.tests.common import skip_rse_tests_with_accounts, did_name_generator
+from rucio.tests.common import did_name_generator, skip_rse_tests_with_accounts
 
 
 def skip_without_json():
     if not json_implemented():
         pytest.skip("JSON support is not implemented in this database")
```

### Comparing `rucio-34.0.0rc2/tests/test_didtype.py` & `rucio-34.1.0/tests/test_didtype.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/tests/test_download.py` & `rucio-34.1.0/tests/test_download.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -19,26 +18,25 @@
 import tarfile
 from tempfile import TemporaryDirectory
 from unittest.mock import ANY, MagicMock, patch
 from zipfile import ZipFile
 
 import pytest
 
-from rucio.client.downloadclient import DownloadClient
+from rucio.client.downloadclient import DownloadClient, FileDownloadState
 from rucio.common.config import config_add_section, config_set
 from rucio.common.exception import InputValidationError, NoFilesDownloaded, RucioException
 from rucio.common.types import InternalScope
 from rucio.common.utils import generate_uuid
 from rucio.core import did as did_core
 from rucio.core import scope as scope_core
 from rucio.core.rse import add_protocol
-from rucio.client.downloadclient import FileDownloadState
 from rucio.rse import rsemanager as rsemgr
 from rucio.rse.protocols.posix import Default as PosixProtocol
-from rucio.tests.common import skip_rse_tests_with_accounts, scope_name_generator, file_generator
+from rucio.tests.common import file_generator, scope_name_generator, skip_rse_tests_with_accounts
 
 
 @pytest.fixture
 def download_client():
     logger = logging.getLogger('dlul_client')
     logger.addHandler(logging.StreamHandler())
     logger.setLevel(logging.DEBUG)
```

### Comparing `rucio-34.0.0rc2/tests/test_dumper.py` & `rucio-34.1.0/tests/test_dumper.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -20,18 +19,17 @@
 from datetime import datetime
 from io import StringIO
 from unittest import mock
 
 import pytest
 import requests
 
-from rucio.common import config
-from rucio.common import dumper
-from rucio.tests.common import make_temp_file
-from rucio.tests.common import mock_open
+from rucio.common import config, dumper
+from rucio.tests.common import make_temp_file, mock_open
+
 from .mocks import gfal2
 
 DATE_SECONDS = "2015-03-10 14:00:35"
 DATE_TENTHS = "2015-03-10T14:00:35.5"
 DATE_MILLISECONDS = "2015-03-10T14:00:35.5"
 RSEPROTOCOL = {
     "hostname": "example.com",
@@ -82,15 +80,15 @@
     os.unlink(tmp)
 
 
 def test_smart_open_for_bz2_file():
     fd, path = tempfile.mkstemp()
     comp = bz2.BZ2Compressor()
     with os.fdopen(fd, 'wb') as f:
-        f.write(comp.compress('abcdef'.encode()))
+        f.write(comp.compress(b'abcdef'))
         f.write(comp.flush())
     assert not isinstance(dumper.smart_open(path), bz2.BZ2File)
     os.unlink(path)
 
 
 def test_temp_file_with_final_name_creates_a_tmp_file_and_then_removes_it():
     final_name = tempfile.mktemp()
```

### Comparing `rucio-34.0.0rc2/tests/test_dumper_consistency.py` & `rucio-34.1.0/tests/test_dumper_consistency.py`

 * *Files 6% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -14,20 +13,15 @@
 # limitations under the License.
 
 import json
 import os
 from datetime import datetime
 from unittest import mock
 
-from rucio.common.dumper.consistency import Consistency
-from rucio.common.dumper.consistency import _try_to_advance
-from rucio.common.dumper.consistency import compare3
-from rucio.common.dumper.consistency import gnu_sort
-from rucio.common.dumper.consistency import min3
-from rucio.common.dumper.consistency import parse_and_filter_file
+from rucio.common.dumper.consistency import Consistency, _try_to_advance, compare3, gnu_sort, min3, parse_and_filter_file
 from rucio.tests.common import make_temp_file
 
 RSEPROTOCOL = {
     "hostname": "example.com",
     "scheme": "root",
     "port": 1094,
     "prefix": "//atlasdatadisk/rucio/",
```

### Comparing `rucio-34.0.0rc2/tests/test_dumper_data_model.py` & `rucio-34.1.0/tests/test_dumper_data_model.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -212,15 +211,15 @@
             self._DataConcrete.download(
                 'SOMEENDPOINT',
                 date=datetime.strptime('01-01-2015', '%d-%m-%Y'),
                 cache_dir=tmp_path,
             )
 
 
-class TestCompleteDataset(object):
+class TestCompleteDataset:
 
     @staticmethod
     def test_creation_with_7_parameters():
         """ test ceation with 7 parameters """
         complete_dataset = data_models.CompleteDataset(
             'RSE',
             'scope',
@@ -259,15 +258,15 @@
             '2015-01-01 23:00:00',
             '2015-01-01 23:00:00',
             'A',
         )
         assert complete_dataset.size is None  # pylint: disable=no-member
 
 
-class TestReplica(object):
+class TestReplica:
 
     @staticmethod
     def test_replica_with_8_parameters():
         """ test replica with 8 parameters """
         replica = data_models.Replica(
             'RSE',
             'scope',
```

### Comparing `rucio-34.0.0rc2/tests/test_dumper_path_parsing.py` & `rucio-34.1.0/tests/test_dumper_path_parsing.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,27 +1,25 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-from rucio.common.dumper.path_parsing import components
-from rucio.common.dumper.path_parsing import remove_prefix
+from rucio.common.dumper.path_parsing import components, remove_prefix
 
 
-class TestPathParsing(object):
+class TestPathParsing:
     def test_remove_prefix(self):
         prefix = ['a', 'b', 'c', 'd']
 
         full = ['a', 'b', 'c', 'd', 'e', 'f']  # -> e,f
         relative = ['c', 'd', 'e', 'f']  # -> e,f
         exclusive = ['e', 'f', 'g']  # -> e,f,g
         mixed = ['c', 'a', 'e', 'f']  # -> c,a,e,f
```

### Comparing `rucio-34.0.0rc2/tests/test_filter_engine.py` & `rucio-34.1.0/tests/test_filter_engine.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -10,26 +9,26 @@
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import operator
-from datetime import datetime, timedelta
 import unittest
+from datetime import datetime, timedelta
 
 import pytest
 
 from rucio.common.exception import DuplicateCriteriaInDIDFilter
 from rucio.common.utils import generate_uuid
 from rucio.core.did import add_did
 from rucio.core.did_meta_plugins import set_metadata
+from rucio.core.did_meta_plugins.filter_engine import FilterEngine
 from rucio.db.sqla import models
 from rucio.db.sqla.util import json_implemented
-from rucio.core.did_meta_plugins.filter_engine import FilterEngine
 
 
 class TestFilterEngineDummy:
     def test_InputSanitisation(self):
         filters = FilterEngine('  TestKeyword1  =  True  ,  TestKeyword2   =   0; 1 < TestKeyword4 <= 2', strict_coerce=False).filters
         filters_expected = [[('TestKeyword1', operator.eq, 1),
                              ('TestKeyword2', operator.eq, 0)],
```

### Comparing `rucio-34.0.0rc2/tests/test_heartbeat.py` & `rucio-34.1.0/tests/test_heartbeat.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -15,15 +14,15 @@
 
 import random
 import threading
 from datetime import datetime, timedelta
 
 import pytest
 
-from rucio.core.heartbeat import live, die, cardiac_arrest, list_payload_counts, list_heartbeats, sanity_check
+from rucio.core.heartbeat import cardiac_arrest, die, list_heartbeats, list_payload_counts, live, sanity_check
 from rucio.db.sqla.models import Heartbeats
 from rucio.db.sqla.session import transactional_session
 
 
 @pytest.fixture
 def executable_factory(function_scope_prefix, db_session):
     executables = []
```

### Comparing `rucio-34.0.0rc2/tests/test_hermes.py` & `rucio-34.1.0/tests/test_hermes.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -13,29 +12,29 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 """
 Hermes Test
 """
 
+import time
 from datetime import datetime
 from json import loads
-import requests
-import pytest
 
+import pytest
+import requests
 import stomp
-import time
 
 from rucio.common.config import config_get, config_get_int
 from rucio.core.message import add_message, retrieve_messages, truncate_messages
 from rucio.daemons.hermes import hermes
 from rucio.tests.common import rse_name_generator, skip_missing_elasticsearch_influxdb_in_env
 
 
-class MyListener(object):
+class MyListener:
     def __init__(self, conn):
         self.conn = conn
         self.count = 0
         self.messages = []
 
     def reset(self):
         self.count = 0
```

### Comparing `rucio-34.0.0rc2/tests/test_identity.py` & `rucio-34.1.0/tests/test_identity.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -15,22 +14,22 @@
 
 import random
 import string
 
 import pytest
 
 from rucio.common.config import config_get_bool
+from rucio.common.exception import IdentityError, IdentityNotFound
 from rucio.common.types import InternalAccount
 from rucio.common.utils import generate_uuid as uuid
 from rucio.core.account import add_account, del_account
-from rucio.core.identity import add_identity, del_identity, add_account_identity, del_account_identity, list_identities, verify_identity
+from rucio.core.identity import add_account_identity, add_identity, del_account_identity, del_identity, list_identities, verify_identity
 from rucio.db.sqla.constants import AccountType, IdentityType
-from rucio.tests.common import account_name_generator, headers, hdrdict, auth, rfc2253_dn_generator
+from rucio.tests.common import account_name_generator, auth, hdrdict, headers, rfc2253_dn_generator
 from rucio.tests.common_server import get_vo
-from rucio.common.exception import IdentityNotFound, IdentityError
 
 
 @pytest.mark.noparallel(reason='adds/removes entities with non-unique names')
 class TestIdentity:
     """
     Test the Identity abstraction layer
     """
```

### Comparing `rucio-34.0.0rc2/tests/test_impl_upload_download.py` & `rucio-34.1.0/tests/test_impl_upload_download.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,28 +1,28 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-from os import path
 import re
+from os import path
 
 import pytest
 
-from rucio.common.utils import generate_uuid as uuid, execute
+from rucio.common.utils import execute
+from rucio.common.utils import generate_uuid as uuid
 from rucio.tests.common import skip_rse_tests_with_accounts
 
 
 @pytest.fixture(scope='class')
 def scope_and_rse(mock_scope, test_scope):
     """
     Check if xrd containers rses for xrootd are available in the testing environment.
```

### Comparing `rucio-34.0.0rc2/tests/test_import_export.py` & `rucio-34.1.0/tests/test_import_export.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -15,29 +14,27 @@
 
 from copy import deepcopy
 
 import pytest
 
 from rucio.client.exportclient import ExportClient
 from rucio.client.importclient import ImportClient
-from rucio.common.config import config_set, config_add_section, config_has_section
+from rucio.common.config import config_add_section, config_has_section, config_set
 from rucio.common.exception import RSENotFound
 from rucio.common.types import InternalAccount
-from rucio.common.utils import render_json, parse_response
+from rucio.common.utils import parse_response, render_json
 from rucio.core.account import add_account, get_account
 from rucio.core.distance import add_distance, get_distances
 from rucio.core.exporter import export_data, export_rses
-from rucio.core.identity import add_identity, list_identities, add_account_identity, list_accounts_for_identity
+from rucio.core.identity import add_account_identity, add_identity, list_accounts_for_identity, list_identities
 from rucio.core.importer import import_data, import_rses
-from rucio.core.rse import get_rse_id, get_rse_name, add_rse, get_rse, add_protocol, get_rse_protocols, \
-    list_rse_attributes, get_rse_limits, set_rse_limits, add_rse_attribute, list_rses, export_rse, del_rse, \
-    get_rse_attribute
-from rucio.db.sqla import session, models
-from rucio.db.sqla.constants import RSEType, AccountType, IdentityType, AccountStatus
-from rucio.tests.common import rse_name_generator, headers, auth, hdrdict
+from rucio.core.rse import add_protocol, add_rse, add_rse_attribute, del_rse, export_rse, get_rse, get_rse_attribute, get_rse_id, get_rse_limits, get_rse_name, get_rse_protocols, list_rse_attributes, list_rses, set_rse_limits
+from rucio.db.sqla import models, session
+from rucio.db.sqla.constants import AccountStatus, AccountType, IdentityType, RSEType
+from rucio.tests.common import auth, hdrdict, headers, rse_name_generator
 
 
 def check_rse(rse_name, test_data, vo='def'):
     rse_id = get_rse_id(rse=rse_name, vo=vo)
     rse = get_rse(rse_id=rse_id)
     assert rse['rse'] == rse_name
     assert rse['vo'] == vo
```

### Comparing `rucio-34.0.0rc2/tests/test_judge_cleaner.py` & `rucio-34.1.0/tests/test_judge_cleaner.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -22,14 +21,15 @@
 from rucio.core.did import add_did, attach_dids
 from rucio.core.lock import get_replica_locks
 from rucio.core.rse import add_rse_attribute
 from rucio.core.rule import add_rule, update_rule
 from rucio.daemons.judge.cleaner import rule_cleaner
 from rucio.db.sqla.constants import DIDType
 from rucio.tests.common_server import get_vo
+
 from .test_rule import create_files, tag_generator
 
 
 @pytest.fixture(scope="class")
 def setup_class(request, rse_factory_unittest):
     request.cls.setUpClass()
 
@@ -82,15 +82,15 @@
         """ JUDGE CLEANER: Test the judge when deleting expired rules"""
         scope = InternalScope('mock', **self.vo)
         files = create_files(3, scope, self.rse1_id)
         dataset = 'dataset_' + str(uuid())
         add_did(scope, dataset, DIDType.DATASET, self.jdoe)
         attach_dids(scope, dataset, files, self.jdoe)
 
-        add_rule(dids=[{'scope': scope, 'name': dataset}], account=self.jdoe, copies=1, rse_expression=self.rse1, grouping='NONE', weight='fakeweight', lifetime=-3, locked=False, subscription_id=None)[0]
+        add_rule(dids=[{'scope': scope, 'name': dataset}], account=self.jdoe, copies=1, rse_expression=self.rse1, grouping='NONE', weight='fakeweight', lifetime=-1, locked=False, subscription_id=None)[0]
         add_rule(dids=[{'scope': scope, 'name': dataset}], account=self.jdoe, copies=2, rse_expression=self.T1, grouping='NONE', weight='fakeweight', lifetime=None, locked=False, subscription_id=None)[0]
         add_rule(dids=[{'scope': scope, 'name': dataset}], account=self.jdoe, copies=3, rse_expression=self.T1, grouping='NONE', weight='fakeweight', lifetime=None, locked=False, subscription_id=None)[0]
 
         rule_cleaner(once=True)
 
         for file in files:
             rse_locks = get_replica_locks(scope=file['scope'], name=file['name'])
@@ -101,11 +101,11 @@
         scope = InternalScope('mock', **self.vo)
         files = create_files(3, scope, self.rse1_id)
         dataset = 'dataset_' + str(uuid())
         add_did(scope, dataset, DIDType.DATASET, self.jdoe)
         attach_dids(scope, dataset, files, self.jdoe)
 
         rule_id = add_rule(dids=[{'scope': scope, 'name': dataset}], account=self.jdoe, copies=1, rse_expression=self.rse1, grouping='NONE', weight='fakeweight', lifetime=None, locked=False, subscription_id=None)[0]
-        child_rule = add_rule(dids=[{'scope': scope, 'name': dataset}], account=self.jdoe, copies=1, rse_expression=self.rse3, grouping='NONE', weight='fakeweight', lifetime=-3, locked=False, subscription_id=None)[0]
+        child_rule = add_rule(dids=[{'scope': scope, 'name': dataset}], account=self.jdoe, copies=1, rse_expression=self.rse3, grouping='NONE', weight='fakeweight', lifetime=-1, locked=False, subscription_id=None)[0]
         update_rule(rule_id, {'child_rule_id': child_rule})
 
         rule_cleaner(once=True)
```

### Comparing `rucio-34.0.0rc2/tests/test_judge_evaluator.py` & `rucio-34.1.0/tests/test_judge_evaluator.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,22 +1,23 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
+from typing import TYPE_CHECKING
+
 import pytest
 
 from rucio.common.config import config_get_bool
 from rucio.common.types import InternalAccount, InternalScope
 from rucio.common.utils import generate_uuid as uuid
 from rucio.core.account import get_usage
 from rucio.core.account_limit import set_local_account_limit
@@ -28,17 +29,17 @@
 from rucio.daemons.abacus.account import account_update
 from rucio.daemons.judge.evaluator import re_evaluator
 from rucio.db.sqla.constants import DIDType, LockState
 from rucio.db.sqla.models import UpdatedDID
 from rucio.db.sqla.session import transactional_session
 from rucio.tests.common import RSE_namedtuple
 from rucio.tests.common_server import get_vo
+
 from .test_rule import create_files, tag_generator
 
-from typing import TYPE_CHECKING
 if TYPE_CHECKING:
     from .temp_factories import TemporaryDidFactory, TemporaryRSEFactory
 
 
 @pytest.fixture(scope="class")
 def setup_class(request, rse_factory_unittest):
     request.cls.setUpClass()
```

### Comparing `rucio-34.0.0rc2/tests/test_judge_injector.py` & `rucio-34.1.0/tests/test_judge_injector.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -21,20 +20,21 @@
 from rucio.common.exception import RuleNotFound
 from rucio.common.types import InternalAccount, InternalScope
 from rucio.common.utils import generate_uuid as uuid
 from rucio.core.account_limit import set_local_account_limit
 from rucio.core.did import add_did, attach_dids
 from rucio.core.lock import get_replica_locks
 from rucio.core.rse import add_rse_attribute
-from rucio.core.rule import add_rule, get_rule, approve_rule, deny_rule, list_rules
+from rucio.core.rule import add_rule, approve_rule, deny_rule, get_rule, list_rules
 from rucio.daemons.judge.injector import rule_injector
 from rucio.db.sqla.constants import DIDType, RuleState
 from rucio.db.sqla.models import ReplicationRule
 from rucio.db.sqla.session import transactional_session
 from rucio.tests.common_server import get_vo
+
 from .test_rule import create_files, tag_generator
 
 
 @pytest.fixture(scope="class")
 def setup_class(request, rse_factory_unittest):
     request.cls.setUpClass()
 
@@ -186,15 +186,15 @@
         for i in range(3):
             files = create_files(3, scope, self.rse1_id)
             dataset = 'dataset_' + str(uuid())
             datasets.append(dataset)
             add_did(scope, dataset, DIDType.DATASET, self.jdoe)
             attach_dids(scope, dataset, files, self.jdoe)
             attach_dids(scope, container, [{'scope': scope, 'name': dataset}], self.jdoe)
-        rule_id = add_rule(dids=[{'scope': scope, 'name': container}], account=self.jdoe, copies=1, rse_expression=self.rse1, grouping='DATASET', weight=None, lifetime=900, locked=False, subscription_id=None, ask_approval=True)[0]
+        rule_id = add_rule(dids=[{'scope': scope, 'name': container}], account=self.jdoe, copies=1, rse_expression=self.rse1, grouping='DATASET', weight=None, lifetime=None, locked=False, subscription_id=None, ask_approval=True)[0]
         approve_rule(rule_id, approver=self.jdoe)
         assert (get_rule(rule_id)['state'] == RuleState.INJECT)
         rule_injector(once=True)
         # Check if there is a rule for each file
         with pytest.raises(RuleNotFound):
             get_rule(rule_id)
         for dataset in datasets:
@@ -209,16 +209,16 @@
         for i in range(3):
             files = create_files(3, scope, self.rse1_id)
             dataset = 'dataset_' + str(uuid())
             datasets.append(dataset)
             add_did(scope, dataset, DIDType.DATASET, self.jdoe)
             attach_dids(scope, dataset, files, self.jdoe)
             attach_dids(scope, container, [{'scope': scope, 'name': dataset}], self.jdoe)
-        add_rule(dids=[{'scope': scope, 'name': dataset}], account=self.jdoe, copies=1, rse_expression=self.rse1, grouping='DATASET', weight=None, lifetime=900, locked=False, subscription_id=None, ask_approval=False)
-        rule_id = add_rule(dids=[{'scope': scope, 'name': container}], account=self.jdoe, copies=1, rse_expression=self.rse1, grouping='DATASET', weight=None, lifetime=900, locked=False, subscription_id=None, ask_approval=True)[0]
+        add_rule(dids=[{'scope': scope, 'name': dataset}], account=self.jdoe, copies=1, rse_expression=self.rse1, grouping='DATASET', weight=None, lifetime=None, locked=False, subscription_id=None, ask_approval=False)
+        rule_id = add_rule(dids=[{'scope': scope, 'name': container}], account=self.jdoe, copies=1, rse_expression=self.rse1, grouping='DATASET', weight=None, lifetime=None, locked=False, subscription_id=None, ask_approval=True)[0]
         approve_rule(rule_id, approver=self.jdoe)
         assert (get_rule(rule_id)['state'] == RuleState.INJECT)
         rule_injector(once=True)
         # Check if there is a rule for each file
         with pytest.raises(RuleNotFound):
             get_rule(rule_id)
         for dataset in datasets:
```

### Comparing `rucio-34.0.0rc2/tests/test_judge_repairer.py` & `rucio-34.1.0/tests/test_judge_repairer.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -15,32 +14,32 @@
 
 import itertools
 from hashlib import sha256
 
 import pytest
 from dogpile.cache import make_region
 
-from rucio.common.config import config_get
-from rucio.common.config import config_get_bool
+from rucio.common.config import config_get, config_get_bool
 from rucio.common.types import InternalAccount, InternalScope
 from rucio.core.account_limit import set_local_account_limit
 from rucio.core.did import add_did, attach_dids
-from rucio.core.lock import successful_transfer, failed_transfer, get_replica_locks
+from rucio.core.lock import failed_transfer, get_replica_locks, successful_transfer
 from rucio.core.replica import get_replica
 from rucio.core.request import cancel_request_did
+from rucio.core.rse import add_rse, add_rse_attribute, update_rse
+from rucio.core.rule import add_rule, get_rule
 from rucio.core.transfer import cancel_transfers
-from rucio.core.rse import add_rse_attribute, add_rse, update_rse
-from rucio.core.rule import get_rule, add_rule
 from rucio.daemons.judge.evaluator import re_evaluator
 from rucio.daemons.judge.repairer import rule_repairer
 from rucio.db.sqla import models
-from rucio.db.sqla.constants import DIDType, RuleState, ReplicaState
+from rucio.db.sqla.constants import DIDType, ReplicaState, RuleState
 from rucio.db.sqla.session import get_session
-from rucio.tests.common import rse_name_generator, did_name_generator
+from rucio.tests.common import did_name_generator, rse_name_generator
 from rucio.tests.common_server import get_vo
+
 from .test_rule import create_files, tag_generator
 
 
 @pytest.fixture(scope="class")
 def setup_class(request, rse_factory_unittest):
     request.cls.setUpClass()
```

### Comparing `rucio-34.0.0rc2/tests/test_lifetime.py` & `rucio-34.1.0/tests/test_lifetime.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,40 +1,38 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-import os
 import json
-
+import os
+from configparser import NoSectionError
 from datetime import datetime, timedelta
 
 import pytest
-from configparser import NoSectionError
 
-from rucio.common.exception import UnsupportedOperation, ConfigNotFound
+from rucio.common.exception import ConfigNotFound, UnsupportedOperation
 from rucio.common.policy import REGION
 from rucio.common.utils import generate_uuid as uuid
-from rucio.tests.common import skip_multivo
 from rucio.core import config as core_config
-from rucio.core.rule import add_rule, get_rule
-from rucio.core.did import set_metadata, get_metadata
+from rucio.core.did import get_metadata, set_metadata
 from rucio.core.lifetime_exception import add_exception
+from rucio.core.rule import add_rule, get_rule
 from rucio.daemons.atropos.atropos import atropos
 from rucio.db.sqla.constants import DIDType
+from rucio.tests.common import skip_multivo
 
 
 @skip_multivo(reason='only valid for ATLAS')
 def test_lifetime_creation_core(root_account, rse_factory, mock_scope, did_factory):
     """
     Test the creation of a lifetime exception on the core side
     """
```

### Comparing `rucio-34.0.0rc2/tests/test_message.py` & `rucio-34.1.0/tests/test_message.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -15,20 +14,20 @@
 
 import json
 import random
 import string
 
 import pytest
 
-from rucio.db.sqla.models import Message
-from rucio.db.sqla.session import get_session
 from rucio.common.constants import MAX_MESSAGE_LENGTH
 from rucio.common.exception import InvalidObject, RucioException
 from rucio.common.utils import generate_uuid
-from rucio.core.message import add_message, add_messages, retrieve_messages, delete_messages, truncate_messages
+from rucio.core.message import add_message, add_messages, delete_messages, retrieve_messages, truncate_messages
+from rucio.db.sqla.models import Message
+from rucio.db.sqla.session import get_session
 
 
 @pytest.mark.noparallel(reason='fails when run in parallel')
 @pytest.mark.parametrize("core_config_mock", [{"table_content": [
     ('hermes', 'services_list', 'influx,activemq,elastic,email'),
 ]}], indirect=True)
 @pytest.mark.parametrize("caches_mock", [{"caches_to_mock": [
```

### Comparing `rucio-34.0.0rc2/tests/test_meta_conventions.py` & `rucio-34.1.0/tests/test_meta_conventions.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -11,18 +10,18 @@
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import pytest
 
-from rucio.common.exception import InvalidValueForKey, RucioException, UnsupportedValueType, UnsupportedKeyType
+from rucio.common.exception import InvalidValueForKey, RucioException, UnsupportedKeyType, UnsupportedValueType
 from rucio.common.utils import generate_uuid as uuid
 from rucio.core.meta_conventions import add_key
-from rucio.db.sqla import session, models
+from rucio.db.sqla import models, session
 from rucio.db.sqla.constants import DIDType, KeyType
 
 
 @pytest.mark.dirty
 class TestMetaConventionsClient:
 
     def test_add_and_list_keys(self, rucio_client):
```

### Comparing `rucio-34.0.0rc2/tests/test_meta_did.py` & `rucio-34.1.0/tests/test_meta_did.py`

 * *Files 6% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/tests/test_monitor.py` & `rucio-34.1.0/tests/test_monitor.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/tests/test_multi_vo.py` & `rucio-34.1.0/tests/test_multi_vo.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -14,17 +13,17 @@
 # limitations under the License.
 
 import os
 from logging import getLogger
 from os import remove
 from random import choice
 from re import search
-from string import ascii_uppercase, ascii_lowercase, ascii_letters, digits
+from string import ascii_letters, ascii_lowercase, ascii_uppercase, digits
 from unittest.mock import patch
-from urllib.parse import urlparse, parse_qs
+from urllib.parse import parse_qs, urlparse
 
 import pytest
 from oic import rndstr
 
 from rucio.api import vo as vo_api
 from rucio.api.account import add_account, list_accounts
 from rucio.api.account_limit import set_local_account_limit
@@ -38,31 +37,32 @@
 from rucio.api.scope import add_scope, list_scopes
 from rucio.api.subscription import add_subscription, list_subscriptions
 from rucio.client.accountlimitclient import AccountLimitClient
 from rucio.client.client import Client
 from rucio.client.replicaclient import ReplicaClient
 from rucio.client.subscriptionclient import SubscriptionClient
 from rucio.client.uploadclient import UploadClient
-from rucio.common.config import config_remove_option, config_set, config_has_section, config_add_section
-from rucio.common.exception import AccessDenied, Duplicate, InvalidRSEExpression, UnsupportedAccountName, \
-    UnsupportedOperation, RucioException
+from rucio.common.config import config_add_section, config_has_section, config_remove_option, config_set
+from rucio.common.exception import AccessDenied, Duplicate, InvalidRSEExpression, RucioException, UnsupportedAccountName, UnsupportedOperation
 from rucio.common.types import InternalAccount
 from rucio.common.utils import generate_uuid, get_tmp_dir, parse_response, ssh_sign
 from rucio.core import config as core_config
 from rucio.core.account_counter import add_counter
 from rucio.core.replica import add_replica
-from rucio.core.rse import get_rses_with_attribute_value, get_rse_id, get_rse_vo
+from rucio.core.rse import get_rse_id, get_rse_vo, get_rses_with_attribute_value
 from rucio.core.rse_expression_parser import parse_expression
 from rucio.core.rule import add_rule
 from rucio.core.vo import map_vo
 from rucio.daemons.automatix.automatix import automatix
-from rucio.db.sqla import models, session as db_session
-from rucio.tests.common import execute, headers, hdrdict, vohdr, auth, loginhdr
+from rucio.db.sqla import models
+from rucio.db.sqla import session as db_session
+from rucio.tests.common import auth, execute, hdrdict, headers, loginhdr, vohdr
+
 from .test_authentication import PRIVATE_KEY, PUBLIC_KEY
-from .test_oidc import get_mock_oidc_client, NEW_TOKEN_DICT
+from .test_oidc import NEW_TOKEN_DICT, get_mock_oidc_client
 
 LOG = getLogger(__name__)
 
 # module-level skip, see https://docs.pytest.org/en/latest/skipping.html#skip-all-test-functions-of-a-class-or-module
 pytestmark = pytest.mark.skipif('SUITE' in os.environ and os.environ['SUITE'] != 'multi_vo',
                                 reason='No execution of the multi_vo tests in a suite other than the multi_vo suite')
```

### Comparing `rucio-34.0.0rc2/tests/test_naming_convention.py` & `rucio-34.1.0/tests/test_naming_convention.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -14,18 +13,15 @@
 # limitations under the License.
 
 import pytest
 
 from rucio.common.exception import InvalidObject
 from rucio.common.types import InternalScope
 from rucio.common.utils import generate_uuid
-from rucio.core.naming_convention import (add_naming_convention,
-                                          validate_name,
-                                          list_naming_conventions,
-                                          delete_naming_convention)
+from rucio.core.naming_convention import add_naming_convention, delete_naming_convention, list_naming_conventions, validate_name
 from rucio.db.sqla.constants import KeyType
 
 
 @pytest.mark.noparallel(reason='changes global naming conventions, breaks other tests')
 class TestNamingConventionCore:
     '''
     Class to test naming convention enforcement.
```

### Comparing `rucio-34.0.0rc2/tests/test_oauthmanager.py` & `rucio-34.1.0/tests/test_oauthmanager.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/tests/test_oidc.py` & `rucio-34.1.0/tests/test_oidc.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -14,33 +13,29 @@
 # limitations under the License.
 
 import time
 import traceback
 import uuid
 from datetime import datetime, timedelta
 from unittest.mock import MagicMock, patch
-from urllib.parse import urlparse, parse_qs
+from urllib.parse import parse_qs, urlparse
 
 import pytest
 from jwkest.jwt import JWT
 from oic import rndstr
 
 from rucio.common.config import config_get_bool
-from rucio.common.exception import (CannotAuthenticate, DatabaseException)
-from rucio.common.exception import Duplicate
+from rucio.common.exception import CannotAuthenticate, DatabaseException, Duplicate
 from rucio.common.types import InternalAccount
 from rucio.core.account import add_account
 from rucio.core.authentication import redirect_auth_oidc, validate_auth_token
 from rucio.core.identity import add_account_identity
-from rucio.core.oidc import (get_auth_oidc, get_token_oidc, get_token_for_account_operation,
-                             EXPECTED_OIDC_AUDIENCE, EXPECTED_OIDC_SCOPE, oidc_identity_string,
-                             _token_cache_get, _token_cache_set)
+from rucio.core.oidc import EXPECTED_OIDC_AUDIENCE, EXPECTED_OIDC_SCOPE, _token_cache_get, _token_cache_set, get_auth_oidc, get_token_for_account_operation, get_token_oidc, oidc_identity_string
 from rucio.db.sqla import models
-from rucio.db.sqla.constants import AccountType
-from rucio.db.sqla.constants import IdentityType
+from rucio.db.sqla.constants import AccountType, IdentityType
 from rucio.db.sqla.session import get_session
 from rucio.tests.common_server import get_vo
 
 NEW_TOKEN_DICT = {'access_token': 'eyJ3bG...',
                   'expires_in': 3599,
                   'id_token': {'sub': 'abcdefg23', 'iss': 'https://test_auth_url_string/', 'nonce': 'mynonce'},
                   'scope': 'openid profile',
@@ -187,15 +182,15 @@
         return None
 
     @classmethod
     def parse_response(cls, AuthorizationResponse, info=None, sformat="urlencoded"):
         return None
 
 
-class MockResponse(object):
+class MockResponse:
     def __init__(self, json_data):
         self.json_data = json_data
 
     def json(self):
         return self.json_data
```

### Comparing `rucio-34.0.0rc2/tests/test_permission.py` & `rucio-34.1.0/tests/test_permission.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,16 +11,16 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 from rucio.api.permission import has_permission
 from rucio.common.config import config_get
 from rucio.common.types import InternalScope
-from rucio.core.scope import add_scope
 from rucio.core.account import add_account_attribute
+from rucio.core.scope import add_scope
 from rucio.tests.common import scope_name_generator, skip_non_belleii
 
 
 class TestPermissionCoreApi:
     """
     Test the Permission Core and API
     """
```

### Comparing `rucio-34.0.0rc2/tests/test_pfns.py` & `rucio-34.1.0/tests/test_pfns.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/tests/test_ping.py` & `rucio-34.1.0/tests/test_ping.py`

 * *Files 3% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/tests/test_preparer.py` & `rucio-34.1.0/tests/test_preparer.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,23 +11,23 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 
 import pytest
 
-from rucio.core.distance import get_distances, add_distance
+from rucio.core.distance import add_distance, get_distances
 from rucio.core.replica import add_replicas
-from rucio.core.request import list_and_mark_transfer_requests_and_source_replicas, set_transfer_limit, list_transfer_limits, get_request
+from rucio.core.request import get_request, list_and_mark_transfer_requests_and_source_replicas, list_transfer_limits, set_transfer_limit
+from rucio.core.rse import RseCollection, RseData, add_rse_attribute
 from rucio.core.transfer import get_supported_transfertools
-from rucio.core.rse import add_rse_attribute, RseData, RseCollection
 from rucio.daemons.conveyor.preparer import preparer
-from rucio.db.sqla.session import get_session
 from rucio.db.sqla import models
 from rucio.db.sqla.constants import RequestState
+from rucio.db.sqla.session import get_session
 
 
 @pytest.fixture
 def dest_rse(vo, rse_factory):
     rse_name, rse_id = rse_factory.make_mock_rse()
     yield {'name': rse_name, 'id': rse_id}
```

### Comparing `rucio-34.0.0rc2/tests/test_qos.py` & `rucio-34.1.0/tests/test_qos.py`

 * *Files 5% similar despite different names*

```diff
@@ -1,23 +1,22 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-from rucio.core.rse import update_rse, get_rse
+from rucio.core.rse import get_rse, update_rse
 
 
 class TestQoS:
 
     def test_update_and_remove_rse_qos_class(self, rse_factory):
         """ QoS (CORE): Update and remove QoS class for RSE """
         rse_name, rse_id = rse_factory.make_mock_rse()
```

### Comparing `rucio-34.0.0rc2/tests/test_quarantined_replica.py` & `rucio-34.1.0/tests/test_quarantined_replica.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -13,16 +12,15 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import pytest
 
 from rucio.common.config import config_get_bool
 from rucio.common.utils import generate_uuid
-from rucio.core.quarantined_replica import add_quarantined_replicas, list_quarantined_replicas, \
-    delete_quarantined_replicas
+from rucio.core.quarantined_replica import add_quarantined_replicas, delete_quarantined_replicas, list_quarantined_replicas
 from rucio.core.rse import get_rse_id
 from rucio.tests.common_server import get_vo
 
 
 @pytest.mark.noparallel(reason='uses pre-defined rses')
 def test_quarantined_replicas():
     """ QUARANTINED REPLICA (CORE): Add, List and Delete quarantined replicas """
```

### Comparing `rucio-34.0.0rc2/tests/test_reaper.py` & `rucio-34.1.0/tests/test_reaper.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -16,30 +15,29 @@
 from datetime import datetime, timedelta
 
 import pytest
 from sqlalchemy import and_, or_
 
 from rucio.api import replica as replica_api
 from rucio.api import rse as rse_api
-from rucio.db.sqla import models
-from rucio.db.sqla.constants import OBSOLETE
-from rucio.db.sqla.session import get_session
-from rucio.common.exception import ReplicaNotFound, DataIdentifierNotFound
+from rucio.common.exception import DataIdentifierNotFound, ReplicaNotFound
 from rucio.common.types import InternalAccount, InternalScope
 from rucio.common.utils import generate_uuid
 from rucio.core import did as did_core
 from rucio.core import message as message_core
 from rucio.core import replica as replica_core
 from rucio.core import rse as rse_core
 from rucio.core import rule as rule_core
-from rucio.daemons.reaper.reaper import reaper
 from rucio.daemons.reaper.dark_reaper import reaper as dark_reaper
+from rucio.daemons.reaper.reaper import reaper
 from rucio.daemons.reaper.reaper import run as run_reaper
+from rucio.db.sqla import models
+from rucio.db.sqla.constants import OBSOLETE
 from rucio.db.sqla.models import ConstituentAssociationHistory
-from rucio.db.sqla.session import read_session
+from rucio.db.sqla.session import get_session, read_session
 from rucio.tests.common import rse_name_generator, skip_rse_tests_with_accounts
 from tests.ruciopytest import NoParallelGroups
 
 __mock_protocol = {'scheme': 'MOCK',
                    'hostname': 'localhost',
                    'port': 123,
                    'prefix': '/test/reaper',
```

### Comparing `rucio-34.0.0rc2/tests/test_redirect.py` & `rucio-34.1.0/tests/test_redirect.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/tests/test_replica.py` & `rucio-34.1.0/tests/test_replica.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -14,44 +13,38 @@
 # limitations under the License.
 
 import hashlib
 import os
 import time
 from datetime import datetime, timedelta
 from json import dumps
+from typing import TYPE_CHECKING
 from unittest import mock
 from xml.etree import ElementTree
 
 import pytest
 import xmltodict
-from werkzeug.datastructures import MultiDict
-from werkzeug.datastructures import Headers
+from werkzeug.datastructures import Headers, MultiDict
 
 from rucio.client.ruleclient import RuleClient
-from rucio.common.exception import (DataIdentifierNotFound, AccessDenied, RucioException,
-                                    ReplicaIsLocked, ReplicaNotFound, ScopeNotFound,
-                                    DatabaseException, InputValidationError)
+from rucio.common.exception import AccessDenied, DatabaseException, DataIdentifierNotFound, InputValidationError, ReplicaIsLocked, ReplicaNotFound, RucioException, ScopeNotFound
 from rucio.common.schema import get_schema_value
-from rucio.common.utils import generate_uuid, clean_surls, parse_response
+from rucio.common.utils import clean_surls, generate_uuid, parse_response
 from rucio.core.config import set as cconfig_set
-from rucio.core.did import add_did, attach_dids, get_did, set_status, list_files, get_did_atime
-from rucio.core.replica import (add_replica, add_replicas, delete_replicas, get_replicas_state,
-                                get_replica, list_replicas, update_replica_state,
-                                get_RSEcoverage_of_dataset, get_replica_atime,
-                                touch_replica, get_bad_pfns, set_tombstone, add_bad_dids)
+from rucio.core.did import add_did, attach_dids, get_did, get_did_atime, list_files, set_status
+from rucio.core.replica import add_bad_dids, add_replica, add_replicas, delete_replicas, get_bad_pfns, get_replica, get_replica_atime, get_replicas_state, get_RSEcoverage_of_dataset, list_replicas, set_tombstone, touch_replica, update_replica_state
 from rucio.core.rse import add_protocol, add_rse_attribute, del_rse_attribute
 from rucio.daemons.badreplicas.minos import minos
 from rucio.daemons.badreplicas.minos_temporary_expiration import minos_tu_expiration
 from rucio.db.sqla import models
-from rucio.db.sqla.constants import DIDType, ReplicaState, BadPFNStatus, OBSOLETE
+from rucio.db.sqla.constants import OBSOLETE, BadPFNStatus, DIDType, ReplicaState
 from rucio.db.sqla.session import transactional_session
 from rucio.rse import rsemanager as rsemgr
-from rucio.tests.common import execute, headers, auth, Mime, accept, did_name_generator
+from rucio.tests.common import Mime, accept, auth, did_name_generator, execute, headers
 
-from typing import TYPE_CHECKING
 if TYPE_CHECKING:
     from .temp_factories import TemporaryRSEFactory
 
 
 def mocked_VP_requests_get(*args, **kwargs):
     """This method will be used by the mock to replace requests.get to VP server."""
     class MockResponse:
```

### Comparing `rucio-34.0.0rc2/tests/test_replica_recoverer.py` & `rucio-34.1.0/tests/test_replica_recoverer.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,36 +1,35 @@
 #!/usr/bin/env python3
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
+import json
 from datetime import datetime, timedelta
 from os import remove
 from time import sleep
 
 import pytest
-import json
 
-from rucio.core.replica import (update_replica_state, list_replicas, list_bad_replicas_status)
-from rucio.core.rse import add_rse_attribute
-from rucio.core.did import set_metadata
 from rucio.core import rse_expression_parser
+from rucio.core.did import set_metadata
+from rucio.core.replica import list_bad_replicas_status, list_replicas, update_replica_state
+from rucio.core.rse import add_rse_attribute
 from rucio.daemons.replicarecoverer.suspicious_replica_recoverer import run, stop
-from rucio.db.sqla.constants import DIDType, BadFilesStatus, ReplicaState
+from rucio.db.sqla.constants import BadFilesStatus, DIDType, ReplicaState
 from rucio.tests.common import execute
 
 
 class TestReplicaRecoverer:
 
     @pytest.fixture(autouse=True)
     def setup_obj(self, vo, rse_factory, replica_client, mock_scope, file_factory, scope_factory):
```

### Comparing `rucio-34.0.0rc2/tests/test_replica_sorting.py` & `rucio-34.1.0/tests/test_replica_sorting.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,27 +11,28 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import copy
 import json
 import os
+from tempfile import mkstemp
 from unittest import mock
 from urllib.parse import urlparse
-from tempfile import mkstemp
 
 import geoip2.database
 import pytest
 
-from rucio.common.utils import parse_replicas_from_string
 from rucio.common.config import config_get
-from rucio.core import rse_expression_parser, replica_sorter
+from rucio.common.utils import parse_replicas_from_string
+from rucio.core import replica_sorter, rse_expression_parser
 from rucio.core.replica import add_replicas, delete_replicas
-from rucio.core.rse import add_rse, del_rse, add_rse_attribute, add_protocol, del_rse_attribute
-from rucio.tests.common import rse_name_generator, headers, auth, vohdr, Mime, accept
+from rucio.core.rse import add_protocol, add_rse, add_rse_attribute, del_rse, del_rse_attribute
+from rucio.tests.common import Mime, accept, auth, headers, rse_name_generator, vohdr
+
 from .inputs import GEOIP_LITE2_CITY_TEST_DB
 
 LOCATION_TO_IP = {
     'Switzerland': '2a02:d000::1',
     'Romania': '2a02:e940::1',
     'Austria': '2a02:da80::1',
     'United Kingdom': '81.2.69.142',
```

### Comparing `rucio-34.0.0rc2/tests/test_request.py` & `rucio-34.1.0/tests/test_request.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -19,19 +18,19 @@
 
 import pytest
 
 from rucio.common.config import config_get_bool
 from rucio.common.utils import generate_uuid, parse_response
 from rucio.core.distance import add_distance
 from rucio.core.replica import add_replica
-from rucio.core.request import queue_requests, get_request_by_did, list_requests, list_requests_history, set_transfer_limit, TransferStatsManager
+from rucio.core.request import TransferStatsManager, get_request_by_did, list_requests, list_requests_history, queue_requests, set_transfer_limit
 from rucio.core.rse import add_rse_attribute
-from rucio.db.sqla import models, constants
-from rucio.db.sqla.constants import RequestType, RequestState
-from rucio.tests.common import vohdr, hdrdict, headers, auth
+from rucio.db.sqla import constants, models
+from rucio.db.sqla.constants import RequestState, RequestType
+from rucio.tests.common import auth, hdrdict, headers, vohdr
 
 
 @pytest.mark.parametrize("file_config_mock", [
     # Run test twice: with, and without, preparer enabled
     {
         "overrides": [
             ('conveyor', 'use_preparer', 'true')
```

### Comparing `rucio-34.0.0rc2/tests/test_root_proxy.py` & `rucio-34.1.0/tests/test_root_proxy.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -15,16 +14,16 @@
 
 from urllib.parse import urlencode
 
 import pytest
 
 from rucio.core.config import set as config_set
 from rucio.core.replica import add_replicas, delete_replicas
-from rucio.core.rse import add_rse, add_rse_attribute, del_rse, add_protocol
-from rucio.tests.common import rse_name_generator, vohdr, headers
+from rucio.core.rse import add_protocol, add_rse, add_rse_attribute, del_rse
+from rucio.tests.common import headers, rse_name_generator, vohdr
 
 client_location_without_proxy = {'ip': '192.168.0.1',
                                  'fqdn': 'anomalous-materials.blackmesa.com',
                                  'site': 'BLACKMESA1'}
 
 client_location_with_proxy = {'ip': '10.0.1.1',
                               'fqdn': 'test-chamber.aperture.com',
```

### Comparing `rucio-34.0.0rc2/tests/test_rse.py` & `rucio-34.1.0/tests/test_rse.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -13,37 +12,46 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import pytest
 
 from rucio.client.replicaclient import ReplicaClient
 from rucio.common import exception
-from rucio.common.exception import (Duplicate, RSENotFound, RSEProtocolNotSupported,
-                                    InvalidObject, ResourceTemporaryUnavailable,
-                                    RSEAttributeNotFound, RSEOperationNotSupported,
-                                    InputValidationError)
+from rucio.common.exception import Duplicate, InputValidationError, InvalidObject, ResourceTemporaryUnavailable, RSEAttributeNotFound, RSENotFound, RSEOperationNotSupported, RSEProtocolNotSupported
 from rucio.common.schema import get_schema_value
-from rucio.common.utils import GLOBALLY_SUPPORTED_CHECKSUMS, CHECKSUM_KEY
-from rucio.core.account_limit import set_local_account_limit, get_rse_account_usage
+from rucio.common.utils import CHECKSUM_KEY, GLOBALLY_SUPPORTED_CHECKSUMS
+from rucio.core.account_limit import get_rse_account_usage, set_local_account_limit
 from rucio.core.did import add_did, attach_dids
+from rucio.core.request import delete_transfer_limit, set_transfer_limit
+from rucio.core.rse import (
+    add_rse,
+    add_rse_attribute,
+    del_rse,
+    del_rse_attribute,
+    get_rse,
+    get_rse_attribute,
+    get_rse_id,
+    get_rse_protocols,
+    get_rse_supported_checksums_from_attributes,
+    get_rse_transfer_limits,
+    list_rse_attributes,
+    list_rses,
+    parse_checksum_support_attribute,
+    restore_rse,
+    rse_exists,
+    rse_is_empty,
+    update_rse,
+)
 from rucio.core.rule import add_rule
-from rucio.core.request import set_transfer_limit, delete_transfer_limit
-from rucio.core.rse import (add_rse, get_rse_id, del_rse, restore_rse, list_rses,
-                            rse_exists, add_rse_attribute, list_rse_attributes,
-                            get_rse_transfer_limits,
-                            get_rse_protocols,
-                            del_rse_attribute, get_rse_attribute, get_rse, rse_is_empty,
-                            parse_checksum_support_attribute,
-                            get_rse_supported_checksums_from_attributes,
-                            update_rse)
 from rucio.daemons.abacus.account import account_update
-from rucio.db.sqla import session, models
-from rucio.db.sqla.constants import RSEType, DIDType
+from rucio.db.sqla import models, session
+from rucio.db.sqla.constants import DIDType, RSEType
 from rucio.rse import rsemanager as mgr
-from rucio.tests.common import rse_name_generator, hdrdict, auth, headers, did_name_generator
+from rucio.tests.common import auth, did_name_generator, hdrdict, headers, rse_name_generator
+
 from .test_rule import create_files
 
 
 class TestRSECoreApi:
 
     def test_create_and_check_for_rse(self, vo):
         """ RSE (CORE): Test the creation, query, and deletion of a RSE """
```

### Comparing `rucio-34.0.0rc2/tests/test_rse_expression_parser.py` & `rucio-34.1.0/tests/test_rse_expression_parser.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -10,21 +9,20 @@
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 from random import choice
-from string import ascii_uppercase, ascii_lowercase
+from string import ascii_lowercase, ascii_uppercase
 
 import pytest
 
 from rucio.common.exception import InvalidRSEExpression, RSEWriteBlocked
-from rucio.core import rse
-from rucio.core import rse_expression_parser
+from rucio.core import rse, rse_expression_parser
 
 
 def attribute_name_generator(size=10):
     return ''.join(choice(ascii_uppercase)).join(choice(ascii_lowercase) for x in range(size - 1))
 
 
 @pytest.mark.noparallel(reason='uses pre-defined RSE, test_all_rse fails when run in parallel')
```

### Comparing `rucio-34.0.0rc2/tests/test_rse_lfn2path.py` & `rucio-34.1.0/tests/test_rse_lfn2path.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -11,22 +10,21 @@
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import copy
 import os
+from configparser import NoOptionError, NoSectionError
 
 import pytest
 
 from rucio.common import config
 from rucio.rse.protocols.protocol import RSEDeterministicTranslation
 
-from configparser import NoOptionError, NoSectionError
-
 
 @pytest.mark.noparallel(reason='uses pre-defined RSE, changes global configuration value')
 class TestDeterministicTranslation:
     """
     Verify the deterministic translator.
     """
```

### Comparing `rucio-34.0.0rc2/tests/test_rse_protocol_gfal2.py` & `rucio-34.1.0/tests/test_rse_protocol_gfal2.py`

 * *Files 3% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -15,15 +14,16 @@
 
 import os
 
 import pytest
 
 from rucio.common.utils import execute
 from rucio.rse import rsemanager as mgr
-from rucio.tests.common import skip_rse_tests_with_accounts, load_test_conf_file
+from rucio.tests.common import load_test_conf_file, skip_rse_tests_with_accounts
+
 from .rsemgr_api_test import MgrTestCases
 
 
 @skip_rse_tests_with_accounts
 class TestRseGFAL2(MgrTestCases):
 
     @classmethod
```

### Comparing `rucio-34.0.0rc2/tests/test_rse_protocol_gfal2_impl.py` & `rucio-34.1.0/tests/test_rse_protocol_gfal2_impl.py`

 * *Files 3% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -15,15 +14,16 @@
 
 import os
 
 import pytest
 
 from rucio.common.utils import execute
 from rucio.rse import rsemanager
-from rucio.tests.common import skip_rse_tests_with_accounts, load_test_conf_file
+from rucio.tests.common import load_test_conf_file, skip_rse_tests_with_accounts
+
 from .rsemgr_api_test import MgrTestCases
 
 
 @pytest.mark.noparallel(reason='creates and removes a test directory with a fixed name')
 @skip_rse_tests_with_accounts
 class TestRseGFAL2Impl(MgrTestCases):
```

### Comparing `rucio-34.0.0rc2/tests/test_rse_protocol_posix.py` & `rucio-34.1.0/tests/test_rse_protocol_posix.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -15,15 +14,16 @@
 
 import os
 import shutil
 
 import pytest
 
 from rucio.rse import rsemanager as mgr
-from rucio.tests.common import skip_rse_tests_with_accounts, load_test_conf_file
+from rucio.tests.common import load_test_conf_file, skip_rse_tests_with_accounts
+
 from .rsemgr_api_test import MgrTestCases
 
 
 def setup_posix_test_env(rse_name, rse_settings, user):
     """POSIX (RSE/PROTOCOLS): Creating necessary directories and files """
 
     data = load_test_conf_file('rse_repository.json')
```

### Comparing `rucio-34.0.0rc2/tests/test_rse_protocol_rclone.py` & `rucio-34.1.0/tests/test_rse_protocol_rclone.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -13,17 +12,18 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import os
 
 import pytest
 
-from rucio.common.utils import execute, PREFERRED_CHECKSUM, set_preferred_checksum
+from rucio.common.utils import PREFERRED_CHECKSUM, execute, set_preferred_checksum
 from rucio.rse import rsemanager
-from rucio.tests.common import skip_rse_tests_with_accounts, load_test_conf_file
+from rucio.tests.common import load_test_conf_file, skip_rse_tests_with_accounts
+
 from .rsemgr_api_test import MgrTestCases
 
 
 @pytest.mark.noparallel(reason='creates and removes a test directory with a fixed name')
 @skip_rse_tests_with_accounts
 class TestRseRCLONE(MgrTestCases):
     original_prefchecksum = PREFERRED_CHECKSUM
```

### Comparing `rucio-34.0.0rc2/tests/test_rse_protocol_rsync.py` & `rucio-34.1.0/tests/test_rse_protocol_rsync.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -13,17 +12,18 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import os
 
 import pytest
 
-from rucio.common.utils import execute, PREFERRED_CHECKSUM, set_preferred_checksum
+from rucio.common.utils import PREFERRED_CHECKSUM, execute, set_preferred_checksum
 from rucio.rse import rsemanager
-from rucio.tests.common import skip_rse_tests_with_accounts, load_test_conf_file
+from rucio.tests.common import load_test_conf_file, skip_rse_tests_with_accounts
+
 from .rsemgr_api_test import MgrTestCases
 
 
 @pytest.mark.noparallel(reason='creates and removes a test directory with a fixed name')
 @skip_rse_tests_with_accounts
 class TestRseRSYNC(MgrTestCases):
     original_prefchecksum = PREFERRED_CHECKSUM
```

### Comparing `rucio-34.0.0rc2/tests/test_rse_protocol_srm.py` & `rucio-34.1.0/tests/test_rse_protocol_srm.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -15,15 +14,16 @@
 
 import os
 
 import pytest
 
 from rucio.common.utils import execute
 from rucio.rse import rsemanager as mgr
-from rucio.tests.common import skip_rse_tests_with_accounts, load_test_conf_file
+from rucio.tests.common import load_test_conf_file, skip_rse_tests_with_accounts
+
 from .rsemgr_api_test import MgrTestCases
 
 
 @skip_rse_tests_with_accounts
 class TestRseSRM(MgrTestCases):
 
     @classmethod
```

### Comparing `rucio-34.0.0rc2/tests/test_rse_protocol_ssh.py` & `rucio-34.1.0/tests/test_rse_protocol_ssh.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -13,17 +12,18 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import os
 
 import pytest
 
-from rucio.common.utils import execute, PREFERRED_CHECKSUM, set_preferred_checksum
+from rucio.common.utils import PREFERRED_CHECKSUM, execute, set_preferred_checksum
 from rucio.rse import rsemanager
-from rucio.tests.common import skip_rse_tests_with_accounts, load_test_conf_file
+from rucio.tests.common import load_test_conf_file, skip_rse_tests_with_accounts
+
 from .rsemgr_api_test import MgrTestCases
 
 
 @pytest.mark.noparallel(reason='creates and removes a test directory with a fixed name')
 @skip_rse_tests_with_accounts
 class TestRseSSH(MgrTestCases):
     original_prefchecksum = PREFERRED_CHECKSUM
```

### Comparing `rucio-34.0.0rc2/tests/test_rse_protocol_webdav.py` & `rucio-34.1.0/tests/test_rse_protocol_webdav.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -16,15 +15,16 @@
 import os
 
 import pytest
 import requests
 
 from rucio.common.exception import FileReplicaAlreadyExists
 from rucio.rse import rsemanager
-from rucio.tests.common import skip_rse_tests_with_accounts, load_test_conf_file
+from rucio.tests.common import load_test_conf_file, skip_rse_tests_with_accounts
+
 from .rsemgr_api_test import MgrTestCases
 
 
 @skip_rse_tests_with_accounts
 class TestRseWebDAV(MgrTestCases):
     """
     Test the WebDAV protocol
```

### Comparing `rucio-34.0.0rc2/tests/test_rse_protocol_xrootd.py` & `rucio-34.1.0/tests/test_rse_protocol_xrootd.py`

 * *Files 6% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -15,15 +14,16 @@
 
 import os
 
 import pytest
 
 from rucio.common.utils import execute
 from rucio.rse import rsemanager
-from rucio.tests.common import skip_rse_tests_with_accounts, load_test_conf_file
+from rucio.tests.common import load_test_conf_file, skip_rse_tests_with_accounts
+
 from .rsemgr_api_test import MgrTestCases
 
 
 @pytest.mark.noparallel(reason='creates and removes a test directory with a fixed name')
 @skip_rse_tests_with_accounts
 class TestRseXROOTD(MgrTestCases):
```

### Comparing `rucio-34.0.0rc2/tests/test_rse_selector.py` & `rucio-34.1.0/tests/test_rse_selector.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -13,16 +12,16 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 
 import pytest
 
 from rucio.common.exception import InsufficientAccountLimit, InsufficientTargetRSEs
-from rucio.core.account_counter import update_account_counter, increase
-from rucio.core.account_limit import set_local_account_limit, set_global_account_limit
+from rucio.core.account_counter import increase, update_account_counter
+from rucio.core.account_limit import set_global_account_limit, set_local_account_limit
 from rucio.core.rse_selector import RSESelector
 
 
 @pytest.fixture
 def test_rses(rse_factory):
     rse1_name, rse1_id = rse_factory.make_mock_rse()
     rse2_name, rse2_id = rse_factory.make_mock_rse()
```

### Comparing `rucio-34.0.0rc2/tests/test_rucio_server.py` & `rucio-34.1.0/tests/test_rucio_server.py`

 * *Files 13% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
```

### Comparing `rucio-34.0.0rc2/tests/test_rule.py` & `rucio-34.1.0/tests/test_rule.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,61 +1,72 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-from collections import namedtuple
 import json
 import random
 import string
+from collections import namedtuple
 from logging import getLogger
+from typing import TYPE_CHECKING
 
 import pytest
 
 import rucio.api.rule
 from rucio.api.account import add_account
 from rucio.client.ruleclient import RuleClient
 from rucio.common.config import config_get_bool
-from rucio.common.exception import (RucioException, RuleNotFound, AccessDenied, InsufficientAccountLimit, DuplicateRule, RSEWriteBlocked,
-                                    RSEOverQuota, RuleReplaceFailed, ManualRuleApprovalBlocked, InputValidationError,
-                                    UnsupportedOperation, InvalidValueForKey, InvalidSourceReplicaExpression)
+from rucio.common.exception import (
+    AccessDenied,
+    DuplicateRule,
+    InputValidationError,
+    InsufficientAccountLimit,
+    InvalidSourceReplicaExpression,
+    InvalidValueForKey,
+    ManualRuleApprovalBlocked,
+    RSEOverQuota,
+    RSEWriteBlocked,
+    RucioException,
+    RuleNotFound,
+    RuleReplaceFailed,
+    UnsupportedOperation,
+)
 from rucio.common.policy import get_policy
 from rucio.common.schema import get_schema_value
 from rucio.common.types import InternalAccount, InternalScope
 from rucio.common.utils import generate_uuid as uuid
-from rucio.core.account import add_account_attribute, get_usage, get_account
-from rucio.core.account_limit import set_local_account_limit, set_global_account_limit
+from rucio.core.account import add_account_attribute, get_account, get_usage
+from rucio.core.account_limit import set_global_account_limit, set_local_account_limit
 from rucio.core.did import add_did, attach_dids, set_status
-from rucio.core.lock import get_replica_locks, get_dataset_locks, successful_transfer
+from rucio.core.lock import get_dataset_locks, get_replica_locks, successful_transfer
 from rucio.core.replica import add_replica, get_replica
 from rucio.core.request import get_request_by_did
-from rucio.core.rse import add_rse_attribute, add_rse, update_rse, get_rse_id, del_rse, del_rse_attribute, set_rse_limits
+from rucio.core.rse import add_rse, add_rse_attribute, del_rse, del_rse_attribute, get_rse_id, set_rse_limits, update_rse
 from rucio.core.rse_counter import get_counter as get_rse_counter
-from rucio.core.rule import add_rule, get_rule, delete_rule, add_rules, update_rule, reduce_rule, move_rule, list_rules
+from rucio.core.rule import add_rule, add_rules, delete_rule, get_rule, list_rules, move_rule, reduce_rule, update_rule
 from rucio.core.scope import add_scope
 from rucio.daemons.abacus.account import account_update
 from rucio.daemons.abacus.rse import rse_update
 from rucio.daemons.judge.evaluator import re_evaluator
 from rucio.db.sqla import models
-from rucio.db.sqla.constants import DIDType, OBSOLETE, RuleState, LockState
+from rucio.db.sqla.constants import OBSOLETE, DIDType, LockState, RuleState
 from rucio.db.sqla.session import transactional_session
-from rucio.tests.common import rse_name_generator, account_name_generator, did_name_generator
+from rucio.tests.common import account_name_generator, did_name_generator, rse_name_generator
 from rucio.tests.common_server import get_vo
 
-from typing import TYPE_CHECKING
 if TYPE_CHECKING:
     from .temp_factories import TemporaryDidFactory, TemporaryRSEFactory
 
 LOG = getLogger(__name__)
 RSE_namedtuple = namedtuple('RSE_namedtuple', ['name', 'id'])
 
 
@@ -177,17 +188,18 @@
         1) by deleting the source RSE
         2) by referring to the source RSE via an RSE attribute and then deleting
             said RSE attribute from the source RSE
         in both cases the source replica expression is invalidated since it
         evaluates to an empty set.
         """
 
-        from dogpile.cache.api import NO_VALUE
         from hashlib import sha256
 
+        from dogpile.cache.api import NO_VALUE
+
         # create RSEs A, B, C (structured into namedtuples)
         rseA, rseB, rseC = (
             RSE_namedtuple(*rse_factory.make_mock_rse()) for _ in range(3)
         )
         rsekey, rseval = tag_generator(), tag_generator()
         add_rse_attribute(rseA.id, rsekey, rseval)
 
@@ -1377,14 +1389,29 @@
 
         ret = rucio_client.list_did_rules(scope=mock_scope.external, name=dataset['name'])
         ids = [rule['id'] for rule in ret]
 
         assert rule_id_1 in ids
         assert rule_id_2 in ids
 
+    def test_list_rules_by_name(self, mock_scope, did_factory, jdoe_account, rucio_client):
+        """ NAME (CLIENT): List Replication Rules per NAME """
+        files = create_files(1, mock_scope, self.rse1_id)
+        dataset = did_factory.random_dataset_did()
+        add_did(did_type=DIDType.DATASET, account=jdoe_account, **dataset)
+        attach_dids(dids=files, account=jdoe_account, **dataset)
+
+        rule_id_1 = add_rule(dids=[dataset], account=jdoe_account, copies=1, rse_expression=self.rse1, grouping='NONE', weight='fakeweight', lifetime=None, locked=False, subscription_id=None)[0]
+        rule_id_2 = add_rule(dids=[dataset], account=jdoe_account, copies=1, rse_expression=self.rse2, grouping='NONE', weight='fakeweight', lifetime=None, locked=False, subscription_id=None)[0]
+        ret = rucio_client.list_associated_rules_for_file(scope=mock_scope.external, name=files[0]['name'])
+        ids = [rule['id'] for rule in ret]
+
+        assert rule_id_1 in ids
+        assert rule_id_2 in ids
+
     def test_get_rule(self, mock_scope, did_factory, jdoe_account):
         """ REPLICATION RULE (CLIENT): Get Replication Rule by id """
         activity = get_schema_value('ACTIVITY')['enum'][0]
         files = create_files(3, mock_scope, self.rse1_id)
         dataset = did_factory.random_dataset_did()
         add_did(did_type=DIDType.DATASET, account=jdoe_account, **dataset)
         attach_dids(dids=files, account=jdoe_account, **dataset)
@@ -1435,32 +1462,32 @@
     def test_change_rule_lifetime(self, mock_scope, did_factory, jdoe_account):
         """ REPLICATION RULE (CLIENT): Change rule lifetime"""
         files = create_files(3, mock_scope, self.rse1_id)
         dataset = did_factory.random_dataset_did()
         add_did(did_type=DIDType.DATASET, account=jdoe_account, **dataset)
         attach_dids(dids=files, account=jdoe_account, **dataset)
 
-        rule_id_1 = add_rule(dids=[dataset], account=jdoe_account, copies=1, rse_expression=self.rse1, grouping='DATASET', weight='fakeweight', lifetime=150, locked=True, subscription_id=None)[0]
+        rule_id_1 = add_rule(dids=[dataset], account=jdoe_account, copies=1, rse_expression=self.rse1, grouping='DATASET', weight='fakeweight', lifetime=None, locked=True, subscription_id=None)[0]
 
         get = self.rule_client.get_replication_rule(rule_id_1)
 
-        self.rule_client.update_replication_rule(rule_id_1, options={'lifetime': 10000})
+        self.rule_client.update_replication_rule(rule_id_1, options={'lifetime': -1})
 
         get2 = self.rule_client.get_replication_rule(rule_id_1)
 
         assert (get['expires_at'] != get2['expires_at'])
 
     def test_approve_rule(self, mock_scope, did_factory, jdoe_account):
         """ REPLICATION RULE (CLIENT): Approve rule"""
         files = create_files(3, mock_scope, self.rse1_id)
         dataset = did_factory.random_dataset_did()
         add_did(did_type=DIDType.DATASET, account=jdoe_account, **dataset)
         attach_dids(dids=files, account=jdoe_account, **dataset)
 
-        rule_id = add_rule(dids=[dataset], account=jdoe_account, copies=1, rse_expression=self.rse1, grouping='DATASET', weight='fakeweight', lifetime=150, locked=True, subscription_id=None, ask_approval=True)[0]
+        rule_id = add_rule(dids=[dataset], account=jdoe_account, copies=1, rse_expression=self.rse1, grouping='DATASET', weight='fakeweight', lifetime=None, locked=True, subscription_id=None, ask_approval=True)[0]
         rule = self.rule_client.get_replication_rule(rule_id)
         assert rule['state'] == RuleState.WAITING_APPROVAL.name
         self.rule_client.approve_replication_rule(rule_id)
         rule = self.rule_client.get_replication_rule(rule_id)
         assert rule['state'] == RuleState.INJECT.name
```

### Comparing `rucio-34.0.0rc2/tests/test_schema_cms.py` & `rucio-34.1.0/tests/test_schema_cms.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -14,15 +13,14 @@
 # limitations under the License.
 
 import pytest
 
 from rucio.common.exception import InvalidObject
 from rucio.common.schema.cms import validate_schema
 
-
 # Some tests adapted from https://github.com/dmwm/WMCore/blob/master/test/python/WMCore_t/Lexicon_t.py
 
 class TestSchemaCMS:
 
     def test_site_names(self):
         """ CMS SCHEMA (COMMON): Test site/RSE names """
         validate_schema('rse', 'T2_US_Nebraska')
```

### Comparing `rucio-34.0.0rc2/tests/test_scope.py` & `rucio-34.1.0/tests/test_scope.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -13,19 +12,19 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 from json import loads
 
 import pytest
 
-from rucio.common.exception import AccountNotFound, Duplicate, ScopeNotFound, InvalidObject
+from rucio.common.exception import AccountNotFound, Duplicate, InvalidObject, ScopeNotFound
 from rucio.common.types import InternalScope
 from rucio.common.utils import generate_uuid as uuid
-from rucio.core.scope import get_scopes, add_scope, is_scope_owner
-from rucio.tests.common import account_name_generator, scope_name_generator, headers, auth, hdrdict
+from rucio.core.scope import add_scope, get_scopes, is_scope_owner
+from rucio.tests.common import account_name_generator, auth, hdrdict, headers, scope_name_generator
 
 
 class TestScopeCoreApi:
 
     def test_list_scopes(self, vo, jdoe_account):
         scopes = [InternalScope(scope_name_generator(), vo=vo) for _ in range(5)]
         """ SCOPE (CORE): List scopes """
```

### Comparing `rucio-34.0.0rc2/tests/test_subscription.py` & `rucio-34.1.0/tests/test_subscription.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -15,30 +14,28 @@
 
 from datetime import datetime
 from json import loads
 from json.decoder import JSONDecodeError
 
 import pytest
 
-from rucio.api.subscription import list_subscriptions, add_subscription, update_subscription, \
-    list_subscription_rule_states, get_subscription_by_id
-from rucio.db.sqla.constants import RuleState
-from rucio.common.exception import InvalidObject, SubscriptionNotFound, SubscriptionDuplicate
+from rucio.api.subscription import add_subscription, get_subscription_by_id, list_subscription_rule_states, list_subscriptions, update_subscription
+from rucio.common.exception import InvalidObject, SubscriptionDuplicate, SubscriptionNotFound
 from rucio.common.schema import get_schema_value
 from rucio.common.types import InternalAccount, InternalScope
 from rucio.common.utils import generate_uuid as uuid
+from rucio.core import subscription as subscription_core
 from rucio.core.account import add_account
-from rucio.core.did import add_did, set_new_dids, list_new_dids, attach_dids, set_status
-from rucio.core.rule import add_rule
+from rucio.core.did import add_did, attach_dids, list_new_dids, set_new_dids, set_status
 from rucio.core.rse import add_rse_attribute
+from rucio.core.rule import add_rule
 from rucio.core.scope import add_scope
-from rucio.core import subscription as subscription_core
-from rucio.daemons.transmogrifier.transmogrifier import run, get_subscriptions
-from rucio.db.sqla.constants import AccountType, DIDType
-from rucio.tests.common import headers, auth, did_name_generator, rse_name_generator
+from rucio.daemons.transmogrifier.transmogrifier import get_subscriptions, run
+from rucio.db.sqla.constants import AccountType, DIDType, RuleState
+from rucio.tests.common import auth, did_name_generator, headers, rse_name_generator
 
 
 class TestSubscriptionCoreApi:
     projects = ['data12_900GeV', 'data12_8TeV', 'data13_900GeV', 'data13_8TeV']
     pattern1 = r'(_tid|physics_(Muons|JetTauEtmiss|Egamma)\..*\.ESD|express_express(?!.*NTUP|.*\.ESD|.*RAW)|(physics|express)(?!.*NTUP).* \
                 \.x|physics_WarmStart|calibration(?!_PixelBeam.merge.(NTUP_IDVTXLUMI|AOD))|merge.HIST|NTUP_MUONCALIB|NTUP_TRIG)'
     activity = get_schema_value('ACTIVITY')['enum'][0]
@@ -49,26 +46,26 @@
         rse2, _ = rse_factory.make_mock_rse()
         rse_expression = '%s|%s' % (rse1, rse2)
         subscription_name = uuid()
         with pytest.raises(InvalidObject):
             add_subscription(name=subscription_name,
                              account='root',
                              filter_={'project': self.projects, 'datatype': ['AOD', ], 'excluded_pattern': self.pattern1, 'account': ['tier0', ]},
-                             replication_rules=[{'lifetime': 86400, 'rse_expression': rse_expression, 'copies': 2, 'activity': 'noactivity'}],
+                             replication_rules=[{'rse_expression': rse_expression, 'copies': 2, 'activity': 'noactivity'}],
                              lifetime=100000,
                              retroactive=False,
                              dry_run=False,
                              comments='This is a comment',
                              issuer='root',
                              vo=vo)
 
         sub_id = add_subscription(name=subscription_name,
                                   account='root',
                                   filter_={'project': self.projects, 'datatype': ['AOD', ], 'excluded_pattern': self.pattern1, 'account': ['tier0', ]},
-                                  replication_rules=[{'lifetime': 86400, 'rse_expression': rse_expression, 'copies': 2, 'activity': self.activity}],
+                                  replication_rules=[{'rse_expression': rse_expression, 'copies': 2, 'activity': self.activity}],
                                   lifetime=100000,
                                   retroactive=False,
                                   dry_run=False,
                                   comments='This is a comment',
                                   issuer='root',
                                   vo=vo)
 
@@ -94,15 +91,15 @@
         rse1, _ = rse_factory.make_mock_rse()
         rse2, _ = rse_factory.make_mock_rse()
         rse_expression = '%s|%s' % (rse1, rse2)
         subscription_name = uuid()
         subscription_id = add_subscription(name=subscription_name,
                                            account='root',
                                            filter_={'project': self.projects, 'datatype': ['AOD', ], 'excluded_pattern': self.pattern1, 'account': ['tier0', ]},
-                                           replication_rules=[{'lifetime': 86400, 'rse_expression': rse_expression, 'copies': 2, 'activity': self.activity}],
+                                           replication_rules=[{'rse_expression': rse_expression, 'copies': 2, 'activity': self.activity}],
                                            lifetime=100000,
                                            retroactive=False,
                                            dry_run=False,
                                            comments='This is a comment',
                                            issuer='root',
                                            vo=vo)
 
@@ -117,15 +114,15 @@
         rse_expression = '%s|%s' % (rse1, rse2)
 
         def genkwargs(rse_expression):
             kwargs = {
                 'name': subscription_name,
                 'account': 'root',
                 'filter_': {'project': self.projects, 'datatype': ['AOD', ], 'excluded_pattern': self.pattern1, 'account': ['tier0', ]},
-                'replication_rules': [{'lifetime': 86400, 'rse_expression': rse_expression, 'copies': 2, 'activity': self.activity}],
+                'replication_rules': [{'rse_expression': rse_expression, 'copies': 2, 'activity': self.activity}],
                 'lifetime': 100000,
                 'retroactive': 0,
                 'dry_run': 0,
                 'comments': 'This is a comment',
                 'issuer': 'root'
             }
             kwargs.update({'vo': vo})
@@ -158,15 +155,15 @@
         add_did(scope=tmp_scope, name=dsn,
                 did_type=DIDType.DATASET, account=root_account)
 
         subscription_name = uuid()
         subid = add_subscription(name=subscription_name,
                                  account='root',
                                  filter_={'account': ['root', ], 'scope': [tmp_scope.external, ]},
-                                 replication_rules=[{'lifetime': 86400, 'rse_expression': rse_expression, 'copies': 2, 'activity': self.activity}],
+                                 replication_rules=[{'rse_expression': rse_expression, 'copies': 2, 'activity': self.activity}],
                                  lifetime=100000,
                                  retroactive=False,
                                  dry_run=False,
                                  comments='This is a comment',
                                  issuer='root',
                                  vo=vo)
 
@@ -185,15 +182,15 @@
     rse1, _ = rse_factory.make_mock_rse()
     rse2, _ = rse_factory.make_mock_rse()
     rse_expression = '%s|%s' % (rse1, rse2)
     projects = ['data12_900GeV', 'data12_8TeV', 'data13_900GeV', 'data13_8TeV']
     pattern1 = r'(_tid|physics_(Muons|JetTauEtmiss|Egamma)\..*\.ESD|express_express(?!.*NTUP|.*\.ESD|.*RAW)|(physics|express)(?!.*NTUP).* \
                  \.x|physics_WarmStart|calibration(?!_PixelBeam.merge.(NTUP_IDVTXLUMI|AOD))|merge.HIST|NTUP_MUONCALIB|NTUP_TRIG)'
     data = {'options': {'filter': {'project': projects, 'datatype': ['AOD', ], 'excluded_pattern': pattern1, 'account': ['tier0', ]},
-                        'replication_rules': [{'lifetime': 86400, 'rse_expression': rse_expression, 'copies': 2, 'activity': activity}],
+                        'replication_rules': [{'rse_expression': rse_expression, 'copies': 2, 'activity': activity}],
                         'lifetime': 100000, 'retroactive': 0, 'dry_run': 0, 'comments': 'blahblah'}}
     response = rest_client.post('/subscriptions/root/' + subscription_name, headers=headers(auth(auth_token)), json=data)
     assert response.status_code == 201
 
     data = {'options': {'filter': {'project': ['toto', ]}}}
     response = rest_client.put('/subscriptions/root/' + subscription_name, headers=headers(auth(auth_token)), json=data)
     assert response.status_code == 201
@@ -210,15 +207,15 @@
     rse1, _ = rse_factory.make_mock_rse()
     rse2, _ = rse_factory.make_mock_rse()
     rse_expression = '%s|%s' % (rse1, rse2)
     projects = ['data12_900GeV', 'data12_8TeV', 'data13_900GeV', 'data13_8TeV']
     pattern1 = r'(_tid|physics_(Muons|JetTauEtmiss|Egamma)\..*\.ESD|express_express(?!.*NTUP|.*\.ESD|.*RAW)|(physics|express)(?!.*NTUP).* \
                  \.x|physics_WarmStart|calibration(?!_PixelBeam.merge.(NTUP_IDVTXLUMI|AOD))|merge.HIST|NTUP_MUONCALIB|NTUP_TRIG)'
     data = {'options': {'filter': {'project': projects, 'datatype': ['AOD', ], 'excluded_pattern': pattern1, 'account': ['tier0', ]},
-                        'replication_rules': [{'lifetime': 86400, 'rse_expression': rse_expression, 'copies': 2, 'activity': activity}],
+                        'replication_rules': [{'rse_expression': rse_expression, 'copies': 2, 'activity': activity}],
                         'lifetime': 100000, 'retroactive': 0, 'dry_run': 0, 'comments': 'blahblah'}}
     response = rest_client.post('/subscriptions/root/' + subscription_name, headers=headers(auth(auth_token)), json=data)
     assert response.status_code == 201
 
     subscription_id = response.get_data(as_text=True)
     response = rest_client.get('/subscriptions/Id/' + subscription_id, headers=headers(auth(auth_token)))
     assert response.status_code == 200
@@ -232,15 +229,15 @@
     rse1, _ = rse_factory.make_mock_rse()
     rse2, _ = rse_factory.make_mock_rse()
     rse_expression = '%s|%s' % (rse1, rse2)
     projects = ['data12_900GeV', 'data12_8TeV', 'data13_900GeV', 'data13_8TeV']
     pattern1 = r'(_tid|physics_(Muons|JetTauEtmiss|Egamma)\..*\.ESD|express_express(?!.*NTUP|.*\.ESD|.*RAW)|(physics|express)(?!.*NTUP).* \
                  \.x|physics_WarmStart|calibration(?!_PixelBeam.merge.(NTUP_IDVTXLUMI|AOD))|merge.HIST|NTUP_MUONCALIB|NTUP_TRIG)'
     data = {'options': {'name': subscription_name, 'filter': {'project': projects, 'datatype': ['AOD', ], 'excluded_pattern': pattern1, 'account': ['tier0', ]},
-                        'replication_rules': [{'lifetime': 86400, 'rse_expression': rse_expression, 'copies': 2, 'activity': activity}],
+                        'replication_rules': [{'rse_expression': rse_expression, 'copies': 2, 'activity': activity}],
                         'lifetime': 100000, 'retroactive': 0, 'dry_run': 0, 'comments': 'We are the knights who say Ni !'}}
     response = rest_client.post('/subscriptions/root/' + subscription_name, headers=headers(auth(auth_token)), json=data)
     assert response.status_code == 201
 
     response = rest_client.post('/subscriptions/root/' + subscription_name, headers=headers(auth(auth_token)), json=data)
     assert response.status_code == 409
     assert response.headers.get('ExceptionClass') == 'SubscriptionDuplicate'
@@ -273,15 +270,15 @@
     add_did(scope=tmp_scope, name=dsn,
             did_type=DIDType.DATASET, account=root_account)
 
     subscription_name = uuid()
     subid = add_subscription(name=subscription_name,
                              account='root',
                              filter_={'account': ['root', ], 'scope': [tmp_scope.external, ]},
-                             replication_rules=[{'lifetime': 86400, 'rse_expression': rse_expression, 'copies': 2, 'activity': activity}],
+                             replication_rules=[{'rse_expression': rse_expression, 'copies': 2, 'activity': activity}],
                              lifetime=100000,
                              retroactive=False,
                              dry_run=False,
                              comments='We want a shrubbery',
                              issuer='root',
                              vo=vo)
 
@@ -314,17 +311,17 @@
         """ SUBSCRIPTION (CLIENT): Test the creation of a new subscription, update it, list it """
         subscription_name = uuid()
         rse1, _ = rse_factory.make_mock_rse()
         rse2, _ = rse_factory.make_mock_rse()
         rse_expression = '%s|%s' % (rse1, rse2)
         with pytest.raises(InvalidObject):
             subid = rucio_client.add_subscription(name=subscription_name, account='root', filter_={'project': self.projects, 'datatype': ['AOD', ], 'excluded_pattern': self.pattern1, 'account': ['tier0', ]},
-                                                  replication_rules=[{'lifetime': 86400, 'rse_expression': rse_expression, 'copies': 2, 'activity': 'noactivity'}], lifetime=100000, retroactive=False, dry_run=False, comments='Ni ! Ni!')
+                                                  replication_rules=[{'rse_expression': rse_expression, 'copies': 2, 'activity': 'noactivity'}], lifetime=100000, retroactive=False, dry_run=False, comments='Ni ! Ni!')
         subid = rucio_client.add_subscription(name=subscription_name, account='root', filter_={'project': self.projects, 'datatype': ['AOD', ], 'excluded_pattern': self.pattern1, 'account': ['tier0', ]},
-                                              replication_rules=[{'lifetime': 86400, 'rse_expression': rse_expression, 'copies': 2, 'activity': self.activity}], lifetime=100000, retroactive=False, dry_run=False, comments='Ni ! Ni!')
+                                              replication_rules=[{'rse_expression': rse_expression, 'copies': 2, 'activity': self.activity}], lifetime=100000, retroactive=False, dry_run=False, comments='Ni ! Ni!')
         result = [sub['id'] for sub in list_subscriptions(name=subscription_name, account='root', vo=vo)]
         assert subid == result[0]
         with pytest.raises(TypeError):
             result = rucio_client.update_subscription(name=subscription_name, account='root', filter_='toto')
         result = rucio_client.update_subscription(name=subscription_name, account='root', filter_={'project': ['toto', ]})
         assert result
         result = list_subscriptions(name=subscription_name, account='root', vo=vo)
@@ -337,19 +334,19 @@
     def test_create_existing_subscription(self, rse_factory, rucio_client):
         """ SUBSCRIPTION (CLIENT): Test the creation of a existing subscription """
         subscription_name = uuid()
         rse1, _ = rse_factory.make_mock_rse()
         rse2, _ = rse_factory.make_mock_rse()
         rse_expression = '%s|%s' % (rse1, rse2)
         result = rucio_client.add_subscription(name=subscription_name, account='root', filter_={'project': self.projects, 'datatype': ['AOD', ], 'excluded_pattern': self.pattern1, 'account': ['tier0', ]},
-                                               replication_rules=[{'lifetime': 86400, 'rse_expression': rse_expression, 'copies': 2, 'activity': self.activity}], lifetime=100000, retroactive=False, dry_run=False, comments='Ni ! Ni!')
+                                               replication_rules=[{'rse_expression': rse_expression, 'copies': 2, 'activity': self.activity}], lifetime=100000, retroactive=False, dry_run=False, comments='Ni ! Ni!')
         assert result
         with pytest.raises(SubscriptionDuplicate):
             rucio_client.add_subscription(name=subscription_name, account='root', filter_={'project': self.projects, 'datatype': ['AOD', ], 'excluded_pattern': self.pattern1, 'account': ['tier0', ]},
-                                          replication_rules=[{'lifetime': 86400, 'rse_expression': rse_expression, 'copies': 2, 'activity': self.activity}], lifetime=100000, retroactive=False, dry_run=False, comments='Ni ! Ni!')
+                                          replication_rules=[{'rse_expression': rse_expression, 'copies': 2, 'activity': self.activity}], lifetime=100000, retroactive=False, dry_run=False, comments='Ni ! Ni!')
 
     def test_update_nonexisting_subscription(self, rucio_client):
         """ SUBSCRIPTION (CLIENT): Test the update of a non-existing subscription """
         subscription_name = uuid()
         with pytest.raises(SubscriptionNotFound):
             rucio_client.update_subscription(name=subscription_name, filter_={'project': ['toto', ]})
 
@@ -358,26 +355,26 @@
         subscription_name = uuid()
         rse1, _ = rse_factory.make_mock_rse()
         rse2, _ = rse_factory.make_mock_rse()
         rse_expression = '%s|%s' % (rse1, rse2)
         account_name = uuid()[:10]
         add_account(InternalAccount(account_name, vo=vo), AccountType.USER, 'rucio@email.com')
         subid = rucio_client.add_subscription(name=subscription_name, account=account_name, filter_={'project': self.projects, 'datatype': ['AOD', ], 'excluded_pattern': self.pattern1, 'account': ['tier0', ]},
-                                              replication_rules=[{'lifetime': 86400, 'rse_expression': rse_expression, 'copies': 2, 'activity': self.activity}], lifetime=100000, retroactive=False, dry_run=False, comments='Ni ! Ni!')
+                                              replication_rules=[{'rse_expression': rse_expression, 'copies': 2, 'activity': self.activity}], lifetime=100000, retroactive=False, dry_run=False, comments='Ni ! Ni!')
         result = [sub['id'] for sub in rucio_client.list_subscriptions(account=account_name)]
         assert subid == result[0]
 
     def test_create_and_list_subscription_by_name(self, rse_factory, rucio_client):
         """ SUBSCRIPTION (CLIENT): Test retrieval of subscriptions for an account """
         subscription_name = uuid()
         rse1, _ = rse_factory.make_mock_rse()
         rse2, _ = rse_factory.make_mock_rse()
         rse_expression = '%s|%s' % (rse1, rse2)
         subid = rucio_client.add_subscription(name=subscription_name, account='root', filter_={'project': self.projects, 'datatype': ['AOD', ], 'excluded_pattern': self.pattern1, 'account': ['tier0', ]},
-                                              replication_rules=[{'lifetime': 86400, 'rse_expression': rse_expression, 'copies': 2, 'activity': self.activity}], lifetime=100000, retroactive=False, dry_run=False, comments='Ni ! Ni!')
+                                              replication_rules=[{'rse_expression': rse_expression, 'copies': 2, 'activity': self.activity}], lifetime=100000, retroactive=False, dry_run=False, comments='Ni ! Ni!')
         result = [sub['id'] for sub in rucio_client.list_subscriptions(name=subscription_name)]
         assert subid == result[0]
 
     @pytest.mark.noparallel(reason='runs transmogrifier. Cannot be run at the same time with other tests running it')
     def test_run_transmogrifier(self, vo, rse_factory, rucio_client, root_account):
         """ SUBSCRIPTION (DAEMON): Test the transmogrifier and the split_rule mode """
         new_dids = [did for did in list_new_dids(did_type=None, thread=None, total_threads=None, chunk_size=100000, session=None)]
@@ -391,15 +388,15 @@
         add_scope(tmp_scope, root_account)
         subscription_name = uuid()
         dsn_prefix = did_name_generator('dataset')
         dsn = '%sdataset-%s' % (dsn_prefix, uuid())
         add_did(scope=tmp_scope, name=dsn, did_type=DIDType.DATASET, account=root_account)
 
         subid = rucio_client.add_subscription(name=subscription_name, account='root', filter_={'scope': [tmp_scope.external, ], 'pattern': '%s.*' % dsn_prefix, 'split_rule': True},
-                                              replication_rules=[{'lifetime': 86400, 'rse_expression': rse_expression, 'copies': 2, 'activity': self.activity}],
+                                              replication_rules=[{'rse_expression': rse_expression, 'copies': 2, 'activity': self.activity}],
                                               lifetime=None, retroactive=False, dry_run=False, comments='Ni ! Ni!', priority=1)
         run(threads=1, bulk=1000000, once=True)
         rules = [rule for rule in rucio_client.list_did_rules(scope=tmp_scope.external, name=dsn) if str(rule['subscription_id']) == str(subid)]
         assert len(rules) == 2
         set_new_dids([{'scope': tmp_scope, 'name': dsn}, ], 1)
         run(threads=1, bulk=1000000, once=True)
         rules = [rule for rule in rucio_client.list_did_rules(scope=tmp_scope.external, name=dsn) if str(rule['subscription_id']) == str(subid)]
@@ -418,15 +415,15 @@
         add_scope(tmp_scope, root_account)
         subscription_name = uuid()
         dsn_prefix = did_name_generator('dataset')
         dsn = '%sdataset-%s' % (dsn_prefix, uuid())
         add_did(scope=tmp_scope, name=dsn, did_type=DIDType.DATASET, account=root_account)
 
         subid = rucio_client.add_subscription(name=subscription_name, account='root', filter_={'scope': [tmp_scope.external, ], 'pattern': '%s.*' % dsn_prefix, 'split_rule': True, 'did_type': ['DATASET', ]},
-                                              replication_rules=[{'lifetime': 86400, 'rse_expression': rse_expression, 'copies': 2, 'activity': self.activity}],
+                                              replication_rules=[{'rse_expression': rse_expression, 'copies': 2, 'activity': self.activity}],
                                               lifetime=None, retroactive=False, dry_run=False, comments='Ni ! Ni!', priority=1)
         run(threads=1, bulk=1000000, once=True)
         rules = [rule for rule in rucio_client.list_did_rules(scope=tmp_scope.external, name=dsn) if str(rule['subscription_id']) == str(subid)]
         assert len(rules) == 2
         set_new_dids([{'scope': tmp_scope, 'name': dsn}, ], 1)
         run(threads=1, bulk=1000000, once=True)
         rules = [rule for rule in rucio_client.list_did_rules(scope=tmp_scope.external, name=dsn) if str(rule['subscription_id']) == str(subid)]
```

### Comparing `rucio-34.0.0rc2/tests/test_throttler.py` & `rucio-34.1.0/tests/test_throttler.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -15,25 +14,32 @@
 
 from datetime import datetime, timedelta
 
 import pytest
 from sqlalchemy import delete
 
 from rucio.common.utils import generate_uuid
-from rucio.core.did import attach_dids, add_did
+from rucio.core.did import add_did, attach_dids
 from rucio.core.distance import add_distance
 from rucio.core.replica import add_replica
-from rucio.core.request import (queue_requests, get_request_by_did, release_waiting_requests_per_deadline,
-                                release_all_waiting_requests, release_waiting_requests_fifo, release_waiting_requests_grouped_fifo,
-                                release_waiting_requests_per_free_volume, delete_transfer_limit)
-from rucio.daemons.conveyor.throttler import throttler
+from rucio.core.request import (
+    delete_transfer_limit,
+    get_request_by_did,
+    queue_requests,
+    release_all_waiting_requests,
+    release_waiting_requests_fifo,
+    release_waiting_requests_grouped_fifo,
+    release_waiting_requests_per_deadline,
+    release_waiting_requests_per_free_volume,
+)
 from rucio.daemons.conveyor.preparer import preparer
+from rucio.daemons.conveyor.throttler import throttler
 from rucio.db.sqla import models
-from rucio.db.sqla.session import transactional_session, get_session
-from rucio.db.sqla.constants import DIDType, RequestType, RequestState, TransferLimitDirection
+from rucio.db.sqla.constants import DIDType, RequestState, RequestType, TransferLimitDirection
+from rucio.db.sqla.session import get_session, transactional_session
 from rucio.tests.common import skiplimitedsql
 
 
 @pytest.fixture
 def transfer_limit_factory():
     """
     Thin wrapper around request_core.set_transfer_limit, which cleans up
```

### Comparing `rucio-34.0.0rc2/tests/test_tpc.py` & `rucio-34.1.0/tests/test_tpc.py`

 * *Files 6% similar despite different names*

```diff
@@ -1,39 +1,38 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-import time
 import datetime
-import pytest
 import hashlib
 import re
+import time
 
+import pytest
+
+from rucio.client.rseclient import RSEClient
+from rucio.client.ruleclient import RuleClient
+from rucio.common.utils import generate_uuid, run_cmd_process
 from rucio.core.request import get_request_by_did, list_and_mark_transfer_requests_and_source_replicas
+from rucio.core.rule import add_rule
 from rucio.core.topology import Topology
 from rucio.core.transfer import ProtocolFactory
-from rucio.core.rule import add_rule
-from rucio.common.utils import generate_uuid
-from rucio.daemons.judge.evaluator import re_evaluator
-from rucio.daemons.conveyor import submitter, poller, finisher
+from rucio.daemons.conveyor import finisher, poller, submitter
 from rucio.daemons.conveyor.common import build_transfer_paths
-from rucio.client.rseclient import RSEClient
-from rucio.client.ruleclient import RuleClient
-from rucio.common.utils import run_cmd_process
+from rucio.daemons.judge.evaluator import re_evaluator
 
 MAX_POLL_WAIT_SECONDS = 60
 
 
 @pytest.fixture
 def rse_client():
     return RSEClient()
```

### Comparing `rucio-34.0.0rc2/tests/test_trace.py` & `rucio-34.1.0/tests/test_trace.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -10,23 +9,24 @@
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import datetime
+import json
+import logging
 import time
 import uuid
-import logging
+
 import pytest
-import json
+
+from rucio.common.exception import InvalidObject
 from rucio.common.schema.generic import IPv4orIPv6
 from rucio.core.trace import SCHEMAS, validate_schema
-from rucio.common.exception import InvalidObject
-
 
 LOGGER = logging.getLogger(__name__)
 
 
 def test_submit_trace(rest_client):
     """ TRACE (REST): submit a trace via POST """
     payload = {'uuid': str(uuid.uuid4()),  # str, because not JSON serializable
```

### Comparing `rucio-34.0.0rc2/tests/test_transfer.py` & `rucio-34.1.0/tests/test_transfer.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,40 +1,40 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-import pytest
-from concurrent.futures import ThreadPoolExecutor
 import datetime
+from concurrent.futures import ThreadPoolExecutor
+
+import pytest
 
 from rucio.common.exception import NoDistance
+from rucio.common.utils import generate_uuid
+from rucio.core import request as request_core
+from rucio.core import rse as rse_core
+from rucio.core import rule as rule_core
 from rucio.core.distance import add_distance
 from rucio.core.replica import add_replicas
 from rucio.core.request import list_and_mark_transfer_requests_and_source_replicas
-from rucio.core.transfer import build_transfer_paths, ProtocolFactory
-from rucio.core.topology import get_hops, Topology
-from rucio.core import rule as rule_core
-from rucio.core import request as request_core
-from rucio.core import rse as rse_core
+from rucio.core.topology import Topology, get_hops
+from rucio.core.transfer import ProtocolFactory, build_transfer_paths
+from rucio.daemons.conveyor.common import assign_paths_to_transfertool_and_create_hops, pick_and_prepare_submission_path
 from rucio.db.sqla import models
-from rucio.db.sqla.constants import RSEType, RequestState
+from rucio.db.sqla.constants import RequestState, RSEType
 from rucio.db.sqla.session import get_session
-from rucio.common.utils import generate_uuid
-from rucio.daemons.conveyor.common import assign_paths_to_transfertool_and_create_hops, pick_and_prepare_submission_path
 
 
 def _prepare_submission(rses):
     topology = Topology().configure_multihop()
     requests_with_sources = list_and_mark_transfer_requests_and_source_replicas(rse_collection=topology, rses=rses)
     pick_and_prepare_submission_path(requests_with_sources, topology=topology, protocol_factory=ProtocolFactory(), default_tombstone_delay=0)
```

### Comparing `rucio-34.0.0rc2/tests/test_transfer_plugins.py` & `rucio-34.1.0/tests/test_transfer_plugins.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,37 +1,34 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-import pytest
 import logging
 
-from rucio.transfertool.fts3 import FTS3Transfertool, build_job_params
-from rucio.core.topology import Topology
-from rucio.core.transfer import ProtocolFactory, build_transfer_paths
-from rucio.core.request import list_and_mark_transfer_requests_and_source_replicas
-
-from rucio.db.sqla.session import get_session
-from rucio.transfertool.fts3_plugins import FTS3TapeMetadataPlugin
+import pytest
 
 from rucio.core import distance as distance_core
 from rucio.core import replica as replica_core
 from rucio.core import rule as rule_core
-
+from rucio.core.request import list_and_mark_transfer_requests_and_source_replicas
+from rucio.core.topology import Topology
+from rucio.core.transfer import ProtocolFactory, build_transfer_paths
+from rucio.db.sqla.session import get_session
+from rucio.transfertool.fts3 import FTS3Transfertool, build_job_params
+from rucio.transfertool.fts3_plugins import FTS3TapeMetadataPlugin
 
 mock_session = get_session()
 
 MAX_POLL_WAIT_SECONDS = 60
 TEST_FTS_HOST = "https://fts:8446"
```

### Comparing `rucio-34.0.0rc2/tests/test_undertaker.py` & `rucio-34.1.0/tests/test_undertaker.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -17,22 +16,22 @@
 from logging import getLogger
 
 import pytest
 
 from rucio.common.policy import get_policy
 from rucio.common.types import InternalScope
 from rucio.core.account_limit import set_local_account_limit
-from rucio.core.did import add_dids, attach_dids, list_expired_dids, get_did, set_metadata
+from rucio.core.did import add_dids, attach_dids, get_did, list_expired_dids, set_metadata
 from rucio.core.replica import add_replicas, get_replica
 from rucio.core.rse import add_rse
 from rucio.core.rule import add_rules, list_rules
 from rucio.daemons.judge.cleaner import rule_cleaner
 from rucio.daemons.undertaker.undertaker import undertaker
 from rucio.db.sqla.util import json_implemented
-from rucio.tests.common import rse_name_generator, did_name_generator
+from rucio.tests.common import did_name_generator, rse_name_generator
 
 LOG = getLogger(__name__)
 
 
 @pytest.mark.dirty
 @pytest.mark.noparallel(reason='uses pre-defined rses; runs undertaker, which impacts other tests')
 class TestUndertaker:
```

### Comparing `rucio-34.0.0rc2/tests/test_upload.py` & `rucio-34.1.0/tests/test_upload.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -12,19 +11,20 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import json
 import logging
 import os
-import pytest
 import shutil
 from tempfile import TemporaryDirectory
 from unittest.mock import patch
 
+import pytest
+
 from rucio.client.uploadclient import UploadClient
 from rucio.common.config import config_add_section, config_set
 from rucio.common.exception import InputValidationError, NoFilesUploaded, NotAllFilesUploaded
 from rucio.common.utils import adler32, generate_uuid
 from rucio.core.rse import add_protocol, add_rse_attribute
```

### Comparing `rucio-34.0.0rc2/tests/test_utils.py` & `rucio-34.1.0/tests/test_utils.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -17,16 +16,16 @@
 import logging
 import os
 from re import match
 
 import pytest
 
 from rucio.common.exception import InvalidType
-from rucio.common.utils import md5, adler32, parse_did_filter_from_string, Availability, retrying, bittorrent_v2_merkle_sha256
 from rucio.common.logging import formatted_logger
+from rucio.common.utils import Availability, adler32, bittorrent_v2_merkle_sha256, md5, parse_did_filter_from_string, retrying
 
 
 class TestUtils:
     """UTILS (COMMON): test utilisty functions"""
 
     def test_utils_md5(self, file_factory):
         """(COMMON/UTILS): test calculating MD5 of a file"""
```

### Comparing `rucio-34.0.0rc2/tools/bootstrap.py` & `rucio-34.1.0/tools/bootstrap.py`

 * *Files 6% similar despite different names*

```diff
@@ -1,9 +1,8 @@
 #!/usr/bin/env python
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -16,19 +15,20 @@
 
 # Run this once to set up the database.
 #   PYTHONPATH=/opt/rucio/.venv/lib/python2.7/site-packages/rucio python tools/bootstrap.py
 #
 # Verify for default SQLite:
 #   for i in `sqlite3 /tmp/rucio.db ".tables"`; do echo $i:; sqlite3 /tmp/rucio.db "select * from $i"; echo; done
 
-import sys
 import os.path
+import sys
+
 base_path = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))
 sys.path.append(base_path)
 os.chdir(base_path)
 
-from rucio.db.sqla.util import (build_database, create_base_vo, create_root_account)  # noqa: E402
+from rucio.db.sqla.util import build_database, create_base_vo, create_root_account  # noqa: E402
 
 if __name__ == '__main__':
     build_database()
     create_base_vo()
     create_root_account()
```

### Comparing `rucio-34.0.0rc2/tools/merge_rucio_configs.py` & `rucio-34.1.0/tools/merge_rucio_configs.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
@@ -10,28 +9,26 @@
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import argparse
+import json
 import logging
-from pathlib import Path
-
 import os
-import json
 import sys
+from pathlib import Path
 
 try:
     import yaml
 except ImportError:
     yaml = None
 import configparser
 
-
 # Multi-word sections used in kubernetes are slightly different from what rucio expects.
 # Usually, it's just a .replace('-', '_'), but not for hermes2, which doesn't follow any convention.
 multi_word_sections = {
     'messaging_fts3': 'messaging-fts3',
     'messaging_cache': 'messaging-cache',
     'messaging_hermes': 'messaging-hermes',
     'messaging_hermes2': 'hermes',
```

### Comparing `rucio-34.0.0rc2/tools/reset_database.py` & `rucio-34.1.0/tools/reset_database.py`

 * *Files 10% similar despite different names*

```diff
@@ -1,32 +1,32 @@
 #!/usr/bin/env python3
-# -*- coding: utf-8 -*-
 # Copyright European Organization for Nuclear Research (CERN) since 2012
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #    http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-import sys
 import os.path
+import sys
+
 base_path = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))
 sys.path.append(base_path)
 os.chdir(base_path)
 
 from argparse import ArgumentParser  # noqa: E402
 
-from rucio.db.sqla.util import build_database, destroy_database, drop_everything, create_root_account, create_base_vo  # noqa: E402
+from rucio.db.sqla.util import build_database, create_base_vo, create_root_account, destroy_database, drop_everything  # noqa: E402
 
 if __name__ == '__main__':
 
     parser = ArgumentParser()
     parser.add_argument('-d', '--drop-everything', action="store_true", default=False, help='Drop all tables and constraints')
     args = parser.parse_args()
```

