# Comparing `tmp/dask-expr-1.0.5.tar.gz` & `tmp/dask-expr-1.0.6.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "dask-expr-1.0.5.tar", last modified: Fri Mar 22 17:04:23 2024, max compression
+gzip compressed data, was "dask-expr-1.0.6.tar", last modified: Mon Apr  1 19:51:20 2024, max compression
```

## Comparing `dask-expr-1.0.5.tar` & `dask-expr-1.0.6.tar`

### file list

```diff
@@ -1,59 +1,59 @@
-drwxr-xr-x   0 fjetter    (501) staff       (20)        0 2024-03-22 17:04:23.306012 dask-expr-1.0.5/
--rw-r--r--   0 fjetter    (501) staff       (20)     1516 2023-08-04 08:49:29.000000 dask-expr-1.0.5/LICENSE.txt
--rw-r--r--   0 fjetter    (501) staff       (20)     2426 2024-03-22 17:04:23.305923 dask-expr-1.0.5/PKG-INFO
--rw-r--r--   0 fjetter    (501) staff       (20)     1358 2024-03-19 12:56:24.000000 dask-expr-1.0.5/README.md
-drwxr-xr-x   0 fjetter    (501) staff       (20)        0 2024-03-22 17:04:23.306574 dask-expr-1.0.5/dask_expr/
--rw-r--r--   0 fjetter    (501) staff       (20)      714 2024-03-22 09:35:28.000000 dask-expr-1.0.5/dask_expr/__init__.py
--rw-r--r--   0 fjetter    (501) staff       (20)     3495 2024-02-20 13:42:44.000000 dask-expr-1.0.5/dask_expr/_accessor.py
--rw-r--r--   0 fjetter    (501) staff       (20)     3089 2024-03-12 10:46:19.000000 dask-expr-1.0.5/dask_expr/_backends.py
--rw-r--r--   0 fjetter    (501) staff       (20)     5913 2024-02-07 09:48:11.000000 dask-expr-1.0.5/dask_expr/_categorical.py
--rw-r--r--   0 fjetter    (501) staff       (20)   199867 2024-03-19 13:05:05.000000 dask-expr-1.0.5/dask_expr/_collection.py
--rw-r--r--   0 fjetter    (501) staff       (20)    12014 2024-03-22 17:00:35.000000 dask-expr-1.0.5/dask_expr/_concat.py
--rw-r--r--   0 fjetter    (501) staff       (20)    23178 2024-03-22 17:00:35.000000 dask-expr-1.0.5/dask_expr/_core.py
--rw-r--r--   0 fjetter    (501) staff       (20)     3402 2024-02-07 09:48:11.000000 dask-expr-1.0.5/dask_expr/_cumulative.py
--rw-r--r--   0 fjetter    (501) staff       (20)     1423 2023-12-06 14:27:33.000000 dask-expr-1.0.5/dask_expr/_datetime.py
--rw-r--r--   0 fjetter    (501) staff       (20)     3125 2024-02-07 09:48:11.000000 dask-expr-1.0.5/dask_expr/_describe.py
--rw-r--r--   0 fjetter    (501) staff       (20)      123 2024-02-07 09:48:11.000000 dask-expr-1.0.5/dask_expr/_dispatch.py
--rw-r--r--   0 fjetter    (501) staff       (20)     5500 2024-02-07 09:48:11.000000 dask-expr-1.0.5/dask_expr/_dummies.py
--rw-r--r--   0 fjetter    (501) staff       (20)   119003 2024-03-22 14:56:22.000000 dask-expr-1.0.5/dask_expr/_expr.py
--rw-r--r--   0 fjetter    (501) staff       (20)    66714 2024-03-19 12:56:24.000000 dask-expr-1.0.5/dask_expr/_groupby.py
--rw-r--r--   0 fjetter    (501) staff       (20)    11384 2024-03-22 17:00:35.000000 dask-expr-1.0.5/dask_expr/_indexing.py
--rw-r--r--   0 fjetter    (501) staff       (20)    30030 2024-03-22 14:56:22.000000 dask-expr-1.0.5/dask_expr/_merge.py
--rw-r--r--   0 fjetter    (501) staff       (20)    11712 2024-03-12 10:46:19.000000 dask-expr-1.0.5/dask_expr/_merge_asof.py
--rw-r--r--   0 fjetter    (501) staff       (20)     3903 2024-02-02 16:52:22.000000 dask-expr-1.0.5/dask_expr/_quantile.py
--rw-r--r--   0 fjetter    (501) staff       (20)     2491 2024-01-16 15:39:13.000000 dask-expr-1.0.5/dask_expr/_quantiles.py
--rw-r--r--   0 fjetter    (501) staff       (20)    43064 2024-03-22 17:00:35.000000 dask-expr-1.0.5/dask_expr/_reductions.py
--rw-r--r--   0 fjetter    (501) staff       (20)    16908 2024-03-19 12:56:24.000000 dask-expr-1.0.5/dask_expr/_repartition.py
--rw-r--r--   0 fjetter    (501) staff       (20)     7020 2024-02-07 09:48:11.000000 dask-expr-1.0.5/dask_expr/_resample.py
--rw-r--r--   0 fjetter    (501) staff       (20)     8765 2024-02-07 09:48:11.000000 dask-expr-1.0.5/dask_expr/_rolling.py
--rw-r--r--   0 fjetter    (501) staff       (20)    43784 2024-03-19 12:56:24.000000 dask-expr-1.0.5/dask_expr/_shuffle.py
--rw-r--r--   0 fjetter    (501) staff       (20)     5022 2024-03-19 12:56:24.000000 dask-expr-1.0.5/dask_expr/_str_accessor.py
--rw-r--r--   0 fjetter    (501) staff       (20)     6825 2024-03-19 12:56:24.000000 dask-expr-1.0.5/dask_expr/_util.py
--rw-r--r--   0 fjetter    (501) staff       (20)      497 2024-03-22 17:04:23.306607 dask-expr-1.0.5/dask_expr/_version.py
--rw-r--r--   0 fjetter    (501) staff       (20)     6636 2024-03-12 10:46:19.000000 dask-expr-1.0.5/dask_expr/datasets.py
-drwxr-xr-x   0 fjetter    (501) staff       (20)        0 2024-03-22 17:04:23.301683 dask-expr-1.0.5/dask_expr/diagnostics/
--rw-r--r--   0 fjetter    (501) staff       (20)      136 2024-03-19 13:05:05.000000 dask-expr-1.0.5/dask_expr/diagnostics/__init__.py
--rw-r--r--   0 fjetter    (501) staff       (20)     5125 2024-03-19 13:05:05.000000 dask-expr-1.0.5/dask_expr/diagnostics/_analyze.py
--rw-r--r--   0 fjetter    (501) staff       (20)     3943 2024-03-19 13:05:05.000000 dask-expr-1.0.5/dask_expr/diagnostics/_analyze_plugin.py
--rw-r--r--   0 fjetter    (501) staff       (20)     2614 2024-02-22 13:57:08.000000 dask-expr-1.0.5/dask_expr/diagnostics/_explain.py
-drwxr-xr-x   0 fjetter    (501) staff       (20)        0 2024-03-22 17:04:23.305380 dask-expr-1.0.5/dask_expr/io/
--rw-r--r--   0 fjetter    (501) staff       (20)       96 2023-06-21 11:20:58.000000 dask-expr-1.0.5/dask_expr/io/__init__.py
--rw-r--r--   0 fjetter    (501) staff       (20)     3938 2024-03-22 14:56:22.000000 dask-expr-1.0.5/dask_expr/io/_delayed.py
--rw-r--r--   0 fjetter    (501) staff       (20)      169 2024-02-07 09:48:11.000000 dask-expr-1.0.5/dask_expr/io/bag.py
--rw-r--r--   0 fjetter    (501) staff       (20)     3945 2024-02-07 09:48:11.000000 dask-expr-1.0.5/dask_expr/io/csv.py
--rw-r--r--   0 fjetter    (501) staff       (20)     1050 2024-02-07 09:48:11.000000 dask-expr-1.0.5/dask_expr/io/hdf.py
--rw-r--r--   0 fjetter    (501) staff       (20)    19498 2024-03-19 12:56:24.000000 dask-expr-1.0.5/dask_expr/io/io.py
--rw-r--r--   0 fjetter    (501) staff       (20)     1535 2024-02-07 09:48:11.000000 dask-expr-1.0.5/dask_expr/io/json.py
--rw-r--r--   0 fjetter    (501) staff       (20)      954 2024-02-07 09:48:11.000000 dask-expr-1.0.5/dask_expr/io/orc.py
--rw-r--r--   0 fjetter    (501) staff       (20)    62283 2024-03-22 09:35:28.000000 dask-expr-1.0.5/dask_expr/io/parquet.py
--rw-r--r--   0 fjetter    (501) staff       (20)       90 2024-02-07 09:48:11.000000 dask-expr-1.0.5/dask_expr/io/records.py
--rw-r--r--   0 fjetter    (501) staff       (20)     2262 2024-02-07 09:48:11.000000 dask-expr-1.0.5/dask_expr/io/sql.py
-drwxr-xr-x   0 fjetter    (501) staff       (20)        0 2024-03-22 17:04:23.305623 dask-expr-1.0.5/dask_expr.egg-info/
--rw-r--r--   0 fjetter    (501) staff       (20)     2426 2024-03-22 17:04:23.000000 dask-expr-1.0.5/dask_expr.egg-info/PKG-INFO
--rw-r--r--   0 fjetter    (501) staff       (20)     1239 2024-03-22 17:04:23.000000 dask-expr-1.0.5/dask_expr.egg-info/SOURCES.txt
--rw-r--r--   0 fjetter    (501) staff       (20)        1 2024-03-22 17:04:23.000000 dask-expr-1.0.5/dask_expr.egg-info/dependency_links.txt
--rw-r--r--   0 fjetter    (501) staff       (20)       40 2024-03-22 17:04:23.000000 dask-expr-1.0.5/dask_expr.egg-info/requires.txt
--rw-r--r--   0 fjetter    (501) staff       (20)       10 2024-03-22 17:04:23.000000 dask-expr-1.0.5/dask_expr.egg-info/top_level.txt
--rw-r--r--   0 fjetter    (501) staff       (20)     2195 2024-03-22 14:56:22.000000 dask-expr-1.0.5/pyproject.toml
--rw-r--r--   0 fjetter    (501) staff       (20)      230 2024-03-22 17:04:23.306429 dask-expr-1.0.5/setup.cfg
--rwxr-xr-x   0 fjetter    (501) staff       (20)      194 2023-08-04 08:49:29.000000 dask-expr-1.0.5/setup.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-01 19:51:20.126563 dask-expr-1.0.6/
+-rw-r--r--   0 james      (501) staff       (20)     1516 2024-04-01 19:20:57.000000 dask-expr-1.0.6/LICENSE.txt
+-rw-r--r--   0 james      (501) staff       (20)     2426 2024-04-01 19:51:20.126490 dask-expr-1.0.6/PKG-INFO
+-rw-r--r--   0 james      (501) staff       (20)     1358 2024-04-01 19:20:57.000000 dask-expr-1.0.6/README.md
+drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-01 19:51:20.126975 dask-expr-1.0.6/dask_expr/
+-rw-r--r--   0 james      (501) staff       (20)      714 2024-04-01 19:20:57.000000 dask-expr-1.0.6/dask_expr/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)     3495 2024-04-01 19:20:57.000000 dask-expr-1.0.6/dask_expr/_accessor.py
+-rw-r--r--   0 james      (501) staff       (20)     3089 2024-04-01 19:20:57.000000 dask-expr-1.0.6/dask_expr/_backends.py
+-rw-r--r--   0 james      (501) staff       (20)     5913 2024-04-01 19:20:57.000000 dask-expr-1.0.6/dask_expr/_categorical.py
+-rw-r--r--   0 james      (501) staff       (20)   201017 2024-04-01 19:20:57.000000 dask-expr-1.0.6/dask_expr/_collection.py
+-rw-r--r--   0 james      (501) staff       (20)    12014 2024-04-01 19:20:57.000000 dask-expr-1.0.6/dask_expr/_concat.py
+-rw-r--r--   0 james      (501) staff       (20)    23241 2024-04-01 19:20:57.000000 dask-expr-1.0.6/dask_expr/_core.py
+-rw-r--r--   0 james      (501) staff       (20)     3402 2024-04-01 19:20:57.000000 dask-expr-1.0.6/dask_expr/_cumulative.py
+-rw-r--r--   0 james      (501) staff       (20)     1423 2024-04-01 19:20:57.000000 dask-expr-1.0.6/dask_expr/_datetime.py
+-rw-r--r--   0 james      (501) staff       (20)     3125 2024-04-01 19:20:57.000000 dask-expr-1.0.6/dask_expr/_describe.py
+-rw-r--r--   0 james      (501) staff       (20)      123 2024-04-01 19:20:57.000000 dask-expr-1.0.6/dask_expr/_dispatch.py
+-rw-r--r--   0 james      (501) staff       (20)     5500 2024-04-01 19:20:57.000000 dask-expr-1.0.6/dask_expr/_dummies.py
+-rw-r--r--   0 james      (501) staff       (20)   119003 2024-04-01 19:20:57.000000 dask-expr-1.0.6/dask_expr/_expr.py
+-rw-r--r--   0 james      (501) staff       (20)    66714 2024-04-01 19:20:57.000000 dask-expr-1.0.6/dask_expr/_groupby.py
+-rw-r--r--   0 james      (501) staff       (20)    11390 2024-04-01 19:20:57.000000 dask-expr-1.0.6/dask_expr/_indexing.py
+-rw-r--r--   0 james      (501) staff       (20)    30030 2024-04-01 19:20:57.000000 dask-expr-1.0.6/dask_expr/_merge.py
+-rw-r--r--   0 james      (501) staff       (20)    11712 2024-04-01 19:20:57.000000 dask-expr-1.0.6/dask_expr/_merge_asof.py
+-rw-r--r--   0 james      (501) staff       (20)     3903 2024-04-01 19:20:57.000000 dask-expr-1.0.6/dask_expr/_quantile.py
+-rw-r--r--   0 james      (501) staff       (20)     2491 2024-04-01 19:20:57.000000 dask-expr-1.0.6/dask_expr/_quantiles.py
+-rw-r--r--   0 james      (501) staff       (20)    43064 2024-04-01 19:20:57.000000 dask-expr-1.0.6/dask_expr/_reductions.py
+-rw-r--r--   0 james      (501) staff       (20)    16908 2024-04-01 19:20:57.000000 dask-expr-1.0.6/dask_expr/_repartition.py
+-rw-r--r--   0 james      (501) staff       (20)     7020 2024-04-01 19:20:57.000000 dask-expr-1.0.6/dask_expr/_resample.py
+-rw-r--r--   0 james      (501) staff       (20)     8765 2024-04-01 19:20:57.000000 dask-expr-1.0.6/dask_expr/_rolling.py
+-rw-r--r--   0 james      (501) staff       (20)    43784 2024-04-01 19:20:57.000000 dask-expr-1.0.6/dask_expr/_shuffle.py
+-rw-r--r--   0 james      (501) staff       (20)     5022 2024-04-01 19:20:57.000000 dask-expr-1.0.6/dask_expr/_str_accessor.py
+-rw-r--r--   0 james      (501) staff       (20)     6825 2024-04-01 19:20:57.000000 dask-expr-1.0.6/dask_expr/_util.py
+-rw-r--r--   0 james      (501) staff       (20)      497 2024-04-01 19:51:20.127017 dask-expr-1.0.6/dask_expr/_version.py
+-rw-r--r--   0 james      (501) staff       (20)     6636 2024-04-01 19:20:57.000000 dask-expr-1.0.6/dask_expr/datasets.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-01 19:51:20.123332 dask-expr-1.0.6/dask_expr/diagnostics/
+-rw-r--r--   0 james      (501) staff       (20)      136 2024-04-01 19:20:57.000000 dask-expr-1.0.6/dask_expr/diagnostics/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)     5125 2024-04-01 19:20:57.000000 dask-expr-1.0.6/dask_expr/diagnostics/_analyze.py
+-rw-r--r--   0 james      (501) staff       (20)     3943 2024-04-01 19:20:57.000000 dask-expr-1.0.6/dask_expr/diagnostics/_analyze_plugin.py
+-rw-r--r--   0 james      (501) staff       (20)     2614 2024-04-01 19:20:57.000000 dask-expr-1.0.6/dask_expr/diagnostics/_explain.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-01 19:51:20.126001 dask-expr-1.0.6/dask_expr/io/
+-rw-r--r--   0 james      (501) staff       (20)       96 2024-04-01 19:20:51.000000 dask-expr-1.0.6/dask_expr/io/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)     3938 2024-04-01 19:20:57.000000 dask-expr-1.0.6/dask_expr/io/_delayed.py
+-rw-r--r--   0 james      (501) staff       (20)      171 2024-04-01 19:20:57.000000 dask-expr-1.0.6/dask_expr/io/bag.py
+-rw-r--r--   0 james      (501) staff       (20)     3947 2024-04-01 19:20:57.000000 dask-expr-1.0.6/dask_expr/io/csv.py
+-rw-r--r--   0 james      (501) staff       (20)     1056 2024-04-01 19:20:57.000000 dask-expr-1.0.6/dask_expr/io/hdf.py
+-rw-r--r--   0 james      (501) staff       (20)    19484 2024-04-01 19:20:57.000000 dask-expr-1.0.6/dask_expr/io/io.py
+-rw-r--r--   0 james      (501) staff       (20)     1657 2024-04-01 19:20:57.000000 dask-expr-1.0.6/dask_expr/io/json.py
+-rw-r--r--   0 james      (501) staff       (20)     1076 2024-04-01 19:20:57.000000 dask-expr-1.0.6/dask_expr/io/orc.py
+-rw-r--r--   0 james      (501) staff       (20)    62734 2024-04-01 19:20:57.000000 dask-expr-1.0.6/dask_expr/io/parquet.py
+-rw-r--r--   0 james      (501) staff       (20)       90 2024-04-01 19:20:57.000000 dask-expr-1.0.6/dask_expr/io/records.py
+-rw-r--r--   0 james      (501) staff       (20)     2272 2024-04-01 19:20:57.000000 dask-expr-1.0.6/dask_expr/io/sql.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-01 19:51:20.126215 dask-expr-1.0.6/dask_expr.egg-info/
+-rw-r--r--   0 james      (501) staff       (20)     2426 2024-04-01 19:51:20.000000 dask-expr-1.0.6/dask_expr.egg-info/PKG-INFO
+-rw-r--r--   0 james      (501) staff       (20)     1239 2024-04-01 19:51:20.000000 dask-expr-1.0.6/dask_expr.egg-info/SOURCES.txt
+-rw-r--r--   0 james      (501) staff       (20)        1 2024-04-01 19:51:20.000000 dask-expr-1.0.6/dask_expr.egg-info/dependency_links.txt
+-rw-r--r--   0 james      (501) staff       (20)       40 2024-04-01 19:51:20.000000 dask-expr-1.0.6/dask_expr.egg-info/requires.txt
+-rw-r--r--   0 james      (501) staff       (20)       10 2024-04-01 19:51:20.000000 dask-expr-1.0.6/dask_expr.egg-info/top_level.txt
+-rw-r--r--   0 james      (501) staff       (20)     2195 2024-04-01 19:43:24.000000 dask-expr-1.0.6/pyproject.toml
+-rw-r--r--   0 james      (501) staff       (20)      230 2024-04-01 19:51:20.126836 dask-expr-1.0.6/setup.cfg
+-rwxr-xr-x   0 james      (501) staff       (20)      194 2024-04-01 19:20:57.000000 dask-expr-1.0.6/setup.py
```

### Comparing `dask-expr-1.0.5/LICENSE.txt` & `dask-expr-1.0.6/LICENSE.txt`

 * *Files identical despite different names*

### Comparing `dask-expr-1.0.5/PKG-INFO` & `dask-expr-1.0.6/PKG-INFO`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: dask-expr
-Version: 1.0.5
+Version: 1.0.6
 Summary: High Level Expressions for Dask 
 Maintainer-email: Matthew Rocklin <mrocklin@gmail.com>
 License: BSD
 Project-URL: Source code, https://github.com/dask-contrib/dask-expr/
 Keywords: dask pandas
 Classifier: Intended Audience :: Developers
 Classifier: Intended Audience :: Science/Research
@@ -18,15 +18,15 @@
 Classifier: Programming Language :: Python :: 3.11
 Classifier: Programming Language :: Python :: 3.12
 Classifier: Topic :: Scientific/Engineering
 Classifier: Topic :: System :: Distributed Computing
 Requires-Python: >=3.9
 Description-Content-Type: text/markdown
 License-File: LICENSE.txt
-Requires-Dist: dask==2024.3.1
+Requires-Dist: dask==2024.4.0
 Requires-Dist: pyarrow>=7.0.0
 Requires-Dist: pandas>=2
 
 Dask Expressions
 ================
 
 Dask DataFrames with query optimization.
```

### Comparing `dask-expr-1.0.5/README.md` & `dask-expr-1.0.6/README.md`

 * *Files identical despite different names*

### Comparing `dask-expr-1.0.5/dask_expr/__init__.py` & `dask-expr-1.0.6/dask_expr/__init__.py`

 * *Files identical despite different names*

### Comparing `dask-expr-1.0.5/dask_expr/_accessor.py` & `dask-expr-1.0.6/dask_expr/_accessor.py`

 * *Files identical despite different names*

### Comparing `dask-expr-1.0.5/dask_expr/_backends.py` & `dask-expr-1.0.6/dask_expr/_backends.py`

 * *Files identical despite different names*

### Comparing `dask-expr-1.0.5/dask_expr/_categorical.py` & `dask-expr-1.0.6/dask_expr/_categorical.py`

 * *Files identical despite different names*

### Comparing `dask-expr-1.0.5/dask_expr/_collection.py` & `dask-expr-1.0.6/dask_expr/_collection.py`

 * *Files 0% similar despite different names*

```diff
@@ -268,12225 +268,12297 @@
 000010b0: 7220 3d20 6f74 6865 722e 6578 7072 0a20  r = other.expr. 
 000010c0: 2020 2065 6c69 6620 6973 696e 7374 616e     elif isinstan
 000010d0: 6365 286f 7468 6572 2c20 6461 2e41 7272  ce(other, da.Arr
 000010e0: 6179 293a 0a20 2020 2020 2020 206f 7468  ay):.        oth
 000010f0: 6572 203d 2066 726f 6d5f 6461 736b 5f61  er = from_dask_a
 00001100: 7272 6179 280a 2020 2020 2020 2020 2020  rray(.          
 00001110: 2020 6f74 6865 722c 2069 6e64 6578 3d73    other, index=s
-00001120: 656c 662e 696e 6465 782e 746f 5f64 6173  elf.index.to_das
-00001130: 6b5f 6461 7461 6672 616d 6528 292c 2063  k_dataframe(), c
-00001140: 6f6c 756d 6e73 3d73 656c 662e 636f 6c75  olumns=self.colu
-00001150: 6d6e 730a 2020 2020 2020 2020 290a 2020  mns.        ).  
-00001160: 2020 2020 2020 6966 2073 656c 662e 6e64        if self.nd
-00001170: 696d 203d 3d20 3120 616e 6420 6c65 6e28  im == 1 and len(
-00001180: 7365 6c66 2e63 6f6c 756d 6e73 293a 0a20  self.columns):. 
-00001190: 2020 2020 2020 2020 2020 206f 7468 6572             other
-000011a0: 203d 206f 7468 6572 5b73 656c 662e 636f   = other[self.co
-000011b0: 6c75 6d6e 735b 305d 5d0a 0a20 2020 2069  lumns[0]]..    i
-000011c0: 6620 280a 2020 2020 2020 2020 6e6f 7420  f (.        not 
-000011d0: 6973 696e 7374 616e 6365 286f 7468 6572  isinstance(other
-000011e0: 2c20 6578 7072 2e45 7870 7229 0a20 2020  , expr.Expr).   
-000011f0: 2020 2020 2061 6e64 2069 735f 6461 7461       and is_data
-00001200: 6672 616d 655f 6c69 6b65 286f 7468 6572  frame_like(other
-00001210: 290a 2020 2020 2020 2020 6f72 2069 735f  ).        or is_
-00001220: 7365 7269 6573 5f6c 696b 6528 6f74 6865  series_like(othe
-00001230: 7229 0a20 2020 2029 3a0a 2020 2020 2020  r).    ):.      
-00001240: 2020 6f74 6865 7220 3d20 7365 6c66 2e5f    other = self._
-00001250: 6372 6561 7465 5f61 6c69 676e 6162 6c65  create_alignable
-00001260: 5f66 7261 6d65 286f 7468 6572 292e 6578  _frame(other).ex
-00001270: 7072 0a0a 2020 2020 6966 206e 6f74 2069  pr..    if not i
-00001280: 7369 6e73 7461 6e63 6528 6f74 6865 722c  sinstance(other,
-00001290: 2065 7870 722e 4578 7072 293a 0a20 2020   expr.Expr):.   
-000012a0: 2020 2020 2072 6574 7572 6e20 6e65 775f       return new_
-000012b0: 636f 6c6c 6563 7469 6f6e 2867 6574 6174  collection(getat
-000012c0: 7472 2873 656c 662e 6578 7072 2c20 6f70  tr(self.expr, op
-000012d0: 2928 6f74 6865 7229 290a 2020 2020 656c  )(other)).    el
-000012e0: 6966 2065 7870 722e 6172 655f 636f 5f61  if expr.are_co_a
-000012f0: 6c69 676e 6564 2873 656c 662e 6578 7072  ligned(self.expr
-00001300: 2c20 6f74 6865 7229 3a0a 2020 2020 2020  , other):.      
-00001310: 2020 7265 7475 726e 206e 6577 5f63 6f6c    return new_col
-00001320: 6c65 6374 696f 6e28 6765 7461 7474 7228  lection(getattr(
-00001330: 7365 6c66 2e65 7870 722c 206f 7029 286f  self.expr, op)(o
-00001340: 7468 6572 2929 0a20 2020 2065 6c73 653a  ther)).    else:
-00001350: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00001360: 6e65 775f 636f 6c6c 6563 7469 6f6e 2865  new_collection(e
-00001370: 7870 722e 4f70 416c 6967 6e50 6172 7469  xpr.OpAlignParti
-00001380: 7469 6f6e 7328 7365 6c66 2c20 6f74 6865  tions(self, othe
-00001390: 722c 206f 7029 290a 0a0a 6465 6620 5f77  r, op))...def _w
-000013a0: 7261 705f 6578 7072 5f6d 6574 686f 645f  rap_expr_method_
-000013b0: 6f70 6572 6174 6f72 286e 616d 652c 2063  operator(name, c
-000013c0: 6c61 7373 5f29 3a0a 2020 2020 2222 220a  lass_):.    """.
-000013d0: 2020 2020 4164 6420 6d65 7468 6f64 206f      Add method o
-000013e0: 7065 7261 746f 7273 2074 6f20 5365 7269  perators to Seri
-000013f0: 6573 206f 7220 4461 7461 4672 616d 6520  es or DataFrame 
-00001400: 6c69 6b65 2044 6174 6146 7261 6d65 2e61  like DataFrame.a
-00001410: 6464 2e0a 2020 2020 5f77 7261 705f 6578  dd..    _wrap_ex
-00001420: 7072 5f6d 6574 686f 645f 6f70 6572 6174  pr_method_operat
-00001430: 6f72 2822 6164 6422 2c20 4461 7461 4672  or("add", DataFr
-00001440: 616d 6529 0a20 2020 2022 2222 0a20 2020  ame).    """.   
-00001450: 2069 6620 636c 6173 735f 203d 3d20 4461   if class_ == Da
-00001460: 7461 4672 616d 653a 0a0a 2020 2020 2020  taFrame:..      
-00001470: 2020 6465 6620 6d65 7468 6f64 2873 656c    def method(sel
-00001480: 662c 206f 7468 6572 2c20 6178 6973 3d22  f, other, axis="
-00001490: 636f 6c75 6d6e 7322 2c20 6c65 7665 6c3d  columns", level=
-000014a0: 4e6f 6e65 2c20 6669 6c6c 5f76 616c 7565  None, fill_value
-000014b0: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
-000014c0: 2020 2020 6966 206c 6576 656c 2069 7320      if level is 
-000014d0: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-000014e0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-000014f0: 4e6f 7449 6d70 6c65 6d65 6e74 6564 4572  NotImplementedEr
-00001500: 726f 7228 226c 6576 656c 206d 7573 7420  ror("level must 
-00001510: 6265 204e 6f6e 6522 290a 0a20 2020 2020  be None")..     
-00001520: 2020 2020 2020 2061 7869 7320 3d20 5f76         axis = _v
-00001530: 616c 6964 6174 655f 6178 6973 2861 7869  alidate_axis(axi
-00001540: 7329 0a0a 2020 2020 2020 2020 2020 2020  s)..            
-00001550: 6966 2028 0a20 2020 2020 2020 2020 2020  if (.           
-00001560: 2020 2020 2069 735f 6461 7461 6672 616d       is_datafram
-00001570: 655f 6c69 6b65 286f 7468 6572 290a 2020  e_like(other).  
-00001580: 2020 2020 2020 2020 2020 2020 2020 6f72                or
-00001590: 2069 735f 7365 7269 6573 5f6c 696b 6528   is_series_like(
-000015a0: 6f74 6865 7229 0a20 2020 2020 2020 2020  other).         
-000015b0: 2020 2020 2020 2061 6e64 2061 7869 7320         and axis 
-000015c0: 696e 2028 302c 2022 696e 6465 7822 290a  in (0, "index").
-000015d0: 2020 2020 2020 2020 2020 2020 2920 616e              ) an
-000015e0: 6420 6e6f 7420 6973 5f64 6173 6b5f 636f  d not is_dask_co
-000015f0: 6c6c 6563 7469 6f6e 286f 7468 6572 293a  llection(other):
-00001600: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00001610: 206f 7468 6572 203d 2073 656c 662e 5f63   other = self._c
-00001620: 7265 6174 655f 616c 6967 6e61 626c 655f  reate_alignable_
-00001630: 6672 616d 6528 6f74 6865 7229 0a0a 2020  frame(other)..  
-00001640: 2020 2020 2020 2020 2020 6966 2061 7869            if axi
-00001650: 7320 696e 2028 312c 2022 636f 6c75 6d6e  s in (1, "column
-00001660: 7322 293a 0a20 2020 2020 2020 2020 2020  s"):.           
-00001670: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
-00001680: 6365 286f 7468 6572 2c20 5365 7269 6573  ce(other, Series
-00001690: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-000016a0: 2020 2020 2020 206d 7367 203d 2066 2255         msg = f"U
-000016b0: 6e61 626c 6520 746f 207b 6e61 6d65 7d20  nable to {name} 
-000016c0: 6464 2e53 6572 6965 7320 7769 7468 2061  dd.Series with a
-000016d0: 7869 733d 3122 0a20 2020 2020 2020 2020  xis=1".         
-000016e0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-000016f0: 2056 616c 7565 4572 726f 7228 6d73 6729   ValueError(msg)
-00001700: 0a0a 2020 2020 2020 2020 2020 2020 6672  ..            fr
-00001710: 616d 6520 3d20 7365 6c66 0a20 2020 2020  ame = self.     
-00001720: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-00001730: 616e 6365 286f 7468 6572 2c20 4672 616d  ance(other, Fram
-00001740: 6542 6173 6529 2061 6e64 206e 6f74 2065  eBase) and not e
-00001750: 7870 722e 6172 655f 636f 5f61 6c69 676e  xpr.are_co_align
-00001760: 6564 280a 2020 2020 2020 2020 2020 2020  ed(.            
-00001770: 2020 2020 7365 6c66 2e65 7870 722c 206f      self.expr, o
-00001780: 7468 6572 2e65 7870 720a 2020 2020 2020  ther.expr.      
-00001790: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
-000017a0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-000017b0: 6e65 775f 636f 6c6c 6563 7469 6f6e 280a  new_collection(.
-000017c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000017d0: 2020 2020 6578 7072 2e4d 6574 686f 644f      expr.MethodO
-000017e0: 7065 7261 746f 7241 6c69 676e 280a 2020  peratorAlign(.  
+00001120: 656c 662e 696e 6465 782e 746f 5f6c 6567  elf.index.to_leg
+00001130: 6163 795f 6461 7461 6672 616d 6528 292c  acy_dataframe(),
+00001140: 2063 6f6c 756d 6e73 3d73 656c 662e 636f   columns=self.co
+00001150: 6c75 6d6e 730a 2020 2020 2020 2020 290a  lumns.        ).
+00001160: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00001170: 6e64 696d 203d 3d20 3120 616e 6420 6c65  ndim == 1 and le
+00001180: 6e28 7365 6c66 2e63 6f6c 756d 6e73 293a  n(self.columns):
+00001190: 0a20 2020 2020 2020 2020 2020 206f 7468  .            oth
+000011a0: 6572 203d 206f 7468 6572 5b73 656c 662e  er = other[self.
+000011b0: 636f 6c75 6d6e 735b 305d 5d0a 0a20 2020  columns[0]]..   
+000011c0: 2069 6620 280a 2020 2020 2020 2020 6e6f   if (.        no
+000011d0: 7420 6973 696e 7374 616e 6365 286f 7468  t isinstance(oth
+000011e0: 6572 2c20 6578 7072 2e45 7870 7229 0a20  er, expr.Expr). 
+000011f0: 2020 2020 2020 2061 6e64 2069 735f 6461         and is_da
+00001200: 7461 6672 616d 655f 6c69 6b65 286f 7468  taframe_like(oth
+00001210: 6572 290a 2020 2020 2020 2020 6f72 2069  er).        or i
+00001220: 735f 7365 7269 6573 5f6c 696b 6528 6f74  s_series_like(ot
+00001230: 6865 7229 0a20 2020 2029 3a0a 2020 2020  her).    ):.    
+00001240: 2020 2020 6f74 6865 7220 3d20 7365 6c66      other = self
+00001250: 2e5f 6372 6561 7465 5f61 6c69 676e 6162  ._create_alignab
+00001260: 6c65 5f66 7261 6d65 286f 7468 6572 292e  le_frame(other).
+00001270: 6578 7072 0a0a 2020 2020 6966 206e 6f74  expr..    if not
+00001280: 2069 7369 6e73 7461 6e63 6528 6f74 6865   isinstance(othe
+00001290: 722c 2065 7870 722e 4578 7072 293a 0a20  r, expr.Expr):. 
+000012a0: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
+000012b0: 775f 636f 6c6c 6563 7469 6f6e 2867 6574  w_collection(get
+000012c0: 6174 7472 2873 656c 662e 6578 7072 2c20  attr(self.expr, 
+000012d0: 6f70 2928 6f74 6865 7229 290a 2020 2020  op)(other)).    
+000012e0: 656c 6966 2065 7870 722e 6172 655f 636f  elif expr.are_co
+000012f0: 5f61 6c69 676e 6564 2873 656c 662e 6578  _aligned(self.ex
+00001300: 7072 2c20 6f74 6865 7229 3a0a 2020 2020  pr, other):.    
+00001310: 2020 2020 7265 7475 726e 206e 6577 5f63      return new_c
+00001320: 6f6c 6c65 6374 696f 6e28 6765 7461 7474  ollection(getatt
+00001330: 7228 7365 6c66 2e65 7870 722c 206f 7029  r(self.expr, op)
+00001340: 286f 7468 6572 2929 0a20 2020 2065 6c73  (other)).    els
+00001350: 653a 0a20 2020 2020 2020 2072 6574 7572  e:.        retur
+00001360: 6e20 6e65 775f 636f 6c6c 6563 7469 6f6e  n new_collection
+00001370: 2865 7870 722e 4f70 416c 6967 6e50 6172  (expr.OpAlignPar
+00001380: 7469 7469 6f6e 7328 7365 6c66 2c20 6f74  titions(self, ot
+00001390: 6865 722c 206f 7029 290a 0a0a 6465 6620  her, op))...def 
+000013a0: 5f77 7261 705f 6578 7072 5f6d 6574 686f  _wrap_expr_metho
+000013b0: 645f 6f70 6572 6174 6f72 286e 616d 652c  d_operator(name,
+000013c0: 2063 6c61 7373 5f29 3a0a 2020 2020 2222   class_):.    ""
+000013d0: 220a 2020 2020 4164 6420 6d65 7468 6f64  ".    Add method
+000013e0: 206f 7065 7261 746f 7273 2074 6f20 5365   operators to Se
+000013f0: 7269 6573 206f 7220 4461 7461 4672 616d  ries or DataFram
+00001400: 6520 6c69 6b65 2044 6174 6146 7261 6d65  e like DataFrame
+00001410: 2e61 6464 2e0a 2020 2020 5f77 7261 705f  .add..    _wrap_
+00001420: 6578 7072 5f6d 6574 686f 645f 6f70 6572  expr_method_oper
+00001430: 6174 6f72 2822 6164 6422 2c20 4461 7461  ator("add", Data
+00001440: 4672 616d 6529 0a20 2020 2022 2222 0a20  Frame).    """. 
+00001450: 2020 2069 6620 636c 6173 735f 203d 3d20     if class_ == 
+00001460: 4461 7461 4672 616d 653a 0a0a 2020 2020  DataFrame:..    
+00001470: 2020 2020 6465 6620 6d65 7468 6f64 2873      def method(s
+00001480: 656c 662c 206f 7468 6572 2c20 6178 6973  elf, other, axis
+00001490: 3d22 636f 6c75 6d6e 7322 2c20 6c65 7665  ="columns", leve
+000014a0: 6c3d 4e6f 6e65 2c20 6669 6c6c 5f76 616c  l=None, fill_val
+000014b0: 7565 3d4e 6f6e 6529 3a0a 2020 2020 2020  ue=None):.      
+000014c0: 2020 2020 2020 6966 206c 6576 656c 2069        if level i
+000014d0: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
+000014e0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+000014f0: 6520 4e6f 7449 6d70 6c65 6d65 6e74 6564  e NotImplemented
+00001500: 4572 726f 7228 226c 6576 656c 206d 7573  Error("level mus
+00001510: 7420 6265 204e 6f6e 6522 290a 0a20 2020  t be None")..   
+00001520: 2020 2020 2020 2020 2061 7869 7320 3d20           axis = 
+00001530: 5f76 616c 6964 6174 655f 6178 6973 2861  _validate_axis(a
+00001540: 7869 7329 0a0a 2020 2020 2020 2020 2020  xis)..          
+00001550: 2020 6966 2028 0a20 2020 2020 2020 2020    if (.         
+00001560: 2020 2020 2020 2069 735f 6461 7461 6672         is_datafr
+00001570: 616d 655f 6c69 6b65 286f 7468 6572 290a  ame_like(other).
+00001580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001590: 6f72 2069 735f 7365 7269 6573 5f6c 696b  or is_series_lik
+000015a0: 6528 6f74 6865 7229 0a20 2020 2020 2020  e(other).       
+000015b0: 2020 2020 2020 2020 2061 6e64 2061 7869           and axi
+000015c0: 7320 696e 2028 302c 2022 696e 6465 7822  s in (0, "index"
+000015d0: 290a 2020 2020 2020 2020 2020 2020 2920  ).            ) 
+000015e0: 616e 6420 6e6f 7420 6973 5f64 6173 6b5f  and not is_dask_
+000015f0: 636f 6c6c 6563 7469 6f6e 286f 7468 6572  collection(other
+00001600: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00001610: 2020 206f 7468 6572 203d 2073 656c 662e     other = self.
+00001620: 5f63 7265 6174 655f 616c 6967 6e61 626c  _create_alignabl
+00001630: 655f 6672 616d 6528 6f74 6865 7229 0a0a  e_frame(other)..
+00001640: 2020 2020 2020 2020 2020 2020 6966 2061              if a
+00001650: 7869 7320 696e 2028 312c 2022 636f 6c75  xis in (1, "colu
+00001660: 6d6e 7322 293a 0a20 2020 2020 2020 2020  mns"):.         
+00001670: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+00001680: 616e 6365 286f 7468 6572 2c20 5365 7269  ance(other, Seri
+00001690: 6573 293a 0a20 2020 2020 2020 2020 2020  es):.           
+000016a0: 2020 2020 2020 2020 206d 7367 203d 2066           msg = f
+000016b0: 2255 6e61 626c 6520 746f 207b 6e61 6d65  "Unable to {name
+000016c0: 7d20 6464 2e53 6572 6965 7320 7769 7468  } dd.Series with
+000016d0: 2061 7869 733d 3122 0a20 2020 2020 2020   axis=1".       
+000016e0: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+000016f0: 7365 2056 616c 7565 4572 726f 7228 6d73  se ValueError(ms
+00001700: 6729 0a0a 2020 2020 2020 2020 2020 2020  g)..            
+00001710: 6672 616d 6520 3d20 7365 6c66 0a20 2020  frame = self.   
+00001720: 2020 2020 2020 2020 2069 6620 6973 696e           if isin
+00001730: 7374 616e 6365 286f 7468 6572 2c20 4672  stance(other, Fr
+00001740: 616d 6542 6173 6529 2061 6e64 206e 6f74  ameBase) and not
+00001750: 2065 7870 722e 6172 655f 636f 5f61 6c69   expr.are_co_ali
+00001760: 676e 6564 280a 2020 2020 2020 2020 2020  gned(.          
+00001770: 2020 2020 2020 7365 6c66 2e65 7870 722c        self.expr,
+00001780: 206f 7468 6572 2e65 7870 720a 2020 2020   other.expr.    
+00001790: 2020 2020 2020 2020 293a 0a20 2020 2020          ):.     
+000017a0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+000017b0: 6e20 6e65 775f 636f 6c6c 6563 7469 6f6e  n new_collection
+000017c0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+000017d0: 2020 2020 2020 6578 7072 2e4d 6574 686f        expr.Metho
+000017e0: 644f 7065 7261 746f 7241 6c69 676e 280a  dOperatorAlign(.
 000017f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001800: 2020 2020 2020 6f70 3d6e 616d 652c 0a20        op=name,. 
-00001810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001820: 2020 2020 2020 2066 7261 6d65 3d66 7261         frame=fra
-00001830: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
-00001840: 2020 2020 2020 2020 2020 2020 6f74 6865              othe
-00001850: 723d 6f74 6865 722c 0a20 2020 2020 2020  r=other,.       
+00001800: 2020 2020 2020 2020 6f70 3d6e 616d 652c          op=name,
+00001810: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00001820: 2020 2020 2020 2020 2066 7261 6d65 3d66           frame=f
+00001830: 7261 6d65 2c0a 2020 2020 2020 2020 2020  rame,.          
+00001840: 2020 2020 2020 2020 2020 2020 2020 6f74                ot
+00001850: 6865 723d 6f74 6865 722c 0a20 2020 2020  her=other,.     
 00001860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001870: 2061 7869 733d 6178 6973 2c0a 2020 2020   axis=axis,.    
+00001870: 2020 2061 7869 733d 6178 6973 2c0a 2020     axis=axis,.  
 00001880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001890: 2020 2020 6c65 7665 6c3d 6c65 7665 6c2c      level=level,
-000018a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000018b0: 2020 2020 2020 2020 2066 696c 6c5f 7661           fill_va
-000018c0: 6c75 653d 6669 6c6c 5f76 616c 7565 2c0a  lue=fill_value,.
-000018d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000018e0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-000018f0: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-00001900: 2020 2020 2072 6574 7572 6e20 6e65 775f       return new_
-00001910: 636f 6c6c 6563 7469 6f6e 280a 2020 2020  collection(.    
-00001920: 2020 2020 2020 2020 2020 2020 6578 7072              expr
-00001930: 2e4d 6574 686f 644f 7065 7261 746f 7228  .MethodOperator(
-00001940: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00001950: 2020 2020 206e 616d 653d 6e61 6d65 2c0a       name=name,.
-00001960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001970: 2020 2020 6c65 6674 3d66 7261 6d65 2c0a      left=frame,.
-00001980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001990: 2020 2020 7269 6768 743d 6f74 6865 722c      right=other,
-000019a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000019b0: 2020 2020 2061 7869 733d 6178 6973 2c0a       axis=axis,.
-000019c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000019d0: 2020 2020 6c65 7665 6c3d 6c65 7665 6c2c      level=level,
-000019e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000019f0: 2020 2020 2066 696c 6c5f 7661 6c75 653d       fill_value=
-00001a00: 6669 6c6c 5f76 616c 7565 2c0a 2020 2020  fill_value,.    
-00001a10: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00001a20: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-00001a30: 2065 6c69 6620 636c 6173 735f 203d 3d20   elif class_ == 
-00001a40: 5365 7269 6573 3a0a 0a20 2020 2020 2020  Series:..       
-00001a50: 2064 6566 206d 6574 686f 6428 7365 6c66   def method(self
-00001a60: 2c20 6f74 6865 722c 206c 6576 656c 3d4e  , other, level=N
-00001a70: 6f6e 652c 2066 696c 6c5f 7661 6c75 653d  one, fill_value=
-00001a80: 4e6f 6e65 2c20 6178 6973 3d30 293a 0a20  None, axis=0):. 
-00001a90: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
-00001aa0: 7665 6c20 6973 206e 6f74 204e 6f6e 653a  vel is not None:
-00001ab0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00001ac0: 2072 6169 7365 204e 6f74 496d 706c 656d   raise NotImplem
-00001ad0: 656e 7465 6445 7272 6f72 2822 6c65 7665  entedError("leve
-00001ae0: 6c20 6d75 7374 2062 6520 4e6f 6e65 2229  l must be None")
-00001af0: 0a0a 2020 2020 2020 2020 2020 2020 6178  ..            ax
-00001b00: 6973 203d 205f 7661 6c69 6461 7465 5f61  is = _validate_a
-00001b10: 7869 7328 6178 6973 290a 0a20 2020 2020  xis(axis)..     
-00001b20: 2020 2020 2020 2069 6620 6973 5f73 6572         if is_ser
-00001b30: 6965 735f 6c69 6b65 286f 7468 6572 2920  ies_like(other) 
-00001b40: 616e 6420 6e6f 7420 6973 5f64 6173 6b5f  and not is_dask_
-00001b50: 636f 6c6c 6563 7469 6f6e 286f 7468 6572  collection(other
-00001b60: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00001b70: 2020 206f 7468 6572 203d 2073 656c 662e     other = self.
-00001b80: 5f63 7265 6174 655f 616c 6967 6e61 626c  _create_alignabl
-00001b90: 655f 6672 616d 6528 6f74 6865 7229 0a0a  e_frame(other)..
-00001ba0: 2020 2020 2020 2020 2020 2020 6672 616d              fram
-00001bb0: 6520 3d20 7365 6c66 0a20 2020 2020 2020  e = self.       
-00001bc0: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
-00001bd0: 6365 286f 7468 6572 2c20 4672 616d 6542  ce(other, FrameB
-00001be0: 6173 6529 2061 6e64 206e 6f74 2065 7870  ase) and not exp
-00001bf0: 722e 6172 655f 636f 5f61 6c69 676e 6564  r.are_co_aligned
-00001c00: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00001c10: 2020 7365 6c66 2e65 7870 722c 206f 7468    self.expr, oth
-00001c20: 6572 2e65 7870 720a 2020 2020 2020 2020  er.expr.        
-00001c30: 2020 2020 293a 0a20 2020 2020 2020 2020      ):.         
-00001c40: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
-00001c50: 775f 636f 6c6c 6563 7469 6f6e 280a 2020  w_collection(.  
+00001890: 2020 2020 2020 6c65 7665 6c3d 6c65 7665        level=leve
+000018a0: 6c2c 0a20 2020 2020 2020 2020 2020 2020  l,.             
+000018b0: 2020 2020 2020 2020 2020 2066 696c 6c5f             fill_
+000018c0: 7661 6c75 653d 6669 6c6c 5f76 616c 7565  value=fill_value
+000018d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000018e0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+000018f0: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+00001900: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
+00001910: 775f 636f 6c6c 6563 7469 6f6e 280a 2020  w_collection(.  
+00001920: 2020 2020 2020 2020 2020 2020 2020 6578                ex
+00001930: 7072 2e4d 6574 686f 644f 7065 7261 746f  pr.MethodOperato
+00001940: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
+00001950: 2020 2020 2020 206e 616d 653d 6e61 6d65         name=name
+00001960: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00001970: 2020 2020 2020 6c65 6674 3d66 7261 6d65        left=frame
+00001980: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00001990: 2020 2020 2020 7269 6768 743d 6f74 6865        right=othe
+000019a0: 722c 0a20 2020 2020 2020 2020 2020 2020  r,.             
+000019b0: 2020 2020 2020 2061 7869 733d 6178 6973         axis=axis
+000019c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000019d0: 2020 2020 2020 6c65 7665 6c3d 6c65 7665        level=leve
+000019e0: 6c2c 0a20 2020 2020 2020 2020 2020 2020  l,.             
+000019f0: 2020 2020 2020 2066 696c 6c5f 7661 6c75         fill_valu
+00001a00: 653d 6669 6c6c 5f76 616c 7565 2c0a 2020  e=fill_value,.  
+00001a10: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+00001a20: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+00001a30: 2020 2065 6c69 6620 636c 6173 735f 203d     elif class_ =
+00001a40: 3d20 5365 7269 6573 3a0a 0a20 2020 2020  = Series:..     
+00001a50: 2020 2064 6566 206d 6574 686f 6428 7365     def method(se
+00001a60: 6c66 2c20 6f74 6865 722c 206c 6576 656c  lf, other, level
+00001a70: 3d4e 6f6e 652c 2066 696c 6c5f 7661 6c75  =None, fill_valu
+00001a80: 653d 4e6f 6e65 2c20 6178 6973 3d30 293a  e=None, axis=0):
+00001a90: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00001aa0: 6c65 7665 6c20 6973 206e 6f74 204e 6f6e  level is not Non
+00001ab0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00001ac0: 2020 2072 6169 7365 204e 6f74 496d 706c     raise NotImpl
+00001ad0: 656d 656e 7465 6445 7272 6f72 2822 6c65  ementedError("le
+00001ae0: 7665 6c20 6d75 7374 2062 6520 4e6f 6e65  vel must be None
+00001af0: 2229 0a0a 2020 2020 2020 2020 2020 2020  ")..            
+00001b00: 6178 6973 203d 205f 7661 6c69 6461 7465  axis = _validate
+00001b10: 5f61 7869 7328 6178 6973 290a 0a20 2020  _axis(axis)..   
+00001b20: 2020 2020 2020 2020 2069 6620 6973 5f73           if is_s
+00001b30: 6572 6965 735f 6c69 6b65 286f 7468 6572  eries_like(other
+00001b40: 2920 616e 6420 6e6f 7420 6973 5f64 6173  ) and not is_das
+00001b50: 6b5f 636f 6c6c 6563 7469 6f6e 286f 7468  k_collection(oth
+00001b60: 6572 293a 0a20 2020 2020 2020 2020 2020  er):.           
+00001b70: 2020 2020 206f 7468 6572 203d 2073 656c       other = sel
+00001b80: 662e 5f63 7265 6174 655f 616c 6967 6e61  f._create_aligna
+00001b90: 626c 655f 6672 616d 6528 6f74 6865 7229  ble_frame(other)
+00001ba0: 0a0a 2020 2020 2020 2020 2020 2020 6672  ..            fr
+00001bb0: 616d 6520 3d20 7365 6c66 0a20 2020 2020  ame = self.     
+00001bc0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+00001bd0: 616e 6365 286f 7468 6572 2c20 4672 616d  ance(other, Fram
+00001be0: 6542 6173 6529 2061 6e64 206e 6f74 2065  eBase) and not e
+00001bf0: 7870 722e 6172 655f 636f 5f61 6c69 676e  xpr.are_co_align
+00001c00: 6564 280a 2020 2020 2020 2020 2020 2020  ed(.            
+00001c10: 2020 2020 7365 6c66 2e65 7870 722c 206f      self.expr, o
+00001c20: 7468 6572 2e65 7870 720a 2020 2020 2020  ther.expr.      
+00001c30: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
+00001c40: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00001c50: 6e65 775f 636f 6c6c 6563 7469 6f6e 280a  new_collection(.
 00001c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001c70: 2020 6578 7072 2e4d 6574 686f 644f 7065    expr.MethodOpe
-00001c80: 7261 746f 7241 6c69 676e 280a 2020 2020  ratorAlign(.    
+00001c70: 2020 2020 6578 7072 2e4d 6574 686f 644f      expr.MethodO
+00001c80: 7065 7261 746f 7241 6c69 676e 280a 2020  peratorAlign(.  
 00001c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001ca0: 2020 2020 6f70 3d6e 616d 652c 0a20 2020      op=name,.   
+00001ca0: 2020 2020 2020 6f70 3d6e 616d 652c 0a20        op=name,. 
 00001cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001cc0: 2020 2020 2066 7261 6d65 3d66 7261 6d65       frame=frame
-00001cd0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00001ce0: 2020 2020 2020 2020 2020 6f74 6865 723d            other=
-00001cf0: 6f74 6865 722c 0a20 2020 2020 2020 2020  other,.         
-00001d00: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-00001d10: 7869 733d 6178 6973 2c0a 2020 2020 2020  xis=axis,.      
+00001cc0: 2020 2020 2020 2066 7261 6d65 3d66 7261         frame=fra
+00001cd0: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
+00001ce0: 2020 2020 2020 2020 2020 2020 6f74 6865              othe
+00001cf0: 723d 6f74 6865 722c 0a20 2020 2020 2020  r=other,.       
+00001d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001d10: 2061 7869 733d 6178 6973 2c0a 2020 2020   axis=axis,.    
 00001d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001d30: 2020 6c65 7665 6c3d 6c65 7665 6c2c 0a20    level=level,. 
-00001d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001d50: 2020 2020 2020 2066 696c 6c5f 7661 6c75         fill_valu
-00001d60: 653d 6669 6c6c 5f76 616c 7565 2c0a 2020  e=fill_value,.  
+00001d30: 2020 2020 6c65 7665 6c3d 6c65 7665 6c2c      level=level,
+00001d40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00001d50: 2020 2020 2020 2020 2066 696c 6c5f 7661           fill_va
+00001d60: 6c75 653d 6669 6c6c 5f76 616c 7565 2c0a  lue=fill_value,.
 00001d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001d80: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-00001d90: 2020 2020 290a 0a20 2020 2020 2020 2020      )..         
-00001da0: 2020 2072 6574 7572 6e20 6e65 775f 636f     return new_co
-00001db0: 6c6c 6563 7469 6f6e 280a 2020 2020 2020  llection(.      
-00001dc0: 2020 2020 2020 2020 2020 6578 7072 2e4d            expr.M
-00001dd0: 6574 686f 644f 7065 7261 746f 7228 0a20  ethodOperator(. 
-00001de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001df0: 2020 206e 616d 653d 6e61 6d65 2c0a 2020     name=name,.  
+00001d80: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+00001d90: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+00001da0: 2020 2020 2072 6574 7572 6e20 6e65 775f       return new_
+00001db0: 636f 6c6c 6563 7469 6f6e 280a 2020 2020  collection(.    
+00001dc0: 2020 2020 2020 2020 2020 2020 6578 7072              expr
+00001dd0: 2e4d 6574 686f 644f 7065 7261 746f 7228  .MethodOperator(
+00001de0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00001df0: 2020 2020 206e 616d 653d 6e61 6d65 2c0a       name=name,.
 00001e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001e10: 2020 6c65 6674 3d66 7261 6d65 2c0a 2020    left=frame,.  
+00001e10: 2020 2020 6c65 6674 3d66 7261 6d65 2c0a      left=frame,.
 00001e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001e30: 2020 7269 6768 743d 6f74 6865 722c 0a20    right=other,. 
-00001e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001e50: 2020 2061 7869 733d 6178 6973 2c0a 2020     axis=axis,.  
+00001e30: 2020 2020 7269 6768 743d 6f74 6865 722c      right=other,
+00001e40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00001e50: 2020 2020 2061 7869 733d 6178 6973 2c0a       axis=axis,.
 00001e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001e70: 2020 6669 6c6c 5f76 616c 7565 3d66 696c    fill_value=fil
-00001e80: 6c5f 7661 6c75 652c 0a20 2020 2020 2020  l_value,.       
-00001e90: 2020 2020 2020 2020 2020 2020 206c 6576               lev
-00001ea0: 656c 3d6c 6576 656c 2c0a 2020 2020 2020  el=level,.      
-00001eb0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00001ec0: 2020 2020 2020 2020 290a 0a20 2020 2065          )..    e
-00001ed0: 6c73 653a 0a20 2020 2020 2020 2072 6169  lse:.        rai
-00001ee0: 7365 204e 6f74 496d 706c 656d 656e 7465  se NotImplemente
-00001ef0: 6445 7272 6f72 2866 2243 616e 6e6f 7420  dError(f"Cannot 
-00001f00: 6372 6561 7465 206d 6574 686f 6420 6f70  create method op
-00001f10: 6572 6174 6f72 2066 6f72 207b 636c 6173  erator for {clas
-00001f20: 735f 3d7d 2229 0a0a 2020 2020 6d65 7468  s_=}")..    meth
-00001f30: 6f64 2e5f 5f6e 616d 655f 5f20 3d20 6e61  od.__name__ = na
-00001f40: 6d65 0a20 2020 2072 6574 7572 6e20 6d65  me.    return me
-00001f50: 7468 6f64 0a0a 0a64 6566 205f 7772 6170  thod...def _wrap
-00001f60: 5f75 6e61 7279 5f65 7870 725f 6f70 2873  _unary_expr_op(s
-00001f70: 656c 662c 206f 703d 4e6f 6e65 293a 0a20  elf, op=None):. 
-00001f80: 2020 2023 2057 7261 7020 6578 7072 206f     # Wrap expr o
-00001f90: 7065 7261 746f 720a 2020 2020 6173 7365  perator.    asse
-00001fa0: 7274 206f 7020 6973 206e 6f74 204e 6f6e  rt op is not Non
-00001fb0: 650a 2020 2020 7265 7475 726e 206e 6577  e.    return new
-00001fc0: 5f63 6f6c 6c65 6374 696f 6e28 6765 7461  _collection(geta
-00001fd0: 7474 7228 7365 6c66 2e65 7870 722c 206f  ttr(self.expr, o
-00001fe0: 7029 2829 290a 0a0a 5f57 4152 4e5f 414e  p)())..._WARN_AN
-00001ff0: 4e4f 5441 5449 4f4e 5320 3d20 5472 7565  NOTATIONS = True
-00002000: 0a23 0a23 2043 6f6c 6c65 6374 696f 6e20  .#.# Collection 
-00002010: 636c 6173 7365 730a 230a 0a0a 636c 6173  classes.#...clas
-00002020: 7320 4672 616d 6542 6173 6528 4461 736b  s FrameBase(Dask
-00002030: 4d65 7468 6f64 734d 6978 696e 293a 0a20  MethodsMixin):. 
-00002040: 2020 2022 2222 4261 7365 2063 6c61 7373     """Base class
-00002050: 2066 6f72 2045 7870 722d 6261 636b 6564   for Expr-backed
-00002060: 2043 6f6c 6c65 6374 696f 6e73 2222 220a   Collections""".
-00002070: 0a20 2020 205f 5f64 6173 6b5f 7363 6865  .    __dask_sche
-00002080: 6475 6c65 725f 5f20 3d20 7374 6174 6963  duler__ = static
-00002090: 6d65 7468 6f64 280a 2020 2020 2020 2020  method(.        
-000020a0: 6e61 6d65 645f 7363 6865 6475 6c65 7273  named_schedulers
-000020b0: 2e67 6574 2822 7468 7265 6164 7322 2c20  .get("threads", 
-000020c0: 6e61 6d65 645f 7363 6865 6475 6c65 7273  named_schedulers
-000020d0: 5b22 7379 6e63 225d 290a 2020 2020 290a  ["sync"]).    ).
-000020e0: 2020 2020 5f5f 6461 736b 5f6f 7074 696d      __dask_optim
-000020f0: 697a 655f 5f20 3d20 7374 6174 6963 6d65  ize__ = staticme
-00002100: 7468 6f64 286c 616d 6264 6120 6473 6b2c  thod(lambda dsk,
-00002110: 206b 6579 732c 202a 2a6b 7761 7267 733a   keys, **kwargs:
-00002120: 2064 736b 290a 0a20 2020 2064 6566 205f   dsk)..    def _
-00002130: 5f69 6e69 745f 5f28 7365 6c66 2c20 6578  _init__(self, ex
-00002140: 7072 293a 0a20 2020 2020 2020 2067 6c6f  pr):.        glo
-00002150: 6261 6c20 5f57 4152 4e5f 414e 4e4f 5441  bal _WARN_ANNOTA
-00002160: 5449 4f4e 530a 2020 2020 2020 2020 6966  TIONS.        if
-00002170: 205f 5741 524e 5f41 4e4e 4f54 4154 494f   _WARN_ANNOTATIO
-00002180: 4e53 2061 6e64 2028 616e 6e6f 7420 3a3d  NS and (annot :=
-00002190: 2067 6574 5f61 6e6e 6f74 6174 696f 6e73   get_annotations
-000021a0: 2829 293a 0a20 2020 2020 2020 2020 2020  ()):.           
-000021b0: 205f 5741 524e 5f41 4e4e 4f54 4154 494f   _WARN_ANNOTATIO
-000021c0: 4e53 203d 2046 616c 7365 0a20 2020 2020  NS = False.     
-000021d0: 2020 2020 2020 2077 6172 6e69 6e67 732e         warnings.
-000021e0: 7761 726e 280a 2020 2020 2020 2020 2020  warn(.          
-000021f0: 2020 2020 2020 6622 4461 736b 2061 6e6e        f"Dask ann
-00002200: 6f74 6174 696f 6e73 207b 616e 6e6f 747d  otations {annot}
-00002210: 2064 6574 6563 7465 642e 2041 6e6e 6f74   detected. Annot
-00002220: 6174 696f 6e73 2077 696c 6c20 6265 2069  ations will be i
-00002230: 676e 6f72 6564 2077 6865 6e20 7573 696e  gnored when usin
-00002240: 6720 7175 6572 792d 706c 616e 6e69 6e67  g query-planning
-00002250: 2e22 0a20 2020 2020 2020 2020 2020 2029  .".            )
-00002260: 0a20 2020 2020 2020 2073 656c 662e 5f65  .        self._e
-00002270: 7870 7220 3d20 6578 7072 0a0a 2020 2020  xpr = expr..    
-00002280: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
-00002290: 6620 6578 7072 2873 656c 6629 202d 3e20  f expr(self) -> 
-000022a0: 6578 7072 2e45 7870 723a 0a20 2020 2020  expr.Expr:.     
-000022b0: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-000022c0: 6578 7072 0a0a 2020 2020 4070 726f 7065  expr..    @prope
-000022d0: 7274 790a 2020 2020 6465 6620 5f6d 6574  rty.    def _met
-000022e0: 6128 7365 6c66 293a 0a20 2020 2020 2020  a(self):.       
-000022f0: 2072 6574 7572 6e20 7365 6c66 2e65 7870   return self.exp
-00002300: 722e 5f6d 6574 610a 0a20 2020 2040 6675  r._meta..    @fu
-00002310: 6e63 746f 6f6c 732e 6361 6368 6564 5f70  nctools.cached_p
-00002320: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-00002330: 5f6d 6574 615f 6e6f 6e65 6d70 7479 2873  _meta_nonempty(s
-00002340: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
-00002350: 7475 726e 206d 6574 615f 6e6f 6e65 6d70  turn meta_nonemp
-00002360: 7479 2873 656c 662e 5f6d 6574 6129 0a0a  ty(self._meta)..
-00002370: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
-00002380: 2020 6465 6620 6469 7669 7369 6f6e 7328    def divisions(
-00002390: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
-000023a0: 2222 0a20 2020 2020 2020 2054 7570 6c65  "".        Tuple
-000023b0: 206f 6620 6060 6e70 6172 7469 7469 6f6e   of ``npartition
-000023c0: 7320 2b20 3160 6020 7661 6c75 6573 2c20  s + 1`` values, 
-000023d0: 696e 2061 7363 656e 6469 6e67 206f 7264  in ascending ord
-000023e0: 6572 2c20 6d61 726b 696e 6720 7468 650a  er, marking the.
-000023f0: 2020 2020 2020 2020 6c6f 7765 722f 7570          lower/up
-00002400: 7065 7220 626f 756e 6473 206f 6620 6561  per bounds of ea
-00002410: 6368 2070 6172 7469 7469 6f6e 2773 2069  ch partition's i
-00002420: 6e64 6578 2e20 4469 7669 7369 6f6e 7320  ndex. Divisions 
-00002430: 616c 6c6f 7720 4461 736b 0a20 2020 2020  allow Dask.     
-00002440: 2020 2074 6f20 6b6e 6f77 2077 6869 6368     to know which
-00002450: 2070 6172 7469 7469 6f6e 2077 696c 6c20   partition will 
-00002460: 636f 6e74 6169 6e20 6120 6769 7665 6e20  contain a given 
-00002470: 7661 6c75 652c 2073 6967 6e69 6669 6361  value, significa
-00002480: 6e74 6c79 0a20 2020 2020 2020 2073 7065  ntly.        spe
-00002490: 6564 696e 6720 7570 206f 7065 7261 7469  eding up operati
-000024a0: 6f6e 7320 6c69 6b65 2060 6c6f 6360 2c20  ons like `loc`, 
-000024b0: 606d 6572 6765 602c 2061 6e64 2060 6772  `merge`, and `gr
-000024c0: 6f75 7062 7960 2062 7920 6e6f 740a 2020  oupby` by not.  
-000024d0: 2020 2020 2020 6861 7669 6e67 2074 6f20        having to 
-000024e0: 7365 6172 6368 2074 6865 2066 756c 6c20  search the full 
-000024f0: 6461 7461 7365 742e 0a0a 2020 2020 2020  dataset...      
-00002500: 2020 4578 616d 706c 653a 2066 6f72 2060    Example: for `
-00002510: 6064 6976 6973 696f 6e73 203d 2028 302c  `divisions = (0,
-00002520: 2031 302c 2035 302c 2031 3030 2960 602c   10, 50, 100)``,
-00002530: 2074 6865 7265 2061 7265 2074 6872 6565   there are three
-00002540: 2070 6172 7469 7469 6f6e 732c 0a20 2020   partitions,.   
-00002550: 2020 2020 2077 6865 7265 2074 6865 2069       where the i
-00002560: 6e64 6578 2069 6e20 6561 6368 2070 6172  ndex in each par
-00002570: 7469 7469 6f6e 2063 6f6e 7461 696e 7320  tition contains 
-00002580: 7661 6c75 6573 205b 302c 2031 3029 2c20  values [0, 10), 
-00002590: 5b31 302c 2035 3029 2c0a 2020 2020 2020  [10, 50),.      
-000025a0: 2020 616e 6420 5b35 302c 2031 3030 5d2c    and [50, 100],
-000025b0: 2072 6573 7065 6374 6976 656c 792e 2044   respectively. D
-000025c0: 6173 6b20 7468 6572 6566 6f72 6520 6b6e  ask therefore kn
-000025d0: 6f77 7320 6060 6466 2e6c 6f63 5b34 355d  ows ``df.loc[45]
-000025e0: 6060 0a20 2020 2020 2020 2077 696c 6c20  ``.        will 
-000025f0: 6265 2069 6e20 7468 6520 7365 636f 6e64  be in the second
-00002600: 2070 6172 7469 7469 6f6e 2e0a 0a20 2020   partition...   
-00002610: 2020 2020 2057 6865 6e20 6576 6572 7920       When every 
-00002620: 6974 656d 2069 6e20 6060 6469 7669 7369  item in ``divisi
-00002630: 6f6e 7360 6020 6973 2060 604e 6f6e 6560  ons`` is ``None`
-00002640: 602c 2074 6865 2064 6976 6973 696f 6e73  `, the divisions
-00002650: 2061 7265 2075 6e6b 6e6f 776e 2e0a 2020   are unknown..  
-00002660: 2020 2020 2020 4d6f 7374 206f 7065 7261        Most opera
-00002670: 7469 6f6e 7320 6361 6e20 7374 696c 6c20  tions can still 
-00002680: 6265 2070 6572 666f 726d 6564 2c20 6275  be performed, bu
-00002690: 7420 736f 6d65 2077 696c 6c20 6265 206d  t some will be m
-000026a0: 7563 6820 736c 6f77 6572 2c0a 2020 2020  uch slower,.    
-000026b0: 2020 2020 616e 6420 6120 6665 7720 6d61      and a few ma
-000026c0: 7920 6661 696c 2e0a 0a20 2020 2020 2020  y fail...       
-000026d0: 2049 7420 6973 206e 6f74 2073 7570 706f   It is not suppo
-000026e0: 7274 6564 2074 6f20 7365 7420 6060 6469  rted to set ``di
-000026f0: 7669 7369 6f6e 7360 6020 6469 7265 6374  visions`` direct
-00002700: 6c79 2e20 496e 7374 6561 642c 2075 7365  ly. Instead, use
-00002710: 2060 6073 6574 5f69 6e64 6578 6060 2c0a   ``set_index``,.
-00002720: 2020 2020 2020 2020 7768 6963 6820 736f          which so
-00002730: 7274 7320 616e 6420 7370 6c69 7473 2074  rts and splits t
-00002740: 6865 2064 6174 6120 6173 206e 6565 6465  he data as neede
-00002750: 642e 0a20 2020 2020 2020 2053 6565 2068  d..        See h
-00002760: 7474 7073 3a2f 2f64 6f63 732e 6461 736b  ttps://docs.dask
-00002770: 2e6f 7267 2f65 6e2f 6c61 7465 7374 2f64  .org/en/latest/d
-00002780: 6174 6166 7261 6d65 2d64 6573 6967 6e2e  ataframe-design.
-00002790: 6874 6d6c 2370 6172 7469 7469 6f6e 732e  html#partitions.
-000027a0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-000027b0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-000027c0: 2e65 7870 722e 6469 7669 7369 6f6e 730a  .expr.divisions.
-000027d0: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
-000027e0: 2020 2064 6566 206e 7061 7274 6974 696f     def npartitio
-000027f0: 6e73 2873 656c 6629 3a0a 2020 2020 2020  ns(self):.      
-00002800: 2020 2222 2252 6574 7572 6e20 6e75 6d62    """Return numb
-00002810: 6572 206f 6620 7061 7274 6974 696f 6e73  er of partitions
-00002820: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
-00002830: 726e 2073 656c 662e 6578 7072 2e6e 7061  rn self.expr.npa
-00002840: 7274 6974 696f 6e73 0a0a 2020 2020 4070  rtitions..    @p
-00002850: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-00002860: 6474 7970 6573 2873 656c 6629 3a0a 2020  dtypes(self):.  
-00002870: 2020 2020 2020 2222 2252 6574 7572 6e20        """Return 
-00002880: 6461 7461 2074 7970 6573 2222 220a 2020  data types""".  
-00002890: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-000028a0: 662e 6578 7072 2e5f 6d65 7461 2e64 7479  f.expr._meta.dty
-000028b0: 7065 730a 0a20 2020 2040 7072 6f70 6572  pes..    @proper
-000028c0: 7479 0a20 2020 2064 6566 2073 697a 6528  ty.    def size(
-000028d0: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
-000028e0: 2222 5369 7a65 206f 6620 7468 6520 5365  ""Size of the Se
-000028f0: 7269 6573 206f 7220 4461 7461 4672 616d  ries or DataFram
-00002900: 6520 6173 2061 2044 656c 6179 6564 206f  e as a Delayed o
-00002910: 626a 6563 742e 0a0a 2020 2020 2020 2020  bject...        
-00002920: 4578 616d 706c 6573 0a20 2020 2020 2020  Examples.       
-00002930: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
-00002940: 2020 3e3e 3e20 7365 7269 6573 2e73 697a    >>> series.siz
-00002950: 6520 2023 2064 6f63 7465 7374 3a20 2b53  e  # doctest: +S
-00002960: 4b49 500a 2020 2020 2020 2020 3c64 6173  KIP.        <das
-00002970: 6b5f 6578 7072 2e65 7870 722e 5363 616c  k_expr.expr.Scal
-00002980: 6172 3a20 6578 7072 3d64 662e 7369 7a65  ar: expr=df.size
-00002990: 2829 2c20 6474 7970 653d 696e 7436 343e  (), dtype=int64>
-000029a0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-000029b0: 2020 2020 2072 6574 7572 6e20 6e65 775f       return new_
-000029c0: 636f 6c6c 6563 7469 6f6e 2873 656c 662e  collection(self.
-000029d0: 6578 7072 2e73 697a 6529 0a0a 2020 2020  expr.size)..    
-000029e0: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
-000029f0: 6620 636f 6c75 6d6e 7328 7365 6c66 293a  f columns(self):
-00002a00: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00002a10: 7365 6c66 2e5f 6d65 7461 2e63 6f6c 756d  self._meta.colum
-00002a20: 6e73 0a0a 2020 2020 4063 6f6c 756d 6e73  ns..    @columns
-00002a30: 2e73 6574 7465 720a 2020 2020 6465 6620  .setter.    def 
-00002a40: 636f 6c75 6d6e 7328 7365 6c66 2c20 636f  columns(self, co
-00002a50: 6c75 6d6e 7329 3a0a 2020 2020 2020 2020  lumns):.        
-00002a60: 6966 206c 656e 2863 6f6c 756d 6e73 2920  if len(columns) 
-00002a70: 213d 206c 656e 2873 656c 662e 636f 6c75  != len(self.colu
-00002a80: 6d6e 7329 3a0a 2020 2020 2020 2020 2020  mns):.          
-00002a90: 2020 2320 7375 7266 6163 6520 7061 6e64    # surface pand
-00002aa0: 6173 2065 7272 6f72 0a20 2020 2020 2020  as error.       
-00002ab0: 2020 2020 2073 656c 662e 5f65 7870 722e       self._expr.
-00002ac0: 5f6d 6574 612e 636f 6c75 6d6e 7320 3d20  _meta.columns = 
-00002ad0: 636f 6c75 6d6e 730a 2020 2020 2020 2020  columns.        
-00002ae0: 7365 6c66 2e5f 6578 7072 203d 2065 7870  self._expr = exp
-00002af0: 722e 436f 6c75 6d6e 7353 6574 7465 7228  r.ColumnsSetter(
-00002b00: 7365 6c66 2c20 636f 6c75 6d6e 7329 0a0a  self, columns)..
-00002b10: 2020 2020 6465 6620 636c 6561 725f 6469      def clear_di
-00002b20: 7669 7369 6f6e 7328 7365 6c66 293a 0a20  visions(self):. 
-00002b30: 2020 2020 2020 2022 2222 466f 7267 6574         """Forget
-00002b40: 2064 6976 6973 696f 6e20 696e 666f 726d   division inform
-00002b50: 6174 696f 6e2e 0a0a 2020 2020 2020 2020  ation...        
-00002b60: 5468 6973 2069 7320 7573 6566 756c 2069  This is useful i
-00002b70: 6620 7468 6520 6469 7669 7369 6f6e 7320  f the divisions 
-00002b80: 6172 6520 6e6f 206c 6f6e 6765 7220 6d65  are no longer me
-00002b90: 616e 696e 6766 756c 2e0a 2020 2020 2020  aningful..      
-00002ba0: 2020 2222 220a 2020 2020 2020 2020 7265    """.        re
-00002bb0: 7475 726e 206e 6577 5f63 6f6c 6c65 6374  turn new_collect
-00002bc0: 696f 6e28 6578 7072 2e43 6c65 6172 4469  ion(expr.ClearDi
-00002bd0: 7669 7369 6f6e 7328 7365 6c66 2929 0a0a  visions(self))..
-00002be0: 2020 2020 6465 6620 5f5f 6c65 6e5f 5f28      def __len__(
-00002bf0: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
-00002c00: 6574 7572 6e20 6e65 775f 636f 6c6c 6563  eturn new_collec
-00002c10: 7469 6f6e 284c 656e 2873 656c 6629 292e  tion(Len(self)).
-00002c20: 636f 6d70 7574 6528 290a 0a20 2020 2040  compute()..    @
-00002c30: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
-00002c40: 206e 6279 7465 7328 7365 6c66 293a 0a20   nbytes(self):. 
-00002c50: 2020 2020 2020 2072 6169 7365 204e 6f74         raise Not
-00002c60: 496d 706c 656d 656e 7465 6445 7272 6f72  ImplementedError
-00002c70: 2822 6e62 7974 6573 2069 7320 6e6f 7420  ("nbytes is not 
-00002c80: 696d 706c 656d 656e 7465 6420 6f6e 2044  implemented on D
-00002c90: 6174 6146 7261 6d65 2229 0a0a 2020 2020  ataFrame")..    
-00002ca0: 6465 6620 5f5f 7265 6475 6365 5f5f 2873  def __reduce__(s
-00002cb0: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
-00002cc0: 7475 726e 206e 6577 5f63 6f6c 6c65 6374  turn new_collect
-00002cd0: 696f 6e2c 2028 7365 6c66 2e5f 6578 7072  ion, (self._expr
-00002ce0: 2c29 0a0a 2020 2020 6465 6620 5f5f 6765  ,)..    def __ge
-00002cf0: 7469 7465 6d5f 5f28 7365 6c66 2c20 6f74  titem__(self, ot
-00002d00: 6865 7229 3a0a 2020 2020 2020 2020 6966  her):.        if
-00002d10: 2069 7369 6e73 7461 6e63 6528 6f74 6865   isinstance(othe
-00002d20: 722c 2046 7261 6d65 4261 7365 293a 0a20  r, FrameBase):. 
-00002d30: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00002d40: 6e20 6e65 775f 636f 6c6c 6563 7469 6f6e  n new_collection
-00002d50: 2873 656c 662e 6578 7072 2e5f 5f67 6574  (self.expr.__get
-00002d60: 6974 656d 5f5f 286f 7468 6572 2e65 7870  item__(other.exp
-00002d70: 7229 290a 2020 2020 2020 2020 656c 6966  r)).        elif
-00002d80: 2069 7369 6e73 7461 6e63 6528 6f74 6865   isinstance(othe
-00002d90: 722c 2073 6c69 6365 293a 0a20 2020 2020  r, slice):.     
-00002da0: 2020 2020 2020 2066 726f 6d20 7061 6e64         from pand
-00002db0: 6173 2e61 7069 2e74 7970 6573 2069 6d70  as.api.types imp
-00002dc0: 6f72 7420 6973 5f66 6c6f 6174 5f64 7479  ort is_float_dty
-00002dd0: 7065 0a0a 2020 2020 2020 2020 2020 2020  pe..            
-00002de0: 6973 5f69 6e74 6567 6572 5f73 6c69 6365  is_integer_slice
-00002df0: 203d 2061 6e79 280a 2020 2020 2020 2020   = any(.        
-00002e00: 2020 2020 2020 2020 6973 696e 7374 616e          isinstan
-00002e10: 6365 2869 2c20 496e 7465 6772 616c 2920  ce(i, Integral) 
-00002e20: 666f 7220 6920 696e 2028 6f74 6865 722e  for i in (other.
-00002e30: 7374 6172 742c 206f 7468 6572 2e73 7465  start, other.ste
-00002e40: 702c 206f 7468 6572 2e73 746f 7029 0a20  p, other.stop). 
-00002e50: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00002e60: 2020 2020 2020 2020 2069 6620 280a 2020           if (.  
-00002e70: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00002e80: 6c66 2e6e 6469 6d20 3d3d 2032 0a20 2020  lf.ndim == 2.   
-00002e90: 2020 2020 2020 2020 2020 2020 2061 6e64               and
-00002ea0: 2069 735f 696e 7465 6765 725f 736c 6963   is_integer_slic
-00002eb0: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-00002ec0: 2020 616e 6420 6e6f 7420 6973 5f66 6c6f    and not is_flo
-00002ed0: 6174 5f64 7479 7065 2873 656c 662e 696e  at_dtype(self.in
-00002ee0: 6465 782e 6474 7970 6529 0a20 2020 2020  dex.dtype).     
-00002ef0: 2020 2020 2020 2029 3a0a 2020 2020 2020         ):.      
-00002f00: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00002f10: 2073 656c 662e 696c 6f63 5b6f 7468 6572   self.iloc[other
-00002f20: 5d0a 2020 2020 2020 2020 2020 2020 656c  ].            el
-00002f30: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00002f40: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00002f50: 6c6f 635b 6f74 6865 725d 0a20 2020 2020  loc[other].     
-00002f60: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-00002f70: 286f 7468 6572 2c20 6e70 2e6e 6461 7272  (other, np.ndarr
-00002f80: 6179 2920 6f72 2069 735f 7365 7269 6573  ay) or is_series
-00002f90: 5f6c 696b 6528 6f74 6865 7229 3a0a 2020  _like(other):.  
-00002fa0: 2020 2020 2020 2020 2020 6f74 6865 7220            other 
-00002fb0: 3d20 6c69 7374 286f 7468 6572 290a 2020  = list(other).  
-00002fc0: 2020 2020 2020 656c 6966 2069 7369 6e73        elif isins
-00002fd0: 7461 6e63 6528 6f74 6865 722c 206c 6973  tance(other, lis
-00002fe0: 7429 3a0a 2020 2020 2020 2020 2020 2020  t):.            
-00002ff0: 6f74 6865 7220 3d20 6f74 6865 722e 636f  other = other.co
-00003000: 7079 2829 0a20 2020 2020 2020 2072 6574  py().        ret
-00003010: 7572 6e20 6e65 775f 636f 6c6c 6563 7469  urn new_collecti
-00003020: 6f6e 2873 656c 662e 6578 7072 2e5f 5f67  on(self.expr.__g
-00003030: 6574 6974 656d 5f5f 286f 7468 6572 2929  etitem__(other))
-00003040: 0a0a 2020 2020 6465 6620 5f5f 6461 736b  ..    def __dask
-00003050: 5f74 6f6b 656e 697a 655f 5f28 7365 6c66  _tokenize__(self
-00003060: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-00003070: 6e20 7479 7065 2873 656c 6629 2e5f 5f6e  n type(self).__n
-00003080: 616d 655f 5f2c 2073 656c 662e 5f65 7870  ame__, self._exp
-00003090: 722e 5f6e 616d 650a 0a20 2020 2064 6566  r._name..    def
-000030a0: 205f 5f72 6570 725f 5f28 7365 6c66 293a   __repr__(self):
-000030b0: 0a20 2020 2020 2020 2064 6174 6120 3d20  .        data = 
-000030c0: 7365 6c66 2e5f 7265 7072 5f64 6174 6128  self._repr_data(
-000030d0: 292e 746f 5f73 7472 696e 6728 6d61 785f  ).to_string(max_
-000030e0: 726f 7773 3d35 290a 2020 2020 2020 2020  rows=5).        
-000030f0: 5f73 7472 5f66 6d74 203d 2022 2222 4461  _str_fmt = """Da
-00003100: 736b 207b 6b6c 6173 737d 2053 7472 7563  sk {klass} Struc
-00003110: 7475 7265 3a0a 7b64 6174 617d 0a44 6173  ture:.{data}.Das
-00003120: 6b20 4e61 6d65 3a20 7b6e 616d 657d 2c20  k Name: {name}, 
-00003130: 7b6e 5f65 7870 727d 0a45 7870 723d 7b65  {n_expr}.Expr={e
-00003140: 7870 727d 2222 220a 2020 2020 2020 2020  xpr}""".        
-00003150: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
-00003160: 6528 7365 6c66 2c20 5365 7269 6573 2920  e(self, Series) 
-00003170: 616e 6420 6e6f 7420 6c65 6e28 7365 6c66  and not len(self
-00003180: 2e63 6f6c 756d 6e73 293a 0a20 2020 2020  .columns):.     
-00003190: 2020 2020 2020 2064 6174 6120 3d20 6461         data = da
-000031a0: 7461 2e70 6172 7469 7469 6f6e 2822 5c6e  ta.partition("\n
-000031b0: 2229 5b2d 315d 2e72 6570 6c61 6365 2822  ")[-1].replace("
-000031c0: 496e 6465 7822 2c20 2244 6976 6973 696f  Index", "Divisio
-000031d0: 6e73 2229 0a20 2020 2020 2020 2020 2020  ns").           
-000031e0: 205f 7374 725f 666d 7420 3d20 6622 456d   _str_fmt = f"Em
-000031f0: 7074 7920 7b5f 7374 725f 666d 747d 220a  pty {_str_fmt}".
-00003200: 2020 2020 2020 2020 6e5f 6578 7072 203d          n_expr =
-00003210: 206c 656e 287b 652e 5f6e 616d 6520 666f   len({e._name fo
-00003220: 7220 6520 696e 2073 656c 662e 6578 7072  r e in self.expr
-00003230: 2e77 616c 6b28 297d 290a 0a20 2020 2020  .walk()})..     
-00003240: 2020 2072 6574 7572 6e20 5f73 7472 5f66     return _str_f
-00003250: 6d74 2e66 6f72 6d61 7428 0a20 2020 2020  mt.format(.     
-00003260: 2020 2020 2020 206b 6c61 7373 3d73 656c         klass=sel
-00003270: 662e 5f5f 636c 6173 735f 5f2e 5f5f 6e61  f.__class__.__na
-00003280: 6d65 5f5f 2c0a 2020 2020 2020 2020 2020  me__,.          
-00003290: 2020 6461 7461 3d64 6174 612c 0a20 2020    data=data,.   
-000032a0: 2020 2020 2020 2020 206e 616d 653d 6b65           name=ke
-000032b0: 795f 7370 6c69 7428 7365 6c66 2e5f 6e61  y_split(self._na
-000032c0: 6d65 292c 0a20 2020 2020 2020 2020 2020  me),.           
-000032d0: 206e 5f65 7870 723d 6d61 7962 655f 706c   n_expr=maybe_pl
-000032e0: 7572 616c 697a 6528 6e5f 6578 7072 2c20  uralize(n_expr, 
-000032f0: 2265 7870 7265 7373 696f 6e22 292c 0a20  "expression"),. 
-00003300: 2020 2020 2020 2020 2020 2065 7870 723d             expr=
-00003310: 7365 6c66 2e65 7870 722c 0a20 2020 2020  self.expr,.     
-00003320: 2020 2029 0a0a 2020 2020 6465 6620 5f5f     )..    def __
-00003330: 626f 6f6c 5f5f 2873 656c 6629 3a0a 2020  bool__(self):.  
-00003340: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-00003350: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
-00003360: 2020 2020 6622 5468 6520 7472 7574 6820      f"The truth 
-00003370: 7661 6c75 6520 6f66 2061 207b 7365 6c66  value of a {self
-00003380: 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e 616d  .__class__.__nam
-00003390: 655f 5f7d 2069 7320 616d 6269 6775 6f75  e__} is ambiguou
-000033a0: 732e 2022 0a20 2020 2020 2020 2020 2020  s. ".           
-000033b0: 2022 5573 6520 612e 616e 7928 2920 6f72   "Use a.any() or
-000033c0: 2061 2e61 6c6c 2829 2e22 0a20 2020 2020   a.all().".     
-000033d0: 2020 2029 0a0a 2020 2020 6465 6620 5f5f     )..    def __
-000033e0: 6172 7261 795f 5f28 7365 6c66 2c20 6474  array__(self, dt
-000033f0: 7970 653d 4e6f 6e65 2c20 2a2a 6b77 6172  ype=None, **kwar
-00003400: 6773 293a 0a20 2020 2020 2020 2072 6574  gs):.        ret
-00003410: 7572 6e20 6e70 2e61 7272 6179 2873 656c  urn np.array(sel
-00003420: 662e 636f 6d70 7574 6528 2929 0a0a 2020  f.compute())..  
-00003430: 2020 6465 6620 7065 7273 6973 7428 7365    def persist(se
-00003440: 6c66 2c20 6675 7365 3d54 7275 652c 202a  lf, fuse=True, *
-00003450: 2a6b 7761 7267 7329 3a0a 2020 2020 2020  *kwargs):.      
-00003460: 2020 6f75 7420 3d20 7365 6c66 2e6f 7074    out = self.opt
-00003470: 696d 697a 6528 6675 7365 3d66 7573 6529  imize(fuse=fuse)
-00003480: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00003490: 4461 736b 4d65 7468 6f64 734d 6978 696e  DaskMethodsMixin
-000034a0: 2e70 6572 7369 7374 286f 7574 2c20 2a2a  .persist(out, **
-000034b0: 6b77 6172 6773 290a 0a20 2020 2064 6566  kwargs)..    def
-000034c0: 2063 6f6d 7075 7465 2873 656c 662c 2066   compute(self, f
-000034d0: 7573 653d 5472 7565 2c20 2a2a 6b77 6172  use=True, **kwar
-000034e0: 6773 293a 0a20 2020 2020 2020 206f 7574  gs):.        out
-000034f0: 203d 2073 656c 660a 2020 2020 2020 2020   = self.        
-00003500: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
-00003510: 6528 6f75 742c 2053 6361 6c61 7229 3a0a  e(out, Scalar):.
-00003520: 2020 2020 2020 2020 2020 2020 6f75 7420              out 
-00003530: 3d20 6f75 742e 7265 7061 7274 6974 696f  = out.repartitio
-00003540: 6e28 6e70 6172 7469 7469 6f6e 733d 3129  n(npartitions=1)
-00003550: 0a20 2020 2020 2020 206f 7574 203d 206f  .        out = o
-00003560: 7574 2e6f 7074 696d 697a 6528 6675 7365  ut.optimize(fuse
-00003570: 3d66 7573 6529 0a20 2020 2020 2020 2072  =fuse).        r
-00003580: 6574 7572 6e20 4461 736b 4d65 7468 6f64  eturn DaskMethod
-00003590: 734d 6978 696e 2e63 6f6d 7075 7465 286f  sMixin.compute(o
-000035a0: 7574 2c20 2a2a 6b77 6172 6773 290a 0a20  ut, **kwargs).. 
-000035b0: 2020 2064 6566 2061 6e61 6c79 7a65 2873     def analyze(s
-000035c0: 656c 662c 2066 696c 656e 616d 653a 2073  elf, filename: s
-000035d0: 7472 207c 204e 6f6e 6520 3d20 4e6f 6e65  tr | None = None
-000035e0: 2c20 666f 726d 6174 3a20 7374 7220 7c20  , format: str | 
-000035f0: 4e6f 6e65 203d 204e 6f6e 6529 202d 3e20  None = None) -> 
-00003600: 4e6f 6e65 3a0a 2020 2020 2020 2020 6f75  None:.        ou
-00003610: 7420 3d20 7365 6c66 0a20 2020 2020 2020  t = self.       
-00003620: 2069 6620 6e6f 7420 6973 696e 7374 616e   if not isinstan
-00003630: 6365 286f 7574 2c20 5363 616c 6172 293a  ce(out, Scalar):
-00003640: 0a20 2020 2020 2020 2020 2020 206f 7574  .            out
-00003650: 203d 206f 7574 2e72 6570 6172 7469 7469   = out.repartiti
-00003660: 6f6e 286e 7061 7274 6974 696f 6e73 3d31  on(npartitions=1
-00003670: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-00003680: 206f 7574 2e65 7870 722e 616e 616c 797a   out.expr.analyz
-00003690: 6528 6669 6c65 6e61 6d65 3d66 696c 656e  e(filename=filen
-000036a0: 616d 652c 2066 6f72 6d61 743d 666f 726d  ame, format=form
-000036b0: 6174 290a 0a20 2020 2064 6566 2065 7870  at)..    def exp
-000036c0: 6c61 696e 2873 656c 662c 2073 7461 6765  lain(self, stage
-000036d0: 3a20 4f70 7469 6d69 7a65 7253 7461 6765  : OptimizerStage
-000036e0: 203d 2022 6675 7365 6422 2c20 666f 726d   = "fused", form
-000036f0: 6174 3a20 7374 7220 7c20 4e6f 6e65 203d  at: str | None =
-00003700: 204e 6f6e 6529 3a0a 2020 2020 2020 2020   None):.        
-00003710: 6f75 7420 3d20 7365 6c66 0a20 2020 2020  out = self.     
-00003720: 2020 2069 6620 6e6f 7420 6973 696e 7374     if not isinst
-00003730: 616e 6365 286f 7574 2c20 5363 616c 6172  ance(out, Scalar
-00003740: 293a 0a20 2020 2020 2020 2020 2020 206f  ):.            o
-00003750: 7574 203d 206f 7574 2e72 6570 6172 7469  ut = out.reparti
-00003760: 7469 6f6e 286e 7061 7274 6974 696f 6e73  tion(npartitions
-00003770: 3d31 290a 2020 2020 2020 2020 7265 7475  =1).        retu
-00003780: 726e 206f 7574 2e65 7870 722e 6578 706c  rn out.expr.expl
-00003790: 6169 6e28 7374 6167 652c 2066 6f72 6d61  ain(stage, forma
-000037a0: 7429 0a0a 2020 2020 4070 726f 7065 7274  t)..    @propert
-000037b0: 790a 2020 2020 6465 6620 6461 736b 2873  y.    def dask(s
-000037c0: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
-000037d0: 7475 726e 2073 656c 662e 5f5f 6461 736b  turn self.__dask
-000037e0: 5f67 7261 7068 5f5f 2829 0a0a 2020 2020  _graph__()..    
-000037f0: 6465 6620 5f5f 6461 736b 5f67 7261 7068  def __dask_graph
-00003800: 5f5f 2873 656c 6629 3a0a 2020 2020 2020  __(self):.      
-00003810: 2020 6f75 7420 3d20 7365 6c66 2e65 7870    out = self.exp
-00003820: 720a 2020 2020 2020 2020 6f75 7420 3d20  r.        out = 
-00003830: 6f75 742e 6c6f 7765 725f 636f 6d70 6c65  out.lower_comple
-00003840: 7465 6c79 2829 0a20 2020 2020 2020 2072  tely().        r
-00003850: 6574 7572 6e20 6f75 742e 5f5f 6461 736b  eturn out.__dask
-00003860: 5f67 7261 7068 5f5f 2829 0a0a 2020 2020  _graph__()..    
-00003870: 6465 6620 5f5f 6461 736b 5f6b 6579 735f  def __dask_keys_
-00003880: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
-00003890: 206f 7574 203d 2073 656c 662e 6578 7072   out = self.expr
-000038a0: 0a20 2020 2020 2020 206f 7574 203d 206f  .        out = o
-000038b0: 7574 2e6c 6f77 6572 5f63 6f6d 706c 6574  ut.lower_complet
-000038c0: 656c 7928 290a 2020 2020 2020 2020 7265  ely().        re
-000038d0: 7475 726e 206f 7574 2e5f 5f64 6173 6b5f  turn out.__dask_
-000038e0: 6b65 7973 5f5f 2829 0a0a 2020 2020 6465  keys__()..    de
-000038f0: 6620 7369 6d70 6c69 6679 2873 656c 6629  f simplify(self)
-00003900: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00003910: 206e 6577 5f63 6f6c 6c65 6374 696f 6e28   new_collection(
-00003920: 7365 6c66 2e65 7870 722e 7369 6d70 6c69  self.expr.simpli
-00003930: 6679 2829 290a 0a20 2020 2064 6566 206c  fy())..    def l
-00003940: 6f77 6572 5f6f 6e63 6528 7365 6c66 293a  ower_once(self):
-00003950: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00003960: 6e65 775f 636f 6c6c 6563 7469 6f6e 2873  new_collection(s
-00003970: 656c 662e 6578 7072 2e6c 6f77 6572 5f6f  elf.expr.lower_o
-00003980: 6e63 6528 2929 0a0a 2020 2020 6465 6620  nce())..    def 
-00003990: 6f70 7469 6d69 7a65 2873 656c 662c 2066  optimize(self, f
-000039a0: 7573 653a 2062 6f6f 6c20 3d20 5472 7565  use: bool = True
-000039b0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-000039c0: 6e20 6e65 775f 636f 6c6c 6563 7469 6f6e  n new_collection
-000039d0: 2873 656c 662e 6578 7072 2e6f 7074 696d  (self.expr.optim
-000039e0: 697a 6528 6675 7365 3d66 7573 6529 290a  ize(fuse=fuse)).
-000039f0: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
-00003a00: 2020 2064 6566 2064 6173 6b28 7365 6c66     def dask(self
-00003a10: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-00003a20: 6e20 7365 6c66 2e5f 5f64 6173 6b5f 6772  n self.__dask_gr
-00003a30: 6170 685f 5f28 290a 0a20 2020 2064 6566  aph__()..    def
-00003a40: 205f 5f64 6173 6b5f 706f 7374 636f 6d70   __dask_postcomp
-00003a50: 7574 655f 5f28 7365 6c66 293a 0a20 2020  ute__(self):.   
-00003a60: 2020 2020 2073 7461 7465 203d 206e 6577       state = new
-00003a70: 5f63 6f6c 6c65 6374 696f 6e28 7365 6c66  _collection(self
-00003a80: 2e65 7870 722e 6c6f 7765 725f 636f 6d70  .expr.lower_comp
-00003a90: 6c65 7465 6c79 2829 290a 2020 2020 2020  letely()).      
-00003aa0: 2020 6966 2074 7970 6528 7365 6c66 2920    if type(self) 
-00003ab0: 213d 2074 7970 6528 7374 6174 6529 3a0a  != type(state):.
-00003ac0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00003ad0: 726e 2073 7461 7465 2e5f 5f64 6173 6b5f  rn state.__dask_
-00003ae0: 706f 7374 636f 6d70 7574 655f 5f28 290a  postcompute__().
-00003af0: 2020 2020 2020 2020 7265 7475 726e 205f          return _
-00003b00: 636f 6e63 6174 2c20 2829 0a0a 2020 2020  concat, ()..    
-00003b10: 6465 6620 5f5f 6461 736b 5f70 6f73 7470  def __dask_postp
-00003b20: 6572 7369 7374 5f5f 2873 656c 6629 3a0a  ersist__(self):.
-00003b30: 2020 2020 2020 2020 7374 6174 6520 3d20          state = 
-00003b40: 6e65 775f 636f 6c6c 6563 7469 6f6e 2873  new_collection(s
-00003b50: 656c 662e 6578 7072 2e6c 6f77 6572 5f63  elf.expr.lower_c
-00003b60: 6f6d 706c 6574 656c 7928 2929 0a20 2020  ompletely()).   
-00003b70: 2020 2020 2072 6574 7572 6e20 6672 6f6d       return from
-00003b80: 5f67 7261 7068 2c20 280a 2020 2020 2020  _graph, (.      
-00003b90: 2020 2020 2020 7374 6174 652e 5f6d 6574        state._met
-00003ba0: 612c 0a20 2020 2020 2020 2020 2020 2073  a,.            s
-00003bb0: 7461 7465 2e64 6976 6973 696f 6e73 2c0a  tate.divisions,.
-00003bc0: 2020 2020 2020 2020 2020 2020 7374 6174              stat
-00003bd0: 652e 5f5f 6461 736b 5f6b 6579 735f 5f28  e.__dask_keys__(
-00003be0: 292c 0a20 2020 2020 2020 2020 2020 206b  ),.            k
-00003bf0: 6579 5f73 706c 6974 2873 7461 7465 2e5f  ey_split(state._
-00003c00: 6e61 6d65 292c 0a20 2020 2020 2020 2029  name),.        )
-00003c10: 0a0a 2020 2020 6465 6620 5f5f 6765 7461  ..    def __geta
-00003c20: 7474 725f 5f28 7365 6c66 2c20 6b65 7929  ttr__(self, key)
-00003c30: 3a0a 2020 2020 2020 2020 7472 793a 0a20  :.        try:. 
-00003c40: 2020 2020 2020 2020 2020 2023 2050 7269             # Pri
-00003c50: 6f72 6974 697a 6520 6046 7261 6d65 4261  oritize `FrameBa
-00003c60: 7365 6020 6174 7472 6962 7574 6573 0a20  se` attributes. 
-00003c70: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00003c80: 6e20 6f62 6a65 6374 2e5f 5f67 6574 6174  n object.__getat
-00003c90: 7472 6962 7574 655f 5f28 7365 6c66 2c20  tribute__(self, 
-00003ca0: 6b65 7929 0a20 2020 2020 2020 2065 7863  key).        exc
-00003cb0: 6570 7420 4174 7472 6962 7574 6545 7272  ept AttributeErr
-00003cc0: 6f72 2061 7320 6572 723a 0a20 2020 2020  or as err:.     
-00003cd0: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
-00003ce0: 2020 2020 2020 2020 2020 2020 2320 4661              # Fa
-00003cf0: 6c6c 2062 6163 6b20 746f 2060 6578 7072  ll back to `expr
-00003d00: 6020 4150 490a 2020 2020 2020 2020 2020  ` API.          
-00003d10: 2020 2020 2020 2320 284d 616b 696e 6720        # (Making 
-00003d20: 7375 7265 2074 6f20 636f 6e76 6572 7420  sure to convert 
-00003d30: 746f 2f66 726f 6d20 4578 7072 290a 2020  to/from Expr).  
-00003d40: 2020 2020 2020 2020 2020 2020 2020 7661                va
-00003d50: 6c20 3d20 6765 7461 7474 7228 7365 6c66  l = getattr(self
-00003d60: 2e65 7870 722c 206b 6579 290a 2020 2020  .expr, key).    
-00003d70: 2020 2020 2020 2020 2020 2020 6966 2063              if c
-00003d80: 616c 6c61 626c 6528 7661 6c29 3a0a 2020  allable(val):.  
+00001e70: 2020 2020 6669 6c6c 5f76 616c 7565 3d66      fill_value=f
+00001e80: 696c 6c5f 7661 6c75 652c 0a20 2020 2020  ill_value,.     
+00001e90: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+00001ea0: 6576 656c 3d6c 6576 656c 2c0a 2020 2020  evel=level,.    
+00001eb0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00001ec0: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+00001ed0: 2065 6c73 653a 0a20 2020 2020 2020 2072   else:.        r
+00001ee0: 6169 7365 204e 6f74 496d 706c 656d 656e  aise NotImplemen
+00001ef0: 7465 6445 7272 6f72 2866 2243 616e 6e6f  tedError(f"Canno
+00001f00: 7420 6372 6561 7465 206d 6574 686f 6420  t create method 
+00001f10: 6f70 6572 6174 6f72 2066 6f72 207b 636c  operator for {cl
+00001f20: 6173 735f 3d7d 2229 0a0a 2020 2020 6d65  ass_=}")..    me
+00001f30: 7468 6f64 2e5f 5f6e 616d 655f 5f20 3d20  thod.__name__ = 
+00001f40: 6e61 6d65 0a20 2020 2072 6574 7572 6e20  name.    return 
+00001f50: 6d65 7468 6f64 0a0a 0a64 6566 205f 7772  method...def _wr
+00001f60: 6170 5f75 6e61 7279 5f65 7870 725f 6f70  ap_unary_expr_op
+00001f70: 2873 656c 662c 206f 703d 4e6f 6e65 293a  (self, op=None):
+00001f80: 0a20 2020 2023 2057 7261 7020 6578 7072  .    # Wrap expr
+00001f90: 206f 7065 7261 746f 720a 2020 2020 6173   operator.    as
+00001fa0: 7365 7274 206f 7020 6973 206e 6f74 204e  sert op is not N
+00001fb0: 6f6e 650a 2020 2020 7265 7475 726e 206e  one.    return n
+00001fc0: 6577 5f63 6f6c 6c65 6374 696f 6e28 6765  ew_collection(ge
+00001fd0: 7461 7474 7228 7365 6c66 2e65 7870 722c  tattr(self.expr,
+00001fe0: 206f 7029 2829 290a 0a0a 5f57 4152 4e5f   op)())..._WARN_
+00001ff0: 414e 4e4f 5441 5449 4f4e 5320 3d20 5472  ANNOTATIONS = Tr
+00002000: 7565 0a23 0a23 2043 6f6c 6c65 6374 696f  ue.#.# Collectio
+00002010: 6e20 636c 6173 7365 730a 230a 0a0a 636c  n classes.#...cl
+00002020: 6173 7320 4672 616d 6542 6173 6528 4461  ass FrameBase(Da
+00002030: 736b 4d65 7468 6f64 734d 6978 696e 293a  skMethodsMixin):
+00002040: 0a20 2020 2022 2222 4261 7365 2063 6c61  .    """Base cla
+00002050: 7373 2066 6f72 2045 7870 722d 6261 636b  ss for Expr-back
+00002060: 6564 2043 6f6c 6c65 6374 696f 6e73 2222  ed Collections""
+00002070: 220a 0a20 2020 205f 5f64 6173 6b5f 7363  "..    __dask_sc
+00002080: 6865 6475 6c65 725f 5f20 3d20 7374 6174  heduler__ = stat
+00002090: 6963 6d65 7468 6f64 280a 2020 2020 2020  icmethod(.      
+000020a0: 2020 6e61 6d65 645f 7363 6865 6475 6c65    named_schedule
+000020b0: 7273 2e67 6574 2822 7468 7265 6164 7322  rs.get("threads"
+000020c0: 2c20 6e61 6d65 645f 7363 6865 6475 6c65  , named_schedule
+000020d0: 7273 5b22 7379 6e63 225d 290a 2020 2020  rs["sync"]).    
+000020e0: 290a 2020 2020 5f5f 6461 736b 5f6f 7074  ).    __dask_opt
+000020f0: 696d 697a 655f 5f20 3d20 7374 6174 6963  imize__ = static
+00002100: 6d65 7468 6f64 286c 616d 6264 6120 6473  method(lambda ds
+00002110: 6b2c 206b 6579 732c 202a 2a6b 7761 7267  k, keys, **kwarg
+00002120: 733a 2064 736b 290a 0a20 2020 2064 6566  s: dsk)..    def
+00002130: 205f 5f69 6e69 745f 5f28 7365 6c66 2c20   __init__(self, 
+00002140: 6578 7072 293a 0a20 2020 2020 2020 2067  expr):.        g
+00002150: 6c6f 6261 6c20 5f57 4152 4e5f 414e 4e4f  lobal _WARN_ANNO
+00002160: 5441 5449 4f4e 530a 2020 2020 2020 2020  TATIONS.        
+00002170: 6966 205f 5741 524e 5f41 4e4e 4f54 4154  if _WARN_ANNOTAT
+00002180: 494f 4e53 2061 6e64 2028 616e 6e6f 7420  IONS and (annot 
+00002190: 3a3d 2067 6574 5f61 6e6e 6f74 6174 696f  := get_annotatio
+000021a0: 6e73 2829 293a 0a20 2020 2020 2020 2020  ns()):.         
+000021b0: 2020 205f 5741 524e 5f41 4e4e 4f54 4154     _WARN_ANNOTAT
+000021c0: 494f 4e53 203d 2046 616c 7365 0a20 2020  IONS = False.   
+000021d0: 2020 2020 2020 2020 2077 6172 6e69 6e67           warning
+000021e0: 732e 7761 726e 280a 2020 2020 2020 2020  s.warn(.        
+000021f0: 2020 2020 2020 2020 6622 4461 736b 2061          f"Dask a
+00002200: 6e6e 6f74 6174 696f 6e73 207b 616e 6e6f  nnotations {anno
+00002210: 747d 2064 6574 6563 7465 642e 2041 6e6e  t} detected. Ann
+00002220: 6f74 6174 696f 6e73 2077 696c 6c20 6265  otations will be
+00002230: 2069 676e 6f72 6564 2077 6865 6e20 7573   ignored when us
+00002240: 696e 6720 7175 6572 792d 706c 616e 6e69  ing query-planni
+00002250: 6e67 2e22 0a20 2020 2020 2020 2020 2020  ng.".           
+00002260: 2029 0a20 2020 2020 2020 2073 656c 662e   ).        self.
+00002270: 5f65 7870 7220 3d20 6578 7072 0a0a 2020  _expr = expr..  
+00002280: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+00002290: 6465 6620 6578 7072 2873 656c 6629 202d  def expr(self) -
+000022a0: 3e20 6578 7072 2e45 7870 723a 0a20 2020  > expr.Expr:.   
+000022b0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+000022c0: 2e5f 6578 7072 0a0a 2020 2020 4070 726f  ._expr..    @pro
+000022d0: 7065 7274 790a 2020 2020 6465 6620 5f6d  perty.    def _m
+000022e0: 6574 6128 7365 6c66 293a 0a20 2020 2020  eta(self):.     
+000022f0: 2020 2072 6574 7572 6e20 7365 6c66 2e65     return self.e
+00002300: 7870 722e 5f6d 6574 610a 0a20 2020 2040  xpr._meta..    @
+00002310: 6675 6e63 746f 6f6c 732e 6361 6368 6564  functools.cached
+00002320: 5f70 726f 7065 7274 790a 2020 2020 6465  _property.    de
+00002330: 6620 5f6d 6574 615f 6e6f 6e65 6d70 7479  f _meta_nonempty
+00002340: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00002350: 7265 7475 726e 206d 6574 615f 6e6f 6e65  return meta_none
+00002360: 6d70 7479 2873 656c 662e 5f6d 6574 6129  mpty(self._meta)
+00002370: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
+00002380: 2020 2020 6465 6620 6469 7669 7369 6f6e      def division
+00002390: 7328 7365 6c66 293a 0a20 2020 2020 2020  s(self):.       
+000023a0: 2022 2222 0a20 2020 2020 2020 2054 7570   """.        Tup
+000023b0: 6c65 206f 6620 6060 6e70 6172 7469 7469  le of ``npartiti
+000023c0: 6f6e 7320 2b20 3160 6020 7661 6c75 6573  ons + 1`` values
+000023d0: 2c20 696e 2061 7363 656e 6469 6e67 206f  , in ascending o
+000023e0: 7264 6572 2c20 6d61 726b 696e 6720 7468  rder, marking th
+000023f0: 650a 2020 2020 2020 2020 6c6f 7765 722f  e.        lower/
+00002400: 7570 7065 7220 626f 756e 6473 206f 6620  upper bounds of 
+00002410: 6561 6368 2070 6172 7469 7469 6f6e 2773  each partition's
+00002420: 2069 6e64 6578 2e20 4469 7669 7369 6f6e   index. Division
+00002430: 7320 616c 6c6f 7720 4461 736b 0a20 2020  s allow Dask.   
+00002440: 2020 2020 2074 6f20 6b6e 6f77 2077 6869       to know whi
+00002450: 6368 2070 6172 7469 7469 6f6e 2077 696c  ch partition wil
+00002460: 6c20 636f 6e74 6169 6e20 6120 6769 7665  l contain a give
+00002470: 6e20 7661 6c75 652c 2073 6967 6e69 6669  n value, signifi
+00002480: 6361 6e74 6c79 0a20 2020 2020 2020 2073  cantly.        s
+00002490: 7065 6564 696e 6720 7570 206f 7065 7261  peeding up opera
+000024a0: 7469 6f6e 7320 6c69 6b65 2060 6c6f 6360  tions like `loc`
+000024b0: 2c20 606d 6572 6765 602c 2061 6e64 2060  , `merge`, and `
+000024c0: 6772 6f75 7062 7960 2062 7920 6e6f 740a  groupby` by not.
+000024d0: 2020 2020 2020 2020 6861 7669 6e67 2074          having t
+000024e0: 6f20 7365 6172 6368 2074 6865 2066 756c  o search the ful
+000024f0: 6c20 6461 7461 7365 742e 0a0a 2020 2020  l dataset...    
+00002500: 2020 2020 4578 616d 706c 653a 2066 6f72      Example: for
+00002510: 2060 6064 6976 6973 696f 6e73 203d 2028   ``divisions = (
+00002520: 302c 2031 302c 2035 302c 2031 3030 2960  0, 10, 50, 100)`
+00002530: 602c 2074 6865 7265 2061 7265 2074 6872  `, there are thr
+00002540: 6565 2070 6172 7469 7469 6f6e 732c 0a20  ee partitions,. 
+00002550: 2020 2020 2020 2077 6865 7265 2074 6865         where the
+00002560: 2069 6e64 6578 2069 6e20 6561 6368 2070   index in each p
+00002570: 6172 7469 7469 6f6e 2063 6f6e 7461 696e  artition contain
+00002580: 7320 7661 6c75 6573 205b 302c 2031 3029  s values [0, 10)
+00002590: 2c20 5b31 302c 2035 3029 2c0a 2020 2020  , [10, 50),.    
+000025a0: 2020 2020 616e 6420 5b35 302c 2031 3030      and [50, 100
+000025b0: 5d2c 2072 6573 7065 6374 6976 656c 792e  ], respectively.
+000025c0: 2044 6173 6b20 7468 6572 6566 6f72 6520   Dask therefore 
+000025d0: 6b6e 6f77 7320 6060 6466 2e6c 6f63 5b34  knows ``df.loc[4
+000025e0: 355d 6060 0a20 2020 2020 2020 2077 696c  5]``.        wil
+000025f0: 6c20 6265 2069 6e20 7468 6520 7365 636f  l be in the seco
+00002600: 6e64 2070 6172 7469 7469 6f6e 2e0a 0a20  nd partition... 
+00002610: 2020 2020 2020 2057 6865 6e20 6576 6572         When ever
+00002620: 7920 6974 656d 2069 6e20 6060 6469 7669  y item in ``divi
+00002630: 7369 6f6e 7360 6020 6973 2060 604e 6f6e  sions`` is ``Non
+00002640: 6560 602c 2074 6865 2064 6976 6973 696f  e``, the divisio
+00002650: 6e73 2061 7265 2075 6e6b 6e6f 776e 2e0a  ns are unknown..
+00002660: 2020 2020 2020 2020 4d6f 7374 206f 7065          Most ope
+00002670: 7261 7469 6f6e 7320 6361 6e20 7374 696c  rations can stil
+00002680: 6c20 6265 2070 6572 666f 726d 6564 2c20  l be performed, 
+00002690: 6275 7420 736f 6d65 2077 696c 6c20 6265  but some will be
+000026a0: 206d 7563 6820 736c 6f77 6572 2c0a 2020   much slower,.  
+000026b0: 2020 2020 2020 616e 6420 6120 6665 7720        and a few 
+000026c0: 6d61 7920 6661 696c 2e0a 0a20 2020 2020  may fail...     
+000026d0: 2020 2049 7420 6973 206e 6f74 2073 7570     It is not sup
+000026e0: 706f 7274 6564 2074 6f20 7365 7420 6060  ported to set ``
+000026f0: 6469 7669 7369 6f6e 7360 6020 6469 7265  divisions`` dire
+00002700: 6374 6c79 2e20 496e 7374 6561 642c 2075  ctly. Instead, u
+00002710: 7365 2060 6073 6574 5f69 6e64 6578 6060  se ``set_index``
+00002720: 2c0a 2020 2020 2020 2020 7768 6963 6820  ,.        which 
+00002730: 736f 7274 7320 616e 6420 7370 6c69 7473  sorts and splits
+00002740: 2074 6865 2064 6174 6120 6173 206e 6565   the data as nee
+00002750: 6465 642e 0a20 2020 2020 2020 2053 6565  ded..        See
+00002760: 2068 7474 7073 3a2f 2f64 6f63 732e 6461   https://docs.da
+00002770: 736b 2e6f 7267 2f65 6e2f 6c61 7465 7374  sk.org/en/latest
+00002780: 2f64 6174 6166 7261 6d65 2d64 6573 6967  /dataframe-desig
+00002790: 6e2e 6874 6d6c 2370 6172 7469 7469 6f6e  n.html#partition
+000027a0: 732e 0a20 2020 2020 2020 2022 2222 0a20  s..        """. 
+000027b0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+000027c0: 6c66 2e65 7870 722e 6469 7669 7369 6f6e  lf.expr.division
+000027d0: 730a 0a20 2020 2040 7072 6f70 6572 7479  s..    @property
+000027e0: 0a20 2020 2064 6566 206e 7061 7274 6974  .    def npartit
+000027f0: 696f 6e73 2873 656c 6629 3a0a 2020 2020  ions(self):.    
+00002800: 2020 2020 2222 2252 6574 7572 6e20 6e75      """Return nu
+00002810: 6d62 6572 206f 6620 7061 7274 6974 696f  mber of partitio
+00002820: 6e73 2222 220a 2020 2020 2020 2020 7265  ns""".        re
+00002830: 7475 726e 2073 656c 662e 6578 7072 2e6e  turn self.expr.n
+00002840: 7061 7274 6974 696f 6e73 0a0a 2020 2020  partitions..    
+00002850: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+00002860: 6620 6474 7970 6573 2873 656c 6629 3a0a  f dtypes(self):.
+00002870: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
+00002880: 6e20 6461 7461 2074 7970 6573 2222 220a  n data types""".
+00002890: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+000028a0: 656c 662e 6578 7072 2e5f 6d65 7461 2e64  elf.expr._meta.d
+000028b0: 7479 7065 730a 0a20 2020 2040 7072 6f70  types..    @prop
+000028c0: 6572 7479 0a20 2020 2064 6566 2073 697a  erty.    def siz
+000028d0: 6528 7365 6c66 293a 0a20 2020 2020 2020  e(self):.       
+000028e0: 2022 2222 5369 7a65 206f 6620 7468 6520   """Size of the 
+000028f0: 5365 7269 6573 206f 7220 4461 7461 4672  Series or DataFr
+00002900: 616d 6520 6173 2061 2044 656c 6179 6564  ame as a Delayed
+00002910: 206f 626a 6563 742e 0a0a 2020 2020 2020   object...      
+00002920: 2020 4578 616d 706c 6573 0a20 2020 2020    Examples.     
+00002930: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
+00002940: 2020 2020 3e3e 3e20 7365 7269 6573 2e73      >>> series.s
+00002950: 697a 6520 2023 2064 6f63 7465 7374 3a20  ize  # doctest: 
+00002960: 2b53 4b49 500a 2020 2020 2020 2020 3c64  +SKIP.        <d
+00002970: 6173 6b5f 6578 7072 2e65 7870 722e 5363  ask_expr.expr.Sc
+00002980: 616c 6172 3a20 6578 7072 3d64 662e 7369  alar: expr=df.si
+00002990: 7a65 2829 2c20 6474 7970 653d 696e 7436  ze(), dtype=int6
+000029a0: 343e 0a20 2020 2020 2020 2022 2222 0a20  4>.        """. 
+000029b0: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
+000029c0: 775f 636f 6c6c 6563 7469 6f6e 2873 656c  w_collection(sel
+000029d0: 662e 6578 7072 2e73 697a 6529 0a0a 2020  f.expr.size)..  
+000029e0: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+000029f0: 6465 6620 636f 6c75 6d6e 7328 7365 6c66  def columns(self
+00002a00: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+00002a10: 6e20 7365 6c66 2e5f 6d65 7461 2e63 6f6c  n self._meta.col
+00002a20: 756d 6e73 0a0a 2020 2020 4063 6f6c 756d  umns..    @colum
+00002a30: 6e73 2e73 6574 7465 720a 2020 2020 6465  ns.setter.    de
+00002a40: 6620 636f 6c75 6d6e 7328 7365 6c66 2c20  f columns(self, 
+00002a50: 636f 6c75 6d6e 7329 3a0a 2020 2020 2020  columns):.      
+00002a60: 2020 6966 206c 656e 2863 6f6c 756d 6e73    if len(columns
+00002a70: 2920 213d 206c 656e 2873 656c 662e 636f  ) != len(self.co
+00002a80: 6c75 6d6e 7329 3a0a 2020 2020 2020 2020  lumns):.        
+00002a90: 2020 2020 2320 7375 7266 6163 6520 7061      # surface pa
+00002aa0: 6e64 6173 2065 7272 6f72 0a20 2020 2020  ndas error.     
+00002ab0: 2020 2020 2020 2073 656c 662e 5f65 7870         self._exp
+00002ac0: 722e 5f6d 6574 612e 636f 6c75 6d6e 7320  r._meta.columns 
+00002ad0: 3d20 636f 6c75 6d6e 730a 2020 2020 2020  = columns.      
+00002ae0: 2020 7365 6c66 2e5f 6578 7072 203d 2065    self._expr = e
+00002af0: 7870 722e 436f 6c75 6d6e 7353 6574 7465  xpr.ColumnsSette
+00002b00: 7228 7365 6c66 2c20 636f 6c75 6d6e 7329  r(self, columns)
+00002b10: 0a0a 2020 2020 6465 6620 636c 6561 725f  ..    def clear_
+00002b20: 6469 7669 7369 6f6e 7328 7365 6c66 293a  divisions(self):
+00002b30: 0a20 2020 2020 2020 2022 2222 466f 7267  .        """Forg
+00002b40: 6574 2064 6976 6973 696f 6e20 696e 666f  et division info
+00002b50: 726d 6174 696f 6e2e 0a0a 2020 2020 2020  rmation...      
+00002b60: 2020 5468 6973 2069 7320 7573 6566 756c    This is useful
+00002b70: 2069 6620 7468 6520 6469 7669 7369 6f6e   if the division
+00002b80: 7320 6172 6520 6e6f 206c 6f6e 6765 7220  s are no longer 
+00002b90: 6d65 616e 696e 6766 756c 2e0a 2020 2020  meaningful..    
+00002ba0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00002bb0: 7265 7475 726e 206e 6577 5f63 6f6c 6c65  return new_colle
+00002bc0: 6374 696f 6e28 6578 7072 2e43 6c65 6172  ction(expr.Clear
+00002bd0: 4469 7669 7369 6f6e 7328 7365 6c66 2929  Divisions(self))
+00002be0: 0a0a 2020 2020 6465 6620 5f5f 6c65 6e5f  ..    def __len_
+00002bf0: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
+00002c00: 2072 6574 7572 6e20 6e65 775f 636f 6c6c   return new_coll
+00002c10: 6563 7469 6f6e 284c 656e 2873 656c 6629  ection(Len(self)
+00002c20: 292e 636f 6d70 7574 6528 290a 0a20 2020  ).compute()..   
+00002c30: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+00002c40: 6566 206e 6279 7465 7328 7365 6c66 293a  ef nbytes(self):
+00002c50: 0a20 2020 2020 2020 2072 6169 7365 204e  .        raise N
+00002c60: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
+00002c70: 6f72 2822 6e62 7974 6573 2069 7320 6e6f  or("nbytes is no
+00002c80: 7420 696d 706c 656d 656e 7465 6420 6f6e  t implemented on
+00002c90: 2044 6174 6146 7261 6d65 2229 0a0a 2020   DataFrame")..  
+00002ca0: 2020 6465 6620 5f5f 7265 6475 6365 5f5f    def __reduce__
+00002cb0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00002cc0: 7265 7475 726e 206e 6577 5f63 6f6c 6c65  return new_colle
+00002cd0: 6374 696f 6e2c 2028 7365 6c66 2e5f 6578  ction, (self._ex
+00002ce0: 7072 2c29 0a0a 2020 2020 6465 6620 5f5f  pr,)..    def __
+00002cf0: 6765 7469 7465 6d5f 5f28 7365 6c66 2c20  getitem__(self, 
+00002d00: 6f74 6865 7229 3a0a 2020 2020 2020 2020  other):.        
+00002d10: 6966 2069 7369 6e73 7461 6e63 6528 6f74  if isinstance(ot
+00002d20: 6865 722c 2046 7261 6d65 4261 7365 293a  her, FrameBase):
+00002d30: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00002d40: 7572 6e20 6e65 775f 636f 6c6c 6563 7469  urn new_collecti
+00002d50: 6f6e 2873 656c 662e 6578 7072 2e5f 5f67  on(self.expr.__g
+00002d60: 6574 6974 656d 5f5f 286f 7468 6572 2e65  etitem__(other.e
+00002d70: 7870 7229 290a 2020 2020 2020 2020 656c  xpr)).        el
+00002d80: 6966 2069 7369 6e73 7461 6e63 6528 6f74  if isinstance(ot
+00002d90: 6865 722c 2073 6c69 6365 293a 0a20 2020  her, slice):.   
+00002da0: 2020 2020 2020 2020 2066 726f 6d20 7061           from pa
+00002db0: 6e64 6173 2e61 7069 2e74 7970 6573 2069  ndas.api.types i
+00002dc0: 6d70 6f72 7420 6973 5f66 6c6f 6174 5f64  mport is_float_d
+00002dd0: 7479 7065 0a0a 2020 2020 2020 2020 2020  type..          
+00002de0: 2020 6973 5f69 6e74 6567 6572 5f73 6c69    is_integer_sli
+00002df0: 6365 203d 2061 6e79 280a 2020 2020 2020  ce = any(.      
+00002e00: 2020 2020 2020 2020 2020 6973 696e 7374            isinst
+00002e10: 616e 6365 2869 2c20 496e 7465 6772 616c  ance(i, Integral
+00002e20: 2920 666f 7220 6920 696e 2028 6f74 6865  ) for i in (othe
+00002e30: 722e 7374 6172 742c 206f 7468 6572 2e73  r.start, other.s
+00002e40: 7465 702c 206f 7468 6572 2e73 746f 7029  tep, other.stop)
+00002e50: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00002e60: 2020 2020 2020 2020 2020 2069 6620 280a             if (.
+00002e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002e80: 7365 6c66 2e6e 6469 6d20 3d3d 2032 0a20  self.ndim == 2. 
+00002e90: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00002ea0: 6e64 2069 735f 696e 7465 6765 725f 736c  nd is_integer_sl
+00002eb0: 6963 650a 2020 2020 2020 2020 2020 2020  ice.            
+00002ec0: 2020 2020 616e 6420 6e6f 7420 6973 5f66      and not is_f
+00002ed0: 6c6f 6174 5f64 7479 7065 2873 656c 662e  loat_dtype(self.
+00002ee0: 696e 6465 782e 6474 7970 6529 0a20 2020  index.dtype).   
+00002ef0: 2020 2020 2020 2020 2029 3a0a 2020 2020           ):.    
+00002f00: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00002f10: 726e 2073 656c 662e 696c 6f63 5b6f 7468  rn self.iloc[oth
+00002f20: 6572 5d0a 2020 2020 2020 2020 2020 2020  er].            
+00002f30: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00002f40: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00002f50: 662e 6c6f 635b 6f74 6865 725d 0a20 2020  f.loc[other].   
+00002f60: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+00002f70: 6365 286f 7468 6572 2c20 6e70 2e6e 6461  ce(other, np.nda
+00002f80: 7272 6179 2920 6f72 2069 735f 7365 7269  rray) or is_seri
+00002f90: 6573 5f6c 696b 6528 6f74 6865 7229 3a0a  es_like(other):.
+00002fa0: 2020 2020 2020 2020 2020 2020 6f74 6865              othe
+00002fb0: 7220 3d20 6c69 7374 286f 7468 6572 290a  r = list(other).
+00002fc0: 2020 2020 2020 2020 656c 6966 2069 7369          elif isi
+00002fd0: 6e73 7461 6e63 6528 6f74 6865 722c 206c  nstance(other, l
+00002fe0: 6973 7429 3a0a 2020 2020 2020 2020 2020  ist):.          
+00002ff0: 2020 6f74 6865 7220 3d20 6f74 6865 722e    other = other.
+00003000: 636f 7079 2829 0a20 2020 2020 2020 2072  copy().        r
+00003010: 6574 7572 6e20 6e65 775f 636f 6c6c 6563  eturn new_collec
+00003020: 7469 6f6e 2873 656c 662e 6578 7072 2e5f  tion(self.expr._
+00003030: 5f67 6574 6974 656d 5f5f 286f 7468 6572  _getitem__(other
+00003040: 2929 0a0a 2020 2020 6465 6620 5f5f 6461  ))..    def __da
+00003050: 736b 5f74 6f6b 656e 697a 655f 5f28 7365  sk_tokenize__(se
+00003060: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
+00003070: 7572 6e20 7479 7065 2873 656c 6629 2e5f  urn type(self)._
+00003080: 5f6e 616d 655f 5f2c 2073 656c 662e 5f65  _name__, self._e
+00003090: 7870 722e 5f6e 616d 650a 0a20 2020 2064  xpr._name..    d
+000030a0: 6566 205f 5f72 6570 725f 5f28 7365 6c66  ef __repr__(self
+000030b0: 293a 0a20 2020 2020 2020 2064 6174 6120  ):.        data 
+000030c0: 3d20 7365 6c66 2e5f 7265 7072 5f64 6174  = self._repr_dat
+000030d0: 6128 292e 746f 5f73 7472 696e 6728 6d61  a().to_string(ma
+000030e0: 785f 726f 7773 3d35 290a 2020 2020 2020  x_rows=5).      
+000030f0: 2020 5f73 7472 5f66 6d74 203d 2022 2222    _str_fmt = """
+00003100: 4461 736b 207b 6b6c 6173 737d 2053 7472  Dask {klass} Str
+00003110: 7563 7475 7265 3a0a 7b64 6174 617d 0a44  ucture:.{data}.D
+00003120: 6173 6b20 4e61 6d65 3a20 7b6e 616d 657d  ask Name: {name}
+00003130: 2c20 7b6e 5f65 7870 727d 0a45 7870 723d  , {n_expr}.Expr=
+00003140: 7b65 7870 727d 2222 220a 2020 2020 2020  {expr}""".      
+00003150: 2020 6966 206e 6f74 2069 7369 6e73 7461    if not isinsta
+00003160: 6e63 6528 7365 6c66 2c20 5365 7269 6573  nce(self, Series
+00003170: 2920 616e 6420 6e6f 7420 6c65 6e28 7365  ) and not len(se
+00003180: 6c66 2e63 6f6c 756d 6e73 293a 0a20 2020  lf.columns):.   
+00003190: 2020 2020 2020 2020 2064 6174 6120 3d20           data = 
+000031a0: 6461 7461 2e70 6172 7469 7469 6f6e 2822  data.partition("
+000031b0: 5c6e 2229 5b2d 315d 2e72 6570 6c61 6365  \n")[-1].replace
+000031c0: 2822 496e 6465 7822 2c20 2244 6976 6973  ("Index", "Divis
+000031d0: 696f 6e73 2229 0a20 2020 2020 2020 2020  ions").         
+000031e0: 2020 205f 7374 725f 666d 7420 3d20 6622     _str_fmt = f"
+000031f0: 456d 7074 7920 7b5f 7374 725f 666d 747d  Empty {_str_fmt}
+00003200: 220a 2020 2020 2020 2020 6e5f 6578 7072  ".        n_expr
+00003210: 203d 206c 656e 287b 652e 5f6e 616d 6520   = len({e._name 
+00003220: 666f 7220 6520 696e 2073 656c 662e 6578  for e in self.ex
+00003230: 7072 2e77 616c 6b28 297d 290a 0a20 2020  pr.walk()})..   
+00003240: 2020 2020 2072 6574 7572 6e20 5f73 7472       return _str
+00003250: 5f66 6d74 2e66 6f72 6d61 7428 0a20 2020  _fmt.format(.   
+00003260: 2020 2020 2020 2020 206b 6c61 7373 3d73           klass=s
+00003270: 656c 662e 5f5f 636c 6173 735f 5f2e 5f5f  elf.__class__.__
+00003280: 6e61 6d65 5f5f 2c0a 2020 2020 2020 2020  name__,.        
+00003290: 2020 2020 6461 7461 3d64 6174 612c 0a20      data=data,. 
+000032a0: 2020 2020 2020 2020 2020 206e 616d 653d             name=
+000032b0: 6b65 795f 7370 6c69 7428 7365 6c66 2e5f  key_split(self._
+000032c0: 6e61 6d65 292c 0a20 2020 2020 2020 2020  name),.         
+000032d0: 2020 206e 5f65 7870 723d 6d61 7962 655f     n_expr=maybe_
+000032e0: 706c 7572 616c 697a 6528 6e5f 6578 7072  pluralize(n_expr
+000032f0: 2c20 2265 7870 7265 7373 696f 6e22 292c  , "expression"),
+00003300: 0a20 2020 2020 2020 2020 2020 2065 7870  .            exp
+00003310: 723d 7365 6c66 2e65 7870 722c 0a20 2020  r=self.expr,.   
+00003320: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
+00003330: 5f5f 626f 6f6c 5f5f 2873 656c 6629 3a0a  __bool__(self):.
+00003340: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+00003350: 6c75 6545 7272 6f72 280a 2020 2020 2020  lueError(.      
+00003360: 2020 2020 2020 6622 5468 6520 7472 7574        f"The trut
+00003370: 6820 7661 6c75 6520 6f66 2061 207b 7365  h value of a {se
+00003380: 6c66 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e  lf.__class__.__n
+00003390: 616d 655f 5f7d 2069 7320 616d 6269 6775  ame__} is ambigu
+000033a0: 6f75 732e 2022 0a20 2020 2020 2020 2020  ous. ".         
+000033b0: 2020 2022 5573 6520 612e 616e 7928 2920     "Use a.any() 
+000033c0: 6f72 2061 2e61 6c6c 2829 2e22 0a20 2020  or a.all().".   
+000033d0: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
+000033e0: 5f5f 6172 7261 795f 5f28 7365 6c66 2c20  __array__(self, 
+000033f0: 6474 7970 653d 4e6f 6e65 2c20 2a2a 6b77  dtype=None, **kw
+00003400: 6172 6773 293a 0a20 2020 2020 2020 2072  args):.        r
+00003410: 6574 7572 6e20 6e70 2e61 7272 6179 2873  eturn np.array(s
+00003420: 656c 662e 636f 6d70 7574 6528 2929 0a0a  elf.compute())..
+00003430: 2020 2020 6465 6620 7065 7273 6973 7428      def persist(
+00003440: 7365 6c66 2c20 6675 7365 3d54 7275 652c  self, fuse=True,
+00003450: 202a 2a6b 7761 7267 7329 3a0a 2020 2020   **kwargs):.    
+00003460: 2020 2020 6f75 7420 3d20 7365 6c66 2e6f      out = self.o
+00003470: 7074 696d 697a 6528 6675 7365 3d66 7573  ptimize(fuse=fus
+00003480: 6529 0a20 2020 2020 2020 2072 6574 7572  e).        retur
+00003490: 6e20 4461 736b 4d65 7468 6f64 734d 6978  n DaskMethodsMix
+000034a0: 696e 2e70 6572 7369 7374 286f 7574 2c20  in.persist(out, 
+000034b0: 2a2a 6b77 6172 6773 290a 0a20 2020 2064  **kwargs)..    d
+000034c0: 6566 2063 6f6d 7075 7465 2873 656c 662c  ef compute(self,
+000034d0: 2066 7573 653d 5472 7565 2c20 2a2a 6b77   fuse=True, **kw
+000034e0: 6172 6773 293a 0a20 2020 2020 2020 206f  args):.        o
+000034f0: 7574 203d 2073 656c 660a 2020 2020 2020  ut = self.      
+00003500: 2020 6966 206e 6f74 2069 7369 6e73 7461    if not isinsta
+00003510: 6e63 6528 6f75 742c 2053 6361 6c61 7229  nce(out, Scalar)
+00003520: 3a0a 2020 2020 2020 2020 2020 2020 6f75  :.            ou
+00003530: 7420 3d20 6f75 742e 7265 7061 7274 6974  t = out.repartit
+00003540: 696f 6e28 6e70 6172 7469 7469 6f6e 733d  ion(npartitions=
+00003550: 3129 0a20 2020 2020 2020 206f 7574 203d  1).        out =
+00003560: 206f 7574 2e6f 7074 696d 697a 6528 6675   out.optimize(fu
+00003570: 7365 3d66 7573 6529 0a20 2020 2020 2020  se=fuse).       
+00003580: 2072 6574 7572 6e20 4461 736b 4d65 7468   return DaskMeth
+00003590: 6f64 734d 6978 696e 2e63 6f6d 7075 7465  odsMixin.compute
+000035a0: 286f 7574 2c20 2a2a 6b77 6172 6773 290a  (out, **kwargs).
+000035b0: 0a20 2020 2064 6566 2061 6e61 6c79 7a65  .    def analyze
+000035c0: 2873 656c 662c 2066 696c 656e 616d 653a  (self, filename:
+000035d0: 2073 7472 207c 204e 6f6e 6520 3d20 4e6f   str | None = No
+000035e0: 6e65 2c20 666f 726d 6174 3a20 7374 7220  ne, format: str 
+000035f0: 7c20 4e6f 6e65 203d 204e 6f6e 6529 202d  | None = None) -
+00003600: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
+00003610: 6f75 7420 3d20 7365 6c66 0a20 2020 2020  out = self.     
+00003620: 2020 2069 6620 6e6f 7420 6973 696e 7374     if not isinst
+00003630: 616e 6365 286f 7574 2c20 5363 616c 6172  ance(out, Scalar
+00003640: 293a 0a20 2020 2020 2020 2020 2020 206f  ):.            o
+00003650: 7574 203d 206f 7574 2e72 6570 6172 7469  ut = out.reparti
+00003660: 7469 6f6e 286e 7061 7274 6974 696f 6e73  tion(npartitions
+00003670: 3d31 290a 2020 2020 2020 2020 7265 7475  =1).        retu
+00003680: 726e 206f 7574 2e65 7870 722e 616e 616c  rn out.expr.anal
+00003690: 797a 6528 6669 6c65 6e61 6d65 3d66 696c  yze(filename=fil
+000036a0: 656e 616d 652c 2066 6f72 6d61 743d 666f  ename, format=fo
+000036b0: 726d 6174 290a 0a20 2020 2064 6566 2065  rmat)..    def e
+000036c0: 7870 6c61 696e 2873 656c 662c 2073 7461  xplain(self, sta
+000036d0: 6765 3a20 4f70 7469 6d69 7a65 7253 7461  ge: OptimizerSta
+000036e0: 6765 203d 2022 6675 7365 6422 2c20 666f  ge = "fused", fo
+000036f0: 726d 6174 3a20 7374 7220 7c20 4e6f 6e65  rmat: str | None
+00003700: 203d 204e 6f6e 6529 3a0a 2020 2020 2020   = None):.      
+00003710: 2020 6f75 7420 3d20 7365 6c66 0a20 2020    out = self.   
+00003720: 2020 2020 2069 6620 6e6f 7420 6973 696e       if not isin
+00003730: 7374 616e 6365 286f 7574 2c20 5363 616c  stance(out, Scal
+00003740: 6172 293a 0a20 2020 2020 2020 2020 2020  ar):.           
+00003750: 206f 7574 203d 206f 7574 2e72 6570 6172   out = out.repar
+00003760: 7469 7469 6f6e 286e 7061 7274 6974 696f  tition(npartitio
+00003770: 6e73 3d31 290a 2020 2020 2020 2020 7265  ns=1).        re
+00003780: 7475 726e 206f 7574 2e65 7870 722e 6578  turn out.expr.ex
+00003790: 706c 6169 6e28 7374 6167 652c 2066 6f72  plain(stage, for
+000037a0: 6d61 7429 0a0a 2020 2020 4070 726f 7065  mat)..    @prope
+000037b0: 7274 790a 2020 2020 6465 6620 6461 736b  rty.    def dask
+000037c0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+000037d0: 7265 7475 726e 2073 656c 662e 5f5f 6461  return self.__da
+000037e0: 736b 5f67 7261 7068 5f5f 2829 0a0a 2020  sk_graph__()..  
+000037f0: 2020 6465 6620 5f5f 6461 736b 5f67 7261    def __dask_gra
+00003800: 7068 5f5f 2873 656c 6629 3a0a 2020 2020  ph__(self):.    
+00003810: 2020 2020 6f75 7420 3d20 7365 6c66 2e65      out = self.e
+00003820: 7870 720a 2020 2020 2020 2020 6f75 7420  xpr.        out 
+00003830: 3d20 6f75 742e 6c6f 7765 725f 636f 6d70  = out.lower_comp
+00003840: 6c65 7465 6c79 2829 0a20 2020 2020 2020  letely().       
+00003850: 2072 6574 7572 6e20 6f75 742e 5f5f 6461   return out.__da
+00003860: 736b 5f67 7261 7068 5f5f 2829 0a0a 2020  sk_graph__()..  
+00003870: 2020 6465 6620 5f5f 6461 736b 5f6b 6579    def __dask_key
+00003880: 735f 5f28 7365 6c66 293a 0a20 2020 2020  s__(self):.     
+00003890: 2020 206f 7574 203d 2073 656c 662e 6578     out = self.ex
+000038a0: 7072 0a20 2020 2020 2020 206f 7574 203d  pr.        out =
+000038b0: 206f 7574 2e6c 6f77 6572 5f63 6f6d 706c   out.lower_compl
+000038c0: 6574 656c 7928 290a 2020 2020 2020 2020  etely().        
+000038d0: 7265 7475 726e 206f 7574 2e5f 5f64 6173  return out.__das
+000038e0: 6b5f 6b65 7973 5f5f 2829 0a0a 2020 2020  k_keys__()..    
+000038f0: 6465 6620 7369 6d70 6c69 6679 2873 656c  def simplify(sel
+00003900: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
+00003910: 726e 206e 6577 5f63 6f6c 6c65 6374 696f  rn new_collectio
+00003920: 6e28 7365 6c66 2e65 7870 722e 7369 6d70  n(self.expr.simp
+00003930: 6c69 6679 2829 290a 0a20 2020 2064 6566  lify())..    def
+00003940: 206c 6f77 6572 5f6f 6e63 6528 7365 6c66   lower_once(self
+00003950: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+00003960: 6e20 6e65 775f 636f 6c6c 6563 7469 6f6e  n new_collection
+00003970: 2873 656c 662e 6578 7072 2e6c 6f77 6572  (self.expr.lower
+00003980: 5f6f 6e63 6528 2929 0a0a 2020 2020 6465  _once())..    de
+00003990: 6620 6f70 7469 6d69 7a65 2873 656c 662c  f optimize(self,
+000039a0: 2066 7573 653a 2062 6f6f 6c20 3d20 5472   fuse: bool = Tr
+000039b0: 7565 293a 0a20 2020 2020 2020 2072 6574  ue):.        ret
+000039c0: 7572 6e20 6e65 775f 636f 6c6c 6563 7469  urn new_collecti
+000039d0: 6f6e 2873 656c 662e 6578 7072 2e6f 7074  on(self.expr.opt
+000039e0: 696d 697a 6528 6675 7365 3d66 7573 6529  imize(fuse=fuse)
+000039f0: 290a 0a20 2020 2040 7072 6f70 6572 7479  )..    @property
+00003a00: 0a20 2020 2064 6566 2064 6173 6b28 7365  .    def dask(se
+00003a10: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
+00003a20: 7572 6e20 7365 6c66 2e5f 5f64 6173 6b5f  urn self.__dask_
+00003a30: 6772 6170 685f 5f28 290a 0a20 2020 2064  graph__()..    d
+00003a40: 6566 205f 5f64 6173 6b5f 706f 7374 636f  ef __dask_postco
+00003a50: 6d70 7574 655f 5f28 7365 6c66 293a 0a20  mpute__(self):. 
+00003a60: 2020 2020 2020 2073 7461 7465 203d 206e         state = n
+00003a70: 6577 5f63 6f6c 6c65 6374 696f 6e28 7365  ew_collection(se
+00003a80: 6c66 2e65 7870 722e 6c6f 7765 725f 636f  lf.expr.lower_co
+00003a90: 6d70 6c65 7465 6c79 2829 290a 2020 2020  mpletely()).    
+00003aa0: 2020 2020 6966 2074 7970 6528 7365 6c66      if type(self
+00003ab0: 2920 213d 2074 7970 6528 7374 6174 6529  ) != type(state)
+00003ac0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+00003ad0: 7475 726e 2073 7461 7465 2e5f 5f64 6173  turn state.__das
+00003ae0: 6b5f 706f 7374 636f 6d70 7574 655f 5f28  k_postcompute__(
+00003af0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+00003b00: 205f 636f 6e63 6174 2c20 2829 0a0a 2020   _concat, ()..  
+00003b10: 2020 6465 6620 5f5f 6461 736b 5f70 6f73    def __dask_pos
+00003b20: 7470 6572 7369 7374 5f5f 2873 656c 6629  tpersist__(self)
+00003b30: 3a0a 2020 2020 2020 2020 7374 6174 6520  :.        state 
+00003b40: 3d20 6e65 775f 636f 6c6c 6563 7469 6f6e  = new_collection
+00003b50: 2873 656c 662e 6578 7072 2e6c 6f77 6572  (self.expr.lower
+00003b60: 5f63 6f6d 706c 6574 656c 7928 2929 0a20  _completely()). 
+00003b70: 2020 2020 2020 2072 6574 7572 6e20 6672         return fr
+00003b80: 6f6d 5f67 7261 7068 2c20 280a 2020 2020  om_graph, (.    
+00003b90: 2020 2020 2020 2020 7374 6174 652e 5f6d          state._m
+00003ba0: 6574 612c 0a20 2020 2020 2020 2020 2020  eta,.           
+00003bb0: 2073 7461 7465 2e64 6976 6973 696f 6e73   state.divisions
+00003bc0: 2c0a 2020 2020 2020 2020 2020 2020 7374  ,.            st
+00003bd0: 6174 652e 5f5f 6461 736b 5f6b 6579 735f  ate.__dask_keys_
+00003be0: 5f28 292c 0a20 2020 2020 2020 2020 2020  _(),.           
+00003bf0: 206b 6579 5f73 706c 6974 2873 7461 7465   key_split(state
+00003c00: 2e5f 6e61 6d65 292c 0a20 2020 2020 2020  ._name),.       
+00003c10: 2029 0a0a 2020 2020 6465 6620 5f5f 6765   )..    def __ge
+00003c20: 7461 7474 725f 5f28 7365 6c66 2c20 6b65  tattr__(self, ke
+00003c30: 7929 3a0a 2020 2020 2020 2020 7472 793a  y):.        try:
+00003c40: 0a20 2020 2020 2020 2020 2020 2023 2050  .            # P
+00003c50: 7269 6f72 6974 697a 6520 6046 7261 6d65  rioritize `Frame
+00003c60: 4261 7365 6020 6174 7472 6962 7574 6573  Base` attributes
+00003c70: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00003c80: 7572 6e20 6f62 6a65 6374 2e5f 5f67 6574  urn object.__get
+00003c90: 6174 7472 6962 7574 655f 5f28 7365 6c66  attribute__(self
+00003ca0: 2c20 6b65 7929 0a20 2020 2020 2020 2065  , key).        e
+00003cb0: 7863 6570 7420 4174 7472 6962 7574 6545  xcept AttributeE
+00003cc0: 7272 6f72 2061 7320 6572 723a 0a20 2020  rror as err:.   
+00003cd0: 2020 2020 2020 2020 2074 7279 3a0a 2020           try:.  
+00003ce0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+00003cf0: 4661 6c6c 2062 6163 6b20 746f 2060 6578  Fall back to `ex
+00003d00: 7072 6020 4150 490a 2020 2020 2020 2020  pr` API.        
+00003d10: 2020 2020 2020 2020 2320 284d 616b 696e          # (Makin
+00003d20: 6720 7375 7265 2074 6f20 636f 6e76 6572  g sure to conver
+00003d30: 7420 746f 2f66 726f 6d20 4578 7072 290a  t to/from Expr).
+00003d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003d50: 7661 6c20 3d20 6765 7461 7474 7228 7365  val = getattr(se
+00003d60: 6c66 2e65 7870 722c 206b 6579 290a 2020  lf.expr, key).  
+00003d70: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00003d80: 2063 616c 6c61 626c 6528 7661 6c29 3a0a   callable(val):.
 00003d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003da0: 2020 7265 7475 726e 2066 756e 6374 6f6f    return functoo
-00003db0: 6c73 2e70 6172 7469 616c 285f 7772 6170  ls.partial(_wrap
-00003dc0: 5f65 7870 725f 6170 692c 2077 7261 705f  _expr_api, wrap_
-00003dd0: 6170 693d 7661 6c29 0a20 2020 2020 2020  api=val).       
-00003de0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00003df0: 7661 6c0a 2020 2020 2020 2020 2020 2020  val.            
-00003e00: 6578 6365 7074 2041 7474 7269 6275 7465  except Attribute
-00003e10: 4572 726f 723a 0a20 2020 2020 2020 2020  Error:.         
-00003e20: 2020 2020 2020 2023 2052 6169 7365 206f         # Raise o
-00003e30: 7269 6769 6e61 6c20 6572 726f 720a 2020  riginal error.  
-00003e40: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-00003e50: 6973 6520 6572 720a 0a20 2020 2064 6566  ise err..    def
-00003e60: 2076 6973 7561 6c69 7a65 2873 656c 662c   visualize(self,
-00003e70: 2074 6173 6b73 3a20 626f 6f6c 203d 2046   tasks: bool = F
-00003e80: 616c 7365 2c20 2a2a 6b77 6172 6773 293a  alse, **kwargs):
-00003e90: 0a20 2020 2020 2020 2022 2222 5669 7375  .        """Visu
-00003ea0: 616c 697a 6520 7468 6520 6578 7072 6573  alize the expres
-00003eb0: 7369 6f6e 206f 7220 7461 736b 2067 7261  sion or task gra
-00003ec0: 7068 0a0a 2020 2020 2020 2020 5061 7261  ph..        Para
-00003ed0: 6d65 7465 7273 0a20 2020 2020 2020 202d  meters.        -
-00003ee0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-00003ef0: 2020 7461 736b 733a 0a20 2020 2020 2020    tasks:.       
-00003f00: 2020 2020 2057 6865 7468 6572 2074 6f20       Whether to 
-00003f10: 7669 7375 616c 697a 6520 7468 6520 7461  visualize the ta
-00003f20: 736b 2067 7261 7068 2e20 4279 2064 6566  sk graph. By def
-00003f30: 6175 6c74 0a20 2020 2020 2020 2020 2020  ault.           
-00003f40: 2074 6865 2065 7870 7265 7373 696f 6e20   the expression 
-00003f50: 6772 6170 6820 7769 6c6c 2062 6520 7669  graph will be vi
-00003f60: 7375 616c 697a 6564 2069 6e73 7465 6164  sualized instead
-00003f70: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00003f80: 2020 2020 2020 6966 2074 6173 6b73 3a0a        if tasks:.
-00003f90: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00003fa0: 726e 2073 7570 6572 2829 2e76 6973 7561  rn super().visua
-00003fb0: 6c69 7a65 282a 2a6b 7761 7267 7329 0a20  lize(**kwargs). 
-00003fc0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00003fd0: 6c66 2e65 7870 722e 7669 7375 616c 697a  lf.expr.visualiz
-00003fe0: 6528 2a2a 6b77 6172 6773 290a 0a20 2020  e(**kwargs)..   
-00003ff0: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
-00004000: 6566 206b 6e6f 776e 5f64 6976 6973 696f  ef known_divisio
-00004010: 6e73 2873 656c 6629 3a0a 2020 2020 2020  ns(self):.      
-00004020: 2020 2222 2257 6865 7468 6572 2074 6865    """Whether the
-00004030: 2064 6976 6973 696f 6e73 2061 7265 206b   divisions are k
-00004040: 6e6f 776e 2e0a 0a20 2020 2020 2020 2054  nown...        T
-00004050: 6869 7320 6368 6563 6b20 6361 6e20 6265  his check can be
-00004060: 2065 7870 656e 7369 7665 2069 6620 7468   expensive if th
-00004070: 6520 6469 7669 7369 6f6e 2063 616c 6375  e division calcu
-00004080: 6c61 7469 6f6e 2069 7320 6578 7065 6e73  lation is expens
-00004090: 6976 652e 0a20 2020 2020 2020 2044 6174  ive..        Dat
-000040a0: 6146 7261 6d65 2e73 6574 5f69 6e64 6578  aFrame.set_index
-000040b0: 2069 7320 6120 676f 6f64 2065 7861 6d70   is a good examp
-000040c0: 6c65 2077 6865 7265 2074 6865 2063 616c  le where the cal
-000040d0: 6375 6c61 7469 6f6e 206e 6565 6473 2061  culation needs a
-000040e0: 6e0a 2020 2020 2020 2020 696e 7370 6563  n.        inspec
-000040f0: 7469 6f6e 206f 6620 7468 6520 6461 7461  tion of the data
-00004100: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00004110: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00004120: 662e 6578 7072 2e6b 6e6f 776e 5f64 6976  f.expr.known_div
-00004130: 6973 696f 6e73 0a0a 2020 2020 4070 726f  isions..    @pro
-00004140: 7065 7274 790a 2020 2020 6465 6620 696e  perty.    def in
-00004150: 6465 7828 7365 6c66 293a 0a20 2020 2020  dex(self):.     
-00004160: 2020 2022 2222 5265 7475 726e 2064 6173     """Return das
-00004170: 6b20 496e 6465 7820 696e 7374 616e 6365  k Index instance
-00004180: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
-00004190: 726e 206e 6577 5f63 6f6c 6c65 6374 696f  rn new_collectio
-000041a0: 6e28 7365 6c66 2e65 7870 722e 696e 6465  n(self.expr.inde
-000041b0: 7829 0a0a 2020 2020 4069 6e64 6578 2e73  x)..    @index.s
-000041c0: 6574 7465 720a 2020 2020 6465 6620 696e  etter.    def in
-000041d0: 6465 7828 7365 6c66 2c20 7661 6c75 6529  dex(self, value)
-000041e0: 3a0a 2020 2020 2020 2020 6173 7365 7274  :.        assert
-000041f0: 2065 7870 722e 6172 655f 636f 5f61 6c69   expr.are_co_ali
-00004200: 676e 6564 280a 2020 2020 2020 2020 2020  gned(.          
-00004210: 2020 7365 6c66 2e65 7870 722c 2076 616c    self.expr, val
-00004220: 7565 2e65 7870 720a 2020 2020 2020 2020  ue.expr.        
-00004230: 292c 2022 7661 6c75 6520 6e65 6564 7320  ), "value needs 
-00004240: 746f 2062 6520 616c 6967 6e65 6420 7769  to be aligned wi
-00004250: 7468 2074 6865 2069 6e64 6578 220a 2020  th the index".  
-00004260: 2020 2020 2020 5f65 7870 7220 3d20 6578        _expr = ex
-00004270: 7072 2e41 7373 6967 6e49 6e64 6578 2873  pr.AssignIndex(s
-00004280: 656c 662c 2076 616c 7565 290a 2020 2020  elf, value).    
-00004290: 2020 2020 7365 6c66 2e5f 6578 7072 203d      self._expr =
-000042a0: 205f 6578 7072 0a0a 2020 2020 6465 6620   _expr..    def 
-000042b0: 7265 7365 745f 696e 6465 7828 7365 6c66  reset_index(self
-000042c0: 2c20 6472 6f70 3a20 626f 6f6c 203d 2046  , drop: bool = F
-000042d0: 616c 7365 293a 0a20 2020 2020 2020 2022  alse):.        "
-000042e0: 2222 5265 7365 7420 7468 6520 696e 6465  ""Reset the inde
-000042f0: 7820 746f 2074 6865 2064 6566 6175 6c74  x to the default
-00004300: 2069 6e64 6578 2e0a 0a20 2020 2020 2020   index...       
-00004310: 204e 6f74 6520 7468 6174 2075 6e6c 696b   Note that unlik
-00004320: 6520 696e 2060 6070 616e 6461 7360 602c  e in ``pandas``,
-00004330: 2074 6865 2072 6573 6574 2069 6e64 6578   the reset index
-00004340: 2066 6f72 2061 2044 6173 6b20 4461 7461   for a Dask Data
-00004350: 4672 616d 6520 7769 6c6c 0a20 2020 2020  Frame will.     
-00004360: 2020 206e 6f74 2062 6520 6d6f 6e6f 746f     not be monoto
-00004370: 6e69 6361 6c6c 7920 696e 6372 6561 7369  nically increasi
-00004380: 6e67 2066 726f 6d20 302e 2049 6e73 7465  ng from 0. Inste
-00004390: 6164 2c20 6974 2077 696c 6c20 7265 7374  ad, it will rest
-000043a0: 6172 7420 6174 2030 0a20 2020 2020 2020  art at 0.       
-000043b0: 2066 6f72 2065 6163 6820 7061 7274 6974   for each partit
-000043c0: 696f 6e20 2865 2e67 2e20 6060 696e 6465  ion (e.g. ``inde
-000043d0: 7831 203d 205b 302c 202e 2e2e 2c20 3130  x1 = [0, ..., 10
-000043e0: 5d2c 2069 6e64 6578 3220 3d20 5b30 2c20  ], index2 = [0, 
-000043f0: 2e2e 2e5d 6060 292e 0a20 2020 2020 2020  ...]``)..       
-00004400: 2054 6869 7320 6973 2064 7565 2074 6f20   This is due to 
-00004410: 7468 6520 696e 6162 696c 6974 7920 746f  the inability to
-00004420: 2073 7461 7469 6361 6c6c 7920 6b6e 6f77   statically know
-00004430: 2074 6865 2066 756c 6c20 6c65 6e67 7468   the full length
-00004440: 206f 6620 7468 650a 2020 2020 2020 2020   of the.        
-00004450: 696e 6465 782e 0a0a 2020 2020 2020 2020  index...        
-00004460: 466f 7220 4461 7461 4672 616d 6520 7769  For DataFrame wi
-00004470: 7468 206d 756c 7469 2d6c 6576 656c 2069  th multi-level i
-00004480: 6e64 6578 2c20 7265 7475 726e 7320 6120  ndex, returns a 
-00004490: 6e65 7720 4461 7461 4672 616d 6520 7769  new DataFrame wi
-000044a0: 7468 0a20 2020 2020 2020 206c 6162 656c  th.        label
-000044b0: 696e 6720 696e 666f 726d 6174 696f 6e20  ing information 
-000044c0: 696e 2074 6865 2063 6f6c 756d 6e73 2075  in the columns u
-000044d0: 6e64 6572 2074 6865 2069 6e64 6578 206e  nder the index n
-000044e0: 616d 6573 2c20 6465 6661 756c 7469 6e67  ames, defaulting
-000044f0: 0a20 2020 2020 2020 2074 6f20 276c 6576  .        to 'lev
-00004500: 656c 5f30 272c 2027 6c65 7665 6c5f 3127  el_0', 'level_1'
-00004510: 2c20 6574 632e 2069 6620 616e 7920 6172  , etc. if any ar
-00004520: 6520 4e6f 6e65 2e20 466f 7220 6120 7374  e None. For a st
-00004530: 616e 6461 7264 2069 6e64 6578 2c0a 2020  andard index,.  
-00004540: 2020 2020 2020 7468 6520 696e 6465 7820        the index 
-00004550: 6e61 6d65 2077 696c 6c20 6265 2075 7365  name will be use
-00004560: 6420 2869 6620 7365 7429 2c20 6f74 6865  d (if set), othe
-00004570: 7277 6973 6520 6120 6465 6661 756c 7420  rwise a default 
-00004580: 2769 6e64 6578 2720 6f72 0a20 2020 2020  'index' or.     
-00004590: 2020 2027 6c65 7665 6c5f 3027 2028 6966     'level_0' (if
-000045a0: 2027 696e 6465 7827 2069 7320 616c 7265   'index' is alre
-000045b0: 6164 7920 7461 6b65 6e29 2077 696c 6c20  ady taken) will 
-000045c0: 6265 2075 7365 642e 0a0a 2020 2020 2020  be used...      
-000045d0: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
-000045e0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
-000045f0: 2020 2020 2020 2020 6472 6f70 203a 2062          drop : b
-00004600: 6f6f 6c65 616e 2c20 6465 6661 756c 7420  oolean, default 
-00004610: 4661 6c73 650a 2020 2020 2020 2020 2020  False.          
-00004620: 2020 446f 206e 6f74 2074 7279 2074 6f20    Do not try to 
-00004630: 696e 7365 7274 2069 6e64 6578 2069 6e74  insert index int
-00004640: 6f20 6461 7461 6672 616d 6520 636f 6c75  o dataframe colu
-00004650: 6d6e 732e 0a20 2020 2020 2020 2022 2222  mns..        """
-00004660: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00004670: 6e65 775f 636f 6c6c 6563 7469 6f6e 2865  new_collection(e
-00004680: 7870 722e 5265 7365 7449 6e64 6578 2873  xpr.ResetIndex(s
-00004690: 656c 662c 2064 726f 7029 290a 0a20 2020  elf, drop))..   
-000046a0: 2064 6566 2068 6561 6428 7365 6c66 2c20   def head(self, 
-000046b0: 6e3a 2069 6e74 203d 2035 2c20 6e70 6172  n: int = 5, npar
-000046c0: 7469 7469 6f6e 733d 312c 2063 6f6d 7075  titions=1, compu
-000046d0: 7465 3a20 626f 6f6c 203d 2054 7275 6529  te: bool = True)
-000046e0: 3a0a 2020 2020 2020 2020 2222 2246 6972  :.        """Fir
-000046f0: 7374 206e 2072 6f77 7320 6f66 2074 6865  st n rows of the
-00004700: 2064 6174 6173 6574 0a0a 2020 2020 2020   dataset..      
-00004710: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
-00004720: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
-00004730: 2020 2020 2020 2020 6e20 3a20 696e 742c          n : int,
-00004740: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-00004750: 2020 2020 2020 5468 6520 6e75 6d62 6572        The number
-00004760: 206f 6620 726f 7773 2074 6f20 7265 7475   of rows to retu
-00004770: 726e 2e20 4465 6661 756c 7420 6973 2035  rn. Default is 5
-00004780: 2e0a 2020 2020 2020 2020 6e70 6172 7469  ..        nparti
-00004790: 7469 6f6e 7320 3a20 696e 742c 206f 7074  tions : int, opt
-000047a0: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
-000047b0: 2020 456c 656d 656e 7473 2061 7265 206f    Elements are o
-000047c0: 6e6c 7920 7461 6b65 6e20 6672 6f6d 2074  nly taken from t
-000047d0: 6865 2066 6972 7374 2060 606e 7061 7274  he first ``npart
-000047e0: 6974 696f 6e73 6060 2c20 7769 7468 2061  itions``, with a
-000047f0: 0a20 2020 2020 2020 2020 2020 2064 6566  .            def
-00004800: 6175 6c74 206f 6620 312e 2049 6620 7468  ault of 1. If th
-00004810: 6572 6520 6172 6520 6665 7765 7220 7468  ere are fewer th
-00004820: 616e 2060 606e 6060 2072 6f77 7320 696e  an ``n`` rows in
-00004830: 2074 6865 2066 6972 7374 0a20 2020 2020   the first.     
-00004840: 2020 2020 2020 2060 606e 7061 7274 6974         ``npartit
-00004850: 696f 6e73 6060 2061 2077 6172 6e69 6e67  ions`` a warning
-00004860: 2077 696c 6c20 6265 2072 6169 7365 6420   will be raised 
-00004870: 616e 6420 616e 7920 666f 756e 6420 726f  and any found ro
-00004880: 7773 0a20 2020 2020 2020 2020 2020 2072  ws.            r
-00004890: 6574 7572 6e65 642e 2050 6173 7320 2d31  eturned. Pass -1
-000048a0: 2074 6f20 7573 6520 616c 6c20 7061 7274   to use all part
-000048b0: 6974 696f 6e73 2e0a 2020 2020 2020 2020  itions..        
-000048c0: 636f 6d70 7574 6520 3a20 626f 6f6c 2c20  compute : bool, 
-000048d0: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
-000048e0: 2020 2020 2057 6865 7468 6572 2074 6f20       Whether to 
-000048f0: 636f 6d70 7574 6520 7468 6520 7265 7375  compute the resu
-00004900: 6c74 2c20 6465 6661 756c 7420 6973 2054  lt, default is T
-00004910: 7275 652e 0a20 2020 2020 2020 2022 2222  rue..        """
-00004920: 0a20 2020 2020 2020 206f 7574 203d 206e  .        out = n
-00004930: 6577 5f63 6f6c 6c65 6374 696f 6e28 6578  ew_collection(ex
-00004940: 7072 2e48 6561 6428 7365 6c66 2c20 6e3d  pr.Head(self, n=
-00004950: 6e2c 206e 7061 7274 6974 696f 6e73 3d6e  n, npartitions=n
-00004960: 7061 7274 6974 696f 6e73 2929 0a20 2020  partitions)).   
-00004970: 2020 2020 2069 6620 636f 6d70 7574 653a       if compute:
-00004980: 0a20 2020 2020 2020 2020 2020 206f 7574  .            out
-00004990: 203d 206f 7574 2e63 6f6d 7075 7465 2829   = out.compute()
-000049a0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000049b0: 6f75 740a 0a20 2020 2064 6566 2074 6169  out..    def tai
-000049c0: 6c28 7365 6c66 2c20 6e3a 2069 6e74 203d  l(self, n: int =
-000049d0: 2035 2c20 636f 6d70 7574 653a 2062 6f6f   5, compute: boo
-000049e0: 6c20 3d20 5472 7565 293a 0a20 2020 2020  l = True):.     
-000049f0: 2020 2022 2222 4c61 7374 206e 2072 6f77     """Last n row
-00004a00: 7320 6f66 2074 6865 2064 6174 6173 6574  s of the dataset
-00004a10: 0a0a 2020 2020 2020 2020 4361 7665 6174  ..        Caveat
-00004a20: 2c20 7468 6520 6f6e 6c79 2063 6865 636b  , the only check
-00004a30: 7320 7468 6520 6c61 7374 206e 2072 6f77  s the last n row
-00004a40: 7320 6f66 2074 6865 206c 6173 7420 7061  s of the last pa
-00004a50: 7274 6974 696f 6e2e 0a20 2020 2020 2020  rtition..       
-00004a60: 2022 2222 0a20 2020 2020 2020 206f 7574   """.        out
-00004a70: 203d 206e 6577 5f63 6f6c 6c65 6374 696f   = new_collectio
-00004a80: 6e28 6578 7072 2e54 6169 6c28 7365 6c66  n(expr.Tail(self
-00004a90: 2c20 6e3d 6e29 290a 2020 2020 2020 2020  , n=n)).        
-00004aa0: 6966 2063 6f6d 7075 7465 3a0a 2020 2020  if compute:.    
-00004ab0: 2020 2020 2020 2020 6f75 7420 3d20 6f75          out = ou
-00004ac0: 742e 636f 6d70 7574 6528 290a 2020 2020  t.compute().    
-00004ad0: 2020 2020 7265 7475 726e 206f 7574 0a0a      return out..
-00004ae0: 2020 2020 6465 6620 636f 7079 2873 656c      def copy(sel
-00004af0: 662c 2064 6565 703a 2062 6f6f 6c20 3d20  f, deep: bool = 
-00004b00: 4661 6c73 6529 3a0a 2020 2020 2020 2020  False):.        
-00004b10: 2222 224d 616b 6520 6120 636f 7079 206f  """Make a copy o
-00004b20: 6620 7468 6520 6461 7461 6672 616d 650a  f the dataframe.
-00004b30: 0a20 2020 2020 2020 2054 6869 7320 6973  .        This is
-00004b40: 2073 7472 6963 746c 7920 6120 7368 616c   strictly a shal
-00004b50: 6c6f 7720 636f 7079 206f 6620 7468 6520  low copy of the 
-00004b60: 756e 6465 726c 7969 6e67 2063 6f6d 7075  underlying compu
-00004b70: 7461 7469 6f6e 616c 2067 7261 7068 2e0a  tational graph..
-00004b80: 2020 2020 2020 2020 4974 2064 6f65 7320          It does 
-00004b90: 6e6f 7420 6166 6665 6374 2074 6865 2075  not affect the u
-00004ba0: 6e64 6572 6c79 696e 6720 6461 7461 0a0a  nderlying data..
-00004bb0: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
-00004bc0: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
-00004bd0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6465  -----.        de
-00004be0: 6570 203a 2062 6f6f 6c65 616e 2c20 6465  ep : boolean, de
-00004bf0: 6661 756c 7420 4661 6c73 650a 2020 2020  fault False.    
-00004c00: 2020 2020 2020 2020 5468 6520 6465 6570          The deep
-00004c10: 2076 616c 7565 206d 7573 7420 6265 2060   value must be `
-00004c20: 4661 6c73 6560 2061 6e64 2069 7420 6973  False` and it is
-00004c30: 2064 6563 6c61 7265 6420 6173 2061 2070   declared as a p
-00004c40: 6172 616d 6574 6572 206a 7573 7420 666f  arameter just fo
-00004c50: 720a 2020 2020 2020 2020 2020 2020 636f  r.            co
-00004c60: 6d70 6174 6962 696c 6974 7920 7769 7468  mpatibility with
-00004c70: 2074 6869 7264 2d70 6172 7479 206c 6962   third-party lib
-00004c80: 7261 7269 6573 206c 696b 6520 6375 4446  raries like cuDF
-00004c90: 2061 6e64 2070 616e 6461 730a 2020 2020   and pandas.    
-00004ca0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00004cb0: 6966 2064 6565 7020 6973 206e 6f74 2046  if deep is not F
-00004cc0: 616c 7365 3a0a 2020 2020 2020 2020 2020  alse:.          
-00004cd0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-00004ce0: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-00004cf0: 2020 2020 2254 6865 2060 6465 6570 6020      "The `deep` 
-00004d00: 7661 6c75 6520 6d75 7374 2062 6520 4661  value must be Fa
-00004d10: 6c73 652e 2054 6869 7320 6973 2073 7472  lse. This is str
-00004d20: 6963 746c 7920 6120 7368 616c 6c6f 7720  ictly a shallow 
-00004d30: 636f 7079 2022 0a20 2020 2020 2020 2020  copy ".         
-00004d40: 2020 2020 2020 2022 6f66 2074 6865 2075         "of the u
-00004d50: 6e64 6572 6c79 696e 6720 636f 6d70 7574  nderlying comput
-00004d60: 6174 696f 6e61 6c20 6772 6170 682e 220a  ational graph.".
-00004d70: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00004d80: 2020 2020 2020 7265 7475 726e 206e 6577        return new
-00004d90: 5f63 6f6c 6c65 6374 696f 6e28 7365 6c66  _collection(self
-00004da0: 2e65 7870 7229 0a0a 2020 2020 4064 6572  .expr)..    @der
-00004db0: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
-00004dc0: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
-00004dd0: 6973 696e 2873 656c 662c 2076 616c 7565  isin(self, value
-00004de0: 7329 3a0a 2020 2020 2020 2020 6966 2069  s):.        if i
-00004df0: 7369 6e73 7461 6e63 6528 7365 6c66 2c20  sinstance(self, 
-00004e00: 4461 7461 4672 616d 6529 3a0a 2020 2020  DataFrame):.    
-00004e10: 2020 2020 2020 2020 2320 4461 7461 4672          # DataFr
-00004e20: 616d 652e 6973 696e 2064 6f65 7320 7765  ame.isin does we
-00004e30: 6972 6420 616c 6967 6e6d 656e 7420 7374  ird alignment st
-00004e40: 7566 660a 2020 2020 2020 2020 2020 2020  uff.            
-00004e50: 6261 645f 7479 7065 7320 3d20 2846 7261  bad_types = (Fra
-00004e60: 6d65 4261 7365 2c20 7064 2e53 6572 6965  meBase, pd.Serie
-00004e70: 732c 2070 642e 4461 7461 4672 616d 6529  s, pd.DataFrame)
-00004e80: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-00004e90: 2020 2020 2020 2020 2020 2062 6164 5f74             bad_t
-00004ea0: 7970 6573 203d 2028 4672 616d 6542 6173  ypes = (FrameBas
-00004eb0: 652c 290a 2020 2020 2020 2020 6966 2069  e,).        if i
-00004ec0: 7369 6e73 7461 6e63 6528 7661 6c75 6573  sinstance(values
-00004ed0: 2c20 6261 645f 7479 7065 7329 3a0a 2020  , bad_types):.  
-00004ee0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00004ef0: 4e6f 7449 6d70 6c65 6d65 6e74 6564 4572  NotImplementedEr
-00004f00: 726f 7228 2250 6173 7369 6e67 2061 2025  ror("Passing a %
-00004f10: 7220 746f 2060 6973 696e 6022 2025 2074  r to `isin`" % t
-00004f20: 7970 656e 616d 6528 7479 7065 2876 616c  ypename(type(val
-00004f30: 7565 7329 2929 0a0a 2020 2020 2020 2020  ues)))..        
-00004f40: 2320 5765 2077 7261 7020 7661 6c75 6573  # We wrap values
-00004f50: 2069 6e20 6120 6465 6c61 7965 6420 666f   in a delayed fo
-00004f60: 7220 7477 6f20 7265 6173 6f6e 733a 0a20  r two reasons:. 
-00004f70: 2020 2020 2020 2023 202d 2061 766f 6964         # - avoid
-00004f80: 2073 6572 6961 6c69 7a69 6e67 2064 6174   serializing dat
-00004f90: 6120 696e 2065 7665 7279 2074 6173 6b0a  a in every task.
-00004fa0: 2020 2020 2020 2020 2320 2d20 6176 6f69          # - avoi
-00004fb0: 6420 636f 7374 206f 6620 7472 6176 6572  d cost of traver
-00004fc0: 7361 6c20 6f66 206c 6172 6765 206c 6973  sal of large lis
-00004fd0: 7420 696e 206f 7074 696d 697a 6174 696f  t in optimizatio
-00004fe0: 6e73 0a20 2020 2020 2020 2069 6620 6973  ns.        if is
-00004ff0: 696e 7374 616e 6365 2876 616c 7565 732c  instance(values,
-00005000: 206c 6973 7429 3a0a 2020 2020 2020 2020   list):.        
-00005010: 2020 2020 2320 4d6f 7469 7661 7465 6420      # Motivated 
-00005020: 6279 2068 7474 7073 3a2f 2f67 6974 6875  by https://githu
-00005030: 622e 636f 6d2f 6461 736b 2f64 6173 6b2f  b.com/dask/dask/
-00005040: 6973 7375 6573 2f39 3431 312e 2020 5468  issues/9411.  Th
-00005050: 6973 2061 7070 6561 7273 2074 6f20 6265  is appears to be
-00005060: 0a20 2020 2020 2020 2020 2020 2023 2063  .            # c
-00005070: 6175 7365 6420 6279 2068 7474 7073 3a2f  aused by https:/
-00005080: 2f67 6974 6875 622e 636f 6d2f 6461 736b  /github.com/dask
-00005090: 2f64 6973 7472 6962 7574 6564 2f69 7373  /distributed/iss
-000050a0: 7565 732f 3633 3638 2c20 616e 6420 6675  ues/6368, and fu
-000050b0: 7274 6865 720a 2020 2020 2020 2020 2020  rther.          
-000050c0: 2020 2320 6578 6163 6572 6261 7465 6420    # exacerbated 
-000050d0: 6279 2074 6865 2066 6163 7420 7468 6174  by the fact that
-000050e0: 2074 6865 206c 6973 7420 636f 6e74 6169   the list contai
-000050f0: 6e73 2064 7570 6c69 6361 7465 732e 2020  ns duplicates.  
-00005100: 5468 6973 2069 7320 6120 7061 7463 6820  This is a patch 
-00005110: 756e 7469 6c0a 2020 2020 2020 2020 2020  until.          
-00005120: 2020 2320 7765 2063 616e 2063 7265 6174    # we can creat
-00005130: 6520 6120 6265 7474 6572 2066 6978 2066  e a better fix f
-00005140: 6f72 2053 6572 6961 6c69 7a61 7469 6f6e  or Serialization
-00005150: 2e0a 2020 2020 2020 2020 2020 2020 7472  ..            tr
-00005160: 793a 0a20 2020 2020 2020 2020 2020 2020  y:.             
-00005170: 2020 2076 616c 7565 7320 3d20 6c69 7374     values = list
-00005180: 2873 6574 2876 616c 7565 7329 290a 2020  (set(values)).  
-00005190: 2020 2020 2020 2020 2020 6578 6365 7074            except
-000051a0: 2054 7970 6545 7272 6f72 3a0a 2020 2020   TypeError:.    
-000051b0: 2020 2020 2020 2020 2020 2020 7061 7373              pass
-000051c0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000051d0: 6e6f 7420 616e 7928 6973 5f64 6173 6b5f  not any(is_dask_
-000051e0: 636f 6c6c 6563 7469 6f6e 2876 2920 666f  collection(v) fo
-000051f0: 7220 7620 696e 2076 616c 7565 7329 3a0a  r v in values):.
-00005200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005210: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
-00005220: 2020 2020 2020 2020 2076 616c 7565 7320           values 
-00005230: 3d20 6e70 2e66 726f 6d69 7465 7228 7661  = np.fromiter(va
-00005240: 6c75 6573 2c20 6474 7970 653d 6f62 6a65  lues, dtype=obje
-00005250: 6374 290a 2020 2020 2020 2020 2020 2020  ct).            
-00005260: 2020 2020 6578 6365 7074 2056 616c 7565      except Value
-00005270: 4572 726f 723a 0a20 2020 2020 2020 2020  Error:.         
-00005280: 2020 2020 2020 2020 2020 2023 204e 756d             # Num
-00005290: 7079 2031 2e32 3320 7375 7070 6f72 7473  py 1.23 supports
-000052a0: 2063 7265 6174 696e 6720 6172 7261 7973   creating arrays
-000052b0: 206f 6620 6974 6572 6162 6c65 732c 2077   of iterables, w
-000052c0: 6869 6c65 206c 6f77 6572 0a20 2020 2020  hile lower.     
-000052d0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-000052e0: 2076 6572 7369 6f6e 2031 2e32 312e 7820   version 1.21.x 
-000052f0: 616e 6420 312e 3232 2e78 2064 6f20 6e6f  and 1.22.x do no
-00005300: 740a 2020 2020 2020 2020 2020 2020 2020  t.              
-00005310: 2020 2020 2020 7061 7373 0a20 2020 2020        pass.     
-00005320: 2020 2066 726f 6d20 6461 736b 5f65 7870     from dask_exp
-00005330: 722e 696f 2e5f 6465 6c61 7965 6420 696d  r.io._delayed im
-00005340: 706f 7274 205f 4465 6c61 7965 6445 7870  port _DelayedExp
-00005350: 720a 0a20 2020 2020 2020 2072 6574 7572  r..        retur
-00005360: 6e20 6e65 775f 636f 6c6c 6563 7469 6f6e  n new_collection
-00005370: 280a 2020 2020 2020 2020 2020 2020 6578  (.            ex
-00005380: 7072 2e49 7369 6e28 0a20 2020 2020 2020  pr.Isin(.       
-00005390: 2020 2020 2020 2020 2073 656c 662c 0a20           self,. 
-000053a0: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-000053b0: 616c 7565 733d 5f44 656c 6179 6564 4578  alues=_DelayedEx
-000053c0: 7072 280a 2020 2020 2020 2020 2020 2020  pr(.            
-000053d0: 2020 2020 2020 2020 6465 6c61 7965 6428          delayed(
-000053e0: 7661 6c75 6573 2c20 6e61 6d65 3d22 6465  values, name="de
-000053f0: 6c61 7965 642d 2220 2b20 5f74 6f6b 656e  layed-" + _token
-00005400: 697a 655f 6465 7465 726d 696e 6973 7469  ize_deterministi
-00005410: 6328 7661 6c75 6573 2929 0a20 2020 2020  c(values)).     
-00005420: 2020 2020 2020 2020 2020 2029 2c0a 2020             ),.  
-00005430: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00005440: 2020 2020 290a 0a20 2020 2064 6566 205f      )..    def _
-00005450: 7061 7274 6974 696f 6e73 2873 656c 662c  partitions(self,
-00005460: 2069 6e64 6578 293a 0a20 2020 2020 2020   index):.       
-00005470: 2023 2055 7365 6420 6279 2060 7061 7274   # Used by `part
-00005480: 6974 696f 6e73 6020 666f 7220 7061 7274  itions` for part
-00005490: 6974 696f 6e2d 7769 7365 2073 6c69 6369  ition-wise slici
-000054a0: 6e67 0a0a 2020 2020 2020 2020 2320 436f  ng..        # Co
-000054b0: 6e76 6572 7420 696e 6465 7820 746f 206c  nvert index to l
-000054c0: 6973 740a 2020 2020 2020 2020 6966 2069  ist.        if i
-000054d0: 7369 6e73 7461 6e63 6528 696e 6465 782c  sinstance(index,
-000054e0: 2069 6e74 293a 0a20 2020 2020 2020 2020   int):.         
-000054f0: 2020 2069 6e64 6578 203d 205b 696e 6465     index = [inde
-00005500: 785d 0a20 2020 2020 2020 2069 6e64 6578  x].        index
-00005510: 203d 206e 702e 6172 616e 6765 2873 656c   = np.arange(sel
-00005520: 662e 6e70 6172 7469 7469 6f6e 732c 2064  f.npartitions, d
-00005530: 7479 7065 3d6f 626a 6563 7429 5b69 6e64  type=object)[ind
-00005540: 6578 5d2e 746f 6c69 7374 2829 0a0a 2020  ex].tolist()..  
-00005550: 2020 2020 2020 2320 4368 6563 6b20 7468        # Check th
-00005560: 6174 2073 656c 6563 7469 6f6e 206d 616b  at selection mak
-00005570: 6573 2073 656e 7365 0a20 2020 2020 2020  es sense.       
-00005580: 2061 7373 6572 7420 7365 7428 696e 6465   assert set(inde
-00005590: 7829 2e69 7373 7562 7365 7428 7261 6e67  x).issubset(rang
-000055a0: 6528 7365 6c66 2e6e 7061 7274 6974 696f  e(self.npartitio
-000055b0: 6e73 2929 0a0a 2020 2020 2020 2020 2320  ns))..        # 
-000055c0: 5265 7475 726e 2073 656c 6563 7465 6420  Return selected 
-000055d0: 7061 7274 6974 696f 6e73 0a20 2020 2020  partitions.     
-000055e0: 2020 2072 6574 7572 6e20 6e65 775f 636f     return new_co
-000055f0: 6c6c 6563 7469 6f6e 2865 7870 722e 5061  llection(expr.Pa
-00005600: 7274 6974 696f 6e73 2873 656c 662c 2069  rtitions(self, i
-00005610: 6e64 6578 2929 0a0a 2020 2020 4070 726f  ndex))..    @pro
-00005620: 7065 7274 790a 2020 2020 6465 6620 7061  perty.    def pa
-00005630: 7274 6974 696f 6e73 2873 656c 6629 3a0a  rtitions(self):.
-00005640: 2020 2020 2020 2020 2222 2253 6c69 6365          """Slice
-00005650: 2064 6174 6166 7261 6d65 2062 7920 7061   dataframe by pa
-00005660: 7274 6974 696f 6e73 0a0a 2020 2020 2020  rtitions..      
-00005670: 2020 5468 6973 2061 6c6c 6f77 7320 7061    This allows pa
-00005680: 7274 6974 696f 6e77 6973 6520 736c 6963  rtitionwise slic
-00005690: 696e 6720 6f66 2061 2044 6173 6b20 4461  ing of a Dask Da
-000056a0: 7461 6672 616d 652e 2020 596f 7520 6361  taframe.  You ca
-000056b0: 6e20 7065 7266 6f72 6d20 6e6f 726d 616c  n perform normal
-000056c0: 0a20 2020 2020 2020 204e 756d 7079 2d73  .        Numpy-s
-000056d0: 7479 6c65 2073 6c69 6369 6e67 2c20 6275  tyle slicing, bu
-000056e0: 7420 6e6f 7720 7261 7468 6572 2074 6861  t now rather tha
-000056f0: 6e20 736c 6963 6520 656c 656d 656e 7473  n slice elements
-00005700: 206f 6620 7468 6520 6172 7261 7920 796f   of the array yo
-00005710: 750a 2020 2020 2020 2020 736c 6963 6520  u.        slice 
-00005720: 616c 6f6e 6720 7061 7274 6974 696f 6e73  along partitions
-00005730: 2073 6f2c 2066 6f72 2065 7861 6d70 6c65   so, for example
-00005740: 2c20 6060 6466 2e70 6172 7469 7469 6f6e  , ``df.partition
-00005750: 735b 3a35 5d60 6020 7072 6f64 7563 6573  s[:5]`` produces
-00005760: 2061 206e 6577 0a20 2020 2020 2020 2044   a new.        D
-00005770: 6173 6b20 4461 7461 6672 616d 6520 6f66  ask Dataframe of
-00005780: 2074 6865 2066 6972 7374 2066 6976 6520   the first five 
-00005790: 7061 7274 6974 696f 6e73 2e20 5661 6c69  partitions. Vali
-000057a0: 6420 696e 6465 7865 7273 2061 7265 2069  d indexers are i
-000057b0: 6e74 6567 6572 732c 2073 6571 7565 6e63  ntegers, sequenc
-000057c0: 6573 0a20 2020 2020 2020 206f 6620 696e  es.        of in
-000057d0: 7465 6765 7273 2c20 736c 6963 6573 2c20  tegers, slices, 
-000057e0: 6f72 2062 6f6f 6c65 616e 206d 6173 6b73  or boolean masks
-000057f0: 2e0a 0a20 2020 2020 2020 2045 7861 6d70  ...        Examp
-00005800: 6c65 730a 2020 2020 2020 2020 2d2d 2d2d  les.        ----
-00005810: 2d2d 2d2d 0a20 2020 2020 2020 203e 3e3e  ----.        >>>
-00005820: 2064 662e 7061 7274 6974 696f 6e73 5b30   df.partitions[0
-00005830: 5d20 2023 2064 6f63 7465 7374 3a20 2b53  ]  # doctest: +S
-00005840: 4b49 500a 2020 2020 2020 2020 3e3e 3e20  KIP.        >>> 
-00005850: 6466 2e70 6172 7469 7469 6f6e 735b 3a33  df.partitions[:3
-00005860: 5d20 2023 2064 6f63 7465 7374 3a20 2b53  ]  # doctest: +S
-00005870: 4b49 500a 2020 2020 2020 2020 3e3e 3e20  KIP.        >>> 
-00005880: 6466 2e70 6172 7469 7469 6f6e 735b 3a3a  df.partitions[::
-00005890: 3130 5d20 2023 2064 6f63 7465 7374 3a20  10]  # doctest: 
-000058a0: 2b53 4b49 500a 0a20 2020 2020 2020 2052  +SKIP..        R
-000058b0: 6574 7572 6e73 0a20 2020 2020 2020 202d  eturns.        -
-000058c0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2041  ------.        A
-000058d0: 2044 6173 6b20 4461 7461 4672 616d 650a   Dask DataFrame.
-000058e0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-000058f0: 2020 2020 7265 7475 726e 2049 6e64 6578      return Index
-00005900: 4361 6c6c 6162 6c65 2873 656c 662e 5f70  Callable(self._p
-00005910: 6172 7469 7469 6f6e 7329 0a0a 2020 2020  artitions)..    
-00005920: 6465 6620 6765 745f 7061 7274 6974 696f  def get_partitio
-00005930: 6e28 7365 6c66 2c20 6e29 3a0a 2020 2020  n(self, n):.    
-00005940: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00005950: 4765 7420 6120 6461 736b 2044 6174 6146  Get a dask DataF
-00005960: 7261 6d65 2f53 6572 6965 7320 7265 7072  rame/Series repr
-00005970: 6573 656e 7469 6e67 2074 6865 2060 6e74  esenting the `nt
-00005980: 6860 2070 6172 7469 7469 6f6e 2e0a 0a20  h` partition... 
-00005990: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-000059a0: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
-000059b0: 2d2d 2d2d 0a20 2020 2020 2020 206e 203a  ----.        n :
-000059c0: 2069 6e74 0a20 2020 2020 2020 2020 2020   int.           
-000059d0: 2054 6865 2030 2d69 6e64 6578 6564 2070   The 0-indexed p
-000059e0: 6172 7469 7469 6f6e 206e 756d 6265 7220  artition number 
-000059f0: 746f 2073 656c 6563 742e 0a0a 2020 2020  to select...    
-00005a00: 2020 2020 5265 7475 726e 730a 2020 2020      Returns.    
-00005a10: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
-00005a20: 2020 2020 4461 736b 2044 6174 6146 7261      Dask DataFra
-00005a30: 6d65 206f 7220 5365 7269 6573 0a20 2020  me or Series.   
-00005a40: 2020 2020 2020 2020 2054 6865 2073 616d           The sam
-00005a50: 6520 7479 7065 2061 7320 7468 6520 6f72  e type as the or
-00005a60: 6967 696e 616c 206f 626a 6563 742e 0a0a  iginal object...
-00005a70: 2020 2020 2020 2020 5365 6520 416c 736f          See Also
-00005a80: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00005a90: 2d0a 2020 2020 2020 2020 4461 7461 4672  -.        DataFr
-00005aa0: 616d 652e 7061 7274 6974 696f 6e73 0a20  ame.partitions. 
-00005ab0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00005ac0: 2020 2069 6620 6e6f 7420 3020 3c3d 206e     if not 0 <= n
-00005ad0: 203c 2073 656c 662e 6e70 6172 7469 7469   < self.npartiti
-00005ae0: 6f6e 733a 0a20 2020 2020 2020 2020 2020  ons:.           
-00005af0: 206d 7367 203d 2066 226e 206d 7573 7420   msg = f"n must 
-00005b00: 6265 2030 203c 3d20 6e20 3c20 7b73 656c  be 0 <= n < {sel
-00005b10: 662e 6e70 6172 7469 7469 6f6e 737d 220a  f.npartitions}".
-00005b20: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00005b30: 6520 5661 6c75 6545 7272 6f72 286d 7367  e ValueError(msg
-00005b40: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-00005b50: 2073 656c 662e 7061 7274 6974 696f 6e73   self.partitions
-00005b60: 5b6e 5d0a 0a20 2020 2064 6566 2073 6875  [n]..    def shu
-00005b70: 6666 6c65 280a 2020 2020 2020 2020 7365  ffle(.        se
-00005b80: 6c66 2c0a 2020 2020 2020 2020 6f6e 3a20  lf,.        on: 
-00005b90: 7374 7220 7c20 6c69 7374 207c 206e 6f5f  str | list | no_
-00005ba0: 6465 6661 756c 7420 3d20 6e6f 5f64 6566  default = no_def
-00005bb0: 6175 6c74 2c0a 2020 2020 2020 2020 6967  ault,.        ig
-00005bc0: 6e6f 7265 5f69 6e64 6578 3a20 626f 6f6c  nore_index: bool
-00005bd0: 203d 2046 616c 7365 2c0a 2020 2020 2020   = False,.      
-00005be0: 2020 6e70 6172 7469 7469 6f6e 733a 2069    npartitions: i
-00005bf0: 6e74 207c 204e 6f6e 6520 3d20 4e6f 6e65  nt | None = None
-00005c00: 2c0a 2020 2020 2020 2020 7368 7566 666c  ,.        shuffl
-00005c10: 655f 6d65 7468 6f64 3a20 7374 7220 7c20  e_method: str | 
-00005c20: 4e6f 6e65 203d 204e 6f6e 652c 0a20 2020  None = None,.   
-00005c30: 2020 2020 206f 6e5f 696e 6465 783a 2062       on_index: b
-00005c40: 6f6f 6c20 3d20 4661 6c73 652c 0a20 2020  ool = False,.   
-00005c50: 2020 2020 202a 2a6f 7074 696f 6e73 2c0a       **options,.
-00005c60: 2020 2020 293a 0a20 2020 2020 2020 2022      ):.        "
-00005c70: 2222 5265 6172 7261 6e67 6520 4461 7461  ""Rearrange Data
-00005c80: 4672 616d 6520 696e 746f 206e 6577 2070  Frame into new p
-00005c90: 6172 7469 7469 6f6e 730a 0a20 2020 2020  artitions..     
-00005ca0: 2020 2055 7365 7320 6861 7368 696e 6720     Uses hashing 
-00005cb0: 6f66 2060 6f6e 6020 746f 206d 6170 2072  of `on` to map r
-00005cc0: 6f77 7320 746f 206f 7574 7075 7420 7061  ows to output pa
-00005cd0: 7274 6974 696f 6e73 2e20 4166 7465 7220  rtitions. After 
-00005ce0: 7468 6973 0a20 2020 2020 2020 206f 7065  this.        ope
-00005cf0: 7261 7469 6f6e 2c20 726f 7773 2077 6974  ration, rows wit
-00005d00: 6820 7468 6520 7361 6d65 2076 616c 7565  h the same value
-00005d10: 206f 6620 606f 6e60 2077 696c 6c20 6265   of `on` will be
-00005d20: 2069 6e20 7468 6520 7361 6d65 0a20 2020   in the same.   
-00005d30: 2020 2020 2070 6172 7469 7469 6f6e 2e0a       partition..
-00005d40: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-00005d50: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
-00005d60: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 206f  ------.        o
-00005d70: 6e20 3a20 7374 722c 206c 6973 7420 6f66  n : str, list of
-00005d80: 2073 7472 2c20 6f72 2053 6572 6965 732c   str, or Series,
-00005d90: 2049 6e64 6578 2c20 6f72 2044 6174 6146   Index, or DataF
-00005da0: 7261 6d65 0a20 2020 2020 2020 2020 2020  rame.           
-00005db0: 2043 6f6c 756d 6e20 6e61 6d65 7320 746f   Column names to
-00005dc0: 2073 6875 6666 6c65 2062 792e 0a20 2020   shuffle by..   
-00005dd0: 2020 2020 2069 676e 6f72 655f 696e 6465       ignore_inde
-00005de0: 7820 3a20 6f70 7469 6f6e 616c 0a20 2020  x : optional.   
-00005df0: 2020 2020 2020 2020 2057 6865 7468 6572           Whether
-00005e00: 2074 6f20 6967 6e6f 7265 2074 6865 2069   to ignore the i
-00005e10: 6e64 6578 2e20 4465 6661 756c 7420 6973  ndex. Default is
-00005e20: 2060 6046 616c 7365 6060 2e0a 2020 2020   ``False``..    
-00005e30: 2020 2020 6e70 6172 7469 7469 6f6e 7320      npartitions 
-00005e40: 3a20 6f70 7469 6f6e 616c 0a20 2020 2020  : optional.     
-00005e50: 2020 2020 2020 204e 756d 6265 7220 6f66         Number of
-00005e60: 206f 7574 7075 7420 7061 7274 6974 696f   output partitio
-00005e70: 6e73 2e20 5468 6520 7061 7274 6974 696f  ns. The partitio
-00005e80: 6e20 636f 756e 7420 7769 6c6c 0a20 2020  n count will.   
-00005e90: 2020 2020 2020 2020 2062 6520 7072 6573           be pres
-00005ea0: 6572 7665 6420 6279 2064 6566 6175 6c74  erved by default
-00005eb0: 2e0a 2020 2020 2020 2020 7368 7566 666c  ..        shuffl
-00005ec0: 655f 6d65 7468 6f64 203a 206f 7074 696f  e_method : optio
-00005ed0: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
-00005ee0: 4465 7369 7265 6420 7368 7566 666c 6520  Desired shuffle 
-00005ef0: 6d65 7468 6f64 2e20 4465 6661 756c 7420  method. Default 
-00005f00: 6368 6f73 656e 2061 7420 6f70 7469 6d69  chosen at optimi
-00005f10: 7a61 7469 6f6e 2074 696d 652e 0a20 2020  zation time..   
-00005f20: 2020 2020 206f 6e5f 696e 6465 7820 3a20       on_index : 
-00005f30: 626f 6f6c 2c20 6465 6661 756c 7420 4661  bool, default Fa
-00005f40: 6c73 650a 2020 2020 2020 2020 2020 2020  lse.            
-00005f50: 5768 6574 6865 7220 746f 2073 6875 6666  Whether to shuff
-00005f60: 6c65 206f 6e20 7468 6520 696e 6465 782e  le on the index.
-00005f70: 204d 7574 7561 6c6c 7920 6578 636c 7573   Mutually exclus
-00005f80: 6976 6520 7769 7468 2027 6f6e 272e 0a20  ive with 'on'.. 
-00005f90: 2020 2020 2020 2020 2020 2053 6574 2074             Set t
-00005fa0: 6869 7320 746f 2060 6054 7275 6560 6020  his to ``True`` 
-00005fb0: 6966 2027 6f6e 2720 6973 206e 6f74 2070  if 'on' is not p
-00005fc0: 726f 7669 6465 642e 0a20 2020 2020 2020  rovided..       
-00005fd0: 202a 2a6f 7074 696f 6e73 203a 206f 7074   **options : opt
-00005fe0: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
-00005ff0: 2020 416c 676f 7269 7468 6d2d 7370 6563    Algorithm-spec
-00006000: 6966 6963 206f 7074 696f 6e73 2e0a 0a20  ific options... 
-00006010: 2020 2020 2020 204e 6f74 6573 0a20 2020         Notes.   
-00006020: 2020 2020 202d 2d2d 2d2d 0a20 2020 2020       -----.     
-00006030: 2020 2054 6869 7320 646f 6573 206e 6f74     This does not
-00006040: 2070 7265 7365 7276 6520 6120 6d65 616e   preserve a mean
-00006050: 696e 6766 756c 2069 6e64 6578 2f70 6172  ingful index/par
-00006060: 7469 7469 6f6e 696e 6720 7363 6865 6d65  titioning scheme
-00006070: 2e20 5468 6973 0a20 2020 2020 2020 2069  . This.        i
-00006080: 7320 6e6f 7420 6465 7465 726d 696e 6973  s not determinis
-00006090: 7469 6320 6966 2064 6f6e 6520 696e 2070  tic if done in p
-000060a0: 6172 616c 6c65 6c2e 0a0a 2020 2020 2020  arallel...      
-000060b0: 2020 4578 616d 706c 6573 0a20 2020 2020    Examples.     
-000060c0: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
-000060d0: 2020 2020 3e3e 3e20 6466 203d 2064 662e      >>> df = df.
-000060e0: 7368 7566 666c 6528 6466 2e63 6f6c 756d  shuffle(df.colum
-000060f0: 6e73 5b30 5d29 2020 2320 646f 6374 6573  ns[0])  # doctes
-00006100: 743a 202b 534b 4950 0a20 2020 2020 2020  t: +SKIP.       
-00006110: 2022 2222 0a20 2020 2020 2020 2069 6620   """.        if 
-00006120: 6f6e 2069 7320 6e6f 5f64 6566 6175 6c74  on is no_default
-00006130: 2061 6e64 206e 6f74 206f 6e5f 696e 6465   and not on_inde
-00006140: 783a 0a20 2020 2020 2020 2020 2020 2072  x:.            r
-00006150: 6169 7365 2054 7970 6545 7272 6f72 280a  aise TypeError(.
-00006160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006170: 224d 7573 7420 7368 7566 666c 6520 6f6e  "Must shuffle on
-00006180: 2065 6974 6865 7220 636f 6c75 6d6e 7320   either columns 
-00006190: 6f72 2074 6865 2069 6e64 6578 3b20 6375  or the index; cu
-000061a0: 7272 656e 746c 7920 7368 7566 666c 696e  rrently shufflin
-000061b0: 6720 6f6e 2022 0a20 2020 2020 2020 2020  g on ".         
-000061c0: 2020 2020 2020 2022 6e65 6974 6865 722e         "neither.
-000061d0: 2050 6173 7320 636f 6c75 6d6e 2873 2920   Pass column(s) 
-000061e0: 746f 2027 6f6e 2720 6f72 2073 6574 2027  to 'on' or set '
-000061f0: 6f6e 5f69 6e64 6578 2720 746f 2054 7275  on_index' to Tru
-00006200: 652e 220a 2020 2020 2020 2020 2020 2020  e.".            
-00006210: 290a 2020 2020 2020 2020 656c 6966 206f  ).        elif o
-00006220: 6e20 6973 206e 6f74 206e 6f5f 6465 6661  n is not no_defa
-00006230: 756c 7420 616e 6420 6f6e 5f69 6e64 6578  ult and on_index
-00006240: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-00006250: 6973 6520 5479 7065 4572 726f 7228 0a20  ise TypeError(. 
-00006260: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00006270: 4361 6e6e 6f74 2073 6875 6666 6c65 206f  Cannot shuffle o
-00006280: 6e20 626f 7468 2063 6f6c 756d 6e73 2061  n both columns a
-00006290: 6e64 2074 6865 2069 6e64 6578 2e20 446f  nd the index. Do
-000062a0: 206e 6f74 2070 6173 7320 636f 6c75 6d6e   not pass column
-000062b0: 2873 2920 220a 2020 2020 2020 2020 2020  (s) ".          
-000062c0: 2020 2020 2020 2274 6f20 276f 6e27 206f        "to 'on' o
-000062d0: 7220 7365 7420 276f 6e5f 696e 6465 7827  r set 'on_index'
-000062e0: 2074 6f20 4661 6c73 652e 220a 2020 2020   to False.".    
-000062f0: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-00006300: 2020 2023 2050 7265 7365 7276 6520 7061     # Preserve pa
-00006310: 7274 6974 696f 6e20 636f 756e 7420 6279  rtition count by
-00006320: 2064 6566 6175 6c74 0a20 2020 2020 2020   default.       
-00006330: 206e 7061 7274 6974 696f 6e73 203d 206e   npartitions = n
-00006340: 7061 7274 6974 696f 6e73 206f 7220 7365  partitions or se
-00006350: 6c66 2e6e 7061 7274 6974 696f 6e73 0a0a  lf.npartitions..
-00006360: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-00006370: 7461 6e63 6528 6f6e 2c20 4672 616d 6542  tance(on, FrameB
-00006380: 6173 6529 3a0a 2020 2020 2020 2020 2020  ase):.          
-00006390: 2020 6966 206e 6f74 2065 7870 722e 6172    if not expr.ar
-000063a0: 655f 636f 5f61 6c69 676e 6564 2873 656c  e_co_aligned(sel
-000063b0: 662e 6578 7072 2c20 6f6e 2e65 7870 7229  f.expr, on.expr)
-000063c0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000063d0: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
-000063e0: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
-000063f0: 2020 2020 2020 2022 696e 6465 7820 6d75         "index mu
-00006400: 7374 2062 6520 616c 6967 6e65 6420 7769  st be aligned wi
-00006410: 7468 2074 6865 2044 6174 6146 7261 6d65  th the DataFrame
-00006420: 2074 6f20 7573 6520 6173 2073 6875 6666   to use as shuff
-00006430: 6c65 2069 6e64 6578 2e22 0a20 2020 2020  le index.".     
-00006440: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00006450: 2020 2020 2065 6c69 6620 7064 2e61 7069       elif pd.api
-00006460: 2e74 7970 6573 2e69 735f 6c69 7374 5f6c  .types.is_list_l
-00006470: 696b 6528 6f6e 2920 616e 6420 6e6f 7420  ike(on) and not 
-00006480: 6973 5f64 6173 6b5f 636f 6c6c 6563 7469  is_dask_collecti
-00006490: 6f6e 286f 6e29 3a0a 2020 2020 2020 2020  on(on):.        
-000064a0: 2020 2020 6f6e 203d 206c 6973 7428 6f6e      on = list(on
-000064b0: 290a 0a20 2020 2020 2020 2069 6620 2873  )..        if (s
-000064c0: 6875 6666 6c65 5f6d 6574 686f 6420 6f72  huffle_method or
-000064d0: 2067 6574 5f64 6566 6175 6c74 5f73 6875   get_default_shu
-000064e0: 6666 6c65 5f6d 6574 686f 6428 2929 203d  ffle_method()) =
-000064f0: 3d20 2270 3270 223a 0a20 2020 2020 2020  = "p2p":.       
-00006500: 2020 2020 2066 726f 6d20 6469 7374 7269       from distri
-00006510: 6275 7465 642e 7368 7566 666c 652e 5f61  buted.shuffle._a
-00006520: 7272 6f77 2069 6d70 6f72 7420 6368 6563  rrow import chec
-00006530: 6b5f 6474 7970 655f 7375 7070 6f72 740a  k_dtype_support.
-00006540: 0a20 2020 2020 2020 2020 2020 2063 6865  .            che
-00006550: 636b 5f64 7479 7065 5f73 7570 706f 7274  ck_dtype_support
-00006560: 2873 656c 662e 5f6d 6574 6129 0a0a 2020  (self._meta)..  
-00006570: 2020 2020 2020 2020 2020 6966 2061 6e79            if any
-00006580: 286e 6f74 2069 7369 6e73 7461 6e63 6528  (not isinstance(
-00006590: 632c 2073 7472 2920 666f 7220 6320 696e  c, str) for c in
-000065a0: 2073 656c 662e 5f6d 6574 612e 636f 6c75   self._meta.colu
-000065b0: 6d6e 7329 3a0a 2020 2020 2020 2020 2020  mns):.          
-000065c0: 2020 2020 2020 756e 7375 7070 6f72 7465        unsupporte
-000065d0: 6420 3d20 7b0a 2020 2020 2020 2020 2020  d = {.          
-000065e0: 2020 2020 2020 2020 2020 633a 2074 7970            c: typ
-000065f0: 6528 6329 2066 6f72 2063 2069 6e20 7365  e(c) for c in se
-00006600: 6c66 2e5f 6d65 7461 2e63 6f6c 756d 6e73  lf._meta.columns
-00006610: 2069 6620 6e6f 7420 6973 696e 7374 616e   if not isinstan
-00006620: 6365 2863 2c20 7374 7229 0a20 2020 2020  ce(c, str).     
-00006630: 2020 2020 2020 2020 2020 207d 0a20 2020             }.   
-00006640: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-00006650: 7365 2054 7970 6545 7272 6f72 280a 2020  se TypeError(.  
+00003da0: 2020 2020 7265 7475 726e 2066 756e 6374      return funct
+00003db0: 6f6f 6c73 2e70 6172 7469 616c 285f 7772  ools.partial(_wr
+00003dc0: 6170 5f65 7870 725f 6170 692c 2077 7261  ap_expr_api, wra
+00003dd0: 705f 6170 693d 7661 6c29 0a20 2020 2020  p_api=val).     
+00003de0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00003df0: 6e20 7661 6c0a 2020 2020 2020 2020 2020  n val.          
+00003e00: 2020 6578 6365 7074 2041 7474 7269 6275    except Attribu
+00003e10: 7465 4572 726f 723a 0a20 2020 2020 2020  teError:.       
+00003e20: 2020 2020 2020 2020 2023 2052 6169 7365           # Raise
+00003e30: 206f 7269 6769 6e61 6c20 6572 726f 720a   original error.
+00003e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003e50: 7261 6973 6520 6572 720a 0a20 2020 2064  raise err..    d
+00003e60: 6566 2076 6973 7561 6c69 7a65 2873 656c  ef visualize(sel
+00003e70: 662c 2074 6173 6b73 3a20 626f 6f6c 203d  f, tasks: bool =
+00003e80: 2046 616c 7365 2c20 2a2a 6b77 6172 6773   False, **kwargs
+00003e90: 293a 0a20 2020 2020 2020 2022 2222 5669  ):.        """Vi
+00003ea0: 7375 616c 697a 6520 7468 6520 6578 7072  sualize the expr
+00003eb0: 6573 7369 6f6e 206f 7220 7461 736b 2067  ession or task g
+00003ec0: 7261 7068 0a0a 2020 2020 2020 2020 5061  raph..        Pa
+00003ed0: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
+00003ee0: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
+00003ef0: 2020 2020 7461 736b 733a 0a20 2020 2020      tasks:.     
+00003f00: 2020 2020 2020 2057 6865 7468 6572 2074         Whether t
+00003f10: 6f20 7669 7375 616c 697a 6520 7468 6520  o visualize the 
+00003f20: 7461 736b 2067 7261 7068 2e20 4279 2064  task graph. By d
+00003f30: 6566 6175 6c74 0a20 2020 2020 2020 2020  efault.         
+00003f40: 2020 2074 6865 2065 7870 7265 7373 696f     the expressio
+00003f50: 6e20 6772 6170 6820 7769 6c6c 2062 6520  n graph will be 
+00003f60: 7669 7375 616c 697a 6564 2069 6e73 7465  visualized inste
+00003f70: 6164 2e0a 2020 2020 2020 2020 2222 220a  ad..        """.
+00003f80: 2020 2020 2020 2020 6966 2074 6173 6b73          if tasks
+00003f90: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+00003fa0: 7475 726e 2073 7570 6572 2829 2e76 6973  turn super().vis
+00003fb0: 7561 6c69 7a65 282a 2a6b 7761 7267 7329  ualize(**kwargs)
+00003fc0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00003fd0: 7365 6c66 2e65 7870 722e 7669 7375 616c  self.expr.visual
+00003fe0: 697a 6528 2a2a 6b77 6172 6773 290a 0a20  ize(**kwargs).. 
+00003ff0: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+00004000: 2064 6566 206b 6e6f 776e 5f64 6976 6973   def known_divis
+00004010: 696f 6e73 2873 656c 6629 3a0a 2020 2020  ions(self):.    
+00004020: 2020 2020 2222 2257 6865 7468 6572 2074      """Whether t
+00004030: 6865 2064 6976 6973 696f 6e73 2061 7265  he divisions are
+00004040: 206b 6e6f 776e 2e0a 0a20 2020 2020 2020   known...       
+00004050: 2054 6869 7320 6368 6563 6b20 6361 6e20   This check can 
+00004060: 6265 2065 7870 656e 7369 7665 2069 6620  be expensive if 
+00004070: 7468 6520 6469 7669 7369 6f6e 2063 616c  the division cal
+00004080: 6375 6c61 7469 6f6e 2069 7320 6578 7065  culation is expe
+00004090: 6e73 6976 652e 0a20 2020 2020 2020 2044  nsive..        D
+000040a0: 6174 6146 7261 6d65 2e73 6574 5f69 6e64  ataFrame.set_ind
+000040b0: 6578 2069 7320 6120 676f 6f64 2065 7861  ex is a good exa
+000040c0: 6d70 6c65 2077 6865 7265 2074 6865 2063  mple where the c
+000040d0: 616c 6375 6c61 7469 6f6e 206e 6565 6473  alculation needs
+000040e0: 2061 6e0a 2020 2020 2020 2020 696e 7370   an.        insp
+000040f0: 6563 7469 6f6e 206f 6620 7468 6520 6461  ection of the da
+00004100: 7461 2e0a 2020 2020 2020 2020 2222 220a  ta..        """.
+00004110: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00004120: 656c 662e 6578 7072 2e6b 6e6f 776e 5f64  elf.expr.known_d
+00004130: 6976 6973 696f 6e73 0a0a 2020 2020 4070  ivisions..    @p
+00004140: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+00004150: 696e 6465 7828 7365 6c66 293a 0a20 2020  index(self):.   
+00004160: 2020 2020 2022 2222 5265 7475 726e 2064       """Return d
+00004170: 6173 6b20 496e 6465 7820 696e 7374 616e  ask Index instan
+00004180: 6365 2222 220a 2020 2020 2020 2020 7265  ce""".        re
+00004190: 7475 726e 206e 6577 5f63 6f6c 6c65 6374  turn new_collect
+000041a0: 696f 6e28 7365 6c66 2e65 7870 722e 696e  ion(self.expr.in
+000041b0: 6465 7829 0a0a 2020 2020 4069 6e64 6578  dex)..    @index
+000041c0: 2e73 6574 7465 720a 2020 2020 6465 6620  .setter.    def 
+000041d0: 696e 6465 7828 7365 6c66 2c20 7661 6c75  index(self, valu
+000041e0: 6529 3a0a 2020 2020 2020 2020 6173 7365  e):.        asse
+000041f0: 7274 2065 7870 722e 6172 655f 636f 5f61  rt expr.are_co_a
+00004200: 6c69 676e 6564 280a 2020 2020 2020 2020  ligned(.        
+00004210: 2020 2020 7365 6c66 2e65 7870 722c 2076      self.expr, v
+00004220: 616c 7565 2e65 7870 720a 2020 2020 2020  alue.expr.      
+00004230: 2020 292c 2022 7661 6c75 6520 6e65 6564    ), "value need
+00004240: 7320 746f 2062 6520 616c 6967 6e65 6420  s to be aligned 
+00004250: 7769 7468 2074 6865 2069 6e64 6578 220a  with the index".
+00004260: 2020 2020 2020 2020 5f65 7870 7220 3d20          _expr = 
+00004270: 6578 7072 2e41 7373 6967 6e49 6e64 6578  expr.AssignIndex
+00004280: 2873 656c 662c 2076 616c 7565 290a 2020  (self, value).  
+00004290: 2020 2020 2020 7365 6c66 2e5f 6578 7072        self._expr
+000042a0: 203d 205f 6578 7072 0a0a 2020 2020 6465   = _expr..    de
+000042b0: 6620 7265 7365 745f 696e 6465 7828 7365  f reset_index(se
+000042c0: 6c66 2c20 6472 6f70 3a20 626f 6f6c 203d  lf, drop: bool =
+000042d0: 2046 616c 7365 293a 0a20 2020 2020 2020   False):.       
+000042e0: 2022 2222 5265 7365 7420 7468 6520 696e   """Reset the in
+000042f0: 6465 7820 746f 2074 6865 2064 6566 6175  dex to the defau
+00004300: 6c74 2069 6e64 6578 2e0a 0a20 2020 2020  lt index...     
+00004310: 2020 204e 6f74 6520 7468 6174 2075 6e6c     Note that unl
+00004320: 696b 6520 696e 2060 6070 616e 6461 7360  ike in ``pandas`
+00004330: 602c 2074 6865 2072 6573 6574 2069 6e64  `, the reset ind
+00004340: 6578 2066 6f72 2061 2044 6173 6b20 4461  ex for a Dask Da
+00004350: 7461 4672 616d 6520 7769 6c6c 0a20 2020  taFrame will.   
+00004360: 2020 2020 206e 6f74 2062 6520 6d6f 6e6f       not be mono
+00004370: 746f 6e69 6361 6c6c 7920 696e 6372 6561  tonically increa
+00004380: 7369 6e67 2066 726f 6d20 302e 2049 6e73  sing from 0. Ins
+00004390: 7465 6164 2c20 6974 2077 696c 6c20 7265  tead, it will re
+000043a0: 7374 6172 7420 6174 2030 0a20 2020 2020  start at 0.     
+000043b0: 2020 2066 6f72 2065 6163 6820 7061 7274     for each part
+000043c0: 6974 696f 6e20 2865 2e67 2e20 6060 696e  ition (e.g. ``in
+000043d0: 6465 7831 203d 205b 302c 202e 2e2e 2c20  dex1 = [0, ..., 
+000043e0: 3130 5d2c 2069 6e64 6578 3220 3d20 5b30  10], index2 = [0
+000043f0: 2c20 2e2e 2e5d 6060 292e 0a20 2020 2020  , ...]``)..     
+00004400: 2020 2054 6869 7320 6973 2064 7565 2074     This is due t
+00004410: 6f20 7468 6520 696e 6162 696c 6974 7920  o the inability 
+00004420: 746f 2073 7461 7469 6361 6c6c 7920 6b6e  to statically kn
+00004430: 6f77 2074 6865 2066 756c 6c20 6c65 6e67  ow the full leng
+00004440: 7468 206f 6620 7468 650a 2020 2020 2020  th of the.      
+00004450: 2020 696e 6465 782e 0a0a 2020 2020 2020    index...      
+00004460: 2020 466f 7220 4461 7461 4672 616d 6520    For DataFrame 
+00004470: 7769 7468 206d 756c 7469 2d6c 6576 656c  with multi-level
+00004480: 2069 6e64 6578 2c20 7265 7475 726e 7320   index, returns 
+00004490: 6120 6e65 7720 4461 7461 4672 616d 6520  a new DataFrame 
+000044a0: 7769 7468 0a20 2020 2020 2020 206c 6162  with.        lab
+000044b0: 656c 696e 6720 696e 666f 726d 6174 696f  eling informatio
+000044c0: 6e20 696e 2074 6865 2063 6f6c 756d 6e73  n in the columns
+000044d0: 2075 6e64 6572 2074 6865 2069 6e64 6578   under the index
+000044e0: 206e 616d 6573 2c20 6465 6661 756c 7469   names, defaulti
+000044f0: 6e67 0a20 2020 2020 2020 2074 6f20 276c  ng.        to 'l
+00004500: 6576 656c 5f30 272c 2027 6c65 7665 6c5f  evel_0', 'level_
+00004510: 3127 2c20 6574 632e 2069 6620 616e 7920  1', etc. if any 
+00004520: 6172 6520 4e6f 6e65 2e20 466f 7220 6120  are None. For a 
+00004530: 7374 616e 6461 7264 2069 6e64 6578 2c0a  standard index,.
+00004540: 2020 2020 2020 2020 7468 6520 696e 6465          the inde
+00004550: 7820 6e61 6d65 2077 696c 6c20 6265 2075  x name will be u
+00004560: 7365 6420 2869 6620 7365 7429 2c20 6f74  sed (if set), ot
+00004570: 6865 7277 6973 6520 6120 6465 6661 756c  herwise a defaul
+00004580: 7420 2769 6e64 6578 2720 6f72 0a20 2020  t 'index' or.   
+00004590: 2020 2020 2027 6c65 7665 6c5f 3027 2028       'level_0' (
+000045a0: 6966 2027 696e 6465 7827 2069 7320 616c  if 'index' is al
+000045b0: 7265 6164 7920 7461 6b65 6e29 2077 696c  ready taken) wil
+000045c0: 6c20 6265 2075 7365 642e 0a0a 2020 2020  l be used...    
+000045d0: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
+000045e0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+000045f0: 2d0a 2020 2020 2020 2020 6472 6f70 203a  -.        drop :
+00004600: 2062 6f6f 6c65 616e 2c20 6465 6661 756c   boolean, defaul
+00004610: 7420 4661 6c73 650a 2020 2020 2020 2020  t False.        
+00004620: 2020 2020 446f 206e 6f74 2074 7279 2074      Do not try t
+00004630: 6f20 696e 7365 7274 2069 6e64 6578 2069  o insert index i
+00004640: 6e74 6f20 6461 7461 6672 616d 6520 636f  nto dataframe co
+00004650: 6c75 6d6e 732e 0a20 2020 2020 2020 2022  lumns..        "
+00004660: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
+00004670: 6e20 6e65 775f 636f 6c6c 6563 7469 6f6e  n new_collection
+00004680: 2865 7870 722e 5265 7365 7449 6e64 6578  (expr.ResetIndex
+00004690: 2873 656c 662c 2064 726f 7029 290a 0a20  (self, drop)).. 
+000046a0: 2020 2064 6566 2068 6561 6428 7365 6c66     def head(self
+000046b0: 2c20 6e3a 2069 6e74 203d 2035 2c20 6e70  , n: int = 5, np
+000046c0: 6172 7469 7469 6f6e 733d 312c 2063 6f6d  artitions=1, com
+000046d0: 7075 7465 3a20 626f 6f6c 203d 2054 7275  pute: bool = Tru
+000046e0: 6529 3a0a 2020 2020 2020 2020 2222 2246  e):.        """F
+000046f0: 6972 7374 206e 2072 6f77 7320 6f66 2074  irst n rows of t
+00004700: 6865 2064 6174 6173 6574 0a0a 2020 2020  he dataset..    
+00004710: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
+00004720: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00004730: 2d0a 2020 2020 2020 2020 6e20 3a20 696e  -.        n : in
+00004740: 742c 206f 7074 696f 6e61 6c0a 2020 2020  t, optional.    
+00004750: 2020 2020 2020 2020 5468 6520 6e75 6d62          The numb
+00004760: 6572 206f 6620 726f 7773 2074 6f20 7265  er of rows to re
+00004770: 7475 726e 2e20 4465 6661 756c 7420 6973  turn. Default is
+00004780: 2035 2e0a 2020 2020 2020 2020 6e70 6172   5..        npar
+00004790: 7469 7469 6f6e 7320 3a20 696e 742c 206f  titions : int, o
+000047a0: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
+000047b0: 2020 2020 456c 656d 656e 7473 2061 7265      Elements are
+000047c0: 206f 6e6c 7920 7461 6b65 6e20 6672 6f6d   only taken from
+000047d0: 2074 6865 2066 6972 7374 2060 606e 7061   the first ``npa
+000047e0: 7274 6974 696f 6e73 6060 2c20 7769 7468  rtitions``, with
+000047f0: 2061 0a20 2020 2020 2020 2020 2020 2064   a.            d
+00004800: 6566 6175 6c74 206f 6620 312e 2049 6620  efault of 1. If 
+00004810: 7468 6572 6520 6172 6520 6665 7765 7220  there are fewer 
+00004820: 7468 616e 2060 606e 6060 2072 6f77 7320  than ``n`` rows 
+00004830: 696e 2074 6865 2066 6972 7374 0a20 2020  in the first.   
+00004840: 2020 2020 2020 2020 2060 606e 7061 7274           ``npart
+00004850: 6974 696f 6e73 6060 2061 2077 6172 6e69  itions`` a warni
+00004860: 6e67 2077 696c 6c20 6265 2072 6169 7365  ng will be raise
+00004870: 6420 616e 6420 616e 7920 666f 756e 6420  d and any found 
+00004880: 726f 7773 0a20 2020 2020 2020 2020 2020  rows.           
+00004890: 2072 6574 7572 6e65 642e 2050 6173 7320   returned. Pass 
+000048a0: 2d31 2074 6f20 7573 6520 616c 6c20 7061  -1 to use all pa
+000048b0: 7274 6974 696f 6e73 2e0a 2020 2020 2020  rtitions..      
+000048c0: 2020 636f 6d70 7574 6520 3a20 626f 6f6c    compute : bool
+000048d0: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+000048e0: 2020 2020 2020 2057 6865 7468 6572 2074         Whether t
+000048f0: 6f20 636f 6d70 7574 6520 7468 6520 7265  o compute the re
+00004900: 7375 6c74 2c20 6465 6661 756c 7420 6973  sult, default is
+00004910: 2054 7275 652e 0a20 2020 2020 2020 2022   True..        "
+00004920: 2222 0a20 2020 2020 2020 206f 7574 203d  "".        out =
+00004930: 206e 6577 5f63 6f6c 6c65 6374 696f 6e28   new_collection(
+00004940: 6578 7072 2e48 6561 6428 7365 6c66 2c20  expr.Head(self, 
+00004950: 6e3d 6e2c 206e 7061 7274 6974 696f 6e73  n=n, npartitions
+00004960: 3d6e 7061 7274 6974 696f 6e73 2929 0a20  =npartitions)). 
+00004970: 2020 2020 2020 2069 6620 636f 6d70 7574         if comput
+00004980: 653a 0a20 2020 2020 2020 2020 2020 206f  e:.            o
+00004990: 7574 203d 206f 7574 2e63 6f6d 7075 7465  ut = out.compute
+000049a0: 2829 0a20 2020 2020 2020 2072 6574 7572  ().        retur
+000049b0: 6e20 6f75 740a 0a20 2020 2064 6566 2074  n out..    def t
+000049c0: 6169 6c28 7365 6c66 2c20 6e3a 2069 6e74  ail(self, n: int
+000049d0: 203d 2035 2c20 636f 6d70 7574 653a 2062   = 5, compute: b
+000049e0: 6f6f 6c20 3d20 5472 7565 293a 0a20 2020  ool = True):.   
+000049f0: 2020 2020 2022 2222 4c61 7374 206e 2072       """Last n r
+00004a00: 6f77 7320 6f66 2074 6865 2064 6174 6173  ows of the datas
+00004a10: 6574 0a0a 2020 2020 2020 2020 4361 7665  et..        Cave
+00004a20: 6174 2c20 7468 6520 6f6e 6c79 2063 6865  at, the only che
+00004a30: 636b 7320 7468 6520 6c61 7374 206e 2072  cks the last n r
+00004a40: 6f77 7320 6f66 2074 6865 206c 6173 7420  ows of the last 
+00004a50: 7061 7274 6974 696f 6e2e 0a20 2020 2020  partition..     
+00004a60: 2020 2022 2222 0a20 2020 2020 2020 206f     """.        o
+00004a70: 7574 203d 206e 6577 5f63 6f6c 6c65 6374  ut = new_collect
+00004a80: 696f 6e28 6578 7072 2e54 6169 6c28 7365  ion(expr.Tail(se
+00004a90: 6c66 2c20 6e3d 6e29 290a 2020 2020 2020  lf, n=n)).      
+00004aa0: 2020 6966 2063 6f6d 7075 7465 3a0a 2020    if compute:.  
+00004ab0: 2020 2020 2020 2020 2020 6f75 7420 3d20            out = 
+00004ac0: 6f75 742e 636f 6d70 7574 6528 290a 2020  out.compute().  
+00004ad0: 2020 2020 2020 7265 7475 726e 206f 7574        return out
+00004ae0: 0a0a 2020 2020 6465 6620 636f 7079 2873  ..    def copy(s
+00004af0: 656c 662c 2064 6565 703a 2062 6f6f 6c20  elf, deep: bool 
+00004b00: 3d20 4661 6c73 6529 3a0a 2020 2020 2020  = False):.      
+00004b10: 2020 2222 224d 616b 6520 6120 636f 7079    """Make a copy
+00004b20: 206f 6620 7468 6520 6461 7461 6672 616d   of the datafram
+00004b30: 650a 0a20 2020 2020 2020 2054 6869 7320  e..        This 
+00004b40: 6973 2073 7472 6963 746c 7920 6120 7368  is strictly a sh
+00004b50: 616c 6c6f 7720 636f 7079 206f 6620 7468  allow copy of th
+00004b60: 6520 756e 6465 726c 7969 6e67 2063 6f6d  e underlying com
+00004b70: 7075 7461 7469 6f6e 616c 2067 7261 7068  putational graph
+00004b80: 2e0a 2020 2020 2020 2020 4974 2064 6f65  ..        It doe
+00004b90: 7320 6e6f 7420 6166 6665 6374 2074 6865  s not affect the
+00004ba0: 2075 6e64 6572 6c79 696e 6720 6461 7461   underlying data
+00004bb0: 0a0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
+00004bc0: 7465 7273 0a20 2020 2020 2020 202d 2d2d  ters.        ---
+00004bd0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00004be0: 6465 6570 203a 2062 6f6f 6c65 616e 2c20  deep : boolean, 
+00004bf0: 6465 6661 756c 7420 4661 6c73 650a 2020  default False.  
+00004c00: 2020 2020 2020 2020 2020 5468 6520 6465            The de
+00004c10: 6570 2076 616c 7565 206d 7573 7420 6265  ep value must be
+00004c20: 2060 4661 6c73 6560 2061 6e64 2069 7420   `False` and it 
+00004c30: 6973 2064 6563 6c61 7265 6420 6173 2061  is declared as a
+00004c40: 2070 6172 616d 6574 6572 206a 7573 7420   parameter just 
+00004c50: 666f 720a 2020 2020 2020 2020 2020 2020  for.            
+00004c60: 636f 6d70 6174 6962 696c 6974 7920 7769  compatibility wi
+00004c70: 7468 2074 6869 7264 2d70 6172 7479 206c  th third-party l
+00004c80: 6962 7261 7269 6573 206c 696b 6520 6375  ibraries like cu
+00004c90: 4446 2061 6e64 2070 616e 6461 730a 2020  DF and pandas.  
+00004ca0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00004cb0: 2020 6966 2064 6565 7020 6973 206e 6f74    if deep is not
+00004cc0: 2046 616c 7365 3a0a 2020 2020 2020 2020   False:.        
+00004cd0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+00004ce0: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+00004cf0: 2020 2020 2020 2254 6865 2060 6465 6570        "The `deep
+00004d00: 6020 7661 6c75 6520 6d75 7374 2062 6520  ` value must be 
+00004d10: 4661 6c73 652e 2054 6869 7320 6973 2073  False. This is s
+00004d20: 7472 6963 746c 7920 6120 7368 616c 6c6f  trictly a shallo
+00004d30: 7720 636f 7079 2022 0a20 2020 2020 2020  w copy ".       
+00004d40: 2020 2020 2020 2020 2022 6f66 2074 6865           "of the
+00004d50: 2075 6e64 6572 6c79 696e 6720 636f 6d70   underlying comp
+00004d60: 7574 6174 696f 6e61 6c20 6772 6170 682e  utational graph.
+00004d70: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
+00004d80: 2020 2020 2020 2020 7265 7475 726e 206e          return n
+00004d90: 6577 5f63 6f6c 6c65 6374 696f 6e28 7365  ew_collection(se
+00004da0: 6c66 2e65 7870 7229 0a0a 2020 2020 4064  lf.expr)..    @d
+00004db0: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
+00004dc0: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
+00004dd0: 6620 6973 696e 2873 656c 662c 2076 616c  f isin(self, val
+00004de0: 7565 7329 3a0a 2020 2020 2020 2020 6966  ues):.        if
+00004df0: 2069 7369 6e73 7461 6e63 6528 7365 6c66   isinstance(self
+00004e00: 2c20 4461 7461 4672 616d 6529 3a0a 2020  , DataFrame):.  
+00004e10: 2020 2020 2020 2020 2020 2320 4461 7461            # Data
+00004e20: 4672 616d 652e 6973 696e 2064 6f65 7320  Frame.isin does 
+00004e30: 7765 6972 6420 616c 6967 6e6d 656e 7420  weird alignment 
+00004e40: 7374 7566 660a 2020 2020 2020 2020 2020  stuff.          
+00004e50: 2020 6261 645f 7479 7065 7320 3d20 2846    bad_types = (F
+00004e60: 7261 6d65 4261 7365 2c20 7064 2e53 6572  rameBase, pd.Ser
+00004e70: 6965 732c 2070 642e 4461 7461 4672 616d  ies, pd.DataFram
+00004e80: 6529 0a20 2020 2020 2020 2065 6c73 653a  e).        else:
+00004e90: 0a20 2020 2020 2020 2020 2020 2062 6164  .            bad
+00004ea0: 5f74 7970 6573 203d 2028 4672 616d 6542  _types = (FrameB
+00004eb0: 6173 652c 290a 2020 2020 2020 2020 6966  ase,).        if
+00004ec0: 2069 7369 6e73 7461 6e63 6528 7661 6c75   isinstance(valu
+00004ed0: 6573 2c20 6261 645f 7479 7065 7329 3a0a  es, bad_types):.
+00004ee0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00004ef0: 6520 4e6f 7449 6d70 6c65 6d65 6e74 6564  e NotImplemented
+00004f00: 4572 726f 7228 2250 6173 7369 6e67 2061  Error("Passing a
+00004f10: 2025 7220 746f 2060 6973 696e 6022 2025   %r to `isin`" %
+00004f20: 2074 7970 656e 616d 6528 7479 7065 2876   typename(type(v
+00004f30: 616c 7565 7329 2929 0a0a 2020 2020 2020  alues)))..      
+00004f40: 2020 2320 5765 2077 7261 7020 7661 6c75    # We wrap valu
+00004f50: 6573 2069 6e20 6120 6465 6c61 7965 6420  es in a delayed 
+00004f60: 666f 7220 7477 6f20 7265 6173 6f6e 733a  for two reasons:
+00004f70: 0a20 2020 2020 2020 2023 202d 2061 766f  .        # - avo
+00004f80: 6964 2073 6572 6961 6c69 7a69 6e67 2064  id serializing d
+00004f90: 6174 6120 696e 2065 7665 7279 2074 6173  ata in every tas
+00004fa0: 6b0a 2020 2020 2020 2020 2320 2d20 6176  k.        # - av
+00004fb0: 6f69 6420 636f 7374 206f 6620 7472 6176  oid cost of trav
+00004fc0: 6572 7361 6c20 6f66 206c 6172 6765 206c  ersal of large l
+00004fd0: 6973 7420 696e 206f 7074 696d 697a 6174  ist in optimizat
+00004fe0: 696f 6e73 0a20 2020 2020 2020 2069 6620  ions.        if 
+00004ff0: 6973 696e 7374 616e 6365 2876 616c 7565  isinstance(value
+00005000: 732c 206c 6973 7429 3a0a 2020 2020 2020  s, list):.      
+00005010: 2020 2020 2020 2320 4d6f 7469 7661 7465        # Motivate
+00005020: 6420 6279 2068 7474 7073 3a2f 2f67 6974  d by https://git
+00005030: 6875 622e 636f 6d2f 6461 736b 2f64 6173  hub.com/dask/das
+00005040: 6b2f 6973 7375 6573 2f39 3431 312e 2020  k/issues/9411.  
+00005050: 5468 6973 2061 7070 6561 7273 2074 6f20  This appears to 
+00005060: 6265 0a20 2020 2020 2020 2020 2020 2023  be.            #
+00005070: 2063 6175 7365 6420 6279 2068 7474 7073   caused by https
+00005080: 3a2f 2f67 6974 6875 622e 636f 6d2f 6461  ://github.com/da
+00005090: 736b 2f64 6973 7472 6962 7574 6564 2f69  sk/distributed/i
+000050a0: 7373 7565 732f 3633 3638 2c20 616e 6420  ssues/6368, and 
+000050b0: 6675 7274 6865 720a 2020 2020 2020 2020  further.        
+000050c0: 2020 2020 2320 6578 6163 6572 6261 7465      # exacerbate
+000050d0: 6420 6279 2074 6865 2066 6163 7420 7468  d by the fact th
+000050e0: 6174 2074 6865 206c 6973 7420 636f 6e74  at the list cont
+000050f0: 6169 6e73 2064 7570 6c69 6361 7465 732e  ains duplicates.
+00005100: 2020 5468 6973 2069 7320 6120 7061 7463    This is a patc
+00005110: 6820 756e 7469 6c0a 2020 2020 2020 2020  h until.        
+00005120: 2020 2020 2320 7765 2063 616e 2063 7265      # we can cre
+00005130: 6174 6520 6120 6265 7474 6572 2066 6978  ate a better fix
+00005140: 2066 6f72 2053 6572 6961 6c69 7a61 7469   for Serializati
+00005150: 6f6e 2e0a 2020 2020 2020 2020 2020 2020  on..            
+00005160: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
+00005170: 2020 2020 2076 616c 7565 7320 3d20 6c69       values = li
+00005180: 7374 2873 6574 2876 616c 7565 7329 290a  st(set(values)).
+00005190: 2020 2020 2020 2020 2020 2020 6578 6365              exce
+000051a0: 7074 2054 7970 6545 7272 6f72 3a0a 2020  pt TypeError:.  
+000051b0: 2020 2020 2020 2020 2020 2020 2020 7061                pa
+000051c0: 7373 0a20 2020 2020 2020 2020 2020 2069  ss.            i
+000051d0: 6620 6e6f 7420 616e 7928 6973 5f64 6173  f not any(is_das
+000051e0: 6b5f 636f 6c6c 6563 7469 6f6e 2876 2920  k_collection(v) 
+000051f0: 666f 7220 7620 696e 2076 616c 7565 7329  for v in values)
+00005200: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00005210: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
+00005220: 2020 2020 2020 2020 2020 2076 616c 7565             value
+00005230: 7320 3d20 6e70 2e66 726f 6d69 7465 7228  s = np.fromiter(
+00005240: 7661 6c75 6573 2c20 6474 7970 653d 6f62  values, dtype=ob
+00005250: 6a65 6374 290a 2020 2020 2020 2020 2020  ject).          
+00005260: 2020 2020 2020 6578 6365 7074 2056 616c        except Val
+00005270: 7565 4572 726f 723a 0a20 2020 2020 2020  ueError:.       
+00005280: 2020 2020 2020 2020 2020 2020 2023 204e               # N
+00005290: 756d 7079 2031 2e32 3320 7375 7070 6f72  umpy 1.23 suppor
+000052a0: 7473 2063 7265 6174 696e 6720 6172 7261  ts creating arra
+000052b0: 7973 206f 6620 6974 6572 6162 6c65 732c  ys of iterables,
+000052c0: 2077 6869 6c65 206c 6f77 6572 0a20 2020   while lower.   
+000052d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000052e0: 2023 2076 6572 7369 6f6e 2031 2e32 312e   # version 1.21.
+000052f0: 7820 616e 6420 312e 3232 2e78 2064 6f20  x and 1.22.x do 
+00005300: 6e6f 740a 2020 2020 2020 2020 2020 2020  not.            
+00005310: 2020 2020 2020 2020 7061 7373 0a20 2020          pass.   
+00005320: 2020 2020 2066 726f 6d20 6461 736b 5f65       from dask_e
+00005330: 7870 722e 696f 2e5f 6465 6c61 7965 6420  xpr.io._delayed 
+00005340: 696d 706f 7274 205f 4465 6c61 7965 6445  import _DelayedE
+00005350: 7870 720a 0a20 2020 2020 2020 2072 6574  xpr..        ret
+00005360: 7572 6e20 6e65 775f 636f 6c6c 6563 7469  urn new_collecti
+00005370: 6f6e 280a 2020 2020 2020 2020 2020 2020  on(.            
+00005380: 6578 7072 2e49 7369 6e28 0a20 2020 2020  expr.Isin(.     
+00005390: 2020 2020 2020 2020 2020 2073 656c 662c             self,
+000053a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000053b0: 2076 616c 7565 733d 5f44 656c 6179 6564   values=_Delayed
+000053c0: 4578 7072 280a 2020 2020 2020 2020 2020  Expr(.          
+000053d0: 2020 2020 2020 2020 2020 6465 6c61 7965            delaye
+000053e0: 6428 7661 6c75 6573 2c20 6e61 6d65 3d22  d(values, name="
+000053f0: 6465 6c61 7965 642d 2220 2b20 5f74 6f6b  delayed-" + _tok
+00005400: 656e 697a 655f 6465 7465 726d 696e 6973  enize_determinis
+00005410: 7469 6328 7661 6c75 6573 2929 0a20 2020  tic(values)).   
+00005420: 2020 2020 2020 2020 2020 2020 2029 2c0a               ),.
+00005430: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00005440: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
+00005450: 205f 7061 7274 6974 696f 6e73 2873 656c   _partitions(sel
+00005460: 662c 2069 6e64 6578 293a 0a20 2020 2020  f, index):.     
+00005470: 2020 2023 2055 7365 6420 6279 2060 7061     # Used by `pa
+00005480: 7274 6974 696f 6e73 6020 666f 7220 7061  rtitions` for pa
+00005490: 7274 6974 696f 6e2d 7769 7365 2073 6c69  rtition-wise sli
+000054a0: 6369 6e67 0a0a 2020 2020 2020 2020 2320  cing..        # 
+000054b0: 436f 6e76 6572 7420 696e 6465 7820 746f  Convert index to
+000054c0: 206c 6973 740a 2020 2020 2020 2020 6966   list.        if
+000054d0: 2069 7369 6e73 7461 6e63 6528 696e 6465   isinstance(inde
+000054e0: 782c 2069 6e74 293a 0a20 2020 2020 2020  x, int):.       
+000054f0: 2020 2020 2069 6e64 6578 203d 205b 696e       index = [in
+00005500: 6465 785d 0a20 2020 2020 2020 2069 6e64  dex].        ind
+00005510: 6578 203d 206e 702e 6172 616e 6765 2873  ex = np.arange(s
+00005520: 656c 662e 6e70 6172 7469 7469 6f6e 732c  elf.npartitions,
+00005530: 2064 7479 7065 3d6f 626a 6563 7429 5b69   dtype=object)[i
+00005540: 6e64 6578 5d2e 746f 6c69 7374 2829 0a0a  ndex].tolist()..
+00005550: 2020 2020 2020 2020 2320 4368 6563 6b20          # Check 
+00005560: 7468 6174 2073 656c 6563 7469 6f6e 206d  that selection m
+00005570: 616b 6573 2073 656e 7365 0a20 2020 2020  akes sense.     
+00005580: 2020 2061 7373 6572 7420 7365 7428 696e     assert set(in
+00005590: 6465 7829 2e69 7373 7562 7365 7428 7261  dex).issubset(ra
+000055a0: 6e67 6528 7365 6c66 2e6e 7061 7274 6974  nge(self.npartit
+000055b0: 696f 6e73 2929 0a0a 2020 2020 2020 2020  ions))..        
+000055c0: 2320 5265 7475 726e 2073 656c 6563 7465  # Return selecte
+000055d0: 6420 7061 7274 6974 696f 6e73 0a20 2020  d partitions.   
+000055e0: 2020 2020 2072 6574 7572 6e20 6e65 775f       return new_
+000055f0: 636f 6c6c 6563 7469 6f6e 2865 7870 722e  collection(expr.
+00005600: 5061 7274 6974 696f 6e73 2873 656c 662c  Partitions(self,
+00005610: 2069 6e64 6578 2929 0a0a 2020 2020 4070   index))..    @p
+00005620: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+00005630: 7061 7274 6974 696f 6e73 2873 656c 6629  partitions(self)
+00005640: 3a0a 2020 2020 2020 2020 2222 2253 6c69  :.        """Sli
+00005650: 6365 2064 6174 6166 7261 6d65 2062 7920  ce dataframe by 
+00005660: 7061 7274 6974 696f 6e73 0a0a 2020 2020  partitions..    
+00005670: 2020 2020 5468 6973 2061 6c6c 6f77 7320      This allows 
+00005680: 7061 7274 6974 696f 6e77 6973 6520 736c  partitionwise sl
+00005690: 6963 696e 6720 6f66 2061 2044 6173 6b20  icing of a Dask 
+000056a0: 4461 7461 6672 616d 652e 2020 596f 7520  Dataframe.  You 
+000056b0: 6361 6e20 7065 7266 6f72 6d20 6e6f 726d  can perform norm
+000056c0: 616c 0a20 2020 2020 2020 204e 756d 7079  al.        Numpy
+000056d0: 2d73 7479 6c65 2073 6c69 6369 6e67 2c20  -style slicing, 
+000056e0: 6275 7420 6e6f 7720 7261 7468 6572 2074  but now rather t
+000056f0: 6861 6e20 736c 6963 6520 656c 656d 656e  han slice elemen
+00005700: 7473 206f 6620 7468 6520 6172 7261 7920  ts of the array 
+00005710: 796f 750a 2020 2020 2020 2020 736c 6963  you.        slic
+00005720: 6520 616c 6f6e 6720 7061 7274 6974 696f  e along partitio
+00005730: 6e73 2073 6f2c 2066 6f72 2065 7861 6d70  ns so, for examp
+00005740: 6c65 2c20 6060 6466 2e70 6172 7469 7469  le, ``df.partiti
+00005750: 6f6e 735b 3a35 5d60 6020 7072 6f64 7563  ons[:5]`` produc
+00005760: 6573 2061 206e 6577 0a20 2020 2020 2020  es a new.       
+00005770: 2044 6173 6b20 4461 7461 6672 616d 6520   Dask Dataframe 
+00005780: 6f66 2074 6865 2066 6972 7374 2066 6976  of the first fiv
+00005790: 6520 7061 7274 6974 696f 6e73 2e20 5661  e partitions. Va
+000057a0: 6c69 6420 696e 6465 7865 7273 2061 7265  lid indexers are
+000057b0: 2069 6e74 6567 6572 732c 2073 6571 7565   integers, seque
+000057c0: 6e63 6573 0a20 2020 2020 2020 206f 6620  nces.        of 
+000057d0: 696e 7465 6765 7273 2c20 736c 6963 6573  integers, slices
+000057e0: 2c20 6f72 2062 6f6f 6c65 616e 206d 6173  , or boolean mas
+000057f0: 6b73 2e0a 0a20 2020 2020 2020 2045 7861  ks...        Exa
+00005800: 6d70 6c65 730a 2020 2020 2020 2020 2d2d  mples.        --
+00005810: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203e  ------.        >
+00005820: 3e3e 2064 662e 7061 7274 6974 696f 6e73  >> df.partitions
+00005830: 5b30 5d20 2023 2064 6f63 7465 7374 3a20  [0]  # doctest: 
+00005840: 2b53 4b49 500a 2020 2020 2020 2020 3e3e  +SKIP.        >>
+00005850: 3e20 6466 2e70 6172 7469 7469 6f6e 735b  > df.partitions[
+00005860: 3a33 5d20 2023 2064 6f63 7465 7374 3a20  :3]  # doctest: 
+00005870: 2b53 4b49 500a 2020 2020 2020 2020 3e3e  +SKIP.        >>
+00005880: 3e20 6466 2e70 6172 7469 7469 6f6e 735b  > df.partitions[
+00005890: 3a3a 3130 5d20 2023 2064 6f63 7465 7374  ::10]  # doctest
+000058a0: 3a20 2b53 4b49 500a 0a20 2020 2020 2020  : +SKIP..       
+000058b0: 2052 6574 7572 6e73 0a20 2020 2020 2020   Returns.       
+000058c0: 202d 2d2d 2d2d 2d2d 0a20 2020 2020 2020   -------.       
+000058d0: 2041 2044 6173 6b20 4461 7461 4672 616d   A Dask DataFram
+000058e0: 650a 2020 2020 2020 2020 2222 220a 2020  e.        """.  
+000058f0: 2020 2020 2020 7265 7475 726e 2049 6e64        return Ind
+00005900: 6578 4361 6c6c 6162 6c65 2873 656c 662e  exCallable(self.
+00005910: 5f70 6172 7469 7469 6f6e 7329 0a0a 2020  _partitions)..  
+00005920: 2020 6465 6620 6765 745f 7061 7274 6974    def get_partit
+00005930: 696f 6e28 7365 6c66 2c20 6e29 3a0a 2020  ion(self, n):.  
+00005940: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00005950: 2020 4765 7420 6120 6461 736b 2044 6174    Get a dask Dat
+00005960: 6146 7261 6d65 2f53 6572 6965 7320 7265  aFrame/Series re
+00005970: 7072 6573 656e 7469 6e67 2074 6865 2060  presenting the `
+00005980: 6e74 6860 2070 6172 7469 7469 6f6e 2e0a  nth` partition..
+00005990: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+000059a0: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
+000059b0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 206e  ------.        n
+000059c0: 203a 2069 6e74 0a20 2020 2020 2020 2020   : int.         
+000059d0: 2020 2054 6865 2030 2d69 6e64 6578 6564     The 0-indexed
+000059e0: 2070 6172 7469 7469 6f6e 206e 756d 6265   partition numbe
+000059f0: 7220 746f 2073 656c 6563 742e 0a0a 2020  r to select...  
+00005a00: 2020 2020 2020 5265 7475 726e 730a 2020        Returns.  
+00005a10: 2020 2020 2020 2d2d 2d2d 2d2d 2d0a 2020        -------.  
+00005a20: 2020 2020 2020 4461 736b 2044 6174 6146        Dask DataF
+00005a30: 7261 6d65 206f 7220 5365 7269 6573 0a20  rame or Series. 
+00005a40: 2020 2020 2020 2020 2020 2054 6865 2073             The s
+00005a50: 616d 6520 7479 7065 2061 7320 7468 6520  ame type as the 
+00005a60: 6f72 6967 696e 616c 206f 626a 6563 742e  original object.
+00005a70: 0a0a 2020 2020 2020 2020 5365 6520 416c  ..        See Al
+00005a80: 736f 0a20 2020 2020 2020 202d 2d2d 2d2d  so.        -----
+00005a90: 2d2d 2d0a 2020 2020 2020 2020 4461 7461  ---.        Data
+00005aa0: 4672 616d 652e 7061 7274 6974 696f 6e73  Frame.partitions
+00005ab0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00005ac0: 2020 2020 2069 6620 6e6f 7420 3020 3c3d       if not 0 <=
+00005ad0: 206e 203c 2073 656c 662e 6e70 6172 7469   n < self.nparti
+00005ae0: 7469 6f6e 733a 0a20 2020 2020 2020 2020  tions:.         
+00005af0: 2020 206d 7367 203d 2066 226e 206d 7573     msg = f"n mus
+00005b00: 7420 6265 2030 203c 3d20 6e20 3c20 7b73  t be 0 <= n < {s
+00005b10: 656c 662e 6e70 6172 7469 7469 6f6e 737d  elf.npartitions}
+00005b20: 220a 2020 2020 2020 2020 2020 2020 7261  ".            ra
+00005b30: 6973 6520 5661 6c75 6545 7272 6f72 286d  ise ValueError(m
+00005b40: 7367 290a 2020 2020 2020 2020 7265 7475  sg).        retu
+00005b50: 726e 2073 656c 662e 7061 7274 6974 696f  rn self.partitio
+00005b60: 6e73 5b6e 5d0a 0a20 2020 2064 6566 2073  ns[n]..    def s
+00005b70: 6875 6666 6c65 280a 2020 2020 2020 2020  huffle(.        
+00005b80: 7365 6c66 2c0a 2020 2020 2020 2020 6f6e  self,.        on
+00005b90: 3a20 7374 7220 7c20 6c69 7374 207c 206e  : str | list | n
+00005ba0: 6f5f 6465 6661 756c 7420 3d20 6e6f 5f64  o_default = no_d
+00005bb0: 6566 6175 6c74 2c0a 2020 2020 2020 2020  efault,.        
+00005bc0: 6967 6e6f 7265 5f69 6e64 6578 3a20 626f  ignore_index: bo
+00005bd0: 6f6c 203d 2046 616c 7365 2c0a 2020 2020  ol = False,.    
+00005be0: 2020 2020 6e70 6172 7469 7469 6f6e 733a      npartitions:
+00005bf0: 2069 6e74 207c 204e 6f6e 6520 3d20 4e6f   int | None = No
+00005c00: 6e65 2c0a 2020 2020 2020 2020 7368 7566  ne,.        shuf
+00005c10: 666c 655f 6d65 7468 6f64 3a20 7374 7220  fle_method: str 
+00005c20: 7c20 4e6f 6e65 203d 204e 6f6e 652c 0a20  | None = None,. 
+00005c30: 2020 2020 2020 206f 6e5f 696e 6465 783a         on_index:
+00005c40: 2062 6f6f 6c20 3d20 4661 6c73 652c 0a20   bool = False,. 
+00005c50: 2020 2020 2020 202a 2a6f 7074 696f 6e73         **options
+00005c60: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
+00005c70: 2022 2222 5265 6172 7261 6e67 6520 4461   """Rearrange Da
+00005c80: 7461 4672 616d 6520 696e 746f 206e 6577  taFrame into new
+00005c90: 2070 6172 7469 7469 6f6e 730a 0a20 2020   partitions..   
+00005ca0: 2020 2020 2055 7365 7320 6861 7368 696e       Uses hashin
+00005cb0: 6720 6f66 2060 6f6e 6020 746f 206d 6170  g of `on` to map
+00005cc0: 2072 6f77 7320 746f 206f 7574 7075 7420   rows to output 
+00005cd0: 7061 7274 6974 696f 6e73 2e20 4166 7465  partitions. Afte
+00005ce0: 7220 7468 6973 0a20 2020 2020 2020 206f  r this.        o
+00005cf0: 7065 7261 7469 6f6e 2c20 726f 7773 2077  peration, rows w
+00005d00: 6974 6820 7468 6520 7361 6d65 2076 616c  ith the same val
+00005d10: 7565 206f 6620 606f 6e60 2077 696c 6c20  ue of `on` will 
+00005d20: 6265 2069 6e20 7468 6520 7361 6d65 0a20  be in the same. 
+00005d30: 2020 2020 2020 2070 6172 7469 7469 6f6e         partition
+00005d40: 2e0a 0a20 2020 2020 2020 2050 6172 616d  ...        Param
+00005d50: 6574 6572 730a 2020 2020 2020 2020 2d2d  eters.        --
+00005d60: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00005d70: 206f 6e20 3a20 7374 722c 206c 6973 7420   on : str, list 
+00005d80: 6f66 2073 7472 2c20 6f72 2053 6572 6965  of str, or Serie
+00005d90: 732c 2049 6e64 6578 2c20 6f72 2044 6174  s, Index, or Dat
+00005da0: 6146 7261 6d65 0a20 2020 2020 2020 2020  aFrame.         
+00005db0: 2020 2043 6f6c 756d 6e20 6e61 6d65 7320     Column names 
+00005dc0: 746f 2073 6875 6666 6c65 2062 792e 0a20  to shuffle by.. 
+00005dd0: 2020 2020 2020 2069 676e 6f72 655f 696e         ignore_in
+00005de0: 6465 7820 3a20 6f70 7469 6f6e 616c 0a20  dex : optional. 
+00005df0: 2020 2020 2020 2020 2020 2057 6865 7468             Wheth
+00005e00: 6572 2074 6f20 6967 6e6f 7265 2074 6865  er to ignore the
+00005e10: 2069 6e64 6578 2e20 4465 6661 756c 7420   index. Default 
+00005e20: 6973 2060 6046 616c 7365 6060 2e0a 2020  is ``False``..  
+00005e30: 2020 2020 2020 6e70 6172 7469 7469 6f6e        npartition
+00005e40: 7320 3a20 6f70 7469 6f6e 616c 0a20 2020  s : optional.   
+00005e50: 2020 2020 2020 2020 204e 756d 6265 7220           Number 
+00005e60: 6f66 206f 7574 7075 7420 7061 7274 6974  of output partit
+00005e70: 696f 6e73 2e20 5468 6520 7061 7274 6974  ions. The partit
+00005e80: 696f 6e20 636f 756e 7420 7769 6c6c 0a20  ion count will. 
+00005e90: 2020 2020 2020 2020 2020 2062 6520 7072             be pr
+00005ea0: 6573 6572 7665 6420 6279 2064 6566 6175  eserved by defau
+00005eb0: 6c74 2e0a 2020 2020 2020 2020 7368 7566  lt..        shuf
+00005ec0: 666c 655f 6d65 7468 6f64 203a 206f 7074  fle_method : opt
+00005ed0: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
+00005ee0: 2020 4465 7369 7265 6420 7368 7566 666c    Desired shuffl
+00005ef0: 6520 6d65 7468 6f64 2e20 4465 6661 756c  e method. Defaul
+00005f00: 7420 6368 6f73 656e 2061 7420 6f70 7469  t chosen at opti
+00005f10: 6d69 7a61 7469 6f6e 2074 696d 652e 0a20  mization time.. 
+00005f20: 2020 2020 2020 206f 6e5f 696e 6465 7820         on_index 
+00005f30: 3a20 626f 6f6c 2c20 6465 6661 756c 7420  : bool, default 
+00005f40: 4661 6c73 650a 2020 2020 2020 2020 2020  False.          
+00005f50: 2020 5768 6574 6865 7220 746f 2073 6875    Whether to shu
+00005f60: 6666 6c65 206f 6e20 7468 6520 696e 6465  ffle on the inde
+00005f70: 782e 204d 7574 7561 6c6c 7920 6578 636c  x. Mutually excl
+00005f80: 7573 6976 6520 7769 7468 2027 6f6e 272e  usive with 'on'.
+00005f90: 0a20 2020 2020 2020 2020 2020 2053 6574  .            Set
+00005fa0: 2074 6869 7320 746f 2060 6054 7275 6560   this to ``True`
+00005fb0: 6020 6966 2027 6f6e 2720 6973 206e 6f74  ` if 'on' is not
+00005fc0: 2070 726f 7669 6465 642e 0a20 2020 2020   provided..     
+00005fd0: 2020 202a 2a6f 7074 696f 6e73 203a 206f     **options : o
+00005fe0: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
+00005ff0: 2020 2020 416c 676f 7269 7468 6d2d 7370      Algorithm-sp
+00006000: 6563 6966 6963 206f 7074 696f 6e73 2e0a  ecific options..
+00006010: 0a20 2020 2020 2020 204e 6f74 6573 0a20  .        Notes. 
+00006020: 2020 2020 2020 202d 2d2d 2d2d 0a20 2020         -----.   
+00006030: 2020 2020 2054 6869 7320 646f 6573 206e       This does n
+00006040: 6f74 2070 7265 7365 7276 6520 6120 6d65  ot preserve a me
+00006050: 616e 696e 6766 756c 2069 6e64 6578 2f70  aningful index/p
+00006060: 6172 7469 7469 6f6e 696e 6720 7363 6865  artitioning sche
+00006070: 6d65 2e20 5468 6973 0a20 2020 2020 2020  me. This.       
+00006080: 2069 7320 6e6f 7420 6465 7465 726d 696e   is not determin
+00006090: 6973 7469 6320 6966 2064 6f6e 6520 696e  istic if done in
+000060a0: 2070 6172 616c 6c65 6c2e 0a0a 2020 2020   parallel...    
+000060b0: 2020 2020 4578 616d 706c 6573 0a20 2020      Examples.   
+000060c0: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
+000060d0: 2020 2020 2020 3e3e 3e20 6466 203d 2064        >>> df = d
+000060e0: 662e 7368 7566 666c 6528 6466 2e63 6f6c  f.shuffle(df.col
+000060f0: 756d 6e73 5b30 5d29 2020 2320 646f 6374  umns[0])  # doct
+00006100: 6573 743a 202b 534b 4950 0a20 2020 2020  est: +SKIP.     
+00006110: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
+00006120: 6620 6f6e 2069 7320 6e6f 5f64 6566 6175  f on is no_defau
+00006130: 6c74 2061 6e64 206e 6f74 206f 6e5f 696e  lt and not on_in
+00006140: 6465 783a 0a20 2020 2020 2020 2020 2020  dex:.           
+00006150: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
+00006160: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00006170: 2020 224d 7573 7420 7368 7566 666c 6520    "Must shuffle 
+00006180: 6f6e 2065 6974 6865 7220 636f 6c75 6d6e  on either column
+00006190: 7320 6f72 2074 6865 2069 6e64 6578 3b20  s or the index; 
+000061a0: 6375 7272 656e 746c 7920 7368 7566 666c  currently shuffl
+000061b0: 696e 6720 6f6e 2022 0a20 2020 2020 2020  ing on ".       
+000061c0: 2020 2020 2020 2020 2022 6e65 6974 6865           "neithe
+000061d0: 722e 2050 6173 7320 636f 6c75 6d6e 2873  r. Pass column(s
+000061e0: 2920 746f 2027 6f6e 2720 6f72 2073 6574  ) to 'on' or set
+000061f0: 2027 6f6e 5f69 6e64 6578 2720 746f 2054   'on_index' to T
+00006200: 7275 652e 220a 2020 2020 2020 2020 2020  rue.".          
+00006210: 2020 290a 2020 2020 2020 2020 656c 6966    ).        elif
+00006220: 206f 6e20 6973 206e 6f74 206e 6f5f 6465   on is not no_de
+00006230: 6661 756c 7420 616e 6420 6f6e 5f69 6e64  fault and on_ind
+00006240: 6578 3a0a 2020 2020 2020 2020 2020 2020  ex:.            
+00006250: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
+00006260: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00006270: 2022 4361 6e6e 6f74 2073 6875 6666 6c65   "Cannot shuffle
+00006280: 206f 6e20 626f 7468 2063 6f6c 756d 6e73   on both columns
+00006290: 2061 6e64 2074 6865 2069 6e64 6578 2e20   and the index. 
+000062a0: 446f 206e 6f74 2070 6173 7320 636f 6c75  Do not pass colu
+000062b0: 6d6e 2873 2920 220a 2020 2020 2020 2020  mn(s) ".        
+000062c0: 2020 2020 2020 2020 2274 6f20 276f 6e27          "to 'on'
+000062d0: 206f 7220 7365 7420 276f 6e5f 696e 6465   or set 'on_inde
+000062e0: 7827 2074 6f20 4661 6c73 652e 220a 2020  x' to False.".  
+000062f0: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+00006300: 2020 2020 2023 2050 7265 7365 7276 6520       # Preserve 
+00006310: 7061 7274 6974 696f 6e20 636f 756e 7420  partition count 
+00006320: 6279 2064 6566 6175 6c74 0a20 2020 2020  by default.     
+00006330: 2020 206e 7061 7274 6974 696f 6e73 203d     npartitions =
+00006340: 206e 7061 7274 6974 696f 6e73 206f 7220   npartitions or 
+00006350: 7365 6c66 2e6e 7061 7274 6974 696f 6e73  self.npartitions
+00006360: 0a0a 2020 2020 2020 2020 6966 2069 7369  ..        if isi
+00006370: 6e73 7461 6e63 6528 6f6e 2c20 4672 616d  nstance(on, Fram
+00006380: 6542 6173 6529 3a0a 2020 2020 2020 2020  eBase):.        
+00006390: 2020 2020 6966 206e 6f74 2065 7870 722e      if not expr.
+000063a0: 6172 655f 636f 5f61 6c69 676e 6564 2873  are_co_aligned(s
+000063b0: 656c 662e 6578 7072 2c20 6f6e 2e65 7870  elf.expr, on.exp
+000063c0: 7229 3a0a 2020 2020 2020 2020 2020 2020  r):.            
+000063d0: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
+000063e0: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
+000063f0: 2020 2020 2020 2020 2022 696e 6465 7820           "index 
+00006400: 6d75 7374 2062 6520 616c 6967 6e65 6420  must be aligned 
+00006410: 7769 7468 2074 6865 2044 6174 6146 7261  with the DataFra
+00006420: 6d65 2074 6f20 7573 6520 6173 2073 6875  me to use as shu
+00006430: 6666 6c65 2069 6e64 6578 2e22 0a20 2020  ffle index.".   
+00006440: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+00006450: 2020 2020 2020 2065 6c69 6620 7064 2e61         elif pd.a
+00006460: 7069 2e74 7970 6573 2e69 735f 6c69 7374  pi.types.is_list
+00006470: 5f6c 696b 6528 6f6e 2920 616e 6420 6e6f  _like(on) and no
+00006480: 7420 6973 5f64 6173 6b5f 636f 6c6c 6563  t is_dask_collec
+00006490: 7469 6f6e 286f 6e29 3a0a 2020 2020 2020  tion(on):.      
+000064a0: 2020 2020 2020 6f6e 203d 206c 6973 7428        on = list(
+000064b0: 6f6e 290a 0a20 2020 2020 2020 2069 6620  on)..        if 
+000064c0: 2873 6875 6666 6c65 5f6d 6574 686f 6420  (shuffle_method 
+000064d0: 6f72 2067 6574 5f64 6566 6175 6c74 5f73  or get_default_s
+000064e0: 6875 6666 6c65 5f6d 6574 686f 6428 2929  huffle_method())
+000064f0: 203d 3d20 2270 3270 223a 0a20 2020 2020   == "p2p":.     
+00006500: 2020 2020 2020 2066 726f 6d20 6469 7374         from dist
+00006510: 7269 6275 7465 642e 7368 7566 666c 652e  ributed.shuffle.
+00006520: 5f61 7272 6f77 2069 6d70 6f72 7420 6368  _arrow import ch
+00006530: 6563 6b5f 6474 7970 655f 7375 7070 6f72  eck_dtype_suppor
+00006540: 740a 0a20 2020 2020 2020 2020 2020 2063  t..            c
+00006550: 6865 636b 5f64 7479 7065 5f73 7570 706f  heck_dtype_suppo
+00006560: 7274 2873 656c 662e 5f6d 6574 6129 0a0a  rt(self._meta)..
+00006570: 2020 2020 2020 2020 2020 2020 6966 2061              if a
+00006580: 6e79 286e 6f74 2069 7369 6e73 7461 6e63  ny(not isinstanc
+00006590: 6528 632c 2073 7472 2920 666f 7220 6320  e(c, str) for c 
+000065a0: 696e 2073 656c 662e 5f6d 6574 612e 636f  in self._meta.co
+000065b0: 6c75 6d6e 7329 3a0a 2020 2020 2020 2020  lumns):.        
+000065c0: 2020 2020 2020 2020 756e 7375 7070 6f72          unsuppor
+000065d0: 7465 6420 3d20 7b0a 2020 2020 2020 2020  ted = {.        
+000065e0: 2020 2020 2020 2020 2020 2020 633a 2074              c: t
+000065f0: 7970 6528 6329 2066 6f72 2063 2069 6e20  ype(c) for c in 
+00006600: 7365 6c66 2e5f 6d65 7461 2e63 6f6c 756d  self._meta.colum
+00006610: 6e73 2069 6620 6e6f 7420 6973 696e 7374  ns if not isinst
+00006620: 616e 6365 2863 2c20 7374 7229 0a20 2020  ance(c, str).   
+00006630: 2020 2020 2020 2020 2020 2020 207d 0a20               }. 
+00006640: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00006650: 6169 7365 2054 7970 6545 7272 6f72 280a  aise TypeError(.
 00006660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006670: 2020 6622 7032 7020 7265 7175 6972 6573    f"p2p requires
-00006680: 2061 6c6c 2063 6f6c 756d 6e20 6e61 6d65   all column name
-00006690: 7320 746f 2062 6520 7374 722c 2066 6f75  s to be str, fou
-000066a0: 6e64 3a20 7b75 6e73 7570 706f 7274 6564  nd: {unsupported
-000066b0: 7d22 2c0a 2020 2020 2020 2020 2020 2020  }",.            
-000066c0: 2020 2020 290a 0a20 2020 2020 2020 2023      )..        #
-000066d0: 2052 6574 7572 6e65 6420 7368 7566 666c   Returned shuffl
-000066e0: 6564 2072 6573 756c 740a 2020 2020 2020  ed result.      
-000066f0: 2020 7265 7475 726e 206e 6577 5f63 6f6c    return new_col
-00006700: 6c65 6374 696f 6e28 0a20 2020 2020 2020  lection(.       
-00006710: 2020 2020 2052 6561 7272 616e 6765 4279       RearrangeBy
-00006720: 436f 6c75 6d6e 280a 2020 2020 2020 2020  Column(.        
-00006730: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-00006740: 2020 2020 2020 2020 2020 2020 2020 6f6e                on
-00006750: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00006760: 2020 6e70 6172 7469 7469 6f6e 732c 0a20    npartitions,. 
-00006770: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00006780: 676e 6f72 655f 696e 6465 782c 0a20 2020  gnore_index,.   
-00006790: 2020 2020 2020 2020 2020 2020 2067 6574               get
-000067a0: 5f73 7065 6369 6669 6564 5f73 6875 6666  _specified_shuff
-000067b0: 6c65 2873 6875 6666 6c65 5f6d 6574 686f  le(shuffle_metho
-000067c0: 6429 2c0a 2020 2020 2020 2020 2020 2020  d),.            
-000067d0: 2020 2020 6f70 7469 6f6e 732c 0a20 2020      options,.   
-000067e0: 2020 2020 2020 2020 2020 2020 2069 6e64               ind
-000067f0: 6578 5f73 6875 6666 6c65 3d6f 6e5f 696e  ex_shuffle=on_in
-00006800: 6465 782c 0a20 2020 2020 2020 2020 2020  dex,.           
-00006810: 2029 0a20 2020 2020 2020 2029 0a0a 2020   ).        )..  
-00006820: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
-00006830: 7064 2e44 6174 6146 7261 6d65 290a 2020  pd.DataFrame).  
-00006840: 2020 6465 6620 7265 7361 6d70 6c65 2873    def resample(s
-00006850: 656c 662c 2072 756c 652c 2063 6c6f 7365  elf, rule, close
-00006860: 643d 4e6f 6e65 2c20 6c61 6265 6c3d 4e6f  d=None, label=No
-00006870: 6e65 293a 0a20 2020 2020 2020 2066 726f  ne):.        fro
-00006880: 6d20 6461 736b 5f65 7870 722e 5f72 6573  m dask_expr._res
-00006890: 616d 706c 6520 696d 706f 7274 2052 6573  ample import Res
-000068a0: 616d 706c 6572 0a0a 2020 2020 2020 2020  ampler..        
-000068b0: 7265 7475 726e 2052 6573 616d 706c 6572  return Resampler
-000068c0: 2873 656c 662c 2072 756c 652c 202a 2a7b  (self, rule, **{
-000068d0: 2263 6c6f 7365 6422 3a20 636c 6f73 6564  "closed": closed
-000068e0: 2c20 226c 6162 656c 223a 206c 6162 656c  , "label": label
-000068f0: 7d29 0a0a 2020 2020 6465 6620 726f 6c6c  })..    def roll
-00006900: 696e 6728 7365 6c66 2c20 7769 6e64 6f77  ing(self, window
-00006910: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
-00006920: 2020 2020 2022 2222 5072 6f76 6964 6573       """Provides
-00006930: 2072 6f6c 6c69 6e67 2074 7261 6e73 666f   rolling transfo
-00006940: 726d 6174 696f 6e73 2e0a 0a20 2020 2020  rmations...     
-00006950: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
-00006960: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00006970: 0a20 2020 2020 2020 2077 696e 646f 7720  .        window 
-00006980: 3a20 696e 742c 2073 7472 2c20 6f66 6673  : int, str, offs
-00006990: 6574 0a20 2020 2020 2020 2020 2020 5369  et.           Si
-000069a0: 7a65 206f 6620 7468 6520 6d6f 7669 6e67  ze of the moving
-000069b0: 2077 696e 646f 772e 2054 6869 7320 6973   window. This is
-000069c0: 2074 6865 206e 756d 6265 7220 6f66 206f   the number of o
-000069d0: 6273 6572 7661 7469 6f6e 7320 7573 6564  bservations used
-000069e0: 0a20 2020 2020 2020 2020 2020 666f 7220  .           for 
-000069f0: 6361 6c63 756c 6174 696e 6720 7468 6520  calculating the 
-00006a00: 7374 6174 6973 7469 632e 2057 6865 6e20  statistic. When 
-00006a10: 6e6f 7420 7573 696e 6720 6120 6060 4461  not using a ``Da
-00006a20: 7465 7469 6d65 496e 6465 7860 602c 0a20  tetimeIndex``,. 
-00006a30: 2020 2020 2020 2020 2020 7468 6520 7769            the wi
-00006a40: 6e64 6f77 2073 697a 6520 6d75 7374 206e  ndow size must n
-00006a50: 6f74 2062 6520 736f 206c 6172 6765 2061  ot be so large a
-00006a60: 7320 746f 2073 7061 6e20 6d6f 7265 2074  s to span more t
-00006a70: 6861 6e20 6f6e 650a 2020 2020 2020 2020  han one.        
-00006a80: 2020 2061 646a 6163 656e 7420 7061 7274     adjacent part
-00006a90: 6974 696f 6e2e 2049 6620 7573 696e 6720  ition. If using 
-00006aa0: 616e 206f 6666 7365 7420 6f72 206f 6666  an offset or off
-00006ab0: 7365 7420 616c 6961 7320 6c69 6b65 2027  set alias like '
-00006ac0: 3544 272c 0a20 2020 2020 2020 2020 2020  5D',.           
-00006ad0: 7468 6520 6461 7461 206d 7573 7420 6861  the data must ha
-00006ae0: 7665 2061 2060 6044 6174 6574 696d 6549  ve a ``DatetimeI
-00006af0: 6e64 6578 6060 0a20 2020 2020 2020 206d  ndex``.        m
-00006b00: 696e 5f70 6572 696f 6473 203a 2069 6e74  in_periods : int
-00006b10: 2c20 6465 6661 756c 7420 4e6f 6e65 0a20  , default None. 
-00006b20: 2020 2020 2020 2020 2020 204d 696e 696d             Minim
-00006b30: 756d 206e 756d 6265 7220 6f66 206f 6273  um number of obs
-00006b40: 6572 7661 7469 6f6e 7320 696e 2077 696e  ervations in win
-00006b50: 646f 7720 7265 7175 6972 6564 2074 6f20  dow required to 
-00006b60: 6861 7665 2061 2076 616c 7565 0a20 2020  have a value.   
-00006b70: 2020 2020 2020 2020 2028 6f74 6865 7277           (otherw
-00006b80: 6973 6520 7265 7375 6c74 2069 7320 4e41  ise result is NA
-00006b90: 292e 0a20 2020 2020 2020 2063 656e 7465  )..        cente
-00006ba0: 7220 3a20 626f 6f6c 6561 6e2c 2064 6566  r : boolean, def
-00006bb0: 6175 6c74 2046 616c 7365 0a20 2020 2020  ault False.     
-00006bc0: 2020 2020 2020 2053 6574 2074 6865 206c         Set the l
-00006bd0: 6162 656c 7320 6174 2074 6865 2063 656e  abels at the cen
-00006be0: 7465 7220 6f66 2074 6865 2077 696e 646f  ter of the windo
-00006bf0: 772e 0a20 2020 2020 2020 2077 696e 5f74  w..        win_t
-00006c00: 7970 6520 3a20 7374 7269 6e67 2c20 6465  ype : string, de
-00006c10: 6661 756c 7420 4e6f 6e65 0a20 2020 2020  fault None.     
-00006c20: 2020 2020 2020 2050 726f 7669 6465 2061         Provide a
-00006c30: 2077 696e 646f 7720 7479 7065 2e20 5468   window type. Th
-00006c40: 6520 7265 636f 676e 697a 6564 2077 696e  e recognized win
-00006c50: 646f 7720 7479 7065 7320 6172 6520 6964  dow types are id
-00006c60: 656e 7469 6361 6c0a 2020 2020 2020 2020  entical.        
-00006c70: 2020 2020 746f 2070 616e 6461 732e 0a20      to pandas.. 
-00006c80: 2020 2020 2020 2061 7869 7320 3a20 696e         axis : in
-00006c90: 742c 2073 7472 2c20 4e6f 6e65 2c20 6465  t, str, None, de
-00006ca0: 6661 756c 7420 300a 2020 2020 2020 2020  fault 0.        
-00006cb0: 2020 2020 5468 6973 2070 6172 616d 6574      This paramet
-00006cc0: 6572 2069 7320 6465 7072 6563 6174 6564  er is deprecated
-00006cd0: 2077 6974 6820 6060 7061 6e64 6173 3e3d   with ``pandas>=
-00006ce0: 322e 3160 602e 0a0a 2020 2020 2020 2020  2.1``...        
-00006cf0: 5265 7475 726e 730a 2020 2020 2020 2020  Returns.        
-00006d00: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00006d10: 6120 526f 6c6c 696e 6720 6f62 6a65 6374  a Rolling object
-00006d20: 206f 6e20 7768 6963 6820 746f 2063 616c   on which to cal
-00006d30: 6c20 6120 6d65 7468 6f64 2074 6f20 636f  l a method to co
-00006d40: 6d70 7574 6520 6120 7374 6174 6973 7469  mpute a statisti
-00006d50: 630a 2020 2020 2020 2020 2222 220a 2020  c.        """.  
-00006d60: 2020 2020 2020 6672 6f6d 2064 6173 6b5f        from dask_
-00006d70: 6578 7072 2e5f 726f 6c6c 696e 6720 696d  expr._rolling im
-00006d80: 706f 7274 2052 6f6c 6c69 6e67 0a0a 2020  port Rolling..  
-00006d90: 2020 2020 2020 7265 7475 726e 2052 6f6c        return Rol
-00006da0: 6c69 6e67 2873 656c 662c 2077 696e 646f  ling(self, windo
-00006db0: 772c 202a 2a6b 7761 7267 7329 0a0a 2020  w, **kwargs)..  
-00006dc0: 2020 4069 6e73 6572 745f 6d65 7461 5f70    @insert_meta_p
-00006dd0: 6172 616d 5f64 6573 6372 6970 7469 6f6e  aram_description
-00006de0: 2870 6164 3d31 3229 0a20 2020 2064 6566  (pad=12).    def
-00006df0: 206d 6170 5f70 6172 7469 7469 6f6e 7328   map_partitions(
-00006e00: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-00006e10: 2020 2020 2020 2066 756e 632c 0a20 2020         func,.   
-00006e20: 2020 2020 202a 6172 6773 2c0a 2020 2020       *args,.    
-00006e30: 2020 2020 6d65 7461 3d6e 6f5f 6465 6661      meta=no_defa
-00006e40: 756c 742c 0a20 2020 2020 2020 2065 6e66  ult,.        enf
-00006e50: 6f72 6365 5f6d 6574 6164 6174 613d 5472  orce_metadata=Tr
-00006e60: 7565 2c0a 2020 2020 2020 2020 7472 616e  ue,.        tran
-00006e70: 7366 6f72 6d5f 6469 7669 7369 6f6e 733d  sform_divisions=
-00006e80: 5472 7565 2c0a 2020 2020 2020 2020 636c  True,.        cl
-00006e90: 6561 725f 6469 7669 7369 6f6e 733d 4661  ear_divisions=Fa
-00006ea0: 6c73 652c 0a20 2020 2020 2020 2061 6c69  lse,.        ali
-00006eb0: 676e 5f64 6174 6166 7261 6d65 733d 4661  gn_dataframes=Fa
-00006ec0: 6c73 652c 0a20 2020 2020 2020 2070 6172  lse,.        par
-00006ed0: 656e 745f 6d65 7461 3d4e 6f6e 652c 0a20  ent_meta=None,. 
-00006ee0: 2020 2020 2020 202a 2a6b 7761 7267 732c         **kwargs,
-00006ef0: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
-00006f00: 2222 2241 7070 6c79 2061 2050 7974 686f  """Apply a Pytho
-00006f10: 6e20 6675 6e63 7469 6f6e 2074 6f20 6561  n function to ea
-00006f20: 6368 2070 6172 7469 7469 6f6e 0a0a 2020  ch partition..  
-00006f30: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
-00006f40: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00006f50: 2d2d 2d0a 2020 2020 2020 2020 6675 6e63  ---.        func
-00006f60: 203a 2066 756e 6374 696f 6e0a 2020 2020   : function.    
-00006f70: 2020 2020 2020 2020 4675 6e63 7469 6f6e          Function
-00006f80: 2061 7070 6c69 6564 2074 6f20 6561 6368   applied to each
-00006f90: 2070 6172 7469 7469 6f6e 2e0a 2020 2020   partition..    
-00006fa0: 2020 2020 6172 6773 2c20 6b77 6172 6773      args, kwargs
-00006fb0: 203a 0a20 2020 2020 2020 2020 2020 2041   :.            A
-00006fc0: 7267 756d 656e 7473 2061 6e64 206b 6579  rguments and key
-00006fd0: 776f 7264 7320 746f 2070 6173 7320 746f  words to pass to
-00006fe0: 2074 6865 2066 756e 6374 696f 6e2e 2041   the function. A
-00006ff0: 7267 756d 656e 7473 2061 6e64 0a20 2020  rguments and.   
-00007000: 2020 2020 2020 2020 206b 6579 776f 7264           keyword
-00007010: 7320 6d61 7920 636f 6e74 6169 6e20 6060  s may contain ``
-00007020: 4672 616d 6542 6173 6560 6020 6f72 2072  FrameBase`` or r
-00007030: 6567 756c 6172 2070 7974 686f 6e20 6f62  egular python ob
-00007040: 6a65 6374 732e 0a20 2020 2020 2020 2020  jects..         
-00007050: 2020 2044 6174 6146 7261 6d65 2d6c 696b     DataFrame-lik
-00007060: 6520 6172 6773 2028 626f 7468 2064 6173  e args (both das
-00007070: 6b20 616e 6420 7061 6e64 6173 2920 6d75  k and pandas) mu
-00007080: 7374 2068 6176 6520 7468 6520 7361 6d65  st have the same
-00007090: 0a20 2020 2020 2020 2020 2020 206e 756d  .            num
-000070a0: 6265 7220 6f66 2070 6172 7469 7469 6f6e  ber of partition
-000070b0: 7320 6173 2060 6073 656c 6660 6020 6f72  s as ``self`` or
-000070c0: 2063 6f6d 7072 6973 6520 6120 7369 6e67   comprise a sing
-000070d0: 6c65 2070 6172 7469 7469 6f6e 2e0a 2020  le partition..  
-000070e0: 2020 2020 2020 2020 2020 4b65 792d 776f            Key-wo
-000070f0: 7264 2061 7267 756d 656e 7473 2c20 5369  rd arguments, Si
-00007100: 6e67 6c65 2d70 6172 7469 7469 6f6e 2061  ngle-partition a
-00007110: 7267 756d 656e 7473 2c20 616e 6420 6765  rguments, and ge
-00007120: 6e65 7261 6c0a 2020 2020 2020 2020 2020  neral.          
-00007130: 2020 7079 7468 6f6e 2d6f 626a 6563 7420    python-object 
-00007140: 6172 6775 6d65 6e74 7320 7769 6c6c 2062  arguments will b
-00007150: 6520 6272 6f61 6463 6173 7465 6420 746f  e broadcasted to
-00007160: 2061 6c6c 2070 6172 7469 7469 6f6e 732e   all partitions.
-00007170: 0a20 2020 2020 2020 2065 6e66 6f72 6365  .        enforce
-00007180: 5f6d 6574 6164 6174 6120 3a20 626f 6f6c  _metadata : bool
-00007190: 2c20 6465 6661 756c 7420 5472 7565 0a20  , default True. 
-000071a0: 2020 2020 2020 2020 2020 2057 6865 7468             Wheth
-000071b0: 6572 2074 6f20 656e 666f 7263 6520 6174  er to enforce at
-000071c0: 2072 756e 7469 6d65 2074 6861 7420 7468   runtime that th
-000071d0: 6520 7374 7275 6374 7572 6520 6f66 2074  e structure of t
-000071e0: 6865 2044 6174 6146 7261 6d65 0a20 2020  he DataFrame.   
-000071f0: 2020 2020 2020 2020 2070 726f 6475 6365           produce
-00007200: 6420 6279 2060 6066 756e 6360 6020 6163  d by ``func`` ac
-00007210: 7475 616c 6c79 206d 6174 6368 6573 2074  tually matches t
-00007220: 6865 2073 7472 7563 7475 7265 206f 6620  he structure of 
-00007230: 6060 6d65 7461 6060 2e0a 2020 2020 2020  ``meta``..      
-00007240: 2020 2020 2020 5468 6973 2077 696c 6c20        This will 
-00007250: 7265 6e61 6d65 2061 6e64 2072 656f 7264  rename and reord
-00007260: 6572 2063 6f6c 756d 6e73 2066 6f72 2065  er columns for e
-00007270: 6163 6820 7061 7274 6974 696f 6e2c 2061  ach partition, a
-00007280: 6e64 2077 696c 6c0a 2020 2020 2020 2020  nd will.        
-00007290: 2020 2020 7261 6973 6520 616e 2065 7272      raise an err
-000072a0: 6f72 2069 6620 7468 6973 2064 6f65 736e  or if this doesn
-000072b0: 2774 2077 6f72 6b2c 2062 7574 2069 7420  't work, but it 
-000072c0: 776f 6e27 7420 7261 6973 6520 6966 2064  won't raise if d
-000072d0: 7479 7065 730a 2020 2020 2020 2020 2020  types.          
-000072e0: 2020 646f 6e27 7420 6d61 7463 682e 0a20    don't match.. 
-000072f0: 2020 2020 2020 2074 7261 6e73 666f 726d         transform
-00007300: 5f64 6976 6973 696f 6e73 203a 2062 6f6f  _divisions : boo
-00007310: 6c2c 2064 6566 6175 6c74 2054 7275 650a  l, default True.
-00007320: 2020 2020 2020 2020 2020 2020 5768 6574              Whet
-00007330: 6865 7220 746f 2061 7070 6c79 2074 6865  her to apply the
-00007340: 2066 756e 6374 696f 6e20 6f6e 746f 2074   function onto t
-00007350: 6865 2064 6976 6973 696f 6e73 2061 6e64  he divisions and
-00007360: 2061 7070 6c79 2074 686f 7365 0a20 2020   apply those.   
-00007370: 2020 2020 2020 2020 2074 7261 6e73 666f           transfo
-00007380: 726d 6564 2064 6976 6973 696f 6e73 2074  rmed divisions t
-00007390: 6f20 7468 6520 6f75 7470 7574 2e0a 2020  o the output..  
-000073a0: 2020 2020 2020 636c 6561 725f 6469 7669        clear_divi
-000073b0: 7369 6f6e 7320 3a20 626f 6f6c 2c20 6465  sions : bool, de
-000073c0: 6661 756c 7420 4661 6c73 650a 2020 2020  fault False.    
-000073d0: 2020 2020 2020 2020 5768 6574 6865 7220          Whether 
-000073e0: 6469 7669 7369 6f6e 7320 7368 6f75 6c64  divisions should
-000073f0: 2062 6520 636c 6561 7265 642e 2049 6620   be cleared. If 
-00007400: 5472 7565 2c20 6074 7261 6e73 666f 726d  True, `transform
-00007410: 5f64 6976 6973 696f 6e73 600a 2020 2020  _divisions`.    
-00007420: 2020 2020 2020 2020 7769 6c6c 2062 6520          will be 
-00007430: 6967 6e6f 7265 642e 0a20 2020 2020 2020  ignored..       
-00007440: 2024 4d45 5441 0a0a 2020 2020 2020 2020   $META..        
-00007450: 4578 616d 706c 6573 0a20 2020 2020 2020  Examples.       
-00007460: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
-00007470: 2020 4769 7665 6e20 6120 4461 7461 4672    Given a DataFr
-00007480: 616d 652c 2053 6572 6965 732c 206f 7220  ame, Series, or 
-00007490: 496e 6465 782c 2073 7563 6820 6173 3a0a  Index, such as:.
-000074a0: 0a20 2020 2020 2020 203e 3e3e 2069 6d70  .        >>> imp
-000074b0: 6f72 7420 7061 6e64 6173 2061 7320 7064  ort pandas as pd
-000074c0: 0a20 2020 2020 2020 203e 3e3e 2069 6d70  .        >>> imp
-000074d0: 6f72 7420 6461 736b 5f65 7870 7220 6173  ort dask_expr as
-000074e0: 2064 640a 2020 2020 2020 2020 3e3e 3e20   dd.        >>> 
-000074f0: 6466 203d 2070 642e 4461 7461 4672 616d  df = pd.DataFram
-00007500: 6528 7b27 7827 3a20 5b31 2c20 322c 2033  e({'x': [1, 2, 3
-00007510: 2c20 342c 2035 5d2c 0a20 2020 2020 2020  , 4, 5],.       
-00007520: 202e 2e2e 2020 2020 2020 2020 2020 2020   ...            
-00007530: 2020 2020 2020 2020 2779 273a 205b 312e          'y': [1.
-00007540: 2c20 322e 2c20 332e 2c20 342e 2c20 352e  , 2., 3., 4., 5.
-00007550: 5d7d 290a 2020 2020 2020 2020 3e3e 3e20  ]}).        >>> 
-00007560: 6464 6620 3d20 6464 2e66 726f 6d5f 7061  ddf = dd.from_pa
-00007570: 6e64 6173 2864 662c 206e 7061 7274 6974  ndas(df, npartit
-00007580: 696f 6e73 3d32 290a 0a20 2020 2020 2020  ions=2)..       
-00007590: 204f 6e65 2063 616e 2075 7365 2060 606d   One can use ``m
-000075a0: 6170 5f70 6172 7469 7469 6f6e 7360 6020  ap_partitions`` 
-000075b0: 746f 2061 7070 6c79 2061 2066 756e 6374  to apply a funct
-000075c0: 696f 6e20 6f6e 2065 6163 6820 7061 7274  ion on each part
-000075d0: 6974 696f 6e2e 0a20 2020 2020 2020 2045  ition..        E
-000075e0: 7874 7261 2061 7267 756d 656e 7473 2061  xtra arguments a
-000075f0: 6e64 206b 6579 776f 7264 7320 6361 6e20  nd keywords can 
-00007600: 6f70 7469 6f6e 616c 6c79 2062 6520 7072  optionally be pr
-00007610: 6f76 6964 6564 2c20 616e 6420 7769 6c6c  ovided, and will
-00007620: 2062 650a 2020 2020 2020 2020 7061 7373   be.        pass
-00007630: 6564 2074 6f20 7468 6520 6675 6e63 7469  ed to the functi
-00007640: 6f6e 2061 6674 6572 2074 6865 2070 6172  on after the par
-00007650: 7469 7469 6f6e 2e0a 0a20 2020 2020 2020  tition...       
-00007660: 2048 6572 6520 7765 2061 7070 6c79 2061   Here we apply a
-00007670: 2066 756e 6374 696f 6e20 7769 7468 2061   function with a
-00007680: 7267 756d 656e 7473 2061 6e64 206b 6579  rguments and key
-00007690: 776f 7264 7320 746f 2061 2044 6174 6146  words to a DataF
-000076a0: 7261 6d65 2c0a 2020 2020 2020 2020 7265  rame,.        re
-000076b0: 7375 6c74 696e 6720 696e 2061 2053 6572  sulting in a Ser
-000076c0: 6965 733a 0a0a 2020 2020 2020 2020 3e3e  ies:..        >>
-000076d0: 3e20 6465 6620 6d79 6164 6428 6466 2c20  > def myadd(df, 
-000076e0: 612c 2062 3d31 293a 0a20 2020 2020 2020  a, b=1):.       
-000076f0: 202e 2e2e 2020 2020 2072 6574 7572 6e20   ...     return 
-00007700: 6466 2e78 202b 2064 662e 7920 2b20 6120  df.x + df.y + a 
-00007710: 2b20 620a 2020 2020 2020 2020 3e3e 3e20  + b.        >>> 
-00007720: 7265 7320 3d20 6464 662e 6d61 705f 7061  res = ddf.map_pa
-00007730: 7274 6974 696f 6e73 286d 7961 6464 2c20  rtitions(myadd, 
-00007740: 312c 2062 3d32 290a 2020 2020 2020 2020  1, b=2).        
-00007750: 3e3e 3e20 7265 732e 6474 7970 650a 2020  >>> res.dtype.  
-00007760: 2020 2020 2020 6474 7970 6528 2766 6c6f        dtype('flo
-00007770: 6174 3634 2729 0a0a 2020 2020 2020 2020  at64')..        
-00007780: 4865 7265 2077 6520 6170 706c 7920 6120  Here we apply a 
-00007790: 6675 6e63 7469 6f6e 2074 6f20 6120 5365  function to a Se
-000077a0: 7269 6573 2072 6573 756c 7469 6e67 2069  ries resulting i
-000077b0: 6e20 6120 5365 7269 6573 3a0a 0a20 2020  n a Series:..   
-000077c0: 2020 2020 203e 3e3e 2072 6573 203d 2064       >>> res = d
-000077d0: 6466 2e78 2e6d 6170 5f70 6172 7469 7469  df.x.map_partiti
-000077e0: 6f6e 7328 6c61 6d62 6461 2078 3a20 6c65  ons(lambda x: le
-000077f0: 6e28 7829 2920 2320 6464 662e 7820 6973  n(x)) # ddf.x is
-00007800: 2061 2044 6173 6b20 5365 7269 6573 2053   a Dask Series S
-00007810: 7472 7563 7475 7265 0a20 2020 2020 2020  tructure.       
-00007820: 203e 3e3e 2072 6573 2e64 7479 7065 0a20   >>> res.dtype. 
-00007830: 2020 2020 2020 2064 7479 7065 2827 696e         dtype('in
-00007840: 7436 3427 290a 0a20 2020 2020 2020 2042  t64')..        B
-00007850: 7920 6465 6661 756c 742c 2064 6173 6b20  y default, dask 
-00007860: 7472 6965 7320 746f 2069 6e66 6572 2074  tries to infer t
-00007870: 6865 206f 7574 7075 7420 6d65 7461 6461  he output metada
-00007880: 7461 2062 7920 7275 6e6e 696e 6720 796f  ta by running yo
-00007890: 7572 0a20 2020 2020 2020 2070 726f 7669  ur.        provi
-000078a0: 6465 6420 6675 6e63 7469 6f6e 206f 6e20  ded function on 
-000078b0: 736f 6d65 2066 616b 6520 6461 7461 2e20  some fake data. 
-000078c0: 5468 6973 2077 6f72 6b73 2077 656c 6c20  This works well 
-000078d0: 696e 206d 616e 7920 6361 7365 732c 2062  in many cases, b
-000078e0: 7574 0a20 2020 2020 2020 2063 616e 2073  ut.        can s
-000078f0: 6f6d 6574 696d 6573 2062 6520 6578 7065  ometimes be expe
-00007900: 6e73 6976 652c 206f 7220 6576 656e 2066  nsive, or even f
-00007910: 6169 6c2e 2054 6f20 6176 6f69 6420 7468  ail. To avoid th
-00007920: 6973 2c20 796f 7520 6361 6e0a 2020 2020  is, you can.    
-00007930: 2020 2020 6d61 6e75 616c 6c79 2073 7065      manually spe
-00007940: 6369 6679 2074 6865 206f 7574 7075 7420  cify the output 
-00007950: 6d65 7461 6461 7461 2077 6974 6820 7468  metadata with th
-00007960: 6520 6060 6d65 7461 6060 206b 6579 776f  e ``meta`` keywo
-00007970: 7264 2e20 5468 6973 0a20 2020 2020 2020  rd. This.       
-00007980: 2063 616e 2062 6520 7370 6563 6966 6965   can be specifie
-00007990: 6420 696e 206d 616e 7920 666f 726d 732c  d in many forms,
-000079a0: 2066 6f72 206d 6f72 6520 696e 666f 726d   for more inform
-000079b0: 6174 696f 6e20 7365 650a 2020 2020 2020  ation see.      
-000079c0: 2020 6060 6461 736b 2e64 6174 6166 7261    ``dask.datafra
-000079d0: 6d65 2e75 7469 6c73 2e6d 616b 655f 6d65  me.utils.make_me
-000079e0: 7461 6060 2e0a 0a20 2020 2020 2020 2048  ta``...        H
-000079f0: 6572 6520 7765 2073 7065 6369 6679 2074  ere we specify t
-00007a00: 6865 206f 7574 7075 7420 6973 2061 2053  he output is a S
-00007a10: 6572 6965 7320 7769 7468 206e 6f20 6e61  eries with no na
-00007a20: 6d65 2c20 616e 6420 6474 7970 650a 2020  me, and dtype.  
-00007a30: 2020 2020 2020 6060 666c 6f61 7436 3460        ``float64`
-00007a40: 603a 0a0a 2020 2020 2020 2020 3e3e 3e20  `:..        >>> 
-00007a50: 7265 7320 3d20 6464 662e 6d61 705f 7061  res = ddf.map_pa
-00007a60: 7274 6974 696f 6e73 286d 7961 6464 2c20  rtitions(myadd, 
-00007a70: 312c 2062 3d32 2c20 6d65 7461 3d28 4e6f  1, b=2, meta=(No
-00007a80: 6e65 2c20 2766 3827 2929 0a0a 2020 2020  ne, 'f8'))..    
-00007a90: 2020 2020 4865 7265 2077 6520 6d61 7020      Here we map 
-00007aa0: 6120 6675 6e63 7469 6f6e 2074 6861 7420  a function that 
-00007ab0: 7461 6b65 7320 696e 2061 2044 6174 6146  takes in a DataF
-00007ac0: 7261 6d65 2c20 616e 6420 7265 7475 726e  rame, and return
-00007ad0: 7320 610a 2020 2020 2020 2020 4461 7461  s a.        Data
-00007ae0: 4672 616d 6520 7769 7468 2061 206e 6577  Frame with a new
-00007af0: 2063 6f6c 756d 6e3a 0a0a 2020 2020 2020   column:..      
-00007b00: 2020 3e3e 3e20 7265 7320 3d20 6464 662e    >>> res = ddf.
-00007b10: 6d61 705f 7061 7274 6974 696f 6e73 286c  map_partitions(l
-00007b20: 616d 6264 6120 6466 3a20 6466 2e61 7373  ambda df: df.ass
-00007b30: 6967 6e28 7a3d 6466 2e78 202a 2064 662e  ign(z=df.x * df.
-00007b40: 7929 290a 2020 2020 2020 2020 3e3e 3e20  y)).        >>> 
-00007b50: 7265 732e 6474 7970 6573 0a20 2020 2020  res.dtypes.     
-00007b60: 2020 2078 2020 2020 2020 696e 7436 340a     x      int64.
-00007b70: 2020 2020 2020 2020 7920 2020 2066 6c6f          y    flo
-00007b80: 6174 3634 0a20 2020 2020 2020 207a 2020  at64.        z  
-00007b90: 2020 666c 6f61 7436 340a 2020 2020 2020    float64.      
-00007ba0: 2020 6474 7970 653a 206f 626a 6563 740a    dtype: object.
-00007bb0: 0a20 2020 2020 2020 2041 7320 6265 666f  .        As befo
-00007bc0: 7265 2c20 7468 6520 6f75 7470 7574 206d  re, the output m
-00007bd0: 6574 6164 6174 6120 6361 6e20 616c 736f  etadata can also
-00007be0: 2062 6520 7370 6563 6966 6965 6420 6d61   be specified ma
-00007bf0: 6e75 616c 6c79 2e20 5468 6973 0a20 2020  nually. This.   
-00007c00: 2020 2020 2074 696d 6520 7765 2070 6173       time we pas
-00007c10: 7320 696e 2061 2060 6064 6963 7460 602c  s in a ``dict``,
-00007c20: 2061 7320 7468 6520 6f75 7470 7574 2069   as the output i
-00007c30: 7320 6120 4461 7461 4672 616d 653a 0a0a  s a DataFrame:..
-00007c40: 2020 2020 2020 2020 3e3e 3e20 7265 7320          >>> res 
-00007c50: 3d20 6464 662e 6d61 705f 7061 7274 6974  = ddf.map_partit
-00007c60: 696f 6e73 286c 616d 6264 6120 6466 3a20  ions(lambda df: 
-00007c70: 6466 2e61 7373 6967 6e28 7a3d 6466 2e78  df.assign(z=df.x
-00007c80: 202a 2064 662e 7929 2c0a 2020 2020 2020   * df.y),.      
-00007c90: 2020 2e2e 2e20 2020 2020 2020 2020 2020    ...           
-00007ca0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-00007cb0: 6574 613d 7b27 7827 3a20 2769 3827 2c20  eta={'x': 'i8', 
-00007cc0: 2779 273a 2027 6638 272c 2027 7a27 3a20  'y': 'f8', 'z': 
-00007cd0: 2766 3827 7d29 0a0a 2020 2020 2020 2020  'f8'})..        
-00007ce0: 496e 2074 6865 2063 6173 6520 7768 6572  In the case wher
-00007cf0: 6520 7468 6520 6d65 7461 6461 7461 2064  e the metadata d
-00007d00: 6f65 736e 2774 2063 6861 6e67 652c 2079  oesn't change, y
-00007d10: 6f75 2063 616e 2061 6c73 6f20 7061 7373  ou can also pass
-00007d20: 2069 6e0a 2020 2020 2020 2020 7468 6520   in.        the 
-00007d30: 6f62 6a65 6374 2069 7473 656c 6620 6469  object itself di
-00007d40: 7265 6374 6c79 3a0a 0a20 2020 2020 2020  rectly:..       
-00007d50: 203e 3e3e 2072 6573 203d 2064 6466 2e6d   >>> res = ddf.m
-00007d60: 6170 5f70 6172 7469 7469 6f6e 7328 6c61  ap_partitions(la
-00007d70: 6d62 6461 2064 663a 2064 662e 6865 6164  mbda df: df.head
-00007d80: 2829 2c20 6d65 7461 3d64 6466 290a 0a20  (), meta=ddf).. 
-00007d90: 2020 2020 2020 2041 6c73 6f20 6e6f 7465         Also note
-00007da0: 2074 6861 7420 7468 6520 696e 6465 7820   that the index 
-00007db0: 616e 6420 6469 7669 7369 6f6e 7320 6172  and divisions ar
-00007dc0: 6520 6173 7375 6d65 6420 746f 2072 656d  e assumed to rem
-00007dd0: 6169 6e20 756e 6368 616e 6765 642e 0a20  ain unchanged.. 
-00007de0: 2020 2020 2020 2049 6620 7468 6520 6675         If the fu
-00007df0: 6e63 7469 6f6e 2079 6f75 2772 6520 6d61  nction you're ma
-00007e00: 7070 696e 6720 6368 616e 6765 7320 7468  pping changes th
-00007e10: 6520 696e 6465 782f 6469 7669 7369 6f6e  e index/division
-00007e20: 732c 2079 6f75 276c 6c20 6e65 6564 0a20  s, you'll need. 
-00007e30: 2020 2020 2020 2074 6f20 7061 7373 2060         to pass `
-00007e40: 6063 6c65 6172 5f64 6976 6973 696f 6e73  `clear_divisions
-00007e50: 3d54 7275 6560 602e 0a0a 2020 2020 2020  =True``...      
-00007e60: 2020 3e3e 3e20 6464 662e 6d61 705f 7061    >>> ddf.map_pa
-00007e70: 7274 6974 696f 6e73 2866 756e 632c 2063  rtitions(func, c
-00007e80: 6c65 6172 5f64 6976 6973 696f 6e73 3d54  lear_divisions=T
-00007e90: 7275 6529 2020 2320 646f 6374 6573 743a  rue)  # doctest:
-00007ea0: 202b 534b 4950 0a0a 2020 2020 2020 2020   +SKIP..        
-00007eb0: 596f 7572 206d 6170 2066 756e 6374 696f  Your map functio
-00007ec0: 6e20 6765 7473 2069 6e66 6f72 6d61 7469  n gets informati
-00007ed0: 6f6e 2061 626f 7574 2077 6865 7265 2069  on about where i
-00007ee0: 7420 6973 2069 6e20 7468 6520 6461 7461  t is in the data
-00007ef0: 6672 616d 6520 6279 0a20 2020 2020 2020  frame by.       
-00007f00: 2061 6363 6570 7469 6e67 2061 2073 7065   accepting a spe
-00007f10: 6369 616c 2060 6070 6172 7469 7469 6f6e  cial ``partition
-00007f20: 5f69 6e66 6f60 6020 6b65 7977 6f72 6420  _info`` keyword 
-00007f30: 6172 6775 6d65 6e74 2e0a 0a20 2020 2020  argument...     
-00007f40: 2020 203e 3e3e 2064 6566 2066 756e 6328     >>> def func(
-00007f50: 7061 7274 6974 696f 6e2c 2070 6172 7469  partition, parti
-00007f60: 7469 6f6e 5f69 6e66 6f3d 4e6f 6e65 293a  tion_info=None):
-00007f70: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
-00007f80: 2070 6173 730a 0a20 2020 2020 2020 2054   pass..        T
-00007f90: 6869 7320 7769 6c6c 2072 6563 6569 7665  his will receive
-00007fa0: 2074 6865 2066 6f6c 6c6f 7769 6e67 2069   the following i
-00007fb0: 6e66 6f72 6d61 7469 6f6e 3a0a 0a20 2020  nformation:..   
-00007fc0: 2020 2020 203e 3e3e 2070 6172 7469 7469       >>> partiti
-00007fd0: 6f6e 5f69 6e66 6f20 2023 2064 6f63 7465  on_info  # docte
-00007fe0: 7374 3a20 2b53 4b49 500a 2020 2020 2020  st: +SKIP.      
-00007ff0: 2020 7b27 6e75 6d62 6572 273a 2031 2c20    {'number': 1, 
-00008000: 2764 6976 6973 696f 6e27 3a20 337d 0a0a  'division': 3}..
-00008010: 2020 2020 2020 2020 466f 7220 6561 6368          For each
-00008020: 2061 7267 756d 656e 7420 616e 6420 6b65   argument and ke
-00008030: 7977 6f72 6420 6172 6775 6d65 6e74 7320  yword arguments 
-00008040: 7468 6174 2061 7265 2064 6173 6b20 6461  that are dask da
-00008050: 7461 6672 616d 6573 2079 6f75 2077 696c  taframes you wil
-00008060: 6c0a 2020 2020 2020 2020 7265 6365 6976  l.        receiv
-00008070: 6520 7468 6520 6e75 6d62 6572 2028 6e29  e the number (n)
-00008080: 2077 6869 6368 2072 6570 7265 7365 6e74   which represent
-00008090: 7320 7468 6520 6e74 6820 7061 7274 6974  s the nth partit
-000080a0: 696f 6e20 6f66 2074 6865 2064 6174 6166  ion of the dataf
-000080b0: 7261 6d65 0a20 2020 2020 2020 2061 6e64  rame.        and
-000080c0: 2074 6865 2064 6976 6973 696f 6e20 2874   the division (t
-000080d0: 6865 2066 6972 7374 2069 6e64 6578 2076  he first index v
-000080e0: 616c 7565 2069 6e20 7468 6520 7061 7274  alue in the part
-000080f0: 6974 696f 6e29 2e20 4966 2064 6976 6973  ition). If divis
-00008100: 696f 6e73 0a20 2020 2020 2020 2061 7265  ions.        are
-00008110: 206e 6f74 206b 6e6f 776e 2028 666f 7220   not known (for 
-00008120: 696e 7374 616e 6365 2069 6620 7468 6520  instance if the 
-00008130: 696e 6465 7820 6973 206e 6f74 2073 6f72  index is not sor
-00008140: 7465 6429 2074 6865 6e20 796f 7520 7769  ted) then you wi
-00008150: 6c6c 2067 6574 0a20 2020 2020 2020 204e  ll get.        N
-00008160: 6f6e 6520 6173 2074 6865 2064 6976 6973  one as the divis
-00008170: 696f 6e2e 0a20 2020 2020 2020 2022 2222  ion..        """
-00008180: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00008190: 6d61 705f 7061 7274 6974 696f 6e73 280a  map_partitions(.
-000081a0: 2020 2020 2020 2020 2020 2020 6675 6e63              func
-000081b0: 2c0a 2020 2020 2020 2020 2020 2020 7365  ,.            se
-000081c0: 6c66 2c0a 2020 2020 2020 2020 2020 2020  lf,.            
-000081d0: 2a61 7267 732c 0a20 2020 2020 2020 2020  *args,.         
-000081e0: 2020 206d 6574 613d 6d65 7461 2c0a 2020     meta=meta,.  
-000081f0: 2020 2020 2020 2020 2020 656e 666f 7263            enforc
-00008200: 655f 6d65 7461 6461 7461 3d65 6e66 6f72  e_metadata=enfor
-00008210: 6365 5f6d 6574 6164 6174 612c 0a20 2020  ce_metadata,.   
-00008220: 2020 2020 2020 2020 2074 7261 6e73 666f           transfo
-00008230: 726d 5f64 6976 6973 696f 6e73 3d74 7261  rm_divisions=tra
-00008240: 6e73 666f 726d 5f64 6976 6973 696f 6e73  nsform_divisions
-00008250: 2c0a 2020 2020 2020 2020 2020 2020 636c  ,.            cl
-00008260: 6561 725f 6469 7669 7369 6f6e 733d 636c  ear_divisions=cl
-00008270: 6561 725f 6469 7669 7369 6f6e 732c 0a20  ear_divisions,. 
-00008280: 2020 2020 2020 2020 2020 2061 6c69 676e             align
-00008290: 5f64 6174 6166 7261 6d65 733d 616c 6967  _dataframes=alig
-000082a0: 6e5f 6461 7461 6672 616d 6573 2c0a 2020  n_dataframes,.  
-000082b0: 2020 2020 2020 2020 2020 7061 7265 6e74            parent
-000082c0: 5f6d 6574 613d 7061 7265 6e74 5f6d 6574  _meta=parent_met
-000082d0: 612c 0a20 2020 2020 2020 2020 2020 202a  a,.            *
-000082e0: 2a6b 7761 7267 732c 0a20 2020 2020 2020  *kwargs,.       
-000082f0: 2029 0a0a 2020 2020 4069 6e73 6572 745f   )..    @insert_
-00008300: 6d65 7461 5f70 6172 616d 5f64 6573 6372  meta_param_descr
-00008310: 6970 7469 6f6e 2870 6164 3d31 3229 0a20  iption(pad=12). 
-00008320: 2020 2064 6566 206d 6170 5f6f 7665 726c     def map_overl
-00008330: 6170 280a 2020 2020 2020 2020 7365 6c66  ap(.        self
-00008340: 2c0a 2020 2020 2020 2020 6675 6e63 2c0a  ,.        func,.
-00008350: 2020 2020 2020 2020 6265 666f 7265 2c0a          before,.
-00008360: 2020 2020 2020 2020 6166 7465 722c 0a20          after,. 
-00008370: 2020 2020 2020 202a 6172 6773 2c0a 2020         *args,.  
-00008380: 2020 2020 2020 6d65 7461 3d6e 6f5f 6465        meta=no_de
-00008390: 6661 756c 742c 0a20 2020 2020 2020 2065  fault,.        e
-000083a0: 6e66 6f72 6365 5f6d 6574 6164 6174 613d  nforce_metadata=
-000083b0: 5472 7565 2c0a 2020 2020 2020 2020 7472  True,.        tr
-000083c0: 616e 7366 6f72 6d5f 6469 7669 7369 6f6e  ansform_division
-000083d0: 733d 5472 7565 2c0a 2020 2020 2020 2020  s=True,.        
-000083e0: 636c 6561 725f 6469 7669 7369 6f6e 733d  clear_divisions=
-000083f0: 4661 6c73 652c 0a20 2020 2020 2020 2061  False,.        a
-00008400: 6c69 676e 5f64 6174 6166 7261 6d65 733d  lign_dataframes=
-00008410: 4661 6c73 652c 0a20 2020 2020 2020 202a  False,.        *
-00008420: 2a6b 7761 7267 732c 0a20 2020 2029 3a0a  *kwargs,.    ):.
-00008430: 2020 2020 2020 2020 2222 2241 7070 6c79          """Apply
-00008440: 2061 2066 756e 6374 696f 6e20 746f 2065   a function to e
-00008450: 6163 6820 7061 7274 6974 696f 6e2c 2073  ach partition, s
-00008460: 6861 7269 6e67 2072 6f77 7320 7769 7468  haring rows with
-00008470: 2061 646a 6163 656e 7420 7061 7274 6974   adjacent partit
-00008480: 696f 6e73 2e0a 0a20 2020 2020 2020 2054  ions...        T
-00008490: 6869 7320 6361 6e20 6265 2075 7365 6675  his can be usefu
-000084a0: 6c20 666f 7220 696d 706c 656d 656e 7469  l for implementi
-000084b0: 6e67 2077 696e 646f 7769 6e67 2066 756e  ng windowing fun
-000084c0: 6374 696f 6e73 2073 7563 6820 6173 0a20  ctions such as. 
-000084d0: 2020 2020 2020 2060 6064 662e 726f 6c6c         ``df.roll
-000084e0: 696e 6728 2e2e 2e29 2e6d 6561 6e28 2960  ing(...).mean()`
-000084f0: 6020 6f72 2060 6064 662e 6469 6666 2829  ` or ``df.diff()
-00008500: 6060 2e0a 0a20 2020 2020 2020 2050 6172  ``...        Par
-00008510: 616d 6574 6572 730a 2020 2020 2020 2020  ameters.        
-00008520: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-00008530: 2020 2066 756e 6320 3a20 6675 6e63 7469     func : functi
-00008540: 6f6e 0a20 2020 2020 2020 2020 2020 2046  on.            F
-00008550: 756e 6374 696f 6e20 6170 706c 6965 6420  unction applied 
-00008560: 746f 2065 6163 6820 7061 7274 6974 696f  to each partitio
-00008570: 6e2e 0a20 2020 2020 2020 2062 6566 6f72  n..        befor
-00008580: 6520 3a20 696e 742c 2074 696d 6564 656c  e : int, timedel
-00008590: 7461 206f 7220 7374 7269 6e67 2074 696d  ta or string tim
-000085a0: 6564 656c 7461 0a20 2020 2020 2020 2020  edelta.         
-000085b0: 2020 2054 6865 2072 6f77 7320 746f 2070     The rows to p
-000085c0: 7265 7065 6e64 2074 6f20 7061 7274 6974  repend to partit
-000085d0: 696f 6e20 6060 6960 6020 6672 6f6d 2074  ion ``i`` from t
-000085e0: 6865 2065 6e64 206f 660a 2020 2020 2020  he end of.      
-000085f0: 2020 2020 2020 7061 7274 6974 696f 6e20        partition 
-00008600: 6060 6920 2d20 3160 602e 0a20 2020 2020  ``i - 1``..     
-00008610: 2020 2061 6674 6572 203a 2069 6e74 2c20     after : int, 
-00008620: 7469 6d65 6465 6c74 6120 6f72 2073 7472  timedelta or str
-00008630: 696e 6720 7469 6d65 6465 6c74 610a 2020  ing timedelta.  
-00008640: 2020 2020 2020 2020 2020 5468 6520 726f            The ro
-00008650: 7773 2074 6f20 6170 7065 6e64 2074 6f20  ws to append to 
-00008660: 7061 7274 6974 696f 6e20 6060 6960 6020  partition ``i`` 
-00008670: 6672 6f6d 2074 6865 2062 6567 696e 6e69  from the beginni
-00008680: 6e67 0a20 2020 2020 2020 2020 2020 206f  ng.            o
-00008690: 6620 7061 7274 6974 696f 6e20 6060 6920  f partition ``i 
-000086a0: 2b20 3160 602e 0a20 2020 2020 2020 2061  + 1``..        a
-000086b0: 7267 732c 206b 7761 7267 7320 3a0a 2020  rgs, kwargs :.  
-000086c0: 2020 2020 2020 2020 2020 506f 7369 7469            Positi
-000086d0: 6f6e 616c 2061 6e64 206b 6579 776f 7264  onal and keyword
-000086e0: 2061 7267 756d 656e 7473 2074 6f20 7061   arguments to pa
-000086f0: 7373 2074 6f20 7468 6520 6675 6e63 7469  ss to the functi
-00008700: 6f6e 2e0a 2020 2020 2020 2020 2020 2020  on..            
-00008710: 506f 7369 7469 6f6e 616c 2061 7267 756d  Positional argum
-00008720: 656e 7473 2061 7265 2063 6f6d 7075 7465  ents are compute
-00008730: 6420 6f6e 2061 2070 6572 2d70 6172 7469  d on a per-parti
-00008740: 7469 6f6e 2062 6173 6973 2c20 7768 696c  tion basis, whil
-00008750: 650a 2020 2020 2020 2020 2020 2020 6b65  e.            ke
-00008760: 7977 6f72 6420 6172 6775 6d65 6e74 7320  yword arguments 
-00008770: 6172 6520 7368 6172 6564 2061 6372 6f73  are shared acros
-00008780: 7320 616c 6c20 7061 7274 6974 696f 6e73  s all partitions
-00008790: 2e20 5468 6520 7061 7274 6974 696f 6e0a  . The partition.
-000087a0: 2020 2020 2020 2020 2020 2020 6974 7365              itse
-000087b0: 6c66 2077 696c 6c20 6265 2074 6865 2066  lf will be the f
-000087c0: 6972 7374 2070 6f73 6974 696f 6e61 6c20  irst positional 
-000087d0: 6172 6775 6d65 6e74 2c20 7769 7468 2061  argument, with a
-000087e0: 6c6c 206f 7468 6572 0a20 2020 2020 2020  ll other.       
-000087f0: 2020 2020 2061 7267 756d 656e 7473 2070       arguments p
-00008800: 6173 7365 6420 2a61 6674 6572 2a2e 2041  assed *after*. A
-00008810: 7267 756d 656e 7473 2063 616e 2062 6520  rguments can be 
-00008820: 6060 5363 616c 6172 6060 2c20 6060 4465  ``Scalar``, ``De
-00008830: 6c61 7965 6460 602c 0a20 2020 2020 2020  layed``,.       
-00008840: 2020 2020 206f 7220 7265 6775 6c61 7220       or regular 
-00008850: 5079 7468 6f6e 206f 626a 6563 7473 2e20  Python objects. 
-00008860: 4461 7461 4672 616d 652d 6c69 6b65 2061  DataFrame-like a
-00008870: 7267 7320 2862 6f74 6820 6461 736b 2061  rgs (both dask a
-00008880: 6e64 0a20 2020 2020 2020 2020 2020 2070  nd.            p
-00008890: 616e 6461 7329 2077 696c 6c20 6265 2072  andas) will be r
-000088a0: 6570 6172 7469 7469 6f6e 6564 2074 6f20  epartitioned to 
-000088b0: 616c 6967 6e20 2869 6620 6e65 6365 7373  align (if necess
-000088c0: 6172 7929 2062 6566 6f72 650a 2020 2020  ary) before.    
-000088d0: 2020 2020 2020 2020 6170 706c 7969 6e67          applying
-000088e0: 2074 6865 2066 756e 6374 696f 6e3b 2073   the function; s
-000088f0: 6565 2060 6061 6c69 676e 5f64 6174 6166  ee ``align_dataf
-00008900: 7261 6d65 7360 6020 746f 2063 6f6e 7472  rames`` to contr
-00008910: 6f6c 2074 6869 730a 2020 2020 2020 2020  ol this.        
-00008920: 2020 2020 6265 6861 7669 6f72 2e0a 2020      behavior..  
-00008930: 2020 2020 2020 656e 666f 7263 655f 6d65        enforce_me
-00008940: 7461 6461 7461 203a 2062 6f6f 6c2c 2064  tadata : bool, d
-00008950: 6566 6175 6c74 2054 7275 650a 2020 2020  efault True.    
-00008960: 2020 2020 2020 2020 5768 6574 6865 7220          Whether 
-00008970: 746f 2065 6e66 6f72 6365 2061 7420 7275  to enforce at ru
-00008980: 6e74 696d 6520 7468 6174 2074 6865 2073  ntime that the s
-00008990: 7472 7563 7475 7265 206f 6620 7468 6520  tructure of the 
-000089a0: 4461 7461 4672 616d 650a 2020 2020 2020  DataFrame.      
-000089b0: 2020 2020 2020 7072 6f64 7563 6564 2062        produced b
-000089c0: 7920 6060 6675 6e63 6060 2061 6374 7561  y ``func`` actua
-000089d0: 6c6c 7920 6d61 7463 6865 7320 7468 6520  lly matches the 
-000089e0: 7374 7275 6374 7572 6520 6f66 2060 606d  structure of ``m
-000089f0: 6574 6160 602e 0a20 2020 2020 2020 2020  eta``..         
-00008a00: 2020 2054 6869 7320 7769 6c6c 2072 656e     This will ren
-00008a10: 616d 6520 616e 6420 7265 6f72 6465 7220  ame and reorder 
-00008a20: 636f 6c75 6d6e 7320 666f 7220 6561 6368  columns for each
-00008a30: 2070 6172 7469 7469 6f6e 2c0a 2020 2020   partition,.    
-00008a40: 2020 2020 2020 2020 616e 6420 7769 6c6c          and will
-00008a50: 2072 6169 7365 2061 6e20 6572 726f 7220   raise an error 
-00008a60: 6966 2074 6869 7320 646f 6573 6e27 7420  if this doesn't 
-00008a70: 776f 726b 2c0a 2020 2020 2020 2020 2020  work,.          
-00008a80: 2020 6275 7420 6974 2077 6f6e 2774 2072    but it won't r
-00008a90: 6169 7365 2069 6620 6474 7970 6573 2064  aise if dtypes d
-00008aa0: 6f6e 2774 206d 6174 6368 2e0a 2020 2020  on't match..    
-00008ab0: 2020 2020 7472 616e 7366 6f72 6d5f 6469      transform_di
-00008ac0: 7669 7369 6f6e 7320 3a20 626f 6f6c 2c20  visions : bool, 
-00008ad0: 6465 6661 756c 7420 5472 7565 0a20 2020  default True.   
-00008ae0: 2020 2020 2020 2020 2057 6865 7468 6572           Whether
-00008af0: 2074 6f20 6170 706c 7920 7468 6520 6675   to apply the fu
-00008b00: 6e63 7469 6f6e 206f 6e74 6f20 7468 6520  nction onto the 
-00008b10: 6469 7669 7369 6f6e 7320 616e 6420 6170  divisions and ap
-00008b20: 706c 7920 7468 6f73 650a 2020 2020 2020  ply those.      
-00008b30: 2020 2020 2020 7472 616e 7366 6f72 6d65        transforme
-00008b40: 6420 6469 7669 7369 6f6e 7320 746f 2074  d divisions to t
-00008b50: 6865 206f 7574 7075 742e 0a20 2020 2020  he output..     
-00008b60: 2020 2061 6c69 676e 5f64 6174 6166 7261     align_datafra
-00008b70: 6d65 7320 3a20 626f 6f6c 2c20 6465 6661  mes : bool, defa
-00008b80: 756c 7420 5472 7565 0a20 2020 2020 2020  ult True.       
-00008b90: 2020 2020 2057 6865 7468 6572 2074 6f20       Whether to 
-00008ba0: 7265 7061 7274 6974 696f 6e20 4461 7461  repartition Data
-00008bb0: 4672 616d 652d 206f 7220 5365 7269 6573  Frame- or Series
-00008bc0: 2d6c 696b 6520 6172 6773 0a20 2020 2020  -like args.     
-00008bd0: 2020 2020 2020 2028 626f 7468 2064 6173         (both das
-00008be0: 6b20 616e 6420 7061 6e64 6173 2920 736f  k and pandas) so
-00008bf0: 2074 6865 6972 2064 6976 6973 696f 6e73   their divisions
-00008c00: 2061 6c69 676e 2062 6566 6f72 6520 6170   align before ap
-00008c10: 706c 7969 6e67 0a20 2020 2020 2020 2020  plying.         
-00008c20: 2020 2074 6865 2066 756e 6374 696f 6e2e     the function.
-00008c30: 2054 6869 7320 7265 7175 6972 6573 2061   This requires a
-00008c40: 6c6c 2069 6e70 7574 7320 746f 2068 6176  ll inputs to hav
-00008c50: 6520 6b6e 6f77 6e20 6469 7669 7369 6f6e  e known division
-00008c60: 732e 0a20 2020 2020 2020 2020 2020 2053  s..            S
-00008c70: 696e 676c 652d 7061 7274 6974 696f 6e20  ingle-partition 
-00008c80: 696e 7075 7473 2077 696c 6c20 6265 2073  inputs will be s
-00008c90: 706c 6974 2069 6e74 6f20 6d75 6c74 6970  plit into multip
-00008ca0: 6c65 2070 6172 7469 7469 6f6e 732e 0a0a  le partitions...
-00008cb0: 2020 2020 2020 2020 2020 2020 4966 2046              If F
-00008cc0: 616c 7365 2c20 616c 6c20 696e 7075 7473  alse, all inputs
-00008cd0: 206d 7573 7420 6861 7665 2065 6974 6865   must have eithe
-00008ce0: 7220 7468 6520 7361 6d65 206e 756d 6265  r the same numbe
-00008cf0: 7220 6f66 2070 6172 7469 7469 6f6e 730a  r of partitions.
-00008d00: 2020 2020 2020 2020 2020 2020 6f72 2061              or a
-00008d10: 2073 696e 676c 6520 7061 7274 6974 696f   single partitio
-00008d20: 6e2e 2053 696e 676c 652d 7061 7274 6974  n. Single-partit
-00008d30: 696f 6e20 696e 7075 7473 2077 696c 6c20  ion inputs will 
-00008d40: 6265 2062 726f 6164 6361 7374 2074 6f0a  be broadcast to.
-00008d50: 2020 2020 2020 2020 2020 2020 6576 6572              ever
-00008d60: 7920 7061 7274 6974 696f 6e20 6f66 206d  y partition of m
-00008d70: 756c 7469 2d70 6172 7469 7469 6f6e 2069  ulti-partition i
-00008d80: 6e70 7574 732e 0a20 2020 2020 2020 2024  nputs..        $
-00008d90: 4d45 5441 0a0a 2020 2020 2020 2020 4e6f  META..        No
-00008da0: 7465 730a 2020 2020 2020 2020 2d2d 2d2d  tes.        ----
-00008db0: 2d0a 2020 2020 2020 2020 4769 7665 6e20  -.        Given 
-00008dc0: 706f 7369 7469 7665 2069 6e74 6567 6572  positive integer
-00008dd0: 7320 6060 6265 666f 7265 6060 2061 6e64  s ``before`` and
-00008de0: 2060 6061 6674 6572 6060 2c20 616e 6420   ``after``, and 
-00008df0: 6120 6675 6e63 7469 6f6e 0a20 2020 2020  a function.     
-00008e00: 2020 2060 6066 756e 6360 602c 2060 606d     ``func``, ``m
-00008e10: 6170 5f6f 7665 726c 6170 6060 2064 6f65  ap_overlap`` doe
-00008e20: 7320 7468 6520 666f 6c6c 6f77 696e 673a  s the following:
-00008e30: 0a0a 2020 2020 2020 2020 312e 2050 7265  ..        1. Pre
-00008e40: 7065 6e64 2060 6062 6566 6f72 6560 6020  pend ``before`` 
-00008e50: 726f 7773 2074 6f20 6561 6368 2070 6172  rows to each par
-00008e60: 7469 7469 6f6e 2060 6069 6060 2066 726f  tition ``i`` fro
-00008e70: 6d20 7468 6520 656e 6420 6f66 0a20 2020  m the end of.   
-00008e80: 2020 2020 2020 2020 7061 7274 6974 696f          partitio
-00008e90: 6e20 6060 6920 2d20 3160 602e 2054 6865  n ``i - 1``. The
-00008ea0: 2066 6972 7374 2070 6172 7469 7469 6f6e   first partition
-00008eb0: 2068 6173 206e 6f20 726f 7773 2070 7265   has no rows pre
-00008ec0: 7065 6e64 6564 2e0a 0a20 2020 2020 2020  pended...       
-00008ed0: 2032 2e20 4170 7065 6e64 2060 6061 6674   2. Append ``aft
-00008ee0: 6572 6060 2072 6f77 7320 746f 2065 6163  er`` rows to eac
-00008ef0: 6820 7061 7274 6974 696f 6e20 6060 6960  h partition ``i`
-00008f00: 6020 6672 6f6d 2074 6865 2062 6567 696e  ` from the begin
-00008f10: 6e69 6e67 206f 660a 2020 2020 2020 2020  ning of.        
-00008f20: 2020 2070 6172 7469 7469 6f6e 2060 6069     partition ``i
-00008f30: 202b 2031 6060 2e20 5468 6520 6c61 7374   + 1``. The last
-00008f40: 2070 6172 7469 7469 6f6e 2068 6173 206e   partition has n
-00008f50: 6f20 726f 7773 2061 7070 656e 6465 642e  o rows appended.
-00008f60: 0a0a 2020 2020 2020 2020 332e 2041 7070  ..        3. App
-00008f70: 6c79 2060 6066 756e 6360 6020 746f 2065  ly ``func`` to e
-00008f80: 6163 6820 7061 7274 6974 696f 6e2c 2070  ach partition, p
-00008f90: 6173 7369 6e67 2069 6e20 616e 7920 6578  assing in any ex
-00008fa0: 7472 6120 6060 6172 6773 6060 2061 6e64  tra ``args`` and
-00008fb0: 0a20 2020 2020 2020 2020 2020 6060 6b77  .           ``kw
-00008fc0: 6172 6773 6060 2069 6620 7072 6f76 6964  args`` if provid
-00008fd0: 6564 2e0a 0a20 2020 2020 2020 2034 2e20  ed...        4. 
-00008fe0: 5472 696d 2060 6062 6566 6f72 6560 6020  Trim ``before`` 
-00008ff0: 726f 7773 2066 726f 6d20 7468 6520 6265  rows from the be
-00009000: 6769 6e6e 696e 6720 6f66 2061 6c6c 2062  ginning of all b
-00009010: 7574 2074 6865 2066 6972 7374 0a20 2020  ut the first.   
-00009020: 2020 2020 2020 2020 7061 7274 6974 696f          partitio
-00009030: 6e2e 0a0a 2020 2020 2020 2020 352e 2054  n...        5. T
-00009040: 7269 6d20 6060 6166 7465 7260 6020 726f  rim ``after`` ro
-00009050: 7773 2066 726f 6d20 7468 6520 656e 6420  ws from the end 
-00009060: 6f66 2061 6c6c 2062 7574 2074 6865 206c  of all but the l
-00009070: 6173 7420 7061 7274 6974 696f 6e2e 0a0a  ast partition...
-00009080: 2020 2020 2020 2020 4578 616d 706c 6573          Examples
-00009090: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-000090a0: 2d0a 2020 2020 2020 2020 4769 7665 6e20  -.        Given 
-000090b0: 6120 4461 7461 4672 616d 652c 2053 6572  a DataFrame, Ser
-000090c0: 6965 732c 206f 7220 496e 6465 782c 2073  ies, or Index, s
-000090d0: 7563 6820 6173 3a0a 0a20 2020 2020 2020  uch as:..       
-000090e0: 203e 3e3e 2069 6d70 6f72 7420 7061 6e64   >>> import pand
-000090f0: 6173 2061 7320 7064 0a20 2020 2020 2020  as as pd.       
-00009100: 203e 3e3e 2069 6d70 6f72 7420 6461 736b   >>> import dask
-00009110: 5f65 7870 7220 6173 2064 640a 2020 2020  _expr as dd.    
-00009120: 2020 2020 3e3e 3e20 6466 203d 2070 642e      >>> df = pd.
-00009130: 4461 7461 4672 616d 6528 7b27 7827 3a20  DataFrame({'x': 
-00009140: 5b31 2c20 322c 2034 2c20 372c 2031 315d  [1, 2, 4, 7, 11]
-00009150: 2c0a 2020 2020 2020 2020 2e2e 2e20 2020  ,.        ...   
+00006670: 2020 2020 6622 7032 7020 7265 7175 6972      f"p2p requir
+00006680: 6573 2061 6c6c 2063 6f6c 756d 6e20 6e61  es all column na
+00006690: 6d65 7320 746f 2062 6520 7374 722c 2066  mes to be str, f
+000066a0: 6f75 6e64 3a20 7b75 6e73 7570 706f 7274  ound: {unsupport
+000066b0: 6564 7d22 2c0a 2020 2020 2020 2020 2020  ed}",.          
+000066c0: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+000066d0: 2023 2052 6574 7572 6e65 6420 7368 7566   # Returned shuf
+000066e0: 666c 6564 2072 6573 756c 740a 2020 2020  fled result.    
+000066f0: 2020 2020 7265 7475 726e 206e 6577 5f63      return new_c
+00006700: 6f6c 6c65 6374 696f 6e28 0a20 2020 2020  ollection(.     
+00006710: 2020 2020 2020 2052 6561 7272 616e 6765         Rearrange
+00006720: 4279 436f 6c75 6d6e 280a 2020 2020 2020  ByColumn(.      
+00006730: 2020 2020 2020 2020 2020 7365 6c66 2c0a            self,.
+00006740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006750: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
+00006760: 2020 2020 6e70 6172 7469 7469 6f6e 732c      npartitions,
+00006770: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00006780: 2069 676e 6f72 655f 696e 6465 782c 0a20   ignore_index,. 
+00006790: 2020 2020 2020 2020 2020 2020 2020 2067                 g
+000067a0: 6574 5f73 7065 6369 6669 6564 5f73 6875  et_specified_shu
+000067b0: 6666 6c65 2873 6875 6666 6c65 5f6d 6574  ffle(shuffle_met
+000067c0: 686f 6429 2c0a 2020 2020 2020 2020 2020  hod),.          
+000067d0: 2020 2020 2020 6f70 7469 6f6e 732c 0a20        options,. 
+000067e0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+000067f0: 6e64 6578 5f73 6875 6666 6c65 3d6f 6e5f  ndex_shuffle=on_
+00006800: 696e 6465 782c 0a20 2020 2020 2020 2020  index,.         
+00006810: 2020 2029 0a20 2020 2020 2020 2029 0a0a     ).        )..
+00006820: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
+00006830: 6d28 7064 2e44 6174 6146 7261 6d65 290a  m(pd.DataFrame).
+00006840: 2020 2020 6465 6620 7265 7361 6d70 6c65      def resample
+00006850: 2873 656c 662c 2072 756c 652c 2063 6c6f  (self, rule, clo
+00006860: 7365 643d 4e6f 6e65 2c20 6c61 6265 6c3d  sed=None, label=
+00006870: 4e6f 6e65 293a 0a20 2020 2020 2020 2066  None):.        f
+00006880: 726f 6d20 6461 736b 5f65 7870 722e 5f72  rom dask_expr._r
+00006890: 6573 616d 706c 6520 696d 706f 7274 2052  esample import R
+000068a0: 6573 616d 706c 6572 0a0a 2020 2020 2020  esampler..      
+000068b0: 2020 7265 7475 726e 2052 6573 616d 706c    return Resampl
+000068c0: 6572 2873 656c 662c 2072 756c 652c 202a  er(self, rule, *
+000068d0: 2a7b 2263 6c6f 7365 6422 3a20 636c 6f73  *{"closed": clos
+000068e0: 6564 2c20 226c 6162 656c 223a 206c 6162  ed, "label": lab
+000068f0: 656c 7d29 0a0a 2020 2020 6465 6620 726f  el})..    def ro
+00006900: 6c6c 696e 6728 7365 6c66 2c20 7769 6e64  lling(self, wind
+00006910: 6f77 2c20 2a2a 6b77 6172 6773 293a 0a20  ow, **kwargs):. 
+00006920: 2020 2020 2020 2022 2222 5072 6f76 6964         """Provid
+00006930: 6573 2072 6f6c 6c69 6e67 2074 7261 6e73  es rolling trans
+00006940: 666f 726d 6174 696f 6e73 2e0a 0a20 2020  formations...   
+00006950: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
+00006960: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00006970: 2d2d 0a20 2020 2020 2020 2077 696e 646f  --.        windo
+00006980: 7720 3a20 696e 742c 2073 7472 2c20 6f66  w : int, str, of
+00006990: 6673 6574 0a20 2020 2020 2020 2020 2020  fset.           
+000069a0: 5369 7a65 206f 6620 7468 6520 6d6f 7669  Size of the movi
+000069b0: 6e67 2077 696e 646f 772e 2054 6869 7320  ng window. This 
+000069c0: 6973 2074 6865 206e 756d 6265 7220 6f66  is the number of
+000069d0: 206f 6273 6572 7661 7469 6f6e 7320 7573   observations us
+000069e0: 6564 0a20 2020 2020 2020 2020 2020 666f  ed.           fo
+000069f0: 7220 6361 6c63 756c 6174 696e 6720 7468  r calculating th
+00006a00: 6520 7374 6174 6973 7469 632e 2057 6865  e statistic. Whe
+00006a10: 6e20 6e6f 7420 7573 696e 6720 6120 6060  n not using a ``
+00006a20: 4461 7465 7469 6d65 496e 6465 7860 602c  DatetimeIndex``,
+00006a30: 0a20 2020 2020 2020 2020 2020 7468 6520  .           the 
+00006a40: 7769 6e64 6f77 2073 697a 6520 6d75 7374  window size must
+00006a50: 206e 6f74 2062 6520 736f 206c 6172 6765   not be so large
+00006a60: 2061 7320 746f 2073 7061 6e20 6d6f 7265   as to span more
+00006a70: 2074 6861 6e20 6f6e 650a 2020 2020 2020   than one.      
+00006a80: 2020 2020 2061 646a 6163 656e 7420 7061       adjacent pa
+00006a90: 7274 6974 696f 6e2e 2049 6620 7573 696e  rtition. If usin
+00006aa0: 6720 616e 206f 6666 7365 7420 6f72 206f  g an offset or o
+00006ab0: 6666 7365 7420 616c 6961 7320 6c69 6b65  ffset alias like
+00006ac0: 2027 3544 272c 0a20 2020 2020 2020 2020   '5D',.         
+00006ad0: 2020 7468 6520 6461 7461 206d 7573 7420    the data must 
+00006ae0: 6861 7665 2061 2060 6044 6174 6574 696d  have a ``Datetim
+00006af0: 6549 6e64 6578 6060 0a20 2020 2020 2020  eIndex``.       
+00006b00: 206d 696e 5f70 6572 696f 6473 203a 2069   min_periods : i
+00006b10: 6e74 2c20 6465 6661 756c 7420 4e6f 6e65  nt, default None
+00006b20: 0a20 2020 2020 2020 2020 2020 204d 696e  .            Min
+00006b30: 696d 756d 206e 756d 6265 7220 6f66 206f  imum number of o
+00006b40: 6273 6572 7661 7469 6f6e 7320 696e 2077  bservations in w
+00006b50: 696e 646f 7720 7265 7175 6972 6564 2074  indow required t
+00006b60: 6f20 6861 7665 2061 2076 616c 7565 0a20  o have a value. 
+00006b70: 2020 2020 2020 2020 2020 2028 6f74 6865             (othe
+00006b80: 7277 6973 6520 7265 7375 6c74 2069 7320  rwise result is 
+00006b90: 4e41 292e 0a20 2020 2020 2020 2063 656e  NA)..        cen
+00006ba0: 7465 7220 3a20 626f 6f6c 6561 6e2c 2064  ter : boolean, d
+00006bb0: 6566 6175 6c74 2046 616c 7365 0a20 2020  efault False.   
+00006bc0: 2020 2020 2020 2020 2053 6574 2074 6865           Set the
+00006bd0: 206c 6162 656c 7320 6174 2074 6865 2063   labels at the c
+00006be0: 656e 7465 7220 6f66 2074 6865 2077 696e  enter of the win
+00006bf0: 646f 772e 0a20 2020 2020 2020 2077 696e  dow..        win
+00006c00: 5f74 7970 6520 3a20 7374 7269 6e67 2c20  _type : string, 
+00006c10: 6465 6661 756c 7420 4e6f 6e65 0a20 2020  default None.   
+00006c20: 2020 2020 2020 2020 2050 726f 7669 6465           Provide
+00006c30: 2061 2077 696e 646f 7720 7479 7065 2e20   a window type. 
+00006c40: 5468 6520 7265 636f 676e 697a 6564 2077  The recognized w
+00006c50: 696e 646f 7720 7479 7065 7320 6172 6520  indow types are 
+00006c60: 6964 656e 7469 6361 6c0a 2020 2020 2020  identical.      
+00006c70: 2020 2020 2020 746f 2070 616e 6461 732e        to pandas.
+00006c80: 0a20 2020 2020 2020 2061 7869 7320 3a20  .        axis : 
+00006c90: 696e 742c 2073 7472 2c20 4e6f 6e65 2c20  int, str, None, 
+00006ca0: 6465 6661 756c 7420 300a 2020 2020 2020  default 0.      
+00006cb0: 2020 2020 2020 5468 6973 2070 6172 616d        This param
+00006cc0: 6574 6572 2069 7320 6465 7072 6563 6174  eter is deprecat
+00006cd0: 6564 2077 6974 6820 6060 7061 6e64 6173  ed with ``pandas
+00006ce0: 3e3d 322e 3160 602e 0a0a 2020 2020 2020  >=2.1``...      
+00006cf0: 2020 5265 7475 726e 730a 2020 2020 2020    Returns.      
+00006d00: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 2020    -------.      
+00006d10: 2020 6120 526f 6c6c 696e 6720 6f62 6a65    a Rolling obje
+00006d20: 6374 206f 6e20 7768 6963 6820 746f 2063  ct on which to c
+00006d30: 616c 6c20 6120 6d65 7468 6f64 2074 6f20  all a method to 
+00006d40: 636f 6d70 7574 6520 6120 7374 6174 6973  compute a statis
+00006d50: 7469 630a 2020 2020 2020 2020 2222 220a  tic.        """.
+00006d60: 2020 2020 2020 2020 6672 6f6d 2064 6173          from das
+00006d70: 6b5f 6578 7072 2e5f 726f 6c6c 696e 6720  k_expr._rolling 
+00006d80: 696d 706f 7274 2052 6f6c 6c69 6e67 0a0a  import Rolling..
+00006d90: 2020 2020 2020 2020 7265 7475 726e 2052          return R
+00006da0: 6f6c 6c69 6e67 2873 656c 662c 2077 696e  olling(self, win
+00006db0: 646f 772c 202a 2a6b 7761 7267 7329 0a0a  dow, **kwargs)..
+00006dc0: 2020 2020 4069 6e73 6572 745f 6d65 7461      @insert_meta
+00006dd0: 5f70 6172 616d 5f64 6573 6372 6970 7469  _param_descripti
+00006de0: 6f6e 2870 6164 3d31 3229 0a20 2020 2064  on(pad=12).    d
+00006df0: 6566 206d 6170 5f70 6172 7469 7469 6f6e  ef map_partition
+00006e00: 7328 0a20 2020 2020 2020 2073 656c 662c  s(.        self,
+00006e10: 0a20 2020 2020 2020 2066 756e 632c 0a20  .        func,. 
+00006e20: 2020 2020 2020 202a 6172 6773 2c0a 2020         *args,.  
+00006e30: 2020 2020 2020 6d65 7461 3d6e 6f5f 6465        meta=no_de
+00006e40: 6661 756c 742c 0a20 2020 2020 2020 2065  fault,.        e
+00006e50: 6e66 6f72 6365 5f6d 6574 6164 6174 613d  nforce_metadata=
+00006e60: 5472 7565 2c0a 2020 2020 2020 2020 7472  True,.        tr
+00006e70: 616e 7366 6f72 6d5f 6469 7669 7369 6f6e  ansform_division
+00006e80: 733d 5472 7565 2c0a 2020 2020 2020 2020  s=True,.        
+00006e90: 636c 6561 725f 6469 7669 7369 6f6e 733d  clear_divisions=
+00006ea0: 4661 6c73 652c 0a20 2020 2020 2020 2061  False,.        a
+00006eb0: 6c69 676e 5f64 6174 6166 7261 6d65 733d  lign_dataframes=
+00006ec0: 4661 6c73 652c 0a20 2020 2020 2020 2070  False,.        p
+00006ed0: 6172 656e 745f 6d65 7461 3d4e 6f6e 652c  arent_meta=None,
+00006ee0: 0a20 2020 2020 2020 202a 2a6b 7761 7267  .        **kwarg
+00006ef0: 732c 0a20 2020 2029 3a0a 2020 2020 2020  s,.    ):.      
+00006f00: 2020 2222 2241 7070 6c79 2061 2050 7974    """Apply a Pyt
+00006f10: 686f 6e20 6675 6e63 7469 6f6e 2074 6f20  hon function to 
+00006f20: 6561 6368 2070 6172 7469 7469 6f6e 0a0a  each partition..
+00006f30: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+00006f40: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
+00006f50: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6675  -----.        fu
+00006f60: 6e63 203a 2066 756e 6374 696f 6e0a 2020  nc : function.  
+00006f70: 2020 2020 2020 2020 2020 4675 6e63 7469            Functi
+00006f80: 6f6e 2061 7070 6c69 6564 2074 6f20 6561  on applied to ea
+00006f90: 6368 2070 6172 7469 7469 6f6e 2e0a 2020  ch partition..  
+00006fa0: 2020 2020 2020 6172 6773 2c20 6b77 6172        args, kwar
+00006fb0: 6773 203a 0a20 2020 2020 2020 2020 2020  gs :.           
+00006fc0: 2041 7267 756d 656e 7473 2061 6e64 206b   Arguments and k
+00006fd0: 6579 776f 7264 7320 746f 2070 6173 7320  eywords to pass 
+00006fe0: 746f 2074 6865 2066 756e 6374 696f 6e2e  to the function.
+00006ff0: 2041 7267 756d 656e 7473 2061 6e64 0a20   Arguments and. 
+00007000: 2020 2020 2020 2020 2020 206b 6579 776f             keywo
+00007010: 7264 7320 6d61 7920 636f 6e74 6169 6e20  rds may contain 
+00007020: 6060 4672 616d 6542 6173 6560 6020 6f72  ``FrameBase`` or
+00007030: 2072 6567 756c 6172 2070 7974 686f 6e20   regular python 
+00007040: 6f62 6a65 6374 732e 0a20 2020 2020 2020  objects..       
+00007050: 2020 2020 2044 6174 6146 7261 6d65 2d6c       DataFrame-l
+00007060: 696b 6520 6172 6773 2028 626f 7468 2064  ike args (both d
+00007070: 6173 6b20 616e 6420 7061 6e64 6173 2920  ask and pandas) 
+00007080: 6d75 7374 2068 6176 6520 7468 6520 7361  must have the sa
+00007090: 6d65 0a20 2020 2020 2020 2020 2020 206e  me.            n
+000070a0: 756d 6265 7220 6f66 2070 6172 7469 7469  umber of partiti
+000070b0: 6f6e 7320 6173 2060 6073 656c 6660 6020  ons as ``self`` 
+000070c0: 6f72 2063 6f6d 7072 6973 6520 6120 7369  or comprise a si
+000070d0: 6e67 6c65 2070 6172 7469 7469 6f6e 2e0a  ngle partition..
+000070e0: 2020 2020 2020 2020 2020 2020 4b65 792d              Key-
+000070f0: 776f 7264 2061 7267 756d 656e 7473 2c20  word arguments, 
+00007100: 5369 6e67 6c65 2d70 6172 7469 7469 6f6e  Single-partition
+00007110: 2061 7267 756d 656e 7473 2c20 616e 6420   arguments, and 
+00007120: 6765 6e65 7261 6c0a 2020 2020 2020 2020  general.        
+00007130: 2020 2020 7079 7468 6f6e 2d6f 626a 6563      python-objec
+00007140: 7420 6172 6775 6d65 6e74 7320 7769 6c6c  t arguments will
+00007150: 2062 6520 6272 6f61 6463 6173 7465 6420   be broadcasted 
+00007160: 746f 2061 6c6c 2070 6172 7469 7469 6f6e  to all partition
+00007170: 732e 0a20 2020 2020 2020 2065 6e66 6f72  s..        enfor
+00007180: 6365 5f6d 6574 6164 6174 6120 3a20 626f  ce_metadata : bo
+00007190: 6f6c 2c20 6465 6661 756c 7420 5472 7565  ol, default True
+000071a0: 0a20 2020 2020 2020 2020 2020 2057 6865  .            Whe
+000071b0: 7468 6572 2074 6f20 656e 666f 7263 6520  ther to enforce 
+000071c0: 6174 2072 756e 7469 6d65 2074 6861 7420  at runtime that 
+000071d0: 7468 6520 7374 7275 6374 7572 6520 6f66  the structure of
+000071e0: 2074 6865 2044 6174 6146 7261 6d65 0a20   the DataFrame. 
+000071f0: 2020 2020 2020 2020 2020 2070 726f 6475             produ
+00007200: 6365 6420 6279 2060 6066 756e 6360 6020  ced by ``func`` 
+00007210: 6163 7475 616c 6c79 206d 6174 6368 6573  actually matches
+00007220: 2074 6865 2073 7472 7563 7475 7265 206f   the structure o
+00007230: 6620 6060 6d65 7461 6060 2e0a 2020 2020  f ``meta``..    
+00007240: 2020 2020 2020 2020 5468 6973 2077 696c          This wil
+00007250: 6c20 7265 6e61 6d65 2061 6e64 2072 656f  l rename and reo
+00007260: 7264 6572 2063 6f6c 756d 6e73 2066 6f72  rder columns for
+00007270: 2065 6163 6820 7061 7274 6974 696f 6e2c   each partition,
+00007280: 2061 6e64 2077 696c 6c0a 2020 2020 2020   and will.      
+00007290: 2020 2020 2020 7261 6973 6520 616e 2065        raise an e
+000072a0: 7272 6f72 2069 6620 7468 6973 2064 6f65  rror if this doe
+000072b0: 736e 2774 2077 6f72 6b2c 2062 7574 2069  sn't work, but i
+000072c0: 7420 776f 6e27 7420 7261 6973 6520 6966  t won't raise if
+000072d0: 2064 7479 7065 730a 2020 2020 2020 2020   dtypes.        
+000072e0: 2020 2020 646f 6e27 7420 6d61 7463 682e      don't match.
+000072f0: 0a20 2020 2020 2020 2074 7261 6e73 666f  .        transfo
+00007300: 726d 5f64 6976 6973 696f 6e73 203a 2062  rm_divisions : b
+00007310: 6f6f 6c2c 2064 6566 6175 6c74 2054 7275  ool, default Tru
+00007320: 650a 2020 2020 2020 2020 2020 2020 5768  e.            Wh
+00007330: 6574 6865 7220 746f 2061 7070 6c79 2074  ether to apply t
+00007340: 6865 2066 756e 6374 696f 6e20 6f6e 746f  he function onto
+00007350: 2074 6865 2064 6976 6973 696f 6e73 2061   the divisions a
+00007360: 6e64 2061 7070 6c79 2074 686f 7365 0a20  nd apply those. 
+00007370: 2020 2020 2020 2020 2020 2074 7261 6e73             trans
+00007380: 666f 726d 6564 2064 6976 6973 696f 6e73  formed divisions
+00007390: 2074 6f20 7468 6520 6f75 7470 7574 2e0a   to the output..
+000073a0: 2020 2020 2020 2020 636c 6561 725f 6469          clear_di
+000073b0: 7669 7369 6f6e 7320 3a20 626f 6f6c 2c20  visions : bool, 
+000073c0: 6465 6661 756c 7420 4661 6c73 650a 2020  default False.  
+000073d0: 2020 2020 2020 2020 2020 5768 6574 6865            Whethe
+000073e0: 7220 6469 7669 7369 6f6e 7320 7368 6f75  r divisions shou
+000073f0: 6c64 2062 6520 636c 6561 7265 642e 2049  ld be cleared. I
+00007400: 6620 5472 7565 2c20 6074 7261 6e73 666f  f True, `transfo
+00007410: 726d 5f64 6976 6973 696f 6e73 600a 2020  rm_divisions`.  
+00007420: 2020 2020 2020 2020 2020 7769 6c6c 2062            will b
+00007430: 6520 6967 6e6f 7265 642e 0a20 2020 2020  e ignored..     
+00007440: 2020 2024 4d45 5441 0a0a 2020 2020 2020     $META..      
+00007450: 2020 4578 616d 706c 6573 0a20 2020 2020    Examples.     
+00007460: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
+00007470: 2020 2020 4769 7665 6e20 6120 4461 7461      Given a Data
+00007480: 4672 616d 652c 2053 6572 6965 732c 206f  Frame, Series, o
+00007490: 7220 496e 6465 782c 2073 7563 6820 6173  r Index, such as
+000074a0: 3a0a 0a20 2020 2020 2020 203e 3e3e 2069  :..        >>> i
+000074b0: 6d70 6f72 7420 7061 6e64 6173 2061 7320  mport pandas as 
+000074c0: 7064 0a20 2020 2020 2020 203e 3e3e 2069  pd.        >>> i
+000074d0: 6d70 6f72 7420 6461 736b 5f65 7870 7220  mport dask_expr 
+000074e0: 6173 2064 640a 2020 2020 2020 2020 3e3e  as dd.        >>
+000074f0: 3e20 6466 203d 2070 642e 4461 7461 4672  > df = pd.DataFr
+00007500: 616d 6528 7b27 7827 3a20 5b31 2c20 322c  ame({'x': [1, 2,
+00007510: 2033 2c20 342c 2035 5d2c 0a20 2020 2020   3, 4, 5],.     
+00007520: 2020 202e 2e2e 2020 2020 2020 2020 2020     ...          
+00007530: 2020 2020 2020 2020 2020 2779 273a 205b            'y': [
+00007540: 312e 2c20 322e 2c20 332e 2c20 342e 2c20  1., 2., 3., 4., 
+00007550: 352e 5d7d 290a 2020 2020 2020 2020 3e3e  5.]}).        >>
+00007560: 3e20 6464 6620 3d20 6464 2e66 726f 6d5f  > ddf = dd.from_
+00007570: 7061 6e64 6173 2864 662c 206e 7061 7274  pandas(df, npart
+00007580: 6974 696f 6e73 3d32 290a 0a20 2020 2020  itions=2)..     
+00007590: 2020 204f 6e65 2063 616e 2075 7365 2060     One can use `
+000075a0: 606d 6170 5f70 6172 7469 7469 6f6e 7360  `map_partitions`
+000075b0: 6020 746f 2061 7070 6c79 2061 2066 756e  ` to apply a fun
+000075c0: 6374 696f 6e20 6f6e 2065 6163 6820 7061  ction on each pa
+000075d0: 7274 6974 696f 6e2e 0a20 2020 2020 2020  rtition..       
+000075e0: 2045 7874 7261 2061 7267 756d 656e 7473   Extra arguments
+000075f0: 2061 6e64 206b 6579 776f 7264 7320 6361   and keywords ca
+00007600: 6e20 6f70 7469 6f6e 616c 6c79 2062 6520  n optionally be 
+00007610: 7072 6f76 6964 6564 2c20 616e 6420 7769  provided, and wi
+00007620: 6c6c 2062 650a 2020 2020 2020 2020 7061  ll be.        pa
+00007630: 7373 6564 2074 6f20 7468 6520 6675 6e63  ssed to the func
+00007640: 7469 6f6e 2061 6674 6572 2074 6865 2070  tion after the p
+00007650: 6172 7469 7469 6f6e 2e0a 0a20 2020 2020  artition...     
+00007660: 2020 2048 6572 6520 7765 2061 7070 6c79     Here we apply
+00007670: 2061 2066 756e 6374 696f 6e20 7769 7468   a function with
+00007680: 2061 7267 756d 656e 7473 2061 6e64 206b   arguments and k
+00007690: 6579 776f 7264 7320 746f 2061 2044 6174  eywords to a Dat
+000076a0: 6146 7261 6d65 2c0a 2020 2020 2020 2020  aFrame,.        
+000076b0: 7265 7375 6c74 696e 6720 696e 2061 2053  resulting in a S
+000076c0: 6572 6965 733a 0a0a 2020 2020 2020 2020  eries:..        
+000076d0: 3e3e 3e20 6465 6620 6d79 6164 6428 6466  >>> def myadd(df
+000076e0: 2c20 612c 2062 3d31 293a 0a20 2020 2020  , a, b=1):.     
+000076f0: 2020 202e 2e2e 2020 2020 2072 6574 7572     ...     retur
+00007700: 6e20 6466 2e78 202b 2064 662e 7920 2b20  n df.x + df.y + 
+00007710: 6120 2b20 620a 2020 2020 2020 2020 3e3e  a + b.        >>
+00007720: 3e20 7265 7320 3d20 6464 662e 6d61 705f  > res = ddf.map_
+00007730: 7061 7274 6974 696f 6e73 286d 7961 6464  partitions(myadd
+00007740: 2c20 312c 2062 3d32 290a 2020 2020 2020  , 1, b=2).      
+00007750: 2020 3e3e 3e20 7265 732e 6474 7970 650a    >>> res.dtype.
+00007760: 2020 2020 2020 2020 6474 7970 6528 2766          dtype('f
+00007770: 6c6f 6174 3634 2729 0a0a 2020 2020 2020  loat64')..      
+00007780: 2020 4865 7265 2077 6520 6170 706c 7920    Here we apply 
+00007790: 6120 6675 6e63 7469 6f6e 2074 6f20 6120  a function to a 
+000077a0: 5365 7269 6573 2072 6573 756c 7469 6e67  Series resulting
+000077b0: 2069 6e20 6120 5365 7269 6573 3a0a 0a20   in a Series:.. 
+000077c0: 2020 2020 2020 203e 3e3e 2072 6573 203d         >>> res =
+000077d0: 2064 6466 2e78 2e6d 6170 5f70 6172 7469   ddf.x.map_parti
+000077e0: 7469 6f6e 7328 6c61 6d62 6461 2078 3a20  tions(lambda x: 
+000077f0: 6c65 6e28 7829 2920 2320 6464 662e 7820  len(x)) # ddf.x 
+00007800: 6973 2061 2044 6173 6b20 5365 7269 6573  is a Dask Series
+00007810: 2053 7472 7563 7475 7265 0a20 2020 2020   Structure.     
+00007820: 2020 203e 3e3e 2072 6573 2e64 7479 7065     >>> res.dtype
+00007830: 0a20 2020 2020 2020 2064 7479 7065 2827  .        dtype('
+00007840: 696e 7436 3427 290a 0a20 2020 2020 2020  int64')..       
+00007850: 2042 7920 6465 6661 756c 742c 2064 6173   By default, das
+00007860: 6b20 7472 6965 7320 746f 2069 6e66 6572  k tries to infer
+00007870: 2074 6865 206f 7574 7075 7420 6d65 7461   the output meta
+00007880: 6461 7461 2062 7920 7275 6e6e 696e 6720  data by running 
+00007890: 796f 7572 0a20 2020 2020 2020 2070 726f  your.        pro
+000078a0: 7669 6465 6420 6675 6e63 7469 6f6e 206f  vided function o
+000078b0: 6e20 736f 6d65 2066 616b 6520 6461 7461  n some fake data
+000078c0: 2e20 5468 6973 2077 6f72 6b73 2077 656c  . This works wel
+000078d0: 6c20 696e 206d 616e 7920 6361 7365 732c  l in many cases,
+000078e0: 2062 7574 0a20 2020 2020 2020 2063 616e   but.        can
+000078f0: 2073 6f6d 6574 696d 6573 2062 6520 6578   sometimes be ex
+00007900: 7065 6e73 6976 652c 206f 7220 6576 656e  pensive, or even
+00007910: 2066 6169 6c2e 2054 6f20 6176 6f69 6420   fail. To avoid 
+00007920: 7468 6973 2c20 796f 7520 6361 6e0a 2020  this, you can.  
+00007930: 2020 2020 2020 6d61 6e75 616c 6c79 2073        manually s
+00007940: 7065 6369 6679 2074 6865 206f 7574 7075  pecify the outpu
+00007950: 7420 6d65 7461 6461 7461 2077 6974 6820  t metadata with 
+00007960: 7468 6520 6060 6d65 7461 6060 206b 6579  the ``meta`` key
+00007970: 776f 7264 2e20 5468 6973 0a20 2020 2020  word. This.     
+00007980: 2020 2063 616e 2062 6520 7370 6563 6966     can be specif
+00007990: 6965 6420 696e 206d 616e 7920 666f 726d  ied in many form
+000079a0: 732c 2066 6f72 206d 6f72 6520 696e 666f  s, for more info
+000079b0: 726d 6174 696f 6e20 7365 650a 2020 2020  rmation see.    
+000079c0: 2020 2020 6060 6461 736b 2e64 6174 6166      ``dask.dataf
+000079d0: 7261 6d65 2e75 7469 6c73 2e6d 616b 655f  rame.utils.make_
+000079e0: 6d65 7461 6060 2e0a 0a20 2020 2020 2020  meta``...       
+000079f0: 2048 6572 6520 7765 2073 7065 6369 6679   Here we specify
+00007a00: 2074 6865 206f 7574 7075 7420 6973 2061   the output is a
+00007a10: 2053 6572 6965 7320 7769 7468 206e 6f20   Series with no 
+00007a20: 6e61 6d65 2c20 616e 6420 6474 7970 650a  name, and dtype.
+00007a30: 2020 2020 2020 2020 6060 666c 6f61 7436          ``float6
+00007a40: 3460 603a 0a0a 2020 2020 2020 2020 3e3e  4``:..        >>
+00007a50: 3e20 7265 7320 3d20 6464 662e 6d61 705f  > res = ddf.map_
+00007a60: 7061 7274 6974 696f 6e73 286d 7961 6464  partitions(myadd
+00007a70: 2c20 312c 2062 3d32 2c20 6d65 7461 3d28  , 1, b=2, meta=(
+00007a80: 4e6f 6e65 2c20 2766 3827 2929 0a0a 2020  None, 'f8'))..  
+00007a90: 2020 2020 2020 4865 7265 2077 6520 6d61        Here we ma
+00007aa0: 7020 6120 6675 6e63 7469 6f6e 2074 6861  p a function tha
+00007ab0: 7420 7461 6b65 7320 696e 2061 2044 6174  t takes in a Dat
+00007ac0: 6146 7261 6d65 2c20 616e 6420 7265 7475  aFrame, and retu
+00007ad0: 726e 7320 610a 2020 2020 2020 2020 4461  rns a.        Da
+00007ae0: 7461 4672 616d 6520 7769 7468 2061 206e  taFrame with a n
+00007af0: 6577 2063 6f6c 756d 6e3a 0a0a 2020 2020  ew column:..    
+00007b00: 2020 2020 3e3e 3e20 7265 7320 3d20 6464      >>> res = dd
+00007b10: 662e 6d61 705f 7061 7274 6974 696f 6e73  f.map_partitions
+00007b20: 286c 616d 6264 6120 6466 3a20 6466 2e61  (lambda df: df.a
+00007b30: 7373 6967 6e28 7a3d 6466 2e78 202a 2064  ssign(z=df.x * d
+00007b40: 662e 7929 290a 2020 2020 2020 2020 3e3e  f.y)).        >>
+00007b50: 3e20 7265 732e 6474 7970 6573 0a20 2020  > res.dtypes.   
+00007b60: 2020 2020 2078 2020 2020 2020 696e 7436       x      int6
+00007b70: 340a 2020 2020 2020 2020 7920 2020 2066  4.        y    f
+00007b80: 6c6f 6174 3634 0a20 2020 2020 2020 207a  loat64.        z
+00007b90: 2020 2020 666c 6f61 7436 340a 2020 2020      float64.    
+00007ba0: 2020 2020 6474 7970 653a 206f 626a 6563      dtype: objec
+00007bb0: 740a 0a20 2020 2020 2020 2041 7320 6265  t..        As be
+00007bc0: 666f 7265 2c20 7468 6520 6f75 7470 7574  fore, the output
+00007bd0: 206d 6574 6164 6174 6120 6361 6e20 616c   metadata can al
+00007be0: 736f 2062 6520 7370 6563 6966 6965 6420  so be specified 
+00007bf0: 6d61 6e75 616c 6c79 2e20 5468 6973 0a20  manually. This. 
+00007c00: 2020 2020 2020 2074 696d 6520 7765 2070         time we p
+00007c10: 6173 7320 696e 2061 2060 6064 6963 7460  ass in a ``dict`
+00007c20: 602c 2061 7320 7468 6520 6f75 7470 7574  `, as the output
+00007c30: 2069 7320 6120 4461 7461 4672 616d 653a   is a DataFrame:
+00007c40: 0a0a 2020 2020 2020 2020 3e3e 3e20 7265  ..        >>> re
+00007c50: 7320 3d20 6464 662e 6d61 705f 7061 7274  s = ddf.map_part
+00007c60: 6974 696f 6e73 286c 616d 6264 6120 6466  itions(lambda df
+00007c70: 3a20 6466 2e61 7373 6967 6e28 7a3d 6466  : df.assign(z=df
+00007c80: 2e78 202a 2064 662e 7929 2c0a 2020 2020  .x * df.y),.    
+00007c90: 2020 2020 2e2e 2e20 2020 2020 2020 2020      ...         
+00007ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007cb0: 206d 6574 613d 7b27 7827 3a20 2769 3827   meta={'x': 'i8'
+00007cc0: 2c20 2779 273a 2027 6638 272c 2027 7a27  , 'y': 'f8', 'z'
+00007cd0: 3a20 2766 3827 7d29 0a0a 2020 2020 2020  : 'f8'})..      
+00007ce0: 2020 496e 2074 6865 2063 6173 6520 7768    In the case wh
+00007cf0: 6572 6520 7468 6520 6d65 7461 6461 7461  ere the metadata
+00007d00: 2064 6f65 736e 2774 2063 6861 6e67 652c   doesn't change,
+00007d10: 2079 6f75 2063 616e 2061 6c73 6f20 7061   you can also pa
+00007d20: 7373 2069 6e0a 2020 2020 2020 2020 7468  ss in.        th
+00007d30: 6520 6f62 6a65 6374 2069 7473 656c 6620  e object itself 
+00007d40: 6469 7265 6374 6c79 3a0a 0a20 2020 2020  directly:..     
+00007d50: 2020 203e 3e3e 2072 6573 203d 2064 6466     >>> res = ddf
+00007d60: 2e6d 6170 5f70 6172 7469 7469 6f6e 7328  .map_partitions(
+00007d70: 6c61 6d62 6461 2064 663a 2064 662e 6865  lambda df: df.he
+00007d80: 6164 2829 2c20 6d65 7461 3d64 6466 290a  ad(), meta=ddf).
+00007d90: 0a20 2020 2020 2020 2041 6c73 6f20 6e6f  .        Also no
+00007da0: 7465 2074 6861 7420 7468 6520 696e 6465  te that the inde
+00007db0: 7820 616e 6420 6469 7669 7369 6f6e 7320  x and divisions 
+00007dc0: 6172 6520 6173 7375 6d65 6420 746f 2072  are assumed to r
+00007dd0: 656d 6169 6e20 756e 6368 616e 6765 642e  emain unchanged.
+00007de0: 0a20 2020 2020 2020 2049 6620 7468 6520  .        If the 
+00007df0: 6675 6e63 7469 6f6e 2079 6f75 2772 6520  function you're 
+00007e00: 6d61 7070 696e 6720 6368 616e 6765 7320  mapping changes 
+00007e10: 7468 6520 696e 6465 782f 6469 7669 7369  the index/divisi
+00007e20: 6f6e 732c 2079 6f75 276c 6c20 6e65 6564  ons, you'll need
+00007e30: 0a20 2020 2020 2020 2074 6f20 7061 7373  .        to pass
+00007e40: 2060 6063 6c65 6172 5f64 6976 6973 696f   ``clear_divisio
+00007e50: 6e73 3d54 7275 6560 602e 0a0a 2020 2020  ns=True``...    
+00007e60: 2020 2020 3e3e 3e20 6464 662e 6d61 705f      >>> ddf.map_
+00007e70: 7061 7274 6974 696f 6e73 2866 756e 632c  partitions(func,
+00007e80: 2063 6c65 6172 5f64 6976 6973 696f 6e73   clear_divisions
+00007e90: 3d54 7275 6529 2020 2320 646f 6374 6573  =True)  # doctes
+00007ea0: 743a 202b 534b 4950 0a0a 2020 2020 2020  t: +SKIP..      
+00007eb0: 2020 596f 7572 206d 6170 2066 756e 6374    Your map funct
+00007ec0: 696f 6e20 6765 7473 2069 6e66 6f72 6d61  ion gets informa
+00007ed0: 7469 6f6e 2061 626f 7574 2077 6865 7265  tion about where
+00007ee0: 2069 7420 6973 2069 6e20 7468 6520 6461   it is in the da
+00007ef0: 7461 6672 616d 6520 6279 0a20 2020 2020  taframe by.     
+00007f00: 2020 2061 6363 6570 7469 6e67 2061 2073     accepting a s
+00007f10: 7065 6369 616c 2060 6070 6172 7469 7469  pecial ``partiti
+00007f20: 6f6e 5f69 6e66 6f60 6020 6b65 7977 6f72  on_info`` keywor
+00007f30: 6420 6172 6775 6d65 6e74 2e0a 0a20 2020  d argument...   
+00007f40: 2020 2020 203e 3e3e 2064 6566 2066 756e       >>> def fun
+00007f50: 6328 7061 7274 6974 696f 6e2c 2070 6172  c(partition, par
+00007f60: 7469 7469 6f6e 5f69 6e66 6f3d 4e6f 6e65  tition_info=None
+00007f70: 293a 0a20 2020 2020 2020 202e 2e2e 2020  ):.        ...  
+00007f80: 2020 2070 6173 730a 0a20 2020 2020 2020     pass..       
+00007f90: 2054 6869 7320 7769 6c6c 2072 6563 6569   This will recei
+00007fa0: 7665 2074 6865 2066 6f6c 6c6f 7769 6e67  ve the following
+00007fb0: 2069 6e66 6f72 6d61 7469 6f6e 3a0a 0a20   information:.. 
+00007fc0: 2020 2020 2020 203e 3e3e 2070 6172 7469         >>> parti
+00007fd0: 7469 6f6e 5f69 6e66 6f20 2023 2064 6f63  tion_info  # doc
+00007fe0: 7465 7374 3a20 2b53 4b49 500a 2020 2020  test: +SKIP.    
+00007ff0: 2020 2020 7b27 6e75 6d62 6572 273a 2031      {'number': 1
+00008000: 2c20 2764 6976 6973 696f 6e27 3a20 337d  , 'division': 3}
+00008010: 0a0a 2020 2020 2020 2020 466f 7220 6561  ..        For ea
+00008020: 6368 2061 7267 756d 656e 7420 616e 6420  ch argument and 
+00008030: 6b65 7977 6f72 6420 6172 6775 6d65 6e74  keyword argument
+00008040: 7320 7468 6174 2061 7265 2064 6173 6b20  s that are dask 
+00008050: 6461 7461 6672 616d 6573 2079 6f75 2077  dataframes you w
+00008060: 696c 6c0a 2020 2020 2020 2020 7265 6365  ill.        rece
+00008070: 6976 6520 7468 6520 6e75 6d62 6572 2028  ive the number (
+00008080: 6e29 2077 6869 6368 2072 6570 7265 7365  n) which represe
+00008090: 6e74 7320 7468 6520 6e74 6820 7061 7274  nts the nth part
+000080a0: 6974 696f 6e20 6f66 2074 6865 2064 6174  ition of the dat
+000080b0: 6166 7261 6d65 0a20 2020 2020 2020 2061  aframe.        a
+000080c0: 6e64 2074 6865 2064 6976 6973 696f 6e20  nd the division 
+000080d0: 2874 6865 2066 6972 7374 2069 6e64 6578  (the first index
+000080e0: 2076 616c 7565 2069 6e20 7468 6520 7061   value in the pa
+000080f0: 7274 6974 696f 6e29 2e20 4966 2064 6976  rtition). If div
+00008100: 6973 696f 6e73 0a20 2020 2020 2020 2061  isions.        a
+00008110: 7265 206e 6f74 206b 6e6f 776e 2028 666f  re not known (fo
+00008120: 7220 696e 7374 616e 6365 2069 6620 7468  r instance if th
+00008130: 6520 696e 6465 7820 6973 206e 6f74 2073  e index is not s
+00008140: 6f72 7465 6429 2074 6865 6e20 796f 7520  orted) then you 
+00008150: 7769 6c6c 2067 6574 0a20 2020 2020 2020  will get.       
+00008160: 204e 6f6e 6520 6173 2074 6865 2064 6976   None as the div
+00008170: 6973 696f 6e2e 0a20 2020 2020 2020 2022  ision..        "
+00008180: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
+00008190: 6e20 6d61 705f 7061 7274 6974 696f 6e73  n map_partitions
+000081a0: 280a 2020 2020 2020 2020 2020 2020 6675  (.            fu
+000081b0: 6e63 2c0a 2020 2020 2020 2020 2020 2020  nc,.            
+000081c0: 7365 6c66 2c0a 2020 2020 2020 2020 2020  self,.          
+000081d0: 2020 2a61 7267 732c 0a20 2020 2020 2020    *args,.       
+000081e0: 2020 2020 206d 6574 613d 6d65 7461 2c0a       meta=meta,.
+000081f0: 2020 2020 2020 2020 2020 2020 656e 666f              enfo
+00008200: 7263 655f 6d65 7461 6461 7461 3d65 6e66  rce_metadata=enf
+00008210: 6f72 6365 5f6d 6574 6164 6174 612c 0a20  orce_metadata,. 
+00008220: 2020 2020 2020 2020 2020 2074 7261 6e73             trans
+00008230: 666f 726d 5f64 6976 6973 696f 6e73 3d74  form_divisions=t
+00008240: 7261 6e73 666f 726d 5f64 6976 6973 696f  ransform_divisio
+00008250: 6e73 2c0a 2020 2020 2020 2020 2020 2020  ns,.            
+00008260: 636c 6561 725f 6469 7669 7369 6f6e 733d  clear_divisions=
+00008270: 636c 6561 725f 6469 7669 7369 6f6e 732c  clear_divisions,
+00008280: 0a20 2020 2020 2020 2020 2020 2061 6c69  .            ali
+00008290: 676e 5f64 6174 6166 7261 6d65 733d 616c  gn_dataframes=al
+000082a0: 6967 6e5f 6461 7461 6672 616d 6573 2c0a  ign_dataframes,.
+000082b0: 2020 2020 2020 2020 2020 2020 7061 7265              pare
+000082c0: 6e74 5f6d 6574 613d 7061 7265 6e74 5f6d  nt_meta=parent_m
+000082d0: 6574 612c 0a20 2020 2020 2020 2020 2020  eta,.           
+000082e0: 202a 2a6b 7761 7267 732c 0a20 2020 2020   **kwargs,.     
+000082f0: 2020 2029 0a0a 2020 2020 4069 6e73 6572     )..    @inser
+00008300: 745f 6d65 7461 5f70 6172 616d 5f64 6573  t_meta_param_des
+00008310: 6372 6970 7469 6f6e 2870 6164 3d31 3229  cription(pad=12)
+00008320: 0a20 2020 2064 6566 206d 6170 5f6f 7665  .    def map_ove
+00008330: 726c 6170 280a 2020 2020 2020 2020 7365  rlap(.        se
+00008340: 6c66 2c0a 2020 2020 2020 2020 6675 6e63  lf,.        func
+00008350: 2c0a 2020 2020 2020 2020 6265 666f 7265  ,.        before
+00008360: 2c0a 2020 2020 2020 2020 6166 7465 722c  ,.        after,
+00008370: 0a20 2020 2020 2020 202a 6172 6773 2c0a  .        *args,.
+00008380: 2020 2020 2020 2020 6d65 7461 3d6e 6f5f          meta=no_
+00008390: 6465 6661 756c 742c 0a20 2020 2020 2020  default,.       
+000083a0: 2065 6e66 6f72 6365 5f6d 6574 6164 6174   enforce_metadat
+000083b0: 613d 5472 7565 2c0a 2020 2020 2020 2020  a=True,.        
+000083c0: 7472 616e 7366 6f72 6d5f 6469 7669 7369  transform_divisi
+000083d0: 6f6e 733d 5472 7565 2c0a 2020 2020 2020  ons=True,.      
+000083e0: 2020 636c 6561 725f 6469 7669 7369 6f6e    clear_division
+000083f0: 733d 4661 6c73 652c 0a20 2020 2020 2020  s=False,.       
+00008400: 2061 6c69 676e 5f64 6174 6166 7261 6d65   align_dataframe
+00008410: 733d 4661 6c73 652c 0a20 2020 2020 2020  s=False,.       
+00008420: 202a 2a6b 7761 7267 732c 0a20 2020 2029   **kwargs,.    )
+00008430: 3a0a 2020 2020 2020 2020 2222 2241 7070  :.        """App
+00008440: 6c79 2061 2066 756e 6374 696f 6e20 746f  ly a function to
+00008450: 2065 6163 6820 7061 7274 6974 696f 6e2c   each partition,
+00008460: 2073 6861 7269 6e67 2072 6f77 7320 7769   sharing rows wi
+00008470: 7468 2061 646a 6163 656e 7420 7061 7274  th adjacent part
+00008480: 6974 696f 6e73 2e0a 0a20 2020 2020 2020  itions...       
+00008490: 2054 6869 7320 6361 6e20 6265 2075 7365   This can be use
+000084a0: 6675 6c20 666f 7220 696d 706c 656d 656e  ful for implemen
+000084b0: 7469 6e67 2077 696e 646f 7769 6e67 2066  ting windowing f
+000084c0: 756e 6374 696f 6e73 2073 7563 6820 6173  unctions such as
+000084d0: 0a20 2020 2020 2020 2060 6064 662e 726f  .        ``df.ro
+000084e0: 6c6c 696e 6728 2e2e 2e29 2e6d 6561 6e28  lling(...).mean(
+000084f0: 2960 6020 6f72 2060 6064 662e 6469 6666  )`` or ``df.diff
+00008500: 2829 6060 2e0a 0a20 2020 2020 2020 2050  ()``...        P
+00008510: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
+00008520: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
+00008530: 2020 2020 2066 756e 6320 3a20 6675 6e63       func : func
+00008540: 7469 6f6e 0a20 2020 2020 2020 2020 2020  tion.           
+00008550: 2046 756e 6374 696f 6e20 6170 706c 6965   Function applie
+00008560: 6420 746f 2065 6163 6820 7061 7274 6974  d to each partit
+00008570: 696f 6e2e 0a20 2020 2020 2020 2062 6566  ion..        bef
+00008580: 6f72 6520 3a20 696e 742c 2074 696d 6564  ore : int, timed
+00008590: 656c 7461 206f 7220 7374 7269 6e67 2074  elta or string t
+000085a0: 696d 6564 656c 7461 0a20 2020 2020 2020  imedelta.       
+000085b0: 2020 2020 2054 6865 2072 6f77 7320 746f       The rows to
+000085c0: 2070 7265 7065 6e64 2074 6f20 7061 7274   prepend to part
+000085d0: 6974 696f 6e20 6060 6960 6020 6672 6f6d  ition ``i`` from
+000085e0: 2074 6865 2065 6e64 206f 660a 2020 2020   the end of.    
+000085f0: 2020 2020 2020 2020 7061 7274 6974 696f          partitio
+00008600: 6e20 6060 6920 2d20 3160 602e 0a20 2020  n ``i - 1``..   
+00008610: 2020 2020 2061 6674 6572 203a 2069 6e74       after : int
+00008620: 2c20 7469 6d65 6465 6c74 6120 6f72 2073  , timedelta or s
+00008630: 7472 696e 6720 7469 6d65 6465 6c74 610a  tring timedelta.
+00008640: 2020 2020 2020 2020 2020 2020 5468 6520              The 
+00008650: 726f 7773 2074 6f20 6170 7065 6e64 2074  rows to append t
+00008660: 6f20 7061 7274 6974 696f 6e20 6060 6960  o partition ``i`
+00008670: 6020 6672 6f6d 2074 6865 2062 6567 696e  ` from the begin
+00008680: 6e69 6e67 0a20 2020 2020 2020 2020 2020  ning.           
+00008690: 206f 6620 7061 7274 6974 696f 6e20 6060   of partition ``
+000086a0: 6920 2b20 3160 602e 0a20 2020 2020 2020  i + 1``..       
+000086b0: 2061 7267 732c 206b 7761 7267 7320 3a0a   args, kwargs :.
+000086c0: 2020 2020 2020 2020 2020 2020 506f 7369              Posi
+000086d0: 7469 6f6e 616c 2061 6e64 206b 6579 776f  tional and keywo
+000086e0: 7264 2061 7267 756d 656e 7473 2074 6f20  rd arguments to 
+000086f0: 7061 7373 2074 6f20 7468 6520 6675 6e63  pass to the func
+00008700: 7469 6f6e 2e0a 2020 2020 2020 2020 2020  tion..          
+00008710: 2020 506f 7369 7469 6f6e 616c 2061 7267    Positional arg
+00008720: 756d 656e 7473 2061 7265 2063 6f6d 7075  uments are compu
+00008730: 7465 6420 6f6e 2061 2070 6572 2d70 6172  ted on a per-par
+00008740: 7469 7469 6f6e 2062 6173 6973 2c20 7768  tition basis, wh
+00008750: 696c 650a 2020 2020 2020 2020 2020 2020  ile.            
+00008760: 6b65 7977 6f72 6420 6172 6775 6d65 6e74  keyword argument
+00008770: 7320 6172 6520 7368 6172 6564 2061 6372  s are shared acr
+00008780: 6f73 7320 616c 6c20 7061 7274 6974 696f  oss all partitio
+00008790: 6e73 2e20 5468 6520 7061 7274 6974 696f  ns. The partitio
+000087a0: 6e0a 2020 2020 2020 2020 2020 2020 6974  n.            it
+000087b0: 7365 6c66 2077 696c 6c20 6265 2074 6865  self will be the
+000087c0: 2066 6972 7374 2070 6f73 6974 696f 6e61   first positiona
+000087d0: 6c20 6172 6775 6d65 6e74 2c20 7769 7468  l argument, with
+000087e0: 2061 6c6c 206f 7468 6572 0a20 2020 2020   all other.     
+000087f0: 2020 2020 2020 2061 7267 756d 656e 7473         arguments
+00008800: 2070 6173 7365 6420 2a61 6674 6572 2a2e   passed *after*.
+00008810: 2041 7267 756d 656e 7473 2063 616e 2062   Arguments can b
+00008820: 6520 6060 5363 616c 6172 6060 2c20 6060  e ``Scalar``, ``
+00008830: 4465 6c61 7965 6460 602c 0a20 2020 2020  Delayed``,.     
+00008840: 2020 2020 2020 206f 7220 7265 6775 6c61         or regula
+00008850: 7220 5079 7468 6f6e 206f 626a 6563 7473  r Python objects
+00008860: 2e20 4461 7461 4672 616d 652d 6c69 6b65  . DataFrame-like
+00008870: 2061 7267 7320 2862 6f74 6820 6461 736b   args (both dask
+00008880: 2061 6e64 0a20 2020 2020 2020 2020 2020   and.           
+00008890: 2070 616e 6461 7329 2077 696c 6c20 6265   pandas) will be
+000088a0: 2072 6570 6172 7469 7469 6f6e 6564 2074   repartitioned t
+000088b0: 6f20 616c 6967 6e20 2869 6620 6e65 6365  o align (if nece
+000088c0: 7373 6172 7929 2062 6566 6f72 650a 2020  ssary) before.  
+000088d0: 2020 2020 2020 2020 2020 6170 706c 7969            applyi
+000088e0: 6e67 2074 6865 2066 756e 6374 696f 6e3b  ng the function;
+000088f0: 2073 6565 2060 6061 6c69 676e 5f64 6174   see ``align_dat
+00008900: 6166 7261 6d65 7360 6020 746f 2063 6f6e  aframes`` to con
+00008910: 7472 6f6c 2074 6869 730a 2020 2020 2020  trol this.      
+00008920: 2020 2020 2020 6265 6861 7669 6f72 2e0a        behavior..
+00008930: 2020 2020 2020 2020 656e 666f 7263 655f          enforce_
+00008940: 6d65 7461 6461 7461 203a 2062 6f6f 6c2c  metadata : bool,
+00008950: 2064 6566 6175 6c74 2054 7275 650a 2020   default True.  
+00008960: 2020 2020 2020 2020 2020 5768 6574 6865            Whethe
+00008970: 7220 746f 2065 6e66 6f72 6365 2061 7420  r to enforce at 
+00008980: 7275 6e74 696d 6520 7468 6174 2074 6865  runtime that the
+00008990: 2073 7472 7563 7475 7265 206f 6620 7468   structure of th
+000089a0: 6520 4461 7461 4672 616d 650a 2020 2020  e DataFrame.    
+000089b0: 2020 2020 2020 2020 7072 6f64 7563 6564          produced
+000089c0: 2062 7920 6060 6675 6e63 6060 2061 6374   by ``func`` act
+000089d0: 7561 6c6c 7920 6d61 7463 6865 7320 7468  ually matches th
+000089e0: 6520 7374 7275 6374 7572 6520 6f66 2060  e structure of `
+000089f0: 606d 6574 6160 602e 0a20 2020 2020 2020  `meta``..       
+00008a00: 2020 2020 2054 6869 7320 7769 6c6c 2072       This will r
+00008a10: 656e 616d 6520 616e 6420 7265 6f72 6465  ename and reorde
+00008a20: 7220 636f 6c75 6d6e 7320 666f 7220 6561  r columns for ea
+00008a30: 6368 2070 6172 7469 7469 6f6e 2c0a 2020  ch partition,.  
+00008a40: 2020 2020 2020 2020 2020 616e 6420 7769            and wi
+00008a50: 6c6c 2072 6169 7365 2061 6e20 6572 726f  ll raise an erro
+00008a60: 7220 6966 2074 6869 7320 646f 6573 6e27  r if this doesn'
+00008a70: 7420 776f 726b 2c0a 2020 2020 2020 2020  t work,.        
+00008a80: 2020 2020 6275 7420 6974 2077 6f6e 2774      but it won't
+00008a90: 2072 6169 7365 2069 6620 6474 7970 6573   raise if dtypes
+00008aa0: 2064 6f6e 2774 206d 6174 6368 2e0a 2020   don't match..  
+00008ab0: 2020 2020 2020 7472 616e 7366 6f72 6d5f        transform_
+00008ac0: 6469 7669 7369 6f6e 7320 3a20 626f 6f6c  divisions : bool
+00008ad0: 2c20 6465 6661 756c 7420 5472 7565 0a20  , default True. 
+00008ae0: 2020 2020 2020 2020 2020 2057 6865 7468             Wheth
+00008af0: 6572 2074 6f20 6170 706c 7920 7468 6520  er to apply the 
+00008b00: 6675 6e63 7469 6f6e 206f 6e74 6f20 7468  function onto th
+00008b10: 6520 6469 7669 7369 6f6e 7320 616e 6420  e divisions and 
+00008b20: 6170 706c 7920 7468 6f73 650a 2020 2020  apply those.    
+00008b30: 2020 2020 2020 2020 7472 616e 7366 6f72          transfor
+00008b40: 6d65 6420 6469 7669 7369 6f6e 7320 746f  med divisions to
+00008b50: 2074 6865 206f 7574 7075 742e 0a20 2020   the output..   
+00008b60: 2020 2020 2061 6c69 676e 5f64 6174 6166       align_dataf
+00008b70: 7261 6d65 7320 3a20 626f 6f6c 2c20 6465  rames : bool, de
+00008b80: 6661 756c 7420 5472 7565 0a20 2020 2020  fault True.     
+00008b90: 2020 2020 2020 2057 6865 7468 6572 2074         Whether t
+00008ba0: 6f20 7265 7061 7274 6974 696f 6e20 4461  o repartition Da
+00008bb0: 7461 4672 616d 652d 206f 7220 5365 7269  taFrame- or Seri
+00008bc0: 6573 2d6c 696b 6520 6172 6773 0a20 2020  es-like args.   
+00008bd0: 2020 2020 2020 2020 2028 626f 7468 2064           (both d
+00008be0: 6173 6b20 616e 6420 7061 6e64 6173 2920  ask and pandas) 
+00008bf0: 736f 2074 6865 6972 2064 6976 6973 696f  so their divisio
+00008c00: 6e73 2061 6c69 676e 2062 6566 6f72 6520  ns align before 
+00008c10: 6170 706c 7969 6e67 0a20 2020 2020 2020  applying.       
+00008c20: 2020 2020 2074 6865 2066 756e 6374 696f       the functio
+00008c30: 6e2e 2054 6869 7320 7265 7175 6972 6573  n. This requires
+00008c40: 2061 6c6c 2069 6e70 7574 7320 746f 2068   all inputs to h
+00008c50: 6176 6520 6b6e 6f77 6e20 6469 7669 7369  ave known divisi
+00008c60: 6f6e 732e 0a20 2020 2020 2020 2020 2020  ons..           
+00008c70: 2053 696e 676c 652d 7061 7274 6974 696f   Single-partitio
+00008c80: 6e20 696e 7075 7473 2077 696c 6c20 6265  n inputs will be
+00008c90: 2073 706c 6974 2069 6e74 6f20 6d75 6c74   split into mult
+00008ca0: 6970 6c65 2070 6172 7469 7469 6f6e 732e  iple partitions.
+00008cb0: 0a0a 2020 2020 2020 2020 2020 2020 4966  ..            If
+00008cc0: 2046 616c 7365 2c20 616c 6c20 696e 7075   False, all inpu
+00008cd0: 7473 206d 7573 7420 6861 7665 2065 6974  ts must have eit
+00008ce0: 6865 7220 7468 6520 7361 6d65 206e 756d  her the same num
+00008cf0: 6265 7220 6f66 2070 6172 7469 7469 6f6e  ber of partition
+00008d00: 730a 2020 2020 2020 2020 2020 2020 6f72  s.            or
+00008d10: 2061 2073 696e 676c 6520 7061 7274 6974   a single partit
+00008d20: 696f 6e2e 2053 696e 676c 652d 7061 7274  ion. Single-part
+00008d30: 6974 696f 6e20 696e 7075 7473 2077 696c  ition inputs wil
+00008d40: 6c20 6265 2062 726f 6164 6361 7374 2074  l be broadcast t
+00008d50: 6f0a 2020 2020 2020 2020 2020 2020 6576  o.            ev
+00008d60: 6572 7920 7061 7274 6974 696f 6e20 6f66  ery partition of
+00008d70: 206d 756c 7469 2d70 6172 7469 7469 6f6e   multi-partition
+00008d80: 2069 6e70 7574 732e 0a20 2020 2020 2020   inputs..       
+00008d90: 2024 4d45 5441 0a0a 2020 2020 2020 2020   $META..        
+00008da0: 4e6f 7465 730a 2020 2020 2020 2020 2d2d  Notes.        --
+00008db0: 2d2d 2d0a 2020 2020 2020 2020 4769 7665  ---.        Give
+00008dc0: 6e20 706f 7369 7469 7665 2069 6e74 6567  n positive integ
+00008dd0: 6572 7320 6060 6265 666f 7265 6060 2061  ers ``before`` a
+00008de0: 6e64 2060 6061 6674 6572 6060 2c20 616e  nd ``after``, an
+00008df0: 6420 6120 6675 6e63 7469 6f6e 0a20 2020  d a function.   
+00008e00: 2020 2020 2060 6066 756e 6360 602c 2060       ``func``, `
+00008e10: 606d 6170 5f6f 7665 726c 6170 6060 2064  `map_overlap`` d
+00008e20: 6f65 7320 7468 6520 666f 6c6c 6f77 696e  oes the followin
+00008e30: 673a 0a0a 2020 2020 2020 2020 312e 2050  g:..        1. P
+00008e40: 7265 7065 6e64 2060 6062 6566 6f72 6560  repend ``before`
+00008e50: 6020 726f 7773 2074 6f20 6561 6368 2070  ` rows to each p
+00008e60: 6172 7469 7469 6f6e 2060 6069 6060 2066  artition ``i`` f
+00008e70: 726f 6d20 7468 6520 656e 6420 6f66 0a20  rom the end of. 
+00008e80: 2020 2020 2020 2020 2020 7061 7274 6974            partit
+00008e90: 696f 6e20 6060 6920 2d20 3160 602e 2054  ion ``i - 1``. T
+00008ea0: 6865 2066 6972 7374 2070 6172 7469 7469  he first partiti
+00008eb0: 6f6e 2068 6173 206e 6f20 726f 7773 2070  on has no rows p
+00008ec0: 7265 7065 6e64 6564 2e0a 0a20 2020 2020  repended...     
+00008ed0: 2020 2032 2e20 4170 7065 6e64 2060 6061     2. Append ``a
+00008ee0: 6674 6572 6060 2072 6f77 7320 746f 2065  fter`` rows to e
+00008ef0: 6163 6820 7061 7274 6974 696f 6e20 6060  ach partition ``
+00008f00: 6960 6020 6672 6f6d 2074 6865 2062 6567  i`` from the beg
+00008f10: 696e 6e69 6e67 206f 660a 2020 2020 2020  inning of.      
+00008f20: 2020 2020 2070 6172 7469 7469 6f6e 2060       partition `
+00008f30: 6069 202b 2031 6060 2e20 5468 6520 6c61  `i + 1``. The la
+00008f40: 7374 2070 6172 7469 7469 6f6e 2068 6173  st partition has
+00008f50: 206e 6f20 726f 7773 2061 7070 656e 6465   no rows appende
+00008f60: 642e 0a0a 2020 2020 2020 2020 332e 2041  d...        3. A
+00008f70: 7070 6c79 2060 6066 756e 6360 6020 746f  pply ``func`` to
+00008f80: 2065 6163 6820 7061 7274 6974 696f 6e2c   each partition,
+00008f90: 2070 6173 7369 6e67 2069 6e20 616e 7920   passing in any 
+00008fa0: 6578 7472 6120 6060 6172 6773 6060 2061  extra ``args`` a
+00008fb0: 6e64 0a20 2020 2020 2020 2020 2020 6060  nd.           ``
+00008fc0: 6b77 6172 6773 6060 2069 6620 7072 6f76  kwargs`` if prov
+00008fd0: 6964 6564 2e0a 0a20 2020 2020 2020 2034  ided...        4
+00008fe0: 2e20 5472 696d 2060 6062 6566 6f72 6560  . Trim ``before`
+00008ff0: 6020 726f 7773 2066 726f 6d20 7468 6520  ` rows from the 
+00009000: 6265 6769 6e6e 696e 6720 6f66 2061 6c6c  beginning of all
+00009010: 2062 7574 2074 6865 2066 6972 7374 0a20   but the first. 
+00009020: 2020 2020 2020 2020 2020 7061 7274 6974            partit
+00009030: 696f 6e2e 0a0a 2020 2020 2020 2020 352e  ion...        5.
+00009040: 2054 7269 6d20 6060 6166 7465 7260 6020   Trim ``after`` 
+00009050: 726f 7773 2066 726f 6d20 7468 6520 656e  rows from the en
+00009060: 6420 6f66 2061 6c6c 2062 7574 2074 6865  d of all but the
+00009070: 206c 6173 7420 7061 7274 6974 696f 6e2e   last partition.
+00009080: 0a0a 2020 2020 2020 2020 4578 616d 706c  ..        Exampl
+00009090: 6573 0a20 2020 2020 2020 202d 2d2d 2d2d  es.        -----
+000090a0: 2d2d 2d0a 2020 2020 2020 2020 4769 7665  ---.        Give
+000090b0: 6e20 6120 4461 7461 4672 616d 652c 2053  n a DataFrame, S
+000090c0: 6572 6965 732c 206f 7220 496e 6465 782c  eries, or Index,
+000090d0: 2073 7563 6820 6173 3a0a 0a20 2020 2020   such as:..     
+000090e0: 2020 203e 3e3e 2069 6d70 6f72 7420 7061     >>> import pa
+000090f0: 6e64 6173 2061 7320 7064 0a20 2020 2020  ndas as pd.     
+00009100: 2020 203e 3e3e 2069 6d70 6f72 7420 6461     >>> import da
+00009110: 736b 5f65 7870 7220 6173 2064 640a 2020  sk_expr as dd.  
+00009120: 2020 2020 2020 3e3e 3e20 6466 203d 2070        >>> df = p
+00009130: 642e 4461 7461 4672 616d 6528 7b27 7827  d.DataFrame({'x'
+00009140: 3a20 5b31 2c20 322c 2034 2c20 372c 2031  : [1, 2, 4, 7, 1
+00009150: 315d 2c0a 2020 2020 2020 2020 2e2e 2e20  1],.        ... 
 00009160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009170: 2027 7927 3a20 5b31 2e2c 2032 2e2c 2033   'y': [1., 2., 3
-00009180: 2e2c 2034 2e2c 2035 2e5d 7d29 0a20 2020  ., 4., 5.]}).   
-00009190: 2020 2020 203e 3e3e 2064 6466 203d 2064       >>> ddf = d
-000091a0: 642e 6672 6f6d 5f70 616e 6461 7328 6466  d.from_pandas(df
-000091b0: 2c20 6e70 6172 7469 7469 6f6e 733d 3229  , npartitions=2)
-000091c0: 0a0a 2020 2020 2020 2020 4120 726f 6c6c  ..        A roll
-000091d0: 696e 6720 7375 6d20 7769 7468 2061 2074  ing sum with a t
-000091e0: 7261 696c 696e 6720 6d6f 7669 6e67 2077  railing moving w
-000091f0: 696e 646f 7720 6f66 2073 697a 6520 3220  indow of size 2 
-00009200: 6361 6e20 6265 2063 6f6d 7075 7465 6420  can be computed 
-00009210: 6279 0a20 2020 2020 2020 206f 7665 726c  by.        overl
-00009220: 6170 7069 6e67 2032 2072 6f77 7320 6265  apping 2 rows be
-00009230: 666f 7265 2065 6163 6820 7061 7274 6974  fore each partit
-00009240: 696f 6e2c 2061 6e64 2074 6865 6e20 6d61  ion, and then ma
-00009250: 7070 696e 6720 6361 6c6c 7320 746f 0a20  pping calls to. 
-00009260: 2020 2020 2020 2060 6064 662e 726f 6c6c         ``df.roll
-00009270: 696e 6728 3229 2e73 756d 2829 6060 3a0a  ing(2).sum()``:.
-00009280: 0a20 2020 2020 2020 203e 3e3e 2064 6466  .        >>> ddf
-00009290: 2e63 6f6d 7075 7465 2829 0a20 2020 2020  .compute().     
-000092a0: 2020 2020 2020 2078 2020 2020 790a 2020         x    y.  
-000092b0: 2020 2020 2020 3020 2020 3120 2031 2e30        0   1  1.0
-000092c0: 0a20 2020 2020 2020 2031 2020 2032 2020  .        1   2  
-000092d0: 322e 300a 2020 2020 2020 2020 3220 2020  2.0.        2   
-000092e0: 3420 2033 2e30 0a20 2020 2020 2020 2033  4  3.0.        3
-000092f0: 2020 2037 2020 342e 300a 2020 2020 2020     7  4.0.      
-00009300: 2020 3420 2031 3120 2035 2e30 0a20 2020    4  11  5.0.   
-00009310: 2020 2020 203e 3e3e 2064 6466 2e6d 6170       >>> ddf.map
-00009320: 5f6f 7665 726c 6170 286c 616d 6264 6120  _overlap(lambda 
-00009330: 6466 3a20 6466 2e72 6f6c 6c69 6e67 2832  df: df.rolling(2
-00009340: 292e 7375 6d28 292c 2032 2c20 3029 2e63  ).sum(), 2, 0).c
-00009350: 6f6d 7075 7465 2829 0a20 2020 2020 2020  ompute().       
-00009360: 2020 2020 2020 2078 2020 2020 790a 2020         x    y.  
-00009370: 2020 2020 2020 3020 2020 4e61 4e20 204e        0   NaN  N
-00009380: 614e 0a20 2020 2020 2020 2031 2020 2033  aN.        1   3
-00009390: 2e30 2020 332e 300a 2020 2020 2020 2020  .0  3.0.        
-000093a0: 3220 2020 362e 3020 2035 2e30 0a20 2020  2   6.0  5.0.   
-000093b0: 2020 2020 2033 2020 3131 2e30 2020 372e       3  11.0  7.
-000093c0: 300a 2020 2020 2020 2020 3420 2031 382e  0.        4  18.
-000093d0: 3020 2039 2e30 0a0a 2020 2020 2020 2020  0  9.0..        
-000093e0: 5468 6520 7061 6e64 6173 2060 6064 6966  The pandas ``dif
-000093f0: 6660 6020 6d65 7468 6f64 2063 6f6d 7075  f`` method compu
-00009400: 7465 7320 6120 6469 7363 7265 7465 2064  tes a discrete d
-00009410: 6966 6665 7265 6e63 6520 7368 6966 7465  ifference shifte
-00009420: 6420 6279 2061 0a20 2020 2020 2020 206e  d by a.        n
-00009430: 756d 6265 7220 6f66 2070 6572 696f 6473  umber of periods
-00009440: 2028 6361 6e20 6265 2070 6f73 6974 6976   (can be positiv
-00009450: 6520 6f72 206e 6567 6174 6976 6529 2e20  e or negative). 
-00009460: 5468 6973 2063 616e 2062 650a 2020 2020  This can be.    
-00009470: 2020 2020 696d 706c 656d 656e 7465 6420      implemented 
-00009480: 6279 206d 6170 7069 6e67 2063 616c 6c73  by mapping calls
-00009490: 2074 6f20 6060 6466 2e64 6966 6660 6020   to ``df.diff`` 
-000094a0: 746f 2065 6163 6820 7061 7274 6974 696f  to each partitio
-000094b0: 6e20 6166 7465 720a 2020 2020 2020 2020  n after.        
-000094c0: 7072 6570 656e 6469 6e67 2f61 7070 656e  prepending/appen
-000094d0: 6469 6e67 2074 6861 7420 6d61 6e79 2072  ding that many r
-000094e0: 6f77 732c 2064 6570 656e 6469 6e67 206f  ows, depending o
-000094f0: 6e20 7369 676e 3a0a 0a20 2020 2020 2020  n sign:..       
-00009500: 203e 3e3e 2064 6566 2064 6966 6628 6466   >>> def diff(df
-00009510: 2c20 7065 7269 6f64 733d 3129 3a0a 2020  , periods=1):.  
-00009520: 2020 2020 2020 2e2e 2e20 2020 2020 6265        ...     be
-00009530: 666f 7265 2c20 6166 7465 7220 3d20 2870  fore, after = (p
-00009540: 6572 696f 6473 2c20 3029 2069 6620 7065  eriods, 0) if pe
-00009550: 7269 6f64 7320 3e20 3020 656c 7365 2028  riods > 0 else (
-00009560: 302c 202d 7065 7269 6f64 7329 0a20 2020  0, -periods).   
-00009570: 2020 2020 202e 2e2e 2020 2020 2072 6574       ...     ret
-00009580: 7572 6e20 6466 2e6d 6170 5f6f 7665 726c  urn df.map_overl
-00009590: 6170 286c 616d 6264 6120 6466 2c20 7065  ap(lambda df, pe
-000095a0: 7269 6f64 733d 313a 2064 662e 6469 6666  riods=1: df.diff
-000095b0: 2870 6572 696f 6473 292c 0a20 2020 2020  (periods),.     
-000095c0: 2020 202e 2e2e 2020 2020 2020 2020 2020     ...          
+00009170: 2020 2027 7927 3a20 5b31 2e2c 2032 2e2c     'y': [1., 2.,
+00009180: 2033 2e2c 2034 2e2c 2035 2e5d 7d29 0a20   3., 4., 5.]}). 
+00009190: 2020 2020 2020 203e 3e3e 2064 6466 203d         >>> ddf =
+000091a0: 2064 642e 6672 6f6d 5f70 616e 6461 7328   dd.from_pandas(
+000091b0: 6466 2c20 6e70 6172 7469 7469 6f6e 733d  df, npartitions=
+000091c0: 3229 0a0a 2020 2020 2020 2020 4120 726f  2)..        A ro
+000091d0: 6c6c 696e 6720 7375 6d20 7769 7468 2061  lling sum with a
+000091e0: 2074 7261 696c 696e 6720 6d6f 7669 6e67   trailing moving
+000091f0: 2077 696e 646f 7720 6f66 2073 697a 6520   window of size 
+00009200: 3220 6361 6e20 6265 2063 6f6d 7075 7465  2 can be compute
+00009210: 6420 6279 0a20 2020 2020 2020 206f 7665  d by.        ove
+00009220: 726c 6170 7069 6e67 2032 2072 6f77 7320  rlapping 2 rows 
+00009230: 6265 666f 7265 2065 6163 6820 7061 7274  before each part
+00009240: 6974 696f 6e2c 2061 6e64 2074 6865 6e20  ition, and then 
+00009250: 6d61 7070 696e 6720 6361 6c6c 7320 746f  mapping calls to
+00009260: 0a20 2020 2020 2020 2060 6064 662e 726f  .        ``df.ro
+00009270: 6c6c 696e 6728 3229 2e73 756d 2829 6060  lling(2).sum()``
+00009280: 3a0a 0a20 2020 2020 2020 203e 3e3e 2064  :..        >>> d
+00009290: 6466 2e63 6f6d 7075 7465 2829 0a20 2020  df.compute().   
+000092a0: 2020 2020 2020 2020 2078 2020 2020 790a           x    y.
+000092b0: 2020 2020 2020 2020 3020 2020 3120 2031          0   1  1
+000092c0: 2e30 0a20 2020 2020 2020 2031 2020 2032  .0.        1   2
+000092d0: 2020 322e 300a 2020 2020 2020 2020 3220    2.0.        2 
+000092e0: 2020 3420 2033 2e30 0a20 2020 2020 2020    4  3.0.       
+000092f0: 2033 2020 2037 2020 342e 300a 2020 2020   3   7  4.0.    
+00009300: 2020 2020 3420 2031 3120 2035 2e30 0a20      4  11  5.0. 
+00009310: 2020 2020 2020 203e 3e3e 2064 6466 2e6d         >>> ddf.m
+00009320: 6170 5f6f 7665 726c 6170 286c 616d 6264  ap_overlap(lambd
+00009330: 6120 6466 3a20 6466 2e72 6f6c 6c69 6e67  a df: df.rolling
+00009340: 2832 292e 7375 6d28 292c 2032 2c20 3029  (2).sum(), 2, 0)
+00009350: 2e63 6f6d 7075 7465 2829 0a20 2020 2020  .compute().     
+00009360: 2020 2020 2020 2020 2078 2020 2020 790a           x    y.
+00009370: 2020 2020 2020 2020 3020 2020 4e61 4e20          0   NaN 
+00009380: 204e 614e 0a20 2020 2020 2020 2031 2020   NaN.        1  
+00009390: 2033 2e30 2020 332e 300a 2020 2020 2020   3.0  3.0.      
+000093a0: 2020 3220 2020 362e 3020 2035 2e30 0a20    2   6.0  5.0. 
+000093b0: 2020 2020 2020 2033 2020 3131 2e30 2020         3  11.0  
+000093c0: 372e 300a 2020 2020 2020 2020 3420 2031  7.0.        4  1
+000093d0: 382e 3020 2039 2e30 0a0a 2020 2020 2020  8.0  9.0..      
+000093e0: 2020 5468 6520 7061 6e64 6173 2060 6064    The pandas ``d
+000093f0: 6966 6660 6020 6d65 7468 6f64 2063 6f6d  iff`` method com
+00009400: 7075 7465 7320 6120 6469 7363 7265 7465  putes a discrete
+00009410: 2064 6966 6665 7265 6e63 6520 7368 6966   difference shif
+00009420: 7465 6420 6279 2061 0a20 2020 2020 2020  ted by a.       
+00009430: 206e 756d 6265 7220 6f66 2070 6572 696f   number of perio
+00009440: 6473 2028 6361 6e20 6265 2070 6f73 6974  ds (can be posit
+00009450: 6976 6520 6f72 206e 6567 6174 6976 6529  ive or negative)
+00009460: 2e20 5468 6973 2063 616e 2062 650a 2020  . This can be.  
+00009470: 2020 2020 2020 696d 706c 656d 656e 7465        implemente
+00009480: 6420 6279 206d 6170 7069 6e67 2063 616c  d by mapping cal
+00009490: 6c73 2074 6f20 6060 6466 2e64 6966 6660  ls to ``df.diff`
+000094a0: 6020 746f 2065 6163 6820 7061 7274 6974  ` to each partit
+000094b0: 696f 6e20 6166 7465 720a 2020 2020 2020  ion after.      
+000094c0: 2020 7072 6570 656e 6469 6e67 2f61 7070    prepending/app
+000094d0: 656e 6469 6e67 2074 6861 7420 6d61 6e79  ending that many
+000094e0: 2072 6f77 732c 2064 6570 656e 6469 6e67   rows, depending
+000094f0: 206f 6e20 7369 676e 3a0a 0a20 2020 2020   on sign:..     
+00009500: 2020 203e 3e3e 2064 6566 2064 6966 6628     >>> def diff(
+00009510: 6466 2c20 7065 7269 6f64 733d 3129 3a0a  df, periods=1):.
+00009520: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+00009530: 6265 666f 7265 2c20 6166 7465 7220 3d20  before, after = 
+00009540: 2870 6572 696f 6473 2c20 3029 2069 6620  (periods, 0) if 
+00009550: 7065 7269 6f64 7320 3e20 3020 656c 7365  periods > 0 else
+00009560: 2028 302c 202d 7065 7269 6f64 7329 0a20   (0, -periods). 
+00009570: 2020 2020 2020 202e 2e2e 2020 2020 2072         ...     r
+00009580: 6574 7572 6e20 6466 2e6d 6170 5f6f 7665  eturn df.map_ove
+00009590: 726c 6170 286c 616d 6264 6120 6466 2c20  rlap(lambda df, 
+000095a0: 7065 7269 6f64 733d 313a 2064 662e 6469  periods=1: df.di
+000095b0: 6666 2870 6572 696f 6473 292c 0a20 2020  ff(periods),.   
+000095c0: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
 000095d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000095e0: 2070 6572 696f 6473 2c20 302c 2070 6572   periods, 0, per
-000095f0: 696f 6473 3d70 6572 696f 6473 290a 2020  iods=periods).  
-00009600: 2020 2020 2020 3e3e 3e20 6469 6666 2864        >>> diff(d
-00009610: 6466 2c20 3129 2e63 6f6d 7075 7465 2829  df, 1).compute()
-00009620: 0a20 2020 2020 2020 2020 2020 2020 7820  .             x 
-00009630: 2020 2079 0a20 2020 2020 2020 2030 2020     y.        0  
-00009640: 4e61 4e20 204e 614e 0a20 2020 2020 2020  NaN  NaN.       
-00009650: 2031 2020 312e 3020 2031 2e30 0a20 2020   1  1.0  1.0.   
-00009660: 2020 2020 2032 2020 322e 3020 2031 2e30       2  2.0  1.0
-00009670: 0a20 2020 2020 2020 2033 2020 332e 3020  .        3  3.0 
-00009680: 2031 2e30 0a20 2020 2020 2020 2034 2020   1.0.        4  
-00009690: 342e 3020 2031 2e30 0a0a 2020 2020 2020  4.0  1.0..      
-000096a0: 2020 4966 2079 6f75 2068 6176 6520 6120    If you have a 
-000096b0: 6060 4461 7465 7469 6d65 496e 6465 7860  ``DatetimeIndex`
-000096c0: 602c 2079 6f75 2063 616e 2075 7365 2061  `, you can use a
-000096d0: 2060 6070 642e 5469 6d65 6465 6c74 6160   ``pd.Timedelta`
-000096e0: 6020 666f 7220 7469 6d65 2d0a 2020 2020  ` for time-.    
-000096f0: 2020 2020 6261 7365 6420 7769 6e64 6f77      based window
-00009700: 7320 6f72 2061 6e79 2060 6070 642e 5469  s or any ``pd.Ti
-00009710: 6d65 6465 6c74 6160 6020 636f 6e76 6572  medelta`` conver
-00009720: 7469 626c 6520 7374 7269 6e67 3a0a 0a20  tible string:.. 
-00009730: 2020 2020 2020 203e 3e3e 2074 7320 3d20         >>> ts = 
-00009740: 7064 2e53 6572 6965 7328 7261 6e67 6528  pd.Series(range(
-00009750: 3130 292c 2069 6e64 6578 3d70 642e 6461  10), index=pd.da
-00009760: 7465 5f72 616e 6765 2827 3230 3137 272c  te_range('2017',
-00009770: 2070 6572 696f 6473 3d31 3029 290a 2020   periods=10)).  
-00009780: 2020 2020 2020 3e3e 3e20 6474 7320 3d20        >>> dts = 
-00009790: 6464 2e66 726f 6d5f 7061 6e64 6173 2874  dd.from_pandas(t
-000097a0: 732c 206e 7061 7274 6974 696f 6e73 3d32  s, npartitions=2
-000097b0: 290a 2020 2020 2020 2020 3e3e 3e20 6474  ).        >>> dt
-000097c0: 732e 6d61 705f 6f76 6572 6c61 7028 6c61  s.map_overlap(la
-000097d0: 6d62 6461 2064 663a 2064 662e 726f 6c6c  mbda df: df.roll
-000097e0: 696e 6728 2732 4427 292e 7375 6d28 292c  ing('2D').sum(),
-000097f0: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
-00009800: 2020 2020 2020 2020 2020 2020 2070 642e               pd.
-00009810: 5469 6d65 6465 6c74 6128 2732 4427 292c  Timedelta('2D'),
-00009820: 2030 292e 636f 6d70 7574 6528 290a 2020   0).compute().  
-00009830: 2020 2020 2020 3230 3137 2d30 312d 3031        2017-01-01
-00009840: 2020 2020 2030 2e30 0a20 2020 2020 2020       0.0.       
-00009850: 2032 3031 372d 3031 2d30 3220 2020 2020   2017-01-02     
-00009860: 312e 300a 2020 2020 2020 2020 3230 3137  1.0.        2017
-00009870: 2d30 312d 3033 2020 2020 2033 2e30 0a20  -01-03     3.0. 
-00009880: 2020 2020 2020 2032 3031 372d 3031 2d30         2017-01-0
-00009890: 3420 2020 2020 352e 300a 2020 2020 2020  4     5.0.      
-000098a0: 2020 3230 3137 2d30 312d 3035 2020 2020    2017-01-05    
-000098b0: 2037 2e30 0a20 2020 2020 2020 2032 3031   7.0.        201
-000098c0: 372d 3031 2d30 3620 2020 2020 392e 300a  7-01-06     9.0.
-000098d0: 2020 2020 2020 2020 3230 3137 2d30 312d          2017-01-
-000098e0: 3037 2020 2020 3131 2e30 0a20 2020 2020  07    11.0.     
-000098f0: 2020 2032 3031 372d 3031 2d30 3820 2020     2017-01-08   
-00009900: 2031 332e 300a 2020 2020 2020 2020 3230   13.0.        20
-00009910: 3137 2d30 312d 3039 2020 2020 3135 2e30  17-01-09    15.0
-00009920: 0a20 2020 2020 2020 2032 3031 372d 3031  .        2017-01
-00009930: 2d31 3020 2020 2031 372e 300a 2020 2020  -10    17.0.    
-00009940: 2020 2020 4672 6571 3a20 442c 2064 7479      Freq: D, dty
-00009950: 7065 3a20 666c 6f61 7436 340a 2020 2020  pe: float64.    
-00009960: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00009970: 7265 7475 726e 206d 6170 5f6f 7665 726c  return map_overl
-00009980: 6170 280a 2020 2020 2020 2020 2020 2020  ap(.            
-00009990: 6675 6e63 2c0a 2020 2020 2020 2020 2020  func,.          
-000099a0: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-000099b0: 2020 2020 6265 666f 7265 2c0a 2020 2020      before,.    
-000099c0: 2020 2020 2020 2020 6166 7465 722c 0a20          after,. 
-000099d0: 2020 2020 2020 2020 2020 202a 6172 6773             *args
-000099e0: 2c0a 2020 2020 2020 2020 2020 2020 6d65  ,.            me
-000099f0: 7461 3d6d 6574 612c 0a20 2020 2020 2020  ta=meta,.       
-00009a00: 2020 2020 2065 6e66 6f72 6365 5f6d 6574       enforce_met
-00009a10: 6164 6174 613d 656e 666f 7263 655f 6d65  adata=enforce_me
-00009a20: 7461 6461 7461 2c0a 2020 2020 2020 2020  tadata,.        
-00009a30: 2020 2020 7472 616e 7366 6f72 6d5f 6469      transform_di
-00009a40: 7669 7369 6f6e 733d 7472 616e 7366 6f72  visions=transfor
-00009a50: 6d5f 6469 7669 7369 6f6e 732c 0a20 2020  m_divisions,.   
-00009a60: 2020 2020 2020 2020 2063 6c65 6172 5f64           clear_d
-00009a70: 6976 6973 696f 6e73 3d63 6c65 6172 5f64  ivisions=clear_d
-00009a80: 6976 6973 696f 6e73 2c0a 2020 2020 2020  ivisions,.      
-00009a90: 2020 2020 2020 616c 6967 6e5f 6461 7461        align_data
-00009aa0: 6672 616d 6573 3d61 6c69 676e 5f64 6174  frames=align_dat
-00009ab0: 6166 7261 6d65 732c 0a20 2020 2020 2020  aframes,.       
-00009ac0: 2020 2020 202a 2a6b 7761 7267 732c 0a20       **kwargs,. 
-00009ad0: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
-00009ae0: 6620 7265 7061 7274 6974 696f 6e28 0a20  f repartition(. 
-00009af0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-00009b00: 2020 2020 2064 6976 6973 696f 6e73 3a20       divisions: 
-00009b10: 7475 706c 6520 7c20 4e6f 6e65 203d 204e  tuple | None = N
-00009b20: 6f6e 652c 0a20 2020 2020 2020 206e 7061  one,.        npa
-00009b30: 7274 6974 696f 6e73 3a20 696e 7420 7c20  rtitions: int | 
-00009b40: 4e6f 6e65 203d 204e 6f6e 652c 0a20 2020  None = None,.   
-00009b50: 2020 2020 2070 6172 7469 7469 6f6e 5f73       partition_s
-00009b60: 697a 653a 2073 7472 203d 204e 6f6e 652c  ize: str = None,
-00009b70: 0a20 2020 2020 2020 2066 7265 713d 4e6f  .        freq=No
-00009b80: 6e65 2c0a 2020 2020 2020 2020 666f 7263  ne,.        forc
-00009b90: 653a 2062 6f6f 6c20 3d20 4661 6c73 652c  e: bool = False,
-00009ba0: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
-00009bb0: 2222 2252 6570 6172 7469 7469 6f6e 2061  """Repartition a
-00009bc0: 2063 6f6c 6c65 6374 696f 6e0a 0a20 2020   collection..   
-00009bd0: 2020 2020 2045 7861 6374 6c79 206f 6e65       Exactly one
-00009be0: 206f 6620 6064 6976 6973 696f 6e73 602c   of `divisions`,
-00009bf0: 2060 6e70 6172 7469 7469 6f6e 7360 206f   `npartitions` o
-00009c00: 7220 6070 6172 7469 7469 6f6e 5f73 697a  r `partition_siz
-00009c10: 6560 2073 686f 756c 6420 6265 0a20 2020  e` should be.   
-00009c20: 2020 2020 2073 7065 6369 6669 6564 2e20       specified. 
-00009c30: 4120 6060 5661 6c75 6545 7272 6f72 6060  A ``ValueError``
-00009c40: 2077 696c 6c20 6265 2072 6169 7365 6420   will be raised 
-00009c50: 7768 656e 2074 6861 7420 6973 206e 6f74  when that is not
-00009c60: 2074 6865 2063 6173 652e 0a0a 2020 2020   the case...    
-00009c70: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
-00009c80: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-00009c90: 2d0a 2020 2020 2020 2020 6469 7669 7369  -.        divisi
-00009ca0: 6f6e 7320 3a20 6c69 7374 2c20 6f70 7469  ons : list, opti
-00009cb0: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
-00009cc0: 2054 6865 2022 6469 7669 6469 6e67 206c   The "dividing l
-00009cd0: 696e 6573 2220 7573 6564 2074 6f20 7370  ines" used to sp
-00009ce0: 6c69 7420 7468 6520 6461 7461 6672 616d  lit the datafram
-00009cf0: 6520 696e 746f 2070 6172 7469 7469 6f6e  e into partition
-00009d00: 732e 0a20 2020 2020 2020 2020 2020 2046  s..            F
-00009d10: 6f72 2060 6064 6976 6973 696f 6e73 3d5b  or ``divisions=[
-00009d20: 302c 2031 302c 2035 302c 2031 3030 5d60  0, 10, 50, 100]`
-00009d30: 602c 2074 6865 7265 2077 6f75 6c64 2062  `, there would b
-00009d40: 6520 7468 7265 6520 6f75 7470 7574 2070  e three output p
-00009d50: 6172 7469 7469 6f6e 732c 0a20 2020 2020  artitions,.     
-00009d60: 2020 2020 2020 2077 6865 7265 2074 6865         where the
-00009d70: 206e 6577 2069 6e64 6578 2063 6f6e 7461   new index conta
-00009d80: 696e 6564 205b 302c 2031 3029 2c20 5b31  ined [0, 10), [1
-00009d90: 302c 2035 3029 2c20 616e 6420 5b35 302c  0, 50), and [50,
-00009da0: 2031 3030 292c 2072 6573 7065 6374 6976   100), respectiv
-00009db0: 656c 792e 0a20 2020 2020 2020 2020 2020  ely..           
-00009dc0: 2053 6565 2068 7474 7073 3a2f 2f64 6f63   See https://doc
-00009dd0: 732e 6461 736b 2e6f 7267 2f65 6e2f 6c61  s.dask.org/en/la
-00009de0: 7465 7374 2f64 6174 6166 7261 6d65 2d64  test/dataframe-d
-00009df0: 6573 6967 6e2e 6874 6d6c 2370 6172 7469  esign.html#parti
-00009e00: 7469 6f6e 732e 0a20 2020 2020 2020 206e  tions..        n
-00009e10: 7061 7274 6974 696f 6e73 203a 2069 6e74  partitions : int
-00009e20: 2c20 4361 6c6c 6162 6c65 2c20 6f70 7469  , Callable, opti
-00009e30: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
-00009e40: 2041 7070 726f 7869 6d61 7465 206e 756d   Approximate num
-00009e50: 6265 7220 6f66 2070 6172 7469 7469 6f6e  ber of partition
-00009e60: 7320 6f66 206f 7574 7075 742e 2054 6865  s of output. The
-00009e70: 206e 756d 6265 7220 6f66 0a20 2020 2020   number of.     
-00009e80: 2020 2020 2020 2070 6172 7469 7469 6f6e         partition
-00009e90: 7320 7573 6564 206d 6179 2062 6520 736c  s used may be sl
-00009ea0: 6967 6874 6c79 206c 6f77 6572 2074 6861  ightly lower tha
-00009eb0: 6e20 6e70 6172 7469 7469 6f6e 7320 6465  n npartitions de
-00009ec0: 7065 6e64 696e 670a 2020 2020 2020 2020  pending.        
-00009ed0: 2020 2020 6f6e 2064 6174 6120 6469 7374      on data dist
-00009ee0: 7269 6275 7469 6f6e 2c20 6275 7420 7769  ribution, but wi
-00009ef0: 6c6c 206e 6576 6572 2062 6520 6869 6768  ll never be high
-00009f00: 6572 2e0a 2020 2020 2020 2020 2020 2020  er..            
-00009f10: 5468 6520 4361 6c6c 6162 6c65 2067 6574  The Callable get
-00009f20: 7320 7468 6520 6e75 6d62 6572 206f 6620  s the number of 
-00009f30: 7061 7274 6974 696f 6e73 206f 6620 7468  partitions of th
-00009f40: 6520 696e 7075 7420 6173 2061 6e20 6172  e input as an ar
-00009f50: 6775 6d65 6e74 0a20 2020 2020 2020 2020  gument.         
-00009f60: 2020 2061 6e64 2073 686f 756c 6420 7265     and should re
-00009f70: 7475 726e 2061 6e20 696e 742e 0a20 2020  turn an int..   
-00009f80: 2020 2020 2070 6172 7469 7469 6f6e 5f73       partition_s
-00009f90: 697a 6520 3a20 7374 722c 206f 7074 696f  ize : str, optio
-00009fa0: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
-00009fb0: 4d61 7820 6e75 6d62 6572 206f 6620 6279  Max number of by
-00009fc0: 7465 7320 6f66 206d 656d 6f72 7920 666f  tes of memory fo
-00009fd0: 7220 6561 6368 2070 6172 7469 7469 6f6e  r each partition
-00009fe0: 2e20 5573 6520 6e75 6d62 6572 7320 6f72  . Use numbers or
-00009ff0: 2073 7472 696e 6773 0a20 2020 2020 2020   strings.       
-0000a000: 2020 2020 206c 696b 6520 354d 422e 2049       like 5MB. I
-0000a010: 6620 7370 6563 6966 6965 6420 6e70 6172  f specified npar
-0000a020: 7469 7469 6f6e 7320 616e 6420 6469 7669  titions and divi
-0000a030: 7369 6f6e 7320 7769 6c6c 2062 6520 6967  sions will be ig
-0000a040: 6e6f 7265 642e 204e 6f74 6520 7468 6174  nored. Note that
-0000a050: 0a20 2020 2020 2020 2020 2020 2074 6865  .            the
-0000a060: 2073 697a 6520 7265 666c 6563 7473 2074   size reflects t
-0000a070: 6865 206e 756d 6265 7220 6f66 2062 7974  he number of byt
-0000a080: 6573 2075 7365 6420 6173 2063 6f6d 7075  es used as compu
-0000a090: 7465 6420 6279 0a20 2020 2020 2020 2020  ted by.         
-0000a0a0: 2020 2070 616e 6461 732e 4461 7461 4672     pandas.DataFr
-0000a0b0: 616d 652e 6d65 6d6f 7279 5f75 7361 6765  ame.memory_usage
-0000a0c0: 2c20 7768 6963 6820 7769 6c6c 206e 6f74  , which will not
-0000a0d0: 206e 6563 6573 7361 7269 6c79 206d 6174   necessarily mat
-0000a0e0: 6368 2074 6865 2073 697a 650a 2020 2020  ch the size.    
-0000a0f0: 2020 2020 2020 2020 7768 656e 2073 746f          when sto
-0000a100: 7269 6e67 2074 6f20 6469 736b 2e0a 0a20  ring to disk... 
-0000a110: 2020 2020 2020 2020 2020 202e 2e20 7761             .. wa
-0000a120: 726e 696e 673a 3a0a 0a20 2020 2020 2020  rning::..       
-0000a130: 2020 2020 2020 2020 5468 6973 206b 6579          This key
-0000a140: 776f 7264 2061 7267 756d 656e 7420 7472  word argument tr
-0000a150: 6967 6765 7273 2063 6f6d 7075 7461 7469  iggers computati
-0000a160: 6f6e 2074 6f20 6465 7465 726d 696e 650a  on to determine.
-0000a170: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-0000a180: 6865 206d 656d 6f72 7920 7369 7a65 206f  he memory size o
-0000a190: 6620 6561 6368 2070 6172 7469 7469 6f6e  f each partition
-0000a1a0: 2c20 7768 6963 6820 6d61 7920 6265 2065  , which may be e
-0000a1b0: 7870 656e 7369 7665 2e0a 0a20 2020 2020  xpensive...     
-0000a1c0: 2020 2066 6f72 6365 203a 2062 6f6f 6c2c     force : bool,
-0000a1d0: 2064 6566 6175 6c74 2046 616c 7365 0a20   default False. 
-0000a1e0: 2020 2020 2020 2020 2020 2041 6c6c 6f77             Allow
-0000a1f0: 7320 7468 6520 6578 7061 6e73 696f 6e20  s the expansion 
-0000a200: 6f66 2074 6865 2065 7869 7374 696e 6720  of the existing 
-0000a210: 6469 7669 7369 6f6e 732e 0a20 2020 2020  divisions..     
-0000a220: 2020 2020 2020 2049 6620 4661 6c73 6520         If False 
-0000a230: 7468 656e 2074 6865 206e 6577 2064 6976  then the new div
-0000a240: 6973 696f 6e73 2720 6c6f 7765 7220 616e  isions' lower an
-0000a250: 6420 7570 7065 7220 626f 756e 6473 206d  d upper bounds m
-0000a260: 7573 7420 6265 0a20 2020 2020 2020 2020  ust be.         
-0000a270: 2020 2074 6865 2073 616d 6520 6173 2074     the same as t
-0000a280: 6865 206f 6c64 2064 6976 6973 696f 6e73  he old divisions
-0000a290: 272e 0a20 2020 2020 2020 2066 7265 7120  '..        freq 
-0000a2a0: 3a20 7374 722c 2070 642e 5469 6d65 6465  : str, pd.Timede
-0000a2b0: 6c74 610a 2020 2020 2020 2020 2020 2020  lta.            
-0000a2c0: 4120 7065 7269 6f64 206f 6e20 7768 6963  A period on whic
-0000a2d0: 6820 746f 2070 6172 7469 7469 6f6e 2074  h to partition t
-0000a2e0: 696d 6573 6572 6965 7320 6461 7461 206c  imeseries data l
-0000a2f0: 696b 6520 6060 2737 4427 6060 206f 720a  ike ``'7D'`` or.
-0000a300: 2020 2020 2020 2020 2020 2020 6060 2731              ``'1
-0000a310: 3268 2760 6020 6f72 2060 6070 642e 5469  2h'`` or ``pd.Ti
-0000a320: 6d65 6465 6c74 6128 686f 7572 733d 3132  medelta(hours=12
-0000a330: 2960 602e 2020 4173 7375 6d65 7320 6120  )``.  Assumes a 
-0000a340: 6461 7465 7469 6d65 2069 6e64 6578 2e0a  datetime index..
-0000a350: 0a20 2020 2020 2020 204e 6f74 6573 0a20  .        Notes. 
-0000a360: 2020 2020 2020 202d 2d2d 2d2d 0a20 2020         -----.   
-0000a370: 2020 2020 2045 7861 6374 6c79 206f 6e65       Exactly one
-0000a380: 206f 6620 6064 6976 6973 696f 6e73 602c   of `divisions`,
-0000a390: 2060 6e70 6172 7469 7469 6f6e 7360 2c20   `npartitions`, 
-0000a3a0: 6070 6172 7469 7469 6f6e 5f73 697a 6560  `partition_size`
-0000a3b0: 2c20 6f72 2060 6672 6571 600a 2020 2020  , or `freq`.    
-0000a3c0: 2020 2020 7368 6f75 6c64 2062 6520 7370      should be sp
-0000a3d0: 6563 6966 6965 642e 2041 2060 6056 616c  ecified. A ``Val
-0000a3e0: 7565 4572 726f 7260 6020 7769 6c6c 2062  ueError`` will b
-0000a3f0: 6520 7261 6973 6564 2077 6865 6e20 7468  e raised when th
-0000a400: 6174 2069 730a 2020 2020 2020 2020 6e6f  at is.        no
-0000a410: 7420 7468 6520 6361 7365 2e0a 0a20 2020  t the case...   
-0000a420: 2020 2020 2041 6c73 6f20 6e6f 7465 2074       Also note t
-0000a430: 6861 7420 6060 6c65 6e28 6469 7669 736f  hat ``len(diviso
-0000a440: 6e73 2960 6020 6973 2065 7175 616c 2074  ns)`` is equal t
-0000a450: 6f20 6060 6e70 6172 7469 7469 6f6e 7320  o ``npartitions 
-0000a460: 2b20 3160 602e 2054 6869 7320 6973 2062  + 1``. This is b
-0000a470: 6563 6175 7365 2060 6064 6976 6973 696f  ecause ``divisio
-0000a480: 6e73 6060 0a20 2020 2020 2020 2072 6570  ns``.        rep
-0000a490: 7265 7365 6e74 7320 7468 6520 7570 7065  resents the uppe
-0000a4a0: 7220 616e 6420 6c6f 7765 7220 626f 756e  r and lower boun
-0000a4b0: 6473 206f 6620 6561 6368 2070 6172 7469  ds of each parti
-0000a4c0: 7469 6f6e 2e20 5468 6520 6669 7273 7420  tion. The first 
-0000a4d0: 6974 656d 2069 7320 7468 650a 2020 2020  item is the.    
-0000a4e0: 2020 2020 6c6f 7765 7220 626f 756e 6420      lower bound 
-0000a4f0: 6f66 2074 6865 2066 6972 7374 2070 6172  of the first par
-0000a500: 7469 7469 6f6e 2c20 7468 6520 7365 636f  tition, the seco
-0000a510: 6e64 2069 7465 6d20 6973 2074 6865 206c  nd item is the l
-0000a520: 6f77 6572 2062 6f75 6e64 206f 6620 7468  ower bound of th
-0000a530: 650a 2020 2020 2020 2020 7365 636f 6e64  e.        second
-0000a540: 2070 6172 7469 7469 6f6e 2061 6e64 2074   partition and t
-0000a550: 6865 2075 7070 6572 2062 6f75 6e64 206f  he upper bound o
-0000a560: 6620 7468 6520 6669 7273 7420 7061 7274  f the first part
-0000a570: 6974 696f 6e2c 2061 6e64 2073 6f20 6f6e  ition, and so on
-0000a580: 2e0a 2020 2020 2020 2020 5468 6520 7365  ..        The se
-0000a590: 636f 6e64 2d74 6f2d 6c61 7374 2069 7465  cond-to-last ite
-0000a5a0: 6d20 6973 2074 6865 206c 6f77 6572 2062  m is the lower b
-0000a5b0: 6f75 6e64 206f 6620 7468 6520 6c61 7374  ound of the last
-0000a5c0: 2070 6172 7469 7469 6f6e 2c20 616e 6420   partition, and 
-0000a5d0: 7468 6520 6c61 7374 0a20 2020 2020 2020  the last.       
-0000a5e0: 2028 6578 7472 6129 2069 7465 6d20 6973   (extra) item is
-0000a5f0: 2074 6865 2075 7070 6572 2062 6f75 6e64   the upper bound
-0000a600: 206f 6620 7468 6520 6c61 7374 2070 6172   of the last par
-0000a610: 7469 7469 6f6e 2e0a 0a20 2020 2020 2020  tition...       
-0000a620: 2045 7861 6d70 6c65 730a 2020 2020 2020   Examples.      
-0000a630: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020    --------.     
-0000a640: 2020 203e 3e3e 2064 6620 3d20 6466 2e72     >>> df = df.r
-0000a650: 6570 6172 7469 7469 6f6e 286e 7061 7274  epartition(npart
-0000a660: 6974 696f 6e73 3d31 3029 2020 2320 646f  itions=10)  # do
-0000a670: 6374 6573 743a 202b 534b 4950 0a20 2020  ctest: +SKIP.   
-0000a680: 2020 2020 203e 3e3e 2064 6620 3d20 6466       >>> df = df
-0000a690: 2e72 6570 6172 7469 7469 6f6e 2864 6976  .repartition(div
-0000a6a0: 6973 696f 6e73 3d5b 302c 2035 2c20 3130  isions=[0, 5, 10
-0000a6b0: 2c20 3230 5d29 2020 2320 646f 6374 6573  , 20])  # doctes
-0000a6c0: 743a 202b 534b 4950 0a20 2020 2020 2020  t: +SKIP.       
-0000a6d0: 203e 3e3e 2064 6620 3d20 6466 2e72 6570   >>> df = df.rep
-0000a6e0: 6172 7469 7469 6f6e 2866 7265 713d 2737  artition(freq='7
-0000a6f0: 6427 2920 2023 2064 6f63 7465 7374 3a20  d')  # doctest: 
-0000a700: 2b53 4b49 500a 0a20 2020 2020 2020 2053  +SKIP..        S
-0000a710: 6565 2041 6c73 6f0a 2020 2020 2020 2020  ee Also.        
-0000a720: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-0000a730: 2044 6174 6146 7261 6d65 2e6d 656d 6f72   DataFrame.memor
-0000a740: 795f 7573 6167 655f 7065 725f 7061 7274  y_usage_per_part
-0000a750: 6974 696f 6e0a 2020 2020 2020 2020 7061  ition.        pa
-0000a760: 6e64 6173 2e44 6174 6146 7261 6d65 2e6d  ndas.DataFrame.m
-0000a770: 656d 6f72 795f 7573 6167 650a 2020 2020  emory_usage.    
-0000a780: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
-0000a790: 2069 6620 280a 2020 2020 2020 2020 2020   if (.          
-0000a7a0: 2020 7375 6d28 0a20 2020 2020 2020 2020    sum(.         
-0000a7b0: 2020 2020 2020 205b 0a20 2020 2020 2020         [.       
-0000a7c0: 2020 2020 2020 2020 2020 2020 2064 6976               div
-0000a7d0: 6973 696f 6e73 2069 7320 6e6f 7420 4e6f  isions is not No
-0000a7e0: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
-0000a7f0: 2020 2020 2020 2020 6e70 6172 7469 7469          npartiti
-0000a800: 6f6e 7320 6973 206e 6f74 204e 6f6e 652c  ons is not None,
-0000a810: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000a820: 2020 2020 2070 6172 7469 7469 6f6e 5f73       partition_s
-0000a830: 697a 6520 6973 206e 6f74 204e 6f6e 652c  ize is not None,
-0000a840: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000a850: 2020 2020 2066 7265 7120 6973 206e 6f74       freq is not
-0000a860: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
-0000a870: 2020 2020 2020 205d 0a20 2020 2020 2020         ].       
-0000a880: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-0000a890: 2020 2021 3d20 310a 2020 2020 2020 2020     != 1.        
-0000a8a0: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
-0000a8b0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-0000a8c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000a8d0: 2022 506c 6561 7365 2070 726f 7669 6465   "Please provide
-0000a8e0: 2065 7861 6374 6c79 206f 6e65 206f 6620   exactly one of 
-0000a8f0: 7468 6520 6060 6e70 6172 7469 7469 6f6e  the ``npartition
-0000a900: 733d 6060 206f 7220 220a 2020 2020 2020  s=`` or ".      
-0000a910: 2020 2020 2020 2020 2020 2260 6064 6976            "``div
-0000a920: 6973 696f 6e73 3d60 6020 6b65 7977 6f72  isions=`` keywor
-0000a930: 6420 6172 6775 6d65 6e74 732e 220a 2020  d arguments.".  
-0000a940: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0000a950: 2020 2020 6966 2064 6976 6973 696f 6e73      if divisions
-0000a960: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-0000a970: 2020 2020 2020 2020 2020 6368 6563 6b5f            check_
-0000a980: 6469 7669 7369 6f6e 7328 6469 7669 7369  divisions(divisi
-0000a990: 6f6e 7329 0a20 2020 2020 2020 2069 6620  ons).        if 
-0000a9a0: 6672 6571 2069 7320 6e6f 7420 4e6f 6e65  freq is not None
-0000a9b0: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-0000a9c0: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
-0000a9d0: 7365 6c66 2e64 6976 6973 696f 6e73 5b30  self.divisions[0
-0000a9e0: 5d2c 2070 642e 5469 6d65 7374 616d 7029  ], pd.Timestamp)
-0000a9f0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0000aa00: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
-0000aa10: 7228 2243 616e 206f 6e6c 7920 7265 7061  r("Can only repa
-0000aa20: 7274 6974 696f 6e20 6f6e 2066 7265 7175  rtition on frequ
-0000aa30: 656e 6379 2066 6f72 2074 696d 6573 6572  ency for timeser
-0000aa40: 6965 7322 290a 2020 2020 2020 2020 2020  ies").          
-0000aa50: 2020 7265 7475 726e 206e 6577 5f63 6f6c    return new_col
-0000aa60: 6c65 6374 696f 6e28 5265 7061 7274 6974  lection(Repartit
-0000aa70: 696f 6e46 7265 7128 7365 6c66 2c20 6672  ionFreq(self, fr
-0000aa80: 6571 2929 0a20 2020 2020 2020 2065 6c73  eq)).        els
-0000aa90: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-0000aaa0: 6574 7572 6e20 6e65 775f 636f 6c6c 6563  eturn new_collec
-0000aab0: 7469 6f6e 280a 2020 2020 2020 2020 2020  tion(.          
-0000aac0: 2020 2020 2020 5265 7061 7274 6974 696f        Repartitio
-0000aad0: 6e28 7365 6c66 2c20 6e70 6172 7469 7469  n(self, npartiti
-0000aae0: 6f6e 732c 2064 6976 6973 696f 6e73 2c20  ons, divisions, 
-0000aaf0: 666f 7263 652c 2070 6172 7469 7469 6f6e  force, partition
-0000ab00: 5f73 697a 652c 2066 7265 7129 0a20 2020  _size, freq).   
-0000ab10: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-0000ab20: 6465 6620 746f 5f64 6173 6b5f 6461 7461  def to_dask_data
-0000ab30: 6672 616d 6528 7365 6c66 2c20 6f70 7469  frame(self, opti
-0000ab40: 6d69 7a65 3a20 626f 6f6c 203d 2054 7275  mize: bool = Tru
-0000ab50: 652c 202a 2a6f 7074 696d 697a 655f 6b77  e, **optimize_kw
-0000ab60: 6172 6773 2920 2d3e 205f 4672 616d 653a  args) -> _Frame:
-0000ab70: 0a20 2020 2020 2020 2022 2222 436f 6e76  .        """Conv
-0000ab80: 6572 7420 746f 2061 2064 6173 6b2d 6461  ert to a dask-da
-0000ab90: 7461 6672 616d 6520 636f 6c6c 6563 7469  taframe collecti
-0000aba0: 6f6e 0a0a 2020 2020 2020 2020 5061 7261  on..        Para
-0000abb0: 6d65 7465 7273 0a20 2020 2020 2020 202d  meters.        -
-0000abc0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-0000abd0: 2020 6f70 7469 6d69 7a65 0a20 2020 2020    optimize.     
-0000abe0: 2020 2020 2020 2057 6865 7468 6572 2074         Whether t
-0000abf0: 6f20 6f70 7469 6d69 7a65 2074 6865 2075  o optimize the u
-0000ac00: 6e64 6572 6c79 696e 6720 6045 7870 7260  nderlying `Expr`
-0000ac10: 206f 626a 6563 7420 6265 666f 7265 2063   object before c
-0000ac20: 6f6e 7665 7273 696f 6e2e 0a20 2020 2020  onversion..     
-0000ac30: 2020 202a 2a6f 7074 696d 697a 655f 6b77     **optimize_kw
-0000ac40: 6172 6773 0a20 2020 2020 2020 2020 2020  args.           
-0000ac50: 204b 6579 2d77 6f72 6420 6172 6775 6d65   Key-word argume
-0000ac60: 6e74 7320 746f 2070 6173 7320 7468 726f  nts to pass thro
-0000ac70: 7567 6820 746f 2060 6f70 7469 6d69 7a65  ugh to `optimize
-0000ac80: 602e 0a20 2020 2020 2020 2022 2222 0a20  `..        """. 
-0000ac90: 2020 2020 2020 2064 6620 3d20 7365 6c66         df = self
-0000aca0: 2e6f 7074 696d 697a 6528 2a2a 6f70 7469  .optimize(**opti
-0000acb0: 6d69 7a65 5f6b 7761 7267 7329 2069 6620  mize_kwargs) if 
-0000acc0: 6f70 7469 6d69 7a65 2065 6c73 6520 7365  optimize else se
-0000acd0: 6c66 0a20 2020 2020 2020 2072 6574 7572  lf.        retur
-0000ace0: 6e20 6e65 775f 6464 5f6f 626a 6563 7428  n new_dd_object(
-0000acf0: 6466 2e64 6173 6b2c 2064 662e 5f6e 616d  df.dask, df._nam
-0000ad00: 652c 2064 662e 5f6d 6574 612c 2064 662e  e, df._meta, df.
-0000ad10: 6469 7669 7369 6f6e 7329 0a0a 2020 2020  divisions)..    
-0000ad20: 6465 6620 746f 5f64 6173 6b5f 6172 7261  def to_dask_arra
-0000ad30: 7928 0a20 2020 2020 2020 2073 656c 662c  y(.        self,
-0000ad40: 206c 656e 6774 6873 3d4e 6f6e 652c 206d   lengths=None, m
-0000ad50: 6574 613d 4e6f 6e65 2c20 6f70 7469 6d69  eta=None, optimi
-0000ad60: 7a65 3a20 626f 6f6c 203d 2054 7275 652c  ze: bool = True,
-0000ad70: 202a 2a6f 7074 696d 697a 655f 6b77 6172   **optimize_kwar
-0000ad80: 6773 0a20 2020 2029 202d 3e20 4172 7261  gs.    ) -> Arra
-0000ad90: 793a 0a20 2020 2020 2020 2022 2222 436f  y:.        """Co
-0000ada0: 6e76 6572 7420 6120 6461 736b 2044 6174  nvert a dask Dat
-0000adb0: 6146 7261 6d65 2074 6f20 6120 6461 736b  aFrame to a dask
-0000adc0: 2061 7272 6179 2e0a 0a20 2020 2020 2020   array...       
-0000add0: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-0000ade0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
-0000adf0: 2020 2020 2020 206c 656e 6774 6873 203a         lengths :
-0000ae00: 2062 6f6f 6c20 6f72 2053 6571 7565 6e63   bool or Sequenc
-0000ae10: 6520 6f66 2069 6e74 732c 206f 7074 696f  e of ints, optio
-0000ae20: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
-0000ae30: 486f 7720 746f 2064 6574 6572 6d69 6e65  How to determine
-0000ae40: 2074 6865 2063 6875 6e6b 7320 7369 7a65   the chunks size
-0000ae50: 7320 666f 7220 7468 6520 6f75 7470 7574  s for the output
-0000ae60: 2061 7272 6179 2e0a 2020 2020 2020 2020   array..        
-0000ae70: 2020 2020 4279 2064 6566 6175 6c74 2c20      By default, 
-0000ae80: 7468 6520 6f75 7470 7574 2061 7272 6179  the output array
-0000ae90: 2077 696c 6c20 6861 7665 2075 6e6b 6e6f   will have unkno
-0000aea0: 776e 2063 6875 6e6b 206c 656e 6774 6873  wn chunk lengths
-0000aeb0: 0a20 2020 2020 2020 2020 2020 2061 6c6f  .            alo
-0000aec0: 6e67 2074 6865 2066 6972 7374 2061 7869  ng the first axi
-0000aed0: 732c 2077 6869 6368 2063 616e 2063 6175  s, which can cau
-0000aee0: 7365 2073 6f6d 6520 6c61 7465 7220 6f70  se some later op
-0000aef0: 6572 6174 696f 6e73 0a20 2020 2020 2020  erations.       
-0000af00: 2020 2020 2074 6f20 6661 696c 2e0a 0a20       to fail... 
-0000af10: 2020 2020 2020 2020 2020 202a 2054 7275             * Tru
-0000af20: 6520 3a20 696d 6d65 6469 6174 656c 7920  e : immediately 
-0000af30: 636f 6d70 7574 6520 7468 6520 6c65 6e67  compute the leng
-0000af40: 7468 206f 6620 6561 6368 2070 6172 7469  th of each parti
-0000af50: 7469 6f6e 0a20 2020 2020 2020 2020 2020  tion.           
-0000af60: 202a 2053 6571 7565 6e63 6520 3a20 6120   * Sequence : a 
-0000af70: 7365 7175 656e 6365 206f 6620 696e 7465  sequence of inte
-0000af80: 6765 7273 2074 6f20 7573 6520 666f 7220  gers to use for 
-0000af90: 7468 6520 6368 756e 6b20 7369 7a65 730a  the chunk sizes.
-0000afa0: 2020 2020 2020 2020 2020 2020 2020 6f6e                on
-0000afb0: 2074 6865 2066 6972 7374 2061 7869 732e   the first axis.
-0000afc0: 2054 6865 7365 2076 616c 7565 7320 6172   These values ar
-0000afd0: 6520 2a6e 6f74 2a20 7661 6c69 6461 7465  e *not* validate
-0000afe0: 6420 666f 720a 2020 2020 2020 2020 2020  d for.          
-0000aff0: 2020 2020 636f 7272 6563 746e 6573 732c      correctness,
-0000b000: 2062 6579 6f6e 6420 656e 7375 7269 6e67   beyond ensuring
-0000b010: 2074 6861 7420 7468 6520 6e75 6d62 6572   that the number
-0000b020: 206f 6620 6974 656d 730a 2020 2020 2020   of items.      
-0000b030: 2020 2020 2020 2020 6d61 7463 6865 7320          matches 
-0000b040: 7468 6520 6e75 6d62 6572 206f 6620 7061  the number of pa
-0000b050: 7274 6974 696f 6e73 2e0a 2020 2020 2020  rtitions..      
-0000b060: 2020 6d65 7461 203a 206f 626a 6563 742c    meta : object,
-0000b070: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-0000b080: 2020 2020 2020 416e 206f 7074 696f 6e61        An optiona
-0000b090: 6c20 606d 6574 6160 2070 6172 616d 6574  l `meta` paramet
-0000b0a0: 6572 2063 616e 2062 6520 7061 7373 6564  er can be passed
-0000b0b0: 2066 6f72 2064 6173 6b20 746f 206f 7665   for dask to ove
-0000b0c0: 7272 6964 6520 7468 650a 2020 2020 2020  rride the.      
-0000b0d0: 2020 2020 2020 6465 6661 756c 7420 6d65        default me
-0000b0e0: 7461 6461 7461 206f 6e20 7468 6520 756e  tadata on the un
-0000b0f0: 6465 726c 7969 6e67 2064 6173 6b20 6172  derlying dask ar
-0000b100: 7261 792e 0a20 2020 2020 2020 206f 7074  ray..        opt
-0000b110: 696d 697a 6520 3a20 626f 6f6c 0a20 2020  imize : bool.   
-0000b120: 2020 2020 2020 2020 2057 6865 7468 6572           Whether
-0000b130: 2074 6f20 6f70 7469 6d69 7a65 2074 6865   to optimize the
-0000b140: 2065 7870 7265 7373 696f 6e20 6265 666f   expression befo
-0000b150: 7265 2063 6f6e 7665 7274 696e 6720 746f  re converting to
-0000b160: 2061 6e20 4172 7261 792e 0a0a 2020 2020   an Array...    
-0000b170: 2020 2020 5265 7475 726e 730a 2020 2020      Returns.    
-0000b180: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
-0000b190: 2020 2020 4120 4461 736b 2041 7272 6179      A Dask Array
-0000b1a0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0000b1b0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0000b1c0: 2e74 6f5f 6461 736b 5f64 6174 6166 7261  .to_dask_datafra
-0000b1d0: 6d65 286f 7074 696d 697a 652c 202a 2a6f  me(optimize, **o
-0000b1e0: 7074 696d 697a 655f 6b77 6172 6773 292e  ptimize_kwargs).
-0000b1f0: 746f 5f64 6173 6b5f 6172 7261 7928 0a20  to_dask_array(. 
-0000b200: 2020 2020 2020 2020 2020 206c 656e 6774             lengt
-0000b210: 6873 3d6c 656e 6774 6873 2c20 6d65 7461  hs=lengths, meta
-0000b220: 3d6d 6574 610a 2020 2020 2020 2020 290a  =meta.        ).
-0000b230: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
-0000b240: 2020 2064 6566 2076 616c 7565 7328 7365     def values(se
-0000b250: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-0000b260: 5265 7475 726e 2061 2064 6173 6b2e 6172  Return a dask.ar
-0000b270: 7261 7920 6f66 2074 6865 2076 616c 7565  ray of the value
-0000b280: 7320 6f66 2074 6869 7320 6461 7461 6672  s of this datafr
-0000b290: 616d 650a 0a20 2020 2020 2020 2057 6172  ame..        War
-0000b2a0: 6e69 6e67 3a20 5468 6973 2063 7265 6174  ning: This creat
-0000b2b0: 6573 2061 2064 6173 6b2e 6172 7261 7920  es a dask.array 
-0000b2c0: 7769 7468 6f75 7420 7072 6563 6973 6520  without precise 
-0000b2d0: 7368 6170 6520 696e 666f 726d 6174 696f  shape informatio
-0000b2e0: 6e2e 0a20 2020 2020 2020 204f 7065 7261  n..        Opera
-0000b2f0: 7469 6f6e 7320 7468 6174 2064 6570 656e  tions that depen
-0000b300: 6420 6f6e 2073 6861 7065 2069 6e66 6f72  d on shape infor
-0000b310: 6d61 7469 6f6e 2c20 6c69 6b65 2073 6c69  mation, like sli
-0000b320: 6369 6e67 206f 7220 7265 7368 6170 696e  cing or reshapin
-0000b330: 672c 0a20 2020 2020 2020 2077 696c 6c20  g,.        will 
-0000b340: 6e6f 7420 776f 726b 2e0a 2020 2020 2020  not work..      
-0000b350: 2020 2222 220a 2020 2020 2020 2020 7265    """.        re
-0000b360: 7475 726e 2073 656c 662e 746f 5f64 6173  turn self.to_das
-0000b370: 6b5f 6172 7261 7928 290a 0a20 2020 2064  k_array()..    d
-0000b380: 6566 205f 5f64 6976 6d6f 645f 5f28 7365  ef __divmod__(se
-0000b390: 6c66 2c20 6f74 6865 7229 3a0a 2020 2020  lf, other):.    
-0000b3a0: 2020 2020 7265 7375 6c74 203d 2073 656c      result = sel
-0000b3b0: 662e 6578 7072 2e5f 5f64 6976 6d6f 645f  f.expr.__divmod_
-0000b3c0: 5f28 6f74 6865 7229 0a20 2020 2020 2020  _(other).       
-0000b3d0: 2072 6574 7572 6e20 6e65 775f 636f 6c6c   return new_coll
-0000b3e0: 6563 7469 6f6e 2872 6573 756c 745b 305d  ection(result[0]
-0000b3f0: 292c 206e 6577 5f63 6f6c 6c65 6374 696f  ), new_collectio
-0000b400: 6e28 7265 7375 6c74 5b31 5d29 0a0a 2020  n(result[1])..  
-0000b410: 2020 6465 6620 5f5f 7264 6976 6d6f 645f    def __rdivmod_
-0000b420: 5f28 7365 6c66 2c20 6f74 6865 7229 3a0a  _(self, other):.
-0000b430: 2020 2020 2020 2020 7265 7375 6c74 203d          result =
-0000b440: 2073 656c 662e 6578 7072 2e5f 5f72 6469   self.expr.__rdi
-0000b450: 766d 6f64 5f5f 286f 7468 6572 290a 2020  vmod__(other).  
-0000b460: 2020 2020 2020 7265 7475 726e 206e 6577        return new
-0000b470: 5f63 6f6c 6c65 6374 696f 6e28 7265 7375  _collection(resu
-0000b480: 6c74 5b30 5d29 2c20 6e65 775f 636f 6c6c  lt[0]), new_coll
-0000b490: 6563 7469 6f6e 2872 6573 756c 745b 315d  ection(result[1]
-0000b4a0: 290a 0a20 2020 2064 6566 205f 5f61 6273  )..    def __abs
-0000b4b0: 5f5f 2873 656c 6629 3a0a 2020 2020 2020  __(self):.      
-0000b4c0: 2020 7265 7475 726e 2073 656c 662e 6162    return self.ab
-0000b4d0: 7328 290a 0a20 2020 2040 6465 7269 7665  s()..    @derive
-0000b4e0: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
-0000b4f0: 616d 6529 0a20 2020 2064 6566 2073 756d  ame).    def sum
-0000b500: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-0000b510: 2020 2020 2020 2020 6178 6973 3d30 2c0a          axis=0,.
-0000b520: 2020 2020 2020 2020 736b 6970 6e61 3d54          skipna=T
-0000b530: 7275 652c 0a20 2020 2020 2020 206e 756d  rue,.        num
-0000b540: 6572 6963 5f6f 6e6c 793d 4661 6c73 652c  eric_only=False,
-0000b550: 0a20 2020 2020 2020 206d 696e 5f63 6f75  .        min_cou
-0000b560: 6e74 3d30 2c0a 2020 2020 2020 2020 7370  nt=0,.        sp
-0000b570: 6c69 745f 6576 6572 793d 4661 6c73 652c  lit_every=False,
-0000b580: 0a20 2020 2020 2020 202a 2a6b 7761 7267  .        **kwarg
-0000b590: 732c 0a20 2020 2029 3a0a 2020 2020 2020  s,.    ):.      
-0000b5a0: 2020 6178 6973 203d 2073 656c 662e 5f76    axis = self._v
-0000b5b0: 616c 6964 6174 655f 6178 6973 2861 7869  alidate_axis(axi
-0000b5c0: 7329 0a20 2020 2020 2020 2069 6620 6178  s).        if ax
-0000b5d0: 6973 203d 3d20 313a 0a20 2020 2020 2020  is == 1:.       
-0000b5e0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0000b5f0: 2e6d 6170 5f70 6172 7469 7469 6f6e 7328  .map_partitions(
-0000b600: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000b610: 204d 2e73 756d 2c0a 2020 2020 2020 2020   M.sum,.        
-0000b620: 2020 2020 2020 2020 736b 6970 6e61 3d73          skipna=s
-0000b630: 6b69 706e 612c 0a20 2020 2020 2020 2020  kipna,.         
-0000b640: 2020 2020 2020 206e 756d 6572 6963 5f6f         numeric_o
-0000b650: 6e6c 793d 6e75 6d65 7269 635f 6f6e 6c79  nly=numeric_only
-0000b660: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000b670: 2020 6178 6973 3d61 7869 732c 0a20 2020    axis=axis,.   
-0000b680: 2020 2020 2020 2020 2020 2020 206d 696e               min
-0000b690: 5f63 6f75 6e74 3d6d 696e 5f63 6f75 6e74  _count=min_count
-0000b6a0: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
-0000b6b0: 0a20 2020 2020 2020 2072 6573 756c 7420  .        result 
-0000b6c0: 3d20 6e65 775f 636f 6c6c 6563 7469 6f6e  = new_collection
-0000b6d0: 2873 656c 662e 6578 7072 2e73 756d 2873  (self.expr.sum(s
-0000b6e0: 6b69 706e 612c 206e 756d 6572 6963 5f6f  kipna, numeric_o
-0000b6f0: 6e6c 792c 2073 706c 6974 5f65 7665 7279  nly, split_every
-0000b700: 2c20 6178 6973 2929 0a20 2020 2020 2020  , axis)).       
-0000b710: 2072 6574 7572 6e20 7365 6c66 2e5f 6170   return self._ap
-0000b720: 706c 795f 6d69 6e5f 636f 756e 7428 7265  ply_min_count(re
-0000b730: 7375 6c74 2c20 6d69 6e5f 636f 756e 7429  sult, min_count)
-0000b740: 0a0a 2020 2020 6465 6620 5f61 7070 6c79  ..    def _apply
-0000b750: 5f6d 696e 5f63 6f75 6e74 2873 656c 662c  _min_count(self,
-0000b760: 2072 6573 756c 742c 206d 696e 5f63 6f75   result, min_cou
-0000b770: 6e74 293a 0a20 2020 2020 2020 2069 6620  nt):.        if 
-0000b780: 6d69 6e5f 636f 756e 743a 0a20 2020 2020  min_count:.     
-0000b790: 2020 2020 2020 2063 6f6e 6420 3d20 7365         cond = se
-0000b7a0: 6c66 2e6e 6f74 6e75 6c6c 2829 2e73 756d  lf.notnull().sum
-0000b7b0: 2829 203e 3d20 6d69 6e5f 636f 756e 740a  () >= min_count.
-0000b7c0: 2020 2020 2020 2020 2020 2020 636f 6e64              cond
-0000b7d0: 5f6d 6574 6120 3d20 636f 6e64 2e5f 6d65  _meta = cond._me
-0000b7e0: 7461 0a20 2020 2020 2020 2020 2020 2069  ta.            i
-0000b7f0: 6620 6e6f 7420 6973 5f73 6572 6965 735f  f not is_series_
-0000b800: 6c69 6b65 2863 6f6e 645f 6d65 7461 293a  like(cond_meta):
-0000b810: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000b820: 2072 6573 756c 7420 3d20 7265 7375 6c74   result = result
-0000b830: 2e74 6f5f 7365 7269 6573 2829 0a20 2020  .to_series().   
-0000b840: 2020 2020 2020 2020 2020 2020 2063 6f6e               con
-0000b850: 6420 3d20 636f 6e64 2e74 6f5f 7365 7269  d = cond.to_seri
-0000b860: 6573 2829 0a0a 2020 2020 2020 2020 2020  es()..          
-0000b870: 2020 7265 7375 6c74 203d 2072 6573 756c    result = resul
-0000b880: 742e 7768 6572 6528 636f 6e64 2c20 6f74  t.where(cond, ot
-0000b890: 6865 723d 6e70 2e6e 616e 290a 2020 2020  her=np.nan).    
-0000b8a0: 2020 2020 2020 2020 6966 206e 6f74 2069          if not i
-0000b8b0: 735f 7365 7269 6573 5f6c 696b 6528 636f  s_series_like(co
-0000b8c0: 6e64 5f6d 6574 6129 3a0a 2020 2020 2020  nd_meta):.      
-0000b8d0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0000b8e0: 2072 6573 756c 742e 6d69 6e28 290a 2020   result.min().  
-0000b8f0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-0000b900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b910: 7265 7475 726e 2072 6573 756c 740a 2020  return result.  
-0000b920: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0000b930: 2020 2020 2020 2020 7265 7475 726e 2072          return r
-0000b940: 6573 756c 740a 0a20 2020 2040 6465 7269  esult..    @deri
-0000b950: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
-0000b960: 4672 616d 6529 0a20 2020 2064 6566 2070  Frame).    def p
-0000b970: 726f 6428 0a20 2020 2020 2020 2073 656c  rod(.        sel
-0000b980: 662c 0a20 2020 2020 2020 2061 7869 733d  f,.        axis=
-0000b990: 302c 0a20 2020 2020 2020 2073 6b69 706e  0,.        skipn
-0000b9a0: 613d 5472 7565 2c0a 2020 2020 2020 2020  a=True,.        
-0000b9b0: 6e75 6d65 7269 635f 6f6e 6c79 3d46 616c  numeric_only=Fal
-0000b9c0: 7365 2c0a 2020 2020 2020 2020 6d69 6e5f  se,.        min_
-0000b9d0: 636f 756e 743d 302c 0a20 2020 2020 2020  count=0,.       
-0000b9e0: 2073 706c 6974 5f65 7665 7279 3d46 616c   split_every=Fal
-0000b9f0: 7365 2c0a 2020 2020 2020 2020 2a2a 6b77  se,.        **kw
-0000ba00: 6172 6773 2c0a 2020 2020 293a 0a20 2020  args,.    ):.   
-0000ba10: 2020 2020 2061 7869 7320 3d20 7365 6c66       axis = self
-0000ba20: 2e5f 7661 6c69 6461 7465 5f61 7869 7328  ._validate_axis(
-0000ba30: 6178 6973 290a 2020 2020 2020 2020 6966  axis).        if
-0000ba40: 2061 7869 7320 3d3d 2031 3a0a 2020 2020   axis == 1:.    
-0000ba50: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0000ba60: 656c 662e 6d61 705f 7061 7274 6974 696f  elf.map_partitio
-0000ba70: 6e73 280a 2020 2020 2020 2020 2020 2020  ns(.            
-0000ba80: 2020 2020 4d2e 7072 6f64 2c0a 2020 2020      M.prod,.    
-0000ba90: 2020 2020 2020 2020 2020 2020 736b 6970              skip
-0000baa0: 6e61 3d73 6b69 706e 612c 0a20 2020 2020  na=skipna,.     
-0000bab0: 2020 2020 2020 2020 2020 206e 756d 6572             numer
-0000bac0: 6963 5f6f 6e6c 793d 6e75 6d65 7269 635f  ic_only=numeric_
-0000bad0: 6f6e 6c79 2c0a 2020 2020 2020 2020 2020  only,.          
-0000bae0: 2020 2020 2020 6178 6973 3d61 7869 732c        axis=axis,
-0000baf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000bb00: 206d 696e 5f63 6f75 6e74 3d6d 696e 5f63   min_count=min_c
-0000bb10: 6f75 6e74 2c0a 2020 2020 2020 2020 2020  ount,.          
-0000bb20: 2020 290a 2020 2020 2020 2020 7265 7375    ).        resu
-0000bb30: 6c74 203d 206e 6577 5f63 6f6c 6c65 6374  lt = new_collect
-0000bb40: 696f 6e28 7365 6c66 2e65 7870 722e 7072  ion(self.expr.pr
-0000bb50: 6f64 2873 6b69 706e 612c 206e 756d 6572  od(skipna, numer
-0000bb60: 6963 5f6f 6e6c 792c 2073 706c 6974 5f65  ic_only, split_e
-0000bb70: 7665 7279 2c20 6178 6973 2929 0a20 2020  very, axis)).   
-0000bb80: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0000bb90: 2e5f 6170 706c 795f 6d69 6e5f 636f 756e  ._apply_min_coun
-0000bba0: 7428 7265 7375 6c74 2c20 6d69 6e5f 636f  t(result, min_co
-0000bbb0: 756e 7429 0a0a 2020 2020 7072 6f64 7563  unt)..    produc
-0000bbc0: 7420 3d20 7072 6f64 0a0a 2020 2020 4064  t = prod..    @d
-0000bbd0: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
-0000bbe0: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
-0000bbf0: 6620 7661 7228 0a20 2020 2020 2020 2073  f var(.        s
-0000bc00: 656c 662c 0a20 2020 2020 2020 2061 7869  elf,.        axi
-0000bc10: 733d 302c 0a20 2020 2020 2020 2073 6b69  s=0,.        ski
-0000bc20: 706e 613d 5472 7565 2c0a 2020 2020 2020  pna=True,.      
-0000bc30: 2020 6464 6f66 3d31 2c0a 2020 2020 2020    ddof=1,.      
-0000bc40: 2020 6e75 6d65 7269 635f 6f6e 6c79 3d46    numeric_only=F
-0000bc50: 616c 7365 2c0a 2020 2020 2020 2020 7370  alse,.        sp
-0000bc60: 6c69 745f 6576 6572 793d 4661 6c73 652c  lit_every=False,
-0000bc70: 0a20 2020 2020 2020 202a 2a6b 7761 7267  .        **kwarg
-0000bc80: 732c 0a20 2020 2029 3a0a 2020 2020 2020  s,.    ):.      
-0000bc90: 2020 5f72 6169 7365 5f69 665f 6f62 6a65    _raise_if_obje
-0000bca0: 6374 5f73 6572 6965 7328 7365 6c66 2c20  ct_series(self, 
-0000bcb0: 2276 6172 2229 0a20 2020 2020 2020 2061  "var").        a
-0000bcc0: 7869 7320 3d20 7365 6c66 2e5f 7661 6c69  xis = self._vali
-0000bcd0: 6461 7465 5f61 7869 7328 6178 6973 290a  date_axis(axis).
-0000bce0: 2020 2020 2020 2020 7365 6c66 2e5f 6d65          self._me
-0000bcf0: 7461 2e76 6172 2861 7869 733d 6178 6973  ta.var(axis=axis
-0000bd00: 2c20 736b 6970 6e61 3d73 6b69 706e 612c  , skipna=skipna,
-0000bd10: 206e 756d 6572 6963 5f6f 6e6c 793d 6e75   numeric_only=nu
-0000bd20: 6d65 7269 635f 6f6e 6c79 290a 2020 2020  meric_only).    
-0000bd30: 2020 2020 6672 616d 6520 3d20 7365 6c66      frame = self
-0000bd40: 0a20 2020 2020 2020 2069 6620 6973 5f64  .        if is_d
-0000bd50: 6174 6166 7261 6d65 5f6c 696b 6528 7365  ataframe_like(se
-0000bd60: 6c66 2e5f 6d65 7461 2920 616e 6420 6e75  lf._meta) and nu
-0000bd70: 6d65 7269 635f 6f6e 6c79 3a0a 2020 2020  meric_only:.    
-0000bd80: 2020 2020 2020 2020 6672 616d 6520 3d20          frame = 
-0000bd90: 6672 616d 655b 6c69 7374 2873 656c 662e  frame[list(self.
-0000bda0: 5f6d 6574 612e 7661 7228 6e75 6d65 7269  _meta.var(numeri
-0000bdb0: 635f 6f6e 6c79 3d54 7275 6529 2e69 6e64  c_only=True).ind
-0000bdc0: 6578 295d 0a20 2020 2020 2020 2072 6574  ex)].        ret
-0000bdd0: 7572 6e20 6e65 775f 636f 6c6c 6563 7469  urn new_collecti
-0000bde0: 6f6e 280a 2020 2020 2020 2020 2020 2020  on(.            
-0000bdf0: 6672 616d 652e 6578 7072 2e76 6172 2861  frame.expr.var(a
-0000be00: 7869 732c 2073 6b69 706e 612c 2064 646f  xis, skipna, ddo
-0000be10: 662c 206e 756d 6572 6963 5f6f 6e6c 792c  f, numeric_only,
-0000be20: 2073 706c 6974 5f65 7665 7279 3d73 706c   split_every=spl
-0000be30: 6974 5f65 7665 7279 290a 2020 2020 2020  it_every).      
-0000be40: 2020 290a 0a20 2020 2040 6465 7269 7665    )..    @derive
-0000be50: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
-0000be60: 616d 6529 0a20 2020 2064 6566 2073 7464  ame).    def std
-0000be70: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-0000be80: 2020 2020 2020 2020 6178 6973 3d30 2c0a          axis=0,.
-0000be90: 2020 2020 2020 2020 736b 6970 6e61 3d54          skipna=T
-0000bea0: 7275 652c 0a20 2020 2020 2020 2064 646f  rue,.        ddo
-0000beb0: 663d 312c 0a20 2020 2020 2020 206e 756d  f=1,.        num
-0000bec0: 6572 6963 5f6f 6e6c 793d 4661 6c73 652c  eric_only=False,
-0000bed0: 0a20 2020 2020 2020 2073 706c 6974 5f65  .        split_e
-0000bee0: 7665 7279 3d46 616c 7365 2c0a 2020 2020  very=False,.    
-0000bef0: 2020 2020 2a2a 6b77 6172 6773 2c0a 2020      **kwargs,.  
-0000bf00: 2020 293a 0a20 2020 2020 2020 205f 7261    ):.        _ra
-0000bf10: 6973 655f 6966 5f6f 626a 6563 745f 7365  ise_if_object_se
-0000bf20: 7269 6573 2873 656c 662c 2022 7374 6422  ries(self, "std"
-0000bf30: 290a 2020 2020 2020 2020 6178 6973 203d  ).        axis =
-0000bf40: 2073 656c 662e 5f76 616c 6964 6174 655f   self._validate_
-0000bf50: 6178 6973 2861 7869 7329 0a20 2020 2020  axis(axis).     
-0000bf60: 2020 206e 756d 6572 6963 5f64 6420 3d20     numeric_dd = 
-0000bf70: 7365 6c66 0a20 2020 2020 2020 206d 6574  self.        met
-0000bf80: 6120 3d20 6d65 7461 5f6e 6f6e 656d 7074  a = meta_nonempt
-0000bf90: 7928 7365 6c66 2e5f 6d65 7461 292e 7374  y(self._meta).st
-0000bfa0: 6428 0a20 2020 2020 2020 2020 2020 2061  d(.            a
-0000bfb0: 7869 733d 6178 6973 2c20 736b 6970 6e61  xis=axis, skipna
-0000bfc0: 3d73 6b69 706e 612c 2064 646f 663d 6464  =skipna, ddof=dd
-0000bfd0: 6f66 2c20 6e75 6d65 7269 635f 6f6e 6c79  of, numeric_only
-0000bfe0: 3d6e 756d 6572 6963 5f6f 6e6c 790a 2020  =numeric_only.  
-0000bff0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0000c000: 6e65 6564 735f 7469 6d65 5f63 6f6e 7665  needs_time_conve
-0000c010: 7273 696f 6e2c 2074 696d 655f 636f 6c73  rsion, time_cols
-0000c020: 203d 2046 616c 7365 2c20 4e6f 6e65 0a20   = False, None. 
-0000c030: 2020 2020 2020 2069 6620 6973 5f64 6174         if is_dat
-0000c040: 6166 7261 6d65 5f6c 696b 6528 7365 6c66  aframe_like(self
-0000c050: 2e5f 6d65 7461 293a 0a20 2020 2020 2020  ._meta):.       
-0000c060: 2020 2020 2069 6620 6178 6973 203d 3d20       if axis == 
-0000c070: 303a 0a20 2020 2020 2020 2020 2020 2020  0:.             
-0000c080: 2020 206e 756d 6572 6963 5f64 6420 3d20     numeric_dd = 
-0000c090: 6e75 6d65 7269 635f 6464 5b6c 6973 7428  numeric_dd[list(
-0000c0a0: 6d65 7461 2e69 6e64 6578 295d 0a20 2020  meta.index)].   
-0000c0b0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-0000c0c0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-0000c0d0: 756d 6572 6963 5f64 6420 3d20 6e75 6d65  umeric_dd = nume
-0000c0e0: 7269 635f 6464 2e63 6f70 7928 290a 0a20  ric_dd.copy().. 
-0000c0f0: 2020 2020 2020 2020 2020 2069 6620 6e75             if nu
-0000c100: 6d65 7269 635f 6f6e 6c79 2069 7320 5472  meric_only is Tr
-0000c110: 7565 3a0a 2020 2020 2020 2020 2020 2020  ue:.            
-0000c120: 2020 2020 5f6d 6574 6120 3d20 6e75 6d65      _meta = nume
-0000c130: 7269 635f 6464 2e5f 6d65 7461 2e73 656c  ric_dd._meta.sel
-0000c140: 6563 745f 6474 7970 6573 2869 6e63 6c75  ect_dtypes(inclu
-0000c150: 6465 3d5b 6e70 2e6e 756d 6265 725d 290a  de=[np.number]).
-0000c160: 2020 2020 2020 2020 2020 2020 656c 7365              else
-0000c170: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0000c180: 2020 5f6d 6574 6120 3d20 6e75 6d65 7269    _meta = numeri
-0000c190: 635f 6464 2e5f 6d65 7461 0a20 2020 2020  c_dd._meta.     
-0000c1a0: 2020 2020 2020 2074 696d 655f 636f 6c73         time_cols
-0000c1b0: 203d 205f 6d65 7461 2e73 656c 6563 745f   = _meta.select_
-0000c1c0: 6474 7970 6573 2869 6e63 6c75 6465 3d5b  dtypes(include=[
-0000c1d0: 2264 6174 6574 696d 6522 2c20 2274 696d  "datetime", "tim
-0000c1e0: 6564 656c 7461 225d 292e 636f 6c75 6d6e  edelta"]).column
-0000c1f0: 730a 2020 2020 2020 2020 2020 2020 6966  s.            if
-0000c200: 206c 656e 2874 696d 655f 636f 6c73 2920   len(time_cols) 
-0000c210: 3e20 303a 0a20 2020 2020 2020 2020 2020  > 0:.           
-0000c220: 2020 2020 2069 6620 6178 6973 203d 3d20       if axis == 
-0000c230: 3120 616e 6420 6c65 6e28 7469 6d65 5f63  1 and len(time_c
-0000c240: 6f6c 7329 2021 3d20 6c65 6e28 7365 6c66  ols) != len(self
-0000c250: 2e63 6f6c 756d 6e73 293a 0a20 2020 2020  .columns):.     
-0000c260: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-0000c270: 756d 6572 6963 5f64 6420 3d20 6672 6f6d  umeric_dd = from
-0000c280: 5f70 616e 6461 7328 0a20 2020 2020 2020  _pandas(.       
-0000c290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c2a0: 206d 6574 615f 6672 616d 655f 636f 6e73   meta_frame_cons
-0000c2b0: 7472 7563 746f 7228 7365 6c66 2928 0a20  tructor(self)(. 
-0000c2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c2d0: 2020 2020 2020 2020 2020 207b 225f 223a             {"_":
-0000c2e0: 206d 6574 615f 7365 7269 6573 5f63 6f6e   meta_series_con
-0000c2f0: 7374 7275 6374 6f72 2873 656c 6629 285b  structor(self)([
-0000c300: 6e70 2e6e 616e 5d29 7d2c 0a20 2020 2020  np.nan])},.     
-0000c310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c320: 2020 2020 2020 2069 6e64 6578 3d73 656c         index=sel
-0000c330: 662e 696e 6465 782c 0a20 2020 2020 2020  f.index,.       
-0000c340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c350: 2029 2c0a 2020 2020 2020 2020 2020 2020   ),.            
-0000c360: 2020 2020 2020 2020 2020 2020 6e70 6172              npar
-0000c370: 7469 7469 6f6e 733d 7365 6c66 2e6e 7061  titions=self.npa
-0000c380: 7274 6974 696f 6e73 2c0a 2020 2020 2020  rtitions,.      
-0000c390: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-0000c3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c3b0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0000c3c0: 2020 2020 2020 2020 2020 6e65 6564 735f            needs_
-0000c3d0: 7469 6d65 5f63 6f6e 7665 7273 696f 6e20  time_conversion 
-0000c3e0: 3d20 5472 7565 0a20 2020 2020 2020 2020  = True.         
-0000c3f0: 2020 2020 2020 2020 2020 2066 6f72 2063             for c
-0000c400: 6f6c 2069 6e20 7469 6d65 5f63 6f6c 733a  ol in time_cols:
-0000c410: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000c420: 2020 2020 2020 2020 206e 756d 6572 6963           numeric
-0000c430: 5f64 645b 636f 6c5d 203d 205f 636f 6e76  _dd[col] = _conv
-0000c440: 6572 745f 746f 5f6e 756d 6572 6963 286e  ert_to_numeric(n
-0000c450: 756d 6572 6963 5f64 645b 636f 6c5d 2c20  umeric_dd[col], 
-0000c460: 736b 6970 6e61 290a 2020 2020 2020 2020  skipna).        
-0000c470: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0000c480: 2020 6e65 6564 735f 7469 6d65 5f63 6f6e    needs_time_con
-0000c490: 7665 7273 696f 6e20 3d20 6973 5f64 6174  version = is_dat
-0000c4a0: 6574 696d 6536 345f 616e 795f 6474 7970  etime64_any_dtyp
-0000c4b0: 6528 7365 6c66 2e5f 6d65 7461 290a 2020  e(self._meta).  
-0000c4c0: 2020 2020 2020 2020 2020 6966 206e 6565            if nee
-0000c4d0: 6473 5f74 696d 655f 636f 6e76 6572 7369  ds_time_conversi
-0000c4e0: 6f6e 3a0a 2020 2020 2020 2020 2020 2020  on:.            
-0000c4f0: 2020 2020 6e75 6d65 7269 635f 6464 203d      numeric_dd =
-0000c500: 205f 636f 6e76 6572 745f 746f 5f6e 756d   _convert_to_num
-0000c510: 6572 6963 2873 656c 662c 2073 6b69 706e  eric(self, skipn
-0000c520: 6129 0a0a 2020 2020 2020 2020 6966 2061  a)..        if a
-0000c530: 7869 7320 3d3d 2031 3a0a 2020 2020 2020  xis == 1:.      
-0000c540: 2020 2020 2020 7265 7475 726e 206e 756d        return num
-0000c550: 6572 6963 5f64 642e 6d61 705f 7061 7274  eric_dd.map_part
-0000c560: 6974 696f 6e73 280a 2020 2020 2020 2020  itions(.        
-0000c570: 2020 2020 2020 2020 4d2e 7374 6420 6966          M.std if
-0000c580: 206e 6f74 206e 6565 6473 5f74 696d 655f   not needs_time_
-0000c590: 636f 6e76 6572 7369 6f6e 2065 6c73 6520  conversion else 
-0000c5a0: 5f73 7172 745f 616e 645f 636f 6e76 6572  _sqrt_and_conver
-0000c5b0: 745f 746f 5f74 696d 6564 656c 7461 2c0a  t_to_timedelta,.
-0000c5c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c5d0: 6d65 7461 3d6d 6574 612c 0a20 2020 2020  meta=meta,.     
-0000c5e0: 2020 2020 2020 2020 2020 2061 7869 733d             axis=
-0000c5f0: 6178 6973 2c0a 2020 2020 2020 2020 2020  axis,.          
-0000c600: 2020 2020 2020 736b 6970 6e61 3d73 6b69        skipna=ski
-0000c610: 706e 612c 0a20 2020 2020 2020 2020 2020  pna,.           
-0000c620: 2020 2020 2064 646f 663d 6464 6f66 2c0a       ddof=ddof,.
-0000c630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c640: 656e 666f 7263 655f 6d65 7461 6461 7461  enforce_metadata
-0000c650: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
-0000c660: 2020 2020 2020 2020 6e75 6d65 7269 635f          numeric_
-0000c670: 6f6e 6c79 3d6e 756d 6572 6963 5f6f 6e6c  only=numeric_onl
-0000c680: 792c 0a20 2020 2020 2020 2020 2020 2029  y,.            )
-0000c690: 0a0a 2020 2020 2020 2020 7265 7375 6c74  ..        result
-0000c6a0: 203d 206e 756d 6572 6963 5f64 642e 7661   = numeric_dd.va
-0000c6b0: 7228 0a20 2020 2020 2020 2020 2020 2073  r(.            s
-0000c6c0: 6b69 706e 613d 736b 6970 6e61 2c20 6464  kipna=skipna, dd
-0000c6d0: 6f66 3d64 646f 662c 206e 756d 6572 6963  of=ddof, numeric
-0000c6e0: 5f6f 6e6c 793d 6e75 6d65 7269 635f 6f6e  _only=numeric_on
-0000c6f0: 6c79 2c20 7370 6c69 745f 6576 6572 793d  ly, split_every=
-0000c700: 7370 6c69 745f 6576 6572 790a 2020 2020  split_every.    
-0000c710: 2020 2020 290a 0a20 2020 2020 2020 2069      )..        i
-0000c720: 6620 6e65 6564 735f 7469 6d65 5f63 6f6e  f needs_time_con
-0000c730: 7665 7273 696f 6e3a 0a20 2020 2020 2020  version:.       
-0000c740: 2020 2020 2073 7172 745f 6675 6e63 5f6b       sqrt_func_k
-0000c750: 7761 7267 7320 3d20 7b0a 2020 2020 2020  wargs = {.      
-0000c760: 2020 2020 2020 2020 2020 2269 735f 6466            "is_df
-0000c770: 5f6c 696b 6522 3a20 6973 5f64 6174 6166  _like": is_dataf
-0000c780: 7261 6d65 5f6c 696b 6528 7365 6c66 2e5f  rame_like(self._
-0000c790: 6d65 7461 292c 0a20 2020 2020 2020 2020  meta),.         
-0000c7a0: 2020 2020 2020 2022 7469 6d65 5f63 6f6c         "time_col
-0000c7b0: 7322 3a20 7469 6d65 5f63 6f6c 732c 0a20  s": time_cols,. 
-0000c7c0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0000c7d0: 6178 6973 223a 2061 7869 732c 0a20 2020  axis": axis,.   
-0000c7e0: 2020 2020 2020 2020 2020 2020 2022 6474               "dt
-0000c7f0: 7970 6522 3a20 6765 7461 7474 7228 6d65  ype": getattr(me
-0000c800: 7461 2c20 2264 7479 7065 222c 204e 6f6e  ta, "dtype", Non
-0000c810: 6529 2c0a 2020 2020 2020 2020 2020 2020  e),.            
-0000c820: 7d0a 2020 2020 2020 2020 2020 2020 7371  }.            sq
-0000c830: 7274 5f66 756e 6320 3d20 5f73 7172 745f  rt_func = _sqrt_
-0000c840: 616e 645f 636f 6e76 6572 745f 746f 5f74  and_convert_to_t
-0000c850: 696d 6564 656c 7461 0a20 2020 2020 2020  imedelta.       
-0000c860: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-0000c870: 2020 2073 7172 745f 6675 6e63 5f6b 7761     sqrt_func_kwa
-0000c880: 7267 7320 3d20 7b7d 0a20 2020 2020 2020  rgs = {}.       
-0000c890: 2020 2020 2073 7172 745f 6675 6e63 203d       sqrt_func =
-0000c8a0: 206e 702e 7371 7274 0a0a 2020 2020 2020   np.sqrt..      
-0000c8b0: 2020 7265 7375 6c74 203d 2072 6573 756c    result = resul
-0000c8c0: 742e 6d61 705f 7061 7274 6974 696f 6e73  t.map_partitions
-0000c8d0: 280a 2020 2020 2020 2020 2020 2020 7371  (.            sq
-0000c8e0: 7274 5f66 756e 632c 0a20 2020 2020 2020  rt_func,.       
-0000c8f0: 2020 2020 206d 6574 613d 6d65 7461 2c0a       meta=meta,.
-0000c900: 2020 2020 2020 2020 2020 2020 656e 666f              enfo
-0000c910: 7263 655f 6d65 7461 6461 7461 3d46 616c  rce_metadata=Fal
-0000c920: 7365 2c0a 2020 2020 2020 2020 2020 2020  se,.            
-0000c930: 7061 7265 6e74 5f6d 6574 613d 7365 6c66  parent_meta=self
-0000c940: 2e5f 6d65 7461 2c0a 2020 2020 2020 2020  ._meta,.        
-0000c950: 2020 2020 2a2a 7371 7274 5f66 756e 635f      **sqrt_func_
-0000c960: 6b77 6172 6773 2c0a 2020 2020 2020 2020  kwargs,.        
-0000c970: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-0000c980: 2072 6573 756c 740a 0a20 2020 2064 6566   result..    def
-0000c990: 2065 6e66 6f72 6365 5f72 756e 7469 6d65   enforce_runtime
-0000c9a0: 5f64 6976 6973 696f 6e73 2873 656c 6629  _divisions(self)
-0000c9b0: 3a0a 2020 2020 2020 2020 2222 2245 6e66  :.        """Enf
-0000c9c0: 6f72 6365 2074 6865 2063 7572 7265 6e74  orce the current
-0000c9d0: 2064 6976 6973 696f 6e73 2061 7420 7275   divisions at ru
-0000c9e0: 6e74 696d 652e 0a0a 2020 2020 2020 2020  ntime...        
-0000c9f0: 496e 6a65 6374 7320 6120 6c61 7965 7220  Injects a layer 
-0000ca00: 696e 746f 2074 6865 2054 6173 6b20 4772  into the Task Gr
-0000ca10: 6170 6820 7468 6174 2063 6865 636b 7320  aph that checks 
-0000ca20: 7468 6174 2074 6865 2063 7572 7265 6e74  that the current
-0000ca30: 2064 6976 6973 696f 6e73 0a20 2020 2020   divisions.     
-0000ca40: 2020 206d 6174 6368 2074 6865 2065 7870     match the exp
-0000ca50: 6563 7465 6420 6469 7669 7369 6f6e 7320  ected divisions 
-0000ca60: 6174 2072 756e 7469 6d65 2e0a 2020 2020  at runtime..    
-0000ca70: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0000ca80: 6966 206e 6f74 2073 656c 662e 6b6e 6f77  if not self.know
-0000ca90: 6e5f 6469 7669 7369 6f6e 733a 0a20 2020  n_divisions:.   
-0000caa0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-0000cab0: 616c 7565 4572 726f 7228 224e 6f20 6b6e  alueError("No kn
-0000cac0: 6f77 6e20 6469 7669 7369 6f6e 7320 746f  own divisions to
-0000cad0: 2065 6e66 6f72 6365 2122 290a 2020 2020   enforce!").    
-0000cae0: 2020 2020 7265 7475 726e 206e 6577 5f63      return new_c
-0000caf0: 6f6c 6c65 6374 696f 6e28 6578 7072 2e45  ollection(expr.E
-0000cb00: 6e66 6f72 6365 5275 6e74 696d 6544 6976  nforceRuntimeDiv
-0000cb10: 6973 696f 6e73 2873 656c 6629 290a 0a20  isions(self)).. 
-0000cb20: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
-0000cb30: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
-0000cb40: 2020 2064 6566 2073 6b65 7728 0a20 2020     def skew(.   
-0000cb50: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-0000cb60: 2020 2061 7869 733d 302c 0a20 2020 2020     axis=0,.     
-0000cb70: 2020 2062 6961 733d 5472 7565 2c0a 2020     bias=True,.  
-0000cb80: 2020 2020 2020 6e61 6e5f 706f 6c69 6379        nan_policy
-0000cb90: 3d22 7072 6f70 6167 6174 6522 2c0a 2020  ="propagate",.  
-0000cba0: 2020 2020 2020 6e75 6d65 7269 635f 6f6e        numeric_on
-0000cbb0: 6c79 3d46 616c 7365 2c0a 2020 2020 293a  ly=False,.    ):
-0000cbc0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0000cbd0: 2020 2020 202e 2e20 6e6f 7465 3a3a 0a0a       .. note::..
-0000cbe0: 2020 2020 2020 2020 2020 2054 6869 7320             This 
-0000cbf0: 696d 706c 656d 656e 7461 7469 6f6e 2066  implementation f
-0000cc00: 6f6c 6c6f 7773 2074 6865 2064 6173 6b2e  ollows the dask.
-0000cc10: 6172 7261 792e 7374 6174 7320 696d 706c  array.stats impl
-0000cc20: 656d 656e 7461 7469 6f6e 0a20 2020 2020  ementation.     
-0000cc30: 2020 2020 2020 6f66 2073 6b65 776e 6573        of skewnes
-0000cc40: 7320 616e 6420 6361 6c63 756c 6174 6573  s and calculates
-0000cc50: 2073 6b65 776e 6573 7320 7769 7468 6f75   skewness withou
-0000cc60: 7420 7461 6b69 6e67 2069 6e74 6f20 6163  t taking into ac
-0000cc70: 636f 756e 740a 2020 2020 2020 2020 2020  count.          
-0000cc80: 2061 2062 6961 7320 7465 726d 2066 6f72   a bias term for
-0000cc90: 2066 696e 6974 6520 7361 6d70 6c65 2073   finite sample s
-0000cca0: 697a 652c 2077 6869 6368 2063 6f72 7265  ize, which corre
-0000ccb0: 7370 6f6e 6473 2074 6f20 7468 650a 2020  sponds to the.  
-0000ccc0: 2020 2020 2020 2020 2064 6566 6175 6c74           default
-0000ccd0: 2073 6574 7469 6e67 7320 6f66 2074 6865   settings of the
-0000cce0: 2073 6369 7079 2e73 7461 7473 2073 6b65   scipy.stats ske
-0000ccf0: 776e 6573 7320 6361 6c63 756c 6174 696f  wness calculatio
-0000cd00: 6e2e 2048 6f77 6576 6572 2c0a 2020 2020  n. However,.    
-0000cd10: 2020 2020 2020 2050 616e 6461 7320 636f         Pandas co
-0000cd20: 7272 6563 7473 2066 6f72 2074 6869 732c  rrects for this,
-0000cd30: 2073 6f20 7468 6520 7661 6c75 6573 2064   so the values d
-0000cd40: 6966 6665 7220 6279 2061 2066 6163 746f  iffer by a facto
-0000cd50: 7220 6f66 0a20 2020 2020 2020 2020 2020  r of.           
-0000cd60: 286e 202a 2028 6e20 2d20 3129 2920 2a2a  (n * (n - 1)) **
-0000cd70: 2030 2e35 202f 2028 6e20 2d20 3229 2c20   0.5 / (n - 2), 
-0000cd80: 7768 6572 6520 6e20 6973 2074 6865 206e  where n is the n
-0000cd90: 756d 6265 7220 6f66 2073 616d 706c 6573  umber of samples
-0000cda0: 2e0a 0a20 2020 2020 2020 2020 2020 4675  ...           Fu
-0000cdb0: 7274 6865 722c 2074 6869 7320 6d65 7468  rther, this meth
-0000cdc0: 6f64 2063 7572 7265 6e74 6c79 2064 6f65  od currently doe
-0000cdd0: 7320 6e6f 7420 7375 7070 6f72 7420 6669  s not support fi
-0000cde0: 6c74 6572 696e 6720 6f75 7420 4e61 4e0a  ltering out NaN.
-0000cdf0: 2020 2020 2020 2020 2020 2076 616c 7565             value
-0000ce00: 732c 2077 6869 6368 2069 7320 6167 6169  s, which is agai
-0000ce10: 6e20 6120 6469 6666 6572 656e 6365 2074  n a difference t
-0000ce20: 6f20 5061 6e64 6173 2e0a 2020 2020 2020  o Pandas..      
-0000ce30: 2020 2222 220a 2020 2020 2020 2020 5f72    """.        _r
-0000ce40: 6169 7365 5f69 665f 6f62 6a65 6374 5f73  aise_if_object_s
-0000ce50: 6572 6965 7328 7365 6c66 2c20 2273 6b65  eries(self, "ske
-0000ce60: 7722 290a 2020 2020 2020 2020 6966 2061  w").        if a
-0000ce70: 7869 7320 6973 204e 6f6e 653a 0a20 2020  xis is None:.   
-0000ce80: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-0000ce90: 616c 7565 4572 726f 7228 2260 6178 6973  alueError("`axis
-0000cea0: 3d4e 6f6e 6560 2069 736e 2774 2063 7572  =None` isn't cur
-0000ceb0: 7265 6e74 6c79 2073 7570 706f 7274 6564  rently supported
-0000cec0: 2066 6f72 2060 736b 6577 6022 290a 2020   for `skew`").  
-0000ced0: 2020 2020 2020 6178 6973 203d 2073 656c        axis = sel
-0000cee0: 662e 5f76 616c 6964 6174 655f 6178 6973  f._validate_axis
-0000cef0: 2861 7869 7329 0a0a 2020 2020 2020 2020  (axis)..        
-0000cf00: 6966 2069 735f 6461 7461 6672 616d 655f  if is_dataframe_
-0000cf10: 6c69 6b65 2873 656c 6629 3a0a 2020 2020  like(self):.    
-0000cf20: 2020 2020 2020 2020 2320 4c65 7420 7061          # Let pa
-0000cf30: 6e64 6173 2072 6169 7365 2065 7272 6f72  ndas raise error
-0000cf40: 7320 6966 206e 6563 6573 7361 7279 0a20  s if necessary. 
-0000cf50: 2020 2020 2020 2020 2020 206d 6574 6120             meta 
-0000cf60: 3d20 7365 6c66 2e5f 6d65 7461 5f6e 6f6e  = self._meta_non
-0000cf70: 656d 7074 792e 736b 6577 2861 7869 733d  empty.skew(axis=
-0000cf80: 6178 6973 2c20 6e75 6d65 7269 635f 6f6e  axis, numeric_on
-0000cf90: 6c79 3d6e 756d 6572 6963 5f6f 6e6c 7929  ly=numeric_only)
-0000cfa0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-0000cfb0: 2020 2020 2020 2020 2020 206d 6574 6120             meta 
-0000cfc0: 3d20 7365 6c66 2e5f 6d65 7461 5f6e 6f6e  = self._meta_non
-0000cfd0: 656d 7074 792e 736b 6577 2829 0a0a 2020  empty.skew()..  
-0000cfe0: 2020 2020 2020 6966 2061 7869 7320 3d3d        if axis ==
-0000cff0: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
-0000d000: 7265 7475 726e 2073 656c 662e 6d61 705f  return self.map_
-0000d010: 7061 7274 6974 696f 6e73 280a 2020 2020  partitions(.    
-0000d020: 2020 2020 2020 2020 2020 2020 4d2e 736b              M.sk
-0000d030: 6577 2c0a 2020 2020 2020 2020 2020 2020  ew,.            
-0000d040: 2020 2020 6d65 7461 3d6d 6574 612c 0a20      meta=meta,. 
-0000d050: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-0000d060: 7869 733d 6178 6973 2c0a 2020 2020 2020  xis=axis,.      
-0000d070: 2020 2020 2020 2020 2020 656e 666f 7263            enforc
-0000d080: 655f 6d65 7461 6461 7461 3d46 616c 7365  e_metadata=False
-0000d090: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
-0000d0a0: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
-0000d0b0: 6269 6173 3a0a 2020 2020 2020 2020 2020  bias:.          
-0000d0c0: 2020 7261 6973 6520 4e6f 7449 6d70 6c65    raise NotImple
-0000d0d0: 6d65 6e74 6564 4572 726f 7228 2262 6961  mentedError("bia
-0000d0e0: 733d 4661 6c73 6520 6973 206e 6f74 2069  s=False is not i
-0000d0f0: 6d70 6c65 6d65 6e74 6564 2e22 290a 2020  mplemented.").  
-0000d100: 2020 2020 2020 6966 206e 616e 5f70 6f6c        if nan_pol
-0000d110: 6963 7920 213d 2022 7072 6f70 6167 6174  icy != "propagat
-0000d120: 6522 3a0a 2020 2020 2020 2020 2020 2020  e":.            
-0000d130: 7261 6973 6520 4e6f 7449 6d70 6c65 6d65  raise NotImpleme
-0000d140: 6e74 6564 4572 726f 7228 0a20 2020 2020  ntedError(.     
-0000d150: 2020 2020 2020 2020 2020 2022 606e 616e             "`nan
-0000d160: 5f70 6f6c 6963 7960 206f 7468 6572 2074  _policy` other t
-0000d170: 6861 6e20 2770 726f 7061 6761 7465 2720  han 'propagate' 
-0000d180: 6861 7665 206e 6f74 2062 6565 6e20 696d  have not been im
-0000d190: 706c 656d 656e 7465 642e 220a 2020 2020  plemented.".    
-0000d1a0: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-0000d1b0: 2020 2066 7261 6d65 203d 2073 656c 660a     frame = self.
-0000d1c0: 2020 2020 2020 2020 6966 2066 7261 6d65          if frame
-0000d1d0: 2e6e 6469 6d20 3e20 313a 0a20 2020 2020  .ndim > 1:.     
-0000d1e0: 2020 2020 2020 2066 7261 6d65 203d 2066         frame = f
-0000d1f0: 7261 6d65 2e73 656c 6563 745f 6474 7970  rame.select_dtyp
-0000d200: 6573 280a 2020 2020 2020 2020 2020 2020  es(.            
-0000d210: 2020 2020 696e 636c 7564 653d 5b22 6e75      include=["nu
-0000d220: 6d62 6572 222c 2022 626f 6f6c 225d 2c20  mber", "bool"], 
-0000d230: 6578 636c 7564 653d 5b6e 702e 7469 6d65  exclude=[np.time
-0000d240: 6465 6c74 6136 345d 0a20 2020 2020 2020  delta64].       
-0000d250: 2020 2020 2029 0a20 2020 2020 2020 206d       ).        m
-0000d260: 3220 3d20 6e65 775f 636f 6c6c 6563 7469  2 = new_collecti
-0000d270: 6f6e 284d 6f6d 656e 7428 6672 616d 652c  on(Moment(frame,
-0000d280: 206f 7264 6572 3d32 2929 0a20 2020 2020   order=2)).     
-0000d290: 2020 206d 3320 3d20 6e65 775f 636f 6c6c     m3 = new_coll
-0000d2a0: 6563 7469 6f6e 284d 6f6d 656e 7428 6672  ection(Moment(fr
-0000d2b0: 616d 652c 206f 7264 6572 3d33 2929 0a20  ame, order=3)). 
-0000d2c0: 2020 2020 2020 2072 6573 756c 7420 3d20         result = 
-0000d2d0: 6d33 202f 206d 322a 2a31 2e35 0a20 2020  m3 / m2**1.5.   
-0000d2e0: 2020 2020 2069 6620 7265 7375 6c74 2e6e       if result.n
-0000d2f0: 6469 6d20 3d3d 2031 3a0a 2020 2020 2020  dim == 1:.      
-0000d300: 2020 2020 2020 7265 7375 6c74 203d 2072        result = r
-0000d310: 6573 756c 742e 6669 6c6c 6e61 2830 2e30  esult.fillna(0.0
-0000d320: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-0000d330: 2072 6573 756c 740a 0a20 2020 2040 6465   result..    @de
-0000d340: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
-0000d350: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
-0000d360: 206b 7572 746f 7369 7328 0a20 2020 2020   kurtosis(.     
-0000d370: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-0000d380: 2061 7869 733d 302c 0a20 2020 2020 2020   axis=0,.       
-0000d390: 2066 6973 6865 723d 5472 7565 2c0a 2020   fisher=True,.  
-0000d3a0: 2020 2020 2020 6269 6173 3d54 7275 652c        bias=True,
-0000d3b0: 0a20 2020 2020 2020 206e 616e 5f70 6f6c  .        nan_pol
-0000d3c0: 6963 793d 2270 726f 7061 6761 7465 222c  icy="propagate",
-0000d3d0: 0a20 2020 2020 2020 206e 756d 6572 6963  .        numeric
-0000d3e0: 5f6f 6e6c 793d 4661 6c73 652c 0a20 2020  _only=False,.   
-0000d3f0: 2029 3a0a 2020 2020 2020 2020 2222 220a   ):.        """.
-0000d400: 2020 2020 2020 2020 2e2e 206e 6f74 653a          .. note:
-0000d410: 3a0a 0a20 2020 2020 2020 2020 2020 5468  :..           Th
-0000d420: 6973 2069 6d70 6c65 6d65 6e74 6174 696f  is implementatio
-0000d430: 6e20 666f 6c6c 6f77 7320 7468 6520 6461  n follows the da
-0000d440: 736b 2e61 7272 6179 2e73 7461 7473 2069  sk.array.stats i
-0000d450: 6d70 6c65 6d65 6e74 6174 696f 6e0a 2020  mplementation.  
-0000d460: 2020 2020 2020 2020 206f 6620 6b75 7274           of kurt
-0000d470: 6f73 6973 2061 6e64 2063 616c 6375 6c61  osis and calcula
-0000d480: 7465 7320 6b75 7274 6f73 6973 2077 6974  tes kurtosis wit
-0000d490: 686f 7574 2074 616b 696e 6720 696e 746f  hout taking into
-0000d4a0: 2061 6363 6f75 6e74 0a20 2020 2020 2020   account.       
-0000d4b0: 2020 2020 6120 6269 6173 2074 6572 6d20      a bias term 
-0000d4c0: 666f 7220 6669 6e69 7465 2073 616d 706c  for finite sampl
-0000d4d0: 6520 7369 7a65 2c20 7768 6963 6820 636f  e size, which co
-0000d4e0: 7272 6573 706f 6e64 7320 746f 2074 6865  rresponds to the
-0000d4f0: 0a20 2020 2020 2020 2020 2020 6465 6661  .           defa
-0000d500: 756c 7420 7365 7474 696e 6773 206f 6620  ult settings of 
-0000d510: 7468 6520 7363 6970 792e 7374 6174 7320  the scipy.stats 
-0000d520: 6b75 7274 6f73 6973 2063 616c 6375 6c61  kurtosis calcula
-0000d530: 7469 6f6e 2e20 5468 6973 2064 6966 6665  tion. This diffe
-0000d540: 7273 0a20 2020 2020 2020 2020 2020 6672  rs.           fr
-0000d550: 6f6d 2070 616e 6461 732e 0a0a 2020 2020  om pandas...    
-0000d560: 2020 2020 2020 2046 7572 7468 6572 2c20         Further, 
-0000d570: 7468 6973 206d 6574 686f 6420 6375 7272  this method curr
-0000d580: 656e 746c 7920 646f 6573 206e 6f74 2073  ently does not s
-0000d590: 7570 706f 7274 2066 696c 7465 7269 6e67  upport filtering
-0000d5a0: 206f 7574 204e 614e 0a20 2020 2020 2020   out NaN.       
-0000d5b0: 2020 2020 7661 6c75 6573 2c20 7768 6963      values, whic
-0000d5c0: 6820 6973 2061 6761 696e 2061 2064 6966  h is again a dif
-0000d5d0: 6665 7265 6e63 6520 746f 2050 616e 6461  ference to Panda
-0000d5e0: 732e 0a20 2020 2020 2020 2022 2222 0a20  s..        """. 
-0000d5f0: 2020 2020 2020 205f 7261 6973 655f 6966         _raise_if
-0000d600: 5f6f 626a 6563 745f 7365 7269 6573 2873  _object_series(s
-0000d610: 656c 662c 2022 6b75 7274 6f73 6973 2229  elf, "kurtosis")
-0000d620: 0a20 2020 2020 2020 2069 6620 6178 6973  .        if axis
-0000d630: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
-0000d640: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-0000d650: 6545 7272 6f72 2822 6061 7869 733d 4e6f  eError("`axis=No
-0000d660: 6e65 6020 6973 6e27 7420 6375 7272 656e  ne` isn't curren
-0000d670: 746c 7920 7375 7070 6f72 7465 6420 666f  tly supported fo
-0000d680: 7220 6073 6b65 7760 2229 0a20 2020 2020  r `skew`").     
-0000d690: 2020 2061 7869 7320 3d20 7365 6c66 2e5f     axis = self._
-0000d6a0: 7661 6c69 6461 7465 5f61 7869 7328 6178  validate_axis(ax
-0000d6b0: 6973 290a 0a20 2020 2020 2020 2069 6620  is)..        if 
-0000d6c0: 6973 5f64 6174 6166 7261 6d65 5f6c 696b  is_dataframe_lik
-0000d6d0: 6528 7365 6c66 293a 0a20 2020 2020 2020  e(self):.       
-0000d6e0: 2020 2020 2023 204c 6574 2070 616e 6461       # Let panda
-0000d6f0: 7320 7261 6973 6520 6572 726f 7273 2069  s raise errors i
-0000d700: 6620 6e65 6365 7373 6172 790a 2020 2020  f necessary.    
-0000d710: 2020 2020 2020 2020 6d65 7461 203d 2073          meta = s
-0000d720: 656c 662e 5f6d 6574 615f 6e6f 6e65 6d70  elf._meta_nonemp
-0000d730: 7479 2e6b 7572 746f 7369 7328 6178 6973  ty.kurtosis(axis
-0000d740: 3d61 7869 732c 206e 756d 6572 6963 5f6f  =axis, numeric_o
-0000d750: 6e6c 793d 6e75 6d65 7269 635f 6f6e 6c79  nly=numeric_only
-0000d760: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
-0000d770: 2020 2020 2020 2020 2020 2020 6d65 7461              meta
-0000d780: 203d 2073 656c 662e 5f6d 6574 615f 6e6f   = self._meta_no
-0000d790: 6e65 6d70 7479 2e6b 7572 746f 7369 7328  nempty.kurtosis(
-0000d7a0: 290a 0a20 2020 2020 2020 2069 6620 6178  )..        if ax
-0000d7b0: 6973 203d 3d20 313a 0a20 2020 2020 2020  is == 1:.       
-0000d7c0: 2020 2020 2072 6574 7572 6e20 6d61 705f       return map_
-0000d7d0: 7061 7274 6974 696f 6e73 280a 2020 2020  partitions(.    
-0000d7e0: 2020 2020 2020 2020 2020 2020 4d2e 6b75              M.ku
-0000d7f0: 7274 6f73 6973 2c0a 2020 2020 2020 2020  rtosis,.        
-0000d800: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-0000d810: 2020 2020 2020 2020 2020 2020 2020 6d65                me
-0000d820: 7461 3d6d 6574 612c 0a20 2020 2020 2020  ta=meta,.       
-0000d830: 2020 2020 2020 2020 2074 6f6b 656e 3d73           token=s
-0000d840: 656c 662e 5f74 6f6b 656e 5f70 7265 6669  elf._token_prefi
-0000d850: 7820 2b20 226b 7572 746f 7369 7322 2c0a  x + "kurtosis",.
-0000d860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d870: 6178 6973 3d61 7869 732c 0a20 2020 2020  axis=axis,.     
-0000d880: 2020 2020 2020 2020 2020 2065 6e66 6f72             enfor
-0000d890: 6365 5f6d 6574 6164 6174 613d 4661 6c73  ce_metadata=Fals
-0000d8a0: 652c 0a20 2020 2020 2020 2020 2020 2029  e,.            )
-0000d8b0: 0a0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
-0000d8c0: 2062 6961 733a 0a20 2020 2020 2020 2020   bias:.         
-0000d8d0: 2020 2072 6169 7365 204e 6f74 496d 706c     raise NotImpl
-0000d8e0: 656d 656e 7465 6445 7272 6f72 2822 6269  ementedError("bi
-0000d8f0: 6173 3d46 616c 7365 2069 7320 6e6f 7420  as=False is not 
-0000d900: 696d 706c 656d 656e 7465 642e 2229 0a20  implemented."). 
-0000d910: 2020 2020 2020 2069 6620 6e61 6e5f 706f         if nan_po
-0000d920: 6c69 6379 2021 3d20 2270 726f 7061 6761  licy != "propaga
-0000d930: 7465 223a 0a20 2020 2020 2020 2020 2020  te":.           
-0000d940: 2072 6169 7365 204e 6f74 496d 706c 656d   raise NotImplem
-0000d950: 656e 7465 6445 7272 6f72 280a 2020 2020  entedError(.    
-0000d960: 2020 2020 2020 2020 2020 2020 2260 6e61              "`na
-0000d970: 6e5f 706f 6c69 6379 6020 6f74 6865 7220  n_policy` other 
-0000d980: 7468 616e 2027 7072 6f70 6167 6174 6527  than 'propagate'
-0000d990: 2068 6176 6520 6e6f 7420 6265 656e 2069   have not been i
-0000d9a0: 6d70 6c65 6d65 6e74 6564 2e22 0a20 2020  mplemented.".   
-0000d9b0: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-0000d9c0: 2020 2020 6672 616d 6520 3d20 7365 6c66      frame = self
-0000d9d0: 0a20 2020 2020 2020 2069 6620 6672 616d  .        if fram
-0000d9e0: 652e 6e64 696d 203e 2031 3a0a 2020 2020  e.ndim > 1:.    
-0000d9f0: 2020 2020 2020 2020 6672 616d 6520 3d20          frame = 
-0000da00: 6672 616d 652e 7365 6c65 6374 5f64 7479  frame.select_dty
-0000da10: 7065 7328 0a20 2020 2020 2020 2020 2020  pes(.           
-0000da20: 2020 2020 2069 6e63 6c75 6465 3d5b 226e       include=["n
-0000da30: 756d 6265 7222 2c20 2262 6f6f 6c22 5d2c  umber", "bool"],
-0000da40: 2065 7863 6c75 6465 3d5b 6e70 2e74 696d   exclude=[np.tim
-0000da50: 6564 656c 7461 3634 5d0a 2020 2020 2020  edelta64].      
-0000da60: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0000da70: 6d32 203d 206e 6577 5f63 6f6c 6c65 6374  m2 = new_collect
-0000da80: 696f 6e28 4d6f 6d65 6e74 2866 7261 6d65  ion(Moment(frame
-0000da90: 2c20 6f72 6465 723d 3229 290a 2020 2020  , order=2)).    
-0000daa0: 2020 2020 6d34 203d 206e 6577 5f63 6f6c      m4 = new_col
-0000dab0: 6c65 6374 696f 6e28 4d6f 6d65 6e74 2866  lection(Moment(f
-0000dac0: 7261 6d65 2c20 6f72 6465 723d 3429 290a  rame, order=4)).
-0000dad0: 2020 2020 2020 2020 7265 7375 6c74 203d          result =
-0000dae0: 206d 3420 2f20 6d32 2a2a 322e 300a 2020   m4 / m2**2.0.  
-0000daf0: 2020 2020 2020 6966 2072 6573 756c 742e        if result.
-0000db00: 6e64 696d 203d 3d20 313a 0a20 2020 2020  ndim == 1:.     
-0000db10: 2020 2020 2020 2072 6573 756c 7420 3d20         result = 
-0000db20: 7265 7375 6c74 2e66 696c 6c6e 6128 302e  result.fillna(0.
-0000db30: 3029 0a20 2020 2020 2020 2069 6620 6669  0).        if fi
-0000db40: 7368 6572 3a0a 2020 2020 2020 2020 2020  sher:.          
-0000db50: 2020 7265 7475 726e 2072 6573 756c 7420    return result 
-0000db60: 2d20 330a 2020 2020 2020 2020 656c 7365  - 3.        else
-0000db70: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-0000db80: 7475 726e 2072 6573 756c 740a 0a20 2020  turn result..   
-0000db90: 206b 7572 7420 3d20 6b75 7274 6f73 6973   kurt = kurtosis
-0000dba0: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
-0000dbb0: 726f 6d28 7064 2e44 6174 6146 7261 6d65  rom(pd.DataFrame
-0000dbc0: 290a 2020 2020 6465 6620 7365 6d28 0a20  ).    def sem(. 
-0000dbd0: 2020 2020 2020 2073 656c 662c 2061 7869         self, axi
-0000dbe0: 733d 4e6f 6e65 2c20 736b 6970 6e61 3d54  s=None, skipna=T
-0000dbf0: 7275 652c 2064 646f 663d 312c 2073 706c  rue, ddof=1, spl
-0000dc00: 6974 5f65 7665 7279 3d46 616c 7365 2c20  it_every=False, 
-0000dc10: 6e75 6d65 7269 635f 6f6e 6c79 3d46 616c  numeric_only=Fal
-0000dc20: 7365 0a20 2020 2029 3a0a 2020 2020 2020  se.    ):.      
-0000dc30: 2020 6178 6973 203d 2073 656c 662e 5f76    axis = self._v
-0000dc40: 616c 6964 6174 655f 6178 6973 2861 7869  alidate_axis(axi
-0000dc50: 7329 0a20 2020 2020 2020 205f 7261 6973  s).        _rais
-0000dc60: 655f 6966 5f6f 626a 6563 745f 7365 7269  e_if_object_seri
-0000dc70: 6573 2873 656c 662c 2022 7365 6d22 290a  es(self, "sem").
-0000dc80: 2020 2020 2020 2020 6966 2061 7869 7320          if axis 
-0000dc90: 3d3d 2031 3a0a 2020 2020 2020 2020 2020  == 1:.          
-0000dca0: 2020 7265 7475 726e 2073 656c 662e 6d61    return self.ma
-0000dcb0: 705f 7061 7274 6974 696f 6e73 280a 2020  p_partitions(.  
-0000dcc0: 2020 2020 2020 2020 2020 2020 2020 4d2e                M.
-0000dcd0: 7365 6d2c 0a20 2020 2020 2020 2020 2020  sem,.           
-0000dce0: 2020 2020 2061 7869 733d 6178 6973 2c0a       axis=axis,.
-0000dcf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000dd00: 736b 6970 6e61 3d73 6b69 706e 612c 0a20  skipna=skipna,. 
-0000dd10: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-0000dd20: 646f 663d 6464 6f66 2c0a 2020 2020 2020  dof=ddof,.      
-0000dd30: 2020 2020 2020 2020 2020 6e75 6d65 7269            numeri
-0000dd40: 635f 6f6e 6c79 3d6e 756d 6572 6963 5f6f  c_only=numeric_o
-0000dd50: 6e6c 792c 0a20 2020 2020 2020 2020 2020  nly,.           
-0000dd60: 2029 0a20 2020 2020 2020 206d 6574 6120   ).        meta 
-0000dd70: 3d20 7365 6c66 2e5f 6d65 7461 2e73 656d  = self._meta.sem
-0000dd80: 2873 6b69 706e 613d 736b 6970 6e61 2c20  (skipna=skipna, 
-0000dd90: 6464 6f66 3d64 646f 662c 206e 756d 6572  ddof=ddof, numer
-0000dda0: 6963 5f6f 6e6c 793d 6e75 6d65 7269 635f  ic_only=numeric_
-0000ddb0: 6f6e 6c79 290a 2020 2020 2020 2020 6672  only).        fr
-0000ddc0: 616d 6520 3d20 7365 6c66 0a20 2020 2020  ame = self.     
-0000ddd0: 2020 2069 6620 7365 6c66 2e6e 6469 6d20     if self.ndim 
-0000dde0: 3d3d 2032 3a0a 2020 2020 2020 2020 2020  == 2:.          
-0000ddf0: 2020 6672 616d 6520 3d20 7365 6c66 5b6c    frame = self[l
-0000de00: 6973 7428 6d65 7461 2e69 6e64 6578 295d  ist(meta.index)]
-0000de10: 0a0a 2020 2020 2020 2020 7620 3d20 6672  ..        v = fr
-0000de20: 616d 652e 7661 7228 736b 6970 6e61 3d73  ame.var(skipna=s
-0000de30: 6b69 706e 612c 2064 646f 663d 6464 6f66  kipna, ddof=ddof
-0000de40: 2c20 7370 6c69 745f 6576 6572 793d 7370  , split_every=sp
-0000de50: 6c69 745f 6576 6572 7929 0a20 2020 2020  lit_every).     
-0000de60: 2020 206e 203d 2066 7261 6d65 2e63 6f75     n = frame.cou
-0000de70: 6e74 2873 706c 6974 5f65 7665 7279 3d73  nt(split_every=s
-0000de80: 706c 6974 5f65 7665 7279 290a 2020 2020  plit_every).    
-0000de90: 2020 2020 7265 7375 6c74 203d 206d 6170      result = map
-0000dea0: 5f70 6172 7469 7469 6f6e 7328 0a20 2020  _partitions(.   
-0000deb0: 2020 2020 2020 2020 206e 702e 7371 7274           np.sqrt
-0000dec0: 2c0a 2020 2020 2020 2020 2020 2020 7620  ,.            v 
-0000ded0: 2f20 6e2c 0a20 2020 2020 2020 2020 2020  / n,.           
-0000dee0: 206d 6574 613d 6d65 7461 2c0a 2020 2020   meta=meta,.    
-0000def0: 2020 2020 2020 2020 656e 666f 7263 655f          enforce_
-0000df00: 6d65 7461 6461 7461 3d46 616c 7365 2c0a  metadata=False,.
-0000df10: 2020 2020 2020 2020 2020 2020 7061 7265              pare
-0000df20: 6e74 5f6d 6574 613d 7365 6c66 2e5f 6d65  nt_meta=self._me
-0000df30: 7461 2c0a 2020 2020 2020 2020 290a 2020  ta,.        ).  
-0000df40: 2020 2020 2020 7265 7475 726e 2072 6573        return res
-0000df50: 756c 740a 0a20 2020 2064 6566 205f 7072  ult..    def _pr
-0000df60: 6570 6172 655f 636f 765f 636f 7272 2873  epare_cov_corr(s
-0000df70: 656c 662c 206d 696e 5f70 6572 696f 6473  elf, min_periods
-0000df80: 2c20 6e75 6d65 7269 635f 6f6e 6c79 293a  , numeric_only):
-0000df90: 0a20 2020 2020 2020 2069 6620 6d69 6e5f  .        if min_
-0000dfa0: 7065 7269 6f64 7320 6973 204e 6f6e 653a  periods is None:
-0000dfb0: 0a20 2020 2020 2020 2020 2020 206d 696e  .            min
-0000dfc0: 5f70 6572 696f 6473 203d 2032 0a20 2020  _periods = 2.   
-0000dfd0: 2020 2020 2065 6c69 6620 6d69 6e5f 7065       elif min_pe
-0000dfe0: 7269 6f64 7320 3c20 323a 0a20 2020 2020  riods < 2:.     
-0000dff0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-0000e000: 7565 4572 726f 7228 226d 696e 5f70 6572  ueError("min_per
-0000e010: 696f 6473 206d 7573 7420 6265 203e 3d20  iods must be >= 
-0000e020: 3222 290a 0a20 2020 2020 2020 2073 656c  2")..        sel
-0000e030: 662e 5f6d 6574 612e 636f 7628 6e75 6d65  f._meta.cov(nume
-0000e040: 7269 635f 6f6e 6c79 3d6e 756d 6572 6963  ric_only=numeric
-0000e050: 5f6f 6e6c 792c 206d 696e 5f70 6572 696f  _only, min_perio
-0000e060: 6473 3d6d 696e 5f70 6572 696f 6473 290a  ds=min_periods).
-0000e070: 0a20 2020 2020 2020 2066 7261 6d65 203d  .        frame =
-0000e080: 2073 656c 660a 2020 2020 2020 2020 6966   self.        if
-0000e090: 206e 756d 6572 6963 5f6f 6e6c 793a 0a20   numeric_only:. 
-0000e0a0: 2020 2020 2020 2020 2020 206e 756d 6572             numer
-0000e0b0: 6963 7320 3d20 7365 6c66 2e5f 6d65 7461  ics = self._meta
-0000e0c0: 2e5f 6765 745f 6e75 6d65 7269 635f 6461  ._get_numeric_da
-0000e0d0: 7461 2829 0a20 2020 2020 2020 2020 2020  ta().           
-0000e0e0: 2069 6620 6c65 6e28 6e75 6d65 7269 6373   if len(numerics
-0000e0f0: 2e63 6f6c 756d 6e73 2920 213d 206c 656e  .columns) != len
-0000e100: 2873 656c 662e 636f 6c75 6d6e 7329 3a0a  (self.columns):.
-0000e110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e120: 6672 616d 6520 3d20 6672 616d 655b 6c69  frame = frame[li
-0000e130: 7374 286e 756d 6572 6963 732e 636f 6c75  st(numerics.colu
-0000e140: 6d6e 7329 5d0a 2020 2020 2020 2020 7265  mns)].        re
-0000e150: 7475 726e 2066 7261 6d65 2c20 6d69 6e5f  turn frame, min_
-0000e160: 7065 7269 6f64 730a 0a20 2020 2064 6566  periods..    def
-0000e170: 205f 636f 7628 0a20 2020 2020 2020 2073   _cov(.        s
-0000e180: 656c 662c 206d 696e 5f70 6572 696f 6473  elf, min_periods
-0000e190: 3d4e 6f6e 652c 206e 756d 6572 6963 5f6f  =None, numeric_o
-0000e1a0: 6e6c 793d 4661 6c73 652c 2073 706c 6974  nly=False, split
-0000e1b0: 5f65 7665 7279 3d46 616c 7365 2c20 7363  _every=False, sc
-0000e1c0: 616c 6172 3d46 616c 7365 0a20 2020 2029  alar=False.    )
-0000e1d0: 3a0a 2020 2020 2020 2020 6672 616d 652c  :.        frame,
-0000e1e0: 206d 696e 5f70 6572 696f 6473 203d 2073   min_periods = s
-0000e1f0: 656c 662e 5f70 7265 7061 7265 5f63 6f76  elf._prepare_cov
-0000e200: 5f63 6f72 7228 6d69 6e5f 7065 7269 6f64  _corr(min_period
-0000e210: 732c 206e 756d 6572 6963 5f6f 6e6c 7929  s, numeric_only)
-0000e220: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0000e230: 6e65 775f 636f 6c6c 6563 7469 6f6e 2843  new_collection(C
-0000e240: 6f76 2866 7261 6d65 2c20 6d69 6e5f 7065  ov(frame, min_pe
-0000e250: 7269 6f64 732c 2073 706c 6974 5f65 7665  riods, split_eve
-0000e260: 7279 2c20 7363 616c 6172 2929 0a0a 2020  ry, scalar))..  
-0000e270: 2020 6465 6620 5f63 6f72 7228 0a20 2020    def _corr(.   
-0000e280: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-0000e290: 2020 206d 6574 686f 643d 2270 6561 7273     method="pears
-0000e2a0: 6f6e 222c 0a20 2020 2020 2020 206d 696e  on",.        min
-0000e2b0: 5f70 6572 696f 6473 3d4e 6f6e 652c 0a20  _periods=None,. 
-0000e2c0: 2020 2020 2020 206e 756d 6572 6963 5f6f         numeric_o
-0000e2d0: 6e6c 793d 4661 6c73 652c 0a20 2020 2020  nly=False,.     
-0000e2e0: 2020 2073 706c 6974 5f65 7665 7279 3d46     split_every=F
-0000e2f0: 616c 7365 2c0a 2020 2020 2020 2020 7363  alse,.        sc
-0000e300: 616c 6172 3d46 616c 7365 2c0a 2020 2020  alar=False,.    
-0000e310: 293a 0a20 2020 2020 2020 2069 6620 6d65  ):.        if me
-0000e320: 7468 6f64 2021 3d20 2270 6561 7273 6f6e  thod != "pearson
-0000e330: 223a 0a20 2020 2020 2020 2020 2020 2072  ":.            r
-0000e340: 6169 7365 204e 6f74 496d 706c 656d 656e  aise NotImplemen
-0000e350: 7465 6445 7272 6f72 2822 4f6e 6c79 2050  tedError("Only P
-0000e360: 6561 7273 6f6e 2063 6f72 7265 6c61 7469  earson correlati
-0000e370: 6f6e 2068 6173 2062 6565 6e20 696d 706c  on has been impl
-0000e380: 656d 656e 7465 6422 290a 2020 2020 2020  emented").      
-0000e390: 2020 6672 616d 652c 206d 696e 5f70 6572    frame, min_per
-0000e3a0: 696f 6473 203d 2073 656c 662e 5f70 7265  iods = self._pre
-0000e3b0: 7061 7265 5f63 6f76 5f63 6f72 7228 6d69  pare_cov_corr(mi
-0000e3c0: 6e5f 7065 7269 6f64 732c 206e 756d 6572  n_periods, numer
-0000e3d0: 6963 5f6f 6e6c 7929 0a20 2020 2020 2020  ic_only).       
-0000e3e0: 2072 6574 7572 6e20 6e65 775f 636f 6c6c   return new_coll
-0000e3f0: 6563 7469 6f6e 2843 6f72 7228 6672 616d  ection(Corr(fram
-0000e400: 652c 206d 696e 5f70 6572 696f 6473 2c20  e, min_periods, 
-0000e410: 7370 6c69 745f 6576 6572 792c 2073 6361  split_every, sca
-0000e420: 6c61 7229 290a 0a20 2020 2040 6465 7269  lar))..    @deri
-0000e430: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
-0000e440: 4672 616d 6529 0a20 2020 2064 6566 206d  Frame).    def m
-0000e450: 6561 6e28 0a20 2020 2020 2020 2073 656c  ean(.        sel
-0000e460: 662c 2061 7869 733d 302c 2073 6b69 706e  f, axis=0, skipn
-0000e470: 613d 5472 7565 2c20 6e75 6d65 7269 635f  a=True, numeric_
-0000e480: 6f6e 6c79 3d46 616c 7365 2c20 7370 6c69  only=False, spli
-0000e490: 745f 6576 6572 793d 4661 6c73 652c 202a  t_every=False, *
-0000e4a0: 2a6b 7761 7267 730a 2020 2020 293a 0a20  *kwargs.    ):. 
-0000e4b0: 2020 2020 2020 205f 7261 6973 655f 6966         _raise_if
-0000e4c0: 5f6f 626a 6563 745f 7365 7269 6573 2873  _object_series(s
-0000e4d0: 656c 662c 2022 6d65 616e 2229 0a20 2020  elf, "mean").   
-0000e4e0: 2020 2020 2061 7869 7320 3d20 7365 6c66       axis = self
-0000e4f0: 2e5f 7661 6c69 6461 7465 5f61 7869 7328  ._validate_axis(
-0000e500: 6178 6973 290a 2020 2020 2020 2020 6966  axis).        if
-0000e510: 2061 7869 7320 3d3d 2031 3a0a 2020 2020   axis == 1:.    
-0000e520: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0000e530: 656c 662e 6d61 705f 7061 7274 6974 696f  elf.map_partitio
-0000e540: 6e73 280a 2020 2020 2020 2020 2020 2020  ns(.            
-0000e550: 2020 2020 4d2e 6d65 616e 2c20 736b 6970      M.mean, skip
-0000e560: 6e61 3d73 6b69 706e 612c 206e 756d 6572  na=skipna, numer
-0000e570: 6963 5f6f 6e6c 793d 6e75 6d65 7269 635f  ic_only=numeric_
-0000e580: 6f6e 6c79 2c20 6178 6973 3d61 7869 730a  only, axis=axis.
-0000e590: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-0000e5a0: 2020 2020 2020 7265 7475 726e 206e 6577        return new
-0000e5b0: 5f63 6f6c 6c65 6374 696f 6e28 0a20 2020  _collection(.   
-0000e5c0: 2020 2020 2020 2020 2073 656c 662e 6578           self.ex
-0000e5d0: 7072 2e6d 6561 6e28 736b 6970 6e61 2c20  pr.mean(skipna, 
-0000e5e0: 6e75 6d65 7269 635f 6f6e 6c79 2c20 7370  numeric_only, sp
-0000e5f0: 6c69 745f 6576 6572 793d 7370 6c69 745f  lit_every=split_
-0000e600: 6576 6572 792c 2061 7869 733d 6178 6973  every, axis=axis
-0000e610: 290a 2020 2020 2020 2020 290a 0a20 2020  ).        )..   
-0000e620: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
-0000e630: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
-0000e640: 2064 6566 206d 6178 2873 656c 662c 2061   def max(self, a
-0000e650: 7869 733d 302c 2073 6b69 706e 613d 5472  xis=0, skipna=Tr
-0000e660: 7565 2c20 6e75 6d65 7269 635f 6f6e 6c79  ue, numeric_only
-0000e670: 3d46 616c 7365 2c20 7370 6c69 745f 6576  =False, split_ev
-0000e680: 6572 793d 4661 6c73 652c 202a 2a6b 7761  ery=False, **kwa
-0000e690: 7267 7329 3a0a 2020 2020 2020 2020 6178  rgs):.        ax
-0000e6a0: 6973 203d 2073 656c 662e 5f76 616c 6964  is = self._valid
-0000e6b0: 6174 655f 6178 6973 2861 7869 7329 0a20  ate_axis(axis). 
-0000e6c0: 2020 2020 2020 2069 6620 6178 6973 203d         if axis =
-0000e6d0: 3d20 313a 0a20 2020 2020 2020 2020 2020  = 1:.           
-0000e6e0: 2072 6574 7572 6e20 7365 6c66 2e6d 6170   return self.map
-0000e6f0: 5f70 6172 7469 7469 6f6e 7328 0a20 2020  _partitions(.   
-0000e700: 2020 2020 2020 2020 2020 2020 204d 2e6d               M.m
-0000e710: 6178 2c20 736b 6970 6e61 3d73 6b69 706e  ax, skipna=skipn
-0000e720: 612c 206e 756d 6572 6963 5f6f 6e6c 793d  a, numeric_only=
-0000e730: 6e75 6d65 7269 635f 6f6e 6c79 2c20 6178  numeric_only, ax
-0000e740: 6973 3d61 7869 730a 2020 2020 2020 2020  is=axis.        
-0000e750: 2020 2020 290a 2020 2020 2020 2020 7265      ).        re
-0000e760: 7475 726e 206e 6577 5f63 6f6c 6c65 6374  turn new_collect
-0000e770: 696f 6e28 7365 6c66 2e65 7870 722e 6d61  ion(self.expr.ma
-0000e780: 7828 736b 6970 6e61 2c20 6e75 6d65 7269  x(skipna, numeri
-0000e790: 635f 6f6e 6c79 2c20 7370 6c69 745f 6576  c_only, split_ev
-0000e7a0: 6572 792c 2061 7869 7329 290a 0a20 2020  ery, axis))..   
-0000e7b0: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
-0000e7c0: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
-0000e7d0: 2064 6566 2061 6e79 2873 656c 662c 2061   def any(self, a
-0000e7e0: 7869 733d 302c 2073 6b69 706e 613d 5472  xis=0, skipna=Tr
-0000e7f0: 7565 2c20 7370 6c69 745f 6576 6572 793d  ue, split_every=
-0000e800: 4661 6c73 652c 202a 2a6b 7761 7267 7329  False, **kwargs)
-0000e810: 3a0a 2020 2020 2020 2020 6178 6973 203d  :.        axis =
-0000e820: 2073 656c 662e 5f76 616c 6964 6174 655f   self._validate_
-0000e830: 6178 6973 2861 7869 7329 0a20 2020 2020  axis(axis).     
-0000e840: 2020 2069 6620 6178 6973 203d 3d20 313a     if axis == 1:
-0000e850: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-0000e860: 7572 6e20 7365 6c66 2e6d 6170 5f70 6172  urn self.map_par
-0000e870: 7469 7469 6f6e 7328 4d2e 616e 792c 2073  titions(M.any, s
-0000e880: 6b69 706e 613d 736b 6970 6e61 2c20 6178  kipna=skipna, ax
-0000e890: 6973 3d61 7869 7329 0a20 2020 2020 2020  is=axis).       
-0000e8a0: 2072 6574 7572 6e20 6e65 775f 636f 6c6c   return new_coll
-0000e8b0: 6563 7469 6f6e 2873 656c 662e 6578 7072  ection(self.expr
-0000e8c0: 2e61 6e79 2873 6b69 706e 612c 2073 706c  .any(skipna, spl
-0000e8d0: 6974 5f65 7665 7279 2929 0a0a 2020 2020  it_every))..    
-0000e8e0: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
-0000e8f0: 2e44 6174 6146 7261 6d65 290a 2020 2020  .DataFrame).    
-0000e900: 6465 6620 616c 6c28 7365 6c66 2c20 6178  def all(self, ax
-0000e910: 6973 3d30 2c20 736b 6970 6e61 3d54 7275  is=0, skipna=Tru
-0000e920: 652c 2073 706c 6974 5f65 7665 7279 3d46  e, split_every=F
-0000e930: 616c 7365 2c20 2a2a 6b77 6172 6773 293a  alse, **kwargs):
-0000e940: 0a20 2020 2020 2020 2061 7869 7320 3d20  .        axis = 
-0000e950: 7365 6c66 2e5f 7661 6c69 6461 7465 5f61  self._validate_a
-0000e960: 7869 7328 6178 6973 290a 2020 2020 2020  xis(axis).      
-0000e970: 2020 6966 2061 7869 7320 3d3d 2031 3a0a    if axis == 1:.
-0000e980: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0000e990: 726e 2073 656c 662e 6d61 705f 7061 7274  rn self.map_part
-0000e9a0: 6974 696f 6e73 284d 2e61 6c6c 2c20 736b  itions(M.all, sk
-0000e9b0: 6970 6e61 3d73 6b69 706e 612c 2061 7869  ipna=skipna, axi
-0000e9c0: 733d 6178 6973 290a 2020 2020 2020 2020  s=axis).        
-0000e9d0: 7265 7475 726e 206e 6577 5f63 6f6c 6c65  return new_colle
-0000e9e0: 6374 696f 6e28 7365 6c66 2e65 7870 722e  ction(self.expr.
-0000e9f0: 616c 6c28 736b 6970 6e61 2c20 7370 6c69  all(skipna, spli
-0000ea00: 745f 6576 6572 7929 290a 0a20 2020 2040  t_every))..    @
+000095e0: 2020 2070 6572 696f 6473 2c20 302c 2070     periods, 0, p
+000095f0: 6572 696f 6473 3d70 6572 696f 6473 290a  eriods=periods).
+00009600: 2020 2020 2020 2020 3e3e 3e20 6469 6666          >>> diff
+00009610: 2864 6466 2c20 3129 2e63 6f6d 7075 7465  (ddf, 1).compute
+00009620: 2829 0a20 2020 2020 2020 2020 2020 2020  ().             
+00009630: 7820 2020 2079 0a20 2020 2020 2020 2030  x    y.        0
+00009640: 2020 4e61 4e20 204e 614e 0a20 2020 2020    NaN  NaN.     
+00009650: 2020 2031 2020 312e 3020 2031 2e30 0a20     1  1.0  1.0. 
+00009660: 2020 2020 2020 2032 2020 322e 3020 2031         2  2.0  1
+00009670: 2e30 0a20 2020 2020 2020 2033 2020 332e  .0.        3  3.
+00009680: 3020 2031 2e30 0a20 2020 2020 2020 2034  0  1.0.        4
+00009690: 2020 342e 3020 2031 2e30 0a0a 2020 2020    4.0  1.0..    
+000096a0: 2020 2020 4966 2079 6f75 2068 6176 6520      If you have 
+000096b0: 6120 6060 4461 7465 7469 6d65 496e 6465  a ``DatetimeInde
+000096c0: 7860 602c 2079 6f75 2063 616e 2075 7365  x``, you can use
+000096d0: 2061 2060 6070 642e 5469 6d65 6465 6c74   a ``pd.Timedelt
+000096e0: 6160 6020 666f 7220 7469 6d65 2d0a 2020  a`` for time-.  
+000096f0: 2020 2020 2020 6261 7365 6420 7769 6e64        based wind
+00009700: 6f77 7320 6f72 2061 6e79 2060 6070 642e  ows or any ``pd.
+00009710: 5469 6d65 6465 6c74 6160 6020 636f 6e76  Timedelta`` conv
+00009720: 6572 7469 626c 6520 7374 7269 6e67 3a0a  ertible string:.
+00009730: 0a20 2020 2020 2020 203e 3e3e 2074 7320  .        >>> ts 
+00009740: 3d20 7064 2e53 6572 6965 7328 7261 6e67  = pd.Series(rang
+00009750: 6528 3130 292c 2069 6e64 6578 3d70 642e  e(10), index=pd.
+00009760: 6461 7465 5f72 616e 6765 2827 3230 3137  date_range('2017
+00009770: 272c 2070 6572 696f 6473 3d31 3029 290a  ', periods=10)).
+00009780: 2020 2020 2020 2020 3e3e 3e20 6474 7320          >>> dts 
+00009790: 3d20 6464 2e66 726f 6d5f 7061 6e64 6173  = dd.from_pandas
+000097a0: 2874 732c 206e 7061 7274 6974 696f 6e73  (ts, npartitions
+000097b0: 3d32 290a 2020 2020 2020 2020 3e3e 3e20  =2).        >>> 
+000097c0: 6474 732e 6d61 705f 6f76 6572 6c61 7028  dts.map_overlap(
+000097d0: 6c61 6d62 6461 2064 663a 2064 662e 726f  lambda df: df.ro
+000097e0: 6c6c 696e 6728 2732 4427 292e 7375 6d28  lling('2D').sum(
+000097f0: 292c 0a20 2020 2020 2020 202e 2e2e 2020  ),.        ...  
+00009800: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00009810: 642e 5469 6d65 6465 6c74 6128 2732 4427  d.Timedelta('2D'
+00009820: 292c 2030 292e 636f 6d70 7574 6528 290a  ), 0).compute().
+00009830: 2020 2020 2020 2020 3230 3137 2d30 312d          2017-01-
+00009840: 3031 2020 2020 2030 2e30 0a20 2020 2020  01     0.0.     
+00009850: 2020 2032 3031 372d 3031 2d30 3220 2020     2017-01-02   
+00009860: 2020 312e 300a 2020 2020 2020 2020 3230    1.0.        20
+00009870: 3137 2d30 312d 3033 2020 2020 2033 2e30  17-01-03     3.0
+00009880: 0a20 2020 2020 2020 2032 3031 372d 3031  .        2017-01
+00009890: 2d30 3420 2020 2020 352e 300a 2020 2020  -04     5.0.    
+000098a0: 2020 2020 3230 3137 2d30 312d 3035 2020      2017-01-05  
+000098b0: 2020 2037 2e30 0a20 2020 2020 2020 2032     7.0.        2
+000098c0: 3031 372d 3031 2d30 3620 2020 2020 392e  017-01-06     9.
+000098d0: 300a 2020 2020 2020 2020 3230 3137 2d30  0.        2017-0
+000098e0: 312d 3037 2020 2020 3131 2e30 0a20 2020  1-07    11.0.   
+000098f0: 2020 2020 2032 3031 372d 3031 2d30 3820       2017-01-08 
+00009900: 2020 2031 332e 300a 2020 2020 2020 2020     13.0.        
+00009910: 3230 3137 2d30 312d 3039 2020 2020 3135  2017-01-09    15
+00009920: 2e30 0a20 2020 2020 2020 2032 3031 372d  .0.        2017-
+00009930: 3031 2d31 3020 2020 2031 372e 300a 2020  01-10    17.0.  
+00009940: 2020 2020 2020 4672 6571 3a20 442c 2064        Freq: D, d
+00009950: 7479 7065 3a20 666c 6f61 7436 340a 2020  type: float64.  
+00009960: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00009970: 2020 7265 7475 726e 206d 6170 5f6f 7665    return map_ove
+00009980: 726c 6170 280a 2020 2020 2020 2020 2020  rlap(.          
+00009990: 2020 6675 6e63 2c0a 2020 2020 2020 2020    func,.        
+000099a0: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+000099b0: 2020 2020 2020 6265 666f 7265 2c0a 2020        before,.  
+000099c0: 2020 2020 2020 2020 2020 6166 7465 722c            after,
+000099d0: 0a20 2020 2020 2020 2020 2020 202a 6172  .            *ar
+000099e0: 6773 2c0a 2020 2020 2020 2020 2020 2020  gs,.            
+000099f0: 6d65 7461 3d6d 6574 612c 0a20 2020 2020  meta=meta,.     
+00009a00: 2020 2020 2020 2065 6e66 6f72 6365 5f6d         enforce_m
+00009a10: 6574 6164 6174 613d 656e 666f 7263 655f  etadata=enforce_
+00009a20: 6d65 7461 6461 7461 2c0a 2020 2020 2020  metadata,.      
+00009a30: 2020 2020 2020 7472 616e 7366 6f72 6d5f        transform_
+00009a40: 6469 7669 7369 6f6e 733d 7472 616e 7366  divisions=transf
+00009a50: 6f72 6d5f 6469 7669 7369 6f6e 732c 0a20  orm_divisions,. 
+00009a60: 2020 2020 2020 2020 2020 2063 6c65 6172             clear
+00009a70: 5f64 6976 6973 696f 6e73 3d63 6c65 6172  _divisions=clear
+00009a80: 5f64 6976 6973 696f 6e73 2c0a 2020 2020  _divisions,.    
+00009a90: 2020 2020 2020 2020 616c 6967 6e5f 6461          align_da
+00009aa0: 7461 6672 616d 6573 3d61 6c69 676e 5f64  taframes=align_d
+00009ab0: 6174 6166 7261 6d65 732c 0a20 2020 2020  ataframes,.     
+00009ac0: 2020 2020 2020 202a 2a6b 7761 7267 732c         **kwargs,
+00009ad0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+00009ae0: 6465 6620 7265 7061 7274 6974 696f 6e28  def repartition(
+00009af0: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+00009b00: 2020 2020 2020 2064 6976 6973 696f 6e73         divisions
+00009b10: 3a20 7475 706c 6520 7c20 4e6f 6e65 203d  : tuple | None =
+00009b20: 204e 6f6e 652c 0a20 2020 2020 2020 206e   None,.        n
+00009b30: 7061 7274 6974 696f 6e73 3a20 696e 7420  partitions: int 
+00009b40: 7c20 4e6f 6e65 203d 204e 6f6e 652c 0a20  | None = None,. 
+00009b50: 2020 2020 2020 2070 6172 7469 7469 6f6e         partition
+00009b60: 5f73 697a 653a 2073 7472 203d 204e 6f6e  _size: str = Non
+00009b70: 652c 0a20 2020 2020 2020 2066 7265 713d  e,.        freq=
+00009b80: 4e6f 6e65 2c0a 2020 2020 2020 2020 666f  None,.        fo
+00009b90: 7263 653a 2062 6f6f 6c20 3d20 4661 6c73  rce: bool = Fals
+00009ba0: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
+00009bb0: 2020 2222 2252 6570 6172 7469 7469 6f6e    """Repartition
+00009bc0: 2061 2063 6f6c 6c65 6374 696f 6e0a 0a20   a collection.. 
+00009bd0: 2020 2020 2020 2045 7861 6374 6c79 206f         Exactly o
+00009be0: 6e65 206f 6620 6064 6976 6973 696f 6e73  ne of `divisions
+00009bf0: 602c 2060 6e70 6172 7469 7469 6f6e 7360  `, `npartitions`
+00009c00: 206f 7220 6070 6172 7469 7469 6f6e 5f73   or `partition_s
+00009c10: 697a 6560 2073 686f 756c 6420 6265 0a20  ize` should be. 
+00009c20: 2020 2020 2020 2073 7065 6369 6669 6564         specified
+00009c30: 2e20 4120 6060 5661 6c75 6545 7272 6f72  . A ``ValueError
+00009c40: 6060 2077 696c 6c20 6265 2072 6169 7365  `` will be raise
+00009c50: 6420 7768 656e 2074 6861 7420 6973 206e  d when that is n
+00009c60: 6f74 2074 6865 2063 6173 652e 0a0a 2020  ot the case...  
+00009c70: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+00009c80: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00009c90: 2d2d 2d0a 2020 2020 2020 2020 6469 7669  ---.        divi
+00009ca0: 7369 6f6e 7320 3a20 6c69 7374 2c20 6f70  sions : list, op
+00009cb0: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
+00009cc0: 2020 2054 6865 2022 6469 7669 6469 6e67     The "dividing
+00009cd0: 206c 696e 6573 2220 7573 6564 2074 6f20   lines" used to 
+00009ce0: 7370 6c69 7420 7468 6520 6461 7461 6672  split the datafr
+00009cf0: 616d 6520 696e 746f 2070 6172 7469 7469  ame into partiti
+00009d00: 6f6e 732e 0a20 2020 2020 2020 2020 2020  ons..           
+00009d10: 2046 6f72 2060 6064 6976 6973 696f 6e73   For ``divisions
+00009d20: 3d5b 302c 2031 302c 2035 302c 2031 3030  =[0, 10, 50, 100
+00009d30: 5d60 602c 2074 6865 7265 2077 6f75 6c64  ]``, there would
+00009d40: 2062 6520 7468 7265 6520 6f75 7470 7574   be three output
+00009d50: 2070 6172 7469 7469 6f6e 732c 0a20 2020   partitions,.   
+00009d60: 2020 2020 2020 2020 2077 6865 7265 2074           where t
+00009d70: 6865 206e 6577 2069 6e64 6578 2063 6f6e  he new index con
+00009d80: 7461 696e 6564 205b 302c 2031 3029 2c20  tained [0, 10), 
+00009d90: 5b31 302c 2035 3029 2c20 616e 6420 5b35  [10, 50), and [5
+00009da0: 302c 2031 3030 292c 2072 6573 7065 6374  0, 100), respect
+00009db0: 6976 656c 792e 0a20 2020 2020 2020 2020  ively..         
+00009dc0: 2020 2053 6565 2068 7474 7073 3a2f 2f64     See https://d
+00009dd0: 6f63 732e 6461 736b 2e6f 7267 2f65 6e2f  ocs.dask.org/en/
+00009de0: 6c61 7465 7374 2f64 6174 6166 7261 6d65  latest/dataframe
+00009df0: 2d64 6573 6967 6e2e 6874 6d6c 2370 6172  -design.html#par
+00009e00: 7469 7469 6f6e 732e 0a20 2020 2020 2020  titions..       
+00009e10: 206e 7061 7274 6974 696f 6e73 203a 2069   npartitions : i
+00009e20: 6e74 2c20 4361 6c6c 6162 6c65 2c20 6f70  nt, Callable, op
+00009e30: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
+00009e40: 2020 2041 7070 726f 7869 6d61 7465 206e     Approximate n
+00009e50: 756d 6265 7220 6f66 2070 6172 7469 7469  umber of partiti
+00009e60: 6f6e 7320 6f66 206f 7574 7075 742e 2054  ons of output. T
+00009e70: 6865 206e 756d 6265 7220 6f66 0a20 2020  he number of.   
+00009e80: 2020 2020 2020 2020 2070 6172 7469 7469           partiti
+00009e90: 6f6e 7320 7573 6564 206d 6179 2062 6520  ons used may be 
+00009ea0: 736c 6967 6874 6c79 206c 6f77 6572 2074  slightly lower t
+00009eb0: 6861 6e20 6e70 6172 7469 7469 6f6e 7320  han npartitions 
+00009ec0: 6465 7065 6e64 696e 670a 2020 2020 2020  depending.      
+00009ed0: 2020 2020 2020 6f6e 2064 6174 6120 6469        on data di
+00009ee0: 7374 7269 6275 7469 6f6e 2c20 6275 7420  stribution, but 
+00009ef0: 7769 6c6c 206e 6576 6572 2062 6520 6869  will never be hi
+00009f00: 6768 6572 2e0a 2020 2020 2020 2020 2020  gher..          
+00009f10: 2020 5468 6520 4361 6c6c 6162 6c65 2067    The Callable g
+00009f20: 6574 7320 7468 6520 6e75 6d62 6572 206f  ets the number o
+00009f30: 6620 7061 7274 6974 696f 6e73 206f 6620  f partitions of 
+00009f40: 7468 6520 696e 7075 7420 6173 2061 6e20  the input as an 
+00009f50: 6172 6775 6d65 6e74 0a20 2020 2020 2020  argument.       
+00009f60: 2020 2020 2061 6e64 2073 686f 756c 6420       and should 
+00009f70: 7265 7475 726e 2061 6e20 696e 742e 0a20  return an int.. 
+00009f80: 2020 2020 2020 2070 6172 7469 7469 6f6e         partition
+00009f90: 5f73 697a 6520 3a20 7374 722c 206f 7074  _size : str, opt
+00009fa0: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
+00009fb0: 2020 4d61 7820 6e75 6d62 6572 206f 6620    Max number of 
+00009fc0: 6279 7465 7320 6f66 206d 656d 6f72 7920  bytes of memory 
+00009fd0: 666f 7220 6561 6368 2070 6172 7469 7469  for each partiti
+00009fe0: 6f6e 2e20 5573 6520 6e75 6d62 6572 7320  on. Use numbers 
+00009ff0: 6f72 2073 7472 696e 6773 0a20 2020 2020  or strings.     
+0000a000: 2020 2020 2020 206c 696b 6520 354d 422e         like 5MB.
+0000a010: 2049 6620 7370 6563 6966 6965 6420 6e70   If specified np
+0000a020: 6172 7469 7469 6f6e 7320 616e 6420 6469  artitions and di
+0000a030: 7669 7369 6f6e 7320 7769 6c6c 2062 6520  visions will be 
+0000a040: 6967 6e6f 7265 642e 204e 6f74 6520 7468  ignored. Note th
+0000a050: 6174 0a20 2020 2020 2020 2020 2020 2074  at.            t
+0000a060: 6865 2073 697a 6520 7265 666c 6563 7473  he size reflects
+0000a070: 2074 6865 206e 756d 6265 7220 6f66 2062   the number of b
+0000a080: 7974 6573 2075 7365 6420 6173 2063 6f6d  ytes used as com
+0000a090: 7075 7465 6420 6279 0a20 2020 2020 2020  puted by.       
+0000a0a0: 2020 2020 2070 616e 6461 732e 4461 7461       pandas.Data
+0000a0b0: 4672 616d 652e 6d65 6d6f 7279 5f75 7361  Frame.memory_usa
+0000a0c0: 6765 2c20 7768 6963 6820 7769 6c6c 206e  ge, which will n
+0000a0d0: 6f74 206e 6563 6573 7361 7269 6c79 206d  ot necessarily m
+0000a0e0: 6174 6368 2074 6865 2073 697a 650a 2020  atch the size.  
+0000a0f0: 2020 2020 2020 2020 2020 7768 656e 2073            when s
+0000a100: 746f 7269 6e67 2074 6f20 6469 736b 2e0a  toring to disk..
+0000a110: 0a20 2020 2020 2020 2020 2020 202e 2e20  .            .. 
+0000a120: 7761 726e 696e 673a 3a0a 0a20 2020 2020  warning::..     
+0000a130: 2020 2020 2020 2020 2020 5468 6973 206b            This k
+0000a140: 6579 776f 7264 2061 7267 756d 656e 7420  eyword argument 
+0000a150: 7472 6967 6765 7273 2063 6f6d 7075 7461  triggers computa
+0000a160: 7469 6f6e 2074 6f20 6465 7465 726d 696e  tion to determin
+0000a170: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+0000a180: 2074 6865 206d 656d 6f72 7920 7369 7a65   the memory size
+0000a190: 206f 6620 6561 6368 2070 6172 7469 7469   of each partiti
+0000a1a0: 6f6e 2c20 7768 6963 6820 6d61 7920 6265  on, which may be
+0000a1b0: 2065 7870 656e 7369 7665 2e0a 0a20 2020   expensive...   
+0000a1c0: 2020 2020 2066 6f72 6365 203a 2062 6f6f       force : boo
+0000a1d0: 6c2c 2064 6566 6175 6c74 2046 616c 7365  l, default False
+0000a1e0: 0a20 2020 2020 2020 2020 2020 2041 6c6c  .            All
+0000a1f0: 6f77 7320 7468 6520 6578 7061 6e73 696f  ows the expansio
+0000a200: 6e20 6f66 2074 6865 2065 7869 7374 696e  n of the existin
+0000a210: 6720 6469 7669 7369 6f6e 732e 0a20 2020  g divisions..   
+0000a220: 2020 2020 2020 2020 2049 6620 4661 6c73           If Fals
+0000a230: 6520 7468 656e 2074 6865 206e 6577 2064  e then the new d
+0000a240: 6976 6973 696f 6e73 2720 6c6f 7765 7220  ivisions' lower 
+0000a250: 616e 6420 7570 7065 7220 626f 756e 6473  and upper bounds
+0000a260: 206d 7573 7420 6265 0a20 2020 2020 2020   must be.       
+0000a270: 2020 2020 2074 6865 2073 616d 6520 6173       the same as
+0000a280: 2074 6865 206f 6c64 2064 6976 6973 696f   the old divisio
+0000a290: 6e73 272e 0a20 2020 2020 2020 2066 7265  ns'..        fre
+0000a2a0: 7120 3a20 7374 722c 2070 642e 5469 6d65  q : str, pd.Time
+0000a2b0: 6465 6c74 610a 2020 2020 2020 2020 2020  delta.          
+0000a2c0: 2020 4120 7065 7269 6f64 206f 6e20 7768    A period on wh
+0000a2d0: 6963 6820 746f 2070 6172 7469 7469 6f6e  ich to partition
+0000a2e0: 2074 696d 6573 6572 6965 7320 6461 7461   timeseries data
+0000a2f0: 206c 696b 6520 6060 2737 4427 6060 206f   like ``'7D'`` o
+0000a300: 720a 2020 2020 2020 2020 2020 2020 6060  r.            ``
+0000a310: 2731 3268 2760 6020 6f72 2060 6070 642e  '12h'`` or ``pd.
+0000a320: 5469 6d65 6465 6c74 6128 686f 7572 733d  Timedelta(hours=
+0000a330: 3132 2960 602e 2020 4173 7375 6d65 7320  12)``.  Assumes 
+0000a340: 6120 6461 7465 7469 6d65 2069 6e64 6578  a datetime index
+0000a350: 2e0a 0a20 2020 2020 2020 204e 6f74 6573  ...        Notes
+0000a360: 0a20 2020 2020 2020 202d 2d2d 2d2d 0a20  .        -----. 
+0000a370: 2020 2020 2020 2045 7861 6374 6c79 206f         Exactly o
+0000a380: 6e65 206f 6620 6064 6976 6973 696f 6e73  ne of `divisions
+0000a390: 602c 2060 6e70 6172 7469 7469 6f6e 7360  `, `npartitions`
+0000a3a0: 2c20 6070 6172 7469 7469 6f6e 5f73 697a  , `partition_siz
+0000a3b0: 6560 2c20 6f72 2060 6672 6571 600a 2020  e`, or `freq`.  
+0000a3c0: 2020 2020 2020 7368 6f75 6c64 2062 6520        should be 
+0000a3d0: 7370 6563 6966 6965 642e 2041 2060 6056  specified. A ``V
+0000a3e0: 616c 7565 4572 726f 7260 6020 7769 6c6c  alueError`` will
+0000a3f0: 2062 6520 7261 6973 6564 2077 6865 6e20   be raised when 
+0000a400: 7468 6174 2069 730a 2020 2020 2020 2020  that is.        
+0000a410: 6e6f 7420 7468 6520 6361 7365 2e0a 0a20  not the case... 
+0000a420: 2020 2020 2020 2041 6c73 6f20 6e6f 7465         Also note
+0000a430: 2074 6861 7420 6060 6c65 6e28 6469 7669   that ``len(divi
+0000a440: 736f 6e73 2960 6020 6973 2065 7175 616c  sons)`` is equal
+0000a450: 2074 6f20 6060 6e70 6172 7469 7469 6f6e   to ``npartition
+0000a460: 7320 2b20 3160 602e 2054 6869 7320 6973  s + 1``. This is
+0000a470: 2062 6563 6175 7365 2060 6064 6976 6973   because ``divis
+0000a480: 696f 6e73 6060 0a20 2020 2020 2020 2072  ions``.        r
+0000a490: 6570 7265 7365 6e74 7320 7468 6520 7570  epresents the up
+0000a4a0: 7065 7220 616e 6420 6c6f 7765 7220 626f  per and lower bo
+0000a4b0: 756e 6473 206f 6620 6561 6368 2070 6172  unds of each par
+0000a4c0: 7469 7469 6f6e 2e20 5468 6520 6669 7273  tition. The firs
+0000a4d0: 7420 6974 656d 2069 7320 7468 650a 2020  t item is the.  
+0000a4e0: 2020 2020 2020 6c6f 7765 7220 626f 756e        lower boun
+0000a4f0: 6420 6f66 2074 6865 2066 6972 7374 2070  d of the first p
+0000a500: 6172 7469 7469 6f6e 2c20 7468 6520 7365  artition, the se
+0000a510: 636f 6e64 2069 7465 6d20 6973 2074 6865  cond item is the
+0000a520: 206c 6f77 6572 2062 6f75 6e64 206f 6620   lower bound of 
+0000a530: 7468 650a 2020 2020 2020 2020 7365 636f  the.        seco
+0000a540: 6e64 2070 6172 7469 7469 6f6e 2061 6e64  nd partition and
+0000a550: 2074 6865 2075 7070 6572 2062 6f75 6e64   the upper bound
+0000a560: 206f 6620 7468 6520 6669 7273 7420 7061   of the first pa
+0000a570: 7274 6974 696f 6e2c 2061 6e64 2073 6f20  rtition, and so 
+0000a580: 6f6e 2e0a 2020 2020 2020 2020 5468 6520  on..        The 
+0000a590: 7365 636f 6e64 2d74 6f2d 6c61 7374 2069  second-to-last i
+0000a5a0: 7465 6d20 6973 2074 6865 206c 6f77 6572  tem is the lower
+0000a5b0: 2062 6f75 6e64 206f 6620 7468 6520 6c61   bound of the la
+0000a5c0: 7374 2070 6172 7469 7469 6f6e 2c20 616e  st partition, an
+0000a5d0: 6420 7468 6520 6c61 7374 0a20 2020 2020  d the last.     
+0000a5e0: 2020 2028 6578 7472 6129 2069 7465 6d20     (extra) item 
+0000a5f0: 6973 2074 6865 2075 7070 6572 2062 6f75  is the upper bou
+0000a600: 6e64 206f 6620 7468 6520 6c61 7374 2070  nd of the last p
+0000a610: 6172 7469 7469 6f6e 2e0a 0a20 2020 2020  artition...     
+0000a620: 2020 2045 7861 6d70 6c65 730a 2020 2020     Examples.    
+0000a630: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
+0000a640: 2020 2020 203e 3e3e 2064 6620 3d20 6466       >>> df = df
+0000a650: 2e72 6570 6172 7469 7469 6f6e 286e 7061  .repartition(npa
+0000a660: 7274 6974 696f 6e73 3d31 3029 2020 2320  rtitions=10)  # 
+0000a670: 646f 6374 6573 743a 202b 534b 4950 0a20  doctest: +SKIP. 
+0000a680: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+0000a690: 6466 2e72 6570 6172 7469 7469 6f6e 2864  df.repartition(d
+0000a6a0: 6976 6973 696f 6e73 3d5b 302c 2035 2c20  ivisions=[0, 5, 
+0000a6b0: 3130 2c20 3230 5d29 2020 2320 646f 6374  10, 20])  # doct
+0000a6c0: 6573 743a 202b 534b 4950 0a20 2020 2020  est: +SKIP.     
+0000a6d0: 2020 203e 3e3e 2064 6620 3d20 6466 2e72     >>> df = df.r
+0000a6e0: 6570 6172 7469 7469 6f6e 2866 7265 713d  epartition(freq=
+0000a6f0: 2737 6427 2920 2023 2064 6f63 7465 7374  '7d')  # doctest
+0000a700: 3a20 2b53 4b49 500a 0a20 2020 2020 2020  : +SKIP..       
+0000a710: 2053 6565 2041 6c73 6f0a 2020 2020 2020   See Also.      
+0000a720: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020    --------.     
+0000a730: 2020 2044 6174 6146 7261 6d65 2e6d 656d     DataFrame.mem
+0000a740: 6f72 795f 7573 6167 655f 7065 725f 7061  ory_usage_per_pa
+0000a750: 7274 6974 696f 6e0a 2020 2020 2020 2020  rtition.        
+0000a760: 7061 6e64 6173 2e44 6174 6146 7261 6d65  pandas.DataFrame
+0000a770: 2e6d 656d 6f72 795f 7573 6167 650a 2020  .memory_usage.  
+0000a780: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
+0000a790: 2020 2069 6620 280a 2020 2020 2020 2020     if (.        
+0000a7a0: 2020 2020 7375 6d28 0a20 2020 2020 2020      sum(.       
+0000a7b0: 2020 2020 2020 2020 205b 0a20 2020 2020           [.     
+0000a7c0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+0000a7d0: 6976 6973 696f 6e73 2069 7320 6e6f 7420  ivisions is not 
+0000a7e0: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
+0000a7f0: 2020 2020 2020 2020 2020 6e70 6172 7469            nparti
+0000a800: 7469 6f6e 7320 6973 206e 6f74 204e 6f6e  tions is not Non
+0000a810: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+0000a820: 2020 2020 2020 2070 6172 7469 7469 6f6e         partition
+0000a830: 5f73 697a 6520 6973 206e 6f74 204e 6f6e  _size is not Non
+0000a840: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+0000a850: 2020 2020 2020 2066 7265 7120 6973 206e         freq is n
+0000a860: 6f74 204e 6f6e 652c 0a20 2020 2020 2020  ot None,.       
+0000a870: 2020 2020 2020 2020 205d 0a20 2020 2020           ].     
+0000a880: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0000a890: 2020 2020 2021 3d20 310a 2020 2020 2020       != 1.      
+0000a8a0: 2020 293a 0a20 2020 2020 2020 2020 2020    ):.           
+0000a8b0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+0000a8c0: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
+0000a8d0: 2020 2022 506c 6561 7365 2070 726f 7669     "Please provi
+0000a8e0: 6465 2065 7861 6374 6c79 206f 6e65 206f  de exactly one o
+0000a8f0: 6620 7468 6520 6060 6e70 6172 7469 7469  f the ``npartiti
+0000a900: 6f6e 733d 6060 206f 7220 220a 2020 2020  ons=`` or ".    
+0000a910: 2020 2020 2020 2020 2020 2020 2260 6064              "``d
+0000a920: 6976 6973 696f 6e73 3d60 6020 6b65 7977  ivisions=`` keyw
+0000a930: 6f72 6420 6172 6775 6d65 6e74 732e 220a  ord arguments.".
+0000a940: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0000a950: 2020 2020 2020 6966 2064 6976 6973 696f        if divisio
+0000a960: 6e73 2069 7320 6e6f 7420 4e6f 6e65 3a0a  ns is not None:.
+0000a970: 2020 2020 2020 2020 2020 2020 6368 6563              chec
+0000a980: 6b5f 6469 7669 7369 6f6e 7328 6469 7669  k_divisions(divi
+0000a990: 7369 6f6e 7329 0a20 2020 2020 2020 2069  sions).        i
+0000a9a0: 6620 6672 6571 2069 7320 6e6f 7420 4e6f  f freq is not No
+0000a9b0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+0000a9c0: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
+0000a9d0: 6528 7365 6c66 2e64 6976 6973 696f 6e73  e(self.divisions
+0000a9e0: 5b30 5d2c 2070 642e 5469 6d65 7374 616d  [0], pd.Timestam
+0000a9f0: 7029 3a0a 2020 2020 2020 2020 2020 2020  p):.            
+0000aa00: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
+0000aa10: 726f 7228 2243 616e 206f 6e6c 7920 7265  ror("Can only re
+0000aa20: 7061 7274 6974 696f 6e20 6f6e 2066 7265  partition on fre
+0000aa30: 7175 656e 6379 2066 6f72 2074 696d 6573  quency for times
+0000aa40: 6572 6965 7322 290a 2020 2020 2020 2020  eries").        
+0000aa50: 2020 2020 7265 7475 726e 206e 6577 5f63      return new_c
+0000aa60: 6f6c 6c65 6374 696f 6e28 5265 7061 7274  ollection(Repart
+0000aa70: 6974 696f 6e46 7265 7128 7365 6c66 2c20  itionFreq(self, 
+0000aa80: 6672 6571 2929 0a20 2020 2020 2020 2065  freq)).        e
+0000aa90: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0000aaa0: 2072 6574 7572 6e20 6e65 775f 636f 6c6c   return new_coll
+0000aab0: 6563 7469 6f6e 280a 2020 2020 2020 2020  ection(.        
+0000aac0: 2020 2020 2020 2020 5265 7061 7274 6974          Repartit
+0000aad0: 696f 6e28 7365 6c66 2c20 6e70 6172 7469  ion(self, nparti
+0000aae0: 7469 6f6e 732c 2064 6976 6973 696f 6e73  tions, divisions
+0000aaf0: 2c20 666f 7263 652c 2070 6172 7469 7469  , force, partiti
+0000ab00: 6f6e 5f73 697a 652c 2066 7265 7129 0a20  on_size, freq). 
+0000ab10: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
+0000ab20: 2020 6465 6620 746f 5f64 6173 6b5f 6461    def to_dask_da
+0000ab30: 7461 6672 616d 6528 7365 6c66 2c20 2a61  taframe(self, *a
+0000ab40: 7267 732c 202a 2a6b 7761 7267 7329 202d  rgs, **kwargs) -
+0000ab50: 3e20 5f46 7261 6d65 3a0a 2020 2020 2020  > _Frame:.      
+0000ab60: 2020 2222 2243 6f6e 7665 7274 2074 6f20    """Convert to 
+0000ab70: 6120 6c65 6761 6379 2064 6173 6b2d 6461  a legacy dask-da
+0000ab80: 7461 6672 616d 6520 636f 6c6c 6563 7469  taframe collecti
+0000ab90: 6f6e 0a0a 2020 2020 2020 2020 5741 524e  on..        WARN
+0000aba0: 494e 473a 2054 6869 7320 4150 4920 6973  ING: This API is
+0000abb0: 2064 6570 7265 6361 7465 642e 2050 6c65   deprecated. Ple
+0000abc0: 6173 6520 7573 6520 6074 6f5f 6c65 6761  ase use `to_lega
+0000abd0: 6379 5f64 6174 6166 7261 6d65 602e 0a0a  cy_dataframe`...
+0000abe0: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+0000abf0: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
+0000ac00: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6f70  -----.        op
+0000ac10: 7469 6d69 7a65 0a20 2020 2020 2020 2020  timize.         
+0000ac20: 2020 2057 6865 7468 6572 2074 6f20 6f70     Whether to op
+0000ac30: 7469 6d69 7a65 2074 6865 2075 6e64 6572  timize the under
+0000ac40: 6c79 696e 6720 6045 7870 7260 206f 626a  lying `Expr` obj
+0000ac50: 6563 7420 6265 666f 7265 2063 6f6e 7665  ect before conve
+0000ac60: 7273 696f 6e2e 0a20 2020 2020 2020 202a  rsion..        *
+0000ac70: 2a6f 7074 696d 697a 655f 6b77 6172 6773  *optimize_kwargs
+0000ac80: 0a20 2020 2020 2020 2020 2020 204b 6579  .            Key
+0000ac90: 2d77 6f72 6420 6172 6775 6d65 6e74 7320  -word arguments 
+0000aca0: 746f 2070 6173 7320 7468 726f 7567 6820  to pass through 
+0000acb0: 746f 2060 6f70 7469 6d69 7a65 602e 0a20  to `optimize`.. 
+0000acc0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0000acd0: 2020 2023 2054 4f44 4f3a 2044 6570 7265     # TODO: Depre
+0000ace0: 6361 7465 2060 746f 5f64 6173 6b5f 6461  cate `to_dask_da
+0000acf0: 7461 6672 616d 6560 0a20 2020 2020 2020  taframe`.       
+0000ad00: 2023 2053 6565 3a20 6874 7470 733a 2f2f   # See: https://
+0000ad10: 6769 7468 7562 2e63 6f6d 2f64 6173 6b2f  github.com/dask/
+0000ad20: 6461 736b 2d65 7870 722f 6973 7375 6573  dask-expr/issues
+0000ad30: 2f39 3035 0a20 2020 2020 2020 2072 6574  /905.        ret
+0000ad40: 7572 6e20 7365 6c66 2e74 6f5f 6c65 6761  urn self.to_lega
+0000ad50: 6379 5f64 6174 6166 7261 6d65 282a 6172  cy_dataframe(*ar
+0000ad60: 6773 2c20 2a2a 6b77 6172 6773 290a 0a20  gs, **kwargs).. 
+0000ad70: 2020 2064 6566 2074 6f5f 6c65 6761 6379     def to_legacy
+0000ad80: 5f64 6174 6166 7261 6d65 2873 656c 662c  _dataframe(self,
+0000ad90: 206f 7074 696d 697a 653a 2062 6f6f 6c20   optimize: bool 
+0000ada0: 3d20 5472 7565 2c20 2a2a 6f70 7469 6d69  = True, **optimi
+0000adb0: 7a65 5f6b 7761 7267 7329 202d 3e20 5f46  ze_kwargs) -> _F
+0000adc0: 7261 6d65 3a0a 2020 2020 2020 2020 2222  rame:.        ""
+0000add0: 2243 6f6e 7665 7274 2074 6f20 6120 6c65  "Convert to a le
+0000ade0: 6761 6379 2064 6173 6b2d 6461 7461 6672  gacy dask-datafr
+0000adf0: 616d 6520 636f 6c6c 6563 7469 6f6e 0a0a  ame collection..
+0000ae00: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+0000ae10: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
+0000ae20: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6f70  -----.        op
+0000ae30: 7469 6d69 7a65 0a20 2020 2020 2020 2020  timize.         
+0000ae40: 2020 2057 6865 7468 6572 2074 6f20 6f70     Whether to op
+0000ae50: 7469 6d69 7a65 2074 6865 2075 6e64 6572  timize the under
+0000ae60: 6c79 696e 6720 6045 7870 7260 206f 626a  lying `Expr` obj
+0000ae70: 6563 7420 6265 666f 7265 2063 6f6e 7665  ect before conve
+0000ae80: 7273 696f 6e2e 0a20 2020 2020 2020 202a  rsion..        *
+0000ae90: 2a6f 7074 696d 697a 655f 6b77 6172 6773  *optimize_kwargs
+0000aea0: 0a20 2020 2020 2020 2020 2020 204b 6579  .            Key
+0000aeb0: 2d77 6f72 6420 6172 6775 6d65 6e74 7320  -word arguments 
+0000aec0: 746f 2070 6173 7320 7468 726f 7567 6820  to pass through 
+0000aed0: 746f 2060 6f70 7469 6d69 7a65 602e 0a20  to `optimize`.. 
+0000aee0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0000aef0: 2020 2064 6620 3d20 7365 6c66 2e6f 7074     df = self.opt
+0000af00: 696d 697a 6528 2a2a 6f70 7469 6d69 7a65  imize(**optimize
+0000af10: 5f6b 7761 7267 7329 2069 6620 6f70 7469  _kwargs) if opti
+0000af20: 6d69 7a65 2065 6c73 6520 7365 6c66 0a20  mize else self. 
+0000af30: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
+0000af40: 775f 6464 5f6f 626a 6563 7428 6466 2e64  w_dd_object(df.d
+0000af50: 6173 6b2c 2064 662e 5f6e 616d 652c 2064  ask, df._name, d
+0000af60: 662e 5f6d 6574 612c 2064 662e 6469 7669  f._meta, df.divi
+0000af70: 7369 6f6e 7329 0a0a 2020 2020 6465 6620  sions)..    def 
+0000af80: 746f 5f64 6173 6b5f 6172 7261 7928 0a20  to_dask_array(. 
+0000af90: 2020 2020 2020 2073 656c 662c 206c 656e         self, len
+0000afa0: 6774 6873 3d4e 6f6e 652c 206d 6574 613d  gths=None, meta=
+0000afb0: 4e6f 6e65 2c20 6f70 7469 6d69 7a65 3a20  None, optimize: 
+0000afc0: 626f 6f6c 203d 2054 7275 652c 202a 2a6f  bool = True, **o
+0000afd0: 7074 696d 697a 655f 6b77 6172 6773 0a20  ptimize_kwargs. 
+0000afe0: 2020 2029 202d 3e20 4172 7261 793a 0a20     ) -> Array:. 
+0000aff0: 2020 2020 2020 2022 2222 436f 6e76 6572         """Conver
+0000b000: 7420 6120 6461 736b 2044 6174 6146 7261  t a dask DataFra
+0000b010: 6d65 2074 6f20 6120 6461 736b 2061 7272  me to a dask arr
+0000b020: 6179 2e0a 0a20 2020 2020 2020 2050 6172  ay...        Par
+0000b030: 616d 6574 6572 730a 2020 2020 2020 2020  ameters.        
+0000b040: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+0000b050: 2020 206c 656e 6774 6873 203a 2062 6f6f     lengths : boo
+0000b060: 6c20 6f72 2053 6571 7565 6e63 6520 6f66  l or Sequence of
+0000b070: 2069 6e74 732c 206f 7074 696f 6e61 6c0a   ints, optional.
+0000b080: 2020 2020 2020 2020 2020 2020 486f 7720              How 
+0000b090: 746f 2064 6574 6572 6d69 6e65 2074 6865  to determine the
+0000b0a0: 2063 6875 6e6b 7320 7369 7a65 7320 666f   chunks sizes fo
+0000b0b0: 7220 7468 6520 6f75 7470 7574 2061 7272  r the output arr
+0000b0c0: 6179 2e0a 2020 2020 2020 2020 2020 2020  ay..            
+0000b0d0: 4279 2064 6566 6175 6c74 2c20 7468 6520  By default, the 
+0000b0e0: 6f75 7470 7574 2061 7272 6179 2077 696c  output array wil
+0000b0f0: 6c20 6861 7665 2075 6e6b 6e6f 776e 2063  l have unknown c
+0000b100: 6875 6e6b 206c 656e 6774 6873 0a20 2020  hunk lengths.   
+0000b110: 2020 2020 2020 2020 2061 6c6f 6e67 2074           along t
+0000b120: 6865 2066 6972 7374 2061 7869 732c 2077  he first axis, w
+0000b130: 6869 6368 2063 616e 2063 6175 7365 2073  hich can cause s
+0000b140: 6f6d 6520 6c61 7465 7220 6f70 6572 6174  ome later operat
+0000b150: 696f 6e73 0a20 2020 2020 2020 2020 2020  ions.           
+0000b160: 2074 6f20 6661 696c 2e0a 0a20 2020 2020   to fail...     
+0000b170: 2020 2020 2020 202a 2054 7275 6520 3a20         * True : 
+0000b180: 696d 6d65 6469 6174 656c 7920 636f 6d70  immediately comp
+0000b190: 7574 6520 7468 6520 6c65 6e67 7468 206f  ute the length o
+0000b1a0: 6620 6561 6368 2070 6172 7469 7469 6f6e  f each partition
+0000b1b0: 0a20 2020 2020 2020 2020 2020 202a 2053  .            * S
+0000b1c0: 6571 7565 6e63 6520 3a20 6120 7365 7175  equence : a sequ
+0000b1d0: 656e 6365 206f 6620 696e 7465 6765 7273  ence of integers
+0000b1e0: 2074 6f20 7573 6520 666f 7220 7468 6520   to use for the 
+0000b1f0: 6368 756e 6b20 7369 7a65 730a 2020 2020  chunk sizes.    
+0000b200: 2020 2020 2020 2020 2020 6f6e 2074 6865            on the
+0000b210: 2066 6972 7374 2061 7869 732e 2054 6865   first axis. The
+0000b220: 7365 2076 616c 7565 7320 6172 6520 2a6e  se values are *n
+0000b230: 6f74 2a20 7661 6c69 6461 7465 6420 666f  ot* validated fo
+0000b240: 720a 2020 2020 2020 2020 2020 2020 2020  r.              
+0000b250: 636f 7272 6563 746e 6573 732c 2062 6579  correctness, bey
+0000b260: 6f6e 6420 656e 7375 7269 6e67 2074 6861  ond ensuring tha
+0000b270: 7420 7468 6520 6e75 6d62 6572 206f 6620  t the number of 
+0000b280: 6974 656d 730a 2020 2020 2020 2020 2020  items.          
+0000b290: 2020 2020 6d61 7463 6865 7320 7468 6520      matches the 
+0000b2a0: 6e75 6d62 6572 206f 6620 7061 7274 6974  number of partit
+0000b2b0: 696f 6e73 2e0a 2020 2020 2020 2020 6d65  ions..        me
+0000b2c0: 7461 203a 206f 626a 6563 742c 206f 7074  ta : object, opt
+0000b2d0: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
+0000b2e0: 2020 416e 206f 7074 696f 6e61 6c20 606d    An optional `m
+0000b2f0: 6574 6160 2070 6172 616d 6574 6572 2063  eta` parameter c
+0000b300: 616e 2062 6520 7061 7373 6564 2066 6f72  an be passed for
+0000b310: 2064 6173 6b20 746f 206f 7665 7272 6964   dask to overrid
+0000b320: 6520 7468 650a 2020 2020 2020 2020 2020  e the.          
+0000b330: 2020 6465 6661 756c 7420 6d65 7461 6461    default metada
+0000b340: 7461 206f 6e20 7468 6520 756e 6465 726c  ta on the underl
+0000b350: 7969 6e67 2064 6173 6b20 6172 7261 792e  ying dask array.
+0000b360: 0a20 2020 2020 2020 206f 7074 696d 697a  .        optimiz
+0000b370: 6520 3a20 626f 6f6c 0a20 2020 2020 2020  e : bool.       
+0000b380: 2020 2020 2057 6865 7468 6572 2074 6f20       Whether to 
+0000b390: 6f70 7469 6d69 7a65 2074 6865 2065 7870  optimize the exp
+0000b3a0: 7265 7373 696f 6e20 6265 666f 7265 2063  ression before c
+0000b3b0: 6f6e 7665 7274 696e 6720 746f 2061 6e20  onverting to an 
+0000b3c0: 4172 7261 792e 0a0a 2020 2020 2020 2020  Array...        
+0000b3d0: 5265 7475 726e 730a 2020 2020 2020 2020  Returns.        
+0000b3e0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+0000b3f0: 4120 4461 736b 2041 7272 6179 0a20 2020  A Dask Array.   
+0000b400: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0000b410: 2072 6574 7572 6e20 7365 6c66 2e74 6f5f   return self.to_
+0000b420: 6c65 6761 6379 5f64 6174 6166 7261 6d65  legacy_dataframe
+0000b430: 286f 7074 696d 697a 652c 202a 2a6f 7074  (optimize, **opt
+0000b440: 696d 697a 655f 6b77 6172 6773 292e 746f  imize_kwargs).to
+0000b450: 5f64 6173 6b5f 6172 7261 7928 0a20 2020  _dask_array(.   
+0000b460: 2020 2020 2020 2020 206c 656e 6774 6873           lengths
+0000b470: 3d6c 656e 6774 6873 2c20 6d65 7461 3d6d  =lengths, meta=m
+0000b480: 6574 610a 2020 2020 2020 2020 290a 0a20  eta.        ).. 
+0000b490: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+0000b4a0: 2064 6566 2076 616c 7565 7328 7365 6c66   def values(self
+0000b4b0: 293a 0a20 2020 2020 2020 2022 2222 5265  ):.        """Re
+0000b4c0: 7475 726e 2061 2064 6173 6b2e 6172 7261  turn a dask.arra
+0000b4d0: 7920 6f66 2074 6865 2076 616c 7565 7320  y of the values 
+0000b4e0: 6f66 2074 6869 7320 6461 7461 6672 616d  of this datafram
+0000b4f0: 650a 0a20 2020 2020 2020 2057 6172 6e69  e..        Warni
+0000b500: 6e67 3a20 5468 6973 2063 7265 6174 6573  ng: This creates
+0000b510: 2061 2064 6173 6b2e 6172 7261 7920 7769   a dask.array wi
+0000b520: 7468 6f75 7420 7072 6563 6973 6520 7368  thout precise sh
+0000b530: 6170 6520 696e 666f 726d 6174 696f 6e2e  ape information.
+0000b540: 0a20 2020 2020 2020 204f 7065 7261 7469  .        Operati
+0000b550: 6f6e 7320 7468 6174 2064 6570 656e 6420  ons that depend 
+0000b560: 6f6e 2073 6861 7065 2069 6e66 6f72 6d61  on shape informa
+0000b570: 7469 6f6e 2c20 6c69 6b65 2073 6c69 6369  tion, like slici
+0000b580: 6e67 206f 7220 7265 7368 6170 696e 672c  ng or reshaping,
+0000b590: 0a20 2020 2020 2020 2077 696c 6c20 6e6f  .        will no
+0000b5a0: 7420 776f 726b 2e0a 2020 2020 2020 2020  t work..        
+0000b5b0: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
+0000b5c0: 726e 2073 656c 662e 746f 5f64 6173 6b5f  rn self.to_dask_
+0000b5d0: 6172 7261 7928 290a 0a20 2020 2064 6566  array()..    def
+0000b5e0: 205f 5f64 6976 6d6f 645f 5f28 7365 6c66   __divmod__(self
+0000b5f0: 2c20 6f74 6865 7229 3a0a 2020 2020 2020  , other):.      
+0000b600: 2020 7265 7375 6c74 203d 2073 656c 662e    result = self.
+0000b610: 6578 7072 2e5f 5f64 6976 6d6f 645f 5f28  expr.__divmod__(
+0000b620: 6f74 6865 7229 0a20 2020 2020 2020 2072  other).        r
+0000b630: 6574 7572 6e20 6e65 775f 636f 6c6c 6563  eturn new_collec
+0000b640: 7469 6f6e 2872 6573 756c 745b 305d 292c  tion(result[0]),
+0000b650: 206e 6577 5f63 6f6c 6c65 6374 696f 6e28   new_collection(
+0000b660: 7265 7375 6c74 5b31 5d29 0a0a 2020 2020  result[1])..    
+0000b670: 6465 6620 5f5f 7264 6976 6d6f 645f 5f28  def __rdivmod__(
+0000b680: 7365 6c66 2c20 6f74 6865 7229 3a0a 2020  self, other):.  
+0000b690: 2020 2020 2020 7265 7375 6c74 203d 2073        result = s
+0000b6a0: 656c 662e 6578 7072 2e5f 5f72 6469 766d  elf.expr.__rdivm
+0000b6b0: 6f64 5f5f 286f 7468 6572 290a 2020 2020  od__(other).    
+0000b6c0: 2020 2020 7265 7475 726e 206e 6577 5f63      return new_c
+0000b6d0: 6f6c 6c65 6374 696f 6e28 7265 7375 6c74  ollection(result
+0000b6e0: 5b30 5d29 2c20 6e65 775f 636f 6c6c 6563  [0]), new_collec
+0000b6f0: 7469 6f6e 2872 6573 756c 745b 315d 290a  tion(result[1]).
+0000b700: 0a20 2020 2064 6566 205f 5f61 6273 5f5f  .    def __abs__
+0000b710: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+0000b720: 7265 7475 726e 2073 656c 662e 6162 7328  return self.abs(
+0000b730: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
+0000b740: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
+0000b750: 6529 0a20 2020 2064 6566 2073 756d 280a  e).    def sum(.
+0000b760: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+0000b770: 2020 2020 2020 6178 6973 3d30 2c0a 2020        axis=0,.  
+0000b780: 2020 2020 2020 736b 6970 6e61 3d54 7275        skipna=Tru
+0000b790: 652c 0a20 2020 2020 2020 206e 756d 6572  e,.        numer
+0000b7a0: 6963 5f6f 6e6c 793d 4661 6c73 652c 0a20  ic_only=False,. 
+0000b7b0: 2020 2020 2020 206d 696e 5f63 6f75 6e74         min_count
+0000b7c0: 3d30 2c0a 2020 2020 2020 2020 7370 6c69  =0,.        spli
+0000b7d0: 745f 6576 6572 793d 4661 6c73 652c 0a20  t_every=False,. 
+0000b7e0: 2020 2020 2020 202a 2a6b 7761 7267 732c         **kwargs,
+0000b7f0: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
+0000b800: 6178 6973 203d 2073 656c 662e 5f76 616c  axis = self._val
+0000b810: 6964 6174 655f 6178 6973 2861 7869 7329  idate_axis(axis)
+0000b820: 0a20 2020 2020 2020 2069 6620 6178 6973  .        if axis
+0000b830: 203d 3d20 313a 0a20 2020 2020 2020 2020   == 1:.         
+0000b840: 2020 2072 6574 7572 6e20 7365 6c66 2e6d     return self.m
+0000b850: 6170 5f70 6172 7469 7469 6f6e 7328 0a20  ap_partitions(. 
+0000b860: 2020 2020 2020 2020 2020 2020 2020 204d                 M
+0000b870: 2e73 756d 2c0a 2020 2020 2020 2020 2020  .sum,.          
+0000b880: 2020 2020 2020 736b 6970 6e61 3d73 6b69        skipna=ski
+0000b890: 706e 612c 0a20 2020 2020 2020 2020 2020  pna,.           
+0000b8a0: 2020 2020 206e 756d 6572 6963 5f6f 6e6c       numeric_onl
+0000b8b0: 793d 6e75 6d65 7269 635f 6f6e 6c79 2c0a  y=numeric_only,.
+0000b8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b8d0: 6178 6973 3d61 7869 732c 0a20 2020 2020  axis=axis,.     
+0000b8e0: 2020 2020 2020 2020 2020 206d 696e 5f63             min_c
+0000b8f0: 6f75 6e74 3d6d 696e 5f63 6f75 6e74 2c0a  ount=min_count,.
+0000b900: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+0000b910: 2020 2020 2020 2072 6573 756c 7420 3d20         result = 
+0000b920: 6e65 775f 636f 6c6c 6563 7469 6f6e 2873  new_collection(s
+0000b930: 656c 662e 6578 7072 2e73 756d 2873 6b69  elf.expr.sum(ski
+0000b940: 706e 612c 206e 756d 6572 6963 5f6f 6e6c  pna, numeric_onl
+0000b950: 792c 2073 706c 6974 5f65 7665 7279 2c20  y, split_every, 
+0000b960: 6178 6973 2929 0a20 2020 2020 2020 2072  axis)).        r
+0000b970: 6574 7572 6e20 7365 6c66 2e5f 6170 706c  eturn self._appl
+0000b980: 795f 6d69 6e5f 636f 756e 7428 7265 7375  y_min_count(resu
+0000b990: 6c74 2c20 6d69 6e5f 636f 756e 7429 0a0a  lt, min_count)..
+0000b9a0: 2020 2020 6465 6620 5f61 7070 6c79 5f6d      def _apply_m
+0000b9b0: 696e 5f63 6f75 6e74 2873 656c 662c 2072  in_count(self, r
+0000b9c0: 6573 756c 742c 206d 696e 5f63 6f75 6e74  esult, min_count
+0000b9d0: 293a 0a20 2020 2020 2020 2069 6620 6d69  ):.        if mi
+0000b9e0: 6e5f 636f 756e 743a 0a20 2020 2020 2020  n_count:.       
+0000b9f0: 2020 2020 2063 6f6e 6420 3d20 7365 6c66       cond = self
+0000ba00: 2e6e 6f74 6e75 6c6c 2829 2e73 756d 2829  .notnull().sum()
+0000ba10: 203e 3d20 6d69 6e5f 636f 756e 740a 2020   >= min_count.  
+0000ba20: 2020 2020 2020 2020 2020 636f 6e64 5f6d            cond_m
+0000ba30: 6574 6120 3d20 636f 6e64 2e5f 6d65 7461  eta = cond._meta
+0000ba40: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0000ba50: 6e6f 7420 6973 5f73 6572 6965 735f 6c69  not is_series_li
+0000ba60: 6b65 2863 6f6e 645f 6d65 7461 293a 0a20  ke(cond_meta):. 
+0000ba70: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0000ba80: 6573 756c 7420 3d20 7265 7375 6c74 2e74  esult = result.t
+0000ba90: 6f5f 7365 7269 6573 2829 0a20 2020 2020  o_series().     
+0000baa0: 2020 2020 2020 2020 2020 2063 6f6e 6420             cond 
+0000bab0: 3d20 636f 6e64 2e74 6f5f 7365 7269 6573  = cond.to_series
+0000bac0: 2829 0a0a 2020 2020 2020 2020 2020 2020  ()..            
+0000bad0: 7265 7375 6c74 203d 2072 6573 756c 742e  result = result.
+0000bae0: 7768 6572 6528 636f 6e64 2c20 6f74 6865  where(cond, othe
+0000baf0: 723d 6e70 2e6e 616e 290a 2020 2020 2020  r=np.nan).      
+0000bb00: 2020 2020 2020 6966 206e 6f74 2069 735f        if not is_
+0000bb10: 7365 7269 6573 5f6c 696b 6528 636f 6e64  series_like(cond
+0000bb20: 5f6d 6574 6129 3a0a 2020 2020 2020 2020  _meta):.        
+0000bb30: 2020 2020 2020 2020 7265 7475 726e 2072          return r
+0000bb40: 6573 756c 742e 6d69 6e28 290a 2020 2020  esult.min().    
+0000bb50: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0000bb60: 2020 2020 2020 2020 2020 2020 2020 7265                re
+0000bb70: 7475 726e 2072 6573 756c 740a 2020 2020  turn result.    
+0000bb80: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0000bb90: 2020 2020 2020 7265 7475 726e 2072 6573        return res
+0000bba0: 756c 740a 0a20 2020 2040 6465 7269 7665  ult..    @derive
+0000bbb0: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
+0000bbc0: 616d 6529 0a20 2020 2064 6566 2070 726f  ame).    def pro
+0000bbd0: 6428 0a20 2020 2020 2020 2073 656c 662c  d(.        self,
+0000bbe0: 0a20 2020 2020 2020 2061 7869 733d 302c  .        axis=0,
+0000bbf0: 0a20 2020 2020 2020 2073 6b69 706e 613d  .        skipna=
+0000bc00: 5472 7565 2c0a 2020 2020 2020 2020 6e75  True,.        nu
+0000bc10: 6d65 7269 635f 6f6e 6c79 3d46 616c 7365  meric_only=False
+0000bc20: 2c0a 2020 2020 2020 2020 6d69 6e5f 636f  ,.        min_co
+0000bc30: 756e 743d 302c 0a20 2020 2020 2020 2073  unt=0,.        s
+0000bc40: 706c 6974 5f65 7665 7279 3d46 616c 7365  plit_every=False
+0000bc50: 2c0a 2020 2020 2020 2020 2a2a 6b77 6172  ,.        **kwar
+0000bc60: 6773 2c0a 2020 2020 293a 0a20 2020 2020  gs,.    ):.     
+0000bc70: 2020 2061 7869 7320 3d20 7365 6c66 2e5f     axis = self._
+0000bc80: 7661 6c69 6461 7465 5f61 7869 7328 6178  validate_axis(ax
+0000bc90: 6973 290a 2020 2020 2020 2020 6966 2061  is).        if a
+0000bca0: 7869 7320 3d3d 2031 3a0a 2020 2020 2020  xis == 1:.      
+0000bcb0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0000bcc0: 662e 6d61 705f 7061 7274 6974 696f 6e73  f.map_partitions
+0000bcd0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0000bce0: 2020 4d2e 7072 6f64 2c0a 2020 2020 2020    M.prod,.      
+0000bcf0: 2020 2020 2020 2020 2020 736b 6970 6e61            skipna
+0000bd00: 3d73 6b69 706e 612c 0a20 2020 2020 2020  =skipna,.       
+0000bd10: 2020 2020 2020 2020 206e 756d 6572 6963           numeric
+0000bd20: 5f6f 6e6c 793d 6e75 6d65 7269 635f 6f6e  _only=numeric_on
+0000bd30: 6c79 2c0a 2020 2020 2020 2020 2020 2020  ly,.            
+0000bd40: 2020 2020 6178 6973 3d61 7869 732c 0a20      axis=axis,. 
+0000bd50: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+0000bd60: 696e 5f63 6f75 6e74 3d6d 696e 5f63 6f75  in_count=min_cou
+0000bd70: 6e74 2c0a 2020 2020 2020 2020 2020 2020  nt,.            
+0000bd80: 290a 2020 2020 2020 2020 7265 7375 6c74  ).        result
+0000bd90: 203d 206e 6577 5f63 6f6c 6c65 6374 696f   = new_collectio
+0000bda0: 6e28 7365 6c66 2e65 7870 722e 7072 6f64  n(self.expr.prod
+0000bdb0: 2873 6b69 706e 612c 206e 756d 6572 6963  (skipna, numeric
+0000bdc0: 5f6f 6e6c 792c 2073 706c 6974 5f65 7665  _only, split_eve
+0000bdd0: 7279 2c20 6178 6973 2929 0a20 2020 2020  ry, axis)).     
+0000bde0: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+0000bdf0: 6170 706c 795f 6d69 6e5f 636f 756e 7428  apply_min_count(
+0000be00: 7265 7375 6c74 2c20 6d69 6e5f 636f 756e  result, min_coun
+0000be10: 7429 0a0a 2020 2020 7072 6f64 7563 7420  t)..    product 
+0000be20: 3d20 7072 6f64 0a0a 2020 2020 4064 6572  = prod..    @der
+0000be30: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
+0000be40: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
+0000be50: 7661 7228 0a20 2020 2020 2020 2073 656c  var(.        sel
+0000be60: 662c 0a20 2020 2020 2020 2061 7869 733d  f,.        axis=
+0000be70: 302c 0a20 2020 2020 2020 2073 6b69 706e  0,.        skipn
+0000be80: 613d 5472 7565 2c0a 2020 2020 2020 2020  a=True,.        
+0000be90: 6464 6f66 3d31 2c0a 2020 2020 2020 2020  ddof=1,.        
+0000bea0: 6e75 6d65 7269 635f 6f6e 6c79 3d46 616c  numeric_only=Fal
+0000beb0: 7365 2c0a 2020 2020 2020 2020 7370 6c69  se,.        spli
+0000bec0: 745f 6576 6572 793d 4661 6c73 652c 0a20  t_every=False,. 
+0000bed0: 2020 2020 2020 202a 2a6b 7761 7267 732c         **kwargs,
+0000bee0: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
+0000bef0: 5f72 6169 7365 5f69 665f 6f62 6a65 6374  _raise_if_object
+0000bf00: 5f73 6572 6965 7328 7365 6c66 2c20 2276  _series(self, "v
+0000bf10: 6172 2229 0a20 2020 2020 2020 2061 7869  ar").        axi
+0000bf20: 7320 3d20 7365 6c66 2e5f 7661 6c69 6461  s = self._valida
+0000bf30: 7465 5f61 7869 7328 6178 6973 290a 2020  te_axis(axis).  
+0000bf40: 2020 2020 2020 7365 6c66 2e5f 6d65 7461        self._meta
+0000bf50: 2e76 6172 2861 7869 733d 6178 6973 2c20  .var(axis=axis, 
+0000bf60: 736b 6970 6e61 3d73 6b69 706e 612c 206e  skipna=skipna, n
+0000bf70: 756d 6572 6963 5f6f 6e6c 793d 6e75 6d65  umeric_only=nume
+0000bf80: 7269 635f 6f6e 6c79 290a 2020 2020 2020  ric_only).      
+0000bf90: 2020 6672 616d 6520 3d20 7365 6c66 0a20    frame = self. 
+0000bfa0: 2020 2020 2020 2069 6620 6973 5f64 6174         if is_dat
+0000bfb0: 6166 7261 6d65 5f6c 696b 6528 7365 6c66  aframe_like(self
+0000bfc0: 2e5f 6d65 7461 2920 616e 6420 6e75 6d65  ._meta) and nume
+0000bfd0: 7269 635f 6f6e 6c79 3a0a 2020 2020 2020  ric_only:.      
+0000bfe0: 2020 2020 2020 6672 616d 6520 3d20 6672        frame = fr
+0000bff0: 616d 655b 6c69 7374 2873 656c 662e 5f6d  ame[list(self._m
+0000c000: 6574 612e 7661 7228 6e75 6d65 7269 635f  eta.var(numeric_
+0000c010: 6f6e 6c79 3d54 7275 6529 2e69 6e64 6578  only=True).index
+0000c020: 295d 0a20 2020 2020 2020 2072 6574 7572  )].        retur
+0000c030: 6e20 6e65 775f 636f 6c6c 6563 7469 6f6e  n new_collection
+0000c040: 280a 2020 2020 2020 2020 2020 2020 6672  (.            fr
+0000c050: 616d 652e 6578 7072 2e76 6172 2861 7869  ame.expr.var(axi
+0000c060: 732c 2073 6b69 706e 612c 2064 646f 662c  s, skipna, ddof,
+0000c070: 206e 756d 6572 6963 5f6f 6e6c 792c 2073   numeric_only, s
+0000c080: 706c 6974 5f65 7665 7279 3d73 706c 6974  plit_every=split
+0000c090: 5f65 7665 7279 290a 2020 2020 2020 2020  _every).        
+0000c0a0: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
+0000c0b0: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
+0000c0c0: 6529 0a20 2020 2064 6566 2073 7464 280a  e).    def std(.
+0000c0d0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+0000c0e0: 2020 2020 2020 6178 6973 3d30 2c0a 2020        axis=0,.  
+0000c0f0: 2020 2020 2020 736b 6970 6e61 3d54 7275        skipna=Tru
+0000c100: 652c 0a20 2020 2020 2020 2064 646f 663d  e,.        ddof=
+0000c110: 312c 0a20 2020 2020 2020 206e 756d 6572  1,.        numer
+0000c120: 6963 5f6f 6e6c 793d 4661 6c73 652c 0a20  ic_only=False,. 
+0000c130: 2020 2020 2020 2073 706c 6974 5f65 7665         split_eve
+0000c140: 7279 3d46 616c 7365 2c0a 2020 2020 2020  ry=False,.      
+0000c150: 2020 2a2a 6b77 6172 6773 2c0a 2020 2020    **kwargs,.    
+0000c160: 293a 0a20 2020 2020 2020 205f 7261 6973  ):.        _rais
+0000c170: 655f 6966 5f6f 626a 6563 745f 7365 7269  e_if_object_seri
+0000c180: 6573 2873 656c 662c 2022 7374 6422 290a  es(self, "std").
+0000c190: 2020 2020 2020 2020 6178 6973 203d 2073          axis = s
+0000c1a0: 656c 662e 5f76 616c 6964 6174 655f 6178  elf._validate_ax
+0000c1b0: 6973 2861 7869 7329 0a20 2020 2020 2020  is(axis).       
+0000c1c0: 206e 756d 6572 6963 5f64 6420 3d20 7365   numeric_dd = se
+0000c1d0: 6c66 0a20 2020 2020 2020 206d 6574 6120  lf.        meta 
+0000c1e0: 3d20 6d65 7461 5f6e 6f6e 656d 7074 7928  = meta_nonempty(
+0000c1f0: 7365 6c66 2e5f 6d65 7461 292e 7374 6428  self._meta).std(
+0000c200: 0a20 2020 2020 2020 2020 2020 2061 7869  .            axi
+0000c210: 733d 6178 6973 2c20 736b 6970 6e61 3d73  s=axis, skipna=s
+0000c220: 6b69 706e 612c 2064 646f 663d 6464 6f66  kipna, ddof=ddof
+0000c230: 2c20 6e75 6d65 7269 635f 6f6e 6c79 3d6e  , numeric_only=n
+0000c240: 756d 6572 6963 5f6f 6e6c 790a 2020 2020  umeric_only.    
+0000c250: 2020 2020 290a 2020 2020 2020 2020 6e65      ).        ne
+0000c260: 6564 735f 7469 6d65 5f63 6f6e 7665 7273  eds_time_convers
+0000c270: 696f 6e2c 2074 696d 655f 636f 6c73 203d  ion, time_cols =
+0000c280: 2046 616c 7365 2c20 4e6f 6e65 0a20 2020   False, None.   
+0000c290: 2020 2020 2069 6620 6973 5f64 6174 6166       if is_dataf
+0000c2a0: 7261 6d65 5f6c 696b 6528 7365 6c66 2e5f  rame_like(self._
+0000c2b0: 6d65 7461 293a 0a20 2020 2020 2020 2020  meta):.         
+0000c2c0: 2020 2069 6620 6178 6973 203d 3d20 303a     if axis == 0:
+0000c2d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000c2e0: 206e 756d 6572 6963 5f64 6420 3d20 6e75   numeric_dd = nu
+0000c2f0: 6d65 7269 635f 6464 5b6c 6973 7428 6d65  meric_dd[list(me
+0000c300: 7461 2e69 6e64 6578 295d 0a20 2020 2020  ta.index)].     
+0000c310: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0000c320: 2020 2020 2020 2020 2020 2020 206e 756d               num
+0000c330: 6572 6963 5f64 6420 3d20 6e75 6d65 7269  eric_dd = numeri
+0000c340: 635f 6464 2e63 6f70 7928 290a 0a20 2020  c_dd.copy()..   
+0000c350: 2020 2020 2020 2020 2069 6620 6e75 6d65           if nume
+0000c360: 7269 635f 6f6e 6c79 2069 7320 5472 7565  ric_only is True
+0000c370: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000c380: 2020 5f6d 6574 6120 3d20 6e75 6d65 7269    _meta = numeri
+0000c390: 635f 6464 2e5f 6d65 7461 2e73 656c 6563  c_dd._meta.selec
+0000c3a0: 745f 6474 7970 6573 2869 6e63 6c75 6465  t_dtypes(include
+0000c3b0: 3d5b 6e70 2e6e 756d 6265 725d 290a 2020  =[np.number]).  
+0000c3c0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+0000c3d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c3e0: 5f6d 6574 6120 3d20 6e75 6d65 7269 635f  _meta = numeric_
+0000c3f0: 6464 2e5f 6d65 7461 0a20 2020 2020 2020  dd._meta.       
+0000c400: 2020 2020 2074 696d 655f 636f 6c73 203d       time_cols =
+0000c410: 205f 6d65 7461 2e73 656c 6563 745f 6474   _meta.select_dt
+0000c420: 7970 6573 2869 6e63 6c75 6465 3d5b 2264  ypes(include=["d
+0000c430: 6174 6574 696d 6522 2c20 2274 696d 6564  atetime", "timed
+0000c440: 656c 7461 225d 292e 636f 6c75 6d6e 730a  elta"]).columns.
+0000c450: 2020 2020 2020 2020 2020 2020 6966 206c              if l
+0000c460: 656e 2874 696d 655f 636f 6c73 2920 3e20  en(time_cols) > 
+0000c470: 303a 0a20 2020 2020 2020 2020 2020 2020  0:.             
+0000c480: 2020 2069 6620 6178 6973 203d 3d20 3120     if axis == 1 
+0000c490: 616e 6420 6c65 6e28 7469 6d65 5f63 6f6c  and len(time_col
+0000c4a0: 7329 2021 3d20 6c65 6e28 7365 6c66 2e63  s) != len(self.c
+0000c4b0: 6f6c 756d 6e73 293a 0a20 2020 2020 2020  olumns):.       
+0000c4c0: 2020 2020 2020 2020 2020 2020 206e 756d               num
+0000c4d0: 6572 6963 5f64 6420 3d20 6672 6f6d 5f70  eric_dd = from_p
+0000c4e0: 616e 6461 7328 0a20 2020 2020 2020 2020  andas(.         
+0000c4f0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+0000c500: 6574 615f 6672 616d 655f 636f 6e73 7472  eta_frame_constr
+0000c510: 7563 746f 7228 7365 6c66 2928 0a20 2020  uctor(self)(.   
+0000c520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c530: 2020 2020 2020 2020 207b 225f 223a 206d           {"_": m
+0000c540: 6574 615f 7365 7269 6573 5f63 6f6e 7374  eta_series_const
+0000c550: 7275 6374 6f72 2873 656c 6629 285b 6e70  ructor(self)([np
+0000c560: 2e6e 616e 5d29 7d2c 0a20 2020 2020 2020  .nan])},.       
+0000c570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c580: 2020 2020 2069 6e64 6578 3d73 656c 662e       index=self.
+0000c590: 696e 6465 782c 0a20 2020 2020 2020 2020  index,.         
+0000c5a0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0000c5b0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000c5c0: 2020 2020 2020 2020 2020 6e70 6172 7469            nparti
+0000c5d0: 7469 6f6e 733d 7365 6c66 2e6e 7061 7274  tions=self.npart
+0000c5e0: 6974 696f 6e73 2c0a 2020 2020 2020 2020  itions,.        
+0000c5f0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0000c600: 2020 2020 2020 2020 2020 2020 2020 656c                el
+0000c610: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+0000c620: 2020 2020 2020 2020 6e65 6564 735f 7469          needs_ti
+0000c630: 6d65 5f63 6f6e 7665 7273 696f 6e20 3d20  me_conversion = 
+0000c640: 5472 7565 0a20 2020 2020 2020 2020 2020  True.           
+0000c650: 2020 2020 2020 2020 2066 6f72 2063 6f6c           for col
+0000c660: 2069 6e20 7469 6d65 5f63 6f6c 733a 0a20   in time_cols:. 
+0000c670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c680: 2020 2020 2020 206e 756d 6572 6963 5f64         numeric_d
+0000c690: 645b 636f 6c5d 203d 205f 636f 6e76 6572  d[col] = _conver
+0000c6a0: 745f 746f 5f6e 756d 6572 6963 286e 756d  t_to_numeric(num
+0000c6b0: 6572 6963 5f64 645b 636f 6c5d 2c20 736b  eric_dd[col], sk
+0000c6c0: 6970 6e61 290a 2020 2020 2020 2020 656c  ipna).        el
+0000c6d0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+0000c6e0: 6e65 6564 735f 7469 6d65 5f63 6f6e 7665  needs_time_conve
+0000c6f0: 7273 696f 6e20 3d20 6973 5f64 6174 6574  rsion = is_datet
+0000c700: 696d 6536 345f 616e 795f 6474 7970 6528  ime64_any_dtype(
+0000c710: 7365 6c66 2e5f 6d65 7461 290a 2020 2020  self._meta).    
+0000c720: 2020 2020 2020 2020 6966 206e 6565 6473          if needs
+0000c730: 5f74 696d 655f 636f 6e76 6572 7369 6f6e  _time_conversion
+0000c740: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000c750: 2020 6e75 6d65 7269 635f 6464 203d 205f    numeric_dd = _
+0000c760: 636f 6e76 6572 745f 746f 5f6e 756d 6572  convert_to_numer
+0000c770: 6963 2873 656c 662c 2073 6b69 706e 6129  ic(self, skipna)
+0000c780: 0a0a 2020 2020 2020 2020 6966 2061 7869  ..        if axi
+0000c790: 7320 3d3d 2031 3a0a 2020 2020 2020 2020  s == 1:.        
+0000c7a0: 2020 2020 7265 7475 726e 206e 756d 6572      return numer
+0000c7b0: 6963 5f64 642e 6d61 705f 7061 7274 6974  ic_dd.map_partit
+0000c7c0: 696f 6e73 280a 2020 2020 2020 2020 2020  ions(.          
+0000c7d0: 2020 2020 2020 4d2e 7374 6420 6966 206e        M.std if n
+0000c7e0: 6f74 206e 6565 6473 5f74 696d 655f 636f  ot needs_time_co
+0000c7f0: 6e76 6572 7369 6f6e 2065 6c73 6520 5f73  nversion else _s
+0000c800: 7172 745f 616e 645f 636f 6e76 6572 745f  qrt_and_convert_
+0000c810: 746f 5f74 696d 6564 656c 7461 2c0a 2020  to_timedelta,.  
+0000c820: 2020 2020 2020 2020 2020 2020 2020 6d65                me
+0000c830: 7461 3d6d 6574 612c 0a20 2020 2020 2020  ta=meta,.       
+0000c840: 2020 2020 2020 2020 2061 7869 733d 6178           axis=ax
+0000c850: 6973 2c0a 2020 2020 2020 2020 2020 2020  is,.            
+0000c860: 2020 2020 736b 6970 6e61 3d73 6b69 706e      skipna=skipn
+0000c870: 612c 0a20 2020 2020 2020 2020 2020 2020  a,.             
+0000c880: 2020 2064 646f 663d 6464 6f66 2c0a 2020     ddof=ddof,.  
+0000c890: 2020 2020 2020 2020 2020 2020 2020 656e                en
+0000c8a0: 666f 7263 655f 6d65 7461 6461 7461 3d46  force_metadata=F
+0000c8b0: 616c 7365 2c0a 2020 2020 2020 2020 2020  alse,.          
+0000c8c0: 2020 2020 2020 6e75 6d65 7269 635f 6f6e        numeric_on
+0000c8d0: 6c79 3d6e 756d 6572 6963 5f6f 6e6c 792c  ly=numeric_only,
+0000c8e0: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
+0000c8f0: 2020 2020 2020 2020 7265 7375 6c74 203d          result =
+0000c900: 206e 756d 6572 6963 5f64 642e 7661 7228   numeric_dd.var(
+0000c910: 0a20 2020 2020 2020 2020 2020 2073 6b69  .            ski
+0000c920: 706e 613d 736b 6970 6e61 2c20 6464 6f66  pna=skipna, ddof
+0000c930: 3d64 646f 662c 206e 756d 6572 6963 5f6f  =ddof, numeric_o
+0000c940: 6e6c 793d 6e75 6d65 7269 635f 6f6e 6c79  nly=numeric_only
+0000c950: 2c20 7370 6c69 745f 6576 6572 793d 7370  , split_every=sp
+0000c960: 6c69 745f 6576 6572 790a 2020 2020 2020  lit_every.      
+0000c970: 2020 290a 0a20 2020 2020 2020 2069 6620    )..        if 
+0000c980: 6e65 6564 735f 7469 6d65 5f63 6f6e 7665  needs_time_conve
+0000c990: 7273 696f 6e3a 0a20 2020 2020 2020 2020  rsion:.         
+0000c9a0: 2020 2073 7172 745f 6675 6e63 5f6b 7761     sqrt_func_kwa
+0000c9b0: 7267 7320 3d20 7b0a 2020 2020 2020 2020  rgs = {.        
+0000c9c0: 2020 2020 2020 2020 2269 735f 6466 5f6c          "is_df_l
+0000c9d0: 696b 6522 3a20 6973 5f64 6174 6166 7261  ike": is_datafra
+0000c9e0: 6d65 5f6c 696b 6528 7365 6c66 2e5f 6d65  me_like(self._me
+0000c9f0: 7461 292c 0a20 2020 2020 2020 2020 2020  ta),.           
+0000ca00: 2020 2020 2022 7469 6d65 5f63 6f6c 7322       "time_cols"
+0000ca10: 3a20 7469 6d65 5f63 6f6c 732c 0a20 2020  : time_cols,.   
+0000ca20: 2020 2020 2020 2020 2020 2020 2022 6178               "ax
+0000ca30: 6973 223a 2061 7869 732c 0a20 2020 2020  is": axis,.     
+0000ca40: 2020 2020 2020 2020 2020 2022 6474 7970             "dtyp
+0000ca50: 6522 3a20 6765 7461 7474 7228 6d65 7461  e": getattr(meta
+0000ca60: 2c20 2264 7479 7065 222c 204e 6f6e 6529  , "dtype", None)
+0000ca70: 2c0a 2020 2020 2020 2020 2020 2020 7d0a  ,.            }.
+0000ca80: 2020 2020 2020 2020 2020 2020 7371 7274              sqrt
+0000ca90: 5f66 756e 6320 3d20 5f73 7172 745f 616e  _func = _sqrt_an
+0000caa0: 645f 636f 6e76 6572 745f 746f 5f74 696d  d_convert_to_tim
+0000cab0: 6564 656c 7461 0a20 2020 2020 2020 2065  edelta.        e
+0000cac0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0000cad0: 2073 7172 745f 6675 6e63 5f6b 7761 7267   sqrt_func_kwarg
+0000cae0: 7320 3d20 7b7d 0a20 2020 2020 2020 2020  s = {}.         
+0000caf0: 2020 2073 7172 745f 6675 6e63 203d 206e     sqrt_func = n
+0000cb00: 702e 7371 7274 0a0a 2020 2020 2020 2020  p.sqrt..        
+0000cb10: 7265 7375 6c74 203d 2072 6573 756c 742e  result = result.
+0000cb20: 6d61 705f 7061 7274 6974 696f 6e73 280a  map_partitions(.
+0000cb30: 2020 2020 2020 2020 2020 2020 7371 7274              sqrt
+0000cb40: 5f66 756e 632c 0a20 2020 2020 2020 2020  _func,.         
+0000cb50: 2020 206d 6574 613d 6d65 7461 2c0a 2020     meta=meta,.  
+0000cb60: 2020 2020 2020 2020 2020 656e 666f 7263            enforc
+0000cb70: 655f 6d65 7461 6461 7461 3d46 616c 7365  e_metadata=False
+0000cb80: 2c0a 2020 2020 2020 2020 2020 2020 7061  ,.            pa
+0000cb90: 7265 6e74 5f6d 6574 613d 7365 6c66 2e5f  rent_meta=self._
+0000cba0: 6d65 7461 2c0a 2020 2020 2020 2020 2020  meta,.          
+0000cbb0: 2020 2a2a 7371 7274 5f66 756e 635f 6b77    **sqrt_func_kw
+0000cbc0: 6172 6773 2c0a 2020 2020 2020 2020 290a  args,.        ).
+0000cbd0: 2020 2020 2020 2020 7265 7475 726e 2072          return r
+0000cbe0: 6573 756c 740a 0a20 2020 2064 6566 2065  esult..    def e
+0000cbf0: 6e66 6f72 6365 5f72 756e 7469 6d65 5f64  nforce_runtime_d
+0000cc00: 6976 6973 696f 6e73 2873 656c 6629 3a0a  ivisions(self):.
+0000cc10: 2020 2020 2020 2020 2222 2245 6e66 6f72          """Enfor
+0000cc20: 6365 2074 6865 2063 7572 7265 6e74 2064  ce the current d
+0000cc30: 6976 6973 696f 6e73 2061 7420 7275 6e74  ivisions at runt
+0000cc40: 696d 652e 0a0a 2020 2020 2020 2020 496e  ime...        In
+0000cc50: 6a65 6374 7320 6120 6c61 7965 7220 696e  jects a layer in
+0000cc60: 746f 2074 6865 2054 6173 6b20 4772 6170  to the Task Grap
+0000cc70: 6820 7468 6174 2063 6865 636b 7320 7468  h that checks th
+0000cc80: 6174 2074 6865 2063 7572 7265 6e74 2064  at the current d
+0000cc90: 6976 6973 696f 6e73 0a20 2020 2020 2020  ivisions.       
+0000cca0: 206d 6174 6368 2074 6865 2065 7870 6563   match the expec
+0000ccb0: 7465 6420 6469 7669 7369 6f6e 7320 6174  ted divisions at
+0000ccc0: 2072 756e 7469 6d65 2e0a 2020 2020 2020   runtime..      
+0000ccd0: 2020 2222 220a 2020 2020 2020 2020 6966    """.        if
+0000cce0: 206e 6f74 2073 656c 662e 6b6e 6f77 6e5f   not self.known_
+0000ccf0: 6469 7669 7369 6f6e 733a 0a20 2020 2020  divisions:.     
+0000cd00: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+0000cd10: 7565 4572 726f 7228 224e 6f20 6b6e 6f77  ueError("No know
+0000cd20: 6e20 6469 7669 7369 6f6e 7320 746f 2065  n divisions to e
+0000cd30: 6e66 6f72 6365 2122 290a 2020 2020 2020  nforce!").      
+0000cd40: 2020 7265 7475 726e 206e 6577 5f63 6f6c    return new_col
+0000cd50: 6c65 6374 696f 6e28 6578 7072 2e45 6e66  lection(expr.Enf
+0000cd60: 6f72 6365 5275 6e74 696d 6544 6976 6973  orceRuntimeDivis
+0000cd70: 696f 6e73 2873 656c 6629 290a 0a20 2020  ions(self))..   
+0000cd80: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
+0000cd90: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
+0000cda0: 2064 6566 2073 6b65 7728 0a20 2020 2020   def skew(.     
+0000cdb0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+0000cdc0: 2061 7869 733d 302c 0a20 2020 2020 2020   axis=0,.       
+0000cdd0: 2062 6961 733d 5472 7565 2c0a 2020 2020   bias=True,.    
+0000cde0: 2020 2020 6e61 6e5f 706f 6c69 6379 3d22      nan_policy="
+0000cdf0: 7072 6f70 6167 6174 6522 2c0a 2020 2020  propagate",.    
+0000ce00: 2020 2020 6e75 6d65 7269 635f 6f6e 6c79      numeric_only
+0000ce10: 3d46 616c 7365 2c0a 2020 2020 293a 0a20  =False,.    ):. 
+0000ce20: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0000ce30: 2020 202e 2e20 6e6f 7465 3a3a 0a0a 2020     .. note::..  
+0000ce40: 2020 2020 2020 2020 2054 6869 7320 696d           This im
+0000ce50: 706c 656d 656e 7461 7469 6f6e 2066 6f6c  plementation fol
+0000ce60: 6c6f 7773 2074 6865 2064 6173 6b2e 6172  lows the dask.ar
+0000ce70: 7261 792e 7374 6174 7320 696d 706c 656d  ray.stats implem
+0000ce80: 656e 7461 7469 6f6e 0a20 2020 2020 2020  entation.       
+0000ce90: 2020 2020 6f66 2073 6b65 776e 6573 7320      of skewness 
+0000cea0: 616e 6420 6361 6c63 756c 6174 6573 2073  and calculates s
+0000ceb0: 6b65 776e 6573 7320 7769 7468 6f75 7420  kewness without 
+0000cec0: 7461 6b69 6e67 2069 6e74 6f20 6163 636f  taking into acco
+0000ced0: 756e 740a 2020 2020 2020 2020 2020 2061  unt.           a
+0000cee0: 2062 6961 7320 7465 726d 2066 6f72 2066   bias term for f
+0000cef0: 696e 6974 6520 7361 6d70 6c65 2073 697a  inite sample siz
+0000cf00: 652c 2077 6869 6368 2063 6f72 7265 7370  e, which corresp
+0000cf10: 6f6e 6473 2074 6f20 7468 650a 2020 2020  onds to the.    
+0000cf20: 2020 2020 2020 2064 6566 6175 6c74 2073         default s
+0000cf30: 6574 7469 6e67 7320 6f66 2074 6865 2073  ettings of the s
+0000cf40: 6369 7079 2e73 7461 7473 2073 6b65 776e  cipy.stats skewn
+0000cf50: 6573 7320 6361 6c63 756c 6174 696f 6e2e  ess calculation.
+0000cf60: 2048 6f77 6576 6572 2c0a 2020 2020 2020   However,.      
+0000cf70: 2020 2020 2050 616e 6461 7320 636f 7272       Pandas corr
+0000cf80: 6563 7473 2066 6f72 2074 6869 732c 2073  ects for this, s
+0000cf90: 6f20 7468 6520 7661 6c75 6573 2064 6966  o the values dif
+0000cfa0: 6665 7220 6279 2061 2066 6163 746f 7220  fer by a factor 
+0000cfb0: 6f66 0a20 2020 2020 2020 2020 2020 286e  of.           (n
+0000cfc0: 202a 2028 6e20 2d20 3129 2920 2a2a 2030   * (n - 1)) ** 0
+0000cfd0: 2e35 202f 2028 6e20 2d20 3229 2c20 7768  .5 / (n - 2), wh
+0000cfe0: 6572 6520 6e20 6973 2074 6865 206e 756d  ere n is the num
+0000cff0: 6265 7220 6f66 2073 616d 706c 6573 2e0a  ber of samples..
+0000d000: 0a20 2020 2020 2020 2020 2020 4675 7274  .           Furt
+0000d010: 6865 722c 2074 6869 7320 6d65 7468 6f64  her, this method
+0000d020: 2063 7572 7265 6e74 6c79 2064 6f65 7320   currently does 
+0000d030: 6e6f 7420 7375 7070 6f72 7420 6669 6c74  not support filt
+0000d040: 6572 696e 6720 6f75 7420 4e61 4e0a 2020  ering out NaN.  
+0000d050: 2020 2020 2020 2020 2076 616c 7565 732c           values,
+0000d060: 2077 6869 6368 2069 7320 6167 6169 6e20   which is again 
+0000d070: 6120 6469 6666 6572 656e 6365 2074 6f20  a difference to 
+0000d080: 5061 6e64 6173 2e0a 2020 2020 2020 2020  Pandas..        
+0000d090: 2222 220a 2020 2020 2020 2020 5f72 6169  """.        _rai
+0000d0a0: 7365 5f69 665f 6f62 6a65 6374 5f73 6572  se_if_object_ser
+0000d0b0: 6965 7328 7365 6c66 2c20 2273 6b65 7722  ies(self, "skew"
+0000d0c0: 290a 2020 2020 2020 2020 6966 2061 7869  ).        if axi
+0000d0d0: 7320 6973 204e 6f6e 653a 0a20 2020 2020  s is None:.     
+0000d0e0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+0000d0f0: 7565 4572 726f 7228 2260 6178 6973 3d4e  ueError("`axis=N
+0000d100: 6f6e 6560 2069 736e 2774 2063 7572 7265  one` isn't curre
+0000d110: 6e74 6c79 2073 7570 706f 7274 6564 2066  ntly supported f
+0000d120: 6f72 2060 736b 6577 6022 290a 2020 2020  or `skew`").    
+0000d130: 2020 2020 6178 6973 203d 2073 656c 662e      axis = self.
+0000d140: 5f76 616c 6964 6174 655f 6178 6973 2861  _validate_axis(a
+0000d150: 7869 7329 0a0a 2020 2020 2020 2020 6966  xis)..        if
+0000d160: 2069 735f 6461 7461 6672 616d 655f 6c69   is_dataframe_li
+0000d170: 6b65 2873 656c 6629 3a0a 2020 2020 2020  ke(self):.      
+0000d180: 2020 2020 2020 2320 4c65 7420 7061 6e64        # Let pand
+0000d190: 6173 2072 6169 7365 2065 7272 6f72 7320  as raise errors 
+0000d1a0: 6966 206e 6563 6573 7361 7279 0a20 2020  if necessary.   
+0000d1b0: 2020 2020 2020 2020 206d 6574 6120 3d20           meta = 
+0000d1c0: 7365 6c66 2e5f 6d65 7461 5f6e 6f6e 656d  self._meta_nonem
+0000d1d0: 7074 792e 736b 6577 2861 7869 733d 6178  pty.skew(axis=ax
+0000d1e0: 6973 2c20 6e75 6d65 7269 635f 6f6e 6c79  is, numeric_only
+0000d1f0: 3d6e 756d 6572 6963 5f6f 6e6c 7929 0a20  =numeric_only). 
+0000d200: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0000d210: 2020 2020 2020 2020 206d 6574 6120 3d20           meta = 
+0000d220: 7365 6c66 2e5f 6d65 7461 5f6e 6f6e 656d  self._meta_nonem
+0000d230: 7074 792e 736b 6577 2829 0a0a 2020 2020  pty.skew()..    
+0000d240: 2020 2020 6966 2061 7869 7320 3d3d 2031      if axis == 1
+0000d250: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+0000d260: 7475 726e 2073 656c 662e 6d61 705f 7061  turn self.map_pa
+0000d270: 7274 6974 696f 6e73 280a 2020 2020 2020  rtitions(.      
+0000d280: 2020 2020 2020 2020 2020 4d2e 736b 6577            M.skew
+0000d290: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000d2a0: 2020 6d65 7461 3d6d 6574 612c 0a20 2020    meta=meta,.   
+0000d2b0: 2020 2020 2020 2020 2020 2020 2061 7869               axi
+0000d2c0: 733d 6178 6973 2c0a 2020 2020 2020 2020  s=axis,.        
+0000d2d0: 2020 2020 2020 2020 656e 666f 7263 655f          enforce_
+0000d2e0: 6d65 7461 6461 7461 3d46 616c 7365 2c0a  metadata=False,.
+0000d2f0: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+0000d300: 2020 2020 2020 2069 6620 6e6f 7420 6269         if not bi
+0000d310: 6173 3a0a 2020 2020 2020 2020 2020 2020  as:.            
+0000d320: 7261 6973 6520 4e6f 7449 6d70 6c65 6d65  raise NotImpleme
+0000d330: 6e74 6564 4572 726f 7228 2262 6961 733d  ntedError("bias=
+0000d340: 4661 6c73 6520 6973 206e 6f74 2069 6d70  False is not imp
+0000d350: 6c65 6d65 6e74 6564 2e22 290a 2020 2020  lemented.").    
+0000d360: 2020 2020 6966 206e 616e 5f70 6f6c 6963      if nan_polic
+0000d370: 7920 213d 2022 7072 6f70 6167 6174 6522  y != "propagate"
+0000d380: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+0000d390: 6973 6520 4e6f 7449 6d70 6c65 6d65 6e74  ise NotImplement
+0000d3a0: 6564 4572 726f 7228 0a20 2020 2020 2020  edError(.       
+0000d3b0: 2020 2020 2020 2020 2022 606e 616e 5f70           "`nan_p
+0000d3c0: 6f6c 6963 7960 206f 7468 6572 2074 6861  olicy` other tha
+0000d3d0: 6e20 2770 726f 7061 6761 7465 2720 6861  n 'propagate' ha
+0000d3e0: 7665 206e 6f74 2062 6565 6e20 696d 706c  ve not been impl
+0000d3f0: 656d 656e 7465 642e 220a 2020 2020 2020  emented.".      
+0000d400: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+0000d410: 2066 7261 6d65 203d 2073 656c 660a 2020   frame = self.  
+0000d420: 2020 2020 2020 6966 2066 7261 6d65 2e6e        if frame.n
+0000d430: 6469 6d20 3e20 313a 0a20 2020 2020 2020  dim > 1:.       
+0000d440: 2020 2020 2066 7261 6d65 203d 2066 7261       frame = fra
+0000d450: 6d65 2e73 656c 6563 745f 6474 7970 6573  me.select_dtypes
+0000d460: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0000d470: 2020 696e 636c 7564 653d 5b22 6e75 6d62    include=["numb
+0000d480: 6572 222c 2022 626f 6f6c 225d 2c20 6578  er", "bool"], ex
+0000d490: 636c 7564 653d 5b6e 702e 7469 6d65 6465  clude=[np.timede
+0000d4a0: 6c74 6136 345d 0a20 2020 2020 2020 2020  lta64].         
+0000d4b0: 2020 2029 0a20 2020 2020 2020 206d 3220     ).        m2 
+0000d4c0: 3d20 6e65 775f 636f 6c6c 6563 7469 6f6e  = new_collection
+0000d4d0: 284d 6f6d 656e 7428 6672 616d 652c 206f  (Moment(frame, o
+0000d4e0: 7264 6572 3d32 2929 0a20 2020 2020 2020  rder=2)).       
+0000d4f0: 206d 3320 3d20 6e65 775f 636f 6c6c 6563   m3 = new_collec
+0000d500: 7469 6f6e 284d 6f6d 656e 7428 6672 616d  tion(Moment(fram
+0000d510: 652c 206f 7264 6572 3d33 2929 0a20 2020  e, order=3)).   
+0000d520: 2020 2020 2072 6573 756c 7420 3d20 6d33       result = m3
+0000d530: 202f 206d 322a 2a31 2e35 0a20 2020 2020   / m2**1.5.     
+0000d540: 2020 2069 6620 7265 7375 6c74 2e6e 6469     if result.ndi
+0000d550: 6d20 3d3d 2031 3a0a 2020 2020 2020 2020  m == 1:.        
+0000d560: 2020 2020 7265 7375 6c74 203d 2072 6573      result = res
+0000d570: 756c 742e 6669 6c6c 6e61 2830 2e30 290a  ult.fillna(0.0).
+0000d580: 2020 2020 2020 2020 7265 7475 726e 2072          return r
+0000d590: 6573 756c 740a 0a20 2020 2040 6465 7269  esult..    @deri
+0000d5a0: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
+0000d5b0: 4672 616d 6529 0a20 2020 2064 6566 206b  Frame).    def k
+0000d5c0: 7572 746f 7369 7328 0a20 2020 2020 2020  urtosis(.       
+0000d5d0: 2073 656c 662c 0a20 2020 2020 2020 2061   self,.        a
+0000d5e0: 7869 733d 302c 0a20 2020 2020 2020 2066  xis=0,.        f
+0000d5f0: 6973 6865 723d 5472 7565 2c0a 2020 2020  isher=True,.    
+0000d600: 2020 2020 6269 6173 3d54 7275 652c 0a20      bias=True,. 
+0000d610: 2020 2020 2020 206e 616e 5f70 6f6c 6963         nan_polic
+0000d620: 793d 2270 726f 7061 6761 7465 222c 0a20  y="propagate",. 
+0000d630: 2020 2020 2020 206e 756d 6572 6963 5f6f         numeric_o
+0000d640: 6e6c 793d 4661 6c73 652c 0a20 2020 2029  nly=False,.    )
+0000d650: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+0000d660: 2020 2020 2020 2e2e 206e 6f74 653a 3a0a        .. note::.
+0000d670: 0a20 2020 2020 2020 2020 2020 5468 6973  .           This
+0000d680: 2069 6d70 6c65 6d65 6e74 6174 696f 6e20   implementation 
+0000d690: 666f 6c6c 6f77 7320 7468 6520 6461 736b  follows the dask
+0000d6a0: 2e61 7272 6179 2e73 7461 7473 2069 6d70  .array.stats imp
+0000d6b0: 6c65 6d65 6e74 6174 696f 6e0a 2020 2020  lementation.    
+0000d6c0: 2020 2020 2020 206f 6620 6b75 7274 6f73         of kurtos
+0000d6d0: 6973 2061 6e64 2063 616c 6375 6c61 7465  is and calculate
+0000d6e0: 7320 6b75 7274 6f73 6973 2077 6974 686f  s kurtosis witho
+0000d6f0: 7574 2074 616b 696e 6720 696e 746f 2061  ut taking into a
+0000d700: 6363 6f75 6e74 0a20 2020 2020 2020 2020  ccount.         
+0000d710: 2020 6120 6269 6173 2074 6572 6d20 666f    a bias term fo
+0000d720: 7220 6669 6e69 7465 2073 616d 706c 6520  r finite sample 
+0000d730: 7369 7a65 2c20 7768 6963 6820 636f 7272  size, which corr
+0000d740: 6573 706f 6e64 7320 746f 2074 6865 0a20  esponds to the. 
+0000d750: 2020 2020 2020 2020 2020 6465 6661 756c            defaul
+0000d760: 7420 7365 7474 696e 6773 206f 6620 7468  t settings of th
+0000d770: 6520 7363 6970 792e 7374 6174 7320 6b75  e scipy.stats ku
+0000d780: 7274 6f73 6973 2063 616c 6375 6c61 7469  rtosis calculati
+0000d790: 6f6e 2e20 5468 6973 2064 6966 6665 7273  on. This differs
+0000d7a0: 0a20 2020 2020 2020 2020 2020 6672 6f6d  .           from
+0000d7b0: 2070 616e 6461 732e 0a0a 2020 2020 2020   pandas...      
+0000d7c0: 2020 2020 2046 7572 7468 6572 2c20 7468       Further, th
+0000d7d0: 6973 206d 6574 686f 6420 6375 7272 656e  is method curren
+0000d7e0: 746c 7920 646f 6573 206e 6f74 2073 7570  tly does not sup
+0000d7f0: 706f 7274 2066 696c 7465 7269 6e67 206f  port filtering o
+0000d800: 7574 204e 614e 0a20 2020 2020 2020 2020  ut NaN.         
+0000d810: 2020 7661 6c75 6573 2c20 7768 6963 6820    values, which 
+0000d820: 6973 2061 6761 696e 2061 2064 6966 6665  is again a diffe
+0000d830: 7265 6e63 6520 746f 2050 616e 6461 732e  rence to Pandas.
+0000d840: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0000d850: 2020 2020 205f 7261 6973 655f 6966 5f6f       _raise_if_o
+0000d860: 626a 6563 745f 7365 7269 6573 2873 656c  bject_series(sel
+0000d870: 662c 2022 6b75 7274 6f73 6973 2229 0a20  f, "kurtosis"). 
+0000d880: 2020 2020 2020 2069 6620 6178 6973 2069         if axis i
+0000d890: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+0000d8a0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+0000d8b0: 7272 6f72 2822 6061 7869 733d 4e6f 6e65  rror("`axis=None
+0000d8c0: 6020 6973 6e27 7420 6375 7272 656e 746c  ` isn't currentl
+0000d8d0: 7920 7375 7070 6f72 7465 6420 666f 7220  y supported for 
+0000d8e0: 6073 6b65 7760 2229 0a20 2020 2020 2020  `skew`").       
+0000d8f0: 2061 7869 7320 3d20 7365 6c66 2e5f 7661   axis = self._va
+0000d900: 6c69 6461 7465 5f61 7869 7328 6178 6973  lidate_axis(axis
+0000d910: 290a 0a20 2020 2020 2020 2069 6620 6973  )..        if is
+0000d920: 5f64 6174 6166 7261 6d65 5f6c 696b 6528  _dataframe_like(
+0000d930: 7365 6c66 293a 0a20 2020 2020 2020 2020  self):.         
+0000d940: 2020 2023 204c 6574 2070 616e 6461 7320     # Let pandas 
+0000d950: 7261 6973 6520 6572 726f 7273 2069 6620  raise errors if 
+0000d960: 6e65 6365 7373 6172 790a 2020 2020 2020  necessary.      
+0000d970: 2020 2020 2020 6d65 7461 203d 2073 656c        meta = sel
+0000d980: 662e 5f6d 6574 615f 6e6f 6e65 6d70 7479  f._meta_nonempty
+0000d990: 2e6b 7572 746f 7369 7328 6178 6973 3d61  .kurtosis(axis=a
+0000d9a0: 7869 732c 206e 756d 6572 6963 5f6f 6e6c  xis, numeric_onl
+0000d9b0: 793d 6e75 6d65 7269 635f 6f6e 6c79 290a  y=numeric_only).
+0000d9c0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0000d9d0: 2020 2020 2020 2020 2020 6d65 7461 203d            meta =
+0000d9e0: 2073 656c 662e 5f6d 6574 615f 6e6f 6e65   self._meta_none
+0000d9f0: 6d70 7479 2e6b 7572 746f 7369 7328 290a  mpty.kurtosis().
+0000da00: 0a20 2020 2020 2020 2069 6620 6178 6973  .        if axis
+0000da10: 203d 3d20 313a 0a20 2020 2020 2020 2020   == 1:.         
+0000da20: 2020 2072 6574 7572 6e20 6d61 705f 7061     return map_pa
+0000da30: 7274 6974 696f 6e73 280a 2020 2020 2020  rtitions(.      
+0000da40: 2020 2020 2020 2020 2020 4d2e 6b75 7274            M.kurt
+0000da50: 6f73 6973 2c0a 2020 2020 2020 2020 2020  osis,.          
+0000da60: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+0000da70: 2020 2020 2020 2020 2020 2020 6d65 7461              meta
+0000da80: 3d6d 6574 612c 0a20 2020 2020 2020 2020  =meta,.         
+0000da90: 2020 2020 2020 2074 6f6b 656e 3d73 656c         token=sel
+0000daa0: 662e 5f74 6f6b 656e 5f70 7265 6669 7820  f._token_prefix 
+0000dab0: 2b20 226b 7572 746f 7369 7322 2c0a 2020  + "kurtosis",.  
+0000dac0: 2020 2020 2020 2020 2020 2020 2020 6178                ax
+0000dad0: 6973 3d61 7869 732c 0a20 2020 2020 2020  is=axis,.       
+0000dae0: 2020 2020 2020 2020 2065 6e66 6f72 6365           enforce
+0000daf0: 5f6d 6574 6164 6174 613d 4661 6c73 652c  _metadata=False,
+0000db00: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
+0000db10: 2020 2020 2020 2020 6966 206e 6f74 2062          if not b
+0000db20: 6961 733a 0a20 2020 2020 2020 2020 2020  ias:.           
+0000db30: 2072 6169 7365 204e 6f74 496d 706c 656d   raise NotImplem
+0000db40: 656e 7465 6445 7272 6f72 2822 6269 6173  entedError("bias
+0000db50: 3d46 616c 7365 2069 7320 6e6f 7420 696d  =False is not im
+0000db60: 706c 656d 656e 7465 642e 2229 0a20 2020  plemented.").   
+0000db70: 2020 2020 2069 6620 6e61 6e5f 706f 6c69       if nan_poli
+0000db80: 6379 2021 3d20 2270 726f 7061 6761 7465  cy != "propagate
+0000db90: 223a 0a20 2020 2020 2020 2020 2020 2072  ":.            r
+0000dba0: 6169 7365 204e 6f74 496d 706c 656d 656e  aise NotImplemen
+0000dbb0: 7465 6445 7272 6f72 280a 2020 2020 2020  tedError(.      
+0000dbc0: 2020 2020 2020 2020 2020 2260 6e61 6e5f            "`nan_
+0000dbd0: 706f 6c69 6379 6020 6f74 6865 7220 7468  policy` other th
+0000dbe0: 616e 2027 7072 6f70 6167 6174 6527 2068  an 'propagate' h
+0000dbf0: 6176 6520 6e6f 7420 6265 656e 2069 6d70  ave not been imp
+0000dc00: 6c65 6d65 6e74 6564 2e22 0a20 2020 2020  lemented.".     
+0000dc10: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+0000dc20: 2020 6672 616d 6520 3d20 7365 6c66 0a20    frame = self. 
+0000dc30: 2020 2020 2020 2069 6620 6672 616d 652e         if frame.
+0000dc40: 6e64 696d 203e 2031 3a0a 2020 2020 2020  ndim > 1:.      
+0000dc50: 2020 2020 2020 6672 616d 6520 3d20 6672        frame = fr
+0000dc60: 616d 652e 7365 6c65 6374 5f64 7479 7065  ame.select_dtype
+0000dc70: 7328 0a20 2020 2020 2020 2020 2020 2020  s(.             
+0000dc80: 2020 2069 6e63 6c75 6465 3d5b 226e 756d     include=["num
+0000dc90: 6265 7222 2c20 2262 6f6f 6c22 5d2c 2065  ber", "bool"], e
+0000dca0: 7863 6c75 6465 3d5b 6e70 2e74 696d 6564  xclude=[np.timed
+0000dcb0: 656c 7461 3634 5d0a 2020 2020 2020 2020  elta64].        
+0000dcc0: 2020 2020 290a 2020 2020 2020 2020 6d32      ).        m2
+0000dcd0: 203d 206e 6577 5f63 6f6c 6c65 6374 696f   = new_collectio
+0000dce0: 6e28 4d6f 6d65 6e74 2866 7261 6d65 2c20  n(Moment(frame, 
+0000dcf0: 6f72 6465 723d 3229 290a 2020 2020 2020  order=2)).      
+0000dd00: 2020 6d34 203d 206e 6577 5f63 6f6c 6c65    m4 = new_colle
+0000dd10: 6374 696f 6e28 4d6f 6d65 6e74 2866 7261  ction(Moment(fra
+0000dd20: 6d65 2c20 6f72 6465 723d 3429 290a 2020  me, order=4)).  
+0000dd30: 2020 2020 2020 7265 7375 6c74 203d 206d        result = m
+0000dd40: 3420 2f20 6d32 2a2a 322e 300a 2020 2020  4 / m2**2.0.    
+0000dd50: 2020 2020 6966 2072 6573 756c 742e 6e64      if result.nd
+0000dd60: 696d 203d 3d20 313a 0a20 2020 2020 2020  im == 1:.       
+0000dd70: 2020 2020 2072 6573 756c 7420 3d20 7265       result = re
+0000dd80: 7375 6c74 2e66 696c 6c6e 6128 302e 3029  sult.fillna(0.0)
+0000dd90: 0a20 2020 2020 2020 2069 6620 6669 7368  .        if fish
+0000dda0: 6572 3a0a 2020 2020 2020 2020 2020 2020  er:.            
+0000ddb0: 7265 7475 726e 2072 6573 756c 7420 2d20  return result - 
+0000ddc0: 330a 2020 2020 2020 2020 656c 7365 3a0a  3.        else:.
+0000ddd0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0000dde0: 726e 2072 6573 756c 740a 0a20 2020 206b  rn result..    k
+0000ddf0: 7572 7420 3d20 6b75 7274 6f73 6973 0a0a  urt = kurtosis..
+0000de00: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
+0000de10: 6d28 7064 2e44 6174 6146 7261 6d65 290a  m(pd.DataFrame).
+0000de20: 2020 2020 6465 6620 7365 6d28 0a20 2020      def sem(.   
+0000de30: 2020 2020 2073 656c 662c 2061 7869 733d       self, axis=
+0000de40: 4e6f 6e65 2c20 736b 6970 6e61 3d54 7275  None, skipna=Tru
+0000de50: 652c 2064 646f 663d 312c 2073 706c 6974  e, ddof=1, split
+0000de60: 5f65 7665 7279 3d46 616c 7365 2c20 6e75  _every=False, nu
+0000de70: 6d65 7269 635f 6f6e 6c79 3d46 616c 7365  meric_only=False
+0000de80: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
+0000de90: 6178 6973 203d 2073 656c 662e 5f76 616c  axis = self._val
+0000dea0: 6964 6174 655f 6178 6973 2861 7869 7329  idate_axis(axis)
+0000deb0: 0a20 2020 2020 2020 205f 7261 6973 655f  .        _raise_
+0000dec0: 6966 5f6f 626a 6563 745f 7365 7269 6573  if_object_series
+0000ded0: 2873 656c 662c 2022 7365 6d22 290a 2020  (self, "sem").  
+0000dee0: 2020 2020 2020 6966 2061 7869 7320 3d3d        if axis ==
+0000def0: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
+0000df00: 7265 7475 726e 2073 656c 662e 6d61 705f  return self.map_
+0000df10: 7061 7274 6974 696f 6e73 280a 2020 2020  partitions(.    
+0000df20: 2020 2020 2020 2020 2020 2020 4d2e 7365              M.se
+0000df30: 6d2c 0a20 2020 2020 2020 2020 2020 2020  m,.             
+0000df40: 2020 2061 7869 733d 6178 6973 2c0a 2020     axis=axis,.  
+0000df50: 2020 2020 2020 2020 2020 2020 2020 736b                sk
+0000df60: 6970 6e61 3d73 6b69 706e 612c 0a20 2020  ipna=skipna,.   
+0000df70: 2020 2020 2020 2020 2020 2020 2064 646f               ddo
+0000df80: 663d 6464 6f66 2c0a 2020 2020 2020 2020  f=ddof,.        
+0000df90: 2020 2020 2020 2020 6e75 6d65 7269 635f          numeric_
+0000dfa0: 6f6e 6c79 3d6e 756d 6572 6963 5f6f 6e6c  only=numeric_onl
+0000dfb0: 792c 0a20 2020 2020 2020 2020 2020 2029  y,.            )
+0000dfc0: 0a20 2020 2020 2020 206d 6574 6120 3d20  .        meta = 
+0000dfd0: 7365 6c66 2e5f 6d65 7461 2e73 656d 2873  self._meta.sem(s
+0000dfe0: 6b69 706e 613d 736b 6970 6e61 2c20 6464  kipna=skipna, dd
+0000dff0: 6f66 3d64 646f 662c 206e 756d 6572 6963  of=ddof, numeric
+0000e000: 5f6f 6e6c 793d 6e75 6d65 7269 635f 6f6e  _only=numeric_on
+0000e010: 6c79 290a 2020 2020 2020 2020 6672 616d  ly).        fram
+0000e020: 6520 3d20 7365 6c66 0a20 2020 2020 2020  e = self.       
+0000e030: 2069 6620 7365 6c66 2e6e 6469 6d20 3d3d   if self.ndim ==
+0000e040: 2032 3a0a 2020 2020 2020 2020 2020 2020   2:.            
+0000e050: 6672 616d 6520 3d20 7365 6c66 5b6c 6973  frame = self[lis
+0000e060: 7428 6d65 7461 2e69 6e64 6578 295d 0a0a  t(meta.index)]..
+0000e070: 2020 2020 2020 2020 7620 3d20 6672 616d          v = fram
+0000e080: 652e 7661 7228 736b 6970 6e61 3d73 6b69  e.var(skipna=ski
+0000e090: 706e 612c 2064 646f 663d 6464 6f66 2c20  pna, ddof=ddof, 
+0000e0a0: 7370 6c69 745f 6576 6572 793d 7370 6c69  split_every=spli
+0000e0b0: 745f 6576 6572 7929 0a20 2020 2020 2020  t_every).       
+0000e0c0: 206e 203d 2066 7261 6d65 2e63 6f75 6e74   n = frame.count
+0000e0d0: 2873 706c 6974 5f65 7665 7279 3d73 706c  (split_every=spl
+0000e0e0: 6974 5f65 7665 7279 290a 2020 2020 2020  it_every).      
+0000e0f0: 2020 7265 7375 6c74 203d 206d 6170 5f70    result = map_p
+0000e100: 6172 7469 7469 6f6e 7328 0a20 2020 2020  artitions(.     
+0000e110: 2020 2020 2020 206e 702e 7371 7274 2c0a         np.sqrt,.
+0000e120: 2020 2020 2020 2020 2020 2020 7620 2f20              v / 
+0000e130: 6e2c 0a20 2020 2020 2020 2020 2020 206d  n,.            m
+0000e140: 6574 613d 6d65 7461 2c0a 2020 2020 2020  eta=meta,.      
+0000e150: 2020 2020 2020 656e 666f 7263 655f 6d65        enforce_me
+0000e160: 7461 6461 7461 3d46 616c 7365 2c0a 2020  tadata=False,.  
+0000e170: 2020 2020 2020 2020 2020 7061 7265 6e74            parent
+0000e180: 5f6d 6574 613d 7365 6c66 2e5f 6d65 7461  _meta=self._meta
+0000e190: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+0000e1a0: 2020 2020 7265 7475 726e 2072 6573 756c      return resul
+0000e1b0: 740a 0a20 2020 2064 6566 205f 7072 6570  t..    def _prep
+0000e1c0: 6172 655f 636f 765f 636f 7272 2873 656c  are_cov_corr(sel
+0000e1d0: 662c 206d 696e 5f70 6572 696f 6473 2c20  f, min_periods, 
+0000e1e0: 6e75 6d65 7269 635f 6f6e 6c79 293a 0a20  numeric_only):. 
+0000e1f0: 2020 2020 2020 2069 6620 6d69 6e5f 7065         if min_pe
+0000e200: 7269 6f64 7320 6973 204e 6f6e 653a 0a20  riods is None:. 
+0000e210: 2020 2020 2020 2020 2020 206d 696e 5f70             min_p
+0000e220: 6572 696f 6473 203d 2032 0a20 2020 2020  eriods = 2.     
+0000e230: 2020 2065 6c69 6620 6d69 6e5f 7065 7269     elif min_peri
+0000e240: 6f64 7320 3c20 323a 0a20 2020 2020 2020  ods < 2:.       
+0000e250: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+0000e260: 4572 726f 7228 226d 696e 5f70 6572 696f  Error("min_perio
+0000e270: 6473 206d 7573 7420 6265 203e 3d20 3222  ds must be >= 2"
+0000e280: 290a 0a20 2020 2020 2020 2073 656c 662e  )..        self.
+0000e290: 5f6d 6574 612e 636f 7628 6e75 6d65 7269  _meta.cov(numeri
+0000e2a0: 635f 6f6e 6c79 3d6e 756d 6572 6963 5f6f  c_only=numeric_o
+0000e2b0: 6e6c 792c 206d 696e 5f70 6572 696f 6473  nly, min_periods
+0000e2c0: 3d6d 696e 5f70 6572 696f 6473 290a 0a20  =min_periods).. 
+0000e2d0: 2020 2020 2020 2066 7261 6d65 203d 2073         frame = s
+0000e2e0: 656c 660a 2020 2020 2020 2020 6966 206e  elf.        if n
+0000e2f0: 756d 6572 6963 5f6f 6e6c 793a 0a20 2020  umeric_only:.   
+0000e300: 2020 2020 2020 2020 206e 756d 6572 6963           numeric
+0000e310: 7320 3d20 7365 6c66 2e5f 6d65 7461 2e5f  s = self._meta._
+0000e320: 6765 745f 6e75 6d65 7269 635f 6461 7461  get_numeric_data
+0000e330: 2829 0a20 2020 2020 2020 2020 2020 2069  ().            i
+0000e340: 6620 6c65 6e28 6e75 6d65 7269 6373 2e63  f len(numerics.c
+0000e350: 6f6c 756d 6e73 2920 213d 206c 656e 2873  olumns) != len(s
+0000e360: 656c 662e 636f 6c75 6d6e 7329 3a0a 2020  elf.columns):.  
+0000e370: 2020 2020 2020 2020 2020 2020 2020 6672                fr
+0000e380: 616d 6520 3d20 6672 616d 655b 6c69 7374  ame = frame[list
+0000e390: 286e 756d 6572 6963 732e 636f 6c75 6d6e  (numerics.column
+0000e3a0: 7329 5d0a 2020 2020 2020 2020 7265 7475  s)].        retu
+0000e3b0: 726e 2066 7261 6d65 2c20 6d69 6e5f 7065  rn frame, min_pe
+0000e3c0: 7269 6f64 730a 0a20 2020 2064 6566 205f  riods..    def _
+0000e3d0: 636f 7628 0a20 2020 2020 2020 2073 656c  cov(.        sel
+0000e3e0: 662c 206d 696e 5f70 6572 696f 6473 3d4e  f, min_periods=N
+0000e3f0: 6f6e 652c 206e 756d 6572 6963 5f6f 6e6c  one, numeric_onl
+0000e400: 793d 4661 6c73 652c 2073 706c 6974 5f65  y=False, split_e
+0000e410: 7665 7279 3d46 616c 7365 2c20 7363 616c  very=False, scal
+0000e420: 6172 3d46 616c 7365 0a20 2020 2029 3a0a  ar=False.    ):.
+0000e430: 2020 2020 2020 2020 6672 616d 652c 206d          frame, m
+0000e440: 696e 5f70 6572 696f 6473 203d 2073 656c  in_periods = sel
+0000e450: 662e 5f70 7265 7061 7265 5f63 6f76 5f63  f._prepare_cov_c
+0000e460: 6f72 7228 6d69 6e5f 7065 7269 6f64 732c  orr(min_periods,
+0000e470: 206e 756d 6572 6963 5f6f 6e6c 7929 0a20   numeric_only). 
+0000e480: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
+0000e490: 775f 636f 6c6c 6563 7469 6f6e 2843 6f76  w_collection(Cov
+0000e4a0: 2866 7261 6d65 2c20 6d69 6e5f 7065 7269  (frame, min_peri
+0000e4b0: 6f64 732c 2073 706c 6974 5f65 7665 7279  ods, split_every
+0000e4c0: 2c20 7363 616c 6172 2929 0a0a 2020 2020  , scalar))..    
+0000e4d0: 6465 6620 5f63 6f72 7228 0a20 2020 2020  def _corr(.     
+0000e4e0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+0000e4f0: 206d 6574 686f 643d 2270 6561 7273 6f6e   method="pearson
+0000e500: 222c 0a20 2020 2020 2020 206d 696e 5f70  ",.        min_p
+0000e510: 6572 696f 6473 3d4e 6f6e 652c 0a20 2020  eriods=None,.   
+0000e520: 2020 2020 206e 756d 6572 6963 5f6f 6e6c       numeric_onl
+0000e530: 793d 4661 6c73 652c 0a20 2020 2020 2020  y=False,.       
+0000e540: 2073 706c 6974 5f65 7665 7279 3d46 616c   split_every=Fal
+0000e550: 7365 2c0a 2020 2020 2020 2020 7363 616c  se,.        scal
+0000e560: 6172 3d46 616c 7365 2c0a 2020 2020 293a  ar=False,.    ):
+0000e570: 0a20 2020 2020 2020 2069 6620 6d65 7468  .        if meth
+0000e580: 6f64 2021 3d20 2270 6561 7273 6f6e 223a  od != "pearson":
+0000e590: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+0000e5a0: 7365 204e 6f74 496d 706c 656d 656e 7465  se NotImplemente
+0000e5b0: 6445 7272 6f72 2822 4f6e 6c79 2050 6561  dError("Only Pea
+0000e5c0: 7273 6f6e 2063 6f72 7265 6c61 7469 6f6e  rson correlation
+0000e5d0: 2068 6173 2062 6565 6e20 696d 706c 656d   has been implem
+0000e5e0: 656e 7465 6422 290a 2020 2020 2020 2020  ented").        
+0000e5f0: 6672 616d 652c 206d 696e 5f70 6572 696f  frame, min_perio
+0000e600: 6473 203d 2073 656c 662e 5f70 7265 7061  ds = self._prepa
+0000e610: 7265 5f63 6f76 5f63 6f72 7228 6d69 6e5f  re_cov_corr(min_
+0000e620: 7065 7269 6f64 732c 206e 756d 6572 6963  periods, numeric
+0000e630: 5f6f 6e6c 7929 0a20 2020 2020 2020 2072  _only).        r
+0000e640: 6574 7572 6e20 6e65 775f 636f 6c6c 6563  eturn new_collec
+0000e650: 7469 6f6e 2843 6f72 7228 6672 616d 652c  tion(Corr(frame,
+0000e660: 206d 696e 5f70 6572 696f 6473 2c20 7370   min_periods, sp
+0000e670: 6c69 745f 6576 6572 792c 2073 6361 6c61  lit_every, scala
+0000e680: 7229 290a 0a20 2020 2040 6465 7269 7665  r))..    @derive
+0000e690: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
+0000e6a0: 616d 6529 0a20 2020 2064 6566 206d 6561  ame).    def mea
+0000e6b0: 6e28 0a20 2020 2020 2020 2073 656c 662c  n(.        self,
+0000e6c0: 2061 7869 733d 302c 2073 6b69 706e 613d   axis=0, skipna=
+0000e6d0: 5472 7565 2c20 6e75 6d65 7269 635f 6f6e  True, numeric_on
+0000e6e0: 6c79 3d46 616c 7365 2c20 7370 6c69 745f  ly=False, split_
+0000e6f0: 6576 6572 793d 4661 6c73 652c 202a 2a6b  every=False, **k
+0000e700: 7761 7267 730a 2020 2020 293a 0a20 2020  wargs.    ):.   
+0000e710: 2020 2020 205f 7261 6973 655f 6966 5f6f       _raise_if_o
+0000e720: 626a 6563 745f 7365 7269 6573 2873 656c  bject_series(sel
+0000e730: 662c 2022 6d65 616e 2229 0a20 2020 2020  f, "mean").     
+0000e740: 2020 2061 7869 7320 3d20 7365 6c66 2e5f     axis = self._
+0000e750: 7661 6c69 6461 7465 5f61 7869 7328 6178  validate_axis(ax
+0000e760: 6973 290a 2020 2020 2020 2020 6966 2061  is).        if a
+0000e770: 7869 7320 3d3d 2031 3a0a 2020 2020 2020  xis == 1:.      
+0000e780: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0000e790: 662e 6d61 705f 7061 7274 6974 696f 6e73  f.map_partitions
+0000e7a0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0000e7b0: 2020 4d2e 6d65 616e 2c20 736b 6970 6e61    M.mean, skipna
+0000e7c0: 3d73 6b69 706e 612c 206e 756d 6572 6963  =skipna, numeric
+0000e7d0: 5f6f 6e6c 793d 6e75 6d65 7269 635f 6f6e  _only=numeric_on
+0000e7e0: 6c79 2c20 6178 6973 3d61 7869 730a 2020  ly, axis=axis.  
+0000e7f0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+0000e800: 2020 2020 7265 7475 726e 206e 6577 5f63      return new_c
+0000e810: 6f6c 6c65 6374 696f 6e28 0a20 2020 2020  ollection(.     
+0000e820: 2020 2020 2020 2073 656c 662e 6578 7072         self.expr
+0000e830: 2e6d 6561 6e28 736b 6970 6e61 2c20 6e75  .mean(skipna, nu
+0000e840: 6d65 7269 635f 6f6e 6c79 2c20 7370 6c69  meric_only, spli
+0000e850: 745f 6576 6572 793d 7370 6c69 745f 6576  t_every=split_ev
+0000e860: 6572 792c 2061 7869 733d 6178 6973 290a  ery, axis=axis).
+0000e870: 2020 2020 2020 2020 290a 0a20 2020 2040          )..    @
+0000e880: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
+0000e890: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
+0000e8a0: 6566 206d 6178 2873 656c 662c 2061 7869  ef max(self, axi
+0000e8b0: 733d 302c 2073 6b69 706e 613d 5472 7565  s=0, skipna=True
+0000e8c0: 2c20 6e75 6d65 7269 635f 6f6e 6c79 3d46  , numeric_only=F
+0000e8d0: 616c 7365 2c20 7370 6c69 745f 6576 6572  alse, split_ever
+0000e8e0: 793d 4661 6c73 652c 202a 2a6b 7761 7267  y=False, **kwarg
+0000e8f0: 7329 3a0a 2020 2020 2020 2020 6178 6973  s):.        axis
+0000e900: 203d 2073 656c 662e 5f76 616c 6964 6174   = self._validat
+0000e910: 655f 6178 6973 2861 7869 7329 0a20 2020  e_axis(axis).   
+0000e920: 2020 2020 2069 6620 6178 6973 203d 3d20       if axis == 
+0000e930: 313a 0a20 2020 2020 2020 2020 2020 2072  1:.            r
+0000e940: 6574 7572 6e20 7365 6c66 2e6d 6170 5f70  eturn self.map_p
+0000e950: 6172 7469 7469 6f6e 7328 0a20 2020 2020  artitions(.     
+0000e960: 2020 2020 2020 2020 2020 204d 2e6d 6178             M.max
+0000e970: 2c20 736b 6970 6e61 3d73 6b69 706e 612c  , skipna=skipna,
+0000e980: 206e 756d 6572 6963 5f6f 6e6c 793d 6e75   numeric_only=nu
+0000e990: 6d65 7269 635f 6f6e 6c79 2c20 6178 6973  meric_only, axis
+0000e9a0: 3d61 7869 730a 2020 2020 2020 2020 2020  =axis.          
+0000e9b0: 2020 290a 2020 2020 2020 2020 7265 7475    ).        retu
+0000e9c0: 726e 206e 6577 5f63 6f6c 6c65 6374 696f  rn new_collectio
+0000e9d0: 6e28 7365 6c66 2e65 7870 722e 6d61 7828  n(self.expr.max(
+0000e9e0: 736b 6970 6e61 2c20 6e75 6d65 7269 635f  skipna, numeric_
+0000e9f0: 6f6e 6c79 2c20 7370 6c69 745f 6576 6572  only, split_ever
+0000ea00: 792c 2061 7869 7329 290a 0a20 2020 2040  y, axis))..    @
 0000ea10: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
 0000ea20: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
-0000ea30: 6566 2069 6478 6d69 6e28 7365 6c66 2c20  ef idxmin(self, 
-0000ea40: 6178 6973 3d30 2c20 736b 6970 6e61 3d54  axis=0, skipna=T
-0000ea50: 7275 652c 206e 756d 6572 6963 5f6f 6e6c  rue, numeric_onl
-0000ea60: 793d 4661 6c73 652c 2073 706c 6974 5f65  y=False, split_e
-0000ea70: 7665 7279 3d46 616c 7365 293a 0a20 2020  very=False):.   
-0000ea80: 2020 2020 2061 7869 7320 3d20 7365 6c66       axis = self
-0000ea90: 2e5f 7661 6c69 6461 7465 5f61 7869 7328  ._validate_axis(
-0000eaa0: 6178 6973 290a 2020 2020 2020 2020 6966  axis).        if
-0000eab0: 2061 7869 7320 3d3d 2031 3a0a 2020 2020   axis == 1:.    
-0000eac0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0000ead0: 656c 662e 6d61 705f 7061 7274 6974 696f  elf.map_partitio
-0000eae0: 6e73 280a 2020 2020 2020 2020 2020 2020  ns(.            
-0000eaf0: 2020 2020 4d2e 6964 786d 696e 2c20 736b      M.idxmin, sk
-0000eb00: 6970 6e61 3d73 6b69 706e 612c 206e 756d  ipna=skipna, num
-0000eb10: 6572 6963 5f6f 6e6c 793d 6e75 6d65 7269  eric_only=numeri
-0000eb20: 635f 6f6e 6c79 2c20 6178 6973 3d61 7869  c_only, axis=axi
-0000eb30: 730a 2020 2020 2020 2020 2020 2020 290a  s.            ).
-0000eb40: 2020 2020 2020 2020 7265 7475 726e 206e          return n
-0000eb50: 6577 5f63 6f6c 6c65 6374 696f 6e28 7365  ew_collection(se
-0000eb60: 6c66 2e65 7870 722e 6964 786d 696e 2873  lf.expr.idxmin(s
-0000eb70: 6b69 706e 612c 206e 756d 6572 6963 5f6f  kipna, numeric_o
-0000eb80: 6e6c 792c 2073 706c 6974 5f65 7665 7279  nly, split_every
-0000eb90: 2929 0a0a 2020 2020 4064 6572 6976 6564  ))..    @derived
-0000eba0: 5f66 726f 6d28 7064 2e44 6174 6146 7261  _from(pd.DataFra
-0000ebb0: 6d65 290a 2020 2020 6465 6620 6964 786d  me).    def idxm
-0000ebc0: 6178 2873 656c 662c 2061 7869 733d 302c  ax(self, axis=0,
-0000ebd0: 2073 6b69 706e 613d 5472 7565 2c20 6e75   skipna=True, nu
-0000ebe0: 6d65 7269 635f 6f6e 6c79 3d46 616c 7365  meric_only=False
-0000ebf0: 2c20 7370 6c69 745f 6576 6572 793d 4661  , split_every=Fa
-0000ec00: 6c73 6529 3a0a 2020 2020 2020 2020 6178  lse):.        ax
-0000ec10: 6973 203d 2073 656c 662e 5f76 616c 6964  is = self._valid
-0000ec20: 6174 655f 6178 6973 2861 7869 7329 0a20  ate_axis(axis). 
-0000ec30: 2020 2020 2020 2069 6620 6178 6973 203d         if axis =
-0000ec40: 3d20 313a 0a20 2020 2020 2020 2020 2020  = 1:.           
-0000ec50: 2072 6574 7572 6e20 7365 6c66 2e6d 6170   return self.map
-0000ec60: 5f70 6172 7469 7469 6f6e 7328 0a20 2020  _partitions(.   
-0000ec70: 2020 2020 2020 2020 2020 2020 204d 2e69               M.i
-0000ec80: 6478 6d61 782c 2073 6b69 706e 613d 736b  dxmax, skipna=sk
-0000ec90: 6970 6e61 2c20 6e75 6d65 7269 635f 6f6e  ipna, numeric_on
-0000eca0: 6c79 3d6e 756d 6572 6963 5f6f 6e6c 792c  ly=numeric_only,
-0000ecb0: 2061 7869 733d 6178 6973 0a20 2020 2020   axis=axis.     
-0000ecc0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0000ecd0: 2072 6574 7572 6e20 6e65 775f 636f 6c6c   return new_coll
-0000ece0: 6563 7469 6f6e 2873 656c 662e 6578 7072  ection(self.expr
-0000ecf0: 2e69 6478 6d61 7828 736b 6970 6e61 2c20  .idxmax(skipna, 
-0000ed00: 6e75 6d65 7269 635f 6f6e 6c79 2c20 7370  numeric_only, sp
-0000ed10: 6c69 745f 6576 6572 7929 290a 0a20 2020  lit_every))..   
-0000ed20: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
-0000ed30: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
-0000ed40: 2064 6566 206d 696e 2873 656c 662c 2061   def min(self, a
-0000ed50: 7869 733d 302c 2073 6b69 706e 613d 5472  xis=0, skipna=Tr
-0000ed60: 7565 2c20 6e75 6d65 7269 635f 6f6e 6c79  ue, numeric_only
-0000ed70: 3d46 616c 7365 2c20 7370 6c69 745f 6576  =False, split_ev
-0000ed80: 6572 793d 4661 6c73 652c 202a 2a6b 7761  ery=False, **kwa
-0000ed90: 7267 7329 3a0a 2020 2020 2020 2020 6178  rgs):.        ax
-0000eda0: 6973 203d 2073 656c 662e 5f76 616c 6964  is = self._valid
-0000edb0: 6174 655f 6178 6973 2861 7869 7329 0a20  ate_axis(axis). 
-0000edc0: 2020 2020 2020 2069 6620 6178 6973 203d         if axis =
-0000edd0: 3d20 313a 0a20 2020 2020 2020 2020 2020  = 1:.           
-0000ede0: 2072 6574 7572 6e20 7365 6c66 2e6d 6170   return self.map
-0000edf0: 5f70 6172 7469 7469 6f6e 7328 0a20 2020  _partitions(.   
-0000ee00: 2020 2020 2020 2020 2020 2020 204d 2e6d               M.m
-0000ee10: 696e 2c20 736b 6970 6e61 3d73 6b69 706e  in, skipna=skipn
-0000ee20: 612c 206e 756d 6572 6963 5f6f 6e6c 793d  a, numeric_only=
-0000ee30: 6e75 6d65 7269 635f 6f6e 6c79 2c20 6178  numeric_only, ax
-0000ee40: 6973 3d61 7869 730a 2020 2020 2020 2020  is=axis.        
-0000ee50: 2020 2020 290a 2020 2020 2020 2020 7265      ).        re
-0000ee60: 7475 726e 206e 6577 5f63 6f6c 6c65 6374  turn new_collect
-0000ee70: 696f 6e28 7365 6c66 2e65 7870 722e 6d69  ion(self.expr.mi
-0000ee80: 6e28 736b 6970 6e61 2c20 6e75 6d65 7269  n(skipna, numeri
-0000ee90: 635f 6f6e 6c79 2c20 7370 6c69 745f 6576  c_only, split_ev
-0000eea0: 6572 792c 2061 7869 7329 290a 0a20 2020  ery, axis))..   
-0000eeb0: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
-0000eec0: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
-0000eed0: 2064 6566 2063 6f75 6e74 2873 656c 662c   def count(self,
-0000eee0: 2061 7869 733d 302c 206e 756d 6572 6963   axis=0, numeric
-0000eef0: 5f6f 6e6c 793d 4661 6c73 652c 2073 706c  _only=False, spl
-0000ef00: 6974 5f65 7665 7279 3d46 616c 7365 293a  it_every=False):
-0000ef10: 0a20 2020 2020 2020 2061 7869 7320 3d20  .        axis = 
-0000ef20: 7365 6c66 2e5f 7661 6c69 6461 7465 5f61  self._validate_a
-0000ef30: 7869 7328 6178 6973 290a 2020 2020 2020  xis(axis).      
-0000ef40: 2020 6966 2061 7869 7320 3d3d 2031 3a0a    if axis == 1:.
-0000ef50: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0000ef60: 726e 2073 656c 662e 6d61 705f 7061 7274  rn self.map_part
-0000ef70: 6974 696f 6e73 284d 2e63 6f75 6e74 2c20  itions(M.count, 
-0000ef80: 6e75 6d65 7269 635f 6f6e 6c79 3d6e 756d  numeric_only=num
-0000ef90: 6572 6963 5f6f 6e6c 792c 2061 7869 733d  eric_only, axis=
-0000efa0: 6178 6973 290a 2020 2020 2020 2020 7265  axis).        re
-0000efb0: 7475 726e 206e 6577 5f63 6f6c 6c65 6374  turn new_collect
-0000efc0: 696f 6e28 7365 6c66 2e65 7870 722e 636f  ion(self.expr.co
-0000efd0: 756e 7428 6e75 6d65 7269 635f 6f6e 6c79  unt(numeric_only
-0000efe0: 2c20 7370 6c69 745f 6576 6572 7929 290a  , split_every)).
-0000eff0: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
-0000f000: 6f6d 2870 642e 4461 7461 4672 616d 6529  om(pd.DataFrame)
-0000f010: 0a20 2020 2064 6566 2061 6273 2873 656c  .    def abs(sel
-0000f020: 6629 3a0a 2020 2020 2020 2020 2320 5261  f):.        # Ra
-0000f030: 6973 6520 7061 6e64 6173 2065 7272 6f72  ise pandas error
-0000f040: 730a 2020 2020 2020 2020 5f72 6169 7365  s.        _raise
-0000f050: 5f69 665f 6f62 6a65 6374 5f73 6572 6965  _if_object_serie
-0000f060: 7328 7365 6c66 2c20 2261 6273 2229 0a20  s(self, "abs"). 
-0000f070: 2020 2020 2020 206d 6574 615f 6e6f 6e65         meta_none
-0000f080: 6d70 7479 2873 656c 662e 5f6d 6574 6129  mpty(self._meta)
-0000f090: 2e61 6273 2829 0a20 2020 2020 2020 2072  .abs().        r
-0000f0a0: 6574 7572 6e20 6e65 775f 636f 6c6c 6563  eturn new_collec
-0000f0b0: 7469 6f6e 2873 656c 662e 6578 7072 2e61  tion(self.expr.a
-0000f0c0: 6273 2829 290a 0a20 2020 2040 6465 7269  bs())..    @deri
-0000f0d0: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
-0000f0e0: 4672 616d 6529 0a20 2020 2064 6566 2061  Frame).    def a
-0000f0f0: 7374 7970 6528 7365 6c66 2c20 6474 7970  stype(self, dtyp
-0000f100: 6573 293a 0a20 2020 2020 2020 2072 6574  es):.        ret
-0000f110: 7572 6e20 6e65 775f 636f 6c6c 6563 7469  urn new_collecti
-0000f120: 6f6e 2873 656c 662e 6578 7072 2e61 7374  on(self.expr.ast
-0000f130: 7970 6528 6474 7970 6573 2929 0a0a 2020  ype(dtypes))..  
-0000f140: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
-0000f150: 7064 2e44 6174 6146 7261 6d65 290a 2020  pd.DataFrame).  
-0000f160: 2020 6465 6620 636f 6d62 696e 655f 6669    def combine_fi
-0000f170: 7273 7428 7365 6c66 2c20 6f74 6865 7229  rst(self, other)
-0000f180: 3a0a 2020 2020 2020 2020 6f74 6865 7220  :.        other 
-0000f190: 3d20 7365 6c66 2e5f 6372 6561 7465 5f61  = self._create_a
-0000f1a0: 6c69 676e 6162 6c65 5f66 7261 6d65 286f  lignable_frame(o
-0000f1b0: 7468 6572 2c20 226f 7574 6572 2229 2e65  ther, "outer").e
-0000f1c0: 7870 720a 2020 2020 2020 2020 7265 7475  xpr.        retu
-0000f1d0: 726e 206e 6577 5f63 6f6c 6c65 6374 696f  rn new_collectio
-0000f1e0: 6e28 7365 6c66 2e65 7870 722e 636f 6d62  n(self.expr.comb
-0000f1f0: 696e 655f 6669 7273 7428 6f74 6865 7229  ine_first(other)
-0000f200: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
-0000f210: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
-0000f220: 6529 0a20 2020 2064 6566 2074 6f5f 7469  e).    def to_ti
-0000f230: 6d65 7374 616d 7028 7365 6c66 2c20 6672  mestamp(self, fr
-0000f240: 6571 3d4e 6f6e 652c 2068 6f77 3d22 7374  eq=None, how="st
-0000f250: 6172 7422 293a 0a20 2020 2020 2020 2072  art"):.        r
-0000f260: 6574 7572 6e20 6e65 775f 636f 6c6c 6563  eturn new_collec
-0000f270: 7469 6f6e 2873 656c 662e 6578 7072 2e74  tion(self.expr.t
-0000f280: 6f5f 7469 6d65 7374 616d 7028 6672 6571  o_timestamp(freq
-0000f290: 2c20 686f 7729 290a 0a20 2020 2040 6465  , how))..    @de
-0000f2a0: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
-0000f2b0: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
-0000f2c0: 2069 736e 6128 7365 6c66 293a 0a20 2020   isna(self):.   
-0000f2d0: 2020 2020 2072 6574 7572 6e20 6e65 775f       return new_
-0000f2e0: 636f 6c6c 6563 7469 6f6e 2873 656c 662e  collection(self.
-0000f2f0: 6578 7072 2e69 736e 6128 2929 0a0a 2020  expr.isna())..  
-0000f300: 2020 6465 6620 7261 6e64 6f6d 5f73 706c    def random_spl
-0000f310: 6974 2873 656c 662c 2066 7261 632c 2072  it(self, frac, r
-0000f320: 616e 646f 6d5f 7374 6174 653d 4e6f 6e65  andom_state=None
-0000f330: 2c20 7368 7566 666c 653d 4661 6c73 6529  , shuffle=False)
-0000f340: 3a0a 2020 2020 2020 2020 2222 2250 7365  :.        """Pse
-0000f350: 7564 6f72 616e 646f 6d6c 7920 7370 6c69  udorandomly spli
-0000f360: 7420 6461 7461 6672 616d 6520 696e 746f  t dataframe into
-0000f370: 2064 6966 6665 7265 6e74 2070 6965 6365   different piece
-0000f380: 7320 726f 772d 7769 7365 0a0a 2020 2020  s row-wise..    
-0000f390: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
-0000f3a0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-0000f3b0: 2d0a 2020 2020 2020 2020 6672 6163 203a  -.        frac :
-0000f3c0: 206c 6973 740a 2020 2020 2020 2020 2020   list.          
-0000f3d0: 2020 4c69 7374 206f 6620 666c 6f61 7473    List of floats
-0000f3e0: 2074 6861 7420 7368 6f75 6c64 2073 756d   that should sum
-0000f3f0: 2074 6f20 6f6e 652e 0a20 2020 2020 2020   to one..       
-0000f400: 2072 616e 646f 6d5f 7374 6174 6520 3a20   random_state : 
-0000f410: 696e 7420 6f72 206e 702e 7261 6e64 6f6d  int or np.random
-0000f420: 2e52 616e 646f 6d53 7461 7465 0a20 2020  .RandomState.   
-0000f430: 2020 2020 2020 2020 2049 6620 696e 7420           If int 
-0000f440: 6f72 204e 6f6e 6520 6372 6561 7465 2061  or None create a
-0000f450: 206e 6577 2052 616e 646f 6d53 7461 7465   new RandomState
-0000f460: 2077 6974 6820 7468 6973 2061 7320 7468   with this as th
-0000f470: 6520 7365 6564 2e0a 2020 2020 2020 2020  e seed..        
-0000f480: 2020 2020 4f74 6865 7277 6973 6520 6472      Otherwise dr
-0000f490: 6177 2066 726f 6d20 7468 6520 7061 7373  aw from the pass
-0000f4a0: 6564 2052 616e 646f 6d53 7461 7465 2e0a  ed RandomState..
-0000f4b0: 2020 2020 2020 2020 7368 7566 666c 6520          shuffle 
-0000f4c0: 3a20 626f 6f6c 2c20 6465 6661 756c 7420  : bool, default 
-0000f4d0: 4661 6c73 650a 2020 2020 2020 2020 2020  False.          
-0000f4e0: 2020 4966 2073 6574 2074 6f20 5472 7565    If set to True
-0000f4f0: 2c20 7468 6520 6461 7461 6672 616d 6520  , the dataframe 
-0000f500: 6973 2073 6875 6666 6c65 6420 2877 6974  is shuffled (wit
-0000f510: 6869 6e20 7061 7274 6974 696f 6e29 0a20  hin partition). 
-0000f520: 2020 2020 2020 2020 2020 2062 6566 6f72             befor
-0000f530: 6520 7468 6520 7370 6c69 742e 0a0a 2020  e the split...  
-0000f540: 2020 2020 2020 4578 616d 706c 6573 0a20        Examples. 
-0000f550: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d0a         --------.
-0000f560: 0a20 2020 2020 2020 2035 302f 3530 2073  .        50/50 s
-0000f570: 706c 6974 0a0a 2020 2020 2020 2020 3e3e  plit..        >>
-0000f580: 3e20 612c 2062 203d 2064 662e 7261 6e64  > a, b = df.rand
-0000f590: 6f6d 5f73 706c 6974 285b 302e 352c 2030  om_split([0.5, 0
-0000f5a0: 2e35 5d29 2020 2320 646f 6374 6573 743a  .5])  # doctest:
-0000f5b0: 202b 534b 4950 0a0a 2020 2020 2020 2020   +SKIP..        
-0000f5c0: 3830 2f31 302f 3130 2073 706c 6974 2c20  80/10/10 split, 
-0000f5d0: 636f 6e73 6973 7465 6e74 2072 616e 646f  consistent rando
-0000f5e0: 6d5f 7374 6174 650a 0a20 2020 2020 2020  m_state..       
-0000f5f0: 203e 3e3e 2061 2c20 622c 2063 203d 2064   >>> a, b, c = d
-0000f600: 662e 7261 6e64 6f6d 5f73 706c 6974 285b  f.random_split([
-0000f610: 302e 382c 2030 2e31 2c20 302e 315d 2c20  0.8, 0.1, 0.1], 
-0000f620: 7261 6e64 6f6d 5f73 7461 7465 3d31 3233  random_state=123
-0000f630: 2920 2023 2064 6f63 7465 7374 3a20 2b53  )  # doctest: +S
-0000f640: 4b49 500a 0a20 2020 2020 2020 2053 6565  KIP..        See
-0000f650: 2041 6c73 6f0a 2020 2020 2020 2020 2d2d   Also.        --
-0000f660: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2064  ------.        d
-0000f670: 6173 6b2e 4461 7461 4672 616d 652e 7361  ask.DataFrame.sa
-0000f680: 6d70 6c65 0a20 2020 2020 2020 2022 2222  mple.        """
-0000f690: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
-0000f6a0: 6e70 2e61 6c6c 636c 6f73 6528 7375 6d28  np.allclose(sum(
-0000f6b0: 6672 6163 292c 2031 293a 0a20 2020 2020  frac), 1):.     
-0000f6c0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-0000f6d0: 7565 4572 726f 7228 2266 7261 6320 7368  ueError("frac sh
-0000f6e0: 6f75 6c64 2073 756d 2074 6f20 3122 290a  ould sum to 1").
-0000f6f0: 2020 2020 2020 2020 6672 616d 6520 3d20          frame = 
-0000f700: 6578 7072 2e53 706c 6974 2873 656c 662c  expr.Split(self,
-0000f710: 2066 7261 632c 2072 616e 646f 6d5f 7374   frac, random_st
-0000f720: 6174 652c 2073 6875 6666 6c65 290a 0a20  ate, shuffle).. 
-0000f730: 2020 2020 2020 206f 7574 203d 205b 5d0a         out = [].
-0000f740: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
-0000f750: 2072 616e 6765 286c 656e 2866 7261 6329   range(len(frac)
-0000f760: 293a 0a20 2020 2020 2020 2020 2020 206f  ):.            o
-0000f770: 7574 2e61 7070 656e 6428 6e65 775f 636f  ut.append(new_co
-0000f780: 6c6c 6563 7469 6f6e 2865 7870 722e 5370  llection(expr.Sp
-0000f790: 6c69 7454 616b 6528 6672 616d 652c 2069  litTake(frame, i
-0000f7a0: 2c20 7365 6c66 2e6e 6469 6d29 2929 0a20  , self.ndim))). 
-0000f7b0: 2020 2020 2020 2072 6574 7572 6e20 6f75         return ou
-0000f7c0: 740a 0a20 2020 2064 6566 2069 736e 756c  t..    def isnul
-0000f7d0: 6c28 7365 6c66 293a 0a20 2020 2020 2020  l(self):.       
-0000f7e0: 2072 6574 7572 6e20 6e65 775f 636f 6c6c   return new_coll
-0000f7f0: 6563 7469 6f6e 2873 656c 662e 6578 7072  ection(self.expr
-0000f800: 2e69 736e 756c 6c28 2929 0a0a 2020 2020  .isnull())..    
-0000f810: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
-0000f820: 2e44 6174 6146 7261 6d65 290a 2020 2020  .DataFrame).    
-0000f830: 6465 6620 726f 756e 6428 7365 6c66 2c20  def round(self, 
-0000f840: 6465 6369 6d61 6c73 3d30 293a 0a20 2020  decimals=0):.   
-0000f850: 2020 2020 2072 6574 7572 6e20 6e65 775f       return new_
-0000f860: 636f 6c6c 6563 7469 6f6e 2873 656c 662e  collection(self.
-0000f870: 6578 7072 2e72 6f75 6e64 2864 6563 696d  expr.round(decim
-0000f880: 616c 7329 290a 0a20 2020 2040 6465 7269  als))..    @deri
-0000f890: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
-0000f8a0: 4672 616d 6529 0a20 2020 2064 6566 2077  Frame).    def w
-0000f8b0: 6865 7265 2873 656c 662c 2063 6f6e 642c  here(self, cond,
-0000f8c0: 206f 7468 6572 3d6e 702e 6e61 6e29 3a0a   other=np.nan):.
-0000f8d0: 2020 2020 2020 2020 636f 6e64 203d 2073          cond = s
-0000f8e0: 656c 662e 5f63 7265 6174 655f 616c 6967  elf._create_alig
-0000f8f0: 6e61 626c 655f 6672 616d 6528 636f 6e64  nable_frame(cond
-0000f900: 290a 2020 2020 2020 2020 6f74 6865 7220  ).        other 
-0000f910: 3d20 7365 6c66 2e5f 6372 6561 7465 5f61  = self._create_a
-0000f920: 6c69 676e 6162 6c65 5f66 7261 6d65 286f  lignable_frame(o
-0000f930: 7468 6572 290a 2020 2020 2020 2020 636f  ther).        co
-0000f940: 6e64 203d 2063 6f6e 642e 6578 7072 2069  nd = cond.expr i
-0000f950: 6620 6973 696e 7374 616e 6365 2863 6f6e  f isinstance(con
-0000f960: 642c 2046 7261 6d65 4261 7365 2920 656c  d, FrameBase) el
-0000f970: 7365 2063 6f6e 640a 2020 2020 2020 2020  se cond.        
-0000f980: 6f74 6865 7220 3d20 6f74 6865 722e 6578  other = other.ex
-0000f990: 7072 2069 6620 6973 696e 7374 616e 6365  pr if isinstance
-0000f9a0: 286f 7468 6572 2c20 4672 616d 6542 6173  (other, FrameBas
-0000f9b0: 6529 2065 6c73 6520 6f74 6865 720a 2020  e) else other.  
-0000f9c0: 2020 2020 2020 7265 7475 726e 206e 6577        return new
-0000f9d0: 5f63 6f6c 6c65 6374 696f 6e28 7365 6c66  _collection(self
-0000f9e0: 2e65 7870 722e 7768 6572 6528 636f 6e64  .expr.where(cond
-0000f9f0: 2c20 6f74 6865 7229 290a 0a20 2020 2040  , other))..    @
-0000fa00: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
-0000fa10: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
-0000fa20: 6566 206d 6173 6b28 7365 6c66 2c20 636f  ef mask(self, co
-0000fa30: 6e64 2c20 6f74 6865 723d 6e70 2e6e 616e  nd, other=np.nan
-0000fa40: 293a 0a20 2020 2020 2020 2063 6f6e 6420  ):.        cond 
-0000fa50: 3d20 7365 6c66 2e5f 6372 6561 7465 5f61  = self._create_a
-0000fa60: 6c69 676e 6162 6c65 5f66 7261 6d65 2863  lignable_frame(c
-0000fa70: 6f6e 6429 0a20 2020 2020 2020 206f 7468  ond).        oth
-0000fa80: 6572 203d 2073 656c 662e 5f63 7265 6174  er = self._creat
-0000fa90: 655f 616c 6967 6e61 626c 655f 6672 616d  e_alignable_fram
-0000faa0: 6528 6f74 6865 7229 0a20 2020 2020 2020  e(other).       
-0000fab0: 2063 6f6e 6420 3d20 636f 6e64 2e65 7870   cond = cond.exp
-0000fac0: 7220 6966 2069 7369 6e73 7461 6e63 6528  r if isinstance(
-0000fad0: 636f 6e64 2c20 4672 616d 6542 6173 6529  cond, FrameBase)
-0000fae0: 2065 6c73 6520 636f 6e64 0a20 2020 2020   else cond.     
-0000faf0: 2020 206f 7468 6572 203d 206f 7468 6572     other = other
-0000fb00: 2e65 7870 7220 6966 2069 7369 6e73 7461  .expr if isinsta
-0000fb10: 6e63 6528 6f74 6865 722c 2046 7261 6d65  nce(other, Frame
-0000fb20: 4261 7365 2920 656c 7365 206f 7468 6572  Base) else other
-0000fb30: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0000fb40: 6e65 775f 636f 6c6c 6563 7469 6f6e 2873  new_collection(s
-0000fb50: 656c 662e 6578 7072 2e6d 6173 6b28 636f  elf.expr.mask(co
-0000fb60: 6e64 2c20 6f74 6865 7229 290a 0a20 2020  nd, other))..   
-0000fb70: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
-0000fb80: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
-0000fb90: 2064 6566 2072 6570 6c61 6365 2873 656c   def replace(sel
-0000fba0: 662c 2074 6f5f 7265 706c 6163 653d 4e6f  f, to_replace=No
-0000fbb0: 6e65 2c20 7661 6c75 653d 6e6f 5f64 6566  ne, value=no_def
-0000fbc0: 6175 6c74 2c20 7265 6765 783d 4661 6c73  ault, regex=Fals
-0000fbd0: 6529 3a0a 2020 2020 2020 2020 7265 7475  e):.        retu
-0000fbe0: 726e 206e 6577 5f63 6f6c 6c65 6374 696f  rn new_collectio
-0000fbf0: 6e28 7365 6c66 2e65 7870 722e 7265 706c  n(self.expr.repl
-0000fc00: 6163 6528 746f 5f72 6570 6c61 6365 2c20  ace(to_replace, 
-0000fc10: 7661 6c75 652c 2072 6567 6578 2929 0a0a  value, regex))..
-0000fc20: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
-0000fc30: 6d28 7064 2e44 6174 6146 7261 6d65 290a  m(pd.DataFrame).
-0000fc40: 2020 2020 6465 6620 6666 696c 6c28 7365      def ffill(se
-0000fc50: 6c66 2c20 6178 6973 3d30 2c20 6c69 6d69  lf, axis=0, limi
-0000fc60: 743d 4e6f 6e65 293a 0a20 2020 2020 2020  t=None):.       
-0000fc70: 2061 7869 7320 3d20 5f76 616c 6964 6174   axis = _validat
-0000fc80: 655f 6178 6973 2861 7869 7329 0a20 2020  e_axis(axis).   
-0000fc90: 2020 2020 2069 6620 6178 6973 203d 3d20       if axis == 
-0000fca0: 313a 0a20 2020 2020 2020 2020 2020 2072  1:.            r
-0000fcb0: 6574 7572 6e20 7365 6c66 2e6d 6170 5f70  eturn self.map_p
-0000fcc0: 6172 7469 7469 6f6e 7328 4d2e 6666 696c  artitions(M.ffil
-0000fcd0: 6c2c 2061 7869 733d 6178 6973 2c20 6c69  l, axis=axis, li
-0000fce0: 6d69 743d 6c69 6d69 7429 0a20 2020 2020  mit=limit).     
-0000fcf0: 2020 2066 7261 6d65 203d 2073 656c 660a     frame = self.
-0000fd00: 2020 2020 2020 2020 6966 206c 696d 6974          if limit
-0000fd10: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
-0000fd20: 2020 2020 2020 6672 616d 6520 3d20 4669        frame = Fi
-0000fd30: 6c6c 6e61 4368 6563 6b28 7365 6c66 2c20  llnaCheck(self, 
-0000fd40: 2266 6669 6c6c 222c 206c 616d 6264 6120  "ffill", lambda 
-0000fd50: 783a 2030 290a 2020 2020 2020 2020 7265  x: 0).        re
-0000fd60: 7475 726e 206e 6577 5f63 6f6c 6c65 6374  turn new_collect
-0000fd70: 696f 6e28 4646 696c 6c28 6672 616d 652c  ion(FFill(frame,
-0000fd80: 206c 696d 6974 2929 0a0a 2020 2020 4064   limit))..    @d
-0000fd90: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
-0000fda0: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
-0000fdb0: 6620 6266 696c 6c28 7365 6c66 2c20 6178  f bfill(self, ax
-0000fdc0: 6973 3d30 2c20 6c69 6d69 743d 4e6f 6e65  is=0, limit=None
-0000fdd0: 293a 0a20 2020 2020 2020 2061 7869 7320  ):.        axis 
-0000fde0: 3d20 5f76 616c 6964 6174 655f 6178 6973  = _validate_axis
-0000fdf0: 2861 7869 7329 0a20 2020 2020 2020 2069  (axis).        i
-0000fe00: 6620 6178 6973 203d 3d20 313a 0a20 2020  f axis == 1:.   
-0000fe10: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0000fe20: 7365 6c66 2e6d 6170 5f70 6172 7469 7469  self.map_partiti
-0000fe30: 6f6e 7328 4d2e 6266 696c 6c2c 2061 7869  ons(M.bfill, axi
-0000fe40: 733d 6178 6973 2c20 6c69 6d69 743d 6c69  s=axis, limit=li
-0000fe50: 6d69 7429 0a20 2020 2020 2020 2066 7261  mit).        fra
-0000fe60: 6d65 203d 2073 656c 660a 2020 2020 2020  me = self.      
-0000fe70: 2020 6966 206c 696d 6974 2069 7320 4e6f    if limit is No
-0000fe80: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-0000fe90: 6672 616d 6520 3d20 4669 6c6c 6e61 4368  frame = FillnaCh
-0000fea0: 6563 6b28 7365 6c66 2c20 2262 6669 6c6c  eck(self, "bfill
-0000feb0: 222c 206c 616d 6264 6120 783a 2078 2e6e  ", lambda x: x.n
-0000fec0: 7061 7274 6974 696f 6e73 202d 2031 290a  partitions - 1).
-0000fed0: 2020 2020 2020 2020 7265 7475 726e 206e          return n
-0000fee0: 6577 5f63 6f6c 6c65 6374 696f 6e28 4246  ew_collection(BF
-0000fef0: 696c 6c28 6672 616d 652c 206c 696d 6974  ill(frame, limit
-0000ff00: 2929 0a0a 2020 2020 4064 6572 6976 6564  ))..    @derived
-0000ff10: 5f66 726f 6d28 7064 2e44 6174 6146 7261  _from(pd.DataFra
-0000ff20: 6d65 290a 2020 2020 6465 6620 6669 6c6c  me).    def fill
-0000ff30: 6e61 2873 656c 662c 2076 616c 7565 3d4e  na(self, value=N
-0000ff40: 6f6e 652c 2061 7869 733d 4e6f 6e65 293a  one, axis=None):
-0000ff50: 0a20 2020 2020 2020 2061 7869 7320 3d20  .        axis = 
-0000ff60: 7365 6c66 2e5f 7661 6c69 6461 7465 5f61  self._validate_a
-0000ff70: 7869 7328 6178 6973 290a 2020 2020 2020  xis(axis).      
-0000ff80: 2020 6966 2061 7869 7320 3d3d 2031 3a0a    if axis == 1:.
-0000ff90: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0000ffa0: 726e 2073 656c 662e 6d61 705f 7061 7274  rn self.map_part
-0000ffb0: 6974 696f 6e73 284d 2e66 696c 6c6e 612c  itions(M.fillna,
-0000ffc0: 2076 616c 7565 2c20 6178 6973 3d61 7869   value, axis=axi
-0000ffd0: 7329 0a20 2020 2020 2020 2069 6620 6973  s).        if is
-0000ffe0: 696e 7374 616e 6365 2876 616c 7565 2c20  instance(value, 
-0000fff0: 4672 616d 6542 6173 6529 3a0a 2020 2020  FrameBase):.    
-00010000: 2020 2020 2020 2020 7661 6c75 6520 3d20          value = 
-00010010: 7661 6c75 652e 6578 7072 0a20 2020 2020  value.expr.     
-00010020: 2020 2072 6574 7572 6e20 6e65 775f 636f     return new_co
-00010030: 6c6c 6563 7469 6f6e 2873 656c 662e 6578  llection(self.ex
-00010040: 7072 2e66 696c 6c6e 6128 7661 6c75 6529  pr.fillna(value)
-00010050: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
-00010060: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
-00010070: 6529 0a20 2020 2064 6566 2073 6869 6674  e).    def shift
-00010080: 2873 656c 662c 2070 6572 696f 6473 3d31  (self, periods=1
-00010090: 2c20 6672 6571 3d4e 6f6e 652c 2061 7869  , freq=None, axi
-000100a0: 733d 3029 3a0a 2020 2020 2020 2020 6966  s=0):.        if
-000100b0: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
-000100c0: 7065 7269 6f64 732c 2049 6e74 6567 7261  periods, Integra
-000100d0: 6c29 3a0a 2020 2020 2020 2020 2020 2020  l):.            
-000100e0: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
-000100f0: 2270 6572 696f 6473 206d 7573 7420 6265  "periods must be
-00010100: 2061 6e20 696e 7465 6765 7222 290a 0a20   an integer").. 
-00010110: 2020 2020 2020 2061 7869 7320 3d20 5f76         axis = _v
-00010120: 616c 6964 6174 655f 6178 6973 2861 7869  alidate_axis(axi
-00010130: 7329 0a20 2020 2020 2020 2069 6620 6178  s).        if ax
-00010140: 6973 203d 3d20 303a 0a20 2020 2020 2020  is == 0:.       
-00010150: 2020 2020 2072 6574 7572 6e20 6e65 775f       return new_
-00010160: 636f 6c6c 6563 7469 6f6e 2853 6869 6674  collection(Shift
-00010170: 2873 656c 662c 2070 6572 696f 6473 2c20  (self, periods, 
-00010180: 6672 6571 2929 0a0a 2020 2020 2020 2020  freq))..        
-00010190: 7265 7475 726e 2073 656c 662e 6d61 705f  return self.map_
-000101a0: 7061 7274 6974 696f 6e73 280a 2020 2020  partitions(.    
-000101b0: 2020 2020 2020 2020 6675 6e63 3d53 6869          func=Shi
-000101c0: 6674 2e66 756e 632c 0a20 2020 2020 2020  ft.func,.       
-000101d0: 2020 2020 2065 6e66 6f72 6365 5f6d 6574       enforce_met
-000101e0: 6164 6174 613d 4661 6c73 652c 0a20 2020  adata=False,.   
-000101f0: 2020 2020 2020 2020 2074 7261 6e73 666f           transfo
-00010200: 726d 5f64 6976 6973 696f 6e73 3d46 616c  rm_divisions=Fal
-00010210: 7365 2c0a 2020 2020 2020 2020 2020 2020  se,.            
-00010220: 7065 7269 6f64 733d 7065 7269 6f64 732c  periods=periods,
-00010230: 0a20 2020 2020 2020 2020 2020 2061 7869  .            axi
-00010240: 733d 6178 6973 2c0a 2020 2020 2020 2020  s=axis,.        
-00010250: 2020 2020 6672 6571 3d66 7265 712c 0a20      freq=freq,. 
-00010260: 2020 2020 2020 2029 0a0a 2020 2020 4064         )..    @d
-00010270: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
-00010280: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
-00010290: 6620 6469 6666 2873 656c 662c 2070 6572  f diff(self, per
-000102a0: 696f 6473 3d31 2c20 6178 6973 3d30 293a  iods=1, axis=0):
-000102b0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-000102c0: 2020 2020 202e 2e20 6e6f 7465 3a3a 0a0a       .. note::..
-000102d0: 2020 2020 2020 2020 2020 2050 616e 6461             Panda
-000102e0: 7320 6375 7272 656e 746c 7920 7573 6573  s currently uses
-000102f0: 2061 6e20 6060 6f62 6a65 6374 6060 2d64   an ``object``-d
-00010300: 7479 7065 2063 6f6c 756d 6e20 746f 2072  type column to r
-00010310: 6570 7265 7365 6e74 0a20 2020 2020 2020  epresent.       
-00010320: 2020 2020 626f 6f6c 6561 6e20 6461 7461      boolean data
-00010330: 2077 6974 6820 6d69 7373 696e 6720 7661   with missing va
-00010340: 6c75 6573 2e20 5468 6973 2063 616e 2063  lues. This can c
-00010350: 6175 7365 2069 7373 7565 7320 666f 720a  ause issues for.
-00010360: 2020 2020 2020 2020 2020 2062 6f6f 6c65             boole
-00010370: 616e 2d73 7065 6369 6669 6320 6f70 6572  an-specific oper
-00010380: 6174 696f 6e73 2c20 6c69 6b65 2060 607c  ations, like ``|
-00010390: 6060 2e20 546f 2065 6e61 626c 6520 626f  ``. To enable bo
-000103a0: 6f6c 6561 6e2d 0a20 2020 2020 2020 2020  olean-.         
-000103b0: 2020 7370 6563 6966 6963 206f 7065 7261    specific opera
-000103c0: 7469 6f6e 732c 2061 7420 7468 6520 636f  tions, at the co
-000103d0: 7374 206f 6620 6d65 7461 6461 7461 2074  st of metadata t
-000103e0: 6861 7420 646f 6573 6e27 7420 6d61 7463  hat doesn't matc
-000103f0: 680a 2020 2020 2020 2020 2020 2070 616e  h.           pan
-00010400: 6461 732c 2075 7365 2060 602e 6173 7479  das, use ``.asty
-00010410: 7065 2862 6f6f 6c29 6060 2061 6674 6572  pe(bool)`` after
-00010420: 2074 6865 2060 6073 6869 6674 6060 2e0a   the ``shift``..
-00010430: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00010440: 2020 2020 6178 6973 203d 205f 7661 6c69      axis = _vali
-00010450: 6461 7465 5f61 7869 7328 6178 6973 290a  date_axis(axis).
-00010460: 2020 2020 2020 2020 6966 2061 7869 7320          if axis 
-00010470: 3d3d 2030 3a0a 2020 2020 2020 2020 2020  == 0:.          
-00010480: 2020 7265 7475 726e 206e 6577 5f63 6f6c    return new_col
-00010490: 6c65 6374 696f 6e28 4469 6666 2873 656c  lection(Diff(sel
-000104a0: 662c 2070 6572 696f 6473 2929 0a20 2020  f, periods)).   
-000104b0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-000104c0: 2e6d 6170 5f70 6172 7469 7469 6f6e 7328  .map_partitions(
-000104d0: 0a20 2020 2020 2020 2020 2020 2066 756e  .            fun
-000104e0: 633d 4469 6666 2e66 756e 632c 0a20 2020  c=Diff.func,.   
-000104f0: 2020 2020 2020 2020 2065 6e66 6f72 6365           enforce
-00010500: 5f6d 6574 6164 6174 613d 4661 6c73 652c  _metadata=False,
-00010510: 0a20 2020 2020 2020 2020 2020 2074 7261  .            tra
-00010520: 6e73 666f 726d 5f64 6976 6973 696f 6e73  nsform_divisions
-00010530: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
-00010540: 2020 2020 636c 6561 725f 6469 7669 7369      clear_divisi
-00010550: 6f6e 733d 4661 6c73 652c 0a20 2020 2020  ons=False,.     
-00010560: 2020 2020 2020 2070 6572 696f 6473 3d70         periods=p
-00010570: 6572 696f 6473 2c0a 2020 2020 2020 2020  eriods,.        
-00010580: 2020 2020 6178 6973 3d61 7869 732c 0a20      axis=axis,. 
-00010590: 2020 2020 2020 2029 0a0a 2020 2020 4064         )..    @d
-000105a0: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
-000105b0: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
-000105c0: 6620 7265 6e61 6d65 5f61 7869 7328 0a20  f rename_axis(. 
-000105d0: 2020 2020 2020 2073 656c 662c 206d 6170         self, map
-000105e0: 7065 723d 6e6f 5f64 6566 6175 6c74 2c20  per=no_default, 
-000105f0: 696e 6465 783d 6e6f 5f64 6566 6175 6c74  index=no_default
-00010600: 2c20 636f 6c75 6d6e 733d 6e6f 5f64 6566  , columns=no_def
-00010610: 6175 6c74 2c20 6178 6973 3d30 0a20 2020  ault, axis=0.   
-00010620: 2029 3a0a 2020 2020 2020 2020 7265 7475   ):.        retu
-00010630: 726e 206e 6577 5f63 6f6c 6c65 6374 696f  rn new_collectio
-00010640: 6e28 7365 6c66 2e65 7870 722e 7265 6e61  n(self.expr.rena
-00010650: 6d65 5f61 7869 7328 6d61 7070 6572 2c20  me_axis(mapper, 
-00010660: 696e 6465 782c 2063 6f6c 756d 6e73 2c20  index, columns, 
-00010670: 6178 6973 2929 0a0a 2020 2020 6465 6620  axis))..    def 
-00010680: 5f63 7265 6174 655f 616c 6967 6e61 626c  _create_alignabl
-00010690: 655f 6672 616d 6528 7365 6c66 2c20 6f74  e_frame(self, ot
-000106a0: 6865 722c 206a 6f69 6e3d 226f 7574 6572  her, join="outer
-000106b0: 2229 3a0a 2020 2020 2020 2020 6966 206e  "):.        if n
-000106c0: 6f74 2069 735f 6461 736b 5f63 6f6c 6c65  ot is_dask_colle
-000106d0: 6374 696f 6e28 6f74 6865 7229 2061 6e64  ction(other) and
-000106e0: 2028 0a20 2020 2020 2020 2020 2020 2069   (.            i
-000106f0: 735f 7365 7269 6573 5f6c 696b 6528 6f74  s_series_like(ot
-00010700: 6865 7229 206f 7220 6973 5f64 6174 6166  her) or is_dataf
-00010710: 7261 6d65 5f6c 696b 6528 6f74 6865 7229  rame_like(other)
-00010720: 0a20 2020 2020 2020 2029 3a0a 2020 2020  .        ):.    
-00010730: 2020 2020 2020 2020 6966 206a 6f69 6e20          if join 
-00010740: 696e 2028 2269 6e6e 6572 222c 2022 6c65  in ("inner", "le
-00010750: 6674 2229 3a0a 2020 2020 2020 2020 2020  ft"):.          
-00010760: 2020 2020 2020 6e70 6172 7469 7469 6f6e        npartition
-00010770: 7320 3d20 310a 2020 2020 2020 2020 2020  s = 1.          
-00010780: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00010790: 2020 2020 2020 2020 2320 5765 2068 6176          # We hav
-000107a0: 6520 746f 2074 7269 6767 6572 2061 6c69  e to trigger ali
-000107b0: 676e 6d65 6e74 2c20 6f74 6865 7277 6973  gnment, otherwis
-000107c0: 6520 7061 6e64 6173 2077 696c 6c20 6164  e pandas will ad
-000107d0: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
-000107e0: 2020 2320 7468 6520 7361 6d65 2076 616c    # the same val
-000107f0: 7565 7320 746f 2065 7665 7279 2070 6172  ues to every par
-00010800: 7469 7469 6f6e 0a20 2020 2020 2020 2020  tition.         
-00010810: 2020 2020 2020 206e 7061 7274 6974 696f         npartitio
-00010820: 6e73 203d 2032 0a20 2020 2020 2020 2020  ns = 2.         
-00010830: 2020 206f 7468 6572 203d 2066 726f 6d5f     other = from_
-00010840: 7061 6e64 6173 286f 7468 6572 2c20 6e70  pandas(other, np
-00010850: 6172 7469 7469 6f6e 733d 6e70 6172 7469  artitions=nparti
-00010860: 7469 6f6e 7329 0a20 2020 2020 2020 2072  tions).        r
-00010870: 6574 7572 6e20 6f74 6865 720a 0a20 2020  eturn other..   
-00010880: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
-00010890: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
-000108a0: 2064 6566 2061 6c69 676e 2873 656c 662c   def align(self,
-000108b0: 206f 7468 6572 2c20 6a6f 696e 3d22 6f75   other, join="ou
-000108c0: 7465 7222 2c20 6178 6973 3d4e 6f6e 652c  ter", axis=None,
-000108d0: 2066 696c 6c5f 7661 6c75 653d 4e6f 6e65   fill_value=None
-000108e0: 293a 0a20 2020 2020 2020 206f 7468 6572  ):.        other
-000108f0: 203d 2073 656c 662e 5f63 7265 6174 655f   = self._create_
-00010900: 616c 6967 6e61 626c 655f 6672 616d 6528  alignable_frame(
-00010910: 6f74 6865 722c 206a 6f69 6e29 0a20 2020  other, join).   
-00010920: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00010930: 2e65 7870 722e 616c 6967 6e28 6f74 6865  .expr.align(othe
-00010940: 722e 6578 7072 2c20 6a6f 696e 2c20 6178  r.expr, join, ax
-00010950: 6973 2c20 6669 6c6c 5f76 616c 7565 290a  is, fill_value).
-00010960: 0a20 2020 2064 6566 206e 756e 6971 7565  .    def nunique
-00010970: 5f61 7070 726f 7828 7365 6c66 2c20 7370  _approx(self, sp
-00010980: 6c69 745f 6576 6572 793d 4e6f 6e65 293a  lit_every=None):
-00010990: 0a20 2020 2020 2020 2022 2222 4170 7072  .        """Appr
-000109a0: 6f78 696d 6174 6520 6e75 6d62 6572 206f  oximate number o
-000109b0: 6620 756e 6971 7565 2072 6f77 732e 0a0a  f unique rows...
-000109c0: 2020 2020 2020 2020 5468 6973 206d 6574          This met
-000109d0: 686f 6420 7573 6573 2074 6865 2048 7970  hod uses the Hyp
-000109e0: 6572 4c6f 674c 6f67 2061 6c67 6f72 6974  erLogLog algorit
-000109f0: 686d 2066 6f72 2063 6172 6469 6e61 6c69  hm for cardinali
-00010a00: 7479 0a20 2020 2020 2020 2065 7374 696d  ty.        estim
-00010a10: 6174 696f 6e20 746f 2063 6f6d 7075 7465  ation to compute
-00010a20: 2074 6865 2061 7070 726f 7869 6d61 7465   the approximate
-00010a30: 206e 756d 6265 7220 6f66 2075 6e69 7175   number of uniqu
-00010a40: 6520 726f 7773 2e0a 2020 2020 2020 2020  e rows..        
-00010a50: 5468 6520 6170 7072 6f78 696d 6174 6520  The approximate 
-00010a60: 6572 726f 7220 6973 2030 2e34 3036 252e  error is 0.406%.
-00010a70: 0a0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-00010a80: 7465 7273 0a20 2020 2020 2020 202d 2d2d  ters.        ---
-00010a90: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00010aa0: 7370 6c69 745f 6576 6572 7920 3a20 696e  split_every : in
-00010ab0: 742c 206f 7074 696f 6e61 6c0a 2020 2020  t, optional.    
-00010ac0: 2020 2020 2020 2020 4772 6f75 7020 7061          Group pa
-00010ad0: 7274 6974 696f 6e73 2069 6e74 6f20 6772  rtitions into gr
-00010ae0: 6f75 7073 206f 6620 7468 6973 2073 697a  oups of this siz
-00010af0: 6520 7768 696c 6520 7065 7266 6f72 6d69  e while performi
-00010b00: 6e67 2061 0a20 2020 2020 2020 2020 2020  ng a.           
-00010b10: 2074 7265 652d 7265 6475 6374 696f 6e2e   tree-reduction.
-00010b20: 2049 6620 7365 7420 746f 2046 616c 7365   If set to False
-00010b30: 2c20 6e6f 2074 7265 652d 7265 6475 6374  , no tree-reduct
-00010b40: 696f 6e20 7769 6c6c 2062 6520 7573 6564  ion will be used
-00010b50: 2e0a 2020 2020 2020 2020 2020 2020 4465  ..            De
-00010b60: 6661 756c 7420 6973 2038 2e0a 0a20 2020  fault is 8...   
-00010b70: 2020 2020 2052 6574 7572 6e73 0a20 2020       Returns.   
-00010b80: 2020 2020 202d 2d2d 2d2d 2d2d 0a20 2020       -------.   
-00010b90: 2020 2020 2061 2066 6c6f 6174 2072 6570       a float rep
-00010ba0: 7265 7365 6e74 696e 6720 7468 6520 6170  resenting the ap
-00010bb0: 7072 6f78 696d 6174 6520 6e75 6d62 6572  proximate number
-00010bc0: 206f 6620 656c 656d 656e 7473 0a20 2020   of elements.   
-00010bd0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00010be0: 2072 6574 7572 6e20 6e65 775f 636f 6c6c   return new_coll
-00010bf0: 6563 7469 6f6e 2873 656c 662e 6578 7072  ection(self.expr
-00010c00: 2e6e 756e 6971 7565 5f61 7070 726f 7828  .nunique_approx(
-00010c10: 7370 6c69 745f 6576 6572 793d 7370 6c69  split_every=spli
-00010c20: 745f 6576 6572 7929 290a 0a20 2020 2040  t_every))..    @
-00010c30: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
-00010c40: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
-00010c50: 6566 2063 756d 7375 6d28 7365 6c66 2c20  ef cumsum(self, 
-00010c60: 6178 6973 3d30 2c20 736b 6970 6e61 3d54  axis=0, skipna=T
-00010c70: 7275 652c 202a 2a6b 7761 7267 7329 3a0a  rue, **kwargs):.
-00010c80: 2020 2020 2020 2020 6966 2061 7869 7320          if axis 
-00010c90: 3d3d 2031 3a0a 2020 2020 2020 2020 2020  == 1:.          
-00010ca0: 2020 7265 7475 726e 2073 656c 662e 6d61    return self.ma
-00010cb0: 705f 7061 7274 6974 696f 6e73 284d 2e63  p_partitions(M.c
-00010cc0: 756d 7375 6d2c 2061 7869 733d 6178 6973  umsum, axis=axis
-00010cd0: 2c20 736b 6970 6e61 3d73 6b69 706e 6129  , skipna=skipna)
-00010ce0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00010cf0: 6e65 775f 636f 6c6c 6563 7469 6f6e 2873  new_collection(s
-00010d00: 656c 662e 6578 7072 2e63 756d 7375 6d28  elf.expr.cumsum(
-00010d10: 736b 6970 6e61 3d73 6b69 706e 6129 290a  skipna=skipna)).
-00010d20: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
-00010d30: 6f6d 2870 642e 4461 7461 4672 616d 6529  om(pd.DataFrame)
-00010d40: 0a20 2020 2064 6566 2063 756d 7072 6f64  .    def cumprod
-00010d50: 2873 656c 662c 2061 7869 733d 302c 2073  (self, axis=0, s
-00010d60: 6b69 706e 613d 5472 7565 2c20 2a2a 6b77  kipna=True, **kw
-00010d70: 6172 6773 293a 0a20 2020 2020 2020 2069  args):.        i
-00010d80: 6620 6178 6973 203d 3d20 313a 0a20 2020  f axis == 1:.   
-00010d90: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00010da0: 7365 6c66 2e6d 6170 5f70 6172 7469 7469  self.map_partiti
-00010db0: 6f6e 7328 4d2e 6375 6d70 726f 642c 2061  ons(M.cumprod, a
-00010dc0: 7869 733d 6178 6973 2c20 736b 6970 6e61  xis=axis, skipna
-00010dd0: 3d73 6b69 706e 6129 0a20 2020 2020 2020  =skipna).       
-00010de0: 2072 6574 7572 6e20 6e65 775f 636f 6c6c   return new_coll
-00010df0: 6563 7469 6f6e 2873 656c 662e 6578 7072  ection(self.expr
-00010e00: 2e63 756d 7072 6f64 2873 6b69 706e 613d  .cumprod(skipna=
-00010e10: 736b 6970 6e61 2929 0a0a 2020 2020 4064  skipna))..    @d
-00010e20: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
-00010e30: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
-00010e40: 6620 6375 6d6d 6178 2873 656c 662c 2061  f cummax(self, a
-00010e50: 7869 733d 302c 2073 6b69 706e 613d 5472  xis=0, skipna=Tr
-00010e60: 7565 293a 0a20 2020 2020 2020 2069 6620  ue):.        if 
-00010e70: 6178 6973 203d 3d20 313a 0a20 2020 2020  axis == 1:.     
-00010e80: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00010e90: 6c66 2e6d 6170 5f70 6172 7469 7469 6f6e  lf.map_partition
-00010ea0: 7328 4d2e 6375 6d6d 6178 2c20 6178 6973  s(M.cummax, axis
-00010eb0: 3d61 7869 732c 2073 6b69 706e 613d 736b  =axis, skipna=sk
-00010ec0: 6970 6e61 290a 2020 2020 2020 2020 7265  ipna).        re
-00010ed0: 7475 726e 206e 6577 5f63 6f6c 6c65 6374  turn new_collect
-00010ee0: 696f 6e28 7365 6c66 2e65 7870 722e 6375  ion(self.expr.cu
-00010ef0: 6d6d 6178 2873 6b69 706e 613d 736b 6970  mmax(skipna=skip
-00010f00: 6e61 2929 0a0a 2020 2020 4064 6572 6976  na))..    @deriv
-00010f10: 6564 5f66 726f 6d28 7064 2e44 6174 6146  ed_from(pd.DataF
-00010f20: 7261 6d65 290a 2020 2020 6465 6620 6375  rame).    def cu
-00010f30: 6d6d 696e 2873 656c 662c 2061 7869 733d  mmin(self, axis=
-00010f40: 302c 2073 6b69 706e 613d 5472 7565 293a  0, skipna=True):
-00010f50: 0a20 2020 2020 2020 2069 6620 6178 6973  .        if axis
-00010f60: 203d 3d20 313a 0a20 2020 2020 2020 2020   == 1:.         
-00010f70: 2020 2072 6574 7572 6e20 7365 6c66 2e6d     return self.m
-00010f80: 6170 5f70 6172 7469 7469 6f6e 7328 4d2e  ap_partitions(M.
-00010f90: 6375 6d6d 696e 2c20 6178 6973 3d61 7869  cummin, axis=axi
-00010fa0: 732c 2073 6b69 706e 613d 736b 6970 6e61  s, skipna=skipna
-00010fb0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-00010fc0: 206e 6577 5f63 6f6c 6c65 6374 696f 6e28   new_collection(
-00010fd0: 7365 6c66 2e65 7870 722e 6375 6d6d 696e  self.expr.cummin
-00010fe0: 2873 6b69 706e 613d 736b 6970 6e61 2929  (skipna=skipna))
-00010ff0: 0a0a 2020 2020 6465 6620 7265 6475 6374  ..    def reduct
-00011000: 696f 6e28 0a20 2020 2020 2020 2073 656c  ion(.        sel
-00011010: 662c 0a20 2020 2020 2020 2063 6875 6e6b  f,.        chunk
-00011020: 2c0a 2020 2020 2020 2020 6167 6772 6567  ,.        aggreg
-00011030: 6174 653d 4e6f 6e65 2c0a 2020 2020 2020  ate=None,.      
-00011040: 2020 636f 6d62 696e 653d 4e6f 6e65 2c0a    combine=None,.
-00011050: 2020 2020 2020 2020 6d65 7461 3d6e 6f5f          meta=no_
-00011060: 6465 6661 756c 742c 0a20 2020 2020 2020  default,.       
-00011070: 2074 6f6b 656e 3d4e 6f6e 652c 0a20 2020   token=None,.   
-00011080: 2020 2020 2073 706c 6974 5f65 7665 7279       split_every
-00011090: 3d4e 6f6e 652c 0a20 2020 2020 2020 2063  =None,.        c
-000110a0: 6875 6e6b 5f6b 7761 7267 733d 4e6f 6e65  hunk_kwargs=None
-000110b0: 2c0a 2020 2020 2020 2020 6167 6772 6567  ,.        aggreg
-000110c0: 6174 655f 6b77 6172 6773 3d4e 6f6e 652c  ate_kwargs=None,
-000110d0: 0a20 2020 2020 2020 2063 6f6d 6269 6e65  .        combine
-000110e0: 5f6b 7761 7267 733d 4e6f 6e65 2c0a 2020  _kwargs=None,.  
-000110f0: 2020 2020 2020 2a2a 6b77 6172 6773 2c0a        **kwargs,.
-00011100: 2020 2020 293a 0a20 2020 2020 2020 2022      ):.        "
-00011110: 2222 4765 6e65 7269 6320 726f 772d 7769  ""Generic row-wi
-00011120: 7365 2072 6564 7563 7469 6f6e 732e 0a0a  se reductions...
-00011130: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
-00011140: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
-00011150: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6368  -----.        ch
-00011160: 756e 6b20 3a20 6361 6c6c 6162 6c65 0a20  unk : callable. 
-00011170: 2020 2020 2020 2020 2020 2046 756e 6374             Funct
-00011180: 696f 6e20 746f 206f 7065 7261 7465 206f  ion to operate o
-00011190: 6e20 6561 6368 2070 6172 7469 7469 6f6e  n each partition
-000111a0: 2e20 5368 6f75 6c64 2072 6574 7572 6e20  . Should return 
-000111b0: 610a 2020 2020 2020 2020 2020 2020 6060  a.            ``
-000111c0: 7061 6e64 6173 2e44 6174 6146 7261 6d65  pandas.DataFrame
-000111d0: 6060 2c20 6060 7061 6e64 6173 2e53 6572  ``, ``pandas.Ser
-000111e0: 6965 7360 602c 206f 7220 6120 7363 616c  ies``, or a scal
-000111f0: 6172 2e0a 2020 2020 2020 2020 6167 6772  ar..        aggr
-00011200: 6567 6174 6520 3a20 6361 6c6c 6162 6c65  egate : callable
-00011210: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
-00011220: 2020 2020 2020 2046 756e 6374 696f 6e20         Function 
-00011230: 746f 206f 7065 7261 7465 206f 6e20 7468  to operate on th
-00011240: 6520 636f 6e63 6174 656e 6174 6564 2072  e concatenated r
-00011250: 6573 756c 7420 6f66 2060 6063 6875 6e6b  esult of ``chunk
-00011260: 6060 2e20 4966 206e 6f74 0a20 2020 2020  ``. If not.     
-00011270: 2020 2020 2020 2073 7065 6369 6669 6564         specified
-00011280: 2c20 6465 6661 756c 7473 2074 6f20 6060  , defaults to ``
-00011290: 6368 756e 6b60 602e 2055 7365 6420 746f  chunk``. Used to
-000112a0: 2064 6f20 7468 6520 6669 6e61 6c20 6167   do the final ag
-000112b0: 6772 6567 6174 696f 6e0a 2020 2020 2020  gregation.      
-000112c0: 2020 2020 2020 696e 2061 2074 7265 6520        in a tree 
-000112d0: 7265 6475 6374 696f 6e2e 0a0a 2020 2020  reduction...    
-000112e0: 2020 2020 2020 2020 5468 6520 696e 7075          The inpu
-000112f0: 7420 746f 2060 6061 6767 7265 6761 7465  t to ``aggregate
-00011300: 6060 2064 6570 656e 6473 206f 6e20 7468  `` depends on th
-00011310: 6520 6f75 7470 7574 206f 6620 6060 6368  e output of ``ch
-00011320: 756e 6b60 602e 0a20 2020 2020 2020 2020  unk``..         
-00011330: 2020 2049 6620 7468 6520 6f75 7470 7574     If the output
-00011340: 206f 6620 6060 6368 756e 6b60 6020 6973   of ``chunk`` is
-00011350: 2061 3a0a 0a20 2020 2020 2020 2020 2020   a:..           
-00011360: 202d 2073 6361 6c61 723a 2049 6e70 7574   - scalar: Input
-00011370: 2069 7320 6120 5365 7269 6573 2c20 7769   is a Series, wi
-00011380: 7468 206f 6e65 2072 6f77 2070 6572 2070  th one row per p
-00011390: 6172 7469 7469 6f6e 2e0a 2020 2020 2020  artition..      
-000113a0: 2020 2020 2020 2d20 5365 7269 6573 3a20        - Series: 
-000113b0: 496e 7075 7420 6973 2061 2044 6174 6146  Input is a DataF
-000113c0: 7261 6d65 2c20 7769 7468 206f 6e65 2072  rame, with one r
-000113d0: 6f77 2070 6572 2070 6172 7469 7469 6f6e  ow per partition
-000113e0: 2e20 436f 6c75 6d6e 730a 2020 2020 2020  . Columns.      
-000113f0: 2020 2020 2020 2020 6172 6520 7468 6520          are the 
-00011400: 726f 7773 2069 6e20 7468 6520 6f75 7470  rows in the outp
-00011410: 7574 2073 6572 6965 732e 0a20 2020 2020  ut series..     
-00011420: 2020 2020 2020 202d 2044 6174 6146 7261         - DataFra
-00011430: 6d65 3a20 496e 7075 7420 6973 2061 2044  me: Input is a D
-00011440: 6174 6146 7261 6d65 2c20 7769 7468 206f  ataFrame, with o
-00011450: 6e65 2072 6f77 2070 6572 2070 6172 7469  ne row per parti
-00011460: 7469 6f6e 2e0a 2020 2020 2020 2020 2020  tion..          
-00011470: 2020 2020 436f 6c75 6d6e 7320 6172 6520      Columns are 
-00011480: 7468 6520 636f 6c75 6d6e 7320 696e 2074  the columns in t
-00011490: 6865 206f 7574 7075 7420 6461 7461 6672  he output datafr
-000114a0: 616d 6573 2e0a 0a20 2020 2020 2020 2020  ames...         
-000114b0: 2020 2053 686f 756c 6420 7265 7475 726e     Should return
-000114c0: 2061 2060 6070 616e 6461 732e 4461 7461   a ``pandas.Data
-000114d0: 4672 616d 6560 602c 2060 6070 616e 6461  Frame``, ``panda
-000114e0: 732e 5365 7269 6573 6060 2c20 6f72 2061  s.Series``, or a
-000114f0: 0a20 2020 2020 2020 2020 2020 2073 6361  .            sca
-00011500: 6c61 722e 0a20 2020 2020 2020 2063 6f6d  lar..        com
-00011510: 6269 6e65 203a 2063 616c 6c61 626c 652c  bine : callable,
-00011520: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-00011530: 2020 2020 2020 4675 6e63 7469 6f6e 2074        Function t
-00011540: 6f20 6f70 6572 6174 6520 6f6e 2069 6e74  o operate on int
-00011550: 6572 6d65 6469 6174 6520 636f 6e63 6174  ermediate concat
-00011560: 656e 6174 6564 2072 6573 756c 7473 206f  enated results o
-00011570: 660a 2020 2020 2020 2020 2020 2020 6060  f.            ``
-00011580: 6368 756e 6b60 6020 696e 2061 2074 7265  chunk`` in a tre
-00011590: 652d 7265 6475 6374 696f 6e2e 2049 6620  e-reduction. If 
-000115a0: 6e6f 7420 7072 6f76 6964 6564 2c20 6465  not provided, de
-000115b0: 6661 756c 7473 2074 6f0a 2020 2020 2020  faults to.      
-000115c0: 2020 2020 2020 6060 6167 6772 6567 6174        ``aggregat
-000115d0: 6560 602e 2054 6865 2069 6e70 7574 2f6f  e``. The input/o
-000115e0: 7574 7075 7420 7265 7175 6972 656d 656e  utput requiremen
-000115f0: 7473 2073 686f 756c 6420 6d61 7463 6820  ts should match 
-00011600: 7468 6174 206f 660a 2020 2020 2020 2020  that of.        
-00011610: 2020 2020 6060 6167 6772 6567 6174 6560      ``aggregate`
-00011620: 6020 6465 7363 7269 6265 6420 6162 6f76  ` described abov
-00011630: 652e 0a20 2020 2020 2020 2024 4d45 5441  e..        $META
-00011640: 0a20 2020 2020 2020 2074 6f6b 656e 203a  .        token :
-00011650: 2073 7472 2c20 6f70 7469 6f6e 616c 0a20   str, optional. 
-00011660: 2020 2020 2020 2020 2020 2054 6865 206e             The n
-00011670: 616d 6520 746f 2075 7365 2066 6f72 2074  ame to use for t
-00011680: 6865 206f 7574 7075 7420 6b65 7973 2e0a  he output keys..
-00011690: 2020 2020 2020 2020 7370 6c69 745f 6576          split_ev
-000116a0: 6572 7920 3a20 696e 742c 206f 7074 696f  ery : int, optio
-000116b0: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
-000116c0: 4772 6f75 7020 7061 7274 6974 696f 6e73  Group partitions
-000116d0: 2069 6e74 6f20 6772 6f75 7073 206f 6620   into groups of 
-000116e0: 7468 6973 2073 697a 6520 7768 696c 6520  this size while 
-000116f0: 7065 7266 6f72 6d69 6e67 2061 0a20 2020  performing a.   
-00011700: 2020 2020 2020 2020 2074 7265 652d 7265           tree-re
-00011710: 6475 6374 696f 6e2e 2049 6620 7365 7420  duction. If set 
-00011720: 746f 2046 616c 7365 2c20 6e6f 2074 7265  to False, no tre
-00011730: 652d 7265 6475 6374 696f 6e20 7769 6c6c  e-reduction will
-00011740: 2062 6520 7573 6564 2c0a 2020 2020 2020   be used,.      
-00011750: 2020 2020 2020 616e 6420 616c 6c20 696e        and all in
-00011760: 7465 726d 6564 6961 7465 7320 7769 6c6c  termediates will
-00011770: 2062 6520 636f 6e63 6174 656e 6174 6564   be concatenated
-00011780: 2061 6e64 2070 6173 7365 6420 746f 0a20   and passed to. 
-00011790: 2020 2020 2020 2020 2020 2060 6061 6767             ``agg
-000117a0: 7265 6761 7465 6060 2e20 4465 6661 756c  regate``. Defaul
-000117b0: 7420 6973 2038 2e0a 2020 2020 2020 2020  t is 8..        
-000117c0: 6368 756e 6b5f 6b77 6172 6773 203a 2064  chunk_kwargs : d
-000117d0: 6963 742c 206f 7074 696f 6e61 6c0a 2020  ict, optional.  
-000117e0: 2020 2020 2020 2020 2020 4b65 7977 6f72            Keywor
-000117f0: 6420 6172 6775 6d65 6e74 7320 746f 2070  d arguments to p
-00011800: 6173 7320 6f6e 2074 6f20 6060 6368 756e  ass on to ``chun
-00011810: 6b60 6020 6f6e 6c79 2e0a 2020 2020 2020  k`` only..      
-00011820: 2020 6167 6772 6567 6174 655f 6b77 6172    aggregate_kwar
-00011830: 6773 203a 2064 6963 742c 206f 7074 696f  gs : dict, optio
-00011840: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
-00011850: 4b65 7977 6f72 6420 6172 6775 6d65 6e74  Keyword argument
-00011860: 7320 746f 2070 6173 7320 6f6e 2074 6f20  s to pass on to 
-00011870: 6060 6167 6772 6567 6174 6560 6020 6f6e  ``aggregate`` on
-00011880: 6c79 2e0a 2020 2020 2020 2020 636f 6d62  ly..        comb
-00011890: 696e 655f 6b77 6172 6773 203a 2064 6963  ine_kwargs : dic
-000118a0: 742c 206f 7074 696f 6e61 6c0a 2020 2020  t, optional.    
-000118b0: 2020 2020 2020 2020 4b65 7977 6f72 6420          Keyword 
-000118c0: 6172 6775 6d65 6e74 7320 746f 2070 6173  arguments to pas
-000118d0: 7320 6f6e 2074 6f20 6060 636f 6d62 696e  s on to ``combin
-000118e0: 6560 6020 6f6e 6c79 2e0a 2020 2020 2020  e`` only..      
-000118f0: 2020 6b77 6172 6773 203a 0a20 2020 2020    kwargs :.     
-00011900: 2020 2020 2020 2041 6c6c 2072 656d 6169         All remai
-00011910: 6e69 6e67 206b 6579 776f 7264 7320 7769  ning keywords wi
-00011920: 6c6c 2062 6520 7061 7373 6564 2074 6f20  ll be passed to 
-00011930: 6060 6368 756e 6b60 602c 2060 6063 6f6d  ``chunk``, ``com
-00011940: 6269 6e65 6060 2c0a 2020 2020 2020 2020  bine``,.        
-00011950: 2020 2020 616e 6420 6060 6167 6772 6567      and ``aggreg
-00011960: 6174 6560 602e 0a0a 2020 2020 2020 2020  ate``...        
-00011970: 4578 616d 706c 6573 0a20 2020 2020 2020  Examples.       
-00011980: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
-00011990: 2020 3e3e 3e20 696d 706f 7274 2070 616e    >>> import pan
-000119a0: 6461 7320 6173 2070 640a 2020 2020 2020  das as pd.      
-000119b0: 2020 3e3e 3e20 696d 706f 7274 2064 6173    >>> import das
-000119c0: 6b2e 6461 7461 6672 616d 6520 6173 2064  k.dataframe as d
-000119d0: 640a 2020 2020 2020 2020 3e3e 3e20 6466  d.        >>> df
-000119e0: 203d 2070 642e 4461 7461 4672 616d 6528   = pd.DataFrame(
-000119f0: 7b27 7827 3a20 7261 6e67 6528 3530 292c  {'x': range(50),
-00011a00: 2027 7927 3a20 7261 6e67 6528 3530 2c20   'y': range(50, 
-00011a10: 3130 3029 7d29 0a20 2020 2020 2020 203e  100)}).        >
-00011a20: 3e3e 2064 6466 203d 2064 642e 6672 6f6d  >> ddf = dd.from
-00011a30: 5f70 616e 6461 7328 6466 2c20 6e70 6172  _pandas(df, npar
-00011a40: 7469 7469 6f6e 733d 3429 0a0a 2020 2020  titions=4)..    
-00011a50: 2020 2020 436f 756e 7420 7468 6520 6e75      Count the nu
-00011a60: 6d62 6572 206f 6620 726f 7773 2069 6e20  mber of rows in 
-00011a70: 6120 4461 7461 4672 616d 652e 2054 6f20  a DataFrame. To 
-00011a80: 646f 2074 6869 732c 2063 6f75 6e74 2074  do this, count t
-00011a90: 6865 206e 756d 6265 720a 2020 2020 2020  he number.      
-00011aa0: 2020 6f66 2072 6f77 7320 696e 2065 6163    of rows in eac
-00011ab0: 6820 7061 7274 6974 696f 6e2c 2074 6865  h partition, the
-00011ac0: 6e20 7375 6d20 7468 6520 7265 7375 6c74  n sum the result
-00011ad0: 733a 0a0a 2020 2020 2020 2020 3e3e 3e20  s:..        >>> 
-00011ae0: 7265 7320 3d20 6464 662e 7265 6475 6374  res = ddf.reduct
-00011af0: 696f 6e28 6c61 6d62 6461 2078 3a20 782e  ion(lambda x: x.
-00011b00: 636f 756e 7428 292c 0a20 2020 2020 2020  count(),.       
-00011b10: 202e 2e2e 2020 2020 2020 2020 2020 2020   ...            
-00011b20: 2020 2020 2020 2020 2061 6767 7265 6761           aggrega
-00011b30: 7465 3d6c 616d 6264 6120 783a 2078 2e73  te=lambda x: x.s
-00011b40: 756d 2829 290a 2020 2020 2020 2020 3e3e  um()).        >>
-00011b50: 3e20 7265 732e 636f 6d70 7574 6528 290a  > res.compute().
-00011b60: 2020 2020 2020 2020 7820 2020 2035 300a          x    50.
-00011b70: 2020 2020 2020 2020 7920 2020 2035 300a          y    50.
-00011b80: 2020 2020 2020 2020 6474 7970 653a 2069          dtype: i
-00011b90: 6e74 3634 0a0a 2020 2020 2020 2020 436f  nt64..        Co
-00011ba0: 756e 7420 7468 6520 6e75 6d62 6572 206f  unt the number o
-00011bb0: 6620 726f 7773 2069 6e20 6120 5365 7269  f rows in a Seri
-00011bc0: 6573 2077 6974 6820 656c 656d 656e 7473  es with elements
-00011bd0: 2067 7265 6174 6572 2074 6861 6e20 6f72   greater than or
-00011be0: 0a20 2020 2020 2020 2065 7175 616c 2074  .        equal t
-00011bf0: 6f20 6120 7661 6c75 6520 2870 726f 7669  o a value (provi
-00011c00: 6465 6420 7669 6120 6120 6b65 7977 6f72  ded via a keywor
-00011c10: 6429 2e0a 0a20 2020 2020 2020 203e 3e3e  d)...        >>>
-00011c20: 2064 6566 2063 6f75 6e74 5f67 7265 6174   def count_great
-00011c30: 6572 2878 2c20 7661 6c75 653d 3029 3a0a  er(x, value=0):.
-00011c40: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-00011c50: 7265 7475 726e 2028 7820 3e3d 2076 616c  return (x >= val
-00011c60: 7565 292e 7375 6d28 290a 2020 2020 2020  ue).sum().      
-00011c70: 2020 3e3e 3e20 7265 7320 3d20 6464 662e    >>> res = ddf.
-00011c80: 782e 7265 6475 6374 696f 6e28 636f 756e  x.reduction(coun
-00011c90: 745f 6772 6561 7465 722c 2061 6767 7265  t_greater, aggre
-00011ca0: 6761 7465 3d6c 616d 6264 6120 783a 2078  gate=lambda x: x
-00011cb0: 2e73 756d 2829 2c0a 2020 2020 2020 2020  .sum(),.        
-00011cc0: 2e2e 2e20 2020 2020 2020 2020 2020 2020  ...             
-00011cd0: 2020 2020 2020 2020 2020 6368 756e 6b5f            chunk_
-00011ce0: 6b77 6172 6773 3d7b 2776 616c 7565 273a  kwargs={'value':
-00011cf0: 2032 357d 290a 2020 2020 2020 2020 3e3e   25}).        >>
-00011d00: 3e20 7265 732e 636f 6d70 7574 6528 290a  > res.compute().
-00011d10: 2020 2020 2020 2020 3235 0a0a 2020 2020          25..    
-00011d20: 2020 2020 4167 6772 6567 6174 6520 626f      Aggregate bo
-00011d30: 7468 2074 6865 2073 756d 2061 6e64 2063  th the sum and c
-00011d40: 6f75 6e74 206f 6620 6120 5365 7269 6573  ount of a Series
-00011d50: 2061 7420 7468 6520 7361 6d65 2074 696d   at the same tim
-00011d60: 653a 0a0a 2020 2020 2020 2020 3e3e 3e20  e:..        >>> 
-00011d70: 6465 6620 7375 6d5f 616e 645f 636f 756e  def sum_and_coun
-00011d80: 7428 7829 3a0a 2020 2020 2020 2020 2e2e  t(x):.        ..
-00011d90: 2e20 2020 2020 7265 7475 726e 2070 642e  .     return pd.
-00011da0: 5365 7269 6573 287b 2763 6f75 6e74 273a  Series({'count':
-00011db0: 2078 2e63 6f75 6e74 2829 2c20 2773 756d   x.count(), 'sum
-00011dc0: 273a 2078 2e73 756d 2829 7d2c 0a20 2020  ': x.sum()},.   
-00011dd0: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
-00011de0: 2020 2020 2020 2020 2020 2020 2020 696e                in
-00011df0: 6465 783d 5b27 636f 756e 7427 2c20 2773  dex=['count', 's
-00011e00: 756d 275d 290a 2020 2020 2020 2020 3e3e  um']).        >>
-00011e10: 3e20 7265 7320 3d20 6464 662e 782e 7265  > res = ddf.x.re
-00011e20: 6475 6374 696f 6e28 7375 6d5f 616e 645f  duction(sum_and_
-00011e30: 636f 756e 742c 2061 6767 7265 6761 7465  count, aggregate
-00011e40: 3d6c 616d 6264 6120 783a 2078 2e73 756d  =lambda x: x.sum
-00011e50: 2829 290a 2020 2020 2020 2020 3e3e 3e20  ()).        >>> 
-00011e60: 7265 732e 636f 6d70 7574 6528 290a 2020  res.compute().  
-00011e70: 2020 2020 2020 636f 756e 7420 2020 2020        count     
-00011e80: 2035 300a 2020 2020 2020 2020 7375 6d20   50.        sum 
-00011e90: 2020 2020 2031 3232 350a 2020 2020 2020       1225.      
-00011ea0: 2020 6474 7970 653a 2069 6e74 3634 0a0a    dtype: int64..
-00011eb0: 2020 2020 2020 2020 446f 696e 6720 7468          Doing th
-00011ec0: 6520 7361 6d65 2c20 6275 7420 666f 7220  e same, but for 
-00011ed0: 6120 4461 7461 4672 616d 652e 2048 6572  a DataFrame. Her
-00011ee0: 6520 6060 6368 756e 6b60 6020 7265 7475  e ``chunk`` retu
-00011ef0: 726e 7320 610a 2020 2020 2020 2020 4461  rns a.        Da
-00011f00: 7461 4672 616d 652c 206d 6561 6e69 6e67  taFrame, meaning
-00011f10: 2074 6865 2069 6e70 7574 2074 6f20 6060   the input to ``
-00011f20: 6167 6772 6567 6174 6560 6020 6973 2061  aggregate`` is a
-00011f30: 2044 6174 6146 7261 6d65 2077 6974 6820   DataFrame with 
-00011f40: 616e 0a20 2020 2020 2020 2069 6e64 6578  an.        index
-00011f50: 2077 6974 6820 6e6f 6e2d 756e 6971 7565   with non-unique
-00011f60: 2065 6e74 7269 6573 2066 6f72 2062 6f74   entries for bot
-00011f70: 6820 2778 2720 616e 6420 2779 272e 2057  h 'x' and 'y'. W
-00011f80: 6520 6772 6f75 7062 7920 7468 650a 2020  e groupby the.  
-00011f90: 2020 2020 2020 696e 6465 782c 2061 6e64        index, and
-00011fa0: 2073 756d 2065 6163 6820 6772 6f75 7020   sum each group 
-00011fb0: 746f 2067 6574 2074 6865 2066 696e 616c  to get the final
-00011fc0: 2072 6573 756c 742e 0a0a 2020 2020 2020   result...      
-00011fd0: 2020 3e3e 3e20 6465 6620 7375 6d5f 616e    >>> def sum_an
-00011fe0: 645f 636f 756e 7428 7829 3a0a 2020 2020  d_count(x):.    
-00011ff0: 2020 2020 2e2e 2e20 2020 2020 7265 7475      ...     retu
-00012000: 726e 2070 642e 4461 7461 4672 616d 6528  rn pd.DataFrame(
-00012010: 7b27 636f 756e 7427 3a20 782e 636f 756e  {'count': x.coun
-00012020: 7428 292c 2027 7375 6d27 3a20 782e 7375  t(), 'sum': x.su
-00012030: 6d28 297d 2c0a 2020 2020 2020 2020 2e2e  m()},.        ..
-00012040: 2e20 2020 2020 2020 2020 2020 2020 2020  .               
-00012050: 2020 2020 2020 2020 2020 636f 6c75 6d6e            column
-00012060: 733d 5b27 636f 756e 7427 2c20 2773 756d  s=['count', 'sum
-00012070: 275d 290a 2020 2020 2020 2020 3e3e 3e20  ']).        >>> 
-00012080: 7265 7320 3d20 6464 662e 7265 6475 6374  res = ddf.reduct
-00012090: 696f 6e28 7375 6d5f 616e 645f 636f 756e  ion(sum_and_coun
-000120a0: 742c 0a20 2020 2020 2020 202e 2e2e 2020  t,.        ...  
-000120b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000120c0: 2020 2061 6767 7265 6761 7465 3d6c 616d     aggregate=lam
-000120d0: 6264 6120 783a 2078 2e67 726f 7570 6279  bda x: x.groupby
-000120e0: 286c 6576 656c 3d30 292e 7375 6d28 2929  (level=0).sum())
-000120f0: 0a20 2020 2020 2020 203e 3e3e 2072 6573  .        >>> res
-00012100: 2e63 6f6d 7075 7465 2829 0a20 2020 2020  .compute().     
-00012110: 2020 2020 2020 636f 756e 7420 2020 7375        count   su
-00012120: 6d0a 2020 2020 2020 2020 7820 2020 2020  m.        x     
-00012130: 3530 2020 3132 3235 0a20 2020 2020 2020  50  1225.       
-00012140: 2079 2020 2020 2035 3020 2033 3732 350a   y     50  3725.
-00012150: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00012160: 2020 2020 6966 2073 706c 6974 5f65 7665      if split_eve
-00012170: 7279 2069 7320 6e6f 7420 4e6f 6e65 2061  ry is not None a
-00012180: 6e64 2073 706c 6974 5f65 7665 7279 203c  nd split_every <
-00012190: 2032 2061 6e64 2073 706c 6974 5f65 7665   2 and split_eve
-000121a0: 7279 2069 7320 6e6f 7420 4661 6c73 653a  ry is not False:
-000121b0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-000121c0: 7365 2056 616c 7565 4572 726f 7228 2273  se ValueError("s
-000121d0: 706c 6974 5f65 7665 7279 206d 7573 7420  plit_every must 
-000121e0: 6265 2061 7420 6c65 6173 7420 3222 290a  be at least 2").
-000121f0: 0a20 2020 2020 2020 2069 6620 636f 6d62  .        if comb
-00012200: 696e 6520 6973 204e 6f6e 653a 0a20 2020  ine is None:.   
-00012210: 2020 2020 2020 2020 2069 6620 636f 6d62           if comb
-00012220: 696e 655f 6b77 6172 6773 3a0a 2020 2020  ine_kwargs:.    
-00012230: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00012240: 6520 5661 6c75 6545 7272 6f72 2822 6063  e ValueError("`c
-00012250: 6f6d 6269 6e65 5f6b 7761 7267 7360 2070  ombine_kwargs` p
-00012260: 726f 7669 6465 6420 7769 7468 206e 6f20  rovided with no 
-00012270: 6063 6f6d 6269 6e65 6022 290a 0a20 2020  `combine`")..   
-00012280: 2020 2020 2063 6875 6e6b 5f6b 7761 7267       chunk_kwarg
-00012290: 7320 3d20 6368 756e 6b5f 6b77 6172 6773  s = chunk_kwargs
-000122a0: 2e63 6f70 7928 2920 6966 2063 6875 6e6b  .copy() if chunk
-000122b0: 5f6b 7761 7267 7320 656c 7365 207b 7d0a  _kwargs else {}.
-000122c0: 2020 2020 2020 2020 6368 756e 6b5f 6b77          chunk_kw
-000122d0: 6172 6773 2e75 7064 6174 6528 6b77 6172  args.update(kwar
-000122e0: 6773 290a 2020 2020 2020 2020 6368 756e  gs).        chun
-000122f0: 6b5f 6b77 6172 6773 5b22 6675 6e63 225d  k_kwargs["func"]
-00012300: 203d 2063 6875 6e6b 0a0a 2020 2020 2020   = chunk..      
-00012310: 2020 636f 6d62 696e 655f 6b77 6172 6773    combine_kwargs
-00012320: 203d 2063 6f6d 6269 6e65 5f6b 7761 7267   = combine_kwarg
-00012330: 732e 636f 7079 2829 2069 6620 636f 6d62  s.copy() if comb
-00012340: 696e 655f 6b77 6172 6773 2065 6c73 6520  ine_kwargs else 
-00012350: 7b7d 0a20 2020 2020 2020 2063 6f6d 6269  {}.        combi
-00012360: 6e65 5f6b 7761 7267 732e 7570 6461 7465  ne_kwargs.update
-00012370: 286b 7761 7267 7329 0a20 2020 2020 2020  (kwargs).       
-00012380: 2063 6f6d 6269 6e65 5f6b 7761 7267 735b   combine_kwargs[
-00012390: 2266 756e 6322 5d20 3d20 636f 6d62 696e  "func"] = combin
-000123a0: 6520 6f72 2061 6767 7265 6761 7465 206f  e or aggregate o
-000123b0: 7220 6368 756e 6b0a 0a20 2020 2020 2020  r chunk..       
-000123c0: 2061 6767 7265 6761 7465 5f6b 7761 7267   aggregate_kwarg
-000123d0: 7320 3d20 6167 6772 6567 6174 655f 6b77  s = aggregate_kw
-000123e0: 6172 6773 2e63 6f70 7928 2920 6966 2061  args.copy() if a
-000123f0: 6767 7265 6761 7465 5f6b 7761 7267 7320  ggregate_kwargs 
-00012400: 656c 7365 207b 7d0a 2020 2020 2020 2020  else {}.        
-00012410: 6167 6772 6567 6174 655f 6b77 6172 6773  aggregate_kwargs
-00012420: 2e75 7064 6174 6528 6b77 6172 6773 290a  .update(kwargs).
-00012430: 2020 2020 2020 2020 6167 6772 6567 6174          aggregat
-00012440: 655f 6b77 6172 6773 5b22 6675 6e63 225d  e_kwargs["func"]
-00012450: 203d 2061 6767 7265 6761 7465 206f 7220   = aggregate or 
-00012460: 6368 756e 6b0a 0a20 2020 2020 2020 2072  chunk..        r
-00012470: 6574 7572 6e20 6e65 775f 636f 6c6c 6563  eturn new_collec
-00012480: 7469 6f6e 280a 2020 2020 2020 2020 2020  tion(.          
-00012490: 2020 4375 7374 6f6d 5265 6475 6374 696f    CustomReductio
-000124a0: 6e28 0a20 2020 2020 2020 2020 2020 2020  n(.             
-000124b0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-000124c0: 2020 2020 2020 2020 206d 6574 612c 0a20           meta,. 
-000124d0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-000124e0: 6875 6e6b 5f6b 7761 7267 732c 0a20 2020  hunk_kwargs,.   
-000124f0: 2020 2020 2020 2020 2020 2020 2061 6767               agg
-00012500: 7265 6761 7465 5f6b 7761 7267 732c 0a20  regate_kwargs,. 
-00012510: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00012520: 6f6d 6269 6e65 5f6b 7761 7267 732c 0a20  ombine_kwargs,. 
-00012530: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00012540: 706c 6974 5f65 7665 7279 2c0a 2020 2020  plit_every,.    
-00012550: 2020 2020 2020 2020 2020 2020 746f 6b65              toke
-00012560: 6e2c 0a20 2020 2020 2020 2020 2020 2029  n,.            )
-00012570: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-00012580: 6465 6620 6d65 6d6f 7279 5f75 7361 6765  def memory_usage
-00012590: 5f70 6572 5f70 6172 7469 7469 6f6e 2873  _per_partition(s
-000125a0: 656c 662c 2069 6e64 6578 3a20 626f 6f6c  elf, index: bool
-000125b0: 203d 2054 7275 652c 2064 6565 703a 2062   = True, deep: b
-000125c0: 6f6f 6c20 3d20 4661 6c73 6529 3a0a 2020  ool = False):.  
-000125d0: 2020 2020 2020 2222 2252 6574 7572 6e20        """Return 
-000125e0: 7468 6520 6d65 6d6f 7279 2075 7361 6765  the memory usage
-000125f0: 206f 6620 6561 6368 2070 6172 7469 7469   of each partiti
-00012600: 6f6e 0a0a 2020 2020 2020 2020 5061 7261  on..        Para
-00012610: 6d65 7465 7273 0a20 2020 2020 2020 202d  meters.        -
-00012620: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-00012630: 2020 696e 6465 7820 3a20 626f 6f6c 2c20    index : bool, 
-00012640: 6465 6661 756c 7420 5472 7565 0a20 2020  default True.   
-00012650: 2020 2020 2020 2020 2053 7065 6369 6669           Specifi
-00012660: 6573 2077 6865 7468 6572 2074 6f20 696e  es whether to in
-00012670: 636c 7564 6520 7468 6520 6d65 6d6f 7279  clude the memory
-00012680: 2075 7361 6765 206f 6620 7468 6520 696e   usage of the in
-00012690: 6465 7820 696e 0a20 2020 2020 2020 2020  dex in.         
-000126a0: 2020 2072 6574 7572 6e65 6420 5365 7269     returned Seri
-000126b0: 6573 2e0a 2020 2020 2020 2020 6465 6570  es..        deep
-000126c0: 203a 2062 6f6f 6c2c 2064 6566 6175 6c74   : bool, default
-000126d0: 2046 616c 7365 0a20 2020 2020 2020 2020   False.         
-000126e0: 2020 2049 6620 5472 7565 2c20 696e 7472     If True, intr
-000126f0: 6f73 7065 6374 2074 6865 2064 6174 6120  ospect the data 
-00012700: 6465 6570 6c79 2062 7920 696e 7465 7272  deeply by interr
-00012710: 6f67 6174 696e 670a 2020 2020 2020 2020  ogating.        
-00012720: 2020 2020 6060 6f62 6a65 6374 6060 2064      ``object`` d
-00012730: 7479 7065 7320 666f 7220 7379 7374 656d  types for system
-00012740: 2d6c 6576 656c 206d 656d 6f72 7920 636f  -level memory co
-00012750: 6e73 756d 7074 696f 6e2c 2061 6e64 2069  nsumption, and i
-00012760: 6e63 6c75 6465 0a20 2020 2020 2020 2020  nclude.         
-00012770: 2020 2069 7420 696e 2074 6865 2072 6574     it in the ret
-00012780: 7572 6e65 6420 7661 6c75 6573 2e0a 0a20  urned values... 
-00012790: 2020 2020 2020 2052 6574 7572 6e73 0a20         Returns. 
-000127a0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0a20         -------. 
-000127b0: 2020 2020 2020 2053 6572 6965 730a 2020         Series.  
-000127c0: 2020 2020 2020 2020 2020 4120 5365 7269            A Seri
-000127d0: 6573 2077 686f 7365 2069 6e64 6578 2069  es whose index i
-000127e0: 7320 7468 6520 7061 7274 6974 696f 6e20  s the partition 
-000127f0: 6e75 6d62 6572 2061 6e64 2077 686f 7365  number and whose
-00012800: 2076 616c 7565 730a 2020 2020 2020 2020   values.        
-00012810: 2020 2020 6172 6520 7468 6520 6d65 6d6f      are the memo
-00012820: 7279 2075 7361 6765 206f 6620 6561 6368  ry usage of each
-00012830: 2070 6172 7469 7469 6f6e 2069 6e20 6279   partition in by
-00012840: 7465 732e 0a20 2020 2020 2020 2022 2222  tes..        """
-00012850: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00012860: 6e65 775f 636f 6c6c 6563 7469 6f6e 2873  new_collection(s
-00012870: 656c 662e 6578 7072 2e6d 656d 6f72 795f  elf.expr.memory_
-00012880: 7573 6167 655f 7065 725f 7061 7274 6974  usage_per_partit
-00012890: 696f 6e28 696e 6465 782c 2064 6565 7029  ion(index, deep)
-000128a0: 290a 0a20 2020 2040 7072 6f70 6572 7479  )..    @property
-000128b0: 0a20 2020 2064 6566 206c 6f63 2873 656c  .    def loc(sel
-000128c0: 6629 3a0a 2020 2020 2020 2020 2222 2250  f):.        """P
-000128d0: 7572 656c 7920 6c61 6265 6c2d 6c6f 6361  urely label-loca
-000128e0: 7469 6f6e 2062 6173 6564 2069 6e64 6578  tion based index
-000128f0: 6572 2066 6f72 2073 656c 6563 7469 6f6e  er for selection
-00012900: 2062 7920 6c61 6265 6c2e 0a0a 2020 2020   by label...    
-00012910: 2020 2020 3e3e 3e20 6466 2e6c 6f63 5b22      >>> df.loc["
-00012920: 6222 5d20 2023 2064 6f63 7465 7374 3a20  b"]  # doctest: 
-00012930: 2b53 4b49 500a 2020 2020 2020 2020 3e3e  +SKIP.        >>
-00012940: 3e20 6466 2e6c 6f63 5b22 6222 3a22 6422  > df.loc["b":"d"
-00012950: 5d20 2023 2064 6f63 7465 7374 3a20 2b53  ]  # doctest: +S
-00012960: 4b49 500a 2020 2020 2020 2020 2222 220a  KIP.        """.
-00012970: 2020 2020 2020 2020 6672 6f6d 2064 6173          from das
-00012980: 6b5f 6578 7072 2e5f 696e 6465 7869 6e67  k_expr._indexing
-00012990: 2069 6d70 6f72 7420 4c6f 6349 6e64 6578   import LocIndex
-000129a0: 6572 0a0a 2020 2020 2020 2020 7265 7475  er..        retu
-000129b0: 726e 204c 6f63 496e 6465 7865 7228 7365  rn LocIndexer(se
-000129c0: 6c66 290a 0a20 2020 2040 6465 7269 7665  lf)..    @derive
-000129d0: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
-000129e0: 616d 6529 0a20 2020 2064 6566 206e 6f74  ame).    def not
-000129f0: 6e75 6c6c 2873 656c 6629 3a0a 2020 2020  null(self):.    
-00012a00: 2020 2020 7265 7475 726e 206e 6577 5f63      return new_c
-00012a10: 6f6c 6c65 6374 696f 6e28 6578 7072 2e4e  ollection(expr.N
-00012a20: 6f74 4e75 6c6c 2873 656c 6629 290a 0a20  otNull(self)).. 
-00012a30: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
-00012a40: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
-00012a50: 2020 2064 6566 2069 736e 756c 6c28 7365     def isnull(se
-00012a60: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
-00012a70: 7572 6e20 7e73 656c 662e 6e6f 746e 756c  urn ~self.notnul
-00012a80: 6c28 290a 0a20 2020 2064 6566 2063 6f6d  l()..    def com
-00012a90: 7075 7465 5f63 7572 7265 6e74 5f64 6976  pute_current_div
-00012aa0: 6973 696f 6e73 2873 656c 662c 2063 6f6c  isions(self, col
-00012ab0: 3d4e 6f6e 652c 2073 6574 5f64 6976 6973  =None, set_divis
-00012ac0: 696f 6e73 3a20 626f 6f6c 203d 2046 616c  ions: bool = Fal
-00012ad0: 7365 293a 0a20 2020 2020 2020 2022 2222  se):.        """
-00012ae0: 436f 6d70 7574 6520 7468 6520 6375 7272  Compute the curr
-00012af0: 656e 7420 6469 7669 7369 6f6e 7320 6f66  ent divisions of
-00012b00: 2074 6865 2044 6174 6146 7261 6d65 2e0a   the DataFrame..
-00012b10: 0a20 2020 2020 2020 2054 6869 7320 6d65  .        This me
-00012b20: 7468 6f64 2074 7269 6767 6572 7320 696d  thod triggers im
-00012b30: 6d65 6469 6174 6520 636f 6d70 7574 6174  mediate computat
-00012b40: 696f 6e2e 2049 6620 796f 7520 6669 6e64  ion. If you find
-00012b50: 2079 6f75 7273 656c 6620 7275 6e6e 696e   yourself runnin
-00012b60: 6720 7468 6973 2063 6f6d 6d61 6e64 0a20  g this command. 
-00012b70: 2020 2020 2020 2072 6570 6561 7465 646c         repeatedl
-00012b80: 7920 666f 7220 7468 6520 7361 6d65 2064  y for the same d
-00012b90: 6174 6166 7261 6d65 2c20 7765 2072 6563  ataframe, we rec
-00012ba0: 6f6d 6d65 6e64 2073 746f 7269 6e67 2074  ommend storing t
-00012bb0: 6865 2072 6573 756c 740a 2020 2020 2020  he result.      
-00012bc0: 2020 736f 2079 6f75 2064 6f6e 2774 2068    so you don't h
-00012bd0: 6176 6520 746f 2072 6572 756e 2069 742e  ave to rerun it.
-00012be0: 0a0a 2020 2020 2020 2020 4966 2074 6865  ..        If the
-00012bf0: 2063 6f6c 756d 6e20 6f72 2069 6e64 6578   column or index
-00012c00: 2076 616c 7565 7320 6f76 6572 6c61 7020   values overlap 
-00012c10: 6265 7477 6565 6e20 7061 7274 6974 696f  between partitio
-00012c20: 6e73 2c20 7261 6973 6573 2060 6056 616c  ns, raises ``Val
-00012c30: 7565 4572 726f 7260 602e 0a20 2020 2020  ueError``..     
-00012c40: 2020 2054 6f20 7072 6576 656e 7420 7468     To prevent th
-00012c50: 6973 2c20 6d61 6b65 2073 7572 6520 7468  is, make sure th
-00012c60: 6520 6461 7461 2061 7265 2073 6f72 7465  e data are sorte
-00012c70: 6420 6279 2074 6865 2063 6f6c 756d 6e20  d by the column 
-00012c80: 6f72 2069 6e64 6578 2e0a 0a20 2020 2020  or index...     
-00012c90: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
-00012ca0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00012cb0: 0a20 2020 2020 2020 2063 6f6c 203a 2073  .        col : s
-00012cc0: 7472 696e 672c 206f 7074 696f 6e61 6c0a  tring, optional.
-00012cd0: 2020 2020 2020 2020 2020 2020 4361 6c63              Calc
-00012ce0: 756c 6174 6520 7468 6520 6469 7669 7369  ulate the divisi
-00012cf0: 6f6e 7320 666f 7220 6120 6e6f 6e2d 696e  ons for a non-in
-00012d00: 6465 7820 636f 6c75 6d6e 2062 7920 7061  dex column by pa
-00012d10: 7373 696e 6720 696e 2074 6865 206e 616d  ssing in the nam
-00012d20: 6520 6f66 2074 6865 2063 6f6c 756d 6e2e  e of the column.
-00012d30: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
-00012d40: 636f 6c20 6973 206e 6f74 2073 7065 6369  col is not speci
-00012d50: 6669 6564 2c20 7468 6520 696e 6465 7820  fied, the index 
-00012d60: 7769 6c6c 2062 6520 7573 6564 2074 6f20  will be used to 
-00012d70: 6361 6c63 756c 6174 6520 6469 7669 7369  calculate divisi
-00012d80: 6f6e 732e 0a20 2020 2020 2020 2020 2020  ons..           
-00012d90: 2049 6e20 7468 6973 2063 6173 652c 2069   In this case, i
-00012da0: 6620 7468 6520 6469 7669 7369 6f6e 7320  f the divisions 
-00012db0: 6172 6520 616c 7265 6164 7920 6b6e 6f77  are already know
-00012dc0: 6e2c 2074 6865 7920 7769 6c6c 2062 6520  n, they will be 
-00012dd0: 7265 7475 726e 6564 0a20 2020 2020 2020  returned.       
-00012de0: 2020 2020 2069 6d6d 6564 6961 7465 6c79       immediately
-00012df0: 2077 6974 686f 7574 2063 6f6d 7075 7469   without computi
-00012e00: 6e67 2e0a 2020 2020 2020 2020 7365 745f  ng..        set_
-00012e10: 6469 7669 7369 6f6e 7320 3a20 626f 6f6c  divisions : bool
-00012e20: 2c20 6465 6661 756c 7420 4661 6c73 650a  , default False.
-00012e30: 2020 2020 2020 2020 2020 2020 5768 6574              Whet
-00012e40: 6865 7220 746f 2073 6574 2074 6865 2063  her to set the c
-00012e50: 6f6d 7075 7465 6420 6469 7669 7369 6f6e  omputed division
-00012e60: 7320 696e 746f 2074 6865 2044 6174 6146  s into the DataF
-00012e70: 7261 6d65 2e20 4966 2046 616c 7365 2c20  rame. If False, 
-00012e80: 7468 6520 6469 7669 7369 6f6e 730a 2020  the divisions.  
-00012e90: 2020 2020 2020 2020 2020 6f66 2074 6865            of the
-00012ea0: 2044 6174 6146 7261 6d65 2061 7265 2075   DataFrame are u
-00012eb0: 6e63 6861 6e67 6564 2e0a 0a20 2020 2020  nchanged...     
-00012ec0: 2020 2045 7861 6d70 6c65 730a 2020 2020     Examples.    
-00012ed0: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
-00012ee0: 2020 2020 203e 3e3e 2069 6d70 6f72 7420       >>> import 
-00012ef0: 6461 736b 0a20 2020 2020 2020 203e 3e3e  dask.        >>>
-00012f00: 2064 6466 203d 2064 6173 6b2e 6461 7461   ddf = dask.data
-00012f10: 7365 7473 2e74 696d 6573 6572 6965 7328  sets.timeseries(
-00012f20: 7374 6172 743d 2232 3032 312d 3031 2d30  start="2021-01-0
-00012f30: 3122 2c20 656e 643d 2232 3032 312d 3031  1", end="2021-01
-00012f40: 2d30 3722 2c20 6672 6571 3d22 3168 2229  -07", freq="1h")
-00012f50: 2e63 6c65 6172 5f64 6976 6973 696f 6e73  .clear_divisions
-00012f60: 2829 0a20 2020 2020 2020 203e 3e3e 2064  ().        >>> d
-00012f70: 6976 6973 696f 6e73 203d 2064 6466 2e63  ivisions = ddf.c
-00012f80: 6f6d 7075 7465 5f63 7572 7265 6e74 5f64  ompute_current_d
-00012f90: 6976 6973 696f 6e73 2829 0a20 2020 2020  ivisions().     
-00012fa0: 2020 203e 3e3e 2070 7269 6e74 2864 6976     >>> print(div
-00012fb0: 6973 696f 6e73 2920 2023 2064 6f63 7465  isions)  # docte
-00012fc0: 7374 3a20 2b4e 4f52 4d41 4c49 5a45 5f57  st: +NORMALIZE_W
-00012fd0: 4849 5445 5350 4143 450a 2020 2020 2020  HITESPACE.      
-00012fe0: 2020 2854 696d 6573 7461 6d70 2827 3230    (Timestamp('20
-00012ff0: 3231 2d30 312d 3031 2030 303a 3030 3a30  21-01-01 00:00:0
-00013000: 3027 292c 0a20 2020 2020 2020 2020 5469  0'),.         Ti
-00013010: 6d65 7374 616d 7028 2732 3032 312d 3031  mestamp('2021-01
-00013020: 2d30 3220 3030 3a30 303a 3030 2729 2c0a  -02 00:00:00'),.
-00013030: 2020 2020 2020 2020 2054 696d 6573 7461           Timesta
-00013040: 6d70 2827 3230 3231 2d30 312d 3033 2030  mp('2021-01-03 0
-00013050: 303a 3030 3a30 3027 292c 0a20 2020 2020  0:00:00'),.     
-00013060: 2020 2020 5469 6d65 7374 616d 7028 2732      Timestamp('2
-00013070: 3032 312d 3031 2d30 3420 3030 3a30 303a  021-01-04 00:00:
-00013080: 3030 2729 2c0a 2020 2020 2020 2020 2054  00'),.         T
-00013090: 696d 6573 7461 6d70 2827 3230 3231 2d30  imestamp('2021-0
-000130a0: 312d 3035 2030 303a 3030 3a30 3027 292c  1-05 00:00:00'),
-000130b0: 0a20 2020 2020 2020 2020 5469 6d65 7374  .         Timest
-000130c0: 616d 7028 2732 3032 312d 3031 2d30 3620  amp('2021-01-06 
-000130d0: 3030 3a30 303a 3030 2729 2c0a 2020 2020  00:00:00'),.    
-000130e0: 2020 2020 2054 696d 6573 7461 6d70 2827       Timestamp('
-000130f0: 3230 3231 2d30 312d 3036 2032 333a 3030  2021-01-06 23:00
-00013100: 3a30 3027 2929 0a0a 2020 2020 2020 2020  :00'))..        
-00013110: 3e3e 3e20 6464 662e 6469 7669 7369 6f6e  >>> ddf.division
-00013120: 7320 3d20 6469 7669 7369 6f6e 730a 2020  s = divisions.  
-00013130: 2020 2020 2020 3e3e 3e20 6464 662e 6b6e        >>> ddf.kn
-00013140: 6f77 6e5f 6469 7669 7369 6f6e 730a 2020  own_divisions.  
-00013150: 2020 2020 2020 5472 7565 0a0a 2020 2020        True..    
-00013160: 2020 2020 3e3e 3e20 6464 6620 3d20 6464      >>> ddf = dd
-00013170: 662e 7265 7365 745f 696e 6465 7828 292e  f.reset_index().
-00013180: 636c 6561 725f 6469 7669 7369 6f6e 7328  clear_divisions(
-00013190: 290a 2020 2020 2020 2020 3e3e 3e20 6469  ).        >>> di
-000131a0: 7669 7369 6f6e 7320 3d20 6464 662e 636f  visions = ddf.co
-000131b0: 6d70 7574 655f 6375 7272 656e 745f 6469  mpute_current_di
-000131c0: 7669 7369 6f6e 7328 2274 696d 6573 7461  visions("timesta
-000131d0: 6d70 2229 0a20 2020 2020 2020 203e 3e3e  mp").        >>>
-000131e0: 2070 7269 6e74 2864 6976 6973 696f 6e73   print(divisions
-000131f0: 2920 2023 2064 6f63 7465 7374 3a20 2b4e  )  # doctest: +N
-00013200: 4f52 4d41 4c49 5a45 5f57 4849 5445 5350  ORMALIZE_WHITESP
-00013210: 4143 450a 2020 2020 2020 2020 2854 696d  ACE.        (Tim
-00013220: 6573 7461 6d70 2827 3230 3231 2d30 312d  estamp('2021-01-
-00013230: 3031 2030 303a 3030 3a30 3027 292c 0a20  01 00:00:00'),. 
-00013240: 2020 2020 2020 2020 5469 6d65 7374 616d          Timestam
-00013250: 7028 2732 3032 312d 3031 2d30 3220 3030  p('2021-01-02 00
-00013260: 3a30 303a 3030 2729 2c0a 2020 2020 2020  :00:00'),.      
-00013270: 2020 2054 696d 6573 7461 6d70 2827 3230     Timestamp('20
-00013280: 3231 2d30 312d 3033 2030 303a 3030 3a30  21-01-03 00:00:0
-00013290: 3027 292c 0a20 2020 2020 2020 2020 5469  0'),.         Ti
-000132a0: 6d65 7374 616d 7028 2732 3032 312d 3031  mestamp('2021-01
-000132b0: 2d30 3420 3030 3a30 303a 3030 2729 2c0a  -04 00:00:00'),.
-000132c0: 2020 2020 2020 2020 2054 696d 6573 7461           Timesta
-000132d0: 6d70 2827 3230 3231 2d30 312d 3035 2030  mp('2021-01-05 0
-000132e0: 303a 3030 3a30 3027 292c 0a20 2020 2020  0:00:00'),.     
-000132f0: 2020 2020 5469 6d65 7374 616d 7028 2732      Timestamp('2
-00013300: 3032 312d 3031 2d30 3620 3030 3a30 303a  021-01-06 00:00:
-00013310: 3030 2729 2c0a 2020 2020 2020 2020 2054  00'),.         T
-00013320: 696d 6573 7461 6d70 2827 3230 3231 2d30  imestamp('2021-0
-00013330: 312d 3036 2032 333a 3030 3a30 3027 2929  1-06 23:00:00'))
-00013340: 0a0a 2020 2020 2020 2020 3e3e 3e20 6464  ..        >>> dd
-00013350: 6620 3d20 6464 662e 7365 745f 696e 6465  f = ddf.set_inde
-00013360: 7828 2274 696d 6573 7461 6d70 222c 2064  x("timestamp", d
-00013370: 6976 6973 696f 6e73 3d64 6976 6973 696f  ivisions=divisio
-00013380: 6e73 2c20 736f 7274 6564 3d54 7275 6529  ns, sorted=True)
-00013390: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-000133a0: 2020 2020 2069 6620 636f 6c20 6973 204e       if col is N
-000133b0: 6f6e 6520 616e 6420 7365 6c66 2e6b 6e6f  one and self.kno
-000133c0: 776e 5f64 6976 6973 696f 6e73 3a0a 2020  wn_divisions:.  
-000133d0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-000133e0: 2073 656c 662e 6469 7669 7369 6f6e 730a   self.divisions.
-000133f0: 0a20 2020 2020 2020 2069 6620 636f 6c20  .        if col 
-00013400: 6973 206e 6f74 204e 6f6e 6520 616e 6420  is not None and 
-00013410: 7365 745f 6469 7669 7369 6f6e 733a 0a20  set_divisions:. 
-00013420: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00013430: 204e 6f74 496d 706c 656d 656e 7465 6445   NotImplementedE
-00013440: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-00013450: 2020 2020 2020 2243 616e 2774 2073 6574        "Can't set
-00013460: 2064 6976 6973 696f 6e73 206f 6620 6e6f   divisions of no
-00013470: 6e2d 696e 6465 782c 2063 616c 6c20 7365  n-index, call se
-00013480: 745f 696e 6465 7820 696e 7374 6561 642e  t_index instead.
-00013490: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
-000134a0: 0a20 2020 2020 2020 2069 6620 636f 6c20  .        if col 
-000134b0: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
-000134c0: 2020 2020 2020 2020 2066 7261 6d65 203d           frame =
-000134d0: 2073 656c 665b 636f 6c5d 0a20 2020 2020   self[col].     
-000134e0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-000134f0: 2020 2020 2066 7261 6d65 203d 2073 656c       frame = sel
-00013500: 662e 696e 6465 780a 0a20 2020 2020 2020  f.index..       
-00013510: 206d 696e 732c 206d 6178 6573 2c20 6c65   mins, maxes, le
-00013520: 6e73 203d 205f 636f 6d70 7574 655f 7061  ns = _compute_pa
-00013530: 7274 6974 696f 6e5f 7374 6174 7328 6672  rtition_stats(fr
-00013540: 616d 652c 2061 6c6c 6f77 5f6f 7665 726c  ame, allow_overl
-00013550: 6170 3d73 6574 5f64 6976 6973 696f 6e73  ap=set_divisions
-00013560: 290a 2020 2020 2020 2020 6469 7669 7369  ).        divisi
-00013570: 6f6e 7320 3d20 7475 706c 6528 6d69 6e73  ons = tuple(mins
-00013580: 2920 2b20 286d 6178 6573 5b2d 315d 2c29  ) + (maxes[-1],)
-00013590: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
-000135a0: 7365 745f 6469 7669 7369 6f6e 733a 0a20  set_divisions:. 
-000135b0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-000135c0: 6e20 6469 7669 7369 6f6e 730a 2020 2020  n divisions.    
-000135d0: 2020 2020 6966 206c 656e 286d 696e 7329      if len(mins)
-000135e0: 203d 3d20 6c65 6e28 7365 6c66 2e64 6976   == len(self.div
-000135f0: 6973 696f 6e73 2920 2d20 313a 0a20 2020  isions) - 1:.   
-00013600: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
-00013610: 616e 7928 6d69 6e73 5b69 5d20 3e3d 206d  any(mins[i] >= m
-00013620: 6178 6573 5b69 202d 2031 5d20 666f 7220  axes[i - 1] for 
-00013630: 6920 696e 2072 616e 6765 2831 2c20 6c65  i in range(1, le
-00013640: 6e28 6d69 6e73 2929 293a 0a20 2020 2020  n(mins))):.     
-00013650: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00013660: 6e20 6e65 775f 636f 6c6c 6563 7469 6f6e  n new_collection
-00013670: 2865 7870 722e 5365 7444 6976 6973 696f  (expr.SetDivisio
-00013680: 6e73 2873 656c 662c 2064 6976 6973 696f  ns(self, divisio
-00013690: 6e73 2929 0a0a 2020 2020 2020 2020 7265  ns))..        re
-000136a0: 7475 726e 206e 6577 5f63 6f6c 6c65 6374  turn new_collect
-000136b0: 696f 6e28 6578 7072 2e52 6573 6f6c 7665  ion(expr.Resolve
-000136c0: 4f76 6572 6c61 7070 696e 6744 6976 6973  OverlappingDivis
-000136d0: 696f 6e73 2873 656c 662c 206d 696e 732c  ions(self, mins,
-000136e0: 206d 6178 6573 2c20 6c65 6e73 2929 0a0a   maxes, lens))..
-000136f0: 2020 2020 4063 6c61 7373 6d65 7468 6f64      @classmethod
-00013700: 0a20 2020 2064 6566 2066 726f 6d5f 6469  .    def from_di
-00013710: 6374 280a 2020 2020 2020 2020 636c 732c  ct(.        cls,
-00013720: 2064 6174 612c 202a 2c20 6e70 6172 7469   data, *, nparti
-00013730: 7469 6f6e 733d 312c 206f 7269 656e 743d  tions=1, orient=
-00013740: 2263 6f6c 756d 6e73 222c 2064 7479 7065  "columns", dtype
-00013750: 3d4e 6f6e 652c 2063 6f6c 756d 6e73 3d4e  =None, columns=N
-00013760: 6f6e 650a 2020 2020 293a 0a20 2020 2020  one.    ):.     
-00013770: 2020 2022 2222 0a20 2020 2020 2020 2043     """.        C
-00013780: 6f6e 7374 7275 6374 2061 2044 6173 6b20  onstruct a Dask 
-00013790: 4461 7461 4672 616d 6520 6672 6f6d 2061  DataFrame from a
-000137a0: 2050 7974 686f 6e20 4469 6374 696f 6e61   Python Dictiona
-000137b0: 7279 0a0a 2020 2020 2020 2020 5365 6520  ry..        See 
-000137c0: 416c 736f 0a20 2020 2020 2020 202d 2d2d  Also.        ---
-000137d0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6461  -----.        da
-000137e0: 736b 2e64 6174 6166 7261 6d65 2e66 726f  sk.dataframe.fro
-000137f0: 6d5f 6469 6374 0a20 2020 2020 2020 2022  m_dict.        "
-00013800: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
-00013810: 6e20 6672 6f6d 5f64 6963 7428 6461 7461  n from_dict(data
-00013820: 2c20 6e70 6172 7469 7469 6f6e 732c 206f  , npartitions, o
-00013830: 7269 656e 742c 2064 7479 7065 3d64 7479  rient, dtype=dty
-00013840: 7065 2c20 636f 6c75 6d6e 733d 636f 6c75  pe, columns=colu
-00013850: 6d6e 7329 0a0a 2020 2020 6465 6620 746f  mns)..    def to
-00013860: 5f6a 736f 6e28 7365 6c66 2c20 6669 6c65  _json(self, file
-00013870: 6e61 6d65 2c20 2a61 7267 732c 202a 2a6b  name, *args, **k
-00013880: 7761 7267 7329 3a0a 2020 2020 2020 2020  wargs):.        
-00013890: 2222 2253 6565 2064 642e 746f 5f6a 736f  """See dd.to_jso
-000138a0: 6e20 646f 6373 7472 696e 6720 666f 7220  n docstring for 
-000138b0: 6d6f 7265 2069 6e66 6f72 6d61 7469 6f6e  more information
-000138c0: 2222 220a 2020 2020 2020 2020 6672 6f6d  """.        from
-000138d0: 2064 6173 6b2e 6461 7461 6672 616d 652e   dask.dataframe.
-000138e0: 696f 2069 6d70 6f72 7420 746f 5f6a 736f  io import to_jso
-000138f0: 6e0a 0a20 2020 2020 2020 2072 6574 7572  n..        retur
-00013900: 6e20 746f 5f6a 736f 6e28 7365 6c66 2c20  n to_json(self, 
-00013910: 6669 6c65 6e61 6d65 2c20 2a61 7267 732c  filename, *args,
-00013920: 202a 2a6b 7761 7267 7329 0a0a 2020 2020   **kwargs)..    
-00013930: 6465 6620 746f 5f73 716c 280a 2020 2020  def to_sql(.    
-00013940: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-00013950: 2020 6e61 6d65 3a20 7374 722c 0a20 2020    name: str,.   
-00013960: 2020 2020 2075 7269 3a20 7374 722c 0a20       uri: str,. 
-00013970: 2020 2020 2020 2073 6368 656d 613d 4e6f         schema=No
-00013980: 6e65 2c0a 2020 2020 2020 2020 6966 5f65  ne,.        if_e
-00013990: 7869 7374 733a 2073 7472 203d 2022 6661  xists: str = "fa
-000139a0: 696c 222c 0a20 2020 2020 2020 2069 6e64  il",.        ind
-000139b0: 6578 3a20 626f 6f6c 203d 2054 7275 652c  ex: bool = True,
-000139c0: 0a20 2020 2020 2020 2069 6e64 6578 5f6c  .        index_l
-000139d0: 6162 656c 3d4e 6f6e 652c 0a20 2020 2020  abel=None,.     
-000139e0: 2020 2063 6875 6e6b 7369 7a65 3d4e 6f6e     chunksize=Non
-000139f0: 652c 0a20 2020 2020 2020 2064 7479 7065  e,.        dtype
-00013a00: 3d4e 6f6e 652c 0a20 2020 2020 2020 206d  =None,.        m
-00013a10: 6574 686f 643d 4e6f 6e65 2c0a 2020 2020  ethod=None,.    
-00013a20: 2020 2020 636f 6d70 7574 653d 5472 7565      compute=True
-00013a30: 2c0a 2020 2020 2020 2020 7061 7261 6c6c  ,.        parall
-00013a40: 656c 3d46 616c 7365 2c0a 2020 2020 2020  el=False,.      
-00013a50: 2020 656e 6769 6e65 5f6b 7761 7267 733d    engine_kwargs=
-00013a60: 4e6f 6e65 2c0a 2020 2020 293a 0a20 2020  None,.    ):.   
-00013a70: 2020 2020 2066 726f 6d20 6461 736b 5f65       from dask_e
-00013a80: 7870 722e 696f 2e73 716c 2069 6d70 6f72  xpr.io.sql impor
-00013a90: 7420 746f 5f73 716c 0a0a 2020 2020 2020  t to_sql..      
-00013aa0: 2020 7265 7475 726e 2074 6f5f 7371 6c28    return to_sql(
-00013ab0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00013ac0: 662c 0a20 2020 2020 2020 2020 2020 206e  f,.            n
-00013ad0: 616d 652c 0a20 2020 2020 2020 2020 2020  ame,.           
-00013ae0: 2075 7269 2c0a 2020 2020 2020 2020 2020   uri,.          
-00013af0: 2020 7363 6865 6d61 3d73 6368 656d 612c    schema=schema,
-00013b00: 0a20 2020 2020 2020 2020 2020 2069 665f  .            if_
-00013b10: 6578 6973 7473 3d69 665f 6578 6973 7473  exists=if_exists
-00013b20: 2c0a 2020 2020 2020 2020 2020 2020 696e  ,.            in
-00013b30: 6465 783d 696e 6465 782c 0a20 2020 2020  dex=index,.     
-00013b40: 2020 2020 2020 2069 6e64 6578 5f6c 6162         index_lab
-00013b50: 656c 3d69 6e64 6578 5f6c 6162 656c 2c0a  el=index_label,.
-00013b60: 2020 2020 2020 2020 2020 2020 6368 756e              chun
-00013b70: 6b73 697a 653d 6368 756e 6b73 697a 652c  ksize=chunksize,
-00013b80: 0a20 2020 2020 2020 2020 2020 2064 7479  .            dty
-00013b90: 7065 3d64 7479 7065 2c0a 2020 2020 2020  pe=dtype,.      
-00013ba0: 2020 2020 2020 6d65 7468 6f64 3d6d 6574        method=met
-00013bb0: 686f 642c 0a20 2020 2020 2020 2020 2020  hod,.           
-00013bc0: 2063 6f6d 7075 7465 3d63 6f6d 7075 7465   compute=compute
-00013bd0: 2c0a 2020 2020 2020 2020 2020 2020 7061  ,.            pa
-00013be0: 7261 6c6c 656c 3d70 6172 616c 6c65 6c2c  rallel=parallel,
-00013bf0: 0a20 2020 2020 2020 2020 2020 2065 6e67  .            eng
-00013c00: 696e 655f 6b77 6172 6773 3d65 6e67 696e  ine_kwargs=engin
-00013c10: 655f 6b77 6172 6773 2c0a 2020 2020 2020  e_kwargs,.      
-00013c20: 2020 290a 0a20 2020 2064 6566 2074 6f5f    )..    def to_
-00013c30: 6f72 6328 7365 6c66 2c20 7061 7468 2c20  orc(self, path, 
-00013c40: 2a61 7267 732c 202a 2a6b 7761 7267 7329  *args, **kwargs)
-00013c50: 3a0a 2020 2020 2020 2020 2222 2253 6565  :.        """See
-00013c60: 2064 642e 746f 5f6f 7263 2064 6f63 7374   dd.to_orc docst
-00013c70: 7269 6e67 2066 6f72 206d 6f72 6520 696e  ring for more in
-00013c80: 666f 726d 6174 696f 6e22 2222 0a20 2020  formation""".   
-00013c90: 2020 2020 2066 726f 6d20 6461 736b 5f65       from dask_e
-00013ca0: 7870 722e 696f 2e6f 7263 2069 6d70 6f72  xpr.io.orc impor
-00013cb0: 7420 746f 5f6f 7263 0a0a 2020 2020 2020  t to_orc..      
-00013cc0: 2020 7265 7475 726e 2074 6f5f 6f72 6328    return to_orc(
-00013cd0: 7365 6c66 2c20 7061 7468 2c20 2a61 7267  self, path, *arg
-00013ce0: 732c 202a 2a6b 7761 7267 7329 0a0a 2020  s, **kwargs)..  
-00013cf0: 2020 6465 6620 746f 5f63 7376 2873 656c    def to_csv(sel
-00013d00: 662c 2066 696c 656e 616d 652c 202a 2a6b  f, filename, **k
-00013d10: 7761 7267 7329 3a0a 2020 2020 2020 2020  wargs):.        
-00013d20: 2222 2253 6565 2064 642e 746f 5f63 7376  """See dd.to_csv
-00013d30: 2064 6f63 7374 7269 6e67 2066 6f72 206d   docstring for m
-00013d40: 6f72 6520 696e 666f 726d 6174 696f 6e22  ore information"
-00013d50: 2222 0a20 2020 2020 2020 2066 726f 6d20  "".        from 
-00013d60: 6461 736b 5f65 7870 722e 696f 2e63 7376  dask_expr.io.csv
-00013d70: 2069 6d70 6f72 7420 746f 5f63 7376 0a0a   import to_csv..
-00013d80: 2020 2020 2020 2020 7265 7475 726e 2074          return t
-00013d90: 6f5f 6373 7628 7365 6c66 2c20 6669 6c65  o_csv(self, file
-00013da0: 6e61 6d65 2c20 2a2a 6b77 6172 6773 290a  name, **kwargs).
-00013db0: 0a20 2020 2064 6566 2074 6f5f 7265 636f  .    def to_reco
-00013dc0: 7264 7328 7365 6c66 2c20 696e 6465 783d  rds(self, index=
-00013dd0: 4661 6c73 652c 206c 656e 6774 6873 3d4e  False, lengths=N
-00013de0: 6f6e 6529 3a0a 2020 2020 2020 2020 6672  one):.        fr
-00013df0: 6f6d 2064 6173 6b5f 6578 7072 2e69 6f2e  om dask_expr.io.
-00013e00: 7265 636f 7264 7320 696d 706f 7274 2074  records import t
-00013e10: 6f5f 7265 636f 7264 730a 0a20 2020 2020  o_records..     
-00013e20: 2020 2069 6620 6c65 6e67 7468 7320 6973     if lengths is
-00013e30: 2054 7275 653a 0a20 2020 2020 2020 2020   True:.         
-00013e40: 2020 206c 656e 6774 6873 203d 2074 7570     lengths = tup
-00013e50: 6c65 2873 656c 662e 6d61 705f 7061 7274  le(self.map_part
-00013e60: 6974 696f 6e73 286c 656e 292e 636f 6d70  itions(len).comp
-00013e70: 7574 6528 2929 0a0a 2020 2020 2020 2020  ute())..        
-00013e80: 6672 616d 6520 3d20 7365 6c66 2e74 6f5f  frame = self.to_
-00013e90: 6461 736b 5f64 6174 6166 7261 6d65 2829  dask_dataframe()
-00013ea0: 0a20 2020 2020 2020 2072 6563 6f72 6473  .        records
-00013eb0: 203d 2074 6f5f 7265 636f 7264 7328 6672   = to_records(fr
-00013ec0: 616d 6529 0a0a 2020 2020 2020 2020 6368  ame)..        ch
-00013ed0: 756e 6b73 203d 2066 7261 6d65 2e5f 7661  unks = frame._va
-00013ee0: 6c69 6461 7465 5f63 6875 6e6b 7328 7265  lidate_chunks(re
-00013ef0: 636f 7264 732c 206c 656e 6774 6873 290a  cords, lengths).
-00013f00: 2020 2020 2020 2020 7265 636f 7264 732e          records.
-00013f10: 5f63 6875 6e6b 7320 3d20 2863 6875 6e6b  _chunks = (chunk
-00013f20: 735b 305d 2c29 0a0a 2020 2020 2020 2020  s[0],)..        
-00013f30: 7265 7475 726e 2072 6563 6f72 6473 0a0a  return records..
-00013f40: 2020 2020 6465 6620 746f 5f62 6167 2873      def to_bag(s
-00013f50: 656c 662c 2069 6e64 6578 3d46 616c 7365  elf, index=False
-00013f60: 2c20 666f 726d 6174 3d22 7475 706c 6522  , format="tuple"
-00013f70: 293a 0a20 2020 2020 2020 2022 2222 4372  ):.        """Cr
-00013f80: 6561 7465 2061 2044 6173 6b20 4261 6720  eate a Dask Bag 
-00013f90: 6672 6f6d 2061 2053 6572 6965 7322 2222  from a Series"""
-00013fa0: 0a20 2020 2020 2020 2066 726f 6d20 6461  .        from da
-00013fb0: 736b 5f65 7870 722e 696f 2e62 6167 2069  sk_expr.io.bag i
-00013fc0: 6d70 6f72 7420 746f 5f62 6167 0a0a 2020  mport to_bag..  
-00013fd0: 2020 2020 2020 7265 7475 726e 2074 6f5f        return to_
-00013fe0: 6261 6728 7365 6c66 2c20 696e 6465 782c  bag(self, index,
-00013ff0: 2066 6f72 6d61 743d 666f 726d 6174 290a   format=format).
-00014000: 0a20 2020 2064 6566 2074 6f5f 6864 6628  .    def to_hdf(
-00014010: 7365 6c66 2c20 7061 7468 5f6f 725f 6275  self, path_or_bu
-00014020: 662c 206b 6579 2c20 6d6f 6465 3d22 6122  f, key, mode="a"
-00014030: 2c20 6170 7065 6e64 3d46 616c 7365 2c20  , append=False, 
-00014040: 2a2a 6b77 6172 6773 293a 0a20 2020 2020  **kwargs):.     
-00014050: 2020 2022 2222 5365 6520 6464 2e74 6f5f     """See dd.to_
-00014060: 6864 6620 646f 6373 7472 696e 6720 666f  hdf docstring fo
-00014070: 7220 6d6f 7265 2069 6e66 6f72 6d61 7469  r more informati
-00014080: 6f6e 2222 220a 2020 2020 2020 2020 6672  on""".        fr
-00014090: 6f6d 2064 6173 6b5f 6578 7072 2e69 6f2e  om dask_expr.io.
-000140a0: 6864 6620 696d 706f 7274 2074 6f5f 6864  hdf import to_hd
-000140b0: 660a 0a20 2020 2020 2020 2072 6574 7572  f..        retur
-000140c0: 6e20 746f 5f68 6466 2873 656c 662c 2070  n to_hdf(self, p
-000140d0: 6174 685f 6f72 5f62 7566 2c20 6b65 792c  ath_or_buf, key,
-000140e0: 206d 6f64 652c 2061 7070 656e 642c 202a   mode, append, *
-000140f0: 2a6b 7761 7267 7329 0a0a 2020 2020 6465  *kwargs)..    de
-00014100: 6620 746f 5f64 656c 6179 6564 2873 656c  f to_delayed(sel
-00014110: 662c 206f 7074 696d 697a 655f 6772 6170  f, optimize_grap
-00014120: 683d 5472 7565 293a 0a20 2020 2020 2020  h=True):.       
-00014130: 2022 2222 436f 6e76 6572 7420 696e 746f   """Convert into
-00014140: 2061 206c 6973 7420 6f66 2060 6064 6173   a list of ``das
-00014150: 6b2e 6465 6c61 7965 6460 6020 6f62 6a65  k.delayed`` obje
-00014160: 6374 732c 206f 6e65 2070 6572 2070 6172  cts, one per par
-00014170: 7469 7469 6f6e 2e0a 0a20 2020 2020 2020  tition...       
-00014180: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-00014190: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
-000141a0: 2020 2020 2020 206f 7074 696d 697a 655f         optimize_
-000141b0: 6772 6170 6820 3a20 626f 6f6c 2c20 6f70  graph : bool, op
-000141c0: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
-000141d0: 2020 2049 6620 5472 7565 205b 6465 6661     If True [defa
-000141e0: 756c 745d 2c20 7468 6520 6772 6170 6820  ult], the graph 
-000141f0: 6973 206f 7074 696d 697a 6564 2062 6566  is optimized bef
-00014200: 6f72 6520 636f 6e76 6572 7469 6e67 2069  ore converting i
-00014210: 6e74 6f0a 2020 2020 2020 2020 2020 2020  nto.            
-00014220: 6060 6461 736b 2e64 656c 6179 6564 6060  ``dask.delayed``
-00014230: 206f 626a 6563 7473 2e0a 0a20 2020 2020   objects...     
-00014240: 2020 2045 7861 6d70 6c65 730a 2020 2020     Examples.    
-00014250: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
-00014260: 2020 2020 203e 3e3e 2070 6172 7469 7469       >>> partiti
-00014270: 6f6e 7320 3d20 6466 2e74 6f5f 6465 6c61  ons = df.to_dela
-00014280: 7965 6428 2920 2023 2064 6f63 7465 7374  yed()  # doctest
-00014290: 3a20 2b53 4b49 500a 0a20 2020 2020 2020  : +SKIP..       
-000142a0: 2053 6565 2041 6c73 6f0a 2020 2020 2020   See Also.      
-000142b0: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020    --------.     
-000142c0: 2020 2064 6173 6b5f 6578 7072 2e66 726f     dask_expr.fro
-000142d0: 6d5f 6465 6c61 7965 640a 2020 2020 2020  m_delayed.      
-000142e0: 2020 2222 220a 2020 2020 2020 2020 7265    """.        re
-000142f0: 7475 726e 2073 656c 662e 746f 5f64 6173  turn self.to_das
-00014300: 6b5f 6461 7461 6672 616d 6528 292e 746f  k_dataframe().to
-00014310: 5f64 656c 6179 6564 286f 7074 696d 697a  _delayed(optimiz
-00014320: 655f 6772 6170 683d 6f70 7469 6d69 7a65  e_graph=optimize
-00014330: 5f67 7261 7068 290a 0a20 2020 2064 6566  _graph)..    def
-00014340: 2074 6f5f 6261 636b 656e 6428 7365 6c66   to_backend(self
-00014350: 2c20 6261 636b 656e 643a 2073 7472 207c  , backend: str |
-00014360: 204e 6f6e 6520 3d20 4e6f 6e65 2c20 2a2a   None = None, **
-00014370: 6b77 6172 6773 293a 0a20 2020 2020 2020  kwargs):.       
-00014380: 2022 2222 4d6f 7665 2074 6f20 6120 6e65   """Move to a ne
-00014390: 7720 4461 7461 4672 616d 6520 6261 636b  w DataFrame back
-000143a0: 656e 640a 0a20 2020 2020 2020 2050 6172  end..        Par
-000143b0: 616d 6574 6572 730a 2020 2020 2020 2020  ameters.        
-000143c0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-000143d0: 2020 2062 6163 6b65 6e64 203a 2073 7472     backend : str
-000143e0: 2c20 4f70 7469 6f6e 616c 0a20 2020 2020  , Optional.     
-000143f0: 2020 2020 2020 2054 6865 206e 616d 6520         The name 
-00014400: 6f66 2074 6865 206e 6577 2062 6163 6b65  of the new backe
-00014410: 6e64 2074 6f20 6d6f 7665 2074 6f2e 2054  nd to move to. T
-00014420: 6865 2064 6566 6175 6c74 0a20 2020 2020  he default.     
-00014430: 2020 2020 2020 2069 7320 7468 6520 6375         is the cu
-00014440: 7272 656e 7420 2264 6174 6166 7261 6d65  rrent "dataframe
-00014450: 2e62 6163 6b65 6e64 2220 636f 6e66 6967  .backend" config
-00014460: 7572 6174 696f 6e2e 0a0a 2020 2020 2020  uration...      
-00014470: 2020 5265 7475 726e 730a 2020 2020 2020    Returns.      
-00014480: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 2020    -------.      
-00014490: 2020 4461 7461 4672 616d 652c 2053 6572    DataFrame, Ser
-000144a0: 6965 7320 6f72 2049 6e64 6578 0a20 2020  ies or Index.   
-000144b0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-000144c0: 2066 726f 6d20 6461 736b 5f65 7870 722e   from dask_expr.
-000144d0: 5f62 6163 6b65 6e64 7320 696d 706f 7274  _backends import
-000144e0: 2064 6174 6166 7261 6d65 5f63 7265 6174   dataframe_creat
-000144f0: 696f 6e5f 6469 7370 6174 6368 0a0a 2020  ion_dispatch..  
-00014500: 2020 2020 2020 2320 4765 7420 6465 7369        # Get desi
-00014510: 7265 6420 6261 636b 656e 640a 2020 2020  red backend.    
-00014520: 2020 2020 6261 636b 656e 6420 3d20 6261      backend = ba
-00014530: 636b 656e 6420 6f72 2064 6174 6166 7261  ckend or datafra
-00014540: 6d65 5f63 7265 6174 696f 6e5f 6469 7370  me_creation_disp
-00014550: 6174 6368 2e62 6163 6b65 6e64 0a20 2020  atch.backend.   
-00014560: 2020 2020 2023 2043 6865 636b 2074 6861       # Check tha
-00014570: 7420 2262 6163 6b65 6e64 2220 6861 7320  t "backend" has 
-00014580: 6120 7265 6769 7374 6572 6564 2065 6e74  a registered ent
-00014590: 7279 706f 696e 740a 2020 2020 2020 2020  rypoint.        
-000145a0: 6261 636b 656e 645f 656e 7472 7970 6f69  backend_entrypoi
-000145b0: 6e74 203d 2064 6174 6166 7261 6d65 5f63  nt = dataframe_c
-000145c0: 7265 6174 696f 6e5f 6469 7370 6174 6368  reation_dispatch
-000145d0: 2e64 6973 7061 7463 6828 6261 636b 656e  .dispatch(backen
-000145e0: 6429 0a20 2020 2020 2020 2023 2043 616c  d).        # Cal
-000145f0: 6c20 6044 6174 6146 7261 6d65 4261 636b  l `DataFrameBack
-00014600: 656e 6445 6e74 7279 706f 696e 742e 746f  endEntrypoint.to
-00014610: 5f62 6163 6b65 6e64 600a 2020 2020 2020  _backend`.      
-00014620: 2020 7265 7475 726e 2062 6163 6b65 6e64    return backend
-00014630: 5f65 6e74 7279 706f 696e 742e 746f 5f62  _entrypoint.to_b
-00014640: 6163 6b65 6e64 2873 656c 662c 202a 2a6b  ackend(self, **k
-00014650: 7761 7267 7329 0a0a 2020 2020 4064 6572  wargs)..    @der
-00014660: 6976 6564 5f66 726f 6d28 7064 2e53 6572  ived_from(pd.Ser
-00014670: 6965 7329 0a20 2020 2064 6566 2064 6f74  ies).    def dot
-00014680: 2873 656c 662c 206f 7468 6572 2c20 6d65  (self, other, me
-00014690: 7461 3d6e 6f5f 6465 6661 756c 7429 3a0a  ta=no_default):.
-000146a0: 2020 2020 2020 2020 6966 206e 6f74 2069          if not i
-000146b0: 7369 6e73 7461 6e63 6528 6f74 6865 722c  sinstance(other,
-000146c0: 2046 7261 6d65 4261 7365 293a 0a20 2020   FrameBase):.   
-000146d0: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
-000146e0: 7970 6545 7272 6f72 2822 5468 6520 7365  ypeError("The se
-000146f0: 636f 6e64 206f 7065 7261 6e64 206d 7573  cond operand mus
-00014700: 7420 6265 2061 2064 6173 6b20 6461 7461  t be a dask data
-00014710: 6672 616d 6522 290a 0a20 2020 2020 2020  frame")..       
-00014720: 2069 6620 6973 696e 7374 616e 6365 286f   if isinstance(o
-00014730: 7468 6572 2c20 4461 7461 4672 616d 6529  ther, DataFrame)
-00014740: 3a0a 2020 2020 2020 2020 2020 2020 7320  :.            s 
-00014750: 3d20 7365 6c66 2e6d 6170 5f70 6172 7469  = self.map_parti
-00014760: 7469 6f6e 7328 4d2e 646f 742c 206f 7468  tions(M.dot, oth
-00014770: 6572 2c20 6d65 7461 3d6d 6574 6129 0a20  er, meta=meta). 
-00014780: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00014790: 6e20 732e 6772 6f75 7062 7928 6279 3d73  n s.groupby(by=s
-000147a0: 2e69 6e64 6578 292e 6170 706c 7928 0a20  .index).apply(. 
-000147b0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-000147c0: 616d 6264 6120 783a 2078 2e73 756d 2873  ambda x: x.sum(s
-000147d0: 6b69 706e 613d 4661 6c73 6529 2c20 6d65  kipna=False), me
-000147e0: 7461 3d73 2e5f 6d65 7461 5f6e 6f6e 656d  ta=s._meta_nonem
-000147f0: 7074 790a 2020 2020 2020 2020 2020 2020  pty.            
-00014800: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
-00014810: 6e20 7365 6c66 2e6d 6170 5f70 6172 7469  n self.map_parti
-00014820: 7469 6f6e 7328 5f64 6f74 5f73 6572 6965  tions(_dot_serie
-00014830: 732c 206f 7468 6572 2c20 6d65 7461 3d6d  s, other, meta=m
-00014840: 6574 6129 2e73 756d 2873 6b69 706e 613d  eta).sum(skipna=
-00014850: 4661 6c73 6529 0a0a 2020 2020 4064 6572  False)..    @der
-00014860: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
-00014870: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
-00014880: 7069 7065 2873 656c 662c 2066 756e 632c  pipe(self, func,
-00014890: 202a 6172 6773 2c20 2a2a 6b77 6172 6773   *args, **kwargs
-000148a0: 293a 0a20 2020 2020 2020 2069 6620 6973  ):.        if is
-000148b0: 696e 7374 616e 6365 2866 756e 632c 2074  instance(func, t
-000148c0: 7570 6c65 293a 0a20 2020 2020 2020 2020  uple):.         
-000148d0: 2020 2066 756e 632c 2074 6172 6765 7420     func, target 
-000148e0: 3d20 6675 6e63 0a20 2020 2020 2020 2020  = func.         
-000148f0: 2020 2069 6620 7461 7267 6574 2069 6e20     if target in 
-00014900: 6b77 6172 6773 3a0a 2020 2020 2020 2020  kwargs:.        
-00014910: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-00014920: 6c75 6545 7272 6f72 280a 2020 2020 2020  lueError(.      
-00014930: 2020 2020 2020 2020 2020 2020 2020 2225                "%
-00014940: 7320 6973 2062 6f74 6820 7468 6520 7069  s is both the pi
-00014950: 7065 2074 6172 6765 7420 616e 6420 6120  pe target and a 
-00014960: 6b65 7977 6f72 6420 6172 6775 6d65 6e74  keyword argument
-00014970: 2220 2520 7461 7267 6574 0a20 2020 2020  " % target.     
-00014980: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00014990: 2020 2020 2020 2020 206b 7761 7267 735b           kwargs[
-000149a0: 7461 7267 6574 5d20 3d20 7365 6c66 0a20  target] = self. 
-000149b0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-000149c0: 6e20 6675 6e63 282a 6172 6773 2c20 2a2a  n func(*args, **
-000149d0: 6b77 6172 6773 290a 2020 2020 2020 2020  kwargs).        
-000149e0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-000149f0: 2020 7265 7475 726e 2066 756e 6328 7365    return func(se
-00014a00: 6c66 2c20 2a61 7267 732c 202a 2a6b 7761  lf, *args, **kwa
-00014a10: 7267 7329 0a0a 2020 2020 6465 6620 7361  rgs)..    def sa
-00014a20: 6d70 6c65 2873 656c 662c 206e 3d4e 6f6e  mple(self, n=Non
-00014a30: 652c 2066 7261 633d 4e6f 6e65 2c20 7265  e, frac=None, re
-00014a40: 706c 6163 653d 4661 6c73 652c 2072 616e  place=False, ran
-00014a50: 646f 6d5f 7374 6174 653d 4e6f 6e65 293a  dom_state=None):
-00014a60: 0a20 2020 2020 2020 2022 2222 5261 6e64  .        """Rand
-00014a70: 6f6d 2073 616d 706c 6520 6f66 2069 7465  om sample of ite
-00014a80: 6d73 0a0a 2020 2020 2020 2020 5061 7261  ms..        Para
-00014a90: 6d65 7465 7273 0a20 2020 2020 2020 202d  meters.        -
-00014aa0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-00014ab0: 2020 6e20 3a20 696e 742c 206f 7074 696f    n : int, optio
-00014ac0: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
-00014ad0: 4e75 6d62 6572 206f 6620 6974 656d 7320  Number of items 
-00014ae0: 746f 2072 6574 7572 6e20 6973 206e 6f74  to return is not
-00014af0: 2073 7570 706f 7274 6564 2062 7920 6461   supported by da
-00014b00: 736b 2e20 5573 6520 6672 6163 0a20 2020  sk. Use frac.   
-00014b10: 2020 2020 2020 2020 2069 6e73 7465 6164           instead
-00014b20: 2e0a 2020 2020 2020 2020 6672 6163 203a  ..        frac :
-00014b30: 2066 6c6f 6174 2c20 6f70 7469 6f6e 616c   float, optional
-00014b40: 0a20 2020 2020 2020 2020 2020 2041 7070  .            App
-00014b50: 726f 7869 6d61 7465 2066 7261 6374 696f  roximate fractio
-00014b60: 6e20 6f66 2069 7465 6d73 2074 6f20 7265  n of items to re
-00014b70: 7475 726e 2e20 5468 6973 2073 616d 706c  turn. This sampl
-00014b80: 696e 6720 6672 6163 7469 6f6e 2069 730a  ing fraction is.
-00014b90: 2020 2020 2020 2020 2020 2020 6170 706c              appl
-00014ba0: 6965 6420 746f 2061 6c6c 2070 6172 7469  ied to all parti
-00014bb0: 7469 6f6e 7320 6571 7561 6c6c 792e 204e  tions equally. N
-00014bc0: 6f74 6520 7468 6174 2074 6869 7320 6973  ote that this is
-00014bd0: 2061 6e0a 2020 2020 2020 2020 2020 2020   an.            
-00014be0: 2a2a 6170 7072 6f78 696d 6174 6520 6672  **approximate fr
-00014bf0: 6163 7469 6f6e 2a2a 2e20 596f 7520 7368  action**. You sh
-00014c00: 6f75 6c64 206e 6f74 2065 7870 6563 7420  ould not expect 
-00014c10: 6578 6163 746c 7920 6060 6c65 6e28 6466  exactly ``len(df
-00014c20: 2920 2a20 6672 6163 6060 0a20 2020 2020  ) * frac``.     
-00014c30: 2020 2020 2020 2069 7465 6d73 2074 6f20         items to 
-00014c40: 6265 2072 6574 7572 6e65 642c 2061 7320  be returned, as 
-00014c50: 7468 6520 6578 6163 7420 6e75 6d62 6572  the exact number
-00014c60: 206f 6620 656c 656d 656e 7473 2073 656c   of elements sel
-00014c70: 6563 7465 6420 7769 6c6c 0a20 2020 2020  ected will.     
-00014c80: 2020 2020 2020 2064 6570 656e 6420 6f6e         depend on
-00014c90: 2068 6f77 2079 6f75 7220 6461 7461 2069   how your data i
-00014ca0: 7320 7061 7274 6974 696f 6e65 6420 2862  s partitioned (b
-00014cb0: 7574 2073 686f 756c 6420 6265 2070 7265  ut should be pre
-00014cc0: 7474 7920 636c 6f73 650a 2020 2020 2020  tty close.      
-00014cd0: 2020 2020 2020 696e 2070 7261 6374 6963        in practic
-00014ce0: 6529 2e0a 2020 2020 2020 2020 7265 706c  e)..        repl
-00014cf0: 6163 6520 3a20 626f 6f6c 6561 6e2c 206f  ace : boolean, o
-00014d00: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
-00014d10: 2020 2020 5361 6d70 6c65 2077 6974 6820      Sample with 
-00014d20: 6f72 2077 6974 686f 7574 2072 6570 6c61  or without repla
-00014d30: 6365 6d65 6e74 2e20 4465 6661 756c 7420  cement. Default 
-00014d40: 3d20 4661 6c73 652e 0a20 2020 2020 2020  = False..       
-00014d50: 2072 616e 646f 6d5f 7374 6174 6520 3a20   random_state : 
-00014d60: 696e 7420 6f72 2060 606e 702e 7261 6e64  int or ``np.rand
-00014d70: 6f6d 2e52 616e 646f 6d53 7461 7465 6060  om.RandomState``
-00014d80: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
-00014d90: 616e 2069 6e74 2c20 7765 2063 7265 6174  an int, we creat
-00014da0: 6520 6120 6e65 7720 5261 6e64 6f6d 5374  e a new RandomSt
-00014db0: 6174 6520 7769 7468 2074 6869 7320 6173  ate with this as
-00014dc0: 2074 6865 2073 6565 643b 0a20 2020 2020   the seed;.     
-00014dd0: 2020 2020 2020 204f 7468 6572 7769 7365         Otherwise
-00014de0: 2077 6520 6472 6177 2066 726f 6d20 7468   we draw from th
-00014df0: 6520 7061 7373 6564 2052 616e 646f 6d53  e passed RandomS
-00014e00: 7461 7465 2e0a 0a20 2020 2020 2020 2053  tate...        S
-00014e10: 6565 2041 6c73 6f0a 2020 2020 2020 2020  ee Also.        
-00014e20: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00014e30: 2044 6174 6146 7261 6d65 2e72 616e 646f   DataFrame.rando
-00014e40: 6d5f 7370 6c69 740a 2020 2020 2020 2020  m_split.        
-00014e50: 7061 6e64 6173 2e44 6174 6146 7261 6d65  pandas.DataFrame
-00014e60: 2e73 616d 706c 650a 2020 2020 2020 2020  .sample.        
-00014e70: 2222 220a 2020 2020 2020 2020 6966 206e  """.        if n
-00014e80: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-00014e90: 2020 2020 2020 2020 2020 6d73 6720 3d20            msg = 
-00014ea0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00014eb0: 2020 2273 616d 706c 6520 646f 6573 206e    "sample does n
-00014ec0: 6f74 2073 7570 706f 7274 2074 6865 206e  ot support the n
-00014ed0: 756d 6265 7220 6f66 2073 616d 706c 6564  umber of sampled
-00014ee0: 2069 7465 6d73 2022 0a20 2020 2020 2020   items ".       
-00014ef0: 2020 2020 2020 2020 2022 7061 7261 6d65           "parame
-00014f00: 7465 722c 2027 6e27 2e20 506c 6561 7365  ter, 'n'. Please
-00014f10: 2075 7365 2074 6865 2027 6672 6163 2720   use the 'frac' 
-00014f20: 7061 7261 6d65 7465 7220 696e 7374 6561  parameter instea
-00014f30: 642e 220a 2020 2020 2020 2020 2020 2020  d.".            
-00014f40: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
-00014f50: 2069 7369 6e73 7461 6e63 6528 6e2c 204e   isinstance(n, N
-00014f60: 756d 6265 7229 2061 6e64 2030 203c 3d20  umber) and 0 <= 
-00014f70: 6e20 3c3d 2031 3a0a 2020 2020 2020 2020  n <= 1:.        
-00014f80: 2020 2020 2020 2020 7761 726e 696e 6773          warnings
-00014f90: 2e77 6172 6e28 6d73 6729 0a20 2020 2020  .warn(msg).     
-00014fa0: 2020 2020 2020 2020 2020 2066 7261 6320             frac 
-00014fb0: 3d20 6e0a 2020 2020 2020 2020 2020 2020  = n.            
-00014fc0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00014fd0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-00014fe0: 6545 7272 6f72 286d 7367 290a 0a20 2020  eError(msg)..   
-00014ff0: 2020 2020 2069 6620 6672 6163 2069 7320       if frac is 
-00015000: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-00015010: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-00015020: 6f72 2822 6672 6163 206d 7573 7420 6e6f  or("frac must no
-00015030: 7420 6265 204e 6f6e 6522 290a 0a20 2020  t be None")..   
-00015040: 2020 2020 2069 6620 7261 6e64 6f6d 5f73       if random_s
-00015050: 7461 7465 2069 7320 4e6f 6e65 3a0a 2020  tate is None:.  
-00015060: 2020 2020 2020 2020 2020 7261 6e64 6f6d            random
-00015070: 5f73 7461 7465 203d 206e 702e 7261 6e64  _state = np.rand
-00015080: 6f6d 2e52 616e 646f 6d53 7461 7465 2829  om.RandomState()
-00015090: 0a0a 2020 2020 2020 2020 7374 6174 655f  ..        state_
-000150a0: 6461 7461 203d 2072 616e 646f 6d5f 7374  data = random_st
-000150b0: 6174 655f 6461 7461 2873 656c 662e 6e70  ate_data(self.np
-000150c0: 6172 7469 7469 6f6e 732c 2072 616e 646f  artitions, rando
-000150d0: 6d5f 7374 6174 6529 0a20 2020 2020 2020  m_state).       
-000150e0: 2072 6574 7572 6e20 6e65 775f 636f 6c6c   return new_coll
-000150f0: 6563 7469 6f6e 280a 2020 2020 2020 2020  ection(.        
-00015100: 2020 2020 6578 7072 2e53 616d 706c 6528      expr.Sample(
-00015110: 7365 6c66 2c20 7374 6174 655f 6461 7461  self, state_data
-00015120: 3d73 7461 7465 5f64 6174 612c 2066 7261  =state_data, fra
-00015130: 633d 6672 6163 2c20 7265 706c 6163 653d  c=frac, replace=
-00015140: 7265 706c 6163 6529 0a20 2020 2020 2020  replace).       
-00015150: 2029 0a0a 2020 2020 6465 6620 5f72 6570   )..    def _rep
-00015160: 725f 6461 7461 2873 656c 6629 3a0a 2020  r_data(self):.  
-00015170: 2020 2020 2020 7261 6973 6520 4e6f 7449        raise NotI
-00015180: 6d70 6c65 6d65 6e74 6564 4572 726f 720a  mplementedError.
-00015190: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
-000151a0: 2020 2064 6566 205f 7265 7072 5f64 6976     def _repr_div
-000151b0: 6973 696f 6e73 2873 656c 6629 3a0a 2020  isions(self):.  
-000151c0: 2020 2020 2020 6e61 6d65 203d 2066 226e        name = f"n
-000151d0: 7061 7274 6974 696f 6e73 3d7b 7365 6c66  partitions={self
-000151e0: 2e6e 7061 7274 6974 696f 6e73 7d22 0a20  .npartitions}". 
-000151f0: 2020 2020 2020 2069 6620 7365 6c66 2e6b         if self.k
-00015200: 6e6f 776e 5f64 6976 6973 696f 6e73 3a0a  nown_divisions:.
-00015210: 2020 2020 2020 2020 2020 2020 6469 7669              divi
-00015220: 7369 6f6e 7320 3d20 7064 2e49 6e64 6578  sions = pd.Index
-00015230: 2873 656c 662e 6469 7669 7369 6f6e 732c  (self.divisions,
-00015240: 206e 616d 653d 6e61 6d65 290a 2020 2020   name=name).    
-00015250: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00015260: 2020 2020 2020 2320 6176 6f69 6420 746f        # avoid to
-00015270: 2062 6520 636f 6e76 6572 7465 6420 746f   be converted to
-00015280: 204e 614e 0a20 2020 2020 2020 2020 2020   NaN.           
-00015290: 2064 6976 6973 696f 6e73 203d 2070 642e   divisions = pd.
-000152a0: 496e 6465 7828 5b22 225d 202a 2028 7365  Index([""] * (se
-000152b0: 6c66 2e6e 7061 7274 6974 696f 6e73 202b  lf.npartitions +
-000152c0: 2031 292c 206e 616d 653d 6e61 6d65 290a   1), name=name).
-000152d0: 2020 2020 2020 2020 7265 7475 726e 2064          return d
-000152e0: 6976 6973 696f 6e73 0a0a 0a64 6566 205f  ivisions...def _
-000152f0: 646f 745f 7365 7269 6573 282a 6172 6773  dot_series(*args
-00015300: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
-00015310: 2023 202e 7375 6d28 2920 6973 2069 6e76   # .sum() is inv
-00015320: 6f6b 6564 206f 6e20 6561 6368 2070 6172  oked on each par
-00015330: 7469 7469 6f6e 2062 6566 6f72 6520 6265  tition before be
-00015340: 696e 6720 6170 706c 6965 6420 746f 2061  ing applied to a
-00015350: 6c6c 0a20 2020 2023 2070 6172 7469 7469  ll.    # partiti
-00015360: 6f6e 732e 2054 6865 2072 6574 7572 6e20  ons. The return 
-00015370: 7479 7065 2069 7320 6578 7065 6374 6564  type is expected
-00015380: 2074 6f20 6265 2061 2073 6572 6965 732c   to be a series,
-00015390: 206e 6f74 2061 206e 756d 7079 206f 626a   not a numpy obj
-000153a0: 6563 740a 2020 2020 7265 7475 726e 206d  ect.    return m
-000153b0: 6574 615f 7365 7269 6573 5f63 6f6e 7374  eta_series_const
-000153c0: 7275 6374 6f72 2861 7267 735b 305d 2928  ructor(args[0])(
-000153d0: 4d2e 646f 7428 2a61 7267 732c 202a 2a6b  M.dot(*args, **k
-000153e0: 7761 7267 7329 290a 0a0a 2320 4164 6420  wargs))...# Add 
-000153f0: 6f70 6572 6174 6f72 2061 7474 7269 6275  operator attribu
-00015400: 7465 730a 666f 7220 6f70 2069 6e20 5b0a  tes.for op in [.
-00015410: 2020 2020 225f 5f61 6464 5f5f 222c 0a20      "__add__",. 
-00015420: 2020 2022 5f5f 7261 6464 5f5f 222c 0a20     "__radd__",. 
-00015430: 2020 2022 5f5f 7375 625f 5f22 2c0a 2020     "__sub__",.  
-00015440: 2020 225f 5f72 7375 625f 5f22 2c0a 2020    "__rsub__",.  
-00015450: 2020 225f 5f6d 756c 5f5f 222c 0a20 2020    "__mul__",.   
-00015460: 2022 5f5f 726d 756c 5f5f 222c 0a20 2020   "__rmul__",.   
-00015470: 2022 5f5f 6d6f 645f 5f22 2c0a 2020 2020   "__mod__",.    
-00015480: 225f 5f72 6d6f 645f 5f22 2c0a 2020 2020  "__rmod__",.    
-00015490: 225f 5f66 6c6f 6f72 6469 765f 5f22 2c0a  "__floordiv__",.
-000154a0: 2020 2020 225f 5f72 666c 6f6f 7264 6976      "__rfloordiv
-000154b0: 5f5f 222c 0a20 2020 2022 5f5f 7472 7565  __",.    "__true
-000154c0: 6469 765f 5f22 2c0a 2020 2020 225f 5f72  div__",.    "__r
-000154d0: 7472 7565 6469 765f 5f22 2c0a 2020 2020  truediv__",.    
-000154e0: 225f 5f70 6f77 5f5f 222c 0a20 2020 2022  "__pow__",.    "
-000154f0: 5f5f 7270 6f77 5f5f 222c 0a20 2020 2022  __rpow__",.    "
-00015500: 5f5f 6c74 5f5f 222c 0a20 2020 2022 5f5f  __lt__",.    "__
-00015510: 726c 745f 5f22 2c0a 2020 2020 225f 5f67  rlt__",.    "__g
-00015520: 745f 5f22 2c0a 2020 2020 225f 5f72 6774  t__",.    "__rgt
-00015530: 5f5f 222c 0a20 2020 2022 5f5f 6c65 5f5f  __",.    "__le__
-00015540: 222c 0a20 2020 2022 5f5f 726c 655f 5f22  ",.    "__rle__"
-00015550: 2c0a 2020 2020 225f 5f67 655f 5f22 2c0a  ,.    "__ge__",.
-00015560: 2020 2020 225f 5f72 6765 5f5f 222c 0a20      "__rge__",. 
-00015570: 2020 2022 5f5f 6571 5f5f 222c 0a20 2020     "__eq__",.   
-00015580: 2022 5f5f 6e65 5f5f 222c 0a20 2020 2022   "__ne__",.    "
-00015590: 5f5f 616e 645f 5f22 2c0a 2020 2020 225f  __and__",.    "_
-000155a0: 5f72 616e 645f 5f22 2c0a 2020 2020 225f  _rand__",.    "_
-000155b0: 5f6f 725f 5f22 2c0a 2020 2020 225f 5f72  _or__",.    "__r
-000155c0: 6f72 5f5f 222c 0a20 2020 2022 5f5f 786f  or__",.    "__xo
-000155d0: 725f 5f22 2c0a 2020 2020 225f 5f72 786f  r__",.    "__rxo
-000155e0: 725f 5f22 2c0a 5d3a 0a20 2020 2073 6574  r__",.]:.    set
-000155f0: 6174 7472 2846 7261 6d65 4261 7365 2c20  attr(FrameBase, 
-00015600: 6f70 2c20 6675 6e63 746f 6f6c 732e 7061  op, functools.pa
-00015610: 7274 6961 6c6d 6574 686f 6428 5f77 7261  rtialmethod(_wra
-00015620: 705f 6578 7072 5f6f 702c 206f 703d 6f70  p_expr_op, op=op
-00015630: 2929 0a0a 666f 7220 6f70 2069 6e20 5b0a  ))..for op in [.
-00015640: 2020 2020 225f 5f69 6e76 6572 745f 5f22      "__invert__"
-00015650: 2c0a 2020 2020 225f 5f6e 6567 5f5f 222c  ,.    "__neg__",
-00015660: 0a20 2020 2022 5f5f 706f 735f 5f22 2c0a  .    "__pos__",.
-00015670: 5d3a 0a20 2020 2073 6574 6174 7472 2846  ]:.    setattr(F
-00015680: 7261 6d65 4261 7365 2c20 6f70 2c20 6675  rameBase, op, fu
-00015690: 6e63 746f 6f6c 732e 7061 7274 6961 6c6d  nctools.partialm
-000156a0: 6574 686f 6428 5f77 7261 705f 756e 6172  ethod(_wrap_unar
-000156b0: 795f 6578 7072 5f6f 702c 206f 703d 6f70  y_expr_op, op=op
-000156c0: 2929 0a0a 0a63 6c61 7373 2044 6174 6146  ))...class DataF
-000156d0: 7261 6d65 2846 7261 6d65 4261 7365 293a  rame(FrameBase):
-000156e0: 0a20 2020 2022 2222 4461 7461 4672 616d  .    """DataFram
-000156f0: 652d 6c69 6b65 2045 7870 7220 436f 6c6c  e-like Expr Coll
-00015700: 6563 7469 6f6e 2222 220a 0a20 2020 205f  ection"""..    _
-00015710: 6163 6365 7373 6f72 733a 2043 6c61 7373  accessors: Class
-00015720: 5661 725b 7365 745b 7374 725d 5d20 3d20  Var[set[str]] = 
-00015730: 7365 7428 290a 2020 2020 5f70 6172 7469  set().    _parti
-00015740: 7469 6f6e 5f74 7970 6520 3d20 7064 2e44  tion_type = pd.D
-00015750: 6174 6146 7261 6d65 0a0a 2020 2020 4070  ataFrame..    @p
-00015760: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-00015770: 7368 6170 6528 7365 6c66 293a 0a20 2020  shape(self):.   
-00015780: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00015790: 2e73 697a 6520 2f20 6d61 7828 6c65 6e28  .size / max(len(
-000157a0: 7365 6c66 2e63 6f6c 756d 6e73 292c 2031  self.columns), 1
-000157b0: 292c 206c 656e 2873 656c 662e 636f 6c75  ), len(self.colu
-000157c0: 6d6e 7329 0a0a 2020 2020 4070 726f 7065  mns)..    @prope
-000157d0: 7274 790a 2020 2020 6465 6620 6e64 696d  rty.    def ndim
-000157e0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-000157f0: 2222 2252 6574 7572 6e20 6469 6d65 6e73  """Return dimens
-00015800: 696f 6e61 6c69 7479 2222 220a 2020 2020  ionality""".    
-00015810: 2020 2020 7265 7475 726e 2032 0a0a 2020      return 2..  
-00015820: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
-00015830: 6465 6620 656d 7074 7928 7365 6c66 293a  def empty(self):
-00015840: 0a20 2020 2020 2020 2023 205f 5f67 6574  .        # __get
-00015850: 6174 7472 5f5f 2077 696c 6c20 6265 2063  attr__ will be c
-00015860: 616c 6c65 6420 6166 7465 7220 7765 2072  alled after we r
-00015870: 6169 7365 2074 6869 732c 2073 6f20 7765  aise this, so we
-00015880: 276c 6c20 7261 6973 6520 6974 2061 6761  'll raise it aga
-00015890: 696e 2066 726f 6d20 7468 6572 650a 2020  in from there.  
-000158a0: 2020 2020 2020 7261 6973 6520 4174 7472        raise Attr
-000158b0: 6962 7574 654e 6f74 496d 706c 656d 656e  ibuteNotImplemen
-000158c0: 7465 6445 7272 6f72 280a 2020 2020 2020  tedError(.      
-000158d0: 2020 2020 2020 2243 6865 636b 696e 6720        "Checking 
-000158e0: 7768 6574 6865 7220 6120 4461 736b 2044  whether a Dask D
-000158f0: 6174 6146 7261 6d65 2068 6173 2061 6e79  ataFrame has any
-00015900: 2072 6f77 7320 6d61 7920 6265 2065 7870   rows may be exp
-00015910: 656e 7369 7665 2e20 220a 2020 2020 2020  ensive. ".      
-00015920: 2020 2020 2020 2248 6f77 6576 6572 2c20        "However, 
-00015930: 6368 6563 6b69 6e67 2074 6865 206e 756d  checking the num
-00015940: 6265 7220 6f66 2063 6f6c 756d 6e73 2069  ber of columns i
-00015950: 7320 6661 7374 2e20 220a 2020 2020 2020  s fast. ".      
-00015960: 2020 2020 2020 2244 6570 656e 6469 6e67        "Depending
-00015970: 206f 6e20 7768 6963 6820 6f66 2074 6865   on which of the
-00015980: 7365 2072 6573 756c 7473 2079 6f75 206e  se results you n
-00015990: 6565 642c 2075 7365 2065 6974 6865 7220  eed, use either 
-000159a0: 220a 2020 2020 2020 2020 2020 2020 2260  ".            "`
-000159b0: 6c65 6e28 6466 2e69 6e64 6578 2920 3d3d  len(df.index) ==
-000159c0: 2030 6020 6f72 2060 6c65 6e28 6466 2e63   0` or `len(df.c
-000159d0: 6f6c 756d 6e73 2920 3d3d 2030 6022 0a20  olumns) == 0`". 
-000159e0: 2020 2020 2020 2029 0a0a 2020 2020 4064         )..    @d
-000159f0: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
-00015a00: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
-00015a10: 6620 6974 656d 7328 7365 6c66 293a 0a20  f items(self):. 
-00015a20: 2020 2020 2020 2066 6f72 2069 2c20 6e61         for i, na
-00015a30: 6d65 2069 6e20 656e 756d 6572 6174 6528  me in enumerate(
-00015a40: 7365 6c66 2e63 6f6c 756d 6e73 293a 0a20  self.columns):. 
-00015a50: 2020 2020 2020 2020 2020 2079 6965 6c64             yield
-00015a60: 2028 6e61 6d65 2c20 7365 6c66 2e69 6c6f   (name, self.ilo
-00015a70: 635b 3a2c 2069 5d29 0a0a 2020 2020 4070  c[:, i])..    @p
-00015a80: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-00015a90: 6178 6573 2873 656c 6629 3a0a 2020 2020  axes(self):.    
-00015aa0: 2020 2020 7265 7475 726e 205b 7365 6c66      return [self
-00015ab0: 2e69 6e64 6578 2c20 7365 6c66 2e63 6f6c  .index, self.col
-00015ac0: 756d 6e73 5d0a 0a20 2020 2064 6566 205f  umns]..    def _
-00015ad0: 5f63 6f6e 7461 696e 735f 5f28 7365 6c66  _contains__(self
-00015ae0: 2c20 6b65 7929 3a0a 2020 2020 2020 2020  , key):.        
-00015af0: 7265 7475 726e 206b 6579 2069 6e20 7365  return key in se
-00015b00: 6c66 2e5f 6d65 7461 0a0a 2020 2020 6465  lf._meta..    de
-00015b10: 6620 5f5f 6974 6572 5f5f 2873 656c 6629  f __iter__(self)
-00015b20: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00015b30: 2069 7465 7228 7365 6c66 2e5f 6d65 7461   iter(self._meta
-00015b40: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
-00015b50: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
-00015b60: 6529 0a20 2020 2064 6566 2069 7465 7272  e).    def iterr
-00015b70: 6f77 7328 7365 6c66 293a 0a20 2020 2020  ows(self):.     
-00015b80: 2020 2066 7261 6d65 203d 2073 656c 662e     frame = self.
-00015b90: 6f70 7469 6d69 7a65 2829 0a20 2020 2020  optimize().     
-00015ba0: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
-00015bb0: 6528 7365 6c66 2e6e 7061 7274 6974 696f  e(self.npartitio
-00015bc0: 6e73 293a 0a20 2020 2020 2020 2020 2020  ns):.           
-00015bd0: 2064 6620 3d20 6672 616d 652e 6765 745f   df = frame.get_
-00015be0: 7061 7274 6974 696f 6e28 6929 2e63 6f6d  partition(i).com
-00015bf0: 7075 7465 2829 0a20 2020 2020 2020 2020  pute().         
-00015c00: 2020 2079 6965 6c64 2066 726f 6d20 6466     yield from df
-00015c10: 2e69 7465 7272 6f77 7328 290a 0a20 2020  .iterrows()..   
-00015c20: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
-00015c30: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
-00015c40: 2064 6566 2069 7465 7274 7570 6c65 7328   def itertuples(
-00015c50: 7365 6c66 2c20 696e 6465 783d 5472 7565  self, index=True
-00015c60: 2c20 6e61 6d65 3d22 5061 6e64 6173 2229  , name="Pandas")
-00015c70: 3a0a 2020 2020 2020 2020 6672 616d 6520  :.        frame 
-00015c80: 3d20 7365 6c66 2e6f 7074 696d 697a 6528  = self.optimize(
-00015c90: 290a 2020 2020 2020 2020 666f 7220 6920  ).        for i 
-00015ca0: 696e 2072 616e 6765 2873 656c 662e 6e70  in range(self.np
-00015cb0: 6172 7469 7469 6f6e 7329 3a0a 2020 2020  artitions):.    
-00015cc0: 2020 2020 2020 2020 6466 203d 2066 7261          df = fra
-00015cd0: 6d65 2e67 6574 5f70 6172 7469 7469 6f6e  me.get_partition
-00015ce0: 2869 292e 636f 6d70 7574 6528 290a 2020  (i).compute().  
-00015cf0: 2020 2020 2020 2020 2020 7969 656c 6420            yield 
-00015d00: 6672 6f6d 2064 662e 6974 6572 7475 706c  from df.itertupl
-00015d10: 6573 2869 6e64 6578 3d69 6e64 6578 2c20  es(index=index, 
-00015d20: 6e61 6d65 3d6e 616d 6529 0a0a 2020 2020  name=name)..    
-00015d30: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
-00015d40: 6620 5f65 6c65 6d77 6973 6528 7365 6c66  f _elemwise(self
-00015d50: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-00015d60: 6e20 656c 656d 7769 7365 0a0a 2020 2020  n elemwise..    
-00015d70: 6465 6620 5f5f 6172 7261 795f 7566 756e  def __array_ufun
-00015d80: 635f 5f28 7365 6c66 2c20 6e75 6d70 795f  c__(self, numpy_
-00015d90: 7566 756e 632c 206d 6574 686f 642c 202a  ufunc, method, *
-00015da0: 696e 7075 7473 2c20 2a2a 6b77 6172 6773  inputs, **kwargs
-00015db0: 293a 0a20 2020 2020 2020 206f 7574 203d  ):.        out =
-00015dc0: 206b 7761 7267 732e 6765 7428 226f 7574   kwargs.get("out
-00015dd0: 222c 2028 2929 0a20 2020 2020 2020 2066  ", ()).        f
-00015de0: 6f72 2078 2069 6e20 696e 7075 7473 202b  or x in inputs +
-00015df0: 206f 7574 3a0a 2020 2020 2020 2020 2020   out:.          
-00015e00: 2020 2320 7566 756e 6373 2077 6f72 6b20    # ufuncs work 
-00015e10: 7769 7468 2030 2d64 696d 656e 7369 6f6e  with 0-dimension
-00015e20: 616c 204e 756d 5079 206e 6461 7272 6179  al NumPy ndarray
-00015e30: 730a 2020 2020 2020 2020 2020 2020 2320  s.            # 
-00015e40: 736f 2077 6520 646f 6e27 7420 7761 6e74  so we don't want
-00015e50: 2074 6f20 7261 6973 6520 4e6f 7449 6d70   to raise NotImp
-00015e60: 6c65 6d65 6e74 6564 0a20 2020 2020 2020  lemented.       
-00015e70: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
-00015e80: 6365 2878 2c20 6e70 2e6e 6461 7272 6179  ce(x, np.ndarray
-00015e90: 2920 616e 6420 782e 7368 6170 6520 3d3d  ) and x.shape ==
-00015ea0: 2028 293a 0a20 2020 2020 2020 2020 2020   ():.           
-00015eb0: 2020 2020 2063 6f6e 7469 6e75 650a 2020       continue.  
-00015ec0: 2020 2020 2020 2020 2020 656c 6966 206e            elif n
-00015ed0: 6f74 2069 7369 6e73 7461 6e63 6528 0a20  ot isinstance(. 
-00015ee0: 2020 2020 2020 2020 2020 2020 2020 2078                 x
-00015ef0: 2c20 284e 756d 6265 722c 2053 6361 6c61  , (Number, Scala
-00015f00: 722c 2046 7261 6d65 4261 7365 2c20 4172  r, FrameBase, Ar
-00015f10: 7261 792c 2070 642e 4461 7461 4672 616d  ray, pd.DataFram
-00015f20: 652c 2070 642e 5365 7269 6573 2c20 7064  e, pd.Series, pd
-00015f30: 2e49 6e64 6578 290a 2020 2020 2020 2020  .Index).        
-00015f40: 2020 2020 293a 0a20 2020 2020 2020 2020      ):.         
-00015f50: 2020 2020 2020 2072 6574 7572 6e20 4e6f         return No
-00015f60: 7449 6d70 6c65 6d65 6e74 6564 0a0a 2020  tImplemented..  
-00015f70: 2020 2020 2020 6966 206d 6574 686f 6420        if method 
-00015f80: 3d3d 2022 5f5f 6361 6c6c 5f5f 223a 0a20  == "__call__":. 
-00015f90: 2020 2020 2020 2020 2020 2069 6620 6e75             if nu
-00015fa0: 6d70 795f 7566 756e 632e 7369 676e 6174  mpy_ufunc.signat
-00015fb0: 7572 6520 6973 206e 6f74 204e 6f6e 653a  ure is not None:
-00015fc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00015fd0: 2072 6574 7572 6e20 4e6f 7449 6d70 6c65   return NotImple
-00015fe0: 6d65 6e74 6564 0a20 2020 2020 2020 2020  mented.         
-00015ff0: 2020 2069 6620 6e75 6d70 795f 7566 756e     if numpy_ufun
-00016000: 632e 6e6f 7574 203e 2031 3a0a 2020 2020  c.nout > 1:.    
-00016010: 2020 2020 2020 2020 2020 2020 2320 7566              # uf
-00016020: 756e 6373 2077 6974 6820 6d75 6c74 6970  uncs with multip
-00016030: 6c65 206f 7574 7075 7420 7661 6c75 6573  le output values
-00016040: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016050: 2023 2061 7265 206e 6f74 2079 6574 2073   # are not yet s
-00016060: 7570 706f 7274 6564 2066 6f72 2066 7261  upported for fra
-00016070: 6d65 730a 2020 2020 2020 2020 2020 2020  mes.            
-00016080: 2020 2020 7265 7475 726e 204e 6f74 496d      return NotIm
-00016090: 706c 656d 656e 7465 640a 2020 2020 2020  plemented.      
-000160a0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-000160b0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-000160c0: 726e 2065 6c65 6d77 6973 6528 6e75 6d70  rn elemwise(nump
-000160d0: 795f 7566 756e 632c 202a 696e 7075 7473  y_ufunc, *inputs
-000160e0: 2c20 2a2a 6b77 6172 6773 290a 2020 2020  , **kwargs).    
-000160f0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00016100: 2020 2020 2020 2320 7566 756e 6320 6d65        # ufunc me
-00016110: 7468 6f64 7320 6172 6520 6e6f 7420 7965  thods are not ye
-00016120: 7420 7375 7070 6f72 7465 6420 666f 7220  t supported for 
-00016130: 6672 616d 6573 0a20 2020 2020 2020 2020  frames.         
-00016140: 2020 2072 6574 7572 6e20 4e6f 7449 6d70     return NotImp
-00016150: 6c65 6d65 6e74 6564 0a0a 2020 2020 6465  lemented..    de
-00016160: 6620 5f5f 6172 7261 795f 7772 6170 5f5f  f __array_wrap__
-00016170: 2873 656c 662c 2061 7272 6179 2c20 636f  (self, array, co
-00016180: 6e74 6578 743d 4e6f 6e65 293a 0a20 2020  ntext=None):.   
-00016190: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
-000161a0: 6365 2863 6f6e 7465 7874 2c20 7475 706c  ce(context, tupl
-000161b0: 6529 2061 6e64 206c 656e 2863 6f6e 7465  e) and len(conte
-000161c0: 7874 2920 3e20 303a 0a20 2020 2020 2020  xt) > 0:.       
-000161d0: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
-000161e0: 6365 2863 6f6e 7465 7874 5b31 5d5b 305d  ce(context[1][0]
-000161f0: 2c20 6e70 2e6e 6461 7272 6179 2920 616e  , np.ndarray) an
-00016200: 6420 636f 6e74 6578 745b 315d 5b30 5d2e  d context[1][0].
-00016210: 7368 6170 6520 3d3d 2028 293a 0a20 2020  shape == ():.   
-00016220: 2020 2020 2020 2020 2020 2020 2069 6e64               ind
-00016230: 6578 203d 204e 6f6e 650a 2020 2020 2020  ex = None.      
-00016240: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00016250: 2020 2020 2020 2020 2020 2020 696e 6465              inde
-00016260: 7820 3d20 636f 6e74 6578 745b 315d 5b30  x = context[1][0
-00016270: 5d2e 696e 6465 780a 2020 2020 2020 2020  ].index.        
-00016280: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00016290: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
-000162a0: 2020 2020 2020 2069 6d70 6f72 7420 696e         import in
-000162b0: 7370 6563 740a 0a20 2020 2020 2020 2020  spect..         
-000162c0: 2020 2020 2020 206d 6574 686f 645f 6e61         method_na
-000162d0: 6d65 203d 2066 2260 7b69 6e73 7065 6374  me = f"`{inspect
-000162e0: 2e73 7461 636b 2829 5b33 5d5b 335d 7d60  .stack()[3][3]}`
-000162f0: 220a 2020 2020 2020 2020 2020 2020 6578  ".            ex
-00016300: 6365 7074 2049 6e64 6578 4572 726f 723a  cept IndexError:
-00016310: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016320: 206d 6574 686f 645f 6e61 6d65 203d 2022   method_name = "
-00016330: 5468 6973 206d 6574 686f 6422 0a0a 2020  This method"..  
-00016340: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00016350: 4e6f 7449 6d70 6c65 6d65 6e74 6564 4572  NotImplementedEr
-00016360: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-00016370: 2020 2020 2066 227b 6d65 7468 6f64 5f6e       f"{method_n
-00016380: 616d 657d 2069 7320 6e6f 7420 696d 706c  ame} is not impl
-00016390: 656d 656e 7465 6420 666f 7220 6064 6173  emented for `das
-000163a0: 6b2e 6461 7461 6672 616d 652e 4461 7461  k.dataframe.Data
-000163b0: 4672 616d 6560 2e22 0a20 2020 2020 2020  Frame`.".       
-000163c0: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-000163d0: 7265 7475 726e 206d 6574 615f 6672 616d  return meta_fram
-000163e0: 655f 636f 6e73 7472 7563 746f 7228 7365  e_constructor(se
-000163f0: 6c66 2928 6172 7261 792c 2069 6e64 6578  lf)(array, index
-00016400: 3d69 6e64 6578 2c20 636f 6c75 6d6e 733d  =index, columns=
-00016410: 7365 6c66 2e63 6f6c 756d 6e73 290a 0a20  self.columns).. 
-00016420: 2020 2064 6566 205f 6970 7974 686f 6e5f     def _ipython_
-00016430: 6b65 795f 636f 6d70 6c65 7469 6f6e 735f  key_completions_
-00016440: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00016450: 7265 7475 726e 206d 6574 686f 6473 2e74  return methods.t
-00016460: 6f6c 6973 7428 7365 6c66 2e63 6f6c 756d  olist(self.colum
-00016470: 6e73 290a 0a20 2020 2064 6566 205f 7265  ns)..    def _re
-00016480: 7072 5f68 746d 6c5f 2873 656c 6629 3a0a  pr_html_(self):.
-00016490: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-000164a0: 656c 662e 746f 5f68 746d 6c28 290a 0a20  elf.to_html().. 
-000164b0: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
-000164c0: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
-000164d0: 2020 2064 6566 2061 7373 6967 6e28 7365     def assign(se
-000164e0: 6c66 2c20 2a2a 7061 6972 7329 3a0a 2020  lf, **pairs):.  
-000164f0: 2020 2020 2020 7265 7375 6c74 203d 2073        result = s
-00016500: 656c 660a 2020 2020 2020 2020 6172 6773  elf.        args
-00016510: 203d 205b 5d0a 2020 2020 2020 2020 666f   = [].        fo
-00016520: 7220 6b2c 2076 2069 6e20 7061 6972 732e  r k, v in pairs.
-00016530: 6974 656d 7328 293a 0a20 2020 2020 2020  items():.       
-00016540: 2020 2020 2076 203d 205f 6d61 7962 655f       v = _maybe_
-00016550: 6672 6f6d 5f70 616e 6461 7328 5b76 5d29  from_pandas([v])
-00016560: 5b30 5d0a 2020 2020 2020 2020 2020 2020  [0].            
-00016570: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
-00016580: 6528 6b2c 2073 7472 293a 0a20 2020 2020  e(k, str):.     
-00016590: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-000165a0: 2054 7970 6545 7272 6f72 2866 2243 6f6c   TypeError(f"Col
-000165b0: 756d 6e20 6e61 6d65 2063 616e 6e6f 7420  umn name cannot 
-000165c0: 6265 2074 7970 6520 7b74 7970 6528 6b29  be type {type(k)
-000165d0: 7d22 290a 0a20 2020 2020 2020 2020 2020  }")..           
-000165e0: 2069 6620 6361 6c6c 6162 6c65 2876 293a   if callable(v):
-000165f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016600: 2072 6573 756c 7420 3d20 6e65 775f 636f   result = new_co
-00016610: 6c6c 6563 7469 6f6e 2865 7870 722e 4173  llection(expr.As
-00016620: 7369 676e 2872 6573 756c 742c 202a 6172  sign(result, *ar
-00016630: 6773 2929 0a20 2020 2020 2020 2020 2020  gs)).           
-00016640: 2020 2020 2061 7267 7320 3d20 5b5d 0a20       args = []. 
-00016650: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00016660: 6573 756c 7420 3d20 6e65 775f 636f 6c6c  esult = new_coll
-00016670: 6563 7469 6f6e 2865 7870 722e 4173 7369  ection(expr.Assi
-00016680: 676e 2872 6573 756c 742c 206b 2c20 7628  gn(result, k, v(
-00016690: 7265 7375 6c74 2929 290a 2020 2020 2020  result))).      
-000166a0: 2020 2020 2020 2020 2020 636f 6e74 696e            contin
-000166b0: 7565 0a0a 2020 2020 2020 2020 2020 2020  ue..            
-000166c0: 656c 6966 2069 7369 6e73 7461 6e63 6528  elif isinstance(
-000166d0: 762c 2028 5363 616c 6172 2c20 5365 7269  v, (Scalar, Seri
-000166e0: 6573 2929 3a0a 2020 2020 2020 2020 2020  es)):.          
-000166f0: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-00016700: 6e63 6528 762c 2053 6572 6965 7329 3a0a  nce(v, Series):.
-00016710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016720: 2020 2020 6966 206e 6f74 2065 7870 722e      if not expr.
-00016730: 6172 655f 636f 5f61 6c69 676e 6564 2872  are_co_aligned(r
-00016740: 6573 756c 742e 6578 7072 2c20 762e 6578  esult.expr, v.ex
-00016750: 7072 293a 0a20 2020 2020 2020 2020 2020  pr):.           
-00016760: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00016770: 6c65 6e28 6172 6773 2920 3e20 303a 0a20  len(args) > 0:. 
-00016780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016790: 2020 2020 2020 2020 2020 2072 6573 756c             resul
-000167a0: 7420 3d20 6578 7072 2e41 7373 6967 6e28  t = expr.Assign(
-000167b0: 7265 7375 6c74 2c20 2a61 7267 7329 0a20  result, *args). 
-000167c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000167d0: 2020 2020 2020 2020 2020 2061 7267 7320             args 
-000167e0: 3d20 5b5d 0a20 2020 2020 2020 2020 2020  = [].           
-000167f0: 2020 2020 2020 2020 2020 2020 2072 6573               res
-00016800: 756c 7420 3d20 6e65 775f 636f 6c6c 6563  ult = new_collec
-00016810: 7469 6f6e 2865 7870 722e 4173 7369 676e  tion(expr.Assign
-00016820: 416c 6967 6e28 7265 7375 6c74 2c20 6b2c  Align(result, k,
-00016830: 2076 2e65 7870 7229 290a 2020 2020 2020   v.expr)).      
-00016840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016850: 2020 636f 6e74 696e 7565 0a0a 2020 2020    continue..    
-00016860: 2020 2020 2020 2020 656c 6966 206e 6f74          elif not
-00016870: 2069 7369 6e73 7461 6e63 6528 762c 2046   isinstance(v, F
-00016880: 7261 6d65 4261 7365 2920 616e 6420 6973  rameBase) and is
-00016890: 696e 7374 616e 6365 2876 2c20 4861 7368  instance(v, Hash
-000168a0: 6162 6c65 293a 0a20 2020 2020 2020 2020  able):.         
-000168b0: 2020 2020 2020 2070 6173 730a 2020 2020         pass.    
-000168c0: 2020 2020 2020 2020 656c 6966 2069 7369          elif isi
-000168d0: 6e73 7461 6e63 6528 762c 2041 7272 6179  nstance(v, Array
-000168e0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-000168f0: 2020 2069 6620 6c65 6e28 762e 7368 6170     if len(v.shap
-00016900: 6529 203e 2031 3a0a 2020 2020 2020 2020  e) > 1:.        
-00016910: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00016920: 6520 5661 6c75 6545 7272 6f72 2822 4172  e ValueError("Ar
-00016930: 7261 7920 6173 7369 676e 6d65 6e74 206f  ray assignment o
-00016940: 6e6c 7920 7375 7070 6f72 7473 2031 2d44  nly supports 1-D
-00016950: 2061 7272 6179 7322 290a 2020 2020 2020   arrays").      
-00016960: 2020 2020 2020 2020 2020 6966 2076 2e6e            if v.n
-00016970: 7061 7274 6974 696f 6e73 2021 3d20 7265  partitions != re
-00016980: 7375 6c74 2e6e 7061 7274 6974 696f 6e73  sult.npartitions
-00016990: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000169a0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-000169b0: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
-000169c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000169d0: 224e 756d 6265 7220 6f66 2070 6172 7469  "Number of parti
-000169e0: 7469 6f6e 7320 646f 206e 6f74 206d 6174  tions do not mat
-000169f0: 6368 2022 0a20 2020 2020 2020 2020 2020  ch ".           
-00016a00: 2020 2020 2020 2020 2020 2020 2066 2228               f"(
-00016a10: 7b76 2e6e 7061 7274 6974 696f 6e73 7d20  {v.npartitions} 
-00016a20: 213d 207b 7265 7375 6c74 2e6e 7061 7274  != {result.npart
-00016a30: 6974 696f 6e73 7d29 220a 2020 2020 2020  itions})".      
-00016a40: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-00016a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016a60: 7620 3d20 6672 6f6d 5f64 6173 6b5f 6172  v = from_dask_ar
-00016a70: 7261 7928 0a20 2020 2020 2020 2020 2020  ray(.           
-00016a80: 2020 2020 2020 2020 2076 2c20 696e 6465           v, inde
-00016a90: 783d 7265 7375 6c74 2e69 6e64 6578 2e74  x=result.index.t
-00016aa0: 6f5f 6461 736b 5f64 6174 6166 7261 6d65  o_dask_dataframe
-00016ab0: 2829 2c20 6d65 7461 3d72 6573 756c 742e  (), meta=result.
-00016ac0: 5f6d 6574 610a 2020 2020 2020 2020 2020  _meta.          
-00016ad0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00016ae0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00016af0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00016b00: 5479 7065 4572 726f 7228 6622 436f 6c75  TypeError(f"Colu
-00016b10: 6d6e 2061 7373 6967 6e6d 656e 7420 646f  mn assignment do
-00016b20: 6573 6e27 7420 7375 7070 6f72 7420 7479  esn't support ty
-00016b30: 7065 207b 7479 7065 2876 297d 2229 0a20  pe {type(v)}"). 
-00016b40: 2020 2020 2020 2020 2020 2061 7267 732e             args.
-00016b50: 6578 7465 6e64 285b 6b2c 2076 5d29 0a0a  extend([k, v])..
-00016b60: 2020 2020 2020 2020 6966 206c 656e 2861          if len(a
-00016b70: 7267 7329 203e 2030 3a0a 2020 2020 2020  rgs) > 0:.      
-00016b80: 2020 2020 2020 7265 7375 6c74 203d 206e        result = n
-00016b90: 6577 5f63 6f6c 6c65 6374 696f 6e28 6578  ew_collection(ex
-00016ba0: 7072 2e41 7373 6967 6e28 7265 7375 6c74  pr.Assign(result
-00016bb0: 2c20 2a61 7267 7329 290a 0a20 2020 2020  , *args))..     
-00016bc0: 2020 2072 6574 7572 6e20 7265 7375 6c74     return result
-00016bd0: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
-00016be0: 726f 6d28 7064 2e44 6174 6146 7261 6d65  rom(pd.DataFrame
-00016bf0: 290a 2020 2020 6465 6620 636c 6970 2873  ).    def clip(s
-00016c00: 656c 662c 206c 6f77 6572 3d4e 6f6e 652c  elf, lower=None,
-00016c10: 2075 7070 6572 3d4e 6f6e 652c 2061 7869   upper=None, axi
-00016c20: 733d 4e6f 6e65 2c20 2a2a 6b77 6172 6773  s=None, **kwargs
-00016c30: 293a 0a20 2020 2020 2020 2061 7869 7320  ):.        axis 
-00016c40: 3d20 7365 6c66 2e5f 7661 6c69 6461 7465  = self._validate
-00016c50: 5f61 7869 7328 6178 6973 290a 2020 2020  _axis(axis).    
-00016c60: 2020 2020 6966 2061 7869 7320 3d3d 2031      if axis == 1
-00016c70: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-00016c80: 7475 726e 2073 656c 662e 6d61 705f 7061  turn self.map_pa
-00016c90: 7274 6974 696f 6e73 284d 2e63 6c69 702c  rtitions(M.clip,
-00016ca0: 206c 6f77 6572 2c20 7570 7065 722c 2061   lower, upper, a
-00016cb0: 7869 733d 6178 6973 290a 2020 2020 2020  xis=axis).      
-00016cc0: 2020 7265 7475 726e 206e 6577 5f63 6f6c    return new_col
-00016cd0: 6c65 6374 696f 6e28 7365 6c66 2e65 7870  lection(self.exp
-00016ce0: 722e 636c 6970 286c 6f77 6572 2c20 7570  r.clip(lower, up
-00016cf0: 7065 722c 2061 7869 7329 290a 0a20 2020  per, axis))..   
-00016d00: 2064 6566 206d 6572 6765 280a 2020 2020   def merge(.    
-00016d10: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-00016d20: 2020 7269 6768 742c 0a20 2020 2020 2020    right,.       
-00016d30: 2068 6f77 3d22 696e 6e65 7222 2c0a 2020   how="inner",.  
-00016d40: 2020 2020 2020 6f6e 3d4e 6f6e 652c 0a20        on=None,. 
-00016d50: 2020 2020 2020 206c 6566 745f 6f6e 3d4e         left_on=N
-00016d60: 6f6e 652c 0a20 2020 2020 2020 2072 6967  one,.        rig
-00016d70: 6874 5f6f 6e3d 4e6f 6e65 2c0a 2020 2020  ht_on=None,.    
-00016d80: 2020 2020 6c65 6674 5f69 6e64 6578 3d46      left_index=F
-00016d90: 616c 7365 2c0a 2020 2020 2020 2020 7269  alse,.        ri
-00016da0: 6768 745f 696e 6465 783d 4661 6c73 652c  ght_index=False,
-00016db0: 0a20 2020 2020 2020 2073 7566 6669 7865  .        suffixe
-00016dc0: 733d 2822 5f78 222c 2022 5f79 2229 2c0a  s=("_x", "_y"),.
-00016dd0: 2020 2020 2020 2020 696e 6469 6361 746f          indicato
-00016de0: 723d 4661 6c73 652c 0a20 2020 2020 2020  r=False,.       
-00016df0: 2073 6875 6666 6c65 5f6d 6574 686f 643d   shuffle_method=
-00016e00: 4e6f 6e65 2c0a 2020 2020 2020 2020 6e70  None,.        np
-00016e10: 6172 7469 7469 6f6e 733d 4e6f 6e65 2c0a  artitions=None,.
-00016e20: 2020 2020 2020 2020 6272 6f61 6463 6173          broadcas
-00016e30: 743d 4e6f 6e65 2c0a 2020 2020 293a 0a20  t=None,.    ):. 
-00016e40: 2020 2020 2020 2022 2222 4d65 7267 6520         """Merge 
-00016e50: 7468 6520 4461 7461 4672 616d 6520 7769  the DataFrame wi
-00016e60: 7468 2061 6e6f 7468 6572 2044 6174 6146  th another DataF
-00016e70: 7261 6d65 0a0a 2020 2020 2020 2020 5468  rame..        Th
-00016e80: 6973 2077 696c 6c20 6d65 7267 6520 7468  is will merge th
-00016e90: 6520 7477 6f20 6461 7461 7365 7473 2c20  e two datasets, 
-00016ea0: 6569 7468 6572 206f 6e20 7468 6520 696e  either on the in
-00016eb0: 6469 6365 732c 2061 2063 6572 7461 696e  dices, a certain
-00016ec0: 2063 6f6c 756d 6e0a 2020 2020 2020 2020   column.        
-00016ed0: 696e 2065 6163 6820 6461 7461 7365 7420  in each dataset 
-00016ee0: 6f72 2074 6865 2069 6e64 6578 2069 6e20  or the index in 
-00016ef0: 6f6e 6520 6461 7461 7365 7420 616e 6420  one dataset and 
-00016f00: 7468 6520 636f 6c75 6d6e 2069 6e20 616e  the column in an
-00016f10: 6f74 6865 722e 0a0a 2020 2020 2020 2020  other...        
-00016f20: 5061 7261 6d65 7465 7273 0a20 2020 2020  Parameters.     
-00016f30: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
-00016f40: 2020 2020 2020 7269 6768 743a 2064 6173        right: das
-00016f50: 6b2e 6461 7461 6672 616d 652e 4461 7461  k.dataframe.Data
-00016f60: 4672 616d 650a 2020 2020 2020 2020 686f  Frame.        ho
-00016f70: 7720 3a20 7b27 6c65 6674 272c 2027 7269  w : {'left', 'ri
-00016f80: 6768 7427 2c20 276f 7574 6572 272c 2027  ght', 'outer', '
-00016f90: 696e 6e65 7227 2c20 276c 6566 7473 656d  inner', 'leftsem
-00016fa0: 6927 7d2c 2064 6566 6175 6c74 3a20 2769  i'}, default: 'i
-00016fb0: 6e6e 6572 270a 2020 2020 2020 2020 2020  nner'.          
-00016fc0: 2020 486f 7720 746f 2068 616e 646c 6520    How to handle 
-00016fd0: 7468 6520 6f70 6572 6174 696f 6e20 6f66  the operation of
-00016fe0: 2074 6865 2074 776f 206f 626a 6563 7473   the two objects
-00016ff0: 3a0a 0a20 2020 2020 2020 2020 2020 202d  :..            -
-00017000: 206c 6566 743a 2075 7365 2063 616c 6c69   left: use calli
-00017010: 6e67 2066 7261 6d65 2773 2069 6e64 6578  ng frame's index
-00017020: 2028 6f72 2063 6f6c 756d 6e20 6966 206f   (or column if o
-00017030: 6e20 6973 2073 7065 6369 6669 6564 290a  n is specified).
-00017040: 2020 2020 2020 2020 2020 2020 2d20 7269              - ri
-00017050: 6768 743a 2075 7365 206f 7468 6572 2066  ght: use other f
-00017060: 7261 6d65 2773 2069 6e64 6578 0a20 2020  rame's index.   
-00017070: 2020 2020 2020 2020 202d 206f 7574 6572           - outer
-00017080: 3a20 666f 726d 2075 6e69 6f6e 206f 6620  : form union of 
-00017090: 6361 6c6c 696e 6720 6672 616d 6527 7320  calling frame's 
-000170a0: 696e 6465 7820 286f 7220 636f 6c75 6d6e  index (or column
-000170b0: 2069 6620 6f6e 2069 730a 2020 2020 2020   if on is.      
-000170c0: 2020 2020 2020 2020 7370 6563 6966 6965          specifie
-000170d0: 6429 2077 6974 6820 6f74 6865 7220 6672  d) with other fr
-000170e0: 616d 6527 7320 696e 6465 782c 2061 6e64  ame's index, and
-000170f0: 2073 6f72 7420 6974 0a20 2020 2020 2020   sort it.       
-00017100: 2020 2020 2020 206c 6578 6963 6f67 7261         lexicogra
-00017110: 7068 6963 616c 6c79 0a20 2020 2020 2020  phically.       
-00017120: 2020 2020 202d 2069 6e6e 6572 3a20 666f       - inner: fo
-00017130: 726d 2069 6e74 6572 7365 6374 696f 6e20  rm intersection 
-00017140: 6f66 2063 616c 6c69 6e67 2066 7261 6d65  of calling frame
-00017150: 2773 2069 6e64 6578 2028 6f72 2063 6f6c  's index (or col
-00017160: 756d 6e20 6966 0a20 2020 2020 2020 2020  umn if.         
-00017170: 2020 2020 206f 6e20 6973 2073 7065 6369       on is speci
-00017180: 6669 6564 2920 7769 7468 206f 7468 6572  fied) with other
-00017190: 2066 7261 6d65 2773 2069 6e64 6578 2c20   frame's index, 
-000171a0: 7072 6573 6572 7669 6e67 2074 6865 206f  preserving the o
-000171b0: 7264 6572 0a20 2020 2020 2020 2020 2020  rder.           
-000171c0: 2020 206f 6620 7468 6520 6361 6c6c 696e     of the callin
-000171d0: 6727 7320 6f6e 650a 2020 2020 2020 2020  g's one.        
-000171e0: 2020 2020 2d20 6c65 6674 7365 6d69 3a20      - leftsemi: 
-000171f0: 4368 6f6f 7365 2061 6c6c 2072 6f77 7320  Choose all rows 
-00017200: 696e 206c 6566 7420 7768 6572 6520 7468  in left where th
-00017210: 6520 6a6f 696e 206b 6579 7320 6361 6e20  e join keys can 
-00017220: 6265 2066 6f75 6e64 0a20 2020 2020 2020  be found.       
-00017230: 2020 2020 2020 2069 6e20 7269 6768 742e         in right.
-00017240: 2057 6f6e 2774 2064 7570 6c69 6361 7465   Won't duplicate
-00017250: 2072 6f77 7320 6966 2074 6865 206b 6579   rows if the key
-00017260: 7320 6172 6520 6475 706c 6963 6174 6564  s are duplicated
-00017270: 2069 6e20 7269 6768 742e 0a20 2020 2020   in right..     
-00017280: 2020 2020 2020 2020 2044 726f 7073 2061           Drops a
-00017290: 6c6c 2063 6f6c 756d 6e73 2066 726f 6d20  ll columns from 
-000172a0: 7269 6768 742e 0a0a 2020 2020 2020 2020  right...        
-000172b0: 6f6e 203a 206c 6162 656c 206f 7220 6c69  on : label or li
-000172c0: 7374 0a20 2020 2020 2020 2020 2020 2043  st.            C
-000172d0: 6f6c 756d 6e20 6f72 2069 6e64 6578 206c  olumn or index l
-000172e0: 6576 656c 206e 616d 6573 2074 6f20 6a6f  evel names to jo
-000172f0: 696e 206f 6e2e 2054 6865 7365 206d 7573  in on. These mus
-00017300: 7420 6265 2066 6f75 6e64 2069 6e20 626f  t be found in bo
-00017310: 7468 0a20 2020 2020 2020 2020 2020 2044  th.            D
-00017320: 6174 6146 7261 6d65 732e 2049 6620 6f6e  ataFrames. If on
-00017330: 2069 7320 4e6f 6e65 2061 6e64 206e 6f74   is None and not
-00017340: 206d 6572 6769 6e67 206f 6e20 696e 6465   merging on inde
-00017350: 7865 7320 7468 656e 2074 6869 730a 2020  xes then this.  
-00017360: 2020 2020 2020 2020 2020 6465 6661 756c            defaul
-00017370: 7473 2074 6f20 7468 6520 696e 7465 7273  ts to the inters
-00017380: 6563 7469 6f6e 206f 6620 7468 6520 636f  ection of the co
-00017390: 6c75 6d6e 7320 696e 2062 6f74 6820 4461  lumns in both Da
-000173a0: 7461 4672 616d 6573 2e0a 2020 2020 2020  taFrames..      
-000173b0: 2020 6c65 6674 5f6f 6e20 3a20 6c61 6265    left_on : labe
-000173c0: 6c20 6f72 206c 6973 742c 206f 7220 6172  l or list, or ar
-000173d0: 7261 792d 6c69 6b65 0a20 2020 2020 2020  ray-like.       
-000173e0: 2020 2020 2043 6f6c 756d 6e20 746f 206a       Column to j
-000173f0: 6f69 6e20 6f6e 2069 6e20 7468 6520 6c65  oin on in the le
-00017400: 6674 2044 6174 6146 7261 6d65 2e20 4f74  ft DataFrame. Ot
-00017410: 6865 7220 7468 616e 2069 6e20 7061 6e64  her than in pand
-00017420: 6173 0a20 2020 2020 2020 2020 2020 2061  as.            a
-00017430: 7272 6179 7320 616e 6420 6c69 7374 7320  rrays and lists 
-00017440: 6172 6520 6f6e 6c79 2073 7570 706f 7274  are only support
-00017450: 2069 6620 7468 6569 7220 6c65 6e67 7468   if their length
-00017460: 2069 7320 312e 0a20 2020 2020 2020 2072   is 1..        r
-00017470: 6967 6874 5f6f 6e20 3a20 6c61 6265 6c20  ight_on : label 
-00017480: 6f72 206c 6973 742c 206f 7220 6172 7261  or list, or arra
-00017490: 792d 6c69 6b65 0a20 2020 2020 2020 2020  y-like.         
-000174a0: 2020 2043 6f6c 756d 6e20 746f 206a 6f69     Column to joi
-000174b0: 6e20 6f6e 2069 6e20 7468 6520 7269 6768  n on in the righ
-000174c0: 7420 4461 7461 4672 616d 652e 204f 7468  t DataFrame. Oth
-000174d0: 6572 2074 6861 6e20 696e 2070 616e 6461  er than in panda
-000174e0: 730a 2020 2020 2020 2020 2020 2020 6172  s.            ar
-000174f0: 7261 7973 2061 6e64 206c 6973 7473 2061  rays and lists a
-00017500: 7265 206f 6e6c 7920 7375 7070 6f72 7420  re only support 
-00017510: 6966 2074 6865 6972 206c 656e 6774 6820  if their length 
-00017520: 6973 2031 2e0a 2020 2020 2020 2020 6c65  is 1..        le
-00017530: 6674 5f69 6e64 6578 203a 2062 6f6f 6c65  ft_index : boole
-00017540: 616e 2c20 6465 6661 756c 7420 4661 6c73  an, default Fals
-00017550: 650a 2020 2020 2020 2020 2020 2020 5573  e.            Us
-00017560: 6520 7468 6520 696e 6465 7820 6672 6f6d  e the index from
-00017570: 2074 6865 206c 6566 7420 4461 7461 4672   the left DataFr
-00017580: 616d 6520 6173 2074 6865 206a 6f69 6e20  ame as the join 
-00017590: 6b65 792e 0a20 2020 2020 2020 2072 6967  key..        rig
-000175a0: 6874 5f69 6e64 6578 203a 2062 6f6f 6c65  ht_index : boole
-000175b0: 616e 2c20 6465 6661 756c 7420 4661 6c73  an, default Fals
-000175c0: 650a 2020 2020 2020 2020 2020 2020 5573  e.            Us
-000175d0: 6520 7468 6520 696e 6465 7820 6672 6f6d  e the index from
-000175e0: 2074 6865 2072 6967 6874 2044 6174 6146   the right DataF
-000175f0: 7261 6d65 2061 7320 7468 6520 6a6f 696e  rame as the join
-00017600: 206b 6579 2e0a 2020 2020 2020 2020 7375   key..        su
-00017610: 6666 6978 6573 203a 2032 2d6c 656e 6774  ffixes : 2-lengt
-00017620: 6820 7365 7175 656e 6365 2028 7475 706c  h sequence (tupl
-00017630: 652c 206c 6973 742c 202e 2e2e 290a 2020  e, list, ...).  
-00017640: 2020 2020 2020 2020 2020 5375 6666 6978            Suffix
-00017650: 2074 6f20 6170 706c 7920 746f 206f 7665   to apply to ove
-00017660: 726c 6170 7069 6e67 2063 6f6c 756d 6e20  rlapping column 
-00017670: 6e61 6d65 7320 696e 2074 6865 206c 6566  names in the lef
-00017680: 7420 616e 640a 2020 2020 2020 2020 2020  t and.          
-00017690: 2020 7269 6768 7420 7369 6465 2c20 7265    right side, re
-000176a0: 7370 6563 7469 7665 6c79 0a20 2020 2020  spectively.     
-000176b0: 2020 2069 6e64 6963 6174 6f72 203a 2062     indicator : b
-000176c0: 6f6f 6c65 616e 206f 7220 7374 7269 6e67  oolean or string
-000176d0: 2c20 6465 6661 756c 7420 4661 6c73 650a  , default False.
-000176e0: 2020 2020 2020 2020 2020 2020 4966 2054              If T
-000176f0: 7275 652c 2061 6464 7320 6120 636f 6c75  rue, adds a colu
-00017700: 6d6e 2074 6f20 6f75 7470 7574 2044 6174  mn to output Dat
-00017710: 6146 7261 6d65 2063 616c 6c65 6420 225f  aFrame called "_
-00017720: 6d65 7267 6522 2077 6974 680a 2020 2020  merge" with.    
-00017730: 2020 2020 2020 2020 696e 666f 726d 6174          informat
-00017740: 696f 6e20 6f6e 2074 6865 2073 6f75 7263  ion on the sourc
-00017750: 6520 6f66 2065 6163 6820 726f 772e 2049  e of each row. I
-00017760: 6620 7374 7269 6e67 2c20 636f 6c75 6d6e  f string, column
-00017770: 2077 6974 680a 2020 2020 2020 2020 2020   with.          
-00017780: 2020 696e 666f 726d 6174 696f 6e20 6f6e    information on
-00017790: 2073 6f75 7263 6520 6f66 2065 6163 6820   source of each 
-000177a0: 726f 7720 7769 6c6c 2062 6520 6164 6465  row will be adde
-000177b0: 6420 746f 206f 7574 7075 7420 4461 7461  d to output Data
-000177c0: 4672 616d 652c 0a20 2020 2020 2020 2020  Frame,.         
-000177d0: 2020 2061 6e64 2063 6f6c 756d 6e20 7769     and column wi
-000177e0: 6c6c 2062 6520 6e61 6d65 6420 7661 6c75  ll be named valu
-000177f0: 6520 6f66 2073 7472 696e 672e 2049 6e66  e of string. Inf
-00017800: 6f72 6d61 7469 6f6e 2063 6f6c 756d 6e20  ormation column 
-00017810: 6973 0a20 2020 2020 2020 2020 2020 2043  is.            C
-00017820: 6174 6567 6f72 6963 616c 2d74 7970 6520  ategorical-type 
-00017830: 616e 6420 7461 6b65 7320 6f6e 2061 2076  and takes on a v
-00017840: 616c 7565 206f 6620 226c 6566 745f 6f6e  alue of "left_on
-00017850: 6c79 2220 666f 7220 6f62 7365 7276 6174  ly" for observat
-00017860: 696f 6e73 0a20 2020 2020 2020 2020 2020  ions.           
-00017870: 2077 686f 7365 206d 6572 6765 206b 6579   whose merge key
-00017880: 206f 6e6c 7920 6170 7065 6172 7320 696e   only appears in
-00017890: 2060 6c65 6674 6020 4461 7461 4672 616d   `left` DataFram
-000178a0: 652c 2022 7269 6768 745f 6f6e 6c79 2220  e, "right_only" 
-000178b0: 666f 720a 2020 2020 2020 2020 2020 2020  for.            
-000178c0: 6f62 7365 7276 6174 696f 6e73 2077 686f  observations who
-000178d0: 7365 206d 6572 6765 206b 6579 206f 6e6c  se merge key onl
-000178e0: 7920 6170 7065 6172 7320 696e 2060 7269  y appears in `ri
-000178f0: 6768 7460 2044 6174 6146 7261 6d65 2c0a  ght` DataFrame,.
-00017900: 2020 2020 2020 2020 2020 2020 616e 6420              and 
-00017910: 2262 6f74 6822 2069 6620 7468 6520 6f62  "both" if the ob
-00017920: 7365 7276 6174 696f 6ee2 8099 7320 6d65  servation...s me
-00017930: 7267 6520 6b65 7920 6973 2066 6f75 6e64  rge key is found
-00017940: 2069 6e20 626f 7468 2e0a 2020 2020 2020   in both..      
-00017950: 2020 6e70 6172 7469 7469 6f6e 733a 2069    npartitions: i
-00017960: 6e74 206f 7220 4e6f 6e65 2c20 6f70 7469  nt or None, opti
-00017970: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
-00017980: 2054 6865 2069 6465 616c 206e 756d 6265   The ideal numbe
-00017990: 7220 6f66 206f 7574 7075 7420 7061 7274  r of output part
-000179a0: 6974 696f 6e73 2e20 5468 6973 2069 7320  itions. This is 
-000179b0: 6f6e 6c79 2075 7469 6c69 7365 6420 7768  only utilised wh
-000179c0: 656e 0a20 2020 2020 2020 2020 2020 2070  en.            p
-000179d0: 6572 666f 726d 696e 6720 6120 6861 7368  erforming a hash
-000179e0: 5f6a 6f69 6e20 286d 6572 6769 6e67 206f  _join (merging o
-000179f0: 6e20 636f 6c75 6d6e 7320 6f6e 6c79 292e  n columns only).
-00017a00: 2049 6620 6060 4e6f 6e65 6060 2074 6865   If ``None`` the
-00017a10: 6e0a 2020 2020 2020 2020 2020 2020 6060  n.            ``
-00017a20: 6e70 6172 7469 7469 6f6e 7320 3d20 6d61  npartitions = ma
-00017a30: 7828 6c68 732e 6e70 6172 7469 7469 6f6e  x(lhs.npartition
-00017a40: 732c 2072 6873 2e6e 7061 7274 6974 696f  s, rhs.npartitio
-00017a50: 6e73 2960 602e 0a20 2020 2020 2020 2020  ns)``..         
-00017a60: 2020 2044 6566 6175 6c74 2069 7320 6060     Default is ``
-00017a70: 4e6f 6e65 6060 2e0a 2020 2020 2020 2020  None``..        
-00017a80: 7368 7566 666c 655f 6d65 7468 6f64 3a20  shuffle_method: 
-00017a90: 7b27 6469 736b 272c 2027 7461 736b 7327  {'disk', 'tasks'
-00017aa0: 2c20 2770 3270 277d 2c20 6f70 7469 6f6e  , 'p2p'}, option
-00017ab0: 616c 0a20 2020 2020 2020 2020 2020 2045  al.            E
-00017ac0: 6974 6865 7220 6060 2764 6973 6b27 6060  ither ``'disk'``
-00017ad0: 2066 6f72 2073 696e 676c 652d 6e6f 6465   for single-node
-00017ae0: 206f 7065 7261 7469 6f6e 206f 7220 6060   operation or ``
-00017af0: 2774 6173 6b73 2760 6020 616e 640a 2020  'tasks'`` and.  
-00017b00: 2020 2020 2020 2020 2020 6060 2770 3270            ``'p2p
-00017b10: 2760 6060 2066 6f72 2064 6973 7472 6962  '``` for distrib
-00017b20: 7574 6564 206f 7065 7261 7469 6f6e 2e20  uted operation. 
-00017b30: 2057 696c 6c20 6265 2069 6e66 6572 7265   Will be inferre
-00017b40: 6420 6279 2079 6f75 720a 2020 2020 2020  d by your.      
-00017b50: 2020 2020 2020 6375 7272 656e 7420 7363        current sc
-00017b60: 6865 6475 6c65 722e 0a20 2020 2020 2020  heduler..       
-00017b70: 2062 726f 6164 6361 7374 3a20 626f 6f6c   broadcast: bool
-00017b80: 6561 6e20 6f72 2066 6c6f 6174 2c20 6f70  ean or float, op
-00017b90: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
-00017ba0: 2020 2057 6865 7468 6572 2074 6f20 7573     Whether to us
-00017bb0: 6520 6120 6272 6f61 6463 6173 742d 6261  e a broadcast-ba
-00017bc0: 7365 6420 6a6f 696e 2069 6e20 6c69 6575  sed join in lieu
-00017bd0: 206f 6620 6120 7368 7566 666c 652d 6261   of a shuffle-ba
-00017be0: 7365 640a 2020 2020 2020 2020 2020 2020  sed.            
-00017bf0: 6a6f 696e 2066 6f72 2073 7570 706f 7274  join for support
-00017c00: 6564 2063 6173 6573 2e20 2042 7920 6465  ed cases.  By de
-00017c10: 6661 756c 742c 2061 2073 696d 706c 6520  fault, a simple 
-00017c20: 6865 7572 6973 7469 6320 7769 6c6c 2062  heuristic will b
-00017c30: 650a 2020 2020 2020 2020 2020 2020 7573  e.            us
-00017c40: 6564 2074 6f20 7365 6c65 6374 2074 6865  ed to select the
-00017c50: 2075 6e64 6572 6c79 696e 6720 616c 676f   underlying algo
-00017c60: 7269 7468 6d2e 2049 6620 6120 666c 6f61  rithm. If a floa
-00017c70: 7469 6e67 2d70 6f69 6e74 2076 616c 7565  ting-point value
-00017c80: 0a20 2020 2020 2020 2020 2020 2069 7320  .            is 
-00017c90: 7370 6563 6966 6965 642c 2074 6861 7420  specified, that 
-00017ca0: 6e75 6d62 6572 2077 696c 6c20 6265 2075  number will be u
-00017cb0: 7365 6420 6173 2074 6865 2060 6062 726f  sed as the ``bro
-00017cc0: 6164 6361 7374 5f62 6961 7360 600a 2020  adcast_bias``.  
-00017cd0: 2020 2020 2020 2020 2020 7769 7468 696e            within
-00017ce0: 2074 6865 2073 696d 706c 6520 6865 7572   the simple heur
-00017cf0: 6973 7469 6320 2861 206c 6172 6765 206e  istic (a large n
-00017d00: 756d 6265 7220 6d61 6b65 7320 4461 736b  umber makes Dask
-00017d10: 206d 6f72 6520 6c69 6b65 6c79 0a20 2020   more likely.   
-00017d20: 2020 2020 2020 2020 2074 6f20 6368 6f6f           to choo
-00017d30: 7365 2074 6865 2060 6062 726f 6163 6173  se the ``broacas
-00017d40: 745f 6a6f 696e 6060 2063 6f64 6520 7061  t_join`` code pa
-00017d50: 7468 292e 2053 6565 2060 6062 726f 6164  th). See ``broad
-00017d60: 6361 7374 5f6a 6f69 6e60 600a 2020 2020  cast_join``.    
-00017d70: 2020 2020 2020 2020 666f 7220 6d6f 7265          for more
-00017d80: 2069 6e66 6f72 6d61 7469 6f6e 2e0a 0a20   information... 
-00017d90: 2020 2020 2020 204e 6f74 6573 0a20 2020         Notes.   
-00017da0: 2020 2020 202d 2d2d 2d2d 0a0a 2020 2020       -----..    
-00017db0: 2020 2020 5468 6572 6520 6172 6520 7468      There are th
-00017dc0: 7265 6520 7761 7973 2074 6f20 6a6f 696e  ree ways to join
-00017dd0: 2064 6174 6166 7261 6d65 733a 0a0a 2020   dataframes:..  
-00017de0: 2020 2020 2020 312e 204a 6f69 6e69 6e67        1. Joining
-00017df0: 206f 6e20 696e 6469 6365 732e 2049 6e20   on indices. In 
-00017e00: 7468 6973 2063 6173 6520 7468 6520 6469  this case the di
-00017e10: 7669 7369 6f6e 7320 6172 650a 2020 2020  visions are.    
-00017e20: 2020 2020 2020 2061 6c69 676e 6564 2075         aligned u
-00017e30: 7369 6e67 2074 6865 2066 756e 6374 696f  sing the functio
-00017e40: 6e20 6060 6461 736b 2e64 6174 6166 7261  n ``dask.datafra
-00017e50: 6d65 2e6d 756c 7469 2e61 6c69 676e 5f70  me.multi.align_p
-00017e60: 6172 7469 7469 6f6e 7360 602e 0a20 2020  artitions``..   
-00017e70: 2020 2020 2020 2020 4166 7465 7277 6172          Afterwar
-00017e80: 6473 2c20 6561 6368 2070 6172 7469 7469  ds, each partiti
-00017e90: 6f6e 2069 7320 6d65 7267 6564 2077 6974  on is merged wit
-00017ea0: 6820 7468 6520 7061 6e64 6173 206d 6572  h the pandas mer
-00017eb0: 6765 2066 756e 6374 696f 6e2e 0a0a 2020  ge function...  
-00017ec0: 2020 2020 2020 322e 204a 6f69 6e69 6e67        2. Joining
-00017ed0: 206f 6e65 206f 6e20 696e 6465 7820 616e   one on index an
-00017ee0: 6420 6f6e 6520 6f6e 2063 6f6c 756d 6e2e  d one on column.
-00017ef0: 2049 6e20 7468 6973 2063 6173 6520 7468   In this case th
-00017f00: 6520 6469 7669 7369 6f6e 7320 6f66 0a20  e divisions of. 
-00017f10: 2020 2020 2020 2020 2020 6461 7461 6672            datafr
-00017f20: 616d 6520 6d65 7267 6564 2062 7920 696e  ame merged by in
-00017f30: 6465 7820 283a 6d61 7468 3a60 645f 6960  dex (:math:`d_i`
-00017f40: 2920 6172 6520 7573 6564 2074 6f20 6469  ) are used to di
-00017f50: 7669 6465 2074 6865 2063 6f6c 756d 6e0a  vide the column.
-00017f60: 2020 2020 2020 2020 2020 206d 6572 6765             merge
-00017f70: 6420 6461 7461 6672 616d 6520 283a 6d61  d dataframe (:ma
-00017f80: 7468 3a60 645f 6360 2920 6f6e 6520 7573  th:`d_c`) one us
-00017f90: 696e 670a 2020 2020 2020 2020 2020 2060  ing.           `
-00017fa0: 6064 6173 6b2e 6461 7461 6672 616d 652e  `dask.dataframe.
-00017fb0: 6d75 6c74 692e 7265 6172 7261 6e67 655f  multi.rearrange_
-00017fc0: 6279 5f64 6976 6973 696f 6e73 6060 2e20  by_divisions``. 
-00017fd0: 496e 2074 6869 7320 6361 7365 2074 6865  In this case the
-00017fe0: 0a20 2020 2020 2020 2020 2020 6d65 7267  .           merg
-00017ff0: 6564 2064 6174 6166 7261 6d65 2028 3a6d  ed dataframe (:m
-00018000: 6174 683a 6064 5f6d 6029 2068 6173 2074  ath:`d_m`) has t
-00018010: 6865 2065 7861 6374 2073 616d 6520 6469  he exact same di
-00018020: 7669 7369 6f6e 730a 2020 2020 2020 2020  visions.        
-00018030: 2020 2061 7320 283a 6d61 7468 3a60 645f     as (:math:`d_
-00018040: 6960 292e 2054 6869 7320 6361 6e20 6c65  i`). This can le
-00018050: 6164 2074 6f20 6973 7375 6573 2069 6620  ad to issues if 
-00018060: 796f 7520 6d65 7267 6520 6d75 6c74 6970  you merge multip
-00018070: 6c65 2072 6f77 7320 6672 6f6d 0a20 2020  le rows from.   
-00018080: 2020 2020 2020 2020 283a 6d61 7468 3a60          (:math:`
-00018090: 645f 6360 2920 746f 206f 6e65 2072 6f77  d_c`) to one row
-000180a0: 2069 6e20 283a 6d61 7468 3a60 645f 6960   in (:math:`d_i`
-000180b0: 292e 0a0a 2020 2020 2020 2020 332e 204a  )...        3. J
-000180c0: 6f69 6e69 6e67 2062 6f74 6820 6f6e 2063  oining both on c
-000180d0: 6f6c 756d 6e73 2e20 496e 2074 6869 7320  olumns. In this 
-000180e0: 6361 7365 2061 2068 6173 6820 6a6f 696e  case a hash join
-000180f0: 2069 7320 7065 7266 6f72 6d65 6420 7573   is performed us
-00018100: 696e 670a 2020 2020 2020 2020 2020 2060  ing.           `
-00018110: 6064 6173 6b2e 6461 7461 6672 616d 652e  `dask.dataframe.
-00018120: 6d75 6c74 692e 6861 7368 5f6a 6f69 6e60  multi.hash_join`
-00018130: 602e 0a0a 2020 2020 2020 2020 496e 2073  `...        In s
-00018140: 6f6d 6520 6361 7365 732c 2079 6f75 206d  ome cases, you m
-00018150: 6179 2073 6565 2061 2060 604d 656d 6f72  ay see a ``Memor
-00018160: 7945 7272 6f72 6060 2069 6620 7468 6520  yError`` if the 
-00018170: 6060 6d65 7267 6560 6020 6f70 6572 6174  ``merge`` operat
-00018180: 696f 6e20 7265 7175 6972 6573 0a20 2020  ion requires.   
-00018190: 2020 2020 2061 6e20 696e 7465 726e 616c       an internal
-000181a0: 2060 6073 6875 6666 6c65 6060 2c20 6265   ``shuffle``, be
-000181b0: 6361 7573 6520 7368 7566 666c 696e 6720  cause shuffling 
-000181c0: 706c 6163 6573 2061 6c6c 2072 6f77 7320  places all rows 
-000181d0: 7468 6174 2068 6176 6520 7468 6520 7361  that have the sa
-000181e0: 6d65 0a20 2020 2020 2020 2069 6e64 6578  me.        index
-000181f0: 2069 6e20 7468 6520 7361 6d65 2070 6172   in the same par
-00018200: 7469 7469 6f6e 2e20 546f 2061 766f 6964  tition. To avoid
-00018210: 2074 6869 7320 6572 726f 722c 206d 616b   this error, mak
-00018220: 6520 7375 7265 2061 6c6c 2072 6f77 7320  e sure all rows 
-00018230: 7769 7468 2074 6865 0a20 2020 2020 2020  with the.       
-00018240: 2073 616d 6520 6060 6f6e 6060 2d63 6f6c   same ``on``-col
-00018250: 756d 6e20 7661 6c75 6520 6361 6e20 6669  umn value can fi
-00018260: 7420 6f6e 2061 2073 696e 676c 6520 7061  t on a single pa
-00018270: 7274 6974 696f 6e2e 0a20 2020 2020 2020  rtition..       
-00018280: 2022 2222 0a20 2020 2020 2020 2072 6574   """.        ret
-00018290: 7572 6e20 6d65 7267 6528 0a20 2020 2020  urn merge(.     
-000182a0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-000182b0: 2020 2020 2020 2020 2072 6967 6874 2c0a           right,.
-000182c0: 2020 2020 2020 2020 2020 2020 686f 772c              how,
-000182d0: 0a20 2020 2020 2020 2020 2020 206f 6e2c  .            on,
-000182e0: 0a20 2020 2020 2020 2020 2020 206c 6566  .            lef
-000182f0: 745f 6f6e 2c0a 2020 2020 2020 2020 2020  t_on,.          
-00018300: 2020 7269 6768 745f 6f6e 2c0a 2020 2020    right_on,.    
-00018310: 2020 2020 2020 2020 6c65 6674 5f69 6e64          left_ind
-00018320: 6578 2c0a 2020 2020 2020 2020 2020 2020  ex,.            
-00018330: 7269 6768 745f 696e 6465 782c 0a20 2020  right_index,.   
-00018340: 2020 2020 2020 2020 2073 7566 6669 7865           suffixe
-00018350: 732c 0a20 2020 2020 2020 2020 2020 2069  s,.            i
-00018360: 6e64 6963 6174 6f72 2c0a 2020 2020 2020  ndicator,.      
-00018370: 2020 2020 2020 7368 7566 666c 655f 6d65        shuffle_me
-00018380: 7468 6f64 2c0a 2020 2020 2020 2020 2020  thod,.          
-00018390: 2020 6e70 6172 7469 7469 6f6e 733d 6e70    npartitions=np
-000183a0: 6172 7469 7469 6f6e 732c 0a20 2020 2020  artitions,.     
-000183b0: 2020 2020 2020 2062 726f 6164 6361 7374         broadcast
-000183c0: 3d62 726f 6164 6361 7374 2c0a 2020 2020  =broadcast,.    
-000183d0: 2020 2020 290a 0a20 2020 2040 6465 7269      )..    @deri
-000183e0: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
-000183f0: 4672 616d 6529 0a20 2020 2064 6566 206a  Frame).    def j
-00018400: 6f69 6e28 0a20 2020 2020 2020 2073 656c  oin(.        sel
-00018410: 662c 0a20 2020 2020 2020 206f 7468 6572  f,.        other
-00018420: 2c0a 2020 2020 2020 2020 6f6e 3d4e 6f6e  ,.        on=Non
-00018430: 652c 0a20 2020 2020 2020 2068 6f77 3d22  e,.        how="
-00018440: 6c65 6674 222c 0a20 2020 2020 2020 206c  left",.        l
-00018450: 7375 6666 6978 3d22 222c 0a20 2020 2020  suffix="",.     
-00018460: 2020 2072 7375 6666 6978 3d22 222c 0a20     rsuffix="",. 
-00018470: 2020 2020 2020 2073 6875 6666 6c65 5f6d         shuffle_m
-00018480: 6574 686f 643d 4e6f 6e65 2c0a 2020 2020  ethod=None,.    
-00018490: 2020 2020 6e70 6172 7469 7469 6f6e 733d      npartitions=
-000184a0: 4e6f 6e65 2c0a 2020 2020 293a 0a20 2020  None,.    ):.   
-000184b0: 2020 2020 2069 6620 6e6f 7420 6973 696e       if not isin
-000184c0: 7374 616e 6365 286f 7468 6572 2c20 6c69  stance(other, li
-000184d0: 7374 2920 616e 6420 6e6f 7420 6973 5f64  st) and not is_d
-000184e0: 6173 6b5f 636f 6c6c 6563 7469 6f6e 286f  ask_collection(o
-000184f0: 7468 6572 293a 0a20 2020 2020 2020 2020  ther):.         
-00018500: 2020 206f 7468 6572 203d 2066 726f 6d5f     other = from_
-00018510: 7061 6e64 6173 286f 7468 6572 2c20 6e70  pandas(other, np
-00018520: 6172 7469 7469 6f6e 733d 3129 0a20 2020  artitions=1).   
-00018530: 2020 2020 2069 6620 280a 2020 2020 2020       if (.      
-00018540: 2020 2020 2020 6e6f 7420 6973 696e 7374        not isinst
-00018550: 616e 6365 286f 7468 6572 2c20 6c69 7374  ance(other, list
-00018560: 290a 2020 2020 2020 2020 2020 2020 616e  ).            an
-00018570: 6420 6e6f 7420 6973 5f64 6174 6166 7261  d not is_datafra
-00018580: 6d65 5f6c 696b 6528 6f74 6865 722e 5f6d  me_like(other._m
-00018590: 6574 6129 0a20 2020 2020 2020 2020 2020  eta).           
-000185a0: 2061 6e64 2068 6173 6174 7472 286f 7468   and hasattr(oth
-000185b0: 6572 2e5f 6d65 7461 2c20 226e 616d 6522  er._meta, "name"
-000185c0: 290a 2020 2020 2020 2020 293a 0a20 2020  ).        ):.   
-000185d0: 2020 2020 2020 2020 206f 7468 6572 203d           other =
-000185e0: 206e 6577 5f63 6f6c 6c65 6374 696f 6e28   new_collection(
-000185f0: 6578 7072 2e54 6f46 7261 6d65 286f 7468  expr.ToFrame(oth
-00018600: 6572 2929 0a0a 2020 2020 2020 2020 6966  er))..        if
-00018610: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
-00018620: 6f74 6865 722c 2046 7261 6d65 4261 7365  other, FrameBase
-00018630: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
-00018640: 6620 6e6f 7420 6973 696e 7374 616e 6365  f not isinstance
-00018650: 286f 7468 6572 2c20 6c69 7374 2920 6f72  (other, list) or
-00018660: 206e 6f74 2061 6c6c 280a 2020 2020 2020   not all(.      
-00018670: 2020 2020 2020 2020 2020 6973 696e 7374            isinst
-00018680: 616e 6365 286f 2c20 4672 616d 6542 6173  ance(o, FrameBas
-00018690: 6529 2066 6f72 206f 2069 6e20 6f74 6865  e) for o in othe
-000186a0: 720a 2020 2020 2020 2020 2020 2020 293a  r.            ):
-000186b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000186c0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-000186d0: 7228 226f 7468 6572 206d 7573 7420 6265  r("other must be
-000186e0: 2044 6174 6146 7261 6d65 206f 7220 6c69   DataFrame or li
-000186f0: 7374 206f 6620 4461 7461 4672 616d 6573  st of DataFrames
-00018700: 2229 0a20 2020 2020 2020 2020 2020 2069  ").            i
-00018710: 6620 686f 7720 6e6f 7420 696e 2028 226f  f how not in ("o
-00018720: 7574 6572 222c 2022 6c65 6674 2229 3a0a  uter", "left"):.
-00018730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018740: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-00018750: 2822 6d65 7267 655f 6d75 6c74 6920 6f6e  ("merge_multi on
-00018760: 6c79 2073 7570 706f 7274 7320 6c65 6674  ly supports left
-00018770: 206f 7220 6f75 7465 7220 6a6f 696e 7322   or outer joins"
-00018780: 290a 0a20 2020 2020 2020 2020 2020 206f  )..            o
-00018790: 7468 6572 203d 205b 0a20 2020 2020 2020  ther = [.       
-000187a0: 2020 2020 2020 2020 2066 726f 6d5f 7061           from_pa
-000187b0: 6e64 6173 286f 2c20 6e70 6172 7469 7469  ndas(o, npartiti
-000187c0: 6f6e 733d 3129 2069 6620 6e6f 7420 6973  ons=1) if not is
-000187d0: 5f64 6173 6b5f 636f 6c6c 6563 7469 6f6e  _dask_collection
-000187e0: 286f 2920 656c 7365 206f 0a20 2020 2020  (o) else o.     
-000187f0: 2020 2020 2020 2020 2020 2066 6f72 206f             for o
-00018800: 2069 6e20 6f74 6865 720a 2020 2020 2020   in other.      
-00018810: 2020 2020 2020 5d0a 0a20 2020 2020 2020        ]..       
-00018820: 2020 2020 2072 6574 7572 6e20 6e65 775f       return new_
-00018830: 636f 6c6c 6563 7469 6f6e 280a 2020 2020  collection(.    
-00018840: 2020 2020 2020 2020 2020 2020 4a6f 696e              Join
-00018850: 5265 6375 7273 6976 6528 5b73 656c 662e  Recursive([self.
-00018860: 6578 7072 5d20 2b20 5b6f 2e65 7870 7220  expr] + [o.expr 
-00018870: 666f 7220 6f20 696e 206f 7468 6572 5d2c  for o in other],
-00018880: 2068 6f77 3d68 6f77 290a 2020 2020 2020   how=how).      
-00018890: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-000188a0: 2072 6574 7572 6e20 7365 6c66 2e6d 6572   return self.mer
-000188b0: 6765 280a 2020 2020 2020 2020 2020 2020  ge(.            
-000188c0: 7269 6768 743d 6f74 6865 722c 0a20 2020  right=other,.   
-000188d0: 2020 2020 2020 2020 206c 6566 745f 696e           left_in
-000188e0: 6465 783d 6f6e 2069 7320 4e6f 6e65 2c0a  dex=on is None,.
-000188f0: 2020 2020 2020 2020 2020 2020 7269 6768              righ
-00018900: 745f 696e 6465 783d 5472 7565 2c0a 2020  t_index=True,.  
-00018910: 2020 2020 2020 2020 2020 6c65 6674 5f6f            left_o
-00018920: 6e3d 6f6e 2c0a 2020 2020 2020 2020 2020  n=on,.          
-00018930: 2020 686f 773d 686f 772c 0a20 2020 2020    how=how,.     
-00018940: 2020 2020 2020 2073 7566 6669 7865 733d         suffixes=
-00018950: 286c 7375 6666 6978 2c20 7273 7566 6669  (lsuffix, rsuffi
-00018960: 7829 2c0a 2020 2020 2020 2020 2020 2020  x),.            
-00018970: 7368 7566 666c 655f 6d65 7468 6f64 3d73  shuffle_method=s
-00018980: 6875 6666 6c65 5f6d 6574 686f 642c 0a20  huffle_method,. 
-00018990: 2020 2020 2020 2020 2020 206e 7061 7274             npart
-000189a0: 6974 696f 6e73 3d6e 7061 7274 6974 696f  itions=npartitio
-000189b0: 6e73 2c0a 2020 2020 2020 2020 290a 0a20  ns,.        ).. 
-000189c0: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
-000189d0: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
-000189e0: 2020 2064 6566 2067 726f 7570 6279 280a     def groupby(.
-000189f0: 2020 2020 2020 2020 7365 6c66 2c20 6279          self, by
-00018a00: 2c20 6772 6f75 705f 6b65 7973 3d54 7275  , group_keys=Tru
-00018a10: 652c 2073 6f72 743d 4e6f 6e65 2c20 6f62  e, sort=None, ob
-00018a20: 7365 7276 6564 3d4e 6f6e 652c 2064 726f  served=None, dro
-00018a30: 706e 613d 4e6f 6e65 2c20 2a2a 6b77 6172  pna=None, **kwar
-00018a40: 6773 0a20 2020 2029 3a0a 2020 2020 2020  gs.    ):.      
-00018a50: 2020 6672 6f6d 2064 6173 6b5f 6578 7072    from dask_expr
-00018a60: 2e5f 6772 6f75 7062 7920 696d 706f 7274  ._groupby import
-00018a70: 2047 726f 7570 4279 0a0a 2020 2020 2020   GroupBy..      
-00018a80: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-00018a90: 6279 2c20 4672 616d 6542 6173 6529 2061  by, FrameBase) a
-00018aa0: 6e64 206e 6f74 2069 7369 6e73 7461 6e63  nd not isinstanc
-00018ab0: 6528 6279 2c20 5365 7269 6573 293a 0a20  e(by, Series):. 
-00018ac0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00018ad0: 2056 616c 7565 4572 726f 7228 0a20 2020   ValueError(.   
-00018ae0: 2020 2020 2020 2020 2020 2020 2066 2260               f"`
-00018af0: 6279 6020 6d75 7374 2062 6520 6120 636f  by` must be a co
-00018b00: 6c75 6d6e 206e 616d 6520 6f72 206c 6973  lumn name or lis
-00018b10: 7420 6f66 2063 6f6c 756d 6e73 2c20 676f  t of columns, go
-00018b20: 7420 7b62 797d 2e22 0a20 2020 2020 2020  t {by}.".       
-00018b30: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-00018b40: 7265 7475 726e 2047 726f 7570 4279 280a  return GroupBy(.
-00018b50: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00018b60: 2c0a 2020 2020 2020 2020 2020 2020 6279  ,.            by
-00018b70: 2c0a 2020 2020 2020 2020 2020 2020 6772  ,.            gr
-00018b80: 6f75 705f 6b65 7973 3d67 726f 7570 5f6b  oup_keys=group_k
-00018b90: 6579 732c 0a20 2020 2020 2020 2020 2020  eys,.           
-00018ba0: 2073 6f72 743d 736f 7274 2c0a 2020 2020   sort=sort,.    
-00018bb0: 2020 2020 2020 2020 6f62 7365 7276 6564          observed
-00018bc0: 3d6f 6273 6572 7665 642c 0a20 2020 2020  =observed,.     
-00018bd0: 2020 2020 2020 2064 726f 706e 613d 6472         dropna=dr
-00018be0: 6f70 6e61 2c0a 2020 2020 2020 2020 2020  opna,.          
-00018bf0: 2020 2a2a 6b77 6172 6773 2c0a 2020 2020    **kwargs,.    
-00018c00: 2020 2020 290a 0a20 2020 2064 6566 205f      )..    def _
-00018c10: 5f73 6574 6974 656d 5f5f 2873 656c 662c  _setitem__(self,
-00018c20: 206b 6579 2c20 7661 6c75 6529 3a0a 2020   key, value):.  
-00018c30: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-00018c40: 6e63 6528 6b65 792c 2028 7475 706c 652c  nce(key, (tuple,
-00018c50: 206c 6973 7429 2920 616e 6420 6973 696e   list)) and isin
-00018c60: 7374 616e 6365 2876 616c 7565 2c20 4461  stance(value, Da
-00018c70: 7461 4672 616d 6529 3a0a 2020 2020 2020  taFrame):.      
-00018c80: 2020 2020 2020 6f75 7420 3d20 7365 6c66        out = self
-00018c90: 2e61 7373 6967 6e28 2a2a 7b6b 3a20 7661  .assign(**{k: va
-00018ca0: 6c75 655b 635d 2066 6f72 206b 2c20 6320  lue[c] for k, c 
-00018cb0: 696e 207a 6970 286b 6579 2c20 7661 6c75  in zip(key, valu
-00018cc0: 652e 636f 6c75 6d6e 7329 7d29 0a0a 2020  e.columns)})..  
-00018cd0: 2020 2020 2020 656c 6966 2069 7369 6e73        elif isins
-00018ce0: 7461 6e63 6528 6b65 792c 2070 642e 496e  tance(key, pd.In
-00018cf0: 6465 7829 2061 6e64 206e 6f74 2069 7369  dex) and not isi
-00018d00: 6e73 7461 6e63 6528 7661 6c75 652c 2044  nstance(value, D
-00018d10: 6174 6146 7261 6d65 293a 0a20 2020 2020  ataFrame):.     
-00018d20: 2020 2020 2020 206f 7574 203d 2073 656c         out = sel
-00018d30: 662e 6173 7369 676e 282a 2a7b 6b3a 2076  f.assign(**{k: v
-00018d40: 616c 7565 2066 6f72 206b 2069 6e20 6c69  alue for k in li
-00018d50: 7374 286b 6579 297d 290a 2020 2020 2020  st(key)}).      
-00018d60: 2020 656c 6966 2028 0a20 2020 2020 2020    elif (.       
-00018d70: 2020 2020 2069 735f 6461 7461 6672 616d       is_datafram
-00018d80: 655f 6c69 6b65 286b 6579 290a 2020 2020  e_like(key).    
-00018d90: 2020 2020 2020 2020 6f72 2069 735f 7365          or is_se
-00018da0: 7269 6573 5f6c 696b 6528 6b65 7929 0a20  ries_like(key). 
-00018db0: 2020 2020 2020 2020 2020 206f 7220 6973             or is
-00018dc0: 696e 7374 616e 6365 286b 6579 2c20 2844  instance(key, (D
-00018dd0: 6174 6146 7261 6d65 2c20 5365 7269 6573  ataFrame, Series
-00018de0: 2929 0a20 2020 2020 2020 2029 3a0a 2020  )).        ):.  
-00018df0: 2020 2020 2020 2020 2020 6f75 7420 3d20            out = 
-00018e00: 7365 6c66 2e77 6865 7265 287e 6b65 792c  self.where(~key,
-00018e10: 2076 616c 7565 290a 2020 2020 2020 2020   value).        
-00018e20: 656c 6966 206e 6f74 2069 7369 6e73 7461  elif not isinsta
-00018e30: 6e63 6528 6b65 792c 2073 7472 293a 0a20  nce(key, str):. 
-00018e40: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00018e50: 204e 6f74 496d 706c 656d 656e 7465 6445   NotImplementedE
-00018e60: 7272 6f72 2866 2249 7465 6d20 6173 7369  rror(f"Item assi
-00018e70: 676e 6d65 6e74 2077 6974 6820 7b74 7970  gnment with {typ
-00018e80: 6528 6b65 7929 7d20 6e6f 7420 7375 7070  e(key)} not supp
-00018e90: 6f72 7465 6422 290a 2020 2020 2020 2020  orted").        
-00018ea0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00018eb0: 2020 6f75 7420 3d20 7365 6c66 2e61 7373    out = self.ass
-00018ec0: 6967 6e28 2a2a 7b6b 6579 3a20 7661 6c75  ign(**{key: valu
-00018ed0: 657d 290a 2020 2020 2020 2020 7365 6c66  e}).        self
-00018ee0: 2e5f 6578 7072 203d 206f 7574 2e5f 6578  ._expr = out._ex
-00018ef0: 7072 0a0a 2020 2020 6465 6620 5f5f 6465  pr..    def __de
-00018f00: 6c69 7465 6d5f 5f28 7365 6c66 2c20 6b65  litem__(self, ke
-00018f10: 7929 3a0a 2020 2020 2020 2020 636f 6c75  y):.        colu
-00018f20: 6d6e 7320 3d20 5b63 2066 6f72 2063 2069  mns = [c for c i
-00018f30: 6e20 7365 6c66 2e63 6f6c 756d 6e73 2069  n self.columns i
-00018f40: 6620 6320 213d 206b 6579 5d0a 2020 2020  f c != key].    
-00018f50: 2020 2020 6f75 7420 3d20 7365 6c66 5b63      out = self[c
-00018f60: 6f6c 756d 6e73 5d0a 2020 2020 2020 2020  olumns].        
-00018f70: 7365 6c66 2e5f 6578 7072 203d 206f 7574  self._expr = out
-00018f80: 2e5f 6578 7072 0a0a 2020 2020 6465 6620  ._expr..    def 
-00018f90: 5f5f 6765 7461 7474 725f 5f28 7365 6c66  __getattr__(self
-00018fa0: 2c20 6b65 7929 3a0a 2020 2020 2020 2020  , key):.        
-00018fb0: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
-00018fc0: 2023 2050 7269 6f72 6974 697a 6520 6044   # Prioritize `D
-00018fd0: 6174 6146 7261 6d65 6020 6174 7472 6962  ataFrame` attrib
-00018fe0: 7574 6573 0a20 2020 2020 2020 2020 2020  utes.           
-00018ff0: 2072 6574 7572 6e20 6f62 6a65 6374 2e5f   return object._
-00019000: 5f67 6574 6174 7472 6962 7574 655f 5f28  _getattribute__(
-00019010: 7365 6c66 2c20 6b65 7929 0a20 2020 2020  self, key).     
-00019020: 2020 2065 7863 6570 7420 4174 7472 6962     except Attrib
-00019030: 7574 6545 7272 6f72 2061 7320 6572 723a  uteError as err:
-00019040: 0a20 2020 2020 2020 2020 2020 2074 7279  .            try
-00019050: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00019060: 2020 2320 4368 6563 6b20 6966 206b 6579    # Check if key
-00019070: 2069 7320 696e 2063 6f6c 756d 6e73 2069   is in columns i
-00019080: 6620 6b65 790a 2020 2020 2020 2020 2020  f key.          
-00019090: 2020 2020 2020 2320 6973 206e 6f74 2061        # is not a
-000190a0: 206e 6f72 6d61 6c20 6174 7472 6962 7574   normal attribut
-000190b0: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-000190c0: 2020 6966 206b 6579 2069 6e20 7365 6c66    if key in self
-000190d0: 2e65 7870 722e 5f6d 6574 612e 636f 6c75  .expr._meta.colu
-000190e0: 6d6e 733a 0a20 2020 2020 2020 2020 2020  mns:.           
-000190f0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00019100: 6e65 775f 636f 6c6c 6563 7469 6f6e 2873  new_collection(s
-00019110: 656c 662e 6578 7072 5b6b 6579 5d29 0a20  elf.expr[key]). 
-00019120: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00019130: 6169 7365 2065 7272 0a20 2020 2020 2020  aise err.       
-00019140: 2020 2020 2065 7863 6570 7420 4174 7472       except Attr
-00019150: 6962 7574 6545 7272 6f72 3a0a 2020 2020  ibuteError:.    
-00019160: 2020 2020 2020 2020 2020 2020 2320 4661              # Fa
-00019170: 6c6c 2062 6163 6b20 746f 2060 4261 7365  ll back to `Base
-00019180: 4672 616d 652e 5f5f 6765 7461 7474 725f  Frame.__getattr_
-00019190: 5f60 0a20 2020 2020 2020 2020 2020 2020  _`.             
-000191a0: 2020 2072 6574 7572 6e20 7375 7065 7228     return super(
-000191b0: 292e 5f5f 6765 7461 7474 725f 5f28 6b65  ).__getattr__(ke
-000191c0: 7929 0a0a 2020 2020 6465 6620 5f5f 6469  y)..    def __di
-000191d0: 725f 5f28 7365 6c66 293a 0a20 2020 2020  r__(self):.     
-000191e0: 2020 206f 203d 2073 6574 2864 6972 2874     o = set(dir(t
-000191f0: 7970 6528 7365 6c66 2929 290a 2020 2020  ype(self))).    
-00019200: 2020 2020 6f2e 7570 6461 7465 2873 656c      o.update(sel
-00019210: 662e 5f5f 6469 6374 5f5f 290a 2020 2020  f.__dict__).    
-00019220: 2020 2020 6f2e 7570 6461 7465 2873 6574      o.update(set
-00019230: 2864 6972 2865 7870 722e 4578 7072 2929  (dir(expr.Expr))
-00019240: 290a 2020 2020 2020 2020 6f2e 7570 6461  ).        o.upda
-00019250: 7465 2863 2066 6f72 2063 2069 6e20 7365  te(c for c in se
-00019260: 6c66 2e63 6f6c 756d 6e73 2069 6620 2869  lf.columns if (i
-00019270: 7369 6e73 7461 6e63 6528 632c 2073 7472  sinstance(c, str
-00019280: 2920 616e 6420 632e 6973 6964 656e 7469  ) and c.isidenti
-00019290: 6669 6572 2829 2929 0a20 2020 2020 2020  fier())).       
-000192a0: 2072 6574 7572 6e20 6c69 7374 286f 290a   return list(o).
-000192b0: 0a20 2020 2064 6566 206d 6170 2873 656c  .    def map(sel
-000192c0: 662c 2066 756e 632c 206e 615f 6163 7469  f, func, na_acti
-000192d0: 6f6e 3d4e 6f6e 652c 206d 6574 613d 4e6f  on=None, meta=No
-000192e0: 6e65 293a 0a20 2020 2020 2020 2069 6620  ne):.        if 
-000192f0: 6e6f 7420 5041 4e44 4153 5f47 455f 3231  not PANDAS_GE_21
-00019300: 303a 0a20 2020 2020 2020 2020 2020 2072  0:.            r
-00019310: 6169 7365 204e 6f74 496d 706c 656d 656e  aise NotImplemen
-00019320: 7465 6445 7272 6f72 280a 2020 2020 2020  tedError(.      
-00019330: 2020 2020 2020 2020 2020 6622 4461 7461            f"Data
-00019340: 4672 616d 652e 6d61 7020 7265 7175 6972  Frame.map requir
-00019350: 6573 2070 616e 6461 733e 3d32 2e31 2e30  es pandas>=2.1.0
-00019360: 2c20 6275 7420 7061 6e64 6173 3d7b 5041  , but pandas={PA
-00019370: 4e44 4153 5f56 4552 5349 4f4e 7d20 6973  NDAS_VERSION} is
-00019380: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
-00019390: 2020 2022 696e 7374 616c 6c65 642e 220a     "installed.".
-000193a0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-000193b0: 2020 2020 2020 6966 206d 6574 6120 6973        if meta is
-000193c0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-000193d0: 2020 206d 6574 6120 3d20 6578 7072 2e5f     meta = expr._
-000193e0: 656d 756c 6174 6528 4d2e 6d61 702c 2073  emulate(M.map, s
-000193f0: 656c 662c 2066 756e 632c 206e 615f 6163  elf, func, na_ac
-00019400: 7469 6f6e 3d6e 615f 6163 7469 6f6e 2c20  tion=na_action, 
-00019410: 7564 663d 5472 7565 290a 2020 2020 2020  udf=True).      
-00019420: 2020 2020 2020 7761 726e 696e 6773 2e77        warnings.w
-00019430: 6172 6e28 6d65 7461 5f77 6172 6e69 6e67  arn(meta_warning
-00019440: 286d 6574 6129 290a 2020 2020 2020 2020  (meta)).        
-00019450: 7265 7475 726e 206e 6577 5f63 6f6c 6c65  return new_colle
-00019460: 6374 696f 6e28 6578 7072 2e4d 6170 2873  ction(expr.Map(s
-00019470: 656c 662c 2061 7267 3d66 756e 632c 206e  elf, arg=func, n
-00019480: 615f 6163 7469 6f6e 3d6e 615f 6163 7469  a_action=na_acti
-00019490: 6f6e 2c20 6d65 7461 3d6d 6574 6129 290a  on, meta=meta)).
-000194a0: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
-000194b0: 6f6d 2870 642e 4461 7461 4672 616d 6529  om(pd.DataFrame)
-000194c0: 0a20 2020 2064 6566 206e 6c61 7267 6573  .    def nlarges
-000194d0: 7428 7365 6c66 2c20 6e3d 352c 2063 6f6c  t(self, n=5, col
-000194e0: 756d 6e73 3d4e 6f6e 652c 2073 706c 6974  umns=None, split
-000194f0: 5f65 7665 7279 3d4e 6f6e 6529 3a0a 2020  _every=None):.  
-00019500: 2020 2020 2020 7265 7475 726e 206e 6577        return new
-00019510: 5f63 6f6c 6c65 6374 696f 6e28 0a20 2020  _collection(.   
-00019520: 2020 2020 2020 2020 204e 4c61 7267 6573           NLarges
-00019530: 7428 7365 6c66 2c20 6e3d 6e2c 205f 636f  t(self, n=n, _co
-00019540: 6c75 6d6e 733d 636f 6c75 6d6e 732c 2073  lumns=columns, s
-00019550: 706c 6974 5f65 7665 7279 3d73 706c 6974  plit_every=split
-00019560: 5f65 7665 7279 290a 2020 2020 2020 2020  _every).        
-00019570: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
-00019580: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
-00019590: 6529 0a20 2020 2064 6566 206e 736d 616c  e).    def nsmal
-000195a0: 6c65 7374 2873 656c 662c 206e 3d35 2c20  lest(self, n=5, 
-000195b0: 636f 6c75 6d6e 733d 4e6f 6e65 2c20 7370  columns=None, sp
-000195c0: 6c69 745f 6576 6572 793d 4e6f 6e65 293a  lit_every=None):
-000195d0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000195e0: 6e65 775f 636f 6c6c 6563 7469 6f6e 280a  new_collection(.
-000195f0: 2020 2020 2020 2020 2020 2020 4e53 6d61              NSma
-00019600: 6c6c 6573 7428 7365 6c66 2c20 6e3d 6e2c  llest(self, n=n,
-00019610: 205f 636f 6c75 6d6e 733d 636f 6c75 6d6e   _columns=column
-00019620: 732c 2073 706c 6974 5f65 7665 7279 3d73  s, split_every=s
-00019630: 706c 6974 5f65 7665 7279 290a 2020 2020  plit_every).    
-00019640: 2020 2020 290a 0a20 2020 2040 6465 7269      )..    @deri
-00019650: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
-00019660: 4672 616d 6529 0a20 2020 2064 6566 206d  Frame).    def m
-00019670: 656d 6f72 795f 7573 6167 6528 7365 6c66  emory_usage(self
-00019680: 2c20 6465 6570 3d46 616c 7365 2c20 696e  , deep=False, in
-00019690: 6465 783d 5472 7565 293a 0a20 2020 2020  dex=True):.     
-000196a0: 2020 2072 6574 7572 6e20 6e65 775f 636f     return new_co
-000196b0: 6c6c 6563 7469 6f6e 284d 656d 6f72 7955  llection(MemoryU
-000196c0: 7361 6765 4672 616d 6528 7365 6c66 2c20  sageFrame(self, 
-000196d0: 6465 6570 3d64 6565 702c 205f 696e 6465  deep=deep, _inde
-000196e0: 783d 696e 6465 7829 290a 0a20 2020 2040  x=index))..    @
-000196f0: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
-00019700: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
-00019710: 6566 2063 6f6d 6269 6e65 2873 656c 662c  ef combine(self,
-00019720: 206f 7468 6572 2c20 6675 6e63 2c20 6669   other, func, fi
-00019730: 6c6c 5f76 616c 7565 3d4e 6f6e 652c 206f  ll_value=None, o
-00019740: 7665 7277 7269 7465 3d54 7275 6529 3a0a  verwrite=True):.
-00019750: 2020 2020 2020 2020 6f74 6865 7220 3d20          other = 
-00019760: 7365 6c66 2e5f 6372 6561 7465 5f61 6c69  self._create_ali
-00019770: 676e 6162 6c65 5f66 7261 6d65 286f 7468  gnable_frame(oth
-00019780: 6572 2c20 226f 7574 6572 2229 0a20 2020  er, "outer").   
-00019790: 2020 2020 2069 6620 6e6f 7420 6578 7072       if not expr
-000197a0: 2e61 7265 5f63 6f5f 616c 6967 6e65 6428  .are_co_aligned(
-000197b0: 7365 6c66 2e65 7870 722c 206f 7468 6572  self.expr, other
-000197c0: 2e65 7870 7229 3a0a 2020 2020 2020 2020  .expr):.        
-000197d0: 2020 2020 7265 7475 726e 206e 6577 5f63      return new_c
-000197e0: 6f6c 6c65 6374 696f 6e28 0a20 2020 2020  ollection(.     
-000197f0: 2020 2020 2020 2020 2020 2065 7870 722e             expr.
-00019800: 436f 6d62 696e 6546 7261 6d65 416c 6967  CombineFrameAlig
-00019810: 6e28 7365 6c66 2c20 6f74 6865 722c 2066  n(self, other, f
-00019820: 756e 632c 2066 696c 6c5f 7661 6c75 652c  unc, fill_value,
-00019830: 206f 7665 7277 7269 7465 290a 2020 2020   overwrite).    
-00019840: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00019850: 2020 7265 7475 726e 206e 6577 5f63 6f6c    return new_col
-00019860: 6c65 6374 696f 6e28 0a20 2020 2020 2020  lection(.       
-00019870: 2020 2020 2065 7870 722e 436f 6d62 696e       expr.Combin
-00019880: 6546 7261 6d65 2873 656c 662c 206f 7468  eFrame(self, oth
-00019890: 6572 2c20 6675 6e63 2c20 6669 6c6c 5f76  er, func, fill_v
-000198a0: 616c 7565 2c20 6f76 6572 7772 6974 6529  alue, overwrite)
-000198b0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-000198c0: 4064 6572 6976 6564 5f66 726f 6d28 0a20  @derived_from(. 
-000198d0: 2020 2020 2020 2070 642e 4461 7461 4672         pd.DataFr
-000198e0: 616d 652c 0a20 2020 2020 2020 2069 6e63  ame,.        inc
-000198f0: 6f6e 7369 7374 656e 6369 6573 3d22 6b65  onsistencies="ke
-00019900: 6570 3d46 616c 7365 2077 696c 6c20 7261  ep=False will ra
-00019910: 6973 6520 6120 6060 4e6f 7449 6d70 6c65  ise a ``NotImple
-00019920: 6d65 6e74 6564 4572 726f 7260 6022 2c0a  mentedError``",.
-00019930: 2020 2020 290a 2020 2020 6465 6620 6472      ).    def dr
-00019940: 6f70 5f64 7570 6c69 6361 7465 7328 0a20  op_duplicates(. 
-00019950: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-00019960: 2020 2020 2073 7562 7365 743d 4e6f 6e65       subset=None
-00019970: 2c0a 2020 2020 2020 2020 7370 6c69 745f  ,.        split_
-00019980: 6576 6572 793d 4e6f 6e65 2c0a 2020 2020  every=None,.    
-00019990: 2020 2020 7370 6c69 745f 6f75 743d 5472      split_out=Tr
-000199a0: 7565 2c0a 2020 2020 2020 2020 7368 7566  ue,.        shuf
-000199b0: 666c 655f 6d65 7468 6f64 3d4e 6f6e 652c  fle_method=None,
-000199c0: 0a20 2020 2020 2020 2069 676e 6f72 655f  .        ignore_
-000199d0: 696e 6465 783d 4661 6c73 652c 0a20 2020  index=False,.   
-000199e0: 2020 2020 206b 6565 703d 2266 6972 7374       keep="first
-000199f0: 222c 0a20 2020 2029 3a0a 2020 2020 2020  ",.    ):.      
-00019a00: 2020 7368 7566 666c 655f 6d65 7468 6f64    shuffle_method
-00019a10: 203d 205f 6765 745f 7368 7566 666c 655f   = _get_shuffle_
-00019a20: 7072 6566 6572 7269 6e67 5f6f 7264 6572  preferring_order
-00019a30: 2873 6875 6666 6c65 5f6d 6574 686f 6429  (shuffle_method)
-00019a40: 0a20 2020 2020 2020 2069 6620 6b65 6570  .        if keep
-00019a50: 2069 7320 4661 6c73 653a 0a20 2020 2020   is False:.     
-00019a60: 2020 2020 2020 2072 6169 7365 204e 6f74         raise Not
-00019a70: 496d 706c 656d 656e 7465 6445 7272 6f72  ImplementedError
-00019a80: 2822 6472 6f70 5f64 7570 6c69 6361 7465  ("drop_duplicate
-00019a90: 7320 7769 7468 206b 6565 703d 4661 6c73  s with keep=Fals
-00019aa0: 6522 290a 2020 2020 2020 2020 2320 4661  e").        # Fa
-00019ab0: 696c 2065 6172 6c79 2069 6620 7375 6273  il early if subs
-00019ac0: 6574 2069 7320 6e6f 7420 7661 6c69 642c  et is not valid,
-00019ad0: 2065 2e67 2e20 6d69 7373 696e 6720 636f   e.g. missing co
-00019ae0: 6c75 6d6e 730a 2020 2020 2020 2020 7375  lumns.        su
-00019af0: 6273 6574 203d 205f 636f 6e76 6572 745f  bset = _convert_
-00019b00: 746f 5f6c 6973 7428 7375 6273 6574 290a  to_list(subset).
-00019b10: 2020 2020 2020 2020 6d65 7461 5f6e 6f6e          meta_non
-00019b20: 656d 7074 7928 7365 6c66 2e5f 6d65 7461  empty(self._meta
-00019b30: 292e 6472 6f70 5f64 7570 6c69 6361 7465  ).drop_duplicate
-00019b40: 7328 7375 6273 6574 3d73 7562 7365 742c  s(subset=subset,
-00019b50: 206b 6565 703d 6b65 6570 290a 2020 2020   keep=keep).    
-00019b60: 2020 2020 7265 7475 726e 206e 6577 5f63      return new_c
-00019b70: 6f6c 6c65 6374 696f 6e28 0a20 2020 2020  ollection(.     
-00019b80: 2020 2020 2020 2044 726f 7044 7570 6c69         DropDupli
-00019b90: 6361 7465 7328 0a20 2020 2020 2020 2020  cates(.         
-00019ba0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-00019bb0: 2020 2020 2020 2020 2020 2020 2073 7562               sub
-00019bc0: 7365 743d 7375 6273 6574 2c0a 2020 2020  set=subset,.    
-00019bd0: 2020 2020 2020 2020 2020 2020 6967 6e6f              igno
-00019be0: 7265 5f69 6e64 6578 3d69 676e 6f72 655f  re_index=ignore_
-00019bf0: 696e 6465 782c 0a20 2020 2020 2020 2020  index,.         
-00019c00: 2020 2020 2020 2073 706c 6974 5f6f 7574         split_out
-00019c10: 3d73 706c 6974 5f6f 7574 2c0a 2020 2020  =split_out,.    
-00019c20: 2020 2020 2020 2020 2020 2020 7370 6c69              spli
-00019c30: 745f 6576 6572 793d 7370 6c69 745f 6576  t_every=split_ev
-00019c40: 6572 792c 0a20 2020 2020 2020 2020 2020  ery,.           
-00019c50: 2020 2020 2073 6875 6666 6c65 5f6d 6574       shuffle_met
-00019c60: 686f 643d 7368 7566 666c 655f 6d65 7468  hod=shuffle_meth
-00019c70: 6f64 2c0a 2020 2020 2020 2020 2020 2020  od,.            
-00019c80: 2020 2020 6b65 6570 3d6b 6565 702c 0a20      keep=keep,. 
-00019c90: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00019ca0: 2020 2020 2029 0a0a 2020 2020 4069 6e73       )..    @ins
-00019cb0: 6572 745f 6d65 7461 5f70 6172 616d 5f64  ert_meta_param_d
-00019cc0: 6573 6372 6970 7469 6f6e 2870 6164 3d31  escription(pad=1
-00019cd0: 3229 0a20 2020 2064 6566 2061 7070 6c79  2).    def apply
-00019ce0: 2873 656c 662c 2066 756e 6374 696f 6e2c  (self, function,
-00019cf0: 202a 6172 6773 2c20 6d65 7461 3d6e 6f5f   *args, meta=no_
-00019d00: 6465 6661 756c 742c 2061 7869 733d 302c  default, axis=0,
-00019d10: 202a 2a6b 7761 7267 7329 3a0a 2020 2020   **kwargs):.    
-00019d20: 2020 2020 2222 2250 6172 616c 6c65 6c20      """Parallel 
-00019d30: 7665 7273 696f 6e20 6f66 2070 616e 6461  version of panda
-00019d40: 732e 4461 7461 4672 616d 652e 6170 706c  s.DataFrame.appl
-00019d50: 790a 0a20 2020 2020 2020 2054 6869 7320  y..        This 
-00019d60: 6d69 6d69 6373 2074 6865 2070 616e 6461  mimics the panda
-00019d70: 7320 7665 7273 696f 6e20 6578 6365 7074  s version except
-00019d80: 2066 6f72 2074 6865 2066 6f6c 6c6f 7769   for the followi
-00019d90: 6e67 3a0a 0a20 2020 2020 2020 2031 2e20  ng:..        1. 
-00019da0: 204f 6e6c 7920 6060 6178 6973 3d31 6060   Only ``axis=1``
-00019db0: 2069 7320 7375 7070 6f72 7465 6420 2861   is supported (a
-00019dc0: 6e64 206d 7573 7420 6265 2073 7065 6369  nd must be speci
-00019dd0: 6669 6564 2065 7870 6c69 6369 746c 7929  fied explicitly)
-00019de0: 2e0a 2020 2020 2020 2020 322e 2020 5468  ..        2.  Th
-00019df0: 6520 7573 6572 2073 686f 756c 6420 7072  e user should pr
-00019e00: 6f76 6964 6520 6f75 7470 7574 206d 6574  ovide output met
-00019e10: 6164 6174 6120 7669 6120 7468 6520 606d  adata via the `m
-00019e20: 6574 6160 206b 6579 776f 7264 2e0a 0a20  eta` keyword... 
-00019e30: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-00019e40: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
-00019e50: 2d2d 2d2d 0a20 2020 2020 2020 2066 756e  ----.        fun
-00019e60: 6320 3a20 6675 6e63 7469 6f6e 0a20 2020  c : function.   
-00019e70: 2020 2020 2020 2020 2046 756e 6374 696f           Functio
-00019e80: 6e20 746f 2061 7070 6c79 2074 6f20 6561  n to apply to ea
-00019e90: 6368 2063 6f6c 756d 6e2f 726f 770a 2020  ch column/row.  
-00019ea0: 2020 2020 2020 6178 6973 203a 207b 3020        axis : {0 
-00019eb0: 6f72 2027 696e 6465 7827 2c20 3120 6f72  or 'index', 1 or
-00019ec0: 2027 636f 6c75 6d6e 7327 7d2c 2064 6566   'columns'}, def
-00019ed0: 6175 6c74 2030 0a20 2020 2020 2020 2020  ault 0.         
-00019ee0: 2020 202d 2030 206f 7220 2769 6e64 6578     - 0 or 'index
-00019ef0: 273a 2061 7070 6c79 2066 756e 6374 696f  ': apply functio
-00019f00: 6e20 746f 2065 6163 6820 636f 6c75 6d6e  n to each column
-00019f10: 2028 4e4f 5420 5355 5050 4f52 5445 4429   (NOT SUPPORTED)
-00019f20: 0a20 2020 2020 2020 2020 2020 202d 2031  .            - 1
-00019f30: 206f 7220 2763 6f6c 756d 6e73 273a 2061   or 'columns': a
-00019f40: 7070 6c79 2066 756e 6374 696f 6e20 746f  pply function to
-00019f50: 2065 6163 6820 726f 770a 2020 2020 2020   each row.      
-00019f60: 2020 244d 4554 410a 2020 2020 2020 2020    $META.        
-00019f70: 6172 6773 203a 2074 7570 6c65 0a20 2020  args : tuple.   
-00019f80: 2020 2020 2020 2020 2050 6f73 6974 696f           Positio
-00019f90: 6e61 6c20 6172 6775 6d65 6e74 7320 746f  nal arguments to
-00019fa0: 2070 6173 7320 746f 2066 756e 6374 696f   pass to functio
-00019fb0: 6e20 696e 2061 6464 6974 696f 6e20 746f  n in addition to
-00019fc0: 2074 6865 2061 7272 6179 2f73 6572 6965   the array/serie
-00019fd0: 730a 0a20 2020 2020 2020 2041 6464 6974  s..        Addit
-00019fe0: 696f 6e61 6c20 6b65 7977 6f72 6420 6172  ional keyword ar
-00019ff0: 6775 6d65 6e74 7320 7769 6c6c 2062 6520  guments will be 
-0001a000: 7061 7373 6564 2061 7320 6b65 7977 6f72  passed as keywor
-0001a010: 6473 2074 6f20 7468 6520 6675 6e63 7469  ds to the functi
-0001a020: 6f6e 0a0a 2020 2020 2020 2020 5265 7475  on..        Retu
-0001a030: 726e 730a 2020 2020 2020 2020 2d2d 2d2d  rns.        ----
-0001a040: 2d2d 2d0a 2020 2020 2020 2020 6170 706c  ---.        appl
-0001a050: 6965 6420 3a20 5365 7269 6573 206f 7220  ied : Series or 
-0001a060: 4461 7461 4672 616d 650a 0a20 2020 2020  DataFrame..     
-0001a070: 2020 2045 7861 6d70 6c65 730a 2020 2020     Examples.    
-0001a080: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
-0001a090: 2020 2020 203e 3e3e 2069 6d70 6f72 7420       >>> import 
-0001a0a0: 7061 6e64 6173 2061 7320 7064 0a20 2020  pandas as pd.   
-0001a0b0: 2020 2020 203e 3e3e 2069 6d70 6f72 7420       >>> import 
-0001a0c0: 6461 736b 2e64 6174 6166 7261 6d65 2061  dask.dataframe a
-0001a0d0: 7320 6464 0a20 2020 2020 2020 203e 3e3e  s dd.        >>>
-0001a0e0: 2064 6620 3d20 7064 2e44 6174 6146 7261   df = pd.DataFra
-0001a0f0: 6d65 287b 2778 273a 205b 312c 2032 2c20  me({'x': [1, 2, 
-0001a100: 332c 2034 2c20 355d 2c0a 2020 2020 2020  3, 4, 5],.      
-0001a110: 2020 2e2e 2e20 2020 2020 2020 2020 2020    ...           
-0001a120: 2020 2020 2020 2020 2027 7927 3a20 5b31           'y': [1
-0001a130: 2e2c 2032 2e2c 2033 2e2c 2034 2e2c 2035  ., 2., 3., 4., 5
-0001a140: 2e5d 7d29 0a20 2020 2020 2020 203e 3e3e  .]}).        >>>
-0001a150: 2064 6466 203d 2064 642e 6672 6f6d 5f70   ddf = dd.from_p
-0001a160: 616e 6461 7328 6466 2c20 6e70 6172 7469  andas(df, nparti
-0001a170: 7469 6f6e 733d 3229 0a0a 2020 2020 2020  tions=2)..      
-0001a180: 2020 4170 706c 7920 6120 6675 6e63 7469    Apply a functi
-0001a190: 6f6e 2074 6f20 726f 772d 7769 7365 2070  on to row-wise p
-0001a1a0: 6173 7369 6e67 2069 6e20 6578 7472 6120  assing in extra 
-0001a1b0: 6172 6775 6d65 6e74 7320 696e 2060 6061  arguments in ``a
-0001a1c0: 7267 7360 6020 616e 640a 2020 2020 2020  rgs`` and.      
-0001a1d0: 2020 6060 6b77 6172 6773 6060 3a0a 0a20    ``kwargs``:.. 
-0001a1e0: 2020 2020 2020 203e 3e3e 2064 6566 206d         >>> def m
-0001a1f0: 7961 6464 2872 6f77 2c20 612c 2062 3d31  yadd(row, a, b=1
-0001a200: 293a 0a20 2020 2020 2020 202e 2e2e 2020  ):.        ...  
-0001a210: 2020 2072 6574 7572 6e20 726f 772e 7375     return row.su
-0001a220: 6d28 2920 2b20 6120 2b20 620a 2020 2020  m() + a + b.    
-0001a230: 2020 2020 3e3e 3e20 7265 7320 3d20 6464      >>> res = dd
-0001a240: 662e 6170 706c 7928 6d79 6164 642c 2061  f.apply(myadd, a
-0001a250: 7869 733d 312c 2061 7267 733d 2832 2c29  xis=1, args=(2,)
-0001a260: 2c20 623d 312e 3529 2020 2320 646f 6374  , b=1.5)  # doct
-0001a270: 6573 743a 202b 534b 4950 0a0a 2020 2020  est: +SKIP..    
-0001a280: 2020 2020 4279 2064 6566 6175 6c74 2c20      By default, 
-0001a290: 6461 736b 2074 7269 6573 2074 6f20 696e  dask tries to in
-0001a2a0: 6665 7220 7468 6520 6f75 7470 7574 206d  fer the output m
-0001a2b0: 6574 6164 6174 6120 6279 2072 756e 6e69  etadata by runni
-0001a2c0: 6e67 2079 6f75 720a 2020 2020 2020 2020  ng your.        
-0001a2d0: 7072 6f76 6964 6564 2066 756e 6374 696f  provided functio
-0001a2e0: 6e20 6f6e 2073 6f6d 6520 6661 6b65 2064  n on some fake d
-0001a2f0: 6174 612e 2054 6869 7320 776f 726b 7320  ata. This works 
-0001a300: 7765 6c6c 2069 6e20 6d61 6e79 2063 6173  well in many cas
-0001a310: 6573 2c20 6275 740a 2020 2020 2020 2020  es, but.        
-0001a320: 6361 6e20 736f 6d65 7469 6d65 7320 6265  can sometimes be
-0001a330: 2065 7870 656e 7369 7665 2c20 6f72 2065   expensive, or e
-0001a340: 7665 6e20 6661 696c 2e20 546f 2061 766f  ven fail. To avo
-0001a350: 6964 2074 6869 732c 2079 6f75 2063 616e  id this, you can
-0001a360: 0a20 2020 2020 2020 206d 616e 7561 6c6c  .        manuall
-0001a370: 7920 7370 6563 6966 7920 7468 6520 6f75  y specify the ou
-0001a380: 7470 7574 206d 6574 6164 6174 6120 7769  tput metadata wi
-0001a390: 7468 2074 6865 2060 606d 6574 6160 6020  th the ``meta`` 
-0001a3a0: 6b65 7977 6f72 642e 2054 6869 730a 2020  keyword. This.  
-0001a3b0: 2020 2020 2020 6361 6e20 6265 2073 7065        can be spe
-0001a3c0: 6369 6669 6564 2069 6e20 6d61 6e79 2066  cified in many f
-0001a3d0: 6f72 6d73 2c20 666f 7220 6d6f 7265 2069  orms, for more i
-0001a3e0: 6e66 6f72 6d61 7469 6f6e 2073 6565 0a20  nformation see. 
-0001a3f0: 2020 2020 2020 2060 6064 6173 6b2e 6461         ``dask.da
-0001a400: 7461 6672 616d 652e 7574 696c 732e 6d61  taframe.utils.ma
-0001a410: 6b65 5f6d 6574 6160 602e 0a0a 2020 2020  ke_meta``...    
-0001a420: 2020 2020 4865 7265 2077 6520 7370 6563      Here we spec
-0001a430: 6966 7920 7468 6520 6f75 7470 7574 2069  ify the output i
-0001a440: 7320 6120 5365 7269 6573 2077 6974 6820  s a Series with 
-0001a450: 6e61 6d65 2060 6027 7827 6060 2c20 616e  name ``'x'``, an
-0001a460: 6420 6474 7970 650a 2020 2020 2020 2020  d dtype.        
-0001a470: 6060 666c 6f61 7436 3460 603a 0a0a 2020  ``float64``:..  
-0001a480: 2020 2020 2020 3e3e 3e20 7265 7320 3d20        >>> res = 
-0001a490: 6464 662e 6170 706c 7928 6d79 6164 642c  ddf.apply(myadd,
-0001a4a0: 2061 7869 733d 312c 2061 7267 733d 2832   axis=1, args=(2
-0001a4b0: 2c29 2c20 623d 312e 352c 206d 6574 613d  ,), b=1.5, meta=
-0001a4c0: 2827 7827 2c20 2766 3827 2929 0a0a 2020  ('x', 'f8'))..  
-0001a4d0: 2020 2020 2020 496e 2074 6865 2063 6173        In the cas
-0001a4e0: 6520 7768 6572 6520 7468 6520 6d65 7461  e where the meta
-0001a4f0: 6461 7461 2064 6f65 736e 2774 2063 6861  data doesn't cha
-0001a500: 6e67 652c 2079 6f75 2063 616e 2061 6c73  nge, you can als
-0001a510: 6f20 7061 7373 2069 6e0a 2020 2020 2020  o pass in.      
-0001a520: 2020 7468 6520 6f62 6a65 6374 2069 7473    the object its
-0001a530: 656c 6620 6469 7265 6374 6c79 3a0a 0a20  elf directly:.. 
-0001a540: 2020 2020 2020 203e 3e3e 2072 6573 203d         >>> res =
-0001a550: 2064 6466 2e61 7070 6c79 286c 616d 6264   ddf.apply(lambd
-0001a560: 6120 726f 773a 2072 6f77 202b 2031 2c20  a row: row + 1, 
-0001a570: 6178 6973 3d31 2c20 6d65 7461 3d64 6466  axis=1, meta=ddf
-0001a580: 290a 0a20 2020 2020 2020 2053 6565 2041  )..        See A
-0001a590: 6c73 6f0a 2020 2020 2020 2020 2d2d 2d2d  lso.        ----
-0001a5a0: 2d2d 2d2d 0a20 2020 2020 2020 2044 6174  ----.        Dat
-0001a5b0: 6146 7261 6d65 2e6d 6170 5f70 6172 7469  aFrame.map_parti
-0001a5c0: 7469 6f6e 730a 2020 2020 2020 2020 2222  tions.        ""
-0001a5d0: 220a 2020 2020 2020 2020 6178 6973 203d  ".        axis =
-0001a5e0: 2073 656c 662e 5f76 616c 6964 6174 655f   self._validate_
-0001a5f0: 6178 6973 2861 7869 7329 0a20 2020 2020  axis(axis).     
-0001a600: 2020 2069 6620 6178 6973 203d 3d20 303a     if axis == 0:
-0001a610: 0a20 2020 2020 2020 2020 2020 206d 7367  .            msg
-0001a620: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
-0001a630: 2020 2020 2022 4461 736b 2044 6174 6146       "Dask DataF
-0001a640: 7261 6d65 2e61 7070 6c79 206f 6e6c 7920  rame.apply only 
-0001a650: 7375 7070 6f72 7473 2061 7869 733d 315c  supports axis=1\
-0001a660: 6e22 0a20 2020 2020 2020 2020 2020 2020  n".             
-0001a670: 2020 2022 2020 5472 793a 2064 662e 6170     "  Try: df.ap
-0001a680: 706c 7928 6675 6e63 2c20 6178 6973 3d31  ply(func, axis=1
-0001a690: 2922 0a20 2020 2020 2020 2020 2020 2029  )".            )
-0001a6a0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-0001a6b0: 7365 204e 6f74 496d 706c 656d 656e 7465  se NotImplemente
-0001a6c0: 6445 7272 6f72 286d 7367 290a 2020 2020  dError(msg).    
-0001a6d0: 2020 2020 6966 206d 6574 6120 6973 206e      if meta is n
-0001a6e0: 6f5f 6465 6661 756c 743a 0a20 2020 2020  o_default:.     
-0001a6f0: 2020 2020 2020 206d 6574 6120 3d20 6578         meta = ex
-0001a700: 7072 2e5f 656d 756c 6174 6528 0a20 2020  pr._emulate(.   
-0001a710: 2020 2020 2020 2020 2020 2020 204d 2e61               M.a
-0001a720: 7070 6c79 2c20 7365 6c66 2c20 6675 6e63  pply, self, func
-0001a730: 7469 6f6e 2c20 6172 6773 3d61 7267 732c  tion, args=args,
-0001a740: 2075 6466 3d54 7275 652c 2061 7869 733d   udf=True, axis=
-0001a750: 6178 6973 2c20 2a2a 6b77 6172 6773 0a20  axis, **kwargs. 
-0001a760: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-0001a770: 2020 2020 2020 2020 2077 6172 6e69 6e67           warning
-0001a780: 732e 7761 726e 286d 6574 615f 7761 726e  s.warn(meta_warn
-0001a790: 696e 6728 6d65 7461 2929 0a20 2020 2020  ing(meta)).     
-0001a7a0: 2020 2072 6574 7572 6e20 6e65 775f 636f     return new_co
-0001a7b0: 6c6c 6563 7469 6f6e 280a 2020 2020 2020  llection(.      
-0001a7c0: 2020 2020 2020 7365 6c66 2e65 7870 722e        self.expr.
-0001a7d0: 6170 706c 7928 6675 6e63 7469 6f6e 2c20  apply(function, 
-0001a7e0: 2a61 7267 732c 206d 6574 613d 6d65 7461  *args, meta=meta
-0001a7f0: 2c20 6178 6973 3d61 7869 732c 202a 2a6b  , axis=axis, **k
-0001a800: 7761 7267 7329 0a20 2020 2020 2020 2029  wargs).        )
-0001a810: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
-0001a820: 726f 6d28 7064 2e44 6174 6146 7261 6d65  rom(pd.DataFrame
-0001a830: 290a 2020 2020 6465 6620 6472 6f70 6e61  ).    def dropna
-0001a840: 2873 656c 662c 2068 6f77 3d6e 6f5f 6465  (self, how=no_de
-0001a850: 6661 756c 742c 2073 7562 7365 743d 4e6f  fault, subset=No
-0001a860: 6e65 2c20 7468 7265 7368 3d6e 6f5f 6465  ne, thresh=no_de
-0001a870: 6661 756c 7429 3a0a 2020 2020 2020 2020  fault):.        
-0001a880: 6966 2068 6f77 2069 7320 6e6f 7420 6e6f  if how is not no
-0001a890: 5f64 6566 6175 6c74 2061 6e64 2074 6872  _default and thr
-0001a8a0: 6573 6820 6973 206e 6f74 206e 6f5f 6465  esh is not no_de
-0001a8b0: 6661 756c 743a 0a20 2020 2020 2020 2020  fault:.         
-0001a8c0: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
-0001a8d0: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-0001a8e0: 2020 2020 2259 6f75 2063 616e 6e6f 7420      "You cannot 
-0001a8f0: 7365 7420 626f 7468 2074 6865 2068 6f77  set both the how
-0001a900: 2061 6e64 2074 6872 6573 6820 6172 6775   and thresh argu
-0001a910: 6d65 6e74 7320 6174 2074 6865 2073 616d  ments at the sam
-0001a920: 6520 7469 6d65 2e22 0a20 2020 2020 2020  e time.".       
-0001a930: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
-0001a940: 7562 7365 7420 3d20 5f63 6f6e 7665 7274  ubset = _convert
-0001a950: 5f74 6f5f 6c69 7374 2873 7562 7365 7429  _to_list(subset)
-0001a960: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0001a970: 6e65 775f 636f 6c6c 6563 7469 6f6e 280a  new_collection(.
-0001a980: 2020 2020 2020 2020 2020 2020 6578 7072              expr
-0001a990: 2e44 726f 706e 6146 7261 6d65 2873 656c  .DropnaFrame(sel
-0001a9a0: 662c 2068 6f77 3d68 6f77 2c20 7375 6273  f, how=how, subs
-0001a9b0: 6574 3d73 7562 7365 742c 2074 6872 6573  et=subset, thres
-0001a9c0: 683d 7468 7265 7368 290a 2020 2020 2020  h=thresh).      
-0001a9d0: 2020 290a 0a20 2020 2040 636c 6173 736d    )..    @classm
-0001a9e0: 6574 686f 640a 2020 2020 6465 6620 5f76  ethod.    def _v
-0001a9f0: 616c 6964 6174 655f 6178 6973 2863 6c73  alidate_axis(cls
-0001aa00: 2c20 6178 6973 3d30 2c20 6e75 6d65 7269  , axis=0, numeri
-0001aa10: 635f 6178 6973 3a20 626f 6f6c 203d 2054  c_axis: bool = T
-0001aa20: 7275 6529 202d 3e20 4e6f 6e65 207c 204c  rue) -> None | L
-0001aa30: 6974 6572 616c 5b30 2c20 315d 3a0a 2020  iteral[0, 1]:.  
-0001aa40: 2020 2020 2020 6966 2061 7869 7320 6e6f        if axis no
-0001aa50: 7420 696e 2028 302c 2031 2c20 2269 6e64  t in (0, 1, "ind
-0001aa60: 6578 222c 2022 636f 6c75 6d6e 7322 2c20  ex", "columns", 
-0001aa70: 4e6f 6e65 293a 0a20 2020 2020 2020 2020  None):.         
-0001aa80: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-0001aa90: 726f 7228 6622 4e6f 2061 7869 7320 6e61  ror(f"No axis na
-0001aaa0: 6d65 6420 7b61 7869 737d 2229 0a20 2020  med {axis}").   
-0001aab0: 2020 2020 2069 6620 6e75 6d65 7269 635f       if numeric_
-0001aac0: 6178 6973 3a0a 2020 2020 2020 2020 2020  axis:.          
-0001aad0: 2020 6e75 6d5f 6178 6973 3a20 6469 6374    num_axis: dict
-0001aae0: 5b73 7472 207c 204e 6f6e 652c 204c 6974  [str | None, Lit
-0001aaf0: 6572 616c 5b30 2c20 315d 5d20 3d20 7b22  eral[0, 1]] = {"
-0001ab00: 696e 6465 7822 3a20 302c 2022 636f 6c75  index": 0, "colu
-0001ab10: 6d6e 7322 3a20 317d 0a20 2020 2020 2020  mns": 1}.       
-0001ab20: 2020 2020 2072 6574 7572 6e20 6e75 6d5f       return num_
-0001ab30: 6178 6973 2e67 6574 2861 7869 732c 2061  axis.get(axis, a
-0001ab40: 7869 7329 0a20 2020 2020 2020 2065 6c73  xis).        els
-0001ab50: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-0001ab60: 6574 7572 6e20 6178 6973 0a0a 2020 2020  eturn axis..    
-0001ab70: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
-0001ab80: 2e44 6174 6146 7261 6d65 2c20 7561 5f61  .DataFrame, ua_a
-0001ab90: 7267 733d 5b22 696e 6465 7822 5d29 0a20  rgs=["index"]). 
-0001aba0: 2020 2064 6566 2072 656e 616d 6528 7365     def rename(se
-0001abb0: 6c66 2c20 696e 6465 783d 4e6f 6e65 2c20  lf, index=None, 
-0001abc0: 636f 6c75 6d6e 733d 4e6f 6e65 293a 0a20  columns=None):. 
-0001abd0: 2020 2020 2020 2069 6620 696e 6465 7820         if index 
-0001abe0: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
-0001abf0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-0001ac00: 616c 7565 4572 726f 7228 2243 616e 6e6f  alueError("Canno
-0001ac10: 7420 7265 6e61 6d65 2069 6e64 6578 2e22  t rename index."
-0001ac20: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-0001ac30: 206e 6577 5f63 6f6c 6c65 6374 696f 6e28   new_collection(
-0001ac40: 6578 7072 2e52 656e 616d 6546 7261 6d65  expr.RenameFrame
-0001ac50: 2873 656c 662c 2063 6f6c 756d 6e73 3d63  (self, columns=c
-0001ac60: 6f6c 756d 6e73 2929 0a0a 2020 2020 4064  olumns))..    @d
-0001ac70: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
-0001ac80: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
-0001ac90: 6620 7371 7565 657a 6528 7365 6c66 2c20  f squeeze(self, 
-0001aca0: 6178 6973 3d4e 6f6e 6529 3a0a 2020 2020  axis=None):.    
-0001acb0: 2020 2020 6966 2061 7869 7320 696e 205b      if axis in [
-0001acc0: 4e6f 6e65 2c20 315d 3a0a 2020 2020 2020  None, 1]:.      
-0001acd0: 2020 2020 2020 6966 206c 656e 2873 656c        if len(sel
-0001ace0: 662e 636f 6c75 6d6e 7329 203d 3d20 313a  f.columns) == 1:
-0001acf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001ad00: 2072 6574 7572 6e20 7365 6c66 5b73 656c   return self[sel
-0001ad10: 662e 636f 6c75 6d6e 735b 305d 5d0a 2020  f.columns[0]].  
-0001ad20: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-0001ad30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ad40: 7265 7475 726e 2073 656c 660a 0a20 2020  return self..   
-0001ad50: 2020 2020 2065 6c69 6620 6178 6973 203d       elif axis =
-0001ad60: 3d20 303a 0a20 2020 2020 2020 2020 2020  = 0:.           
-0001ad70: 2072 6169 7365 204e 6f74 496d 706c 656d   raise NotImplem
-0001ad80: 656e 7465 6445 7272 6f72 280a 2020 2020  entedError(.    
-0001ad90: 2020 2020 2020 2020 2020 2020 6622 7b74              f"{t
-0001ada0: 7970 6528 7365 6c66 297d 2064 6f65 7320  ype(self)} does 
-0001adb0: 6e6f 7420 7375 7070 6f72 7420 7371 7565  not support sque
-0001adc0: 657a 6520 616c 6f6e 6720 6178 6973 2030  eze along axis 0
-0001add0: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
-0001ade0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-0001adf0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0001ae00: 2056 616c 7565 4572 726f 7228 6622 4e6f   ValueError(f"No
-0001ae10: 2061 7869 7320 7b61 7869 737d 2066 6f72   axis {axis} for
-0001ae20: 206f 626a 6563 7420 7479 7065 207b 7479   object type {ty
-0001ae30: 7065 2873 656c 6629 7d22 290a 0a20 2020  pe(self)}")..   
-0001ae40: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
-0001ae50: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
-0001ae60: 2064 6566 2065 7870 6c6f 6465 2873 656c   def explode(sel
-0001ae70: 662c 2063 6f6c 756d 6e29 3a0a 2020 2020  f, column):.    
-0001ae80: 2020 2020 636f 6c75 6d6e 203d 205f 636f      column = _co
-0001ae90: 6e76 6572 745f 746f 5f6c 6973 7428 636f  nvert_to_list(co
-0001aea0: 6c75 6d6e 290a 2020 2020 2020 2020 7265  lumn).        re
-0001aeb0: 7475 726e 206e 6577 5f63 6f6c 6c65 6374  turn new_collect
-0001aec0: 696f 6e28 6578 7072 2e45 7870 6c6f 6465  ion(expr.Explode
-0001aed0: 4672 616d 6528 7365 6c66 2c20 636f 6c75  Frame(self, colu
-0001aee0: 6d6e 3d63 6f6c 756d 6e29 290a 0a20 2020  mn=column))..   
-0001aef0: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
-0001af00: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
-0001af10: 2064 6566 2064 726f 7028 7365 6c66 2c20   def drop(self, 
-0001af20: 6c61 6265 6c73 3d4e 6f6e 652c 2061 7869  labels=None, axi
-0001af30: 733d 302c 2063 6f6c 756d 6e73 3d4e 6f6e  s=0, columns=Non
-0001af40: 652c 2065 7272 6f72 733d 2272 6169 7365  e, errors="raise
-0001af50: 2229 3a0a 2020 2020 2020 2020 6966 2063  "):.        if c
-0001af60: 6f6c 756d 6e73 2069 7320 4e6f 6e65 2061  olumns is None a
-0001af70: 6e64 206c 6162 656c 7320 6973 204e 6f6e  nd labels is Non
-0001af80: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-0001af90: 6169 7365 2054 7970 6545 7272 6f72 2822  aise TypeError("
-0001afa0: 6d75 7374 2065 6974 6865 7220 7370 6563  must either spec
-0001afb0: 6966 7920 2763 6f6c 756d 6e73 2720 6f72  ify 'columns' or
-0001afc0: 2027 6c61 6265 6c73 2722 290a 0a20 2020   'labels'")..   
-0001afd0: 2020 2020 2061 7869 7320 3d20 5f76 616c       axis = _val
-0001afe0: 6964 6174 655f 6178 6973 2861 7869 7329  idate_axis(axis)
-0001aff0: 0a0a 2020 2020 2020 2020 6966 2061 7869  ..        if axi
-0001b000: 7320 3d3d 2031 3a0a 2020 2020 2020 2020  s == 1:.        
-0001b010: 2020 2020 636f 6c75 6d6e 7320 3d20 6c61      columns = la
-0001b020: 6265 6c73 206f 7220 636f 6c75 6d6e 730a  bels or columns.
-0001b030: 2020 2020 2020 2020 656c 6966 2061 7869          elif axi
-0001b040: 7320 3d3d 2030 2061 6e64 2063 6f6c 756d  s == 0 and colum
-0001b050: 6e73 2069 7320 4e6f 6e65 3a0a 2020 2020  ns is None:.    
-0001b060: 2020 2020 2020 2020 7261 6973 6520 4e6f          raise No
-0001b070: 7449 6d70 6c65 6d65 6e74 6564 4572 726f  tImplementedErro
-0001b080: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
-0001b090: 2020 2022 4472 6f70 2063 7572 7265 6e74     "Drop current
-0001b0a0: 6c79 206f 6e6c 7920 776f 726b 7320 666f  ly only works fo
-0001b0b0: 7220 6178 6973 3d31 206f 7220 7768 656e  r axis=1 or when
-0001b0c0: 2063 6f6c 756d 6e73 2069 7320 6e6f 7420   columns is not 
-0001b0d0: 4e6f 6e65 220a 2020 2020 2020 2020 2020  None".          
-0001b0e0: 2020 290a 2020 2020 2020 2020 7265 7475    ).        retu
-0001b0f0: 726e 206e 6577 5f63 6f6c 6c65 6374 696f  rn new_collectio
-0001b100: 6e28 6578 7072 2e44 726f 7028 7365 6c66  n(expr.Drop(self
-0001b110: 2c20 636f 6c75 6d6e 733d 636f 6c75 6d6e  , columns=column
-0001b120: 732c 2065 7272 6f72 733d 6572 726f 7273  s, errors=errors
-0001b130: 2929 0a0a 2020 2020 6465 6620 746f 5f70  ))..    def to_p
-0001b140: 6172 7175 6574 2873 656c 662c 2070 6174  arquet(self, pat
-0001b150: 682c 202a 2a6b 7761 7267 7329 3a0a 2020  h, **kwargs):.  
-0001b160: 2020 2020 2020 6672 6f6d 2064 6173 6b5f        from dask_
-0001b170: 6578 7072 2e69 6f2e 7061 7271 7565 7420  expr.io.parquet 
-0001b180: 696d 706f 7274 2074 6f5f 7061 7271 7565  import to_parque
-0001b190: 740a 0a20 2020 2020 2020 2072 6574 7572  t..        retur
-0001b1a0: 6e20 746f 5f70 6172 7175 6574 2873 656c  n to_parquet(sel
-0001b1b0: 662c 2070 6174 682c 202a 2a6b 7761 7267  f, path, **kwarg
-0001b1c0: 7329 0a0a 2020 2020 4064 6572 6976 6564  s)..    @derived
-0001b1d0: 5f66 726f 6d28 7064 2e44 6174 6146 7261  _from(pd.DataFra
-0001b1e0: 6d65 290a 2020 2020 6465 6620 7365 6c65  me).    def sele
-0001b1f0: 6374 5f64 7479 7065 7328 7365 6c66 2c20  ct_dtypes(self, 
-0001b200: 696e 636c 7564 653d 4e6f 6e65 2c20 6578  include=None, ex
-0001b210: 636c 7564 653d 4e6f 6e65 293a 0a20 2020  clude=None):.   
-0001b220: 2020 2020 2063 6f6c 756d 6e73 203d 206c       columns = l
-0001b230: 6973 7428 0a20 2020 2020 2020 2020 2020  ist(.           
-0001b240: 2073 656c 662e 5f6d 6574 612e 7365 6c65   self._meta.sele
-0001b250: 6374 5f64 7479 7065 7328 696e 636c 7564  ct_dtypes(includ
-0001b260: 653d 696e 636c 7564 652c 2065 7863 6c75  e=include, exclu
-0001b270: 6465 3d65 7863 6c75 6465 292e 636f 6c75  de=exclude).colu
-0001b280: 6d6e 730a 2020 2020 2020 2020 290a 2020  mns.        ).  
-0001b290: 2020 2020 2020 7265 7475 726e 206e 6577        return new
-0001b2a0: 5f63 6f6c 6c65 6374 696f 6e28 7365 6c66  _collection(self
-0001b2b0: 2e65 7870 725b 636f 6c75 6d6e 735d 290a  .expr[columns]).
-0001b2c0: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
-0001b2d0: 6f6d 2870 642e 4461 7461 4672 616d 6529  om(pd.DataFrame)
-0001b2e0: 0a20 2020 2064 6566 2065 7661 6c28 7365  .    def eval(se
-0001b2f0: 6c66 2c20 6578 7072 2c20 2a2a 6b77 6172  lf, expr, **kwar
-0001b300: 6773 293a 0a20 2020 2020 2020 2069 6620  gs):.        if 
-0001b310: 2269 6e70 6c61 6365 2220 696e 206b 7761  "inplace" in kwa
-0001b320: 7267 733a 0a20 2020 2020 2020 2020 2020  rgs:.           
-0001b330: 2072 6169 7365 204e 6f74 496d 706c 656d   raise NotImplem
-0001b340: 656e 7465 6445 7272 6f72 2822 696e 706c  entedError("inpl
-0001b350: 6163 6520 6973 206e 6f74 2073 7570 706f  ace is not suppo
-0001b360: 7274 6564 2066 6f72 2065 7661 6c22 290a  rted for eval").
-0001b370: 2020 2020 2020 2020 7265 7475 726e 206e          return n
-0001b380: 6577 5f63 6f6c 6c65 6374 696f 6e28 4576  ew_collection(Ev
-0001b390: 616c 2873 656c 662c 205f 6578 7072 3d65  al(self, _expr=e
-0001b3a0: 7870 722c 2065 7870 725f 6b77 6172 6773  xpr, expr_kwargs
-0001b3b0: 3d6b 7761 7267 7329 290a 0a20 2020 2064  =kwargs))..    d
-0001b3c0: 6566 2073 6574 5f69 6e64 6578 280a 2020  ef set_index(.  
-0001b3d0: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-0001b3e0: 2020 2020 6f74 6865 722c 0a20 2020 2020      other,.     
-0001b3f0: 2020 2064 726f 703d 5472 7565 2c0a 2020     drop=True,.  
-0001b400: 2020 2020 2020 736f 7274 6564 3d46 616c        sorted=Fal
-0001b410: 7365 2c0a 2020 2020 2020 2020 6e70 6172  se,.        npar
-0001b420: 7469 7469 6f6e 733a 2069 6e74 207c 204e  titions: int | N
-0001b430: 6f6e 6520 3d20 4e6f 6e65 2c0a 2020 2020  one = None,.    
-0001b440: 2020 2020 6469 7669 7369 6f6e 733d 4e6f      divisions=No
-0001b450: 6e65 2c0a 2020 2020 2020 2020 736f 7274  ne,.        sort
-0001b460: 3a20 626f 6f6c 203d 2054 7275 652c 0a20  : bool = True,. 
-0001b470: 2020 2020 2020 2073 6875 6666 6c65 5f6d         shuffle_m
-0001b480: 6574 686f 643d 4e6f 6e65 2c0a 2020 2020  ethod=None,.    
-0001b490: 2020 2020 7570 7361 6d70 6c65 3a20 666c      upsample: fl
-0001b4a0: 6f61 7420 3d20 312e 302c 0a20 2020 2020  oat = 1.0,.     
-0001b4b0: 2020 2070 6172 7469 7469 6f6e 5f73 697a     partition_siz
-0001b4c0: 653a 2066 6c6f 6174 203d 2031 3238 6536  e: float = 128e6
-0001b4d0: 2c0a 2020 2020 2020 2020 6170 7065 6e64  ,.        append
-0001b4e0: 3a20 626f 6f6c 203d 2046 616c 7365 2c0a  : bool = False,.
-0001b4f0: 2020 2020 2020 2020 2a2a 6f70 7469 6f6e          **option
-0001b500: 732c 0a20 2020 2029 3a0a 2020 2020 2020  s,.    ):.      
-0001b510: 2020 2222 2253 6574 2074 6865 2044 6174    """Set the Dat
-0001b520: 6146 7261 6d65 2069 6e64 6578 2028 726f  aFrame index (ro
-0001b530: 7720 6c61 6265 6c73 2920 7573 696e 6720  w labels) using 
-0001b540: 616e 2065 7869 7374 696e 6720 636f 6c75  an existing colu
-0001b550: 6d6e 2e0a 0a20 2020 2020 2020 2049 6620  mn...        If 
-0001b560: 6060 736f 7274 3d46 616c 7365 6060 2c20  ``sort=False``, 
-0001b570: 7468 6973 2066 756e 6374 696f 6e20 6f70  this function op
-0001b580: 6572 6174 6573 2065 7861 6374 6c79 206c  erates exactly l
-0001b590: 696b 6520 6060 7061 6e64 6173 2e73 6574  ike ``pandas.set
-0001b5a0: 5f69 6e64 6578 6060 0a20 2020 2020 2020  _index``.       
-0001b5b0: 2061 6e64 2073 6574 7320 7468 6520 696e   and sets the in
-0001b5c0: 6465 7820 6f6e 2074 6865 2044 6174 6146  dex on the DataF
-0001b5d0: 7261 6d65 2e20 4966 2060 6073 6f72 743d  rame. If ``sort=
-0001b5e0: 5472 7565 6060 2028 6465 6661 756c 7429  True`` (default)
-0001b5f0: 2c0a 2020 2020 2020 2020 7468 6973 2066  ,.        this f
-0001b600: 756e 6374 696f 6e20 616c 736f 2073 6f72  unction also sor
-0001b610: 7473 2074 6865 2044 6174 6146 7261 6d65  ts the DataFrame
-0001b620: 2062 7920 7468 6520 6e65 7720 696e 6465   by the new inde
-0001b630: 782e 2054 6869 7320 6361 6e20 6861 7665  x. This can have
-0001b640: 2061 0a20 2020 2020 2020 2073 6967 6e69   a.        signi
-0001b650: 6669 6361 6e74 2069 6d70 6163 7420 6f6e  ficant impact on
-0001b660: 2070 6572 666f 726d 616e 6365 2c20 6265   performance, be
-0001b670: 6361 7573 6520 6a6f 696e 732c 2067 726f  cause joins, gro
-0001b680: 7570 6279 732c 206c 6f6f 6b75 7073 2c20  upbys, lookups, 
-0001b690: 6574 632e 0a20 2020 2020 2020 2061 7265  etc..        are
-0001b6a0: 2061 6c6c 206d 7563 6820 6661 7374 6572   all much faster
-0001b6b0: 206f 6e20 7468 6174 2063 6f6c 756d 6e2e   on that column.
-0001b6c0: 2048 6f77 6576 6572 2c20 7468 6973 2070   However, this p
-0001b6d0: 6572 666f 726d 616e 6365 2069 6e63 7265  erformance incre
-0001b6e0: 6173 650a 2020 2020 2020 2020 636f 6d65  ase.        come
-0001b6f0: 7320 7769 7468 2061 2063 6f73 742c 2073  s with a cost, s
-0001b700: 6f72 7469 6e67 2061 2070 6172 616c 6c65  orting a paralle
-0001b710: 6c20 6461 7461 7365 7420 7265 7175 6972  l dataset requir
-0001b720: 6573 2065 7870 656e 7369 7665 2073 6875  es expensive shu
-0001b730: 6666 6c65 732e 0a20 2020 2020 2020 204f  ffles..        O
-0001b740: 6674 656e 2077 6520 6060 7365 745f 696e  ften we ``set_in
-0001b750: 6465 7860 6020 6f6e 6365 2064 6972 6563  dex`` once direc
-0001b760: 746c 7920 6166 7465 7220 6461 7461 2069  tly after data i
-0001b770: 6e67 6573 7420 616e 6420 6669 6c74 6572  ngest and filter
-0001b780: 696e 6720 616e 640a 2020 2020 2020 2020  ing and.        
-0001b790: 7468 656e 2070 6572 666f 726d 206d 616e  then perform man
-0001b7a0: 7920 6368 6561 7020 636f 6d70 7574 6174  y cheap computat
-0001b7b0: 696f 6e73 206f 6666 206f 6620 7468 6520  ions off of the 
-0001b7c0: 736f 7274 6564 2064 6174 6173 6574 2e0a  sorted dataset..
-0001b7d0: 0a20 2020 2020 2020 2057 6974 6820 6060  .        With ``
-0001b7e0: 736f 7274 3d54 7275 6560 602c 2074 6869  sort=True``, thi
-0001b7f0: 7320 6675 6e63 7469 6f6e 2069 7320 6d75  s function is mu
-0001b800: 6368 206d 6f72 6520 6578 7065 6e73 6976  ch more expensiv
-0001b810: 652e 2055 6e64 6572 206e 6f72 6d61 6c0a  e. Under normal.
-0001b820: 2020 2020 2020 2020 6f70 6572 6174 696f          operatio
-0001b830: 6e20 7468 6973 2066 756e 6374 696f 6e20  n this function 
-0001b840: 646f 6573 2061 6e20 696e 6974 6961 6c20  does an initial 
-0001b850: 7061 7373 206f 7665 7220 7468 6520 696e  pass over the in
-0001b860: 6465 7820 636f 6c75 6d6e 2074 6f0a 2020  dex column to.  
-0001b870: 2020 2020 2020 636f 6d70 7574 6520 6170        compute ap
-0001b880: 7072 6f78 696d 6174 6520 7175 616e 7469  proximate quanti
-0001b890: 6c65 7320 746f 2073 6572 7665 2061 7320  les to serve as 
-0001b8a0: 6675 7475 7265 2064 6976 6973 696f 6e73  future divisions
-0001b8b0: 2e20 4974 2074 6865 6e20 7061 7373 6573  . It then passes
-0001b8c0: 0a20 2020 2020 2020 206f 7665 7220 7468  .        over th
-0001b8d0: 6520 6461 7461 2061 2073 6563 6f6e 6420  e data a second 
-0001b8e0: 7469 6d65 2c20 7370 6c69 7474 696e 6720  time, splitting 
-0001b8f0: 7570 2065 6163 6820 696e 7075 7420 7061  up each input pa
-0001b900: 7274 6974 696f 6e20 696e 746f 2073 6576  rtition into sev
-0001b910: 6572 616c 0a20 2020 2020 2020 2070 6965  eral.        pie
-0001b920: 6365 7320 616e 6420 7368 6172 696e 6720  ces and sharing 
-0001b930: 7468 6f73 6520 7069 6563 6573 2074 6f20  those pieces to 
-0001b940: 616c 6c20 6f66 2074 6865 206f 7574 7075  all of the outpu
-0001b950: 7420 7061 7274 6974 696f 6e73 206e 6f77  t partitions now
-0001b960: 2069 6e0a 2020 2020 2020 2020 736f 7274   in.        sort
-0001b970: 6564 206f 7264 6572 2e0a 0a20 2020 2020  ed order...     
-0001b980: 2020 2049 6e20 736f 6d65 2063 6173 6573     In some cases
-0001b990: 2077 6520 6361 6e20 616c 6c65 7669 6174   we can alleviat
-0001b9a0: 6520 7468 6f73 6520 636f 7374 732c 2066  e those costs, f
-0001b9b0: 6f72 2065 7861 6d70 6c65 2069 6620 796f  or example if yo
-0001b9c0: 7572 2064 6174 6173 6574 2069 730a 2020  ur dataset is.  
-0001b9d0: 2020 2020 2020 736f 7274 6564 2061 6c72        sorted alr
-0001b9e0: 6561 6479 2074 6865 6e20 7765 2063 616e  eady then we can
-0001b9f0: 2061 766f 6964 206d 616b 696e 6720 6d61   avoid making ma
-0001ba00: 6e79 2073 6d61 6c6c 2070 6965 6365 7320  ny small pieces 
-0001ba10: 6f72 2069 6620 796f 7520 6b6e 6f77 0a20  or if you know. 
-0001ba20: 2020 2020 2020 2067 6f6f 6420 7661 6c75         good valu
-0001ba30: 6573 2074 6f20 7370 6c69 7420 7468 6520  es to split the 
-0001ba40: 6e65 7720 696e 6465 7820 636f 6c75 6d6e  new index column
-0001ba50: 2074 6865 6e20 7765 2063 616e 2061 766f   then we can avo
-0001ba60: 6964 2074 6865 2069 6e69 7469 616c 0a20  id the initial. 
-0001ba70: 2020 2020 2020 2070 6173 7320 6f76 6572         pass over
-0001ba80: 2074 6865 2064 6174 612e 2046 6f72 2065   the data. For e
-0001ba90: 7861 6d70 6c65 2069 6620 796f 7572 206e  xample if your n
-0001baa0: 6577 2069 6e64 6578 2069 7320 6120 6461  ew index is a da
-0001bab0: 7465 7469 6d65 2069 6e64 6578 2061 6e64  tetime index and
-0001bac0: 0a20 2020 2020 2020 2079 6f75 7220 6461  .        your da
-0001bad0: 7461 2069 7320 616c 7265 6164 7920 736f  ta is already so
-0001bae0: 7274 6564 2062 7920 6461 7920 7468 656e  rted by day then
-0001baf0: 2074 6869 7320 656e 7469 7265 206f 7065   this entire ope
-0001bb00: 7261 7469 6f6e 2063 616e 2062 6520 646f  ration can be do
-0001bb10: 6e65 0a20 2020 2020 2020 2066 6f72 2066  ne.        for f
-0001bb20: 7265 652e 2059 6f75 2063 616e 2063 6f6e  ree. You can con
-0001bb30: 7472 6f6c 2074 6865 7365 206f 7074 696f  trol these optio
-0001bb40: 6e73 2077 6974 6820 7468 6520 666f 6c6c  ns with the foll
-0001bb50: 6f77 696e 6720 7061 7261 6d65 7465 7273  owing parameters
-0001bb60: 2e0a 0a20 2020 2020 2020 2050 6172 616d  ...        Param
-0001bb70: 6574 6572 730a 2020 2020 2020 2020 2d2d  eters.        --
-0001bb80: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-0001bb90: 206f 7468 6572 3a20 7374 7269 6e67 206f   other: string o
-0001bba0: 7220 4461 736b 2053 6572 6965 730a 2020  r Dask Series.  
-0001bbb0: 2020 2020 2020 2020 2020 436f 6c75 6d6e            Column
-0001bbc0: 2074 6f20 7573 6520 6173 2069 6e64 6578   to use as index
-0001bbd0: 2e0a 2020 2020 2020 2020 6472 6f70 3a20  ..        drop: 
-0001bbe0: 626f 6f6c 6561 6e2c 2064 6566 6175 6c74  boolean, default
-0001bbf0: 2054 7275 650a 2020 2020 2020 2020 2020   True.          
-0001bc00: 2020 4465 6c65 7465 2063 6f6c 756d 6e20    Delete column 
-0001bc10: 746f 2062 6520 7573 6564 2061 7320 7468  to be used as th
-0001bc20: 6520 6e65 7720 696e 6465 782e 0a20 2020  e new index..   
-0001bc30: 2020 2020 2073 6f72 7465 643a 2062 6f6f       sorted: boo
-0001bc40: 6c2c 206f 7074 696f 6e61 6c0a 2020 2020  l, optional.    
-0001bc50: 2020 2020 2020 2020 4966 2074 6865 2069          If the i
-0001bc60: 6e64 6578 2063 6f6c 756d 6e20 6973 2061  ndex column is a
-0001bc70: 6c72 6561 6479 2073 6f72 7465 6420 696e  lready sorted in
-0001bc80: 2069 6e63 7265 6173 696e 6720 6f72 6465   increasing orde
-0001bc90: 722e 0a20 2020 2020 2020 2020 2020 2044  r..            D
-0001bca0: 6566 6175 6c74 7320 746f 2046 616c 7365  efaults to False
-0001bcb0: 0a20 2020 2020 2020 206e 7061 7274 6974  .        npartit
-0001bcc0: 696f 6e73 3a20 696e 742c 204e 6f6e 652c  ions: int, None,
-0001bcd0: 206f 7220 2761 7574 6f27 0a20 2020 2020   or 'auto'.     
-0001bce0: 2020 2020 2020 2054 6865 2069 6465 616c         The ideal
-0001bcf0: 206e 756d 6265 7220 6f66 206f 7574 7075   number of outpu
-0001bd00: 7420 7061 7274 6974 696f 6e73 2e20 4966  t partitions. If
-0001bd10: 204e 6f6e 652c 2075 7365 2074 6865 2073   None, use the s
-0001bd20: 616d 6520 6173 0a20 2020 2020 2020 2020  ame as.         
-0001bd30: 2020 2074 6865 2069 6e70 7574 2e20 4966     the input. If
-0001bd40: 2027 6175 746f 2720 7468 656e 2064 6563   'auto' then dec
-0001bd50: 6964 6520 6279 206d 656d 6f72 7920 7573  ide by memory us
-0001bd60: 652e 0a20 2020 2020 2020 2020 2020 204f  e..            O
-0001bd70: 6e6c 7920 7573 6564 2077 6865 6e20 6060  nly used when ``
-0001bd80: 6469 7669 7369 6f6e 7360 6020 6973 206e  divisions`` is n
-0001bd90: 6f74 2067 6976 656e 2e20 4966 2060 6064  ot given. If ``d
-0001bda0: 6976 6973 696f 6e73 6060 2069 7320 6769  ivisions`` is gi
-0001bdb0: 7665 6e2c 0a20 2020 2020 2020 2020 2020  ven,.           
-0001bdc0: 2074 6865 206e 756d 6265 7220 6f66 206f   the number of o
-0001bdd0: 7574 7075 7420 7061 7274 6974 696f 6e73  utput partitions
-0001bde0: 2077 696c 6c20 6265 2060 606c 656e 2864   will be ``len(d
-0001bdf0: 6976 6973 696f 6e73 2920 2d20 3160 602e  ivisions) - 1``.
-0001be00: 0a20 2020 2020 2020 2064 6976 6973 696f  .        divisio
-0001be10: 6e73 3a20 6c69 7374 2c20 6f70 7469 6f6e  ns: list, option
-0001be20: 616c 0a20 2020 2020 2020 2020 2020 2054  al.            T
-0001be30: 6865 2022 6469 7669 6469 6e67 206c 696e  he "dividing lin
-0001be40: 6573 2220 7573 6564 2074 6f20 7370 6c69  es" used to spli
-0001be50: 7420 7468 6520 6e65 7720 696e 6465 7820  t the new index 
-0001be60: 696e 746f 2070 6172 7469 7469 6f6e 732e  into partitions.
-0001be70: 0a20 2020 2020 2020 2020 2020 2046 6f72  .            For
-0001be80: 2060 6064 6976 6973 696f 6e73 3d5b 302c   ``divisions=[0,
-0001be90: 2031 302c 2035 302c 2031 3030 5d60 602c   10, 50, 100]``,
-0001bea0: 2074 6865 7265 2077 6f75 6c64 2062 6520   there would be 
-0001beb0: 7468 7265 6520 6f75 7470 7574 2070 6172  three output par
-0001bec0: 7469 7469 6f6e 732c 0a20 2020 2020 2020  titions,.       
-0001bed0: 2020 2020 2077 6865 7265 2074 6865 206e       where the n
-0001bee0: 6577 2069 6e64 6578 2063 6f6e 7461 696e  ew index contain
-0001bef0: 6564 205b 302c 2031 3029 2c20 5b31 302c  ed [0, 10), [10,
-0001bf00: 2035 3029 2c20 616e 6420 5b35 302c 2031   50), and [50, 1
-0001bf10: 3030 292c 2072 6573 7065 6374 6976 656c  00), respectivel
-0001bf20: 792e 0a20 2020 2020 2020 2020 2020 2053  y..            S
-0001bf30: 6565 2068 7474 7073 3a2f 2f64 6f63 732e  ee https://docs.
-0001bf40: 6461 736b 2e6f 7267 2f65 6e2f 6c61 7465  dask.org/en/late
-0001bf50: 7374 2f64 6174 6166 7261 6d65 2d64 6573  st/dataframe-des
-0001bf60: 6967 6e2e 6874 6d6c 2370 6172 7469 7469  ign.html#partiti
-0001bf70: 6f6e 732e 0a20 2020 2020 2020 2020 2020  ons..           
-0001bf80: 2049 6620 6e6f 7420 6769 7665 6e20 2864   If not given (d
-0001bf90: 6566 6175 6c74 292c 2067 6f6f 6420 6469  efault), good di
-0001bfa0: 7669 7369 6f6e 7320 6172 6520 6361 6c63  visions are calc
-0001bfb0: 756c 6174 6564 2062 7920 696d 6d65 6469  ulated by immedi
-0001bfc0: 6174 656c 7920 636f 6d70 7574 696e 670a  ately computing.
-0001bfd0: 2020 2020 2020 2020 2020 2020 7468 6520              the 
-0001bfe0: 6461 7461 2061 6e64 206c 6f6f 6b69 6e67  data and looking
-0001bff0: 2061 7420 7468 6520 6469 7374 7269 6275   at the distribu
-0001c000: 7469 6f6e 206f 6620 6974 7320 7661 6c75  tion of its valu
-0001c010: 6573 2e20 466f 7220 6c61 7267 6520 6461  es. For large da
-0001c020: 7461 7365 7473 2c0a 2020 2020 2020 2020  tasets,.        
-0001c030: 2020 2020 7468 6973 2063 616e 2062 6520      this can be 
-0001c040: 6578 7065 6e73 6976 652e 0a20 2020 2020  expensive..     
-0001c050: 2020 2020 2020 204e 6f74 6520 7468 6174         Note that
-0001c060: 2069 6620 6060 736f 7274 6564 3d54 7275   if ``sorted=Tru
-0001c070: 6560 602c 2073 7065 6369 6669 6564 2064  e``, specified d
-0001c080: 6976 6973 696f 6e73 2061 7265 2061 7373  ivisions are ass
-0001c090: 756d 6564 2074 6f20 6d61 7463 680a 2020  umed to match.  
-0001c0a0: 2020 2020 2020 2020 2020 7468 6520 6578            the ex
-0001c0b0: 6973 7469 6e67 2070 6172 7469 7469 6f6e  isting partition
-0001c0c0: 7320 696e 2074 6865 2064 6174 613b 2069  s in the data; i
-0001c0d0: 6620 7468 6973 2069 7320 756e 7472 7565  f this is untrue
-0001c0e0: 2079 6f75 2073 686f 756c 640a 2020 2020   you should.    
-0001c0f0: 2020 2020 2020 2020 6c65 6176 6520 6469          leave di
-0001c100: 7669 7369 6f6e 7320 656d 7074 7920 616e  visions empty an
-0001c110: 6420 6361 6c6c 2060 6072 6570 6172 7469  d call ``reparti
-0001c120: 7469 6f6e 6060 2061 6674 6572 2060 6073  tion`` after ``s
-0001c130: 6574 5f69 6e64 6578 6060 2e0a 2020 2020  et_index``..    
-0001c140: 2020 2020 696e 706c 6163 653a 2062 6f6f      inplace: boo
-0001c150: 6c2c 206f 7074 696f 6e61 6c0a 2020 2020  l, optional.    
-0001c160: 2020 2020 2020 2020 4d6f 6469 6679 696e          Modifyin
-0001c170: 6720 7468 6520 4461 7461 4672 616d 6520  g the DataFrame 
-0001c180: 696e 2070 6c61 6365 2069 7320 6e6f 7420  in place is not 
-0001c190: 7375 7070 6f72 7465 6420 6279 2044 6173  supported by Das
-0001c1a0: 6b2e 0a20 2020 2020 2020 2020 2020 2044  k..            D
-0001c1b0: 6566 6175 6c74 7320 746f 2046 616c 7365  efaults to False
-0001c1c0: 2e0a 2020 2020 2020 2020 736f 7274 3a20  ..        sort: 
-0001c1d0: 626f 6f6c 2c20 6f70 7469 6f6e 616c 0a20  bool, optional. 
-0001c1e0: 2020 2020 2020 2020 2020 2049 6620 6060             If ``
-0001c1f0: 5472 7565 6060 2c20 736f 7274 2074 6865  True``, sort the
-0001c200: 2044 6174 6146 7261 6d65 2062 7920 7468   DataFrame by th
-0001c210: 6520 6e65 7720 696e 6465 782e 204f 7468  e new index. Oth
-0001c220: 6572 7769 7365 0a20 2020 2020 2020 2020  erwise.         
-0001c230: 2020 2073 6574 2074 6865 2069 6e64 6578     set the index
-0001c240: 206f 6e20 7468 6520 696e 6469 7669 6475   on the individu
-0001c250: 616c 2065 7869 7374 696e 6720 7061 7274  al existing part
-0001c260: 6974 696f 6e73 2e0a 2020 2020 2020 2020  itions..        
-0001c270: 2020 2020 4465 6661 756c 7473 2074 6f20      Defaults to 
-0001c280: 6060 5472 7565 6060 2e0a 2020 2020 2020  ``True``..      
-0001c290: 2020 7368 7566 666c 655f 6d65 7468 6f64    shuffle_method
-0001c2a0: 3a20 7b27 6469 736b 272c 2027 7461 736b  : {'disk', 'task
-0001c2b0: 7327 2c20 2770 3270 277d 2c20 6f70 7469  s', 'p2p'}, opti
-0001c2c0: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
-0001c2d0: 2045 6974 6865 7220 6060 2764 6973 6b27   Either ``'disk'
-0001c2e0: 6060 2066 6f72 2073 696e 676c 652d 6e6f  `` for single-no
-0001c2f0: 6465 206f 7065 7261 7469 6f6e 206f 7220  de operation or 
-0001c300: 6060 2774 6173 6b73 2760 6020 616e 640a  ``'tasks'`` and.
-0001c310: 2020 2020 2020 2020 2020 2020 6060 2770              ``'p
-0001c320: 3270 2760 6020 666f 7220 6469 7374 7269  2p'`` for distri
-0001c330: 6275 7465 6420 6f70 6572 6174 696f 6e2e  buted operation.
-0001c340: 2020 5769 6c6c 2062 6520 696e 6665 7272    Will be inferr
-0001c350: 6564 2062 7920 796f 7572 0a20 2020 2020  ed by your.     
-0001c360: 2020 2020 2020 2063 7572 7265 6e74 2073         current s
-0001c370: 6368 6564 756c 6572 2e0a 2020 2020 2020  cheduler..      
-0001c380: 2020 636f 6d70 7574 653a 2062 6f6f 6c2c    compute: bool,
-0001c390: 2064 6566 6175 6c74 2046 616c 7365 0a20   default False. 
-0001c3a0: 2020 2020 2020 2020 2020 2057 6865 7468             Wheth
-0001c3b0: 6572 206f 7220 6e6f 7420 746f 2074 7269  er or not to tri
-0001c3c0: 6767 6572 2061 6e20 696d 6d65 6469 6174  gger an immediat
-0001c3d0: 6520 636f 6d70 7574 6174 696f 6e2e 2044  e computation. D
-0001c3e0: 6566 6175 6c74 7320 746f 2046 616c 7365  efaults to False
-0001c3f0: 2e0a 2020 2020 2020 2020 2020 2020 4e6f  ..            No
-0001c400: 7465 2c20 7468 6174 2065 7665 6e20 6966  te, that even if
-0001c410: 2079 6f75 2073 6574 2060 6063 6f6d 7075   you set ``compu
-0001c420: 7465 3d46 616c 7365 6060 2c20 616e 2069  te=False``, an i
-0001c430: 6d6d 6564 6961 7465 2063 6f6d 7075 7461  mmediate computa
-0001c440: 7469 6f6e 0a20 2020 2020 2020 2020 2020  tion.           
-0001c450: 2077 696c 6c20 7374 696c 6c20 6265 2074   will still be t
-0001c460: 7269 6767 6572 6564 2069 6620 6060 6469  riggered if ``di
-0001c470: 7669 7369 6f6e 7360 6020 6973 2060 604e  visions`` is ``N
-0001c480: 6f6e 6560 602e 0a20 2020 2020 2020 2070  one``..        p
-0001c490: 6172 7469 7469 6f6e 5f73 697a 653a 2069  artition_size: i
-0001c4a0: 6e74 2c20 6f70 7469 6f6e 616c 0a20 2020  nt, optional.   
-0001c4b0: 2020 2020 2020 2020 2044 6573 6972 6564           Desired
-0001c4c0: 2073 697a 6520 6f66 2065 6163 6820 7061   size of each pa
-0001c4d0: 7274 6974 696f 6e73 2069 6e20 6279 7465  rtitions in byte
-0001c4e0: 732e 0a20 2020 2020 2020 2020 2020 204f  s..            O
-0001c4f0: 6e6c 7920 7573 6564 2077 6865 6e20 6060  nly used when ``
-0001c500: 6e70 6172 7469 7469 6f6e 733d 2761 7574  npartitions='aut
-0001c510: 6f27 6060 0a0a 2020 2020 2020 2020 4578  o'``..        Ex
-0001c520: 616d 706c 6573 0a20 2020 2020 2020 202d  amples.        -
-0001c530: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-0001c540: 3e3e 3e20 696d 706f 7274 2064 6173 6b0a  >>> import dask.
-0001c550: 2020 2020 2020 2020 3e3e 3e20 6464 6620          >>> ddf 
-0001c560: 3d20 6461 736b 2e64 6174 6173 6574 732e  = dask.datasets.
-0001c570: 7469 6d65 7365 7269 6573 2873 7461 7274  timeseries(start
-0001c580: 3d22 3230 3231 2d30 312d 3031 222c 2065  ="2021-01-01", e
-0001c590: 6e64 3d22 3230 3231 2d30 312d 3037 222c  nd="2021-01-07",
-0001c5a0: 2066 7265 713d 2231 6822 292e 7265 7365   freq="1h").rese
-0001c5b0: 745f 696e 6465 7828 290a 2020 2020 2020  t_index().      
-0001c5c0: 2020 3e3e 3e20 6464 6632 203d 2064 6466    >>> ddf2 = ddf
-0001c5d0: 2e73 6574 5f69 6e64 6578 2822 7822 290a  .set_index("x").
-0001c5e0: 2020 2020 2020 2020 3e3e 3e20 6464 6632          >>> ddf2
-0001c5f0: 203d 2064 6466 2e73 6574 5f69 6e64 6578   = ddf.set_index
-0001c600: 2864 6466 2e78 290a 2020 2020 2020 2020  (ddf.x).        
-0001c610: 3e3e 3e20 6464 6632 203d 2064 6466 2e73  >>> ddf2 = ddf.s
-0001c620: 6574 5f69 6e64 6578 2864 6466 2e74 696d  et_index(ddf.tim
-0001c630: 6573 7461 6d70 2c20 736f 7274 6564 3d54  estamp, sorted=T
-0001c640: 7275 6529 0a0a 2020 2020 2020 2020 4120  rue)..        A 
-0001c650: 636f 6d6d 6f6e 2063 6173 6520 6973 2077  common case is w
-0001c660: 6865 6e20 7765 2068 6176 6520 6120 6461  hen we have a da
-0001c670: 7465 7469 6d65 2063 6f6c 756d 6e20 7468  tetime column th
-0001c680: 6174 2077 6520 6b6e 6f77 2074 6f20 6265  at we know to be
-0001c690: 0a20 2020 2020 2020 2073 6f72 7465 6420  .        sorted 
-0001c6a0: 616e 6420 6973 2063 6c65 616e 6c79 2064  and is cleanly d
-0001c6b0: 6976 6964 6564 2062 7920 6461 792e 2020  ivided by day.  
-0001c6c0: 5765 2063 616e 2073 6574 2074 6869 7320  We can set this 
-0001c6d0: 696e 6465 7820 666f 7220 6672 6565 0a20  index for free. 
-0001c6e0: 2020 2020 2020 2062 7920 7370 6563 6966         by specif
-0001c6f0: 7969 6e67 2062 6f74 6820 7468 6174 2074  ying both that t
-0001c700: 6865 2063 6f6c 756d 6e20 6973 2070 7265  he column is pre
-0001c710: 2d73 6f72 7465 6420 616e 6420 7468 6520  -sorted and the 
-0001c720: 7061 7274 6963 756c 6172 0a20 2020 2020  particular.     
-0001c730: 2020 2064 6976 6973 696f 6e73 2061 6c6f     divisions alo
-0001c740: 6e67 2077 6869 6368 2069 7320 6973 2073  ng which is is s
-0001c750: 6570 6172 6174 6564 0a0a 2020 2020 2020  eparated..      
-0001c760: 2020 3e3e 3e20 696d 706f 7274 2070 616e    >>> import pan
-0001c770: 6461 7320 6173 2070 640a 2020 2020 2020  das as pd.      
-0001c780: 2020 3e3e 3e20 6469 7669 7369 6f6e 7320    >>> divisions 
-0001c790: 3d20 7064 2e64 6174 655f 7261 6e67 6528  = pd.date_range(
-0001c7a0: 7374 6172 743d 2232 3032 312d 3031 2d30  start="2021-01-0
-0001c7b0: 3122 2c20 656e 643d 2232 3032 312d 3031  1", end="2021-01
-0001c7c0: 2d30 3722 2c20 6672 6571 3d27 3144 2729  -07", freq='1D')
-0001c7d0: 0a20 2020 2020 2020 203e 3e3e 2064 6976  .        >>> div
-0001c7e0: 6973 696f 6e73 0a20 2020 2020 2020 2044  isions.        D
-0001c7f0: 6174 6574 696d 6549 6e64 6578 285b 2732  atetimeIndex(['2
-0001c800: 3032 312d 3031 2d30 3127 2c20 2732 3032  021-01-01', '202
-0001c810: 312d 3031 2d30 3227 2c20 2732 3032 312d  1-01-02', '2021-
-0001c820: 3031 2d30 3327 2c20 2732 3032 312d 3031  01-03', '2021-01
-0001c830: 2d30 3427 2c0a 2020 2020 2020 2020 2020  -04',.          
-0001c840: 2020 2020 2020 2020 2020 2020 2027 3230               '20
-0001c850: 3231 2d30 312d 3035 272c 2027 3230 3231  21-01-05', '2021
-0001c860: 2d30 312d 3036 272c 2027 3230 3231 2d30  -01-06', '2021-0
-0001c870: 312d 3037 275d 2c0a 2020 2020 2020 2020  1-07'],.        
-0001c880: 2020 2020 2020 2020 2020 2020 2020 6474                dt
-0001c890: 7970 653d 2764 6174 6574 696d 6536 345b  ype='datetime64[
-0001c8a0: 6e73 5d27 2c20 6672 6571 3d27 4427 290a  ns]', freq='D').
-0001c8b0: 0a20 2020 2020 2020 204e 6f74 6520 7468  .        Note th
-0001c8c0: 6174 2060 606c 656e 2864 6976 6973 6f6e  at ``len(divison
-0001c8d0: 7329 6060 2069 7320 6571 7561 6c20 746f  s)`` is equal to
-0001c8e0: 2060 606e 7061 7274 6974 696f 6e73 202b   ``npartitions +
-0001c8f0: 2031 6060 2e20 5468 6973 2069 7320 6265   1``. This is be
-0001c900: 6361 7573 6520 6060 6469 7669 7369 6f6e  cause ``division
-0001c910: 7360 600a 2020 2020 2020 2020 7265 7072  s``.        repr
-0001c920: 6573 656e 7473 2074 6865 2075 7070 6572  esents the upper
-0001c930: 2061 6e64 206c 6f77 6572 2062 6f75 6e64   and lower bound
-0001c940: 7320 6f66 2065 6163 6820 7061 7274 6974  s of each partit
-0001c950: 696f 6e2e 2054 6865 2066 6972 7374 2069  ion. The first i
-0001c960: 7465 6d20 6973 2074 6865 0a20 2020 2020  tem is the.     
-0001c970: 2020 206c 6f77 6572 2062 6f75 6e64 206f     lower bound o
-0001c980: 6620 7468 6520 6669 7273 7420 7061 7274  f the first part
-0001c990: 6974 696f 6e2c 2074 6865 2073 6563 6f6e  ition, the secon
-0001c9a0: 6420 6974 656d 2069 7320 7468 6520 6c6f  d item is the lo
-0001c9b0: 7765 7220 626f 756e 6420 6f66 2074 6865  wer bound of the
-0001c9c0: 0a20 2020 2020 2020 2073 6563 6f6e 6420  .        second 
-0001c9d0: 7061 7274 6974 696f 6e20 616e 6420 7468  partition and th
-0001c9e0: 6520 7570 7065 7220 626f 756e 6420 6f66  e upper bound of
-0001c9f0: 2074 6865 2066 6972 7374 2070 6172 7469   the first parti
-0001ca00: 7469 6f6e 2c20 616e 6420 736f 206f 6e2e  tion, and so on.
-0001ca10: 0a20 2020 2020 2020 2054 6865 2073 6563  .        The sec
-0001ca20: 6f6e 642d 746f 2d6c 6173 7420 6974 656d  ond-to-last item
-0001ca30: 2069 7320 7468 6520 6c6f 7765 7220 626f   is the lower bo
-0001ca40: 756e 6420 6f66 2074 6865 206c 6173 7420  und of the last 
-0001ca50: 7061 7274 6974 696f 6e2c 2061 6e64 2074  partition, and t
-0001ca60: 6865 206c 6173 740a 2020 2020 2020 2020  he last.        
-0001ca70: 2865 7874 7261 2920 6974 656d 2069 7320  (extra) item is 
-0001ca80: 7468 6520 7570 7065 7220 626f 756e 6420  the upper bound 
-0001ca90: 6f66 2074 6865 206c 6173 7420 7061 7274  of the last part
-0001caa0: 6974 696f 6e2e 0a0a 2020 2020 2020 2020  ition...        
-0001cab0: 3e3e 3e20 6464 6632 203d 2064 6466 2e73  >>> ddf2 = ddf.s
-0001cac0: 6574 5f69 6e64 6578 2822 7469 6d65 7374  et_index("timest
-0001cad0: 616d 7022 2c20 736f 7274 6564 3d54 7275  amp", sorted=Tru
-0001cae0: 652c 2064 6976 6973 696f 6e73 3d64 6976  e, divisions=div
-0001caf0: 6973 696f 6e73 2e74 6f6c 6973 7428 2929  isions.tolist())
-0001cb00: 0a0a 2020 2020 2020 2020 4966 2079 6f75  ..        If you
-0001cb10: 276c 6c20 6265 2072 756e 6e69 6e67 2060  'll be running `
-0001cb20: 7365 745f 696e 6465 7860 206f 6e20 7468  set_index` on th
-0001cb30: 6520 7361 6d65 2028 6f72 2073 696d 696c  e same (or simil
-0001cb40: 6172 2920 6461 7461 7365 7473 2072 6570  ar) datasets rep
-0001cb50: 6561 7465 646c 792c 0a20 2020 2020 2020  eatedly,.       
-0001cb60: 2079 6f75 2063 6f75 6c64 2073 6176 6520   you could save 
-0001cb70: 7469 6d65 2062 7920 6c65 7474 696e 6720  time by letting 
-0001cb80: 4461 736b 2063 616c 6375 6c61 7465 2067  Dask calculate g
-0001cb90: 6f6f 6420 6469 7669 7369 6f6e 7320 6f6e  ood divisions on
-0001cba0: 6365 2c20 7468 656e 2063 6f70 792d 7061  ce, then copy-pa
-0001cbb0: 7374 696e 670a 2020 2020 2020 2020 7468  sting.        th
-0001cbc0: 656d 2074 6f20 7265 7573 652e 2054 6869  em to reuse. Thi
-0001cbd0: 7320 6973 2065 7370 6563 6961 6c6c 7920  s is especially 
-0001cbe0: 6865 6c70 6675 6c20 7275 6e6e 696e 6720  helpful running 
-0001cbf0: 696e 2061 204a 7570 7974 6572 206e 6f74  in a Jupyter not
-0001cc00: 6562 6f6f 6b3a 0a0a 2020 2020 2020 2020  ebook:..        
-0001cc10: 3e3e 3e20 6464 6632 203d 2064 6466 2e73  >>> ddf2 = ddf.s
-0001cc20: 6574 5f69 6e64 6578 2822 6e61 6d65 2229  et_index("name")
-0001cc30: 2020 2320 736c 6f77 2c20 6361 6c63 756c    # slow, calcul
-0001cc40: 6174 6573 2064 6174 6120 6469 7374 7269  ates data distri
-0001cc50: 6275 7469 6f6e 0a20 2020 2020 2020 203e  bution.        >
-0001cc60: 3e3e 2064 6466 322e 6469 7669 7369 6f6e  >> ddf2.division
-0001cc70: 7320 2023 2064 6f63 7465 7374 3a20 2b53  s  # doctest: +S
-0001cc80: 4b49 500a 2020 2020 2020 2020 5b22 416c  KIP.        ["Al
-0001cc90: 6963 6522 2c20 224c 6175 7261 222c 2022  ice", "Laura", "
-0001cca0: 5572 7375 6c61 222c 2022 5a65 6c64 6122  Ursula", "Zelda"
-0001ccb0: 5d0a 2020 2020 2020 2020 3e3e 3e20 2320  ].        >>> # 
-0001ccc0: 5e20 4e6f 7720 636f 7079 2d70 6173 7465  ^ Now copy-paste
-0001ccd0: 2074 6869 7320 616e 6420 6564 6974 2074   this and edit t
-0001cce0: 6865 206c 696e 6520 6162 6f76 6520 746f  he line above to
-0001ccf0: 3a0a 2020 2020 2020 2020 3e3e 3e20 2320  :.        >>> # 
-0001cd00: 6464 6632 203d 2064 6466 2e73 6574 5f69  ddf2 = ddf.set_i
-0001cd10: 6e64 6578 2822 6e61 6d65 222c 2064 6976  ndex("name", div
-0001cd20: 6973 696f 6e73 3d5b 2241 6c69 6365 222c  isions=["Alice",
-0001cd30: 2022 4c61 7572 6122 2c20 2255 7273 756c   "Laura", "Ursul
-0001cd40: 6122 2c20 225a 656c 6461 225d 290a 2020  a", "Zelda"]).  
-0001cd50: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0001cd60: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-0001cd70: 6f74 6865 722c 206c 6973 7429 2061 6e64  other, list) and
-0001cd80: 206c 656e 286f 7468 6572 2920 3d3d 2031   len(other) == 1
-0001cd90: 3a0a 2020 2020 2020 2020 2020 2020 6f74  :.            ot
-0001cda0: 6865 7220 3d20 6f74 6865 725b 305d 0a20  her = other[0]. 
-0001cdb0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-0001cdc0: 616e 6365 286f 7468 6572 2c20 6c69 7374  ance(other, list
-0001cdd0: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
-0001cde0: 6620 616e 7928 5b69 7369 6e73 7461 6e63  f any([isinstanc
-0001cdf0: 6528 632c 2046 7261 6d65 4261 7365 2920  e(c, FrameBase) 
-0001ce00: 666f 7220 6320 696e 206f 7468 6572 5d29  for c in other])
-0001ce10: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001ce20: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
-0001ce30: 7228 224c 6973 745b 4672 616d 6542 6173  r("List[FrameBas
-0001ce40: 655d 206e 6f74 2073 7570 706f 7274 6564  e] not supported
-0001ce50: 2062 7920 7365 745f 696e 6465 7822 290a   by set_index").
-0001ce60: 2020 2020 2020 2020 2020 2020 656c 7365              else
-0001ce70: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001ce80: 2020 7261 6973 6520 4e6f 7449 6d70 6c65    raise NotImple
-0001ce90: 6d65 6e74 6564 4572 726f 7228 0a20 2020  mentedError(.   
-0001cea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ceb0: 2022 4461 736b 2064 6174 6166 7261 6d65   "Dask dataframe
-0001cec0: 2064 6f65 7320 6e6f 7420 7965 7420 7375   does not yet su
-0001ced0: 7070 6f72 7420 6d75 6c74 692d 696e 6465  pport multi-inde
-0001cee0: 7865 732e 5c6e 220a 2020 2020 2020 2020  xes.\n".        
-0001cef0: 2020 2020 2020 2020 2020 2020 6622 596f              f"Yo
-0001cf00: 7520 7472 6965 6420 746f 2069 6e64 6578  u tried to index
-0001cf10: 2077 6974 6820 7468 6973 2069 6e64 6578   with this index
-0001cf20: 3a20 7b6f 7468 6572 7d5c 6e22 0a20 2020  : {other}\n".   
-0001cf30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cf40: 2022 496e 6465 7865 7320 6d75 7374 2062   "Indexes must b
-0001cf50: 6520 7369 6e67 6c65 2063 6f6c 756d 6e73  e single columns
-0001cf60: 206f 6e6c 792e 220a 2020 2020 2020 2020   only.".        
-0001cf70: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0001cf80: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-0001cf90: 6f74 6865 722c 2044 6174 6146 7261 6d65  other, DataFrame
-0001cfa0: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
-0001cfb0: 6169 7365 204e 6f74 496d 706c 656d 656e  aise NotImplemen
-0001cfc0: 7465 6445 7272 6f72 280a 2020 2020 2020  tedError(.      
-0001cfd0: 2020 2020 2020 2020 2020 2244 6173 6b20            "Dask 
-0001cfe0: 6461 7461 6672 616d 6520 646f 6573 206e  dataframe does n
-0001cff0: 6f74 2079 6574 2073 7570 706f 7274 206d  ot yet support m
-0001d000: 756c 7469 2d69 6e64 6578 6573 2e5c 6e22  ulti-indexes.\n"
-0001d010: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001d020: 2066 2259 6f75 2074 7269 6564 2074 6f20   f"You tried to 
-0001d030: 696e 6465 7820 7769 7468 2061 2066 7261  index with a fra
-0001d040: 6d65 2077 6974 6820 7468 6573 6520 636f  me with these co
-0001d050: 6c75 6d6e 733a 207b 6c69 7374 286f 7468  lumns: {list(oth
-0001d060: 6572 2e63 6f6c 756d 6e73 297d 5c6e 220a  er.columns)}\n".
-0001d070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d080: 2249 6e64 6578 6573 206d 7573 7420 6265  "Indexes must be
-0001d090: 2073 696e 676c 6520 636f 6c75 6d6e 7320   single columns 
-0001d0a0: 6f6e 6c79 2e22 0a20 2020 2020 2020 2020  only.".         
-0001d0b0: 2020 2029 0a20 2020 2020 2020 2069 6620     ).        if 
-0001d0c0: 6973 696e 7374 616e 6365 286f 7468 6572  isinstance(other
-0001d0d0: 2c20 5365 7269 6573 293a 0a20 2020 2020  , Series):.     
-0001d0e0: 2020 2020 2020 2069 6620 6f74 6865 722e         if other.
-0001d0f0: 5f6e 616d 6520 3d3d 2073 656c 662e 696e  _name == self.in
-0001d100: 6465 782e 5f6e 616d 653a 0a20 2020 2020  dex._name:.     
-0001d110: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0001d120: 6e20 7365 6c66 0a20 2020 2020 2020 2065  n self.        e
-0001d130: 6c69 6620 6f74 6865 7220 3d3d 2073 656c  lif other == sel
-0001d140: 662e 696e 6465 782e 6e61 6d65 3a0a 2020  f.index.name:.  
-0001d150: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0001d160: 2073 656c 660a 0a20 2020 2020 2020 2069   self..        i
-0001d170: 6620 6469 7669 7369 6f6e 7320 6973 206e  f divisions is n
-0001d180: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
-0001d190: 2020 2020 2063 6865 636b 5f64 6976 6973       check_divis
-0001d1a0: 696f 6e73 2864 6976 6973 696f 6e73 290a  ions(divisions).
-0001d1b0: 0a20 2020 2020 2020 2069 6620 2873 6f72  .        if (sor
-0001d1c0: 7465 6420 6f72 206e 6f74 2073 6f72 7429  ted or not sort)
-0001d1d0: 2061 6e64 206e 7061 7274 6974 696f 6e73   and npartitions
-0001d1e0: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-0001d1f0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0001d200: 5661 6c75 6545 7272 6f72 280a 2020 2020  ValueError(.    
-0001d210: 2020 2020 2020 2020 2020 2020 2253 7065              "Spe
-0001d220: 6369 6679 696e 6720 6e70 6172 7469 7469  cifying npartiti
-0001d230: 6f6e 7320 7769 7468 2073 6f72 743d 4661  ons with sort=Fa
-0001d240: 6c73 6520 6f72 2073 6f72 7465 643d 5472  lse or sorted=Tr
-0001d250: 7565 2069 7320 6e6f 7420 220a 2020 2020  ue is not ".    
-0001d260: 2020 2020 2020 2020 2020 2020 2273 7570              "sup
-0001d270: 706f 7274 6564 2e20 4361 6c6c 2060 7265  ported. Call `re
-0001d280: 7061 7274 6974 696f 6e60 2061 6674 6572  partition` after
-0001d290: 7761 7264 732e 220a 2020 2020 2020 2020  wards.".        
-0001d2a0: 2020 2020 290a 0a20 2020 2020 2020 2069      )..        i
-0001d2b0: 6620 736f 7274 6564 3a0a 2020 2020 2020  f sorted:.      
-0001d2c0: 2020 2020 2020 6966 2064 6976 6973 696f        if divisio
-0001d2d0: 6e73 2069 7320 6e6f 7420 4e6f 6e65 2061  ns is not None a
-0001d2e0: 6e64 206c 656e 2864 6976 6973 696f 6e73  nd len(divisions
-0001d2f0: 2920 2d20 3120 213d 2073 656c 662e 6e70  ) - 1 != self.np
-0001d300: 6172 7469 7469 6f6e 733a 0a20 2020 2020  artitions:.     
-0001d310: 2020 2020 2020 2020 2020 206d 7367 203d             msg =
-0001d320: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
-0001d330: 2020 2020 2020 2022 5768 656e 2064 6f69         "When doi
-0001d340: 6e67 2060 6466 2e73 6574 5f69 6e64 6578  ng `df.set_index
-0001d350: 2863 6f6c 2c20 736f 7274 6564 3d54 7275  (col, sorted=Tru
-0001d360: 652c 2064 6976 6973 696f 6e73 3d2e 2e2e  e, divisions=...
-0001d370: 2960 2c20 220a 2020 2020 2020 2020 2020  )`, ".          
-0001d380: 2020 2020 2020 2020 2020 2264 6976 6973            "divis
-0001d390: 696f 6e73 2069 6e64 6963 6174 6573 206b  ions indicates k
-0001d3a0: 6e6f 776e 2073 706c 6974 7320 696e 2074  nown splits in t
-0001d3b0: 6865 2069 6e64 6578 2063 6f6c 756d 6e2e  he index column.
-0001d3c0: 2049 6e20 7468 6973 2022 0a20 2020 2020   In this ".     
-0001d3d0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0001d3e0: 6361 7365 2064 6976 6973 696f 6e73 206d  case divisions m
-0001d3f0: 7573 7420 6265 2074 6865 2073 616d 6520  ust be the same 
-0001d400: 6c65 6e67 7468 2061 7320 7468 6520 6578  length as the ex
-0001d410: 6973 7469 6e67 2022 0a20 2020 2020 2020  isting ".       
-0001d420: 2020 2020 2020 2020 2020 2020 2022 6469               "di
-0001d430: 7669 7369 6f6e 7320 696e 2060 6466 605c  visions in `df`\
-0001d440: 6e5c 6e22 0a20 2020 2020 2020 2020 2020  n\n".           
-0001d450: 2020 2020 2020 2020 2022 4966 2074 6865           "If the
-0001d460: 2069 6e74 656e 7420 6973 2074 6f20 7265   intent is to re
-0001d470: 7061 7274 6974 696f 6e20 696e 746f 206e  partition into n
-0001d480: 6577 2064 6976 6973 696f 6e73 2061 6674  ew divisions aft
-0001d490: 6572 2022 0a20 2020 2020 2020 2020 2020  er ".           
-0001d4a0: 2020 2020 2020 2020 2022 7365 7474 696e           "settin
-0001d4b0: 6720 7468 6520 696e 6465 782c 2079 6f75  g the index, you
-0001d4c0: 2070 726f 6261 626c 7920 7761 6e74 3a5c   probably want:\
-0001d4d0: 6e5c 6e22 0a20 2020 2020 2020 2020 2020  n\n".           
-0001d4e0: 2020 2020 2020 2020 2022 6064 662e 7365           "`df.se
-0001d4f0: 745f 696e 6465 7828 636f 6c2c 2073 6f72  t_index(col, sor
-0001d500: 7465 643d 5472 7565 292e 7265 7061 7274  ted=True).repart
-0001d510: 6974 696f 6e28 6469 7669 7369 6f6e 733d  ition(divisions=
-0001d520: 6469 7669 7369 6f6e 7329 6022 0a20 2020  divisions)`".   
-0001d530: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-0001d540: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0001d550: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-0001d560: 6d73 6729 0a20 2020 2020 2020 2020 2020  msg).           
-0001d570: 2072 6573 756c 7420 3d20 6e65 775f 636f   result = new_co
-0001d580: 6c6c 6563 7469 6f6e 280a 2020 2020 2020  llection(.      
-0001d590: 2020 2020 2020 2020 2020 5365 7449 6e64            SetInd
-0001d5a0: 6578 426c 6f63 6b77 6973 6528 0a20 2020  exBlockwise(.   
-0001d5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d5c0: 2073 656c 662c 206f 7468 6572 2c20 6472   self, other, dr
-0001d5d0: 6f70 2c20 6e65 775f 6469 7669 7369 6f6e  op, new_division
-0001d5e0: 733d 6469 7669 7369 6f6e 732c 2061 7070  s=divisions, app
-0001d5f0: 656e 643d 6170 7065 6e64 0a20 2020 2020  end=append.     
-0001d600: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-0001d610: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0001d620: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
-0001d630: 7375 6c74 2e63 6f6d 7075 7465 5f63 7572  sult.compute_cur
-0001d640: 7265 6e74 5f64 6976 6973 696f 6e73 2873  rent_divisions(s
-0001d650: 6574 5f64 6976 6973 696f 6e73 3d54 7275  et_divisions=Tru
-0001d660: 6529 0a20 2020 2020 2020 2065 6c69 6620  e).        elif 
-0001d670: 6e6f 7420 736f 7274 3a0a 2020 2020 2020  not sort:.      
-0001d680: 2020 2020 2020 7265 7475 726e 206e 6577        return new
-0001d690: 5f63 6f6c 6c65 6374 696f 6e28 0a20 2020  _collection(.   
-0001d6a0: 2020 2020 2020 2020 2020 2020 2053 6574               Set
-0001d6b0: 496e 6465 7842 6c6f 636b 7769 7365 2873  IndexBlockwise(s
-0001d6c0: 656c 662c 206f 7468 6572 2c20 6472 6f70  elf, other, drop
-0001d6d0: 2c20 4e6f 6e65 2c20 6170 7065 6e64 3d61  , None, append=a
-0001d6e0: 7070 656e 6429 0a20 2020 2020 2020 2020  ppend).         
-0001d6f0: 2020 2029 0a0a 2020 2020 2020 2020 7265     )..        re
-0001d700: 7475 726e 206e 6577 5f63 6f6c 6c65 6374  turn new_collect
-0001d710: 696f 6e28 0a20 2020 2020 2020 2020 2020  ion(.           
-0001d720: 2053 6574 496e 6465 7828 0a20 2020 2020   SetIndex(.     
-0001d730: 2020 2020 2020 2020 2020 2073 656c 662c             self,
-0001d740: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001d750: 206f 7468 6572 2c0a 2020 2020 2020 2020   other,.        
-0001d760: 2020 2020 2020 2020 6472 6f70 2c0a 2020          drop,.  
-0001d770: 2020 2020 2020 2020 2020 2020 2020 7573                us
-0001d780: 6572 5f64 6976 6973 696f 6e73 3d64 6976  er_divisions=div
-0001d790: 6973 696f 6e73 2c0a 2020 2020 2020 2020  isions,.        
-0001d7a0: 2020 2020 2020 2020 6e70 6172 7469 7469          npartiti
-0001d7b0: 6f6e 733d 6e70 6172 7469 7469 6f6e 732c  ons=npartitions,
-0001d7c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001d7d0: 2075 7073 616d 706c 653d 7570 7361 6d70   upsample=upsamp
-0001d7e0: 6c65 2c0a 2020 2020 2020 2020 2020 2020  le,.            
-0001d7f0: 2020 2020 7061 7274 6974 696f 6e5f 7369      partition_si
-0001d800: 7a65 3d70 6172 7469 7469 6f6e 5f73 697a  ze=partition_siz
-0001d810: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-0001d820: 2020 2073 6875 6666 6c65 5f6d 6574 686f     shuffle_metho
-0001d830: 643d 6765 745f 7370 6563 6966 6965 645f  d=get_specified_
-0001d840: 7368 7566 666c 6528 7368 7566 666c 655f  shuffle(shuffle_
-0001d850: 6d65 7468 6f64 292c 0a20 2020 2020 2020  method),.       
-0001d860: 2020 2020 2020 2020 2061 7070 656e 643d           append=
-0001d870: 6170 7065 6e64 2c0a 2020 2020 2020 2020  append,.        
-0001d880: 2020 2020 2020 2020 6f70 7469 6f6e 733d          options=
-0001d890: 6f70 7469 6f6e 732c 0a20 2020 2020 2020  options,.       
-0001d8a0: 2020 2020 2029 0a20 2020 2020 2020 2029       ).        )
-0001d8b0: 0a0a 2020 2020 6465 6620 736f 7274 5f76  ..    def sort_v
-0001d8c0: 616c 7565 7328 0a20 2020 2020 2020 2073  alues(.        s
-0001d8d0: 656c 662c 0a20 2020 2020 2020 2062 793a  elf,.        by:
-0001d8e0: 2073 7472 207c 206c 6973 745b 7374 725d   str | list[str]
-0001d8f0: 2c0a 2020 2020 2020 2020 6e70 6172 7469  ,.        nparti
-0001d900: 7469 6f6e 733a 2069 6e74 207c 204e 6f6e  tions: int | Non
-0001d910: 6520 3d20 4e6f 6e65 2c0a 2020 2020 2020  e = None,.      
-0001d920: 2020 6173 6365 6e64 696e 673a 2062 6f6f    ascending: boo
-0001d930: 6c20 7c20 6c69 7374 5b62 6f6f 6c5d 203d  l | list[bool] =
-0001d940: 2054 7275 652c 0a20 2020 2020 2020 206e   True,.        n
-0001d950: 615f 706f 7369 7469 6f6e 3a20 4c69 7465  a_position: Lite
-0001d960: 7261 6c5b 2266 6972 7374 225d 207c 204c  ral["first"] | L
-0001d970: 6974 6572 616c 5b22 6c61 7374 225d 203d  iteral["last"] =
-0001d980: 2022 6c61 7374 222c 0a20 2020 2020 2020   "last",.       
-0001d990: 2070 6172 7469 7469 6f6e 5f73 697a 653a   partition_size:
-0001d9a0: 2066 6c6f 6174 203d 2031 3238 6536 2c0a   float = 128e6,.
-0001d9b0: 2020 2020 2020 2020 736f 7274 5f66 756e          sort_fun
-0001d9c0: 6374 696f 6e3a 2043 616c 6c61 626c 655b  ction: Callable[
-0001d9d0: 5b70 642e 4461 7461 4672 616d 655d 2c20  [pd.DataFrame], 
-0001d9e0: 7064 2e44 6174 6146 7261 6d65 5d20 7c20  pd.DataFrame] | 
-0001d9f0: 4e6f 6e65 203d 204e 6f6e 652c 0a20 2020  None = None,.   
-0001da00: 2020 2020 2073 6f72 745f 6675 6e63 7469       sort_functi
-0001da10: 6f6e 5f6b 7761 7267 733a 204d 6170 7069  on_kwargs: Mappi
-0001da20: 6e67 5b73 7472 2c20 416e 795d 207c 204e  ng[str, Any] | N
-0001da30: 6f6e 6520 3d20 4e6f 6e65 2c0a 2020 2020  one = None,.    
-0001da40: 2020 2020 7570 7361 6d70 6c65 3a20 666c      upsample: fl
-0001da50: 6f61 7420 3d20 312e 302c 0a20 2020 2020  oat = 1.0,.     
-0001da60: 2020 2069 676e 6f72 655f 696e 6465 783a     ignore_index:
-0001da70: 2062 6f6f 6c20 7c20 4e6f 6e65 203d 2046   bool | None = F
-0001da80: 616c 7365 2c0a 2020 2020 2020 2020 7368  alse,.        sh
-0001da90: 7566 666c 655f 6d65 7468 6f64 3a20 7374  uffle_method: st
-0001daa0: 7220 7c20 4e6f 6e65 203d 204e 6f6e 652c  r | None = None,
-0001dab0: 0a20 2020 2020 2020 202a 2a6f 7074 696f  .        **optio
-0001dac0: 6e73 2c0a 2020 2020 293a 0a20 2020 2020  ns,.    ):.     
-0001dad0: 2020 2022 2222 536f 7274 2074 6865 2064     """Sort the d
-0001dae0: 6174 6173 6574 2062 7920 6120 7369 6e67  ataset by a sing
-0001daf0: 6c65 2063 6f6c 756d 6e2e 0a0a 2020 2020  le column...    
-0001db00: 2020 2020 536f 7274 696e 6720 6120 7061      Sorting a pa
-0001db10: 7261 6c6c 656c 2064 6174 6173 6574 2072  rallel dataset r
-0001db20: 6571 7569 7265 7320 6578 7065 6e73 6976  equires expensiv
-0001db30: 6520 7368 7566 666c 6573 2061 6e64 2069  e shuffles and i
-0001db40: 7320 6765 6e65 7261 6c6c 790a 2020 2020  s generally.    
-0001db50: 2020 2020 6e6f 7420 7265 636f 6d6d 656e      not recommen
-0001db60: 6465 642e 2053 6565 2060 6073 6574 5f69  ded. See ``set_i
-0001db70: 6e64 6578 6060 2066 6f72 2069 6d70 6c65  ndex`` for imple
-0001db80: 6d65 6e74 6174 696f 6e20 6465 7461 696c  mentation detail
-0001db90: 732e 0a0a 2020 2020 2020 2020 5061 7261  s...        Para
-0001dba0: 6d65 7465 7273 0a20 2020 2020 2020 202d  meters.        -
-0001dbb0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-0001dbc0: 2020 6279 3a20 7374 7220 6f72 206c 6973    by: str or lis
-0001dbd0: 745b 7374 725d 0a20 2020 2020 2020 2020  t[str].         
-0001dbe0: 2020 2043 6f6c 756d 6e28 7329 2074 6f20     Column(s) to 
-0001dbf0: 736f 7274 2062 792e 0a20 2020 2020 2020  sort by..       
-0001dc00: 206e 7061 7274 6974 696f 6e73 3a20 696e   npartitions: in
-0001dc10: 742c 204e 6f6e 652c 206f 7220 2761 7574  t, None, or 'aut
-0001dc20: 6f27 0a20 2020 2020 2020 2020 2020 2054  o'.            T
-0001dc30: 6865 2069 6465 616c 206e 756d 6265 7220  he ideal number 
-0001dc40: 6f66 206f 7574 7075 7420 7061 7274 6974  of output partit
-0001dc50: 696f 6e73 2e20 4966 204e 6f6e 652c 2075  ions. If None, u
-0001dc60: 7365 2074 6865 2073 616d 6520 6173 0a20  se the same as. 
-0001dc70: 2020 2020 2020 2020 2020 2074 6865 2069             the i
-0001dc80: 6e70 7574 2e20 4966 2027 6175 746f 2720  nput. If 'auto' 
-0001dc90: 7468 656e 2064 6563 6964 6520 6279 206d  then decide by m
-0001dca0: 656d 6f72 7920 7573 652e 0a20 2020 2020  emory use..     
-0001dcb0: 2020 2061 7363 656e 6469 6e67 3a20 626f     ascending: bo
-0001dcc0: 6f6c 2c20 6f70 7469 6f6e 616c 0a20 2020  ol, optional.   
-0001dcd0: 2020 2020 2020 2020 2053 6f72 7420 6173           Sort as
-0001dce0: 6365 6e64 696e 6720 7673 2e20 6465 7363  cending vs. desc
-0001dcf0: 656e 6469 6e67 2e0a 2020 2020 2020 2020  ending..        
-0001dd00: 2020 2020 4465 6661 756c 7473 2074 6f20      Defaults to 
-0001dd10: 5472 7565 2e0a 2020 2020 2020 2020 6e61  True..        na
-0001dd20: 5f70 6f73 6974 696f 6e3a 207b 276c 6173  _position: {'las
-0001dd30: 7427 2c20 2766 6972 7374 277d 2c20 6f70  t', 'first'}, op
-0001dd40: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
-0001dd50: 2020 2050 7574 7320 4e61 4e73 2061 7420     Puts NaNs at 
-0001dd60: 7468 6520 6265 6769 6e6e 696e 6720 6966  the beginning if
-0001dd70: 2027 6669 7273 7427 2c20 7075 7473 204e   'first', puts N
-0001dd80: 614e 2061 7420 7468 6520 656e 6420 6966  aN at the end if
-0001dd90: 2027 6c61 7374 272e 0a20 2020 2020 2020   'last'..       
-0001dda0: 2020 2020 2044 6566 6175 6c74 7320 746f       Defaults to
-0001ddb0: 2027 6c61 7374 272e 0a20 2020 2020 2020   'last'..       
-0001ddc0: 2073 6f72 745f 6675 6e63 7469 6f6e 3a20   sort_function: 
-0001ddd0: 6675 6e63 7469 6f6e 2c20 6f70 7469 6f6e  function, option
-0001dde0: 616c 0a20 2020 2020 2020 2020 2020 2053  al.            S
-0001ddf0: 6f72 7469 6e67 2066 756e 6374 696f 6e20  orting function 
-0001de00: 746f 2075 7365 2077 6865 6e20 736f 7274  to use when sort
-0001de10: 696e 6720 756e 6465 726c 7969 6e67 2070  ing underlying p
-0001de20: 6172 7469 7469 6f6e 732e 0a20 2020 2020  artitions..     
-0001de30: 2020 2020 2020 2049 6620 4e6f 6e65 2c20         If None, 
-0001de40: 6465 6661 756c 7473 2074 6f20 6060 4d2e  defaults to ``M.
-0001de50: 736f 7274 5f76 616c 7565 7360 6020 2874  sort_values`` (t
-0001de60: 6865 2070 6172 7469 7469 6f6e 206c 6962  he partition lib
-0001de70: 7261 7279 2773 0a20 2020 2020 2020 2020  rary's.         
-0001de80: 2020 2069 6d70 6c65 6d65 6e74 6174 696f     implementatio
-0001de90: 6e20 6f66 2060 6073 6f72 745f 7661 6c75  n of ``sort_valu
-0001dea0: 6573 6060 292e 0a20 2020 2020 2020 2073  es``)..        s
-0001deb0: 6f72 745f 6675 6e63 7469 6f6e 5f6b 7761  ort_function_kwa
-0001dec0: 7267 733a 2064 6963 742c 206f 7074 696f  rgs: dict, optio
-0001ded0: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
-0001dee0: 4164 6469 7469 6f6e 616c 206b 6579 776f  Additional keywo
-0001def0: 7264 2061 7267 756d 656e 7473 2074 6f20  rd arguments to 
-0001df00: 7061 7373 2074 6f20 7468 6520 7061 7274  pass to the part
-0001df10: 6974 696f 6e20 736f 7274 696e 6720 6675  ition sorting fu
-0001df20: 6e63 7469 6f6e 2e0a 2020 2020 2020 2020  nction..        
-0001df30: 2020 2020 4279 2064 6566 6175 6c74 2c20      By default, 
-0001df40: 6060 6279 6060 2c20 6060 6173 6365 6e64  ``by``, ``ascend
-0001df50: 696e 6760 602c 2061 6e64 2060 606e 615f  ing``, and ``na_
-0001df60: 706f 7369 7469 6f6e 6060 2061 7265 2070  position`` are p
-0001df70: 726f 7669 6465 642e 0a0a 2020 2020 2020  rovided...      
-0001df80: 2020 4578 616d 706c 6573 0a20 2020 2020    Examples.     
-0001df90: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
-0001dfa0: 2020 2020 3e3e 3e20 6466 3220 3d20 6466      >>> df2 = df
-0001dfb0: 2e73 6f72 745f 7661 6c75 6573 2827 7827  .sort_values('x'
-0001dfc0: 2920 2023 2064 6f63 7465 7374 3a20 2b53  )  # doctest: +S
-0001dfd0: 4b49 500a 2020 2020 2020 2020 2222 220a  KIP.        """.
-0001dfe0: 2020 2020 2020 2020 6966 206e 615f 706f          if na_po
-0001dff0: 7369 7469 6f6e 206e 6f74 2069 6e20 2822  sition not in ("
-0001e000: 6669 7273 7422 2c20 226c 6173 7422 293a  first", "last"):
-0001e010: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-0001e020: 7365 2056 616c 7565 4572 726f 7228 226e  se ValueError("n
-0001e030: 615f 706f 7369 7469 6f6e 206d 7573 7420  a_position must 
-0001e040: 6265 2065 6974 6865 7220 2766 6972 7374  be either 'first
-0001e050: 2720 6f72 2027 6c61 7374 2722 290a 2020  ' or 'last'").  
-0001e060: 2020 2020 2020 6966 206e 6f74 2069 7369        if not isi
-0001e070: 6e73 7461 6e63 6528 6279 2c20 6c69 7374  nstance(by, list
-0001e080: 293a 0a20 2020 2020 2020 2020 2020 2062  ):.            b
-0001e090: 7920 3d20 5b62 795d 0a20 2020 2020 2020  y = [by].       
-0001e0a0: 2069 6620 616e 7928 6e6f 7420 6973 696e   if any(not isin
-0001e0b0: 7374 616e 6365 2862 2c20 7374 7229 2066  stance(b, str) f
-0001e0c0: 6f72 2062 2069 6e20 6279 293a 0a20 2020  or b in by):.   
-0001e0d0: 2020 2020 2020 2020 2072 6169 7365 204e           raise N
-0001e0e0: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
-0001e0f0: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-0001e100: 2020 2020 2244 6174 6166 7261 6d65 7320      "Dataframes 
-0001e110: 6f6e 6c79 2073 7570 706f 7274 2073 6f72  only support sor
-0001e120: 7469 6e67 2062 7920 6e61 6d65 6420 636f  ting by named co
-0001e130: 6c75 6d6e 7320 7768 6963 6820 6d75 7374  lumns which must
-0001e140: 2062 6520 7061 7373 6564 2061 7320 6120   be passed as a 
-0001e150: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-0001e160: 2020 2273 7472 696e 6720 6f72 2061 206c    "string or a l
-0001e170: 6973 7420 6f66 2073 7472 696e 6773 2e5c  ist of strings.\
-0001e180: 6e22 0a20 2020 2020 2020 2020 2020 2020  n".             
-0001e190: 2020 2022 596f 7520 7061 7373 6564 2025     "You passed %
-0001e1a0: 7322 2025 2073 7472 2862 7929 0a20 2020  s" % str(by).   
-0001e1b0: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-0001e1c0: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
-0001e1d0: 7461 6e63 6528 6173 6365 6e64 696e 672c  tance(ascending,
-0001e1e0: 2062 6f6f 6c29 2061 6e64 206e 6f74 206c   bool) and not l
-0001e1f0: 656e 2861 7363 656e 6469 6e67 2920 3d3d  en(ascending) ==
-0001e200: 206c 656e 2862 7929 3a0a 2020 2020 2020   len(by):.      
-0001e210: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-0001e220: 6545 7272 6f72 2866 224c 656e 6774 6820  eError(f"Length 
-0001e230: 6f66 207b 6173 6365 6e64 696e 673d 7d20  of {ascending=} 
-0001e240: 213d 206c 656e 6774 6820 6f66 207b 6279  != length of {by
-0001e250: 3d7d 2229 0a0a 2020 2020 2020 2020 7265  =}")..        re
-0001e260: 7475 726e 206e 6577 5f63 6f6c 6c65 6374  turn new_collect
-0001e270: 696f 6e28 0a20 2020 2020 2020 2020 2020  ion(.           
-0001e280: 2053 6f72 7456 616c 7565 7328 0a20 2020   SortValues(.   
-0001e290: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0001e2a0: 662c 0a20 2020 2020 2020 2020 2020 2020  f,.             
-0001e2b0: 2020 2062 792c 0a20 2020 2020 2020 2020     by,.         
-0001e2c0: 2020 2020 2020 2061 7363 656e 6469 6e67         ascending
-0001e2d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001e2e0: 2020 6e61 5f70 6f73 6974 696f 6e2c 0a20    na_position,. 
-0001e2f0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-0001e300: 7061 7274 6974 696f 6e73 2c0a 2020 2020  partitions,.    
-0001e310: 2020 2020 2020 2020 2020 2020 7061 7274              part
-0001e320: 6974 696f 6e5f 7369 7a65 2c0a 2020 2020  ition_size,.    
-0001e330: 2020 2020 2020 2020 2020 2020 736f 7274              sort
-0001e340: 5f66 756e 6374 696f 6e2c 0a20 2020 2020  _function,.     
-0001e350: 2020 2020 2020 2020 2020 2073 6f72 745f             sort_
-0001e360: 6675 6e63 7469 6f6e 5f6b 7761 7267 732c  function_kwargs,
-0001e370: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001e380: 2075 7073 616d 706c 652c 0a20 2020 2020   upsample,.     
-0001e390: 2020 2020 2020 2020 2020 2069 676e 6f72             ignor
-0001e3a0: 655f 696e 6465 782c 0a20 2020 2020 2020  e_index,.       
-0001e3b0: 2020 2020 2020 2020 2067 6574 5f73 7065           get_spe
-0001e3c0: 6369 6669 6564 5f73 6875 6666 6c65 2873  cified_shuffle(s
-0001e3d0: 6875 6666 6c65 5f6d 6574 686f 6429 2c0a  huffle_method),.
-0001e3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e3f0: 6f70 7469 6f6e 733d 6f70 7469 6f6e 732c  options=options,
-0001e400: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-0001e410: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
-0001e420: 6620 7175 6572 7928 7365 6c66 2c20 6578  f query(self, ex
-0001e430: 7072 2c20 2a2a 6b77 6172 6773 293a 0a20  pr, **kwargs):. 
-0001e440: 2020 2020 2020 2022 2222 4669 6c74 6572         """Filter
-0001e450: 2064 6174 6166 7261 6d65 2077 6974 6820   dataframe with 
-0001e460: 636f 6d70 6c65 7820 6578 7072 6573 7369  complex expressi
-0001e470: 6f6e 0a0a 2020 2020 2020 2020 426c 6f63  on..        Bloc
-0001e480: 6b65 6420 7665 7273 696f 6e20 6f66 2070  ked version of p
-0001e490: 642e 4461 7461 4672 616d 652e 7175 6572  d.DataFrame.quer
-0001e4a0: 790a 0a20 2020 2020 2020 2050 6172 616d  y..        Param
-0001e4b0: 6574 6572 730a 2020 2020 2020 2020 2d2d  eters.        --
-0001e4c0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-0001e4d0: 2065 7870 723a 2073 7472 0a20 2020 2020   expr: str.     
-0001e4e0: 2020 2020 2020 2054 6865 2071 7565 7279         The query
-0001e4f0: 2073 7472 696e 6720 746f 2065 7661 6c75   string to evalu
-0001e500: 6174 652e 0a20 2020 2020 2020 2020 2020  ate..           
-0001e510: 2059 6f75 2063 616e 2072 6566 6572 2074   You can refer t
-0001e520: 6f20 636f 6c75 6d6e 206e 616d 6573 2074  o column names t
-0001e530: 6861 7420 6172 6520 6e6f 7420 7661 6c69  hat are not vali
-0001e540: 6420 5079 7468 6f6e 2076 6172 6961 626c  d Python variabl
-0001e550: 6520 6e61 6d65 730a 2020 2020 2020 2020  e names.        
-0001e560: 2020 2020 6279 2073 7572 726f 756e 6469      by surroundi
-0001e570: 6e67 2074 6865 6d20 696e 2062 6163 6b74  ng them in backt
-0001e580: 6963 6b73 2e0a 2020 2020 2020 2020 2020  icks..          
-0001e590: 2020 4461 736b 2064 6f65 7320 6e6f 7420    Dask does not 
-0001e5a0: 6675 6c6c 7920 7375 7070 6f72 7420 7265  fully support re
-0001e5b0: 6665 7272 696e 6720 746f 2076 6172 6961  ferring to varia
-0001e5c0: 626c 6573 2075 7369 6e67 2074 6865 2027  bles using the '
-0001e5d0: 4027 2063 6861 7261 6374 6572 2c0a 2020  @' character,.  
-0001e5e0: 2020 2020 2020 2020 2020 7573 6520 662d            use f-
-0001e5f0: 7374 7269 6e67 7320 6f72 2074 6865 2060  strings or the `
-0001e600: 606c 6f63 616c 5f64 6963 7460 6020 6b65  `local_dict`` ke
-0001e610: 7977 6f72 6420 6172 6775 6d65 6e74 2069  yword argument i
-0001e620: 6e73 7465 6164 2e0a 0a20 2020 2020 2020  nstead...       
-0001e630: 204e 6f74 6573 0a20 2020 2020 2020 202d   Notes.        -
-0001e640: 2d2d 2d2d 0a20 2020 2020 2020 2054 6869  ----.        Thi
-0001e650: 7320 6973 206c 696b 6520 7468 6520 7365  s is like the se
-0001e660: 7175 656e 7469 616c 2076 6572 7369 6f6e  quential version
-0001e670: 2065 7863 6570 7420 7468 6174 2074 6869   except that thi
-0001e680: 7320 7769 6c6c 2061 6c73 6f20 6861 7070  s will also happ
-0001e690: 656e 0a20 2020 2020 2020 2069 6e20 6d61  en.        in ma
-0001e6a0: 6e79 2074 6872 6561 6473 2e20 2054 6869  ny threads.  Thi
-0001e6b0: 7320 6d61 7920 636f 6e66 6c69 6374 2077  s may conflict w
-0001e6c0: 6974 6820 6060 6e75 6d65 7870 7260 6020  ith ``numexpr`` 
-0001e6d0: 7768 6963 6820 7769 6c6c 2075 7365 0a20  which will use. 
-0001e6e0: 2020 2020 2020 206d 756c 7469 706c 6520         multiple 
-0001e6f0: 7468 7265 6164 7320 6974 7365 6c66 2e20  threads itself. 
-0001e700: 2057 6520 7265 636f 6d6d 656e 6420 7468   We recommend th
-0001e710: 6174 2079 6f75 2073 6574 2060 606e 756d  at you set ``num
-0001e720: 6578 7072 6060 2074 6f20 7573 6520 610a  expr`` to use a.
-0001e730: 2020 2020 2020 2020 7369 6e67 6c65 2074          single t
-0001e740: 6872 6561 643a 0a0a 2020 2020 2020 2020  hread:..        
-0001e750: 2e2e 2063 6f64 652d 626c 6f63 6b3a 3a20  .. code-block:: 
-0001e760: 7079 7468 6f6e 0a0a 2020 2020 2020 2020  python..        
-0001e770: 2020 2020 696d 706f 7274 206e 756d 6578      import numex
-0001e780: 7072 0a20 2020 2020 2020 2020 2020 206e  pr.            n
-0001e790: 756d 6578 7072 2e73 6574 5f6e 756d 5f74  umexpr.set_num_t
-0001e7a0: 6872 6561 6473 2831 290a 0a20 2020 2020  hreads(1)..     
-0001e7b0: 2020 2053 6565 2061 6c73 6f0a 2020 2020     See also.    
-0001e7c0: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
-0001e7d0: 2020 2020 2070 616e 6461 732e 4461 7461       pandas.Data
-0001e7e0: 4672 616d 652e 7175 6572 790a 2020 2020  Frame.query.    
-0001e7f0: 2020 2020 7061 6e64 6173 2e65 7661 6c0a      pandas.eval.
-0001e800: 0a20 2020 2020 2020 2045 7861 6d70 6c65  .        Example
-0001e810: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
-0001e820: 2d2d 0a20 2020 2020 2020 203e 3e3e 2069  --.        >>> i
-0001e830: 6d70 6f72 7420 7061 6e64 6173 2061 7320  mport pandas as 
-0001e840: 7064 0a20 2020 2020 2020 203e 3e3e 2069  pd.        >>> i
-0001e850: 6d70 6f72 7420 6461 736b 5f65 7870 7220  mport dask_expr 
-0001e860: 6173 2064 640a 2020 2020 2020 2020 3e3e  as dd.        >>
-0001e870: 3e20 6466 203d 2070 642e 4461 7461 4672  > df = pd.DataFr
-0001e880: 616d 6528 7b27 7827 3a20 5b31 2c20 322c  ame({'x': [1, 2,
-0001e890: 2031 2c20 325d 2c0a 2020 2020 2020 2020   1, 2],.        
-0001e8a0: 2e2e 2e20 2020 2020 2020 2020 2020 2020  ...             
-0001e8b0: 2020 2020 2020 2027 7927 3a20 5b31 2c20         'y': [1, 
-0001e8c0: 322c 2033 2c20 345d 2c0a 2020 2020 2020  2, 3, 4],.      
-0001e8d0: 2020 2e2e 2e20 2020 2020 2020 2020 2020    ...           
-0001e8e0: 2020 2020 2020 2020 2027 7a20 7a27 3a20           'z z': 
-0001e8f0: 5b34 2c20 332c 2032 2c20 315d 7d29 0a20  [4, 3, 2, 1]}). 
-0001e900: 2020 2020 2020 203e 3e3e 2064 6466 203d         >>> ddf =
-0001e910: 2064 642e 6672 6f6d 5f70 616e 6461 7328   dd.from_pandas(
-0001e920: 6466 2c20 6e70 6172 7469 7469 6f6e 733d  df, npartitions=
-0001e930: 3229 0a0a 2020 2020 2020 2020 5265 6665  2)..        Refe
-0001e940: 7220 746f 2063 6f6c 756d 6e20 6e61 6d65  r to column name
-0001e950: 7320 6469 7265 6374 6c79 3a0a 0a20 2020  s directly:..   
-0001e960: 2020 2020 203e 3e3e 2064 6466 2e71 7565       >>> ddf.que
-0001e970: 7279 2827 7920 3e20 7827 292e 636f 6d70  ry('y > x').comp
-0001e980: 7574 6528 290a 2020 2020 2020 2020 2020  ute().          
-0001e990: 2078 2020 7920 207a 207a 0a20 2020 2020   x  y  z z.     
-0001e9a0: 2020 2032 2020 3120 2033 2020 2020 320a     2  1  3    2.
-0001e9b0: 2020 2020 2020 2020 3320 2032 2020 3420          3  2  4 
-0001e9c0: 2020 2031 0a0a 2020 2020 2020 2020 5265     1..        Re
-0001e9d0: 6665 7220 746f 2063 6f6c 756d 6e20 6e61  fer to column na
-0001e9e0: 6d65 2075 7369 6e67 2062 6163 6b74 6963  me using backtic
-0001e9f0: 6b73 3a0a 0a20 2020 2020 2020 203e 3e3e  ks:..        >>>
-0001ea00: 2064 6466 2e71 7565 7279 2827 607a 207a   ddf.query('`z z
-0001ea10: 6020 3e20 7827 292e 636f 6d70 7574 6528  ` > x').compute(
-0001ea20: 290a 2020 2020 2020 2020 2020 2078 2020  ).           x  
-0001ea30: 7920 207a 207a 0a20 2020 2020 2020 2030  y  z z.        0
-0001ea40: 2020 3120 2031 2020 2020 340a 2020 2020    1  1    4.    
-0001ea50: 2020 2020 3120 2032 2020 3220 2020 2033      1  2  2    3
-0001ea60: 0a20 2020 2020 2020 2032 2020 3120 2033  .        2  1  3
-0001ea70: 2020 2020 320a 0a20 2020 2020 2020 2052      2..        R
-0001ea80: 6566 6572 2074 6f20 7661 7269 6162 6c65  efer to variable
-0001ea90: 206e 616d 6520 7573 696e 6720 662d 7374   name using f-st
-0001eaa0: 7269 6e67 733a 0a0a 2020 2020 2020 2020  rings:..        
-0001eab0: 3e3e 3e20 7661 6c75 6520 3d20 310a 2020  >>> value = 1.  
-0001eac0: 2020 2020 2020 3e3e 3e20 6464 662e 7175        >>> ddf.qu
-0001ead0: 6572 7928 6627 7820 3d3d 207b 7661 6c75  ery(f'x == {valu
-0001eae0: 657d 2729 2e63 6f6d 7075 7465 2829 0a20  e}').compute(). 
-0001eaf0: 2020 2020 2020 2020 2020 7820 2079 2020            x  y  
-0001eb00: 7a20 7a0a 2020 2020 2020 2020 3020 2031  z z.        0  1
-0001eb10: 2020 3120 2020 2034 0a20 2020 2020 2020    1    4.       
-0001eb20: 2032 2020 3120 2033 2020 2020 320a 0a20   2  1  3    2.. 
-0001eb30: 2020 2020 2020 2052 6566 6572 2074 6f20         Refer to 
-0001eb40: 7661 7269 6162 6c65 206e 616d 6520 7573  variable name us
-0001eb50: 696e 6720 6060 6c6f 6361 6c5f 6469 6374  ing ``local_dict
-0001eb60: 6060 3a0a 0a20 2020 2020 2020 203e 3e3e  ``:..        >>>
-0001eb70: 2064 6466 2e71 7565 7279 2827 7820 3d3d   ddf.query('x ==
-0001eb80: 2040 7661 6c75 6527 2c20 6c6f 6361 6c5f   @value', local_
-0001eb90: 6469 6374 3d7b 2276 616c 7565 223a 2076  dict={"value": v
-0001eba0: 616c 7565 7d29 2e63 6f6d 7075 7465 2829  alue}).compute()
-0001ebb0: 0a20 2020 2020 2020 2020 2020 7820 2079  .           x  y
-0001ebc0: 2020 7a20 7a0a 2020 2020 2020 2020 3020    z z.        0 
-0001ebd0: 2031 2020 3120 2020 2034 0a20 2020 2020   1  1    4.     
-0001ebe0: 2020 2032 2020 3120 2033 2020 2020 320a     2  1  3    2.
-0001ebf0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0001ec00: 2020 2020 7265 7475 726e 206e 6577 5f63      return new_c
-0001ec10: 6f6c 6c65 6374 696f 6e28 5175 6572 7928  ollection(Query(
-0001ec20: 7365 6c66 2c20 6578 7072 2c20 6b77 6172  self, expr, kwar
-0001ec30: 6773 2929 0a0a 2020 2020 4064 6572 6976  gs))..    @deriv
-0001ec40: 6564 5f66 726f 6d28 7064 2e44 6174 6146  ed_from(pd.DataF
-0001ec50: 7261 6d65 290a 2020 2020 6465 6620 6d6f  rame).    def mo
-0001ec60: 6465 2873 656c 662c 2064 726f 706e 613d  de(self, dropna=
-0001ec70: 5472 7565 2c20 7370 6c69 745f 6576 6572  True, split_ever
-0001ec80: 793d 4661 6c73 652c 206e 756d 6572 6963  y=False, numeric
-0001ec90: 5f6f 6e6c 793d 4661 6c73 6529 3a0a 2020  _only=False):.  
-0001eca0: 2020 2020 2020 6d6f 6465 7320 3d20 5b5d        modes = []
-0001ecb0: 0a20 2020 2020 2020 2066 6f72 205f 2c20  .        for _, 
-0001ecc0: 636f 6c20 696e 2073 656c 662e 6974 656d  col in self.item
-0001ecd0: 7328 293a 0a20 2020 2020 2020 2020 2020  s():.           
-0001ece0: 2069 6620 6e75 6d65 7269 635f 6f6e 6c79   if numeric_only
-0001ecf0: 2061 6e64 206e 6f74 2070 642e 6170 692e   and not pd.api.
-0001ed00: 7479 7065 732e 6973 5f6e 756d 6572 6963  types.is_numeric
-0001ed10: 5f64 7479 7065 2863 6f6c 2e64 7479 7065  _dtype(col.dtype
-0001ed20: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-0001ed30: 2020 2063 6f6e 7469 6e75 650a 2020 2020     continue.    
-0001ed40: 2020 2020 2020 2020 6d6f 6465 732e 6170          modes.ap
-0001ed50: 7065 6e64 2863 6f6c 2e6d 6f64 6528 6472  pend(col.mode(dr
-0001ed60: 6f70 6e61 3d64 726f 706e 612c 2073 706c  opna=dropna, spl
-0001ed70: 6974 5f65 7665 7279 3d73 706c 6974 5f65  it_every=split_e
-0001ed80: 7665 7279 2929 0a20 2020 2020 2020 2072  very)).        r
-0001ed90: 6574 7572 6e20 636f 6e63 6174 286d 6f64  eturn concat(mod
-0001eda0: 6573 2c20 6178 6973 3d31 290a 0a20 2020  es, axis=1)..   
-0001edb0: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
-0001edc0: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
-0001edd0: 2064 6566 2061 6464 5f70 7265 6669 7828   def add_prefix(
-0001ede0: 7365 6c66 2c20 7072 6566 6978 293a 0a20  self, prefix):. 
-0001edf0: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
-0001ee00: 775f 636f 6c6c 6563 7469 6f6e 2865 7870  w_collection(exp
-0001ee10: 722e 4164 6450 7265 6669 7828 7365 6c66  r.AddPrefix(self
-0001ee20: 2c20 7072 6566 6978 2929 0a0a 2020 2020  , prefix))..    
-0001ee30: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
-0001ee40: 2e44 6174 6146 7261 6d65 290a 2020 2020  .DataFrame).    
-0001ee50: 6465 6620 6164 645f 7375 6666 6978 2873  def add_suffix(s
-0001ee60: 656c 662c 2073 7566 6669 7829 3a0a 2020  elf, suffix):.  
-0001ee70: 2020 2020 2020 7265 7475 726e 206e 6577        return new
-0001ee80: 5f63 6f6c 6c65 6374 696f 6e28 6578 7072  _collection(expr
-0001ee90: 2e41 6464 5375 6666 6978 2873 656c 662c  .AddSuffix(self,
-0001eea0: 2073 7566 6669 7829 290a 0a20 2020 2064   suffix))..    d
-0001eeb0: 6566 2070 6976 6f74 5f74 6162 6c65 2873  ef pivot_table(s
-0001eec0: 656c 662c 2069 6e64 6578 2c20 636f 6c75  elf, index, colu
-0001eed0: 6d6e 732c 2076 616c 7565 732c 2061 6767  mns, values, agg
-0001eee0: 6675 6e63 3d22 6d65 616e 2229 3a0a 2020  func="mean"):.  
-0001eef0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0001ef00: 2020 4372 6561 7465 2061 2073 7072 6561    Create a sprea
-0001ef10: 6473 6865 6574 2d73 7479 6c65 2070 6976  dsheet-style piv
-0001ef20: 6f74 2074 6162 6c65 2061 7320 6120 4461  ot table as a Da
-0001ef30: 7461 4672 616d 652e 2054 6172 6765 7420  taFrame. Target 
-0001ef40: 6060 636f 6c75 6d6e 7360 600a 2020 2020  ``columns``.    
-0001ef50: 2020 2020 6d75 7374 2068 6176 6520 6361      must have ca
-0001ef60: 7465 676f 7279 2064 7479 7065 2074 6f20  tegory dtype to 
-0001ef70: 696e 6665 7220 7265 7375 6c74 2773 2060  infer result's `
-0001ef80: 6063 6f6c 756d 6e73 6060 2e0a 2020 2020  `columns``..    
-0001ef90: 2020 2020 6060 696e 6465 7860 602c 2060      ``index``, `
-0001efa0: 6063 6f6c 756d 6e73 6060 2c20 6060 7661  `columns``, ``va
-0001efb0: 6c75 6573 6060 2061 6e64 2060 6061 6767  lues`` and ``agg
-0001efc0: 6675 6e63 6060 206d 7573 7420 6265 2061  func`` must be a
-0001efd0: 6c6c 2073 6361 6c61 722e 0a0a 2020 2020  ll scalar...    
-0001efe0: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
-0001eff0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-0001f000: 2d0a 2020 2020 2020 2020 7661 6c75 6573  -.        values
-0001f010: 203a 2073 6361 6c61 720a 2020 2020 2020   : scalar.      
-0001f020: 2020 2020 2020 636f 6c75 6d6e 2074 6f20        column to 
-0001f030: 6167 6772 6567 6174 650a 2020 2020 2020  aggregate.      
-0001f040: 2020 696e 6465 7820 3a20 7363 616c 6172    index : scalar
-0001f050: 0a20 2020 2020 2020 2020 2020 2063 6f6c  .            col
-0001f060: 756d 6e20 746f 2062 6520 696e 6465 780a  umn to be index.
-0001f070: 2020 2020 2020 2020 636f 6c75 6d6e 7320          columns 
-0001f080: 3a20 7363 616c 6172 0a20 2020 2020 2020  : scalar.       
-0001f090: 2020 2020 2063 6f6c 756d 6e20 746f 2062       column to b
-0001f0a0: 6520 636f 6c75 6d6e 730a 2020 2020 2020  e columns.      
-0001f0b0: 2020 6167 6766 756e 6320 3a20 7b27 6d65    aggfunc : {'me
-0001f0c0: 616e 272c 2027 7375 6d27 2c20 2763 6f75  an', 'sum', 'cou
-0001f0d0: 6e74 277d 2c20 6465 6661 756c 7420 276d  nt'}, default 'm
-0001f0e0: 6561 6e27 0a0a 2020 2020 2020 2020 5265  ean'..        Re
-0001f0f0: 7475 726e 730a 2020 2020 2020 2020 2d2d  turns.        --
-0001f100: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7461  -----.        ta
-0001f110: 626c 6520 3a20 4461 7461 4672 616d 650a  ble : DataFrame.
-0001f120: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0001f130: 2020 2020 7265 7475 726e 2070 6976 6f74      return pivot
-0001f140: 5f74 6162 6c65 2873 656c 662c 2069 6e64  _table(self, ind
-0001f150: 6578 2c20 636f 6c75 6d6e 732c 2076 616c  ex, columns, val
-0001f160: 7565 732c 2061 6767 6675 6e63 290a 0a20  ues, aggfunc).. 
-0001f170: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
-0001f180: 2064 6566 2069 6c6f 6328 7365 6c66 293a   def iloc(self):
-0001f190: 0a20 2020 2020 2020 2022 2222 5075 7265  .        """Pure
-0001f1a0: 6c79 2069 6e74 6567 6572 2d6c 6f63 6174  ly integer-locat
-0001f1b0: 696f 6e20 6261 7365 6420 696e 6465 7869  ion based indexi
-0001f1c0: 6e67 2066 6f72 2073 656c 6563 7469 6f6e  ng for selection
-0001f1d0: 2062 7920 706f 7369 7469 6f6e 2e0a 0a20   by position... 
-0001f1e0: 2020 2020 2020 204f 6e6c 7920 696e 6465         Only inde
-0001f1f0: 7869 6e67 2074 6865 2063 6f6c 756d 6e20  xing the column 
-0001f200: 706f 7369 7469 6f6e 7320 6973 2073 7570  positions is sup
-0001f210: 706f 7274 6564 2e20 5472 7969 6e67 2074  ported. Trying t
-0001f220: 6f20 7365 6c65 6374 0a20 2020 2020 2020  o select.       
-0001f230: 2072 6f77 2070 6f73 6974 696f 6e73 2077   row positions w
-0001f240: 696c 6c20 7261 6973 6520 6120 5661 6c75  ill raise a Valu
-0001f250: 6545 7272 6f72 2e0a 0a20 2020 2020 2020  eError...       
-0001f260: 2053 6565 203a 7265 663a 6064 6174 6166   See :ref:`dataf
-0001f270: 7261 6d65 2e69 6e64 6578 696e 6760 2066  rame.indexing` f
-0001f280: 6f72 206d 6f72 652e 0a0a 2020 2020 2020  or more...      
-0001f290: 2020 4578 616d 706c 6573 0a20 2020 2020    Examples.     
-0001f2a0: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
-0001f2b0: 2020 2020 3e3e 3e20 6466 2e69 6c6f 635b      >>> df.iloc[
-0001f2c0: 3a2c 205b 322c 2030 2c20 315d 5d20 2023  :, [2, 0, 1]]  #
-0001f2d0: 2064 6f63 7465 7374 3a20 2b53 4b49 500a   doctest: +SKIP.
-0001f2e0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0001f2f0: 2020 2020 6672 6f6d 2064 6173 6b5f 6578      from dask_ex
-0001f300: 7072 2e5f 696e 6465 7869 6e67 2069 6d70  pr._indexing imp
-0001f310: 6f72 7420 494c 6f63 496e 6465 7865 720a  ort ILocIndexer.
-0001f320: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0001f330: 494c 6f63 496e 6465 7865 7228 7365 6c66  ILocIndexer(self
-0001f340: 290a 0a20 2020 2064 6566 205f 636f 6d70  )..    def _comp
-0001f350: 6172 6973 6f6e 5f6f 7028 7365 6c66 2c20  arison_op(self, 
-0001f360: 6578 7072 5f63 6c73 2c20 6f74 6865 722c  expr_cls, other,
-0001f370: 206c 6576 656c 2c20 6178 6973 293a 0a20   level, axis):. 
-0001f380: 2020 2020 2020 2069 6620 6c65 7665 6c20         if level 
-0001f390: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
-0001f3a0: 2020 2020 2020 2020 2072 6169 7365 204e           raise N
-0001f3b0: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
-0001f3c0: 6f72 2822 6c65 7665 6c20 6d75 7374 2062  or("level must b
-0001f3d0: 6520 4e6f 6e65 2229 0a20 2020 2020 2020  e None").       
-0001f3e0: 2061 7869 7320 3d20 7365 6c66 2e5f 7661   axis = self._va
-0001f3f0: 6c69 6461 7465 5f61 7869 7328 6178 6973  lidate_axis(axis
-0001f400: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-0001f410: 206e 6577 5f63 6f6c 6c65 6374 696f 6e28   new_collection(
-0001f420: 6578 7072 5f63 6c73 2873 656c 662c 206f  expr_cls(self, o
-0001f430: 7468 6572 2c20 6178 6973 2929 0a0a 2020  ther, axis))..  
-0001f440: 2020 6465 6620 6c74 2873 656c 662c 206f    def lt(self, o
-0001f450: 7468 6572 2c20 6c65 7665 6c3d 4e6f 6e65  ther, level=None
-0001f460: 2c20 6178 6973 3d30 293a 0a20 2020 2020  , axis=0):.     
-0001f470: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-0001f480: 636f 6d70 6172 6973 6f6e 5f6f 7028 6578  comparison_op(ex
-0001f490: 7072 2e4c 5446 7261 6d65 2c20 6f74 6865  pr.LTFrame, othe
-0001f4a0: 722c 206c 6576 656c 2c20 6178 6973 290a  r, level, axis).
-0001f4b0: 0a20 2020 2064 6566 206c 6528 7365 6c66  .    def le(self
-0001f4c0: 2c20 6f74 6865 722c 206c 6576 656c 3d4e  , other, level=N
-0001f4d0: 6f6e 652c 2061 7869 733d 3029 3a0a 2020  one, axis=0):.  
-0001f4e0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-0001f4f0: 662e 5f63 6f6d 7061 7269 736f 6e5f 6f70  f._comparison_op
-0001f500: 2865 7870 722e 4c45 4672 616d 652c 206f  (expr.LEFrame, o
-0001f510: 7468 6572 2c20 6c65 7665 6c2c 2061 7869  ther, level, axi
-0001f520: 7329 0a0a 2020 2020 6465 6620 6774 2873  s)..    def gt(s
-0001f530: 656c 662c 206f 7468 6572 2c20 6c65 7665  elf, other, leve
-0001f540: 6c3d 4e6f 6e65 2c20 6178 6973 3d30 293a  l=None, axis=0):
-0001f550: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0001f560: 7365 6c66 2e5f 636f 6d70 6172 6973 6f6e  self._comparison
-0001f570: 5f6f 7028 6578 7072 2e47 5446 7261 6d65  _op(expr.GTFrame
-0001f580: 2c20 6f74 6865 722c 206c 6576 656c 2c20  , other, level, 
-0001f590: 6178 6973 290a 0a20 2020 2064 6566 2067  axis)..    def g
-0001f5a0: 6528 7365 6c66 2c20 6f74 6865 722c 206c  e(self, other, l
-0001f5b0: 6576 656c 3d4e 6f6e 652c 2061 7869 733d  evel=None, axis=
-0001f5c0: 3029 3a0a 2020 2020 2020 2020 7265 7475  0):.        retu
-0001f5d0: 726e 2073 656c 662e 5f63 6f6d 7061 7269  rn self._compari
-0001f5e0: 736f 6e5f 6f70 2865 7870 722e 4745 4672  son_op(expr.GEFr
-0001f5f0: 616d 652c 206f 7468 6572 2c20 6c65 7665  ame, other, leve
-0001f600: 6c2c 2061 7869 7329 0a0a 2020 2020 6465  l, axis)..    de
-0001f610: 6620 6e65 2873 656c 662c 206f 7468 6572  f ne(self, other
-0001f620: 2c20 6c65 7665 6c3d 4e6f 6e65 2c20 6178  , level=None, ax
-0001f630: 6973 3d30 293a 0a20 2020 2020 2020 2072  is=0):.        r
-0001f640: 6574 7572 6e20 7365 6c66 2e5f 636f 6d70  eturn self._comp
-0001f650: 6172 6973 6f6e 5f6f 7028 6578 7072 2e4e  arison_op(expr.N
-0001f660: 4546 7261 6d65 2c20 6f74 6865 722c 206c  EFrame, other, l
-0001f670: 6576 656c 2c20 6178 6973 290a 0a20 2020  evel, axis)..   
-0001f680: 2064 6566 2065 7128 7365 6c66 2c20 6f74   def eq(self, ot
-0001f690: 6865 722c 206c 6576 656c 3d4e 6f6e 652c  her, level=None,
-0001f6a0: 2061 7869 733d 3029 3a0a 2020 2020 2020   axis=0):.      
-0001f6b0: 2020 7265 7475 726e 2073 656c 662e 5f63    return self._c
-0001f6c0: 6f6d 7061 7269 736f 6e5f 6f70 2865 7870  omparison_op(exp
-0001f6d0: 722e 4551 4672 616d 652c 206f 7468 6572  r.EQFrame, other
-0001f6e0: 2c20 6c65 7665 6c2c 2061 7869 7329 0a0a  , level, axis)..
-0001f6f0: 2020 2020 6465 6620 6361 7465 676f 7269      def categori
-0001f700: 7a65 2873 656c 662c 2063 6f6c 756d 6e73  ze(self, columns
-0001f710: 3d4e 6f6e 652c 2069 6e64 6578 3d4e 6f6e  =None, index=Non
-0001f720: 652c 2073 706c 6974 5f65 7665 7279 3d4e  e, split_every=N
-0001f730: 6f6e 652c 202a 2a6b 7761 7267 7329 3a0a  one, **kwargs):.
-0001f740: 2020 2020 2020 2020 2222 2243 6f6e 7665          """Conve
-0001f750: 7274 2063 6f6c 756d 6e73 206f 6620 7468  rt columns of th
-0001f760: 6520 4461 7461 4672 616d 6520 746f 2063  e DataFrame to c
-0001f770: 6174 6567 6f72 7920 6474 7970 652e 0a0a  ategory dtype...
-0001f780: 2020 2020 2020 2020 2e2e 2077 6172 6e69          .. warni
-0001f790: 6e67 3a3a 2054 6869 7320 6d65 7468 6f64  ng:: This method
-0001f7a0: 2065 6167 6572 6c79 2063 6f6d 7075 7465   eagerly compute
-0001f7b0: 7320 7468 6520 6361 7465 676f 7269 6573  s the categories
-0001f7c0: 206f 6620 7468 6520 6368 6f73 656e 2063   of the chosen c
-0001f7d0: 6f6c 756d 6e73 2e0a 0a20 2020 2020 2020  olumns...       
-0001f7e0: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-0001f7f0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
-0001f800: 2020 2020 2020 2063 6f6c 756d 6e73 203a         columns :
-0001f810: 206c 6973 742c 206f 7074 696f 6e61 6c0a   list, optional.
-0001f820: 2020 2020 2020 2020 2020 2020 4120 6c69              A li
-0001f830: 7374 206f 6620 636f 6c75 6d6e 206e 616d  st of column nam
-0001f840: 6573 2074 6f20 636f 6e76 6572 7420 746f  es to convert to
-0001f850: 2063 6174 6567 6f72 6963 616c 732e 2042   categoricals. B
-0001f860: 7920 6465 6661 756c 7420 616e 790a 2020  y default any.  
-0001f870: 2020 2020 2020 2020 2020 636f 6c75 6d6e            column
-0001f880: 2077 6974 6820 616e 206f 626a 6563 7420   with an object 
-0001f890: 6474 7970 6520 6973 2063 6f6e 7665 7274  dtype is convert
-0001f8a0: 6564 2074 6f20 6120 6361 7465 676f 7269  ed to a categori
-0001f8b0: 6361 6c2c 2061 6e64 2061 6e79 0a20 2020  cal, and any.   
-0001f8c0: 2020 2020 2020 2020 2075 6e6b 6e6f 776e           unknown
-0001f8d0: 2063 6174 6567 6f72 6963 616c 7320 6172   categoricals ar
-0001f8e0: 6520 6d61 6465 206b 6e6f 776e 2e0a 2020  e made known..  
-0001f8f0: 2020 2020 2020 696e 6465 7820 3a20 626f        index : bo
-0001f900: 6f6c 2c20 6f70 7469 6f6e 616c 0a20 2020  ol, optional.   
-0001f910: 2020 2020 2020 2020 2057 6865 7468 6572           Whether
-0001f920: 2074 6f20 6361 7465 676f 7269 7a65 2074   to categorize t
-0001f930: 6865 2069 6e64 6578 2e20 4279 2064 6566  he index. By def
-0001f940: 6175 6c74 2c20 6f62 6a65 6374 2069 6e64  ault, object ind
-0001f950: 6963 6573 2061 7265 0a20 2020 2020 2020  ices are.       
-0001f960: 2020 2020 2063 6f6e 7665 7274 6564 2074       converted t
-0001f970: 6f20 6361 7465 676f 7269 6361 6c2c 2061  o categorical, a
-0001f980: 6e64 2075 6e6b 6e6f 776e 2063 6174 6567  nd unknown categ
-0001f990: 6f72 6963 616c 2069 6e64 6963 6573 2061  orical indices a
-0001f9a0: 7265 206d 6164 650a 2020 2020 2020 2020  re made.        
-0001f9b0: 2020 2020 6b6e 6f77 6e2e 2053 6574 2054      known. Set T
-0001f9c0: 7275 6520 746f 2061 6c77 6179 7320 6361  rue to always ca
-0001f9d0: 7465 676f 7269 7a65 2074 6865 2069 6e64  tegorize the ind
-0001f9e0: 6578 2c20 4661 6c73 6520 746f 206e 6576  ex, False to nev
-0001f9f0: 6572 2e0a 2020 2020 2020 2020 7370 6c69  er..        spli
-0001fa00: 745f 6576 6572 7920 3a20 696e 742c 206f  t_every : int, o
-0001fa10: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
-0001fa20: 2020 2020 4772 6f75 7020 7061 7274 6974      Group partit
-0001fa30: 696f 6e73 2069 6e74 6f20 6772 6f75 7073  ions into groups
-0001fa40: 206f 6620 7468 6973 2073 697a 6520 7768   of this size wh
-0001fa50: 696c 6520 7065 7266 6f72 6d69 6e67 2061  ile performing a
-0001fa60: 0a20 2020 2020 2020 2020 2020 2074 7265  .            tre
-0001fa70: 652d 7265 6475 6374 696f 6e2e 2049 6620  e-reduction. If 
-0001fa80: 7365 7420 746f 2046 616c 7365 2c20 6e6f  set to False, no
-0001fa90: 2074 7265 652d 7265 6475 6374 696f 6e20   tree-reduction 
-0001faa0: 7769 6c6c 2062 6520 7573 6564 2e0a 2020  will be used..  
-0001fab0: 2020 2020 2020 6b77 6172 6773 0a20 2020        kwargs.   
-0001fac0: 2020 2020 2020 2020 204b 6579 776f 7264           Keyword
-0001fad0: 2061 7267 756d 656e 7473 2061 7265 2070   arguments are p
-0001fae0: 6173 7365 6420 6f6e 2074 6f20 636f 6d70  assed on to comp
-0001faf0: 7574 652e 0a20 2020 2020 2020 2022 2222  ute..        """
-0001fb00: 0a20 2020 2020 2020 2064 6620 3d20 7365  .        df = se
-0001fb10: 6c66 0a20 2020 2020 2020 206d 6574 6120  lf.        meta 
-0001fb20: 3d20 6466 2e5f 6d65 7461 0a20 2020 2020  = df._meta.     
-0001fb30: 2020 2069 6620 636f 6c75 6d6e 7320 6973     if columns is
-0001fb40: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-0001fb50: 2020 2063 6f6c 756d 6e73 203d 206c 6973     columns = lis
-0001fb60: 7428 6d65 7461 2e73 656c 6563 745f 6474  t(meta.select_dt
-0001fb70: 7970 6573 285b 226f 626a 6563 7422 2c20  ypes(["object", 
-0001fb80: 2273 7472 696e 6722 2c20 2263 6174 6567  "string", "categ
-0001fb90: 6f72 7922 5d29 2e63 6f6c 756d 6e73 290a  ory"]).columns).
-0001fba0: 2020 2020 2020 2020 656c 6966 2069 735f          elif is_
-0001fbb0: 7363 616c 6172 2863 6f6c 756d 6e73 293a  scalar(columns):
-0001fbc0: 0a20 2020 2020 2020 2020 2020 2063 6f6c  .            col
-0001fbd0: 756d 6e73 203d 205b 636f 6c75 6d6e 735d  umns = [columns]
-0001fbe0: 0a0a 2020 2020 2020 2020 2320 4669 6c74  ..        # Filt
-0001fbf0: 6572 206f 7574 206b 6e6f 776e 2063 6174  er out known cat
-0001fc00: 6567 6f72 6963 616c 2063 6f6c 756d 6e73  egorical columns
-0001fc10: 0a20 2020 2020 2020 2063 6f6c 756d 6e73  .        columns
-0001fc20: 203d 205b 0a20 2020 2020 2020 2020 2020   = [.           
-0001fc30: 2063 0a20 2020 2020 2020 2020 2020 2066   c.            f
-0001fc40: 6f72 2063 2069 6e20 636f 6c75 6d6e 730a  or c in columns.
-0001fc50: 2020 2020 2020 2020 2020 2020 6966 206e              if n
-0001fc60: 6f74 2028 6973 5f63 6174 6567 6f72 6963  ot (is_categoric
-0001fc70: 616c 5f64 7479 7065 286d 6574 615b 635d  al_dtype(meta[c]
-0001fc80: 2920 616e 6420 6861 735f 6b6e 6f77 6e5f  ) and has_known_
-0001fc90: 6361 7465 676f 7269 6573 286d 6574 615b  categories(meta[
-0001fca0: 635d 2929 0a20 2020 2020 2020 205d 0a0a  c])).        ]..
-0001fcb0: 2020 2020 2020 2020 6966 2069 6e64 6578          if index
-0001fcc0: 2069 7320 6e6f 7420 4661 6c73 653a 0a20   is not False:. 
-0001fcd0: 2020 2020 2020 2020 2020 2069 6620 6973             if is
-0001fce0: 5f63 6174 6567 6f72 6963 616c 5f64 7479  _categorical_dty
-0001fcf0: 7065 286d 6574 612e 696e 6465 7829 3a0a  pe(meta.index):.
-0001fd00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fd10: 696e 6465 7820 3d20 6e6f 7420 6861 735f  index = not has_
-0001fd20: 6b6e 6f77 6e5f 6361 7465 676f 7269 6573  known_categories
-0001fd30: 286d 6574 612e 696e 6465 7829 0a20 2020  (meta.index).   
-0001fd40: 2020 2020 2020 2020 2065 6c69 6620 696e           elif in
-0001fd50: 6465 7820 6973 204e 6f6e 653a 0a20 2020  dex is None:.   
-0001fd60: 2020 2020 2020 2020 2020 2020 2069 6e64               ind
-0001fd70: 6578 203d 2073 7472 286d 6574 612e 696e  ex = str(meta.in
-0001fd80: 6465 782e 6474 7970 6529 2069 6e20 2822  dex.dtype) in ("
-0001fd90: 6f62 6a65 6374 222c 2022 7374 7269 6e67  object", "string
-0001fda0: 2229 0a0a 2020 2020 2020 2020 2320 4e6f  ")..        # No
-0001fdb0: 7468 696e 6720 746f 2064 6f0a 2020 2020  thing to do.    
-0001fdc0: 2020 2020 6966 206e 6f74 206c 656e 2863      if not len(c
-0001fdd0: 6f6c 756d 6e73 2920 616e 6420 696e 6465  olumns) and inde
-0001fde0: 7820 6973 2046 616c 7365 3a0a 2020 2020  x is False:.    
-0001fdf0: 2020 2020 2020 2020 7265 7475 726e 2064          return d
-0001fe00: 660a 0a20 2020 2020 2020 2066 726f 6d20  f..        from 
-0001fe10: 6461 736b 5f65 7870 722e 5f63 6f6c 6c65  dask_expr._colle
-0001fe20: 6374 696f 6e20 696d 706f 7274 206e 6577  ction import new
-0001fe30: 5f63 6f6c 6c65 6374 696f 6e0a 0a20 2020  _collection..   
-0001fe40: 2020 2020 2023 2045 6167 6572 6c79 2063       # Eagerly c
-0001fe50: 6f6d 7075 7465 2074 6865 2063 6174 6567  ompute the categ
-0001fe60: 6f72 6965 730a 2020 2020 2020 2020 6361  ories.        ca
-0001fe70: 7465 676f 7269 6573 2c20 696e 6465 7820  tegories, index 
-0001fe80: 3d20 6e65 775f 636f 6c6c 6563 7469 6f6e  = new_collection
-0001fe90: 280a 2020 2020 2020 2020 2020 2020 4765  (.            Ge
-0001fea0: 7443 6174 6567 6f72 6965 7328 7365 6c66  tCategories(self
-0001feb0: 2c20 636f 6c75 6d6e 733d 636f 6c75 6d6e  , columns=column
-0001fec0: 732c 2069 6e64 6578 3d69 6e64 6578 2c20  s, index=index, 
-0001fed0: 7370 6c69 745f 6576 6572 793d 7370 6c69  split_every=spli
-0001fee0: 745f 6576 6572 7929 0a20 2020 2020 2020  t_every).       
-0001fef0: 2029 2e63 6f6d 7075 7465 2829 0a0a 2020   ).compute()..  
-0001ff00: 2020 2020 2020 2320 536f 6d65 206f 7065        # Some ope
-0001ff10: 7261 7469 6f6e 7320 6c69 6b65 2067 6574  rations like get
-0001ff20: 5f64 756d 6d69 6573 2829 2072 656c 7920  _dummies() rely 
-0001ff30: 6f6e 2074 6865 206f 7264 6572 206f 6620  on the order of 
-0001ff40: 6361 7465 676f 7269 6573 0a20 2020 2020  categories.     
-0001ff50: 2020 2063 6174 6567 6f72 6965 7320 3d20     categories = 
-0001ff60: 7b6b 3a20 762e 736f 7274 5f76 616c 7565  {k: v.sort_value
-0001ff70: 7328 2920 666f 7220 6b2c 2076 2069 6e20  s() for k, v in 
-0001ff80: 6361 7465 676f 7269 6573 2e69 7465 6d73  categories.items
-0001ff90: 2829 7d0a 0a20 2020 2020 2020 2023 2043  ()}..        # C
-0001ffa0: 6174 6567 6f72 697a 6520 6561 6368 2070  ategorize each p
-0001ffb0: 6172 7469 7469 6f6e 0a20 2020 2020 2020  artition.       
-0001ffc0: 2072 6574 7572 6e20 6e65 775f 636f 6c6c   return new_coll
-0001ffd0: 6563 7469 6f6e 2843 6174 6567 6f72 697a  ection(Categoriz
-0001ffe0: 6528 7365 6c66 2c20 6361 7465 676f 7269  e(self, categori
-0001fff0: 6573 2c20 696e 6465 7829 290a 0a20 2020  es, index))..   
-00020000: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
-00020010: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
-00020020: 2064 6566 206e 756e 6971 7565 2873 656c   def nunique(sel
-00020030: 662c 2061 7869 733d 302c 2064 726f 706e  f, axis=0, dropn
-00020040: 613d 5472 7565 2c20 7370 6c69 745f 6576  a=True, split_ev
-00020050: 6572 793d 4661 6c73 6529 3a0a 2020 2020  ery=False):.    
-00020060: 2020 2020 6966 2061 7869 7320 3d3d 2031      if axis == 1
-00020070: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-00020080: 7475 726e 206e 6577 5f63 6f6c 6c65 6374  turn new_collect
-00020090: 696f 6e28 6578 7072 2e4e 556e 6971 7565  ion(expr.NUnique
-000200a0: 436f 6c75 6d6e 7328 7365 6c66 2c20 6178  Columns(self, ax
-000200b0: 6973 3d61 7869 732c 2064 726f 706e 613d  is=axis, dropna=
-000200c0: 6472 6f70 6e61 2929 0a20 2020 2020 2020  dropna)).       
-000200d0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-000200e0: 2020 2072 6574 7572 6e20 636f 6e63 6174     return concat
-000200f0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00020100: 2020 5b0a 2020 2020 2020 2020 2020 2020    [.            
-00020110: 2020 2020 2020 2020 636f 6c2e 6e75 6e69          col.nuni
-00020120: 7175 6528 6472 6f70 6e61 3d64 726f 706e  que(dropna=dropn
-00020130: 612c 2073 706c 6974 5f65 7665 7279 3d73  a, split_every=s
-00020140: 706c 6974 5f65 7665 7279 292e 746f 5f73  plit_every).to_s
-00020150: 6572 6965 7328 6e61 6d65 290a 2020 2020  eries(name).    
-00020160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020170: 666f 7220 6e61 6d65 2c20 636f 6c20 696e  for name, col in
-00020180: 2073 656c 662e 6974 656d 7328 290a 2020   self.items().  
-00020190: 2020 2020 2020 2020 2020 2020 2020 5d0a                ].
-000201a0: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-000201b0: 2020 2064 6566 2071 7561 6e74 696c 6528     def quantile(
-000201c0: 7365 6c66 2c20 713d 302e 352c 2061 7869  self, q=0.5, axi
-000201d0: 733d 302c 206e 756d 6572 6963 5f6f 6e6c  s=0, numeric_onl
-000201e0: 793d 4661 6c73 652c 206d 6574 686f 643d  y=False, method=
-000201f0: 2264 6566 6175 6c74 2229 3a0a 2020 2020  "default"):.    
-00020200: 2020 2020 2222 2241 7070 726f 7869 6d61      """Approxima
-00020210: 7465 2072 6f77 2d77 6973 6520 616e 6420  te row-wise and 
-00020220: 7072 6563 6973 6520 636f 6c75 6d6e 2d77  precise column-w
-00020230: 6973 6520 7175 616e 7469 6c65 7320 6f66  ise quantiles of
-00020240: 2044 6174 6146 7261 6d65 0a0a 2020 2020   DataFrame..    
-00020250: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
-00020260: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-00020270: 2d0a 2020 2020 2020 2020 7120 3a20 6c69  -.        q : li
-00020280: 7374 2f61 7272 6179 206f 6620 666c 6f61  st/array of floa
-00020290: 7473 2c20 6465 6661 756c 7420 302e 3520  ts, default 0.5 
-000202a0: 2835 3025 290a 2020 2020 2020 2020 2020  (50%).          
-000202b0: 2020 4974 6572 6162 6c65 206f 6620 6e75    Iterable of nu
-000202c0: 6d62 6572 7320 7261 6e67 696e 6720 6672  mbers ranging fr
-000202d0: 6f6d 2030 2074 6f20 3120 666f 7220 7468  om 0 to 1 for th
-000202e0: 6520 6465 7369 7265 6420 7175 616e 7469  e desired quanti
-000202f0: 6c65 730a 2020 2020 2020 2020 6178 6973  les.        axis
-00020300: 203a 207b 302c 2031 2c20 2769 6e64 6578   : {0, 1, 'index
-00020310: 272c 2027 636f 6c75 6d6e 7327 7d20 2864  ', 'columns'} (d
-00020320: 6566 6175 6c74 2030 290a 2020 2020 2020  efault 0).      
-00020330: 2020 2020 2020 3020 6f72 2027 696e 6465        0 or 'inde
-00020340: 7827 2066 6f72 2072 6f77 2d77 6973 652c  x' for row-wise,
-00020350: 2031 206f 7220 2763 6f6c 756d 6e73 2720   1 or 'columns' 
-00020360: 666f 7220 636f 6c75 6d6e 2d77 6973 650a  for column-wise.
-00020370: 2020 2020 2020 2020 6d65 7468 6f64 203a          method :
-00020380: 207b 2764 6566 6175 6c74 272c 2027 7464   {'default', 'td
-00020390: 6967 6573 7427 2c20 2764 6173 6b27 7d2c  igest', 'dask'},
-000203a0: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-000203b0: 2020 2020 2020 5768 6174 206d 6574 686f        What metho
-000203c0: 6420 746f 2075 7365 2e20 4279 2064 6566  d to use. By def
-000203d0: 6175 6c74 2077 696c 6c20 7573 6520 6461  ault will use da
-000203e0: 736b 2773 2069 6e74 6572 6e61 6c20 6375  sk's internal cu
-000203f0: 7374 6f6d 0a20 2020 2020 2020 2020 2020  stom.           
-00020400: 2061 6c67 6f72 6974 686d 2028 6060 2764   algorithm (``'d
-00020410: 6173 6b27 6060 292e 2020 4966 2073 6574  ask'``).  If set
-00020420: 2074 6f20 6060 2774 6469 6765 7374 2760   to ``'tdigest'`
-00020430: 6020 7769 6c6c 2075 7365 2074 6469 6765  ` will use tdige
-00020440: 7374 0a20 2020 2020 2020 2020 2020 2066  st.            f
-00020450: 6f72 2066 6c6f 6174 7320 616e 6420 696e  or floats and in
-00020460: 7473 2061 6e64 2066 616c 6c62 6163 6b20  ts and fallback 
-00020470: 746f 2074 6865 2060 6027 6461 736b 2760  to the ``'dask'`
-00020480: 6020 6f74 6865 7277 6973 652e 0a20 2020  ` otherwise..   
-00020490: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-000204a0: 2061 6c6c 6f77 6564 5f6d 6574 686f 6473   allowed_methods
-000204b0: 203d 205b 2264 6566 6175 6c74 222c 2022   = ["default", "
-000204c0: 6461 736b 222c 2022 7464 6967 6573 7422  dask", "tdigest"
-000204d0: 5d0a 2020 2020 2020 2020 6966 206d 6574  ].        if met
-000204e0: 686f 6420 6e6f 7420 696e 2061 6c6c 6f77  hod not in allow
-000204f0: 6564 5f6d 6574 686f 6473 3a0a 2020 2020  ed_methods:.    
-00020500: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-00020510: 6c75 6545 7272 6f72 2822 6d65 7468 6f64  lueError("method
-00020520: 2063 616e 206f 6e6c 7920 6265 2027 6465   can only be 'de
-00020530: 6661 756c 7427 2c20 2764 6173 6b27 206f  fault', 'dask' o
-00020540: 7220 2774 6469 6765 7374 2722 290a 2020  r 'tdigest'").  
-00020550: 2020 2020 2020 6d65 7461 203d 206d 616b        meta = mak
-00020560: 655f 6d65 7461 280a 2020 2020 2020 2020  e_meta(.        
-00020570: 2020 2020 6d65 7461 5f6e 6f6e 656d 7074      meta_nonempt
-00020580: 7928 7365 6c66 2e5f 6d65 7461 292e 7175  y(self._meta).qu
-00020590: 616e 7469 6c65 280a 2020 2020 2020 2020  antile(.        
-000205a0: 2020 2020 2020 2020 713d 712c 206e 756d          q=q, num
-000205b0: 6572 6963 5f6f 6e6c 793d 6e75 6d65 7269  eric_only=numeri
-000205c0: 635f 6f6e 6c79 2c20 6178 6973 3d61 7869  c_only, axis=axi
-000205d0: 730a 2020 2020 2020 2020 2020 2020 290a  s.            ).
-000205e0: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-000205f0: 2020 2069 6620 6178 6973 203d 3d20 313a     if axis == 1:
-00020600: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00020610: 6973 696e 7374 616e 6365 2871 2c20 6c69  isinstance(q, li
-00020620: 7374 293a 0a20 2020 2020 2020 2020 2020  st):.           
-00020630: 2020 2020 2023 204e 6f74 2073 7570 706f       # Not suppo
-00020640: 7274 6564 2c20 7468 6520 7265 7375 6c74  rted, the result
-00020650: 2077 696c 6c20 6861 7665 2063 7572 7265   will have curre
-00020660: 6e74 2069 6e64 6578 2061 7320 636f 6c75  nt index as colu
-00020670: 6d6e 730a 2020 2020 2020 2020 2020 2020  mns.            
-00020680: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-00020690: 7272 6f72 2822 2771 2720 6d75 7374 2062  rror("'q' must b
-000206a0: 6520 7363 616c 6172 2077 6865 6e20 6178  e scalar when ax
-000206b0: 6973 3d31 2069 7320 7370 6563 6966 6965  is=1 is specifie
-000206c0: 6422 290a 0a20 2020 2020 2020 2020 2020  d")..           
-000206d0: 2072 6574 7572 6e20 7365 6c66 2e6d 6170   return self.map
-000206e0: 5f70 6172 7469 7469 6f6e 7328 0a20 2020  _partitions(.   
-000206f0: 2020 2020 2020 2020 2020 2020 204d 2e71               M.q
-00020700: 7561 6e74 696c 652c 0a20 2020 2020 2020  uantile,.       
-00020710: 2020 2020 2020 2020 2071 2c0a 2020 2020           q,.    
-00020720: 2020 2020 2020 2020 2020 2020 6178 6973              axis
-00020730: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00020740: 2020 656e 666f 7263 655f 6d65 7461 6461    enforce_metada
-00020750: 7461 3d46 616c 7365 2c0a 2020 2020 2020  ta=False,.      
-00020760: 2020 2020 2020 2020 2020 6d65 7461 3d6d            meta=m
-00020770: 6574 612c 0a20 2020 2020 2020 2020 2020  eta,.           
-00020780: 2020 2020 206e 756d 6572 6963 5f6f 6e6c       numeric_onl
-00020790: 793d 6e75 6d65 7269 635f 6f6e 6c79 2c0a  y=numeric_only,.
-000207a0: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-000207b0: 2020 2020 2020 2069 6620 6e75 6d65 7269         if numeri
-000207c0: 635f 6f6e 6c79 3a0a 2020 2020 2020 2020  c_only:.        
-000207d0: 2020 2020 6672 616d 6520 3d20 7365 6c66      frame = self
-000207e0: 2e73 656c 6563 745f 6474 7970 6573 280a  .select_dtypes(.
-000207f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020800: 226e 756d 6265 7222 2c20 6578 636c 7564  "number", exclud
-00020810: 653d 5b6e 702e 7469 6d65 6465 6c74 6136  e=[np.timedelta6
-00020820: 342c 206e 702e 6461 7465 7469 6d65 3634  4, np.datetime64
-00020830: 5d0a 2020 2020 2020 2020 2020 2020 290a  ].            ).
-00020840: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00020850: 2020 2020 2020 2020 2020 6672 616d 6520            frame 
-00020860: 3d20 7365 6c66 0a0a 2020 2020 2020 2020  = self..        
-00020870: 636f 6c6c 6563 7469 6f6e 7320 3d20 5b5d  collections = []
-00020880: 0a20 2020 2020 2020 2066 6f72 205f 2c20  .        for _, 
-00020890: 636f 6c20 696e 2066 7261 6d65 2e69 7465  col in frame.ite
-000208a0: 6d73 2829 3a0a 2020 2020 2020 2020 2020  ms():.          
-000208b0: 2020 636f 6c6c 6563 7469 6f6e 732e 6170    collections.ap
-000208c0: 7065 6e64 2863 6f6c 2e71 7561 6e74 696c  pend(col.quantil
-000208d0: 6528 713d 712c 206d 6574 686f 643d 6d65  e(q=q, method=me
-000208e0: 7468 6f64 2929 0a0a 2020 2020 2020 2020  thod))..        
-000208f0: 6966 206c 656e 2863 6f6c 6c65 6374 696f  if len(collectio
-00020900: 6e73 2920 3e20 3020 616e 6420 6973 696e  ns) > 0 and isin
-00020910: 7374 616e 6365 2863 6f6c 6c65 6374 696f  stance(collectio
-00020920: 6e73 5b30 5d2c 2053 6361 6c61 7229 3a0a  ns[0], Scalar):.
-00020930: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00020940: 726e 205f 6672 6f6d 5f73 6361 6c61 7273  rn _from_scalars
-00020950: 2863 6f6c 6c65 6374 696f 6e73 2c20 6d65  (collections, me
-00020960: 7461 2c20 6672 616d 652e 6578 7072 2e63  ta, frame.expr.c
-00020970: 6f6c 756d 6e73 290a 0a20 2020 2020 2020  olumns)..       
-00020980: 2072 6574 7572 6e20 636f 6e63 6174 2863   return concat(c
-00020990: 6f6c 6c65 6374 696f 6e73 2c20 6178 6973  ollections, axis
-000209a0: 3d31 290a 0a20 2020 2040 6465 7269 7665  =1)..    @derive
-000209b0: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
-000209c0: 616d 6529 0a20 2020 2064 6566 206d 6564  ame).    def med
-000209d0: 6961 6e28 7365 6c66 2c20 6178 6973 3d30  ian(self, axis=0
-000209e0: 2c20 6e75 6d65 7269 635f 6f6e 6c79 3d46  , numeric_only=F
-000209f0: 616c 7365 293a 0a20 2020 2020 2020 2069  alse):.        i
-00020a00: 6620 6178 6973 203d 3d20 3120 6f72 2073  f axis == 1 or s
-00020a10: 656c 662e 6e70 6172 7469 7469 6f6e 7320  elf.npartitions 
-00020a20: 3d3d 2031 3a0a 2020 2020 2020 2020 2020  == 1:.          
-00020a30: 2020 7265 7475 726e 2073 656c 662e 6d65    return self.me
-00020a40: 6469 616e 5f61 7070 726f 7869 6d61 7465  dian_approximate
-00020a50: 2861 7869 733d 6178 6973 2c20 6e75 6d65  (axis=axis, nume
-00020a60: 7269 635f 6f6e 6c79 3d6e 756d 6572 6963  ric_only=numeric
-00020a70: 5f6f 6e6c 7929 0a20 2020 2020 2020 2072  _only).        r
-00020a80: 6169 7365 204e 6f74 496d 706c 656d 656e  aise NotImplemen
-00020a90: 7465 6445 7272 6f72 280a 2020 2020 2020  tedError(.      
-00020aa0: 2020 2020 2020 2244 6173 6b20 646f 6573        "Dask does
-00020ab0: 6e27 7420 696d 706c 656d 656e 7420 616e  n't implement an
-00020ac0: 2065 7861 6374 206d 6564 6961 6e20 696e   exact median in
-00020ad0: 2061 6c6c 2063 6173 6573 2061 7320 7468   all cases as th
-00020ae0: 6973 2069 7320 6861 7264 2074 6f20 646f  is is hard to do
-00020af0: 2069 6e20 7061 7261 6c6c 656c 2e20 220a   in parallel. ".
-00020b00: 2020 2020 2020 2020 2020 2020 2253 6565              "See
-00020b10: 2074 6865 2060 6d65 6469 616e 5f61 7070   the `median_app
-00020b20: 726f 7869 6d61 7465 6020 6d65 7468 6f64  roximate` method
-00020b30: 2069 6e73 7465 6164 2c20 7768 6963 6820   instead, which 
-00020b40: 7573 6573 2061 6e20 6170 7072 6f78 696d  uses an approxim
-00020b50: 6174 6520 616c 676f 7269 7468 6d2e 220a  ate algorithm.".
-00020b60: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
-00020b70: 6566 206d 6564 6961 6e5f 6170 7072 6f78  ef median_approx
-00020b80: 696d 6174 6528 7365 6c66 2c20 6178 6973  imate(self, axis
-00020b90: 3d30 2c20 6d65 7468 6f64 3d22 6465 6661  =0, method="defa
-00020ba0: 756c 7422 2c20 6e75 6d65 7269 635f 6f6e  ult", numeric_on
-00020bb0: 6c79 3d46 616c 7365 293a 0a20 2020 2020  ly=False):.     
-00020bc0: 2020 2022 2222 5265 7475 726e 2074 6865     """Return the
-00020bd0: 2061 7070 726f 7869 6d61 7465 206d 6564   approximate med
-00020be0: 6961 6e20 6f66 2074 6865 2076 616c 7565  ian of the value
-00020bf0: 7320 6f76 6572 2074 6865 2072 6571 7565  s over the reque
-00020c00: 7374 6564 2061 7869 732e 0a0a 2020 2020  sted axis...    
-00020c10: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
-00020c20: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-00020c30: 2d0a 2020 2020 2020 2020 6178 6973 203a  -.        axis :
-00020c40: 207b 302c 2031 2c20 2269 6e64 6578 222c   {0, 1, "index",
-00020c50: 2022 636f 6c75 6d6e 7322 7d20 2864 6566   "columns"} (def
-00020c60: 6175 6c74 2030 290a 2020 2020 2020 2020  ault 0).        
-00020c70: 2020 2020 3020 6f72 2060 6022 696e 6465      0 or ``"inde
-00020c80: 7822 6060 2066 6f72 2072 6f77 2d77 6973  x"`` for row-wis
-00020c90: 652c 2031 206f 7220 6060 2263 6f6c 756d  e, 1 or ``"colum
-00020ca0: 6e73 2260 6020 666f 7220 636f 6c75 6d6e  ns"`` for column
-00020cb0: 2d77 6973 650a 2020 2020 2020 2020 6d65  -wise.        me
-00020cc0: 7468 6f64 203a 207b 2764 6566 6175 6c74  thod : {'default
-00020cd0: 272c 2027 7464 6967 6573 7427 2c20 2764  ', 'tdigest', 'd
-00020ce0: 6173 6b27 7d2c 206f 7074 696f 6e61 6c0a  ask'}, optional.
-00020cf0: 2020 2020 2020 2020 2020 2020 5768 6174              What
-00020d00: 206d 6574 686f 6420 746f 2075 7365 2e20   method to use. 
-00020d10: 4279 2064 6566 6175 6c74 2077 696c 6c20  By default will 
-00020d20: 7573 6520 4461 736b 2773 2069 6e74 6572  use Dask's inter
-00020d30: 6e61 6c20 6375 7374 6f6d 0a20 2020 2020  nal custom.     
-00020d40: 2020 2020 2020 2061 6c67 6f72 6974 686d         algorithm
-00020d50: 2028 6060 2264 6173 6b22 6060 292e 2020   (``"dask"``).  
-00020d60: 4966 2073 6574 2074 6f20 6060 2274 6469  If set to ``"tdi
-00020d70: 6765 7374 2260 6020 7769 6c6c 2075 7365  gest"`` will use
-00020d80: 2074 6469 6765 7374 0a20 2020 2020 2020   tdigest.       
-00020d90: 2020 2020 2066 6f72 2066 6c6f 6174 7320       for floats 
-00020da0: 616e 6420 696e 7473 2061 6e64 2066 616c  and ints and fal
-00020db0: 6c62 6163 6b20 746f 2074 6865 2060 6022  lback to the ``"
-00020dc0: 6461 736b 2260 6020 6f74 6865 7277 6973  dask"`` otherwis
-00020dd0: 652e 0a20 2020 2020 2020 2022 2222 0a20  e..        """. 
-00020de0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00020df0: 6c66 2e71 7561 6e74 696c 6528 0a20 2020  lf.quantile(.   
-00020e00: 2020 2020 2020 2020 2061 7869 733d 6178           axis=ax
-00020e10: 6973 2c20 6d65 7468 6f64 3d6d 6574 686f  is, method=metho
-00020e20: 642c 206e 756d 6572 6963 5f6f 6e6c 793d  d, numeric_only=
-00020e30: 6e75 6d65 7269 635f 6f6e 6c79 0a20 2020  numeric_only.   
-00020e40: 2020 2020 2029 2e72 656e 616d 6528 4e6f       ).rename(No
-00020e50: 6e65 290a 0a20 2020 2040 6465 7269 7665  ne)..    @derive
-00020e60: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
-00020e70: 616d 6529 0a20 2020 2064 6566 2064 6573  ame).    def des
-00020e80: 6372 6962 6528 0a20 2020 2020 2020 2073  cribe(.        s
-00020e90: 656c 662c 0a20 2020 2020 2020 2073 706c  elf,.        spl
-00020ea0: 6974 5f65 7665 7279 3d46 616c 7365 2c0a  it_every=False,.
-00020eb0: 2020 2020 2020 2020 7065 7263 656e 7469          percenti
-00020ec0: 6c65 733d 4e6f 6e65 2c0a 2020 2020 2020  les=None,.      
-00020ed0: 2020 7065 7263 656e 7469 6c65 735f 6d65    percentiles_me
-00020ee0: 7468 6f64 3d22 6465 6661 756c 7422 2c0a  thod="default",.
-00020ef0: 2020 2020 2020 2020 696e 636c 7564 653d          include=
-00020f00: 4e6f 6e65 2c0a 2020 2020 2020 2020 6578  None,.        ex
-00020f10: 636c 7564 653d 4e6f 6e65 2c0a 2020 2020  clude=None,.    
-00020f20: 293a 0a20 2020 2020 2020 2023 2054 4f44  ):.        # TOD
-00020f30: 4f3a 2064 7570 6c69 6361 7465 6420 636f  O: duplicated co
-00020f40: 6c75 6d6e 730a 2020 2020 2020 2020 6966  lumns.        if
-00020f50: 2069 6e63 6c75 6465 2069 7320 4e6f 6e65   include is None
-00020f60: 2061 6e64 2065 7863 6c75 6465 2069 7320   and exclude is 
-00020f70: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-00020f80: 2020 5f69 6e63 6c75 6465 203d 205b 6e70    _include = [np
-00020f90: 2e6e 756d 6265 722c 206e 702e 7469 6d65  .number, np.time
-00020fa0: 6465 6c74 6136 342c 206e 702e 6461 7465  delta64, np.date
-00020fb0: 7469 6d65 3634 5d0a 2020 2020 2020 2020  time64].        
-00020fc0: 2020 2020 636f 6c75 6d6e 7320 3d20 7365      columns = se
-00020fd0: 6c66 2e5f 6d65 7461 2e73 656c 6563 745f  lf._meta.select_
-00020fe0: 6474 7970 6573 2869 6e63 6c75 6465 3d5f  dtypes(include=_
-00020ff0: 696e 636c 7564 6529 2e63 6f6c 756d 6e73  include).columns
-00021000: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00021010: 6c65 6e28 636f 6c75 6d6e 7329 203d 3d20  len(columns) == 
-00021020: 303a 0a20 2020 2020 2020 2020 2020 2020  0:.             
-00021030: 2020 2063 6f6c 756d 6e73 203d 2073 656c     columns = sel
-00021040: 662e 5f6d 6574 612e 636f 6c75 6d6e 730a  f._meta.columns.
-00021050: 2020 2020 2020 2020 656c 6966 2069 6e63          elif inc
-00021060: 6c75 6465 203d 3d20 2261 6c6c 223a 0a20  lude == "all":. 
-00021070: 2020 2020 2020 2020 2020 2069 6620 6578             if ex
-00021080: 636c 7564 6520 6973 206e 6f74 204e 6f6e  clude is not Non
-00021090: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-000210a0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-000210b0: 726f 7228 2265 7863 6c75 6465 206d 7573  ror("exclude mus
-000210c0: 7420 6265 204e 6f6e 6520 7768 656e 2069  t be None when i
-000210d0: 6e63 6c75 6465 2069 7320 2761 6c6c 2722  nclude is 'all'"
-000210e0: 290a 2020 2020 2020 2020 2020 2020 636f  ).            co
-000210f0: 6c75 6d6e 7320 3d20 7365 6c66 2e5f 6d65  lumns = self._me
-00021100: 7461 2e63 6f6c 756d 6e73 0a20 2020 2020  ta.columns.     
-00021110: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00021120: 2020 2020 2063 6f6c 756d 6e73 203d 2073       columns = s
-00021130: 656c 662e 5f6d 6574 612e 7365 6c65 6374  elf._meta.select
-00021140: 5f64 7479 7065 7328 696e 636c 7564 653d  _dtypes(include=
-00021150: 696e 636c 7564 652c 2065 7863 6c75 6465  include, exclude
-00021160: 3d65 7863 6c75 6465 292e 636f 6c75 6d6e  =exclude).column
-00021170: 730a 0a20 2020 2020 2020 2073 7461 7473  s..        stats
-00021180: 203d 205b 0a20 2020 2020 2020 2020 2020   = [.           
-00021190: 2073 656c 665b 636f 6c5d 2e64 6573 6372   self[col].descr
-000211a0: 6962 6528 0a20 2020 2020 2020 2020 2020  ibe(.           
-000211b0: 2020 2020 2073 706c 6974 5f65 7665 7279       split_every
-000211c0: 3d73 706c 6974 5f65 7665 7279 2c0a 2020  =split_every,.  
-000211d0: 2020 2020 2020 2020 2020 2020 2020 7065                pe
-000211e0: 7263 656e 7469 6c65 733d 7065 7263 656e  rcentiles=percen
-000211f0: 7469 6c65 732c 0a20 2020 2020 2020 2020  tiles,.         
-00021200: 2020 2020 2020 2070 6572 6365 6e74 696c         percentil
-00021210: 6573 5f6d 6574 686f 643d 7065 7263 656e  es_method=percen
-00021220: 7469 6c65 735f 6d65 7468 6f64 2c0a 2020  tiles_method,.  
-00021230: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00021240: 2020 2020 2020 2020 666f 7220 636f 6c20          for col 
-00021250: 696e 2063 6f6c 756d 6e73 0a20 2020 2020  in columns.     
-00021260: 2020 205d 0a20 2020 2020 2020 2072 6574     ].        ret
-00021270: 7572 6e20 636f 6e63 6174 2873 7461 7473  urn concat(stats
-00021280: 2c20 6178 6973 3d31 290a 0a20 2020 2040  , axis=1)..    @
-00021290: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
-000212a0: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
-000212b0: 6566 2070 6f70 2873 656c 662c 2069 7465  ef pop(self, ite
-000212c0: 6d29 3a0a 2020 2020 2020 2020 6f75 7420  m):.        out 
-000212d0: 3d20 7365 6c66 5b69 7465 6d5d 0a20 2020  = self[item].   
-000212e0: 2020 2020 2073 656c 662e 5f65 7870 7220       self._expr 
-000212f0: 3d20 6578 7072 2e44 726f 7028 7365 6c66  = expr.Drop(self
-00021300: 2c20 636f 6c75 6d6e 733d 5b69 7465 6d5d  , columns=[item]
-00021310: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-00021320: 206f 7574 0a0a 2020 2020 6465 6620 696e   out..    def in
-00021330: 666f 2873 656c 662c 2062 7566 3d4e 6f6e  fo(self, buf=Non
-00021340: 652c 2076 6572 626f 7365 3d46 616c 7365  e, verbose=False
-00021350: 2c20 6d65 6d6f 7279 5f75 7361 6765 3d46  , memory_usage=F
-00021360: 616c 7365 293a 0a20 2020 2020 2020 2022  alse):.        "
-00021370: 2222 0a20 2020 2020 2020 2043 6f6e 6369  "".        Conci
-00021380: 7365 2073 756d 6d61 7279 206f 6620 6120  se summary of a 
-00021390: 4461 736b 2044 6174 6146 7261 6d65 0a20  Dask DataFrame. 
-000213a0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-000213b0: 2020 2069 6620 6275 6620 6973 204e 6f6e     if buf is Non
-000213c0: 653a 0a20 2020 2020 2020 2020 2020 2069  e:.            i
-000213d0: 6d70 6f72 7420 7379 730a 0a20 2020 2020  mport sys..     
-000213e0: 2020 2020 2020 2062 7566 203d 2073 7973         buf = sys
-000213f0: 2e73 7464 6f75 740a 2020 2020 2020 2020  .stdout.        
-00021400: 6c69 6e65 7320 3d20 5b73 7472 2874 7970  lines = [str(typ
-00021410: 6528 7365 6c66 2929 2e72 6570 6c61 6365  e(self)).replace
-00021420: 2822 2e5f 636f 6c6c 6563 7469 6f6e 222c  ("._collection",
-00021430: 2022 2229 5d0a 0a20 2020 2020 2020 2069   "")]..        i
-00021440: 6620 6c65 6e28 7365 6c66 2e63 6f6c 756d  f len(self.colum
-00021450: 6e73 2920 3d3d 2030 3a0a 2020 2020 2020  ns) == 0:.      
-00021460: 2020 2020 2020 6c69 6e65 732e 6170 7065        lines.appe
-00021470: 6e64 2866 227b 7479 7065 2873 656c 662e  nd(f"{type(self.
-00021480: 696e 6465 782e 5f6d 6574 6129 2e5f 5f6e  index._meta).__n
-00021490: 616d 655f 5f7d 3a20 3020 656e 7472 6965  ame__}: 0 entrie
-000214a0: 7322 290a 2020 2020 2020 2020 2020 2020  s").            
-000214b0: 6c69 6e65 732e 6170 7065 6e64 2866 2245  lines.append(f"E
-000214c0: 6d70 7479 207b 7479 7065 2873 656c 6629  mpty {type(self)
-000214d0: 2e5f 5f6e 616d 655f 5f7d 2229 0a20 2020  .__name__}").   
-000214e0: 2020 2020 2020 2020 2070 7574 5f6c 696e           put_lin
-000214f0: 6573 2862 7566 2c20 6c69 6e65 7329 0a20  es(buf, lines). 
-00021500: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00021510: 6e0a 0a20 2020 2020 2020 2023 2047 726f  n..        # Gro
-00021520: 7570 2061 6e64 2065 7865 6375 7465 2074  up and execute t
-00021530: 6865 2072 6571 7569 7265 6420 636f 6d70  he required comp
-00021540: 7574 6174 696f 6e73 0a20 2020 2020 2020  utations.       
-00021550: 2063 6f6d 7075 7461 7469 6f6e 7320 3d20   computations = 
-00021560: 7b7d 0a20 2020 2020 2020 2069 6620 7665  {}.        if ve
-00021570: 7262 6f73 653a 0a20 2020 2020 2020 2020  rbose:.         
-00021580: 2020 2063 6f6d 7075 7461 7469 6f6e 732e     computations.
-00021590: 7570 6461 7465 287b 2269 6e64 6578 223a  update({"index":
-000215a0: 2073 656c 662e 696e 6465 782c 2022 636f   self.index, "co
-000215b0: 756e 7422 3a20 7365 6c66 2e63 6f75 6e74  unt": self.count
-000215c0: 2829 7d29 0a20 2020 2020 2020 2069 6620  ()}).        if 
-000215d0: 6d65 6d6f 7279 5f75 7361 6765 3a0a 2020  memory_usage:.  
-000215e0: 2020 2020 2020 2020 2020 636f 6d70 7574            comput
-000215f0: 6174 696f 6e73 5b22 6d65 6d6f 7279 5f75  ations["memory_u
-00021600: 7361 6765 225d 203d 2073 656c 662e 6d65  sage"] = self.me
-00021610: 6d6f 7279 5f75 7361 6765 2864 6565 703d  mory_usage(deep=
-00021620: 5472 7565 2c20 696e 6465 783d 5472 7565  True, index=True
-00021630: 290a 0a20 2020 2020 2020 2063 6f6d 7075  )..        compu
-00021640: 7461 7469 6f6e 7320 3d20 6469 6374 287a  tations = dict(z
-00021650: 6970 2863 6f6d 7075 7461 7469 6f6e 732e  ip(computations.
-00021660: 6b65 7973 2829 2c20 636f 6d70 7574 6528  keys(), compute(
-00021670: 2a63 6f6d 7075 7461 7469 6f6e 732e 7661  *computations.va
-00021680: 6c75 6573 2829 2929 290a 0a20 2020 2020  lues())))..     
-00021690: 2020 2069 6620 7665 7262 6f73 653a 0a20     if verbose:. 
-000216a0: 2020 2020 2020 2020 2020 2069 6d70 6f72             impor
-000216b0: 7420 7465 7874 7772 6170 0a0a 2020 2020  t textwrap..    
-000216c0: 2020 2020 2020 2020 696e 6465 7820 3d20          index = 
-000216d0: 636f 6d70 7574 6174 696f 6e73 5b22 696e  computations["in
-000216e0: 6465 7822 5d0a 2020 2020 2020 2020 2020  dex"].          
-000216f0: 2020 636f 756e 7473 203d 2063 6f6d 7075    counts = compu
-00021700: 7461 7469 6f6e 735b 2263 6f75 6e74 225d  tations["count"]
-00021710: 0a20 2020 2020 2020 2020 2020 206c 696e  .            lin
-00021720: 6573 2e61 7070 656e 6428 696e 6465 785f  es.append(index_
-00021730: 7375 6d6d 6172 7928 696e 6465 7829 290a  summary(index)).
-00021740: 2020 2020 2020 2020 2020 2020 6c69 6e65              line
-00021750: 732e 6170 7065 6e64 2866 2244 6174 6120  s.append(f"Data 
-00021760: 636f 6c75 6d6e 7320 2874 6f74 616c 207b  columns (total {
-00021770: 6c65 6e28 7365 6c66 2e63 6f6c 756d 6e73  len(self.columns
-00021780: 297d 2063 6f6c 756d 6e73 293a 2229 0a0a  )} columns):")..
-00021790: 2020 2020 2020 2020 2020 2020 6672 6f6d              from
-000217a0: 2070 616e 6461 732e 696f 2e66 6f72 6d61   pandas.io.forma
-000217b0: 7473 2e70 7269 6e74 696e 6720 696d 706f  ts.printing impo
-000217c0: 7274 2070 7072 696e 745f 7468 696e 670a  rt pprint_thing.
-000217d0: 0a20 2020 2020 2020 2020 2020 2073 7061  .            spa
-000217e0: 6365 203d 206d 6178 286c 656e 2870 7072  ce = max(len(ppr
-000217f0: 696e 745f 7468 696e 6728 6b29 2920 666f  int_thing(k)) fo
-00021800: 7220 6b20 696e 2073 656c 662e 636f 6c75  r k in self.colu
-00021810: 6d6e 7329 202b 2031 0a20 2020 2020 2020  mns) + 1.       
-00021820: 2020 2020 2063 6f6c 756d 6e5f 7769 6474       column_widt
-00021830: 6820 3d20 6d61 7828 7370 6163 652c 2037  h = max(space, 7
-00021840: 290a 0a20 2020 2020 2020 2020 2020 2068  )..            h
-00021850: 6561 6465 7220 3d20 280a 2020 2020 2020  eader = (.      
-00021860: 2020 2020 2020 2020 2020 7465 7874 7772            textwr
-00021870: 6170 2e64 6564 656e 7428 0a20 2020 2020  ap.dedent(.     
-00021880: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00021890: 2222 5c0a 2020 2020 2020 2020 2020 2020  ""\.            
-000218a0: 2023 2020 207b 7b63 6f6c 756d 6e3a 3c7b   #   {{column:<{
-000218b0: 636f 6c75 6d6e 5f77 6964 7468 7d7d 7d20  column_width}}} 
-000218c0: 4e6f 6e2d 4e75 6c6c 2043 6f75 6e74 2020  Non-Null Count  
-000218d0: 4474 7970 650a 2020 2020 2020 2020 2020  Dtype.          
-000218e0: 2020 2d2d 2d20 207b 7b75 6e64 6572 6c3a    ---  {{underl:
-000218f0: 3c7b 636f 6c75 6d6e 5f77 6964 7468 7d7d  <{column_width}}
-00021900: 7d20 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  } --------------
-00021910: 2020 2d2d 2d2d 2d22 2222 0a20 2020 2020    -----""".     
-00021920: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00021930: 2020 2020 2020 2020 2020 2020 202e 666f               .fo
-00021940: 726d 6174 2863 6f6c 756d 6e5f 7769 6474  rmat(column_widt
-00021950: 683d 636f 6c75 6d6e 5f77 6964 7468 290a  h=column_width).
-00021960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021970: 2e66 6f72 6d61 7428 636f 6c75 6d6e 3d22  .format(column="
-00021980: 436f 6c75 6d6e 222c 2075 6e64 6572 6c3d  Column", underl=
-00021990: 222d 2d2d 2d2d 2d22 290a 2020 2020 2020  "------").      
-000219a0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-000219b0: 2020 2020 636f 6c75 6d6e 5f74 656d 706c      column_templ
-000219c0: 6174 6520 3d20 7465 7874 7772 6170 2e64  ate = textwrap.d
-000219d0: 6564 656e 7428 0a20 2020 2020 2020 2020  edent(.         
-000219e0: 2020 2020 2020 2022 2222 5c0a 2020 2020         """\.    
-000219f0: 2020 2020 2020 2020 7b7b 693a 5e33 7d7d          {{i:^3}}
-00021a00: 2020 7b7b 6e61 6d65 3a3c 7b63 6f6c 756d    {{name:<{colum
-00021a10: 6e5f 7769 6474 687d 7d7d 207b 7b63 6f75  n_width}}} {{cou
-00021a20: 6e74 7d7d 206e 6f6e 2d6e 756c 6c20 2020  nt}} non-null   
-00021a30: 2020 207b 7b64 7479 7065 7d7d 2222 222e     {{dtype}}""".
-00021a40: 666f 726d 6174 280a 2020 2020 2020 2020  format(.        
-00021a50: 2020 2020 2020 2020 2020 2020 636f 6c75              colu
-00021a60: 6d6e 5f77 6964 7468 3d63 6f6c 756d 6e5f  mn_width=column_
-00021a70: 7769 6474 680a 2020 2020 2020 2020 2020  width.          
-00021a80: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00021a90: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-00021aa0: 2020 636f 6c75 6d6e 5f69 6e66 6f20 3d20    column_info = 
-00021ab0: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
-00021ac0: 2020 636f 6c75 6d6e 5f74 656d 706c 6174    column_templat
-00021ad0: 652e 666f 726d 6174 280a 2020 2020 2020  e.format(.      
-00021ae0: 2020 2020 2020 2020 2020 2020 2020 693d                i=
-00021af0: 7070 7269 6e74 5f74 6869 6e67 2869 292c  pprint_thing(i),
-00021b00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00021b10: 2020 2020 206e 616d 653d 7070 7269 6e74       name=pprint
-00021b20: 5f74 6869 6e67 286e 616d 6529 2c0a 2020  _thing(name),.  
-00021b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021b40: 2020 636f 756e 743d 7070 7269 6e74 5f74    count=pprint_t
-00021b50: 6869 6e67 2863 6f75 6e74 292c 0a20 2020  hing(count),.   
-00021b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021b70: 2064 7479 7065 3d70 7072 696e 745f 7468   dtype=pprint_th
-00021b80: 696e 6728 6474 7970 6529 2c0a 2020 2020  ing(dtype),.    
-00021b90: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00021ba0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-00021bb0: 7220 692c 2028 6e61 6d65 2c20 636f 756e  r i, (name, coun
-00021bc0: 742c 2064 7479 7065 2920 696e 2065 6e75  t, dtype) in enu
-00021bd0: 6d65 7261 7465 280a 2020 2020 2020 2020  merate(.        
-00021be0: 2020 2020 2020 2020 2020 2020 2320 4e4f              # NO
-00021bf0: 5445 3a20 5573 6520 6063 6f75 6e74 732e  TE: Use `counts.
-00021c00: 7661 6c75 6573 6020 666f 7220 6375 6466  values` for cudf
-00021c10: 2073 7570 706f 7274 0a20 2020 2020 2020   support.       
-00021c20: 2020 2020 2020 2020 2020 2020 207a 6970               zip
-00021c30: 2873 656c 662e 636f 6c75 6d6e 732c 2063  (self.columns, c
-00021c40: 6f75 6e74 732e 7661 6c75 6573 2c20 7365  ounts.values, se
-00021c50: 6c66 2e64 7479 7065 7329 0a20 2020 2020  lf.dtypes).     
-00021c60: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00021c70: 2020 2020 2020 2020 205d 0a20 2020 2020           ].     
-00021c80: 2020 2020 2020 206c 696e 6573 2e65 7874         lines.ext
-00021c90: 656e 6428 6865 6164 6572 2e73 706c 6974  end(header.split
-00021ca0: 2822 5c6e 2229 290a 2020 2020 2020 2020  ("\n")).        
-00021cb0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00021cc0: 2020 636f 6c75 6d6e 5f69 6e66 6f20 3d20    column_info = 
-00021cd0: 5b69 6e64 6578 5f73 756d 6d61 7279 2873  [index_summary(s
-00021ce0: 656c 662e 636f 6c75 6d6e 732c 206e 616d  elf.columns, nam
-00021cf0: 653d 2243 6f6c 756d 6e73 2229 5d0a 0a20  e="Columns")].. 
-00021d00: 2020 2020 2020 206c 696e 6573 2e65 7874         lines.ext
-00021d10: 656e 6428 636f 6c75 6d6e 5f69 6e66 6f29  end(column_info)
-00021d20: 0a20 2020 2020 2020 2064 7479 7065 5f63  .        dtype_c
-00021d30: 6f75 6e74 7320 3d20 5b0a 2020 2020 2020  ounts = [.      
-00021d40: 2020 2020 2020 2225 7328 2564 2922 2025        "%s(%d)" %
-00021d50: 206b 2066 6f72 206b 2069 6e20 736f 7274   k for k in sort
-00021d60: 6564 2873 656c 662e 6474 7970 6573 2e76  ed(self.dtypes.v
-00021d70: 616c 7565 5f63 6f75 6e74 7328 292e 6974  alue_counts().it
-00021d80: 656d 7328 292c 206b 6579 3d73 7472 290a  ems(), key=str).
-00021d90: 2020 2020 2020 2020 5d0a 2020 2020 2020          ].      
-00021da0: 2020 6c69 6e65 732e 6170 7065 6e64 2822    lines.append("
-00021db0: 6474 7970 6573 3a20 7b7d 222e 666f 726d  dtypes: {}".form
-00021dc0: 6174 2822 2c20 222e 6a6f 696e 2864 7479  at(", ".join(dty
-00021dd0: 7065 5f63 6f75 6e74 7329 2929 0a0a 2020  pe_counts)))..  
-00021de0: 2020 2020 2020 6966 206d 656d 6f72 795f        if memory_
-00021df0: 7573 6167 653a 0a20 2020 2020 2020 2020  usage:.         
-00021e00: 2020 206d 656d 6f72 795f 696e 7420 3d20     memory_int = 
-00021e10: 636f 6d70 7574 6174 696f 6e73 5b22 6d65  computations["me
-00021e20: 6d6f 7279 5f75 7361 6765 225d 2e73 756d  mory_usage"].sum
-00021e30: 2829 0a20 2020 2020 2020 2020 2020 206c  ().            l
-00021e40: 696e 6573 2e61 7070 656e 6428 6622 6d65  ines.append(f"me
-00021e50: 6d6f 7279 2075 7361 6765 3a20 7b6d 656d  mory usage: {mem
-00021e60: 6f72 795f 7265 7072 286d 656d 6f72 795f  ory_repr(memory_
-00021e70: 696e 7429 7d5c 6e22 290a 0a20 2020 2020  int)}\n")..     
-00021e80: 2020 2070 7574 5f6c 696e 6573 2862 7566     put_lines(buf
-00021e90: 2c20 6c69 6e65 7329 0a0a 2020 2020 4064  , lines)..    @d
-00021ea0: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
-00021eb0: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
-00021ec0: 6620 636f 7628 7365 6c66 2c20 6d69 6e5f  f cov(self, min_
-00021ed0: 7065 7269 6f64 733d 4e6f 6e65 2c20 6e75  periods=None, nu
-00021ee0: 6d65 7269 635f 6f6e 6c79 3d46 616c 7365  meric_only=False
-00021ef0: 2c20 7370 6c69 745f 6576 6572 793d 4661  , split_every=Fa
-00021f00: 6c73 6529 3a0a 2020 2020 2020 2020 7265  lse):.        re
-00021f10: 7475 726e 2073 656c 662e 5f63 6f76 286d  turn self._cov(m
-00021f20: 696e 5f70 6572 696f 6473 2c20 6e75 6d65  in_periods, nume
-00021f30: 7269 635f 6f6e 6c79 2c20 7370 6c69 745f  ric_only, split_
-00021f40: 6576 6572 7929 0a0a 2020 2020 4064 6572  every)..    @der
-00021f50: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
-00021f60: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
-00021f70: 636f 7272 280a 2020 2020 2020 2020 7365  corr(.        se
-00021f80: 6c66 2c0a 2020 2020 2020 2020 6d65 7468  lf,.        meth
-00021f90: 6f64 3d22 7065 6172 736f 6e22 2c0a 2020  od="pearson",.  
-00021fa0: 2020 2020 2020 6d69 6e5f 7065 7269 6f64        min_period
-00021fb0: 733d 4e6f 6e65 2c0a 2020 2020 2020 2020  s=None,.        
-00021fc0: 6e75 6d65 7269 635f 6f6e 6c79 3d46 616c  numeric_only=Fal
-00021fd0: 7365 2c0a 2020 2020 2020 2020 7370 6c69  se,.        spli
-00021fe0: 745f 6576 6572 793d 4661 6c73 652c 0a20  t_every=False,. 
-00021ff0: 2020 2029 3a0a 2020 2020 2020 2020 7265     ):.        re
-00022000: 7475 726e 2073 656c 662e 5f63 6f72 7228  turn self._corr(
-00022010: 6d65 7468 6f64 2c20 6d69 6e5f 7065 7269  method, min_peri
-00022020: 6f64 732c 206e 756d 6572 6963 5f6f 6e6c  ods, numeric_onl
-00022030: 792c 2073 706c 6974 5f65 7665 7279 290a  y, split_every).
-00022040: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
-00022050: 6f6d 2870 642e 4461 7461 4672 616d 6529  om(pd.DataFrame)
-00022060: 0a20 2020 2064 6566 2074 6f5f 7374 7269  .    def to_stri
-00022070: 6e67 2873 656c 662c 206d 6178 5f72 6f77  ng(self, max_row
-00022080: 733d 3529 3a0a 2020 2020 2020 2020 2320  s=5):.        # 
-00022090: 6f70 7469 6f6e 5f63 6f6e 7465 7874 2064  option_context d
-000220a0: 6f65 736e 2774 2061 6666 6563 740a 2020  oesn't affect.  
-000220b0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-000220c0: 662e 5f72 6570 725f 6461 7461 2829 2e74  f._repr_data().t
-000220d0: 6f5f 7374 7269 6e67 286d 6178 5f72 6f77  o_string(max_row
-000220e0: 733d 6d61 785f 726f 7773 2c20 7368 6f77  s=max_rows, show
-000220f0: 5f64 696d 656e 7369 6f6e 733d 4661 6c73  _dimensions=Fals
-00022100: 6529 0a0a 2020 2020 4064 6572 6976 6564  e)..    @derived
-00022110: 5f66 726f 6d28 7064 2e44 6174 6146 7261  _from(pd.DataFra
-00022120: 6d65 290a 2020 2020 6465 6620 746f 5f68  me).    def to_h
-00022130: 746d 6c28 7365 6c66 2c20 6d61 785f 726f  tml(self, max_ro
-00022140: 7773 3d35 293a 0a20 2020 2020 2020 2023  ws=5):.        #
-00022150: 2070 642e 5365 7269 6573 2064 6f65 736e   pd.Series doesn
-00022160: 2774 2068 6176 6520 6874 6d6c 2072 6570  't have html rep
-00022170: 720a 2020 2020 2020 2020 6461 7461 203d  r.        data =
-00022180: 2073 656c 662e 5f72 6570 725f 6461 7461   self._repr_data
-00022190: 2829 2e74 6f5f 6874 6d6c 286d 6178 5f72  ().to_html(max_r
-000221a0: 6f77 733d 6d61 785f 726f 7773 2c20 7368  ows=max_rows, sh
-000221b0: 6f77 5f64 696d 656e 7369 6f6e 733d 4661  ow_dimensions=Fa
-000221c0: 6c73 6529 0a20 2020 2020 2020 206e 5f65  lse).        n_e
-000221d0: 7870 7220 3d20 6c65 6e28 7b65 2e5f 6e61  xpr = len({e._na
-000221e0: 6d65 2066 6f72 2065 2069 6e20 7365 6c66  me for e in self
-000221f0: 2e77 616c 6b28 297d 290a 2020 2020 2020  .walk()}).      
-00022200: 2020 7265 7475 726e 2067 6574 5f74 656d    return get_tem
-00022210: 706c 6174 6528 2264 6174 6166 7261 6d65  plate("dataframe
-00022220: 2e68 746d 6c2e 6a32 2229 2e72 656e 6465  .html.j2").rende
-00022230: 7228 0a20 2020 2020 2020 2020 2020 2064  r(.            d
-00022240: 6174 613d 6461 7461 2c0a 2020 2020 2020  ata=data,.      
-00022250: 2020 2020 2020 6e61 6d65 3d73 656c 662e        name=self.
-00022260: 5f6e 616d 652c 0a20 2020 2020 2020 2020  _name,.         
-00022270: 2020 206c 6179 6572 733d 6d61 7962 655f     layers=maybe_
-00022280: 706c 7572 616c 697a 6528 6e5f 6578 7072  pluralize(n_expr
-00022290: 2c20 2265 7870 7265 7373 696f 6e22 292c  , "expression"),
-000222a0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-000222b0: 6465 6620 5f72 6570 725f 6461 7461 2873  def _repr_data(s
-000222c0: 656c 6629 3a0a 2020 2020 2020 2020 6d65  elf):.        me
-000222d0: 7461 203d 2073 656c 662e 5f6d 6574 610a  ta = self._meta.
-000222e0: 2020 2020 2020 2020 696e 6465 7820 3d20          index = 
-000222f0: 7365 6c66 2e5f 7265 7072 5f64 6976 6973  self._repr_divis
-00022300: 696f 6e73 0a20 2020 2020 2020 2063 6f6c  ions.        col
-00022310: 7320 3d20 6d65 7461 2e63 6f6c 756d 6e73  s = meta.columns
-00022320: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
-00022330: 636f 6c73 2920 3d3d 2030 3a0a 2020 2020  cols) == 0:.    
-00022340: 2020 2020 2020 2020 7365 7269 6573 5f64          series_d
-00022350: 6620 3d20 7064 2e44 6174 6146 7261 6d65  f = pd.DataFrame
-00022360: 285b 5b5d 5d20 2a20 6c65 6e28 696e 6465  ([[]] * len(inde
-00022370: 7829 2c20 636f 6c75 6d6e 733d 636f 6c73  x), columns=cols
-00022380: 2c20 696e 6465 783d 696e 6465 7829 0a20  , index=index). 
-00022390: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-000223a0: 2020 2020 2020 2020 2073 6572 6965 735f           series_
-000223b0: 6466 203d 2070 642e 636f 6e63 6174 280a  df = pd.concat(.
-000223c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000223d0: 5b5f 7265 7072 5f64 6174 615f 7365 7269  [_repr_data_seri
-000223e0: 6573 2873 2c20 696e 6465 783d 696e 6465  es(s, index=inde
-000223f0: 7829 2066 6f72 205f 2c20 7320 696e 206d  x) for _, s in m
-00022400: 6574 612e 6974 656d 7328 295d 2c20 6178  eta.items()], ax
-00022410: 6973 3d31 0a20 2020 2020 2020 2020 2020  is=1.           
-00022420: 2029 0a20 2020 2020 2020 2072 6574 7572   ).        retur
-00022430: 6e20 7365 7269 6573 5f64 660a 0a0a 636c  n series_df...cl
-00022440: 6173 7320 5365 7269 6573 2846 7261 6d65  ass Series(Frame
-00022450: 4261 7365 293a 0a20 2020 2022 2222 5365  Base):.    """Se
-00022460: 7269 6573 2d6c 696b 6520 4578 7072 2043  ries-like Expr C
-00022470: 6f6c 6c65 6374 696f 6e22 2222 0a0a 2020  ollection"""..  
-00022480: 2020 5f61 6363 6573 736f 7273 3a20 436c    _accessors: Cl
-00022490: 6173 7356 6172 5b73 6574 5b73 7472 5d5d  assVar[set[str]]
-000224a0: 203d 2073 6574 2829 0a20 2020 205f 7061   = set().    _pa
-000224b0: 7274 6974 696f 6e5f 7479 7065 203d 2070  rtition_type = p
-000224c0: 642e 5365 7269 6573 0a0a 2020 2020 4070  d.Series..    @p
-000224d0: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-000224e0: 7368 6170 6528 7365 6c66 293a 0a20 2020  shape(self):.   
-000224f0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00022500: 2052 6574 7572 6e20 6120 7475 706c 6520   Return a tuple 
-00022510: 7265 7072 6573 656e 7469 6e67 2074 6865  representing the
-00022520: 2064 696d 656e 7369 6f6e 616c 6974 7920   dimensionality 
-00022530: 6f66 2074 6865 2044 6174 6146 7261 6d65  of the DataFrame
-00022540: 2e0a 0a20 2020 2020 2020 2054 6865 206e  ...        The n
-00022550: 756d 6265 7220 6f66 2072 6f77 7320 6973  umber of rows is
-00022560: 2061 2044 656c 6179 6564 2072 6573 756c   a Delayed resul
-00022570: 742e 2054 6865 206e 756d 6265 7220 6f66  t. The number of
-00022580: 2063 6f6c 756d 6e73 0a20 2020 2020 2020   columns.       
-00022590: 2069 7320 6120 636f 6e63 7265 7465 2069   is a concrete i
-000225a0: 6e74 6567 6572 2e0a 2020 2020 2020 2020  nteger..        
-000225b0: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
-000225c0: 726e 2028 7365 6c66 2e73 697a 652c 290a  rn (self.size,).
-000225d0: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
-000225e0: 2020 2064 6566 2061 7865 7328 7365 6c66     def axes(self
-000225f0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-00022600: 6e20 5b73 656c 662e 696e 6465 785d 0a0a  n [self.index]..
-00022610: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
-00022620: 2020 6465 6620 6e64 696d 2873 656c 6629    def ndim(self)
-00022630: 3a0a 2020 2020 2020 2020 2222 2252 6574  :.        """Ret
-00022640: 7572 6e20 6469 6d65 6e73 696f 6e61 6c69  urn dimensionali
-00022650: 7479 2222 220a 2020 2020 2020 2020 7265  ty""".        re
-00022660: 7475 726e 2031 0a0a 2020 2020 4070 726f  turn 1..    @pro
-00022670: 7065 7274 790a 2020 2020 6465 6620 5f65  perty.    def _e
-00022680: 6c65 6d77 6973 6528 7365 6c66 293a 0a20  lemwise(self):. 
-00022690: 2020 2020 2020 2072 6574 7572 6e20 656c         return el
-000226a0: 656d 7769 7365 0a0a 2020 2020 6465 6620  emwise..    def 
-000226b0: 5f5f 6469 725f 5f28 7365 6c66 293a 0a20  __dir__(self):. 
-000226c0: 2020 2020 2020 206f 203d 2073 6574 2864         o = set(d
-000226d0: 6972 2874 7970 6528 7365 6c66 2929 290a  ir(type(self))).
-000226e0: 2020 2020 2020 2020 6f2e 7570 6461 7465          o.update
-000226f0: 2873 656c 662e 5f5f 6469 6374 5f5f 290a  (self.__dict__).
-00022700: 2020 2020 2020 2020 6f2e 7570 6461 7465          o.update
-00022710: 2873 6574 2864 6972 2865 7870 722e 4578  (set(dir(expr.Ex
-00022720: 7072 2929 290a 2020 2020 2020 2020 666f  pr))).        fo
-00022730: 7220 6163 6365 7373 6f72 2069 6e20 5b22  r accessor in ["
-00022740: 6361 7422 2c20 2273 7472 225d 3a0a 2020  cat", "str"]:.  
-00022750: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
-00022760: 2068 6173 6174 7472 2873 656c 662e 5f6d   hasattr(self._m
-00022770: 6574 612c 2061 6363 6573 736f 7229 3a0a  eta, accessor):.
-00022780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022790: 6f2e 7265 6d6f 7665 2861 6363 6573 736f  o.remove(accesso
-000227a0: 7229 0a20 2020 2020 2020 2072 6574 7572  r).        retur
-000227b0: 6e20 6c69 7374 286f 290a 0a20 2020 2064  n list(o)..    d
-000227c0: 6566 205f 5f63 6f6e 7461 696e 735f 5f28  ef __contains__(
-000227d0: 7365 6c66 2c20 6974 656d 293a 0a20 2020  self, item):.   
-000227e0: 2020 2020 2072 6169 7365 204e 6f74 496d       raise NotIm
-000227f0: 706c 656d 656e 7465 6445 7272 6f72 280a  plementedError(.
-00022800: 2020 2020 2020 2020 2020 2020 2255 7369              "Usi
-00022810: 6e67 2027 696e 2720 746f 2074 6573 7420  ng 'in' to test 
-00022820: 666f 7220 6d65 6d62 6572 7368 6970 2069  for membership i
-00022830: 7320 6e6f 7420 7375 7070 6f72 7465 642e  s not supported.
-00022840: 2055 7365 2074 6865 2076 616c 7565 7320   Use the values 
-00022850: 696e 7374 6561 6422 0a20 2020 2020 2020  instead".       
-00022860: 2029 0a0a 2020 2020 4064 6572 6976 6564   )..    @derived
-00022870: 5f66 726f 6d28 7064 2e53 6572 6965 7329  _from(pd.Series)
-00022880: 0a20 2020 2064 6566 205f 5f69 7465 725f  .    def __iter_
-00022890: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
-000228a0: 2066 7261 6d65 203d 2073 656c 662e 6f70   frame = self.op
-000228b0: 7469 6d69 7a65 2829 0a20 2020 2020 2020  timize().       
-000228c0: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
-000228d0: 7365 6c66 2e6e 7061 7274 6974 696f 6e73  self.npartitions
-000228e0: 293a 0a20 2020 2020 2020 2020 2020 2073  ):.            s
-000228f0: 203d 2066 7261 6d65 2e67 6574 5f70 6172   = frame.get_par
-00022900: 7469 7469 6f6e 2869 292e 636f 6d70 7574  tition(i).comput
-00022910: 6528 290a 2020 2020 2020 2020 2020 2020  e().            
-00022920: 7969 656c 6420 6672 6f6d 2073 0a0a 2020  yield from s..  
-00022930: 2020 6465 6620 5f5f 6765 7469 7465 6d5f    def __getitem_
-00022940: 5f28 7365 6c66 2c20 6b65 7929 3a0a 2020  _(self, key):.  
-00022950: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-00022960: 6e63 6528 6b65 792c 2053 6572 6965 7329  nce(key, Series)
-00022970: 206f 7220 7365 6c66 2e6e 7061 7274 6974   or self.npartit
-00022980: 696f 6e73 203d 3d20 313a 0a20 2020 2020  ions == 1:.     
-00022990: 2020 2020 2020 2072 6574 7572 6e20 7375         return su
-000229a0: 7065 7228 292e 5f5f 6765 7469 7465 6d5f  per().__getitem_
-000229b0: 5f28 6b65 7929 0a20 2020 2020 2020 2072  _(key).        r
-000229c0: 6574 7572 6e20 7365 6c66 2e6c 6f63 5b6b  eturn self.loc[k
-000229d0: 6579 5d0a 0a20 2020 2040 7072 6f70 6572  ey]..    @proper
-000229e0: 7479 0a20 2020 2064 6566 206e 616d 6528  ty.    def name(
-000229f0: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
-00022a00: 6574 7572 6e20 7365 6c66 2e65 7870 722e  eturn self.expr.
-00022a10: 5f6d 6574 612e 6e61 6d65 0a0a 2020 2020  _meta.name..    
-00022a20: 406e 616d 652e 7365 7474 6572 0a20 2020  @name.setter.   
-00022a30: 2064 6566 206e 616d 6528 7365 6c66 2c20   def name(self, 
-00022a40: 6e61 6d65 293a 0a20 2020 2020 2020 2073  name):.        s
-00022a50: 656c 662e 5f65 7870 7220 3d20 7365 6c66  elf._expr = self
-00022a60: 2e72 656e 616d 6528 696e 6465 783d 6e61  .rename(index=na
-00022a70: 6d65 292e 5f65 7870 720a 0a20 2020 2040  me)._expr..    @
-00022a80: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
-00022a90: 2064 7479 7065 2873 656c 6629 3a0a 2020   dtype(self):.  
-00022aa0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00022ab0: 662e 6578 7072 2e5f 6d65 7461 2e64 7479  f.expr._meta.dty
-00022ac0: 7065 0a0a 2020 2020 4070 726f 7065 7274  pe..    @propert
-00022ad0: 790a 2020 2020 6465 6620 6e62 7974 6573  y.    def nbytes
-00022ae0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00022af0: 2222 224e 756d 6265 7220 6f66 2062 7974  """Number of byt
-00022b00: 6573 2222 220a 2020 2020 2020 2020 7265  es""".        re
-00022b10: 7475 726e 206e 6577 5f63 6f6c 6c65 6374  turn new_collect
-00022b20: 696f 6e28 7365 6c66 2e65 7870 722e 6e62  ion(self.expr.nb
-00022b30: 7974 6573 290a 0a20 2020 2064 6566 205f  ytes)..    def _
-00022b40: 5f61 7272 6179 5f75 6675 6e63 5f5f 2873  _array_ufunc__(s
-00022b50: 656c 662c 206e 756d 7079 5f75 6675 6e63  elf, numpy_ufunc
-00022b60: 2c20 6d65 7468 6f64 2c20 2a69 6e70 7574  , method, *input
-00022b70: 732c 202a 2a6b 7761 7267 7329 3a0a 2020  s, **kwargs):.  
-00022b80: 2020 2020 2020 6f75 7420 3d20 6b77 6172        out = kwar
-00022b90: 6773 2e67 6574 2822 6f75 7422 2c20 2829  gs.get("out", ()
-00022ba0: 290a 2020 2020 2020 2020 666f 7220 7820  ).        for x 
-00022bb0: 696e 2069 6e70 7574 7320 2b20 6f75 743a  in inputs + out:
-00022bc0: 0a20 2020 2020 2020 2020 2020 2023 2075  .            # u
-00022bd0: 6675 6e63 7320 776f 726b 2077 6974 6820  funcs work with 
-00022be0: 302d 6469 6d65 6e73 696f 6e61 6c20 4e75  0-dimensional Nu
-00022bf0: 6d50 7920 6e64 6172 7261 7973 0a20 2020  mPy ndarrays.   
-00022c00: 2020 2020 2020 2020 2023 2073 6f20 7765           # so we
-00022c10: 2064 6f6e 2774 2077 616e 7420 746f 2072   don't want to r
-00022c20: 6169 7365 204e 6f74 496d 706c 656d 656e  aise NotImplemen
-00022c30: 7465 640a 2020 2020 2020 2020 2020 2020  ted.            
-00022c40: 6966 2069 7369 6e73 7461 6e63 6528 782c  if isinstance(x,
-00022c50: 206e 702e 6e64 6172 7261 7929 2061 6e64   np.ndarray) and
-00022c60: 2078 2e73 6861 7065 203d 3d20 2829 3a0a   x.shape == ():.
-00022c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022c80: 636f 6e74 696e 7565 0a20 2020 2020 2020  continue.       
-00022c90: 2020 2020 2065 6c69 6620 6e6f 7420 6973       elif not is
-00022ca0: 696e 7374 616e 6365 280a 2020 2020 2020  instance(.      
-00022cb0: 2020 2020 2020 2020 2020 782c 2028 4e75            x, (Nu
-00022cc0: 6d62 6572 2c20 5363 616c 6172 2c20 4672  mber, Scalar, Fr
-00022cd0: 616d 6542 6173 652c 2041 7272 6179 2c20  ameBase, Array, 
-00022ce0: 7064 2e44 6174 6146 7261 6d65 2c20 7064  pd.DataFrame, pd
-00022cf0: 2e53 6572 6965 732c 2070 642e 496e 6465  .Series, pd.Inde
-00022d00: 7829 0a20 2020 2020 2020 2020 2020 2029  x).            )
-00022d10: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00022d20: 2020 7265 7475 726e 204e 6f74 496d 706c    return NotImpl
-00022d30: 656d 656e 7465 640a 0a20 2020 2020 2020  emented..       
-00022d40: 2069 6620 6d65 7468 6f64 203d 3d20 225f   if method == "_
-00022d50: 5f63 616c 6c5f 5f22 3a0a 2020 2020 2020  _call__":.      
-00022d60: 2020 2020 2020 6966 206e 756d 7079 5f75        if numpy_u
-00022d70: 6675 6e63 2e73 6967 6e61 7475 7265 2069  func.signature i
-00022d80: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-00022d90: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00022da0: 726e 204e 6f74 496d 706c 656d 656e 7465  rn NotImplemente
-00022db0: 640a 2020 2020 2020 2020 2020 2020 6966  d.            if
-00022dc0: 206e 756d 7079 5f75 6675 6e63 2e6e 6f75   numpy_ufunc.nou
-00022dd0: 7420 3e20 313a 0a20 2020 2020 2020 2020  t > 1:.         
-00022de0: 2020 2020 2020 2023 2075 6675 6e63 7320         # ufuncs 
-00022df0: 7769 7468 206d 756c 7469 706c 6520 6f75  with multiple ou
-00022e00: 7470 7574 2076 616c 7565 730a 2020 2020  tput values.    
-00022e10: 2020 2020 2020 2020 2020 2020 2320 6172              # ar
-00022e20: 6520 6e6f 7420 7965 7420 7375 7070 6f72  e not yet suppor
-00022e30: 7465 6420 666f 7220 6672 616d 6573 0a20  ted for frames. 
-00022e40: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00022e50: 6574 7572 6e20 4e6f 7449 6d70 6c65 6d65  eturn NotImpleme
-00022e60: 6e74 6564 0a20 2020 2020 2020 2020 2020  nted.           
-00022e70: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00022e80: 2020 2020 2020 2072 6574 7572 6e20 656c         return el
-00022e90: 656d 7769 7365 286e 756d 7079 5f75 6675  emwise(numpy_ufu
-00022ea0: 6e63 2c20 2a69 6e70 7574 732c 202a 2a6b  nc, *inputs, **k
-00022eb0: 7761 7267 7329 0a20 2020 2020 2020 2065  wargs).        e
-00022ec0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00022ed0: 2023 2075 6675 6e63 206d 6574 686f 6473   # ufunc methods
-00022ee0: 2061 7265 206e 6f74 2079 6574 2073 7570   are not yet sup
-00022ef0: 706f 7274 6564 2066 6f72 2066 7261 6d65  ported for frame
-00022f00: 730a 2020 2020 2020 2020 2020 2020 7265  s.            re
-00022f10: 7475 726e 204e 6f74 496d 706c 656d 656e  turn NotImplemen
-00022f20: 7465 640a 0a20 2020 2064 6566 205f 5f61  ted..    def __a
-00022f30: 7272 6179 5f77 7261 705f 5f28 7365 6c66  rray_wrap__(self
-00022f40: 2c20 6172 7261 792c 2063 6f6e 7465 7874  , array, context
-00022f50: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
-00022f60: 6966 2069 7369 6e73 7461 6e63 6528 636f  if isinstance(co
-00022f70: 6e74 6578 742c 2074 7570 6c65 2920 616e  ntext, tuple) an
-00022f80: 6420 6c65 6e28 636f 6e74 6578 7429 203e  d len(context) >
-00022f90: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
-00022fa0: 6966 2069 7369 6e73 7461 6e63 6528 636f  if isinstance(co
-00022fb0: 6e74 6578 745b 315d 5b30 5d2c 206e 702e  ntext[1][0], np.
-00022fc0: 6e64 6172 7261 7929 2061 6e64 2063 6f6e  ndarray) and con
-00022fd0: 7465 7874 5b31 5d5b 305d 2e73 6861 7065  text[1][0].shape
-00022fe0: 203d 3d20 2829 3a0a 2020 2020 2020 2020   == ():.        
-00022ff0: 2020 2020 2020 2020 696e 6465 7820 3d20          index = 
-00023000: 4e6f 6e65 0a20 2020 2020 2020 2020 2020  None.           
-00023010: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00023020: 2020 2020 2020 2069 6e64 6578 203d 2063         index = c
-00023030: 6f6e 7465 7874 5b31 5d5b 305d 2e69 6e64  ontext[1][0].ind
-00023040: 6578 0a20 2020 2020 2020 2065 6c73 653a  ex.        else:
-00023050: 0a20 2020 2020 2020 2020 2020 2074 7279  .            try
-00023060: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00023070: 2020 696d 706f 7274 2069 6e73 7065 6374    import inspect
-00023080: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00023090: 2020 6d65 7468 6f64 5f6e 616d 6520 3d20    method_name = 
-000230a0: 6622 607b 696e 7370 6563 742e 7374 6163  f"`{inspect.stac
-000230b0: 6b28 295b 335d 5b33 5d7d 6022 0a20 2020  k()[3][3]}`".   
-000230c0: 2020 2020 2020 2020 2065 7863 6570 7420           except 
-000230d0: 496e 6465 7845 7272 6f72 3a0a 2020 2020  IndexError:.    
-000230e0: 2020 2020 2020 2020 2020 2020 6d65 7468              meth
-000230f0: 6f64 5f6e 616d 6520 3d20 2254 6869 7320  od_name = "This 
-00023100: 6d65 7468 6f64 220a 2020 2020 2020 2020  method".        
-00023110: 2020 2020 7261 6973 6520 4e6f 7449 6d70      raise NotImp
-00023120: 6c65 6d65 6e74 6564 4572 726f 7228 0a20  lementedError(. 
-00023130: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00023140: 227b 6d65 7468 6f64 5f6e 616d 657d 2069  "{method_name} i
-00023150: 7320 6e6f 7420 696d 706c 656d 656e 7465  s not implemente
-00023160: 6420 666f 7220 6064 6173 6b2e 6461 7461  d for `dask.data
-00023170: 6672 616d 652e 5365 7269 6573 602e 220a  frame.Series`.".
-00023180: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-00023190: 2020 2020 2020 2072 6574 7572 6e20 6d65         return me
-000231a0: 7461 5f73 6572 6965 735f 636f 6e73 7472  ta_series_constr
-000231b0: 7563 746f 7228 7365 6c66 2928 6172 7261  uctor(self)(arra
-000231c0: 792c 2069 6e64 6578 3d69 6e64 6578 2c20  y, index=index, 
-000231d0: 6e61 6d65 3d73 656c 662e 6e61 6d65 290a  name=self.name).
-000231e0: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
-000231f0: 6f6d 2870 642e 5365 7269 6573 290a 2020  om(pd.Series).  
-00023200: 2020 6465 6620 6d61 7028 7365 6c66 2c20    def map(self, 
-00023210: 6172 672c 206e 615f 6163 7469 6f6e 3d4e  arg, na_action=N
-00023220: 6f6e 652c 206d 6574 613d 4e6f 6e65 293a  one, meta=None):
-00023230: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
-00023240: 7374 616e 6365 2861 7267 2c20 5365 7269  stance(arg, Seri
-00023250: 6573 293a 0a20 2020 2020 2020 2020 2020  es):.           
-00023260: 2069 6620 6e6f 7420 6578 7072 2e61 7265   if not expr.are
-00023270: 5f63 6f5f 616c 6967 6e65 6428 7365 6c66  _co_aligned(self
-00023280: 2e65 7870 722c 2061 7267 2e65 7870 7229  .expr, arg.expr)
-00023290: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000232a0: 2020 6966 206d 6574 6120 6973 204e 6f6e    if meta is Non
-000232b0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-000232c0: 2020 2020 2020 2077 6172 6e69 6e67 732e         warnings.
-000232d0: 7761 726e 286d 6574 615f 7761 726e 696e  warn(meta_warnin
-000232e0: 6728 6d65 7461 2929 0a20 2020 2020 2020  g(meta)).       
-000232f0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00023300: 6e65 775f 636f 6c6c 6563 7469 6f6e 280a  new_collection(.
-00023310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023320: 2020 2020 6578 7072 2e4d 6170 416c 6967      expr.MapAlig
-00023330: 6e28 7365 6c66 2c20 6172 672c 206f 703d  n(self, arg, op=
-00023340: 4e6f 6e65 2c20 6e61 5f61 6374 696f 6e3d  None, na_action=
-00023350: 6e61 5f61 6374 696f 6e2c 206d 6574 613d  na_action, meta=
-00023360: 6d65 7461 290a 2020 2020 2020 2020 2020  meta).          
-00023370: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00023380: 6966 206d 6574 6120 6973 204e 6f6e 653a  if meta is None:
-00023390: 0a20 2020 2020 2020 2020 2020 206d 6574  .            met
-000233a0: 6120 3d20 6578 7072 2e5f 656d 756c 6174  a = expr._emulat
-000233b0: 6528 4d2e 6d61 702c 2073 656c 662c 2061  e(M.map, self, a
-000233c0: 7267 2c20 6e61 5f61 6374 696f 6e3d 6e61  rg, na_action=na
-000233d0: 5f61 6374 696f 6e2c 2075 6466 3d54 7275  _action, udf=Tru
-000233e0: 6529 0a20 2020 2020 2020 2020 2020 2077  e).            w
-000233f0: 6172 6e69 6e67 732e 7761 726e 286d 6574  arnings.warn(met
-00023400: 615f 7761 726e 696e 6728 6d65 7461 2929  a_warning(meta))
-00023410: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00023420: 6e65 775f 636f 6c6c 6563 7469 6f6e 2865  new_collection(e
-00023430: 7870 722e 4d61 7028 7365 6c66 2c20 6172  xpr.Map(self, ar
-00023440: 673d 6172 672c 206e 615f 6163 7469 6f6e  g=arg, na_action
-00023450: 3d6e 615f 6163 7469 6f6e 2c20 6d65 7461  =na_action, meta
-00023460: 3d6d 6574 6129 290a 0a20 2020 2040 6465  =meta))..    @de
-00023470: 7269 7665 645f 6672 6f6d 2870 642e 5365  rived_from(pd.Se
-00023480: 7269 6573 290a 2020 2020 6465 6620 636c  ries).    def cl
-00023490: 6970 2873 656c 662c 206c 6f77 6572 3d4e  ip(self, lower=N
-000234a0: 6f6e 652c 2075 7070 6572 3d4e 6f6e 652c  one, upper=None,
-000234b0: 2061 7869 733d 4e6f 6e65 2c20 2a2a 6b77   axis=None, **kw
-000234c0: 6172 6773 293a 0a20 2020 2020 2020 2061  args):.        a
-000234d0: 7869 7320 3d20 7365 6c66 2e5f 7661 6c69  xis = self._vali
-000234e0: 6461 7465 5f61 7869 7328 6178 6973 290a  date_axis(axis).
-000234f0: 2020 2020 2020 2020 7265 7475 726e 206e          return n
-00023500: 6577 5f63 6f6c 6c65 6374 696f 6e28 7365  ew_collection(se
-00023510: 6c66 2e65 7870 722e 636c 6970 286c 6f77  lf.expr.clip(low
-00023520: 6572 2c20 7570 7065 722c 2061 7869 7329  er, upper, axis)
-00023530: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
-00023540: 6672 6f6d 2870 642e 5365 7269 6573 290a  from(pd.Series).
-00023550: 2020 2020 6465 6620 746f 5f66 7261 6d65      def to_frame
-00023560: 2873 656c 662c 206e 616d 653d 6e6f 5f64  (self, name=no_d
-00023570: 6566 6175 6c74 293a 0a20 2020 2020 2020  efault):.       
-00023580: 2072 6574 7572 6e20 6e65 775f 636f 6c6c   return new_coll
-00023590: 6563 7469 6f6e 2865 7870 722e 546f 4672  ection(expr.ToFr
-000235a0: 616d 6528 7365 6c66 2c20 6e61 6d65 3d6e  ame(self, name=n
-000235b0: 616d 6529 290a 0a20 2020 2064 6566 205f  ame))..    def _
-000235c0: 636f 6d70 6172 6973 6f6e 5f6f 7028 7365  comparison_op(se
-000235d0: 6c66 2c20 6578 7072 5f63 6c73 2c20 6f74  lf, expr_cls, ot
-000235e0: 6865 722c 206c 6576 656c 2c20 6669 6c6c  her, level, fill
-000235f0: 5f76 616c 7565 2c20 6178 6973 293a 0a20  _value, axis):. 
-00023600: 2020 2020 2020 2069 6620 6c65 7665 6c20         if level 
-00023610: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
-00023620: 2020 2020 2020 2020 2072 6169 7365 204e           raise N
-00023630: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
-00023640: 6f72 2822 6c65 7665 6c20 6d75 7374 2062  or("level must b
-00023650: 6520 4e6f 6e65 2229 0a20 2020 2020 2020  e None").       
-00023660: 2073 656c 662e 5f76 616c 6964 6174 655f   self._validate_
-00023670: 6178 6973 2861 7869 7329 0a20 2020 2020  axis(axis).     
-00023680: 2020 2072 6574 7572 6e20 6e65 775f 636f     return new_co
-00023690: 6c6c 6563 7469 6f6e 2865 7870 725f 636c  llection(expr_cl
-000236a0: 7328 7365 6c66 2c20 6f74 6865 722c 2066  s(self, other, f
-000236b0: 696c 6c5f 7661 6c75 653d 6669 6c6c 5f76  ill_value=fill_v
-000236c0: 616c 7565 2929 0a0a 2020 2020 6465 6620  alue))..    def 
-000236d0: 6c74 2873 656c 662c 206f 7468 6572 2c20  lt(self, other, 
-000236e0: 6c65 7665 6c3d 4e6f 6e65 2c20 6669 6c6c  level=None, fill
-000236f0: 5f76 616c 7565 3d4e 6f6e 652c 2061 7869  _value=None, axi
-00023700: 733d 3029 3a0a 2020 2020 2020 2020 7265  s=0):.        re
-00023710: 7475 726e 2073 656c 662e 5f63 6f6d 7061  turn self._compa
-00023720: 7269 736f 6e5f 6f70 2865 7870 722e 4c54  rison_op(expr.LT
-00023730: 5365 7269 6573 2c20 6f74 6865 722c 206c  Series, other, l
-00023740: 6576 656c 2c20 6669 6c6c 5f76 616c 7565  evel, fill_value
-00023750: 2c20 6178 6973 290a 0a20 2020 2064 6566  , axis)..    def
-00023760: 206c 6528 7365 6c66 2c20 6f74 6865 722c   le(self, other,
-00023770: 206c 6576 656c 3d4e 6f6e 652c 2066 696c   level=None, fil
-00023780: 6c5f 7661 6c75 653d 4e6f 6e65 2c20 6178  l_value=None, ax
-00023790: 6973 3d30 293a 0a20 2020 2020 2020 2072  is=0):.        r
-000237a0: 6574 7572 6e20 7365 6c66 2e5f 636f 6d70  eturn self._comp
-000237b0: 6172 6973 6f6e 5f6f 7028 6578 7072 2e4c  arison_op(expr.L
-000237c0: 4553 6572 6965 732c 206f 7468 6572 2c20  ESeries, other, 
-000237d0: 6c65 7665 6c2c 2066 696c 6c5f 7661 6c75  level, fill_valu
-000237e0: 652c 2061 7869 7329 0a0a 2020 2020 6465  e, axis)..    de
-000237f0: 6620 6774 2873 656c 662c 206f 7468 6572  f gt(self, other
-00023800: 2c20 6c65 7665 6c3d 4e6f 6e65 2c20 6669  , level=None, fi
-00023810: 6c6c 5f76 616c 7565 3d4e 6f6e 652c 2061  ll_value=None, a
-00023820: 7869 733d 3029 3a0a 2020 2020 2020 2020  xis=0):.        
-00023830: 7265 7475 726e 2073 656c 662e 5f63 6f6d  return self._com
-00023840: 7061 7269 736f 6e5f 6f70 2865 7870 722e  parison_op(expr.
-00023850: 4754 5365 7269 6573 2c20 6f74 6865 722c  GTSeries, other,
-00023860: 206c 6576 656c 2c20 6669 6c6c 5f76 616c   level, fill_val
-00023870: 7565 2c20 6178 6973 290a 0a20 2020 2064  ue, axis)..    d
-00023880: 6566 2067 6528 7365 6c66 2c20 6f74 6865  ef ge(self, othe
-00023890: 722c 206c 6576 656c 3d4e 6f6e 652c 2066  r, level=None, f
-000238a0: 696c 6c5f 7661 6c75 653d 4e6f 6e65 2c20  ill_value=None, 
-000238b0: 6178 6973 3d30 293a 0a20 2020 2020 2020  axis=0):.       
-000238c0: 2072 6574 7572 6e20 7365 6c66 2e5f 636f   return self._co
-000238d0: 6d70 6172 6973 6f6e 5f6f 7028 6578 7072  mparison_op(expr
-000238e0: 2e47 4553 6572 6965 732c 206f 7468 6572  .GESeries, other
-000238f0: 2c20 6c65 7665 6c2c 2066 696c 6c5f 7661  , level, fill_va
-00023900: 6c75 652c 2061 7869 7329 0a0a 2020 2020  lue, axis)..    
-00023910: 6465 6620 6e65 2873 656c 662c 206f 7468  def ne(self, oth
-00023920: 6572 2c20 6c65 7665 6c3d 4e6f 6e65 2c20  er, level=None, 
-00023930: 6669 6c6c 5f76 616c 7565 3d4e 6f6e 652c  fill_value=None,
-00023940: 2061 7869 733d 3029 3a0a 2020 2020 2020   axis=0):.      
-00023950: 2020 7265 7475 726e 2073 656c 662e 5f63    return self._c
-00023960: 6f6d 7061 7269 736f 6e5f 6f70 2865 7870  omparison_op(exp
-00023970: 722e 4e45 5365 7269 6573 2c20 6f74 6865  r.NESeries, othe
-00023980: 722c 206c 6576 656c 2c20 6669 6c6c 5f76  r, level, fill_v
-00023990: 616c 7565 2c20 6178 6973 290a 0a20 2020  alue, axis)..   
-000239a0: 2064 6566 2065 7128 7365 6c66 2c20 6f74   def eq(self, ot
-000239b0: 6865 722c 206c 6576 656c 3d4e 6f6e 652c  her, level=None,
-000239c0: 2066 696c 6c5f 7661 6c75 653d 4e6f 6e65   fill_value=None
-000239d0: 2c20 6178 6973 3d30 293a 0a20 2020 2020  , axis=0):.     
-000239e0: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-000239f0: 636f 6d70 6172 6973 6f6e 5f6f 7028 6578  comparison_op(ex
-00023a00: 7072 2e45 5153 6572 6965 732c 206f 7468  pr.EQSeries, oth
-00023a10: 6572 2c20 6c65 7665 6c2c 2066 696c 6c5f  er, level, fill_
-00023a20: 7661 6c75 652c 2061 7869 7329 0a0a 2020  value, axis)..  
-00023a30: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
-00023a40: 7064 2e53 6572 6965 7329 0a20 2020 2064  pd.Series).    d
-00023a50: 6566 2076 616c 7565 5f63 6f75 6e74 7328  ef value_counts(
-00023a60: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-00023a70: 2020 2020 2020 2073 6f72 743d 4e6f 6e65         sort=None
-00023a80: 2c0a 2020 2020 2020 2020 6173 6365 6e64  ,.        ascend
-00023a90: 696e 673d 4661 6c73 652c 0a20 2020 2020  ing=False,.     
-00023aa0: 2020 2064 726f 706e 613d 5472 7565 2c0a     dropna=True,.
-00023ab0: 2020 2020 2020 2020 6e6f 726d 616c 697a          normaliz
-00023ac0: 653d 4661 6c73 652c 0a20 2020 2020 2020  e=False,.       
-00023ad0: 2073 706c 6974 5f65 7665 7279 3d4e 6f6e   split_every=Non
-00023ae0: 652c 0a20 2020 2020 2020 2073 706c 6974  e,.        split
-00023af0: 5f6f 7574 3d6e 6f5f 6465 6661 756c 742c  _out=no_default,
-00023b00: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
-00023b10: 6966 2073 706c 6974 5f6f 7574 2069 7320  if split_out is 
-00023b20: 6e6f 5f64 6566 6175 6c74 3a0a 2020 2020  no_default:.    
-00023b30: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-00023b40: 7461 6e63 6528 7365 6c66 2e64 7479 7065  tance(self.dtype
-00023b50: 2c20 4361 7465 676f 7269 6361 6c44 7479  , CategoricalDty
-00023b60: 7065 293a 0a20 2020 2020 2020 2020 2020  pe):.           
-00023b70: 2020 2020 2023 2075 6e6f 6273 6572 7665       # unobserve
-00023b80: 6420 6361 7465 676f 7269 6573 2061 7265  d categories are
-00023b90: 2061 2070 6169 6e0a 2020 2020 2020 2020   a pain.        
-00023ba0: 2020 2020 2020 2020 7370 6c69 745f 6f75          split_ou
-00023bb0: 7420 3d20 310a 2020 2020 2020 2020 2020  t = 1.          
-00023bc0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00023bd0: 2020 2020 2020 2020 7370 6c69 745f 6f75          split_ou
-00023be0: 7420 3d20 5472 7565 0a20 2020 2020 2020  t = True.       
-00023bf0: 2069 6620 7370 6c69 745f 6f75 7420 3d3d   if split_out ==
-00023c00: 2031 2061 6e64 2073 706c 6974 5f6f 7574   1 and split_out
-00023c10: 2069 7320 6e6f 7420 5472 7565 2061 6e64   is not True and
-00023c20: 2073 6f72 7420 6973 204e 6f6e 653a 0a20   sort is None:. 
-00023c30: 2020 2020 2020 2020 2020 2073 6f72 7420             sort 
-00023c40: 3d20 5472 7565 0a0a 2020 2020 2020 2020  = True..        
-00023c50: 6c65 6e67 7468 203d 204e 6f6e 650a 2020  length = None.  
-00023c60: 2020 2020 2020 6966 2028 7370 6c69 745f        if (split_
-00023c70: 6f75 7420 3e20 3120 6f72 2073 706c 6974  out > 1 or split
-00023c80: 5f6f 7574 2069 7320 5472 7565 2920 616e  _out is True) an
-00023c90: 6420 6e6f 726d 616c 697a 653a 0a20 2020  d normalize:.   
-00023ca0: 2020 2020 2020 2020 2066 7261 6d65 203d           frame =
-00023cb0: 2073 656c 6620 6966 206e 6f74 2064 726f   self if not dro
-00023cc0: 706e 6120 656c 7365 2073 656c 662e 6472  pna else self.dr
-00023cd0: 6f70 6e61 2829 0a20 2020 2020 2020 2020  opna().         
-00023ce0: 2020 206c 656e 6774 6820 3d20 4c65 6e28     length = Len(
-00023cf0: 6672 616d 6529 0a0a 2020 2020 2020 2020  frame)..        
-00023d00: 7265 7475 726e 206e 6577 5f63 6f6c 6c65  return new_colle
-00023d10: 6374 696f 6e28 0a20 2020 2020 2020 2020  ction(.         
-00023d20: 2020 2056 616c 7565 436f 756e 7473 280a     ValueCounts(.
-00023d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023d40: 7365 6c66 2c20 736f 7274 2c20 6173 6365  self, sort, asce
-00023d50: 6e64 696e 672c 2064 726f 706e 612c 206e  nding, dropna, n
-00023d60: 6f72 6d61 6c69 7a65 2c20 7370 6c69 745f  ormalize, split_
-00023d70: 6576 6572 792c 2073 706c 6974 5f6f 7574  every, split_out
-00023d80: 2c20 6c65 6e67 7468 0a20 2020 2020 2020  , length.       
-00023d90: 2020 2020 2029 0a20 2020 2020 2020 2029       ).        )
-00023da0: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
-00023db0: 726f 6d28 7064 2e53 6572 6965 7329 0a20  rom(pd.Series). 
-00023dc0: 2020 2064 6566 206d 6f64 6528 7365 6c66     def mode(self
-00023dd0: 2c20 6472 6f70 6e61 3d54 7275 652c 2073  , dropna=True, s
-00023de0: 706c 6974 5f65 7665 7279 3d46 616c 7365  plit_every=False
-00023df0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-00023e00: 6e20 6e65 775f 636f 6c6c 6563 7469 6f6e  n new_collection
-00023e10: 2873 656c 662e 6578 7072 2e6d 6f64 6528  (self.expr.mode(
-00023e20: 6472 6f70 6e61 2c20 7370 6c69 745f 6576  dropna, split_ev
-00023e30: 6572 7929 290a 0a20 2020 2040 6465 7269  ery))..    @deri
-00023e40: 7665 645f 6672 6f6d 2870 642e 5365 7269  ved_from(pd.Seri
-00023e50: 6573 290a 2020 2020 6465 6620 6e6c 6172  es).    def nlar
-00023e60: 6765 7374 2873 656c 662c 206e 3d35 2c20  gest(self, n=5, 
-00023e70: 7370 6c69 745f 6576 6572 793d 4e6f 6e65  split_every=None
-00023e80: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-00023e90: 6e20 6e65 775f 636f 6c6c 6563 7469 6f6e  n new_collection
-00023ea0: 284e 4c61 7267 6573 7428 7365 6c66 2c20  (NLargest(self, 
-00023eb0: 6e3d 6e2c 2073 706c 6974 5f65 7665 7279  n=n, split_every
-00023ec0: 3d73 706c 6974 5f65 7665 7279 2929 0a0a  =split_every))..
-00023ed0: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
-00023ee0: 6d28 7064 2e53 6572 6965 7329 0a20 2020  m(pd.Series).   
-00023ef0: 2064 6566 206e 736d 616c 6c65 7374 2873   def nsmallest(s
-00023f00: 656c 662c 206e 3d35 2c20 7370 6c69 745f  elf, n=5, split_
-00023f10: 6576 6572 793d 4e6f 6e65 293a 0a20 2020  every=None):.   
-00023f20: 2020 2020 2072 6574 7572 6e20 6e65 775f       return new_
-00023f30: 636f 6c6c 6563 7469 6f6e 284e 536d 616c  collection(NSmal
-00023f40: 6c65 7374 2873 656c 662c 206e 3d6e 2c20  lest(self, n=n, 
-00023f50: 7370 6c69 745f 6576 6572 793d 7370 6c69  split_every=spli
-00023f60: 745f 6576 6572 7929 290a 0a20 2020 2040  t_every))..    @
-00023f70: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
-00023f80: 5365 7269 6573 290a 2020 2020 6465 6620  Series).    def 
-00023f90: 6d65 6d6f 7279 5f75 7361 6765 2873 656c  memory_usage(sel
-00023fa0: 662c 2064 6565 703d 4661 6c73 652c 2069  f, deep=False, i
-00023fb0: 6e64 6578 3d54 7275 6529 3a0a 2020 2020  ndex=True):.    
-00023fc0: 2020 2020 7265 7475 726e 206e 6577 5f63      return new_c
-00023fd0: 6f6c 6c65 6374 696f 6e28 4d65 6d6f 7279  ollection(Memory
-00023fe0: 5573 6167 6546 7261 6d65 2873 656c 662c  UsageFrame(self,
-00023ff0: 2064 6565 703d 6465 6570 2c20 5f69 6e64   deep=deep, _ind
-00024000: 6578 3d69 6e64 6578 2929 0a0a 2020 2020  ex=index))..    
-00024010: 6465 6620 756e 6971 7565 2873 656c 662c  def unique(self,
-00024020: 2073 706c 6974 5f65 7665 7279 3d4e 6f6e   split_every=Non
-00024030: 652c 2073 706c 6974 5f6f 7574 3d54 7275  e, split_out=Tru
-00024040: 652c 2073 6875 6666 6c65 5f6d 6574 686f  e, shuffle_metho
-00024050: 643d 4e6f 6e65 293a 0a20 2020 2020 2020  d=None):.       
-00024060: 2022 2222 0a20 2020 2020 2020 2052 6574   """.        Ret
-00024070: 7572 6e20 5365 7269 6573 206f 6620 756e  urn Series of un
-00024080: 6971 7565 2076 616c 7565 7320 696e 2074  ique values in t
-00024090: 6865 206f 626a 6563 742e 2049 6e63 6c75  he object. Inclu
-000240a0: 6465 7320 4e41 2076 616c 7565 732e 0a0a  des NA values...
-000240b0: 2020 2020 2020 2020 5265 7475 726e 730a          Returns.
-000240c0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0a          -------.
-000240d0: 2020 2020 2020 2020 756e 6971 7565 7320          uniques 
-000240e0: 3a20 5365 7269 6573 0a20 2020 2020 2020  : Series.       
-000240f0: 2022 2222 0a20 2020 2020 2020 2073 6875   """.        shu
-00024100: 6666 6c65 5f6d 6574 686f 6420 3d20 5f67  ffle_method = _g
-00024110: 6574 5f73 6875 6666 6c65 5f70 7265 6665  et_shuffle_prefe
-00024120: 7272 696e 675f 6f72 6465 7228 7368 7566  rring_order(shuf
-00024130: 666c 655f 6d65 7468 6f64 290a 2020 2020  fle_method).    
-00024140: 2020 2020 7265 7475 726e 206e 6577 5f63      return new_c
-00024150: 6f6c 6c65 6374 696f 6e28 556e 6971 7565  ollection(Unique
-00024160: 2873 656c 662c 2073 706c 6974 5f65 7665  (self, split_eve
-00024170: 7279 2c20 7370 6c69 745f 6f75 742c 2073  ry, split_out, s
-00024180: 6875 6666 6c65 5f6d 6574 686f 6429 290a  huffle_method)).
-00024190: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
-000241a0: 6f6d 2870 642e 5365 7269 6573 290a 2020  om(pd.Series).  
-000241b0: 2020 6465 6620 6e75 6e69 7175 6528 7365    def nunique(se
-000241c0: 6c66 2c20 6472 6f70 6e61 3d54 7275 652c  lf, dropna=True,
-000241d0: 2073 706c 6974 5f65 7665 7279 3d46 616c   split_every=Fal
-000241e0: 7365 2c20 7370 6c69 745f 6f75 743d 5472  se, split_out=Tr
-000241f0: 7565 293a 0a20 2020 2020 2020 2075 6e69  ue):.        uni
-00024200: 7173 203d 2073 656c 662e 6472 6f70 5f64  qs = self.drop_d
-00024210: 7570 6c69 6361 7465 7328 7370 6c69 745f  uplicates(split_
-00024220: 6576 6572 793d 7370 6c69 745f 6576 6572  every=split_ever
-00024230: 792c 2073 706c 6974 5f6f 7574 3d73 706c  y, split_out=spl
-00024240: 6974 5f6f 7574 290a 2020 2020 2020 2020  it_out).        
-00024250: 6966 2064 726f 706e 613a 0a20 2020 2020  if dropna:.     
-00024260: 2020 2020 2020 2023 2063 6f75 6e74 206d         # count m
-00024270: 696d 6963 7320 7061 6e64 6173 2062 6568  imics pandas beh
-00024280: 6176 696f 7220 616e 6420 6578 636c 7564  avior and exclud
-00024290: 6573 204e 4120 7661 6c75 6573 0a20 2020  es NA values.   
-000242a0: 2020 2020 2020 2020 2069 6620 6973 696e           if isin
-000242b0: 7374 616e 6365 2875 6e69 7173 2c20 496e  stance(uniqs, In
-000242c0: 6465 7829 3a0a 2020 2020 2020 2020 2020  dex):.          
-000242d0: 2020 2020 2020 756e 6971 7320 3d20 756e        uniqs = un
-000242e0: 6971 732e 746f 5f73 6572 6965 7328 290a  iqs.to_series().
-000242f0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00024300: 726e 2075 6e69 7173 2e63 6f75 6e74 2829  rn uniqs.count()
-00024310: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-00024320: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00024330: 6e20 756e 6971 732e 7369 7a65 0a0a 2020  n uniqs.size..  
-00024340: 2020 6465 6620 6472 6f70 5f64 7570 6c69    def drop_dupli
-00024350: 6361 7465 7328 0a20 2020 2020 2020 2073  cates(.        s
-00024360: 656c 662c 0a20 2020 2020 2020 2069 676e  elf,.        ign
-00024370: 6f72 655f 696e 6465 783d 4661 6c73 652c  ore_index=False,
-00024380: 0a20 2020 2020 2020 2073 706c 6974 5f65  .        split_e
-00024390: 7665 7279 3d4e 6f6e 652c 0a20 2020 2020  very=None,.     
-000243a0: 2020 2073 706c 6974 5f6f 7574 3d54 7275     split_out=Tru
-000243b0: 652c 0a20 2020 2020 2020 2073 6875 6666  e,.        shuff
-000243c0: 6c65 5f6d 6574 686f 643d 4e6f 6e65 2c0a  le_method=None,.
-000243d0: 2020 2020 2020 2020 6b65 6570 3d22 6669          keep="fi
-000243e0: 7273 7422 2c0a 2020 2020 293a 0a20 2020  rst",.    ):.   
-000243f0: 2020 2020 2073 6875 6666 6c65 5f6d 6574       shuffle_met
-00024400: 686f 6420 3d20 5f67 6574 5f73 6875 6666  hod = _get_shuff
-00024410: 6c65 5f70 7265 6665 7272 696e 675f 6f72  le_preferring_or
-00024420: 6465 7228 7368 7566 666c 655f 6d65 7468  der(shuffle_meth
-00024430: 6f64 290a 2020 2020 2020 2020 6966 206b  od).        if k
-00024440: 6565 7020 6973 2046 616c 7365 3a0a 2020  eep is False:.  
-00024450: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00024460: 4e6f 7449 6d70 6c65 6d65 6e74 6564 4572  NotImplementedEr
-00024470: 726f 7228 2264 726f 705f 6475 706c 6963  ror("drop_duplic
-00024480: 6174 6573 2077 6974 6820 6b65 6570 3d46  ates with keep=F
-00024490: 616c 7365 2229 0a20 2020 2020 2020 2072  alse").        r
-000244a0: 6574 7572 6e20 6e65 775f 636f 6c6c 6563  eturn new_collec
-000244b0: 7469 6f6e 280a 2020 2020 2020 2020 2020  tion(.          
-000244c0: 2020 4472 6f70 4475 706c 6963 6174 6573    DropDuplicates
-000244d0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-000244e0: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-000244f0: 2020 2020 2020 2020 6967 6e6f 7265 5f69          ignore_i
-00024500: 6e64 6578 3d69 676e 6f72 655f 696e 6465  ndex=ignore_inde
-00024510: 782c 0a20 2020 2020 2020 2020 2020 2020  x,.             
-00024520: 2020 2073 706c 6974 5f6f 7574 3d73 706c     split_out=spl
-00024530: 6974 5f6f 7574 2c0a 2020 2020 2020 2020  it_out,.        
-00024540: 2020 2020 2020 2020 7370 6c69 745f 6576          split_ev
-00024550: 6572 793d 7370 6c69 745f 6576 6572 792c  ery=split_every,
-00024560: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00024570: 2073 6875 6666 6c65 5f6d 6574 686f 643d   shuffle_method=
-00024580: 7368 7566 666c 655f 6d65 7468 6f64 2c0a  shuffle_method,.
-00024590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000245a0: 6b65 6570 3d6b 6565 702c 0a20 2020 2020  keep=keep,.     
-000245b0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-000245c0: 2029 0a0a 2020 2020 4069 6e73 6572 745f   )..    @insert_
-000245d0: 6d65 7461 5f70 6172 616d 5f64 6573 6372  meta_param_descr
-000245e0: 6970 7469 6f6e 2870 6164 3d31 3229 0a20  iption(pad=12). 
-000245f0: 2020 2064 6566 2061 7070 6c79 2873 656c     def apply(sel
-00024600: 662c 2066 756e 6374 696f 6e2c 202a 6172  f, function, *ar
-00024610: 6773 2c20 6d65 7461 3d6e 6f5f 6465 6661  gs, meta=no_defa
-00024620: 756c 742c 2061 7869 733d 302c 202a 2a6b  ult, axis=0, **k
-00024630: 7761 7267 7329 3a0a 2020 2020 2020 2020  wargs):.        
-00024640: 2222 2250 6172 616c 6c65 6c20 7665 7273  """Parallel vers
-00024650: 696f 6e20 6f66 2070 616e 6461 732e 5365  ion of pandas.Se
-00024660: 7269 6573 2e61 7070 6c79 0a0a 2020 2020  ries.apply..    
-00024670: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
-00024680: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-00024690: 2d0a 2020 2020 2020 2020 6675 6e63 203a  -.        func :
-000246a0: 2066 756e 6374 696f 6e0a 2020 2020 2020   function.      
-000246b0: 2020 2020 2020 4675 6e63 7469 6f6e 2074        Function t
-000246c0: 6f20 6170 706c 790a 2020 2020 2020 2020  o apply.        
-000246d0: 244d 4554 410a 2020 2020 2020 2020 6172  $META.        ar
-000246e0: 6773 203a 2074 7570 6c65 0a20 2020 2020  gs : tuple.     
-000246f0: 2020 2020 2020 2050 6f73 6974 696f 6e61         Positiona
-00024700: 6c20 6172 6775 6d65 6e74 7320 746f 2070  l arguments to p
-00024710: 6173 7320 746f 2066 756e 6374 696f 6e20  ass to function 
-00024720: 696e 2061 6464 6974 696f 6e20 746f 2074  in addition to t
-00024730: 6865 2076 616c 7565 2e0a 0a20 2020 2020  he value...     
-00024740: 2020 2041 6464 6974 696f 6e61 6c20 6b65     Additional ke
-00024750: 7977 6f72 6420 6172 6775 6d65 6e74 7320  yword arguments 
-00024760: 7769 6c6c 2062 6520 7061 7373 6564 2061  will be passed a
-00024770: 7320 6b65 7977 6f72 6473 2074 6f20 7468  s keywords to th
-00024780: 6520 6675 6e63 7469 6f6e 2e0a 0a20 2020  e function...   
-00024790: 2020 2020 2052 6574 7572 6e73 0a20 2020       Returns.   
-000247a0: 2020 2020 202d 2d2d 2d2d 2d2d 0a20 2020       -------.   
-000247b0: 2020 2020 2061 7070 6c69 6564 203a 2053       applied : S
-000247c0: 6572 6965 7320 6f72 2044 6174 6146 7261  eries or DataFra
-000247d0: 6d65 2069 6620 6675 6e63 2072 6574 7572  me if func retur
-000247e0: 6e73 2061 2053 6572 6965 732e 0a0a 2020  ns a Series...  
-000247f0: 2020 2020 2020 4578 616d 706c 6573 0a20        Examples. 
-00024800: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d0a         --------.
-00024810: 2020 2020 2020 2020 3e3e 3e20 696d 706f          >>> impo
-00024820: 7274 2064 6173 6b2e 6461 7461 6672 616d  rt dask.datafram
-00024830: 6520 6173 2064 640a 2020 2020 2020 2020  e as dd.        
-00024840: 3e3e 3e20 7320 3d20 7064 2e53 6572 6965  >>> s = pd.Serie
-00024850: 7328 7261 6e67 6528 3529 2c20 6e61 6d65  s(range(5), name
-00024860: 3d27 7827 290a 2020 2020 2020 2020 3e3e  ='x').        >>
-00024870: 3e20 6473 203d 2064 642e 6672 6f6d 5f70  > ds = dd.from_p
-00024880: 616e 6461 7328 732c 206e 7061 7274 6974  andas(s, npartit
-00024890: 696f 6e73 3d32 290a 0a20 2020 2020 2020  ions=2)..       
-000248a0: 2041 7070 6c79 2061 2066 756e 6374 696f   Apply a functio
-000248b0: 6e20 656c 656d 656e 7477 6973 6520 6163  n elementwise ac
-000248c0: 726f 7373 2074 6865 2053 6572 6965 732c  ross the Series,
-000248d0: 2070 6173 7369 6e67 2069 6e20 6578 7472   passing in extr
-000248e0: 610a 2020 2020 2020 2020 6172 6775 6d65  a.        argume
-000248f0: 6e74 7320 696e 2060 6061 7267 7360 6020  nts in ``args`` 
-00024900: 616e 6420 6060 6b77 6172 6773 6060 3a0a  and ``kwargs``:.
-00024910: 0a20 2020 2020 2020 203e 3e3e 2064 6566  .        >>> def
-00024920: 206d 7961 6464 2878 2c20 612c 2062 3d31   myadd(x, a, b=1
-00024930: 293a 0a20 2020 2020 2020 202e 2e2e 2020  ):.        ...  
-00024940: 2020 2072 6574 7572 6e20 7820 2b20 6120     return x + a 
-00024950: 2b20 620a 2020 2020 2020 2020 3e3e 3e20  + b.        >>> 
-00024960: 7265 7320 3d20 6473 2e61 7070 6c79 286d  res = ds.apply(m
-00024970: 7961 6464 2c20 6172 6773 3d28 322c 292c  yadd, args=(2,),
-00024980: 2062 3d31 2e35 2920 2023 2064 6f63 7465   b=1.5)  # docte
-00024990: 7374 3a20 2b53 4b49 500a 0a20 2020 2020  st: +SKIP..     
-000249a0: 2020 2042 7920 6465 6661 756c 742c 2064     By default, d
-000249b0: 6173 6b20 7472 6965 7320 746f 2069 6e66  ask tries to inf
-000249c0: 6572 2074 6865 206f 7574 7075 7420 6d65  er the output me
-000249d0: 7461 6461 7461 2062 7920 7275 6e6e 696e  tadata by runnin
-000249e0: 6720 796f 7572 0a20 2020 2020 2020 2070  g your.        p
-000249f0: 726f 7669 6465 6420 6675 6e63 7469 6f6e  rovided function
-00024a00: 206f 6e20 736f 6d65 2066 616b 6520 6461   on some fake da
-00024a10: 7461 2e20 5468 6973 2077 6f72 6b73 2077  ta. This works w
-00024a20: 656c 6c20 696e 206d 616e 7920 6361 7365  ell in many case
-00024a30: 732c 2062 7574 0a20 2020 2020 2020 2063  s, but.        c
-00024a40: 616e 2073 6f6d 6574 696d 6573 2062 6520  an sometimes be 
-00024a50: 6578 7065 6e73 6976 652c 206f 7220 6576  expensive, or ev
-00024a60: 656e 2066 6169 6c2e 2054 6f20 6176 6f69  en fail. To avoi
-00024a70: 6420 7468 6973 2c20 796f 7520 6361 6e0a  d this, you can.
-00024a80: 2020 2020 2020 2020 6d61 6e75 616c 6c79          manually
-00024a90: 2073 7065 6369 6679 2074 6865 206f 7574   specify the out
-00024aa0: 7075 7420 6d65 7461 6461 7461 2077 6974  put metadata wit
-00024ab0: 6820 7468 6520 6060 6d65 7461 6060 206b  h the ``meta`` k
-00024ac0: 6579 776f 7264 2e20 5468 6973 0a20 2020  eyword. This.   
-00024ad0: 2020 2020 2063 616e 2062 6520 7370 6563       can be spec
-00024ae0: 6966 6965 6420 696e 206d 616e 7920 666f  ified in many fo
-00024af0: 726d 732c 2066 6f72 206d 6f72 6520 696e  rms, for more in
-00024b00: 666f 726d 6174 696f 6e20 7365 650a 2020  formation see.  
-00024b10: 2020 2020 2020 6060 6461 736b 2e64 6174        ``dask.dat
-00024b20: 6166 7261 6d65 2e75 7469 6c73 2e6d 616b  aframe.utils.mak
-00024b30: 655f 6d65 7461 6060 2e0a 0a20 2020 2020  e_meta``...     
-00024b40: 2020 2048 6572 6520 7765 2073 7065 6369     Here we speci
-00024b50: 6679 2074 6865 206f 7574 7075 7420 6973  fy the output is
-00024b60: 2061 2053 6572 6965 7320 7769 7468 206e   a Series with n
-00024b70: 616d 6520 6060 2778 2760 602c 2061 6e64  ame ``'x'``, and
-00024b80: 2064 7479 7065 0a20 2020 2020 2020 2060   dtype.        `
-00024b90: 6066 6c6f 6174 3634 6060 3a0a 0a20 2020  `float64``:..   
-00024ba0: 2020 2020 203e 3e3e 2072 6573 203d 2064       >>> res = d
-00024bb0: 732e 6170 706c 7928 6d79 6164 642c 2061  s.apply(myadd, a
-00024bc0: 7267 733d 2832 2c29 2c20 623d 312e 352c  rgs=(2,), b=1.5,
-00024bd0: 206d 6574 613d 2827 7827 2c20 2766 3827   meta=('x', 'f8'
-00024be0: 2929 0a0a 2020 2020 2020 2020 496e 2074  ))..        In t
-00024bf0: 6865 2063 6173 6520 7768 6572 6520 7468  he case where th
-00024c00: 6520 6d65 7461 6461 7461 2064 6f65 736e  e metadata doesn
-00024c10: 2774 2063 6861 6e67 652c 2079 6f75 2063  't change, you c
-00024c20: 616e 2061 6c73 6f20 7061 7373 2069 6e0a  an also pass in.
-00024c30: 2020 2020 2020 2020 7468 6520 6f62 6a65          the obje
-00024c40: 6374 2069 7473 656c 6620 6469 7265 6374  ct itself direct
-00024c50: 6c79 3a0a 0a20 2020 2020 2020 203e 3e3e  ly:..        >>>
-00024c60: 2072 6573 203d 2064 732e 6170 706c 7928   res = ds.apply(
-00024c70: 6c61 6d62 6461 2078 3a20 7820 2b20 312c  lambda x: x + 1,
-00024c80: 206d 6574 613d 6473 290a 0a20 2020 2020   meta=ds)..     
-00024c90: 2020 2053 6565 2041 6c73 6f0a 2020 2020     See Also.    
-00024ca0: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
-00024cb0: 2020 2020 2053 6572 6965 732e 6d61 705f       Series.map_
-00024cc0: 7061 7274 6974 696f 6e73 0a20 2020 2020  partitions.     
-00024cd0: 2020 2022 2222 0a20 2020 2020 2020 2073     """.        s
-00024ce0: 656c 662e 5f76 616c 6964 6174 655f 6178  elf._validate_ax
-00024cf0: 6973 2861 7869 7329 0a20 2020 2020 2020  is(axis).       
-00024d00: 2069 6620 6d65 7461 2069 7320 6e6f 5f64   if meta is no_d
-00024d10: 6566 6175 6c74 3a0a 2020 2020 2020 2020  efault:.        
-00024d20: 2020 2020 6d65 7461 203d 2065 7870 722e      meta = expr.
-00024d30: 5f65 6d75 6c61 7465 284d 2e61 7070 6c79  _emulate(M.apply
-00024d40: 2c20 7365 6c66 2c20 6675 6e63 7469 6f6e  , self, function
-00024d50: 2c20 6172 6773 3d61 7267 732c 2075 6466  , args=args, udf
-00024d60: 3d54 7275 652c 202a 2a6b 7761 7267 7329  =True, **kwargs)
-00024d70: 0a20 2020 2020 2020 2020 2020 2077 6172  .            war
-00024d80: 6e69 6e67 732e 7761 726e 286d 6574 615f  nings.warn(meta_
-00024d90: 7761 726e 696e 6728 6d65 7461 2929 0a20  warning(meta)). 
-00024da0: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
-00024db0: 775f 636f 6c6c 6563 7469 6f6e 2873 656c  w_collection(sel
-00024dc0: 662e 6578 7072 2e61 7070 6c79 2866 756e  f.expr.apply(fun
-00024dd0: 6374 696f 6e2c 202a 6172 6773 2c20 6d65  ction, *args, me
-00024de0: 7461 3d6d 6574 612c 202a 2a6b 7761 7267  ta=meta, **kwarg
-00024df0: 7329 290a 0a20 2020 2040 636c 6173 736d  s))..    @classm
-00024e00: 6574 686f 640a 2020 2020 6465 6620 5f76  ethod.    def _v
-00024e10: 616c 6964 6174 655f 6178 6973 2863 6c73  alidate_axis(cls
-00024e20: 2c20 6178 6973 3d30 2c20 6e75 6d65 7269  , axis=0, numeri
-00024e30: 635f 6178 6973 3a20 626f 6f6c 203d 2054  c_axis: bool = T
-00024e40: 7275 6529 202d 3e20 4e6f 6e65 207c 204c  rue) -> None | L
-00024e50: 6974 6572 616c 5b30 2c20 315d 3a0a 2020  iteral[0, 1]:.  
-00024e60: 2020 2020 2020 6966 2061 7869 7320 6e6f        if axis no
-00024e70: 7420 696e 2028 302c 2022 696e 6465 7822  t in (0, "index"
-00024e80: 2c20 4e6f 6e65 293a 0a20 2020 2020 2020  , None):.       
-00024e90: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-00024ea0: 4572 726f 7228 6622 4e6f 2061 7869 7320  Error(f"No axis 
-00024eb0: 6e61 6d65 6420 7b61 7869 737d 2066 6f72  named {axis} for
-00024ec0: 2053 6572 6965 7322 290a 2020 2020 2020   Series").      
-00024ed0: 2020 6966 206e 756d 6572 6963 5f61 7869    if numeric_axi
-00024ee0: 733a 0a20 2020 2020 2020 2020 2020 206e  s:.            n
-00024ef0: 756d 5f61 7869 733a 2064 6963 745b 7374  um_axis: dict[st
-00024f00: 7220 7c20 4e6f 6e65 2c20 4c69 7465 7261  r | None, Litera
-00024f10: 6c5b 302c 2031 5d5d 203d 207b 2269 6e64  l[0, 1]] = {"ind
-00024f20: 6578 223a 2030 7d0a 2020 2020 2020 2020  ex": 0}.        
-00024f30: 2020 2020 7265 7475 726e 206e 756d 5f61      return num_a
-00024f40: 7869 732e 6765 7428 6178 6973 2c20 6178  xis.get(axis, ax
-00024f50: 6973 290a 2020 2020 2020 2020 656c 7365  is).        else
-00024f60: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-00024f70: 7475 726e 2061 7869 730a 0a20 2020 2040  turn axis..    @
-00024f80: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
-00024f90: 5365 7269 6573 290a 2020 2020 6465 6620  Series).    def 
-00024fa0: 7371 7565 657a 6528 7365 6c66 293a 0a20  squeeze(self):. 
-00024fb0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00024fc0: 6c66 0a0a 2020 2020 4064 6572 6976 6564  lf..    @derived
-00024fd0: 5f66 726f 6d28 7064 2e53 6572 6965 7329  _from(pd.Series)
-00024fe0: 0a20 2020 2064 6566 2064 726f 706e 6128  .    def dropna(
-00024ff0: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
-00025000: 6574 7572 6e20 6e65 775f 636f 6c6c 6563  eturn new_collec
-00025010: 7469 6f6e 2865 7870 722e 4472 6f70 6e61  tion(expr.Dropna
-00025020: 5365 7269 6573 2873 656c 6629 290a 0a20  Series(self)).. 
-00025030: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
-00025040: 2870 642e 5365 7269 6573 290a 2020 2020  (pd.Series).    
-00025050: 6465 6620 6265 7477 6565 6e28 7365 6c66  def between(self
-00025060: 2c20 6c65 6674 2c20 7269 6768 742c 2069  , left, right, i
-00025070: 6e63 6c75 7369 7665 3d22 626f 7468 2229  nclusive="both")
-00025080: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00025090: 206e 6577 5f63 6f6c 6c65 6374 696f 6e28   new_collection(
-000250a0: 0a20 2020 2020 2020 2020 2020 2065 7870  .            exp
-000250b0: 722e 4265 7477 6565 6e28 7365 6c66 2c20  r.Between(self, 
-000250c0: 6c65 6674 3d6c 6566 742c 2072 6967 6874  left=left, right
-000250d0: 3d72 6967 6874 2c20 696e 636c 7573 6976  =right, inclusiv
-000250e0: 653d 696e 636c 7573 6976 6529 0a20 2020  e=inclusive).   
-000250f0: 2020 2020 2029 0a0a 2020 2020 4064 6572       )..    @der
-00025100: 6976 6564 5f66 726f 6d28 7064 2e53 6572  ived_from(pd.Ser
-00025110: 6965 7329 0a20 2020 2064 6566 2063 6f6d  ies).    def com
-00025120: 6269 6e65 2873 656c 662c 206f 7468 6572  bine(self, other
-00025130: 2c20 6675 6e63 2c20 6669 6c6c 5f76 616c  , func, fill_val
-00025140: 7565 3d4e 6f6e 6529 3a0a 2020 2020 2020  ue=None):.      
-00025150: 2020 6f74 6865 7220 3d20 7365 6c66 2e5f    other = self._
-00025160: 6372 6561 7465 5f61 6c69 676e 6162 6c65  create_alignable
-00025170: 5f66 7261 6d65 286f 7468 6572 2c20 226f  _frame(other, "o
-00025180: 7574 6572 2229 0a20 2020 2020 2020 2069  uter").        i
-00025190: 6620 6e6f 7420 6578 7072 2e61 7265 5f63  f not expr.are_c
-000251a0: 6f5f 616c 6967 6e65 6428 7365 6c66 2e65  o_aligned(self.e
-000251b0: 7870 722c 206f 7468 6572 2e65 7870 7229  xpr, other.expr)
-000251c0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-000251d0: 7475 726e 206e 6577 5f63 6f6c 6c65 6374  turn new_collect
-000251e0: 696f 6e28 0a20 2020 2020 2020 2020 2020  ion(.           
-000251f0: 2020 2020 2065 7870 722e 436f 6d62 696e       expr.Combin
-00025200: 6553 6572 6965 7341 6c69 676e 2873 656c  eSeriesAlign(sel
-00025210: 662c 206f 7468 6572 2c20 6675 6e63 2c20  f, other, func, 
-00025220: 6669 6c6c 5f76 616c 7565 290a 2020 2020  fill_value).    
-00025230: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00025240: 2020 7265 7475 726e 206e 6577 5f63 6f6c    return new_col
-00025250: 6c65 6374 696f 6e28 6578 7072 2e43 6f6d  lection(expr.Com
-00025260: 6269 6e65 5365 7269 6573 2873 656c 662c  bineSeries(self,
-00025270: 206f 7468 6572 2c20 6675 6e63 2c20 6669   other, func, fi
-00025280: 6c6c 5f76 616c 7565 2929 0a0a 2020 2020  ll_value))..    
-00025290: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
-000252a0: 2e53 6572 6965 7329 0a20 2020 2064 6566  .Series).    def
-000252b0: 2065 7870 6c6f 6465 2873 656c 6629 3a0a   explode(self):.
-000252c0: 2020 2020 2020 2020 7265 7475 726e 206e          return n
-000252d0: 6577 5f63 6f6c 6c65 6374 696f 6e28 6578  ew_collection(ex
-000252e0: 7072 2e45 7870 6c6f 6465 5365 7269 6573  pr.ExplodeSeries
-000252f0: 2873 656c 6629 290a 0a20 2020 2040 6465  (self))..    @de
-00025300: 7269 7665 645f 6672 6f6d 2870 642e 5365  rived_from(pd.Se
-00025310: 7269 6573 290a 2020 2020 6465 6620 6164  ries).    def ad
-00025320: 645f 7072 6566 6978 2873 656c 662c 2070  d_prefix(self, p
-00025330: 7265 6669 7829 3a0a 2020 2020 2020 2020  refix):.        
-00025340: 7265 7475 726e 206e 6577 5f63 6f6c 6c65  return new_colle
-00025350: 6374 696f 6e28 6578 7072 2e41 6464 5072  ction(expr.AddPr
-00025360: 6566 6978 5365 7269 6573 2873 656c 662c  efixSeries(self,
-00025370: 2070 7265 6669 7829 290a 0a20 2020 2040   prefix))..    @
-00025380: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
-00025390: 5365 7269 6573 290a 2020 2020 6465 6620  Series).    def 
-000253a0: 6164 645f 7375 6666 6978 2873 656c 662c  add_suffix(self,
-000253b0: 2073 7566 6669 7829 3a0a 2020 2020 2020   suffix):.      
-000253c0: 2020 7265 7475 726e 206e 6577 5f63 6f6c    return new_col
-000253d0: 6c65 6374 696f 6e28 6578 7072 2e41 6464  lection(expr.Add
-000253e0: 5375 6666 6978 5365 7269 6573 2873 656c  SuffixSeries(sel
-000253f0: 662c 2073 7566 6669 7829 290a 0a20 2020  f, suffix))..   
-00025400: 2063 6174 203d 2043 6163 6865 6441 6363   cat = CachedAcc
-00025410: 6573 736f 7228 2263 6174 222c 2043 6174  essor("cat", Cat
-00025420: 6567 6f72 6963 616c 4163 6365 7373 6f72  egoricalAccessor
-00025430: 290a 2020 2020 6474 203d 2043 6163 6865  ).    dt = Cache
-00025440: 6441 6363 6573 736f 7228 2264 7422 2c20  dAccessor("dt", 
-00025450: 4461 7465 7469 6d65 4163 6365 7373 6f72  DatetimeAccessor
-00025460: 290a 2020 2020 7374 7220 3d20 4361 6368  ).    str = Cach
-00025470: 6564 4163 6365 7373 6f72 2822 7374 7222  edAccessor("str"
-00025480: 2c20 5374 7269 6e67 4163 6365 7373 6f72  , StringAccessor
-00025490: 290a 0a20 2020 2064 6566 205f 7265 7061  )..    def _repa
-000254a0: 7274 6974 696f 6e5f 7175 616e 7469 6c65  rtition_quantile
-000254b0: 7328 7365 6c66 2c20 6e70 6172 7469 7469  s(self, npartiti
-000254c0: 6f6e 732c 2075 7073 616d 706c 653d 312e  ons, upsample=1.
-000254d0: 302c 2072 616e 646f 6d5f 7374 6174 653d  0, random_state=
-000254e0: 4e6f 6e65 293a 0a20 2020 2020 2020 2072  None):.        r
-000254f0: 6574 7572 6e20 6e65 775f 636f 6c6c 6563  eturn new_collec
-00025500: 7469 6f6e 280a 2020 2020 2020 2020 2020  tion(.          
-00025510: 2020 5265 7061 7274 6974 696f 6e51 7561    RepartitionQua
-00025520: 6e74 696c 6573 2873 656c 662c 206e 7061  ntiles(self, npa
-00025530: 7274 6974 696f 6e73 2c20 7570 7361 6d70  rtitions, upsamp
-00025540: 6c65 2c20 7261 6e64 6f6d 5f73 7461 7465  le, random_state
-00025550: 290a 2020 2020 2020 2020 290a 0a20 2020  ).        )..   
-00025560: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
-00025570: 642e 5365 7269 6573 290a 2020 2020 6465  d.Series).    de
-00025580: 6620 6772 6f75 7062 7928 7365 6c66 2c20  f groupby(self, 
-00025590: 6279 2c20 2a2a 6b77 6172 6773 293a 0a20  by, **kwargs):. 
-000255a0: 2020 2020 2020 2066 726f 6d20 6461 736b         from dask
-000255b0: 5f65 7870 722e 5f67 726f 7570 6279 2069  _expr._groupby i
-000255c0: 6d70 6f72 7420 5365 7269 6573 4772 6f75  mport SeriesGrou
-000255d0: 7042 790a 0a20 2020 2020 2020 2072 6574  pBy..        ret
-000255e0: 7572 6e20 5365 7269 6573 4772 6f75 7042  urn SeriesGroupB
-000255f0: 7928 7365 6c66 2c20 6279 2c20 2a2a 6b77  y(self, by, **kw
-00025600: 6172 6773 290a 0a20 2020 2064 6566 2072  args)..    def r
-00025610: 656e 616d 6528 7365 6c66 2c20 696e 6465  ename(self, inde
-00025620: 782c 2073 6f72 7465 645f 696e 6465 783d  x, sorted_index=
-00025630: 4661 6c73 6529 3a0a 2020 2020 2020 2020  False):.        
-00025640: 2222 2241 6c74 6572 2053 6572 6965 7320  """Alter Series 
-00025650: 696e 6465 7820 6c61 6265 6c73 206f 7220  index labels or 
-00025660: 6e61 6d65 0a0a 2020 2020 2020 2020 4675  name..        Fu
-00025670: 6e63 7469 6f6e 202f 2064 6963 7420 7661  nction / dict va
-00025680: 6c75 6573 206d 7573 7420 6265 2075 6e69  lues must be uni
-00025690: 7175 6520 2831 2d74 6f2d 3129 2e20 4c61  que (1-to-1). La
-000256a0: 6265 6c73 206e 6f74 2063 6f6e 7461 696e  bels not contain
-000256b0: 6564 2069 6e0a 2020 2020 2020 2020 6120  ed in.        a 
-000256c0: 6469 6374 202f 2053 6572 6965 7320 7769  dict / Series wi
-000256d0: 6c6c 2062 6520 6c65 6674 2061 732d 6973  ll be left as-is
-000256e0: 2e20 4578 7472 6120 6c61 6265 6c73 206c  . Extra labels l
-000256f0: 6973 7465 6420 646f 6e27 7420 7468 726f  isted don't thro
-00025700: 7720 616e 0a20 2020 2020 2020 2065 7272  w an.        err
-00025710: 6f72 2e0a 0a20 2020 2020 2020 2041 6c74  or...        Alt
-00025720: 6572 6e61 7469 7665 6c79 2c20 6368 616e  ernatively, chan
-00025730: 6765 2060 6053 6572 6965 732e 6e61 6d65  ge ``Series.name
-00025740: 6060 2077 6974 6820 6120 7363 616c 6172  `` with a scalar
-00025750: 2076 616c 7565 2e0a 0a20 2020 2020 2020   value...       
-00025760: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-00025770: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
-00025780: 2020 2020 2020 2069 6e64 6578 203a 2073         index : s
-00025790: 6361 6c61 722c 2068 6173 6861 626c 6520  calar, hashable 
-000257a0: 7365 7175 656e 6365 2c20 6469 6374 2d6c  sequence, dict-l
-000257b0: 696b 6520 6f72 2063 616c 6c61 626c 652c  ike or callable,
-000257c0: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-000257d0: 2020 2020 2020 4966 2064 6963 742d 6c69        If dict-li
-000257e0: 6b65 206f 7220 6361 6c6c 6162 6c65 2c20  ke or callable, 
-000257f0: 7468 6520 7472 616e 7366 6f72 6d61 7469  the transformati
-00025800: 6f6e 2069 7320 6170 706c 6965 6420 746f  on is applied to
-00025810: 2074 6865 0a20 2020 2020 2020 2020 2020   the.           
-00025820: 2069 6e64 6578 2e20 5363 616c 6172 206f   index. Scalar o
-00025830: 7220 6861 7368 6162 6c65 2073 6571 7565  r hashable seque
-00025840: 6e63 652d 6c69 6b65 2077 696c 6c20 616c  nce-like will al
-00025850: 7465 7220 7468 650a 2020 2020 2020 2020  ter the.        
-00025860: 2020 2020 6060 5365 7269 6573 2e6e 616d      ``Series.nam
-00025870: 6560 6020 6174 7472 6962 7574 652e 0a20  e`` attribute.. 
-00025880: 2020 2020 2020 2069 6e70 6c61 6365 203a         inplace :
-00025890: 2062 6f6f 6c65 616e 2c20 6465 6661 756c   boolean, defaul
-000258a0: 7420 4661 6c73 650a 2020 2020 2020 2020  t False.        
-000258b0: 2020 2020 5768 6574 6865 7220 746f 2072      Whether to r
-000258c0: 6574 7572 6e20 6120 6e65 7720 5365 7269  eturn a new Seri
-000258d0: 6573 206f 7220 6d6f 6469 6679 2074 6869  es or modify thi
-000258e0: 7320 6f6e 6520 696e 706c 6163 652e 0a20  s one inplace.. 
-000258f0: 2020 2020 2020 2073 6f72 7465 645f 696e         sorted_in
-00025900: 6465 7820 3a20 626f 6f6c 2c20 6465 6661  dex : bool, defa
-00025910: 756c 7420 4661 6c73 650a 2020 2020 2020  ult False.      
-00025920: 2020 2020 2020 4966 2074 7275 652c 2074        If true, t
-00025930: 6865 206f 7574 7075 7420 6060 5365 7269  he output ``Seri
-00025940: 6573 6060 2077 696c 6c20 6861 7665 206b  es`` will have k
-00025950: 6e6f 776e 2064 6976 6973 696f 6e73 2069  nown divisions i
-00025960: 6e66 6572 7265 640a 2020 2020 2020 2020  nferred.        
-00025970: 2020 2020 6672 6f6d 2074 6865 2069 6e70      from the inp
-00025980: 7574 2073 6572 6965 7320 616e 6420 7468  ut series and th
-00025990: 6520 7472 616e 7366 6f72 6d61 7469 6f6e  e transformation
-000259a0: 2e20 4967 6e6f 7265 6420 666f 720a 2020  . Ignored for.  
-000259b0: 2020 2020 2020 2020 2020 6e6f 6e2d 6361            non-ca
-000259c0: 6c6c 6162 6c65 2f64 6963 742d 6c69 6b65  llable/dict-like
-000259d0: 2060 6069 6e64 6578 6060 206f 7220 7768   ``index`` or wh
-000259e0: 656e 2074 6865 2069 6e70 7574 2073 6572  en the input ser
-000259f0: 6965 7320 6861 730a 2020 2020 2020 2020  ies has.        
-00025a00: 2020 2020 756e 6b6e 6f77 6e20 6469 7669      unknown divi
-00025a10: 7369 6f6e 732e 204e 6f74 6520 7468 6174  sions. Note that
-00025a20: 2074 6869 7320 6d61 7920 6f6e 6c79 2062   this may only b
-00025a30: 6520 7365 7420 746f 2060 6054 7275 6560  e set to ``True`
-00025a40: 6020 6966 0a20 2020 2020 2020 2020 2020  ` if.           
-00025a50: 2079 6f75 206b 6e6f 7720 7468 6174 2074   you know that t
-00025a60: 6865 2074 7261 6e73 666f 726d 6564 2069  he transformed i
-00025a70: 6e64 6578 2069 7320 6d6f 6e6f 746f 6e69  ndex is monotoni
-00025a80: 6361 6c6c 7920 696e 6372 6561 7369 6e67  cally increasing
-00025a90: 2e20 4461 736b 0a20 2020 2020 2020 2020  . Dask.         
-00025aa0: 2020 2077 696c 6c20 6368 6563 6b20 7468     will check th
-00025ab0: 6174 2074 7261 6e73 666f 726d 6564 2064  at transformed d
-00025ac0: 6976 6973 696f 6e73 2061 7265 206d 6f6e  ivisions are mon
-00025ad0: 6f74 6f6e 6963 2c20 6275 7420 6361 6e6e  otonic, but cann
-00025ae0: 6f74 0a20 2020 2020 2020 2020 2020 2063  ot.            c
-00025af0: 6865 636b 2061 6c6c 2074 6865 2076 616c  heck all the val
-00025b00: 7565 7320 6265 7477 6565 6e20 6469 7669  ues between divi
-00025b10: 7369 6f6e 732c 2073 6f20 696e 636f 7272  sions, so incorr
-00025b20: 6563 746c 7920 7365 7474 696e 6720 7468  ectly setting th
-00025b30: 6973 0a20 2020 2020 2020 2020 2020 2063  is.            c
-00025b40: 616e 2072 6573 756c 7420 696e 2062 7567  an result in bug
-00025b50: 732e 0a0a 2020 2020 2020 2020 5265 7475  s...        Retu
-00025b60: 726e 730a 2020 2020 2020 2020 2d2d 2d2d  rns.        ----
-00025b70: 2d2d 2d0a 2020 2020 2020 2020 7265 6e61  ---.        rena
-00025b80: 6d65 6420 3a20 5365 7269 6573 0a0a 2020  med : Series..  
-00025b90: 2020 2020 2020 5365 6520 416c 736f 0a20        See Also. 
-00025ba0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d0a         --------.
-00025bb0: 2020 2020 2020 2020 7061 6e64 6173 2e53          pandas.S
-00025bc0: 6572 6965 732e 7265 6e61 6d65 0a20 2020  eries.rename.   
-00025bd0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00025be0: 2072 6574 7572 6e20 6e65 775f 636f 6c6c   return new_coll
-00025bf0: 6563 7469 6f6e 2865 7870 722e 5265 6e61  ection(expr.Rena
-00025c00: 6d65 5365 7269 6573 2873 656c 662c 2069  meSeries(self, i
-00025c10: 6e64 6578 2c20 736f 7274 6564 5f69 6e64  ndex, sorted_ind
-00025c20: 6578 2929 0a0a 2020 2020 6465 6620 7175  ex))..    def qu
-00025c30: 616e 7469 6c65 2873 656c 662c 2071 3d30  antile(self, q=0
-00025c40: 2e35 2c20 6d65 7468 6f64 3d22 6465 6661  .5, method="defa
-00025c50: 756c 7422 293a 0a20 2020 2020 2020 2022  ult"):.        "
-00025c60: 2222 4170 7072 6f78 696d 6174 6520 7175  ""Approximate qu
-00025c70: 616e 7469 6c65 7320 6f66 2053 6572 6965  antiles of Serie
-00025c80: 730a 0a20 2020 2020 2020 2050 6172 616d  s..        Param
-00025c90: 6574 6572 730a 2020 2020 2020 2020 2d2d  eters.        --
-00025ca0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00025cb0: 2071 203a 206c 6973 742f 6172 7261 7920   q : list/array 
-00025cc0: 6f66 2066 6c6f 6174 732c 2064 6566 6175  of floats, defau
-00025cd0: 6c74 2030 2e35 2028 3530 2529 0a20 2020  lt 0.5 (50%).   
-00025ce0: 2020 2020 2020 2020 2049 7465 7261 626c           Iterabl
-00025cf0: 6520 6f66 206e 756d 6265 7273 2072 616e  e of numbers ran
-00025d00: 6769 6e67 2066 726f 6d20 3020 746f 2031  ging from 0 to 1
-00025d10: 2066 6f72 2074 6865 2064 6573 6972 6564   for the desired
-00025d20: 2071 7561 6e74 696c 6573 0a20 2020 2020   quantiles.     
-00025d30: 2020 206d 6574 686f 6420 3a20 7b27 6465     method : {'de
-00025d40: 6661 756c 7427 2c20 2774 6469 6765 7374  fault', 'tdigest
-00025d50: 272c 2027 6461 736b 277d 2c20 6f70 7469  ', 'dask'}, opti
-00025d60: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
-00025d70: 2057 6861 7420 6d65 7468 6f64 2074 6f20   What method to 
-00025d80: 7573 652e 2042 7920 6465 6661 756c 7420  use. By default 
-00025d90: 7769 6c6c 2075 7365 2064 6173 6b27 7320  will use dask's 
-00025da0: 696e 7465 726e 616c 2063 7573 746f 6d0a  internal custom.
-00025db0: 2020 2020 2020 2020 2020 2020 616c 676f              algo
-00025dc0: 7269 7468 6d20 2860 6027 6461 736b 2760  rithm (``'dask'`
-00025dd0: 6029 2e20 2049 6620 7365 7420 746f 2060  `).  If set to `
-00025de0: 6027 7464 6967 6573 7427 6060 2077 696c  `'tdigest'`` wil
-00025df0: 6c20 7573 6520 7464 6967 6573 740a 2020  l use tdigest.  
-00025e00: 2020 2020 2020 2020 2020 666f 7220 666c            for fl
-00025e10: 6f61 7473 2061 6e64 2069 6e74 7320 616e  oats and ints an
-00025e20: 6420 6661 6c6c 6261 636b 2074 6f20 7468  d fallback to th
-00025e30: 6520 6060 2764 6173 6b27 6060 206f 7468  e ``'dask'`` oth
-00025e40: 6572 7769 7365 2e0a 2020 2020 2020 2020  erwise..        
-00025e50: 2222 220a 2020 2020 2020 2020 5f72 6169  """.        _rai
-00025e60: 7365 5f69 665f 6f62 6a65 6374 5f73 6572  se_if_object_ser
-00025e70: 6965 7328 7365 6c66 2c20 2271 7561 6e74  ies(self, "quant
-00025e80: 696c 6522 290a 2020 2020 2020 2020 616c  ile").        al
-00025e90: 6c6f 7765 645f 6d65 7468 6f64 7320 3d20  lowed_methods = 
-00025ea0: 5b22 6465 6661 756c 7422 2c20 2264 6173  ["default", "das
-00025eb0: 6b22 2c20 2274 6469 6765 7374 225d 0a20  k", "tdigest"]. 
-00025ec0: 2020 2020 2020 2069 6620 6d65 7468 6f64         if method
-00025ed0: 206e 6f74 2069 6e20 616c 6c6f 7765 645f   not in allowed_
-00025ee0: 6d65 7468 6f64 733a 0a20 2020 2020 2020  methods:.       
-00025ef0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-00025f00: 4572 726f 7228 226d 6574 686f 6420 6361  Error("method ca
-00025f10: 6e20 6f6e 6c79 2062 6520 2764 6566 6175  n only be 'defau
-00025f20: 6c74 272c 2027 6461 736b 2720 6f72 2027  lt', 'dask' or '
-00025f30: 7464 6967 6573 7427 2229 0a20 2020 2020  tdigest'").     
-00025f40: 2020 2072 6574 7572 6e20 6e65 775f 636f     return new_co
-00025f50: 6c6c 6563 7469 6f6e 2853 6572 6965 7351  llection(SeriesQ
-00025f60: 7561 6e74 696c 6528 7365 6c66 2c20 712c  uantile(self, q,
-00025f70: 206d 6574 686f 6429 290a 0a20 2020 2040   method))..    @
-00025f80: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
-00025f90: 5365 7269 6573 290a 2020 2020 6465 6620  Series).    def 
-00025fa0: 6d65 6469 616e 2873 656c 6629 3a0a 2020  median(self):.  
-00025fb0: 2020 2020 2020 6966 2073 656c 662e 6e70        if self.np
-00025fc0: 6172 7469 7469 6f6e 7320 3d3d 2031 3a0a  artitions == 1:.
-00025fd0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00025fe0: 726e 2073 656c 662e 6d65 6469 616e 5f61  rn self.median_a
-00025ff0: 7070 726f 7869 6d61 7465 2829 0a20 2020  pproximate().   
-00026000: 2020 2020 2072 6169 7365 204e 6f74 496d       raise NotIm
-00026010: 706c 656d 656e 7465 6445 7272 6f72 280a  plementedError(.
-00026020: 2020 2020 2020 2020 2020 2020 2244 6173              "Das
-00026030: 6b20 646f 6573 6e27 7420 696d 706c 656d  k doesn't implem
-00026040: 656e 7420 616e 2065 7861 6374 206d 6564  ent an exact med
-00026050: 6961 6e20 696e 2061 6c6c 2063 6173 6573  ian in all cases
-00026060: 2061 7320 7468 6973 2069 7320 6861 7264   as this is hard
-00026070: 2074 6f20 646f 2069 6e20 7061 7261 6c6c   to do in parall
-00026080: 656c 2e20 220a 2020 2020 2020 2020 2020  el. ".          
-00026090: 2020 2253 6565 2074 6865 2060 6d65 6469    "See the `medi
-000260a0: 616e 5f61 7070 726f 7869 6d61 7465 6020  an_approximate` 
-000260b0: 6d65 7468 6f64 2069 6e73 7465 6164 2c20  method instead, 
-000260c0: 7768 6963 6820 7573 6573 2061 6e20 6170  which uses an ap
-000260d0: 7072 6f78 696d 6174 6520 616c 676f 7269  proximate algori
-000260e0: 7468 6d2e 220a 2020 2020 2020 2020 290a  thm.".        ).
-000260f0: 0a20 2020 2064 6566 206d 6564 6961 6e5f  .    def median_
-00026100: 6170 7072 6f78 696d 6174 6528 7365 6c66  approximate(self
-00026110: 2c20 6d65 7468 6f64 3d22 6465 6661 756c  , method="defaul
-00026120: 7422 293a 0a20 2020 2020 2020 2022 2222  t"):.        """
-00026130: 5265 7475 726e 2074 6865 2061 7070 726f  Return the appro
-00026140: 7869 6d61 7465 206d 6564 6961 6e20 6f66  ximate median of
-00026150: 2074 6865 2076 616c 7565 7320 6f76 6572   the values over
-00026160: 2074 6865 2072 6571 7565 7374 6564 2061   the requested a
-00026170: 7869 732e 0a0a 2020 2020 2020 2020 5061  xis...        Pa
-00026180: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
-00026190: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
-000261a0: 2020 2020 6d65 7468 6f64 203a 207b 2764      method : {'d
-000261b0: 6566 6175 6c74 272c 2027 7464 6967 6573  efault', 'tdiges
-000261c0: 7427 2c20 2764 6173 6b27 7d2c 206f 7074  t', 'dask'}, opt
-000261d0: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
-000261e0: 2020 5768 6174 206d 6574 686f 6420 746f    What method to
-000261f0: 2075 7365 2e20 4279 2064 6566 6175 6c74   use. By default
-00026200: 2077 696c 6c20 7573 6520 4461 736b 2773   will use Dask's
-00026210: 2069 6e74 6572 6e61 6c20 6375 7374 6f6d   internal custom
-00026220: 0a20 2020 2020 2020 2020 2020 2061 6c67  .            alg
-00026230: 6f72 6974 686d 2028 6060 2264 6173 6b22  orithm (``"dask"
-00026240: 6060 292e 2020 4966 2073 6574 2074 6f20  ``).  If set to 
-00026250: 6060 2274 6469 6765 7374 2260 6020 7769  ``"tdigest"`` wi
-00026260: 6c6c 2075 7365 2074 6469 6765 7374 0a20  ll use tdigest. 
-00026270: 2020 2020 2020 2020 2020 2066 6f72 2066             for f
-00026280: 6c6f 6174 7320 616e 6420 696e 7473 2061  loats and ints a
-00026290: 6e64 2066 616c 6c62 6163 6b20 746f 2074  nd fallback to t
-000262a0: 6865 2060 6022 6461 736b 2260 6020 6f74  he ``"dask"`` ot
-000262b0: 6865 7277 6973 652e 0a20 2020 2020 2020  herwise..       
-000262c0: 2022 2222 0a20 2020 2020 2020 2072 6574   """.        ret
-000262d0: 7572 6e20 7365 6c66 2e71 7561 6e74 696c  urn self.quantil
-000262e0: 6528 6d65 7468 6f64 3d6d 6574 686f 6429  e(method=method)
-000262f0: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
-00026300: 726f 6d28 7064 2e53 6572 6965 7329 0a20  rom(pd.Series). 
-00026310: 2020 2064 6566 2063 6f76 2873 656c 662c     def cov(self,
-00026320: 206f 7468 6572 2c20 6d69 6e5f 7065 7269   other, min_peri
-00026330: 6f64 733d 4e6f 6e65 2c20 7370 6c69 745f  ods=None, split_
-00026340: 6576 6572 793d 4661 6c73 6529 3a0a 2020  every=False):.  
-00026350: 2020 2020 2020 6966 206e 6f74 2069 7369        if not isi
-00026360: 6e73 7461 6e63 6528 6f74 6865 722c 2053  nstance(other, S
-00026370: 6572 6965 7329 3a0a 2020 2020 2020 2020  eries):.        
-00026380: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
-00026390: 726f 7228 226f 7468 6572 206d 7573 7420  ror("other must 
-000263a0: 6265 2061 2064 6173 6b2e 6461 7461 6672  be a dask.datafr
-000263b0: 616d 652e 5365 7269 6573 2229 0a20 2020  ame.Series").   
-000263c0: 2020 2020 2064 6620 3d20 636f 6e63 6174       df = concat
-000263d0: 285b 7365 6c66 2c20 6f74 6865 725d 2c20  ([self, other], 
-000263e0: 6178 6973 3d31 290a 2020 2020 2020 2020  axis=1).        
-000263f0: 7265 7475 726e 2064 662e 5f63 6f76 286d  return df._cov(m
-00026400: 696e 5f70 6572 696f 6473 2c20 5472 7565  in_periods, True
-00026410: 2c20 7370 6c69 745f 6576 6572 792c 2073  , split_every, s
-00026420: 6361 6c61 723d 5472 7565 290a 0a20 2020  calar=True)..   
-00026430: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
-00026440: 642e 5365 7269 6573 290a 2020 2020 6465  d.Series).    de
-00026450: 6620 636f 7272 2873 656c 662c 206f 7468  f corr(self, oth
-00026460: 6572 2c20 6d65 7468 6f64 3d22 7065 6172  er, method="pear
-00026470: 736f 6e22 2c20 6d69 6e5f 7065 7269 6f64  son", min_period
-00026480: 733d 4e6f 6e65 2c20 7370 6c69 745f 6576  s=None, split_ev
-00026490: 6572 793d 4661 6c73 6529 3a0a 2020 2020  ery=False):.    
-000264a0: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
-000264b0: 7461 6e63 6528 6f74 6865 722c 2053 6572  tance(other, Ser
-000264c0: 6965 7329 3a0a 2020 2020 2020 2020 2020  ies):.          
-000264d0: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
-000264e0: 7228 226f 7468 6572 206d 7573 7420 6265  r("other must be
-000264f0: 2061 2064 6173 6b2e 6461 7461 6672 616d   a dask.datafram
-00026500: 652e 5365 7269 6573 2229 0a20 2020 2020  e.Series").     
-00026510: 2020 2064 6620 3d20 636f 6e63 6174 285b     df = concat([
-00026520: 7365 6c66 2c20 6f74 6865 725d 2c20 6178  self, other], ax
-00026530: 6973 3d31 290a 2020 2020 2020 2020 7265  is=1).        re
-00026540: 7475 726e 2064 662e 5f63 6f72 7228 6d65  turn df._corr(me
-00026550: 7468 6f64 2c20 6d69 6e5f 7065 7269 6f64  thod, min_period
-00026560: 732c 2054 7275 652c 2073 706c 6974 5f65  s, True, split_e
-00026570: 7665 7279 2c20 7363 616c 6172 3d54 7275  very, scalar=Tru
-00026580: 6529 0a0a 2020 2020 4064 6572 6976 6564  e)..    @derived
-00026590: 5f66 726f 6d28 7064 2e53 6572 6965 7329  _from(pd.Series)
-000265a0: 0a20 2020 2064 6566 2061 7574 6f63 6f72  .    def autocor
-000265b0: 7228 7365 6c66 2c20 6c61 673d 312c 2073  r(self, lag=1, s
-000265c0: 706c 6974 5f65 7665 7279 3d46 616c 7365  plit_every=False
-000265d0: 293a 0a20 2020 2020 2020 2069 6620 6e6f  ):.        if no
-000265e0: 7420 6973 696e 7374 616e 6365 286c 6167  t isinstance(lag
-000265f0: 2c20 496e 7465 6772 616c 293a 0a20 2020  , Integral):.   
-00026600: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
-00026610: 7970 6545 7272 6f72 2822 6c61 6720 6d75  ypeError("lag mu
-00026620: 7374 2062 6520 616e 2069 6e74 6567 6572  st be an integer
-00026630: 2229 0a20 2020 2020 2020 2072 6574 7572  ").        retur
-00026640: 6e20 7365 6c66 2e63 6f72 7228 7365 6c66  n self.corr(self
-00026650: 2069 6620 6c61 6720 3d3d 2030 2065 6c73   if lag == 0 els
-00026660: 6520 7365 6c66 2e73 6869 6674 286c 6167  e self.shift(lag
-00026670: 292c 2073 706c 6974 5f65 7665 7279 3d73  ), split_every=s
-00026680: 706c 6974 5f65 7665 7279 290a 0a20 2020  plit_every)..   
-00026690: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
-000266a0: 642e 5365 7269 6573 290a 2020 2020 6465  d.Series).    de
-000266b0: 6620 6465 7363 7269 6265 280a 2020 2020  f describe(.    
-000266c0: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-000266d0: 2020 7370 6c69 745f 6576 6572 793d 4661    split_every=Fa
-000266e0: 6c73 652c 0a20 2020 2020 2020 2070 6572  lse,.        per
-000266f0: 6365 6e74 696c 6573 3d4e 6f6e 652c 0a20  centiles=None,. 
-00026700: 2020 2020 2020 2070 6572 6365 6e74 696c         percentil
-00026710: 6573 5f6d 6574 686f 643d 2264 6566 6175  es_method="defau
-00026720: 6c74 222c 0a20 2020 2020 2020 2069 6e63  lt",.        inc
-00026730: 6c75 6465 3d4e 6f6e 652c 0a20 2020 2020  lude=None,.     
-00026740: 2020 2065 7863 6c75 6465 3d4e 6f6e 652c     exclude=None,
-00026750: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
-00026760: 6966 2028 0a20 2020 2020 2020 2020 2020  if (.           
-00026770: 2069 735f 6e75 6d65 7269 635f 6474 7970   is_numeric_dtyp
-00026780: 6528 7365 6c66 2e64 7479 7065 290a 2020  e(self.dtype).  
-00026790: 2020 2020 2020 2020 2020 616e 6420 6e6f            and no
-000267a0: 7420 6973 5f62 6f6f 6c5f 6474 7970 6528  t is_bool_dtype(
-000267b0: 7365 6c66 2e64 7479 7065 290a 2020 2020  self.dtype).    
-000267c0: 2020 2020 2020 2020 6f72 2069 735f 7469          or is_ti
-000267d0: 6d65 6465 6c74 6136 345f 6474 7970 6528  medelta64_dtype(
-000267e0: 7365 6c66 2e64 7479 7065 290a 2020 2020  self.dtype).    
-000267f0: 2020 2020 2020 2020 6f72 2069 735f 6461          or is_da
-00026800: 7465 7469 6d65 3634 5f61 6e79 5f64 7479  tetime64_any_dty
-00026810: 7065 2873 656c 662e 6474 7970 6529 0a20  pe(self.dtype). 
-00026820: 2020 2020 2020 2029 3a0a 2020 2020 2020         ):.      
-00026830: 2020 2020 2020 7265 7475 726e 206e 6577        return new
-00026840: 5f63 6f6c 6c65 6374 696f 6e28 0a20 2020  _collection(.   
-00026850: 2020 2020 2020 2020 2020 2020 2044 6573               Des
-00026860: 6372 6962 654e 756d 6572 6963 2873 656c  cribeNumeric(sel
-00026870: 662c 2073 706c 6974 5f65 7665 7279 2c20  f, split_every, 
-00026880: 7065 7263 656e 7469 6c65 732c 2070 6572  percentiles, per
-00026890: 6365 6e74 696c 6573 5f6d 6574 686f 6429  centiles_method)
-000268a0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-000268b0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-000268c0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-000268d0: 6e65 775f 636f 6c6c 6563 7469 6f6e 280a  new_collection(.
-000268e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000268f0: 4465 7363 7269 6265 4e6f 6e4e 756d 6572  DescribeNonNumer
-00026900: 6963 2873 656c 662c 2073 706c 6974 5f65  ic(self, split_e
-00026910: 7665 7279 2c20 7065 7263 656e 7469 6c65  very, percentile
-00026920: 732c 2070 6572 6365 6e74 696c 6573 5f6d  s, percentiles_m
-00026930: 6574 686f 6429 0a20 2020 2020 2020 2020  ethod).         
-00026940: 2020 2029 0a0a 2020 2020 4070 726f 7065     )..    @prope
-00026950: 7274 790a 2020 2020 4064 6572 6976 6564  rty.    @derived
-00026960: 5f66 726f 6d28 7064 2e53 6572 6965 7329  _from(pd.Series)
-00026970: 0a20 2020 2064 6566 2069 735f 6d6f 6e6f  .    def is_mono
-00026980: 746f 6e69 635f 696e 6372 6561 7369 6e67  tonic_increasing
-00026990: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-000269a0: 7265 7475 726e 206e 6577 5f63 6f6c 6c65  return new_colle
-000269b0: 6374 696f 6e28 4973 4d6f 6e6f 746f 6e69  ction(IsMonotoni
-000269c0: 6349 6e63 7265 6173 696e 6728 7365 6c66  cIncreasing(self
-000269d0: 2929 0a0a 2020 2020 4070 726f 7065 7274  ))..    @propert
-000269e0: 790a 2020 2020 4064 6572 6976 6564 5f66  y.    @derived_f
-000269f0: 726f 6d28 7064 2e53 6572 6965 7329 0a20  rom(pd.Series). 
-00026a00: 2020 2064 6566 2069 735f 6d6f 6e6f 746f     def is_monoto
-00026a10: 6e69 635f 6465 6372 6561 7369 6e67 2873  nic_decreasing(s
-00026a20: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
-00026a30: 7475 726e 206e 6577 5f63 6f6c 6c65 6374  turn new_collect
-00026a40: 696f 6e28 4973 4d6f 6e6f 746f 6e69 6344  ion(IsMonotonicD
-00026a50: 6563 7265 6173 696e 6728 7365 6c66 2929  ecreasing(self))
-00026a60: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
-00026a70: 726f 6d28 7064 2e53 6572 6965 7329 0a20  rom(pd.Series). 
-00026a80: 2020 2064 6566 2074 6f5f 7374 7269 6e67     def to_string
-00026a90: 2873 656c 662c 206d 6178 5f72 6f77 733d  (self, max_rows=
-00026aa0: 3529 3a0a 2020 2020 2020 2020 2320 6f70  5):.        # op
-00026ab0: 7469 6f6e 5f63 6f6e 7465 7874 2064 6f65  tion_context doe
-00026ac0: 736e 2774 2061 6666 6563 740a 2020 2020  sn't affect.    
-00026ad0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00026ae0: 5f72 6570 725f 6461 7461 2829 2e74 6f5f  _repr_data().to_
-00026af0: 7374 7269 6e67 286d 6178 5f72 6f77 733d  string(max_rows=
-00026b00: 6d61 785f 726f 7773 290a 0a20 2020 2064  max_rows)..    d
-00026b10: 6566 205f 7265 7072 5f64 6174 6128 7365  ef _repr_data(se
-00026b20: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
-00026b30: 7572 6e20 5f72 6570 725f 6461 7461 5f73  urn _repr_data_s
-00026b40: 6572 6965 7328 7365 6c66 2e5f 6d65 7461  eries(self._meta
-00026b50: 2c20 7365 6c66 2e5f 7265 7072 5f64 6976  , self._repr_div
-00026b60: 6973 696f 6e73 290a 0a20 2020 2069 6620  isions)..    if 
-00026b70: 5041 4e44 4153 5f47 455f 3232 303a 0a0a  PANDAS_GE_220:..
-00026b80: 2020 2020 2020 2020 4064 6572 6976 6564          @derived
-00026b90: 5f66 726f 6d28 7064 2e53 6572 6965 7329  _from(pd.Series)
-00026ba0: 0a20 2020 2020 2020 2064 6566 2063 6173  .        def cas
-00026bb0: 655f 7768 656e 2873 656c 662c 2063 6173  e_when(self, cas
-00026bc0: 656c 6973 7429 3a0a 2020 2020 2020 2020  elist):.        
-00026bd0: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
-00026be0: 7461 6e63 6528 6361 7365 6c69 7374 2c20  tance(caselist, 
-00026bf0: 6c69 7374 293a 0a20 2020 2020 2020 2020  list):.         
-00026c00: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
-00026c10: 6545 7272 6f72 2822 5468 6520 6361 7365  eError("The case
-00026c20: 6c69 7374 2061 7267 756d 656e 7420 7368  list argument sh
-00026c30: 6f75 6c64 2062 6520 6120 6c69 7374 2229  ould be a list")
-00026c40: 0a20 2020 2020 2020 2020 2020 2063 6173  .            cas
-00026c50: 656c 6973 7420 3d20 6c69 7374 2866 6c61  elist = list(fla
-00026c60: 7474 656e 285b 5b63 2c20 765d 2066 6f72  tten([[c, v] for
-00026c70: 2063 2c20 7620 696e 2063 6173 656c 6973   c, v in caselis
-00026c80: 745d 2c20 636f 6e74 6169 6e65 723d 6c69  t], container=li
-00026c90: 7374 2929 0a20 2020 2020 2020 2020 2020  st)).           
-00026ca0: 2072 6574 7572 6e20 6e65 775f 636f 6c6c   return new_coll
-00026cb0: 6563 7469 6f6e 2865 7870 722e 4361 7365  ection(expr.Case
-00026cc0: 5768 656e 2873 656c 662c 202a 6361 7365  When(self, *case
-00026cd0: 6c69 7374 2929 0a0a 0a66 6f72 206e 616d  list))...for nam
-00026ce0: 6520 696e 205b 0a20 2020 2022 6164 6422  e in [.    "add"
-00026cf0: 2c0a 2020 2020 2273 7562 222c 0a20 2020  ,.    "sub",.   
-00026d00: 2022 6d75 6c22 2c0a 2020 2020 2264 6976   "mul",.    "div
-00026d10: 222c 0a20 2020 2022 6469 7669 6465 222c  ",.    "divide",
-00026d20: 0a20 2020 2022 7472 7565 6469 7622 2c0a  .    "truediv",.
-00026d30: 2020 2020 2266 6c6f 6f72 6469 7622 2c0a      "floordiv",.
-00026d40: 2020 2020 226d 6f64 222c 0a20 2020 2022      "mod",.    "
-00026d50: 706f 7722 2c0a 2020 2020 2272 6164 6422  pow",.    "radd"
-00026d60: 2c0a 2020 2020 2272 7375 6222 2c0a 2020  ,.    "rsub",.  
-00026d70: 2020 2272 6d75 6c22 2c0a 2020 2020 2272    "rmul",.    "r
-00026d80: 6469 7622 2c0a 2020 2020 2272 7472 7565  div",.    "rtrue
-00026d90: 6469 7622 2c0a 2020 2020 2272 666c 6f6f  div",.    "rfloo
-00026da0: 7264 6976 222c 0a20 2020 2022 726d 6f64  rdiv",.    "rmod
-00026db0: 222c 0a20 2020 2022 7270 6f77 222c 0a5d  ",.    "rpow",.]
-00026dc0: 3a0a 2020 2020 6173 7365 7274 206e 6f74  :.    assert not
-00026dd0: 2068 6173 6174 7472 2844 6174 6146 7261   hasattr(DataFra
-00026de0: 6d65 2c20 6e61 6d65 292c 206e 616d 650a  me, name), name.
-00026df0: 2020 2020 7365 7461 7474 7228 4461 7461      setattr(Data
-00026e00: 4672 616d 652c 206e 616d 652c 205f 7772  Frame, name, _wr
-00026e10: 6170 5f65 7870 725f 6d65 7468 6f64 5f6f  ap_expr_method_o
-00026e20: 7065 7261 746f 7228 6e61 6d65 2c20 4461  perator(name, Da
-00026e30: 7461 4672 616d 6529 290a 0a20 2020 2061  taFrame))..    a
-00026e40: 7373 6572 7420 6e6f 7420 6861 7361 7474  ssert not hasatt
-00026e50: 7228 5365 7269 6573 2c20 6e61 6d65 292c  r(Series, name),
-00026e60: 206e 616d 650a 2020 2020 7365 7461 7474   name.    setatt
-00026e70: 7228 5365 7269 6573 2c20 6e61 6d65 2c20  r(Series, name, 
-00026e80: 5f77 7261 705f 6578 7072 5f6d 6574 686f  _wrap_expr_metho
-00026e90: 645f 6f70 6572 6174 6f72 286e 616d 652c  d_operator(name,
-00026ea0: 2053 6572 6965 7329 290a 0a0a 636c 6173   Series))...clas
-00026eb0: 7320 496e 6465 7828 5365 7269 6573 293a  s Index(Series):
-00026ec0: 0a20 2020 2022 2222 496e 6465 782d 6c69  .    """Index-li
-00026ed0: 6b65 2045 7870 7220 436f 6c6c 6563 7469  ke Expr Collecti
-00026ee0: 6f6e 2222 220a 0a20 2020 205f 6163 6365  on"""..    _acce
-00026ef0: 7373 6f72 733a 2043 6c61 7373 5661 725b  ssors: ClassVar[
-00026f00: 7365 745b 7374 725d 5d20 3d20 7365 7428  set[str]] = set(
-00026f10: 290a 2020 2020 5f70 6172 7469 7469 6f6e  ).    _partition
-00026f20: 5f74 7970 6520 3d20 7064 2e49 6e64 6578  _type = pd.Index
-00026f30: 0a0a 2020 2020 5f64 745f 6174 7472 6962  ..    _dt_attrib
-00026f40: 7574 6573 203d 207b 0a20 2020 2020 2020  utes = {.       
-00026f50: 2022 6e61 6e6f 7365 636f 6e64 222c 0a20   "nanosecond",. 
-00026f60: 2020 2020 2020 2022 6d69 6372 6f73 6563         "microsec
-00026f70: 6f6e 6422 2c0a 2020 2020 2020 2020 226d  ond",.        "m
-00026f80: 696c 6c69 7365 636f 6e64 222c 0a20 2020  illisecond",.   
-00026f90: 2020 2020 2022 6461 796f 6679 6561 7222       "dayofyear"
-00026fa0: 2c0a 2020 2020 2020 2020 226d 696e 7574  ,.        "minut
-00026fb0: 6522 2c0a 2020 2020 2020 2020 2268 6f75  e",.        "hou
-00026fc0: 7222 2c0a 2020 2020 2020 2020 2264 6179  r",.        "day
-00026fd0: 222c 0a20 2020 2020 2020 2022 6461 796f  ",.        "dayo
-00026fe0: 6677 6565 6b22 2c0a 2020 2020 2020 2020  fweek",.        
-00026ff0: 2273 6563 6f6e 6422 2c0a 2020 2020 2020  "second",.      
-00027000: 2020 2277 6565 6b22 2c0a 2020 2020 2020    "week",.      
-00027010: 2020 2277 6565 6b64 6179 222c 0a20 2020    "weekday",.   
-00027020: 2020 2020 2022 7765 656b 6f66 7965 6172       "weekofyear
-00027030: 222c 0a20 2020 2020 2020 2022 6d6f 6e74  ",.        "mont
-00027040: 6822 2c0a 2020 2020 2020 2020 2271 7561  h",.        "qua
-00027050: 7274 6572 222c 0a20 2020 2020 2020 2022  rter",.        "
-00027060: 7965 6172 222c 0a20 2020 207d 0a0a 2020  year",.    }..  
-00027070: 2020 5f63 6174 5f61 7474 7269 6275 7465    _cat_attribute
-00027080: 7320 3d20 7b0a 2020 2020 2020 2020 226b  s = {.        "k
-00027090: 6e6f 776e 222c 0a20 2020 2020 2020 2022  nown",.        "
-000270a0: 6173 5f6b 6e6f 776e 222c 0a20 2020 2020  as_known",.     
-000270b0: 2020 2022 6173 5f75 6e6b 6e6f 776e 222c     "as_unknown",
-000270c0: 0a20 2020 2020 2020 2022 6164 645f 6361  .        "add_ca
-000270d0: 7465 676f 7269 6573 222c 0a20 2020 2020  tegories",.     
-000270e0: 2020 2022 6361 7465 676f 7269 6573 222c     "categories",
-000270f0: 0a20 2020 2020 2020 2022 7265 6d6f 7665  .        "remove
-00027100: 5f63 6174 6567 6f72 6965 7322 2c0a 2020  _categories",.  
-00027110: 2020 2020 2020 2272 656f 7264 6572 5f63        "reorder_c
-00027120: 6174 6567 6f72 6965 7322 2c0a 2020 2020  ategories",.    
-00027130: 2020 2020 2261 735f 6f72 6465 7265 6422      "as_ordered"
-00027140: 2c0a 2020 2020 2020 2020 2263 6f64 6573  ,.        "codes
-00027150: 222c 0a20 2020 2020 2020 2022 7265 6d6f  ",.        "remo
-00027160: 7665 5f75 6e75 7365 645f 6361 7465 676f  ve_unused_catego
-00027170: 7269 6573 222c 0a20 2020 2020 2020 2022  ries",.        "
-00027180: 7365 745f 6361 7465 676f 7269 6573 222c  set_categories",
-00027190: 0a20 2020 2020 2020 2022 6173 5f75 6e6f  .        "as_uno
-000271a0: 7264 6572 6564 222c 0a20 2020 2020 2020  rdered",.       
-000271b0: 2022 6f72 6465 7265 6422 2c0a 2020 2020   "ordered",.    
-000271c0: 2020 2020 2272 656e 616d 655f 6361 7465      "rename_cate
-000271d0: 676f 7269 6573 222c 0a20 2020 207d 0a0a  gories",.    }..
-000271e0: 2020 2020 6465 6620 5f5f 6765 7461 7474      def __getatt
-000271f0: 725f 5f28 7365 6c66 2c20 6b65 7929 3a0a  r__(self, key):.
-00027200: 2020 2020 2020 2020 6966 2028 0a20 2020          if (.   
-00027210: 2020 2020 2020 2020 2069 7369 6e73 7461           isinsta
-00027220: 6e63 6528 7365 6c66 2e5f 6d65 7461 2e64  nce(self._meta.d
-00027230: 7479 7065 2c20 7064 2e43 6174 6567 6f72  type, pd.Categor
-00027240: 6963 616c 4474 7970 6529 0a20 2020 2020  icalDtype).     
-00027250: 2020 2020 2020 2061 6e64 206b 6579 2069         and key i
-00027260: 6e20 7365 6c66 2e5f 6361 745f 6174 7472  n self._cat_attr
-00027270: 6962 7574 6573 0a20 2020 2020 2020 2029  ibutes.        )
-00027280: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-00027290: 7475 726e 2067 6574 6174 7472 2873 656c  turn getattr(sel
-000272a0: 662e 6361 742c 206b 6579 290a 2020 2020  f.cat, key).    
-000272b0: 2020 2020 656c 6966 206b 6579 2069 6e20      elif key in 
-000272c0: 7365 6c66 2e5f 6474 5f61 7474 7269 6275  self._dt_attribu
-000272d0: 7465 733a 0a20 2020 2020 2020 2020 2020  tes:.           
-000272e0: 2072 6574 7572 6e20 6765 7461 7474 7228   return getattr(
-000272f0: 7365 6c66 2e64 742c 206b 6579 290a 0a20  self.dt, key).. 
-00027300: 2020 2020 2020 2069 6620 6861 7361 7474         if hasatt
-00027310: 7228 7375 7065 7228 292c 206b 6579 293a  r(super(), key):
-00027320: 2020 2320 446f 6573 6e27 7420 7472 6967    # Doesn't trig
-00027330: 6765 7220 7375 7065 7228 292e 5f5f 6765  ger super().__ge
-00027340: 7461 7474 725f 5f0a 2020 2020 2020 2020  tattr__.        
-00027350: 2020 2020 2320 4e6f 7420 6120 6d61 6769      # Not a magi
-00027360: 6320 6174 7472 6962 7574 652e 2054 6869  c attribute. Thi
-00027370: 7320 6973 2061 2072 6561 6c20 6d65 7468  s is a real meth
-00027380: 6f64 206f 7220 7072 6f70 6572 7479 206f  od or property o
-00027390: 6620 5365 7269 6573 2074 6861 740a 2020  f Series that.  
-000273a0: 2020 2020 2020 2020 2020 2320 6861 7320            # has 
-000273b0: 6265 656e 206f 7665 7272 6964 6465 6e20  been overridden 
-000273c0: 6279 2052 6169 7365 4174 7472 6962 7574  by RaiseAttribut
-000273d0: 6545 7272 6f72 2829 2e0a 2020 2020 2020  eError()..      
-000273e0: 2020 2020 2020 7261 6973 6520 4174 7472        raise Attr
-000273f0: 6962 7574 6545 7272 6f72 280a 2020 2020  ibuteError(.    
-00027400: 2020 2020 2020 2020 2020 2020 6622 7b73              f"{s
-00027410: 656c 662e 5f5f 636c 6173 735f 5f2e 5f5f  elf.__class__.__
-00027420: 6e61 6d65 5f5f 2172 7d20 6f62 6a65 6374  name__!r} object
-00027430: 2068 6173 206e 6f20 6174 7472 6962 7574   has no attribut
-00027440: 6520 7b6b 6579 2172 7d22 0a20 2020 2020  e {key!r}".     
-00027450: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00027460: 2072 6574 7572 6e20 7375 7065 7228 292e   return super().
-00027470: 5f5f 6765 7461 7474 725f 5f28 6b65 7929  __getattr__(key)
-00027480: 0a0a 2020 2020 6465 6620 5f5f 7265 7072  ..    def __repr
-00027490: 5f5f 2873 656c 6629 3a0a 2020 2020 2020  __(self):.      
-000274a0: 2020 7265 7475 726e 2066 223c 6461 736b    return f"<dask
-000274b0: 5f65 7870 722e 6578 7072 2e49 6e64 6578  _expr.expr.Index
-000274c0: 3a20 6578 7072 3d7b 7365 6c66 2e65 7870  : expr={self.exp
-000274d0: 727d 3e22 0a0a 2020 2020 6465 6620 5f5f  r}>"..    def __
-000274e0: 6172 7261 795f 7772 6170 5f5f 2873 656c  array_wrap__(sel
-000274f0: 662c 2061 7272 6179 2c20 636f 6e74 6578  f, array, contex
-00027500: 743d 4e6f 6e65 293a 0a20 2020 2020 2020  t=None):.       
-00027510: 2072 6574 7572 6e20 7064 2e49 6e64 6578   return pd.Index
-00027520: 2861 7272 6179 2c20 6e61 6d65 3d73 656c  (array, name=sel
-00027530: 662e 6e61 6d65 290a 0a20 2020 2040 6465  f.name)..    @de
-00027540: 7269 7665 645f 6672 6f6d 2870 642e 496e  rived_from(pd.In
-00027550: 6465 7829 0a20 2020 2064 6566 2074 6f5f  dex).    def to_
-00027560: 7365 7269 6573 2873 656c 662c 2069 6e64  series(self, ind
-00027570: 6578 3d4e 6f6e 652c 206e 616d 653d 6e6f  ex=None, name=no
-00027580: 5f64 6566 6175 6c74 293a 0a20 2020 2020  _default):.     
-00027590: 2020 2069 6620 696e 6465 7820 6973 206e     if index is n
-000275a0: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
-000275b0: 2020 2020 2072 6169 7365 204e 6f74 496d       raise NotIm
-000275c0: 706c 656d 656e 7465 6445 7272 6f72 0a20  plementedError. 
-000275d0: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
-000275e0: 775f 636f 6c6c 6563 7469 6f6e 2865 7870  w_collection(exp
-000275f0: 722e 546f 5365 7269 6573 496e 6465 7828  r.ToSeriesIndex(
-00027600: 7365 6c66 2c20 696e 6465 783d 696e 6465  self, index=inde
-00027610: 782c 206e 616d 653d 6e61 6d65 2929 0a0a  x, name=name))..
-00027620: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
-00027630: 6d28 7064 2e49 6e64 6578 2c20 7561 5f61  m(pd.Index, ua_a
-00027640: 7267 733d 5b22 696e 6465 7822 5d29 0a20  rgs=["index"]). 
-00027650: 2020 2064 6566 2074 6f5f 6672 616d 6528     def to_frame(
-00027660: 7365 6c66 2c20 696e 6465 783d 5472 7565  self, index=True
-00027670: 2c20 6e61 6d65 3d6e 6f5f 6465 6661 756c  , name=no_defaul
-00027680: 7429 3a0a 2020 2020 2020 2020 6966 206e  t):.        if n
-00027690: 6f74 2069 6e64 6578 3a0a 2020 2020 2020  ot index:.      
-000276a0: 2020 2020 2020 7261 6973 6520 4e6f 7449        raise NotI
-000276b0: 6d70 6c65 6d65 6e74 6564 4572 726f 720a  mplementedError.
-000276c0: 2020 2020 2020 2020 7265 7475 726e 206e          return n
-000276d0: 6577 5f63 6f6c 6c65 6374 696f 6e28 6578  ew_collection(ex
-000276e0: 7072 2e54 6f46 7261 6d65 496e 6465 7828  pr.ToFrameIndex(
-000276f0: 7365 6c66 2c20 696e 6465 783d 696e 6465  self, index=inde
-00027700: 782c 206e 616d 653d 6e61 6d65 2929 0a0a  x, name=name))..
-00027710: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
-00027720: 6d28 7064 2e49 6e64 6578 290a 2020 2020  m(pd.Index).    
-00027730: 6465 6620 6d65 6d6f 7279 5f75 7361 6765  def memory_usage
-00027740: 2873 656c 662c 2064 6565 703d 4661 6c73  (self, deep=Fals
-00027750: 6529 3a0a 2020 2020 2020 2020 7265 7475  e):.        retu
-00027760: 726e 206e 6577 5f63 6f6c 6c65 6374 696f  rn new_collectio
-00027770: 6e28 4d65 6d6f 7279 5573 6167 6549 6e64  n(MemoryUsageInd
-00027780: 6578 2873 656c 662c 2064 6565 703d 6465  ex(self, deep=de
-00027790: 6570 2929 0a0a 2020 2020 6465 6620 7368  ep))..    def sh
-000277a0: 6966 7428 7365 6c66 2c20 7065 7269 6f64  ift(self, period
-000277b0: 733d 312c 2066 7265 713d 4e6f 6e65 293a  s=1, freq=None):
-000277c0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000277d0: 6e65 775f 636f 6c6c 6563 7469 6f6e 2865  new_collection(e
-000277e0: 7870 722e 5368 6966 7449 6e64 6578 2873  xpr.ShiftIndex(s
-000277f0: 656c 662c 2070 6572 696f 6473 2c20 6672  elf, periods, fr
-00027800: 6571 2929 0a0a 2020 2020 4064 6572 6976  eq))..    @deriv
-00027810: 6564 5f66 726f 6d28 7064 2e49 6e64 6578  ed_from(pd.Index
-00027820: 290a 2020 2020 6465 6620 6d61 7028 7365  ).    def map(se
-00027830: 6c66 2c20 6172 672c 206e 615f 6163 7469  lf, arg, na_acti
-00027840: 6f6e 3d4e 6f6e 652c 206d 6574 613d 4e6f  on=None, meta=No
-00027850: 6e65 2c20 6973 5f6d 6f6e 6f74 6f6e 6963  ne, is_monotonic
-00027860: 3d46 616c 7365 293a 0a20 2020 2020 2020  =False):.       
-00027870: 2022 2222 0a20 2020 2020 2020 204e 6f74   """.        Not
-00027880: 6520 7468 6174 2074 6869 7320 6d65 7468  e that this meth
-00027890: 6f64 2063 6c65 6172 7320 616e 7920 6b6e  od clears any kn
-000278a0: 6f77 6e20 6469 7669 7369 6f6e 732e 0a0a  own divisions...
-000278b0: 2020 2020 2020 2020 4966 2079 6f75 7220          If your 
-000278c0: 6d61 7070 696e 6720 6675 6e63 7469 6f6e  mapping function
-000278d0: 2069 7320 6d6f 6e6f 746f 6e69 6361 6c6c   is monotonicall
-000278e0: 7920 696e 6372 6561 7369 6e67 2074 6865  y increasing the
-000278f0: 6e20 7573 6520 6069 735f 6d6f 6e6f 746f  n use `is_monoto
-00027900: 6e69 6360 0a20 2020 2020 2020 2074 6f20  nic`.        to 
-00027910: 6170 706c 7920 7468 6520 6d61 7069 6e67  apply the maping
-00027920: 2066 756e 6374 696f 6e20 746f 2074 6865   function to the
-00027930: 206f 6c64 2064 6976 6973 696f 6e73 2061   old divisions a
-00027940: 6e64 2061 7373 6967 6e20 7468 6520 6e65  nd assign the ne
-00027950: 770a 2020 2020 2020 2020 6469 7669 7369  w.        divisi
-00027960: 6f6e 7320 746f 2074 6865 206f 7574 7075  ons to the outpu
-00027970: 742e 0a0a 2020 2020 2020 2020 2222 220a  t...        """.
-00027980: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-00027990: 7461 6e63 6528 6172 672c 2053 6572 6965  tance(arg, Serie
-000279a0: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
-000279b0: 6966 206e 6f74 2065 7870 722e 6172 655f  if not expr.are_
-000279c0: 636f 5f61 6c69 676e 6564 2873 656c 662e  co_aligned(self.
-000279d0: 6578 7072 2c20 6172 672e 6578 7072 293a  expr, arg.expr):
-000279e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000279f0: 2069 6620 6d65 7461 2069 7320 4e6f 6e65   if meta is None
-00027a00: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00027a10: 2020 2020 2020 7761 726e 696e 6773 2e77        warnings.w
-00027a20: 6172 6e28 6d65 7461 5f77 6172 6e69 6e67  arn(meta_warning
-00027a30: 286d 6574 6129 290a 2020 2020 2020 2020  (meta)).        
-00027a40: 2020 2020 2020 2020 7265 7475 726e 206e          return n
-00027a50: 6577 5f63 6f6c 6c65 6374 696f 6e28 0a20  ew_collection(. 
-00027a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027a70: 2020 2065 7870 722e 4d61 7049 6e64 6578     expr.MapIndex
-00027a80: 416c 6967 6e28 7365 6c66 2c20 6172 672c  Align(self, arg,
-00027a90: 206e 615f 6163 7469 6f6e 2c20 6d65 7461   na_action, meta
-00027aa0: 2c20 6973 5f6d 6f6e 6f74 6f6e 6963 290a  , is_monotonic).
-00027ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027ac0: 290a 2020 2020 2020 2020 6966 206d 6574  ).        if met
-00027ad0: 6120 6973 204e 6f6e 653a 0a20 2020 2020  a is None:.     
-00027ae0: 2020 2020 2020 206d 6574 6120 3d20 6578         meta = ex
-00027af0: 7072 2e5f 656d 756c 6174 6528 4d2e 6d61  pr._emulate(M.ma
-00027b00: 702c 2073 656c 662c 2061 7267 2c20 6e61  p, self, arg, na
-00027b10: 5f61 6374 696f 6e3d 6e61 5f61 6374 696f  _action=na_actio
-00027b20: 6e2c 2075 6466 3d54 7275 6529 0a20 2020  n, udf=True).   
-00027b30: 2020 2020 2020 2020 2077 6172 6e69 6e67           warning
-00027b40: 732e 7761 726e 286d 6574 615f 7761 726e  s.warn(meta_warn
-00027b50: 696e 6728 6d65 7461 2929 0a20 2020 2020  ing(meta)).     
-00027b60: 2020 2072 6574 7572 6e20 6e65 775f 636f     return new_co
-00027b70: 6c6c 6563 7469 6f6e 280a 2020 2020 2020  llection(.      
-00027b80: 2020 2020 2020 6578 7072 2e4d 6170 280a        expr.Map(.
-00027b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027ba0: 7365 6c66 2c20 6172 673d 6172 672c 206e  self, arg=arg, n
-00027bb0: 615f 6163 7469 6f6e 3d6e 615f 6163 7469  a_action=na_acti
-00027bc0: 6f6e 2c20 6d65 7461 3d6d 6574 612c 2069  on, meta=meta, i
-00027bd0: 735f 6d6f 6e6f 746f 6e69 633d 6973 5f6d  s_monotonic=is_m
-00027be0: 6f6e 6f74 6f6e 6963 0a20 2020 2020 2020  onotonic.       
-00027bf0: 2020 2020 2029 0a20 2020 2020 2020 2029       ).        )
-00027c00: 0a0a 2020 2020 6465 6620 5f5f 6469 725f  ..    def __dir_
-00027c10: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
-00027c20: 206f 203d 2073 6574 2864 6972 2874 7970   o = set(dir(typ
-00027c30: 6528 7365 6c66 2929 290a 2020 2020 2020  e(self))).      
-00027c40: 2020 6f2e 7570 6461 7465 2873 656c 662e    o.update(self.
-00027c50: 5f5f 6469 6374 5f5f 290a 2020 2020 2020  __dict__).      
-00027c60: 2020 6f2e 7570 6461 7465 2873 6574 2864    o.update(set(d
-00027c70: 6972 2865 7870 722e 4578 7072 2929 290a  ir(expr.Expr))).
-00027c80: 2020 2020 2020 2020 6f2e 7570 6461 7465          o.update
-00027c90: 2873 656c 662e 5f64 745f 6174 7472 6962  (self._dt_attrib
-00027ca0: 7574 6573 290a 2020 2020 2020 2020 6966  utes).        if
-00027cb0: 2069 7369 6e73 7461 6e63 6528 7365 6c66   isinstance(self
-00027cc0: 2e64 7479 7065 2c20 7064 2e43 6174 6567  .dtype, pd.Categ
-00027cd0: 6f72 6963 616c 4474 7970 6529 3a0a 2020  oricalDtype):.  
-00027ce0: 2020 2020 2020 2020 2020 6f2e 7570 6461            o.upda
-00027cf0: 7465 2873 656c 662e 5f63 6174 5f61 7474  te(self._cat_att
-00027d00: 7269 6275 7465 7329 0a20 2020 2020 2020  ributes).       
-00027d10: 2072 6574 7572 6e20 6c69 7374 286f 290a   return list(o).
-00027d20: 0a20 2020 2023 204d 6574 686f 6473 2061  .    # Methods a
-00027d30: 6e64 2070 726f 7065 7274 6965 7320 6f66  nd properties of
-00027d40: 2053 6572 6965 7320 7468 6174 2061 7265   Series that are
-00027d50: 206e 6f74 2069 6d70 6c65 6d65 6e74 6564   not implemented
-00027d60: 206f 6e20 496e 6465 780a 0a20 2020 2064   on Index..    d
-00027d70: 6566 2063 6f75 6e74 2873 656c 662c 2073  ef count(self, s
-00027d80: 706c 6974 5f65 7665 7279 3d46 616c 7365  plit_every=False
-00027d90: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-00027da0: 6e20 6e65 775f 636f 6c6c 6563 7469 6f6e  n new_collection
-00027db0: 2849 6e64 6578 436f 756e 7428 7365 6c66  (IndexCount(self
-00027dc0: 2c20 7370 6c69 745f 6576 6572 7929 290a  , split_every)).
-00027dd0: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
-00027de0: 2020 2064 6566 2069 6e64 6578 2873 656c     def index(sel
-00027df0: 6629 3a0a 2020 2020 2020 2020 7261 6973  f):.        rais
-00027e00: 6520 4174 7472 6962 7574 6545 7272 6f72  e AttributeError
-00027e10: 2822 2749 6e64 6578 2720 6f62 6a65 6374  ("'Index' object
-00027e20: 2068 6173 206e 6f20 6174 7472 6962 7574   has no attribut
-00027e30: 6520 2769 6e64 6578 2722 290a 0a20 2020  e 'index'")..   
-00027e40: 2064 6566 2073 756d 2873 656c 662c 202a   def sum(self, *
-00027e50: 6172 6773 2c20 2a2a 6b77 6172 6773 293a  args, **kwargs):
-00027e60: 0a20 2020 2020 2020 2072 6169 7365 2041  .        raise A
-00027e70: 7474 7269 6275 7465 4572 726f 7228 2227  ttributeError("'
-00027e80: 496e 6465 7827 206f 626a 6563 7420 6861  Index' object ha
-00027e90: 7320 6e6f 2061 7474 7269 6275 7465 2027  s no attribute '
-00027ea0: 7375 6d27 2229 0a0a 2020 2020 6465 6620  sum'")..    def 
-00027eb0: 7072 6f64 2873 656c 662c 202a 6172 6773  prod(self, *args
-00027ec0: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
-00027ed0: 2020 2020 2072 6169 7365 2041 7474 7269       raise Attri
-00027ee0: 6275 7465 4572 726f 7228 2227 496e 6465  buteError("'Inde
-00027ef0: 7827 206f 626a 6563 7420 6861 7320 6e6f  x' object has no
-00027f00: 2061 7474 7269 6275 7465 2027 7072 6f64   attribute 'prod
-00027f10: 2722 290a 0a20 2020 2064 6566 206d 6561  '")..    def mea
-00027f20: 6e28 7365 6c66 2c20 2a61 7267 732c 202a  n(self, *args, *
-00027f30: 2a6b 7761 7267 7329 3a0a 2020 2020 2020  *kwargs):.      
-00027f40: 2020 7261 6973 6520 4174 7472 6962 7574    raise Attribut
-00027f50: 6545 7272 6f72 2822 2749 6e64 6578 2720  eError("'Index' 
-00027f60: 6f62 6a65 6374 2068 6173 206e 6f20 6174  object has no at
-00027f70: 7472 6962 7574 6520 276d 6561 6e27 2229  tribute 'mean'")
-00027f80: 0a0a 2020 2020 6465 6620 7374 6428 7365  ..    def std(se
-00027f90: 6c66 2c20 2a61 7267 732c 202a 2a6b 7761  lf, *args, **kwa
-00027fa0: 7267 7329 3a0a 2020 2020 2020 2020 7261  rgs):.        ra
-00027fb0: 6973 6520 4174 7472 6962 7574 6545 7272  ise AttributeErr
-00027fc0: 6f72 2822 2749 6e64 6578 2720 6f62 6a65  or("'Index' obje
-00027fd0: 6374 2068 6173 206e 6f20 6174 7472 6962  ct has no attrib
-00027fe0: 7574 6520 2773 7464 2722 290a 0a20 2020  ute 'std'")..   
-00027ff0: 2064 6566 2076 6172 2873 656c 662c 202a   def var(self, *
-00028000: 6172 6773 2c20 2a2a 6b77 6172 6773 293a  args, **kwargs):
-00028010: 0a20 2020 2020 2020 2072 6169 7365 2041  .        raise A
-00028020: 7474 7269 6275 7465 4572 726f 7228 2227  ttributeError("'
-00028030: 496e 6465 7827 206f 626a 6563 7420 6861  Index' object ha
-00028040: 7320 6e6f 2061 7474 7269 6275 7465 2027  s no attribute '
-00028050: 7661 7227 2229 0a0a 2020 2020 6465 6620  var'")..    def 
-00028060: 6964 786d 6178 2873 656c 662c 202a 6172  idxmax(self, *ar
-00028070: 6773 2c20 2a2a 6b77 6172 6773 293a 0a20  gs, **kwargs):. 
-00028080: 2020 2020 2020 2072 6169 7365 2041 7474         raise Att
-00028090: 7269 6275 7465 4572 726f 7228 2227 496e  ributeError("'In
-000280a0: 6465 7827 206f 626a 6563 7420 6861 7320  dex' object has 
-000280b0: 6e6f 2061 7474 7269 6275 7465 2027 6964  no attribute 'id
-000280c0: 786d 6178 2722 290a 0a20 2020 2064 6566  xmax'")..    def
-000280d0: 2069 6478 6d69 6e28 7365 6c66 2c20 2a61   idxmin(self, *a
-000280e0: 7267 732c 202a 2a6b 7761 7267 7329 3a0a  rgs, **kwargs):.
-000280f0: 2020 2020 2020 2020 7261 6973 6520 4174          raise At
-00028100: 7472 6962 7574 6545 7272 6f72 2822 2749  tributeError("'I
-00028110: 6e64 6578 2720 6f62 6a65 6374 2068 6173  ndex' object has
-00028120: 206e 6f20 6174 7472 6962 7574 6520 2769   no attribute 'i
-00028130: 6478 6d69 6e27 2229 0a0a 0a63 6c61 7373  dxmin'")...class
-00028140: 2053 6361 6c61 7228 4672 616d 6542 6173   Scalar(FrameBas
-00028150: 6529 3a0a 2020 2020 2222 2253 6361 6c61  e):.    """Scala
-00028160: 7220 4578 7072 2043 6f6c 6c65 6374 696f  r Expr Collectio
-00028170: 6e22 2222 0a0a 2020 2020 6465 6620 5f5f  n"""..    def __
-00028180: 7265 7072 5f5f 2873 656c 6629 3a0a 2020  repr__(self):.  
-00028190: 2020 2020 2020 7265 7475 726e 2066 223c        return f"<
-000281a0: 6461 736b 5f65 7870 722e 6578 7072 2e53  dask_expr.expr.S
-000281b0: 6361 6c61 723a 2065 7870 723d 7b73 656c  calar: expr={sel
-000281c0: 662e 6578 7072 7d2c 2064 7479 7065 3d7b  f.expr}, dtype={
-000281d0: 7365 6c66 2e64 7479 7065 7d3e 220a 0a20  self.dtype}>".. 
-000281e0: 2020 2064 6566 205f 5f62 6f6f 6c5f 5f28     def __bool__(
-000281f0: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
-00028200: 6169 7365 2054 7970 6545 7272 6f72 280a  aise TypeError(.
-00028210: 2020 2020 2020 2020 2020 2020 6622 5472              f"Tr
-00028220: 7969 6e67 2074 6f20 636f 6e76 6572 7420  ying to convert 
-00028230: 7b73 656c 667d 2074 6f20 6120 626f 6f6c  {self} to a bool
-00028240: 6561 6e20 7661 6c75 652e 2042 6563 6175  ean value. Becau
-00028250: 7365 2044 6173 6b20 6f62 6a65 6374 7320  se Dask objects 
-00028260: 6172 6520 220a 2020 2020 2020 2020 2020  are ".          
-00028270: 2020 226c 617a 696c 7920 6576 616c 7561    "lazily evalua
-00028280: 7465 642c 2074 6865 7920 6361 6e6e 6f74  ted, they cannot
-00028290: 2062 6520 636f 6e76 6572 7465 6420 746f   be converted to
-000282a0: 2061 2062 6f6f 6c65 616e 2076 616c 7565   a boolean value
-000282b0: 206f 7220 7573 6564 2022 0a20 2020 2020   or used ".     
-000282c0: 2020 2020 2020 2022 696e 2062 6f6f 6c65         "in boole
-000282d0: 616e 2063 6f6e 6469 7469 6f6e 7320 6c69  an conditions li
-000282e0: 6b65 2069 6620 7374 6174 656d 656e 7473  ke if statements
-000282f0: 2e20 5472 7920 6361 6c6c 696e 6720 2e63  . Try calling .c
-00028300: 6f6d 7075 7465 2829 2074 6f20 220a 2020  ompute() to ".  
-00028310: 2020 2020 2020 2020 2020 2266 6f72 6365            "force
-00028320: 2063 6f6d 7075 7461 7469 6f6e 2070 7269   computation pri
-00028330: 6f72 2074 6f20 636f 6e76 6572 7469 6e67  or to converting
-00028340: 2074 6f20 6120 626f 6f6c 6561 6e20 7661   to a boolean va
-00028350: 6c75 6520 6f72 2075 7369 6e67 2069 6e20  lue or using in 
-00028360: 220a 2020 2020 2020 2020 2020 2020 2261  ".            "a
-00028370: 2063 6f6e 6469 7469 6f6e 616c 2073 7461   conditional sta
-00028380: 7465 6d65 6e74 2e22 0a20 2020 2020 2020  tement.".       
-00028390: 2029 0a0a 2020 2020 6465 6620 5f5f 6461   )..    def __da
-000283a0: 736b 5f70 6f73 7463 6f6d 7075 7465 5f5f  sk_postcompute__
-000283b0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-000283c0: 7265 7475 726e 2066 6972 7374 2c20 2829  return first, ()
-000283d0: 0a0a 2020 2020 6465 6620 746f 5f73 6572  ..    def to_ser
-000283e0: 6965 7328 7365 6c66 2c20 696e 6465 783d  ies(self, index=
-000283f0: 3029 202d 3e20 5365 7269 6573 3a0a 2020  0) -> Series:.  
-00028400: 2020 2020 2020 7265 7475 726e 206e 6577        return new
-00028410: 5f63 6f6c 6c65 6374 696f 6e28 6578 7072  _collection(expr
-00028420: 2e53 6361 6c61 7254 6f53 6572 6965 7328  .ScalarToSeries(
-00028430: 7365 6c66 2c20 696e 6465 783d 696e 6465  self, index=inde
-00028440: 7829 290a 0a20 2020 2064 6566 205f 5f61  x))..    def __a
-00028450: 7272 6179 5f5f 2873 656c 6629 3a0a 2020  rray__(self):.  
-00028460: 2020 2020 2020 2320 6172 7261 7920 696e        # array in
-00028470: 7465 7266 6163 6520 6973 2072 6571 7569  terface is requi
-00028480: 7265 6420 746f 2073 7570 706f 7274 2070  red to support p
-00028490: 616e 6461 7320 696e 7374 616e 6365 202b  andas instance +
-000284a0: 2053 6361 6c61 720a 2020 2020 2020 2020   Scalar.        
-000284b0: 2320 4f74 6865 7277 6973 652c 2061 626f  # Otherwise, abo
-000284c0: 7665 206f 7020 7265 7375 6c74 7320 696e  ve op results in
-000284d0: 2070 642e 5365 7269 6573 206f 6620 5363   pd.Series of Sc
-000284e0: 616c 6172 2028 6f62 6a65 6374 2064 7479  alar (object dty
-000284f0: 7065 290a 2020 2020 2020 2020 7265 7475  pe).        retu
-00028500: 726e 206e 702e 6173 6172 7261 7928 7365  rn np.asarray(se
-00028510: 6c66 2e63 6f6d 7075 7465 2829 290a 0a20  lf.compute()).. 
-00028520: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
-00028530: 2064 6566 2064 7479 7065 2873 656c 6629   def dtype(self)
-00028540: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00028550: 2073 656c 662e 5f6d 6574 612e 6474 7970   self._meta.dtyp
-00028560: 650a 0a0a 6465 6620 6e65 775f 636f 6c6c  e...def new_coll
-00028570: 6563 7469 6f6e 2865 7870 7229 3a0a 2020  ection(expr):.  
-00028580: 2020 2222 2243 7265 6174 6520 6e65 7720    """Create new 
-00028590: 636f 6c6c 6563 7469 6f6e 2066 726f 6d20  collection from 
-000285a0: 616e 2065 7870 7222 2222 0a20 2020 206d  an expr""".    m
-000285b0: 6574 6120 3d20 6578 7072 2e5f 6d65 7461  eta = expr._meta
-000285c0: 0a20 2020 2065 7870 722e 5f6e 616d 6520  .    expr._name 
-000285d0: 2023 2045 6e73 7572 6520 6261 636b 656e   # Ensure backen
-000285e0: 6420 6973 2069 6d70 6f72 7465 640a 2020  d is imported.  
-000285f0: 2020 7265 7475 726e 2067 6574 5f63 6f6c    return get_col
-00028600: 6c65 6374 696f 6e5f 7479 7065 286d 6574  lection_type(met
-00028610: 6129 2865 7870 7229 0a0a 0a64 6566 206f  a)(expr)...def o
-00028620: 7074 696d 697a 6528 636f 6c6c 6563 7469  ptimize(collecti
-00028630: 6f6e 2c20 6675 7365 3d54 7275 6529 3a0a  on, fuse=True):.
-00028640: 2020 2020 7265 7475 726e 206e 6577 5f63      return new_c
-00028650: 6f6c 6c65 6374 696f 6e28 6578 7072 2e6f  ollection(expr.o
-00028660: 7074 696d 697a 6528 636f 6c6c 6563 7469  ptimize(collecti
-00028670: 6f6e 2e65 7870 722c 2066 7573 653d 6675  on.expr, fuse=fu
-00028680: 7365 2929 0a0a 0a64 6566 2066 726f 6d5f  se))...def from_
-00028690: 7061 6e64 6173 2864 6174 612c 206e 7061  pandas(data, npa
-000286a0: 7274 6974 696f 6e73 3d4e 6f6e 652c 2073  rtitions=None, s
-000286b0: 6f72 743d 5472 7565 2c20 6368 756e 6b73  ort=True, chunks
-000286c0: 697a 653d 4e6f 6e65 293a 0a20 2020 2069  ize=None):.    i
-000286d0: 6620 6368 756e 6b73 697a 6520 6973 206e  f chunksize is n
-000286e0: 6f74 204e 6f6e 6520 616e 6420 6e70 6172  ot None and npar
-000286f0: 7469 7469 6f6e 7320 6973 206e 6f74 204e  titions is not N
-00028700: 6f6e 653a 0a20 2020 2020 2020 2072 6169  one:.        rai
-00028710: 7365 2056 616c 7565 4572 726f 7228 2245  se ValueError("E
-00028720: 7861 6374 6c79 206f 6e65 206f 6620 6e70  xactly one of np
-00028730: 6172 7469 7469 6f6e 7320 616e 6420 6368  artitions and ch
-00028740: 756e 6b73 697a 6520 6d75 7374 2062 6520  unksize must be 
-00028750: 7370 6563 6966 6965 642e 2229 0a20 2020  specified.").   
-00028760: 2065 6c69 6620 6368 756e 6b73 697a 6520   elif chunksize 
-00028770: 6973 204e 6f6e 6520 616e 6420 6e70 6172  is None and npar
-00028780: 7469 7469 6f6e 7320 6973 204e 6f6e 653a  titions is None:
-00028790: 0a20 2020 2020 2020 206e 7061 7274 6974  .        npartit
-000287a0: 696f 6e73 203d 2031 0a0a 2020 2020 6966  ions = 1..    if
-000287b0: 206e 6f74 2068 6173 5f70 6172 616c 6c65   not has_paralle
-000287c0: 6c5f 7479 7065 2864 6174 6129 3a0a 2020  l_type(data):.  
-000287d0: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
-000287e0: 4572 726f 7228 2249 6e70 7574 206d 7573  Error("Input mus
-000287f0: 7420 6265 2061 2070 616e 6461 7320 4461  t be a pandas Da
-00028800: 7461 4672 616d 6520 6f72 2053 6572 6965  taFrame or Serie
-00028810: 732e 2229 0a0a 2020 2020 6966 2064 6174  s.")..    if dat
-00028820: 612e 696e 6465 782e 6973 6e61 2829 2e61  a.index.isna().a
-00028830: 6e79 2829 2061 6e64 206e 6f74 205f 6973  ny() and not _is
-00028840: 5f61 6e79 5f72 6561 6c5f 6e75 6d65 7269  _any_real_numeri
-00028850: 635f 6474 7970 6528 6461 7461 2e69 6e64  c_dtype(data.ind
-00028860: 6578 293a 0a20 2020 2020 2020 2072 6169  ex):.        rai
-00028870: 7365 204e 6f74 496d 706c 656d 656e 7465  se NotImplemente
-00028880: 6445 7272 6f72 280a 2020 2020 2020 2020  dError(.        
-00028890: 2020 2020 2249 6e64 6578 2069 6e20 7061      "Index in pa
-000288a0: 7373 6564 2064 6174 6120 6973 206e 6f6e  ssed data is non
-000288b0: 2d6e 756d 6572 6963 2061 6e64 2063 6f6e  -numeric and con
-000288c0: 7461 696e 7320 6e75 6c6c 732c 2077 6869  tains nulls, whi
-000288d0: 6368 2044 6173 6b20 646f 6573 206e 6f74  ch Dask does not
-000288e0: 2065 6e74 6972 656c 7920 7375 7070 6f72   entirely suppor
-000288f0: 742e 5c6e 220a 2020 2020 2020 2020 2020  t.\n".          
-00028900: 2020 2243 6f6e 7369 6465 7220 7061 7373    "Consider pass
-00028910: 696e 6720 6064 6174 612e 6c6f 635b 7e64  ing `data.loc[~d
-00028920: 6174 612e 6973 6e61 2829 5d60 2069 6e73  ata.isna()]` ins
-00028930: 7465 6164 2e22 0a20 2020 2020 2020 2029  tead.".        )
-00028940: 0a0a 2020 2020 6966 206e 7061 7274 6974  ..    if npartit
-00028950: 696f 6e73 2069 7320 6e6f 7420 4e6f 6e65  ions is not None
-00028960: 2061 6e64 206e 6f74 2069 7369 6e73 7461   and not isinsta
-00028970: 6e63 6528 6e70 6172 7469 7469 6f6e 732c  nce(npartitions,
-00028980: 2069 6e74 293a 0a20 2020 2020 2020 2072   int):.        r
-00028990: 6169 7365 2054 7970 6545 7272 6f72 280a  aise TypeError(.
-000289a0: 2020 2020 2020 2020 2020 2020 2250 6c65              "Ple
-000289b0: 6173 6520 7072 6f76 6964 6520 6e70 6172  ase provide npar
-000289c0: 7469 7469 6f6e 7320 6173 2061 6e20 696e  titions as an in
-000289d0: 742c 206f 7220 706f 7373 6962 6c79 2061  t, or possibly a
-000289e0: 7320 4e6f 6e65 2069 6620 796f 7520 7370  s None if you sp
-000289f0: 6563 6966 7920 6368 756e 6b73 697a 652e  ecify chunksize.
-00028a00: 220a 2020 2020 2020 2020 290a 2020 2020  ".        ).    
-00028a10: 656c 6966 2063 6875 6e6b 7369 7a65 2069  elif chunksize i
-00028a20: 7320 6e6f 7420 4e6f 6e65 2061 6e64 206e  s not None and n
-00028a30: 6f74 2069 7369 6e73 7461 6e63 6528 6368  ot isinstance(ch
-00028a40: 756e 6b73 697a 652c 2069 6e74 293a 0a20  unksize, int):. 
-00028a50: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
-00028a60: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
-00028a70: 2020 2020 2250 6c65 6173 6520 7072 6f76      "Please prov
-00028a80: 6964 6520 6368 756e 6b73 697a 6520 6173  ide chunksize as
-00028a90: 2061 6e20 696e 742c 206f 7220 706f 7373   an int, or poss
-00028aa0: 6962 6c79 2061 7320 4e6f 6e65 2069 6620  ibly as None if 
-00028ab0: 796f 7520 7370 6563 6966 7920 6e70 6172  you specify npar
-00028ac0: 7469 7469 6f6e 732e 220a 2020 2020 2020  titions.".      
-00028ad0: 2020 290a 0a20 2020 2066 726f 6d20 6461    )..    from da
-00028ae0: 736b 5f65 7870 722e 696f 2e69 6f20 696d  sk_expr.io.io im
-00028af0: 706f 7274 2046 726f 6d50 616e 6461 730a  port FromPandas.
-00028b00: 0a20 2020 2072 6574 7572 6e20 6e65 775f  .    return new_
-00028b10: 636f 6c6c 6563 7469 6f6e 280a 2020 2020  collection(.    
-00028b20: 2020 2020 4672 6f6d 5061 6e64 6173 280a      FromPandas(.
-00028b30: 2020 2020 2020 2020 2020 2020 5f42 6163              _Bac
-00028b40: 6b65 6e64 4461 7461 2864 6174 612e 636f  kendData(data.co
-00028b50: 7079 2829 292c 0a20 2020 2020 2020 2020  py()),.         
-00028b60: 2020 206e 7061 7274 6974 696f 6e73 3d6e     npartitions=n
-00028b70: 7061 7274 6974 696f 6e73 2c0a 2020 2020  partitions,.    
-00028b80: 2020 2020 2020 2020 736f 7274 3d73 6f72          sort=sor
-00028b90: 742c 0a20 2020 2020 2020 2020 2020 2063  t,.            c
-00028ba0: 6875 6e6b 7369 7a65 3d63 6875 6e6b 7369  hunksize=chunksi
-00028bb0: 7a65 2c0a 2020 2020 2020 2020 2020 2020  ze,.            
-00028bc0: 7079 6172 726f 775f 7374 7269 6e67 735f  pyarrow_strings_
-00028bd0: 656e 6162 6c65 643d 7079 6172 726f 775f  enabled=pyarrow_
-00028be0: 7374 7269 6e67 735f 656e 6162 6c65 6428  strings_enabled(
-00028bf0: 292c 0a20 2020 2020 2020 2029 0a20 2020  ),.        ).   
-00028c00: 2029 0a0a 0a64 6566 2066 726f 6d5f 6172   )...def from_ar
-00028c10: 7261 7928 6172 722c 2063 6875 6e6b 7369  ray(arr, chunksi
-00028c20: 7a65 3d35 305f 3030 302c 2063 6f6c 756d  ze=50_000, colum
-00028c30: 6e73 3d4e 6f6e 652c 206d 6574 613d 4e6f  ns=None, meta=No
-00028c40: 6e65 293a 0a20 2020 2069 6d70 6f72 7420  ne):.    import 
-00028c50: 6461 736b 2e61 7272 6179 2061 7320 6461  dask.array as da
-00028c60: 0a0a 2020 2020 6966 2069 7369 6e73 7461  ..    if isinsta
-00028c70: 6e63 6528 6172 722c 2064 612e 4172 7261  nce(arr, da.Arra
-00028c80: 7929 3a0a 2020 2020 2020 2020 7265 7475  y):.        retu
-00028c90: 726e 2066 726f 6d5f 6461 736b 5f61 7272  rn from_dask_arr
-00028ca0: 6179 2861 7272 2c20 636f 6c75 6d6e 733d  ay(arr, columns=
-00028cb0: 636f 6c75 6d6e 732c 206d 6574 613d 6d65  columns, meta=me
-00028cc0: 7461 290a 0a20 2020 2066 726f 6d20 6461  ta)..    from da
-00028cd0: 736b 5f65 7870 722e 696f 2e69 6f20 696d  sk_expr.io.io im
-00028ce0: 706f 7274 2046 726f 6d41 7272 6179 0a0a  port FromArray..
-00028cf0: 2020 2020 7265 7375 6c74 203d 2046 726f      result = Fro
-00028d00: 6d41 7272 6179 280a 2020 2020 2020 2020  mArray(.        
-00028d10: 6172 722c 0a20 2020 2020 2020 2063 6875  arr,.        chu
-00028d20: 6e6b 7369 7a65 3d63 6875 6e6b 7369 7a65  nksize=chunksize
-00028d30: 2c0a 2020 2020 2020 2020 6f72 6967 696e  ,.        origin
-00028d40: 616c 5f63 6f6c 756d 6e73 3d63 6f6c 756d  al_columns=colum
-00028d50: 6e73 2c0a 2020 2020 2020 2020 6d65 7461  ns,.        meta
-00028d60: 3d6d 6574 612c 0a20 2020 2029 0a20 2020  =meta,.    ).   
-00028d70: 2069 6620 7079 6172 726f 775f 7374 7269   if pyarrow_stri
-00028d80: 6e67 735f 656e 6162 6c65 6428 2920 616e  ngs_enabled() an
-00028d90: 6420 6172 722e 6474 7970 652e 6b69 6e64  d arr.dtype.kind
-00028da0: 2069 6e20 224f 5522 3a0a 2020 2020 2020   in "OU":.      
-00028db0: 2020 7265 7375 6c74 203d 2065 7870 722e    result = expr.
-00028dc0: 4172 726f 7753 7472 696e 6743 6f6e 7665  ArrowStringConve
-00028dd0: 7273 696f 6e28 7265 7375 6c74 290a 2020  rsion(result).  
-00028de0: 2020 7265 7475 726e 206e 6577 5f63 6f6c    return new_col
-00028df0: 6c65 6374 696f 6e28 7265 7375 6c74 290a  lection(result).
-00028e00: 0a0a 6465 6620 6672 6f6d 5f67 7261 7068  ..def from_graph
-00028e10: 282a 6172 6773 2c20 2a2a 6b77 6172 6773  (*args, **kwargs
-00028e20: 293a 0a20 2020 2066 726f 6d20 6461 736b  ):.    from dask
-00028e30: 5f65 7870 722e 696f 2e69 6f20 696d 706f  _expr.io.io impo
-00028e40: 7274 2046 726f 6d47 7261 7068 0a0a 2020  rt FromGraph..  
-00028e50: 2020 7265 7475 726e 206e 6577 5f63 6f6c    return new_col
-00028e60: 6c65 6374 696f 6e28 4672 6f6d 4772 6170  lection(FromGrap
-00028e70: 6828 2a61 7267 732c 202a 2a6b 7761 7267  h(*args, **kwarg
-00028e80: 7329 290a 0a0a 4064 6174 6166 7261 6d65  s))...@dataframe
-00028e90: 5f63 7265 6174 696f 6e5f 6469 7370 6174  _creation_dispat
-00028ea0: 6368 2e72 6567 6973 7465 725f 696e 706c  ch.register_inpl
-00028eb0: 6163 6528 2270 616e 6461 7322 290a 6465  ace("pandas").de
-00028ec0: 6620 6672 6f6d 5f64 6963 7428 0a20 2020  f from_dict(.   
-00028ed0: 2064 6174 612c 0a20 2020 206e 7061 7274   data,.    npart
-00028ee0: 6974 696f 6e73 2c0a 2020 2020 6f72 6965  itions,.    orie
-00028ef0: 6e74 3d22 636f 6c75 6d6e 7322 2c0a 2020  nt="columns",.  
-00028f00: 2020 6474 7970 653d 4e6f 6e65 2c0a 2020    dtype=None,.  
-00028f10: 2020 636f 6c75 6d6e 733d 4e6f 6e65 2c0a    columns=None,.
-00028f20: 2020 2020 636f 6e73 7472 7563 746f 723d      constructor=
-00028f30: 7064 2e44 6174 6146 7261 6d65 2c0a 293a  pd.DataFrame,.):
-00028f40: 0a20 2020 2022 2222 0a20 2020 2043 6f6e  .    """.    Con
-00028f50: 7374 7275 6374 2061 2044 6173 6b20 4461  struct a Dask Da
-00028f60: 7461 4672 616d 6520 6672 6f6d 2061 2050  taFrame from a P
-00028f70: 7974 686f 6e20 4469 6374 696f 6e61 7279  ython Dictionary
-00028f80: 0a0a 2020 2020 5061 7261 6d65 7465 7273  ..    Parameters
-00028f90: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a  .    ----------.
-00028fa0: 2020 2020 6461 7461 203a 2064 6963 740a      data : dict.
-00028fb0: 2020 2020 2020 2020 4f66 2074 6865 2066          Of the f
-00028fc0: 6f72 6d20 7b66 6965 6c64 203a 2061 7272  orm {field : arr
-00028fd0: 6179 2d6c 696b 657d 206f 7220 7b66 6965  ay-like} or {fie
-00028fe0: 6c64 203a 2064 6963 747d 2e0a 2020 2020  ld : dict}..    
-00028ff0: 6e70 6172 7469 7469 6f6e 7320 3a20 696e  npartitions : in
-00029000: 740a 2020 2020 2020 2020 5468 6520 6e75  t.        The nu
-00029010: 6d62 6572 206f 6620 7061 7274 6974 696f  mber of partitio
-00029020: 6e73 206f 6620 7468 6520 696e 6465 7820  ns of the index 
-00029030: 746f 2063 7265 6174 652e 204e 6f74 6520  to create. Note 
-00029040: 7468 6174 2064 6570 656e 6469 6e67 206f  that depending o
-00029050: 6e0a 2020 2020 2020 2020 7468 6520 7369  n.        the si
-00029060: 7a65 2061 6e64 2069 6e64 6578 206f 6620  ze and index of 
-00029070: 7468 6520 6461 7461 6672 616d 652c 2074  the dataframe, t
-00029080: 6865 206f 7574 7075 7420 6d61 7920 6861  he output may ha
-00029090: 7665 2066 6577 6572 0a20 2020 2020 2020  ve fewer.       
-000290a0: 2070 6172 7469 7469 6f6e 7320 7468 616e   partitions than
-000290b0: 2072 6571 7565 7374 6564 2e0a 2020 2020   requested..    
-000290c0: 6f72 6965 6e74 203a 207b 2763 6f6c 756d  orient : {'colum
-000290d0: 6e73 272c 2027 696e 6465 7827 2c20 2774  ns', 'index', 't
-000290e0: 6967 6874 277d 2c20 6465 6661 756c 7420  ight'}, default 
-000290f0: 2763 6f6c 756d 6e73 270a 2020 2020 2020  'columns'.      
-00029100: 2020 5468 6520 226f 7269 656e 7461 7469    The "orientati
-00029110: 6f6e 2220 6f66 2074 6865 2064 6174 612e  on" of the data.
-00029120: 2049 6620 7468 6520 6b65 7973 206f 6620   If the keys of 
-00029130: 7468 6520 7061 7373 6564 2064 6963 740a  the passed dict.
-00029140: 2020 2020 2020 2020 7368 6f75 6c64 2062          should b
-00029150: 6520 7468 6520 636f 6c75 6d6e 7320 6f66  e the columns of
-00029160: 2074 6865 2072 6573 756c 7469 6e67 2044   the resulting D
-00029170: 6174 6146 7261 6d65 2c20 7061 7373 2027  ataFrame, pass '
-00029180: 636f 6c75 6d6e 7327 0a20 2020 2020 2020  columns'.       
-00029190: 2028 6465 6661 756c 7429 2e20 4f74 6865   (default). Othe
-000291a0: 7277 6973 6520 6966 2074 6865 206b 6579  rwise if the key
-000291b0: 7320 7368 6f75 6c64 2062 6520 726f 7773  s should be rows
-000291c0: 2c20 7061 7373 2027 696e 6465 7827 2e0a  , pass 'index'..
-000291d0: 2020 2020 2020 2020 4966 2027 7469 6768          If 'tigh
-000291e0: 7427 2c20 6173 7375 6d65 2061 2064 6963  t', assume a dic
-000291f0: 7420 7769 7468 206b 6579 730a 2020 2020  t with keys.    
-00029200: 2020 2020 5b27 696e 6465 7827 2c20 2763      ['index', 'c
-00029210: 6f6c 756d 6e73 272c 2027 6461 7461 272c  olumns', 'data',
-00029220: 2027 696e 6465 785f 6e61 6d65 7327 2c20   'index_names', 
-00029230: 2763 6f6c 756d 6e5f 6e61 6d65 7327 5d2e  'column_names'].
-00029240: 0a20 2020 2064 7479 7065 3a20 626f 6f6c  .    dtype: bool
-00029250: 0a20 2020 2020 2020 2044 6174 6120 7479  .        Data ty
-00029260: 7065 2074 6f20 666f 7263 652c 206f 7468  pe to force, oth
-00029270: 6572 7769 7365 2069 6e66 6572 2e0a 2020  erwise infer..  
-00029280: 2020 636f 6c75 6d6e 733a 2073 7472 696e    columns: strin
-00029290: 672c 206f 7074 696f 6e61 6c0a 2020 2020  g, optional.    
-000292a0: 2020 2020 436f 6c75 6d6e 206c 6162 656c      Column label
-000292b0: 7320 746f 2075 7365 2077 6865 6e20 6060  s to use when ``
-000292c0: 6f72 6965 6e74 3d27 696e 6465 7827 6060  orient='index'``
-000292d0: 2e20 5261 6973 6573 2061 2056 616c 7565  . Raises a Value
-000292e0: 4572 726f 720a 2020 2020 2020 2020 6966  Error.        if
-000292f0: 2075 7365 6420 7769 7468 2060 606f 7269   used with ``ori
-00029300: 656e 743d 2763 6f6c 756d 6e73 2760 6020  ent='columns'`` 
-00029310: 6f72 2060 606f 7269 656e 743d 2774 6967  or ``orient='tig
-00029320: 6874 2760 602e 0a20 2020 2063 6f6e 7374  ht'``..    const
-00029330: 7275 6374 6f72 3a20 636c 6173 732c 2064  ructor: class, d
-00029340: 6566 6175 6c74 2070 642e 4461 7461 4672  efault pd.DataFr
-00029350: 616d 650a 2020 2020 2020 2020 436c 6173  ame.        Clas
-00029360: 7320 7769 7468 2077 6869 6368 2060 6066  s with which ``f
-00029370: 726f 6d5f 6469 6374 6060 2073 686f 756c  rom_dict`` shoul
-00029380: 6420 6265 2063 616c 6c65 6420 7769 7468  d be called with
-00029390: 2e0a 0a20 2020 2045 7861 6d70 6c65 730a  ...    Examples.
-000293a0: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
-000293b0: 203e 3e3e 2069 6d70 6f72 7420 6461 736b   >>> import dask
-000293c0: 2e64 6174 6166 7261 6d65 2061 7320 6464  .dataframe as dd
-000293d0: 0a20 2020 203e 3e3e 2064 6466 203d 2064  .    >>> ddf = d
-000293e0: 642e 6672 6f6d 5f64 6963 7428 7b22 6e75  d.from_dict({"nu
-000293f0: 6d31 223a 205b 312c 2032 2c20 332c 2034  m1": [1, 2, 3, 4
-00029400: 5d2c 2022 6e75 6d32 223a 205b 372c 2038  ], "num2": [7, 8
-00029410: 2c20 392c 2031 305d 7d2c 206e 7061 7274  , 9, 10]}, npart
-00029420: 6974 696f 6e73 3d32 290a 2020 2020 2222  itions=2).    ""
-00029430: 220a 0a20 2020 2063 6f6c 6c65 6374 696f  "..    collectio
-00029440: 6e5f 7479 7065 7320 3d20 7b74 7970 6528  n_types = {type(
-00029450: 7629 2066 6f72 2076 2069 6e20 6461 7461  v) for v in data
-00029460: 2e76 616c 7565 7328 2920 6966 2069 735f  .values() if is_
-00029470: 6461 736b 5f63 6f6c 6c65 6374 696f 6e28  dask_collection(
-00029480: 7629 7d0a 2020 2020 6966 2063 6f6c 6c65  v)}.    if colle
-00029490: 6374 696f 6e5f 7479 7065 733a 0a20 2020  ction_types:.   
-000294a0: 2020 2020 2072 6169 7365 204e 6f74 496d       raise NotIm
-000294b0: 706c 656d 656e 7465 6445 7272 6f72 280a  plementedError(.
-000294c0: 2020 2020 2020 2020 2020 2020 2266 726f              "fro
-000294d0: 6d5f 6469 6374 2064 6f65 736e 2774 2063  m_dict doesn't c
-000294e0: 7572 7265 6e74 6c79 2073 7570 706f 7274  urrently support
-000294f0: 2044 6173 6b20 636f 6c6c 6563 7469 6f6e   Dask collection
-00029500: 7320 6173 2069 6e70 7574 732e 2022 0a20  s as inputs. ". 
-00029510: 2020 2020 2020 2020 2020 2066 224f 626a             f"Obj
-00029520: 6563 7473 206f 6620 7479 7065 207b 636f  ects of type {co
-00029530: 6c6c 6563 7469 6f6e 5f74 7970 6573 7d20  llection_types} 
-00029540: 7765 7265 2067 6976 656e 2069 6e20 7468  were given in th
-00029550: 6520 696e 7075 7420 6469 6374 2e22 0a20  e input dict.". 
-00029560: 2020 2020 2020 2029 0a0a 2020 2020 7265         )..    re
-00029570: 7475 726e 2066 726f 6d5f 7061 6e64 6173  turn from_pandas
-00029580: 280a 2020 2020 2020 2020 636f 6e73 7472  (.        constr
-00029590: 7563 746f 722e 6672 6f6d 5f64 6963 7428  uctor.from_dict(
-000295a0: 6461 7461 2c20 6f72 6965 6e74 2c20 6474  data, orient, dt
-000295b0: 7970 652c 2063 6f6c 756d 6e73 292c 0a20  ype, columns),. 
-000295c0: 2020 2020 2020 206e 7061 7274 6974 696f         npartitio
-000295d0: 6e73 2c0a 2020 2020 290a 0a0a 6465 6620  ns,.    )...def 
-000295e0: 6672 6f6d 5f64 6173 6b5f 6461 7461 6672  from_dask_datafr
-000295f0: 616d 6528 6464 663a 205f 4672 616d 652c  ame(ddf: _Frame,
-00029600: 206f 7074 696d 697a 653a 2062 6f6f 6c20   optimize: bool 
-00029610: 3d20 5472 7565 2920 2d3e 2046 7261 6d65  = True) -> Frame
-00029620: 4261 7365 3a0a 2020 2020 2222 2243 7265  Base:.    """Cre
-00029630: 6174 6520 6120 6461 736b 2d65 7870 7220  ate a dask-expr 
-00029640: 636f 6c6c 6563 7469 6f6e 2066 726f 6d20  collection from 
-00029650: 6120 6461 736b 2d64 6174 6166 7261 6d65  a dask-dataframe
-00029660: 2063 6f6c 6c65 6374 696f 6e0a 0a20 2020   collection..   
-00029670: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-00029680: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 206f  ----------.    o
-00029690: 7074 696d 697a 650a 2020 2020 2020 2020  ptimize.        
-000296a0: 5768 6574 6865 7220 746f 206f 7074 696d  Whether to optim
-000296b0: 697a 6520 7468 6520 6772 6170 6820 6265  ize the graph be
-000296c0: 666f 7265 2063 6f6e 7665 7273 696f 6e2e  fore conversion.
-000296d0: 0a20 2020 2022 2222 0a20 2020 2067 7261  .    """.    gra
-000296e0: 7068 203d 2064 6466 2e64 6173 6b0a 2020  ph = ddf.dask.  
-000296f0: 2020 6966 206f 7074 696d 697a 653a 0a20    if optimize:. 
-00029700: 2020 2020 2020 2067 7261 7068 203d 2064         graph = d
-00029710: 6466 2e5f 5f64 6173 6b5f 6f70 7469 6d69  df.__dask_optimi
-00029720: 7a65 5f5f 2867 7261 7068 2c20 6464 662e  ze__(graph, ddf.
-00029730: 5f5f 6461 736b 5f6b 6579 735f 5f28 2929  __dask_keys__())
-00029740: 0a20 2020 2072 6574 7572 6e20 6672 6f6d  .    return from
-00029750: 5f67 7261 7068 280a 2020 2020 2020 2020  _graph(.        
-00029760: 6772 6170 682c 2064 6466 2e5f 6d65 7461  graph, ddf._meta
-00029770: 2c20 6464 662e 6469 7669 7369 6f6e 732c  , ddf.divisions,
-00029780: 2064 6466 2e5f 5f64 6173 6b5f 6b65 7973   ddf.__dask_keys
-00029790: 5f5f 2829 2c20 6b65 795f 7370 6c69 7428  __(), key_split(
-000297a0: 6464 662e 5f6e 616d 6529 0a20 2020 2029  ddf._name).    )
-000297b0: 0a0a 0a64 6566 2066 726f 6d5f 6461 736b  ...def from_dask
-000297c0: 5f61 7272 6179 2878 2c20 636f 6c75 6d6e  _array(x, column
-000297d0: 733d 4e6f 6e65 2c20 696e 6465 783d 4e6f  s=None, index=No
-000297e0: 6e65 2c20 6d65 7461 3d4e 6f6e 6529 3a0a  ne, meta=None):.
-000297f0: 2020 2020 6672 6f6d 2064 6173 6b2e 6461      from dask.da
-00029800: 7461 6672 616d 652e 696f 2069 6d70 6f72  taframe.io impor
-00029810: 7420 6672 6f6d 5f64 6173 6b5f 6172 7261  t from_dask_arra
-00029820: 790a 0a20 2020 2069 6620 6973 696e 7374  y..    if isinst
-00029830: 616e 6365 2869 6e64 6578 2c20 4672 616d  ance(index, Fram
-00029840: 6542 6173 6529 3a0a 2020 2020 2020 2020  eBase):.        
-00029850: 696e 6465 7820 3d20 696e 6465 782e 746f  index = index.to
-00029860: 5f64 6173 6b5f 6461 7461 6672 616d 6528  _dask_dataframe(
-00029870: 290a 2020 2020 6966 2063 6f6c 756d 6e73  ).    if columns
-00029880: 2069 7320 6e6f 7420 4e6f 6e65 2061 6e64   is not None and
-00029890: 206e 6f74 206c 656e 2863 6f6c 756d 6e73   not len(columns
-000298a0: 293a 0a20 2020 2020 2020 2063 6f6c 756d  ):.        colum
-000298b0: 6e73 203d 204e 6f6e 650a 2020 2020 6466  ns = None.    df
-000298c0: 203d 2066 726f 6d5f 6461 736b 5f61 7272   = from_dask_arr
-000298d0: 6179 2878 2c20 636f 6c75 6d6e 733d 636f  ay(x, columns=co
-000298e0: 6c75 6d6e 732c 2069 6e64 6578 3d69 6e64  lumns, index=ind
-000298f0: 6578 2c20 6d65 7461 3d6d 6574 6129 0a20  ex, meta=meta). 
-00029900: 2020 2072 6574 7572 6e20 6672 6f6d 5f64     return from_d
-00029910: 6173 6b5f 6461 7461 6672 616d 6528 6466  ask_dataframe(df
-00029920: 2c20 6f70 7469 6d69 7a65 3d54 7275 6529  , optimize=True)
-00029930: 0a0a 0a64 6566 2072 6561 645f 6373 7628  ...def read_csv(
-00029940: 0a20 2020 2070 6174 682c 0a20 2020 202a  .    path,.    *
-00029950: 6172 6773 2c0a 2020 2020 6865 6164 6572  args,.    header
-00029960: 3d22 696e 6665 7222 2c0a 2020 2020 7573  ="infer",.    us
-00029970: 6563 6f6c 733d 4e6f 6e65 2c0a 2020 2020  ecols=None,.    
-00029980: 6474 7970 655f 6261 636b 656e 643d 4e6f  dtype_backend=No
-00029990: 6e65 2c0a 2020 2020 7374 6f72 6167 655f  ne,.    storage_
-000299a0: 6f70 7469 6f6e 733d 4e6f 6e65 2c0a 2020  options=None,.  
-000299b0: 2020 2a2a 6b77 6172 6773 2c0a 293a 0a20    **kwargs,.):. 
-000299c0: 2020 2066 726f 6d20 6461 736b 5f65 7870     from dask_exp
-000299d0: 722e 696f 2e63 7376 2069 6d70 6f72 7420  r.io.csv import 
-000299e0: 5265 6164 4353 560a 0a20 2020 2069 6620  ReadCSV..    if 
-000299f0: 6e6f 7420 6973 696e 7374 616e 6365 2870  not isinstance(p
-00029a00: 6174 682c 2073 7472 293a 0a20 2020 2020  ath, str):.     
-00029a10: 2020 2070 6174 6820 3d20 7374 7269 6e67     path = string
-00029a20: 6966 795f 7061 7468 2870 6174 6829 0a20  ify_path(path). 
-00029a30: 2020 2072 6574 7572 6e20 6e65 775f 636f     return new_co
-00029a40: 6c6c 6563 7469 6f6e 280a 2020 2020 2020  llection(.      
-00029a50: 2020 5265 6164 4353 5628 0a20 2020 2020    ReadCSV(.     
-00029a60: 2020 2020 2020 2070 6174 682c 0a20 2020         path,.   
-00029a70: 2020 2020 2020 2020 2063 6f6c 756d 6e73           columns
-00029a80: 3d75 7365 636f 6c73 2c0a 2020 2020 2020  =usecols,.      
-00029a90: 2020 2020 2020 6474 7970 655f 6261 636b        dtype_back
-00029aa0: 656e 643d 6474 7970 655f 6261 636b 656e  end=dtype_backen
-00029ab0: 642c 0a20 2020 2020 2020 2020 2020 2073  d,.            s
-00029ac0: 746f 7261 6765 5f6f 7074 696f 6e73 3d73  torage_options=s
-00029ad0: 746f 7261 6765 5f6f 7074 696f 6e73 2c0a  torage_options,.
-00029ae0: 2020 2020 2020 2020 2020 2020 6b77 6172              kwar
-00029af0: 6773 3d6b 7761 7267 732c 0a20 2020 2020  gs=kwargs,.     
-00029b00: 2020 2020 2020 2068 6561 6465 723d 6865         header=he
-00029b10: 6164 6572 2c0a 2020 2020 2020 2020 290a  ader,.        ).
-00029b20: 2020 2020 290a 0a0a 6465 6620 7265 6164      )...def read
-00029b30: 5f74 6162 6c65 280a 2020 2020 7061 7468  _table(.    path
-00029b40: 2c0a 2020 2020 2a61 7267 732c 0a20 2020  ,.    *args,.   
-00029b50: 2068 6561 6465 723d 2269 6e66 6572 222c   header="infer",
-00029b60: 0a20 2020 2075 7365 636f 6c73 3d4e 6f6e  .    usecols=Non
-00029b70: 652c 0a20 2020 2064 7479 7065 5f62 6163  e,.    dtype_bac
-00029b80: 6b65 6e64 3d4e 6f6e 652c 0a20 2020 2073  kend=None,.    s
-00029b90: 746f 7261 6765 5f6f 7074 696f 6e73 3d4e  torage_options=N
-00029ba0: 6f6e 652c 0a20 2020 202a 2a6b 7761 7267  one,.    **kwarg
-00029bb0: 732c 0a29 3a0a 2020 2020 6672 6f6d 2064  s,.):.    from d
-00029bc0: 6173 6b5f 6578 7072 2e69 6f2e 6373 7620  ask_expr.io.csv 
-00029bd0: 696d 706f 7274 2052 6561 6454 6162 6c65  import ReadTable
-00029be0: 0a0a 2020 2020 6966 206e 6f74 2069 7369  ..    if not isi
-00029bf0: 6e73 7461 6e63 6528 7061 7468 2c20 7374  nstance(path, st
-00029c00: 7229 3a0a 2020 2020 2020 2020 7061 7468  r):.        path
-00029c10: 203d 2073 7472 696e 6769 6679 5f70 6174   = stringify_pat
-00029c20: 6828 7061 7468 290a 2020 2020 7265 7475  h(path).    retu
-00029c30: 726e 206e 6577 5f63 6f6c 6c65 6374 696f  rn new_collectio
-00029c40: 6e28 0a20 2020 2020 2020 2052 6561 6454  n(.        ReadT
-00029c50: 6162 6c65 280a 2020 2020 2020 2020 2020  able(.          
-00029c60: 2020 7061 7468 2c0a 2020 2020 2020 2020    path,.        
-00029c70: 2020 2020 636f 6c75 6d6e 733d 7573 6563      columns=usec
-00029c80: 6f6c 732c 0a20 2020 2020 2020 2020 2020  ols,.           
-00029c90: 2064 7479 7065 5f62 6163 6b65 6e64 3d64   dtype_backend=d
-00029ca0: 7479 7065 5f62 6163 6b65 6e64 2c0a 2020  type_backend,.  
-00029cb0: 2020 2020 2020 2020 2020 7374 6f72 6167            storag
-00029cc0: 655f 6f70 7469 6f6e 733d 7374 6f72 6167  e_options=storag
-00029cd0: 655f 6f70 7469 6f6e 732c 0a20 2020 2020  e_options,.     
-00029ce0: 2020 2020 2020 206b 7761 7267 733d 6b77         kwargs=kw
-00029cf0: 6172 6773 2c0a 2020 2020 2020 2020 2020  args,.          
-00029d00: 2020 6865 6164 6572 3d68 6561 6465 722c    header=header,
-00029d10: 0a20 2020 2020 2020 2029 0a20 2020 2029  .        ).    )
-00029d20: 0a0a 0a64 6566 2072 6561 645f 6677 6628  ...def read_fwf(
-00029d30: 0a20 2020 2070 6174 682c 0a20 2020 202a  .    path,.    *
-00029d40: 6172 6773 2c0a 2020 2020 6865 6164 6572  args,.    header
-00029d50: 3d22 696e 6665 7222 2c0a 2020 2020 7573  ="infer",.    us
-00029d60: 6563 6f6c 733d 4e6f 6e65 2c0a 2020 2020  ecols=None,.    
-00029d70: 6474 7970 655f 6261 636b 656e 643d 4e6f  dtype_backend=No
-00029d80: 6e65 2c0a 2020 2020 7374 6f72 6167 655f  ne,.    storage_
-00029d90: 6f70 7469 6f6e 733d 4e6f 6e65 2c0a 2020  options=None,.  
-00029da0: 2020 2a2a 6b77 6172 6773 2c0a 293a 0a20    **kwargs,.):. 
-00029db0: 2020 2066 726f 6d20 6461 736b 5f65 7870     from dask_exp
-00029dc0: 722e 696f 2e63 7376 2069 6d70 6f72 7420  r.io.csv import 
-00029dd0: 5265 6164 4677 660a 0a20 2020 2069 6620  ReadFwf..    if 
-00029de0: 6e6f 7420 6973 696e 7374 616e 6365 2870  not isinstance(p
-00029df0: 6174 682c 2073 7472 293a 0a20 2020 2020  ath, str):.     
-00029e00: 2020 2070 6174 6820 3d20 7374 7269 6e67     path = string
-00029e10: 6966 795f 7061 7468 2870 6174 6829 0a20  ify_path(path). 
-00029e20: 2020 2072 6574 7572 6e20 6e65 775f 636f     return new_co
-00029e30: 6c6c 6563 7469 6f6e 280a 2020 2020 2020  llection(.      
-00029e40: 2020 5265 6164 4677 6628 0a20 2020 2020    ReadFwf(.     
-00029e50: 2020 2020 2020 2070 6174 682c 0a20 2020         path,.   
-00029e60: 2020 2020 2020 2020 2063 6f6c 756d 6e73           columns
-00029e70: 3d75 7365 636f 6c73 2c0a 2020 2020 2020  =usecols,.      
-00029e80: 2020 2020 2020 6474 7970 655f 6261 636b        dtype_back
-00029e90: 656e 643d 6474 7970 655f 6261 636b 656e  end=dtype_backen
-00029ea0: 642c 0a20 2020 2020 2020 2020 2020 2073  d,.            s
-00029eb0: 746f 7261 6765 5f6f 7074 696f 6e73 3d73  torage_options=s
-00029ec0: 746f 7261 6765 5f6f 7074 696f 6e73 2c0a  torage_options,.
-00029ed0: 2020 2020 2020 2020 2020 2020 6b77 6172              kwar
-00029ee0: 6773 3d6b 7761 7267 732c 0a20 2020 2020  gs=kwargs,.     
-00029ef0: 2020 2020 2020 2068 6561 6465 723d 6865         header=he
-00029f00: 6164 6572 2c0a 2020 2020 2020 2020 290a  ader,.        ).
-00029f10: 2020 2020 290a 0a0a 6465 6620 7265 6164      )...def read
-00029f20: 5f70 6172 7175 6574 280a 2020 2020 7061  _parquet(.    pa
-00029f30: 7468 3d4e 6f6e 652c 0a20 2020 2063 6f6c  th=None,.    col
-00029f40: 756d 6e73 3d4e 6f6e 652c 0a20 2020 2066  umns=None,.    f
-00029f50: 696c 7465 7273 3d4e 6f6e 652c 0a20 2020  ilters=None,.   
-00029f60: 2063 6174 6567 6f72 6965 733d 4e6f 6e65   categories=None
-00029f70: 2c0a 2020 2020 696e 6465 783d 4e6f 6e65  ,.    index=None
-00029f80: 2c0a 2020 2020 7374 6f72 6167 655f 6f70  ,.    storage_op
-00029f90: 7469 6f6e 733d 4e6f 6e65 2c0a 2020 2020  tions=None,.    
-00029fa0: 6474 7970 655f 6261 636b 656e 643d 4e6f  dtype_backend=No
-00029fb0: 6e65 2c0a 2020 2020 6361 6c63 756c 6174  ne,.    calculat
-00029fc0: 655f 6469 7669 7369 6f6e 733d 4661 6c73  e_divisions=Fals
-00029fd0: 652c 0a20 2020 2069 676e 6f72 655f 6d65  e,.    ignore_me
-00029fe0: 7461 6461 7461 5f66 696c 653d 4661 6c73  tadata_file=Fals
-00029ff0: 652c 0a20 2020 206d 6574 6164 6174 615f  e,.    metadata_
-0002a000: 7461 736b 5f73 697a 653d 4e6f 6e65 2c0a  task_size=None,.
-0002a010: 2020 2020 7370 6c69 745f 726f 775f 6772      split_row_gr
-0002a020: 6f75 7073 3d22 696e 6665 7222 2c0a 2020  oups="infer",.  
-0002a030: 2020 626c 6f63 6b73 697a 653d 2264 6566    blocksize="def
-0002a040: 6175 6c74 222c 0a20 2020 2061 6767 7265  ault",.    aggre
-0002a050: 6761 7465 5f66 696c 6573 3d4e 6f6e 652c  gate_files=None,
-0002a060: 0a20 2020 2070 6172 7175 6574 5f66 696c  .    parquet_fil
-0002a070: 655f 6578 7465 6e73 696f 6e3d 2822 2e70  e_extension=(".p
-0002a080: 6172 7122 2c20 222e 7061 7271 7565 7422  arq", ".parquet"
-0002a090: 2c20 222e 7071 2229 2c0a 2020 2020 6669  , ".pq"),.    fi
-0002a0a0: 6c65 7379 7374 656d 3d22 6673 7370 6563  lesystem="fsspec
-0002a0b0: 222c 0a20 2020 2065 6e67 696e 653d 4e6f  ",.    engine=No
-0002a0c0: 6e65 2c0a 2020 2020 6172 726f 775f 746f  ne,.    arrow_to
-0002a0d0: 5f70 616e 6461 733d 4e6f 6e65 2c0a 2020  _pandas=None,.  
-0002a0e0: 2020 2a2a 6b77 6172 6773 2c0a 293a 0a20    **kwargs,.):. 
-0002a0f0: 2020 2066 726f 6d20 6461 736b 5f65 7870     from dask_exp
-0002a100: 722e 696f 2e70 6172 7175 6574 2069 6d70  r.io.parquet imp
-0002a110: 6f72 7420 280a 2020 2020 2020 2020 5265  ort (.        Re
-0002a120: 6164 5061 7271 7565 7446 5353 7065 632c  adParquetFSSpec,
-0002a130: 0a20 2020 2020 2020 2052 6561 6450 6172  .        ReadPar
-0002a140: 7175 6574 5079 6172 726f 7746 532c 0a20  quetPyarrowFS,. 
-0002a150: 2020 2020 2020 205f 7365 745f 7061 7271         _set_parq
-0002a160: 7565 745f 656e 6769 6e65 2c0a 2020 2020  uet_engine,.    
-0002a170: 290a 0a20 2020 2069 6620 6e6f 7420 6973  )..    if not is
-0002a180: 696e 7374 616e 6365 2870 6174 682c 2073  instance(path, s
-0002a190: 7472 293a 0a20 2020 2020 2020 2070 6174  tr):.        pat
-0002a1a0: 6820 3d20 7374 7269 6e67 6966 795f 7061  h = stringify_pa
-0002a1b0: 7468 2870 6174 6829 0a0a 2020 2020 6b77  th(path)..    kw
-0002a1c0: 6172 6773 5b22 6474 7970 655f 6261 636b  args["dtype_back
-0002a1d0: 656e 6422 5d20 3d20 6474 7970 655f 6261  end"] = dtype_ba
-0002a1e0: 636b 656e 640a 2020 2020 6966 2061 7272  ckend.    if arr
-0002a1f0: 6f77 5f74 6f5f 7061 6e64 6173 3a0a 2020  ow_to_pandas:.  
-0002a200: 2020 2020 2020 6b77 6172 6773 5b22 6172        kwargs["ar
-0002a210: 726f 775f 746f 5f70 616e 6461 7322 5d20  row_to_pandas"] 
-0002a220: 3d20 6172 726f 775f 746f 5f70 616e 6461  = arrow_to_panda
-0002a230: 730a 0a20 2020 2069 6620 6669 6c74 6572  s..    if filter
-0002a240: 7320 6973 206e 6f74 204e 6f6e 653a 0a20  s is not None:. 
-0002a250: 2020 2020 2020 2066 6f72 2066 696c 7465         for filte
-0002a260: 7220 696e 2066 6c61 7474 656e 2866 696c  r in flatten(fil
-0002a270: 7465 7273 2c20 636f 6e74 6169 6e65 723d  ters, container=
-0002a280: 6c69 7374 293a 0a20 2020 2020 2020 2020  list):.         
-0002a290: 2020 2063 6f6c 2c20 6f70 2c20 7661 6c20     col, op, val 
-0002a2a0: 3d20 6669 6c74 6572 0a20 2020 2020 2020  = filter.       
-0002a2b0: 2020 2020 2069 6620 6f70 203d 3d20 2269       if op == "i
-0002a2c0: 6e22 2061 6e64 206e 6f74 2069 7369 6e73  n" and not isins
-0002a2d0: 7461 6e63 6528 7661 6c2c 2028 7365 742c  tance(val, (set,
-0002a2e0: 206c 6973 742c 2074 7570 6c65 2929 3a0a   list, tuple)):.
-0002a2f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a300: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
-0002a310: 2256 616c 7565 206f 6620 2769 6e27 2066  "Value of 'in' f
-0002a320: 696c 7465 7220 6d75 7374 2062 6520 6120  ilter must be a 
-0002a330: 6c69 7374 2c20 7365 7420 6f72 2074 7570  list, set or tup
-0002a340: 6c65 2e22 290a 0a20 2020 2069 6620 280a  le.")..    if (.
-0002a350: 2020 2020 2020 2020 6973 696e 7374 616e          isinstan
-0002a360: 6365 2866 696c 6573 7973 7465 6d2c 2070  ce(filesystem, p
-0002a370: 615f 6673 2e46 696c 6553 7973 7465 6d29  a_fs.FileSystem)
-0002a380: 0a20 2020 2020 2020 206f 7220 6973 696e  .        or isin
-0002a390: 7374 616e 6365 2866 696c 6573 7973 7465  stance(filesyste
-0002a3a0: 6d2c 2073 7472 290a 2020 2020 2020 2020  m, str).        
-0002a3b0: 616e 6420 6669 6c65 7379 7374 656d 2e6c  and filesystem.l
-0002a3c0: 6f77 6572 2829 2069 6e20 2822 6172 726f  ower() in ("arro
-0002a3d0: 7722 2c20 2270 7961 7272 6f77 2229 0a20  w", "pyarrow"). 
-0002a3e0: 2020 2029 3a0a 2020 2020 2020 2020 6966     ):.        if
-0002a3f0: 2070 6172 7365 5f76 6572 7369 6f6e 2870   parse_version(p
-0002a400: 612e 5f5f 7665 7273 696f 6e5f 5f29 203c  a.__version__) <
-0002a410: 2070 6172 7365 5f76 6572 7369 6f6e 2822   parse_version("
-0002a420: 3135 2e30 2e30 2229 3a0a 2020 2020 2020  15.0.0"):.      
-0002a430: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-0002a440: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
-0002a450: 2020 2020 2020 2020 2270 7961 7272 6f77          "pyarrow
-0002a460: 3e3d 3135 2e30 2e30 2069 7320 7265 7175  >=15.0.0 is requ
-0002a470: 6972 6564 2074 6f20 7573 6520 7468 6520  ired to use the 
-0002a480: 7079 6172 726f 7720 6669 6c65 7379 7374  pyarrow filesyst
-0002a490: 656d 2e22 0a20 2020 2020 2020 2020 2020  em.".           
-0002a4a0: 2029 0a20 2020 2020 2020 2069 6620 6d65   ).        if me
-0002a4b0: 7461 6461 7461 5f74 6173 6b5f 7369 7a65  tadata_task_size
-0002a4c0: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-0002a4d0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0002a4e0: 4e6f 7449 6d70 6c65 6d65 6e74 6564 4572  NotImplementedEr
-0002a4f0: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-0002a500: 2020 2020 2022 6d65 7461 6461 7461 5f74       "metadata_t
-0002a510: 6173 6b5f 7369 7a65 2069 7320 6e6f 7420  ask_size is not 
-0002a520: 7375 7070 6f72 7465 6420 7768 656e 2075  supported when u
-0002a530: 7369 6e67 2074 6865 2070 7961 7272 6f77  sing the pyarrow
-0002a540: 2066 696c 6573 7973 7465 6d2e 220a 2020   filesystem.".  
-0002a550: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0002a560: 2020 2020 6966 2073 706c 6974 5f72 6f77      if split_row
-0002a570: 5f67 726f 7570 7320 213d 2022 696e 6665  _groups != "infe
-0002a580: 7222 3a0a 2020 2020 2020 2020 2020 2020  r":.            
-0002a590: 7261 6973 6520 4e6f 7449 6d70 6c65 6d65  raise NotImpleme
-0002a5a0: 6e74 6564 4572 726f 7228 0a20 2020 2020  ntedError(.     
-0002a5b0: 2020 2020 2020 2020 2020 2022 7370 6c69             "spli
-0002a5c0: 745f 726f 775f 6772 6f75 7073 2069 7320  t_row_groups is 
-0002a5d0: 6e6f 7420 7375 7070 6f72 7465 6420 7768  not supported wh
-0002a5e0: 656e 2075 7369 6e67 2074 6865 2070 7961  en using the pya
-0002a5f0: 7272 6f77 2066 696c 6573 7973 7465 6d2e  rrow filesystem.
-0002a600: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
-0002a610: 2020 2020 2020 2020 6966 2062 6c6f 636b          if block
-0002a620: 7369 7a65 2069 7320 6e6f 7420 4e6f 6e65  size is not None
-0002a630: 2061 6e64 2062 6c6f 636b 7369 7a65 2021   and blocksize !
-0002a640: 3d20 2264 6566 6175 6c74 223a 0a20 2020  = "default":.   
-0002a650: 2020 2020 2020 2020 2072 6169 7365 204e           raise N
-0002a660: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
-0002a670: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-0002a680: 2020 2020 2262 6c6f 636b 7369 7a65 2069      "blocksize i
-0002a690: 7320 6e6f 7420 7375 7070 6f72 7465 6420  s not supported 
-0002a6a0: 7768 656e 2075 7369 6e67 2074 6865 2070  when using the p
-0002a6b0: 7961 7272 6f77 2066 696c 6573 7973 7465  yarrow filesyste
-0002a6c0: 6d2e 220a 2020 2020 2020 2020 2020 2020  m.".            
-0002a6d0: 290a 2020 2020 2020 2020 6966 2061 6767  ).        if agg
-0002a6e0: 7265 6761 7465 5f66 696c 6573 2069 7320  regate_files is 
-0002a6f0: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-0002a700: 2020 2020 2020 7261 6973 6520 4e6f 7449        raise NotI
-0002a710: 6d70 6c65 6d65 6e74 6564 4572 726f 7228  mplementedError(
-0002a720: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002a730: 2022 6167 6772 6567 6174 655f 6669 6c65   "aggregate_file
-0002a740: 7320 6973 206e 6f74 2073 7570 706f 7274  s is not support
-0002a750: 6564 2077 6865 6e20 7573 696e 6720 7468  ed when using th
-0002a760: 6520 7079 6172 726f 7720 6669 6c65 7379  e pyarrow filesy
-0002a770: 7374 656d 2e22 0a20 2020 2020 2020 2020  stem.".         
-0002a780: 2020 2029 0a20 2020 2020 2020 2069 6620     ).        if 
-0002a790: 7061 7271 7565 745f 6669 6c65 5f65 7874  parquet_file_ext
-0002a7a0: 656e 7369 6f6e 2021 3d20 2822 2e70 6172  ension != (".par
-0002a7b0: 7122 2c20 222e 7061 7271 7565 7422 2c20  q", ".parquet", 
-0002a7c0: 222e 7071 2229 3a0a 2020 2020 2020 2020  ".pq"):.        
-0002a7d0: 2020 2020 7261 6973 6520 4e6f 7449 6d70      raise NotImp
-0002a7e0: 6c65 6d65 6e74 6564 4572 726f 7228 0a20  lementedError(. 
-0002a7f0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0002a800: 7061 7271 7565 745f 6669 6c65 5f65 7874  parquet_file_ext
-0002a810: 656e 7369 6f6e 2069 7320 6e6f 7420 7375  ension is not su
-0002a820: 7070 6f72 7465 6420 7768 656e 2075 7369  pported when usi
-0002a830: 6e67 2074 6865 2070 7961 7272 6f77 2066  ng the pyarrow f
-0002a840: 696c 6573 7973 7465 6d2e 220a 2020 2020  ilesystem.".    
-0002a850: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0002a860: 2020 6966 2065 6e67 696e 6520 6973 206e    if engine is n
-0002a870: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
-0002a880: 2020 2020 2072 6169 7365 204e 6f74 496d       raise NotIm
-0002a890: 706c 656d 656e 7465 6445 7272 6f72 280a  plementedError(.
-0002a8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a8b0: 2265 6e67 696e 6520 6973 206e 6f74 2073  "engine is not s
-0002a8c0: 7570 706f 7274 6564 2077 6865 6e20 7573  upported when us
-0002a8d0: 696e 6720 7468 6520 7079 6172 726f 7720  ing the pyarrow 
-0002a8e0: 6669 6c65 7379 7374 656d 2e22 0a20 2020  filesystem.".   
-0002a8f0: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-0002a900: 2020 2020 7265 7475 726e 206e 6577 5f63      return new_c
-0002a910: 6f6c 6c65 6374 696f 6e28 0a20 2020 2020  ollection(.     
-0002a920: 2020 2020 2020 2052 6561 6450 6172 7175         ReadParqu
-0002a930: 6574 5079 6172 726f 7746 5328 0a20 2020  etPyarrowFS(.   
-0002a940: 2020 2020 2020 2020 2020 2020 2070 6174               pat
-0002a950: 682c 0a20 2020 2020 2020 2020 2020 2020  h,.             
-0002a960: 2020 2063 6f6c 756d 6e73 3d5f 636f 6e76     columns=_conv
-0002a970: 6572 745f 746f 5f6c 6973 7428 636f 6c75  ert_to_list(colu
-0002a980: 6d6e 7329 2c0a 2020 2020 2020 2020 2020  mns),.          
-0002a990: 2020 2020 2020 6669 6c74 6572 733d 6669        filters=fi
-0002a9a0: 6c74 6572 732c 0a20 2020 2020 2020 2020  lters,.         
-0002a9b0: 2020 2020 2020 2063 6174 6567 6f72 6965         categorie
-0002a9c0: 733d 6361 7465 676f 7269 6573 2c0a 2020  s=categories,.  
-0002a9d0: 2020 2020 2020 2020 2020 2020 2020 696e                in
-0002a9e0: 6465 783d 696e 6465 782c 0a20 2020 2020  dex=index,.     
-0002a9f0: 2020 2020 2020 2020 2020 2063 616c 6375             calcu
-0002aa00: 6c61 7465 5f64 6976 6973 696f 6e73 3d63  late_divisions=c
-0002aa10: 616c 6375 6c61 7465 5f64 6976 6973 696f  alculate_divisio
-0002aa20: 6e73 2c0a 2020 2020 2020 2020 2020 2020  ns,.            
-0002aa30: 2020 2020 7374 6f72 6167 655f 6f70 7469      storage_opti
-0002aa40: 6f6e 733d 7374 6f72 6167 655f 6f70 7469  ons=storage_opti
-0002aa50: 6f6e 732c 0a20 2020 2020 2020 2020 2020  ons,.           
-0002aa60: 2020 2020 2066 696c 6573 7973 7465 6d3d       filesystem=
-0002aa70: 6669 6c65 7379 7374 656d 2c0a 2020 2020  filesystem,.    
-0002aa80: 2020 2020 2020 2020 2020 2020 6967 6e6f              igno
-0002aa90: 7265 5f6d 6574 6164 6174 615f 6669 6c65  re_metadata_file
-0002aaa0: 3d69 676e 6f72 655f 6d65 7461 6461 7461  =ignore_metadata
-0002aab0: 5f66 696c 652c 0a20 2020 2020 2020 2020  _file,.         
-0002aac0: 2020 2020 2020 2061 7272 6f77 5f74 6f5f         arrow_to_
-0002aad0: 7061 6e64 6173 3d61 7272 6f77 5f74 6f5f  pandas=arrow_to_
-0002aae0: 7061 6e64 6173 2c0a 2020 2020 2020 2020  pandas,.        
-0002aaf0: 2020 2020 2020 2020 7079 6172 726f 775f          pyarrow_
-0002ab00: 7374 7269 6e67 735f 656e 6162 6c65 643d  strings_enabled=
-0002ab10: 7079 6172 726f 775f 7374 7269 6e67 735f  pyarrow_strings_
-0002ab20: 656e 6162 6c65 6428 292c 0a20 2020 2020  enabled(),.     
-0002ab30: 2020 2020 2020 2020 2020 206b 7761 7267             kwarg
-0002ab40: 733d 6b77 6172 6773 2c0a 2020 2020 2020  s=kwargs,.      
-0002ab50: 2020 2020 2020 2020 2020 5f73 6572 6965            _serie
-0002ab60: 733d 6973 696e 7374 616e 6365 2863 6f6c  s=isinstance(col
-0002ab70: 756d 6e73 2c20 7374 7229 2c0a 2020 2020  umns, str),.    
-0002ab80: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0002ab90: 2020 290a 0a20 2020 2072 6574 7572 6e20    )..    return 
-0002aba0: 6e65 775f 636f 6c6c 6563 7469 6f6e 280a  new_collection(.
-0002abb0: 2020 2020 2020 2020 5265 6164 5061 7271          ReadParq
-0002abc0: 7565 7446 5353 7065 6328 0a20 2020 2020  uetFSSpec(.     
-0002abd0: 2020 2020 2020 2070 6174 682c 0a20 2020         path,.   
-0002abe0: 2020 2020 2020 2020 2063 6f6c 756d 6e73           columns
-0002abf0: 3d5f 636f 6e76 6572 745f 746f 5f6c 6973  =_convert_to_lis
-0002ac00: 7428 636f 6c75 6d6e 7329 2c0a 2020 2020  t(columns),.    
-0002ac10: 2020 2020 2020 2020 6669 6c74 6572 733d          filters=
-0002ac20: 6669 6c74 6572 732c 0a20 2020 2020 2020  filters,.       
-0002ac30: 2020 2020 2063 6174 6567 6f72 6965 733d       categories=
-0002ac40: 6361 7465 676f 7269 6573 2c0a 2020 2020  categories,.    
-0002ac50: 2020 2020 2020 2020 696e 6465 783d 696e          index=in
-0002ac60: 6465 782c 0a20 2020 2020 2020 2020 2020  dex,.           
-0002ac70: 2073 746f 7261 6765 5f6f 7074 696f 6e73   storage_options
-0002ac80: 3d73 746f 7261 6765 5f6f 7074 696f 6e73  =storage_options
-0002ac90: 2c0a 2020 2020 2020 2020 2020 2020 6361  ,.            ca
-0002aca0: 6c63 756c 6174 655f 6469 7669 7369 6f6e  lculate_division
-0002acb0: 733d 6361 6c63 756c 6174 655f 6469 7669  s=calculate_divi
-0002acc0: 7369 6f6e 732c 0a20 2020 2020 2020 2020  sions,.         
-0002acd0: 2020 2069 676e 6f72 655f 6d65 7461 6461     ignore_metada
-0002ace0: 7461 5f66 696c 653d 6967 6e6f 7265 5f6d  ta_file=ignore_m
-0002acf0: 6574 6164 6174 615f 6669 6c65 2c0a 2020  etadata_file,.  
-0002ad00: 2020 2020 2020 2020 2020 6d65 7461 6461            metada
-0002ad10: 7461 5f74 6173 6b5f 7369 7a65 3d6d 6574  ta_task_size=met
-0002ad20: 6164 6174 615f 7461 736b 5f73 697a 652c  adata_task_size,
-0002ad30: 0a20 2020 2020 2020 2020 2020 2073 706c  .            spl
-0002ad40: 6974 5f72 6f77 5f67 726f 7570 733d 7370  it_row_groups=sp
-0002ad50: 6c69 745f 726f 775f 6772 6f75 7073 2c0a  lit_row_groups,.
-0002ad60: 2020 2020 2020 2020 2020 2020 626c 6f63              bloc
-0002ad70: 6b73 697a 653d 626c 6f63 6b73 697a 652c  ksize=blocksize,
-0002ad80: 0a20 2020 2020 2020 2020 2020 2061 6767  .            agg
-0002ad90: 7265 6761 7465 5f66 696c 6573 3d61 6767  regate_files=agg
-0002ada0: 7265 6761 7465 5f66 696c 6573 2c0a 2020  regate_files,.  
-0002adb0: 2020 2020 2020 2020 2020 7061 7271 7565            parque
-0002adc0: 745f 6669 6c65 5f65 7874 656e 7369 6f6e  t_file_extension
-0002add0: 3d70 6172 7175 6574 5f66 696c 655f 6578  =parquet_file_ex
-0002ade0: 7465 6e73 696f 6e2c 0a20 2020 2020 2020  tension,.       
-0002adf0: 2020 2020 2066 696c 6573 7973 7465 6d3d       filesystem=
-0002ae00: 6669 6c65 7379 7374 656d 2c0a 2020 2020  filesystem,.    
-0002ae10: 2020 2020 2020 2020 656e 6769 6e65 3d5f          engine=_
-0002ae20: 7365 745f 7061 7271 7565 745f 656e 6769  set_parquet_engi
-0002ae30: 6e65 2865 6e67 696e 6529 2c0a 2020 2020  ne(engine),.    
-0002ae40: 2020 2020 2020 2020 6b77 6172 6773 3d6b          kwargs=k
-0002ae50: 7761 7267 732c 0a20 2020 2020 2020 2020  wargs,.         
-0002ae60: 2020 205f 7365 7269 6573 3d69 7369 6e73     _series=isins
-0002ae70: 7461 6e63 6528 636f 6c75 6d6e 732c 2073  tance(columns, s
-0002ae80: 7472 292c 0a20 2020 2020 2020 2029 0a20  tr),.        ). 
-0002ae90: 2020 2029 0a0a 0a64 6566 2063 6f6e 6361     )...def conca
-0002aea0: 7428 0a20 2020 2064 6673 2c0a 2020 2020  t(.    dfs,.    
-0002aeb0: 6178 6973 3d30 2c0a 2020 2020 6a6f 696e  axis=0,.    join
-0002aec0: 3d22 6f75 7465 7222 2c0a 2020 2020 6967  ="outer",.    ig
-0002aed0: 6e6f 7265 5f75 6e6b 6e6f 776e 5f64 6976  nore_unknown_div
-0002aee0: 6973 696f 6e73 3d46 616c 7365 2c0a 2020  isions=False,.  
-0002aef0: 2020 6967 6e6f 7265 5f6f 7264 6572 3d46    ignore_order=F
-0002af00: 616c 7365 2c0a 2020 2020 696e 7465 726c  alse,.    interl
-0002af10: 6561 7665 5f70 6172 7469 7469 6f6e 733d  eave_partitions=
-0002af20: 4661 6c73 652c 0a20 2020 202a 2a6b 7761  False,.    **kwa
-0002af30: 7267 732c 0a29 3a0a 2020 2020 6966 206e  rgs,.):.    if n
-0002af40: 6f74 2069 7369 6e73 7461 6e63 6528 6466  ot isinstance(df
-0002af50: 732c 206c 6973 7429 3a0a 2020 2020 2020  s, list):.      
-0002af60: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
-0002af70: 7228 2264 6673 206d 7573 7420 6265 2061  r("dfs must be a
-0002af80: 206c 6973 7420 6f66 2044 6174 6146 7261   list of DataFra
-0002af90: 6d65 732f 5365 7269 6573 206f 626a 6563  mes/Series objec
-0002afa0: 7473 2229 0a20 2020 2069 6620 6c65 6e28  ts").    if len(
-0002afb0: 6466 7329 203d 3d20 303a 0a20 2020 2020  dfs) == 0:.     
-0002afc0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-0002afd0: 726f 7228 224e 6f20 6f62 6a65 6374 7320  ror("No objects 
-0002afe0: 746f 2063 6f6e 6361 7465 6e61 7465 2229  to concatenate")
-0002aff0: 0a20 2020 2069 6620 6c65 6e28 6466 7329  .    if len(dfs)
-0002b000: 203d 3d20 313a 0a20 2020 2020 2020 2069   == 1:.        i
-0002b010: 6620 6178 6973 203d 3d20 3120 616e 6420  f axis == 1 and 
-0002b020: 6973 696e 7374 616e 6365 2864 6673 5b30  isinstance(dfs[0
-0002b030: 5d2c 2053 6572 6965 7329 3a0a 2020 2020  ], Series):.    
-0002b040: 2020 2020 2020 2020 7265 7475 726e 2064          return d
-0002b050: 6673 5b30 5d2e 746f 5f66 7261 6d65 2829  fs[0].to_frame()
-0002b060: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0002b070: 6466 735b 305d 0a0a 2020 2020 6966 206a  dfs[0]..    if j
-0002b080: 6f69 6e20 6e6f 7420 696e 2028 2269 6e6e  oin not in ("inn
-0002b090: 6572 222c 2022 6f75 7465 7222 293a 0a20  er", "outer"):. 
-0002b0a0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-0002b0b0: 7565 4572 726f 7228 2227 6a6f 696e 2720  ueError("'join' 
-0002b0c0: 6d75 7374 2062 6520 2769 6e6e 6572 2720  must be 'inner' 
-0002b0d0: 6f72 2027 6f75 7465 7227 2229 0a0a 2020  or 'outer'")..  
-0002b0e0: 2020 6466 7320 3d20 5b66 726f 6d5f 7061    dfs = [from_pa
-0002b0f0: 6e64 6173 2864 6629 2069 6620 6e6f 7420  ndas(df) if not 
-0002b100: 6973 696e 7374 616e 6365 2864 662c 2046  isinstance(df, F
-0002b110: 7261 6d65 4261 7365 2920 656c 7365 2064  rameBase) else d
-0002b120: 6620 666f 7220 6466 2069 6e20 6466 735d  f for df in dfs]
-0002b130: 0a0a 2020 2020 6966 2061 7869 7320 3d3d  ..    if axis ==
-0002b140: 2031 3a0a 2020 2020 2020 2020 6466 7320   1:.        dfs 
-0002b150: 3d20 5b64 6620 666f 7220 6466 2069 6e20  = [df for df in 
-0002b160: 6466 7320 6966 206c 656e 2864 662e 636f  dfs if len(df.co
-0002b170: 6c75 6d6e 7329 203e 2030 206f 7220 6973  lumns) > 0 or is
-0002b180: 696e 7374 616e 6365 2864 662c 2053 6572  instance(df, Ser
-0002b190: 6965 7329 5d0a 0a20 2020 2072 6574 7572  ies)]..    retur
-0002b1a0: 6e20 6e65 775f 636f 6c6c 6563 7469 6f6e  n new_collection
-0002b1b0: 280a 2020 2020 2020 2020 436f 6e63 6174  (.        Concat
-0002b1c0: 280a 2020 2020 2020 2020 2020 2020 6a6f  (.            jo
-0002b1d0: 696e 2c0a 2020 2020 2020 2020 2020 2020  in,.            
-0002b1e0: 6967 6e6f 7265 5f6f 7264 6572 2c0a 2020  ignore_order,.  
-0002b1f0: 2020 2020 2020 2020 2020 6b77 6172 6773            kwargs
-0002b200: 2c0a 2020 2020 2020 2020 2020 2020 6178  ,.            ax
-0002b210: 6973 2c0a 2020 2020 2020 2020 2020 2020  is,.            
-0002b220: 6967 6e6f 7265 5f75 6e6b 6e6f 776e 5f64  ignore_unknown_d
-0002b230: 6976 6973 696f 6e73 2c0a 2020 2020 2020  ivisions,.      
-0002b240: 2020 2020 2020 696e 7465 726c 6561 7665        interleave
-0002b250: 5f70 6172 7469 7469 6f6e 732c 0a20 2020  _partitions,.   
-0002b260: 2020 2020 2020 2020 202a 6466 732c 0a20           *dfs,. 
-0002b270: 2020 2020 2020 2029 0a20 2020 2029 0a0a         ).    )..
-0002b280: 0a64 6566 206d 6572 6765 280a 2020 2020  .def merge(.    
-0002b290: 6c65 6674 2c0a 2020 2020 7269 6768 742c  left,.    right,
-0002b2a0: 0a20 2020 2068 6f77 3d22 696e 6e65 7222  .    how="inner"
-0002b2b0: 2c0a 2020 2020 6f6e 3d4e 6f6e 652c 0a20  ,.    on=None,. 
-0002b2c0: 2020 206c 6566 745f 6f6e 3d4e 6f6e 652c     left_on=None,
-0002b2d0: 0a20 2020 2072 6967 6874 5f6f 6e3d 4e6f  .    right_on=No
-0002b2e0: 6e65 2c0a 2020 2020 6c65 6674 5f69 6e64  ne,.    left_ind
-0002b2f0: 6578 3d46 616c 7365 2c0a 2020 2020 7269  ex=False,.    ri
-0002b300: 6768 745f 696e 6465 783d 4661 6c73 652c  ght_index=False,
-0002b310: 0a20 2020 2073 7566 6669 7865 733d 2822  .    suffixes=("
-0002b320: 5f78 222c 2022 5f79 2229 2c0a 2020 2020  _x", "_y"),.    
-0002b330: 696e 6469 6361 746f 723d 4661 6c73 652c  indicator=False,
-0002b340: 0a20 2020 2073 6875 6666 6c65 5f6d 6574  .    shuffle_met
-0002b350: 686f 643d 4e6f 6e65 2c0a 2020 2020 6e70  hod=None,.    np
-0002b360: 6172 7469 7469 6f6e 733d 4e6f 6e65 2c0a  artitions=None,.
-0002b370: 2020 2020 6272 6f61 6463 6173 743d 4e6f      broadcast=No
-0002b380: 6e65 2c0a 293a 0a20 2020 2066 6f72 206f  ne,.):.    for o
-0002b390: 2069 6e20 5b6f 6e2c 206c 6566 745f 6f6e   in [on, left_on
-0002b3a0: 2c20 7269 6768 745f 6f6e 5d3a 0a20 2020  , right_on]:.   
-0002b3b0: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
-0002b3c0: 6365 286f 2c20 4672 616d 6542 6173 6529  ce(o, FrameBase)
-0002b3d0: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-0002b3e0: 6973 6520 4e6f 7449 6d70 6c65 6d65 6e74  ise NotImplement
-0002b3f0: 6564 4572 726f 7228 290a 2020 2020 6966  edError().    if
-0002b400: 206e 6f74 206f 6e20 616e 6420 6e6f 7420   not on and not 
-0002b410: 6c65 6674 5f6f 6e20 616e 6420 6e6f 7420  left_on and not 
-0002b420: 7269 6768 745f 6f6e 2061 6e64 206e 6f74  right_on and not
-0002b430: 206c 6566 745f 696e 6465 7820 616e 6420   left_index and 
-0002b440: 6e6f 7420 7269 6768 745f 696e 6465 783a  not right_index:
-0002b450: 0a20 2020 2020 2020 206f 6e20 3d20 5b63  .        on = [c
-0002b460: 2066 6f72 2063 2069 6e20 6c65 6674 2e63   for c in left.c
-0002b470: 6f6c 756d 6e73 2069 6620 6320 696e 2072  olumns if c in r
-0002b480: 6967 6874 2e63 6f6c 756d 6e73 5d0a 2020  ight.columns].  
-0002b490: 2020 2020 2020 6966 206e 6f74 206f 6e3a        if not on:
-0002b4a0: 0a20 2020 2020 2020 2020 2020 206c 6566  .            lef
-0002b4b0: 745f 696e 6465 7820 3d20 7269 6768 745f  t_index = right_
-0002b4c0: 696e 6465 7820 3d20 5472 7565 0a0a 2020  index = True..  
-0002b4d0: 2020 6966 206f 6e20 616e 6420 6e6f 7420    if on and not 
-0002b4e0: 6c65 6674 5f6f 6e20 616e 6420 6e6f 7420  left_on and not 
-0002b4f0: 7269 6768 745f 6f6e 3a0a 2020 2020 2020  right_on:.      
-0002b500: 2020 6c65 6674 5f6f 6e20 3d20 7269 6768    left_on = righ
-0002b510: 745f 6f6e 203d 206f 6e0a 0a20 2020 2073  t_on = on..    s
-0002b520: 7570 706f 7274 6564 5f68 6f77 203d 2028  upported_how = (
-0002b530: 226c 6566 7422 2c20 2272 6967 6874 222c  "left", "right",
-0002b540: 2022 6f75 7465 7222 2c20 2269 6e6e 6572   "outer", "inner
-0002b550: 222c 2022 6c65 6674 7365 6d69 2229 0a20  ", "leftsemi"). 
-0002b560: 2020 2069 6620 686f 7720 6e6f 7420 696e     if how not in
-0002b570: 2073 7570 706f 7274 6564 5f68 6f77 3a0a   supported_how:.
-0002b580: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-0002b590: 6c75 6545 7272 6f72 280a 2020 2020 2020  lueError(.      
-0002b5a0: 2020 2020 2020 6622 6461 736b 2e64 6174        f"dask.dat
-0002b5b0: 6166 7261 6d65 2e6d 6572 6765 2064 6f65  aframe.merge doe
-0002b5c0: 7320 6e6f 7420 7375 7070 6f72 7420 686f  s not support ho
-0002b5d0: 773d 277b 686f 777d 272e 220a 2020 2020  w='{how}'.".    
-0002b5e0: 2020 2020 2020 2020 6622 4f70 7469 6f6e          f"Option
-0002b5f0: 7320 6172 653a 207b 7375 7070 6f72 7465  s are: {supporte
-0002b600: 645f 686f 777d 2e22 0a20 2020 2020 2020  d_how}.".       
-0002b610: 2029 0a0a 2020 2020 6966 2068 6f77 203d   )..    if how =
-0002b620: 3d20 226c 6566 7473 656d 6922 3a0a 2020  = "leftsemi":.  
-0002b630: 2020 2020 2020 6966 2072 6967 6874 5f69        if right_i
-0002b640: 6e64 6578 206f 7220 616e 7928 0a20 2020  ndex or any(.   
-0002b650: 2020 2020 2020 2020 206f 206e 6f74 2069           o not i
-0002b660: 6e20 7269 6768 742e 636f 6c75 6d6e 7320  n right.columns 
-0002b670: 666f 7220 6f20 696e 205f 636f 6e76 6572  for o in _conver
-0002b680: 745f 746f 5f6c 6973 7428 7269 6768 745f  t_to_list(right_
-0002b690: 6f6e 290a 2020 2020 2020 2020 293a 0a20  on).        ):. 
-0002b6a0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0002b6b0: 204e 6f74 496d 706c 656d 656e 7465 6445   NotImplementedE
-0002b6c0: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-0002b6d0: 2020 2020 2020 2268 6f77 3d27 6c65 6674        "how='left
-0002b6e0: 7365 6d69 2720 646f 6573 206e 6f74 2073  semi' does not s
-0002b6f0: 7570 706f 7274 2072 6967 6874 5f69 6e64  upport right_ind
-0002b700: 6578 3d54 7275 6520 6f72 206f 6e20 636f  ex=True or on co
-0002b710: 6c75 6d6e 7320 6672 6f6d 2074 6865 2069  lumns from the i
-0002b720: 6e64 6578 220a 2020 2020 2020 2020 2020  ndex".          
-0002b730: 2020 290a 2020 2020 2020 2020 656c 7365    ).        else
-0002b740: 3a0a 2020 2020 2020 2020 2020 2020 7269  :.            ri
-0002b750: 6768 7420 3d20 7269 6768 745b 5f63 6f6e  ght = right[_con
-0002b760: 7665 7274 5f74 6f5f 6c69 7374 2872 6967  vert_to_list(rig
-0002b770: 6874 5f6f 6e29 5d2e 7265 6e61 6d65 280a  ht_on)].rename(.
-0002b780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b790: 636f 6c75 6d6e 733d 6469 6374 287a 6970  columns=dict(zip
-0002b7a0: 285f 636f 6e76 6572 745f 746f 5f6c 6973  (_convert_to_lis
-0002b7b0: 7428 7269 6768 745f 6f6e 292c 205f 636f  t(right_on), _co
-0002b7c0: 6e76 6572 745f 746f 5f6c 6973 7428 6c65  nvert_to_list(le
-0002b7d0: 6674 5f6f 6e29 2929 0a20 2020 2020 2020  ft_on))).       
-0002b7e0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-0002b7f0: 2020 2072 6967 6874 5f6f 6e20 3d20 6c65     right_on = le
-0002b800: 6674 5f6f 6e0a 0a20 2020 2023 2054 7261  ft_on..    # Tra
-0002b810: 6e73 666f 726d 2070 616e 6461 7320 6f62  nsform pandas ob
-0002b820: 6a65 6374 7320 696e 746f 2064 6173 6b2e  jects into dask.
-0002b830: 6461 7461 6672 616d 6520 6f62 6a65 6374  dataframe object
-0002b840: 730a 2020 2020 6966 206e 6f74 2069 735f  s.    if not is_
-0002b850: 6461 736b 5f63 6f6c 6c65 6374 696f 6e28  dask_collection(
-0002b860: 6c65 6674 293a 0a20 2020 2020 2020 2069  left):.        i
-0002b870: 6620 7269 6768 745f 696e 6465 7820 616e  f right_index an
-0002b880: 6420 6c65 6674 5f6f 6e3a 2020 2320 6368  d left_on:  # ch
-0002b890: 616e 6765 2074 6f20 6a6f 696e 206f 6e20  ange to join on 
-0002b8a0: 696e 6465 780a 2020 2020 2020 2020 2020  index.          
-0002b8b0: 2020 6c65 6674 203d 206c 6566 742e 7365    left = left.se
-0002b8c0: 745f 696e 6465 7828 6c65 6674 5b6c 6566  t_index(left[lef
-0002b8d0: 745f 6f6e 5d29 0a20 2020 2020 2020 2020  t_on]).         
-0002b8e0: 2020 206c 6566 745f 6f6e 203d 204e 6f6e     left_on = Non
-0002b8f0: 650a 2020 2020 2020 2020 2020 2020 6c65  e.            le
-0002b900: 6674 5f69 6e64 6578 203d 2054 7275 650a  ft_index = True.
-0002b910: 2020 2020 2020 2020 6c65 6674 203d 2066          left = f
-0002b920: 726f 6d5f 7061 6e64 6173 286c 6566 742c  rom_pandas(left,
-0002b930: 206e 7061 7274 6974 696f 6e73 3d31 290a   npartitions=1).
-0002b940: 0a20 2020 2069 6620 6e6f 7420 6973 5f64  .    if not is_d
-0002b950: 6173 6b5f 636f 6c6c 6563 7469 6f6e 2872  ask_collection(r
-0002b960: 6967 6874 293a 0a20 2020 2020 2020 2069  ight):.        i
-0002b970: 6620 6c65 6674 5f69 6e64 6578 2061 6e64  f left_index and
-0002b980: 2072 6967 6874 5f6f 6e3a 2020 2320 6368   right_on:  # ch
-0002b990: 616e 6765 2074 6f20 6a6f 696e 206f 6e20  ange to join on 
-0002b9a0: 696e 6465 780a 2020 2020 2020 2020 2020  index.          
-0002b9b0: 2020 7269 6768 7420 3d20 7269 6768 742e    right = right.
-0002b9c0: 7365 745f 696e 6465 7828 7269 6768 745b  set_index(right[
-0002b9d0: 7269 6768 745f 6f6e 5d29 0a20 2020 2020  right_on]).     
-0002b9e0: 2020 2020 2020 2072 6967 6874 5f6f 6e20         right_on 
-0002b9f0: 3d20 4e6f 6e65 0a20 2020 2020 2020 2020  = None.         
-0002ba00: 2020 2072 6967 6874 5f69 6e64 6578 203d     right_index =
-0002ba10: 2054 7275 650a 2020 2020 2020 2020 7269   True.        ri
-0002ba20: 6768 7420 3d20 6672 6f6d 5f70 616e 6461  ght = from_panda
-0002ba30: 7328 7269 6768 742c 206e 7061 7274 6974  s(right, npartit
-0002ba40: 696f 6e73 3d31 290a 0a20 2020 2061 7373  ions=1)..    ass
-0002ba50: 6572 7420 6973 5f64 6174 6166 7261 6d65  ert is_dataframe
-0002ba60: 5f6c 696b 6528 7269 6768 742e 5f6d 6574  _like(right._met
-0002ba70: 6129 0a20 2020 2069 6620 6c65 6674 5f6f  a).    if left_o
-0002ba80: 6e20 616e 6420 7269 6768 745f 6f6e 3a0a  n and right_on:.
-0002ba90: 2020 2020 2020 2020 7761 726e 5f64 7479          warn_dty
-0002baa0: 7065 5f6d 6973 6d61 7463 6828 6c65 6674  pe_mismatch(left
-0002bab0: 2c20 7269 6768 742c 206c 6566 745f 6f6e  , right, left_on
-0002bac0: 2c20 7269 6768 745f 6f6e 290a 0a20 2020  , right_on)..   
-0002bad0: 2072 6574 7572 6e20 6e65 775f 636f 6c6c   return new_coll
-0002bae0: 6563 7469 6f6e 280a 2020 2020 2020 2020  ection(.        
-0002baf0: 4d65 7267 6528 0a20 2020 2020 2020 2020  Merge(.         
-0002bb00: 2020 206c 6566 742c 0a20 2020 2020 2020     left,.       
-0002bb10: 2020 2020 2072 6967 6874 2c0a 2020 2020       right,.    
-0002bb20: 2020 2020 2020 2020 686f 773d 686f 772c          how=how,
-0002bb30: 0a20 2020 2020 2020 2020 2020 206c 6566  .            lef
-0002bb40: 745f 6f6e 3d6c 6566 745f 6f6e 2c0a 2020  t_on=left_on,.  
-0002bb50: 2020 2020 2020 2020 2020 7269 6768 745f            right_
-0002bb60: 6f6e 3d72 6967 6874 5f6f 6e2c 0a20 2020  on=right_on,.   
-0002bb70: 2020 2020 2020 2020 206c 6566 745f 696e           left_in
-0002bb80: 6465 783d 6c65 6674 5f69 6e64 6578 2c0a  dex=left_index,.
-0002bb90: 2020 2020 2020 2020 2020 2020 7269 6768              righ
-0002bba0: 745f 696e 6465 783d 7269 6768 745f 696e  t_index=right_in
-0002bbb0: 6465 782c 0a20 2020 2020 2020 2020 2020  dex,.           
-0002bbc0: 2073 7566 6669 7865 733d 7375 6666 6978   suffixes=suffix
-0002bbd0: 6573 2c0a 2020 2020 2020 2020 2020 2020  es,.            
-0002bbe0: 696e 6469 6361 746f 723d 696e 6469 6361  indicator=indica
-0002bbf0: 746f 722c 0a20 2020 2020 2020 2020 2020  tor,.           
-0002bc00: 2073 6875 6666 6c65 5f6d 6574 686f 643d   shuffle_method=
-0002bc10: 6765 745f 7370 6563 6966 6965 645f 7368  get_specified_sh
-0002bc20: 7566 666c 6528 7368 7566 666c 655f 6d65  uffle(shuffle_me
-0002bc30: 7468 6f64 292c 0a20 2020 2020 2020 2020  thod),.         
-0002bc40: 2020 205f 6e70 6172 7469 7469 6f6e 733d     _npartitions=
-0002bc50: 6e70 6172 7469 7469 6f6e 732c 0a20 2020  npartitions,.   
-0002bc60: 2020 2020 2020 2020 2062 726f 6164 6361           broadca
-0002bc70: 7374 3d62 726f 6164 6361 7374 2c0a 2020  st=broadcast,.  
-0002bc80: 2020 2020 2020 290a 2020 2020 290a 0a0a        ).    )...
-0002bc90: 6465 6620 6d65 7267 655f 6173 6f66 280a  def merge_asof(.
-0002bca0: 2020 2020 6c65 6674 2c0a 2020 2020 7269      left,.    ri
-0002bcb0: 6768 742c 0a20 2020 206f 6e3d 4e6f 6e65  ght,.    on=None
-0002bcc0: 2c0a 2020 2020 6c65 6674 5f6f 6e3d 4e6f  ,.    left_on=No
-0002bcd0: 6e65 2c0a 2020 2020 7269 6768 745f 6f6e  ne,.    right_on
-0002bce0: 3d4e 6f6e 652c 0a20 2020 206c 6566 745f  =None,.    left_
-0002bcf0: 696e 6465 783d 4661 6c73 652c 0a20 2020  index=False,.   
-0002bd00: 2072 6967 6874 5f69 6e64 6578 3d46 616c   right_index=Fal
-0002bd10: 7365 2c0a 2020 2020 6279 3d4e 6f6e 652c  se,.    by=None,
-0002bd20: 0a20 2020 206c 6566 745f 6279 3d4e 6f6e  .    left_by=Non
-0002bd30: 652c 0a20 2020 2072 6967 6874 5f62 793d  e,.    right_by=
-0002bd40: 4e6f 6e65 2c0a 2020 2020 7375 6666 6978  None,.    suffix
-0002bd50: 6573 3d28 225f 7822 2c20 225f 7922 292c  es=("_x", "_y"),
-0002bd60: 0a20 2020 2074 6f6c 6572 616e 6365 3d4e  .    tolerance=N
-0002bd70: 6f6e 652c 0a20 2020 2061 6c6c 6f77 5f65  one,.    allow_e
-0002bd80: 7861 6374 5f6d 6174 6368 6573 3d54 7275  xact_matches=Tru
-0002bd90: 652c 0a20 2020 2064 6972 6563 7469 6f6e  e,.    direction
-0002bda0: 3d22 6261 636b 7761 7264 222c 0a29 3a0a  ="backward",.):.
-0002bdb0: 2020 2020 6966 2064 6972 6563 7469 6f6e      if direction
-0002bdc0: 206e 6f74 2069 6e20 5b22 6261 636b 7761   not in ["backwa
-0002bdd0: 7264 222c 2022 666f 7277 6172 6422 2c20  rd", "forward", 
-0002bde0: 226e 6561 7265 7374 225d 3a0a 2020 2020  "nearest"]:.    
-0002bdf0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-0002be00: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-0002be10: 2020 2249 6e76 616c 6964 206d 6572 6765    "Invalid merge
-0002be20: 5f61 736f 6620 6469 7265 6374 696f 6e2e  _asof direction.
-0002be30: 2043 686f 6f73 6520 6672 6f6d 2027 6261   Choose from 'ba
-0002be40: 636b 7761 7264 2722 0a20 2020 2020 2020  ckward'".       
-0002be50: 2020 2020 2022 2027 666f 7277 6172 6427       " 'forward'
-0002be60: 2c20 6f72 2027 6e65 6172 6573 7427 220a  , or 'nearest'".
-0002be70: 2020 2020 2020 2020 290a 0a20 2020 206b          )..    k
-0002be80: 7761 7267 7320 3d20 7b0a 2020 2020 2020  wargs = {.      
-0002be90: 2020 226f 6e22 3a20 6f6e 2c0a 2020 2020    "on": on,.    
-0002bea0: 2020 2020 226c 6566 745f 6f6e 223a 206c      "left_on": l
-0002beb0: 6566 745f 6f6e 2c0a 2020 2020 2020 2020  eft_on,.        
-0002bec0: 2272 6967 6874 5f6f 6e22 3a20 7269 6768  "right_on": righ
-0002bed0: 745f 6f6e 2c0a 2020 2020 2020 2020 226c  t_on,.        "l
-0002bee0: 6566 745f 696e 6465 7822 3a20 6c65 6674  eft_index": left
-0002bef0: 5f69 6e64 6578 2c0a 2020 2020 2020 2020  _index,.        
-0002bf00: 2272 6967 6874 5f69 6e64 6578 223a 2072  "right_index": r
-0002bf10: 6967 6874 5f69 6e64 6578 2c0a 2020 2020  ight_index,.    
-0002bf20: 2020 2020 2262 7922 3a20 6279 2c0a 2020      "by": by,.  
-0002bf30: 2020 2020 2020 226c 6566 745f 6279 223a        "left_by":
-0002bf40: 206c 6566 745f 6279 2c0a 2020 2020 2020   left_by,.      
-0002bf50: 2020 2272 6967 6874 5f62 7922 3a20 7269    "right_by": ri
-0002bf60: 6768 745f 6279 2c0a 2020 2020 2020 2020  ght_by,.        
-0002bf70: 2273 7566 6669 7865 7322 3a20 7375 6666  "suffixes": suff
-0002bf80: 6978 6573 2c0a 2020 2020 2020 2020 2274  ixes,.        "t
-0002bf90: 6f6c 6572 616e 6365 223a 2074 6f6c 6572  olerance": toler
-0002bfa0: 616e 6365 2c0a 2020 2020 2020 2020 2261  ance,.        "a
-0002bfb0: 6c6c 6f77 5f65 7861 6374 5f6d 6174 6368  llow_exact_match
-0002bfc0: 6573 223a 2061 6c6c 6f77 5f65 7861 6374  es": allow_exact
-0002bfd0: 5f6d 6174 6368 6573 2c0a 2020 2020 2020  _matches,.      
-0002bfe0: 2020 2264 6972 6563 7469 6f6e 223a 2064    "direction": d
-0002bff0: 6972 6563 7469 6f6e 2c0a 2020 2020 7d0a  irection,.    }.
-0002c000: 0a20 2020 2069 6620 6c65 6674 2069 7320  .    if left is 
-0002c010: 4e6f 6e65 206f 7220 7269 6768 7420 6973  None or right is
-0002c020: 204e 6f6e 653a 0a20 2020 2020 2020 2072   None:.        r
-0002c030: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-0002c040: 2243 616e 6e6f 7420 6d65 7267 655f 6173  "Cannot merge_as
-0002c050: 6f66 206f 6e20 4e6f 6e65 2229 0a0a 2020  of on None")..  
-0002c060: 2020 2320 6966 2069 735f 6461 7461 6672    # if is_datafr
-0002c070: 616d 655f 6c69 6b65 286c 6566 7429 2061  ame_like(left) a
-0002c080: 6e64 2069 735f 6461 7461 6672 616d 655f  nd is_dataframe_
-0002c090: 6c69 6b65 2872 6967 6874 293a 0a20 2020  like(right):.   
-0002c0a0: 2069 6620 6973 696e 7374 616e 6365 286c   if isinstance(l
-0002c0b0: 6566 742c 2070 642e 4461 7461 4672 616d  eft, pd.DataFram
-0002c0c0: 6529 2061 6e64 2069 7369 6e73 7461 6e63  e) and isinstanc
-0002c0d0: 6528 7269 6768 742c 2070 642e 4461 7461  e(right, pd.Data
-0002c0e0: 4672 616d 6529 3a0a 2020 2020 2020 2020  Frame):.        
-0002c0f0: 7265 7475 726e 2070 642e 6d65 7267 655f  return pd.merge_
-0002c100: 6173 6f66 286c 6566 742c 2072 6967 6874  asof(left, right
-0002c110: 2c20 2a2a 6b77 6172 6773 290a 0a20 2020  , **kwargs)..   
-0002c120: 2069 6620 6f6e 2069 7320 6e6f 7420 4e6f   if on is not No
-0002c130: 6e65 3a0a 2020 2020 2020 2020 6966 206c  ne:.        if l
-0002c140: 6566 745f 6f6e 2069 7320 6e6f 7420 4e6f  eft_on is not No
-0002c150: 6e65 206f 7220 7269 6768 745f 6f6e 2069  ne or right_on i
-0002c160: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-0002c170: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-0002c180: 6c75 6545 7272 6f72 280a 2020 2020 2020  lueError(.      
-0002c190: 2020 2020 2020 2020 2020 2243 616e 206f            "Can o
-0002c1a0: 6e6c 7920 7061 7373 2061 7267 756d 656e  nly pass argumen
-0002c1b0: 7420 276f 6e27 204f 5220 276c 6566 745f  t 'on' OR 'left_
-0002c1c0: 6f6e 2720 616e 6420 2772 6967 6874 5f6f  on' and 'right_o
-0002c1d0: 6e27 2c20 6e6f 7420 6120 220a 2020 2020  n', not a ".    
-0002c1e0: 2020 2020 2020 2020 2020 2020 2263 6f6d              "com
-0002c1f0: 6269 6e61 7469 6f6e 206f 6620 626f 7468  bination of both
-0002c200: 2e22 0a20 2020 2020 2020 2020 2020 2029  .".            )
-0002c210: 0a20 2020 2020 2020 206c 6566 745f 6f6e  .        left_on
-0002c220: 203d 2072 6967 6874 5f6f 6e20 3d20 6f6e   = right_on = on
-0002c230: 0a20 2020 2020 2020 206b 7761 7267 735b  .        kwargs[
-0002c240: 226c 6566 745f 6f6e 225d 203d 206c 6566  "left_on"] = lef
-0002c250: 745f 6f6e 0a20 2020 2020 2020 206b 7761  t_on.        kwa
-0002c260: 7267 735b 2272 6967 6874 5f6f 6e22 5d20  rgs["right_on"] 
-0002c270: 3d20 7269 6768 745f 6f6e 0a20 2020 2064  = right_on.    d
-0002c280: 656c 206b 7761 7267 735b 226f 6e22 5d0a  el kwargs["on"].
-0002c290: 0a20 2020 2066 6f72 206f 2069 6e20 5b6c  .    for o in [l
-0002c2a0: 6566 745f 6f6e 2c20 7269 6768 745f 6f6e  eft_on, right_on
-0002c2b0: 5d3a 0a20 2020 2020 2020 2069 6620 6973  ]:.        if is
-0002c2c0: 696e 7374 616e 6365 286f 2c20 5f46 7261  instance(o, _Fra
-0002c2d0: 6d65 293a 0a20 2020 2020 2020 2020 2020  me):.           
-0002c2e0: 2072 6169 7365 204e 6f74 496d 706c 656d   raise NotImplem
-0002c2f0: 656e 7465 6445 7272 6f72 280a 2020 2020  entedError(.    
-0002c300: 2020 2020 2020 2020 2020 2020 2244 6173              "Das
-0002c310: 6b20 636f 6c6c 6563 7469 6f6e 7320 6e6f  k collections no
-0002c320: 7420 6375 7272 656e 746c 7920 616c 6c6f  t currently allo
-0002c330: 7765 6420 696e 206d 6572 6765 2063 6f6c  wed in merge col
-0002c340: 756d 6e73 220a 2020 2020 2020 2020 2020  umns".          
-0002c350: 2020 290a 0a20 2020 2069 6620 6e6f 7420    )..    if not 
-0002c360: 6973 5f64 6173 6b5f 636f 6c6c 6563 7469  is_dask_collecti
-0002c370: 6f6e 286c 6566 7429 3a0a 2020 2020 2020  on(left):.      
-0002c380: 2020 6c65 6674 203d 2066 726f 6d5f 7061    left = from_pa
-0002c390: 6e64 6173 286c 6566 742c 206e 7061 7274  ndas(left, npart
-0002c3a0: 6974 696f 6e73 3d31 290a 0a20 2020 2069  itions=1)..    i
-0002c3b0: 6620 6e6f 7420 6973 5f64 6173 6b5f 636f  f not is_dask_co
-0002c3c0: 6c6c 6563 7469 6f6e 2872 6967 6874 293a  llection(right):
-0002c3d0: 0a20 2020 2020 2020 2072 6967 6874 203d  .        right =
-0002c3e0: 2066 726f 6d5f 7061 6e64 6173 2872 6967   from_pandas(rig
-0002c3f0: 6874 2c20 6e70 6172 7469 7469 6f6e 733d  ht, npartitions=
-0002c400: 3129 0a0a 2020 2020 6966 2062 7920 6973  1)..    if by is
-0002c410: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
-0002c420: 2020 2069 6620 6c65 6674 5f62 7920 6973     if left_by is
-0002c430: 206e 6f74 204e 6f6e 6520 6f72 2072 6967   not None or rig
-0002c440: 6874 5f62 7920 6973 206e 6f74 204e 6f6e  ht_by is not Non
-0002c450: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-0002c460: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-0002c470: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002c480: 2022 4361 6e20 6f6e 6c79 2070 6173 7320   "Can only pass 
-0002c490: 6172 6775 6d65 6e74 2027 6279 2720 4f52  argument 'by' OR
-0002c4a0: 2027 6c65 6674 5f62 7927 2061 6e64 2027   'left_by' and '
-0002c4b0: 7269 6768 745f 6279 272c 206e 6f74 2061  right_by', not a
-0002c4c0: 2063 6f6d 6269 6e61 7469 6f6e 206f 6620   combination of 
-0002c4d0: 626f 7468 2e22 0a20 2020 2020 2020 2020  both.".         
-0002c4e0: 2020 2029 0a20 2020 2020 2020 206b 7761     ).        kwa
-0002c4f0: 7267 735b 226c 6566 745f 6279 225d 203d  rgs["left_by"] =
-0002c500: 206b 7761 7267 735b 2272 6967 6874 5f62   kwargs["right_b
-0002c510: 7922 5d20 3d20 6279 0a20 2020 2064 656c  y"] = by.    del
-0002c520: 206b 7761 7267 735b 2262 7922 5d0a 0a20   kwargs["by"].. 
-0002c530: 2020 2069 6620 6c65 6674 5f62 7920 6973     if left_by is
-0002c540: 204e 6f6e 6520 616e 6420 7269 6768 745f   None and right_
-0002c550: 6279 2069 7320 6e6f 7420 4e6f 6e65 3a0a  by is not None:.
-0002c560: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-0002c570: 6c75 6545 7272 6f72 2822 4d75 7374 2073  lueError("Must s
-0002c580: 7065 6369 6679 2062 6f74 6820 6c65 6674  pecify both left
-0002c590: 5f6f 6e20 616e 6420 7269 6768 745f 6f6e  _on and right_on
-0002c5a0: 2069 6620 6f6e 6520 6973 2073 7065 6369   if one is speci
-0002c5b0: 6669 6564 2e22 290a 2020 2020 6966 206c  fied.").    if l
-0002c5c0: 6566 745f 6279 2069 7320 6e6f 7420 4e6f  eft_by is not No
-0002c5d0: 6e65 2061 6e64 2072 6967 6874 5f62 7920  ne and right_by 
-0002c5e0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-0002c5f0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-0002c600: 7228 224d 7573 7420 7370 6563 6966 7920  r("Must specify 
-0002c610: 626f 7468 206c 6566 745f 6f6e 2061 6e64  both left_on and
-0002c620: 2072 6967 6874 5f6f 6e20 6966 206f 6e65   right_on if one
-0002c630: 2069 7320 7370 6563 6966 6965 642e 2229   is specified.")
-0002c640: 0a0a 2020 2020 6672 6f6d 2064 6173 6b5f  ..    from dask_
-0002c650: 6578 7072 2e5f 6d65 7267 655f 6173 6f66  expr._merge_asof
-0002c660: 2069 6d70 6f72 7420 4d65 7267 6541 736f   import MergeAso
-0002c670: 660a 0a20 2020 2072 6574 7572 6e20 6e65  f..    return ne
-0002c680: 775f 636f 6c6c 6563 7469 6f6e 284d 6572  w_collection(Mer
-0002c690: 6765 4173 6f66 286c 6566 742c 2072 6967  geAsof(left, rig
-0002c6a0: 6874 2c20 2a2a 6b77 6172 6773 2929 0a0a  ht, **kwargs))..
-0002c6b0: 0a64 6566 2066 726f 6d5f 6d61 7028 0a20  .def from_map(. 
-0002c6c0: 2020 2066 756e 632c 0a20 2020 202a 6974     func,.    *it
-0002c6d0: 6572 6162 6c65 732c 0a20 2020 2061 7267  erables,.    arg
-0002c6e0: 733d 4e6f 6e65 2c0a 2020 2020 6d65 7461  s=None,.    meta
-0002c6f0: 3d6e 6f5f 6465 6661 756c 742c 0a20 2020  =no_default,.   
-0002c700: 2064 6976 6973 696f 6e73 3d4e 6f6e 652c   divisions=None,
-0002c710: 0a20 2020 206c 6162 656c 3d4e 6f6e 652c  .    label=None,
-0002c720: 0a20 2020 2065 6e66 6f72 6365 5f6d 6574  .    enforce_met
-0002c730: 6164 6174 613d 4661 6c73 652c 0a20 2020  adata=False,.   
-0002c740: 202a 2a6b 7761 7267 732c 0a29 3a0a 2020   **kwargs,.):.  
-0002c750: 2020 2222 2243 7265 6174 6520 6120 6461    """Create a da
-0002c760: 736b 2d65 7870 7220 636f 6c6c 6563 7469  sk-expr collecti
-0002c770: 6f6e 2066 726f 6d20 6120 6375 7374 6f6d  on from a custom
-0002c780: 2066 756e 6374 696f 6e20 6d61 700a 0a20   function map.. 
-0002c790: 2020 204e 4f54 453a 2054 6865 2075 6e64     NOTE: The und
-0002c7a0: 6572 6c79 696e 6720 6060 4578 7072 6060  erlying ``Expr``
-0002c7b0: 206f 626a 6563 7420 7072 6f64 7563 6564   object produced
-0002c7c0: 2062 7920 7468 6973 2041 5049 0a20 2020   by this API.   
-0002c7d0: 2077 696c 6c20 7375 7070 6f72 7420 636f   will support co
-0002c7e0: 6c75 6d6e 2070 726f 6a65 6374 696f 6e20  lumn projection 
-0002c7f0: 2876 6961 2060 6073 696d 706c 6966 7960  (via ``simplify`
-0002c800: 6029 2069 660a 2020 2020 7468 6520 6060  `) if.    the ``
-0002c810: 6675 6e63 6060 2061 7267 756d 656e 7420  func`` argument 
-0002c820: 6861 7320 2263 6f6c 756d 6e73 2220 696e  has "columns" in
-0002c830: 2069 7473 2073 6967 6e61 7475 7265 2e0a   its signature..
-0002c840: 0a20 2020 2022 2222 0a20 2020 2066 726f  .    """.    fro
-0002c850: 6d20 6461 736b 2e64 6174 6166 7261 6d65  m dask.dataframe
-0002c860: 2e69 6f2e 7574 696c 7320 696d 706f 7274  .io.utils import
-0002c870: 2044 6174 6146 7261 6d65 494f 4675 6e63   DataFrameIOFunc
-0002c880: 7469 6f6e 0a0a 2020 2020 6672 6f6d 2064  tion..    from d
-0002c890: 6173 6b5f 6578 7072 2e69 6f20 696d 706f  ask_expr.io impo
-0002c8a0: 7274 2046 726f 6d4d 6170 2c20 4672 6f6d  rt FromMap, From
-0002c8b0: 4d61 7050 726f 6a65 6374 6162 6c65 0a0a  MapProjectable..
-0002c8c0: 2020 2020 6966 2022 746f 6b65 6e22 2069      if "token" i
-0002c8d0: 6e20 6b77 6172 6773 3a0a 2020 2020 2020  n kwargs:.      
-0002c8e0: 2020 2320 5468 6973 206f 7074 696f 6e20    # This option 
-0002c8f0: 646f 6573 6e27 7420 7265 616c 6c79 206d  doesn't really m
-0002c900: 616b 6520 7365 6e73 6520 696e 2064 6173  ake sense in das
-0002c910: 6b2d 6578 7072 0a20 2020 2020 2020 2072  k-expr.        r
-0002c920: 6169 7365 204e 6f74 496d 706c 656d 656e  aise NotImplemen
-0002c930: 7465 6445 7272 6f72 2822 6461 736b 5f65  tedError("dask_e
-0002c940: 7870 7220 646f 6573 206e 6f74 2073 7570  xpr does not sup
-0002c950: 706f 7274 2061 2074 6f6b 656e 2061 7267  port a token arg
-0002c960: 756d 656e 742e 2229 0a0a 2020 2020 6c65  ument.")..    le
-0002c970: 6e67 7468 7320 3d20 7365 7428 290a 2020  ngths = set().  
-0002c980: 2020 6974 6572 6162 6c65 7320 3d20 6c69    iterables = li
-0002c990: 7374 2869 7465 7261 626c 6573 290a 2020  st(iterables).  
-0002c9a0: 2020 666f 7220 692c 2069 7465 7261 626c    for i, iterabl
-0002c9b0: 6520 696e 2065 6e75 6d65 7261 7465 2869  e in enumerate(i
-0002c9c0: 7465 7261 626c 6573 293a 0a20 2020 2020  terables):.     
-0002c9d0: 2020 2069 6620 6e6f 7420 6973 696e 7374     if not isinst
-0002c9e0: 616e 6365 2869 7465 7261 626c 652c 2049  ance(iterable, I
-0002c9f0: 7465 7261 626c 6529 3a0a 2020 2020 2020  terable):.      
-0002ca00: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-0002ca10: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
-0002ca20: 2020 2020 2020 2020 6622 416c 6c20 656c          f"All el
-0002ca30: 656d 656e 7473 206f 6620 6069 7465 7261  ements of `itera
-0002ca40: 626c 6573 6020 6d75 7374 2062 6520 4974  bles` must be It
-0002ca50: 6572 6162 6c65 2c20 676f 7420 7b74 7970  erable, got {typ
-0002ca60: 6528 6974 6572 6162 6c65 297d 220a 2020  e(iterable)}".  
-0002ca70: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0002ca80: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
-0002ca90: 2020 2020 206c 656e 6774 6873 2e61 6464       lengths.add
-0002caa0: 286c 656e 2869 7465 7261 626c 6529 290a  (len(iterable)).
-0002cab0: 2020 2020 2020 2020 6578 6365 7074 2028          except (
-0002cac0: 4174 7472 6962 7574 6545 7272 6f72 2c20  AttributeError, 
-0002cad0: 5479 7065 4572 726f 7229 3a0a 2020 2020  TypeError):.    
-0002cae0: 2020 2020 2020 2020 6974 6572 6162 6c65          iterable
-0002caf0: 735b 695d 203d 206c 6973 7428 6974 6572  s[i] = list(iter
-0002cb00: 6162 6c65 290a 2020 2020 2020 2020 2020  able).          
-0002cb10: 2020 6c65 6e67 7468 732e 6164 6428 6c65    lengths.add(le
-0002cb20: 6e28 6974 6572 6162 6c65 735b 695d 2929  n(iterables[i]))
-0002cb30: 0a20 2020 2069 6620 6c65 6e28 6c65 6e67  .    if len(leng
-0002cb40: 7468 7329 203d 3d20 303a 0a20 2020 2020  ths) == 0:.     
-0002cb50: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-0002cb60: 726f 7228 2260 6672 6f6d 5f6d 6170 6020  ror("`from_map` 
-0002cb70: 7265 7175 6972 6573 2061 7420 6c65 6173  requires at leas
-0002cb80: 7420 6f6e 6520 4974 6572 6162 6c65 2069  t one Iterable i
-0002cb90: 6e70 7574 2229 0a20 2020 2065 6c69 6620  nput").    elif 
-0002cba0: 6c65 6e28 6c65 6e67 7468 7329 203e 2031  len(lengths) > 1
-0002cbb0: 3a0a 2020 2020 2020 2020 7261 6973 6520  :.        raise 
-0002cbc0: 5661 6c75 6545 7272 6f72 2822 416c 6c20  ValueError("All 
-0002cbd0: 6069 7465 7261 626c 6573 6020 6d75 7374  `iterables` must
-0002cbe0: 2068 6176 6520 7468 6520 7361 6d65 206c   have the same l
-0002cbf0: 656e 6774 6822 290a 2020 2020 6966 206c  ength").    if l
-0002cc00: 656e 6774 6873 203d 3d20 7b30 7d3a 0a20  engths == {0}:. 
-0002cc10: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-0002cc20: 7565 4572 726f 7228 2241 6c6c 2060 6974  ueError("All `it
-0002cc30: 6572 6162 6c65 7360 206d 7573 7420 6861  erables` must ha
-0002cc40: 7665 2061 206e 6f6e 2d7a 6572 6f20 6c65  ve a non-zero le
-0002cc50: 6e67 7468 2229 0a0a 2020 2020 2320 4368  ngth")..    # Ch
-0002cc60: 6563 6b20 6966 2060 6675 6e63 6020 7375  eck if `func` su
-0002cc70: 7070 6f72 7473 2063 6f6c 756d 6e20 7072  pports column pr
-0002cc80: 6f6a 6563 7469 6f6e 0a20 2020 2061 6c6c  ojection.    all
-0002cc90: 6f77 5f70 726f 6a65 6374 696f 6e20 3d20  ow_projection = 
-0002cca0: 4661 6c73 650a 2020 2020 636f 6c75 6d6e  False.    column
-0002ccb0: 735f 6172 675f 7265 7175 6972 6564 203d  s_arg_required =
-0002ccc0: 2046 616c 7365 0a20 2020 2069 6620 7061   False.    if pa
-0002ccd0: 7261 6d20 3a3d 2069 6e73 7065 6374 2e73  ram := inspect.s
-0002cce0: 6967 6e61 7475 7265 2866 756e 6329 2e70  ignature(func).p
-0002ccf0: 6172 616d 6574 6572 732e 6765 7428 2263  arameters.get("c
-0002cd00: 6f6c 756d 6e73 222c 204e 6f6e 6529 3a0a  olumns", None):.
-0002cd10: 2020 2020 2020 2020 616c 6c6f 775f 7072          allow_pr
-0002cd20: 6f6a 6563 7469 6f6e 203d 2054 7275 650a  ojection = True.
-0002cd30: 2020 2020 2020 2020 636f 6c75 6d6e 735f          columns_
-0002cd40: 6172 675f 7265 7175 6972 6564 203d 2070  arg_required = p
-0002cd50: 6172 616d 2e64 6566 6175 6c74 2069 7320  aram.default is 
-0002cd60: 7061 7261 6d2e 656d 7074 790a 2020 2020  param.empty.    
-0002cd70: 2020 2020 6966 206d 6574 6120 6973 206e      if meta is n
-0002cd80: 6f5f 6465 6661 756c 7420 616e 6420 636f  o_default and co
-0002cd90: 6c75 6d6e 735f 6172 675f 7265 7175 6972  lumns_arg_requir
-0002cda0: 6564 3a0a 2020 2020 2020 2020 2020 2020  ed:.            
-0002cdb0: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
-0002cdc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002cdd0: 2022 4172 6775 6d65 6e74 2060 6675 6e63   "Argument `func
-0002cde0: 6020 6f66 2060 6672 6f6d 5f6d 6170 6020  ` of `from_map` 
-0002cdf0: 6861 7320 6120 7265 7175 6972 6564 2060  has a required `
-0002ce00: 636f 6c75 6d6e 7360 2022 0a20 2020 2020  columns` ".     
-0002ce10: 2020 2020 2020 2020 2020 2022 2070 6172             " par
-0002ce20: 616d 6574 6572 2061 6e64 206e 6f74 2060  ameter and not `
-0002ce30: 6d65 7461 6020 7072 6f76 6964 6564 2e22  meta` provided."
-0002ce40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002ce50: 2022 4569 7468 6572 2070 726f 7669 6465   "Either provide
-0002ce60: 2060 6d65 7461 6020 796f 7572 7365 6c66   `meta` yourself
-0002ce70: 206f 7220 6d61 6b65 2060 636f 6c75 6d6e   or make `column
-0002ce80: 7360 2061 6e20 6f70 7469 6f6e 616c 2061  s` an optional a
-0002ce90: 7267 756d 656e 742e 220a 2020 2020 2020  rgument.".      
-0002cea0: 2020 2020 2020 290a 2020 2020 656c 6966        ).    elif
-0002ceb0: 2069 7369 6e73 7461 6e63 6528 6675 6e63   isinstance(func
-0002cec0: 2c20 4461 7461 4672 616d 6549 4f46 756e  , DataFrameIOFun
-0002ced0: 6374 696f 6e29 3a0a 2020 2020 2020 2020  ction):.        
-0002cee0: 7761 726e 696e 6773 2e77 6172 6e28 0a20  warnings.warn(. 
-0002cef0: 2020 2020 2020 2020 2020 2022 6461 736b             "dask
-0002cf00: 5f65 7870 7220 646f 6573 206e 6f74 2073  _expr does not s
-0002cf10: 7570 706f 7274 2074 6865 2044 6174 6146  upport the DataF
-0002cf20: 7261 6d65 494f 4675 6e63 7469 6f6e 2022  rameIOFunction "
-0002cf30: 0a20 2020 2020 2020 2020 2020 2022 7072  .            "pr
-0002cf40: 6f74 6f63 6f6c 2066 6f72 2063 6f6c 756d  otocol for colum
-0002cf50: 6e20 7072 6f6a 6563 7469 6f6e 2e20 546f  n projection. To
-0002cf60: 2065 6e61 626c 6520 636f 6c75 6d6e 2022   enable column "
-0002cf70: 0a20 2020 2020 2020 2020 2020 2022 7072  .            "pr
-0002cf80: 6f6a 6563 7469 6f6e 2c20 706c 6561 7365  ojection, please
-0002cf90: 2065 6e73 7572 6520 7468 6174 2074 6865   ensure that the
-0002cfa0: 2073 6967 6e61 7475 7265 206f 6620 6066   signature of `f
-0002cfb0: 756e 6360 2022 0a20 2020 2020 2020 2020  unc` ".         
-0002cfc0: 2020 2022 696e 636c 7564 6573 2061 2060     "includes a `
-0002cfd0: 636f 6c75 6d6e 733d 6020 6b65 7977 6f72  columns=` keywor
-0002cfe0: 6420 6172 6775 6d65 6e74 2069 6e73 7465  d argument inste
-0002cff0: 6164 2e22 0a20 2020 2020 2020 2029 0a20  ad.".        ). 
-0002d000: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0002d010: 2061 6c6c 6f77 5f70 726f 6a65 6374 696f   allow_projectio
-0002d020: 6e20 3d20 4661 6c73 650a 0a20 2020 2061  n = False..    a
-0002d030: 7267 7320 3d20 5b5d 2069 6620 6172 6773  rgs = [] if args
-0002d040: 2069 7320 4e6f 6e65 2065 6c73 6520 6172   is None else ar
-0002d050: 6773 0a20 2020 206b 7761 7267 7320 3d20  gs.    kwargs = 
-0002d060: 7b7d 2069 6620 6b77 6172 6773 2069 7320  {} if kwargs is 
-0002d070: 4e6f 6e65 2065 6c73 6520 6b77 6172 6773  None else kwargs
-0002d080: 0a20 2020 2069 6620 616c 6c6f 775f 7072  .    if allow_pr
-0002d090: 6f6a 6563 7469 6f6e 3a0a 2020 2020 2020  ojection:.      
-0002d0a0: 2020 636f 6c75 6d6e 7320 3d20 6b77 6172    columns = kwar
-0002d0b0: 6773 2e70 6f70 2822 636f 6c75 6d6e 7322  gs.pop("columns"
-0002d0c0: 2c20 4e6f 6e65 290a 2020 2020 2020 2020  , None).        
-0002d0d0: 7265 7375 6c74 203d 206e 6577 5f63 6f6c  result = new_col
-0002d0e0: 6c65 6374 696f 6e28 0a20 2020 2020 2020  lection(.       
-0002d0f0: 2020 2020 2046 726f 6d4d 6170 5072 6f6a       FromMapProj
-0002d100: 6563 7461 626c 6528 0a20 2020 2020 2020  ectable(.       
-0002d110: 2020 2020 2020 2020 2066 756e 632c 0a20           func,. 
-0002d120: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0002d130: 7465 7261 626c 6573 2c0a 2020 2020 2020  terables,.      
-0002d140: 2020 2020 2020 2020 2020 636f 6c75 6d6e            column
-0002d150: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
-0002d160: 2020 2061 7267 732c 0a20 2020 2020 2020     args,.       
-0002d170: 2020 2020 2020 2020 206b 7761 7267 732c           kwargs,
-0002d180: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002d190: 2063 6f6c 756d 6e73 5f61 7267 5f72 6571   columns_arg_req
-0002d1a0: 7569 7265 642c 0a20 2020 2020 2020 2020  uired,.         
-0002d1b0: 2020 2020 2020 206d 6574 612c 0a20 2020         meta,.   
-0002d1c0: 2020 2020 2020 2020 2020 2020 2065 6e66               enf
-0002d1d0: 6f72 6365 5f6d 6574 6164 6174 612c 0a20  orce_metadata,. 
-0002d1e0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-0002d1f0: 6976 6973 696f 6e73 2c0a 2020 2020 2020  ivisions,.      
-0002d200: 2020 2020 2020 2020 2020 6c61 6265 6c2c            label,
-0002d210: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-0002d220: 2020 2020 2020 2029 0a20 2020 2065 6c73         ).    els
-0002d230: 653a 0a20 2020 2020 2020 2072 6573 756c  e:.        resul
-0002d240: 7420 3d20 6e65 775f 636f 6c6c 6563 7469  t = new_collecti
-0002d250: 6f6e 280a 2020 2020 2020 2020 2020 2020  on(.            
-0002d260: 4672 6f6d 4d61 7028 0a20 2020 2020 2020  FromMap(.       
-0002d270: 2020 2020 2020 2020 2066 756e 632c 0a20           func,. 
-0002d280: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0002d290: 7465 7261 626c 6573 2c0a 2020 2020 2020  terables,.      
-0002d2a0: 2020 2020 2020 2020 2020 6172 6773 2c0a            args,.
-0002d2b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d2c0: 6b77 6172 6773 2c0a 2020 2020 2020 2020  kwargs,.        
-0002d2d0: 2020 2020 2020 2020 6d65 7461 2c0a 2020          meta,.  
-0002d2e0: 2020 2020 2020 2020 2020 2020 2020 656e                en
-0002d2f0: 666f 7263 655f 6d65 7461 6461 7461 2c0a  force_metadata,.
-0002d300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d310: 6469 7669 7369 6f6e 732c 0a20 2020 2020  divisions,.     
-0002d320: 2020 2020 2020 2020 2020 206c 6162 656c             label
-0002d330: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
-0002d340: 2020 2020 2020 2020 290a 2020 2020 6966          ).    if
-0002d350: 2070 7961 7272 6f77 5f73 7472 696e 6773   pyarrow_strings
-0002d360: 5f65 6e61 626c 6564 2829 3a0a 2020 2020  _enabled():.    
-0002d370: 2020 2020 7265 7475 726e 206e 6577 5f63      return new_c
-0002d380: 6f6c 6c65 6374 696f 6e28 6578 7072 2e41  ollection(expr.A
-0002d390: 7272 6f77 5374 7269 6e67 436f 6e76 6572  rrowStringConver
-0002d3a0: 7369 6f6e 2872 6573 756c 7429 290a 2020  sion(result)).  
-0002d3b0: 2020 7265 7475 726e 2072 6573 756c 740a    return result.
-0002d3c0: 0a0a 6465 6620 7265 7061 7274 6974 696f  ..def repartitio
-0002d3d0: 6e28 6466 2c20 6469 7669 7369 6f6e 732c  n(df, divisions,
-0002d3e0: 2066 6f72 6365 3d46 616c 7365 293a 0a20   force=False):. 
-0002d3f0: 2020 2022 2222 5265 7061 7274 6974 696f     """Repartitio
-0002d400: 6e20 6461 7461 6672 616d 6520 616c 6f6e  n dataframe alon
-0002d410: 6720 6e65 7720 6469 7669 7369 6f6e 730a  g new divisions.
-0002d420: 0a20 2020 2044 6173 6b2e 4461 7461 4672  .    Dask.DataFr
-0002d430: 616d 6520 6f62 6a65 6374 7320 6172 6520  ame objects are 
-0002d440: 7061 7274 6974 696f 6e65 6420 616c 6f6e  partitioned alon
-0002d450: 6720 7468 6569 7220 696e 6465 782e 2020  g their index.  
-0002d460: 4f66 7465 6e20 7768 656e 0a20 2020 206d  Often when.    m
-0002d470: 756c 7469 706c 6520 6461 7461 6672 616d  ultiple datafram
-0002d480: 6573 2069 6e74 6572 6163 7420 7765 206e  es interact we n
-0002d490: 6565 6420 746f 2061 6c69 676e 2074 6865  eed to align the
-0002d4a0: 7365 2070 6172 7469 7469 6f6e 696e 6773  se partitionings
-0002d4b0: 2e20 2054 6865 0a20 2020 2060 6072 6570  .  The.    ``rep
-0002d4c0: 6172 7469 7469 6f6e 6060 2066 756e 6374  artition`` funct
-0002d4d0: 696f 6e20 636f 6e73 7472 7563 7473 2061  ion constructs a
-0002d4e0: 206e 6577 2044 6174 6146 7261 6d65 206f   new DataFrame o
-0002d4f0: 626a 6563 7420 686f 6c64 696e 6720 7468  bject holding th
-0002d500: 6520 7361 6d65 0a20 2020 2064 6174 6120  e same.    data 
-0002d510: 6275 7420 7061 7274 6974 696f 6e65 6420  but partitioned 
-0002d520: 6f6e 2064 6966 6665 7265 6e74 2076 616c  on different val
-0002d530: 7565 732e 2020 4974 2064 6f65 7320 7468  ues.  It does th
-0002d540: 6973 2062 7920 7065 7266 6f72 6d69 6e67  is by performing
-0002d550: 2061 0a20 2020 2073 6571 7565 6e63 6520   a.    sequence 
-0002d560: 6f66 2060 606c 6f63 6060 2061 6e64 2060  of ``loc`` and `
-0002d570: 6063 6f6e 6361 7460 6020 6361 6c6c 7320  `concat`` calls 
-0002d580: 746f 2073 706c 6974 2061 6e64 206d 6572  to split and mer
-0002d590: 6765 2074 6865 2070 7265 7669 6f75 730a  ge the previous.
-0002d5a0: 2020 2020 6765 6e65 7261 7469 6f6e 206f      generation o
-0002d5b0: 6620 7061 7274 6974 696f 6e73 2e0a 0a20  f partitions... 
-0002d5c0: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
-0002d5d0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a0a 2020    ----------..  
-0002d5e0: 2020 6469 7669 7369 6f6e 7320 3a20 6c69    divisions : li
-0002d5f0: 7374 0a20 2020 2020 2020 204c 6973 7420  st.        List 
-0002d600: 6f66 2070 6172 7469 7469 6f6e 7320 746f  of partitions to
-0002d610: 2062 6520 7573 6564 0a20 2020 2066 6f72   be used.    for
-0002d620: 6365 203a 2062 6f6f 6c2c 2064 6566 6175  ce : bool, defau
-0002d630: 6c74 2046 616c 7365 0a20 2020 2020 2020  lt False.       
-0002d640: 2041 6c6c 6f77 7320 7468 6520 6578 7061   Allows the expa
-0002d650: 6e73 696f 6e20 6f66 2074 6865 2065 7869  nsion of the exi
-0002d660: 7374 696e 6720 6469 7669 7369 6f6e 732e  sting divisions.
-0002d670: 0a20 2020 2020 2020 2049 6620 4661 6c73  .        If Fals
-0002d680: 6520 7468 656e 2074 6865 206e 6577 2064  e then the new d
-0002d690: 6976 6973 696f 6e73 206c 6f77 6572 2061  ivisions lower a
-0002d6a0: 6e64 2075 7070 6572 2062 6f75 6e64 7320  nd upper bounds 
-0002d6b0: 6d75 7374 2062 650a 2020 2020 2020 2020  must be.        
-0002d6c0: 7468 6520 7361 6d65 2061 7320 7468 6520  the same as the 
-0002d6d0: 6f6c 6420 6469 7669 7369 6f6e 732e 0a0a  old divisions...
-0002d6e0: 2020 2020 4578 616d 706c 6573 0a20 2020      Examples.   
-0002d6f0: 202d 2d2d 2d2d 2d2d 2d0a 0a20 2020 203e   --------..    >
-0002d700: 3e3e 2064 6620 3d20 6466 2e72 6570 6172  >> df = df.repar
-0002d710: 7469 7469 6f6e 285b 302c 2035 2c20 3130  tition([0, 5, 10
-0002d720: 2c20 3230 5d29 2020 2320 646f 6374 6573  , 20])  # doctes
-0002d730: 743a 202b 534b 4950 0a0a 2020 2020 416c  t: +SKIP..    Al
-0002d740: 736f 2077 6f72 6b73 206f 6e20 5061 6e64  so works on Pand
-0002d750: 6173 206f 626a 6563 7473 0a0a 2020 2020  as objects..    
-0002d760: 3e3e 3e20 6464 6620 3d20 6464 2e72 6570  >>> ddf = dd.rep
-0002d770: 6172 7469 7469 6f6e 2864 662c 205b 302c  artition(df, [0,
-0002d780: 2035 2c20 3130 2c20 3230 5d29 2020 2320   5, 10, 20])  # 
-0002d790: 646f 6374 6573 743a 202b 534b 4950 0a20  doctest: +SKIP. 
-0002d7a0: 2020 2022 2222 0a20 2020 2069 6620 6973     """.    if is
-0002d7b0: 696e 7374 616e 6365 2864 662c 2046 7261  instance(df, Fra
-0002d7c0: 6d65 4261 7365 293a 0a20 2020 2020 2020  meBase):.       
-0002d7d0: 2072 6574 7572 6e20 6466 2e72 6570 6172   return df.repar
-0002d7e0: 7469 7469 6f6e 2864 6976 6973 696f 6e73  tition(divisions
-0002d7f0: 3d64 6976 6973 696f 6e73 2c20 666f 7263  =divisions, forc
-0002d800: 653d 666f 7263 6529 0a20 2020 2065 6c69  e=force).    eli
-0002d810: 6620 6973 5f64 6174 6166 7261 6d65 5f6c  f is_dataframe_l
-0002d820: 696b 6528 6466 2920 6f72 2069 735f 7365  ike(df) or is_se
-0002d830: 7269 6573 5f6c 696b 6528 6466 293a 0a20  ries_like(df):. 
-0002d840: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
-0002d850: 775f 636f 6c6c 6563 7469 6f6e 280a 2020  w_collection(.  
-0002d860: 2020 2020 2020 2020 2020 4672 6f6d 5061            FromPa
-0002d870: 6e64 6173 4469 7669 7369 6f6e 7328 0a20  ndasDivisions(. 
-0002d880: 2020 2020 2020 2020 2020 2020 2020 205f                 _
-0002d890: 4261 636b 656e 6444 6174 6128 6466 292c  BackendData(df),
-0002d8a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002d8b0: 2064 6976 6973 696f 6e73 3d64 6976 6973   divisions=divis
-0002d8c0: 696f 6e73 2c0a 2020 2020 2020 2020 2020  ions,.          
-0002d8d0: 2020 2020 2020 7079 6172 726f 775f 7374        pyarrow_st
-0002d8e0: 7269 6e67 735f 656e 6162 6c65 643d 7079  rings_enabled=py
-0002d8f0: 6172 726f 775f 7374 7269 6e67 735f 656e  arrow_strings_en
-0002d900: 6162 6c65 6428 292c 0a20 2020 2020 2020  abled(),.       
-0002d910: 2020 2020 2029 0a20 2020 2020 2020 2029       ).        )
-0002d920: 0a20 2020 2065 6c73 653a 0a20 2020 2020  .    else:.     
-0002d930: 2020 2072 6169 7365 204e 6f74 496d 706c     raise NotImpl
-0002d940: 656d 656e 7465 6445 7272 6f72 2866 2272  ementedError(f"r
-0002d950: 6570 6172 7469 7469 6f6e 2069 7320 6e6f  epartition is no
-0002d960: 7420 696d 706c 656d 656e 7465 6420 666f  t implemented fo
-0002d970: 7220 7b74 7970 6528 6466 297d 2e22 290a  r {type(df)}.").
-0002d980: 0a0a 6465 6620 7069 766f 745f 7461 626c  ..def pivot_tabl
-0002d990: 6528 6466 2c20 696e 6465 782c 2063 6f6c  e(df, index, col
-0002d9a0: 756d 6e73 2c20 7661 6c75 6573 2c20 6167  umns, values, ag
-0002d9b0: 6766 756e 633d 226d 6561 6e22 293a 0a20  gfunc="mean"):. 
-0002d9c0: 2020 2069 6620 6e6f 7420 6973 5f73 6361     if not is_sca
-0002d9d0: 6c61 7228 696e 6465 7829 206f 7220 696e  lar(index) or in
-0002d9e0: 6465 7820 6e6f 7420 696e 2064 662e 5f6d  dex not in df._m
-0002d9f0: 6574 612e 636f 6c75 6d6e 733a 0a20 2020  eta.columns:.   
-0002da00: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-0002da10: 4572 726f 7228 2227 696e 6465 7827 206d  Error("'index' m
-0002da20: 7573 7420 6265 2074 6865 206e 616d 6520  ust be the name 
-0002da30: 6f66 2061 6e20 6578 6973 7469 6e67 2063  of an existing c
-0002da40: 6f6c 756d 6e22 290a 2020 2020 6966 206e  olumn").    if n
-0002da50: 6f74 2069 735f 7363 616c 6172 2863 6f6c  ot is_scalar(col
-0002da60: 756d 6e73 2920 6f72 2063 6f6c 756d 6e73  umns) or columns
-0002da70: 206e 6f74 2069 6e20 6466 2e5f 6d65 7461   not in df._meta
-0002da80: 2e63 6f6c 756d 6e73 3a0a 2020 2020 2020  .columns:.      
-0002da90: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-0002daa0: 6f72 2822 2763 6f6c 756d 6e73 2720 6d75  or("'columns' mu
-0002dab0: 7374 2062 6520 7468 6520 6e61 6d65 206f  st be the name o
-0002dac0: 6620 616e 2065 7869 7374 696e 6720 636f  f an existing co
-0002dad0: 6c75 6d6e 2229 0a20 2020 2069 6620 6e6f  lumn").    if no
-0002dae0: 7420 6d65 7468 6f64 732e 6973 5f63 6174  t methods.is_cat
-0002daf0: 6567 6f72 6963 616c 5f64 7479 7065 2864  egorical_dtype(d
-0002db00: 662e 5f6d 6574 615b 636f 6c75 6d6e 735d  f._meta[columns]
-0002db10: 293a 0a20 2020 2020 2020 2072 6169 7365  ):.        raise
-0002db20: 2056 616c 7565 4572 726f 7228 2227 636f   ValueError("'co
-0002db30: 6c75 6d6e 7327 206d 7573 7420 6265 2063  lumns' must be c
-0002db40: 6174 6567 6f72 7920 6474 7970 6522 290a  ategory dtype").
-0002db50: 2020 2020 6966 206e 6f74 2068 6173 5f6b      if not has_k
-0002db60: 6e6f 776e 5f63 6174 6567 6f72 6965 7328  nown_categories(
-0002db70: 6466 2e5f 6d65 7461 5b63 6f6c 756d 6e73  df._meta[columns
-0002db80: 5d29 3a0a 2020 2020 2020 2020 7261 6973  ]):.        rais
-0002db90: 6520 5661 6c75 6545 7272 6f72 2822 2763  e ValueError("'c
-0002dba0: 6f6c 756d 6e73 2720 6d75 7374 2068 6176  olumns' must hav
-0002dbb0: 6520 6b6e 6f77 6e20 6361 7465 676f 7269  e known categori
-0002dbc0: 6573 2229 0a0a 2020 2020 6966 206e 6f74  es")..    if not
-0002dbd0: 2028 0a20 2020 2020 2020 2069 735f 7363   (.        is_sc
-0002dbe0: 616c 6172 2876 616c 7565 7329 0a20 2020  alar(values).   
-0002dbf0: 2020 2020 2061 6e64 2076 616c 7565 7320       and values 
-0002dc00: 696e 2064 662e 5f6d 6574 612e 636f 6c75  in df._meta.colu
-0002dc10: 6d6e 730a 2020 2020 2020 2020 6f72 206e  mns.        or n
-0002dc20: 6f74 2069 735f 7363 616c 6172 2876 616c  ot is_scalar(val
-0002dc30: 7565 7329 0a20 2020 2020 2020 2061 6e64  ues).        and
-0002dc40: 2061 6c6c 2869 735f 7363 616c 6172 2878   all(is_scalar(x
-0002dc50: 2920 616e 6420 7820 696e 2064 662e 5f6d  ) and x in df._m
-0002dc60: 6574 612e 636f 6c75 6d6e 7320 666f 7220  eta.columns for 
-0002dc70: 7820 696e 2076 616c 7565 7329 0a20 2020  x in values).   
-0002dc80: 2029 3a0a 2020 2020 2020 2020 7261 6973   ):.        rais
-0002dc90: 6520 5661 6c75 6545 7272 6f72 2822 2776  e ValueError("'v
-0002dca0: 616c 7565 7327 206d 7573 7420 7265 6665  alues' must refe
-0002dcb0: 7220 746f 2061 6e20 6578 6973 7469 6e67  r to an existing
-0002dcc0: 2063 6f6c 756d 6e20 6f72 2063 6f6c 756d   column or colum
-0002dcd0: 6e73 2229 0a0a 2020 2020 6176 6169 6c61  ns")..    availa
-0002dce0: 626c 655f 6167 6766 756e 6373 203d 205b  ble_aggfuncs = [
-0002dcf0: 226d 6561 6e22 2c20 2273 756d 222c 2022  "mean", "sum", "
-0002dd00: 636f 756e 7422 2c20 2266 6972 7374 222c  count", "first",
-0002dd10: 2022 6c61 7374 225d 0a0a 2020 2020 6966   "last"]..    if
-0002dd20: 206e 6f74 2069 735f 7363 616c 6172 2861   not is_scalar(a
-0002dd30: 6767 6675 6e63 2920 6f72 2061 6767 6675  ggfunc) or aggfu
-0002dd40: 6e63 206e 6f74 2069 6e20 6176 6169 6c61  nc not in availa
-0002dd50: 626c 655f 6167 6766 756e 6373 3a0a 2020  ble_aggfuncs:.  
-0002dd60: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-0002dd70: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
-0002dd80: 2020 2020 2261 6767 6675 6e63 206d 7573      "aggfunc mus
-0002dd90: 7420 6265 2065 6974 6865 7220 2220 2b20  t be either " + 
-0002dda0: 222c 2022 2e6a 6f69 6e28 6622 277b 787d  ", ".join(f"'{x}
-0002ddb0: 2722 2066 6f72 2078 2069 6e20 6176 6169  '" for x in avai
-0002ddc0: 6c61 626c 655f 6167 6766 756e 6373 290a  lable_aggfuncs).
-0002ddd0: 2020 2020 2020 2020 290a 0a20 2020 2072          )..    r
-0002dde0: 6574 7572 6e20 6e65 775f 636f 6c6c 6563  eturn new_collec
-0002ddf0: 7469 6f6e 280a 2020 2020 2020 2020 5069  tion(.        Pi
-0002de00: 766f 7454 6162 6c65 2864 662c 2069 6e64  votTable(df, ind
-0002de10: 6578 3d69 6e64 6578 2c20 636f 6c75 6d6e  ex=index, column
-0002de20: 733d 636f 6c75 6d6e 732c 2076 616c 7565  s=columns, value
-0002de30: 733d 7661 6c75 6573 2c20 6167 6766 756e  s=values, aggfun
-0002de40: 633d 6167 6766 756e 6329 0a20 2020 2029  c=aggfunc).    )
-0002de50: 0a0a 0a64 6566 2074 6f5f 6e75 6d65 7269  ...def to_numeri
-0002de60: 6328 6172 672c 2065 7272 6f72 733d 2272  c(arg, errors="r
-0002de70: 6169 7365 222c 2064 6f77 6e63 6173 743d  aise", downcast=
-0002de80: 4e6f 6e65 2c20 6d65 7461 3d4e 6f6e 6529  None, meta=None)
-0002de90: 3a0a 2020 2020 2222 220a 2020 2020 5265  :.    """.    Re
-0002dea0: 7475 726e 2074 7970 6520 6465 7065 6e64  turn type depend
-0002deb0: 7320 6f6e 2069 6e70 7574 2e20 4465 6c61  s on input. Dela
-0002dec0: 7965 6420 6966 2073 6361 6c61 722c 206f  yed if scalar, o
-0002ded0: 7468 6572 7769 7365 2073 616d 6520 6173  therwise same as
-0002dee0: 2069 6e70 7574 2e0a 2020 2020 466f 7220   input..    For 
-0002def0: 6572 726f 7273 2c20 6f6e 6c79 2022 7261  errors, only "ra
-0002df00: 6973 6522 2061 6e64 2022 636f 6572 6365  ise" and "coerce
-0002df10: 2220 6172 6520 616c 6c6f 7765 642e 0a20  " are allowed.. 
-0002df20: 2020 2022 2222 0a20 2020 2069 6620 6572     """.    if er
-0002df30: 726f 7273 206e 6f74 2069 6e20 2822 7261  rors not in ("ra
-0002df40: 6973 6522 2c20 2263 6f65 7263 6522 293a  ise", "coerce"):
-0002df50: 0a20 2020 2020 2020 2072 6169 7365 2056  .        raise V
-0002df60: 616c 7565 4572 726f 7228 2269 6e76 616c  alueError("inval
-0002df70: 6964 2065 7272 6f72 2076 616c 7565 2073  id error value s
-0002df80: 7065 6369 6669 6564 2229 0a0a 2020 2020  pecified")..    
-0002df90: 6966 2070 645f 6973 5f73 6361 6c61 7228  if pd_is_scalar(
-0002dfa0: 6172 6729 3a0a 2020 2020 2020 2020 6966  arg):.        if
-0002dfb0: 206d 6574 6120 6973 206e 6f74 204e 6f6e   meta is not Non
-0002dfc0: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-0002dfd0: 6169 7365 204b 6579 4572 726f 7228 2260  aise KeyError("`
-0002dfe0: 606d 6574 6160 6020 6973 206e 6f74 2061  `meta`` is not a
-0002dff0: 6c6c 6f77 6564 2077 6865 6e20 696e 7075  llowed when inpu
-0002e000: 7420 6973 2061 2073 6361 6c61 722e 2229  t is a scalar.")
-0002e010: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0002e020: 6465 6c61 7965 6428 7064 2e74 6f5f 6e75  delayed(pd.to_nu
-0002e030: 6d65 7269 632c 2070 7572 653d 5472 7565  meric, pure=True
-0002e040: 2928 6172 672c 2065 7272 6f72 733d 6572  )(arg, errors=er
-0002e050: 726f 7273 2c20 646f 776e 6361 7374 3d64  rors, downcast=d
-0002e060: 6f77 6e63 6173 7429 0a0a 2020 2020 6966  owncast)..    if
-0002e070: 2069 735f 6172 7261 796c 696b 6528 6172   is_arraylike(ar
-0002e080: 6729 3a0a 2020 2020 2020 2020 7265 7475  g):.        retu
-0002e090: 726e 206e 6577 5f63 6f6c 6c65 6374 696f  rn new_collectio
-0002e0a0: 6e28 0a20 2020 2020 2020 2020 2020 2054  n(.            T
-0002e0b0: 6f4e 756d 6572 6963 280a 2020 2020 2020  oNumeric(.      
-0002e0c0: 2020 2020 2020 2020 2020 6672 6f6d 5f61            from_a
-0002e0d0: 7272 6179 2861 7267 292e 6173 7479 7065  rray(arg).astype
-0002e0e0: 2861 7267 2e64 7479 7065 292c 2065 7272  (arg.dtype), err
-0002e0f0: 6f72 733d 6572 726f 7273 2c20 646f 776e  ors=errors, down
-0002e100: 6361 7374 3d64 6f77 6e63 6173 740a 2020  cast=downcast.  
-0002e110: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0002e120: 2020 2020 292e 746f 5f64 6173 6b5f 6172      ).to_dask_ar
-0002e130: 7261 7928 6d65 7461 3d6d 6574 6129 0a0a  ray(meta=meta)..
-0002e140: 2020 2020 6966 2069 735f 7365 7269 6573      if is_series
-0002e150: 5f6c 696b 6528 6172 6729 3a0a 2020 2020  _like(arg):.    
-0002e160: 2020 2020 7265 7475 726e 206e 6577 5f63      return new_c
-0002e170: 6f6c 6c65 6374 696f 6e28 0a20 2020 2020  ollection(.     
-0002e180: 2020 2020 2020 2054 6f4e 756d 6572 6963         ToNumeric
-0002e190: 2866 7261 6d65 3d61 7267 2c20 6572 726f  (frame=arg, erro
-0002e1a0: 7273 3d65 7272 6f72 732c 2064 6f77 6e63  rs=errors, downc
-0002e1b0: 6173 743d 646f 776e 6361 7374 2c20 6d65  ast=downcast, me
-0002e1c0: 7461 3d6d 6574 6129 0a20 2020 2020 2020  ta=meta).       
-0002e1d0: 2029 0a0a 2020 2020 7261 6973 6520 5479   )..    raise Ty
-0002e1e0: 7065 4572 726f 7228 0a20 2020 2020 2020  peError(.       
-0002e1f0: 2022 6172 6720 6d75 7374 2062 6520 6120   "arg must be a 
-0002e200: 6c69 7374 2c20 7475 706c 652c 2064 6173  list, tuple, das
-0002e210: 6b2e 6172 7261 792e 4172 7261 792c 206f  k.array.Array, o
-0002e220: 7220 6461 736b 2e64 6174 6166 7261 6d65  r dask.dataframe
-0002e230: 2e53 6572 6965 7322 0a20 2020 2029 0a0a  .Series".    )..
-0002e240: 0a64 6566 2074 6f5f 6461 7465 7469 6d65  .def to_datetime
-0002e250: 2861 7267 2c20 6d65 7461 3d4e 6f6e 652c  (arg, meta=None,
-0002e260: 202a 2a6b 7761 7267 7329 3a0a 2020 2020   **kwargs):.    
-0002e270: 747a 5f6b 7761 7267 203d 207b 2274 7a22  tz_kwarg = {"tz"
-0002e280: 3a20 2275 7463 227d 2069 6620 6b77 6172  : "utc"} if kwar
-0002e290: 6773 2e67 6574 2822 7574 6322 2920 656c  gs.get("utc") el
-0002e2a0: 7365 207b 7d0a 0a20 2020 2028 6172 672c  se {}..    (arg,
-0002e2b0: 2920 3d20 5f6d 6179 6265 5f66 726f 6d5f  ) = _maybe_from_
-0002e2c0: 7061 6e64 6173 285b 6172 675d 290a 0a20  pandas([arg]).. 
-0002e2d0: 2020 2069 6620 6d65 7461 2069 7320 4e6f     if meta is No
-0002e2e0: 6e65 3a0a 2020 2020 2020 2020 6966 2069  ne:.        if i
-0002e2f0: 7369 6e73 7461 6e63 6528 6172 672c 2049  sinstance(arg, I
-0002e300: 6e64 6578 293a 0a20 2020 2020 2020 2020  ndex):.         
-0002e310: 2020 206d 6574 6120 3d20 6765 745f 6d65     meta = get_me
-0002e320: 7461 5f6c 6962 7261 7279 2861 7267 292e  ta_library(arg).
-0002e330: 4461 7465 7469 6d65 496e 6465 7828 5b5d  DatetimeIndex([]
-0002e340: 2c20 2a2a 747a 5f6b 7761 7267 290a 2020  , **tz_kwarg).  
-0002e350: 2020 2020 2020 2020 2020 6d65 7461 2e6e            meta.n
-0002e360: 616d 6520 3d20 6172 672e 6e61 6d65 0a20  ame = arg.name. 
-0002e370: 2020 2020 2020 2065 6c69 6620 6e6f 7420         elif not 
-0002e380: 2869 735f 6461 7461 6672 616d 655f 6c69  (is_dataframe_li
-0002e390: 6b65 2861 7267 2920 6f72 2069 735f 7365  ke(arg) or is_se
-0002e3a0: 7269 6573 5f6c 696b 6528 6172 6729 293a  ries_like(arg)):
-0002e3b0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-0002e3c0: 7365 204e 6f74 496d 706c 656d 656e 7465  se NotImplemente
-0002e3d0: 6445 7272 6f72 280a 2020 2020 2020 2020  dError(.        
-0002e3e0: 2020 2020 2020 2020 2264 6173 6b2e 6461          "dask.da
-0002e3f0: 7461 6672 616d 652e 746f 5f64 6174 6574  taframe.to_datet
-0002e400: 696d 6520 646f 6573 206e 6f74 2073 7570  ime does not sup
-0002e410: 706f 7274 2022 0a20 2020 2020 2020 2020  port ".         
-0002e420: 2020 2020 2020 2022 6e6f 6e2d 696e 6465         "non-inde
-0002e430: 782d 6162 6c65 2061 7267 756d 656e 7473  x-able arguments
-0002e440: 2028 6c69 6b65 2073 6361 6c61 7273 2922   (like scalars)"
-0002e450: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-0002e460: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0002e470: 2020 2020 2020 2020 206d 6574 6120 3d20           meta = 
-0002e480: 6d65 7461 5f73 6572 6965 735f 636f 6e73  meta_series_cons
-0002e490: 7472 7563 746f 7228 6172 6729 285b 7064  tructor(arg)([pd
-0002e4a0: 2e54 696d 6573 7461 6d70 2822 3230 3030  .Timestamp("2000
-0002e4b0: 222c 202a 2a74 7a5f 6b77 6172 6729 5d29  ", **tz_kwarg)])
-0002e4c0: 0a20 2020 2020 2020 2020 2020 206d 6574  .            met
-0002e4d0: 612e 696e 6465 7820 3d20 6d65 7461 2e69  a.index = meta.i
-0002e4e0: 6e64 6578 2e61 7374 7970 6528 6172 672e  ndex.astype(arg.
-0002e4f0: 696e 6465 782e 6474 7970 6529 0a20 2020  index.dtype).   
-0002e500: 2020 2020 2020 2020 206d 6574 612e 696e           meta.in
-0002e510: 6465 782e 6e61 6d65 203d 2061 7267 2e69  dex.name = arg.i
-0002e520: 6e64 6578 2e6e 616d 650a 0a20 2020 206b  ndex.name..    k
-0002e530: 7761 7267 732e 706f 7028 2269 6e66 6572  wargs.pop("infer
-0002e540: 5f64 6174 6574 696d 655f 666f 726d 6174  _datetime_format
-0002e550: 222c 204e 6f6e 6529 0a0a 2020 2020 7265  ", None)..    re
-0002e560: 7475 726e 206e 6577 5f63 6f6c 6c65 6374  turn new_collect
-0002e570: 696f 6e28 546f 4461 7465 7469 6d65 2866  ion(ToDatetime(f
-0002e580: 7261 6d65 3d61 7267 2c20 6b77 6172 6773  rame=arg, kwargs
-0002e590: 3d6b 7761 7267 732c 206d 6574 613d 6d65  =kwargs, meta=me
-0002e5a0: 7461 2929 0a0a 0a64 6566 2074 6f5f 7469  ta))...def to_ti
-0002e5b0: 6d65 6465 6c74 6128 6172 672c 2075 6e69  medelta(arg, uni
-0002e5c0: 743d 4e6f 6e65 2c20 6572 726f 7273 3d22  t=None, errors="
-0002e5d0: 7261 6973 6522 293a 0a20 2020 2069 6620  raise"):.    if 
-0002e5e0: 6e6f 7420 6973 696e 7374 616e 6365 2861  not isinstance(a
-0002e5f0: 7267 2c20 5365 7269 6573 293a 0a20 2020  rg, Series):.   
-0002e600: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
-0002e610: 7272 6f72 2822 6172 6720 6d75 7374 2062  rror("arg must b
-0002e620: 6520 6120 5365 7269 6573 2229 0a20 2020  e a Series").   
-0002e630: 2072 6574 7572 6e20 6e65 775f 636f 6c6c   return new_coll
-0002e640: 6563 7469 6f6e 2854 6f54 696d 6564 656c  ection(ToTimedel
-0002e650: 7461 2866 7261 6d65 3d61 7267 2c20 756e  ta(frame=arg, un
-0002e660: 6974 3d75 6e69 742c 2065 7272 6f72 733d  it=unit, errors=
-0002e670: 6572 726f 7273 2929 0a0a 0a64 6566 205f  errors))...def _
-0002e680: 6672 6f6d 5f73 6361 6c61 7273 2873 6361  from_scalars(sca
-0002e690: 6c61 7273 2c20 6d65 7461 2c20 6e61 6d65  lars, meta, name
-0002e6a0: 7329 3a0a 2020 2020 7265 7475 726e 206e  s):.    return n
-0002e6b0: 6577 5f63 6f6c 6c65 6374 696f 6e28 4672  ew_collection(Fr
-0002e6c0: 6f6d 5363 616c 6172 7328 6d65 7461 2c20  omScalars(meta, 
-0002e6d0: 6e61 6d65 732c 202a 7363 616c 6172 7329  names, *scalars)
-0002e6e0: 290a 0a0a 4069 6e73 6572 745f 6d65 7461  )...@insert_meta
-0002e6f0: 5f70 6172 616d 5f64 6573 6372 6970 7469  _param_descripti
-0002e700: 6f6e 0a64 6566 206d 6170 5f70 6172 7469  on.def map_parti
-0002e710: 7469 6f6e 7328 0a20 2020 2066 756e 632c  tions(.    func,
-0002e720: 0a20 2020 202a 6172 6773 2c0a 2020 2020  .    *args,.    
-0002e730: 6d65 7461 3d6e 6f5f 6465 6661 756c 742c  meta=no_default,
-0002e740: 0a20 2020 2065 6e66 6f72 6365 5f6d 6574  .    enforce_met
-0002e750: 6164 6174 613d 5472 7565 2c0a 2020 2020  adata=True,.    
-0002e760: 7472 616e 7366 6f72 6d5f 6469 7669 7369  transform_divisi
-0002e770: 6f6e 733d 5472 7565 2c0a 2020 2020 636c  ons=True,.    cl
-0002e780: 6561 725f 6469 7669 7369 6f6e 733d 4661  ear_divisions=Fa
-0002e790: 6c73 652c 0a20 2020 2061 6c69 676e 5f64  lse,.    align_d
-0002e7a0: 6174 6166 7261 6d65 733d 4661 6c73 652c  ataframes=False,
-0002e7b0: 0a20 2020 2070 6172 656e 745f 6d65 7461  .    parent_meta
-0002e7c0: 3d4e 6f6e 652c 0a20 2020 202a 2a6b 7761  =None,.    **kwa
-0002e7d0: 7267 732c 0a29 3a0a 2020 2020 2222 2241  rgs,.):.    """A
-0002e7e0: 7070 6c79 2050 7974 686f 6e20 6675 6e63  pply Python func
-0002e7f0: 7469 6f6e 206f 6e20 6561 6368 2044 6174  tion on each Dat
-0002e800: 6146 7261 6d65 2070 6172 7469 7469 6f6e  aFrame partition
-0002e810: 2e0a 0a20 2020 2050 6172 616d 6574 6572  ...    Parameter
-0002e820: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
-0002e830: 0a20 2020 2066 756e 6320 3a20 6675 6e63  .    func : func
-0002e840: 7469 6f6e 0a20 2020 2020 2020 2046 756e  tion.        Fun
-0002e850: 6374 696f 6e20 6170 706c 6965 6420 746f  ction applied to
-0002e860: 2065 6163 6820 7061 7274 6974 696f 6e2e   each partition.
-0002e870: 0a20 2020 2061 7267 732c 206b 7761 7267  .    args, kwarg
-0002e880: 7320 3a0a 2020 2020 2020 2020 4172 6775  s :.        Argu
-0002e890: 6d65 6e74 7320 616e 6420 6b65 7977 6f72  ments and keywor
-0002e8a0: 6473 2074 6f20 7061 7373 2074 6f20 7468  ds to pass to th
-0002e8b0: 6520 6675 6e63 7469 6f6e 2e20 2041 7420  e function.  At 
-0002e8c0: 6c65 6173 7420 6f6e 6520 6f66 2074 6865  least one of the
-0002e8d0: 0a20 2020 2020 2020 2061 7267 7320 7368  .        args sh
-0002e8e0: 6f75 6c64 2062 6520 6120 4461 736b 2e64  ould be a Dask.d
-0002e8f0: 6174 6166 7261 6d65 2e20 4172 6775 6d65  ataframe. Argume
-0002e900: 6e74 7320 616e 6420 6b65 7977 6f72 6473  nts and keywords
-0002e910: 206d 6179 2063 6f6e 7461 696e 0a20 2020   may contain.   
-0002e920: 2020 2020 2060 6053 6361 6c61 7260 602c       ``Scalar``,
-0002e930: 2060 6044 656c 6179 6564 6060 206f 7220   ``Delayed`` or 
-0002e940: 7265 6775 6c61 7220 7079 7468 6f6e 206f  regular python o
-0002e950: 626a 6563 7473 2e20 4461 7461 4672 616d  bjects. DataFram
-0002e960: 652d 6c69 6b65 2061 7267 730a 2020 2020  e-like args.    
-0002e970: 2020 2020 2862 6f74 6820 6461 736b 2061      (both dask a
-0002e980: 6e64 2070 616e 6461 7329 2077 696c 6c20  nd pandas) will 
-0002e990: 6265 2072 6570 6172 7469 7469 6f6e 6564  be repartitioned
-0002e9a0: 2074 6f20 616c 6967 6e20 2869 6620 6e65   to align (if ne
-0002e9b0: 6365 7373 6172 7929 0a20 2020 2020 2020  cessary).       
-0002e9c0: 2062 6566 6f72 6520 6170 706c 7969 6e67   before applying
-0002e9d0: 2074 6865 2066 756e 6374 696f 6e20 2873   the function (s
-0002e9e0: 6565 2060 6061 6c69 676e 5f64 6174 6166  ee ``align_dataf
-0002e9f0: 7261 6d65 7360 6020 746f 2063 6f6e 7472  rames`` to contr
-0002ea00: 6f6c 292e 0a20 2020 2065 6e66 6f72 6365  ol)..    enforce
-0002ea10: 5f6d 6574 6164 6174 6120 3a20 626f 6f6c  _metadata : bool
-0002ea20: 2c20 6465 6661 756c 7420 5472 7565 0a20  , default True. 
-0002ea30: 2020 2020 2020 2057 6865 7468 6572 2074         Whether t
-0002ea40: 6f20 656e 666f 7263 6520 6174 2072 756e  o enforce at run
-0002ea50: 7469 6d65 2074 6861 7420 7468 6520 7374  time that the st
-0002ea60: 7275 6374 7572 6520 6f66 2074 6865 2044  ructure of the D
-0002ea70: 6174 6146 7261 6d65 0a20 2020 2020 2020  ataFrame.       
-0002ea80: 2070 726f 6475 6365 6420 6279 2060 6066   produced by ``f
-0002ea90: 756e 6360 6020 6163 7475 616c 6c79 206d  unc`` actually m
-0002eaa0: 6174 6368 6573 2074 6865 2073 7472 7563  atches the struc
-0002eab0: 7475 7265 206f 6620 6060 6d65 7461 6060  ture of ``meta``
-0002eac0: 2e0a 2020 2020 2020 2020 5468 6973 2077  ..        This w
-0002ead0: 696c 6c20 7265 6e61 6d65 2061 6e64 2072  ill rename and r
-0002eae0: 656f 7264 6572 2063 6f6c 756d 6e73 2066  eorder columns f
-0002eaf0: 6f72 2065 6163 6820 7061 7274 6974 696f  or each partitio
-0002eb00: 6e2c 0a20 2020 2020 2020 2061 6e64 2077  n,.        and w
-0002eb10: 696c 6c20 7261 6973 6520 616e 2065 7272  ill raise an err
-0002eb20: 6f72 2069 6620 7468 6973 2064 6f65 736e  or if this doesn
-0002eb30: 2774 2077 6f72 6b2c 0a20 2020 2020 2020  't work,.       
-0002eb40: 2062 7574 2069 7420 776f 6e27 7420 7261   but it won't ra
-0002eb50: 6973 6520 6966 2064 7479 7065 7320 646f  ise if dtypes do
-0002eb60: 6e27 7420 6d61 7463 682e 0a20 2020 2074  n't match..    t
-0002eb70: 7261 6e73 666f 726d 5f64 6976 6973 696f  ransform_divisio
-0002eb80: 6e73 203a 2062 6f6f 6c2c 2064 6566 6175  ns : bool, defau
-0002eb90: 6c74 2054 7275 650a 2020 2020 2020 2020  lt True.        
-0002eba0: 5768 6574 6865 7220 746f 2061 7070 6c79  Whether to apply
-0002ebb0: 2074 6865 2066 756e 6374 696f 6e20 6f6e   the function on
-0002ebc0: 746f 2074 6865 2064 6976 6973 696f 6e73  to the divisions
-0002ebd0: 2061 6e64 2061 7070 6c79 2074 686f 7365   and apply those
-0002ebe0: 0a20 2020 2020 2020 2074 7261 6e73 666f  .        transfo
-0002ebf0: 726d 6564 2064 6976 6973 696f 6e73 2074  rmed divisions t
-0002ec00: 6f20 7468 6520 6f75 7470 7574 2e0a 2020  o the output..  
-0002ec10: 2020 616c 6967 6e5f 6461 7461 6672 616d    align_datafram
-0002ec20: 6573 203a 2062 6f6f 6c2c 2064 6566 6175  es : bool, defau
-0002ec30: 6c74 2054 7275 650a 2020 2020 2020 2020  lt True.        
-0002ec40: 5768 6574 6865 7220 746f 2072 6570 6172  Whether to repar
-0002ec50: 7469 7469 6f6e 2044 6174 6146 7261 6d65  tition DataFrame
-0002ec60: 2d20 6f72 2053 6572 6965 732d 6c69 6b65  - or Series-like
-0002ec70: 2061 7267 730a 2020 2020 2020 2020 2862   args.        (b
-0002ec80: 6f74 6820 6461 736b 2061 6e64 2070 616e  oth dask and pan
-0002ec90: 6461 7329 2073 6f20 7468 6569 7220 6469  das) so their di
-0002eca0: 7669 7369 6f6e 7320 616c 6967 6e20 6265  visions align be
-0002ecb0: 666f 7265 2061 7070 6c79 696e 670a 2020  fore applying.  
-0002ecc0: 2020 2020 2020 7468 6520 6675 6e63 7469        the functi
-0002ecd0: 6f6e 2e20 5468 6973 2072 6571 7569 7265  on. This require
-0002ece0: 7320 616c 6c20 696e 7075 7473 2074 6f20  s all inputs to 
-0002ecf0: 6861 7665 206b 6e6f 776e 2064 6976 6973  have known divis
-0002ed00: 696f 6e73 2e0a 2020 2020 2020 2020 5369  ions..        Si
-0002ed10: 6e67 6c65 2d70 6172 7469 7469 6f6e 2069  ngle-partition i
-0002ed20: 6e70 7574 7320 7769 6c6c 2062 6520 7370  nputs will be sp
-0002ed30: 6c69 7420 696e 746f 206d 756c 7469 706c  lit into multipl
-0002ed40: 6520 7061 7274 6974 696f 6e73 2e0a 0a20  e partitions... 
-0002ed50: 2020 2020 2020 2049 6620 4661 6c73 652c         If False,
-0002ed60: 2061 6c6c 2069 6e70 7574 7320 6d75 7374   all inputs must
-0002ed70: 2068 6176 6520 6569 7468 6572 2074 6865   have either the
-0002ed80: 2073 616d 6520 6e75 6d62 6572 206f 6620   same number of 
-0002ed90: 7061 7274 6974 696f 6e73 0a20 2020 2020  partitions.     
-0002eda0: 2020 206f 7220 6120 7369 6e67 6c65 2070     or a single p
-0002edb0: 6172 7469 7469 6f6e 2e20 5369 6e67 6c65  artition. Single
-0002edc0: 2d70 6172 7469 7469 6f6e 2069 6e70 7574  -partition input
-0002edd0: 7320 7769 6c6c 2062 6520 6272 6f61 6463  s will be broadc
-0002ede0: 6173 7420 746f 0a20 2020 2020 2020 2065  ast to.        e
-0002edf0: 7665 7279 2070 6172 7469 7469 6f6e 206f  very partition o
-0002ee00: 6620 6d75 6c74 692d 7061 7274 6974 696f  f multi-partitio
-0002ee10: 6e20 696e 7075 7473 2e0a 2020 2020 244d  n inputs..    $M
-0002ee20: 4554 410a 2020 2020 2222 220a 2020 2020  ETA.    """.    
-0002ee30: 6966 2061 6c69 676e 5f64 6174 6166 7261  if align_datafra
-0002ee40: 6d65 733a 0a20 2020 2020 2020 2023 2054  mes:.        # T
-0002ee50: 4f44 4f3a 2048 616e 646c 6520 616c 6967  ODO: Handle alig
-0002ee60: 6e6d 656e 743f 0a20 2020 2020 2020 2023  nment?.        #
-0002ee70: 2050 6572 6861 7073 2077 6520 6f6e 6c79   Perhaps we only
-0002ee80: 2068 616e 646c 6520 7468 6520 6361 7365   handle the case
-0002ee90: 2074 6861 7420 616c 6c20 6045 7870 7260   that all `Expr`
-0002eea0: 206f 7065 7261 6e64 730a 2020 2020 2020   operands.      
-0002eeb0: 2020 2320 6861 7665 2074 6865 2073 616d    # have the sam
-0002eec0: 6520 6e75 6d62 6572 206f 6620 7061 7274  e number of part
-0002eed0: 6974 696f 6e73 206f 7220 6361 6e20 6265  itions or can be
-0002eee0: 2062 726f 6164 6361 7374 6564 0a20 2020   broadcasted.   
-0002eef0: 2020 2020 2023 2077 6974 6869 6e20 604d       # within `M
-0002ef00: 6170 5061 7274 6974 696f 6e73 602e 2049  apPartitions`. I
-0002ef10: 6620 736f 2c20 7468 6520 606d 6170 5f70  f so, the `map_p
-0002ef20: 6172 7469 7469 6f6e 7360 2041 5049 0a20  artitions` API. 
-0002ef30: 2020 2020 2020 2023 2077 696c 6c20 6e65         # will ne
-0002ef40: 6564 2074 6f20 6361 6c6c 2060 5265 7061  ed to call `Repa
-0002ef50: 7274 6974 696f 6e60 206f 6e20 6f70 6572  rtition` on oper
-0002ef60: 616e 6473 2074 6861 7420 6172 6520 6e6f  ands that are no
-0002ef70: 740a 2020 2020 2020 2020 2320 616c 6967  t.        # alig
-0002ef80: 6e65 6420 7769 7468 2060 7365 6c66 2e65  ned with `self.e
-0002ef90: 7870 7260 2e0a 2020 2020 2020 2020 7261  xpr`..        ra
-0002efa0: 6973 6520 4e6f 7449 6d70 6c65 6d65 6e74  ise NotImplement
-0002efb0: 6564 4572 726f 7228 290a 2020 2020 6e65  edError().    ne
-0002efc0: 775f 6578 7072 203d 2065 7870 722e 4d61  w_expr = expr.Ma
-0002efd0: 7050 6172 7469 7469 6f6e 7328 0a20 2020  pPartitions(.   
-0002efe0: 2020 2020 2061 7267 735b 305d 2c0a 2020       args[0],.  
-0002eff0: 2020 2020 2020 6675 6e63 2c0a 2020 2020        func,.    
-0002f000: 2020 2020 6d65 7461 2c0a 2020 2020 2020      meta,.      
-0002f010: 2020 656e 666f 7263 655f 6d65 7461 6461    enforce_metada
-0002f020: 7461 2c0a 2020 2020 2020 2020 7472 616e  ta,.        tran
-0002f030: 7366 6f72 6d5f 6469 7669 7369 6f6e 732c  sform_divisions,
-0002f040: 0a20 2020 2020 2020 2063 6c65 6172 5f64  .        clear_d
-0002f050: 6976 6973 696f 6e73 2c0a 2020 2020 2020  ivisions,.      
-0002f060: 2020 616c 6967 6e5f 6461 7461 6672 616d    align_datafram
-0002f070: 6573 2c0a 2020 2020 2020 2020 7061 7265  es,.        pare
-0002f080: 6e74 5f6d 6574 612c 0a20 2020 2020 2020  nt_meta,.       
-0002f090: 206b 7761 7267 732e 706f 7028 2274 6f6b   kwargs.pop("tok
-0002f0a0: 656e 222c 204e 6f6e 6529 2c0a 2020 2020  en", None),.    
-0002f0b0: 2020 2020 6b77 6172 6773 2c0a 2020 2020      kwargs,.    
-0002f0c0: 2020 2020 2a61 7267 735b 313a 5d2c 0a20      *args[1:],. 
-0002f0d0: 2020 2029 0a20 2020 2072 6574 7572 6e20     ).    return 
-0002f0e0: 6e65 775f 636f 6c6c 6563 7469 6f6e 286e  new_collection(n
-0002f0f0: 6577 5f65 7870 7229 0a0a 0a64 6566 206d  ew_expr)...def m
-0002f100: 6170 5f6f 7665 726c 6170 280a 2020 2020  ap_overlap(.    
-0002f110: 6675 6e63 2c0a 2020 2020 6466 2c0a 2020  func,.    df,.  
-0002f120: 2020 6265 666f 7265 2c0a 2020 2020 6166    before,.    af
-0002f130: 7465 722c 0a20 2020 202a 6172 6773 2c0a  ter,.    *args,.
-0002f140: 2020 2020 6d65 7461 3d6e 6f5f 6465 6661      meta=no_defa
-0002f150: 756c 742c 0a20 2020 2065 6e66 6f72 6365  ult,.    enforce
-0002f160: 5f6d 6574 6164 6174 613d 5472 7565 2c0a  _metadata=True,.
-0002f170: 2020 2020 7472 616e 7366 6f72 6d5f 6469      transform_di
-0002f180: 7669 7369 6f6e 733d 5472 7565 2c0a 2020  visions=True,.  
-0002f190: 2020 636c 6561 725f 6469 7669 7369 6f6e    clear_division
-0002f1a0: 733d 4661 6c73 652c 0a20 2020 2061 6c69  s=False,.    ali
-0002f1b0: 676e 5f64 6174 6166 7261 6d65 733d 4661  gn_dataframes=Fa
-0002f1c0: 6c73 652c 0a20 2020 202a 2a6b 7761 7267  lse,.    **kwarg
-0002f1d0: 732c 0a29 3a0a 2020 2020 6966 2069 7369  s,.):.    if isi
-0002f1e0: 6e73 7461 6e63 6528 6265 666f 7265 2c20  nstance(before, 
-0002f1f0: 7374 7229 3a0a 2020 2020 2020 2020 6265  str):.        be
-0002f200: 666f 7265 203d 2070 642e 746f 5f74 696d  fore = pd.to_tim
-0002f210: 6564 656c 7461 2862 6566 6f72 6529 0a20  edelta(before). 
-0002f220: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-0002f230: 2861 6674 6572 2c20 7374 7229 3a0a 2020  (after, str):.  
-0002f240: 2020 2020 2020 6166 7465 7220 3d20 7064        after = pd
-0002f250: 2e74 6f5f 7469 6d65 6465 6c74 6128 6166  .to_timedelta(af
-0002f260: 7465 7229 0a0a 2020 2020 6966 2069 7369  ter)..    if isi
-0002f270: 6e73 7461 6e63 6528 6265 666f 7265 2c20  nstance(before, 
-0002f280: 6461 7465 7469 6d65 2e74 696d 6564 656c  datetime.timedel
-0002f290: 7461 2920 6f72 2069 7369 6e73 7461 6e63  ta) or isinstanc
-0002f2a0: 6528 6166 7465 722c 2064 6174 6574 696d  e(after, datetim
-0002f2b0: 652e 7469 6d65 6465 6c74 6129 3a0a 2020  e.timedelta):.  
-0002f2c0: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-0002f2d0: 6e63 6528 6466 2c20 4672 616d 6542 6173  nce(df, FrameBas
-0002f2e0: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
-0002f2f0: 696e 6665 7272 6564 5f74 7970 6520 3d20  inferred_type = 
-0002f300: 6466 2e69 6e64 6578 2e5f 6d65 7461 5f6e  df.index._meta_n
-0002f310: 6f6e 656d 7074 792e 696e 6665 7272 6564  onempty.inferred
-0002f320: 5f74 7970 650a 2020 2020 2020 2020 656c  _type.        el
-0002f330: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0002f340: 696e 6665 7272 6564 5f74 7970 6520 3d20  inferred_type = 
-0002f350: 6466 2e69 6e64 6578 2e69 6e66 6572 7265  df.index.inferre
-0002f360: 645f 7479 7065 0a0a 2020 2020 2020 2020  d_type..        
-0002f370: 6966 206e 6f74 2069 735f 6461 7465 7469  if not is_dateti
-0002f380: 6d65 3634 5f61 6e79 5f64 7479 7065 2869  me64_any_dtype(i
-0002f390: 6e66 6572 7265 645f 7479 7065 293a 0a20  nferred_type):. 
-0002f3a0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0002f3b0: 2054 7970 6545 7272 6f72 280a 2020 2020   TypeError(.    
-0002f3c0: 2020 2020 2020 2020 2020 2020 224d 7573              "Mus
-0002f3d0: 7420 6861 7665 2061 2060 4461 7465 7469  t have a `Dateti
-0002f3e0: 6d65 496e 6465 7860 2077 6865 6e20 7573  meIndex` when us
-0002f3f0: 696e 6720 7374 7269 6e67 206f 6666 7365  ing string offse
-0002f400: 7420 220a 2020 2020 2020 2020 2020 2020  t ".            
-0002f410: 2020 2020 2266 6f72 2060 6265 666f 7265      "for `before
-0002f420: 6020 616e 6420 6061 6674 6572 6022 0a20  ` and `after`". 
-0002f430: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-0002f440: 2020 656c 6966 206e 6f74 2028 0a20 2020    elif not (.   
-0002f450: 2020 2020 2069 7369 6e73 7461 6e63 6528       isinstance(
-0002f460: 6265 666f 7265 2c20 496e 7465 6772 616c  before, Integral
-0002f470: 290a 2020 2020 2020 2020 616e 6420 6265  ).        and be
-0002f480: 666f 7265 203e 3d20 300a 2020 2020 2020  fore >= 0.      
-0002f490: 2020 616e 6420 6973 696e 7374 616e 6365    and isinstance
-0002f4a0: 2861 6674 6572 2c20 496e 7465 6772 616c  (after, Integral
-0002f4b0: 290a 2020 2020 2020 2020 616e 6420 6166  ).        and af
-0002f4c0: 7465 7220 3e3d 2030 0a20 2020 2029 3a0a  ter >= 0.    ):.
-0002f4d0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-0002f4e0: 6c75 6545 7272 6f72 2822 6265 666f 7265  lueError("before
-0002f4f0: 2061 6e64 2061 6674 6572 206d 7573 7420   and after must 
-0002f500: 6265 2070 6f73 6974 6976 6520 696e 7465  be positive inte
-0002f510: 6765 7273 2229 0a0a 2020 2020 6466 203d  gers")..    df =
-0002f520: 205f 6d61 7962 655f 6672 6f6d 5f70 616e   _maybe_from_pan
-0002f530: 6461 7328 5b64 665d 295b 305d 0a20 2020  das([df])[0].   
-0002f540: 2061 7267 7320 3d20 5f6d 6179 6265 5f66   args = _maybe_f
-0002f550: 726f 6d5f 7061 6e64 6173 2861 7267 7329  rom_pandas(args)
-0002f560: 0a0a 2020 2020 6966 2061 6c69 676e 5f64  ..    if align_d
-0002f570: 6174 6166 7261 6d65 733a 0a20 2020 2020  ataframes:.     
-0002f580: 2020 2064 6673 203d 205b 6466 5d20 2b20     dfs = [df] + 
-0002f590: 6172 6773 0a20 2020 2020 2020 2064 6673  args.        dfs
-0002f5a0: 203d 205b 6466 2066 6f72 2064 6620 696e   = [df for df in
-0002f5b0: 2064 6673 2069 6620 6973 696e 7374 616e   dfs if isinstan
-0002f5c0: 6365 2864 662c 2046 7261 6d65 4261 7365  ce(df, FrameBase
-0002f5d0: 295d 0a20 2020 2020 2020 2069 6620 6c65  )].        if le
-0002f5e0: 6e28 6466 7329 203e 2031 2061 6e64 206e  n(dfs) > 1 and n
-0002f5f0: 6f74 2065 7870 722e 6172 655f 636f 5f61  ot expr.are_co_a
-0002f600: 6c69 676e 6564 282a 6466 7329 3a0a 2020  ligned(*dfs):.  
-0002f610: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0002f620: 206e 6577 5f63 6f6c 6c65 6374 696f 6e28   new_collection(
-0002f630: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002f640: 2065 7870 722e 4d61 704f 7665 726c 6170   expr.MapOverlap
-0002f650: 416c 6967 6e28 0a20 2020 2020 2020 2020  Align(.         
-0002f660: 2020 2020 2020 2020 2020 2064 662c 0a20             df,. 
-0002f670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f680: 2020 2066 756e 632c 0a20 2020 2020 2020     func,.       
-0002f690: 2020 2020 2020 2020 2020 2020 2062 6566               bef
-0002f6a0: 6f72 652c 0a20 2020 2020 2020 2020 2020  ore,.           
-0002f6b0: 2020 2020 2020 2020 2061 6674 6572 2c0a           after,.
-0002f6c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f6d0: 2020 2020 6d65 7461 2c0a 2020 2020 2020      meta,.      
-0002f6e0: 2020 2020 2020 2020 2020 2020 2020 656e                en
-0002f6f0: 666f 7263 655f 6d65 7461 6461 7461 2c0a  force_metadata,.
-0002f700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f710: 2020 2020 7472 616e 7366 6f72 6d5f 6469      transform_di
-0002f720: 7669 7369 6f6e 732c 0a20 2020 2020 2020  visions,.       
-0002f730: 2020 2020 2020 2020 2020 2020 2063 6c65               cle
-0002f740: 6172 5f64 6976 6973 696f 6e73 2c0a 2020  ar_divisions,.  
-0002f750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f760: 2020 616c 6967 6e5f 6461 7461 6672 616d    align_datafram
-0002f770: 6573 2c0a 2020 2020 2020 2020 2020 2020  es,.            
-0002f780: 2020 2020 2020 2020 6b77 6172 6773 2e70          kwargs.p
-0002f790: 6f70 2822 746f 6b65 6e22 2c20 4e6f 6e65  op("token", None
-0002f7a0: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-0002f7b0: 2020 2020 2020 206b 7761 7267 732c 0a20         kwargs,. 
-0002f7c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f7d0: 2020 202a 6172 6773 2c0a 2020 2020 2020     *args,.      
-0002f7e0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0002f7f0: 2020 2020 2020 2020 290a 0a20 2020 206e          )..    n
-0002f800: 6577 5f65 7870 7220 3d20 6578 7072 2e4d  ew_expr = expr.M
-0002f810: 6170 4f76 6572 6c61 7028 0a20 2020 2020  apOverlap(.     
-0002f820: 2020 2064 662c 0a20 2020 2020 2020 2066     df,.        f
-0002f830: 756e 632c 0a20 2020 2020 2020 2062 6566  unc,.        bef
-0002f840: 6f72 652c 0a20 2020 2020 2020 2061 6674  ore,.        aft
-0002f850: 6572 2c0a 2020 2020 2020 2020 6d65 7461  er,.        meta
-0002f860: 2c0a 2020 2020 2020 2020 656e 666f 7263  ,.        enforc
-0002f870: 655f 6d65 7461 6461 7461 2c0a 2020 2020  e_metadata,.    
-0002f880: 2020 2020 7472 616e 7366 6f72 6d5f 6469      transform_di
-0002f890: 7669 7369 6f6e 732c 0a20 2020 2020 2020  visions,.       
-0002f8a0: 2063 6c65 6172 5f64 6976 6973 696f 6e73   clear_divisions
-0002f8b0: 2c0a 2020 2020 2020 2020 616c 6967 6e5f  ,.        align_
-0002f8c0: 6461 7461 6672 616d 6573 2c0a 2020 2020  dataframes,.    
-0002f8d0: 2020 2020 6b77 6172 6773 2e70 6f70 2822      kwargs.pop("
-0002f8e0: 746f 6b65 6e22 2c20 4e6f 6e65 292c 0a20  token", None),. 
-0002f8f0: 2020 2020 2020 206b 7761 7267 732c 0a20         kwargs,. 
-0002f900: 2020 2020 2020 202a 6172 6773 2c0a 2020         *args,.  
-0002f910: 2020 290a 2020 2020 7265 7475 726e 206e    ).    return n
-0002f920: 6577 5f63 6f6c 6c65 6374 696f 6e28 6e65  ew_collection(ne
-0002f930: 775f 6578 7072 290a 0a0a 6465 6620 6973  w_expr)...def is
-0002f940: 6e61 2861 7267 293a 0a20 2020 2069 6620  na(arg):.    if 
-0002f950: 6973 696e 7374 616e 6365 2861 7267 2c20  isinstance(arg, 
-0002f960: 4672 616d 6542 6173 6529 3a0a 2020 2020  FrameBase):.    
-0002f970: 2020 2020 7265 7475 726e 2061 7267 2e69      return arg.i
-0002f980: 736e 6128 290a 2020 2020 656c 7365 3a0a  sna().    else:.
-0002f990: 2020 2020 2020 2020 7265 7475 726e 2066          return f
-0002f9a0: 726f 6d5f 7061 6e64 6173 2861 7267 292e  rom_pandas(arg).
-0002f9b0: 6973 6e61 2829 0a0a 0a64 6566 2065 6c65  isna()...def ele
-0002f9c0: 6d77 6973 6528 6f70 2c20 2a61 7267 732c  mwise(op, *args,
-0002f9d0: 206d 6574 613d 6e6f 5f64 6566 6175 6c74   meta=no_default
-0002f9e0: 2c20 6f75 743d 4e6f 6e65 2c20 7472 616e  , out=None, tran
-0002f9f0: 7366 6f72 6d5f 6469 7669 7369 6f6e 733d  sform_divisions=
-0002fa00: 5472 7565 2c20 2a2a 6b77 6172 6773 293a  True, **kwargs):
-0002fa10: 0a20 2020 2022 2222 456c 656d 656e 7477  .    """Elementw
-0002fa20: 6973 6520 6f70 6572 6174 696f 6e20 666f  ise operation fo
-0002fa30: 7220 4461 736b 2064 6174 6166 7261 6d65  r Dask dataframe
-0002fa40: 730a 0a20 2020 2050 6172 616d 6574 6572  s..    Parameter
-0002fa50: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
-0002fa60: 0a20 2020 206f 703a 2063 616c 6c61 626c  .    op: callabl
-0002fa70: 650a 2020 2020 2020 2020 4675 6e63 7469  e.        Functi
-0002fa80: 6f6e 2074 6f20 6170 706c 7920 6163 726f  on to apply acro
-0002fa90: 7373 2069 6e70 7574 2064 6174 6166 7261  ss input datafra
-0002faa0: 6d65 730a 2020 2020 2a61 7267 733a 2044  mes.    *args: D
-0002fab0: 6174 6146 7261 6d65 732c 2053 6572 6965  ataFrames, Serie
-0002fac0: 732c 2053 6361 6c61 7273 2c20 4172 7261  s, Scalars, Arra
-0002fad0: 7973 2c0a 2020 2020 2020 2020 5468 6520  ys,.        The 
-0002fae0: 6172 6775 6d65 6e74 7320 6f66 2074 6865  arguments of the
-0002faf0: 206f 7065 7261 7469 6f6e 0a20 2020 206d   operation.    m
-0002fb00: 6574 613a 2070 642e 4461 7461 4672 616d  eta: pd.DataFram
-0002fb10: 652c 2070 642e 5365 7269 6573 2028 6f70  e, pd.Series (op
-0002fb20: 7469 6f6e 616c 290a 2020 2020 2020 2020  tional).        
-0002fb30: 5661 6c69 6420 6d65 7461 6461 7461 2066  Valid metadata f
-0002fb40: 6f72 2074 6865 206f 7065 7261 7469 6f6e  or the operation
-0002fb50: 2e20 2057 696c 6c20 6576 616c 7561 7465  .  Will evaluate
-0002fb60: 206f 6e20 6120 736d 616c 6c20 7069 6563   on a small piec
-0002fb70: 6520 6f66 0a20 2020 2020 2020 2064 6174  e of.        dat
-0002fb80: 6120 6966 206e 6f74 2070 726f 7669 6465  a if not provide
-0002fb90: 642e 0a20 2020 2074 7261 6e73 666f 726d  d..    transform
-0002fba0: 5f64 6976 6973 696f 6e73 3a20 626f 6f6c  _divisions: bool
-0002fbb0: 6561 6e0a 2020 2020 2020 2020 4966 2074  ean.        If t
-0002fbc0: 6865 2069 6e70 7574 2069 7320 6120 6060  he input is a ``
-0002fbd0: 6461 736b 2e64 6174 6166 7261 6d65 2e49  dask.dataframe.I
-0002fbe0: 6e64 6578 6060 2077 6520 6e6f 726d 616c  ndex`` we normal
-0002fbf0: 6c79 2077 696c 6c20 616c 736f 2061 7070  ly will also app
-0002fc00: 6c79 0a20 2020 2020 2020 2074 6865 2066  ly.        the f
-0002fc10: 756e 6374 696f 6e20 6f6e 746f 2074 6865  unction onto the
-0002fc20: 2064 6976 6973 696f 6e73 2061 6e64 2061   divisions and a
-0002fc30: 7070 6c79 2074 686f 7365 2074 7261 6e73  pply those trans
-0002fc40: 666f 726d 6564 2064 6976 6973 696f 6e73  formed divisions
-0002fc50: 0a20 2020 2020 2020 2074 6f20 7468 6520  .        to the 
-0002fc60: 6f75 7470 7574 2e20 2059 6f75 2063 616e  output.  You can
-0002fc70: 2070 6173 7320 6060 7472 616e 7366 6f72   pass ``transfor
-0002fc80: 6d5f 6469 7669 7369 6f6e 733d 4661 6c73  m_divisions=Fals
-0002fc90: 6560 6020 746f 206f 7665 7272 6964 650a  e`` to override.
-0002fca0: 2020 2020 2020 2020 7468 6973 2062 6568          this beh
-0002fcb0: 6176 696f 720a 2020 2020 6f75 7420 3a20  avior.    out : 
-0002fcc0: 6060 6461 736b 2e61 7272 6179 6060 206f  ``dask.array`` o
-0002fcd0: 7220 6060 4e6f 6e65 6060 0a20 2020 2020  r ``None``.     
-0002fce0: 2020 2049 6620 6f75 7420 6973 2061 2064     If out is a d
-0002fcf0: 6173 6b2e 4461 7461 4672 616d 652c 2064  ask.DataFrame, d
-0002fd00: 6173 6b2e 5365 7269 6573 206f 7220 6461  ask.Series or da
-0002fd10: 736b 2e53 6361 6c61 7220 7468 656e 0a20  sk.Scalar then. 
-0002fd20: 2020 2020 2020 2074 6869 7320 6f76 6572         this over
-0002fd30: 7772 6974 6573 2074 6865 2063 6f6e 7465  writes the conte
-0002fd40: 6e74 7320 6f66 2069 7420 7769 7468 2074  nts of it with t
-0002fd50: 6865 2072 6573 756c 740a 2020 2020 2a2a  he result.    **
-0002fd60: 6b77 6172 6773 3a20 7363 616c 6172 730a  kwargs: scalars.
-0002fd70: 0a20 2020 2045 7861 6d70 6c65 730a 2020  .    Examples.  
-0002fd80: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 203e    --------.    >
-0002fd90: 3e3e 2065 6c65 6d77 6973 6528 6f70 6572  >> elemwise(oper
-0002fda0: 6174 6f72 2e61 6464 2c20 6466 2e78 2c20  ator.add, df.x, 
-0002fdb0: 6466 2e79 2920 2023 2064 6f63 7465 7374  df.y)  # doctest
-0002fdc0: 3a20 2b53 4b49 500a 2020 2020 2222 220a  : +SKIP.    """.
-0002fdd0: 0a20 2020 2061 7267 7320 3d20 5f6d 6179  .    args = _may
-0002fde0: 6265 5f66 726f 6d5f 7061 6e64 6173 2861  be_from_pandas(a
-0002fdf0: 7267 7329 0a20 2020 2064 6673 203d 205b  rgs).    dfs = [
-0002fe00: 6466 2066 6f72 2064 6620 696e 2061 7267  df for df in arg
-0002fe10: 7320 6966 2069 7369 6e73 7461 6e63 6528  s if isinstance(
-0002fe20: 6466 2c20 4672 616d 6542 6173 6529 5d0a  df, FrameBase)].
-0002fe30: 2020 2020 6966 206c 656e 2864 6673 2920      if len(dfs) 
-0002fe40: 3c3d 2031 206f 7220 6578 7072 2e61 7265  <= 1 or expr.are
-0002fe50: 5f63 6f5f 616c 6967 6e65 6428 2a64 6673  _co_aligned(*dfs
-0002fe60: 293a 0a20 2020 2020 2020 2072 6573 756c  ):.        resul
-0002fe70: 7420 3d20 6e65 775f 636f 6c6c 6563 7469  t = new_collecti
-0002fe80: 6f6e 280a 2020 2020 2020 2020 2020 2020  on(.            
-0002fe90: 6578 7072 2e55 4675 6e63 456c 656d 7769  expr.UFuncElemwi
-0002fea0: 7365 2864 6673 5b30 5d2c 206f 702c 206d  se(dfs[0], op, m
-0002feb0: 6574 612c 2074 7261 6e73 666f 726d 5f64  eta, transform_d
-0002fec0: 6976 6973 696f 6e73 2c20 6b77 6172 6773  ivisions, kwargs
-0002fed0: 2c20 2a61 7267 7329 0a20 2020 2020 2020  , *args).       
-0002fee0: 2029 0a20 2020 2065 6c73 653a 0a20 2020   ).    else:.   
-0002fef0: 2020 2020 2072 6573 756c 7420 3d20 6e65       result = ne
-0002ff00: 775f 636f 6c6c 6563 7469 6f6e 2865 7870  w_collection(exp
-0002ff10: 722e 5546 756e 6341 6c69 676e 2864 6673  r.UFuncAlign(dfs
-0002ff20: 5b30 5d2c 206f 702c 206d 6574 612c 206b  [0], op, meta, k
-0002ff30: 7761 7267 732c 202a 6172 6773 2929 0a20  wargs, *args)). 
-0002ff40: 2020 2072 6574 7572 6e20 6861 6e64 6c65     return handle
-0002ff50: 5f6f 7574 286f 7574 2c20 7265 7375 6c74  _out(out, result
-0002ff60: 290a 0a0a 6465 6620 6861 6e64 6c65 5f6f  )...def handle_o
-0002ff70: 7574 286f 7574 2c20 7265 7375 6c74 293a  ut(out, result):
-0002ff80: 0a20 2020 2022 2222 4861 6e64 6c65 206f  .    """Handle o
-0002ff90: 7574 2070 6172 616d 6574 6572 730a 0a20  ut parameters.. 
-0002ffa0: 2020 2049 6620 6f75 7420 6973 2061 2064     If out is a d
-0002ffb0: 6173 6b2e 4461 7461 4672 616d 652c 2064  ask.DataFrame, d
-0002ffc0: 6173 6b2e 5365 7269 6573 206f 7220 6461  ask.Series or da
-0002ffd0: 736b 2e53 6361 6c61 7220 7468 656e 0a20  sk.Scalar then. 
-0002ffe0: 2020 2074 6869 7320 6f76 6572 7772 6974     this overwrit
-0002fff0: 6573 2074 6865 2063 6f6e 7465 6e74 7320  es the contents 
-00030000: 6f66 2069 7420 7769 7468 2074 6865 2072  of it with the r
-00030010: 6573 756c 742e 2054 6865 206d 6574 686f  esult. The metho
-00030020: 640a 2020 2020 7265 706c 6163 6573 2074  d.    replaces t
-00030030: 6865 2065 7870 7265 7373 696f 6e20 6f66  he expression of
-00030040: 2074 6865 206f 7574 2070 6172 616d 6574   the out paramet
-00030050: 6572 2077 6974 6820 7468 6520 7265 7375  er with the resu
-00030060: 6c74 0a20 2020 2066 726f 6d20 7468 6973  lt.    from this
-00030070: 206f 7065 7261 7469 6f6e 2074 6f20 7065   operation to pe
-00030080: 7266 6f72 6d20 736f 6d65 7468 696e 6720  rform something 
-00030090: 616b 696e 2074 6f20 616e 2069 6e70 6c61  akin to an inpla
-000300a0: 6365 0a20 2020 206d 6f64 6966 6963 6174  ce.    modificat
-000300b0: 696f 6e2e 0a20 2020 2022 2222 0a20 2020  ion..    """.   
-000300c0: 2069 6620 6973 696e 7374 616e 6365 286f   if isinstance(o
-000300d0: 7574 2c20 7475 706c 6529 3a0a 2020 2020  ut, tuple):.    
-000300e0: 2020 2020 6966 206c 656e 286f 7574 2920      if len(out) 
-000300f0: 3d3d 2031 3a0a 2020 2020 2020 2020 2020  == 1:.          
-00030100: 2020 6f75 7420 3d20 6f75 745b 305d 0a20    out = out[0]. 
-00030110: 2020 2020 2020 2065 6c69 6620 6c65 6e28         elif len(
-00030120: 6f75 7429 203e 2031 3a0a 2020 2020 2020  out) > 1:.      
-00030130: 2020 2020 2020 7261 6973 6520 4e6f 7449        raise NotI
-00030140: 6d70 6c65 6d65 6e74 6564 4572 726f 7228  mplementedError(
-00030150: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00030160: 2022 5468 6520 606f 7574 6020 7061 7261   "The `out` para
-00030170: 6d65 7465 7220 7769 7468 206c 656e 6774  meter with lengt
-00030180: 6820 3e20 3120 6973 206e 6f74 2073 7570  h > 1 is not sup
-00030190: 706f 7274 6564 220a 2020 2020 2020 2020  ported".        
-000301a0: 2020 2020 290a 2020 2020 2020 2020 656c      ).        el
-000301b0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-000301c0: 6f75 7420 3d20 4e6f 6e65 0a0a 2020 2020  out = None..    
-000301d0: 6966 206f 7574 2069 7320 6e6f 7420 4e6f  if out is not No
-000301e0: 6e65 2061 6e64 206f 7574 2e5f 5f63 6c61  ne and out.__cla
-000301f0: 7373 5f5f 2021 3d20 7265 7375 6c74 2e5f  ss__ != result._
-00030200: 5f63 6c61 7373 5f5f 3a0a 2020 2020 2020  _class__:.      
-00030210: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
-00030220: 7228 0a20 2020 2020 2020 2020 2020 2022  r(.            "
-00030230: 4d69 736d 6174 6368 6564 2074 7970 6573  Mismatched types
-00030240: 2062 6574 7765 656e 2072 6573 756c 7420   between result 
-00030250: 616e 6420 6f75 7420 7061 7261 6d65 7465  and out paramete
-00030260: 722e 2022 0a20 2020 2020 2020 2020 2020  r. ".           
-00030270: 2022 6f75 743d 2573 2c20 7265 7375 6c74   "out=%s, result
-00030280: 3d25 7322 2025 2028 7374 7228 7479 7065  =%s" % (str(type
-00030290: 286f 7574 2929 2c20 7374 7228 7479 7065  (out)), str(type
-000302a0: 2872 6573 756c 7429 2929 0a20 2020 2020  (result))).     
-000302b0: 2020 2029 0a0a 2020 2020 6966 2069 7369     )..    if isi
-000302c0: 6e73 7461 6e63 6528 6f75 742c 2044 6174  nstance(out, Dat
-000302d0: 6146 7261 6d65 293a 0a20 2020 2020 2020  aFrame):.       
-000302e0: 2069 6620 6c65 6e28 6f75 742e 636f 6c75   if len(out.colu
-000302f0: 6d6e 7329 2021 3d20 6c65 6e28 7265 7375  mns) != len(resu
-00030300: 6c74 2e63 6f6c 756d 6e73 293a 0a20 2020  lt.columns):.   
-00030310: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-00030320: 616c 7565 4572 726f 7228 0a20 2020 2020  alueError(.     
-00030330: 2020 2020 2020 2020 2020 2022 4d69 736d             "Mism
-00030340: 6174 6368 6564 2063 6f6c 756d 6e73 2063  atched columns c
-00030350: 6f75 6e74 2062 6574 7765 656e 2072 6573  ount between res
-00030360: 756c 7420 616e 6420 6f75 7420 7061 7261  ult and out para
-00030370: 6d65 7465 722e 2022 0a20 2020 2020 2020  meter. ".       
-00030380: 2020 2020 2020 2020 2022 6f75 743d 2573           "out=%s
-00030390: 2c20 7265 7375 6c74 3d25 7322 2025 2028  , result=%s" % (
-000303a0: 7374 7228 6c65 6e28 6f75 742e 636f 6c75  str(len(out.colu
-000303b0: 6d6e 7329 292c 2073 7472 286c 656e 2872  mns)), str(len(r
-000303c0: 6573 756c 742e 636f 6c75 6d6e 7329 2929  esult.columns)))
-000303d0: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
-000303e0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-000303f0: 6528 6f75 742c 2028 5365 7269 6573 2c20  e(out, (Series, 
-00030400: 4461 7461 4672 616d 652c 2053 6361 6c61  DataFrame, Scala
-00030410: 7229 293a 0a20 2020 2020 2020 206f 7574  r)):.        out
-00030420: 2e5f 6578 7072 203d 2072 6573 756c 742e  ._expr = result.
-00030430: 5f65 7870 720a 2020 2020 656c 6966 206f  _expr.    elif o
-00030440: 7574 2069 7320 6e6f 7420 4e6f 6e65 3a0a  ut is not None:.
-00030450: 2020 2020 2020 2020 6d73 6720 3d20 280a          msg = (.
-00030460: 2020 2020 2020 2020 2020 2020 2254 6865              "The
-00030470: 206f 7574 2070 6172 616d 6574 6572 2069   out parameter i
-00030480: 7320 6e6f 7420 6675 6c6c 7920 7375 7070  s not fully supp
-00030490: 6f72 7465 642e 220a 2020 2020 2020 2020  orted.".        
-000304a0: 2020 2020 2220 5265 6365 6976 6564 2074      " Received t
-000304b0: 7970 6520 2573 2c20 6578 7065 6374 6564  ype %s, expected
-000304c0: 2025 7320 220a 2020 2020 2020 2020 2020   %s ".          
-000304d0: 2020 2520 280a 2020 2020 2020 2020 2020    % (.          
-000304e0: 2020 2020 2020 7479 7065 6e61 6d65 2874        typename(t
-000304f0: 7970 6528 6f75 7429 292c 0a20 2020 2020  ype(out)),.     
-00030500: 2020 2020 2020 2020 2020 2074 7970 656e             typen
-00030510: 616d 6528 7479 7065 2872 6573 756c 7429  ame(type(result)
-00030520: 292c 0a20 2020 2020 2020 2020 2020 2029  ),.            )
-00030530: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-00030540: 2020 2072 6169 7365 204e 6f74 496d 706c     raise NotImpl
-00030550: 656d 656e 7465 6445 7272 6f72 286d 7367  ementedError(msg
-00030560: 290a 2020 2020 656c 7365 3a0a 2020 2020  ).    else:.    
-00030570: 2020 2020 7265 7475 726e 2072 6573 756c      return resul
-00030580: 740a 0a0a 6465 6620 5f63 6f6d 7075 7465  t...def _compute
-00030590: 5f70 6172 7469 7469 6f6e 5f73 7461 7473  _partition_stats
-000305a0: 280a 2020 2020 636f 6c75 6d6e 3a20 5365  (.    column: Se
-000305b0: 7269 6573 2c20 616c 6c6f 775f 6f76 6572  ries, allow_over
-000305c0: 6c61 703a 2062 6f6f 6c20 3d20 4661 6c73  lap: bool = Fals
-000305d0: 650a 2920 2d3e 2074 7570 6c65 5b6c 6973  e.) -> tuple[lis
-000305e0: 742c 206c 6973 742c 206c 6973 745b 696e  t, list, list[in
-000305f0: 745d 5d3a 0a20 2020 2022 2222 466f 7220  t]]:.    """For 
-00030600: 6120 6769 7665 6e20 636f 6c75 6d6e 2c20  a given column, 
-00030610: 636f 6d70 7574 6520 7468 6520 6d69 6e2c  compute the min,
-00030620: 206d 6178 2c20 616e 6420 6c65 6e20 6f66   max, and len of
-00030630: 2065 6163 6820 7061 7274 6974 696f 6e2e   each partition.
-00030640: 0a0a 2020 2020 416e 6420 6d61 6b65 2073  ..    And make s
-00030650: 7572 6520 7468 6174 2074 6865 2070 6172  ure that the par
-00030660: 7469 7469 6f6e 7320 6172 6520 736f 7274  titions are sort
-00030670: 6564 2072 656c 6174 6976 6520 746f 2065  ed relative to e
-00030680: 6163 6820 6f74 6865 722e 0a20 2020 204e  ach other..    N
-00030690: 4f54 453a 2074 6869 7320 646f 6573 206e  OTE: this does n
-000306a0: 6f74 2067 7561 7261 6e74 6565 2074 6861  ot guarantee tha
-000306b0: 7420 6576 6572 7920 7061 7274 6974 696f  t every partitio
-000306c0: 6e20 6973 2069 6e74 6572 6e61 6c6c 7920  n is internally 
-000306d0: 736f 7274 6564 2e0a 2020 2020 2222 220a  sorted..    """.
-000306e0: 2020 2020 6d69 6e73 203d 2063 6f6c 756d      mins = colum
-000306f0: 6e2e 6d61 705f 7061 7274 6974 696f 6e73  n.map_partitions
-00030700: 284d 2e6d 696e 2c20 6d65 7461 3d63 6f6c  (M.min, meta=col
-00030710: 756d 6e29 0a20 2020 206d 6178 6573 203d  umn).    maxes =
-00030720: 2063 6f6c 756d 6e2e 6d61 705f 7061 7274   column.map_part
-00030730: 6974 696f 6e73 284d 2e6d 6178 2c20 6d65  itions(M.max, me
-00030740: 7461 3d63 6f6c 756d 6e29 0a20 2020 206c  ta=column).    l
-00030750: 656e 7320 3d20 636f 6c75 6d6e 2e6d 6170  ens = column.map
-00030760: 5f70 6172 7469 7469 6f6e 7328 6c65 6e2c  _partitions(len,
-00030770: 206d 6574 613d 636f 6c75 6d6e 290a 2020   meta=column).  
-00030780: 2020 6d69 6e73 2c20 6d61 7865 732c 206c    mins, maxes, l
-00030790: 656e 7320 3d20 636f 6d70 7574 6528 6d69  ens = compute(mi
-000307a0: 6e73 2c20 6d61 7865 732c 206c 656e 7329  ns, maxes, lens)
-000307b0: 0a20 2020 206d 696e 7320 3d20 6d69 6e73  .    mins = mins
-000307c0: 2e62 6669 6c6c 2829 2e74 6f6c 6973 7428  .bfill().tolist(
-000307d0: 290a 2020 2020 6d61 7865 7320 3d20 6d61  ).    maxes = ma
-000307e0: 7865 732e 6266 696c 6c28 292e 746f 6c69  xes.bfill().toli
-000307f0: 7374 2829 0a20 2020 206e 6f6e 5f65 6d70  st().    non_emp
-00030800: 7479 5f6d 696e 7320 3d20 5b6d 2066 6f72  ty_mins = [m for
-00030810: 206d 2c20 6c65 6e67 7468 2069 6e20 7a69   m, length in zi
-00030820: 7028 6d69 6e73 2c20 6c65 6e73 2920 6966  p(mins, lens) if
-00030830: 206c 656e 6774 6820 213d 2030 5d0a 2020   length != 0].  
-00030840: 2020 6e6f 6e5f 656d 7074 795f 6d61 7865    non_empty_maxe
-00030850: 7320 3d20 5b6d 2066 6f72 206d 2c20 6c65  s = [m for m, le
-00030860: 6e67 7468 2069 6e20 7a69 7028 6d61 7865  ngth in zip(maxe
-00030870: 732c 206c 656e 7329 2069 6620 6c65 6e67  s, lens) if leng
-00030880: 7468 2021 3d20 305d 0a20 2020 2069 6620  th != 0].    if 
-00030890: 280a 2020 2020 2020 2020 736f 7274 6564  (.        sorted
-000308a0: 286e 6f6e 5f65 6d70 7479 5f6d 696e 7329  (non_empty_mins)
-000308b0: 2021 3d20 6e6f 6e5f 656d 7074 795f 6d69   != non_empty_mi
-000308c0: 6e73 0a20 2020 2020 2020 206f 7220 736f  ns.        or so
-000308d0: 7274 6564 286e 6f6e 5f65 6d70 7479 5f6d  rted(non_empty_m
-000308e0: 6178 6573 2920 213d 206e 6f6e 5f65 6d70  axes) != non_emp
-000308f0: 7479 5f6d 6178 6573 0a20 2020 2029 3a0a  ty_maxes.    ):.
-00030900: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-00030910: 6c75 6545 7272 6f72 280a 2020 2020 2020  lueError(.      
-00030920: 2020 2020 2020 6622 5061 7274 6974 696f        f"Partitio
-00030930: 6e73 2061 7265 206e 6f74 2073 6f72 7465  ns are not sorte
-00030940: 6420 6173 6365 6e64 696e 6720 6279 207b  d ascending by {
-00030950: 636f 6c75 6d6e 2e6e 616d 6520 6f72 2027  column.name or '
-00030960: 7468 6520 696e 6465 7827 7d2e 2022 2c0a  the index'}. ",.
-00030970: 2020 2020 2020 2020 2020 2020 6622 496e              f"In
-00030980: 2079 6f75 7220 6461 7461 7365 7420 7468   your dataset th
-00030990: 6520 286d 696e 2c20 6d61 782c 206c 656e  e (min, max, len
-000309a0: 2920 7661 6c75 6573 206f 6620 7b63 6f6c  ) values of {col
-000309b0: 756d 6e2e 6e61 6d65 206f 7220 2774 6865  umn.name or 'the
-000309c0: 2069 6e64 6578 277d 2022 0a20 2020 2020   index'} ".     
-000309d0: 2020 2020 2020 2066 2266 6f72 2065 6163         f"for eac
-000309e0: 6820 7061 7274 6974 696f 6e20 6172 653a  h partition are:
-000309f0: 207b 6c69 7374 287a 6970 286d 696e 732c   {list(zip(mins,
-00030a00: 206d 6178 6573 2c20 6c65 6e73 2929 7d22   maxes, lens))}"
-00030a10: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-00030a20: 6966 206e 6f74 2061 6c6c 6f77 5f6f 7665  if not allow_ove
-00030a30: 726c 6170 2061 6e64 2061 6e79 280a 2020  rlap and any(.  
-00030a40: 2020 2020 2020 6120 3c3d 2062 2066 6f72        a <= b for
-00030a50: 2061 2c20 6220 696e 207a 6970 286e 6f6e   a, b in zip(non
-00030a60: 5f65 6d70 7479 5f6d 696e 735b 313a 5d2c  _empty_mins[1:],
-00030a70: 206e 6f6e 5f65 6d70 7479 5f6d 6178 6573   non_empty_maxes
-00030a80: 5b3a 2d31 5d29 0a20 2020 2029 3a0a 2020  [:-1]).    ):.  
-00030a90: 2020 2020 2020 7761 726e 696e 6773 2e77        warnings.w
-00030aa0: 6172 6e28 0a20 2020 2020 2020 2020 2020  arn(.           
-00030ab0: 2022 5061 7274 6974 696f 6e73 2068 6176   "Partitions hav
-00030ac0: 6520 6f76 6572 6c61 7070 696e 6720 7661  e overlapping va
-00030ad0: 6c75 6573 2c20 736f 2064 6976 6973 696f  lues, so divisio
-00030ae0: 6e73 2061 7265 206e 6f6e 2d75 6e69 7175  ns are non-uniqu
-00030af0: 652e 2022 0a20 2020 2020 2020 2020 2020  e. ".           
-00030b00: 2022 5573 6520 6073 6574 5f69 6e64 6578   "Use `set_index
-00030b10: 2873 6f72 7465 643d 5472 7565 2960 2077  (sorted=True)` w
-00030b20: 6974 6820 6e6f 2060 6469 7669 7369 6f6e  ith no `division
-00030b30: 7360 2074 6f20 616c 6c6f 7720 6461 736b  s` to allow dask
-00030b40: 2074 6f20 6669 7820 7468 6520 6f76 6572   to fix the over
-00030b50: 6c61 702e 2022 0a20 2020 2020 2020 2020  lap. ".         
-00030b60: 2020 2066 2249 6e20 796f 7572 2064 6174     f"In your dat
-00030b70: 6173 6574 2074 6865 2028 6d69 6e2c 206d  aset the (min, m
-00030b80: 6178 2c20 6c65 6e29 2076 616c 7565 7320  ax, len) values 
-00030b90: 6f66 207b 636f 6c75 6d6e 2e6e 616d 6520  of {column.name 
-00030ba0: 6f72 2027 7468 6520 696e 6465 7827 7d20  or 'the index'} 
-00030bb0: 220a 2020 2020 2020 2020 2020 2020 6622  ".            f"
-00030bc0: 666f 7220 6561 6368 2070 6172 7469 7469  for each partiti
-00030bd0: 6f6e 2061 7265 203a 207b 6c69 7374 287a  on are : {list(z
-00030be0: 6970 286d 696e 732c 206d 6178 6573 2c20  ip(mins, maxes, 
-00030bf0: 6c65 6e73 2929 7d22 2c0a 2020 2020 2020  lens))}",.      
-00030c00: 2020 2020 2020 5573 6572 5761 726e 696e        UserWarnin
-00030c10: 672c 0a20 2020 2020 2020 2029 0a20 2020  g,.        ).   
-00030c20: 206c 656e 7320 3d20 6d65 7468 6f64 732e   lens = methods.
-00030c30: 746f 6c69 7374 286c 656e 7329 0a20 2020  tolist(lens).   
-00030c40: 2069 6620 6e6f 7420 616c 6c6f 775f 6f76   if not allow_ov
-00030c50: 6572 6c61 703a 0a20 2020 2020 2020 2072  erlap:.        r
-00030c60: 6574 7572 6e20 286d 696e 732c 206d 6178  eturn (mins, max
-00030c70: 6573 2c20 6c65 6e73 290a 2020 2020 656c  es, lens).    el
-00030c80: 7365 3a0a 2020 2020 2020 2020 7265 7475  se:.        retu
-00030c90: 726e 2028 6e6f 6e5f 656d 7074 795f 6d69  rn (non_empty_mi
-00030ca0: 6e73 2c20 6e6f 6e5f 656d 7074 795f 6d61  ns, non_empty_ma
-00030cb0: 7865 732c 206c 656e 7329 0a              xes, lens).
+0000ea30: 6566 2061 6e79 2873 656c 662c 2061 7869  ef any(self, axi
+0000ea40: 733d 302c 2073 6b69 706e 613d 5472 7565  s=0, skipna=True
+0000ea50: 2c20 7370 6c69 745f 6576 6572 793d 4661  , split_every=Fa
+0000ea60: 6c73 652c 202a 2a6b 7761 7267 7329 3a0a  lse, **kwargs):.
+0000ea70: 2020 2020 2020 2020 6178 6973 203d 2073          axis = s
+0000ea80: 656c 662e 5f76 616c 6964 6174 655f 6178  elf._validate_ax
+0000ea90: 6973 2861 7869 7329 0a20 2020 2020 2020  is(axis).       
+0000eaa0: 2069 6620 6178 6973 203d 3d20 313a 0a20   if axis == 1:. 
+0000eab0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0000eac0: 6e20 7365 6c66 2e6d 6170 5f70 6172 7469  n self.map_parti
+0000ead0: 7469 6f6e 7328 4d2e 616e 792c 2073 6b69  tions(M.any, ski
+0000eae0: 706e 613d 736b 6970 6e61 2c20 6178 6973  pna=skipna, axis
+0000eaf0: 3d61 7869 7329 0a20 2020 2020 2020 2072  =axis).        r
+0000eb00: 6574 7572 6e20 6e65 775f 636f 6c6c 6563  eturn new_collec
+0000eb10: 7469 6f6e 2873 656c 662e 6578 7072 2e61  tion(self.expr.a
+0000eb20: 6e79 2873 6b69 706e 612c 2073 706c 6974  ny(skipna, split
+0000eb30: 5f65 7665 7279 2929 0a0a 2020 2020 4064  _every))..    @d
+0000eb40: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
+0000eb50: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
+0000eb60: 6620 616c 6c28 7365 6c66 2c20 6178 6973  f all(self, axis
+0000eb70: 3d30 2c20 736b 6970 6e61 3d54 7275 652c  =0, skipna=True,
+0000eb80: 2073 706c 6974 5f65 7665 7279 3d46 616c   split_every=Fal
+0000eb90: 7365 2c20 2a2a 6b77 6172 6773 293a 0a20  se, **kwargs):. 
+0000eba0: 2020 2020 2020 2061 7869 7320 3d20 7365         axis = se
+0000ebb0: 6c66 2e5f 7661 6c69 6461 7465 5f61 7869  lf._validate_axi
+0000ebc0: 7328 6178 6973 290a 2020 2020 2020 2020  s(axis).        
+0000ebd0: 6966 2061 7869 7320 3d3d 2031 3a0a 2020  if axis == 1:.  
+0000ebe0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0000ebf0: 2073 656c 662e 6d61 705f 7061 7274 6974   self.map_partit
+0000ec00: 696f 6e73 284d 2e61 6c6c 2c20 736b 6970  ions(M.all, skip
+0000ec10: 6e61 3d73 6b69 706e 612c 2061 7869 733d  na=skipna, axis=
+0000ec20: 6178 6973 290a 2020 2020 2020 2020 7265  axis).        re
+0000ec30: 7475 726e 206e 6577 5f63 6f6c 6c65 6374  turn new_collect
+0000ec40: 696f 6e28 7365 6c66 2e65 7870 722e 616c  ion(self.expr.al
+0000ec50: 6c28 736b 6970 6e61 2c20 7370 6c69 745f  l(skipna, split_
+0000ec60: 6576 6572 7929 290a 0a20 2020 2040 6465  every))..    @de
+0000ec70: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
+0000ec80: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
+0000ec90: 2069 6478 6d69 6e28 7365 6c66 2c20 6178   idxmin(self, ax
+0000eca0: 6973 3d30 2c20 736b 6970 6e61 3d54 7275  is=0, skipna=Tru
+0000ecb0: 652c 206e 756d 6572 6963 5f6f 6e6c 793d  e, numeric_only=
+0000ecc0: 4661 6c73 652c 2073 706c 6974 5f65 7665  False, split_eve
+0000ecd0: 7279 3d46 616c 7365 293a 0a20 2020 2020  ry=False):.     
+0000ece0: 2020 2061 7869 7320 3d20 7365 6c66 2e5f     axis = self._
+0000ecf0: 7661 6c69 6461 7465 5f61 7869 7328 6178  validate_axis(ax
+0000ed00: 6973 290a 2020 2020 2020 2020 6966 2061  is).        if a
+0000ed10: 7869 7320 3d3d 2031 3a0a 2020 2020 2020  xis == 1:.      
+0000ed20: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0000ed30: 662e 6d61 705f 7061 7274 6974 696f 6e73  f.map_partitions
+0000ed40: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0000ed50: 2020 4d2e 6964 786d 696e 2c20 736b 6970    M.idxmin, skip
+0000ed60: 6e61 3d73 6b69 706e 612c 206e 756d 6572  na=skipna, numer
+0000ed70: 6963 5f6f 6e6c 793d 6e75 6d65 7269 635f  ic_only=numeric_
+0000ed80: 6f6e 6c79 2c20 6178 6973 3d61 7869 730a  only, axis=axis.
+0000ed90: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0000eda0: 2020 2020 2020 7265 7475 726e 206e 6577        return new
+0000edb0: 5f63 6f6c 6c65 6374 696f 6e28 7365 6c66  _collection(self
+0000edc0: 2e65 7870 722e 6964 786d 696e 2873 6b69  .expr.idxmin(ski
+0000edd0: 706e 612c 206e 756d 6572 6963 5f6f 6e6c  pna, numeric_onl
+0000ede0: 792c 2073 706c 6974 5f65 7665 7279 2929  y, split_every))
+0000edf0: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
+0000ee00: 726f 6d28 7064 2e44 6174 6146 7261 6d65  rom(pd.DataFrame
+0000ee10: 290a 2020 2020 6465 6620 6964 786d 6178  ).    def idxmax
+0000ee20: 2873 656c 662c 2061 7869 733d 302c 2073  (self, axis=0, s
+0000ee30: 6b69 706e 613d 5472 7565 2c20 6e75 6d65  kipna=True, nume
+0000ee40: 7269 635f 6f6e 6c79 3d46 616c 7365 2c20  ric_only=False, 
+0000ee50: 7370 6c69 745f 6576 6572 793d 4661 6c73  split_every=Fals
+0000ee60: 6529 3a0a 2020 2020 2020 2020 6178 6973  e):.        axis
+0000ee70: 203d 2073 656c 662e 5f76 616c 6964 6174   = self._validat
+0000ee80: 655f 6178 6973 2861 7869 7329 0a20 2020  e_axis(axis).   
+0000ee90: 2020 2020 2069 6620 6178 6973 203d 3d20       if axis == 
+0000eea0: 313a 0a20 2020 2020 2020 2020 2020 2072  1:.            r
+0000eeb0: 6574 7572 6e20 7365 6c66 2e6d 6170 5f70  eturn self.map_p
+0000eec0: 6172 7469 7469 6f6e 7328 0a20 2020 2020  artitions(.     
+0000eed0: 2020 2020 2020 2020 2020 204d 2e69 6478             M.idx
+0000eee0: 6d61 782c 2073 6b69 706e 613d 736b 6970  max, skipna=skip
+0000eef0: 6e61 2c20 6e75 6d65 7269 635f 6f6e 6c79  na, numeric_only
+0000ef00: 3d6e 756d 6572 6963 5f6f 6e6c 792c 2061  =numeric_only, a
+0000ef10: 7869 733d 6178 6973 0a20 2020 2020 2020  xis=axis.       
+0000ef20: 2020 2020 2029 0a20 2020 2020 2020 2072       ).        r
+0000ef30: 6574 7572 6e20 6e65 775f 636f 6c6c 6563  eturn new_collec
+0000ef40: 7469 6f6e 2873 656c 662e 6578 7072 2e69  tion(self.expr.i
+0000ef50: 6478 6d61 7828 736b 6970 6e61 2c20 6e75  dxmax(skipna, nu
+0000ef60: 6d65 7269 635f 6f6e 6c79 2c20 7370 6c69  meric_only, spli
+0000ef70: 745f 6576 6572 7929 290a 0a20 2020 2040  t_every))..    @
+0000ef80: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
+0000ef90: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
+0000efa0: 6566 206d 696e 2873 656c 662c 2061 7869  ef min(self, axi
+0000efb0: 733d 302c 2073 6b69 706e 613d 5472 7565  s=0, skipna=True
+0000efc0: 2c20 6e75 6d65 7269 635f 6f6e 6c79 3d46  , numeric_only=F
+0000efd0: 616c 7365 2c20 7370 6c69 745f 6576 6572  alse, split_ever
+0000efe0: 793d 4661 6c73 652c 202a 2a6b 7761 7267  y=False, **kwarg
+0000eff0: 7329 3a0a 2020 2020 2020 2020 6178 6973  s):.        axis
+0000f000: 203d 2073 656c 662e 5f76 616c 6964 6174   = self._validat
+0000f010: 655f 6178 6973 2861 7869 7329 0a20 2020  e_axis(axis).   
+0000f020: 2020 2020 2069 6620 6178 6973 203d 3d20       if axis == 
+0000f030: 313a 0a20 2020 2020 2020 2020 2020 2072  1:.            r
+0000f040: 6574 7572 6e20 7365 6c66 2e6d 6170 5f70  eturn self.map_p
+0000f050: 6172 7469 7469 6f6e 7328 0a20 2020 2020  artitions(.     
+0000f060: 2020 2020 2020 2020 2020 204d 2e6d 696e             M.min
+0000f070: 2c20 736b 6970 6e61 3d73 6b69 706e 612c  , skipna=skipna,
+0000f080: 206e 756d 6572 6963 5f6f 6e6c 793d 6e75   numeric_only=nu
+0000f090: 6d65 7269 635f 6f6e 6c79 2c20 6178 6973  meric_only, axis
+0000f0a0: 3d61 7869 730a 2020 2020 2020 2020 2020  =axis.          
+0000f0b0: 2020 290a 2020 2020 2020 2020 7265 7475    ).        retu
+0000f0c0: 726e 206e 6577 5f63 6f6c 6c65 6374 696f  rn new_collectio
+0000f0d0: 6e28 7365 6c66 2e65 7870 722e 6d69 6e28  n(self.expr.min(
+0000f0e0: 736b 6970 6e61 2c20 6e75 6d65 7269 635f  skipna, numeric_
+0000f0f0: 6f6e 6c79 2c20 7370 6c69 745f 6576 6572  only, split_ever
+0000f100: 792c 2061 7869 7329 290a 0a20 2020 2040  y, axis))..    @
+0000f110: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
+0000f120: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
+0000f130: 6566 2063 6f75 6e74 2873 656c 662c 2061  ef count(self, a
+0000f140: 7869 733d 302c 206e 756d 6572 6963 5f6f  xis=0, numeric_o
+0000f150: 6e6c 793d 4661 6c73 652c 2073 706c 6974  nly=False, split
+0000f160: 5f65 7665 7279 3d46 616c 7365 293a 0a20  _every=False):. 
+0000f170: 2020 2020 2020 2061 7869 7320 3d20 7365         axis = se
+0000f180: 6c66 2e5f 7661 6c69 6461 7465 5f61 7869  lf._validate_axi
+0000f190: 7328 6178 6973 290a 2020 2020 2020 2020  s(axis).        
+0000f1a0: 6966 2061 7869 7320 3d3d 2031 3a0a 2020  if axis == 1:.  
+0000f1b0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0000f1c0: 2073 656c 662e 6d61 705f 7061 7274 6974   self.map_partit
+0000f1d0: 696f 6e73 284d 2e63 6f75 6e74 2c20 6e75  ions(M.count, nu
+0000f1e0: 6d65 7269 635f 6f6e 6c79 3d6e 756d 6572  meric_only=numer
+0000f1f0: 6963 5f6f 6e6c 792c 2061 7869 733d 6178  ic_only, axis=ax
+0000f200: 6973 290a 2020 2020 2020 2020 7265 7475  is).        retu
+0000f210: 726e 206e 6577 5f63 6f6c 6c65 6374 696f  rn new_collectio
+0000f220: 6e28 7365 6c66 2e65 7870 722e 636f 756e  n(self.expr.coun
+0000f230: 7428 6e75 6d65 7269 635f 6f6e 6c79 2c20  t(numeric_only, 
+0000f240: 7370 6c69 745f 6576 6572 7929 290a 0a20  split_every)).. 
+0000f250: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
+0000f260: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
+0000f270: 2020 2064 6566 2061 6273 2873 656c 6629     def abs(self)
+0000f280: 3a0a 2020 2020 2020 2020 2320 5261 6973  :.        # Rais
+0000f290: 6520 7061 6e64 6173 2065 7272 6f72 730a  e pandas errors.
+0000f2a0: 2020 2020 2020 2020 5f72 6169 7365 5f69          _raise_i
+0000f2b0: 665f 6f62 6a65 6374 5f73 6572 6965 7328  f_object_series(
+0000f2c0: 7365 6c66 2c20 2261 6273 2229 0a20 2020  self, "abs").   
+0000f2d0: 2020 2020 206d 6574 615f 6e6f 6e65 6d70       meta_nonemp
+0000f2e0: 7479 2873 656c 662e 5f6d 6574 6129 2e61  ty(self._meta).a
+0000f2f0: 6273 2829 0a20 2020 2020 2020 2072 6574  bs().        ret
+0000f300: 7572 6e20 6e65 775f 636f 6c6c 6563 7469  urn new_collecti
+0000f310: 6f6e 2873 656c 662e 6578 7072 2e61 6273  on(self.expr.abs
+0000f320: 2829 290a 0a20 2020 2040 6465 7269 7665  ())..    @derive
+0000f330: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
+0000f340: 616d 6529 0a20 2020 2064 6566 2061 7374  ame).    def ast
+0000f350: 7970 6528 7365 6c66 2c20 6474 7970 6573  ype(self, dtypes
+0000f360: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+0000f370: 6e20 6e65 775f 636f 6c6c 6563 7469 6f6e  n new_collection
+0000f380: 2873 656c 662e 6578 7072 2e61 7374 7970  (self.expr.astyp
+0000f390: 6528 6474 7970 6573 2929 0a0a 2020 2020  e(dtypes))..    
+0000f3a0: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
+0000f3b0: 2e44 6174 6146 7261 6d65 290a 2020 2020  .DataFrame).    
+0000f3c0: 6465 6620 636f 6d62 696e 655f 6669 7273  def combine_firs
+0000f3d0: 7428 7365 6c66 2c20 6f74 6865 7229 3a0a  t(self, other):.
+0000f3e0: 2020 2020 2020 2020 6f74 6865 7220 3d20          other = 
+0000f3f0: 7365 6c66 2e5f 6372 6561 7465 5f61 6c69  self._create_ali
+0000f400: 676e 6162 6c65 5f66 7261 6d65 286f 7468  gnable_frame(oth
+0000f410: 6572 2c20 226f 7574 6572 2229 2e65 7870  er, "outer").exp
+0000f420: 720a 2020 2020 2020 2020 7265 7475 726e  r.        return
+0000f430: 206e 6577 5f63 6f6c 6c65 6374 696f 6e28   new_collection(
+0000f440: 7365 6c66 2e65 7870 722e 636f 6d62 696e  self.expr.combin
+0000f450: 655f 6669 7273 7428 6f74 6865 7229 290a  e_first(other)).
+0000f460: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
+0000f470: 6f6d 2870 642e 4461 7461 4672 616d 6529  om(pd.DataFrame)
+0000f480: 0a20 2020 2064 6566 2074 6f5f 7469 6d65  .    def to_time
+0000f490: 7374 616d 7028 7365 6c66 2c20 6672 6571  stamp(self, freq
+0000f4a0: 3d4e 6f6e 652c 2068 6f77 3d22 7374 6172  =None, how="star
+0000f4b0: 7422 293a 0a20 2020 2020 2020 2072 6574  t"):.        ret
+0000f4c0: 7572 6e20 6e65 775f 636f 6c6c 6563 7469  urn new_collecti
+0000f4d0: 6f6e 2873 656c 662e 6578 7072 2e74 6f5f  on(self.expr.to_
+0000f4e0: 7469 6d65 7374 616d 7028 6672 6571 2c20  timestamp(freq, 
+0000f4f0: 686f 7729 290a 0a20 2020 2040 6465 7269  how))..    @deri
+0000f500: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
+0000f510: 4672 616d 6529 0a20 2020 2064 6566 2069  Frame).    def i
+0000f520: 736e 6128 7365 6c66 293a 0a20 2020 2020  sna(self):.     
+0000f530: 2020 2072 6574 7572 6e20 6e65 775f 636f     return new_co
+0000f540: 6c6c 6563 7469 6f6e 2873 656c 662e 6578  llection(self.ex
+0000f550: 7072 2e69 736e 6128 2929 0a0a 2020 2020  pr.isna())..    
+0000f560: 6465 6620 7261 6e64 6f6d 5f73 706c 6974  def random_split
+0000f570: 2873 656c 662c 2066 7261 632c 2072 616e  (self, frac, ran
+0000f580: 646f 6d5f 7374 6174 653d 4e6f 6e65 2c20  dom_state=None, 
+0000f590: 7368 7566 666c 653d 4661 6c73 6529 3a0a  shuffle=False):.
+0000f5a0: 2020 2020 2020 2020 2222 2250 7365 7564          """Pseud
+0000f5b0: 6f72 616e 646f 6d6c 7920 7370 6c69 7420  orandomly split 
+0000f5c0: 6461 7461 6672 616d 6520 696e 746f 2064  dataframe into d
+0000f5d0: 6966 6665 7265 6e74 2070 6965 6365 7320  ifferent pieces 
+0000f5e0: 726f 772d 7769 7365 0a0a 2020 2020 2020  row-wise..      
+0000f5f0: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
+0000f600: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
+0000f610: 2020 2020 2020 2020 6672 6163 203a 206c          frac : l
+0000f620: 6973 740a 2020 2020 2020 2020 2020 2020  ist.            
+0000f630: 4c69 7374 206f 6620 666c 6f61 7473 2074  List of floats t
+0000f640: 6861 7420 7368 6f75 6c64 2073 756d 2074  hat should sum t
+0000f650: 6f20 6f6e 652e 0a20 2020 2020 2020 2072  o one..        r
+0000f660: 616e 646f 6d5f 7374 6174 6520 3a20 696e  andom_state : in
+0000f670: 7420 6f72 206e 702e 7261 6e64 6f6d 2e52  t or np.random.R
+0000f680: 616e 646f 6d53 7461 7465 0a20 2020 2020  andomState.     
+0000f690: 2020 2020 2020 2049 6620 696e 7420 6f72         If int or
+0000f6a0: 204e 6f6e 6520 6372 6561 7465 2061 206e   None create a n
+0000f6b0: 6577 2052 616e 646f 6d53 7461 7465 2077  ew RandomState w
+0000f6c0: 6974 6820 7468 6973 2061 7320 7468 6520  ith this as the 
+0000f6d0: 7365 6564 2e0a 2020 2020 2020 2020 2020  seed..          
+0000f6e0: 2020 4f74 6865 7277 6973 6520 6472 6177    Otherwise draw
+0000f6f0: 2066 726f 6d20 7468 6520 7061 7373 6564   from the passed
+0000f700: 2052 616e 646f 6d53 7461 7465 2e0a 2020   RandomState..  
+0000f710: 2020 2020 2020 7368 7566 666c 6520 3a20        shuffle : 
+0000f720: 626f 6f6c 2c20 6465 6661 756c 7420 4661  bool, default Fa
+0000f730: 6c73 650a 2020 2020 2020 2020 2020 2020  lse.            
+0000f740: 4966 2073 6574 2074 6f20 5472 7565 2c20  If set to True, 
+0000f750: 7468 6520 6461 7461 6672 616d 6520 6973  the dataframe is
+0000f760: 2073 6875 6666 6c65 6420 2877 6974 6869   shuffled (withi
+0000f770: 6e20 7061 7274 6974 696f 6e29 0a20 2020  n partition).   
+0000f780: 2020 2020 2020 2020 2062 6566 6f72 6520           before 
+0000f790: 7468 6520 7370 6c69 742e 0a0a 2020 2020  the split...    
+0000f7a0: 2020 2020 4578 616d 706c 6573 0a20 2020      Examples.   
+0000f7b0: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 0a20       --------.. 
+0000f7c0: 2020 2020 2020 2035 302f 3530 2073 706c         50/50 spl
+0000f7d0: 6974 0a0a 2020 2020 2020 2020 3e3e 3e20  it..        >>> 
+0000f7e0: 612c 2062 203d 2064 662e 7261 6e64 6f6d  a, b = df.random
+0000f7f0: 5f73 706c 6974 285b 302e 352c 2030 2e35  _split([0.5, 0.5
+0000f800: 5d29 2020 2320 646f 6374 6573 743a 202b  ])  # doctest: +
+0000f810: 534b 4950 0a0a 2020 2020 2020 2020 3830  SKIP..        80
+0000f820: 2f31 302f 3130 2073 706c 6974 2c20 636f  /10/10 split, co
+0000f830: 6e73 6973 7465 6e74 2072 616e 646f 6d5f  nsistent random_
+0000f840: 7374 6174 650a 0a20 2020 2020 2020 203e  state..        >
+0000f850: 3e3e 2061 2c20 622c 2063 203d 2064 662e  >> a, b, c = df.
+0000f860: 7261 6e64 6f6d 5f73 706c 6974 285b 302e  random_split([0.
+0000f870: 382c 2030 2e31 2c20 302e 315d 2c20 7261  8, 0.1, 0.1], ra
+0000f880: 6e64 6f6d 5f73 7461 7465 3d31 3233 2920  ndom_state=123) 
+0000f890: 2023 2064 6f63 7465 7374 3a20 2b53 4b49   # doctest: +SKI
+0000f8a0: 500a 0a20 2020 2020 2020 2053 6565 2041  P..        See A
+0000f8b0: 6c73 6f0a 2020 2020 2020 2020 2d2d 2d2d  lso.        ----
+0000f8c0: 2d2d 2d2d 0a20 2020 2020 2020 2064 6173  ----.        das
+0000f8d0: 6b2e 4461 7461 4672 616d 652e 7361 6d70  k.DataFrame.samp
+0000f8e0: 6c65 0a20 2020 2020 2020 2022 2222 0a20  le.        """. 
+0000f8f0: 2020 2020 2020 2069 6620 6e6f 7420 6e70         if not np
+0000f900: 2e61 6c6c 636c 6f73 6528 7375 6d28 6672  .allclose(sum(fr
+0000f910: 6163 292c 2031 293a 0a20 2020 2020 2020  ac), 1):.       
+0000f920: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+0000f930: 4572 726f 7228 2266 7261 6320 7368 6f75  Error("frac shou
+0000f940: 6c64 2073 756d 2074 6f20 3122 290a 2020  ld sum to 1").  
+0000f950: 2020 2020 2020 6672 616d 6520 3d20 6578        frame = ex
+0000f960: 7072 2e53 706c 6974 2873 656c 662c 2066  pr.Split(self, f
+0000f970: 7261 632c 2072 616e 646f 6d5f 7374 6174  rac, random_stat
+0000f980: 652c 2073 6875 6666 6c65 290a 0a20 2020  e, shuffle)..   
+0000f990: 2020 2020 206f 7574 203d 205b 5d0a 2020       out = [].  
+0000f9a0: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
+0000f9b0: 616e 6765 286c 656e 2866 7261 6329 293a  ange(len(frac)):
+0000f9c0: 0a20 2020 2020 2020 2020 2020 206f 7574  .            out
+0000f9d0: 2e61 7070 656e 6428 6e65 775f 636f 6c6c  .append(new_coll
+0000f9e0: 6563 7469 6f6e 2865 7870 722e 5370 6c69  ection(expr.Spli
+0000f9f0: 7454 616b 6528 6672 616d 652c 2069 2c20  tTake(frame, i, 
+0000fa00: 7365 6c66 2e6e 6469 6d29 2929 0a20 2020  self.ndim))).   
+0000fa10: 2020 2020 2072 6574 7572 6e20 6f75 740a       return out.
+0000fa20: 0a20 2020 2064 6566 2069 736e 756c 6c28  .    def isnull(
+0000fa30: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
+0000fa40: 6574 7572 6e20 6e65 775f 636f 6c6c 6563  eturn new_collec
+0000fa50: 7469 6f6e 2873 656c 662e 6578 7072 2e69  tion(self.expr.i
+0000fa60: 736e 756c 6c28 2929 0a0a 2020 2020 4064  snull())..    @d
+0000fa70: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
+0000fa80: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
+0000fa90: 6620 726f 756e 6428 7365 6c66 2c20 6465  f round(self, de
+0000faa0: 6369 6d61 6c73 3d30 293a 0a20 2020 2020  cimals=0):.     
+0000fab0: 2020 2072 6574 7572 6e20 6e65 775f 636f     return new_co
+0000fac0: 6c6c 6563 7469 6f6e 2873 656c 662e 6578  llection(self.ex
+0000fad0: 7072 2e72 6f75 6e64 2864 6563 696d 616c  pr.round(decimal
+0000fae0: 7329 290a 0a20 2020 2040 6465 7269 7665  s))..    @derive
+0000faf0: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
+0000fb00: 616d 6529 0a20 2020 2064 6566 2077 6865  ame).    def whe
+0000fb10: 7265 2873 656c 662c 2063 6f6e 642c 206f  re(self, cond, o
+0000fb20: 7468 6572 3d6e 702e 6e61 6e29 3a0a 2020  ther=np.nan):.  
+0000fb30: 2020 2020 2020 636f 6e64 203d 2073 656c        cond = sel
+0000fb40: 662e 5f63 7265 6174 655f 616c 6967 6e61  f._create_aligna
+0000fb50: 626c 655f 6672 616d 6528 636f 6e64 290a  ble_frame(cond).
+0000fb60: 2020 2020 2020 2020 6f74 6865 7220 3d20          other = 
+0000fb70: 7365 6c66 2e5f 6372 6561 7465 5f61 6c69  self._create_ali
+0000fb80: 676e 6162 6c65 5f66 7261 6d65 286f 7468  gnable_frame(oth
+0000fb90: 6572 290a 2020 2020 2020 2020 636f 6e64  er).        cond
+0000fba0: 203d 2063 6f6e 642e 6578 7072 2069 6620   = cond.expr if 
+0000fbb0: 6973 696e 7374 616e 6365 2863 6f6e 642c  isinstance(cond,
+0000fbc0: 2046 7261 6d65 4261 7365 2920 656c 7365   FrameBase) else
+0000fbd0: 2063 6f6e 640a 2020 2020 2020 2020 6f74   cond.        ot
+0000fbe0: 6865 7220 3d20 6f74 6865 722e 6578 7072  her = other.expr
+0000fbf0: 2069 6620 6973 696e 7374 616e 6365 286f   if isinstance(o
+0000fc00: 7468 6572 2c20 4672 616d 6542 6173 6529  ther, FrameBase)
+0000fc10: 2065 6c73 6520 6f74 6865 720a 2020 2020   else other.    
+0000fc20: 2020 2020 7265 7475 726e 206e 6577 5f63      return new_c
+0000fc30: 6f6c 6c65 6374 696f 6e28 7365 6c66 2e65  ollection(self.e
+0000fc40: 7870 722e 7768 6572 6528 636f 6e64 2c20  xpr.where(cond, 
+0000fc50: 6f74 6865 7229 290a 0a20 2020 2040 6465  other))..    @de
+0000fc60: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
+0000fc70: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
+0000fc80: 206d 6173 6b28 7365 6c66 2c20 636f 6e64   mask(self, cond
+0000fc90: 2c20 6f74 6865 723d 6e70 2e6e 616e 293a  , other=np.nan):
+0000fca0: 0a20 2020 2020 2020 2063 6f6e 6420 3d20  .        cond = 
+0000fcb0: 7365 6c66 2e5f 6372 6561 7465 5f61 6c69  self._create_ali
+0000fcc0: 676e 6162 6c65 5f66 7261 6d65 2863 6f6e  gnable_frame(con
+0000fcd0: 6429 0a20 2020 2020 2020 206f 7468 6572  d).        other
+0000fce0: 203d 2073 656c 662e 5f63 7265 6174 655f   = self._create_
+0000fcf0: 616c 6967 6e61 626c 655f 6672 616d 6528  alignable_frame(
+0000fd00: 6f74 6865 7229 0a20 2020 2020 2020 2063  other).        c
+0000fd10: 6f6e 6420 3d20 636f 6e64 2e65 7870 7220  ond = cond.expr 
+0000fd20: 6966 2069 7369 6e73 7461 6e63 6528 636f  if isinstance(co
+0000fd30: 6e64 2c20 4672 616d 6542 6173 6529 2065  nd, FrameBase) e
+0000fd40: 6c73 6520 636f 6e64 0a20 2020 2020 2020  lse cond.       
+0000fd50: 206f 7468 6572 203d 206f 7468 6572 2e65   other = other.e
+0000fd60: 7870 7220 6966 2069 7369 6e73 7461 6e63  xpr if isinstanc
+0000fd70: 6528 6f74 6865 722c 2046 7261 6d65 4261  e(other, FrameBa
+0000fd80: 7365 2920 656c 7365 206f 7468 6572 0a20  se) else other. 
+0000fd90: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
+0000fda0: 775f 636f 6c6c 6563 7469 6f6e 2873 656c  w_collection(sel
+0000fdb0: 662e 6578 7072 2e6d 6173 6b28 636f 6e64  f.expr.mask(cond
+0000fdc0: 2c20 6f74 6865 7229 290a 0a20 2020 2040  , other))..    @
+0000fdd0: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
+0000fde0: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
+0000fdf0: 6566 2072 6570 6c61 6365 2873 656c 662c  ef replace(self,
+0000fe00: 2074 6f5f 7265 706c 6163 653d 4e6f 6e65   to_replace=None
+0000fe10: 2c20 7661 6c75 653d 6e6f 5f64 6566 6175  , value=no_defau
+0000fe20: 6c74 2c20 7265 6765 783d 4661 6c73 6529  lt, regex=False)
+0000fe30: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+0000fe40: 206e 6577 5f63 6f6c 6c65 6374 696f 6e28   new_collection(
+0000fe50: 7365 6c66 2e65 7870 722e 7265 706c 6163  self.expr.replac
+0000fe60: 6528 746f 5f72 6570 6c61 6365 2c20 7661  e(to_replace, va
+0000fe70: 6c75 652c 2072 6567 6578 2929 0a0a 2020  lue, regex))..  
+0000fe80: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
+0000fe90: 7064 2e44 6174 6146 7261 6d65 290a 2020  pd.DataFrame).  
+0000fea0: 2020 6465 6620 6666 696c 6c28 7365 6c66    def ffill(self
+0000feb0: 2c20 6178 6973 3d30 2c20 6c69 6d69 743d  , axis=0, limit=
+0000fec0: 4e6f 6e65 293a 0a20 2020 2020 2020 2061  None):.        a
+0000fed0: 7869 7320 3d20 5f76 616c 6964 6174 655f  xis = _validate_
+0000fee0: 6178 6973 2861 7869 7329 0a20 2020 2020  axis(axis).     
+0000fef0: 2020 2069 6620 6178 6973 203d 3d20 313a     if axis == 1:
+0000ff00: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0000ff10: 7572 6e20 7365 6c66 2e6d 6170 5f70 6172  urn self.map_par
+0000ff20: 7469 7469 6f6e 7328 4d2e 6666 696c 6c2c  titions(M.ffill,
+0000ff30: 2061 7869 733d 6178 6973 2c20 6c69 6d69   axis=axis, limi
+0000ff40: 743d 6c69 6d69 7429 0a20 2020 2020 2020  t=limit).       
+0000ff50: 2066 7261 6d65 203d 2073 656c 660a 2020   frame = self.  
+0000ff60: 2020 2020 2020 6966 206c 696d 6974 2069        if limit i
+0000ff70: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+0000ff80: 2020 2020 6672 616d 6520 3d20 4669 6c6c      frame = Fill
+0000ff90: 6e61 4368 6563 6b28 7365 6c66 2c20 2266  naCheck(self, "f
+0000ffa0: 6669 6c6c 222c 206c 616d 6264 6120 783a  fill", lambda x:
+0000ffb0: 2030 290a 2020 2020 2020 2020 7265 7475   0).        retu
+0000ffc0: 726e 206e 6577 5f63 6f6c 6c65 6374 696f  rn new_collectio
+0000ffd0: 6e28 4646 696c 6c28 6672 616d 652c 206c  n(FFill(frame, l
+0000ffe0: 696d 6974 2929 0a0a 2020 2020 4064 6572  imit))..    @der
+0000fff0: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
+00010000: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
+00010010: 6266 696c 6c28 7365 6c66 2c20 6178 6973  bfill(self, axis
+00010020: 3d30 2c20 6c69 6d69 743d 4e6f 6e65 293a  =0, limit=None):
+00010030: 0a20 2020 2020 2020 2061 7869 7320 3d20  .        axis = 
+00010040: 5f76 616c 6964 6174 655f 6178 6973 2861  _validate_axis(a
+00010050: 7869 7329 0a20 2020 2020 2020 2069 6620  xis).        if 
+00010060: 6178 6973 203d 3d20 313a 0a20 2020 2020  axis == 1:.     
+00010070: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00010080: 6c66 2e6d 6170 5f70 6172 7469 7469 6f6e  lf.map_partition
+00010090: 7328 4d2e 6266 696c 6c2c 2061 7869 733d  s(M.bfill, axis=
+000100a0: 6178 6973 2c20 6c69 6d69 743d 6c69 6d69  axis, limit=limi
+000100b0: 7429 0a20 2020 2020 2020 2066 7261 6d65  t).        frame
+000100c0: 203d 2073 656c 660a 2020 2020 2020 2020   = self.        
+000100d0: 6966 206c 696d 6974 2069 7320 4e6f 6e65  if limit is None
+000100e0: 3a0a 2020 2020 2020 2020 2020 2020 6672  :.            fr
+000100f0: 616d 6520 3d20 4669 6c6c 6e61 4368 6563  ame = FillnaChec
+00010100: 6b28 7365 6c66 2c20 2262 6669 6c6c 222c  k(self, "bfill",
+00010110: 206c 616d 6264 6120 783a 2078 2e6e 7061   lambda x: x.npa
+00010120: 7274 6974 696f 6e73 202d 2031 290a 2020  rtitions - 1).  
+00010130: 2020 2020 2020 7265 7475 726e 206e 6577        return new
+00010140: 5f63 6f6c 6c65 6374 696f 6e28 4246 696c  _collection(BFil
+00010150: 6c28 6672 616d 652c 206c 696d 6974 2929  l(frame, limit))
+00010160: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
+00010170: 726f 6d28 7064 2e44 6174 6146 7261 6d65  rom(pd.DataFrame
+00010180: 290a 2020 2020 6465 6620 6669 6c6c 6e61  ).    def fillna
+00010190: 2873 656c 662c 2076 616c 7565 3d4e 6f6e  (self, value=Non
+000101a0: 652c 2061 7869 733d 4e6f 6e65 293a 0a20  e, axis=None):. 
+000101b0: 2020 2020 2020 2061 7869 7320 3d20 7365         axis = se
+000101c0: 6c66 2e5f 7661 6c69 6461 7465 5f61 7869  lf._validate_axi
+000101d0: 7328 6178 6973 290a 2020 2020 2020 2020  s(axis).        
+000101e0: 6966 2061 7869 7320 3d3d 2031 3a0a 2020  if axis == 1:.  
+000101f0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00010200: 2073 656c 662e 6d61 705f 7061 7274 6974   self.map_partit
+00010210: 696f 6e73 284d 2e66 696c 6c6e 612c 2076  ions(M.fillna, v
+00010220: 616c 7565 2c20 6178 6973 3d61 7869 7329  alue, axis=axis)
+00010230: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
+00010240: 7374 616e 6365 2876 616c 7565 2c20 4672  stance(value, Fr
+00010250: 616d 6542 6173 6529 3a0a 2020 2020 2020  ameBase):.      
+00010260: 2020 2020 2020 7661 6c75 6520 3d20 7661        value = va
+00010270: 6c75 652e 6578 7072 0a20 2020 2020 2020  lue.expr.       
+00010280: 2072 6574 7572 6e20 6e65 775f 636f 6c6c   return new_coll
+00010290: 6563 7469 6f6e 2873 656c 662e 6578 7072  ection(self.expr
+000102a0: 2e66 696c 6c6e 6128 7661 6c75 6529 290a  .fillna(value)).
+000102b0: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
+000102c0: 6f6d 2870 642e 4461 7461 4672 616d 6529  om(pd.DataFrame)
+000102d0: 0a20 2020 2064 6566 2073 6869 6674 2873  .    def shift(s
+000102e0: 656c 662c 2070 6572 696f 6473 3d31 2c20  elf, periods=1, 
+000102f0: 6672 6571 3d4e 6f6e 652c 2061 7869 733d  freq=None, axis=
+00010300: 3029 3a0a 2020 2020 2020 2020 6966 206e  0):.        if n
+00010310: 6f74 2069 7369 6e73 7461 6e63 6528 7065  ot isinstance(pe
+00010320: 7269 6f64 732c 2049 6e74 6567 7261 6c29  riods, Integral)
+00010330: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+00010340: 6973 6520 5479 7065 4572 726f 7228 2270  ise TypeError("p
+00010350: 6572 696f 6473 206d 7573 7420 6265 2061  eriods must be a
+00010360: 6e20 696e 7465 6765 7222 290a 0a20 2020  n integer")..   
+00010370: 2020 2020 2061 7869 7320 3d20 5f76 616c       axis = _val
+00010380: 6964 6174 655f 6178 6973 2861 7869 7329  idate_axis(axis)
+00010390: 0a20 2020 2020 2020 2069 6620 6178 6973  .        if axis
+000103a0: 203d 3d20 303a 0a20 2020 2020 2020 2020   == 0:.         
+000103b0: 2020 2072 6574 7572 6e20 6e65 775f 636f     return new_co
+000103c0: 6c6c 6563 7469 6f6e 2853 6869 6674 2873  llection(Shift(s
+000103d0: 656c 662c 2070 6572 696f 6473 2c20 6672  elf, periods, fr
+000103e0: 6571 2929 0a0a 2020 2020 2020 2020 7265  eq))..        re
+000103f0: 7475 726e 2073 656c 662e 6d61 705f 7061  turn self.map_pa
+00010400: 7274 6974 696f 6e73 280a 2020 2020 2020  rtitions(.      
+00010410: 2020 2020 2020 6675 6e63 3d53 6869 6674        func=Shift
+00010420: 2e66 756e 632c 0a20 2020 2020 2020 2020  .func,.         
+00010430: 2020 2065 6e66 6f72 6365 5f6d 6574 6164     enforce_metad
+00010440: 6174 613d 4661 6c73 652c 0a20 2020 2020  ata=False,.     
+00010450: 2020 2020 2020 2074 7261 6e73 666f 726d         transform
+00010460: 5f64 6976 6973 696f 6e73 3d46 616c 7365  _divisions=False
+00010470: 2c0a 2020 2020 2020 2020 2020 2020 7065  ,.            pe
+00010480: 7269 6f64 733d 7065 7269 6f64 732c 0a20  riods=periods,. 
+00010490: 2020 2020 2020 2020 2020 2061 7869 733d             axis=
+000104a0: 6178 6973 2c0a 2020 2020 2020 2020 2020  axis,.          
+000104b0: 2020 6672 6571 3d66 7265 712c 0a20 2020    freq=freq,.   
+000104c0: 2020 2020 2029 0a0a 2020 2020 4064 6572       )..    @der
+000104d0: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
+000104e0: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
+000104f0: 6469 6666 2873 656c 662c 2070 6572 696f  diff(self, perio
+00010500: 6473 3d31 2c20 6178 6973 3d30 293a 0a20  ds=1, axis=0):. 
+00010510: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00010520: 2020 202e 2e20 6e6f 7465 3a3a 0a0a 2020     .. note::..  
+00010530: 2020 2020 2020 2020 2050 616e 6461 7320           Pandas 
+00010540: 6375 7272 656e 746c 7920 7573 6573 2061  currently uses a
+00010550: 6e20 6060 6f62 6a65 6374 6060 2d64 7479  n ``object``-dty
+00010560: 7065 2063 6f6c 756d 6e20 746f 2072 6570  pe column to rep
+00010570: 7265 7365 6e74 0a20 2020 2020 2020 2020  resent.         
+00010580: 2020 626f 6f6c 6561 6e20 6461 7461 2077    boolean data w
+00010590: 6974 6820 6d69 7373 696e 6720 7661 6c75  ith missing valu
+000105a0: 6573 2e20 5468 6973 2063 616e 2063 6175  es. This can cau
+000105b0: 7365 2069 7373 7565 7320 666f 720a 2020  se issues for.  
+000105c0: 2020 2020 2020 2020 2062 6f6f 6c65 616e           boolean
+000105d0: 2d73 7065 6369 6669 6320 6f70 6572 6174  -specific operat
+000105e0: 696f 6e73 2c20 6c69 6b65 2060 607c 6060  ions, like ``|``
+000105f0: 2e20 546f 2065 6e61 626c 6520 626f 6f6c  . To enable bool
+00010600: 6561 6e2d 0a20 2020 2020 2020 2020 2020  ean-.           
+00010610: 7370 6563 6966 6963 206f 7065 7261 7469  specific operati
+00010620: 6f6e 732c 2061 7420 7468 6520 636f 7374  ons, at the cost
+00010630: 206f 6620 6d65 7461 6461 7461 2074 6861   of metadata tha
+00010640: 7420 646f 6573 6e27 7420 6d61 7463 680a  t doesn't match.
+00010650: 2020 2020 2020 2020 2020 2070 616e 6461             panda
+00010660: 732c 2075 7365 2060 602e 6173 7479 7065  s, use ``.astype
+00010670: 2862 6f6f 6c29 6060 2061 6674 6572 2074  (bool)`` after t
+00010680: 6865 2060 6073 6869 6674 6060 2e0a 2020  he ``shift``..  
+00010690: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+000106a0: 2020 6178 6973 203d 205f 7661 6c69 6461    axis = _valida
+000106b0: 7465 5f61 7869 7328 6178 6973 290a 2020  te_axis(axis).  
+000106c0: 2020 2020 2020 6966 2061 7869 7320 3d3d        if axis ==
+000106d0: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
+000106e0: 7265 7475 726e 206e 6577 5f63 6f6c 6c65  return new_colle
+000106f0: 6374 696f 6e28 4469 6666 2873 656c 662c  ction(Diff(self,
+00010700: 2070 6572 696f 6473 2929 0a20 2020 2020   periods)).     
+00010710: 2020 2072 6574 7572 6e20 7365 6c66 2e6d     return self.m
+00010720: 6170 5f70 6172 7469 7469 6f6e 7328 0a20  ap_partitions(. 
+00010730: 2020 2020 2020 2020 2020 2066 756e 633d             func=
+00010740: 4469 6666 2e66 756e 632c 0a20 2020 2020  Diff.func,.     
+00010750: 2020 2020 2020 2065 6e66 6f72 6365 5f6d         enforce_m
+00010760: 6574 6164 6174 613d 4661 6c73 652c 0a20  etadata=False,. 
+00010770: 2020 2020 2020 2020 2020 2074 7261 6e73             trans
+00010780: 666f 726d 5f64 6976 6973 696f 6e73 3d46  form_divisions=F
+00010790: 616c 7365 2c0a 2020 2020 2020 2020 2020  alse,.          
+000107a0: 2020 636c 6561 725f 6469 7669 7369 6f6e    clear_division
+000107b0: 733d 4661 6c73 652c 0a20 2020 2020 2020  s=False,.       
+000107c0: 2020 2020 2070 6572 696f 6473 3d70 6572       periods=per
+000107d0: 696f 6473 2c0a 2020 2020 2020 2020 2020  iods,.          
+000107e0: 2020 6178 6973 3d61 7869 732c 0a20 2020    axis=axis,.   
+000107f0: 2020 2020 2029 0a0a 2020 2020 4064 6572       )..    @der
+00010800: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
+00010810: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
+00010820: 7265 6e61 6d65 5f61 7869 7328 0a20 2020  rename_axis(.   
+00010830: 2020 2020 2073 656c 662c 206d 6170 7065       self, mappe
+00010840: 723d 6e6f 5f64 6566 6175 6c74 2c20 696e  r=no_default, in
+00010850: 6465 783d 6e6f 5f64 6566 6175 6c74 2c20  dex=no_default, 
+00010860: 636f 6c75 6d6e 733d 6e6f 5f64 6566 6175  columns=no_defau
+00010870: 6c74 2c20 6178 6973 3d30 0a20 2020 2029  lt, axis=0.    )
+00010880: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+00010890: 206e 6577 5f63 6f6c 6c65 6374 696f 6e28   new_collection(
+000108a0: 7365 6c66 2e65 7870 722e 7265 6e61 6d65  self.expr.rename
+000108b0: 5f61 7869 7328 6d61 7070 6572 2c20 696e  _axis(mapper, in
+000108c0: 6465 782c 2063 6f6c 756d 6e73 2c20 6178  dex, columns, ax
+000108d0: 6973 2929 0a0a 2020 2020 6465 6620 5f63  is))..    def _c
+000108e0: 7265 6174 655f 616c 6967 6e61 626c 655f  reate_alignable_
+000108f0: 6672 616d 6528 7365 6c66 2c20 6f74 6865  frame(self, othe
+00010900: 722c 206a 6f69 6e3d 226f 7574 6572 2229  r, join="outer")
+00010910: 3a0a 2020 2020 2020 2020 6966 206e 6f74  :.        if not
+00010920: 2069 735f 6461 736b 5f63 6f6c 6c65 6374   is_dask_collect
+00010930: 696f 6e28 6f74 6865 7229 2061 6e64 2028  ion(other) and (
+00010940: 0a20 2020 2020 2020 2020 2020 2069 735f  .            is_
+00010950: 7365 7269 6573 5f6c 696b 6528 6f74 6865  series_like(othe
+00010960: 7229 206f 7220 6973 5f64 6174 6166 7261  r) or is_datafra
+00010970: 6d65 5f6c 696b 6528 6f74 6865 7229 0a20  me_like(other). 
+00010980: 2020 2020 2020 2029 3a0a 2020 2020 2020         ):.      
+00010990: 2020 2020 2020 6966 206a 6f69 6e20 696e        if join in
+000109a0: 2028 2269 6e6e 6572 222c 2022 6c65 6674   ("inner", "left
+000109b0: 2229 3a0a 2020 2020 2020 2020 2020 2020  "):.            
+000109c0: 2020 2020 6e70 6172 7469 7469 6f6e 7320      npartitions 
+000109d0: 3d20 310a 2020 2020 2020 2020 2020 2020  = 1.            
+000109e0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+000109f0: 2020 2020 2020 2320 5765 2068 6176 6520        # We have 
+00010a00: 746f 2074 7269 6767 6572 2061 6c69 676e  to trigger align
+00010a10: 6d65 6e74 2c20 6f74 6865 7277 6973 6520  ment, otherwise 
+00010a20: 7061 6e64 6173 2077 696c 6c20 6164 640a  pandas will add.
+00010a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010a40: 2320 7468 6520 7361 6d65 2076 616c 7565  # the same value
+00010a50: 7320 746f 2065 7665 7279 2070 6172 7469  s to every parti
+00010a60: 7469 6f6e 0a20 2020 2020 2020 2020 2020  tion.           
+00010a70: 2020 2020 206e 7061 7274 6974 696f 6e73       npartitions
+00010a80: 203d 2032 0a20 2020 2020 2020 2020 2020   = 2.           
+00010a90: 206f 7468 6572 203d 2066 726f 6d5f 7061   other = from_pa
+00010aa0: 6e64 6173 286f 7468 6572 2c20 6e70 6172  ndas(other, npar
+00010ab0: 7469 7469 6f6e 733d 6e70 6172 7469 7469  titions=npartiti
+00010ac0: 6f6e 7329 0a20 2020 2020 2020 2072 6574  ons).        ret
+00010ad0: 7572 6e20 6f74 6865 720a 0a20 2020 2040  urn other..    @
+00010ae0: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
+00010af0: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
+00010b00: 6566 2061 6c69 676e 2873 656c 662c 206f  ef align(self, o
+00010b10: 7468 6572 2c20 6a6f 696e 3d22 6f75 7465  ther, join="oute
+00010b20: 7222 2c20 6178 6973 3d4e 6f6e 652c 2066  r", axis=None, f
+00010b30: 696c 6c5f 7661 6c75 653d 4e6f 6e65 293a  ill_value=None):
+00010b40: 0a20 2020 2020 2020 206f 7468 6572 203d  .        other =
+00010b50: 2073 656c 662e 5f63 7265 6174 655f 616c   self._create_al
+00010b60: 6967 6e61 626c 655f 6672 616d 6528 6f74  ignable_frame(ot
+00010b70: 6865 722c 206a 6f69 6e29 0a20 2020 2020  her, join).     
+00010b80: 2020 2072 6574 7572 6e20 7365 6c66 2e65     return self.e
+00010b90: 7870 722e 616c 6967 6e28 6f74 6865 722e  xpr.align(other.
+00010ba0: 6578 7072 2c20 6a6f 696e 2c20 6178 6973  expr, join, axis
+00010bb0: 2c20 6669 6c6c 5f76 616c 7565 290a 0a20  , fill_value).. 
+00010bc0: 2020 2064 6566 206e 756e 6971 7565 5f61     def nunique_a
+00010bd0: 7070 726f 7828 7365 6c66 2c20 7370 6c69  pprox(self, spli
+00010be0: 745f 6576 6572 793d 4e6f 6e65 293a 0a20  t_every=None):. 
+00010bf0: 2020 2020 2020 2022 2222 4170 7072 6f78         """Approx
+00010c00: 696d 6174 6520 6e75 6d62 6572 206f 6620  imate number of 
+00010c10: 756e 6971 7565 2072 6f77 732e 0a0a 2020  unique rows...  
+00010c20: 2020 2020 2020 5468 6973 206d 6574 686f        This metho
+00010c30: 6420 7573 6573 2074 6865 2048 7970 6572  d uses the Hyper
+00010c40: 4c6f 674c 6f67 2061 6c67 6f72 6974 686d  LogLog algorithm
+00010c50: 2066 6f72 2063 6172 6469 6e61 6c69 7479   for cardinality
+00010c60: 0a20 2020 2020 2020 2065 7374 696d 6174  .        estimat
+00010c70: 696f 6e20 746f 2063 6f6d 7075 7465 2074  ion to compute t
+00010c80: 6865 2061 7070 726f 7869 6d61 7465 206e  he approximate n
+00010c90: 756d 6265 7220 6f66 2075 6e69 7175 6520  umber of unique 
+00010ca0: 726f 7773 2e0a 2020 2020 2020 2020 5468  rows..        Th
+00010cb0: 6520 6170 7072 6f78 696d 6174 6520 6572  e approximate er
+00010cc0: 726f 7220 6973 2030 2e34 3036 252e 0a0a  ror is 0.406%...
+00010cd0: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+00010ce0: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
+00010cf0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7370  -----.        sp
+00010d00: 6c69 745f 6576 6572 7920 3a20 696e 742c  lit_every : int,
+00010d10: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
+00010d20: 2020 2020 2020 4772 6f75 7020 7061 7274        Group part
+00010d30: 6974 696f 6e73 2069 6e74 6f20 6772 6f75  itions into grou
+00010d40: 7073 206f 6620 7468 6973 2073 697a 6520  ps of this size 
+00010d50: 7768 696c 6520 7065 7266 6f72 6d69 6e67  while performing
+00010d60: 2061 0a20 2020 2020 2020 2020 2020 2074   a.            t
+00010d70: 7265 652d 7265 6475 6374 696f 6e2e 2049  ree-reduction. I
+00010d80: 6620 7365 7420 746f 2046 616c 7365 2c20  f set to False, 
+00010d90: 6e6f 2074 7265 652d 7265 6475 6374 696f  no tree-reductio
+00010da0: 6e20 7769 6c6c 2062 6520 7573 6564 2e0a  n will be used..
+00010db0: 2020 2020 2020 2020 2020 2020 4465 6661              Defa
+00010dc0: 756c 7420 6973 2038 2e0a 0a20 2020 2020  ult is 8...     
+00010dd0: 2020 2052 6574 7572 6e73 0a20 2020 2020     Returns.     
+00010de0: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2020     -------.     
+00010df0: 2020 2061 2066 6c6f 6174 2072 6570 7265     a float repre
+00010e00: 7365 6e74 696e 6720 7468 6520 6170 7072  senting the appr
+00010e10: 6f78 696d 6174 6520 6e75 6d62 6572 206f  oximate number o
+00010e20: 6620 656c 656d 656e 7473 0a20 2020 2020  f elements.     
+00010e30: 2020 2022 2222 0a20 2020 2020 2020 2072     """.        r
+00010e40: 6574 7572 6e20 6e65 775f 636f 6c6c 6563  eturn new_collec
+00010e50: 7469 6f6e 2873 656c 662e 6578 7072 2e6e  tion(self.expr.n
+00010e60: 756e 6971 7565 5f61 7070 726f 7828 7370  unique_approx(sp
+00010e70: 6c69 745f 6576 6572 793d 7370 6c69 745f  lit_every=split_
+00010e80: 6576 6572 7929 290a 0a20 2020 2040 6465  every))..    @de
+00010e90: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
+00010ea0: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
+00010eb0: 2063 756d 7375 6d28 7365 6c66 2c20 6178   cumsum(self, ax
+00010ec0: 6973 3d30 2c20 736b 6970 6e61 3d54 7275  is=0, skipna=Tru
+00010ed0: 652c 202a 2a6b 7761 7267 7329 3a0a 2020  e, **kwargs):.  
+00010ee0: 2020 2020 2020 6966 2061 7869 7320 3d3d        if axis ==
+00010ef0: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
+00010f00: 7265 7475 726e 2073 656c 662e 6d61 705f  return self.map_
+00010f10: 7061 7274 6974 696f 6e73 284d 2e63 756d  partitions(M.cum
+00010f20: 7375 6d2c 2061 7869 733d 6178 6973 2c20  sum, axis=axis, 
+00010f30: 736b 6970 6e61 3d73 6b69 706e 6129 0a20  skipna=skipna). 
+00010f40: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
+00010f50: 775f 636f 6c6c 6563 7469 6f6e 2873 656c  w_collection(sel
+00010f60: 662e 6578 7072 2e63 756d 7375 6d28 736b  f.expr.cumsum(sk
+00010f70: 6970 6e61 3d73 6b69 706e 6129 290a 0a20  ipna=skipna)).. 
+00010f80: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
+00010f90: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
+00010fa0: 2020 2064 6566 2063 756d 7072 6f64 2873     def cumprod(s
+00010fb0: 656c 662c 2061 7869 733d 302c 2073 6b69  elf, axis=0, ski
+00010fc0: 706e 613d 5472 7565 2c20 2a2a 6b77 6172  pna=True, **kwar
+00010fd0: 6773 293a 0a20 2020 2020 2020 2069 6620  gs):.        if 
+00010fe0: 6178 6973 203d 3d20 313a 0a20 2020 2020  axis == 1:.     
+00010ff0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00011000: 6c66 2e6d 6170 5f70 6172 7469 7469 6f6e  lf.map_partition
+00011010: 7328 4d2e 6375 6d70 726f 642c 2061 7869  s(M.cumprod, axi
+00011020: 733d 6178 6973 2c20 736b 6970 6e61 3d73  s=axis, skipna=s
+00011030: 6b69 706e 6129 0a20 2020 2020 2020 2072  kipna).        r
+00011040: 6574 7572 6e20 6e65 775f 636f 6c6c 6563  eturn new_collec
+00011050: 7469 6f6e 2873 656c 662e 6578 7072 2e63  tion(self.expr.c
+00011060: 756d 7072 6f64 2873 6b69 706e 613d 736b  umprod(skipna=sk
+00011070: 6970 6e61 2929 0a0a 2020 2020 4064 6572  ipna))..    @der
+00011080: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
+00011090: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
+000110a0: 6375 6d6d 6178 2873 656c 662c 2061 7869  cummax(self, axi
+000110b0: 733d 302c 2073 6b69 706e 613d 5472 7565  s=0, skipna=True
+000110c0: 293a 0a20 2020 2020 2020 2069 6620 6178  ):.        if ax
+000110d0: 6973 203d 3d20 313a 0a20 2020 2020 2020  is == 1:.       
+000110e0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+000110f0: 2e6d 6170 5f70 6172 7469 7469 6f6e 7328  .map_partitions(
+00011100: 4d2e 6375 6d6d 6178 2c20 6178 6973 3d61  M.cummax, axis=a
+00011110: 7869 732c 2073 6b69 706e 613d 736b 6970  xis, skipna=skip
+00011120: 6e61 290a 2020 2020 2020 2020 7265 7475  na).        retu
+00011130: 726e 206e 6577 5f63 6f6c 6c65 6374 696f  rn new_collectio
+00011140: 6e28 7365 6c66 2e65 7870 722e 6375 6d6d  n(self.expr.cumm
+00011150: 6178 2873 6b69 706e 613d 736b 6970 6e61  ax(skipna=skipna
+00011160: 2929 0a0a 2020 2020 4064 6572 6976 6564  ))..    @derived
+00011170: 5f66 726f 6d28 7064 2e44 6174 6146 7261  _from(pd.DataFra
+00011180: 6d65 290a 2020 2020 6465 6620 6375 6d6d  me).    def cumm
+00011190: 696e 2873 656c 662c 2061 7869 733d 302c  in(self, axis=0,
+000111a0: 2073 6b69 706e 613d 5472 7565 293a 0a20   skipna=True):. 
+000111b0: 2020 2020 2020 2069 6620 6178 6973 203d         if axis =
+000111c0: 3d20 313a 0a20 2020 2020 2020 2020 2020  = 1:.           
+000111d0: 2072 6574 7572 6e20 7365 6c66 2e6d 6170   return self.map
+000111e0: 5f70 6172 7469 7469 6f6e 7328 4d2e 6375  _partitions(M.cu
+000111f0: 6d6d 696e 2c20 6178 6973 3d61 7869 732c  mmin, axis=axis,
+00011200: 2073 6b69 706e 613d 736b 6970 6e61 290a   skipna=skipna).
+00011210: 2020 2020 2020 2020 7265 7475 726e 206e          return n
+00011220: 6577 5f63 6f6c 6c65 6374 696f 6e28 7365  ew_collection(se
+00011230: 6c66 2e65 7870 722e 6375 6d6d 696e 2873  lf.expr.cummin(s
+00011240: 6b69 706e 613d 736b 6970 6e61 2929 0a0a  kipna=skipna))..
+00011250: 2020 2020 6465 6620 7265 6475 6374 696f      def reductio
+00011260: 6e28 0a20 2020 2020 2020 2073 656c 662c  n(.        self,
+00011270: 0a20 2020 2020 2020 2063 6875 6e6b 2c0a  .        chunk,.
+00011280: 2020 2020 2020 2020 6167 6772 6567 6174          aggregat
+00011290: 653d 4e6f 6e65 2c0a 2020 2020 2020 2020  e=None,.        
+000112a0: 636f 6d62 696e 653d 4e6f 6e65 2c0a 2020  combine=None,.  
+000112b0: 2020 2020 2020 6d65 7461 3d6e 6f5f 6465        meta=no_de
+000112c0: 6661 756c 742c 0a20 2020 2020 2020 2074  fault,.        t
+000112d0: 6f6b 656e 3d4e 6f6e 652c 0a20 2020 2020  oken=None,.     
+000112e0: 2020 2073 706c 6974 5f65 7665 7279 3d4e     split_every=N
+000112f0: 6f6e 652c 0a20 2020 2020 2020 2063 6875  one,.        chu
+00011300: 6e6b 5f6b 7761 7267 733d 4e6f 6e65 2c0a  nk_kwargs=None,.
+00011310: 2020 2020 2020 2020 6167 6772 6567 6174          aggregat
+00011320: 655f 6b77 6172 6773 3d4e 6f6e 652c 0a20  e_kwargs=None,. 
+00011330: 2020 2020 2020 2063 6f6d 6269 6e65 5f6b         combine_k
+00011340: 7761 7267 733d 4e6f 6e65 2c0a 2020 2020  wargs=None,.    
+00011350: 2020 2020 2a2a 6b77 6172 6773 2c0a 2020      **kwargs,.  
+00011360: 2020 293a 0a20 2020 2020 2020 2022 2222    ):.        """
+00011370: 4765 6e65 7269 6320 726f 772d 7769 7365  Generic row-wise
+00011380: 2072 6564 7563 7469 6f6e 732e 0a0a 2020   reductions...  
+00011390: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+000113a0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+000113b0: 2d2d 2d0a 2020 2020 2020 2020 6368 756e  ---.        chun
+000113c0: 6b20 3a20 6361 6c6c 6162 6c65 0a20 2020  k : callable.   
+000113d0: 2020 2020 2020 2020 2046 756e 6374 696f           Functio
+000113e0: 6e20 746f 206f 7065 7261 7465 206f 6e20  n to operate on 
+000113f0: 6561 6368 2070 6172 7469 7469 6f6e 2e20  each partition. 
+00011400: 5368 6f75 6c64 2072 6574 7572 6e20 610a  Should return a.
+00011410: 2020 2020 2020 2020 2020 2020 6060 7061              ``pa
+00011420: 6e64 6173 2e44 6174 6146 7261 6d65 6060  ndas.DataFrame``
+00011430: 2c20 6060 7061 6e64 6173 2e53 6572 6965  , ``pandas.Serie
+00011440: 7360 602c 206f 7220 6120 7363 616c 6172  s``, or a scalar
+00011450: 2e0a 2020 2020 2020 2020 6167 6772 6567  ..        aggreg
+00011460: 6174 6520 3a20 6361 6c6c 6162 6c65 2c20  ate : callable, 
+00011470: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
+00011480: 2020 2020 2046 756e 6374 696f 6e20 746f       Function to
+00011490: 206f 7065 7261 7465 206f 6e20 7468 6520   operate on the 
+000114a0: 636f 6e63 6174 656e 6174 6564 2072 6573  concatenated res
+000114b0: 756c 7420 6f66 2060 6063 6875 6e6b 6060  ult of ``chunk``
+000114c0: 2e20 4966 206e 6f74 0a20 2020 2020 2020  . If not.       
+000114d0: 2020 2020 2073 7065 6369 6669 6564 2c20       specified, 
+000114e0: 6465 6661 756c 7473 2074 6f20 6060 6368  defaults to ``ch
+000114f0: 756e 6b60 602e 2055 7365 6420 746f 2064  unk``. Used to d
+00011500: 6f20 7468 6520 6669 6e61 6c20 6167 6772  o the final aggr
+00011510: 6567 6174 696f 6e0a 2020 2020 2020 2020  egation.        
+00011520: 2020 2020 696e 2061 2074 7265 6520 7265      in a tree re
+00011530: 6475 6374 696f 6e2e 0a0a 2020 2020 2020  duction...      
+00011540: 2020 2020 2020 5468 6520 696e 7075 7420        The input 
+00011550: 746f 2060 6061 6767 7265 6761 7465 6060  to ``aggregate``
+00011560: 2064 6570 656e 6473 206f 6e20 7468 6520   depends on the 
+00011570: 6f75 7470 7574 206f 6620 6060 6368 756e  output of ``chun
+00011580: 6b60 602e 0a20 2020 2020 2020 2020 2020  k``..           
+00011590: 2049 6620 7468 6520 6f75 7470 7574 206f   If the output o
+000115a0: 6620 6060 6368 756e 6b60 6020 6973 2061  f ``chunk`` is a
+000115b0: 3a0a 0a20 2020 2020 2020 2020 2020 202d  :..            -
+000115c0: 2073 6361 6c61 723a 2049 6e70 7574 2069   scalar: Input i
+000115d0: 7320 6120 5365 7269 6573 2c20 7769 7468  s a Series, with
+000115e0: 206f 6e65 2072 6f77 2070 6572 2070 6172   one row per par
+000115f0: 7469 7469 6f6e 2e0a 2020 2020 2020 2020  tition..        
+00011600: 2020 2020 2d20 5365 7269 6573 3a20 496e      - Series: In
+00011610: 7075 7420 6973 2061 2044 6174 6146 7261  put is a DataFra
+00011620: 6d65 2c20 7769 7468 206f 6e65 2072 6f77  me, with one row
+00011630: 2070 6572 2070 6172 7469 7469 6f6e 2e20   per partition. 
+00011640: 436f 6c75 6d6e 730a 2020 2020 2020 2020  Columns.        
+00011650: 2020 2020 2020 6172 6520 7468 6520 726f        are the ro
+00011660: 7773 2069 6e20 7468 6520 6f75 7470 7574  ws in the output
+00011670: 2073 6572 6965 732e 0a20 2020 2020 2020   series..       
+00011680: 2020 2020 202d 2044 6174 6146 7261 6d65       - DataFrame
+00011690: 3a20 496e 7075 7420 6973 2061 2044 6174  : Input is a Dat
+000116a0: 6146 7261 6d65 2c20 7769 7468 206f 6e65  aFrame, with one
+000116b0: 2072 6f77 2070 6572 2070 6172 7469 7469   row per partiti
+000116c0: 6f6e 2e0a 2020 2020 2020 2020 2020 2020  on..            
+000116d0: 2020 436f 6c75 6d6e 7320 6172 6520 7468    Columns are th
+000116e0: 6520 636f 6c75 6d6e 7320 696e 2074 6865  e columns in the
+000116f0: 206f 7574 7075 7420 6461 7461 6672 616d   output datafram
+00011700: 6573 2e0a 0a20 2020 2020 2020 2020 2020  es...           
+00011710: 2053 686f 756c 6420 7265 7475 726e 2061   Should return a
+00011720: 2060 6070 616e 6461 732e 4461 7461 4672   ``pandas.DataFr
+00011730: 616d 6560 602c 2060 6070 616e 6461 732e  ame``, ``pandas.
+00011740: 5365 7269 6573 6060 2c20 6f72 2061 0a20  Series``, or a. 
+00011750: 2020 2020 2020 2020 2020 2073 6361 6c61             scala
+00011760: 722e 0a20 2020 2020 2020 2063 6f6d 6269  r..        combi
+00011770: 6e65 203a 2063 616c 6c61 626c 652c 206f  ne : callable, o
+00011780: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
+00011790: 2020 2020 4675 6e63 7469 6f6e 2074 6f20      Function to 
+000117a0: 6f70 6572 6174 6520 6f6e 2069 6e74 6572  operate on inter
+000117b0: 6d65 6469 6174 6520 636f 6e63 6174 656e  mediate concaten
+000117c0: 6174 6564 2072 6573 756c 7473 206f 660a  ated results of.
+000117d0: 2020 2020 2020 2020 2020 2020 6060 6368              ``ch
+000117e0: 756e 6b60 6020 696e 2061 2074 7265 652d  unk`` in a tree-
+000117f0: 7265 6475 6374 696f 6e2e 2049 6620 6e6f  reduction. If no
+00011800: 7420 7072 6f76 6964 6564 2c20 6465 6661  t provided, defa
+00011810: 756c 7473 2074 6f0a 2020 2020 2020 2020  ults to.        
+00011820: 2020 2020 6060 6167 6772 6567 6174 6560      ``aggregate`
+00011830: 602e 2054 6865 2069 6e70 7574 2f6f 7574  `. The input/out
+00011840: 7075 7420 7265 7175 6972 656d 656e 7473  put requirements
+00011850: 2073 686f 756c 6420 6d61 7463 6820 7468   should match th
+00011860: 6174 206f 660a 2020 2020 2020 2020 2020  at of.          
+00011870: 2020 6060 6167 6772 6567 6174 6560 6020    ``aggregate`` 
+00011880: 6465 7363 7269 6265 6420 6162 6f76 652e  described above.
+00011890: 0a20 2020 2020 2020 2024 4d45 5441 0a20  .        $META. 
+000118a0: 2020 2020 2020 2074 6f6b 656e 203a 2073         token : s
+000118b0: 7472 2c20 6f70 7469 6f6e 616c 0a20 2020  tr, optional.   
+000118c0: 2020 2020 2020 2020 2054 6865 206e 616d           The nam
+000118d0: 6520 746f 2075 7365 2066 6f72 2074 6865  e to use for the
+000118e0: 206f 7574 7075 7420 6b65 7973 2e0a 2020   output keys..  
+000118f0: 2020 2020 2020 7370 6c69 745f 6576 6572        split_ever
+00011900: 7920 3a20 696e 742c 206f 7074 696f 6e61  y : int, optiona
+00011910: 6c0a 2020 2020 2020 2020 2020 2020 4772  l.            Gr
+00011920: 6f75 7020 7061 7274 6974 696f 6e73 2069  oup partitions i
+00011930: 6e74 6f20 6772 6f75 7073 206f 6620 7468  nto groups of th
+00011940: 6973 2073 697a 6520 7768 696c 6520 7065  is size while pe
+00011950: 7266 6f72 6d69 6e67 2061 0a20 2020 2020  rforming a.     
+00011960: 2020 2020 2020 2074 7265 652d 7265 6475         tree-redu
+00011970: 6374 696f 6e2e 2049 6620 7365 7420 746f  ction. If set to
+00011980: 2046 616c 7365 2c20 6e6f 2074 7265 652d   False, no tree-
+00011990: 7265 6475 6374 696f 6e20 7769 6c6c 2062  reduction will b
+000119a0: 6520 7573 6564 2c0a 2020 2020 2020 2020  e used,.        
+000119b0: 2020 2020 616e 6420 616c 6c20 696e 7465      and all inte
+000119c0: 726d 6564 6961 7465 7320 7769 6c6c 2062  rmediates will b
+000119d0: 6520 636f 6e63 6174 656e 6174 6564 2061  e concatenated a
+000119e0: 6e64 2070 6173 7365 6420 746f 0a20 2020  nd passed to.   
+000119f0: 2020 2020 2020 2020 2060 6061 6767 7265           ``aggre
+00011a00: 6761 7465 6060 2e20 4465 6661 756c 7420  gate``. Default 
+00011a10: 6973 2038 2e0a 2020 2020 2020 2020 6368  is 8..        ch
+00011a20: 756e 6b5f 6b77 6172 6773 203a 2064 6963  unk_kwargs : dic
+00011a30: 742c 206f 7074 696f 6e61 6c0a 2020 2020  t, optional.    
+00011a40: 2020 2020 2020 2020 4b65 7977 6f72 6420          Keyword 
+00011a50: 6172 6775 6d65 6e74 7320 746f 2070 6173  arguments to pas
+00011a60: 7320 6f6e 2074 6f20 6060 6368 756e 6b60  s on to ``chunk`
+00011a70: 6020 6f6e 6c79 2e0a 2020 2020 2020 2020  ` only..        
+00011a80: 6167 6772 6567 6174 655f 6b77 6172 6773  aggregate_kwargs
+00011a90: 203a 2064 6963 742c 206f 7074 696f 6e61   : dict, optiona
+00011aa0: 6c0a 2020 2020 2020 2020 2020 2020 4b65  l.            Ke
+00011ab0: 7977 6f72 6420 6172 6775 6d65 6e74 7320  yword arguments 
+00011ac0: 746f 2070 6173 7320 6f6e 2074 6f20 6060  to pass on to ``
+00011ad0: 6167 6772 6567 6174 6560 6020 6f6e 6c79  aggregate`` only
+00011ae0: 2e0a 2020 2020 2020 2020 636f 6d62 696e  ..        combin
+00011af0: 655f 6b77 6172 6773 203a 2064 6963 742c  e_kwargs : dict,
+00011b00: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
+00011b10: 2020 2020 2020 4b65 7977 6f72 6420 6172        Keyword ar
+00011b20: 6775 6d65 6e74 7320 746f 2070 6173 7320  guments to pass 
+00011b30: 6f6e 2074 6f20 6060 636f 6d62 696e 6560  on to ``combine`
+00011b40: 6020 6f6e 6c79 2e0a 2020 2020 2020 2020  ` only..        
+00011b50: 6b77 6172 6773 203a 0a20 2020 2020 2020  kwargs :.       
+00011b60: 2020 2020 2041 6c6c 2072 656d 6169 6e69       All remaini
+00011b70: 6e67 206b 6579 776f 7264 7320 7769 6c6c  ng keywords will
+00011b80: 2062 6520 7061 7373 6564 2074 6f20 6060   be passed to ``
+00011b90: 6368 756e 6b60 602c 2060 6063 6f6d 6269  chunk``, ``combi
+00011ba0: 6e65 6060 2c0a 2020 2020 2020 2020 2020  ne``,.          
+00011bb0: 2020 616e 6420 6060 6167 6772 6567 6174    and ``aggregat
+00011bc0: 6560 602e 0a0a 2020 2020 2020 2020 4578  e``...        Ex
+00011bd0: 616d 706c 6573 0a20 2020 2020 2020 202d  amples.        -
+00011be0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00011bf0: 3e3e 3e20 696d 706f 7274 2070 616e 6461  >>> import panda
+00011c00: 7320 6173 2070 640a 2020 2020 2020 2020  s as pd.        
+00011c10: 3e3e 3e20 696d 706f 7274 2064 6173 6b2e  >>> import dask.
+00011c20: 6461 7461 6672 616d 6520 6173 2064 640a  dataframe as dd.
+00011c30: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
+00011c40: 2070 642e 4461 7461 4672 616d 6528 7b27   pd.DataFrame({'
+00011c50: 7827 3a20 7261 6e67 6528 3530 292c 2027  x': range(50), '
+00011c60: 7927 3a20 7261 6e67 6528 3530 2c20 3130  y': range(50, 10
+00011c70: 3029 7d29 0a20 2020 2020 2020 203e 3e3e  0)}).        >>>
+00011c80: 2064 6466 203d 2064 642e 6672 6f6d 5f70   ddf = dd.from_p
+00011c90: 616e 6461 7328 6466 2c20 6e70 6172 7469  andas(df, nparti
+00011ca0: 7469 6f6e 733d 3429 0a0a 2020 2020 2020  tions=4)..      
+00011cb0: 2020 436f 756e 7420 7468 6520 6e75 6d62    Count the numb
+00011cc0: 6572 206f 6620 726f 7773 2069 6e20 6120  er of rows in a 
+00011cd0: 4461 7461 4672 616d 652e 2054 6f20 646f  DataFrame. To do
+00011ce0: 2074 6869 732c 2063 6f75 6e74 2074 6865   this, count the
+00011cf0: 206e 756d 6265 720a 2020 2020 2020 2020   number.        
+00011d00: 6f66 2072 6f77 7320 696e 2065 6163 6820  of rows in each 
+00011d10: 7061 7274 6974 696f 6e2c 2074 6865 6e20  partition, then 
+00011d20: 7375 6d20 7468 6520 7265 7375 6c74 733a  sum the results:
+00011d30: 0a0a 2020 2020 2020 2020 3e3e 3e20 7265  ..        >>> re
+00011d40: 7320 3d20 6464 662e 7265 6475 6374 696f  s = ddf.reductio
+00011d50: 6e28 6c61 6d62 6461 2078 3a20 782e 636f  n(lambda x: x.co
+00011d60: 756e 7428 292c 0a20 2020 2020 2020 202e  unt(),.        .
+00011d70: 2e2e 2020 2020 2020 2020 2020 2020 2020  ..              
+00011d80: 2020 2020 2020 2061 6767 7265 6761 7465         aggregate
+00011d90: 3d6c 616d 6264 6120 783a 2078 2e73 756d  =lambda x: x.sum
+00011da0: 2829 290a 2020 2020 2020 2020 3e3e 3e20  ()).        >>> 
+00011db0: 7265 732e 636f 6d70 7574 6528 290a 2020  res.compute().  
+00011dc0: 2020 2020 2020 7820 2020 2035 300a 2020        x    50.  
+00011dd0: 2020 2020 2020 7920 2020 2035 300a 2020        y    50.  
+00011de0: 2020 2020 2020 6474 7970 653a 2069 6e74        dtype: int
+00011df0: 3634 0a0a 2020 2020 2020 2020 436f 756e  64..        Coun
+00011e00: 7420 7468 6520 6e75 6d62 6572 206f 6620  t the number of 
+00011e10: 726f 7773 2069 6e20 6120 5365 7269 6573  rows in a Series
+00011e20: 2077 6974 6820 656c 656d 656e 7473 2067   with elements g
+00011e30: 7265 6174 6572 2074 6861 6e20 6f72 0a20  reater than or. 
+00011e40: 2020 2020 2020 2065 7175 616c 2074 6f20         equal to 
+00011e50: 6120 7661 6c75 6520 2870 726f 7669 6465  a value (provide
+00011e60: 6420 7669 6120 6120 6b65 7977 6f72 6429  d via a keyword)
+00011e70: 2e0a 0a20 2020 2020 2020 203e 3e3e 2064  ...        >>> d
+00011e80: 6566 2063 6f75 6e74 5f67 7265 6174 6572  ef count_greater
+00011e90: 2878 2c20 7661 6c75 653d 3029 3a0a 2020  (x, value=0):.  
+00011ea0: 2020 2020 2020 2e2e 2e20 2020 2020 7265        ...     re
+00011eb0: 7475 726e 2028 7820 3e3d 2076 616c 7565  turn (x >= value
+00011ec0: 292e 7375 6d28 290a 2020 2020 2020 2020  ).sum().        
+00011ed0: 3e3e 3e20 7265 7320 3d20 6464 662e 782e  >>> res = ddf.x.
+00011ee0: 7265 6475 6374 696f 6e28 636f 756e 745f  reduction(count_
+00011ef0: 6772 6561 7465 722c 2061 6767 7265 6761  greater, aggrega
+00011f00: 7465 3d6c 616d 6264 6120 783a 2078 2e73  te=lambda x: x.s
+00011f10: 756d 2829 2c0a 2020 2020 2020 2020 2e2e  um(),.        ..
+00011f20: 2e20 2020 2020 2020 2020 2020 2020 2020  .               
+00011f30: 2020 2020 2020 2020 6368 756e 6b5f 6b77          chunk_kw
+00011f40: 6172 6773 3d7b 2776 616c 7565 273a 2032  args={'value': 2
+00011f50: 357d 290a 2020 2020 2020 2020 3e3e 3e20  5}).        >>> 
+00011f60: 7265 732e 636f 6d70 7574 6528 290a 2020  res.compute().  
+00011f70: 2020 2020 2020 3235 0a0a 2020 2020 2020        25..      
+00011f80: 2020 4167 6772 6567 6174 6520 626f 7468    Aggregate both
+00011f90: 2074 6865 2073 756d 2061 6e64 2063 6f75   the sum and cou
+00011fa0: 6e74 206f 6620 6120 5365 7269 6573 2061  nt of a Series a
+00011fb0: 7420 7468 6520 7361 6d65 2074 696d 653a  t the same time:
+00011fc0: 0a0a 2020 2020 2020 2020 3e3e 3e20 6465  ..        >>> de
+00011fd0: 6620 7375 6d5f 616e 645f 636f 756e 7428  f sum_and_count(
+00011fe0: 7829 3a0a 2020 2020 2020 2020 2e2e 2e20  x):.        ... 
+00011ff0: 2020 2020 7265 7475 726e 2070 642e 5365      return pd.Se
+00012000: 7269 6573 287b 2763 6f75 6e74 273a 2078  ries({'count': x
+00012010: 2e63 6f75 6e74 2829 2c20 2773 756d 273a  .count(), 'sum':
+00012020: 2078 2e73 756d 2829 7d2c 0a20 2020 2020   x.sum()},.     
+00012030: 2020 202e 2e2e 2020 2020 2020 2020 2020     ...          
+00012040: 2020 2020 2020 2020 2020 2020 696e 6465              inde
+00012050: 783d 5b27 636f 756e 7427 2c20 2773 756d  x=['count', 'sum
+00012060: 275d 290a 2020 2020 2020 2020 3e3e 3e20  ']).        >>> 
+00012070: 7265 7320 3d20 6464 662e 782e 7265 6475  res = ddf.x.redu
+00012080: 6374 696f 6e28 7375 6d5f 616e 645f 636f  ction(sum_and_co
+00012090: 756e 742c 2061 6767 7265 6761 7465 3d6c  unt, aggregate=l
+000120a0: 616d 6264 6120 783a 2078 2e73 756d 2829  ambda x: x.sum()
+000120b0: 290a 2020 2020 2020 2020 3e3e 3e20 7265  ).        >>> re
+000120c0: 732e 636f 6d70 7574 6528 290a 2020 2020  s.compute().    
+000120d0: 2020 2020 636f 756e 7420 2020 2020 2035      count      5
+000120e0: 300a 2020 2020 2020 2020 7375 6d20 2020  0.        sum   
+000120f0: 2020 2031 3232 350a 2020 2020 2020 2020     1225.        
+00012100: 6474 7970 653a 2069 6e74 3634 0a0a 2020  dtype: int64..  
+00012110: 2020 2020 2020 446f 696e 6720 7468 6520        Doing the 
+00012120: 7361 6d65 2c20 6275 7420 666f 7220 6120  same, but for a 
+00012130: 4461 7461 4672 616d 652e 2048 6572 6520  DataFrame. Here 
+00012140: 6060 6368 756e 6b60 6020 7265 7475 726e  ``chunk`` return
+00012150: 7320 610a 2020 2020 2020 2020 4461 7461  s a.        Data
+00012160: 4672 616d 652c 206d 6561 6e69 6e67 2074  Frame, meaning t
+00012170: 6865 2069 6e70 7574 2074 6f20 6060 6167  he input to ``ag
+00012180: 6772 6567 6174 6560 6020 6973 2061 2044  gregate`` is a D
+00012190: 6174 6146 7261 6d65 2077 6974 6820 616e  ataFrame with an
+000121a0: 0a20 2020 2020 2020 2069 6e64 6578 2077  .        index w
+000121b0: 6974 6820 6e6f 6e2d 756e 6971 7565 2065  ith non-unique e
+000121c0: 6e74 7269 6573 2066 6f72 2062 6f74 6820  ntries for both 
+000121d0: 2778 2720 616e 6420 2779 272e 2057 6520  'x' and 'y'. We 
+000121e0: 6772 6f75 7062 7920 7468 650a 2020 2020  groupby the.    
+000121f0: 2020 2020 696e 6465 782c 2061 6e64 2073      index, and s
+00012200: 756d 2065 6163 6820 6772 6f75 7020 746f  um each group to
+00012210: 2067 6574 2074 6865 2066 696e 616c 2072   get the final r
+00012220: 6573 756c 742e 0a0a 2020 2020 2020 2020  esult...        
+00012230: 3e3e 3e20 6465 6620 7375 6d5f 616e 645f  >>> def sum_and_
+00012240: 636f 756e 7428 7829 3a0a 2020 2020 2020  count(x):.      
+00012250: 2020 2e2e 2e20 2020 2020 7265 7475 726e    ...     return
+00012260: 2070 642e 4461 7461 4672 616d 6528 7b27   pd.DataFrame({'
+00012270: 636f 756e 7427 3a20 782e 636f 756e 7428  count': x.count(
+00012280: 292c 2027 7375 6d27 3a20 782e 7375 6d28  ), 'sum': x.sum(
+00012290: 297d 2c0a 2020 2020 2020 2020 2e2e 2e20  )},.        ... 
+000122a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000122b0: 2020 2020 2020 2020 636f 6c75 6d6e 733d          columns=
+000122c0: 5b27 636f 756e 7427 2c20 2773 756d 275d  ['count', 'sum']
+000122d0: 290a 2020 2020 2020 2020 3e3e 3e20 7265  ).        >>> re
+000122e0: 7320 3d20 6464 662e 7265 6475 6374 696f  s = ddf.reductio
+000122f0: 6e28 7375 6d5f 616e 645f 636f 756e 742c  n(sum_and_count,
+00012300: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+00012310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012320: 2061 6767 7265 6761 7465 3d6c 616d 6264   aggregate=lambd
+00012330: 6120 783a 2078 2e67 726f 7570 6279 286c  a x: x.groupby(l
+00012340: 6576 656c 3d30 292e 7375 6d28 2929 0a20  evel=0).sum()). 
+00012350: 2020 2020 2020 203e 3e3e 2072 6573 2e63         >>> res.c
+00012360: 6f6d 7075 7465 2829 0a20 2020 2020 2020  ompute().       
+00012370: 2020 2020 636f 756e 7420 2020 7375 6d0a      count   sum.
+00012380: 2020 2020 2020 2020 7820 2020 2020 3530          x     50
+00012390: 2020 3132 3235 0a20 2020 2020 2020 2079    1225.        y
+000123a0: 2020 2020 2035 3020 2033 3732 350a 2020       50  3725.  
+000123b0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+000123c0: 2020 6966 2073 706c 6974 5f65 7665 7279    if split_every
+000123d0: 2069 7320 6e6f 7420 4e6f 6e65 2061 6e64   is not None and
+000123e0: 2073 706c 6974 5f65 7665 7279 203c 2032   split_every < 2
+000123f0: 2061 6e64 2073 706c 6974 5f65 7665 7279   and split_every
+00012400: 2069 7320 6e6f 7420 4661 6c73 653a 0a20   is not False:. 
+00012410: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00012420: 2056 616c 7565 4572 726f 7228 2273 706c   ValueError("spl
+00012430: 6974 5f65 7665 7279 206d 7573 7420 6265  it_every must be
+00012440: 2061 7420 6c65 6173 7420 3222 290a 0a20   at least 2").. 
+00012450: 2020 2020 2020 2069 6620 636f 6d62 696e         if combin
+00012460: 6520 6973 204e 6f6e 653a 0a20 2020 2020  e is None:.     
+00012470: 2020 2020 2020 2069 6620 636f 6d62 696e         if combin
+00012480: 655f 6b77 6172 6773 3a0a 2020 2020 2020  e_kwargs:.      
+00012490: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+000124a0: 5661 6c75 6545 7272 6f72 2822 6063 6f6d  ValueError("`com
+000124b0: 6269 6e65 5f6b 7761 7267 7360 2070 726f  bine_kwargs` pro
+000124c0: 7669 6465 6420 7769 7468 206e 6f20 6063  vided with no `c
+000124d0: 6f6d 6269 6e65 6022 290a 0a20 2020 2020  ombine`")..     
+000124e0: 2020 2063 6875 6e6b 5f6b 7761 7267 7320     chunk_kwargs 
+000124f0: 3d20 6368 756e 6b5f 6b77 6172 6773 2e63  = chunk_kwargs.c
+00012500: 6f70 7928 2920 6966 2063 6875 6e6b 5f6b  opy() if chunk_k
+00012510: 7761 7267 7320 656c 7365 207b 7d0a 2020  wargs else {}.  
+00012520: 2020 2020 2020 6368 756e 6b5f 6b77 6172        chunk_kwar
+00012530: 6773 2e75 7064 6174 6528 6b77 6172 6773  gs.update(kwargs
+00012540: 290a 2020 2020 2020 2020 6368 756e 6b5f  ).        chunk_
+00012550: 6b77 6172 6773 5b22 6675 6e63 225d 203d  kwargs["func"] =
+00012560: 2063 6875 6e6b 0a0a 2020 2020 2020 2020   chunk..        
+00012570: 636f 6d62 696e 655f 6b77 6172 6773 203d  combine_kwargs =
+00012580: 2063 6f6d 6269 6e65 5f6b 7761 7267 732e   combine_kwargs.
+00012590: 636f 7079 2829 2069 6620 636f 6d62 696e  copy() if combin
+000125a0: 655f 6b77 6172 6773 2065 6c73 6520 7b7d  e_kwargs else {}
+000125b0: 0a20 2020 2020 2020 2063 6f6d 6269 6e65  .        combine
+000125c0: 5f6b 7761 7267 732e 7570 6461 7465 286b  _kwargs.update(k
+000125d0: 7761 7267 7329 0a20 2020 2020 2020 2063  wargs).        c
+000125e0: 6f6d 6269 6e65 5f6b 7761 7267 735b 2266  ombine_kwargs["f
+000125f0: 756e 6322 5d20 3d20 636f 6d62 696e 6520  unc"] = combine 
+00012600: 6f72 2061 6767 7265 6761 7465 206f 7220  or aggregate or 
+00012610: 6368 756e 6b0a 0a20 2020 2020 2020 2061  chunk..        a
+00012620: 6767 7265 6761 7465 5f6b 7761 7267 7320  ggregate_kwargs 
+00012630: 3d20 6167 6772 6567 6174 655f 6b77 6172  = aggregate_kwar
+00012640: 6773 2e63 6f70 7928 2920 6966 2061 6767  gs.copy() if agg
+00012650: 7265 6761 7465 5f6b 7761 7267 7320 656c  regate_kwargs el
+00012660: 7365 207b 7d0a 2020 2020 2020 2020 6167  se {}.        ag
+00012670: 6772 6567 6174 655f 6b77 6172 6773 2e75  gregate_kwargs.u
+00012680: 7064 6174 6528 6b77 6172 6773 290a 2020  pdate(kwargs).  
+00012690: 2020 2020 2020 6167 6772 6567 6174 655f        aggregate_
+000126a0: 6b77 6172 6773 5b22 6675 6e63 225d 203d  kwargs["func"] =
+000126b0: 2061 6767 7265 6761 7465 206f 7220 6368   aggregate or ch
+000126c0: 756e 6b0a 0a20 2020 2020 2020 2072 6574  unk..        ret
+000126d0: 7572 6e20 6e65 775f 636f 6c6c 6563 7469  urn new_collecti
+000126e0: 6f6e 280a 2020 2020 2020 2020 2020 2020  on(.            
+000126f0: 4375 7374 6f6d 5265 6475 6374 696f 6e28  CustomReduction(
+00012700: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00012710: 2073 656c 662c 0a20 2020 2020 2020 2020   self,.         
+00012720: 2020 2020 2020 206d 6574 612c 0a20 2020         meta,.   
+00012730: 2020 2020 2020 2020 2020 2020 2063 6875               chu
+00012740: 6e6b 5f6b 7761 7267 732c 0a20 2020 2020  nk_kwargs,.     
+00012750: 2020 2020 2020 2020 2020 2061 6767 7265             aggre
+00012760: 6761 7465 5f6b 7761 7267 732c 0a20 2020  gate_kwargs,.   
+00012770: 2020 2020 2020 2020 2020 2020 2063 6f6d               com
+00012780: 6269 6e65 5f6b 7761 7267 732c 0a20 2020  bine_kwargs,.   
+00012790: 2020 2020 2020 2020 2020 2020 2073 706c               spl
+000127a0: 6974 5f65 7665 7279 2c0a 2020 2020 2020  it_every,.      
+000127b0: 2020 2020 2020 2020 2020 746f 6b65 6e2c            token,
+000127c0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+000127d0: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
+000127e0: 6620 6d65 6d6f 7279 5f75 7361 6765 5f70  f memory_usage_p
+000127f0: 6572 5f70 6172 7469 7469 6f6e 2873 656c  er_partition(sel
+00012800: 662c 2069 6e64 6578 3a20 626f 6f6c 203d  f, index: bool =
+00012810: 2054 7275 652c 2064 6565 703a 2062 6f6f   True, deep: boo
+00012820: 6c20 3d20 4661 6c73 6529 3a0a 2020 2020  l = False):.    
+00012830: 2020 2020 2222 2252 6574 7572 6e20 7468      """Return th
+00012840: 6520 6d65 6d6f 7279 2075 7361 6765 206f  e memory usage o
+00012850: 6620 6561 6368 2070 6172 7469 7469 6f6e  f each partition
+00012860: 0a0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
+00012870: 7465 7273 0a20 2020 2020 2020 202d 2d2d  ters.        ---
+00012880: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00012890: 696e 6465 7820 3a20 626f 6f6c 2c20 6465  index : bool, de
+000128a0: 6661 756c 7420 5472 7565 0a20 2020 2020  fault True.     
+000128b0: 2020 2020 2020 2053 7065 6369 6669 6573         Specifies
+000128c0: 2077 6865 7468 6572 2074 6f20 696e 636c   whether to incl
+000128d0: 7564 6520 7468 6520 6d65 6d6f 7279 2075  ude the memory u
+000128e0: 7361 6765 206f 6620 7468 6520 696e 6465  sage of the inde
+000128f0: 7820 696e 0a20 2020 2020 2020 2020 2020  x in.           
+00012900: 2072 6574 7572 6e65 6420 5365 7269 6573   returned Series
+00012910: 2e0a 2020 2020 2020 2020 6465 6570 203a  ..        deep :
+00012920: 2062 6f6f 6c2c 2064 6566 6175 6c74 2046   bool, default F
+00012930: 616c 7365 0a20 2020 2020 2020 2020 2020  alse.           
+00012940: 2049 6620 5472 7565 2c20 696e 7472 6f73   If True, intros
+00012950: 7065 6374 2074 6865 2064 6174 6120 6465  pect the data de
+00012960: 6570 6c79 2062 7920 696e 7465 7272 6f67  eply by interrog
+00012970: 6174 696e 670a 2020 2020 2020 2020 2020  ating.          
+00012980: 2020 6060 6f62 6a65 6374 6060 2064 7479    ``object`` dty
+00012990: 7065 7320 666f 7220 7379 7374 656d 2d6c  pes for system-l
+000129a0: 6576 656c 206d 656d 6f72 7920 636f 6e73  evel memory cons
+000129b0: 756d 7074 696f 6e2c 2061 6e64 2069 6e63  umption, and inc
+000129c0: 6c75 6465 0a20 2020 2020 2020 2020 2020  lude.           
+000129d0: 2069 7420 696e 2074 6865 2072 6574 7572   it in the retur
+000129e0: 6e65 6420 7661 6c75 6573 2e0a 0a20 2020  ned values...   
+000129f0: 2020 2020 2052 6574 7572 6e73 0a20 2020       Returns.   
+00012a00: 2020 2020 202d 2d2d 2d2d 2d2d 0a20 2020       -------.   
+00012a10: 2020 2020 2053 6572 6965 730a 2020 2020       Series.    
+00012a20: 2020 2020 2020 2020 4120 5365 7269 6573          A Series
+00012a30: 2077 686f 7365 2069 6e64 6578 2069 7320   whose index is 
+00012a40: 7468 6520 7061 7274 6974 696f 6e20 6e75  the partition nu
+00012a50: 6d62 6572 2061 6e64 2077 686f 7365 2076  mber and whose v
+00012a60: 616c 7565 730a 2020 2020 2020 2020 2020  alues.          
+00012a70: 2020 6172 6520 7468 6520 6d65 6d6f 7279    are the memory
+00012a80: 2075 7361 6765 206f 6620 6561 6368 2070   usage of each p
+00012a90: 6172 7469 7469 6f6e 2069 6e20 6279 7465  artition in byte
+00012aa0: 732e 0a20 2020 2020 2020 2022 2222 0a20  s..        """. 
+00012ab0: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
+00012ac0: 775f 636f 6c6c 6563 7469 6f6e 2873 656c  w_collection(sel
+00012ad0: 662e 6578 7072 2e6d 656d 6f72 795f 7573  f.expr.memory_us
+00012ae0: 6167 655f 7065 725f 7061 7274 6974 696f  age_per_partitio
+00012af0: 6e28 696e 6465 782c 2064 6565 7029 290a  n(index, deep)).
+00012b00: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+00012b10: 2020 2064 6566 206c 6f63 2873 656c 6629     def loc(self)
+00012b20: 3a0a 2020 2020 2020 2020 2222 2250 7572  :.        """Pur
+00012b30: 656c 7920 6c61 6265 6c2d 6c6f 6361 7469  ely label-locati
+00012b40: 6f6e 2062 6173 6564 2069 6e64 6578 6572  on based indexer
+00012b50: 2066 6f72 2073 656c 6563 7469 6f6e 2062   for selection b
+00012b60: 7920 6c61 6265 6c2e 0a0a 2020 2020 2020  y label...      
+00012b70: 2020 3e3e 3e20 6466 2e6c 6f63 5b22 6222    >>> df.loc["b"
+00012b80: 5d20 2023 2064 6f63 7465 7374 3a20 2b53  ]  # doctest: +S
+00012b90: 4b49 500a 2020 2020 2020 2020 3e3e 3e20  KIP.        >>> 
+00012ba0: 6466 2e6c 6f63 5b22 6222 3a22 6422 5d20  df.loc["b":"d"] 
+00012bb0: 2023 2064 6f63 7465 7374 3a20 2b53 4b49   # doctest: +SKI
+00012bc0: 500a 2020 2020 2020 2020 2222 220a 2020  P.        """.  
+00012bd0: 2020 2020 2020 6672 6f6d 2064 6173 6b5f        from dask_
+00012be0: 6578 7072 2e5f 696e 6465 7869 6e67 2069  expr._indexing i
+00012bf0: 6d70 6f72 7420 4c6f 6349 6e64 6578 6572  mport LocIndexer
+00012c00: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00012c10: 204c 6f63 496e 6465 7865 7228 7365 6c66   LocIndexer(self
+00012c20: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
+00012c30: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
+00012c40: 6529 0a20 2020 2064 6566 206e 6f74 6e75  e).    def notnu
+00012c50: 6c6c 2873 656c 6629 3a0a 2020 2020 2020  ll(self):.      
+00012c60: 2020 7265 7475 726e 206e 6577 5f63 6f6c    return new_col
+00012c70: 6c65 6374 696f 6e28 6578 7072 2e4e 6f74  lection(expr.Not
+00012c80: 4e75 6c6c 2873 656c 6629 290a 0a20 2020  Null(self))..   
+00012c90: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
+00012ca0: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
+00012cb0: 2064 6566 2069 736e 756c 6c28 7365 6c66   def isnull(self
+00012cc0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+00012cd0: 6e20 7e73 656c 662e 6e6f 746e 756c 6c28  n ~self.notnull(
+00012ce0: 290a 0a20 2020 2064 6566 2063 6f6d 7075  )..    def compu
+00012cf0: 7465 5f63 7572 7265 6e74 5f64 6976 6973  te_current_divis
+00012d00: 696f 6e73 2873 656c 662c 2063 6f6c 3d4e  ions(self, col=N
+00012d10: 6f6e 652c 2073 6574 5f64 6976 6973 696f  one, set_divisio
+00012d20: 6e73 3a20 626f 6f6c 203d 2046 616c 7365  ns: bool = False
+00012d30: 293a 0a20 2020 2020 2020 2022 2222 436f  ):.        """Co
+00012d40: 6d70 7574 6520 7468 6520 6375 7272 656e  mpute the curren
+00012d50: 7420 6469 7669 7369 6f6e 7320 6f66 2074  t divisions of t
+00012d60: 6865 2044 6174 6146 7261 6d65 2e0a 0a20  he DataFrame... 
+00012d70: 2020 2020 2020 2054 6869 7320 6d65 7468         This meth
+00012d80: 6f64 2074 7269 6767 6572 7320 696d 6d65  od triggers imme
+00012d90: 6469 6174 6520 636f 6d70 7574 6174 696f  diate computatio
+00012da0: 6e2e 2049 6620 796f 7520 6669 6e64 2079  n. If you find y
+00012db0: 6f75 7273 656c 6620 7275 6e6e 696e 6720  ourself running 
+00012dc0: 7468 6973 2063 6f6d 6d61 6e64 0a20 2020  this command.   
+00012dd0: 2020 2020 2072 6570 6561 7465 646c 7920       repeatedly 
+00012de0: 666f 7220 7468 6520 7361 6d65 2064 6174  for the same dat
+00012df0: 6166 7261 6d65 2c20 7765 2072 6563 6f6d  aframe, we recom
+00012e00: 6d65 6e64 2073 746f 7269 6e67 2074 6865  mend storing the
+00012e10: 2072 6573 756c 740a 2020 2020 2020 2020   result.        
+00012e20: 736f 2079 6f75 2064 6f6e 2774 2068 6176  so you don't hav
+00012e30: 6520 746f 2072 6572 756e 2069 742e 0a0a  e to rerun it...
+00012e40: 2020 2020 2020 2020 4966 2074 6865 2063          If the c
+00012e50: 6f6c 756d 6e20 6f72 2069 6e64 6578 2076  olumn or index v
+00012e60: 616c 7565 7320 6f76 6572 6c61 7020 6265  alues overlap be
+00012e70: 7477 6565 6e20 7061 7274 6974 696f 6e73  tween partitions
+00012e80: 2c20 7261 6973 6573 2060 6056 616c 7565  , raises ``Value
+00012e90: 4572 726f 7260 602e 0a20 2020 2020 2020  Error``..       
+00012ea0: 2054 6f20 7072 6576 656e 7420 7468 6973   To prevent this
+00012eb0: 2c20 6d61 6b65 2073 7572 6520 7468 6520  , make sure the 
+00012ec0: 6461 7461 2061 7265 2073 6f72 7465 6420  data are sorted 
+00012ed0: 6279 2074 6865 2063 6f6c 756d 6e20 6f72  by the column or
+00012ee0: 2069 6e64 6578 2e0a 0a20 2020 2020 2020   index...       
+00012ef0: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
+00012f00: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
+00012f10: 2020 2020 2020 2063 6f6c 203a 2073 7472         col : str
+00012f20: 696e 672c 206f 7074 696f 6e61 6c0a 2020  ing, optional.  
+00012f30: 2020 2020 2020 2020 2020 4361 6c63 756c            Calcul
+00012f40: 6174 6520 7468 6520 6469 7669 7369 6f6e  ate the division
+00012f50: 7320 666f 7220 6120 6e6f 6e2d 696e 6465  s for a non-inde
+00012f60: 7820 636f 6c75 6d6e 2062 7920 7061 7373  x column by pass
+00012f70: 696e 6720 696e 2074 6865 206e 616d 6520  ing in the name 
+00012f80: 6f66 2074 6865 2063 6f6c 756d 6e2e 0a20  of the column.. 
+00012f90: 2020 2020 2020 2020 2020 2049 6620 636f             If co
+00012fa0: 6c20 6973 206e 6f74 2073 7065 6369 6669  l is not specifi
+00012fb0: 6564 2c20 7468 6520 696e 6465 7820 7769  ed, the index wi
+00012fc0: 6c6c 2062 6520 7573 6564 2074 6f20 6361  ll be used to ca
+00012fd0: 6c63 756c 6174 6520 6469 7669 7369 6f6e  lculate division
+00012fe0: 732e 0a20 2020 2020 2020 2020 2020 2049  s..            I
+00012ff0: 6e20 7468 6973 2063 6173 652c 2069 6620  n this case, if 
+00013000: 7468 6520 6469 7669 7369 6f6e 7320 6172  the divisions ar
+00013010: 6520 616c 7265 6164 7920 6b6e 6f77 6e2c  e already known,
+00013020: 2074 6865 7920 7769 6c6c 2062 6520 7265   they will be re
+00013030: 7475 726e 6564 0a20 2020 2020 2020 2020  turned.         
+00013040: 2020 2069 6d6d 6564 6961 7465 6c79 2077     immediately w
+00013050: 6974 686f 7574 2063 6f6d 7075 7469 6e67  ithout computing
+00013060: 2e0a 2020 2020 2020 2020 7365 745f 6469  ..        set_di
+00013070: 7669 7369 6f6e 7320 3a20 626f 6f6c 2c20  visions : bool, 
+00013080: 6465 6661 756c 7420 4661 6c73 650a 2020  default False.  
+00013090: 2020 2020 2020 2020 2020 5768 6574 6865            Whethe
+000130a0: 7220 746f 2073 6574 2074 6865 2063 6f6d  r to set the com
+000130b0: 7075 7465 6420 6469 7669 7369 6f6e 7320  puted divisions 
+000130c0: 696e 746f 2074 6865 2044 6174 6146 7261  into the DataFra
+000130d0: 6d65 2e20 4966 2046 616c 7365 2c20 7468  me. If False, th
+000130e0: 6520 6469 7669 7369 6f6e 730a 2020 2020  e divisions.    
+000130f0: 2020 2020 2020 2020 6f66 2074 6865 2044          of the D
+00013100: 6174 6146 7261 6d65 2061 7265 2075 6e63  ataFrame are unc
+00013110: 6861 6e67 6564 2e0a 0a20 2020 2020 2020  hanged...       
+00013120: 2045 7861 6d70 6c65 730a 2020 2020 2020   Examples.      
+00013130: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020    --------.     
+00013140: 2020 203e 3e3e 2069 6d70 6f72 7420 6461     >>> import da
+00013150: 736b 0a20 2020 2020 2020 203e 3e3e 2064  sk.        >>> d
+00013160: 6466 203d 2064 6173 6b2e 6461 7461 7365  df = dask.datase
+00013170: 7473 2e74 696d 6573 6572 6965 7328 7374  ts.timeseries(st
+00013180: 6172 743d 2232 3032 312d 3031 2d30 3122  art="2021-01-01"
+00013190: 2c20 656e 643d 2232 3032 312d 3031 2d30  , end="2021-01-0
+000131a0: 3722 2c20 6672 6571 3d22 3168 2229 2e63  7", freq="1h").c
+000131b0: 6c65 6172 5f64 6976 6973 696f 6e73 2829  lear_divisions()
+000131c0: 0a20 2020 2020 2020 203e 3e3e 2064 6976  .        >>> div
+000131d0: 6973 696f 6e73 203d 2064 6466 2e63 6f6d  isions = ddf.com
+000131e0: 7075 7465 5f63 7572 7265 6e74 5f64 6976  pute_current_div
+000131f0: 6973 696f 6e73 2829 0a20 2020 2020 2020  isions().       
+00013200: 203e 3e3e 2070 7269 6e74 2864 6976 6973   >>> print(divis
+00013210: 696f 6e73 2920 2023 2064 6f63 7465 7374  ions)  # doctest
+00013220: 3a20 2b4e 4f52 4d41 4c49 5a45 5f57 4849  : +NORMALIZE_WHI
+00013230: 5445 5350 4143 450a 2020 2020 2020 2020  TESPACE.        
+00013240: 2854 696d 6573 7461 6d70 2827 3230 3231  (Timestamp('2021
+00013250: 2d30 312d 3031 2030 303a 3030 3a30 3027  -01-01 00:00:00'
+00013260: 292c 0a20 2020 2020 2020 2020 5469 6d65  ),.         Time
+00013270: 7374 616d 7028 2732 3032 312d 3031 2d30  stamp('2021-01-0
+00013280: 3220 3030 3a30 303a 3030 2729 2c0a 2020  2 00:00:00'),.  
+00013290: 2020 2020 2020 2054 696d 6573 7461 6d70         Timestamp
+000132a0: 2827 3230 3231 2d30 312d 3033 2030 303a  ('2021-01-03 00:
+000132b0: 3030 3a30 3027 292c 0a20 2020 2020 2020  00:00'),.       
+000132c0: 2020 5469 6d65 7374 616d 7028 2732 3032    Timestamp('202
+000132d0: 312d 3031 2d30 3420 3030 3a30 303a 3030  1-01-04 00:00:00
+000132e0: 2729 2c0a 2020 2020 2020 2020 2054 696d  '),.         Tim
+000132f0: 6573 7461 6d70 2827 3230 3231 2d30 312d  estamp('2021-01-
+00013300: 3035 2030 303a 3030 3a30 3027 292c 0a20  05 00:00:00'),. 
+00013310: 2020 2020 2020 2020 5469 6d65 7374 616d          Timestam
+00013320: 7028 2732 3032 312d 3031 2d30 3620 3030  p('2021-01-06 00
+00013330: 3a30 303a 3030 2729 2c0a 2020 2020 2020  :00:00'),.      
+00013340: 2020 2054 696d 6573 7461 6d70 2827 3230     Timestamp('20
+00013350: 3231 2d30 312d 3036 2032 333a 3030 3a30  21-01-06 23:00:0
+00013360: 3027 2929 0a0a 2020 2020 2020 2020 3e3e  0'))..        >>
+00013370: 3e20 6464 662e 6469 7669 7369 6f6e 7320  > ddf.divisions 
+00013380: 3d20 6469 7669 7369 6f6e 730a 2020 2020  = divisions.    
+00013390: 2020 2020 3e3e 3e20 6464 662e 6b6e 6f77      >>> ddf.know
+000133a0: 6e5f 6469 7669 7369 6f6e 730a 2020 2020  n_divisions.    
+000133b0: 2020 2020 5472 7565 0a0a 2020 2020 2020      True..      
+000133c0: 2020 3e3e 3e20 6464 6620 3d20 6464 662e    >>> ddf = ddf.
+000133d0: 7265 7365 745f 696e 6465 7828 292e 636c  reset_index().cl
+000133e0: 6561 725f 6469 7669 7369 6f6e 7328 290a  ear_divisions().
+000133f0: 2020 2020 2020 2020 3e3e 3e20 6469 7669          >>> divi
+00013400: 7369 6f6e 7320 3d20 6464 662e 636f 6d70  sions = ddf.comp
+00013410: 7574 655f 6375 7272 656e 745f 6469 7669  ute_current_divi
+00013420: 7369 6f6e 7328 2274 696d 6573 7461 6d70  sions("timestamp
+00013430: 2229 0a20 2020 2020 2020 203e 3e3e 2070  ").        >>> p
+00013440: 7269 6e74 2864 6976 6973 696f 6e73 2920  rint(divisions) 
+00013450: 2023 2064 6f63 7465 7374 3a20 2b4e 4f52   # doctest: +NOR
+00013460: 4d41 4c49 5a45 5f57 4849 5445 5350 4143  MALIZE_WHITESPAC
+00013470: 450a 2020 2020 2020 2020 2854 696d 6573  E.        (Times
+00013480: 7461 6d70 2827 3230 3231 2d30 312d 3031  tamp('2021-01-01
+00013490: 2030 303a 3030 3a30 3027 292c 0a20 2020   00:00:00'),.   
+000134a0: 2020 2020 2020 5469 6d65 7374 616d 7028        Timestamp(
+000134b0: 2732 3032 312d 3031 2d30 3220 3030 3a30  '2021-01-02 00:0
+000134c0: 303a 3030 2729 2c0a 2020 2020 2020 2020  0:00'),.        
+000134d0: 2054 696d 6573 7461 6d70 2827 3230 3231   Timestamp('2021
+000134e0: 2d30 312d 3033 2030 303a 3030 3a30 3027  -01-03 00:00:00'
+000134f0: 292c 0a20 2020 2020 2020 2020 5469 6d65  ),.         Time
+00013500: 7374 616d 7028 2732 3032 312d 3031 2d30  stamp('2021-01-0
+00013510: 3420 3030 3a30 303a 3030 2729 2c0a 2020  4 00:00:00'),.  
+00013520: 2020 2020 2020 2054 696d 6573 7461 6d70         Timestamp
+00013530: 2827 3230 3231 2d30 312d 3035 2030 303a  ('2021-01-05 00:
+00013540: 3030 3a30 3027 292c 0a20 2020 2020 2020  00:00'),.       
+00013550: 2020 5469 6d65 7374 616d 7028 2732 3032    Timestamp('202
+00013560: 312d 3031 2d30 3620 3030 3a30 303a 3030  1-01-06 00:00:00
+00013570: 2729 2c0a 2020 2020 2020 2020 2054 696d  '),.         Tim
+00013580: 6573 7461 6d70 2827 3230 3231 2d30 312d  estamp('2021-01-
+00013590: 3036 2032 333a 3030 3a30 3027 2929 0a0a  06 23:00:00'))..
+000135a0: 2020 2020 2020 2020 3e3e 3e20 6464 6620          >>> ddf 
+000135b0: 3d20 6464 662e 7365 745f 696e 6465 7828  = ddf.set_index(
+000135c0: 2274 696d 6573 7461 6d70 222c 2064 6976  "timestamp", div
+000135d0: 6973 696f 6e73 3d64 6976 6973 696f 6e73  isions=divisions
+000135e0: 2c20 736f 7274 6564 3d54 7275 6529 0a20  , sorted=True). 
+000135f0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00013600: 2020 2069 6620 636f 6c20 6973 204e 6f6e     if col is Non
+00013610: 6520 616e 6420 7365 6c66 2e6b 6e6f 776e  e and self.known
+00013620: 5f64 6976 6973 696f 6e73 3a0a 2020 2020  _divisions:.    
+00013630: 2020 2020 2020 2020 6966 2073 6574 5f64          if set_d
+00013640: 6976 6973 696f 6e73 3a0a 2020 2020 2020  ivisions:.      
+00013650: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00013660: 2073 656c 660a 2020 2020 2020 2020 2020   self.          
+00013670: 2020 7265 7475 726e 2073 656c 662e 6469    return self.di
+00013680: 7669 7369 6f6e 730a 0a20 2020 2020 2020  visions..       
+00013690: 2069 6620 636f 6c20 6973 206e 6f74 204e   if col is not N
+000136a0: 6f6e 6520 616e 6420 7365 745f 6469 7669  one and set_divi
+000136b0: 7369 6f6e 733a 0a20 2020 2020 2020 2020  sions:.         
+000136c0: 2020 2072 6169 7365 204e 6f74 496d 706c     raise NotImpl
+000136d0: 656d 656e 7465 6445 7272 6f72 280a 2020  ementedError(.  
+000136e0: 2020 2020 2020 2020 2020 2020 2020 2243                "C
+000136f0: 616e 2774 2073 6574 2064 6976 6973 696f  an't set divisio
+00013700: 6e73 206f 6620 6e6f 6e2d 696e 6465 782c  ns of non-index,
+00013710: 2063 616c 6c20 7365 745f 696e 6465 7820   call set_index 
+00013720: 696e 7374 6561 642e 220a 2020 2020 2020  instead.".      
+00013730: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+00013740: 2069 6620 636f 6c20 6973 206e 6f74 204e   if col is not N
+00013750: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+00013760: 2066 7261 6d65 203d 2073 656c 665b 636f   frame = self[co
+00013770: 6c5d 0a20 2020 2020 2020 2065 6c73 653a  l].        else:
+00013780: 0a20 2020 2020 2020 2020 2020 2066 7261  .            fra
+00013790: 6d65 203d 2073 656c 662e 696e 6465 780a  me = self.index.
+000137a0: 0a20 2020 2020 2020 206d 696e 732c 206d  .        mins, m
+000137b0: 6178 6573 2c20 6c65 6e73 203d 205f 636f  axes, lens = _co
+000137c0: 6d70 7574 655f 7061 7274 6974 696f 6e5f  mpute_partition_
+000137d0: 7374 6174 7328 6672 616d 652c 2061 6c6c  stats(frame, all
+000137e0: 6f77 5f6f 7665 726c 6170 3d73 6574 5f64  ow_overlap=set_d
+000137f0: 6976 6973 696f 6e73 290a 2020 2020 2020  ivisions).      
+00013800: 2020 6469 7669 7369 6f6e 7320 3d20 7475    divisions = tu
+00013810: 706c 6528 6d69 6e73 2920 2b20 286d 6178  ple(mins) + (max
+00013820: 6573 5b2d 315d 2c29 0a20 2020 2020 2020  es[-1],).       
+00013830: 2069 6620 6e6f 7420 7365 745f 6469 7669   if not set_divi
+00013840: 7369 6f6e 733a 0a20 2020 2020 2020 2020  sions:.         
+00013850: 2020 2072 6574 7572 6e20 6469 7669 7369     return divisi
+00013860: 6f6e 730a 2020 2020 2020 2020 6966 206c  ons.        if l
+00013870: 656e 286d 696e 7329 203d 3d20 6c65 6e28  en(mins) == len(
+00013880: 7365 6c66 2e64 6976 6973 696f 6e73 2920  self.divisions) 
+00013890: 2d20 313a 0a20 2020 2020 2020 2020 2020  - 1:.           
+000138a0: 2069 6620 6e6f 7420 616e 7928 6d69 6e73   if not any(mins
+000138b0: 5b69 5d20 3e3d 206d 6178 6573 5b69 202d  [i] >= maxes[i -
+000138c0: 2031 5d20 666f 7220 6920 696e 2072 616e   1] for i in ran
+000138d0: 6765 2831 2c20 6c65 6e28 6d69 6e73 2929  ge(1, len(mins))
+000138e0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+000138f0: 2020 2072 6574 7572 6e20 6e65 775f 636f     return new_co
+00013900: 6c6c 6563 7469 6f6e 2865 7870 722e 5365  llection(expr.Se
+00013910: 7444 6976 6973 696f 6e73 2873 656c 662c  tDivisions(self,
+00013920: 2064 6976 6973 696f 6e73 2929 0a0a 2020   divisions))..  
+00013930: 2020 2020 2020 7265 7475 726e 206e 6577        return new
+00013940: 5f63 6f6c 6c65 6374 696f 6e28 6578 7072  _collection(expr
+00013950: 2e52 6573 6f6c 7665 4f76 6572 6c61 7070  .ResolveOverlapp
+00013960: 696e 6744 6976 6973 696f 6e73 2873 656c  ingDivisions(sel
+00013970: 662c 206d 696e 732c 206d 6178 6573 2c20  f, mins, maxes, 
+00013980: 6c65 6e73 2929 0a0a 2020 2020 4063 6c61  lens))..    @cla
+00013990: 7373 6d65 7468 6f64 0a20 2020 2064 6566  ssmethod.    def
+000139a0: 2066 726f 6d5f 6469 6374 280a 2020 2020   from_dict(.    
+000139b0: 2020 2020 636c 732c 2064 6174 612c 202a      cls, data, *
+000139c0: 2c20 6e70 6172 7469 7469 6f6e 733d 312c  , npartitions=1,
+000139d0: 206f 7269 656e 743d 2263 6f6c 756d 6e73   orient="columns
+000139e0: 222c 2064 7479 7065 3d4e 6f6e 652c 2063  ", dtype=None, c
+000139f0: 6f6c 756d 6e73 3d4e 6f6e 650a 2020 2020  olumns=None.    
+00013a00: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+00013a10: 2020 2020 2020 2043 6f6e 7374 7275 6374         Construct
+00013a20: 2061 2044 6173 6b20 4461 7461 4672 616d   a Dask DataFram
+00013a30: 6520 6672 6f6d 2061 2050 7974 686f 6e20  e from a Python 
+00013a40: 4469 6374 696f 6e61 7279 0a0a 2020 2020  Dictionary..    
+00013a50: 2020 2020 5365 6520 416c 736f 0a20 2020      See Also.   
+00013a60: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
+00013a70: 2020 2020 2020 6461 736b 2e64 6174 6166        dask.dataf
+00013a80: 7261 6d65 2e66 726f 6d5f 6469 6374 0a20  rame.from_dict. 
+00013a90: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00013aa0: 2020 2072 6574 7572 6e20 6672 6f6d 5f64     return from_d
+00013ab0: 6963 7428 6461 7461 2c20 6e70 6172 7469  ict(data, nparti
+00013ac0: 7469 6f6e 732c 206f 7269 656e 742c 2064  tions, orient, d
+00013ad0: 7479 7065 3d64 7479 7065 2c20 636f 6c75  type=dtype, colu
+00013ae0: 6d6e 733d 636f 6c75 6d6e 7329 0a0a 2020  mns=columns)..  
+00013af0: 2020 6465 6620 746f 5f6a 736f 6e28 7365    def to_json(se
+00013b00: 6c66 2c20 6669 6c65 6e61 6d65 2c20 2a61  lf, filename, *a
+00013b10: 7267 732c 202a 2a6b 7761 7267 7329 3a0a  rgs, **kwargs):.
+00013b20: 2020 2020 2020 2020 2222 2253 6565 2064          """See d
+00013b30: 642e 746f 5f6a 736f 6e20 646f 6373 7472  d.to_json docstr
+00013b40: 696e 6720 666f 7220 6d6f 7265 2069 6e66  ing for more inf
+00013b50: 6f72 6d61 7469 6f6e 2222 220a 2020 2020  ormation""".    
+00013b60: 2020 2020 6672 6f6d 2064 6173 6b2e 6461      from dask.da
+00013b70: 7461 6672 616d 652e 696f 2069 6d70 6f72  taframe.io impor
+00013b80: 7420 746f 5f6a 736f 6e0a 0a20 2020 2020  t to_json..     
+00013b90: 2020 2072 6574 7572 6e20 746f 5f6a 736f     return to_jso
+00013ba0: 6e28 7365 6c66 2c20 6669 6c65 6e61 6d65  n(self, filename
+00013bb0: 2c20 2a61 7267 732c 202a 2a6b 7761 7267  , *args, **kwarg
+00013bc0: 7329 0a0a 2020 2020 6465 6620 746f 5f73  s)..    def to_s
+00013bd0: 716c 280a 2020 2020 2020 2020 7365 6c66  ql(.        self
+00013be0: 2c0a 2020 2020 2020 2020 6e61 6d65 3a20  ,.        name: 
+00013bf0: 7374 722c 0a20 2020 2020 2020 2075 7269  str,.        uri
+00013c00: 3a20 7374 722c 0a20 2020 2020 2020 2073  : str,.        s
+00013c10: 6368 656d 613d 4e6f 6e65 2c0a 2020 2020  chema=None,.    
+00013c20: 2020 2020 6966 5f65 7869 7374 733a 2073      if_exists: s
+00013c30: 7472 203d 2022 6661 696c 222c 0a20 2020  tr = "fail",.   
+00013c40: 2020 2020 2069 6e64 6578 3a20 626f 6f6c       index: bool
+00013c50: 203d 2054 7275 652c 0a20 2020 2020 2020   = True,.       
+00013c60: 2069 6e64 6578 5f6c 6162 656c 3d4e 6f6e   index_label=Non
+00013c70: 652c 0a20 2020 2020 2020 2063 6875 6e6b  e,.        chunk
+00013c80: 7369 7a65 3d4e 6f6e 652c 0a20 2020 2020  size=None,.     
+00013c90: 2020 2064 7479 7065 3d4e 6f6e 652c 0a20     dtype=None,. 
+00013ca0: 2020 2020 2020 206d 6574 686f 643d 4e6f         method=No
+00013cb0: 6e65 2c0a 2020 2020 2020 2020 636f 6d70  ne,.        comp
+00013cc0: 7574 653d 5472 7565 2c0a 2020 2020 2020  ute=True,.      
+00013cd0: 2020 7061 7261 6c6c 656c 3d46 616c 7365    parallel=False
+00013ce0: 2c0a 2020 2020 2020 2020 656e 6769 6e65  ,.        engine
+00013cf0: 5f6b 7761 7267 733d 4e6f 6e65 2c0a 2020  _kwargs=None,.  
+00013d00: 2020 293a 0a20 2020 2020 2020 2066 726f    ):.        fro
+00013d10: 6d20 6461 736b 5f65 7870 722e 696f 2e73  m dask_expr.io.s
+00013d20: 716c 2069 6d70 6f72 7420 746f 5f73 716c  ql import to_sql
+00013d30: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00013d40: 2074 6f5f 7371 6c28 0a20 2020 2020 2020   to_sql(.       
+00013d50: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+00013d60: 2020 2020 2020 206e 616d 652c 0a20 2020         name,.   
+00013d70: 2020 2020 2020 2020 2075 7269 2c0a 2020           uri,.  
+00013d80: 2020 2020 2020 2020 2020 7363 6865 6d61            schema
+00013d90: 3d73 6368 656d 612c 0a20 2020 2020 2020  =schema,.       
+00013da0: 2020 2020 2069 665f 6578 6973 7473 3d69       if_exists=i
+00013db0: 665f 6578 6973 7473 2c0a 2020 2020 2020  f_exists,.      
+00013dc0: 2020 2020 2020 696e 6465 783d 696e 6465        index=inde
+00013dd0: 782c 0a20 2020 2020 2020 2020 2020 2069  x,.            i
+00013de0: 6e64 6578 5f6c 6162 656c 3d69 6e64 6578  ndex_label=index
+00013df0: 5f6c 6162 656c 2c0a 2020 2020 2020 2020  _label,.        
+00013e00: 2020 2020 6368 756e 6b73 697a 653d 6368      chunksize=ch
+00013e10: 756e 6b73 697a 652c 0a20 2020 2020 2020  unksize,.       
+00013e20: 2020 2020 2064 7479 7065 3d64 7479 7065       dtype=dtype
+00013e30: 2c0a 2020 2020 2020 2020 2020 2020 6d65  ,.            me
+00013e40: 7468 6f64 3d6d 6574 686f 642c 0a20 2020  thod=method,.   
+00013e50: 2020 2020 2020 2020 2063 6f6d 7075 7465           compute
+00013e60: 3d63 6f6d 7075 7465 2c0a 2020 2020 2020  =compute,.      
+00013e70: 2020 2020 2020 7061 7261 6c6c 656c 3d70        parallel=p
+00013e80: 6172 616c 6c65 6c2c 0a20 2020 2020 2020  arallel,.       
+00013e90: 2020 2020 2065 6e67 696e 655f 6b77 6172       engine_kwar
+00013ea0: 6773 3d65 6e67 696e 655f 6b77 6172 6773  gs=engine_kwargs
+00013eb0: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
+00013ec0: 2064 6566 2074 6f5f 6f72 6328 7365 6c66   def to_orc(self
+00013ed0: 2c20 7061 7468 2c20 2a61 7267 732c 202a  , path, *args, *
+00013ee0: 2a6b 7761 7267 7329 3a0a 2020 2020 2020  *kwargs):.      
+00013ef0: 2020 2222 2253 6565 2064 642e 746f 5f6f    """See dd.to_o
+00013f00: 7263 2064 6f63 7374 7269 6e67 2066 6f72  rc docstring for
+00013f10: 206d 6f72 6520 696e 666f 726d 6174 696f   more informatio
+00013f20: 6e22 2222 0a20 2020 2020 2020 2066 726f  n""".        fro
+00013f30: 6d20 6461 736b 5f65 7870 722e 696f 2e6f  m dask_expr.io.o
+00013f40: 7263 2069 6d70 6f72 7420 746f 5f6f 7263  rc import to_orc
+00013f50: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00013f60: 2074 6f5f 6f72 6328 7365 6c66 2c20 7061   to_orc(self, pa
+00013f70: 7468 2c20 2a61 7267 732c 202a 2a6b 7761  th, *args, **kwa
+00013f80: 7267 7329 0a0a 2020 2020 6465 6620 746f  rgs)..    def to
+00013f90: 5f63 7376 2873 656c 662c 2066 696c 656e  _csv(self, filen
+00013fa0: 616d 652c 202a 2a6b 7761 7267 7329 3a0a  ame, **kwargs):.
+00013fb0: 2020 2020 2020 2020 2222 2253 6565 2064          """See d
+00013fc0: 642e 746f 5f63 7376 2064 6f63 7374 7269  d.to_csv docstri
+00013fd0: 6e67 2066 6f72 206d 6f72 6520 696e 666f  ng for more info
+00013fe0: 726d 6174 696f 6e22 2222 0a20 2020 2020  rmation""".     
+00013ff0: 2020 2066 726f 6d20 6461 736b 5f65 7870     from dask_exp
+00014000: 722e 696f 2e63 7376 2069 6d70 6f72 7420  r.io.csv import 
+00014010: 746f 5f63 7376 0a0a 2020 2020 2020 2020  to_csv..        
+00014020: 7265 7475 726e 2074 6f5f 6373 7628 7365  return to_csv(se
+00014030: 6c66 2c20 6669 6c65 6e61 6d65 2c20 2a2a  lf, filename, **
+00014040: 6b77 6172 6773 290a 0a20 2020 2064 6566  kwargs)..    def
+00014050: 2074 6f5f 7265 636f 7264 7328 7365 6c66   to_records(self
+00014060: 2c20 696e 6465 783d 4661 6c73 652c 206c  , index=False, l
+00014070: 656e 6774 6873 3d4e 6f6e 6529 3a0a 2020  engths=None):.  
+00014080: 2020 2020 2020 6672 6f6d 2064 6173 6b5f        from dask_
+00014090: 6578 7072 2e69 6f2e 7265 636f 7264 7320  expr.io.records 
+000140a0: 696d 706f 7274 2074 6f5f 7265 636f 7264  import to_record
+000140b0: 730a 0a20 2020 2020 2020 2069 6620 6c65  s..        if le
+000140c0: 6e67 7468 7320 6973 2054 7275 653a 0a20  ngths is True:. 
+000140d0: 2020 2020 2020 2020 2020 206c 656e 6774             lengt
+000140e0: 6873 203d 2074 7570 6c65 2873 656c 662e  hs = tuple(self.
+000140f0: 6d61 705f 7061 7274 6974 696f 6e73 286c  map_partitions(l
+00014100: 656e 292e 636f 6d70 7574 6528 2929 0a0a  en).compute())..
+00014110: 2020 2020 2020 2020 6672 616d 6520 3d20          frame = 
+00014120: 7365 6c66 2e74 6f5f 6c65 6761 6379 5f64  self.to_legacy_d
+00014130: 6174 6166 7261 6d65 2829 0a20 2020 2020  ataframe().     
+00014140: 2020 2072 6563 6f72 6473 203d 2074 6f5f     records = to_
+00014150: 7265 636f 7264 7328 6672 616d 6529 0a0a  records(frame)..
+00014160: 2020 2020 2020 2020 6368 756e 6b73 203d          chunks =
+00014170: 2066 7261 6d65 2e5f 7661 6c69 6461 7465   frame._validate
+00014180: 5f63 6875 6e6b 7328 7265 636f 7264 732c  _chunks(records,
+00014190: 206c 656e 6774 6873 290a 2020 2020 2020   lengths).      
+000141a0: 2020 7265 636f 7264 732e 5f63 6875 6e6b    records._chunk
+000141b0: 7320 3d20 2863 6875 6e6b 735b 305d 2c29  s = (chunks[0],)
+000141c0: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+000141d0: 2072 6563 6f72 6473 0a0a 2020 2020 6465   records..    de
+000141e0: 6620 746f 5f62 6167 2873 656c 662c 2069  f to_bag(self, i
+000141f0: 6e64 6578 3d46 616c 7365 2c20 666f 726d  ndex=False, form
+00014200: 6174 3d22 7475 706c 6522 293a 0a20 2020  at="tuple"):.   
+00014210: 2020 2020 2022 2222 4372 6561 7465 2061       """Create a
+00014220: 2044 6173 6b20 4261 6720 6672 6f6d 2061   Dask Bag from a
+00014230: 2053 6572 6965 7322 2222 0a20 2020 2020   Series""".     
+00014240: 2020 2066 726f 6d20 6461 736b 5f65 7870     from dask_exp
+00014250: 722e 696f 2e62 6167 2069 6d70 6f72 7420  r.io.bag import 
+00014260: 746f 5f62 6167 0a0a 2020 2020 2020 2020  to_bag..        
+00014270: 7265 7475 726e 2074 6f5f 6261 6728 7365  return to_bag(se
+00014280: 6c66 2c20 696e 6465 782c 2066 6f72 6d61  lf, index, forma
+00014290: 743d 666f 726d 6174 290a 0a20 2020 2064  t=format)..    d
+000142a0: 6566 2074 6f5f 6864 6628 7365 6c66 2c20  ef to_hdf(self, 
+000142b0: 7061 7468 5f6f 725f 6275 662c 206b 6579  path_or_buf, key
+000142c0: 2c20 6d6f 6465 3d22 6122 2c20 6170 7065  , mode="a", appe
+000142d0: 6e64 3d46 616c 7365 2c20 2a2a 6b77 6172  nd=False, **kwar
+000142e0: 6773 293a 0a20 2020 2020 2020 2022 2222  gs):.        """
+000142f0: 5365 6520 6464 2e74 6f5f 6864 6620 646f  See dd.to_hdf do
+00014300: 6373 7472 696e 6720 666f 7220 6d6f 7265  cstring for more
+00014310: 2069 6e66 6f72 6d61 7469 6f6e 2222 220a   information""".
+00014320: 2020 2020 2020 2020 6672 6f6d 2064 6173          from das
+00014330: 6b5f 6578 7072 2e69 6f2e 6864 6620 696d  k_expr.io.hdf im
+00014340: 706f 7274 2074 6f5f 6864 660a 0a20 2020  port to_hdf..   
+00014350: 2020 2020 2072 6574 7572 6e20 746f 5f68       return to_h
+00014360: 6466 2873 656c 662c 2070 6174 685f 6f72  df(self, path_or
+00014370: 5f62 7566 2c20 6b65 792c 206d 6f64 652c  _buf, key, mode,
+00014380: 2061 7070 656e 642c 202a 2a6b 7761 7267   append, **kwarg
+00014390: 7329 0a0a 2020 2020 6465 6620 746f 5f64  s)..    def to_d
+000143a0: 656c 6179 6564 2873 656c 662c 206f 7074  elayed(self, opt
+000143b0: 696d 697a 655f 6772 6170 683d 5472 7565  imize_graph=True
+000143c0: 293a 0a20 2020 2020 2020 2022 2222 436f  ):.        """Co
+000143d0: 6e76 6572 7420 696e 746f 2061 206c 6973  nvert into a lis
+000143e0: 7420 6f66 2060 6064 6173 6b2e 6465 6c61  t of ``dask.dela
+000143f0: 7965 6460 6020 6f62 6a65 6374 732c 206f  yed`` objects, o
+00014400: 6e65 2070 6572 2070 6172 7469 7469 6f6e  ne per partition
+00014410: 2e0a 0a20 2020 2020 2020 2050 6172 616d  ...        Param
+00014420: 6574 6572 730a 2020 2020 2020 2020 2d2d  eters.        --
+00014430: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00014440: 206f 7074 696d 697a 655f 6772 6170 6820   optimize_graph 
+00014450: 3a20 626f 6f6c 2c20 6f70 7469 6f6e 616c  : bool, optional
+00014460: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
+00014470: 5472 7565 205b 6465 6661 756c 745d 2c20  True [default], 
+00014480: 7468 6520 6772 6170 6820 6973 206f 7074  the graph is opt
+00014490: 696d 697a 6564 2062 6566 6f72 6520 636f  imized before co
+000144a0: 6e76 6572 7469 6e67 2069 6e74 6f0a 2020  nverting into.  
+000144b0: 2020 2020 2020 2020 2020 6060 6461 736b            ``dask
+000144c0: 2e64 656c 6179 6564 6060 206f 626a 6563  .delayed`` objec
+000144d0: 7473 2e0a 0a20 2020 2020 2020 2045 7861  ts...        Exa
+000144e0: 6d70 6c65 730a 2020 2020 2020 2020 2d2d  mples.        --
+000144f0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203e  ------.        >
+00014500: 3e3e 2070 6172 7469 7469 6f6e 7320 3d20  >> partitions = 
+00014510: 6466 2e74 6f5f 6465 6c61 7965 6428 2920  df.to_delayed() 
+00014520: 2023 2064 6f63 7465 7374 3a20 2b53 4b49   # doctest: +SKI
+00014530: 500a 0a20 2020 2020 2020 2053 6565 2041  P..        See A
+00014540: 6c73 6f0a 2020 2020 2020 2020 2d2d 2d2d  lso.        ----
+00014550: 2d2d 2d2d 0a20 2020 2020 2020 2064 6173  ----.        das
+00014560: 6b5f 6578 7072 2e66 726f 6d5f 6465 6c61  k_expr.from_dela
+00014570: 7965 640a 2020 2020 2020 2020 2222 220a  yed.        """.
+00014580: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00014590: 656c 662e 746f 5f6c 6567 6163 795f 6461  elf.to_legacy_da
+000145a0: 7461 6672 616d 6528 292e 746f 5f64 656c  taframe().to_del
+000145b0: 6179 6564 286f 7074 696d 697a 655f 6772  ayed(optimize_gr
+000145c0: 6170 683d 6f70 7469 6d69 7a65 5f67 7261  aph=optimize_gra
+000145d0: 7068 290a 0a20 2020 2064 6566 2074 6f5f  ph)..    def to_
+000145e0: 6261 636b 656e 6428 7365 6c66 2c20 6261  backend(self, ba
+000145f0: 636b 656e 643a 2073 7472 207c 204e 6f6e  ckend: str | Non
+00014600: 6520 3d20 4e6f 6e65 2c20 2a2a 6b77 6172  e = None, **kwar
+00014610: 6773 293a 0a20 2020 2020 2020 2022 2222  gs):.        """
+00014620: 4d6f 7665 2074 6f20 6120 6e65 7720 4461  Move to a new Da
+00014630: 7461 4672 616d 6520 6261 636b 656e 640a  taFrame backend.
+00014640: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+00014650: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
+00014660: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2062  ------.        b
+00014670: 6163 6b65 6e64 203a 2073 7472 2c20 4f70  ackend : str, Op
+00014680: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
+00014690: 2020 2054 6865 206e 616d 6520 6f66 2074     The name of t
+000146a0: 6865 206e 6577 2062 6163 6b65 6e64 2074  he new backend t
+000146b0: 6f20 6d6f 7665 2074 6f2e 2054 6865 2064  o move to. The d
+000146c0: 6566 6175 6c74 0a20 2020 2020 2020 2020  efault.         
+000146d0: 2020 2069 7320 7468 6520 6375 7272 656e     is the curren
+000146e0: 7420 2264 6174 6166 7261 6d65 2e62 6163  t "dataframe.bac
+000146f0: 6b65 6e64 2220 636f 6e66 6967 7572 6174  kend" configurat
+00014700: 696f 6e2e 0a0a 2020 2020 2020 2020 5265  ion...        Re
+00014710: 7475 726e 730a 2020 2020 2020 2020 2d2d  turns.        --
+00014720: 2d2d 2d2d 2d0a 2020 2020 2020 2020 4461  -----.        Da
+00014730: 7461 4672 616d 652c 2053 6572 6965 7320  taFrame, Series 
+00014740: 6f72 2049 6e64 6578 0a20 2020 2020 2020  or Index.       
+00014750: 2022 2222 0a20 2020 2020 2020 2066 726f   """.        fro
+00014760: 6d20 6461 736b 5f65 7870 722e 5f62 6163  m dask_expr._bac
+00014770: 6b65 6e64 7320 696d 706f 7274 2064 6174  kends import dat
+00014780: 6166 7261 6d65 5f63 7265 6174 696f 6e5f  aframe_creation_
+00014790: 6469 7370 6174 6368 0a0a 2020 2020 2020  dispatch..      
+000147a0: 2020 2320 4765 7420 6465 7369 7265 6420    # Get desired 
+000147b0: 6261 636b 656e 640a 2020 2020 2020 2020  backend.        
+000147c0: 6261 636b 656e 6420 3d20 6261 636b 656e  backend = backen
+000147d0: 6420 6f72 2064 6174 6166 7261 6d65 5f63  d or dataframe_c
+000147e0: 7265 6174 696f 6e5f 6469 7370 6174 6368  reation_dispatch
+000147f0: 2e62 6163 6b65 6e64 0a20 2020 2020 2020  .backend.       
+00014800: 2023 2043 6865 636b 2074 6861 7420 2262   # Check that "b
+00014810: 6163 6b65 6e64 2220 6861 7320 6120 7265  ackend" has a re
+00014820: 6769 7374 6572 6564 2065 6e74 7279 706f  gistered entrypo
+00014830: 696e 740a 2020 2020 2020 2020 6261 636b  int.        back
+00014840: 656e 645f 656e 7472 7970 6f69 6e74 203d  end_entrypoint =
+00014850: 2064 6174 6166 7261 6d65 5f63 7265 6174   dataframe_creat
+00014860: 696f 6e5f 6469 7370 6174 6368 2e64 6973  ion_dispatch.dis
+00014870: 7061 7463 6828 6261 636b 656e 6429 0a20  patch(backend). 
+00014880: 2020 2020 2020 2023 2043 616c 6c20 6044         # Call `D
+00014890: 6174 6146 7261 6d65 4261 636b 656e 6445  ataFrameBackendE
+000148a0: 6e74 7279 706f 696e 742e 746f 5f62 6163  ntrypoint.to_bac
+000148b0: 6b65 6e64 600a 2020 2020 2020 2020 7265  kend`.        re
+000148c0: 7475 726e 2062 6163 6b65 6e64 5f65 6e74  turn backend_ent
+000148d0: 7279 706f 696e 742e 746f 5f62 6163 6b65  rypoint.to_backe
+000148e0: 6e64 2873 656c 662c 202a 2a6b 7761 7267  nd(self, **kwarg
+000148f0: 7329 0a0a 2020 2020 4064 6572 6976 6564  s)..    @derived
+00014900: 5f66 726f 6d28 7064 2e53 6572 6965 7329  _from(pd.Series)
+00014910: 0a20 2020 2064 6566 2064 6f74 2873 656c  .    def dot(sel
+00014920: 662c 206f 7468 6572 2c20 6d65 7461 3d6e  f, other, meta=n
+00014930: 6f5f 6465 6661 756c 7429 3a0a 2020 2020  o_default):.    
+00014940: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
+00014950: 7461 6e63 6528 6f74 6865 722c 2046 7261  tance(other, Fra
+00014960: 6d65 4261 7365 293a 0a20 2020 2020 2020  meBase):.       
+00014970: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
+00014980: 7272 6f72 2822 5468 6520 7365 636f 6e64  rror("The second
+00014990: 206f 7065 7261 6e64 206d 7573 7420 6265   operand must be
+000149a0: 2061 2064 6173 6b20 6461 7461 6672 616d   a dask datafram
+000149b0: 6522 290a 0a20 2020 2020 2020 2069 6620  e")..        if 
+000149c0: 6973 696e 7374 616e 6365 286f 7468 6572  isinstance(other
+000149d0: 2c20 4461 7461 4672 616d 6529 3a0a 2020  , DataFrame):.  
+000149e0: 2020 2020 2020 2020 2020 7320 3d20 7365            s = se
+000149f0: 6c66 2e6d 6170 5f70 6172 7469 7469 6f6e  lf.map_partition
+00014a00: 7328 4d2e 646f 742c 206f 7468 6572 2c20  s(M.dot, other, 
+00014a10: 6d65 7461 3d6d 6574 6129 0a20 2020 2020  meta=meta).     
+00014a20: 2020 2020 2020 2072 6574 7572 6e20 732e         return s.
+00014a30: 6772 6f75 7062 7928 6279 3d73 2e69 6e64  groupby(by=s.ind
+00014a40: 6578 292e 6170 706c 7928 0a20 2020 2020  ex).apply(.     
+00014a50: 2020 2020 2020 2020 2020 206c 616d 6264             lambd
+00014a60: 6120 783a 2078 2e73 756d 2873 6b69 706e  a x: x.sum(skipn
+00014a70: 613d 4661 6c73 6529 2c20 6d65 7461 3d73  a=False), meta=s
+00014a80: 2e5f 6d65 7461 5f6e 6f6e 656d 7074 790a  ._meta_nonempty.
+00014a90: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+00014aa0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00014ab0: 6c66 2e6d 6170 5f70 6172 7469 7469 6f6e  lf.map_partition
+00014ac0: 7328 5f64 6f74 5f73 6572 6965 732c 206f  s(_dot_series, o
+00014ad0: 7468 6572 2c20 6d65 7461 3d6d 6574 6129  ther, meta=meta)
+00014ae0: 2e73 756d 2873 6b69 706e 613d 4661 6c73  .sum(skipna=Fals
+00014af0: 6529 0a0a 2020 2020 4064 6572 6976 6564  e)..    @derived
+00014b00: 5f66 726f 6d28 7064 2e44 6174 6146 7261  _from(pd.DataFra
+00014b10: 6d65 290a 2020 2020 6465 6620 7069 7065  me).    def pipe
+00014b20: 2873 656c 662c 2066 756e 632c 202a 6172  (self, func, *ar
+00014b30: 6773 2c20 2a2a 6b77 6172 6773 293a 0a20  gs, **kwargs):. 
+00014b40: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+00014b50: 616e 6365 2866 756e 632c 2074 7570 6c65  ance(func, tuple
+00014b60: 293a 0a20 2020 2020 2020 2020 2020 2066  ):.            f
+00014b70: 756e 632c 2074 6172 6765 7420 3d20 6675  unc, target = fu
+00014b80: 6e63 0a20 2020 2020 2020 2020 2020 2069  nc.            i
+00014b90: 6620 7461 7267 6574 2069 6e20 6b77 6172  f target in kwar
+00014ba0: 6773 3a0a 2020 2020 2020 2020 2020 2020  gs:.            
+00014bb0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+00014bc0: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+00014bd0: 2020 2020 2020 2020 2020 2225 7320 6973            "%s is
+00014be0: 2062 6f74 6820 7468 6520 7069 7065 2074   both the pipe t
+00014bf0: 6172 6765 7420 616e 6420 6120 6b65 7977  arget and a keyw
+00014c00: 6f72 6420 6172 6775 6d65 6e74 2220 2520  ord argument" % 
+00014c10: 7461 7267 6574 0a20 2020 2020 2020 2020  target.         
+00014c20: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00014c30: 2020 2020 206b 7761 7267 735b 7461 7267       kwargs[targ
+00014c40: 6574 5d20 3d20 7365 6c66 0a20 2020 2020  et] = self.     
+00014c50: 2020 2020 2020 2072 6574 7572 6e20 6675         return fu
+00014c60: 6e63 282a 6172 6773 2c20 2a2a 6b77 6172  nc(*args, **kwar
+00014c70: 6773 290a 2020 2020 2020 2020 656c 7365  gs).        else
+00014c80: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+00014c90: 7475 726e 2066 756e 6328 7365 6c66 2c20  turn func(self, 
+00014ca0: 2a61 7267 732c 202a 2a6b 7761 7267 7329  *args, **kwargs)
+00014cb0: 0a0a 2020 2020 6465 6620 7361 6d70 6c65  ..    def sample
+00014cc0: 2873 656c 662c 206e 3d4e 6f6e 652c 2066  (self, n=None, f
+00014cd0: 7261 633d 4e6f 6e65 2c20 7265 706c 6163  rac=None, replac
+00014ce0: 653d 4661 6c73 652c 2072 616e 646f 6d5f  e=False, random_
+00014cf0: 7374 6174 653d 4e6f 6e65 293a 0a20 2020  state=None):.   
+00014d00: 2020 2020 2022 2222 5261 6e64 6f6d 2073       """Random s
+00014d10: 616d 706c 6520 6f66 2069 7465 6d73 0a0a  ample of items..
+00014d20: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+00014d30: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
+00014d40: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6e20  -----.        n 
+00014d50: 3a20 696e 742c 206f 7074 696f 6e61 6c0a  : int, optional.
+00014d60: 2020 2020 2020 2020 2020 2020 4e75 6d62              Numb
+00014d70: 6572 206f 6620 6974 656d 7320 746f 2072  er of items to r
+00014d80: 6574 7572 6e20 6973 206e 6f74 2073 7570  eturn is not sup
+00014d90: 706f 7274 6564 2062 7920 6461 736b 2e20  ported by dask. 
+00014da0: 5573 6520 6672 6163 0a20 2020 2020 2020  Use frac.       
+00014db0: 2020 2020 2069 6e73 7465 6164 2e0a 2020       instead..  
+00014dc0: 2020 2020 2020 6672 6163 203a 2066 6c6f        frac : flo
+00014dd0: 6174 2c20 6f70 7469 6f6e 616c 0a20 2020  at, optional.   
+00014de0: 2020 2020 2020 2020 2041 7070 726f 7869           Approxi
+00014df0: 6d61 7465 2066 7261 6374 696f 6e20 6f66  mate fraction of
+00014e00: 2069 7465 6d73 2074 6f20 7265 7475 726e   items to return
+00014e10: 2e20 5468 6973 2073 616d 706c 696e 6720  . This sampling 
+00014e20: 6672 6163 7469 6f6e 2069 730a 2020 2020  fraction is.    
+00014e30: 2020 2020 2020 2020 6170 706c 6965 6420          applied 
+00014e40: 746f 2061 6c6c 2070 6172 7469 7469 6f6e  to all partition
+00014e50: 7320 6571 7561 6c6c 792e 204e 6f74 6520  s equally. Note 
+00014e60: 7468 6174 2074 6869 7320 6973 2061 6e0a  that this is an.
+00014e70: 2020 2020 2020 2020 2020 2020 2a2a 6170              **ap
+00014e80: 7072 6f78 696d 6174 6520 6672 6163 7469  proximate fracti
+00014e90: 6f6e 2a2a 2e20 596f 7520 7368 6f75 6c64  on**. You should
+00014ea0: 206e 6f74 2065 7870 6563 7420 6578 6163   not expect exac
+00014eb0: 746c 7920 6060 6c65 6e28 6466 2920 2a20  tly ``len(df) * 
+00014ec0: 6672 6163 6060 0a20 2020 2020 2020 2020  frac``.         
+00014ed0: 2020 2069 7465 6d73 2074 6f20 6265 2072     items to be r
+00014ee0: 6574 7572 6e65 642c 2061 7320 7468 6520  eturned, as the 
+00014ef0: 6578 6163 7420 6e75 6d62 6572 206f 6620  exact number of 
+00014f00: 656c 656d 656e 7473 2073 656c 6563 7465  elements selecte
+00014f10: 6420 7769 6c6c 0a20 2020 2020 2020 2020  d will.         
+00014f20: 2020 2064 6570 656e 6420 6f6e 2068 6f77     depend on how
+00014f30: 2079 6f75 7220 6461 7461 2069 7320 7061   your data is pa
+00014f40: 7274 6974 696f 6e65 6420 2862 7574 2073  rtitioned (but s
+00014f50: 686f 756c 6420 6265 2070 7265 7474 7920  hould be pretty 
+00014f60: 636c 6f73 650a 2020 2020 2020 2020 2020  close.          
+00014f70: 2020 696e 2070 7261 6374 6963 6529 2e0a    in practice)..
+00014f80: 2020 2020 2020 2020 7265 706c 6163 6520          replace 
+00014f90: 3a20 626f 6f6c 6561 6e2c 206f 7074 696f  : boolean, optio
+00014fa0: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
+00014fb0: 5361 6d70 6c65 2077 6974 6820 6f72 2077  Sample with or w
+00014fc0: 6974 686f 7574 2072 6570 6c61 6365 6d65  ithout replaceme
+00014fd0: 6e74 2e20 4465 6661 756c 7420 3d20 4661  nt. Default = Fa
+00014fe0: 6c73 652e 0a20 2020 2020 2020 2072 616e  lse..        ran
+00014ff0: 646f 6d5f 7374 6174 6520 3a20 696e 7420  dom_state : int 
+00015000: 6f72 2060 606e 702e 7261 6e64 6f6d 2e52  or ``np.random.R
+00015010: 616e 646f 6d53 7461 7465 6060 0a20 2020  andomState``.   
+00015020: 2020 2020 2020 2020 2049 6620 616e 2069           If an i
+00015030: 6e74 2c20 7765 2063 7265 6174 6520 6120  nt, we create a 
+00015040: 6e65 7720 5261 6e64 6f6d 5374 6174 6520  new RandomState 
+00015050: 7769 7468 2074 6869 7320 6173 2074 6865  with this as the
+00015060: 2073 6565 643b 0a20 2020 2020 2020 2020   seed;.         
+00015070: 2020 204f 7468 6572 7769 7365 2077 6520     Otherwise we 
+00015080: 6472 6177 2066 726f 6d20 7468 6520 7061  draw from the pa
+00015090: 7373 6564 2052 616e 646f 6d53 7461 7465  ssed RandomState
+000150a0: 2e0a 0a20 2020 2020 2020 2053 6565 2041  ...        See A
+000150b0: 6c73 6f0a 2020 2020 2020 2020 2d2d 2d2d  lso.        ----
+000150c0: 2d2d 2d2d 0a20 2020 2020 2020 2044 6174  ----.        Dat
+000150d0: 6146 7261 6d65 2e72 616e 646f 6d5f 7370  aFrame.random_sp
+000150e0: 6c69 740a 2020 2020 2020 2020 7061 6e64  lit.        pand
+000150f0: 6173 2e44 6174 6146 7261 6d65 2e73 616d  as.DataFrame.sam
+00015100: 706c 650a 2020 2020 2020 2020 2222 220a  ple.        """.
+00015110: 2020 2020 2020 2020 6966 206e 2069 7320          if n is 
+00015120: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+00015130: 2020 2020 2020 6d73 6720 3d20 280a 2020        msg = (.  
+00015140: 2020 2020 2020 2020 2020 2020 2020 2273                "s
+00015150: 616d 706c 6520 646f 6573 206e 6f74 2073  ample does not s
+00015160: 7570 706f 7274 2074 6865 206e 756d 6265  upport the numbe
+00015170: 7220 6f66 2073 616d 706c 6564 2069 7465  r of sampled ite
+00015180: 6d73 2022 0a20 2020 2020 2020 2020 2020  ms ".           
+00015190: 2020 2020 2022 7061 7261 6d65 7465 722c       "parameter,
+000151a0: 2027 6e27 2e20 506c 6561 7365 2075 7365   'n'. Please use
+000151b0: 2074 6865 2027 6672 6163 2720 7061 7261   the 'frac' para
+000151c0: 6d65 7465 7220 696e 7374 6561 642e 220a  meter instead.".
+000151d0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+000151e0: 2020 2020 2020 2020 2020 6966 2069 7369            if isi
+000151f0: 6e73 7461 6e63 6528 6e2c 204e 756d 6265  nstance(n, Numbe
+00015200: 7229 2061 6e64 2030 203c 3d20 6e20 3c3d  r) and 0 <= n <=
+00015210: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
+00015220: 2020 2020 7761 726e 696e 6773 2e77 6172      warnings.war
+00015230: 6e28 6d73 6729 0a20 2020 2020 2020 2020  n(msg).         
+00015240: 2020 2020 2020 2066 7261 6320 3d20 6e0a         frac = n.
+00015250: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00015260: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00015270: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+00015280: 6f72 286d 7367 290a 0a20 2020 2020 2020  or(msg)..       
+00015290: 2069 6620 6672 6163 2069 7320 4e6f 6e65   if frac is None
+000152a0: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+000152b0: 6973 6520 5661 6c75 6545 7272 6f72 2822  ise ValueError("
+000152c0: 6672 6163 206d 7573 7420 6e6f 7420 6265  frac must not be
+000152d0: 204e 6f6e 6522 290a 0a20 2020 2020 2020   None")..       
+000152e0: 2069 6620 7261 6e64 6f6d 5f73 7461 7465   if random_state
+000152f0: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
+00015300: 2020 2020 2020 7261 6e64 6f6d 5f73 7461        random_sta
+00015310: 7465 203d 206e 702e 7261 6e64 6f6d 2e52  te = np.random.R
+00015320: 616e 646f 6d53 7461 7465 2829 0a0a 2020  andomState()..  
+00015330: 2020 2020 2020 7374 6174 655f 6461 7461        state_data
+00015340: 203d 2072 616e 646f 6d5f 7374 6174 655f   = random_state_
+00015350: 6461 7461 2873 656c 662e 6e70 6172 7469  data(self.nparti
+00015360: 7469 6f6e 732c 2072 616e 646f 6d5f 7374  tions, random_st
+00015370: 6174 6529 0a20 2020 2020 2020 2072 6574  ate).        ret
+00015380: 7572 6e20 6e65 775f 636f 6c6c 6563 7469  urn new_collecti
+00015390: 6f6e 280a 2020 2020 2020 2020 2020 2020  on(.            
+000153a0: 6578 7072 2e53 616d 706c 6528 7365 6c66  expr.Sample(self
+000153b0: 2c20 7374 6174 655f 6461 7461 3d73 7461  , state_data=sta
+000153c0: 7465 5f64 6174 612c 2066 7261 633d 6672  te_data, frac=fr
+000153d0: 6163 2c20 7265 706c 6163 653d 7265 706c  ac, replace=repl
+000153e0: 6163 6529 0a20 2020 2020 2020 2029 0a0a  ace).        )..
+000153f0: 2020 2020 6465 6620 5f72 6570 725f 6461      def _repr_da
+00015400: 7461 2873 656c 6629 3a0a 2020 2020 2020  ta(self):.      
+00015410: 2020 7261 6973 6520 4e6f 7449 6d70 6c65    raise NotImple
+00015420: 6d65 6e74 6564 4572 726f 720a 0a20 2020  mentedError..   
+00015430: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+00015440: 6566 205f 7265 7072 5f64 6976 6973 696f  ef _repr_divisio
+00015450: 6e73 2873 656c 6629 3a0a 2020 2020 2020  ns(self):.      
+00015460: 2020 6e61 6d65 203d 2066 226e 7061 7274    name = f"npart
+00015470: 6974 696f 6e73 3d7b 7365 6c66 2e6e 7061  itions={self.npa
+00015480: 7274 6974 696f 6e73 7d22 0a20 2020 2020  rtitions}".     
+00015490: 2020 2069 6620 7365 6c66 2e6b 6e6f 776e     if self.known
+000154a0: 5f64 6976 6973 696f 6e73 3a0a 2020 2020  _divisions:.    
+000154b0: 2020 2020 2020 2020 6469 7669 7369 6f6e          division
+000154c0: 7320 3d20 7064 2e49 6e64 6578 2873 656c  s = pd.Index(sel
+000154d0: 662e 6469 7669 7369 6f6e 732c 206e 616d  f.divisions, nam
+000154e0: 653d 6e61 6d65 290a 2020 2020 2020 2020  e=name).        
+000154f0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00015500: 2020 2320 6176 6f69 6420 746f 2062 6520    # avoid to be 
+00015510: 636f 6e76 6572 7465 6420 746f 204e 614e  converted to NaN
+00015520: 0a20 2020 2020 2020 2020 2020 2064 6976  .            div
+00015530: 6973 696f 6e73 203d 2070 642e 496e 6465  isions = pd.Inde
+00015540: 7828 5b22 225d 202a 2028 7365 6c66 2e6e  x([""] * (self.n
+00015550: 7061 7274 6974 696f 6e73 202b 2031 292c  partitions + 1),
+00015560: 206e 616d 653d 6e61 6d65 290a 2020 2020   name=name).    
+00015570: 2020 2020 7265 7475 726e 2064 6976 6973      return divis
+00015580: 696f 6e73 0a0a 0a64 6566 205f 646f 745f  ions...def _dot_
+00015590: 7365 7269 6573 282a 6172 6773 2c20 2a2a  series(*args, **
+000155a0: 6b77 6172 6773 293a 0a20 2020 2023 202e  kwargs):.    # .
+000155b0: 7375 6d28 2920 6973 2069 6e76 6f6b 6564  sum() is invoked
+000155c0: 206f 6e20 6561 6368 2070 6172 7469 7469   on each partiti
+000155d0: 6f6e 2062 6566 6f72 6520 6265 696e 6720  on before being 
+000155e0: 6170 706c 6965 6420 746f 2061 6c6c 0a20  applied to all. 
+000155f0: 2020 2023 2070 6172 7469 7469 6f6e 732e     # partitions.
+00015600: 2054 6865 2072 6574 7572 6e20 7479 7065   The return type
+00015610: 2069 7320 6578 7065 6374 6564 2074 6f20   is expected to 
+00015620: 6265 2061 2073 6572 6965 732c 206e 6f74  be a series, not
+00015630: 2061 206e 756d 7079 206f 626a 6563 740a   a numpy object.
+00015640: 2020 2020 7265 7475 726e 206d 6574 615f      return meta_
+00015650: 7365 7269 6573 5f63 6f6e 7374 7275 6374  series_construct
+00015660: 6f72 2861 7267 735b 305d 2928 4d2e 646f  or(args[0])(M.do
+00015670: 7428 2a61 7267 732c 202a 2a6b 7761 7267  t(*args, **kwarg
+00015680: 7329 290a 0a0a 2320 4164 6420 6f70 6572  s))...# Add oper
+00015690: 6174 6f72 2061 7474 7269 6275 7465 730a  ator attributes.
+000156a0: 666f 7220 6f70 2069 6e20 5b0a 2020 2020  for op in [.    
+000156b0: 225f 5f61 6464 5f5f 222c 0a20 2020 2022  "__add__",.    "
+000156c0: 5f5f 7261 6464 5f5f 222c 0a20 2020 2022  __radd__",.    "
+000156d0: 5f5f 7375 625f 5f22 2c0a 2020 2020 225f  __sub__",.    "_
+000156e0: 5f72 7375 625f 5f22 2c0a 2020 2020 225f  _rsub__",.    "_
+000156f0: 5f6d 756c 5f5f 222c 0a20 2020 2022 5f5f  _mul__",.    "__
+00015700: 726d 756c 5f5f 222c 0a20 2020 2022 5f5f  rmul__",.    "__
+00015710: 6d6f 645f 5f22 2c0a 2020 2020 225f 5f72  mod__",.    "__r
+00015720: 6d6f 645f 5f22 2c0a 2020 2020 225f 5f66  mod__",.    "__f
+00015730: 6c6f 6f72 6469 765f 5f22 2c0a 2020 2020  loordiv__",.    
+00015740: 225f 5f72 666c 6f6f 7264 6976 5f5f 222c  "__rfloordiv__",
+00015750: 0a20 2020 2022 5f5f 7472 7565 6469 765f  .    "__truediv_
+00015760: 5f22 2c0a 2020 2020 225f 5f72 7472 7565  _",.    "__rtrue
+00015770: 6469 765f 5f22 2c0a 2020 2020 225f 5f70  div__",.    "__p
+00015780: 6f77 5f5f 222c 0a20 2020 2022 5f5f 7270  ow__",.    "__rp
+00015790: 6f77 5f5f 222c 0a20 2020 2022 5f5f 6c74  ow__",.    "__lt
+000157a0: 5f5f 222c 0a20 2020 2022 5f5f 726c 745f  __",.    "__rlt_
+000157b0: 5f22 2c0a 2020 2020 225f 5f67 745f 5f22  _",.    "__gt__"
+000157c0: 2c0a 2020 2020 225f 5f72 6774 5f5f 222c  ,.    "__rgt__",
+000157d0: 0a20 2020 2022 5f5f 6c65 5f5f 222c 0a20  .    "__le__",. 
+000157e0: 2020 2022 5f5f 726c 655f 5f22 2c0a 2020     "__rle__",.  
+000157f0: 2020 225f 5f67 655f 5f22 2c0a 2020 2020    "__ge__",.    
+00015800: 225f 5f72 6765 5f5f 222c 0a20 2020 2022  "__rge__",.    "
+00015810: 5f5f 6571 5f5f 222c 0a20 2020 2022 5f5f  __eq__",.    "__
+00015820: 6e65 5f5f 222c 0a20 2020 2022 5f5f 616e  ne__",.    "__an
+00015830: 645f 5f22 2c0a 2020 2020 225f 5f72 616e  d__",.    "__ran
+00015840: 645f 5f22 2c0a 2020 2020 225f 5f6f 725f  d__",.    "__or_
+00015850: 5f22 2c0a 2020 2020 225f 5f72 6f72 5f5f  _",.    "__ror__
+00015860: 222c 0a20 2020 2022 5f5f 786f 725f 5f22  ",.    "__xor__"
+00015870: 2c0a 2020 2020 225f 5f72 786f 725f 5f22  ,.    "__rxor__"
+00015880: 2c0a 5d3a 0a20 2020 2073 6574 6174 7472  ,.]:.    setattr
+00015890: 2846 7261 6d65 4261 7365 2c20 6f70 2c20  (FrameBase, op, 
+000158a0: 6675 6e63 746f 6f6c 732e 7061 7274 6961  functools.partia
+000158b0: 6c6d 6574 686f 6428 5f77 7261 705f 6578  lmethod(_wrap_ex
+000158c0: 7072 5f6f 702c 206f 703d 6f70 2929 0a0a  pr_op, op=op))..
+000158d0: 666f 7220 6f70 2069 6e20 5b0a 2020 2020  for op in [.    
+000158e0: 225f 5f69 6e76 6572 745f 5f22 2c0a 2020  "__invert__",.  
+000158f0: 2020 225f 5f6e 6567 5f5f 222c 0a20 2020    "__neg__",.   
+00015900: 2022 5f5f 706f 735f 5f22 2c0a 5d3a 0a20   "__pos__",.]:. 
+00015910: 2020 2073 6574 6174 7472 2846 7261 6d65     setattr(Frame
+00015920: 4261 7365 2c20 6f70 2c20 6675 6e63 746f  Base, op, functo
+00015930: 6f6c 732e 7061 7274 6961 6c6d 6574 686f  ols.partialmetho
+00015940: 6428 5f77 7261 705f 756e 6172 795f 6578  d(_wrap_unary_ex
+00015950: 7072 5f6f 702c 206f 703d 6f70 2929 0a0a  pr_op, op=op))..
+00015960: 0a63 6c61 7373 2044 6174 6146 7261 6d65  .class DataFrame
+00015970: 2846 7261 6d65 4261 7365 293a 0a20 2020  (FrameBase):.   
+00015980: 2022 2222 4461 7461 4672 616d 652d 6c69   """DataFrame-li
+00015990: 6b65 2045 7870 7220 436f 6c6c 6563 7469  ke Expr Collecti
+000159a0: 6f6e 2222 220a 0a20 2020 205f 6163 6365  on"""..    _acce
+000159b0: 7373 6f72 733a 2043 6c61 7373 5661 725b  ssors: ClassVar[
+000159c0: 7365 745b 7374 725d 5d20 3d20 7365 7428  set[str]] = set(
+000159d0: 290a 2020 2020 5f70 6172 7469 7469 6f6e  ).    _partition
+000159e0: 5f74 7970 6520 3d20 7064 2e44 6174 6146  _type = pd.DataF
+000159f0: 7261 6d65 0a0a 2020 2020 4070 726f 7065  rame..    @prope
+00015a00: 7274 790a 2020 2020 6465 6620 7368 6170  rty.    def shap
+00015a10: 6528 7365 6c66 293a 0a20 2020 2020 2020  e(self):.       
+00015a20: 2072 6574 7572 6e20 7365 6c66 2e73 697a   return self.siz
+00015a30: 6520 2f20 6d61 7828 6c65 6e28 7365 6c66  e / max(len(self
+00015a40: 2e63 6f6c 756d 6e73 292c 2031 292c 206c  .columns), 1), l
+00015a50: 656e 2873 656c 662e 636f 6c75 6d6e 7329  en(self.columns)
+00015a60: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
+00015a70: 2020 2020 6465 6620 6e64 696d 2873 656c      def ndim(sel
+00015a80: 6629 3a0a 2020 2020 2020 2020 2222 2252  f):.        """R
+00015a90: 6574 7572 6e20 6469 6d65 6e73 696f 6e61  eturn dimensiona
+00015aa0: 6c69 7479 2222 220a 2020 2020 2020 2020  lity""".        
+00015ab0: 7265 7475 726e 2032 0a0a 2020 2020 4070  return 2..    @p
+00015ac0: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+00015ad0: 656d 7074 7928 7365 6c66 293a 0a20 2020  empty(self):.   
+00015ae0: 2020 2020 2023 205f 5f67 6574 6174 7472       # __getattr
+00015af0: 5f5f 2077 696c 6c20 6265 2063 616c 6c65  __ will be calle
+00015b00: 6420 6166 7465 7220 7765 2072 6169 7365  d after we raise
+00015b10: 2074 6869 732c 2073 6f20 7765 276c 6c20   this, so we'll 
+00015b20: 7261 6973 6520 6974 2061 6761 696e 2066  raise it again f
+00015b30: 726f 6d20 7468 6572 650a 2020 2020 2020  rom there.      
+00015b40: 2020 7261 6973 6520 4174 7472 6962 7574    raise Attribut
+00015b50: 654e 6f74 496d 706c 656d 656e 7465 6445  eNotImplementedE
+00015b60: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+00015b70: 2020 2243 6865 636b 696e 6720 7768 6574    "Checking whet
+00015b80: 6865 7220 6120 4461 736b 2044 6174 6146  her a Dask DataF
+00015b90: 7261 6d65 2068 6173 2061 6e79 2072 6f77  rame has any row
+00015ba0: 7320 6d61 7920 6265 2065 7870 656e 7369  s may be expensi
+00015bb0: 7665 2e20 220a 2020 2020 2020 2020 2020  ve. ".          
+00015bc0: 2020 2248 6f77 6576 6572 2c20 6368 6563    "However, chec
+00015bd0: 6b69 6e67 2074 6865 206e 756d 6265 7220  king the number 
+00015be0: 6f66 2063 6f6c 756d 6e73 2069 7320 6661  of columns is fa
+00015bf0: 7374 2e20 220a 2020 2020 2020 2020 2020  st. ".          
+00015c00: 2020 2244 6570 656e 6469 6e67 206f 6e20    "Depending on 
+00015c10: 7768 6963 6820 6f66 2074 6865 7365 2072  which of these r
+00015c20: 6573 756c 7473 2079 6f75 206e 6565 642c  esults you need,
+00015c30: 2075 7365 2065 6974 6865 7220 220a 2020   use either ".  
+00015c40: 2020 2020 2020 2020 2020 2260 6c65 6e28            "`len(
+00015c50: 6466 2e69 6e64 6578 2920 3d3d 2030 6020  df.index) == 0` 
+00015c60: 6f72 2060 6c65 6e28 6466 2e63 6f6c 756d  or `len(df.colum
+00015c70: 6e73 2920 3d3d 2030 6022 0a20 2020 2020  ns) == 0`".     
+00015c80: 2020 2029 0a0a 2020 2020 4064 6572 6976     )..    @deriv
+00015c90: 6564 5f66 726f 6d28 7064 2e44 6174 6146  ed_from(pd.DataF
+00015ca0: 7261 6d65 290a 2020 2020 6465 6620 6974  rame).    def it
+00015cb0: 656d 7328 7365 6c66 293a 0a20 2020 2020  ems(self):.     
+00015cc0: 2020 2066 6f72 2069 2c20 6e61 6d65 2069     for i, name i
+00015cd0: 6e20 656e 756d 6572 6174 6528 7365 6c66  n enumerate(self
+00015ce0: 2e63 6f6c 756d 6e73 293a 0a20 2020 2020  .columns):.     
+00015cf0: 2020 2020 2020 2079 6965 6c64 2028 6e61         yield (na
+00015d00: 6d65 2c20 7365 6c66 2e69 6c6f 635b 3a2c  me, self.iloc[:,
+00015d10: 2069 5d29 0a0a 2020 2020 4070 726f 7065   i])..    @prope
+00015d20: 7274 790a 2020 2020 6465 6620 6178 6573  rty.    def axes
+00015d30: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00015d40: 7265 7475 726e 205b 7365 6c66 2e69 6e64  return [self.ind
+00015d50: 6578 2c20 7365 6c66 2e63 6f6c 756d 6e73  ex, self.columns
+00015d60: 5d0a 0a20 2020 2064 6566 205f 5f63 6f6e  ]..    def __con
+00015d70: 7461 696e 735f 5f28 7365 6c66 2c20 6b65  tains__(self, ke
+00015d80: 7929 3a0a 2020 2020 2020 2020 7265 7475  y):.        retu
+00015d90: 726e 206b 6579 2069 6e20 7365 6c66 2e5f  rn key in self._
+00015da0: 6d65 7461 0a0a 2020 2020 6465 6620 5f5f  meta..    def __
+00015db0: 6974 6572 5f5f 2873 656c 6629 3a0a 2020  iter__(self):.  
+00015dc0: 2020 2020 2020 7265 7475 726e 2069 7465        return ite
+00015dd0: 7228 7365 6c66 2e5f 6d65 7461 290a 0a20  r(self._meta).. 
+00015de0: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
+00015df0: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
+00015e00: 2020 2064 6566 2069 7465 7272 6f77 7328     def iterrows(
+00015e10: 7365 6c66 293a 0a20 2020 2020 2020 2066  self):.        f
+00015e20: 7261 6d65 203d 2073 656c 662e 6f70 7469  rame = self.opti
+00015e30: 6d69 7a65 2829 0a20 2020 2020 2020 2066  mize().        f
+00015e40: 6f72 2069 2069 6e20 7261 6e67 6528 7365  or i in range(se
+00015e50: 6c66 2e6e 7061 7274 6974 696f 6e73 293a  lf.npartitions):
+00015e60: 0a20 2020 2020 2020 2020 2020 2064 6620  .            df 
+00015e70: 3d20 6672 616d 652e 6765 745f 7061 7274  = frame.get_part
+00015e80: 6974 696f 6e28 6929 2e63 6f6d 7075 7465  ition(i).compute
+00015e90: 2829 0a20 2020 2020 2020 2020 2020 2079  ().            y
+00015ea0: 6965 6c64 2066 726f 6d20 6466 2e69 7465  ield from df.ite
+00015eb0: 7272 6f77 7328 290a 0a20 2020 2040 6465  rrows()..    @de
+00015ec0: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
+00015ed0: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
+00015ee0: 2069 7465 7274 7570 6c65 7328 7365 6c66   itertuples(self
+00015ef0: 2c20 696e 6465 783d 5472 7565 2c20 6e61  , index=True, na
+00015f00: 6d65 3d22 5061 6e64 6173 2229 3a0a 2020  me="Pandas"):.  
+00015f10: 2020 2020 2020 6672 616d 6520 3d20 7365        frame = se
+00015f20: 6c66 2e6f 7074 696d 697a 6528 290a 2020  lf.optimize().  
+00015f30: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
+00015f40: 616e 6765 2873 656c 662e 6e70 6172 7469  ange(self.nparti
+00015f50: 7469 6f6e 7329 3a0a 2020 2020 2020 2020  tions):.        
+00015f60: 2020 2020 6466 203d 2066 7261 6d65 2e67      df = frame.g
+00015f70: 6574 5f70 6172 7469 7469 6f6e 2869 292e  et_partition(i).
+00015f80: 636f 6d70 7574 6528 290a 2020 2020 2020  compute().      
+00015f90: 2020 2020 2020 7969 656c 6420 6672 6f6d        yield from
+00015fa0: 2064 662e 6974 6572 7475 706c 6573 2869   df.itertuples(i
+00015fb0: 6e64 6578 3d69 6e64 6578 2c20 6e61 6d65  ndex=index, name
+00015fc0: 3d6e 616d 6529 0a0a 2020 2020 4070 726f  =name)..    @pro
+00015fd0: 7065 7274 790a 2020 2020 6465 6620 5f65  perty.    def _e
+00015fe0: 6c65 6d77 6973 6528 7365 6c66 293a 0a20  lemwise(self):. 
+00015ff0: 2020 2020 2020 2072 6574 7572 6e20 656c         return el
+00016000: 656d 7769 7365 0a0a 2020 2020 6465 6620  emwise..    def 
+00016010: 5f5f 6172 7261 795f 7566 756e 635f 5f28  __array_ufunc__(
+00016020: 7365 6c66 2c20 6e75 6d70 795f 7566 756e  self, numpy_ufun
+00016030: 632c 206d 6574 686f 642c 202a 696e 7075  c, method, *inpu
+00016040: 7473 2c20 2a2a 6b77 6172 6773 293a 0a20  ts, **kwargs):. 
+00016050: 2020 2020 2020 206f 7574 203d 206b 7761         out = kwa
+00016060: 7267 732e 6765 7428 226f 7574 222c 2028  rgs.get("out", (
+00016070: 2929 0a20 2020 2020 2020 2066 6f72 2078  )).        for x
+00016080: 2069 6e20 696e 7075 7473 202b 206f 7574   in inputs + out
+00016090: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
+000160a0: 7566 756e 6373 2077 6f72 6b20 7769 7468  ufuncs work with
+000160b0: 2030 2d64 696d 656e 7369 6f6e 616c 204e   0-dimensional N
+000160c0: 756d 5079 206e 6461 7272 6179 730a 2020  umPy ndarrays.  
+000160d0: 2020 2020 2020 2020 2020 2320 736f 2077            # so w
+000160e0: 6520 646f 6e27 7420 7761 6e74 2074 6f20  e don't want to 
+000160f0: 7261 6973 6520 4e6f 7449 6d70 6c65 6d65  raise NotImpleme
+00016100: 6e74 6564 0a20 2020 2020 2020 2020 2020  nted.           
+00016110: 2069 6620 6973 696e 7374 616e 6365 2878   if isinstance(x
+00016120: 2c20 6e70 2e6e 6461 7272 6179 2920 616e  , np.ndarray) an
+00016130: 6420 782e 7368 6170 6520 3d3d 2028 293a  d x.shape == ():
+00016140: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00016150: 2063 6f6e 7469 6e75 650a 2020 2020 2020   continue.      
+00016160: 2020 2020 2020 656c 6966 206e 6f74 2069        elif not i
+00016170: 7369 6e73 7461 6e63 6528 0a20 2020 2020  sinstance(.     
+00016180: 2020 2020 2020 2020 2020 2078 2c20 284e             x, (N
+00016190: 756d 6265 722c 2053 6361 6c61 722c 2046  umber, Scalar, F
+000161a0: 7261 6d65 4261 7365 2c20 4172 7261 792c  rameBase, Array,
+000161b0: 2070 642e 4461 7461 4672 616d 652c 2070   pd.DataFrame, p
+000161c0: 642e 5365 7269 6573 2c20 7064 2e49 6e64  d.Series, pd.Ind
+000161d0: 6578 290a 2020 2020 2020 2020 2020 2020  ex).            
+000161e0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+000161f0: 2020 2072 6574 7572 6e20 4e6f 7449 6d70     return NotImp
+00016200: 6c65 6d65 6e74 6564 0a0a 2020 2020 2020  lemented..      
+00016210: 2020 6966 206d 6574 686f 6420 3d3d 2022    if method == "
+00016220: 5f5f 6361 6c6c 5f5f 223a 0a20 2020 2020  __call__":.     
+00016230: 2020 2020 2020 2069 6620 6e75 6d70 795f         if numpy_
+00016240: 7566 756e 632e 7369 676e 6174 7572 6520  ufunc.signature 
+00016250: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+00016260: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+00016270: 7572 6e20 4e6f 7449 6d70 6c65 6d65 6e74  urn NotImplement
+00016280: 6564 0a20 2020 2020 2020 2020 2020 2069  ed.            i
+00016290: 6620 6e75 6d70 795f 7566 756e 632e 6e6f  f numpy_ufunc.no
+000162a0: 7574 203e 2031 3a0a 2020 2020 2020 2020  ut > 1:.        
+000162b0: 2020 2020 2020 2020 2320 7566 756e 6373          # ufuncs
+000162c0: 2077 6974 6820 6d75 6c74 6970 6c65 206f   with multiple o
+000162d0: 7574 7075 7420 7661 6c75 6573 0a20 2020  utput values.   
+000162e0: 2020 2020 2020 2020 2020 2020 2023 2061               # a
+000162f0: 7265 206e 6f74 2079 6574 2073 7570 706f  re not yet suppo
+00016300: 7274 6564 2066 6f72 2066 7261 6d65 730a  rted for frames.
+00016310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016320: 7265 7475 726e 204e 6f74 496d 706c 656d  return NotImplem
+00016330: 656e 7465 640a 2020 2020 2020 2020 2020  ented.          
+00016340: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00016350: 2020 2020 2020 2020 7265 7475 726e 2065          return e
+00016360: 6c65 6d77 6973 6528 6e75 6d70 795f 7566  lemwise(numpy_uf
+00016370: 756e 632c 202a 696e 7075 7473 2c20 2a2a  unc, *inputs, **
+00016380: 6b77 6172 6773 290a 2020 2020 2020 2020  kwargs).        
+00016390: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+000163a0: 2020 2320 7566 756e 6320 6d65 7468 6f64    # ufunc method
+000163b0: 7320 6172 6520 6e6f 7420 7965 7420 7375  s are not yet su
+000163c0: 7070 6f72 7465 6420 666f 7220 6672 616d  pported for fram
+000163d0: 6573 0a20 2020 2020 2020 2020 2020 2072  es.            r
+000163e0: 6574 7572 6e20 4e6f 7449 6d70 6c65 6d65  eturn NotImpleme
+000163f0: 6e74 6564 0a0a 2020 2020 6465 6620 5f5f  nted..    def __
+00016400: 6172 7261 795f 7772 6170 5f5f 2873 656c  array_wrap__(sel
+00016410: 662c 2061 7272 6179 2c20 636f 6e74 6578  f, array, contex
+00016420: 743d 4e6f 6e65 293a 0a20 2020 2020 2020  t=None):.       
+00016430: 2069 6620 6973 696e 7374 616e 6365 2863   if isinstance(c
+00016440: 6f6e 7465 7874 2c20 7475 706c 6529 2061  ontext, tuple) a
+00016450: 6e64 206c 656e 2863 6f6e 7465 7874 2920  nd len(context) 
+00016460: 3e20 303a 0a20 2020 2020 2020 2020 2020  > 0:.           
+00016470: 2069 6620 6973 696e 7374 616e 6365 2863   if isinstance(c
+00016480: 6f6e 7465 7874 5b31 5d5b 305d 2c20 6e70  ontext[1][0], np
+00016490: 2e6e 6461 7272 6179 2920 616e 6420 636f  .ndarray) and co
+000164a0: 6e74 6578 745b 315d 5b30 5d2e 7368 6170  ntext[1][0].shap
+000164b0: 6520 3d3d 2028 293a 0a20 2020 2020 2020  e == ():.       
+000164c0: 2020 2020 2020 2020 2069 6e64 6578 203d           index =
+000164d0: 204e 6f6e 650a 2020 2020 2020 2020 2020   None.          
+000164e0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+000164f0: 2020 2020 2020 2020 696e 6465 7820 3d20          index = 
+00016500: 636f 6e74 6578 745b 315d 5b30 5d2e 696e  context[1][0].in
+00016510: 6465 780a 2020 2020 2020 2020 656c 7365  dex.        else
+00016520: 3a0a 2020 2020 2020 2020 2020 2020 7472  :.            tr
+00016530: 793a 0a20 2020 2020 2020 2020 2020 2020  y:.             
+00016540: 2020 2069 6d70 6f72 7420 696e 7370 6563     import inspec
+00016550: 740a 0a20 2020 2020 2020 2020 2020 2020  t..             
+00016560: 2020 206d 6574 686f 645f 6e61 6d65 203d     method_name =
+00016570: 2066 2260 7b69 6e73 7065 6374 2e73 7461   f"`{inspect.sta
+00016580: 636b 2829 5b33 5d5b 335d 7d60 220a 2020  ck()[3][3]}`".  
+00016590: 2020 2020 2020 2020 2020 6578 6365 7074            except
+000165a0: 2049 6e64 6578 4572 726f 723a 0a20 2020   IndexError:.   
+000165b0: 2020 2020 2020 2020 2020 2020 206d 6574               met
+000165c0: 686f 645f 6e61 6d65 203d 2022 5468 6973  hod_name = "This
+000165d0: 206d 6574 686f 6422 0a0a 2020 2020 2020   method"..      
+000165e0: 2020 2020 2020 7261 6973 6520 4e6f 7449        raise NotI
+000165f0: 6d70 6c65 6d65 6e74 6564 4572 726f 7228  mplementedError(
+00016600: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00016610: 2066 227b 6d65 7468 6f64 5f6e 616d 657d   f"{method_name}
+00016620: 2069 7320 6e6f 7420 696d 706c 656d 656e   is not implemen
+00016630: 7465 6420 666f 7220 6064 6173 6b2e 6461  ted for `dask.da
+00016640: 7461 6672 616d 652e 4461 7461 4672 616d  taframe.DataFram
+00016650: 6560 2e22 0a20 2020 2020 2020 2020 2020  e`.".           
+00016660: 2029 0a0a 2020 2020 2020 2020 7265 7475   )..        retu
+00016670: 726e 206d 6574 615f 6672 616d 655f 636f  rn meta_frame_co
+00016680: 6e73 7472 7563 746f 7228 7365 6c66 2928  nstructor(self)(
+00016690: 6172 7261 792c 2069 6e64 6578 3d69 6e64  array, index=ind
+000166a0: 6578 2c20 636f 6c75 6d6e 733d 7365 6c66  ex, columns=self
+000166b0: 2e63 6f6c 756d 6e73 290a 0a20 2020 2064  .columns)..    d
+000166c0: 6566 205f 6970 7974 686f 6e5f 6b65 795f  ef _ipython_key_
+000166d0: 636f 6d70 6c65 7469 6f6e 735f 2873 656c  completions_(sel
+000166e0: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
+000166f0: 726e 206d 6574 686f 6473 2e74 6f6c 6973  rn methods.tolis
+00016700: 7428 7365 6c66 2e63 6f6c 756d 6e73 290a  t(self.columns).
+00016710: 0a20 2020 2064 6566 205f 7265 7072 5f68  .    def _repr_h
+00016720: 746d 6c5f 2873 656c 6629 3a0a 2020 2020  tml_(self):.    
+00016730: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00016740: 746f 5f68 746d 6c28 290a 0a20 2020 2040  to_html()..    @
+00016750: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
+00016760: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
+00016770: 6566 2061 7373 6967 6e28 7365 6c66 2c20  ef assign(self, 
+00016780: 2a2a 7061 6972 7329 3a0a 2020 2020 2020  **pairs):.      
+00016790: 2020 7265 7375 6c74 203d 2073 656c 660a    result = self.
+000167a0: 2020 2020 2020 2020 6172 6773 203d 205b          args = [
+000167b0: 5d0a 2020 2020 2020 2020 666f 7220 6b2c  ].        for k,
+000167c0: 2076 2069 6e20 7061 6972 732e 6974 656d   v in pairs.item
+000167d0: 7328 293a 0a20 2020 2020 2020 2020 2020  s():.           
+000167e0: 2076 203d 205f 6d61 7962 655f 6672 6f6d   v = _maybe_from
+000167f0: 5f70 616e 6461 7328 5b76 5d29 5b30 5d0a  _pandas([v])[0].
+00016800: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+00016810: 6f74 2069 7369 6e73 7461 6e63 6528 6b2c  ot isinstance(k,
+00016820: 2073 7472 293a 0a20 2020 2020 2020 2020   str):.         
+00016830: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
+00016840: 6545 7272 6f72 2866 2243 6f6c 756d 6e20  eError(f"Column 
+00016850: 6e61 6d65 2063 616e 6e6f 7420 6265 2074  name cannot be t
+00016860: 7970 6520 7b74 7970 6528 6b29 7d22 290a  ype {type(k)}").
+00016870: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00016880: 6361 6c6c 6162 6c65 2876 293a 0a20 2020  callable(v):.   
+00016890: 2020 2020 2020 2020 2020 2020 2072 6573               res
+000168a0: 756c 7420 3d20 6e65 775f 636f 6c6c 6563  ult = new_collec
+000168b0: 7469 6f6e 2865 7870 722e 4173 7369 676e  tion(expr.Assign
+000168c0: 2872 6573 756c 742c 202a 6172 6773 2929  (result, *args))
+000168d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000168e0: 2061 7267 7320 3d20 5b5d 0a20 2020 2020   args = [].     
+000168f0: 2020 2020 2020 2020 2020 2072 6573 756c             resul
+00016900: 7420 3d20 6e65 775f 636f 6c6c 6563 7469  t = new_collecti
+00016910: 6f6e 2865 7870 722e 4173 7369 676e 2872  on(expr.Assign(r
+00016920: 6573 756c 742c 206b 2c20 7628 7265 7375  esult, k, v(resu
+00016930: 6c74 2929 290a 2020 2020 2020 2020 2020  lt))).          
+00016940: 2020 2020 2020 636f 6e74 696e 7565 0a0a        continue..
+00016950: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+00016960: 2069 7369 6e73 7461 6e63 6528 762c 2028   isinstance(v, (
+00016970: 5363 616c 6172 2c20 5365 7269 6573 2929  Scalar, Series))
+00016980: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00016990: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+000169a0: 762c 2053 6572 6965 7329 3a0a 2020 2020  v, Series):.    
+000169b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000169c0: 6966 206e 6f74 2065 7870 722e 6172 655f  if not expr.are_
+000169d0: 636f 5f61 6c69 676e 6564 2872 6573 756c  co_aligned(resul
+000169e0: 742e 6578 7072 2c20 762e 6578 7072 293a  t.expr, v.expr):
+000169f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00016a00: 2020 2020 2020 2020 2069 6620 6c65 6e28           if len(
+00016a10: 6172 6773 2920 3e20 303a 0a20 2020 2020  args) > 0:.     
+00016a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016a30: 2020 2020 2020 2072 6573 756c 7420 3d20         result = 
+00016a40: 6578 7072 2e41 7373 6967 6e28 7265 7375  expr.Assign(resu
+00016a50: 6c74 2c20 2a61 7267 7329 0a20 2020 2020  lt, *args).     
+00016a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016a70: 2020 2020 2020 2061 7267 7320 3d20 5b5d         args = []
+00016a80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00016a90: 2020 2020 2020 2020 2072 6573 756c 7420           result 
+00016aa0: 3d20 6e65 775f 636f 6c6c 6563 7469 6f6e  = new_collection
+00016ab0: 2865 7870 722e 4173 7369 676e 416c 6967  (expr.AssignAlig
+00016ac0: 6e28 7265 7375 6c74 2c20 6b2c 2076 2e65  n(result, k, v.e
+00016ad0: 7870 7229 290a 2020 2020 2020 2020 2020  xpr)).          
+00016ae0: 2020 2020 2020 2020 2020 2020 2020 636f                co
+00016af0: 6e74 696e 7565 0a0a 2020 2020 2020 2020  ntinue..        
+00016b00: 2020 2020 656c 6966 206e 6f74 2069 7369      elif not isi
+00016b10: 6e73 7461 6e63 6528 762c 2046 7261 6d65  nstance(v, Frame
+00016b20: 4261 7365 2920 616e 6420 6973 696e 7374  Base) and isinst
+00016b30: 616e 6365 2876 2c20 4861 7368 6162 6c65  ance(v, Hashable
+00016b40: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00016b50: 2020 2070 6173 730a 2020 2020 2020 2020     pass.        
+00016b60: 2020 2020 656c 6966 2069 7369 6e73 7461      elif isinsta
+00016b70: 6e63 6528 762c 2041 7272 6179 293a 0a20  nce(v, Array):. 
+00016b80: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00016b90: 6620 6c65 6e28 762e 7368 6170 6529 203e  f len(v.shape) >
+00016ba0: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
+00016bb0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+00016bc0: 6c75 6545 7272 6f72 2822 4172 7261 7920  lueError("Array 
+00016bd0: 6173 7369 676e 6d65 6e74 206f 6e6c 7920  assignment only 
+00016be0: 7375 7070 6f72 7473 2031 2d44 2061 7272  supports 1-D arr
+00016bf0: 6179 7322 290a 2020 2020 2020 2020 2020  ays").          
+00016c00: 2020 2020 2020 6966 2076 2e6e 7061 7274        if v.npart
+00016c10: 6974 696f 6e73 2021 3d20 7265 7375 6c74  itions != result
+00016c20: 2e6e 7061 7274 6974 696f 6e73 3a0a 2020  .npartitions:.  
+00016c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016c40: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+00016c50: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+00016c60: 2020 2020 2020 2020 2020 2020 224e 756d              "Num
+00016c70: 6265 7220 6f66 2070 6172 7469 7469 6f6e  ber of partition
+00016c80: 7320 646f 206e 6f74 206d 6174 6368 2022  s do not match "
+00016c90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00016ca0: 2020 2020 2020 2020 2066 2228 7b76 2e6e           f"({v.n
+00016cb0: 7061 7274 6974 696f 6e73 7d20 213d 207b  partitions} != {
+00016cc0: 7265 7375 6c74 2e6e 7061 7274 6974 696f  result.npartitio
+00016cd0: 6e73 7d29 220a 2020 2020 2020 2020 2020  ns})".          
+00016ce0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00016cf0: 2020 2020 2020 2020 2020 2020 7620 3d20              v = 
+00016d00: 6672 6f6d 5f64 6173 6b5f 6172 7261 7928  from_dask_array(
+00016d10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00016d20: 2020 2020 2076 2c20 696e 6465 783d 7265       v, index=re
+00016d30: 7375 6c74 2e69 6e64 6578 2e74 6f5f 6c65  sult.index.to_le
+00016d40: 6761 6379 5f64 6174 6166 7261 6d65 2829  gacy_dataframe()
+00016d50: 2c20 6d65 7461 3d72 6573 756c 742e 5f6d  , meta=result._m
+00016d60: 6574 610a 2020 2020 2020 2020 2020 2020  eta.            
+00016d70: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+00016d80: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00016d90: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
+00016da0: 7065 4572 726f 7228 6622 436f 6c75 6d6e  peError(f"Column
+00016db0: 2061 7373 6967 6e6d 656e 7420 646f 6573   assignment does
+00016dc0: 6e27 7420 7375 7070 6f72 7420 7479 7065  n't support type
+00016dd0: 207b 7479 7065 2876 297d 2229 0a20 2020   {type(v)}").   
+00016de0: 2020 2020 2020 2020 2061 7267 732e 6578           args.ex
+00016df0: 7465 6e64 285b 6b2c 2076 5d29 0a0a 2020  tend([k, v])..  
+00016e00: 2020 2020 2020 6966 206c 656e 2861 7267        if len(arg
+00016e10: 7329 203e 2030 3a0a 2020 2020 2020 2020  s) > 0:.        
+00016e20: 2020 2020 7265 7375 6c74 203d 206e 6577      result = new
+00016e30: 5f63 6f6c 6c65 6374 696f 6e28 6578 7072  _collection(expr
+00016e40: 2e41 7373 6967 6e28 7265 7375 6c74 2c20  .Assign(result, 
+00016e50: 2a61 7267 7329 290a 0a20 2020 2020 2020  *args))..       
+00016e60: 2072 6574 7572 6e20 7265 7375 6c74 0a0a   return result..
+00016e70: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
+00016e80: 6d28 7064 2e44 6174 6146 7261 6d65 290a  m(pd.DataFrame).
+00016e90: 2020 2020 6465 6620 636c 6970 2873 656c      def clip(sel
+00016ea0: 662c 206c 6f77 6572 3d4e 6f6e 652c 2075  f, lower=None, u
+00016eb0: 7070 6572 3d4e 6f6e 652c 2061 7869 733d  pper=None, axis=
+00016ec0: 4e6f 6e65 2c20 2a2a 6b77 6172 6773 293a  None, **kwargs):
+00016ed0: 0a20 2020 2020 2020 2061 7869 7320 3d20  .        axis = 
+00016ee0: 7365 6c66 2e5f 7661 6c69 6461 7465 5f61  self._validate_a
+00016ef0: 7869 7328 6178 6973 290a 2020 2020 2020  xis(axis).      
+00016f00: 2020 6966 2061 7869 7320 3d3d 2031 3a0a    if axis == 1:.
+00016f10: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00016f20: 726e 2073 656c 662e 6d61 705f 7061 7274  rn self.map_part
+00016f30: 6974 696f 6e73 284d 2e63 6c69 702c 206c  itions(M.clip, l
+00016f40: 6f77 6572 2c20 7570 7065 722c 2061 7869  ower, upper, axi
+00016f50: 733d 6178 6973 290a 2020 2020 2020 2020  s=axis).        
+00016f60: 7265 7475 726e 206e 6577 5f63 6f6c 6c65  return new_colle
+00016f70: 6374 696f 6e28 7365 6c66 2e65 7870 722e  ction(self.expr.
+00016f80: 636c 6970 286c 6f77 6572 2c20 7570 7065  clip(lower, uppe
+00016f90: 722c 2061 7869 7329 290a 0a20 2020 2064  r, axis))..    d
+00016fa0: 6566 206d 6572 6765 280a 2020 2020 2020  ef merge(.      
+00016fb0: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+00016fc0: 7269 6768 742c 0a20 2020 2020 2020 2068  right,.        h
+00016fd0: 6f77 3d22 696e 6e65 7222 2c0a 2020 2020  ow="inner",.    
+00016fe0: 2020 2020 6f6e 3d4e 6f6e 652c 0a20 2020      on=None,.   
+00016ff0: 2020 2020 206c 6566 745f 6f6e 3d4e 6f6e       left_on=Non
+00017000: 652c 0a20 2020 2020 2020 2072 6967 6874  e,.        right
+00017010: 5f6f 6e3d 4e6f 6e65 2c0a 2020 2020 2020  _on=None,.      
+00017020: 2020 6c65 6674 5f69 6e64 6578 3d46 616c    left_index=Fal
+00017030: 7365 2c0a 2020 2020 2020 2020 7269 6768  se,.        righ
+00017040: 745f 696e 6465 783d 4661 6c73 652c 0a20  t_index=False,. 
+00017050: 2020 2020 2020 2073 7566 6669 7865 733d         suffixes=
+00017060: 2822 5f78 222c 2022 5f79 2229 2c0a 2020  ("_x", "_y"),.  
+00017070: 2020 2020 2020 696e 6469 6361 746f 723d        indicator=
+00017080: 4661 6c73 652c 0a20 2020 2020 2020 2073  False,.        s
+00017090: 6875 6666 6c65 5f6d 6574 686f 643d 4e6f  huffle_method=No
+000170a0: 6e65 2c0a 2020 2020 2020 2020 6e70 6172  ne,.        npar
+000170b0: 7469 7469 6f6e 733d 4e6f 6e65 2c0a 2020  titions=None,.  
+000170c0: 2020 2020 2020 6272 6f61 6463 6173 743d        broadcast=
+000170d0: 4e6f 6e65 2c0a 2020 2020 293a 0a20 2020  None,.    ):.   
+000170e0: 2020 2020 2022 2222 4d65 7267 6520 7468       """Merge th
+000170f0: 6520 4461 7461 4672 616d 6520 7769 7468  e DataFrame with
+00017100: 2061 6e6f 7468 6572 2044 6174 6146 7261   another DataFra
+00017110: 6d65 0a0a 2020 2020 2020 2020 5468 6973  me..        This
+00017120: 2077 696c 6c20 6d65 7267 6520 7468 6520   will merge the 
+00017130: 7477 6f20 6461 7461 7365 7473 2c20 6569  two datasets, ei
+00017140: 7468 6572 206f 6e20 7468 6520 696e 6469  ther on the indi
+00017150: 6365 732c 2061 2063 6572 7461 696e 2063  ces, a certain c
+00017160: 6f6c 756d 6e0a 2020 2020 2020 2020 696e  olumn.        in
+00017170: 2065 6163 6820 6461 7461 7365 7420 6f72   each dataset or
+00017180: 2074 6865 2069 6e64 6578 2069 6e20 6f6e   the index in on
+00017190: 6520 6461 7461 7365 7420 616e 6420 7468  e dataset and th
+000171a0: 6520 636f 6c75 6d6e 2069 6e20 616e 6f74  e column in anot
+000171b0: 6865 722e 0a0a 2020 2020 2020 2020 5061  her...        Pa
+000171c0: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
+000171d0: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
+000171e0: 2020 2020 7269 6768 743a 2064 6173 6b2e      right: dask.
+000171f0: 6461 7461 6672 616d 652e 4461 7461 4672  dataframe.DataFr
+00017200: 616d 650a 2020 2020 2020 2020 686f 7720  ame.        how 
+00017210: 3a20 7b27 6c65 6674 272c 2027 7269 6768  : {'left', 'righ
+00017220: 7427 2c20 276f 7574 6572 272c 2027 696e  t', 'outer', 'in
+00017230: 6e65 7227 2c20 276c 6566 7473 656d 6927  ner', 'leftsemi'
+00017240: 7d2c 2064 6566 6175 6c74 3a20 2769 6e6e  }, default: 'inn
+00017250: 6572 270a 2020 2020 2020 2020 2020 2020  er'.            
+00017260: 486f 7720 746f 2068 616e 646c 6520 7468  How to handle th
+00017270: 6520 6f70 6572 6174 696f 6e20 6f66 2074  e operation of t
+00017280: 6865 2074 776f 206f 626a 6563 7473 3a0a  he two objects:.
+00017290: 0a20 2020 2020 2020 2020 2020 202d 206c  .            - l
+000172a0: 6566 743a 2075 7365 2063 616c 6c69 6e67  eft: use calling
+000172b0: 2066 7261 6d65 2773 2069 6e64 6578 2028   frame's index (
+000172c0: 6f72 2063 6f6c 756d 6e20 6966 206f 6e20  or column if on 
+000172d0: 6973 2073 7065 6369 6669 6564 290a 2020  is specified).  
+000172e0: 2020 2020 2020 2020 2020 2d20 7269 6768            - righ
+000172f0: 743a 2075 7365 206f 7468 6572 2066 7261  t: use other fra
+00017300: 6d65 2773 2069 6e64 6578 0a20 2020 2020  me's index.     
+00017310: 2020 2020 2020 202d 206f 7574 6572 3a20         - outer: 
+00017320: 666f 726d 2075 6e69 6f6e 206f 6620 6361  form union of ca
+00017330: 6c6c 696e 6720 6672 616d 6527 7320 696e  lling frame's in
+00017340: 6465 7820 286f 7220 636f 6c75 6d6e 2069  dex (or column i
+00017350: 6620 6f6e 2069 730a 2020 2020 2020 2020  f on is.        
+00017360: 2020 2020 2020 7370 6563 6966 6965 6429        specified)
+00017370: 2077 6974 6820 6f74 6865 7220 6672 616d   with other fram
+00017380: 6527 7320 696e 6465 782c 2061 6e64 2073  e's index, and s
+00017390: 6f72 7420 6974 0a20 2020 2020 2020 2020  ort it.         
+000173a0: 2020 2020 206c 6578 6963 6f67 7261 7068       lexicograph
+000173b0: 6963 616c 6c79 0a20 2020 2020 2020 2020  ically.         
+000173c0: 2020 202d 2069 6e6e 6572 3a20 666f 726d     - inner: form
+000173d0: 2069 6e74 6572 7365 6374 696f 6e20 6f66   intersection of
+000173e0: 2063 616c 6c69 6e67 2066 7261 6d65 2773   calling frame's
+000173f0: 2069 6e64 6578 2028 6f72 2063 6f6c 756d   index (or colum
+00017400: 6e20 6966 0a20 2020 2020 2020 2020 2020  n if.           
+00017410: 2020 206f 6e20 6973 2073 7065 6369 6669     on is specifi
+00017420: 6564 2920 7769 7468 206f 7468 6572 2066  ed) with other f
+00017430: 7261 6d65 2773 2069 6e64 6578 2c20 7072  rame's index, pr
+00017440: 6573 6572 7669 6e67 2074 6865 206f 7264  eserving the ord
+00017450: 6572 0a20 2020 2020 2020 2020 2020 2020  er.             
+00017460: 206f 6620 7468 6520 6361 6c6c 696e 6727   of the calling'
+00017470: 7320 6f6e 650a 2020 2020 2020 2020 2020  s one.          
+00017480: 2020 2d20 6c65 6674 7365 6d69 3a20 4368    - leftsemi: Ch
+00017490: 6f6f 7365 2061 6c6c 2072 6f77 7320 696e  oose all rows in
+000174a0: 206c 6566 7420 7768 6572 6520 7468 6520   left where the 
+000174b0: 6a6f 696e 206b 6579 7320 6361 6e20 6265  join keys can be
+000174c0: 2066 6f75 6e64 0a20 2020 2020 2020 2020   found.         
+000174d0: 2020 2020 2069 6e20 7269 6768 742e 2057       in right. W
+000174e0: 6f6e 2774 2064 7570 6c69 6361 7465 2072  on't duplicate r
+000174f0: 6f77 7320 6966 2074 6865 206b 6579 7320  ows if the keys 
+00017500: 6172 6520 6475 706c 6963 6174 6564 2069  are duplicated i
+00017510: 6e20 7269 6768 742e 0a20 2020 2020 2020  n right..       
+00017520: 2020 2020 2020 2044 726f 7073 2061 6c6c         Drops all
+00017530: 2063 6f6c 756d 6e73 2066 726f 6d20 7269   columns from ri
+00017540: 6768 742e 0a0a 2020 2020 2020 2020 6f6e  ght...        on
+00017550: 203a 206c 6162 656c 206f 7220 6c69 7374   : label or list
+00017560: 0a20 2020 2020 2020 2020 2020 2043 6f6c  .            Col
+00017570: 756d 6e20 6f72 2069 6e64 6578 206c 6576  umn or index lev
+00017580: 656c 206e 616d 6573 2074 6f20 6a6f 696e  el names to join
+00017590: 206f 6e2e 2054 6865 7365 206d 7573 7420   on. These must 
+000175a0: 6265 2066 6f75 6e64 2069 6e20 626f 7468  be found in both
+000175b0: 0a20 2020 2020 2020 2020 2020 2044 6174  .            Dat
+000175c0: 6146 7261 6d65 732e 2049 6620 6f6e 2069  aFrames. If on i
+000175d0: 7320 4e6f 6e65 2061 6e64 206e 6f74 206d  s None and not m
+000175e0: 6572 6769 6e67 206f 6e20 696e 6465 7865  erging on indexe
+000175f0: 7320 7468 656e 2074 6869 730a 2020 2020  s then this.    
+00017600: 2020 2020 2020 2020 6465 6661 756c 7473          defaults
+00017610: 2074 6f20 7468 6520 696e 7465 7273 6563   to the intersec
+00017620: 7469 6f6e 206f 6620 7468 6520 636f 6c75  tion of the colu
+00017630: 6d6e 7320 696e 2062 6f74 6820 4461 7461  mns in both Data
+00017640: 4672 616d 6573 2e0a 2020 2020 2020 2020  Frames..        
+00017650: 6c65 6674 5f6f 6e20 3a20 6c61 6265 6c20  left_on : label 
+00017660: 6f72 206c 6973 742c 206f 7220 6172 7261  or list, or arra
+00017670: 792d 6c69 6b65 0a20 2020 2020 2020 2020  y-like.         
+00017680: 2020 2043 6f6c 756d 6e20 746f 206a 6f69     Column to joi
+00017690: 6e20 6f6e 2069 6e20 7468 6520 6c65 6674  n on in the left
+000176a0: 2044 6174 6146 7261 6d65 2e20 4f74 6865   DataFrame. Othe
+000176b0: 7220 7468 616e 2069 6e20 7061 6e64 6173  r than in pandas
+000176c0: 0a20 2020 2020 2020 2020 2020 2061 7272  .            arr
+000176d0: 6179 7320 616e 6420 6c69 7374 7320 6172  ays and lists ar
+000176e0: 6520 6f6e 6c79 2073 7570 706f 7274 2069  e only support i
+000176f0: 6620 7468 6569 7220 6c65 6e67 7468 2069  f their length i
+00017700: 7320 312e 0a20 2020 2020 2020 2072 6967  s 1..        rig
+00017710: 6874 5f6f 6e20 3a20 6c61 6265 6c20 6f72  ht_on : label or
+00017720: 206c 6973 742c 206f 7220 6172 7261 792d   list, or array-
+00017730: 6c69 6b65 0a20 2020 2020 2020 2020 2020  like.           
+00017740: 2043 6f6c 756d 6e20 746f 206a 6f69 6e20   Column to join 
+00017750: 6f6e 2069 6e20 7468 6520 7269 6768 7420  on in the right 
+00017760: 4461 7461 4672 616d 652e 204f 7468 6572  DataFrame. Other
+00017770: 2074 6861 6e20 696e 2070 616e 6461 730a   than in pandas.
+00017780: 2020 2020 2020 2020 2020 2020 6172 7261              arra
+00017790: 7973 2061 6e64 206c 6973 7473 2061 7265  ys and lists are
+000177a0: 206f 6e6c 7920 7375 7070 6f72 7420 6966   only support if
+000177b0: 2074 6865 6972 206c 656e 6774 6820 6973   their length is
+000177c0: 2031 2e0a 2020 2020 2020 2020 6c65 6674   1..        left
+000177d0: 5f69 6e64 6578 203a 2062 6f6f 6c65 616e  _index : boolean
+000177e0: 2c20 6465 6661 756c 7420 4661 6c73 650a  , default False.
+000177f0: 2020 2020 2020 2020 2020 2020 5573 6520              Use 
+00017800: 7468 6520 696e 6465 7820 6672 6f6d 2074  the index from t
+00017810: 6865 206c 6566 7420 4461 7461 4672 616d  he left DataFram
+00017820: 6520 6173 2074 6865 206a 6f69 6e20 6b65  e as the join ke
+00017830: 792e 0a20 2020 2020 2020 2072 6967 6874  y..        right
+00017840: 5f69 6e64 6578 203a 2062 6f6f 6c65 616e  _index : boolean
+00017850: 2c20 6465 6661 756c 7420 4661 6c73 650a  , default False.
+00017860: 2020 2020 2020 2020 2020 2020 5573 6520              Use 
+00017870: 7468 6520 696e 6465 7820 6672 6f6d 2074  the index from t
+00017880: 6865 2072 6967 6874 2044 6174 6146 7261  he right DataFra
+00017890: 6d65 2061 7320 7468 6520 6a6f 696e 206b  me as the join k
+000178a0: 6579 2e0a 2020 2020 2020 2020 7375 6666  ey..        suff
+000178b0: 6978 6573 203a 2032 2d6c 656e 6774 6820  ixes : 2-length 
+000178c0: 7365 7175 656e 6365 2028 7475 706c 652c  sequence (tuple,
+000178d0: 206c 6973 742c 202e 2e2e 290a 2020 2020   list, ...).    
+000178e0: 2020 2020 2020 2020 5375 6666 6978 2074          Suffix t
+000178f0: 6f20 6170 706c 7920 746f 206f 7665 726c  o apply to overl
+00017900: 6170 7069 6e67 2063 6f6c 756d 6e20 6e61  apping column na
+00017910: 6d65 7320 696e 2074 6865 206c 6566 7420  mes in the left 
+00017920: 616e 640a 2020 2020 2020 2020 2020 2020  and.            
+00017930: 7269 6768 7420 7369 6465 2c20 7265 7370  right side, resp
+00017940: 6563 7469 7665 6c79 0a20 2020 2020 2020  ectively.       
+00017950: 2069 6e64 6963 6174 6f72 203a 2062 6f6f   indicator : boo
+00017960: 6c65 616e 206f 7220 7374 7269 6e67 2c20  lean or string, 
+00017970: 6465 6661 756c 7420 4661 6c73 650a 2020  default False.  
+00017980: 2020 2020 2020 2020 2020 4966 2054 7275            If Tru
+00017990: 652c 2061 6464 7320 6120 636f 6c75 6d6e  e, adds a column
+000179a0: 2074 6f20 6f75 7470 7574 2044 6174 6146   to output DataF
+000179b0: 7261 6d65 2063 616c 6c65 6420 225f 6d65  rame called "_me
+000179c0: 7267 6522 2077 6974 680a 2020 2020 2020  rge" with.      
+000179d0: 2020 2020 2020 696e 666f 726d 6174 696f        informatio
+000179e0: 6e20 6f6e 2074 6865 2073 6f75 7263 6520  n on the source 
+000179f0: 6f66 2065 6163 6820 726f 772e 2049 6620  of each row. If 
+00017a00: 7374 7269 6e67 2c20 636f 6c75 6d6e 2077  string, column w
+00017a10: 6974 680a 2020 2020 2020 2020 2020 2020  ith.            
+00017a20: 696e 666f 726d 6174 696f 6e20 6f6e 2073  information on s
+00017a30: 6f75 7263 6520 6f66 2065 6163 6820 726f  ource of each ro
+00017a40: 7720 7769 6c6c 2062 6520 6164 6465 6420  w will be added 
+00017a50: 746f 206f 7574 7075 7420 4461 7461 4672  to output DataFr
+00017a60: 616d 652c 0a20 2020 2020 2020 2020 2020  ame,.           
+00017a70: 2061 6e64 2063 6f6c 756d 6e20 7769 6c6c   and column will
+00017a80: 2062 6520 6e61 6d65 6420 7661 6c75 6520   be named value 
+00017a90: 6f66 2073 7472 696e 672e 2049 6e66 6f72  of string. Infor
+00017aa0: 6d61 7469 6f6e 2063 6f6c 756d 6e20 6973  mation column is
+00017ab0: 0a20 2020 2020 2020 2020 2020 2043 6174  .            Cat
+00017ac0: 6567 6f72 6963 616c 2d74 7970 6520 616e  egorical-type an
+00017ad0: 6420 7461 6b65 7320 6f6e 2061 2076 616c  d takes on a val
+00017ae0: 7565 206f 6620 226c 6566 745f 6f6e 6c79  ue of "left_only
+00017af0: 2220 666f 7220 6f62 7365 7276 6174 696f  " for observatio
+00017b00: 6e73 0a20 2020 2020 2020 2020 2020 2077  ns.            w
+00017b10: 686f 7365 206d 6572 6765 206b 6579 206f  hose merge key o
+00017b20: 6e6c 7920 6170 7065 6172 7320 696e 2060  nly appears in `
+00017b30: 6c65 6674 6020 4461 7461 4672 616d 652c  left` DataFrame,
+00017b40: 2022 7269 6768 745f 6f6e 6c79 2220 666f   "right_only" fo
+00017b50: 720a 2020 2020 2020 2020 2020 2020 6f62  r.            ob
+00017b60: 7365 7276 6174 696f 6e73 2077 686f 7365  servations whose
+00017b70: 206d 6572 6765 206b 6579 206f 6e6c 7920   merge key only 
+00017b80: 6170 7065 6172 7320 696e 2060 7269 6768  appears in `righ
+00017b90: 7460 2044 6174 6146 7261 6d65 2c0a 2020  t` DataFrame,.  
+00017ba0: 2020 2020 2020 2020 2020 616e 6420 2262            and "b
+00017bb0: 6f74 6822 2069 6620 7468 6520 6f62 7365  oth" if the obse
+00017bc0: 7276 6174 696f 6ee2 8099 7320 6d65 7267  rvation...s merg
+00017bd0: 6520 6b65 7920 6973 2066 6f75 6e64 2069  e key is found i
+00017be0: 6e20 626f 7468 2e0a 2020 2020 2020 2020  n both..        
+00017bf0: 6e70 6172 7469 7469 6f6e 733a 2069 6e74  npartitions: int
+00017c00: 206f 7220 4e6f 6e65 2c20 6f70 7469 6f6e   or None, option
+00017c10: 616c 0a20 2020 2020 2020 2020 2020 2054  al.            T
+00017c20: 6865 2069 6465 616c 206e 756d 6265 7220  he ideal number 
+00017c30: 6f66 206f 7574 7075 7420 7061 7274 6974  of output partit
+00017c40: 696f 6e73 2e20 5468 6973 2069 7320 6f6e  ions. This is on
+00017c50: 6c79 2075 7469 6c69 7365 6420 7768 656e  ly utilised when
+00017c60: 0a20 2020 2020 2020 2020 2020 2070 6572  .            per
+00017c70: 666f 726d 696e 6720 6120 6861 7368 5f6a  forming a hash_j
+00017c80: 6f69 6e20 286d 6572 6769 6e67 206f 6e20  oin (merging on 
+00017c90: 636f 6c75 6d6e 7320 6f6e 6c79 292e 2049  columns only). I
+00017ca0: 6620 6060 4e6f 6e65 6060 2074 6865 6e0a  f ``None`` then.
+00017cb0: 2020 2020 2020 2020 2020 2020 6060 6e70              ``np
+00017cc0: 6172 7469 7469 6f6e 7320 3d20 6d61 7828  artitions = max(
+00017cd0: 6c68 732e 6e70 6172 7469 7469 6f6e 732c  lhs.npartitions,
+00017ce0: 2072 6873 2e6e 7061 7274 6974 696f 6e73   rhs.npartitions
+00017cf0: 2960 602e 0a20 2020 2020 2020 2020 2020  )``..           
+00017d00: 2044 6566 6175 6c74 2069 7320 6060 4e6f   Default is ``No
+00017d10: 6e65 6060 2e0a 2020 2020 2020 2020 7368  ne``..        sh
+00017d20: 7566 666c 655f 6d65 7468 6f64 3a20 7b27  uffle_method: {'
+00017d30: 6469 736b 272c 2027 7461 736b 7327 2c20  disk', 'tasks', 
+00017d40: 2770 3270 277d 2c20 6f70 7469 6f6e 616c  'p2p'}, optional
+00017d50: 0a20 2020 2020 2020 2020 2020 2045 6974  .            Eit
+00017d60: 6865 7220 6060 2764 6973 6b27 6060 2066  her ``'disk'`` f
+00017d70: 6f72 2073 696e 676c 652d 6e6f 6465 206f  or single-node o
+00017d80: 7065 7261 7469 6f6e 206f 7220 6060 2774  peration or ``'t
+00017d90: 6173 6b73 2760 6020 616e 640a 2020 2020  asks'`` and.    
+00017da0: 2020 2020 2020 2020 6060 2770 3270 2760          ``'p2p'`
+00017db0: 6060 2066 6f72 2064 6973 7472 6962 7574  `` for distribut
+00017dc0: 6564 206f 7065 7261 7469 6f6e 2e20 2057  ed operation.  W
+00017dd0: 696c 6c20 6265 2069 6e66 6572 7265 6420  ill be inferred 
+00017de0: 6279 2079 6f75 720a 2020 2020 2020 2020  by your.        
+00017df0: 2020 2020 6375 7272 656e 7420 7363 6865      current sche
+00017e00: 6475 6c65 722e 0a20 2020 2020 2020 2062  duler..        b
+00017e10: 726f 6164 6361 7374 3a20 626f 6f6c 6561  roadcast: boolea
+00017e20: 6e20 6f72 2066 6c6f 6174 2c20 6f70 7469  n or float, opti
+00017e30: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
+00017e40: 2057 6865 7468 6572 2074 6f20 7573 6520   Whether to use 
+00017e50: 6120 6272 6f61 6463 6173 742d 6261 7365  a broadcast-base
+00017e60: 6420 6a6f 696e 2069 6e20 6c69 6575 206f  d join in lieu o
+00017e70: 6620 6120 7368 7566 666c 652d 6261 7365  f a shuffle-base
+00017e80: 640a 2020 2020 2020 2020 2020 2020 6a6f  d.            jo
+00017e90: 696e 2066 6f72 2073 7570 706f 7274 6564  in for supported
+00017ea0: 2063 6173 6573 2e20 2042 7920 6465 6661   cases.  By defa
+00017eb0: 756c 742c 2061 2073 696d 706c 6520 6865  ult, a simple he
+00017ec0: 7572 6973 7469 6320 7769 6c6c 2062 650a  uristic will be.
+00017ed0: 2020 2020 2020 2020 2020 2020 7573 6564              used
+00017ee0: 2074 6f20 7365 6c65 6374 2074 6865 2075   to select the u
+00017ef0: 6e64 6572 6c79 696e 6720 616c 676f 7269  nderlying algori
+00017f00: 7468 6d2e 2049 6620 6120 666c 6f61 7469  thm. If a floati
+00017f10: 6e67 2d70 6f69 6e74 2076 616c 7565 0a20  ng-point value. 
+00017f20: 2020 2020 2020 2020 2020 2069 7320 7370             is sp
+00017f30: 6563 6966 6965 642c 2074 6861 7420 6e75  ecified, that nu
+00017f40: 6d62 6572 2077 696c 6c20 6265 2075 7365  mber will be use
+00017f50: 6420 6173 2074 6865 2060 6062 726f 6164  d as the ``broad
+00017f60: 6361 7374 5f62 6961 7360 600a 2020 2020  cast_bias``.    
+00017f70: 2020 2020 2020 2020 7769 7468 696e 2074          within t
+00017f80: 6865 2073 696d 706c 6520 6865 7572 6973  he simple heuris
+00017f90: 7469 6320 2861 206c 6172 6765 206e 756d  tic (a large num
+00017fa0: 6265 7220 6d61 6b65 7320 4461 736b 206d  ber makes Dask m
+00017fb0: 6f72 6520 6c69 6b65 6c79 0a20 2020 2020  ore likely.     
+00017fc0: 2020 2020 2020 2074 6f20 6368 6f6f 7365         to choose
+00017fd0: 2074 6865 2060 6062 726f 6163 6173 745f   the ``broacast_
+00017fe0: 6a6f 696e 6060 2063 6f64 6520 7061 7468  join`` code path
+00017ff0: 292e 2053 6565 2060 6062 726f 6164 6361  ). See ``broadca
+00018000: 7374 5f6a 6f69 6e60 600a 2020 2020 2020  st_join``.      
+00018010: 2020 2020 2020 666f 7220 6d6f 7265 2069        for more i
+00018020: 6e66 6f72 6d61 7469 6f6e 2e0a 0a20 2020  nformation...   
+00018030: 2020 2020 204e 6f74 6573 0a20 2020 2020       Notes.     
+00018040: 2020 202d 2d2d 2d2d 0a0a 2020 2020 2020     -----..      
+00018050: 2020 5468 6572 6520 6172 6520 7468 7265    There are thre
+00018060: 6520 7761 7973 2074 6f20 6a6f 696e 2064  e ways to join d
+00018070: 6174 6166 7261 6d65 733a 0a0a 2020 2020  ataframes:..    
+00018080: 2020 2020 312e 204a 6f69 6e69 6e67 206f      1. Joining o
+00018090: 6e20 696e 6469 6365 732e 2049 6e20 7468  n indices. In th
+000180a0: 6973 2063 6173 6520 7468 6520 6469 7669  is case the divi
+000180b0: 7369 6f6e 7320 6172 650a 2020 2020 2020  sions are.      
+000180c0: 2020 2020 2061 6c69 676e 6564 2075 7369       aligned usi
+000180d0: 6e67 2074 6865 2066 756e 6374 696f 6e20  ng the function 
+000180e0: 6060 6461 736b 2e64 6174 6166 7261 6d65  ``dask.dataframe
+000180f0: 2e6d 756c 7469 2e61 6c69 676e 5f70 6172  .multi.align_par
+00018100: 7469 7469 6f6e 7360 602e 0a20 2020 2020  titions``..     
+00018110: 2020 2020 2020 4166 7465 7277 6172 6473        Afterwards
+00018120: 2c20 6561 6368 2070 6172 7469 7469 6f6e  , each partition
+00018130: 2069 7320 6d65 7267 6564 2077 6974 6820   is merged with 
+00018140: 7468 6520 7061 6e64 6173 206d 6572 6765  the pandas merge
+00018150: 2066 756e 6374 696f 6e2e 0a0a 2020 2020   function...    
+00018160: 2020 2020 322e 204a 6f69 6e69 6e67 206f      2. Joining o
+00018170: 6e65 206f 6e20 696e 6465 7820 616e 6420  ne on index and 
+00018180: 6f6e 6520 6f6e 2063 6f6c 756d 6e2e 2049  one on column. I
+00018190: 6e20 7468 6973 2063 6173 6520 7468 6520  n this case the 
+000181a0: 6469 7669 7369 6f6e 7320 6f66 0a20 2020  divisions of.   
+000181b0: 2020 2020 2020 2020 6461 7461 6672 616d          datafram
+000181c0: 6520 6d65 7267 6564 2062 7920 696e 6465  e merged by inde
+000181d0: 7820 283a 6d61 7468 3a60 645f 6960 2920  x (:math:`d_i`) 
+000181e0: 6172 6520 7573 6564 2074 6f20 6469 7669  are used to divi
+000181f0: 6465 2074 6865 2063 6f6c 756d 6e0a 2020  de the column.  
+00018200: 2020 2020 2020 2020 206d 6572 6765 6420           merged 
+00018210: 6461 7461 6672 616d 6520 283a 6d61 7468  dataframe (:math
+00018220: 3a60 645f 6360 2920 6f6e 6520 7573 696e  :`d_c`) one usin
+00018230: 670a 2020 2020 2020 2020 2020 2060 6064  g.           ``d
+00018240: 6173 6b2e 6461 7461 6672 616d 652e 6d75  ask.dataframe.mu
+00018250: 6c74 692e 7265 6172 7261 6e67 655f 6279  lti.rearrange_by
+00018260: 5f64 6976 6973 696f 6e73 6060 2e20 496e  _divisions``. In
+00018270: 2074 6869 7320 6361 7365 2074 6865 0a20   this case the. 
+00018280: 2020 2020 2020 2020 2020 6d65 7267 6564            merged
+00018290: 2064 6174 6166 7261 6d65 2028 3a6d 6174   dataframe (:mat
+000182a0: 683a 6064 5f6d 6029 2068 6173 2074 6865  h:`d_m`) has the
+000182b0: 2065 7861 6374 2073 616d 6520 6469 7669   exact same divi
+000182c0: 7369 6f6e 730a 2020 2020 2020 2020 2020  sions.          
+000182d0: 2061 7320 283a 6d61 7468 3a60 645f 6960   as (:math:`d_i`
+000182e0: 292e 2054 6869 7320 6361 6e20 6c65 6164  ). This can lead
+000182f0: 2074 6f20 6973 7375 6573 2069 6620 796f   to issues if yo
+00018300: 7520 6d65 7267 6520 6d75 6c74 6970 6c65  u merge multiple
+00018310: 2072 6f77 7320 6672 6f6d 0a20 2020 2020   rows from.     
+00018320: 2020 2020 2020 283a 6d61 7468 3a60 645f        (:math:`d_
+00018330: 6360 2920 746f 206f 6e65 2072 6f77 2069  c`) to one row i
+00018340: 6e20 283a 6d61 7468 3a60 645f 6960 292e  n (:math:`d_i`).
+00018350: 0a0a 2020 2020 2020 2020 332e 204a 6f69  ..        3. Joi
+00018360: 6e69 6e67 2062 6f74 6820 6f6e 2063 6f6c  ning both on col
+00018370: 756d 6e73 2e20 496e 2074 6869 7320 6361  umns. In this ca
+00018380: 7365 2061 2068 6173 6820 6a6f 696e 2069  se a hash join i
+00018390: 7320 7065 7266 6f72 6d65 6420 7573 696e  s performed usin
+000183a0: 670a 2020 2020 2020 2020 2020 2060 6064  g.           ``d
+000183b0: 6173 6b2e 6461 7461 6672 616d 652e 6d75  ask.dataframe.mu
+000183c0: 6c74 692e 6861 7368 5f6a 6f69 6e60 602e  lti.hash_join``.
+000183d0: 0a0a 2020 2020 2020 2020 496e 2073 6f6d  ..        In som
+000183e0: 6520 6361 7365 732c 2079 6f75 206d 6179  e cases, you may
+000183f0: 2073 6565 2061 2060 604d 656d 6f72 7945   see a ``MemoryE
+00018400: 7272 6f72 6060 2069 6620 7468 6520 6060  rror`` if the ``
+00018410: 6d65 7267 6560 6020 6f70 6572 6174 696f  merge`` operatio
+00018420: 6e20 7265 7175 6972 6573 0a20 2020 2020  n requires.     
+00018430: 2020 2061 6e20 696e 7465 726e 616c 2060     an internal `
+00018440: 6073 6875 6666 6c65 6060 2c20 6265 6361  `shuffle``, beca
+00018450: 7573 6520 7368 7566 666c 696e 6720 706c  use shuffling pl
+00018460: 6163 6573 2061 6c6c 2072 6f77 7320 7468  aces all rows th
+00018470: 6174 2068 6176 6520 7468 6520 7361 6d65  at have the same
+00018480: 0a20 2020 2020 2020 2069 6e64 6578 2069  .        index i
+00018490: 6e20 7468 6520 7361 6d65 2070 6172 7469  n the same parti
+000184a0: 7469 6f6e 2e20 546f 2061 766f 6964 2074  tion. To avoid t
+000184b0: 6869 7320 6572 726f 722c 206d 616b 6520  his error, make 
+000184c0: 7375 7265 2061 6c6c 2072 6f77 7320 7769  sure all rows wi
+000184d0: 7468 2074 6865 0a20 2020 2020 2020 2073  th the.        s
+000184e0: 616d 6520 6060 6f6e 6060 2d63 6f6c 756d  ame ``on``-colum
+000184f0: 6e20 7661 6c75 6520 6361 6e20 6669 7420  n value can fit 
+00018500: 6f6e 2061 2073 696e 676c 6520 7061 7274  on a single part
+00018510: 6974 696f 6e2e 0a20 2020 2020 2020 2022  ition..        "
+00018520: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
+00018530: 6e20 6d65 7267 6528 0a20 2020 2020 2020  n merge(.       
+00018540: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+00018550: 2020 2020 2020 2072 6967 6874 2c0a 2020         right,.  
+00018560: 2020 2020 2020 2020 2020 686f 772c 0a20            how,. 
+00018570: 2020 2020 2020 2020 2020 206f 6e2c 0a20             on,. 
+00018580: 2020 2020 2020 2020 2020 206c 6566 745f             left_
+00018590: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
+000185a0: 7269 6768 745f 6f6e 2c0a 2020 2020 2020  right_on,.      
+000185b0: 2020 2020 2020 6c65 6674 5f69 6e64 6578        left_index
+000185c0: 2c0a 2020 2020 2020 2020 2020 2020 7269  ,.            ri
+000185d0: 6768 745f 696e 6465 782c 0a20 2020 2020  ght_index,.     
+000185e0: 2020 2020 2020 2073 7566 6669 7865 732c         suffixes,
+000185f0: 0a20 2020 2020 2020 2020 2020 2069 6e64  .            ind
+00018600: 6963 6174 6f72 2c0a 2020 2020 2020 2020  icator,.        
+00018610: 2020 2020 7368 7566 666c 655f 6d65 7468      shuffle_meth
+00018620: 6f64 2c0a 2020 2020 2020 2020 2020 2020  od,.            
+00018630: 6e70 6172 7469 7469 6f6e 733d 6e70 6172  npartitions=npar
+00018640: 7469 7469 6f6e 732c 0a20 2020 2020 2020  titions,.       
+00018650: 2020 2020 2062 726f 6164 6361 7374 3d62       broadcast=b
+00018660: 726f 6164 6361 7374 2c0a 2020 2020 2020  roadcast,.      
+00018670: 2020 290a 0a20 2020 2040 6465 7269 7665    )..    @derive
+00018680: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
+00018690: 616d 6529 0a20 2020 2064 6566 206a 6f69  ame).    def joi
+000186a0: 6e28 0a20 2020 2020 2020 2073 656c 662c  n(.        self,
+000186b0: 0a20 2020 2020 2020 206f 7468 6572 2c0a  .        other,.
+000186c0: 2020 2020 2020 2020 6f6e 3d4e 6f6e 652c          on=None,
+000186d0: 0a20 2020 2020 2020 2068 6f77 3d22 6c65  .        how="le
+000186e0: 6674 222c 0a20 2020 2020 2020 206c 7375  ft",.        lsu
+000186f0: 6666 6978 3d22 222c 0a20 2020 2020 2020  ffix="",.       
+00018700: 2072 7375 6666 6978 3d22 222c 0a20 2020   rsuffix="",.   
+00018710: 2020 2020 2073 6875 6666 6c65 5f6d 6574       shuffle_met
+00018720: 686f 643d 4e6f 6e65 2c0a 2020 2020 2020  hod=None,.      
+00018730: 2020 6e70 6172 7469 7469 6f6e 733d 4e6f    npartitions=No
+00018740: 6e65 2c0a 2020 2020 293a 0a20 2020 2020  ne,.    ):.     
+00018750: 2020 2069 6620 6e6f 7420 6973 696e 7374     if not isinst
+00018760: 616e 6365 286f 7468 6572 2c20 6c69 7374  ance(other, list
+00018770: 2920 616e 6420 6e6f 7420 6973 5f64 6173  ) and not is_das
+00018780: 6b5f 636f 6c6c 6563 7469 6f6e 286f 7468  k_collection(oth
+00018790: 6572 293a 0a20 2020 2020 2020 2020 2020  er):.           
+000187a0: 206f 7468 6572 203d 2066 726f 6d5f 7061   other = from_pa
+000187b0: 6e64 6173 286f 7468 6572 2c20 6e70 6172  ndas(other, npar
+000187c0: 7469 7469 6f6e 733d 3129 0a20 2020 2020  titions=1).     
+000187d0: 2020 2069 6620 280a 2020 2020 2020 2020     if (.        
+000187e0: 2020 2020 6e6f 7420 6973 696e 7374 616e      not isinstan
+000187f0: 6365 286f 7468 6572 2c20 6c69 7374 290a  ce(other, list).
+00018800: 2020 2020 2020 2020 2020 2020 616e 6420              and 
+00018810: 6e6f 7420 6973 5f64 6174 6166 7261 6d65  not is_dataframe
+00018820: 5f6c 696b 6528 6f74 6865 722e 5f6d 6574  _like(other._met
+00018830: 6129 0a20 2020 2020 2020 2020 2020 2061  a).            a
+00018840: 6e64 2068 6173 6174 7472 286f 7468 6572  nd hasattr(other
+00018850: 2e5f 6d65 7461 2c20 226e 616d 6522 290a  ._meta, "name").
+00018860: 2020 2020 2020 2020 293a 0a20 2020 2020          ):.     
+00018870: 2020 2020 2020 206f 7468 6572 203d 206e         other = n
+00018880: 6577 5f63 6f6c 6c65 6374 696f 6e28 6578  ew_collection(ex
+00018890: 7072 2e54 6f46 7261 6d65 286f 7468 6572  pr.ToFrame(other
+000188a0: 2929 0a0a 2020 2020 2020 2020 6966 206e  ))..        if n
+000188b0: 6f74 2069 7369 6e73 7461 6e63 6528 6f74  ot isinstance(ot
+000188c0: 6865 722c 2046 7261 6d65 4261 7365 293a  her, FrameBase):
+000188d0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+000188e0: 6e6f 7420 6973 696e 7374 616e 6365 286f  not isinstance(o
+000188f0: 7468 6572 2c20 6c69 7374 2920 6f72 206e  ther, list) or n
+00018900: 6f74 2061 6c6c 280a 2020 2020 2020 2020  ot all(.        
+00018910: 2020 2020 2020 2020 6973 696e 7374 616e          isinstan
+00018920: 6365 286f 2c20 4672 616d 6542 6173 6529  ce(o, FrameBase)
+00018930: 2066 6f72 206f 2069 6e20 6f74 6865 720a   for o in other.
+00018940: 2020 2020 2020 2020 2020 2020 293a 0a20              ):. 
+00018950: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00018960: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+00018970: 226f 7468 6572 206d 7573 7420 6265 2044  "other must be D
+00018980: 6174 6146 7261 6d65 206f 7220 6c69 7374  ataFrame or list
+00018990: 206f 6620 4461 7461 4672 616d 6573 2229   of DataFrames")
+000189a0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+000189b0: 686f 7720 6e6f 7420 696e 2028 226f 7574  how not in ("out
+000189c0: 6572 222c 2022 6c65 6674 2229 3a0a 2020  er", "left"):.  
+000189d0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+000189e0: 6973 6520 5661 6c75 6545 7272 6f72 2822  ise ValueError("
+000189f0: 6d65 7267 655f 6d75 6c74 6920 6f6e 6c79  merge_multi only
+00018a00: 2073 7570 706f 7274 7320 6c65 6674 206f   supports left o
+00018a10: 7220 6f75 7465 7220 6a6f 696e 7322 290a  r outer joins").
+00018a20: 0a20 2020 2020 2020 2020 2020 206f 7468  .            oth
+00018a30: 6572 203d 205b 0a20 2020 2020 2020 2020  er = [.         
+00018a40: 2020 2020 2020 2066 726f 6d5f 7061 6e64         from_pand
+00018a50: 6173 286f 2c20 6e70 6172 7469 7469 6f6e  as(o, npartition
+00018a60: 733d 3129 2069 6620 6e6f 7420 6973 5f64  s=1) if not is_d
+00018a70: 6173 6b5f 636f 6c6c 6563 7469 6f6e 286f  ask_collection(o
+00018a80: 2920 656c 7365 206f 0a20 2020 2020 2020  ) else o.       
+00018a90: 2020 2020 2020 2020 2066 6f72 206f 2069           for o i
+00018aa0: 6e20 6f74 6865 720a 2020 2020 2020 2020  n other.        
+00018ab0: 2020 2020 5d0a 0a20 2020 2020 2020 2020      ]..         
+00018ac0: 2020 2072 6574 7572 6e20 6e65 775f 636f     return new_co
+00018ad0: 6c6c 6563 7469 6f6e 280a 2020 2020 2020  llection(.      
+00018ae0: 2020 2020 2020 2020 2020 4a6f 696e 5265            JoinRe
+00018af0: 6375 7273 6976 6528 5b73 656c 662e 6578  cursive([self.ex
+00018b00: 7072 5d20 2b20 5b6f 2e65 7870 7220 666f  pr] + [o.expr fo
+00018b10: 7220 6f20 696e 206f 7468 6572 5d2c 2068  r o in other], h
+00018b20: 6f77 3d68 6f77 290a 2020 2020 2020 2020  ow=how).        
+00018b30: 2020 2020 290a 0a20 2020 2020 2020 2072      )..        r
+00018b40: 6574 7572 6e20 7365 6c66 2e6d 6572 6765  eturn self.merge
+00018b50: 280a 2020 2020 2020 2020 2020 2020 7269  (.            ri
+00018b60: 6768 743d 6f74 6865 722c 0a20 2020 2020  ght=other,.     
+00018b70: 2020 2020 2020 206c 6566 745f 696e 6465         left_inde
+00018b80: 783d 6f6e 2069 7320 4e6f 6e65 2c0a 2020  x=on is None,.  
+00018b90: 2020 2020 2020 2020 2020 7269 6768 745f            right_
+00018ba0: 696e 6465 783d 5472 7565 2c0a 2020 2020  index=True,.    
+00018bb0: 2020 2020 2020 2020 6c65 6674 5f6f 6e3d          left_on=
+00018bc0: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
+00018bd0: 686f 773d 686f 772c 0a20 2020 2020 2020  how=how,.       
+00018be0: 2020 2020 2073 7566 6669 7865 733d 286c       suffixes=(l
+00018bf0: 7375 6666 6978 2c20 7273 7566 6669 7829  suffix, rsuffix)
+00018c00: 2c0a 2020 2020 2020 2020 2020 2020 7368  ,.            sh
+00018c10: 7566 666c 655f 6d65 7468 6f64 3d73 6875  uffle_method=shu
+00018c20: 6666 6c65 5f6d 6574 686f 642c 0a20 2020  ffle_method,.   
+00018c30: 2020 2020 2020 2020 206e 7061 7274 6974           npartit
+00018c40: 696f 6e73 3d6e 7061 7274 6974 696f 6e73  ions=npartitions
+00018c50: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
+00018c60: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
+00018c70: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
+00018c80: 2064 6566 2067 726f 7570 6279 280a 2020   def groupby(.  
+00018c90: 2020 2020 2020 7365 6c66 2c20 6279 2c20        self, by, 
+00018ca0: 6772 6f75 705f 6b65 7973 3d54 7275 652c  group_keys=True,
+00018cb0: 2073 6f72 743d 4e6f 6e65 2c20 6f62 7365   sort=None, obse
+00018cc0: 7276 6564 3d4e 6f6e 652c 2064 726f 706e  rved=None, dropn
+00018cd0: 613d 4e6f 6e65 2c20 2a2a 6b77 6172 6773  a=None, **kwargs
+00018ce0: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
+00018cf0: 6672 6f6d 2064 6173 6b5f 6578 7072 2e5f  from dask_expr._
+00018d00: 6772 6f75 7062 7920 696d 706f 7274 2047  groupby import G
+00018d10: 726f 7570 4279 0a0a 2020 2020 2020 2020  roupBy..        
+00018d20: 6966 2069 7369 6e73 7461 6e63 6528 6279  if isinstance(by
+00018d30: 2c20 4672 616d 6542 6173 6529 2061 6e64  , FrameBase) and
+00018d40: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
+00018d50: 6279 2c20 5365 7269 6573 293a 0a20 2020  by, Series):.   
+00018d60: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+00018d70: 616c 7565 4572 726f 7228 0a20 2020 2020  alueError(.     
+00018d80: 2020 2020 2020 2020 2020 2066 2260 6279             f"`by
+00018d90: 6020 6d75 7374 2062 6520 6120 636f 6c75  ` must be a colu
+00018da0: 6d6e 206e 616d 6520 6f72 206c 6973 7420  mn name or list 
+00018db0: 6f66 2063 6f6c 756d 6e73 2c20 676f 7420  of columns, got 
+00018dc0: 7b62 797d 2e22 0a20 2020 2020 2020 2020  {by}.".         
+00018dd0: 2020 2029 0a0a 2020 2020 2020 2020 7265     )..        re
+00018de0: 7475 726e 2047 726f 7570 4279 280a 2020  turn GroupBy(.  
+00018df0: 2020 2020 2020 2020 2020 7365 6c66 2c0a            self,.
+00018e00: 2020 2020 2020 2020 2020 2020 6279 2c0a              by,.
+00018e10: 2020 2020 2020 2020 2020 2020 6772 6f75              grou
+00018e20: 705f 6b65 7973 3d67 726f 7570 5f6b 6579  p_keys=group_key
+00018e30: 732c 0a20 2020 2020 2020 2020 2020 2073  s,.            s
+00018e40: 6f72 743d 736f 7274 2c0a 2020 2020 2020  ort=sort,.      
+00018e50: 2020 2020 2020 6f62 7365 7276 6564 3d6f        observed=o
+00018e60: 6273 6572 7665 642c 0a20 2020 2020 2020  bserved,.       
+00018e70: 2020 2020 2064 726f 706e 613d 6472 6f70       dropna=drop
+00018e80: 6e61 2c0a 2020 2020 2020 2020 2020 2020  na,.            
+00018e90: 2a2a 6b77 6172 6773 2c0a 2020 2020 2020  **kwargs,.      
+00018ea0: 2020 290a 0a20 2020 2064 6566 205f 5f73    )..    def __s
+00018eb0: 6574 6974 656d 5f5f 2873 656c 662c 206b  etitem__(self, k
+00018ec0: 6579 2c20 7661 6c75 6529 3a0a 2020 2020  ey, value):.    
+00018ed0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+00018ee0: 6528 6b65 792c 2028 7475 706c 652c 206c  e(key, (tuple, l
+00018ef0: 6973 7429 2920 616e 6420 6973 696e 7374  ist)) and isinst
+00018f00: 616e 6365 2876 616c 7565 2c20 4461 7461  ance(value, Data
+00018f10: 4672 616d 6529 3a0a 2020 2020 2020 2020  Frame):.        
+00018f20: 2020 2020 6f75 7420 3d20 7365 6c66 2e61      out = self.a
+00018f30: 7373 6967 6e28 2a2a 7b6b 3a20 7661 6c75  ssign(**{k: valu
+00018f40: 655b 635d 2066 6f72 206b 2c20 6320 696e  e[c] for k, c in
+00018f50: 207a 6970 286b 6579 2c20 7661 6c75 652e   zip(key, value.
+00018f60: 636f 6c75 6d6e 7329 7d29 0a0a 2020 2020  columns)})..    
+00018f70: 2020 2020 656c 6966 2069 7369 6e73 7461      elif isinsta
+00018f80: 6e63 6528 6b65 792c 2070 642e 496e 6465  nce(key, pd.Inde
+00018f90: 7829 2061 6e64 206e 6f74 2069 7369 6e73  x) and not isins
+00018fa0: 7461 6e63 6528 7661 6c75 652c 2044 6174  tance(value, Dat
+00018fb0: 6146 7261 6d65 293a 0a20 2020 2020 2020  aFrame):.       
+00018fc0: 2020 2020 206f 7574 203d 2073 656c 662e       out = self.
+00018fd0: 6173 7369 676e 282a 2a7b 6b3a 2076 616c  assign(**{k: val
+00018fe0: 7565 2066 6f72 206b 2069 6e20 6c69 7374  ue for k in list
+00018ff0: 286b 6579 297d 290a 2020 2020 2020 2020  (key)}).        
+00019000: 656c 6966 2028 0a20 2020 2020 2020 2020  elif (.         
+00019010: 2020 2069 735f 6461 7461 6672 616d 655f     is_dataframe_
+00019020: 6c69 6b65 286b 6579 290a 2020 2020 2020  like(key).      
+00019030: 2020 2020 2020 6f72 2069 735f 7365 7269        or is_seri
+00019040: 6573 5f6c 696b 6528 6b65 7929 0a20 2020  es_like(key).   
+00019050: 2020 2020 2020 2020 206f 7220 6973 696e           or isin
+00019060: 7374 616e 6365 286b 6579 2c20 2844 6174  stance(key, (Dat
+00019070: 6146 7261 6d65 2c20 5365 7269 6573 2929  aFrame, Series))
+00019080: 0a20 2020 2020 2020 2029 3a0a 2020 2020  .        ):.    
+00019090: 2020 2020 2020 2020 6f75 7420 3d20 7365          out = se
+000190a0: 6c66 2e77 6865 7265 287e 6b65 792c 2076  lf.where(~key, v
+000190b0: 616c 7565 290a 2020 2020 2020 2020 656c  alue).        el
+000190c0: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
+000190d0: 6528 6b65 792c 2073 7472 293a 0a20 2020  e(key, str):.   
+000190e0: 2020 2020 2020 2020 2072 6169 7365 204e           raise N
+000190f0: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
+00019100: 6f72 2866 2249 7465 6d20 6173 7369 676e  or(f"Item assign
+00019110: 6d65 6e74 2077 6974 6820 7b74 7970 6528  ment with {type(
+00019120: 6b65 7929 7d20 6e6f 7420 7375 7070 6f72  key)} not suppor
+00019130: 7465 6422 290a 2020 2020 2020 2020 656c  ted").        el
+00019140: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00019150: 6f75 7420 3d20 7365 6c66 2e61 7373 6967  out = self.assig
+00019160: 6e28 2a2a 7b6b 6579 3a20 7661 6c75 657d  n(**{key: value}
+00019170: 290a 2020 2020 2020 2020 7365 6c66 2e5f  ).        self._
+00019180: 6578 7072 203d 206f 7574 2e5f 6578 7072  expr = out._expr
+00019190: 0a0a 2020 2020 6465 6620 5f5f 6465 6c69  ..    def __deli
+000191a0: 7465 6d5f 5f28 7365 6c66 2c20 6b65 7929  tem__(self, key)
+000191b0: 3a0a 2020 2020 2020 2020 636f 6c75 6d6e  :.        column
+000191c0: 7320 3d20 5b63 2066 6f72 2063 2069 6e20  s = [c for c in 
+000191d0: 7365 6c66 2e63 6f6c 756d 6e73 2069 6620  self.columns if 
+000191e0: 6320 213d 206b 6579 5d0a 2020 2020 2020  c != key].      
+000191f0: 2020 6f75 7420 3d20 7365 6c66 5b63 6f6c    out = self[col
+00019200: 756d 6e73 5d0a 2020 2020 2020 2020 7365  umns].        se
+00019210: 6c66 2e5f 6578 7072 203d 206f 7574 2e5f  lf._expr = out._
+00019220: 6578 7072 0a0a 2020 2020 6465 6620 5f5f  expr..    def __
+00019230: 6765 7461 7474 725f 5f28 7365 6c66 2c20  getattr__(self, 
+00019240: 6b65 7929 3a0a 2020 2020 2020 2020 7472  key):.        tr
+00019250: 793a 0a20 2020 2020 2020 2020 2020 2023  y:.            #
+00019260: 2050 7269 6f72 6974 697a 6520 6044 6174   Prioritize `Dat
+00019270: 6146 7261 6d65 6020 6174 7472 6962 7574  aFrame` attribut
+00019280: 6573 0a20 2020 2020 2020 2020 2020 2072  es.            r
+00019290: 6574 7572 6e20 6f62 6a65 6374 2e5f 5f67  eturn object.__g
+000192a0: 6574 6174 7472 6962 7574 655f 5f28 7365  etattribute__(se
+000192b0: 6c66 2c20 6b65 7929 0a20 2020 2020 2020  lf, key).       
+000192c0: 2065 7863 6570 7420 4174 7472 6962 7574   except Attribut
+000192d0: 6545 7272 6f72 2061 7320 6572 723a 0a20  eError as err:. 
+000192e0: 2020 2020 2020 2020 2020 2074 7279 3a0a             try:.
+000192f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019300: 2320 4368 6563 6b20 6966 206b 6579 2069  # Check if key i
+00019310: 7320 696e 2063 6f6c 756d 6e73 2069 6620  s in columns if 
+00019320: 6b65 790a 2020 2020 2020 2020 2020 2020  key.            
+00019330: 2020 2020 2320 6973 206e 6f74 2061 206e      # is not a n
+00019340: 6f72 6d61 6c20 6174 7472 6962 7574 650a  ormal attribute.
+00019350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019360: 6966 206b 6579 2069 6e20 7365 6c66 2e65  if key in self.e
+00019370: 7870 722e 5f6d 6574 612e 636f 6c75 6d6e  xpr._meta.column
+00019380: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
+00019390: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
+000193a0: 775f 636f 6c6c 6563 7469 6f6e 2873 656c  w_collection(sel
+000193b0: 662e 6578 7072 5b6b 6579 5d29 0a20 2020  f.expr[key]).   
+000193c0: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+000193d0: 7365 2065 7272 0a20 2020 2020 2020 2020  se err.         
+000193e0: 2020 2065 7863 6570 7420 4174 7472 6962     except Attrib
+000193f0: 7574 6545 7272 6f72 3a0a 2020 2020 2020  uteError:.      
+00019400: 2020 2020 2020 2020 2020 2320 4661 6c6c            # Fall
+00019410: 2062 6163 6b20 746f 2060 4261 7365 4672   back to `BaseFr
+00019420: 616d 652e 5f5f 6765 7461 7474 725f 5f60  ame.__getattr__`
+00019430: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00019440: 2072 6574 7572 6e20 7375 7065 7228 292e   return super().
+00019450: 5f5f 6765 7461 7474 725f 5f28 6b65 7929  __getattr__(key)
+00019460: 0a0a 2020 2020 6465 6620 5f5f 6469 725f  ..    def __dir_
+00019470: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
+00019480: 206f 203d 2073 6574 2864 6972 2874 7970   o = set(dir(typ
+00019490: 6528 7365 6c66 2929 290a 2020 2020 2020  e(self))).      
+000194a0: 2020 6f2e 7570 6461 7465 2873 656c 662e    o.update(self.
+000194b0: 5f5f 6469 6374 5f5f 290a 2020 2020 2020  __dict__).      
+000194c0: 2020 6f2e 7570 6461 7465 2873 6574 2864    o.update(set(d
+000194d0: 6972 2865 7870 722e 4578 7072 2929 290a  ir(expr.Expr))).
+000194e0: 2020 2020 2020 2020 6f2e 7570 6461 7465          o.update
+000194f0: 2863 2066 6f72 2063 2069 6e20 7365 6c66  (c for c in self
+00019500: 2e63 6f6c 756d 6e73 2069 6620 2869 7369  .columns if (isi
+00019510: 6e73 7461 6e63 6528 632c 2073 7472 2920  nstance(c, str) 
+00019520: 616e 6420 632e 6973 6964 656e 7469 6669  and c.isidentifi
+00019530: 6572 2829 2929 0a20 2020 2020 2020 2072  er())).        r
+00019540: 6574 7572 6e20 6c69 7374 286f 290a 0a20  eturn list(o).. 
+00019550: 2020 2064 6566 206d 6170 2873 656c 662c     def map(self,
+00019560: 2066 756e 632c 206e 615f 6163 7469 6f6e   func, na_action
+00019570: 3d4e 6f6e 652c 206d 6574 613d 4e6f 6e65  =None, meta=None
+00019580: 293a 0a20 2020 2020 2020 2069 6620 6e6f  ):.        if no
+00019590: 7420 5041 4e44 4153 5f47 455f 3231 303a  t PANDAS_GE_210:
+000195a0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+000195b0: 7365 204e 6f74 496d 706c 656d 656e 7465  se NotImplemente
+000195c0: 6445 7272 6f72 280a 2020 2020 2020 2020  dError(.        
+000195d0: 2020 2020 2020 2020 6622 4461 7461 4672          f"DataFr
+000195e0: 616d 652e 6d61 7020 7265 7175 6972 6573  ame.map requires
+000195f0: 2070 616e 6461 733e 3d32 2e31 2e30 2c20   pandas>=2.1.0, 
+00019600: 6275 7420 7061 6e64 6173 3d7b 5041 4e44  but pandas={PAND
+00019610: 4153 5f56 4552 5349 4f4e 7d20 6973 2022  AS_VERSION} is "
+00019620: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00019630: 2022 696e 7374 616c 6c65 642e 220a 2020   "installed.".  
+00019640: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00019650: 2020 2020 6966 206d 6574 6120 6973 204e      if meta is N
+00019660: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+00019670: 206d 6574 6120 3d20 6578 7072 2e5f 656d   meta = expr._em
+00019680: 756c 6174 6528 4d2e 6d61 702c 2073 656c  ulate(M.map, sel
+00019690: 662c 2066 756e 632c 206e 615f 6163 7469  f, func, na_acti
+000196a0: 6f6e 3d6e 615f 6163 7469 6f6e 2c20 7564  on=na_action, ud
+000196b0: 663d 5472 7565 290a 2020 2020 2020 2020  f=True).        
+000196c0: 2020 2020 7761 726e 696e 6773 2e77 6172      warnings.war
+000196d0: 6e28 6d65 7461 5f77 6172 6e69 6e67 286d  n(meta_warning(m
+000196e0: 6574 6129 290a 2020 2020 2020 2020 7265  eta)).        re
+000196f0: 7475 726e 206e 6577 5f63 6f6c 6c65 6374  turn new_collect
+00019700: 696f 6e28 6578 7072 2e4d 6170 2873 656c  ion(expr.Map(sel
+00019710: 662c 2061 7267 3d66 756e 632c 206e 615f  f, arg=func, na_
+00019720: 6163 7469 6f6e 3d6e 615f 6163 7469 6f6e  action=na_action
+00019730: 2c20 6d65 7461 3d6d 6574 6129 290a 0a20  , meta=meta)).. 
+00019740: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
+00019750: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
+00019760: 2020 2064 6566 206e 6c61 7267 6573 7428     def nlargest(
+00019770: 7365 6c66 2c20 6e3d 352c 2063 6f6c 756d  self, n=5, colum
+00019780: 6e73 3d4e 6f6e 652c 2073 706c 6974 5f65  ns=None, split_e
+00019790: 7665 7279 3d4e 6f6e 6529 3a0a 2020 2020  very=None):.    
+000197a0: 2020 2020 7265 7475 726e 206e 6577 5f63      return new_c
+000197b0: 6f6c 6c65 6374 696f 6e28 0a20 2020 2020  ollection(.     
+000197c0: 2020 2020 2020 204e 4c61 7267 6573 7428         NLargest(
+000197d0: 7365 6c66 2c20 6e3d 6e2c 205f 636f 6c75  self, n=n, _colu
+000197e0: 6d6e 733d 636f 6c75 6d6e 732c 2073 706c  mns=columns, spl
+000197f0: 6974 5f65 7665 7279 3d73 706c 6974 5f65  it_every=split_e
+00019800: 7665 7279 290a 2020 2020 2020 2020 290a  very).        ).
+00019810: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
+00019820: 6f6d 2870 642e 4461 7461 4672 616d 6529  om(pd.DataFrame)
+00019830: 0a20 2020 2064 6566 206e 736d 616c 6c65  .    def nsmalle
+00019840: 7374 2873 656c 662c 206e 3d35 2c20 636f  st(self, n=5, co
+00019850: 6c75 6d6e 733d 4e6f 6e65 2c20 7370 6c69  lumns=None, spli
+00019860: 745f 6576 6572 793d 4e6f 6e65 293a 0a20  t_every=None):. 
+00019870: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
+00019880: 775f 636f 6c6c 6563 7469 6f6e 280a 2020  w_collection(.  
+00019890: 2020 2020 2020 2020 2020 4e53 6d61 6c6c            NSmall
+000198a0: 6573 7428 7365 6c66 2c20 6e3d 6e2c 205f  est(self, n=n, _
+000198b0: 636f 6c75 6d6e 733d 636f 6c75 6d6e 732c  columns=columns,
+000198c0: 2073 706c 6974 5f65 7665 7279 3d73 706c   split_every=spl
+000198d0: 6974 5f65 7665 7279 290a 2020 2020 2020  it_every).      
+000198e0: 2020 290a 0a20 2020 2040 6465 7269 7665    )..    @derive
+000198f0: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
+00019900: 616d 6529 0a20 2020 2064 6566 206d 656d  ame).    def mem
+00019910: 6f72 795f 7573 6167 6528 7365 6c66 2c20  ory_usage(self, 
+00019920: 6465 6570 3d46 616c 7365 2c20 696e 6465  deep=False, inde
+00019930: 783d 5472 7565 293a 0a20 2020 2020 2020  x=True):.       
+00019940: 2072 6574 7572 6e20 6e65 775f 636f 6c6c   return new_coll
+00019950: 6563 7469 6f6e 284d 656d 6f72 7955 7361  ection(MemoryUsa
+00019960: 6765 4672 616d 6528 7365 6c66 2c20 6465  geFrame(self, de
+00019970: 6570 3d64 6565 702c 205f 696e 6465 783d  ep=deep, _index=
+00019980: 696e 6465 7829 290a 0a20 2020 2040 6465  index))..    @de
+00019990: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
+000199a0: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
+000199b0: 2063 6f6d 6269 6e65 2873 656c 662c 206f   combine(self, o
+000199c0: 7468 6572 2c20 6675 6e63 2c20 6669 6c6c  ther, func, fill
+000199d0: 5f76 616c 7565 3d4e 6f6e 652c 206f 7665  _value=None, ove
+000199e0: 7277 7269 7465 3d54 7275 6529 3a0a 2020  rwrite=True):.  
+000199f0: 2020 2020 2020 6f74 6865 7220 3d20 7365        other = se
+00019a00: 6c66 2e5f 6372 6561 7465 5f61 6c69 676e  lf._create_align
+00019a10: 6162 6c65 5f66 7261 6d65 286f 7468 6572  able_frame(other
+00019a20: 2c20 226f 7574 6572 2229 0a20 2020 2020  , "outer").     
+00019a30: 2020 2069 6620 6e6f 7420 6578 7072 2e61     if not expr.a
+00019a40: 7265 5f63 6f5f 616c 6967 6e65 6428 7365  re_co_aligned(se
+00019a50: 6c66 2e65 7870 722c 206f 7468 6572 2e65  lf.expr, other.e
+00019a60: 7870 7229 3a0a 2020 2020 2020 2020 2020  xpr):.          
+00019a70: 2020 7265 7475 726e 206e 6577 5f63 6f6c    return new_col
+00019a80: 6c65 6374 696f 6e28 0a20 2020 2020 2020  lection(.       
+00019a90: 2020 2020 2020 2020 2065 7870 722e 436f           expr.Co
+00019aa0: 6d62 696e 6546 7261 6d65 416c 6967 6e28  mbineFrameAlign(
+00019ab0: 7365 6c66 2c20 6f74 6865 722c 2066 756e  self, other, fun
+00019ac0: 632c 2066 696c 6c5f 7661 6c75 652c 206f  c, fill_value, o
+00019ad0: 7665 7277 7269 7465 290a 2020 2020 2020  verwrite).      
+00019ae0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00019af0: 7265 7475 726e 206e 6577 5f63 6f6c 6c65  return new_colle
+00019b00: 6374 696f 6e28 0a20 2020 2020 2020 2020  ction(.         
+00019b10: 2020 2065 7870 722e 436f 6d62 696e 6546     expr.CombineF
+00019b20: 7261 6d65 2873 656c 662c 206f 7468 6572  rame(self, other
+00019b30: 2c20 6675 6e63 2c20 6669 6c6c 5f76 616c  , func, fill_val
+00019b40: 7565 2c20 6f76 6572 7772 6974 6529 0a20  ue, overwrite). 
+00019b50: 2020 2020 2020 2029 0a0a 2020 2020 4064         )..    @d
+00019b60: 6572 6976 6564 5f66 726f 6d28 0a20 2020  erived_from(.   
+00019b70: 2020 2020 2070 642e 4461 7461 4672 616d       pd.DataFram
+00019b80: 652c 0a20 2020 2020 2020 2069 6e63 6f6e  e,.        incon
+00019b90: 7369 7374 656e 6369 6573 3d22 6b65 6570  sistencies="keep
+00019ba0: 3d46 616c 7365 2077 696c 6c20 7261 6973  =False will rais
+00019bb0: 6520 6120 6060 4e6f 7449 6d70 6c65 6d65  e a ``NotImpleme
+00019bc0: 6e74 6564 4572 726f 7260 6022 2c0a 2020  ntedError``",.  
+00019bd0: 2020 290a 2020 2020 6465 6620 6472 6f70    ).    def drop
+00019be0: 5f64 7570 6c69 6361 7465 7328 0a20 2020  _duplicates(.   
+00019bf0: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+00019c00: 2020 2073 7562 7365 743d 4e6f 6e65 2c0a     subset=None,.
+00019c10: 2020 2020 2020 2020 7370 6c69 745f 6576          split_ev
+00019c20: 6572 793d 4e6f 6e65 2c0a 2020 2020 2020  ery=None,.      
+00019c30: 2020 7370 6c69 745f 6f75 743d 5472 7565    split_out=True
+00019c40: 2c0a 2020 2020 2020 2020 7368 7566 666c  ,.        shuffl
+00019c50: 655f 6d65 7468 6f64 3d4e 6f6e 652c 0a20  e_method=None,. 
+00019c60: 2020 2020 2020 2069 676e 6f72 655f 696e         ignore_in
+00019c70: 6465 783d 4661 6c73 652c 0a20 2020 2020  dex=False,.     
+00019c80: 2020 206b 6565 703d 2266 6972 7374 222c     keep="first",
+00019c90: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
+00019ca0: 7368 7566 666c 655f 6d65 7468 6f64 203d  shuffle_method =
+00019cb0: 205f 6765 745f 7368 7566 666c 655f 7072   _get_shuffle_pr
+00019cc0: 6566 6572 7269 6e67 5f6f 7264 6572 2873  eferring_order(s
+00019cd0: 6875 6666 6c65 5f6d 6574 686f 6429 0a20  huffle_method). 
+00019ce0: 2020 2020 2020 2069 6620 6b65 6570 2069         if keep i
+00019cf0: 7320 4661 6c73 653a 0a20 2020 2020 2020  s False:.       
+00019d00: 2020 2020 2072 6169 7365 204e 6f74 496d       raise NotIm
+00019d10: 706c 656d 656e 7465 6445 7272 6f72 2822  plementedError("
+00019d20: 6472 6f70 5f64 7570 6c69 6361 7465 7320  drop_duplicates 
+00019d30: 7769 7468 206b 6565 703d 4661 6c73 6522  with keep=False"
+00019d40: 290a 2020 2020 2020 2020 2320 4661 696c  ).        # Fail
+00019d50: 2065 6172 6c79 2069 6620 7375 6273 6574   early if subset
+00019d60: 2069 7320 6e6f 7420 7661 6c69 642c 2065   is not valid, e
+00019d70: 2e67 2e20 6d69 7373 696e 6720 636f 6c75  .g. missing colu
+00019d80: 6d6e 730a 2020 2020 2020 2020 7375 6273  mns.        subs
+00019d90: 6574 203d 205f 636f 6e76 6572 745f 746f  et = _convert_to
+00019da0: 5f6c 6973 7428 7375 6273 6574 290a 2020  _list(subset).  
+00019db0: 2020 2020 2020 6d65 7461 5f6e 6f6e 656d        meta_nonem
+00019dc0: 7074 7928 7365 6c66 2e5f 6d65 7461 292e  pty(self._meta).
+00019dd0: 6472 6f70 5f64 7570 6c69 6361 7465 7328  drop_duplicates(
+00019de0: 7375 6273 6574 3d73 7562 7365 742c 206b  subset=subset, k
+00019df0: 6565 703d 6b65 6570 290a 2020 2020 2020  eep=keep).      
+00019e00: 2020 7265 7475 726e 206e 6577 5f63 6f6c    return new_col
+00019e10: 6c65 6374 696f 6e28 0a20 2020 2020 2020  lection(.       
+00019e20: 2020 2020 2044 726f 7044 7570 6c69 6361       DropDuplica
+00019e30: 7465 7328 0a20 2020 2020 2020 2020 2020  tes(.           
+00019e40: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+00019e50: 2020 2020 2020 2020 2020 2073 7562 7365             subse
+00019e60: 743d 7375 6273 6574 2c0a 2020 2020 2020  t=subset,.      
+00019e70: 2020 2020 2020 2020 2020 6967 6e6f 7265            ignore
+00019e80: 5f69 6e64 6578 3d69 676e 6f72 655f 696e  _index=ignore_in
+00019e90: 6465 782c 0a20 2020 2020 2020 2020 2020  dex,.           
+00019ea0: 2020 2020 2073 706c 6974 5f6f 7574 3d73       split_out=s
+00019eb0: 706c 6974 5f6f 7574 2c0a 2020 2020 2020  plit_out,.      
+00019ec0: 2020 2020 2020 2020 2020 7370 6c69 745f            split_
+00019ed0: 6576 6572 793d 7370 6c69 745f 6576 6572  every=split_ever
+00019ee0: 792c 0a20 2020 2020 2020 2020 2020 2020  y,.             
+00019ef0: 2020 2073 6875 6666 6c65 5f6d 6574 686f     shuffle_metho
+00019f00: 643d 7368 7566 666c 655f 6d65 7468 6f64  d=shuffle_method
+00019f10: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00019f20: 2020 6b65 6570 3d6b 6565 702c 0a20 2020    keep=keep,.   
+00019f30: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00019f40: 2020 2029 0a0a 2020 2020 4069 6e73 6572     )..    @inser
+00019f50: 745f 6d65 7461 5f70 6172 616d 5f64 6573  t_meta_param_des
+00019f60: 6372 6970 7469 6f6e 2870 6164 3d31 3229  cription(pad=12)
+00019f70: 0a20 2020 2064 6566 2061 7070 6c79 2873  .    def apply(s
+00019f80: 656c 662c 2066 756e 6374 696f 6e2c 202a  elf, function, *
+00019f90: 6172 6773 2c20 6d65 7461 3d6e 6f5f 6465  args, meta=no_de
+00019fa0: 6661 756c 742c 2061 7869 733d 302c 202a  fault, axis=0, *
+00019fb0: 2a6b 7761 7267 7329 3a0a 2020 2020 2020  *kwargs):.      
+00019fc0: 2020 2222 2250 6172 616c 6c65 6c20 7665    """Parallel ve
+00019fd0: 7273 696f 6e20 6f66 2070 616e 6461 732e  rsion of pandas.
+00019fe0: 4461 7461 4672 616d 652e 6170 706c 790a  DataFrame.apply.
+00019ff0: 0a20 2020 2020 2020 2054 6869 7320 6d69  .        This mi
+0001a000: 6d69 6373 2074 6865 2070 616e 6461 7320  mics the pandas 
+0001a010: 7665 7273 696f 6e20 6578 6365 7074 2066  version except f
+0001a020: 6f72 2074 6865 2066 6f6c 6c6f 7769 6e67  or the following
+0001a030: 3a0a 0a20 2020 2020 2020 2031 2e20 204f  :..        1.  O
+0001a040: 6e6c 7920 6060 6178 6973 3d31 6060 2069  nly ``axis=1`` i
+0001a050: 7320 7375 7070 6f72 7465 6420 2861 6e64  s supported (and
+0001a060: 206d 7573 7420 6265 2073 7065 6369 6669   must be specifi
+0001a070: 6564 2065 7870 6c69 6369 746c 7929 2e0a  ed explicitly)..
+0001a080: 2020 2020 2020 2020 322e 2020 5468 6520          2.  The 
+0001a090: 7573 6572 2073 686f 756c 6420 7072 6f76  user should prov
+0001a0a0: 6964 6520 6f75 7470 7574 206d 6574 6164  ide output metad
+0001a0b0: 6174 6120 7669 6120 7468 6520 606d 6574  ata via the `met
+0001a0c0: 6160 206b 6579 776f 7264 2e0a 0a20 2020  a` keyword...   
+0001a0d0: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
+0001a0e0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0001a0f0: 2d2d 0a20 2020 2020 2020 2066 756e 6320  --.        func 
+0001a100: 3a20 6675 6e63 7469 6f6e 0a20 2020 2020  : function.     
+0001a110: 2020 2020 2020 2046 756e 6374 696f 6e20         Function 
+0001a120: 746f 2061 7070 6c79 2074 6f20 6561 6368  to apply to each
+0001a130: 2063 6f6c 756d 6e2f 726f 770a 2020 2020   column/row.    
+0001a140: 2020 2020 6178 6973 203a 207b 3020 6f72      axis : {0 or
+0001a150: 2027 696e 6465 7827 2c20 3120 6f72 2027   'index', 1 or '
+0001a160: 636f 6c75 6d6e 7327 7d2c 2064 6566 6175  columns'}, defau
+0001a170: 6c74 2030 0a20 2020 2020 2020 2020 2020  lt 0.           
+0001a180: 202d 2030 206f 7220 2769 6e64 6578 273a   - 0 or 'index':
+0001a190: 2061 7070 6c79 2066 756e 6374 696f 6e20   apply function 
+0001a1a0: 746f 2065 6163 6820 636f 6c75 6d6e 2028  to each column (
+0001a1b0: 4e4f 5420 5355 5050 4f52 5445 4429 0a20  NOT SUPPORTED). 
+0001a1c0: 2020 2020 2020 2020 2020 202d 2031 206f             - 1 o
+0001a1d0: 7220 2763 6f6c 756d 6e73 273a 2061 7070  r 'columns': app
+0001a1e0: 6c79 2066 756e 6374 696f 6e20 746f 2065  ly function to e
+0001a1f0: 6163 6820 726f 770a 2020 2020 2020 2020  ach row.        
+0001a200: 244d 4554 410a 2020 2020 2020 2020 6172  $META.        ar
+0001a210: 6773 203a 2074 7570 6c65 0a20 2020 2020  gs : tuple.     
+0001a220: 2020 2020 2020 2050 6f73 6974 696f 6e61         Positiona
+0001a230: 6c20 6172 6775 6d65 6e74 7320 746f 2070  l arguments to p
+0001a240: 6173 7320 746f 2066 756e 6374 696f 6e20  ass to function 
+0001a250: 696e 2061 6464 6974 696f 6e20 746f 2074  in addition to t
+0001a260: 6865 2061 7272 6179 2f73 6572 6965 730a  he array/series.
+0001a270: 0a20 2020 2020 2020 2041 6464 6974 696f  .        Additio
+0001a280: 6e61 6c20 6b65 7977 6f72 6420 6172 6775  nal keyword argu
+0001a290: 6d65 6e74 7320 7769 6c6c 2062 6520 7061  ments will be pa
+0001a2a0: 7373 6564 2061 7320 6b65 7977 6f72 6473  ssed as keywords
+0001a2b0: 2074 6f20 7468 6520 6675 6e63 7469 6f6e   to the function
+0001a2c0: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+0001a2d0: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+0001a2e0: 2d0a 2020 2020 2020 2020 6170 706c 6965  -.        applie
+0001a2f0: 6420 3a20 5365 7269 6573 206f 7220 4461  d : Series or Da
+0001a300: 7461 4672 616d 650a 0a20 2020 2020 2020  taFrame..       
+0001a310: 2045 7861 6d70 6c65 730a 2020 2020 2020   Examples.      
+0001a320: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020    --------.     
+0001a330: 2020 203e 3e3e 2069 6d70 6f72 7420 7061     >>> import pa
+0001a340: 6e64 6173 2061 7320 7064 0a20 2020 2020  ndas as pd.     
+0001a350: 2020 203e 3e3e 2069 6d70 6f72 7420 6461     >>> import da
+0001a360: 736b 2e64 6174 6166 7261 6d65 2061 7320  sk.dataframe as 
+0001a370: 6464 0a20 2020 2020 2020 203e 3e3e 2064  dd.        >>> d
+0001a380: 6620 3d20 7064 2e44 6174 6146 7261 6d65  f = pd.DataFrame
+0001a390: 287b 2778 273a 205b 312c 2032 2c20 332c  ({'x': [1, 2, 3,
+0001a3a0: 2034 2c20 355d 2c0a 2020 2020 2020 2020   4, 5],.        
+0001a3b0: 2e2e 2e20 2020 2020 2020 2020 2020 2020  ...             
+0001a3c0: 2020 2020 2020 2027 7927 3a20 5b31 2e2c         'y': [1.,
+0001a3d0: 2032 2e2c 2033 2e2c 2034 2e2c 2035 2e5d   2., 3., 4., 5.]
+0001a3e0: 7d29 0a20 2020 2020 2020 203e 3e3e 2064  }).        >>> d
+0001a3f0: 6466 203d 2064 642e 6672 6f6d 5f70 616e  df = dd.from_pan
+0001a400: 6461 7328 6466 2c20 6e70 6172 7469 7469  das(df, npartiti
+0001a410: 6f6e 733d 3229 0a0a 2020 2020 2020 2020  ons=2)..        
+0001a420: 4170 706c 7920 6120 6675 6e63 7469 6f6e  Apply a function
+0001a430: 2074 6f20 726f 772d 7769 7365 2070 6173   to row-wise pas
+0001a440: 7369 6e67 2069 6e20 6578 7472 6120 6172  sing in extra ar
+0001a450: 6775 6d65 6e74 7320 696e 2060 6061 7267  guments in ``arg
+0001a460: 7360 6020 616e 640a 2020 2020 2020 2020  s`` and.        
+0001a470: 6060 6b77 6172 6773 6060 3a0a 0a20 2020  ``kwargs``:..   
+0001a480: 2020 2020 203e 3e3e 2064 6566 206d 7961       >>> def mya
+0001a490: 6464 2872 6f77 2c20 612c 2062 3d31 293a  dd(row, a, b=1):
+0001a4a0: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+0001a4b0: 2072 6574 7572 6e20 726f 772e 7375 6d28   return row.sum(
+0001a4c0: 2920 2b20 6120 2b20 620a 2020 2020 2020  ) + a + b.      
+0001a4d0: 2020 3e3e 3e20 7265 7320 3d20 6464 662e    >>> res = ddf.
+0001a4e0: 6170 706c 7928 6d79 6164 642c 2061 7869  apply(myadd, axi
+0001a4f0: 733d 312c 2061 7267 733d 2832 2c29 2c20  s=1, args=(2,), 
+0001a500: 623d 312e 3529 2020 2320 646f 6374 6573  b=1.5)  # doctes
+0001a510: 743a 202b 534b 4950 0a0a 2020 2020 2020  t: +SKIP..      
+0001a520: 2020 4279 2064 6566 6175 6c74 2c20 6461    By default, da
+0001a530: 736b 2074 7269 6573 2074 6f20 696e 6665  sk tries to infe
+0001a540: 7220 7468 6520 6f75 7470 7574 206d 6574  r the output met
+0001a550: 6164 6174 6120 6279 2072 756e 6e69 6e67  adata by running
+0001a560: 2079 6f75 720a 2020 2020 2020 2020 7072   your.        pr
+0001a570: 6f76 6964 6564 2066 756e 6374 696f 6e20  ovided function 
+0001a580: 6f6e 2073 6f6d 6520 6661 6b65 2064 6174  on some fake dat
+0001a590: 612e 2054 6869 7320 776f 726b 7320 7765  a. This works we
+0001a5a0: 6c6c 2069 6e20 6d61 6e79 2063 6173 6573  ll in many cases
+0001a5b0: 2c20 6275 740a 2020 2020 2020 2020 6361  , but.        ca
+0001a5c0: 6e20 736f 6d65 7469 6d65 7320 6265 2065  n sometimes be e
+0001a5d0: 7870 656e 7369 7665 2c20 6f72 2065 7665  xpensive, or eve
+0001a5e0: 6e20 6661 696c 2e20 546f 2061 766f 6964  n fail. To avoid
+0001a5f0: 2074 6869 732c 2079 6f75 2063 616e 0a20   this, you can. 
+0001a600: 2020 2020 2020 206d 616e 7561 6c6c 7920         manually 
+0001a610: 7370 6563 6966 7920 7468 6520 6f75 7470  specify the outp
+0001a620: 7574 206d 6574 6164 6174 6120 7769 7468  ut metadata with
+0001a630: 2074 6865 2060 606d 6574 6160 6020 6b65   the ``meta`` ke
+0001a640: 7977 6f72 642e 2054 6869 730a 2020 2020  yword. This.    
+0001a650: 2020 2020 6361 6e20 6265 2073 7065 6369      can be speci
+0001a660: 6669 6564 2069 6e20 6d61 6e79 2066 6f72  fied in many for
+0001a670: 6d73 2c20 666f 7220 6d6f 7265 2069 6e66  ms, for more inf
+0001a680: 6f72 6d61 7469 6f6e 2073 6565 0a20 2020  ormation see.   
+0001a690: 2020 2020 2060 6064 6173 6b2e 6461 7461       ``dask.data
+0001a6a0: 6672 616d 652e 7574 696c 732e 6d61 6b65  frame.utils.make
+0001a6b0: 5f6d 6574 6160 602e 0a0a 2020 2020 2020  _meta``...      
+0001a6c0: 2020 4865 7265 2077 6520 7370 6563 6966    Here we specif
+0001a6d0: 7920 7468 6520 6f75 7470 7574 2069 7320  y the output is 
+0001a6e0: 6120 5365 7269 6573 2077 6974 6820 6e61  a Series with na
+0001a6f0: 6d65 2060 6027 7827 6060 2c20 616e 6420  me ``'x'``, and 
+0001a700: 6474 7970 650a 2020 2020 2020 2020 6060  dtype.        ``
+0001a710: 666c 6f61 7436 3460 603a 0a0a 2020 2020  float64``:..    
+0001a720: 2020 2020 3e3e 3e20 7265 7320 3d20 6464      >>> res = dd
+0001a730: 662e 6170 706c 7928 6d79 6164 642c 2061  f.apply(myadd, a
+0001a740: 7869 733d 312c 2061 7267 733d 2832 2c29  xis=1, args=(2,)
+0001a750: 2c20 623d 312e 352c 206d 6574 613d 2827  , b=1.5, meta=('
+0001a760: 7827 2c20 2766 3827 2929 0a0a 2020 2020  x', 'f8'))..    
+0001a770: 2020 2020 496e 2074 6865 2063 6173 6520      In the case 
+0001a780: 7768 6572 6520 7468 6520 6d65 7461 6461  where the metada
+0001a790: 7461 2064 6f65 736e 2774 2063 6861 6e67  ta doesn't chang
+0001a7a0: 652c 2079 6f75 2063 616e 2061 6c73 6f20  e, you can also 
+0001a7b0: 7061 7373 2069 6e0a 2020 2020 2020 2020  pass in.        
+0001a7c0: 7468 6520 6f62 6a65 6374 2069 7473 656c  the object itsel
+0001a7d0: 6620 6469 7265 6374 6c79 3a0a 0a20 2020  f directly:..   
+0001a7e0: 2020 2020 203e 3e3e 2072 6573 203d 2064       >>> res = d
+0001a7f0: 6466 2e61 7070 6c79 286c 616d 6264 6120  df.apply(lambda 
+0001a800: 726f 773a 2072 6f77 202b 2031 2c20 6178  row: row + 1, ax
+0001a810: 6973 3d31 2c20 6d65 7461 3d64 6466 290a  is=1, meta=ddf).
+0001a820: 0a20 2020 2020 2020 2053 6565 2041 6c73  .        See Als
+0001a830: 6f0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  o.        ------
+0001a840: 2d2d 0a20 2020 2020 2020 2044 6174 6146  --.        DataF
+0001a850: 7261 6d65 2e6d 6170 5f70 6172 7469 7469  rame.map_partiti
+0001a860: 6f6e 730a 2020 2020 2020 2020 2222 220a  ons.        """.
+0001a870: 2020 2020 2020 2020 6178 6973 203d 2073          axis = s
+0001a880: 656c 662e 5f76 616c 6964 6174 655f 6178  elf._validate_ax
+0001a890: 6973 2861 7869 7329 0a20 2020 2020 2020  is(axis).       
+0001a8a0: 2069 6620 6178 6973 203d 3d20 303a 0a20   if axis == 0:. 
+0001a8b0: 2020 2020 2020 2020 2020 206d 7367 203d             msg =
+0001a8c0: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
+0001a8d0: 2020 2022 4461 736b 2044 6174 6146 7261     "Dask DataFra
+0001a8e0: 6d65 2e61 7070 6c79 206f 6e6c 7920 7375  me.apply only su
+0001a8f0: 7070 6f72 7473 2061 7869 733d 315c 6e22  pports axis=1\n"
+0001a900: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001a910: 2022 2020 5472 793a 2064 662e 6170 706c   "  Try: df.appl
+0001a920: 7928 6675 6e63 2c20 6178 6973 3d31 2922  y(func, axis=1)"
+0001a930: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+0001a940: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0001a950: 204e 6f74 496d 706c 656d 656e 7465 6445   NotImplementedE
+0001a960: 7272 6f72 286d 7367 290a 2020 2020 2020  rror(msg).      
+0001a970: 2020 6966 206d 6574 6120 6973 206e 6f5f    if meta is no_
+0001a980: 6465 6661 756c 743a 0a20 2020 2020 2020  default:.       
+0001a990: 2020 2020 206d 6574 6120 3d20 6578 7072       meta = expr
+0001a9a0: 2e5f 656d 756c 6174 6528 0a20 2020 2020  ._emulate(.     
+0001a9b0: 2020 2020 2020 2020 2020 204d 2e61 7070             M.app
+0001a9c0: 6c79 2c20 7365 6c66 2c20 6675 6e63 7469  ly, self, functi
+0001a9d0: 6f6e 2c20 6172 6773 3d61 7267 732c 2075  on, args=args, u
+0001a9e0: 6466 3d54 7275 652c 2061 7869 733d 6178  df=True, axis=ax
+0001a9f0: 6973 2c20 2a2a 6b77 6172 6773 0a20 2020  is, **kwargs.   
+0001aa00: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0001aa10: 2020 2020 2020 2077 6172 6e69 6e67 732e         warnings.
+0001aa20: 7761 726e 286d 6574 615f 7761 726e 696e  warn(meta_warnin
+0001aa30: 6728 6d65 7461 2929 0a20 2020 2020 2020  g(meta)).       
+0001aa40: 2072 6574 7572 6e20 6e65 775f 636f 6c6c   return new_coll
+0001aa50: 6563 7469 6f6e 280a 2020 2020 2020 2020  ection(.        
+0001aa60: 2020 2020 7365 6c66 2e65 7870 722e 6170      self.expr.ap
+0001aa70: 706c 7928 6675 6e63 7469 6f6e 2c20 2a61  ply(function, *a
+0001aa80: 7267 732c 206d 6574 613d 6d65 7461 2c20  rgs, meta=meta, 
+0001aa90: 6178 6973 3d61 7869 732c 202a 2a6b 7761  axis=axis, **kwa
+0001aaa0: 7267 7329 0a20 2020 2020 2020 2029 0a0a  rgs).        )..
+0001aab0: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
+0001aac0: 6d28 7064 2e44 6174 6146 7261 6d65 290a  m(pd.DataFrame).
+0001aad0: 2020 2020 6465 6620 6472 6f70 6e61 2873      def dropna(s
+0001aae0: 656c 662c 2068 6f77 3d6e 6f5f 6465 6661  elf, how=no_defa
+0001aaf0: 756c 742c 2073 7562 7365 743d 4e6f 6e65  ult, subset=None
+0001ab00: 2c20 7468 7265 7368 3d6e 6f5f 6465 6661  , thresh=no_defa
+0001ab10: 756c 7429 3a0a 2020 2020 2020 2020 6966  ult):.        if
+0001ab20: 2068 6f77 2069 7320 6e6f 7420 6e6f 5f64   how is not no_d
+0001ab30: 6566 6175 6c74 2061 6e64 2074 6872 6573  efault and thres
+0001ab40: 6820 6973 206e 6f74 206e 6f5f 6465 6661  h is not no_defa
+0001ab50: 756c 743a 0a20 2020 2020 2020 2020 2020  ult:.           
+0001ab60: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
+0001ab70: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0001ab80: 2020 2259 6f75 2063 616e 6e6f 7420 7365    "You cannot se
+0001ab90: 7420 626f 7468 2074 6865 2068 6f77 2061  t both the how a
+0001aba0: 6e64 2074 6872 6573 6820 6172 6775 6d65  nd thresh argume
+0001abb0: 6e74 7320 6174 2074 6865 2073 616d 6520  nts at the same 
+0001abc0: 7469 6d65 2e22 0a20 2020 2020 2020 2020  time.".         
+0001abd0: 2020 2029 0a20 2020 2020 2020 2073 7562     ).        sub
+0001abe0: 7365 7420 3d20 5f63 6f6e 7665 7274 5f74  set = _convert_t
+0001abf0: 6f5f 6c69 7374 2873 7562 7365 7429 0a20  o_list(subset). 
+0001ac00: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
+0001ac10: 775f 636f 6c6c 6563 7469 6f6e 280a 2020  w_collection(.  
+0001ac20: 2020 2020 2020 2020 2020 6578 7072 2e44            expr.D
+0001ac30: 726f 706e 6146 7261 6d65 2873 656c 662c  ropnaFrame(self,
+0001ac40: 2068 6f77 3d68 6f77 2c20 7375 6273 6574   how=how, subset
+0001ac50: 3d73 7562 7365 742c 2074 6872 6573 683d  =subset, thresh=
+0001ac60: 7468 7265 7368 290a 2020 2020 2020 2020  thresh).        
+0001ac70: 290a 0a20 2020 2040 636c 6173 736d 6574  )..    @classmet
+0001ac80: 686f 640a 2020 2020 6465 6620 5f76 616c  hod.    def _val
+0001ac90: 6964 6174 655f 6178 6973 2863 6c73 2c20  idate_axis(cls, 
+0001aca0: 6178 6973 3d30 2c20 6e75 6d65 7269 635f  axis=0, numeric_
+0001acb0: 6178 6973 3a20 626f 6f6c 203d 2054 7275  axis: bool = Tru
+0001acc0: 6529 202d 3e20 4e6f 6e65 207c 204c 6974  e) -> None | Lit
+0001acd0: 6572 616c 5b30 2c20 315d 3a0a 2020 2020  eral[0, 1]:.    
+0001ace0: 2020 2020 6966 2061 7869 7320 6e6f 7420      if axis not 
+0001acf0: 696e 2028 302c 2031 2c20 2269 6e64 6578  in (0, 1, "index
+0001ad00: 222c 2022 636f 6c75 6d6e 7322 2c20 4e6f  ", "columns", No
+0001ad10: 6e65 293a 0a20 2020 2020 2020 2020 2020  ne):.           
+0001ad20: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+0001ad30: 7228 6622 4e6f 2061 7869 7320 6e61 6d65  r(f"No axis name
+0001ad40: 6420 7b61 7869 737d 2229 0a20 2020 2020  d {axis}").     
+0001ad50: 2020 2069 6620 6e75 6d65 7269 635f 6178     if numeric_ax
+0001ad60: 6973 3a0a 2020 2020 2020 2020 2020 2020  is:.            
+0001ad70: 6e75 6d5f 6178 6973 3a20 6469 6374 5b73  num_axis: dict[s
+0001ad80: 7472 207c 204e 6f6e 652c 204c 6974 6572  tr | None, Liter
+0001ad90: 616c 5b30 2c20 315d 5d20 3d20 7b22 696e  al[0, 1]] = {"in
+0001ada0: 6465 7822 3a20 302c 2022 636f 6c75 6d6e  dex": 0, "column
+0001adb0: 7322 3a20 317d 0a20 2020 2020 2020 2020  s": 1}.         
+0001adc0: 2020 2072 6574 7572 6e20 6e75 6d5f 6178     return num_ax
+0001add0: 6973 2e67 6574 2861 7869 732c 2061 7869  is.get(axis, axi
+0001ade0: 7329 0a20 2020 2020 2020 2065 6c73 653a  s).        else:
+0001adf0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0001ae00: 7572 6e20 6178 6973 0a0a 2020 2020 4064  urn axis..    @d
+0001ae10: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
+0001ae20: 6174 6146 7261 6d65 2c20 7561 5f61 7267  ataFrame, ua_arg
+0001ae30: 733d 5b22 696e 6465 7822 5d29 0a20 2020  s=["index"]).   
+0001ae40: 2064 6566 2072 656e 616d 6528 7365 6c66   def rename(self
+0001ae50: 2c20 696e 6465 783d 4e6f 6e65 2c20 636f  , index=None, co
+0001ae60: 6c75 6d6e 733d 4e6f 6e65 293a 0a20 2020  lumns=None):.   
+0001ae70: 2020 2020 2069 6620 696e 6465 7820 6973       if index is
+0001ae80: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+0001ae90: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+0001aea0: 7565 4572 726f 7228 2243 616e 6e6f 7420  ueError("Cannot 
+0001aeb0: 7265 6e61 6d65 2069 6e64 6578 2e22 290a  rename index.").
+0001aec0: 2020 2020 2020 2020 7265 7475 726e 206e          return n
+0001aed0: 6577 5f63 6f6c 6c65 6374 696f 6e28 6578  ew_collection(ex
+0001aee0: 7072 2e52 656e 616d 6546 7261 6d65 2873  pr.RenameFrame(s
+0001aef0: 656c 662c 2063 6f6c 756d 6e73 3d63 6f6c  elf, columns=col
+0001af00: 756d 6e73 2929 0a0a 2020 2020 4064 6572  umns))..    @der
+0001af10: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
+0001af20: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
+0001af30: 7371 7565 657a 6528 7365 6c66 2c20 6178  squeeze(self, ax
+0001af40: 6973 3d4e 6f6e 6529 3a0a 2020 2020 2020  is=None):.      
+0001af50: 2020 6966 2061 7869 7320 696e 205b 4e6f    if axis in [No
+0001af60: 6e65 2c20 315d 3a0a 2020 2020 2020 2020  ne, 1]:.        
+0001af70: 2020 2020 6966 206c 656e 2873 656c 662e      if len(self.
+0001af80: 636f 6c75 6d6e 7329 203d 3d20 313a 0a20  columns) == 1:. 
+0001af90: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0001afa0: 6574 7572 6e20 7365 6c66 5b73 656c 662e  eturn self[self.
+0001afb0: 636f 6c75 6d6e 735b 305d 5d0a 2020 2020  columns[0]].    
+0001afc0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0001afd0: 2020 2020 2020 2020 2020 2020 2020 7265                re
+0001afe0: 7475 726e 2073 656c 660a 0a20 2020 2020  turn self..     
+0001aff0: 2020 2065 6c69 6620 6178 6973 203d 3d20     elif axis == 
+0001b000: 303a 0a20 2020 2020 2020 2020 2020 2072  0:.            r
+0001b010: 6169 7365 204e 6f74 496d 706c 656d 656e  aise NotImplemen
+0001b020: 7465 6445 7272 6f72 280a 2020 2020 2020  tedError(.      
+0001b030: 2020 2020 2020 2020 2020 6622 7b74 7970            f"{typ
+0001b040: 6528 7365 6c66 297d 2064 6f65 7320 6e6f  e(self)} does no
+0001b050: 7420 7375 7070 6f72 7420 7371 7565 657a  t support squeez
+0001b060: 6520 616c 6f6e 6720 6178 6973 2030 220a  e along axis 0".
+0001b070: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+0001b080: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0001b090: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+0001b0a0: 616c 7565 4572 726f 7228 6622 4e6f 2061  alueError(f"No a
+0001b0b0: 7869 7320 7b61 7869 737d 2066 6f72 206f  xis {axis} for o
+0001b0c0: 626a 6563 7420 7479 7065 207b 7479 7065  bject type {type
+0001b0d0: 2873 656c 6629 7d22 290a 0a20 2020 2040  (self)}")..    @
+0001b0e0: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
+0001b0f0: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
+0001b100: 6566 2065 7870 6c6f 6465 2873 656c 662c  ef explode(self,
+0001b110: 2063 6f6c 756d 6e29 3a0a 2020 2020 2020   column):.      
+0001b120: 2020 636f 6c75 6d6e 203d 205f 636f 6e76    column = _conv
+0001b130: 6572 745f 746f 5f6c 6973 7428 636f 6c75  ert_to_list(colu
+0001b140: 6d6e 290a 2020 2020 2020 2020 7265 7475  mn).        retu
+0001b150: 726e 206e 6577 5f63 6f6c 6c65 6374 696f  rn new_collectio
+0001b160: 6e28 6578 7072 2e45 7870 6c6f 6465 4672  n(expr.ExplodeFr
+0001b170: 616d 6528 7365 6c66 2c20 636f 6c75 6d6e  ame(self, column
+0001b180: 3d63 6f6c 756d 6e29 290a 0a20 2020 2040  =column))..    @
+0001b190: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
+0001b1a0: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
+0001b1b0: 6566 2064 726f 7028 7365 6c66 2c20 6c61  ef drop(self, la
+0001b1c0: 6265 6c73 3d4e 6f6e 652c 2061 7869 733d  bels=None, axis=
+0001b1d0: 302c 2063 6f6c 756d 6e73 3d4e 6f6e 652c  0, columns=None,
+0001b1e0: 2065 7272 6f72 733d 2272 6169 7365 2229   errors="raise")
+0001b1f0: 3a0a 2020 2020 2020 2020 6966 2063 6f6c  :.        if col
+0001b200: 756d 6e73 2069 7320 4e6f 6e65 2061 6e64  umns is None and
+0001b210: 206c 6162 656c 7320 6973 204e 6f6e 653a   labels is None:
+0001b220: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+0001b230: 7365 2054 7970 6545 7272 6f72 2822 6d75  se TypeError("mu
+0001b240: 7374 2065 6974 6865 7220 7370 6563 6966  st either specif
+0001b250: 7920 2763 6f6c 756d 6e73 2720 6f72 2027  y 'columns' or '
+0001b260: 6c61 6265 6c73 2722 290a 0a20 2020 2020  labels'")..     
+0001b270: 2020 2061 7869 7320 3d20 5f76 616c 6964     axis = _valid
+0001b280: 6174 655f 6178 6973 2861 7869 7329 0a0a  ate_axis(axis)..
+0001b290: 2020 2020 2020 2020 6966 2061 7869 7320          if axis 
+0001b2a0: 3d3d 2031 3a0a 2020 2020 2020 2020 2020  == 1:.          
+0001b2b0: 2020 636f 6c75 6d6e 7320 3d20 6c61 6265    columns = labe
+0001b2c0: 6c73 206f 7220 636f 6c75 6d6e 730a 2020  ls or columns.  
+0001b2d0: 2020 2020 2020 656c 6966 2061 7869 7320        elif axis 
+0001b2e0: 3d3d 2030 2061 6e64 2063 6f6c 756d 6e73  == 0 and columns
+0001b2f0: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
+0001b300: 2020 2020 2020 7261 6973 6520 4e6f 7449        raise NotI
+0001b310: 6d70 6c65 6d65 6e74 6564 4572 726f 7228  mplementedError(
+0001b320: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001b330: 2022 4472 6f70 2063 7572 7265 6e74 6c79   "Drop currently
+0001b340: 206f 6e6c 7920 776f 726b 7320 666f 7220   only works for 
+0001b350: 6178 6973 3d31 206f 7220 7768 656e 2063  axis=1 or when c
+0001b360: 6f6c 756d 6e73 2069 7320 6e6f 7420 4e6f  olumns is not No
+0001b370: 6e65 220a 2020 2020 2020 2020 2020 2020  ne".            
+0001b380: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+0001b390: 206e 6577 5f63 6f6c 6c65 6374 696f 6e28   new_collection(
+0001b3a0: 6578 7072 2e44 726f 7028 7365 6c66 2c20  expr.Drop(self, 
+0001b3b0: 636f 6c75 6d6e 733d 636f 6c75 6d6e 732c  columns=columns,
+0001b3c0: 2065 7272 6f72 733d 6572 726f 7273 2929   errors=errors))
+0001b3d0: 0a0a 2020 2020 6465 6620 746f 5f70 6172  ..    def to_par
+0001b3e0: 7175 6574 2873 656c 662c 2070 6174 682c  quet(self, path,
+0001b3f0: 202a 2a6b 7761 7267 7329 3a0a 2020 2020   **kwargs):.    
+0001b400: 2020 2020 6672 6f6d 2064 6173 6b5f 6578      from dask_ex
+0001b410: 7072 2e69 6f2e 7061 7271 7565 7420 696d  pr.io.parquet im
+0001b420: 706f 7274 2074 6f5f 7061 7271 7565 740a  port to_parquet.
+0001b430: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0001b440: 746f 5f70 6172 7175 6574 2873 656c 662c  to_parquet(self,
+0001b450: 2070 6174 682c 202a 2a6b 7761 7267 7329   path, **kwargs)
+0001b460: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
+0001b470: 726f 6d28 7064 2e44 6174 6146 7261 6d65  rom(pd.DataFrame
+0001b480: 290a 2020 2020 6465 6620 7365 6c65 6374  ).    def select
+0001b490: 5f64 7479 7065 7328 7365 6c66 2c20 696e  _dtypes(self, in
+0001b4a0: 636c 7564 653d 4e6f 6e65 2c20 6578 636c  clude=None, excl
+0001b4b0: 7564 653d 4e6f 6e65 293a 0a20 2020 2020  ude=None):.     
+0001b4c0: 2020 2063 6f6c 756d 6e73 203d 206c 6973     columns = lis
+0001b4d0: 7428 0a20 2020 2020 2020 2020 2020 2073  t(.            s
+0001b4e0: 656c 662e 5f6d 6574 612e 7365 6c65 6374  elf._meta.select
+0001b4f0: 5f64 7479 7065 7328 696e 636c 7564 653d  _dtypes(include=
+0001b500: 696e 636c 7564 652c 2065 7863 6c75 6465  include, exclude
+0001b510: 3d65 7863 6c75 6465 292e 636f 6c75 6d6e  =exclude).column
+0001b520: 730a 2020 2020 2020 2020 290a 2020 2020  s.        ).    
+0001b530: 2020 2020 7265 7475 726e 206e 6577 5f63      return new_c
+0001b540: 6f6c 6c65 6374 696f 6e28 7365 6c66 2e65  ollection(self.e
+0001b550: 7870 725b 636f 6c75 6d6e 735d 290a 0a20  xpr[columns]).. 
+0001b560: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
+0001b570: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
+0001b580: 2020 2064 6566 2065 7661 6c28 7365 6c66     def eval(self
+0001b590: 2c20 6578 7072 2c20 2a2a 6b77 6172 6773  , expr, **kwargs
+0001b5a0: 293a 0a20 2020 2020 2020 2069 6620 2269  ):.        if "i
+0001b5b0: 6e70 6c61 6365 2220 696e 206b 7761 7267  nplace" in kwarg
+0001b5c0: 733a 0a20 2020 2020 2020 2020 2020 2072  s:.            r
+0001b5d0: 6169 7365 204e 6f74 496d 706c 656d 656e  aise NotImplemen
+0001b5e0: 7465 6445 7272 6f72 2822 696e 706c 6163  tedError("inplac
+0001b5f0: 6520 6973 206e 6f74 2073 7570 706f 7274  e is not support
+0001b600: 6564 2066 6f72 2065 7661 6c22 290a 2020  ed for eval").  
+0001b610: 2020 2020 2020 7265 7475 726e 206e 6577        return new
+0001b620: 5f63 6f6c 6c65 6374 696f 6e28 4576 616c  _collection(Eval
+0001b630: 2873 656c 662c 205f 6578 7072 3d65 7870  (self, _expr=exp
+0001b640: 722c 2065 7870 725f 6b77 6172 6773 3d6b  r, expr_kwargs=k
+0001b650: 7761 7267 7329 290a 0a20 2020 2064 6566  wargs))..    def
+0001b660: 2073 6574 5f69 6e64 6578 280a 2020 2020   set_index(.    
+0001b670: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+0001b680: 2020 6f74 6865 722c 0a20 2020 2020 2020    other,.       
+0001b690: 2064 726f 703d 5472 7565 2c0a 2020 2020   drop=True,.    
+0001b6a0: 2020 2020 736f 7274 6564 3d46 616c 7365      sorted=False
+0001b6b0: 2c0a 2020 2020 2020 2020 6e70 6172 7469  ,.        nparti
+0001b6c0: 7469 6f6e 733a 2069 6e74 207c 204e 6f6e  tions: int | Non
+0001b6d0: 6520 3d20 4e6f 6e65 2c0a 2020 2020 2020  e = None,.      
+0001b6e0: 2020 6469 7669 7369 6f6e 733d 4e6f 6e65    divisions=None
+0001b6f0: 2c0a 2020 2020 2020 2020 736f 7274 3a20  ,.        sort: 
+0001b700: 626f 6f6c 203d 2054 7275 652c 0a20 2020  bool = True,.   
+0001b710: 2020 2020 2073 6875 6666 6c65 5f6d 6574       shuffle_met
+0001b720: 686f 643d 4e6f 6e65 2c0a 2020 2020 2020  hod=None,.      
+0001b730: 2020 7570 7361 6d70 6c65 3a20 666c 6f61    upsample: floa
+0001b740: 7420 3d20 312e 302c 0a20 2020 2020 2020  t = 1.0,.       
+0001b750: 2070 6172 7469 7469 6f6e 5f73 697a 653a   partition_size:
+0001b760: 2066 6c6f 6174 203d 2031 3238 6536 2c0a   float = 128e6,.
+0001b770: 2020 2020 2020 2020 6170 7065 6e64 3a20          append: 
+0001b780: 626f 6f6c 203d 2046 616c 7365 2c0a 2020  bool = False,.  
+0001b790: 2020 2020 2020 2a2a 6f70 7469 6f6e 732c        **options,
+0001b7a0: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
+0001b7b0: 2222 2253 6574 2074 6865 2044 6174 6146  """Set the DataF
+0001b7c0: 7261 6d65 2069 6e64 6578 2028 726f 7720  rame index (row 
+0001b7d0: 6c61 6265 6c73 2920 7573 696e 6720 616e  labels) using an
+0001b7e0: 2065 7869 7374 696e 6720 636f 6c75 6d6e   existing column
+0001b7f0: 2e0a 0a20 2020 2020 2020 2049 6620 6060  ...        If ``
+0001b800: 736f 7274 3d46 616c 7365 6060 2c20 7468  sort=False``, th
+0001b810: 6973 2066 756e 6374 696f 6e20 6f70 6572  is function oper
+0001b820: 6174 6573 2065 7861 6374 6c79 206c 696b  ates exactly lik
+0001b830: 6520 6060 7061 6e64 6173 2e73 6574 5f69  e ``pandas.set_i
+0001b840: 6e64 6578 6060 0a20 2020 2020 2020 2061  ndex``.        a
+0001b850: 6e64 2073 6574 7320 7468 6520 696e 6465  nd sets the inde
+0001b860: 7820 6f6e 2074 6865 2044 6174 6146 7261  x on the DataFra
+0001b870: 6d65 2e20 4966 2060 6073 6f72 743d 5472  me. If ``sort=Tr
+0001b880: 7565 6060 2028 6465 6661 756c 7429 2c0a  ue`` (default),.
+0001b890: 2020 2020 2020 2020 7468 6973 2066 756e          this fun
+0001b8a0: 6374 696f 6e20 616c 736f 2073 6f72 7473  ction also sorts
+0001b8b0: 2074 6865 2044 6174 6146 7261 6d65 2062   the DataFrame b
+0001b8c0: 7920 7468 6520 6e65 7720 696e 6465 782e  y the new index.
+0001b8d0: 2054 6869 7320 6361 6e20 6861 7665 2061   This can have a
+0001b8e0: 0a20 2020 2020 2020 2073 6967 6e69 6669  .        signifi
+0001b8f0: 6361 6e74 2069 6d70 6163 7420 6f6e 2070  cant impact on p
+0001b900: 6572 666f 726d 616e 6365 2c20 6265 6361  erformance, beca
+0001b910: 7573 6520 6a6f 696e 732c 2067 726f 7570  use joins, group
+0001b920: 6279 732c 206c 6f6f 6b75 7073 2c20 6574  bys, lookups, et
+0001b930: 632e 0a20 2020 2020 2020 2061 7265 2061  c..        are a
+0001b940: 6c6c 206d 7563 6820 6661 7374 6572 206f  ll much faster o
+0001b950: 6e20 7468 6174 2063 6f6c 756d 6e2e 2048  n that column. H
+0001b960: 6f77 6576 6572 2c20 7468 6973 2070 6572  owever, this per
+0001b970: 666f 726d 616e 6365 2069 6e63 7265 6173  formance increas
+0001b980: 650a 2020 2020 2020 2020 636f 6d65 7320  e.        comes 
+0001b990: 7769 7468 2061 2063 6f73 742c 2073 6f72  with a cost, sor
+0001b9a0: 7469 6e67 2061 2070 6172 616c 6c65 6c20  ting a parallel 
+0001b9b0: 6461 7461 7365 7420 7265 7175 6972 6573  dataset requires
+0001b9c0: 2065 7870 656e 7369 7665 2073 6875 6666   expensive shuff
+0001b9d0: 6c65 732e 0a20 2020 2020 2020 204f 6674  les..        Oft
+0001b9e0: 656e 2077 6520 6060 7365 745f 696e 6465  en we ``set_inde
+0001b9f0: 7860 6020 6f6e 6365 2064 6972 6563 746c  x`` once directl
+0001ba00: 7920 6166 7465 7220 6461 7461 2069 6e67  y after data ing
+0001ba10: 6573 7420 616e 6420 6669 6c74 6572 696e  est and filterin
+0001ba20: 6720 616e 640a 2020 2020 2020 2020 7468  g and.        th
+0001ba30: 656e 2070 6572 666f 726d 206d 616e 7920  en perform many 
+0001ba40: 6368 6561 7020 636f 6d70 7574 6174 696f  cheap computatio
+0001ba50: 6e73 206f 6666 206f 6620 7468 6520 736f  ns off of the so
+0001ba60: 7274 6564 2064 6174 6173 6574 2e0a 0a20  rted dataset... 
+0001ba70: 2020 2020 2020 2057 6974 6820 6060 736f         With ``so
+0001ba80: 7274 3d54 7275 6560 602c 2074 6869 7320  rt=True``, this 
+0001ba90: 6675 6e63 7469 6f6e 2069 7320 6d75 6368  function is much
+0001baa0: 206d 6f72 6520 6578 7065 6e73 6976 652e   more expensive.
+0001bab0: 2055 6e64 6572 206e 6f72 6d61 6c0a 2020   Under normal.  
+0001bac0: 2020 2020 2020 6f70 6572 6174 696f 6e20        operation 
+0001bad0: 7468 6973 2066 756e 6374 696f 6e20 646f  this function do
+0001bae0: 6573 2061 6e20 696e 6974 6961 6c20 7061  es an initial pa
+0001baf0: 7373 206f 7665 7220 7468 6520 696e 6465  ss over the inde
+0001bb00: 7820 636f 6c75 6d6e 2074 6f0a 2020 2020  x column to.    
+0001bb10: 2020 2020 636f 6d70 7574 6520 6170 7072      compute appr
+0001bb20: 6f78 696d 6174 6520 7175 616e 7469 6c65  oximate quantile
+0001bb30: 7320 746f 2073 6572 7665 2061 7320 6675  s to serve as fu
+0001bb40: 7475 7265 2064 6976 6973 696f 6e73 2e20  ture divisions. 
+0001bb50: 4974 2074 6865 6e20 7061 7373 6573 0a20  It then passes. 
+0001bb60: 2020 2020 2020 206f 7665 7220 7468 6520         over the 
+0001bb70: 6461 7461 2061 2073 6563 6f6e 6420 7469  data a second ti
+0001bb80: 6d65 2c20 7370 6c69 7474 696e 6720 7570  me, splitting up
+0001bb90: 2065 6163 6820 696e 7075 7420 7061 7274   each input part
+0001bba0: 6974 696f 6e20 696e 746f 2073 6576 6572  ition into sever
+0001bbb0: 616c 0a20 2020 2020 2020 2070 6965 6365  al.        piece
+0001bbc0: 7320 616e 6420 7368 6172 696e 6720 7468  s and sharing th
+0001bbd0: 6f73 6520 7069 6563 6573 2074 6f20 616c  ose pieces to al
+0001bbe0: 6c20 6f66 2074 6865 206f 7574 7075 7420  l of the output 
+0001bbf0: 7061 7274 6974 696f 6e73 206e 6f77 2069  partitions now i
+0001bc00: 6e0a 2020 2020 2020 2020 736f 7274 6564  n.        sorted
+0001bc10: 206f 7264 6572 2e0a 0a20 2020 2020 2020   order...       
+0001bc20: 2049 6e20 736f 6d65 2063 6173 6573 2077   In some cases w
+0001bc30: 6520 6361 6e20 616c 6c65 7669 6174 6520  e can alleviate 
+0001bc40: 7468 6f73 6520 636f 7374 732c 2066 6f72  those costs, for
+0001bc50: 2065 7861 6d70 6c65 2069 6620 796f 7572   example if your
+0001bc60: 2064 6174 6173 6574 2069 730a 2020 2020   dataset is.    
+0001bc70: 2020 2020 736f 7274 6564 2061 6c72 6561      sorted alrea
+0001bc80: 6479 2074 6865 6e20 7765 2063 616e 2061  dy then we can a
+0001bc90: 766f 6964 206d 616b 696e 6720 6d61 6e79  void making many
+0001bca0: 2073 6d61 6c6c 2070 6965 6365 7320 6f72   small pieces or
+0001bcb0: 2069 6620 796f 7520 6b6e 6f77 0a20 2020   if you know.   
+0001bcc0: 2020 2020 2067 6f6f 6420 7661 6c75 6573       good values
+0001bcd0: 2074 6f20 7370 6c69 7420 7468 6520 6e65   to split the ne
+0001bce0: 7720 696e 6465 7820 636f 6c75 6d6e 2074  w index column t
+0001bcf0: 6865 6e20 7765 2063 616e 2061 766f 6964  hen we can avoid
+0001bd00: 2074 6865 2069 6e69 7469 616c 0a20 2020   the initial.   
+0001bd10: 2020 2020 2070 6173 7320 6f76 6572 2074       pass over t
+0001bd20: 6865 2064 6174 612e 2046 6f72 2065 7861  he data. For exa
+0001bd30: 6d70 6c65 2069 6620 796f 7572 206e 6577  mple if your new
+0001bd40: 2069 6e64 6578 2069 7320 6120 6461 7465   index is a date
+0001bd50: 7469 6d65 2069 6e64 6578 2061 6e64 0a20  time index and. 
+0001bd60: 2020 2020 2020 2079 6f75 7220 6461 7461         your data
+0001bd70: 2069 7320 616c 7265 6164 7920 736f 7274   is already sort
+0001bd80: 6564 2062 7920 6461 7920 7468 656e 2074  ed by day then t
+0001bd90: 6869 7320 656e 7469 7265 206f 7065 7261  his entire opera
+0001bda0: 7469 6f6e 2063 616e 2062 6520 646f 6e65  tion can be done
+0001bdb0: 0a20 2020 2020 2020 2066 6f72 2066 7265  .        for fre
+0001bdc0: 652e 2059 6f75 2063 616e 2063 6f6e 7472  e. You can contr
+0001bdd0: 6f6c 2074 6865 7365 206f 7074 696f 6e73  ol these options
+0001bde0: 2077 6974 6820 7468 6520 666f 6c6c 6f77   with the follow
+0001bdf0: 696e 6720 7061 7261 6d65 7465 7273 2e0a  ing parameters..
+0001be00: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+0001be10: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
+0001be20: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 206f  ------.        o
+0001be30: 7468 6572 3a20 7374 7269 6e67 206f 7220  ther: string or 
+0001be40: 4461 736b 2053 6572 6965 730a 2020 2020  Dask Series.    
+0001be50: 2020 2020 2020 2020 436f 6c75 6d6e 2074          Column t
+0001be60: 6f20 7573 6520 6173 2069 6e64 6578 2e0a  o use as index..
+0001be70: 2020 2020 2020 2020 6472 6f70 3a20 626f          drop: bo
+0001be80: 6f6c 6561 6e2c 2064 6566 6175 6c74 2054  olean, default T
+0001be90: 7275 650a 2020 2020 2020 2020 2020 2020  rue.            
+0001bea0: 4465 6c65 7465 2063 6f6c 756d 6e20 746f  Delete column to
+0001beb0: 2062 6520 7573 6564 2061 7320 7468 6520   be used as the 
+0001bec0: 6e65 7720 696e 6465 782e 0a20 2020 2020  new index..     
+0001bed0: 2020 2073 6f72 7465 643a 2062 6f6f 6c2c     sorted: bool,
+0001bee0: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
+0001bef0: 2020 2020 2020 4966 2074 6865 2069 6e64        If the ind
+0001bf00: 6578 2063 6f6c 756d 6e20 6973 2061 6c72  ex column is alr
+0001bf10: 6561 6479 2073 6f72 7465 6420 696e 2069  eady sorted in i
+0001bf20: 6e63 7265 6173 696e 6720 6f72 6465 722e  ncreasing order.
+0001bf30: 0a20 2020 2020 2020 2020 2020 2044 6566  .            Def
+0001bf40: 6175 6c74 7320 746f 2046 616c 7365 0a20  aults to False. 
+0001bf50: 2020 2020 2020 206e 7061 7274 6974 696f         npartitio
+0001bf60: 6e73 3a20 696e 742c 204e 6f6e 652c 206f  ns: int, None, o
+0001bf70: 7220 2761 7574 6f27 0a20 2020 2020 2020  r 'auto'.       
+0001bf80: 2020 2020 2054 6865 2069 6465 616c 206e       The ideal n
+0001bf90: 756d 6265 7220 6f66 206f 7574 7075 7420  umber of output 
+0001bfa0: 7061 7274 6974 696f 6e73 2e20 4966 204e  partitions. If N
+0001bfb0: 6f6e 652c 2075 7365 2074 6865 2073 616d  one, use the sam
+0001bfc0: 6520 6173 0a20 2020 2020 2020 2020 2020  e as.           
+0001bfd0: 2074 6865 2069 6e70 7574 2e20 4966 2027   the input. If '
+0001bfe0: 6175 746f 2720 7468 656e 2064 6563 6964  auto' then decid
+0001bff0: 6520 6279 206d 656d 6f72 7920 7573 652e  e by memory use.
+0001c000: 0a20 2020 2020 2020 2020 2020 204f 6e6c  .            Onl
+0001c010: 7920 7573 6564 2077 6865 6e20 6060 6469  y used when ``di
+0001c020: 7669 7369 6f6e 7360 6020 6973 206e 6f74  visions`` is not
+0001c030: 2067 6976 656e 2e20 4966 2060 6064 6976   given. If ``div
+0001c040: 6973 696f 6e73 6060 2069 7320 6769 7665  isions`` is give
+0001c050: 6e2c 0a20 2020 2020 2020 2020 2020 2074  n,.            t
+0001c060: 6865 206e 756d 6265 7220 6f66 206f 7574  he number of out
+0001c070: 7075 7420 7061 7274 6974 696f 6e73 2077  put partitions w
+0001c080: 696c 6c20 6265 2060 606c 656e 2864 6976  ill be ``len(div
+0001c090: 6973 696f 6e73 2920 2d20 3160 602e 0a20  isions) - 1``.. 
+0001c0a0: 2020 2020 2020 2064 6976 6973 696f 6e73         divisions
+0001c0b0: 3a20 6c69 7374 2c20 6f70 7469 6f6e 616c  : list, optional
+0001c0c0: 0a20 2020 2020 2020 2020 2020 2054 6865  .            The
+0001c0d0: 2022 6469 7669 6469 6e67 206c 696e 6573   "dividing lines
+0001c0e0: 2220 7573 6564 2074 6f20 7370 6c69 7420  " used to split 
+0001c0f0: 7468 6520 6e65 7720 696e 6465 7820 696e  the new index in
+0001c100: 746f 2070 6172 7469 7469 6f6e 732e 0a20  to partitions.. 
+0001c110: 2020 2020 2020 2020 2020 2046 6f72 2060             For `
+0001c120: 6064 6976 6973 696f 6e73 3d5b 302c 2031  `divisions=[0, 1
+0001c130: 302c 2035 302c 2031 3030 5d60 602c 2074  0, 50, 100]``, t
+0001c140: 6865 7265 2077 6f75 6c64 2062 6520 7468  here would be th
+0001c150: 7265 6520 6f75 7470 7574 2070 6172 7469  ree output parti
+0001c160: 7469 6f6e 732c 0a20 2020 2020 2020 2020  tions,.         
+0001c170: 2020 2077 6865 7265 2074 6865 206e 6577     where the new
+0001c180: 2069 6e64 6578 2063 6f6e 7461 696e 6564   index contained
+0001c190: 205b 302c 2031 3029 2c20 5b31 302c 2035   [0, 10), [10, 5
+0001c1a0: 3029 2c20 616e 6420 5b35 302c 2031 3030  0), and [50, 100
+0001c1b0: 292c 2072 6573 7065 6374 6976 656c 792e  ), respectively.
+0001c1c0: 0a20 2020 2020 2020 2020 2020 2053 6565  .            See
+0001c1d0: 2068 7474 7073 3a2f 2f64 6f63 732e 6461   https://docs.da
+0001c1e0: 736b 2e6f 7267 2f65 6e2f 6c61 7465 7374  sk.org/en/latest
+0001c1f0: 2f64 6174 6166 7261 6d65 2d64 6573 6967  /dataframe-desig
+0001c200: 6e2e 6874 6d6c 2370 6172 7469 7469 6f6e  n.html#partition
+0001c210: 732e 0a20 2020 2020 2020 2020 2020 2049  s..            I
+0001c220: 6620 6e6f 7420 6769 7665 6e20 2864 6566  f not given (def
+0001c230: 6175 6c74 292c 2067 6f6f 6420 6469 7669  ault), good divi
+0001c240: 7369 6f6e 7320 6172 6520 6361 6c63 756c  sions are calcul
+0001c250: 6174 6564 2062 7920 696d 6d65 6469 6174  ated by immediat
+0001c260: 656c 7920 636f 6d70 7574 696e 670a 2020  ely computing.  
+0001c270: 2020 2020 2020 2020 2020 7468 6520 6461            the da
+0001c280: 7461 2061 6e64 206c 6f6f 6b69 6e67 2061  ta and looking a
+0001c290: 7420 7468 6520 6469 7374 7269 6275 7469  t the distributi
+0001c2a0: 6f6e 206f 6620 6974 7320 7661 6c75 6573  on of its values
+0001c2b0: 2e20 466f 7220 6c61 7267 6520 6461 7461  . For large data
+0001c2c0: 7365 7473 2c0a 2020 2020 2020 2020 2020  sets,.          
+0001c2d0: 2020 7468 6973 2063 616e 2062 6520 6578    this can be ex
+0001c2e0: 7065 6e73 6976 652e 0a20 2020 2020 2020  pensive..       
+0001c2f0: 2020 2020 204e 6f74 6520 7468 6174 2069       Note that i
+0001c300: 6620 6060 736f 7274 6564 3d54 7275 6560  f ``sorted=True`
+0001c310: 602c 2073 7065 6369 6669 6564 2064 6976  `, specified div
+0001c320: 6973 696f 6e73 2061 7265 2061 7373 756d  isions are assum
+0001c330: 6564 2074 6f20 6d61 7463 680a 2020 2020  ed to match.    
+0001c340: 2020 2020 2020 2020 7468 6520 6578 6973          the exis
+0001c350: 7469 6e67 2070 6172 7469 7469 6f6e 7320  ting partitions 
+0001c360: 696e 2074 6865 2064 6174 613b 2069 6620  in the data; if 
+0001c370: 7468 6973 2069 7320 756e 7472 7565 2079  this is untrue y
+0001c380: 6f75 2073 686f 756c 640a 2020 2020 2020  ou should.      
+0001c390: 2020 2020 2020 6c65 6176 6520 6469 7669        leave divi
+0001c3a0: 7369 6f6e 7320 656d 7074 7920 616e 6420  sions empty and 
+0001c3b0: 6361 6c6c 2060 6072 6570 6172 7469 7469  call ``repartiti
+0001c3c0: 6f6e 6060 2061 6674 6572 2060 6073 6574  on`` after ``set
+0001c3d0: 5f69 6e64 6578 6060 2e0a 2020 2020 2020  _index``..      
+0001c3e0: 2020 696e 706c 6163 653a 2062 6f6f 6c2c    inplace: bool,
+0001c3f0: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
+0001c400: 2020 2020 2020 4d6f 6469 6679 696e 6720        Modifying 
+0001c410: 7468 6520 4461 7461 4672 616d 6520 696e  the DataFrame in
+0001c420: 2070 6c61 6365 2069 7320 6e6f 7420 7375   place is not su
+0001c430: 7070 6f72 7465 6420 6279 2044 6173 6b2e  pported by Dask.
+0001c440: 0a20 2020 2020 2020 2020 2020 2044 6566  .            Def
+0001c450: 6175 6c74 7320 746f 2046 616c 7365 2e0a  aults to False..
+0001c460: 2020 2020 2020 2020 736f 7274 3a20 626f          sort: bo
+0001c470: 6f6c 2c20 6f70 7469 6f6e 616c 0a20 2020  ol, optional.   
+0001c480: 2020 2020 2020 2020 2049 6620 6060 5472           If ``Tr
+0001c490: 7565 6060 2c20 736f 7274 2074 6865 2044  ue``, sort the D
+0001c4a0: 6174 6146 7261 6d65 2062 7920 7468 6520  ataFrame by the 
+0001c4b0: 6e65 7720 696e 6465 782e 204f 7468 6572  new index. Other
+0001c4c0: 7769 7365 0a20 2020 2020 2020 2020 2020  wise.           
+0001c4d0: 2073 6574 2074 6865 2069 6e64 6578 206f   set the index o
+0001c4e0: 6e20 7468 6520 696e 6469 7669 6475 616c  n the individual
+0001c4f0: 2065 7869 7374 696e 6720 7061 7274 6974   existing partit
+0001c500: 696f 6e73 2e0a 2020 2020 2020 2020 2020  ions..          
+0001c510: 2020 4465 6661 756c 7473 2074 6f20 6060    Defaults to ``
+0001c520: 5472 7565 6060 2e0a 2020 2020 2020 2020  True``..        
+0001c530: 7368 7566 666c 655f 6d65 7468 6f64 3a20  shuffle_method: 
+0001c540: 7b27 6469 736b 272c 2027 7461 736b 7327  {'disk', 'tasks'
+0001c550: 2c20 2770 3270 277d 2c20 6f70 7469 6f6e  , 'p2p'}, option
+0001c560: 616c 0a20 2020 2020 2020 2020 2020 2045  al.            E
+0001c570: 6974 6865 7220 6060 2764 6973 6b27 6060  ither ``'disk'``
+0001c580: 2066 6f72 2073 696e 676c 652d 6e6f 6465   for single-node
+0001c590: 206f 7065 7261 7469 6f6e 206f 7220 6060   operation or ``
+0001c5a0: 2774 6173 6b73 2760 6020 616e 640a 2020  'tasks'`` and.  
+0001c5b0: 2020 2020 2020 2020 2020 6060 2770 3270            ``'p2p
+0001c5c0: 2760 6020 666f 7220 6469 7374 7269 6275  '`` for distribu
+0001c5d0: 7465 6420 6f70 6572 6174 696f 6e2e 2020  ted operation.  
+0001c5e0: 5769 6c6c 2062 6520 696e 6665 7272 6564  Will be inferred
+0001c5f0: 2062 7920 796f 7572 0a20 2020 2020 2020   by your.       
+0001c600: 2020 2020 2063 7572 7265 6e74 2073 6368       current sch
+0001c610: 6564 756c 6572 2e0a 2020 2020 2020 2020  eduler..        
+0001c620: 636f 6d70 7574 653a 2062 6f6f 6c2c 2064  compute: bool, d
+0001c630: 6566 6175 6c74 2046 616c 7365 0a20 2020  efault False.   
+0001c640: 2020 2020 2020 2020 2057 6865 7468 6572           Whether
+0001c650: 206f 7220 6e6f 7420 746f 2074 7269 6767   or not to trigg
+0001c660: 6572 2061 6e20 696d 6d65 6469 6174 6520  er an immediate 
+0001c670: 636f 6d70 7574 6174 696f 6e2e 2044 6566  computation. Def
+0001c680: 6175 6c74 7320 746f 2046 616c 7365 2e0a  aults to False..
+0001c690: 2020 2020 2020 2020 2020 2020 4e6f 7465              Note
+0001c6a0: 2c20 7468 6174 2065 7665 6e20 6966 2079  , that even if y
+0001c6b0: 6f75 2073 6574 2060 6063 6f6d 7075 7465  ou set ``compute
+0001c6c0: 3d46 616c 7365 6060 2c20 616e 2069 6d6d  =False``, an imm
+0001c6d0: 6564 6961 7465 2063 6f6d 7075 7461 7469  ediate computati
+0001c6e0: 6f6e 0a20 2020 2020 2020 2020 2020 2077  on.            w
+0001c6f0: 696c 6c20 7374 696c 6c20 6265 2074 7269  ill still be tri
+0001c700: 6767 6572 6564 2069 6620 6060 6469 7669  ggered if ``divi
+0001c710: 7369 6f6e 7360 6020 6973 2060 604e 6f6e  sions`` is ``Non
+0001c720: 6560 602e 0a20 2020 2020 2020 2070 6172  e``..        par
+0001c730: 7469 7469 6f6e 5f73 697a 653a 2069 6e74  tition_size: int
+0001c740: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+0001c750: 2020 2020 2020 2044 6573 6972 6564 2073         Desired s
+0001c760: 697a 6520 6f66 2065 6163 6820 7061 7274  ize of each part
+0001c770: 6974 696f 6e73 2069 6e20 6279 7465 732e  itions in bytes.
+0001c780: 0a20 2020 2020 2020 2020 2020 204f 6e6c  .            Onl
+0001c790: 7920 7573 6564 2077 6865 6e20 6060 6e70  y used when ``np
+0001c7a0: 6172 7469 7469 6f6e 733d 2761 7574 6f27  artitions='auto'
+0001c7b0: 6060 0a0a 2020 2020 2020 2020 4578 616d  ``..        Exam
+0001c7c0: 706c 6573 0a20 2020 2020 2020 202d 2d2d  ples.        ---
+0001c7d0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3e3e  -----.        >>
+0001c7e0: 3e20 696d 706f 7274 2064 6173 6b0a 2020  > import dask.  
+0001c7f0: 2020 2020 2020 3e3e 3e20 6464 6620 3d20        >>> ddf = 
+0001c800: 6461 736b 2e64 6174 6173 6574 732e 7469  dask.datasets.ti
+0001c810: 6d65 7365 7269 6573 2873 7461 7274 3d22  meseries(start="
+0001c820: 3230 3231 2d30 312d 3031 222c 2065 6e64  2021-01-01", end
+0001c830: 3d22 3230 3231 2d30 312d 3037 222c 2066  ="2021-01-07", f
+0001c840: 7265 713d 2231 6822 292e 7265 7365 745f  req="1h").reset_
+0001c850: 696e 6465 7828 290a 2020 2020 2020 2020  index().        
+0001c860: 3e3e 3e20 6464 6632 203d 2064 6466 2e73  >>> ddf2 = ddf.s
+0001c870: 6574 5f69 6e64 6578 2822 7822 290a 2020  et_index("x").  
+0001c880: 2020 2020 2020 3e3e 3e20 6464 6632 203d        >>> ddf2 =
+0001c890: 2064 6466 2e73 6574 5f69 6e64 6578 2864   ddf.set_index(d
+0001c8a0: 6466 2e78 290a 2020 2020 2020 2020 3e3e  df.x).        >>
+0001c8b0: 3e20 6464 6632 203d 2064 6466 2e73 6574  > ddf2 = ddf.set
+0001c8c0: 5f69 6e64 6578 2864 6466 2e74 696d 6573  _index(ddf.times
+0001c8d0: 7461 6d70 2c20 736f 7274 6564 3d54 7275  tamp, sorted=Tru
+0001c8e0: 6529 0a0a 2020 2020 2020 2020 4120 636f  e)..        A co
+0001c8f0: 6d6d 6f6e 2063 6173 6520 6973 2077 6865  mmon case is whe
+0001c900: 6e20 7765 2068 6176 6520 6120 6461 7465  n we have a date
+0001c910: 7469 6d65 2063 6f6c 756d 6e20 7468 6174  time column that
+0001c920: 2077 6520 6b6e 6f77 2074 6f20 6265 0a20   we know to be. 
+0001c930: 2020 2020 2020 2073 6f72 7465 6420 616e         sorted an
+0001c940: 6420 6973 2063 6c65 616e 6c79 2064 6976  d is cleanly div
+0001c950: 6964 6564 2062 7920 6461 792e 2020 5765  ided by day.  We
+0001c960: 2063 616e 2073 6574 2074 6869 7320 696e   can set this in
+0001c970: 6465 7820 666f 7220 6672 6565 0a20 2020  dex for free.   
+0001c980: 2020 2020 2062 7920 7370 6563 6966 7969       by specifyi
+0001c990: 6e67 2062 6f74 6820 7468 6174 2074 6865  ng both that the
+0001c9a0: 2063 6f6c 756d 6e20 6973 2070 7265 2d73   column is pre-s
+0001c9b0: 6f72 7465 6420 616e 6420 7468 6520 7061  orted and the pa
+0001c9c0: 7274 6963 756c 6172 0a20 2020 2020 2020  rticular.       
+0001c9d0: 2064 6976 6973 696f 6e73 2061 6c6f 6e67   divisions along
+0001c9e0: 2077 6869 6368 2069 7320 6973 2073 6570   which is is sep
+0001c9f0: 6172 6174 6564 0a0a 2020 2020 2020 2020  arated..        
+0001ca00: 3e3e 3e20 696d 706f 7274 2070 616e 6461  >>> import panda
+0001ca10: 7320 6173 2070 640a 2020 2020 2020 2020  s as pd.        
+0001ca20: 3e3e 3e20 6469 7669 7369 6f6e 7320 3d20  >>> divisions = 
+0001ca30: 7064 2e64 6174 655f 7261 6e67 6528 7374  pd.date_range(st
+0001ca40: 6172 743d 2232 3032 312d 3031 2d30 3122  art="2021-01-01"
+0001ca50: 2c20 656e 643d 2232 3032 312d 3031 2d30  , end="2021-01-0
+0001ca60: 3722 2c20 6672 6571 3d27 3144 2729 0a20  7", freq='1D'). 
+0001ca70: 2020 2020 2020 203e 3e3e 2064 6976 6973         >>> divis
+0001ca80: 696f 6e73 0a20 2020 2020 2020 2044 6174  ions.        Dat
+0001ca90: 6574 696d 6549 6e64 6578 285b 2732 3032  etimeIndex(['202
+0001caa0: 312d 3031 2d30 3127 2c20 2732 3032 312d  1-01-01', '2021-
+0001cab0: 3031 2d30 3227 2c20 2732 3032 312d 3031  01-02', '2021-01
+0001cac0: 2d30 3327 2c20 2732 3032 312d 3031 2d30  -03', '2021-01-0
+0001cad0: 3427 2c0a 2020 2020 2020 2020 2020 2020  4',.            
+0001cae0: 2020 2020 2020 2020 2020 2027 3230 3231             '2021
+0001caf0: 2d30 312d 3035 272c 2027 3230 3231 2d30  -01-05', '2021-0
+0001cb00: 312d 3036 272c 2027 3230 3231 2d30 312d  1-06', '2021-01-
+0001cb10: 3037 275d 2c0a 2020 2020 2020 2020 2020  07'],.          
+0001cb20: 2020 2020 2020 2020 2020 2020 6474 7970              dtyp
+0001cb30: 653d 2764 6174 6574 696d 6536 345b 6e73  e='datetime64[ns
+0001cb40: 5d27 2c20 6672 6571 3d27 4427 290a 0a20  ]', freq='D').. 
+0001cb50: 2020 2020 2020 204e 6f74 6520 7468 6174         Note that
+0001cb60: 2060 606c 656e 2864 6976 6973 6f6e 7329   ``len(divisons)
+0001cb70: 6060 2069 7320 6571 7561 6c20 746f 2060  `` is equal to `
+0001cb80: 606e 7061 7274 6974 696f 6e73 202b 2031  `npartitions + 1
+0001cb90: 6060 2e20 5468 6973 2069 7320 6265 6361  ``. This is beca
+0001cba0: 7573 6520 6060 6469 7669 7369 6f6e 7360  use ``divisions`
+0001cbb0: 600a 2020 2020 2020 2020 7265 7072 6573  `.        repres
+0001cbc0: 656e 7473 2074 6865 2075 7070 6572 2061  ents the upper a
+0001cbd0: 6e64 206c 6f77 6572 2062 6f75 6e64 7320  nd lower bounds 
+0001cbe0: 6f66 2065 6163 6820 7061 7274 6974 696f  of each partitio
+0001cbf0: 6e2e 2054 6865 2066 6972 7374 2069 7465  n. The first ite
+0001cc00: 6d20 6973 2074 6865 0a20 2020 2020 2020  m is the.       
+0001cc10: 206c 6f77 6572 2062 6f75 6e64 206f 6620   lower bound of 
+0001cc20: 7468 6520 6669 7273 7420 7061 7274 6974  the first partit
+0001cc30: 696f 6e2c 2074 6865 2073 6563 6f6e 6420  ion, the second 
+0001cc40: 6974 656d 2069 7320 7468 6520 6c6f 7765  item is the lowe
+0001cc50: 7220 626f 756e 6420 6f66 2074 6865 0a20  r bound of the. 
+0001cc60: 2020 2020 2020 2073 6563 6f6e 6420 7061         second pa
+0001cc70: 7274 6974 696f 6e20 616e 6420 7468 6520  rtition and the 
+0001cc80: 7570 7065 7220 626f 756e 6420 6f66 2074  upper bound of t
+0001cc90: 6865 2066 6972 7374 2070 6172 7469 7469  he first partiti
+0001cca0: 6f6e 2c20 616e 6420 736f 206f 6e2e 0a20  on, and so on.. 
+0001ccb0: 2020 2020 2020 2054 6865 2073 6563 6f6e         The secon
+0001ccc0: 642d 746f 2d6c 6173 7420 6974 656d 2069  d-to-last item i
+0001ccd0: 7320 7468 6520 6c6f 7765 7220 626f 756e  s the lower boun
+0001cce0: 6420 6f66 2074 6865 206c 6173 7420 7061  d of the last pa
+0001ccf0: 7274 6974 696f 6e2c 2061 6e64 2074 6865  rtition, and the
+0001cd00: 206c 6173 740a 2020 2020 2020 2020 2865   last.        (e
+0001cd10: 7874 7261 2920 6974 656d 2069 7320 7468  xtra) item is th
+0001cd20: 6520 7570 7065 7220 626f 756e 6420 6f66  e upper bound of
+0001cd30: 2074 6865 206c 6173 7420 7061 7274 6974   the last partit
+0001cd40: 696f 6e2e 0a0a 2020 2020 2020 2020 3e3e  ion...        >>
+0001cd50: 3e20 6464 6632 203d 2064 6466 2e73 6574  > ddf2 = ddf.set
+0001cd60: 5f69 6e64 6578 2822 7469 6d65 7374 616d  _index("timestam
+0001cd70: 7022 2c20 736f 7274 6564 3d54 7275 652c  p", sorted=True,
+0001cd80: 2064 6976 6973 696f 6e73 3d64 6976 6973   divisions=divis
+0001cd90: 696f 6e73 2e74 6f6c 6973 7428 2929 0a0a  ions.tolist())..
+0001cda0: 2020 2020 2020 2020 4966 2079 6f75 276c          If you'l
+0001cdb0: 6c20 6265 2072 756e 6e69 6e67 2060 7365  l be running `se
+0001cdc0: 745f 696e 6465 7860 206f 6e20 7468 6520  t_index` on the 
+0001cdd0: 7361 6d65 2028 6f72 2073 696d 696c 6172  same (or similar
+0001cde0: 2920 6461 7461 7365 7473 2072 6570 6561  ) datasets repea
+0001cdf0: 7465 646c 792c 0a20 2020 2020 2020 2079  tedly,.        y
+0001ce00: 6f75 2063 6f75 6c64 2073 6176 6520 7469  ou could save ti
+0001ce10: 6d65 2062 7920 6c65 7474 696e 6720 4461  me by letting Da
+0001ce20: 736b 2063 616c 6375 6c61 7465 2067 6f6f  sk calculate goo
+0001ce30: 6420 6469 7669 7369 6f6e 7320 6f6e 6365  d divisions once
+0001ce40: 2c20 7468 656e 2063 6f70 792d 7061 7374  , then copy-past
+0001ce50: 696e 670a 2020 2020 2020 2020 7468 656d  ing.        them
+0001ce60: 2074 6f20 7265 7573 652e 2054 6869 7320   to reuse. This 
+0001ce70: 6973 2065 7370 6563 6961 6c6c 7920 6865  is especially he
+0001ce80: 6c70 6675 6c20 7275 6e6e 696e 6720 696e  lpful running in
+0001ce90: 2061 204a 7570 7974 6572 206e 6f74 6562   a Jupyter noteb
+0001cea0: 6f6f 6b3a 0a0a 2020 2020 2020 2020 3e3e  ook:..        >>
+0001ceb0: 3e20 6464 6632 203d 2064 6466 2e73 6574  > ddf2 = ddf.set
+0001cec0: 5f69 6e64 6578 2822 6e61 6d65 2229 2020  _index("name")  
+0001ced0: 2320 736c 6f77 2c20 6361 6c63 756c 6174  # slow, calculat
+0001cee0: 6573 2064 6174 6120 6469 7374 7269 6275  es data distribu
+0001cef0: 7469 6f6e 0a20 2020 2020 2020 203e 3e3e  tion.        >>>
+0001cf00: 2064 6466 322e 6469 7669 7369 6f6e 7320   ddf2.divisions 
+0001cf10: 2023 2064 6f63 7465 7374 3a20 2b53 4b49   # doctest: +SKI
+0001cf20: 500a 2020 2020 2020 2020 5b22 416c 6963  P.        ["Alic
+0001cf30: 6522 2c20 224c 6175 7261 222c 2022 5572  e", "Laura", "Ur
+0001cf40: 7375 6c61 222c 2022 5a65 6c64 6122 5d0a  sula", "Zelda"].
+0001cf50: 2020 2020 2020 2020 3e3e 3e20 2320 5e20          >>> # ^ 
+0001cf60: 4e6f 7720 636f 7079 2d70 6173 7465 2074  Now copy-paste t
+0001cf70: 6869 7320 616e 6420 6564 6974 2074 6865  his and edit the
+0001cf80: 206c 696e 6520 6162 6f76 6520 746f 3a0a   line above to:.
+0001cf90: 2020 2020 2020 2020 3e3e 3e20 2320 6464          >>> # dd
+0001cfa0: 6632 203d 2064 6466 2e73 6574 5f69 6e64  f2 = ddf.set_ind
+0001cfb0: 6578 2822 6e61 6d65 222c 2064 6976 6973  ex("name", divis
+0001cfc0: 696f 6e73 3d5b 2241 6c69 6365 222c 2022  ions=["Alice", "
+0001cfd0: 4c61 7572 6122 2c20 2255 7273 756c 6122  Laura", "Ursula"
+0001cfe0: 2c20 225a 656c 6461 225d 290a 2020 2020  , "Zelda"]).    
+0001cff0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0001d000: 6966 2069 7369 6e73 7461 6e63 6528 6f74  if isinstance(ot
+0001d010: 6865 722c 206c 6973 7429 2061 6e64 206c  her, list) and l
+0001d020: 656e 286f 7468 6572 2920 3d3d 2031 3a0a  en(other) == 1:.
+0001d030: 2020 2020 2020 2020 2020 2020 6f74 6865              othe
+0001d040: 7220 3d20 6f74 6865 725b 305d 0a20 2020  r = other[0].   
+0001d050: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+0001d060: 6365 286f 7468 6572 2c20 6c69 7374 293a  ce(other, list):
+0001d070: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0001d080: 616e 7928 5b69 7369 6e73 7461 6e63 6528  any([isinstance(
+0001d090: 632c 2046 7261 6d65 4261 7365 2920 666f  c, FrameBase) fo
+0001d0a0: 7220 6320 696e 206f 7468 6572 5d29 3a0a  r c in other]):.
+0001d0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d0c0: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
+0001d0d0: 224c 6973 745b 4672 616d 6542 6173 655d  "List[FrameBase]
+0001d0e0: 206e 6f74 2073 7570 706f 7274 6564 2062   not supported b
+0001d0f0: 7920 7365 745f 696e 6465 7822 290a 2020  y set_index").  
+0001d100: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+0001d110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d120: 7261 6973 6520 4e6f 7449 6d70 6c65 6d65  raise NotImpleme
+0001d130: 6e74 6564 4572 726f 7228 0a20 2020 2020  ntedError(.     
+0001d140: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0001d150: 4461 736b 2064 6174 6166 7261 6d65 2064  Dask dataframe d
+0001d160: 6f65 7320 6e6f 7420 7965 7420 7375 7070  oes not yet supp
+0001d170: 6f72 7420 6d75 6c74 692d 696e 6465 7865  ort multi-indexe
+0001d180: 732e 5c6e 220a 2020 2020 2020 2020 2020  s.\n".          
+0001d190: 2020 2020 2020 2020 2020 6622 596f 7520            f"You 
+0001d1a0: 7472 6965 6420 746f 2069 6e64 6578 2077  tried to index w
+0001d1b0: 6974 6820 7468 6973 2069 6e64 6578 3a20  ith this index: 
+0001d1c0: 7b6f 7468 6572 7d5c 6e22 0a20 2020 2020  {other}\n".     
+0001d1d0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0001d1e0: 496e 6465 7865 7320 6d75 7374 2062 6520  Indexes must be 
+0001d1f0: 7369 6e67 6c65 2063 6f6c 756d 6e73 206f  single columns o
+0001d200: 6e6c 792e 220a 2020 2020 2020 2020 2020  nly.".          
+0001d210: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0001d220: 6966 2069 7369 6e73 7461 6e63 6528 6f74  if isinstance(ot
+0001d230: 6865 722c 2044 6174 6146 7261 6d65 293a  her, DataFrame):
+0001d240: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+0001d250: 7365 204e 6f74 496d 706c 656d 656e 7465  se NotImplemente
+0001d260: 6445 7272 6f72 280a 2020 2020 2020 2020  dError(.        
+0001d270: 2020 2020 2020 2020 2244 6173 6b20 6461          "Dask da
+0001d280: 7461 6672 616d 6520 646f 6573 206e 6f74  taframe does not
+0001d290: 2079 6574 2073 7570 706f 7274 206d 756c   yet support mul
+0001d2a0: 7469 2d69 6e64 6578 6573 2e5c 6e22 0a20  ti-indexes.\n". 
+0001d2b0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0001d2c0: 2259 6f75 2074 7269 6564 2074 6f20 696e  "You tried to in
+0001d2d0: 6465 7820 7769 7468 2061 2066 7261 6d65  dex with a frame
+0001d2e0: 2077 6974 6820 7468 6573 6520 636f 6c75   with these colu
+0001d2f0: 6d6e 733a 207b 6c69 7374 286f 7468 6572  mns: {list(other
+0001d300: 2e63 6f6c 756d 6e73 297d 5c6e 220a 2020  .columns)}\n".  
+0001d310: 2020 2020 2020 2020 2020 2020 2020 2249                "I
+0001d320: 6e64 6578 6573 206d 7573 7420 6265 2073  ndexes must be s
+0001d330: 696e 676c 6520 636f 6c75 6d6e 7320 6f6e  ingle columns on
+0001d340: 6c79 2e22 0a20 2020 2020 2020 2020 2020  ly.".           
+0001d350: 2029 0a20 2020 2020 2020 2069 6620 6973   ).        if is
+0001d360: 696e 7374 616e 6365 286f 7468 6572 2c20  instance(other, 
+0001d370: 5365 7269 6573 293a 0a20 2020 2020 2020  Series):.       
+0001d380: 2020 2020 2069 6620 6f74 6865 722e 5f6e       if other._n
+0001d390: 616d 6520 3d3d 2073 656c 662e 696e 6465  ame == self.inde
+0001d3a0: 782e 5f6e 616d 653a 0a20 2020 2020 2020  x._name:.       
+0001d3b0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0001d3c0: 7365 6c66 0a20 2020 2020 2020 2065 6c69  self.        eli
+0001d3d0: 6620 6f74 6865 7220 3d3d 2073 656c 662e  f other == self.
+0001d3e0: 696e 6465 782e 6e61 6d65 3a0a 2020 2020  index.name:.    
+0001d3f0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0001d400: 656c 660a 0a20 2020 2020 2020 2069 6620  elf..        if 
+0001d410: 6469 7669 7369 6f6e 7320 6973 206e 6f74  divisions is not
+0001d420: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+0001d430: 2020 2063 6865 636b 5f64 6976 6973 696f     check_divisio
+0001d440: 6e73 2864 6976 6973 696f 6e73 290a 0a20  ns(divisions).. 
+0001d450: 2020 2020 2020 2069 6620 2873 6f72 7465         if (sorte
+0001d460: 6420 6f72 206e 6f74 2073 6f72 7429 2061  d or not sort) a
+0001d470: 6e64 206e 7061 7274 6974 696f 6e73 2069  nd npartitions i
+0001d480: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
+0001d490: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+0001d4a0: 6c75 6545 7272 6f72 280a 2020 2020 2020  lueError(.      
+0001d4b0: 2020 2020 2020 2020 2020 2253 7065 6369            "Speci
+0001d4c0: 6679 696e 6720 6e70 6172 7469 7469 6f6e  fying npartition
+0001d4d0: 7320 7769 7468 2073 6f72 743d 4661 6c73  s with sort=Fals
+0001d4e0: 6520 6f72 2073 6f72 7465 643d 5472 7565  e or sorted=True
+0001d4f0: 2069 7320 6e6f 7420 220a 2020 2020 2020   is not ".      
+0001d500: 2020 2020 2020 2020 2020 2273 7570 706f            "suppo
+0001d510: 7274 6564 2e20 4361 6c6c 2060 7265 7061  rted. Call `repa
+0001d520: 7274 6974 696f 6e60 2061 6674 6572 7761  rtition` afterwa
+0001d530: 7264 732e 220a 2020 2020 2020 2020 2020  rds.".          
+0001d540: 2020 290a 0a20 2020 2020 2020 2069 6620    )..        if 
+0001d550: 736f 7274 6564 3a0a 2020 2020 2020 2020  sorted:.        
+0001d560: 2020 2020 6966 2064 6976 6973 696f 6e73      if divisions
+0001d570: 2069 7320 6e6f 7420 4e6f 6e65 2061 6e64   is not None and
+0001d580: 206c 656e 2864 6976 6973 696f 6e73 2920   len(divisions) 
+0001d590: 2d20 3120 213d 2073 656c 662e 6e70 6172  - 1 != self.npar
+0001d5a0: 7469 7469 6f6e 733a 0a20 2020 2020 2020  titions:.       
+0001d5b0: 2020 2020 2020 2020 206d 7367 203d 2028           msg = (
+0001d5c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001d5d0: 2020 2020 2022 5768 656e 2064 6f69 6e67       "When doing
+0001d5e0: 2060 6466 2e73 6574 5f69 6e64 6578 2863   `df.set_index(c
+0001d5f0: 6f6c 2c20 736f 7274 6564 3d54 7275 652c  ol, sorted=True,
+0001d600: 2064 6976 6973 696f 6e73 3d2e 2e2e 2960   divisions=...)`
+0001d610: 2c20 220a 2020 2020 2020 2020 2020 2020  , ".            
+0001d620: 2020 2020 2020 2020 2264 6976 6973 696f          "divisio
+0001d630: 6e73 2069 6e64 6963 6174 6573 206b 6e6f  ns indicates kno
+0001d640: 776e 2073 706c 6974 7320 696e 2074 6865  wn splits in the
+0001d650: 2069 6e64 6578 2063 6f6c 756d 6e2e 2049   index column. I
+0001d660: 6e20 7468 6973 2022 0a20 2020 2020 2020  n this ".       
+0001d670: 2020 2020 2020 2020 2020 2020 2022 6361               "ca
+0001d680: 7365 2064 6976 6973 696f 6e73 206d 7573  se divisions mus
+0001d690: 7420 6265 2074 6865 2073 616d 6520 6c65  t be the same le
+0001d6a0: 6e67 7468 2061 7320 7468 6520 6578 6973  ngth as the exis
+0001d6b0: 7469 6e67 2022 0a20 2020 2020 2020 2020  ting ".         
+0001d6c0: 2020 2020 2020 2020 2020 2022 6469 7669             "divi
+0001d6d0: 7369 6f6e 7320 696e 2060 6466 605c 6e5c  sions in `df`\n\
+0001d6e0: 6e22 0a20 2020 2020 2020 2020 2020 2020  n".             
+0001d6f0: 2020 2020 2020 2022 4966 2074 6865 2069         "If the i
+0001d700: 6e74 656e 7420 6973 2074 6f20 7265 7061  ntent is to repa
+0001d710: 7274 6974 696f 6e20 696e 746f 206e 6577  rtition into new
+0001d720: 2064 6976 6973 696f 6e73 2061 6674 6572   divisions after
+0001d730: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
+0001d740: 2020 2020 2020 2022 7365 7474 696e 6720         "setting 
+0001d750: 7468 6520 696e 6465 782c 2079 6f75 2070  the index, you p
+0001d760: 726f 6261 626c 7920 7761 6e74 3a5c 6e5c  robably want:\n\
+0001d770: 6e22 0a20 2020 2020 2020 2020 2020 2020  n".             
+0001d780: 2020 2020 2020 2022 6064 662e 7365 745f         "`df.set_
+0001d790: 696e 6465 7828 636f 6c2c 2073 6f72 7465  index(col, sorte
+0001d7a0: 643d 5472 7565 292e 7265 7061 7274 6974  d=True).repartit
+0001d7b0: 696f 6e28 6469 7669 7369 6f6e 733d 6469  ion(divisions=di
+0001d7c0: 7669 7369 6f6e 7329 6022 0a20 2020 2020  visions)`".     
+0001d7d0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0001d7e0: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+0001d7f0: 7365 2056 616c 7565 4572 726f 7228 6d73  se ValueError(ms
+0001d800: 6729 0a20 2020 2020 2020 2020 2020 2072  g).            r
+0001d810: 6573 756c 7420 3d20 6e65 775f 636f 6c6c  esult = new_coll
+0001d820: 6563 7469 6f6e 280a 2020 2020 2020 2020  ection(.        
+0001d830: 2020 2020 2020 2020 5365 7449 6e64 6578          SetIndex
+0001d840: 426c 6f63 6b77 6973 6528 0a20 2020 2020  Blockwise(.     
+0001d850: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0001d860: 656c 662c 206f 7468 6572 2c20 6472 6f70  elf, other, drop
+0001d870: 2c20 6e65 775f 6469 7669 7369 6f6e 733d  , new_divisions=
+0001d880: 6469 7669 7369 6f6e 732c 2061 7070 656e  divisions, appen
+0001d890: 643d 6170 7065 6e64 0a20 2020 2020 2020  d=append.       
+0001d8a0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0001d8b0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0001d8c0: 2020 2020 2072 6574 7572 6e20 7265 7375       return resu
+0001d8d0: 6c74 2e63 6f6d 7075 7465 5f63 7572 7265  lt.compute_curre
+0001d8e0: 6e74 5f64 6976 6973 696f 6e73 2873 6574  nt_divisions(set
+0001d8f0: 5f64 6976 6973 696f 6e73 3d54 7275 6529  _divisions=True)
+0001d900: 0a20 2020 2020 2020 2065 6c69 6620 6e6f  .        elif no
+0001d910: 7420 736f 7274 3a0a 2020 2020 2020 2020  t sort:.        
+0001d920: 2020 2020 7265 7475 726e 206e 6577 5f63      return new_c
+0001d930: 6f6c 6c65 6374 696f 6e28 0a20 2020 2020  ollection(.     
+0001d940: 2020 2020 2020 2020 2020 2053 6574 496e             SetIn
+0001d950: 6465 7842 6c6f 636b 7769 7365 2873 656c  dexBlockwise(sel
+0001d960: 662c 206f 7468 6572 2c20 6472 6f70 2c20  f, other, drop, 
+0001d970: 4e6f 6e65 2c20 6170 7065 6e64 3d61 7070  None, append=app
+0001d980: 656e 6429 0a20 2020 2020 2020 2020 2020  end).           
+0001d990: 2029 0a0a 2020 2020 2020 2020 7265 7475   )..        retu
+0001d9a0: 726e 206e 6577 5f63 6f6c 6c65 6374 696f  rn new_collectio
+0001d9b0: 6e28 0a20 2020 2020 2020 2020 2020 2053  n(.            S
+0001d9c0: 6574 496e 6465 7828 0a20 2020 2020 2020  etIndex(.       
+0001d9d0: 2020 2020 2020 2020 2073 656c 662c 0a20           self,. 
+0001d9e0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+0001d9f0: 7468 6572 2c0a 2020 2020 2020 2020 2020  ther,.          
+0001da00: 2020 2020 2020 6472 6f70 2c0a 2020 2020        drop,.    
+0001da10: 2020 2020 2020 2020 2020 2020 7573 6572              user
+0001da20: 5f64 6976 6973 696f 6e73 3d64 6976 6973  _divisions=divis
+0001da30: 696f 6e73 2c0a 2020 2020 2020 2020 2020  ions,.          
+0001da40: 2020 2020 2020 6e70 6172 7469 7469 6f6e        npartition
+0001da50: 733d 6e70 6172 7469 7469 6f6e 732c 0a20  s=npartitions,. 
+0001da60: 2020 2020 2020 2020 2020 2020 2020 2075                 u
+0001da70: 7073 616d 706c 653d 7570 7361 6d70 6c65  psample=upsample
+0001da80: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001da90: 2020 7061 7274 6974 696f 6e5f 7369 7a65    partition_size
+0001daa0: 3d70 6172 7469 7469 6f6e 5f73 697a 652c  =partition_size,
+0001dab0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001dac0: 2073 6875 6666 6c65 5f6d 6574 686f 643d   shuffle_method=
+0001dad0: 6765 745f 7370 6563 6966 6965 645f 7368  get_specified_sh
+0001dae0: 7566 666c 6528 7368 7566 666c 655f 6d65  uffle(shuffle_me
+0001daf0: 7468 6f64 292c 0a20 2020 2020 2020 2020  thod),.         
+0001db00: 2020 2020 2020 2061 7070 656e 643d 6170         append=ap
+0001db10: 7065 6e64 2c0a 2020 2020 2020 2020 2020  pend,.          
+0001db20: 2020 2020 2020 6f70 7469 6f6e 733d 6f70        options=op
+0001db30: 7469 6f6e 732c 0a20 2020 2020 2020 2020  tions,.         
+0001db40: 2020 2029 0a20 2020 2020 2020 2029 0a0a     ).        )..
+0001db50: 2020 2020 6465 6620 736f 7274 5f76 616c      def sort_val
+0001db60: 7565 7328 0a20 2020 2020 2020 2073 656c  ues(.        sel
+0001db70: 662c 0a20 2020 2020 2020 2062 793a 2073  f,.        by: s
+0001db80: 7472 207c 206c 6973 745b 7374 725d 2c0a  tr | list[str],.
+0001db90: 2020 2020 2020 2020 6e70 6172 7469 7469          npartiti
+0001dba0: 6f6e 733a 2069 6e74 207c 204e 6f6e 6520  ons: int | None 
+0001dbb0: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
+0001dbc0: 6173 6365 6e64 696e 673a 2062 6f6f 6c20  ascending: bool 
+0001dbd0: 7c20 6c69 7374 5b62 6f6f 6c5d 203d 2054  | list[bool] = T
+0001dbe0: 7275 652c 0a20 2020 2020 2020 206e 615f  rue,.        na_
+0001dbf0: 706f 7369 7469 6f6e 3a20 4c69 7465 7261  position: Litera
+0001dc00: 6c5b 2266 6972 7374 225d 207c 204c 6974  l["first"] | Lit
+0001dc10: 6572 616c 5b22 6c61 7374 225d 203d 2022  eral["last"] = "
+0001dc20: 6c61 7374 222c 0a20 2020 2020 2020 2070  last",.        p
+0001dc30: 6172 7469 7469 6f6e 5f73 697a 653a 2066  artition_size: f
+0001dc40: 6c6f 6174 203d 2031 3238 6536 2c0a 2020  loat = 128e6,.  
+0001dc50: 2020 2020 2020 736f 7274 5f66 756e 6374        sort_funct
+0001dc60: 696f 6e3a 2043 616c 6c61 626c 655b 5b70  ion: Callable[[p
+0001dc70: 642e 4461 7461 4672 616d 655d 2c20 7064  d.DataFrame], pd
+0001dc80: 2e44 6174 6146 7261 6d65 5d20 7c20 4e6f  .DataFrame] | No
+0001dc90: 6e65 203d 204e 6f6e 652c 0a20 2020 2020  ne = None,.     
+0001dca0: 2020 2073 6f72 745f 6675 6e63 7469 6f6e     sort_function
+0001dcb0: 5f6b 7761 7267 733a 204d 6170 7069 6e67  _kwargs: Mapping
+0001dcc0: 5b73 7472 2c20 416e 795d 207c 204e 6f6e  [str, Any] | Non
+0001dcd0: 6520 3d20 4e6f 6e65 2c0a 2020 2020 2020  e = None,.      
+0001dce0: 2020 7570 7361 6d70 6c65 3a20 666c 6f61    upsample: floa
+0001dcf0: 7420 3d20 312e 302c 0a20 2020 2020 2020  t = 1.0,.       
+0001dd00: 2069 676e 6f72 655f 696e 6465 783a 2062   ignore_index: b
+0001dd10: 6f6f 6c20 7c20 4e6f 6e65 203d 2046 616c  ool | None = Fal
+0001dd20: 7365 2c0a 2020 2020 2020 2020 7368 7566  se,.        shuf
+0001dd30: 666c 655f 6d65 7468 6f64 3a20 7374 7220  fle_method: str 
+0001dd40: 7c20 4e6f 6e65 203d 204e 6f6e 652c 0a20  | None = None,. 
+0001dd50: 2020 2020 2020 202a 2a6f 7074 696f 6e73         **options
+0001dd60: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
+0001dd70: 2022 2222 536f 7274 2074 6865 2064 6174   """Sort the dat
+0001dd80: 6173 6574 2062 7920 6120 7369 6e67 6c65  aset by a single
+0001dd90: 2063 6f6c 756d 6e2e 0a0a 2020 2020 2020   column...      
+0001dda0: 2020 536f 7274 696e 6720 6120 7061 7261    Sorting a para
+0001ddb0: 6c6c 656c 2064 6174 6173 6574 2072 6571  llel dataset req
+0001ddc0: 7569 7265 7320 6578 7065 6e73 6976 6520  uires expensive 
+0001ddd0: 7368 7566 666c 6573 2061 6e64 2069 7320  shuffles and is 
+0001dde0: 6765 6e65 7261 6c6c 790a 2020 2020 2020  generally.      
+0001ddf0: 2020 6e6f 7420 7265 636f 6d6d 656e 6465    not recommende
+0001de00: 642e 2053 6565 2060 6073 6574 5f69 6e64  d. See ``set_ind
+0001de10: 6578 6060 2066 6f72 2069 6d70 6c65 6d65  ex`` for impleme
+0001de20: 6e74 6174 696f 6e20 6465 7461 696c 732e  ntation details.
+0001de30: 0a0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
+0001de40: 7465 7273 0a20 2020 2020 2020 202d 2d2d  ters.        ---
+0001de50: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+0001de60: 6279 3a20 7374 7220 6f72 206c 6973 745b  by: str or list[
+0001de70: 7374 725d 0a20 2020 2020 2020 2020 2020  str].           
+0001de80: 2043 6f6c 756d 6e28 7329 2074 6f20 736f   Column(s) to so
+0001de90: 7274 2062 792e 0a20 2020 2020 2020 206e  rt by..        n
+0001dea0: 7061 7274 6974 696f 6e73 3a20 696e 742c  partitions: int,
+0001deb0: 204e 6f6e 652c 206f 7220 2761 7574 6f27   None, or 'auto'
+0001dec0: 0a20 2020 2020 2020 2020 2020 2054 6865  .            The
+0001ded0: 2069 6465 616c 206e 756d 6265 7220 6f66   ideal number of
+0001dee0: 206f 7574 7075 7420 7061 7274 6974 696f   output partitio
+0001def0: 6e73 2e20 4966 204e 6f6e 652c 2075 7365  ns. If None, use
+0001df00: 2074 6865 2073 616d 6520 6173 0a20 2020   the same as.   
+0001df10: 2020 2020 2020 2020 2074 6865 2069 6e70           the inp
+0001df20: 7574 2e20 4966 2027 6175 746f 2720 7468  ut. If 'auto' th
+0001df30: 656e 2064 6563 6964 6520 6279 206d 656d  en decide by mem
+0001df40: 6f72 7920 7573 652e 0a20 2020 2020 2020  ory use..       
+0001df50: 2061 7363 656e 6469 6e67 3a20 626f 6f6c   ascending: bool
+0001df60: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+0001df70: 2020 2020 2020 2053 6f72 7420 6173 6365         Sort asce
+0001df80: 6e64 696e 6720 7673 2e20 6465 7363 656e  nding vs. descen
+0001df90: 6469 6e67 2e0a 2020 2020 2020 2020 2020  ding..          
+0001dfa0: 2020 4465 6661 756c 7473 2074 6f20 5472    Defaults to Tr
+0001dfb0: 7565 2e0a 2020 2020 2020 2020 6e61 5f70  ue..        na_p
+0001dfc0: 6f73 6974 696f 6e3a 207b 276c 6173 7427  osition: {'last'
+0001dfd0: 2c20 2766 6972 7374 277d 2c20 6f70 7469  , 'first'}, opti
+0001dfe0: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
+0001dff0: 2050 7574 7320 4e61 4e73 2061 7420 7468   Puts NaNs at th
+0001e000: 6520 6265 6769 6e6e 696e 6720 6966 2027  e beginning if '
+0001e010: 6669 7273 7427 2c20 7075 7473 204e 614e  first', puts NaN
+0001e020: 2061 7420 7468 6520 656e 6420 6966 2027   at the end if '
+0001e030: 6c61 7374 272e 0a20 2020 2020 2020 2020  last'..         
+0001e040: 2020 2044 6566 6175 6c74 7320 746f 2027     Defaults to '
+0001e050: 6c61 7374 272e 0a20 2020 2020 2020 2073  last'..        s
+0001e060: 6f72 745f 6675 6e63 7469 6f6e 3a20 6675  ort_function: fu
+0001e070: 6e63 7469 6f6e 2c20 6f70 7469 6f6e 616c  nction, optional
+0001e080: 0a20 2020 2020 2020 2020 2020 2053 6f72  .            Sor
+0001e090: 7469 6e67 2066 756e 6374 696f 6e20 746f  ting function to
+0001e0a0: 2075 7365 2077 6865 6e20 736f 7274 696e   use when sortin
+0001e0b0: 6720 756e 6465 726c 7969 6e67 2070 6172  g underlying par
+0001e0c0: 7469 7469 6f6e 732e 0a20 2020 2020 2020  titions..       
+0001e0d0: 2020 2020 2049 6620 4e6f 6e65 2c20 6465       If None, de
+0001e0e0: 6661 756c 7473 2074 6f20 6060 4d2e 736f  faults to ``M.so
+0001e0f0: 7274 5f76 616c 7565 7360 6020 2874 6865  rt_values`` (the
+0001e100: 2070 6172 7469 7469 6f6e 206c 6962 7261   partition libra
+0001e110: 7279 2773 0a20 2020 2020 2020 2020 2020  ry's.           
+0001e120: 2069 6d70 6c65 6d65 6e74 6174 696f 6e20   implementation 
+0001e130: 6f66 2060 6073 6f72 745f 7661 6c75 6573  of ``sort_values
+0001e140: 6060 292e 0a20 2020 2020 2020 2073 6f72  ``)..        sor
+0001e150: 745f 6675 6e63 7469 6f6e 5f6b 7761 7267  t_function_kwarg
+0001e160: 733a 2064 6963 742c 206f 7074 696f 6e61  s: dict, optiona
+0001e170: 6c0a 2020 2020 2020 2020 2020 2020 4164  l.            Ad
+0001e180: 6469 7469 6f6e 616c 206b 6579 776f 7264  ditional keyword
+0001e190: 2061 7267 756d 656e 7473 2074 6f20 7061   arguments to pa
+0001e1a0: 7373 2074 6f20 7468 6520 7061 7274 6974  ss to the partit
+0001e1b0: 696f 6e20 736f 7274 696e 6720 6675 6e63  ion sorting func
+0001e1c0: 7469 6f6e 2e0a 2020 2020 2020 2020 2020  tion..          
+0001e1d0: 2020 4279 2064 6566 6175 6c74 2c20 6060    By default, ``
+0001e1e0: 6279 6060 2c20 6060 6173 6365 6e64 696e  by``, ``ascendin
+0001e1f0: 6760 602c 2061 6e64 2060 606e 615f 706f  g``, and ``na_po
+0001e200: 7369 7469 6f6e 6060 2061 7265 2070 726f  sition`` are pro
+0001e210: 7669 6465 642e 0a0a 2020 2020 2020 2020  vided...        
+0001e220: 4578 616d 706c 6573 0a20 2020 2020 2020  Examples.       
+0001e230: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
+0001e240: 2020 3e3e 3e20 6466 3220 3d20 6466 2e73    >>> df2 = df.s
+0001e250: 6f72 745f 7661 6c75 6573 2827 7827 2920  ort_values('x') 
+0001e260: 2023 2064 6f63 7465 7374 3a20 2b53 4b49   # doctest: +SKI
+0001e270: 500a 2020 2020 2020 2020 2222 220a 2020  P.        """.  
+0001e280: 2020 2020 2020 6966 206e 615f 706f 7369        if na_posi
+0001e290: 7469 6f6e 206e 6f74 2069 6e20 2822 6669  tion not in ("fi
+0001e2a0: 7273 7422 2c20 226c 6173 7422 293a 0a20  rst", "last"):. 
+0001e2b0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0001e2c0: 2056 616c 7565 4572 726f 7228 226e 615f   ValueError("na_
+0001e2d0: 706f 7369 7469 6f6e 206d 7573 7420 6265  position must be
+0001e2e0: 2065 6974 6865 7220 2766 6972 7374 2720   either 'first' 
+0001e2f0: 6f72 2027 6c61 7374 2722 290a 2020 2020  or 'last'").    
+0001e300: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
+0001e310: 7461 6e63 6528 6279 2c20 6c69 7374 293a  tance(by, list):
+0001e320: 0a20 2020 2020 2020 2020 2020 2062 7920  .            by 
+0001e330: 3d20 5b62 795d 0a20 2020 2020 2020 2069  = [by].        i
+0001e340: 6620 616e 7928 6e6f 7420 6973 696e 7374  f any(not isinst
+0001e350: 616e 6365 2862 2c20 7374 7229 2066 6f72  ance(b, str) for
+0001e360: 2062 2069 6e20 6279 293a 0a20 2020 2020   b in by):.     
+0001e370: 2020 2020 2020 2072 6169 7365 204e 6f74         raise Not
+0001e380: 496d 706c 656d 656e 7465 6445 7272 6f72  ImplementedError
+0001e390: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0001e3a0: 2020 2244 6174 6166 7261 6d65 7320 6f6e    "Dataframes on
+0001e3b0: 6c79 2073 7570 706f 7274 2073 6f72 7469  ly support sorti
+0001e3c0: 6e67 2062 7920 6e61 6d65 6420 636f 6c75  ng by named colu
+0001e3d0: 6d6e 7320 7768 6963 6820 6d75 7374 2062  mns which must b
+0001e3e0: 6520 7061 7373 6564 2061 7320 6120 220a  e passed as a ".
+0001e3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e400: 2273 7472 696e 6720 6f72 2061 206c 6973  "string or a lis
+0001e410: 7420 6f66 2073 7472 696e 6773 2e5c 6e22  t of strings.\n"
+0001e420: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001e430: 2022 596f 7520 7061 7373 6564 2025 7322   "You passed %s"
+0001e440: 2025 2073 7472 2862 7929 0a20 2020 2020   % str(by).     
+0001e450: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+0001e460: 2020 6966 206e 6f74 2069 7369 6e73 7461    if not isinsta
+0001e470: 6e63 6528 6173 6365 6e64 696e 672c 2062  nce(ascending, b
+0001e480: 6f6f 6c29 2061 6e64 206e 6f74 206c 656e  ool) and not len
+0001e490: 2861 7363 656e 6469 6e67 2920 3d3d 206c  (ascending) == l
+0001e4a0: 656e 2862 7929 3a0a 2020 2020 2020 2020  en(by):.        
+0001e4b0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+0001e4c0: 7272 6f72 2866 224c 656e 6774 6820 6f66  rror(f"Length of
+0001e4d0: 207b 6173 6365 6e64 696e 673d 7d20 213d   {ascending=} !=
+0001e4e0: 206c 656e 6774 6820 6f66 207b 6279 3d7d   length of {by=}
+0001e4f0: 2229 0a0a 2020 2020 2020 2020 7265 7475  ")..        retu
+0001e500: 726e 206e 6577 5f63 6f6c 6c65 6374 696f  rn new_collectio
+0001e510: 6e28 0a20 2020 2020 2020 2020 2020 2053  n(.            S
+0001e520: 6f72 7456 616c 7565 7328 0a20 2020 2020  ortValues(.     
+0001e530: 2020 2020 2020 2020 2020 2073 656c 662c             self,
+0001e540: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001e550: 2062 792c 0a20 2020 2020 2020 2020 2020   by,.           
+0001e560: 2020 2020 2061 7363 656e 6469 6e67 2c0a       ascending,.
+0001e570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e580: 6e61 5f70 6f73 6974 696f 6e2c 0a20 2020  na_position,.   
+0001e590: 2020 2020 2020 2020 2020 2020 206e 7061               npa
+0001e5a0: 7274 6974 696f 6e73 2c0a 2020 2020 2020  rtitions,.      
+0001e5b0: 2020 2020 2020 2020 2020 7061 7274 6974            partit
+0001e5c0: 696f 6e5f 7369 7a65 2c0a 2020 2020 2020  ion_size,.      
+0001e5d0: 2020 2020 2020 2020 2020 736f 7274 5f66            sort_f
+0001e5e0: 756e 6374 696f 6e2c 0a20 2020 2020 2020  unction,.       
+0001e5f0: 2020 2020 2020 2020 2073 6f72 745f 6675           sort_fu
+0001e600: 6e63 7469 6f6e 5f6b 7761 7267 732c 0a20  nction_kwargs,. 
+0001e610: 2020 2020 2020 2020 2020 2020 2020 2075                 u
+0001e620: 7073 616d 706c 652c 0a20 2020 2020 2020  psample,.       
+0001e630: 2020 2020 2020 2020 2069 676e 6f72 655f           ignore_
+0001e640: 696e 6465 782c 0a20 2020 2020 2020 2020  index,.         
+0001e650: 2020 2020 2020 2067 6574 5f73 7065 6369         get_speci
+0001e660: 6669 6564 5f73 6875 6666 6c65 2873 6875  fied_shuffle(shu
+0001e670: 6666 6c65 5f6d 6574 686f 6429 2c0a 2020  ffle_method),.  
+0001e680: 2020 2020 2020 2020 2020 2020 2020 6f70                op
+0001e690: 7469 6f6e 733d 6f70 7469 6f6e 732c 0a20  tions=options,. 
+0001e6a0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0001e6b0: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
+0001e6c0: 7175 6572 7928 7365 6c66 2c20 6578 7072  query(self, expr
+0001e6d0: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
+0001e6e0: 2020 2020 2022 2222 4669 6c74 6572 2064       """Filter d
+0001e6f0: 6174 6166 7261 6d65 2077 6974 6820 636f  ataframe with co
+0001e700: 6d70 6c65 7820 6578 7072 6573 7369 6f6e  mplex expression
+0001e710: 0a0a 2020 2020 2020 2020 426c 6f63 6b65  ..        Blocke
+0001e720: 6420 7665 7273 696f 6e20 6f66 2070 642e  d version of pd.
+0001e730: 4461 7461 4672 616d 652e 7175 6572 790a  DataFrame.query.
+0001e740: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+0001e750: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
+0001e760: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2065  ------.        e
+0001e770: 7870 723a 2073 7472 0a20 2020 2020 2020  xpr: str.       
+0001e780: 2020 2020 2054 6865 2071 7565 7279 2073       The query s
+0001e790: 7472 696e 6720 746f 2065 7661 6c75 6174  tring to evaluat
+0001e7a0: 652e 0a20 2020 2020 2020 2020 2020 2059  e..            Y
+0001e7b0: 6f75 2063 616e 2072 6566 6572 2074 6f20  ou can refer to 
+0001e7c0: 636f 6c75 6d6e 206e 616d 6573 2074 6861  column names tha
+0001e7d0: 7420 6172 6520 6e6f 7420 7661 6c69 6420  t are not valid 
+0001e7e0: 5079 7468 6f6e 2076 6172 6961 626c 6520  Python variable 
+0001e7f0: 6e61 6d65 730a 2020 2020 2020 2020 2020  names.          
+0001e800: 2020 6279 2073 7572 726f 756e 6469 6e67    by surrounding
+0001e810: 2074 6865 6d20 696e 2062 6163 6b74 6963   them in backtic
+0001e820: 6b73 2e0a 2020 2020 2020 2020 2020 2020  ks..            
+0001e830: 4461 736b 2064 6f65 7320 6e6f 7420 6675  Dask does not fu
+0001e840: 6c6c 7920 7375 7070 6f72 7420 7265 6665  lly support refe
+0001e850: 7272 696e 6720 746f 2076 6172 6961 626c  rring to variabl
+0001e860: 6573 2075 7369 6e67 2074 6865 2027 4027  es using the '@'
+0001e870: 2063 6861 7261 6374 6572 2c0a 2020 2020   character,.    
+0001e880: 2020 2020 2020 2020 7573 6520 662d 7374          use f-st
+0001e890: 7269 6e67 7320 6f72 2074 6865 2060 606c  rings or the ``l
+0001e8a0: 6f63 616c 5f64 6963 7460 6020 6b65 7977  ocal_dict`` keyw
+0001e8b0: 6f72 6420 6172 6775 6d65 6e74 2069 6e73  ord argument ins
+0001e8c0: 7465 6164 2e0a 0a20 2020 2020 2020 204e  tead...        N
+0001e8d0: 6f74 6573 0a20 2020 2020 2020 202d 2d2d  otes.        ---
+0001e8e0: 2d2d 0a20 2020 2020 2020 2054 6869 7320  --.        This 
+0001e8f0: 6973 206c 696b 6520 7468 6520 7365 7175  is like the sequ
+0001e900: 656e 7469 616c 2076 6572 7369 6f6e 2065  ential version e
+0001e910: 7863 6570 7420 7468 6174 2074 6869 7320  xcept that this 
+0001e920: 7769 6c6c 2061 6c73 6f20 6861 7070 656e  will also happen
+0001e930: 0a20 2020 2020 2020 2069 6e20 6d61 6e79  .        in many
+0001e940: 2074 6872 6561 6473 2e20 2054 6869 7320   threads.  This 
+0001e950: 6d61 7920 636f 6e66 6c69 6374 2077 6974  may conflict wit
+0001e960: 6820 6060 6e75 6d65 7870 7260 6020 7768  h ``numexpr`` wh
+0001e970: 6963 6820 7769 6c6c 2075 7365 0a20 2020  ich will use.   
+0001e980: 2020 2020 206d 756c 7469 706c 6520 7468       multiple th
+0001e990: 7265 6164 7320 6974 7365 6c66 2e20 2057  reads itself.  W
+0001e9a0: 6520 7265 636f 6d6d 656e 6420 7468 6174  e recommend that
+0001e9b0: 2079 6f75 2073 6574 2060 606e 756d 6578   you set ``numex
+0001e9c0: 7072 6060 2074 6f20 7573 6520 610a 2020  pr`` to use a.  
+0001e9d0: 2020 2020 2020 7369 6e67 6c65 2074 6872        single thr
+0001e9e0: 6561 643a 0a0a 2020 2020 2020 2020 2e2e  ead:..        ..
+0001e9f0: 2063 6f64 652d 626c 6f63 6b3a 3a20 7079   code-block:: py
+0001ea00: 7468 6f6e 0a0a 2020 2020 2020 2020 2020  thon..          
+0001ea10: 2020 696d 706f 7274 206e 756d 6578 7072    import numexpr
+0001ea20: 0a20 2020 2020 2020 2020 2020 206e 756d  .            num
+0001ea30: 6578 7072 2e73 6574 5f6e 756d 5f74 6872  expr.set_num_thr
+0001ea40: 6561 6473 2831 290a 0a20 2020 2020 2020  eads(1)..       
+0001ea50: 2053 6565 2061 6c73 6f0a 2020 2020 2020   See also.      
+0001ea60: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020    --------.     
+0001ea70: 2020 2070 616e 6461 732e 4461 7461 4672     pandas.DataFr
+0001ea80: 616d 652e 7175 6572 790a 2020 2020 2020  ame.query.      
+0001ea90: 2020 7061 6e64 6173 2e65 7661 6c0a 0a20    pandas.eval.. 
+0001eaa0: 2020 2020 2020 2045 7861 6d70 6c65 730a         Examples.
+0001eab0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0001eac0: 0a20 2020 2020 2020 203e 3e3e 2069 6d70  .        >>> imp
+0001ead0: 6f72 7420 7061 6e64 6173 2061 7320 7064  ort pandas as pd
+0001eae0: 0a20 2020 2020 2020 203e 3e3e 2069 6d70  .        >>> imp
+0001eaf0: 6f72 7420 6461 736b 5f65 7870 7220 6173  ort dask_expr as
+0001eb00: 2064 640a 2020 2020 2020 2020 3e3e 3e20   dd.        >>> 
+0001eb10: 6466 203d 2070 642e 4461 7461 4672 616d  df = pd.DataFram
+0001eb20: 6528 7b27 7827 3a20 5b31 2c20 322c 2031  e({'x': [1, 2, 1
+0001eb30: 2c20 325d 2c0a 2020 2020 2020 2020 2e2e  , 2],.        ..
+0001eb40: 2e20 2020 2020 2020 2020 2020 2020 2020  .               
+0001eb50: 2020 2020 2027 7927 3a20 5b31 2c20 322c       'y': [1, 2,
+0001eb60: 2033 2c20 345d 2c0a 2020 2020 2020 2020   3, 4],.        
+0001eb70: 2e2e 2e20 2020 2020 2020 2020 2020 2020  ...             
+0001eb80: 2020 2020 2020 2027 7a20 7a27 3a20 5b34         'z z': [4
+0001eb90: 2c20 332c 2032 2c20 315d 7d29 0a20 2020  , 3, 2, 1]}).   
+0001eba0: 2020 2020 203e 3e3e 2064 6466 203d 2064       >>> ddf = d
+0001ebb0: 642e 6672 6f6d 5f70 616e 6461 7328 6466  d.from_pandas(df
+0001ebc0: 2c20 6e70 6172 7469 7469 6f6e 733d 3229  , npartitions=2)
+0001ebd0: 0a0a 2020 2020 2020 2020 5265 6665 7220  ..        Refer 
+0001ebe0: 746f 2063 6f6c 756d 6e20 6e61 6d65 7320  to column names 
+0001ebf0: 6469 7265 6374 6c79 3a0a 0a20 2020 2020  directly:..     
+0001ec00: 2020 203e 3e3e 2064 6466 2e71 7565 7279     >>> ddf.query
+0001ec10: 2827 7920 3e20 7827 292e 636f 6d70 7574  ('y > x').comput
+0001ec20: 6528 290a 2020 2020 2020 2020 2020 2078  e().           x
+0001ec30: 2020 7920 207a 207a 0a20 2020 2020 2020    y  z z.       
+0001ec40: 2032 2020 3120 2033 2020 2020 320a 2020   2  1  3    2.  
+0001ec50: 2020 2020 2020 3320 2032 2020 3420 2020        3  2  4   
+0001ec60: 2031 0a0a 2020 2020 2020 2020 5265 6665   1..        Refe
+0001ec70: 7220 746f 2063 6f6c 756d 6e20 6e61 6d65  r to column name
+0001ec80: 2075 7369 6e67 2062 6163 6b74 6963 6b73   using backticks
+0001ec90: 3a0a 0a20 2020 2020 2020 203e 3e3e 2064  :..        >>> d
+0001eca0: 6466 2e71 7565 7279 2827 607a 207a 6020  df.query('`z z` 
+0001ecb0: 3e20 7827 292e 636f 6d70 7574 6528 290a  > x').compute().
+0001ecc0: 2020 2020 2020 2020 2020 2078 2020 7920             x  y 
+0001ecd0: 207a 207a 0a20 2020 2020 2020 2030 2020   z z.        0  
+0001ece0: 3120 2031 2020 2020 340a 2020 2020 2020  1  1    4.      
+0001ecf0: 2020 3120 2032 2020 3220 2020 2033 0a20    1  2  2    3. 
+0001ed00: 2020 2020 2020 2032 2020 3120 2033 2020         2  1  3  
+0001ed10: 2020 320a 0a20 2020 2020 2020 2052 6566    2..        Ref
+0001ed20: 6572 2074 6f20 7661 7269 6162 6c65 206e  er to variable n
+0001ed30: 616d 6520 7573 696e 6720 662d 7374 7269  ame using f-stri
+0001ed40: 6e67 733a 0a0a 2020 2020 2020 2020 3e3e  ngs:..        >>
+0001ed50: 3e20 7661 6c75 6520 3d20 310a 2020 2020  > value = 1.    
+0001ed60: 2020 2020 3e3e 3e20 6464 662e 7175 6572      >>> ddf.quer
+0001ed70: 7928 6627 7820 3d3d 207b 7661 6c75 657d  y(f'x == {value}
+0001ed80: 2729 2e63 6f6d 7075 7465 2829 0a20 2020  ').compute().   
+0001ed90: 2020 2020 2020 2020 7820 2079 2020 7a20          x  y  z 
+0001eda0: 7a0a 2020 2020 2020 2020 3020 2031 2020  z.        0  1  
+0001edb0: 3120 2020 2034 0a20 2020 2020 2020 2032  1    4.        2
+0001edc0: 2020 3120 2033 2020 2020 320a 0a20 2020    1  3    2..   
+0001edd0: 2020 2020 2052 6566 6572 2074 6f20 7661       Refer to va
+0001ede0: 7269 6162 6c65 206e 616d 6520 7573 696e  riable name usin
+0001edf0: 6720 6060 6c6f 6361 6c5f 6469 6374 6060  g ``local_dict``
+0001ee00: 3a0a 0a20 2020 2020 2020 203e 3e3e 2064  :..        >>> d
+0001ee10: 6466 2e71 7565 7279 2827 7820 3d3d 2040  df.query('x == @
+0001ee20: 7661 6c75 6527 2c20 6c6f 6361 6c5f 6469  value', local_di
+0001ee30: 6374 3d7b 2276 616c 7565 223a 2076 616c  ct={"value": val
+0001ee40: 7565 7d29 2e63 6f6d 7075 7465 2829 0a20  ue}).compute(). 
+0001ee50: 2020 2020 2020 2020 2020 7820 2079 2020            x  y  
+0001ee60: 7a20 7a0a 2020 2020 2020 2020 3020 2031  z z.        0  1
+0001ee70: 2020 3120 2020 2034 0a20 2020 2020 2020    1    4.       
+0001ee80: 2032 2020 3120 2033 2020 2020 320a 2020   2  1  3    2.  
+0001ee90: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0001eea0: 2020 7265 7475 726e 206e 6577 5f63 6f6c    return new_col
+0001eeb0: 6c65 6374 696f 6e28 5175 6572 7928 7365  lection(Query(se
+0001eec0: 6c66 2c20 6578 7072 2c20 6b77 6172 6773  lf, expr, kwargs
+0001eed0: 2929 0a0a 2020 2020 4064 6572 6976 6564  ))..    @derived
+0001eee0: 5f66 726f 6d28 7064 2e44 6174 6146 7261  _from(pd.DataFra
+0001eef0: 6d65 290a 2020 2020 6465 6620 6d6f 6465  me).    def mode
+0001ef00: 2873 656c 662c 2064 726f 706e 613d 5472  (self, dropna=Tr
+0001ef10: 7565 2c20 7370 6c69 745f 6576 6572 793d  ue, split_every=
+0001ef20: 4661 6c73 652c 206e 756d 6572 6963 5f6f  False, numeric_o
+0001ef30: 6e6c 793d 4661 6c73 6529 3a0a 2020 2020  nly=False):.    
+0001ef40: 2020 2020 6d6f 6465 7320 3d20 5b5d 0a20      modes = []. 
+0001ef50: 2020 2020 2020 2066 6f72 205f 2c20 636f         for _, co
+0001ef60: 6c20 696e 2073 656c 662e 6974 656d 7328  l in self.items(
+0001ef70: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
+0001ef80: 6620 6e75 6d65 7269 635f 6f6e 6c79 2061  f numeric_only a
+0001ef90: 6e64 206e 6f74 2070 642e 6170 692e 7479  nd not pd.api.ty
+0001efa0: 7065 732e 6973 5f6e 756d 6572 6963 5f64  pes.is_numeric_d
+0001efb0: 7479 7065 2863 6f6c 2e64 7479 7065 293a  type(col.dtype):
+0001efc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001efd0: 2063 6f6e 7469 6e75 650a 2020 2020 2020   continue.      
+0001efe0: 2020 2020 2020 6d6f 6465 732e 6170 7065        modes.appe
+0001eff0: 6e64 2863 6f6c 2e6d 6f64 6528 6472 6f70  nd(col.mode(drop
+0001f000: 6e61 3d64 726f 706e 612c 2073 706c 6974  na=dropna, split
+0001f010: 5f65 7665 7279 3d73 706c 6974 5f65 7665  _every=split_eve
+0001f020: 7279 2929 0a20 2020 2020 2020 2072 6574  ry)).        ret
+0001f030: 7572 6e20 636f 6e63 6174 286d 6f64 6573  urn concat(modes
+0001f040: 2c20 6178 6973 3d31 290a 0a20 2020 2040  , axis=1)..    @
+0001f050: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
+0001f060: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
+0001f070: 6566 2061 6464 5f70 7265 6669 7828 7365  ef add_prefix(se
+0001f080: 6c66 2c20 7072 6566 6978 293a 0a20 2020  lf, prefix):.   
+0001f090: 2020 2020 2072 6574 7572 6e20 6e65 775f       return new_
+0001f0a0: 636f 6c6c 6563 7469 6f6e 2865 7870 722e  collection(expr.
+0001f0b0: 4164 6450 7265 6669 7828 7365 6c66 2c20  AddPrefix(self, 
+0001f0c0: 7072 6566 6978 2929 0a0a 2020 2020 4064  prefix))..    @d
+0001f0d0: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
+0001f0e0: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
+0001f0f0: 6620 6164 645f 7375 6666 6978 2873 656c  f add_suffix(sel
+0001f100: 662c 2073 7566 6669 7829 3a0a 2020 2020  f, suffix):.    
+0001f110: 2020 2020 7265 7475 726e 206e 6577 5f63      return new_c
+0001f120: 6f6c 6c65 6374 696f 6e28 6578 7072 2e41  ollection(expr.A
+0001f130: 6464 5375 6666 6978 2873 656c 662c 2073  ddSuffix(self, s
+0001f140: 7566 6669 7829 290a 0a20 2020 2064 6566  uffix))..    def
+0001f150: 2070 6976 6f74 5f74 6162 6c65 2873 656c   pivot_table(sel
+0001f160: 662c 2069 6e64 6578 2c20 636f 6c75 6d6e  f, index, column
+0001f170: 732c 2076 616c 7565 732c 2061 6767 6675  s, values, aggfu
+0001f180: 6e63 3d22 6d65 616e 2229 3a0a 2020 2020  nc="mean"):.    
+0001f190: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0001f1a0: 4372 6561 7465 2061 2073 7072 6561 6473  Create a spreads
+0001f1b0: 6865 6574 2d73 7479 6c65 2070 6976 6f74  heet-style pivot
+0001f1c0: 2074 6162 6c65 2061 7320 6120 4461 7461   table as a Data
+0001f1d0: 4672 616d 652e 2054 6172 6765 7420 6060  Frame. Target ``
+0001f1e0: 636f 6c75 6d6e 7360 600a 2020 2020 2020  columns``.      
+0001f1f0: 2020 6d75 7374 2068 6176 6520 6361 7465    must have cate
+0001f200: 676f 7279 2064 7479 7065 2074 6f20 696e  gory dtype to in
+0001f210: 6665 7220 7265 7375 6c74 2773 2060 6063  fer result's ``c
+0001f220: 6f6c 756d 6e73 6060 2e0a 2020 2020 2020  olumns``..      
+0001f230: 2020 6060 696e 6465 7860 602c 2060 6063    ``index``, ``c
+0001f240: 6f6c 756d 6e73 6060 2c20 6060 7661 6c75  olumns``, ``valu
+0001f250: 6573 6060 2061 6e64 2060 6061 6767 6675  es`` and ``aggfu
+0001f260: 6e63 6060 206d 7573 7420 6265 2061 6c6c  nc`` must be all
+0001f270: 2073 6361 6c61 722e 0a0a 2020 2020 2020   scalar...      
+0001f280: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
+0001f290: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
+0001f2a0: 2020 2020 2020 2020 7661 6c75 6573 203a          values :
+0001f2b0: 2073 6361 6c61 720a 2020 2020 2020 2020   scalar.        
+0001f2c0: 2020 2020 636f 6c75 6d6e 2074 6f20 6167      column to ag
+0001f2d0: 6772 6567 6174 650a 2020 2020 2020 2020  gregate.        
+0001f2e0: 696e 6465 7820 3a20 7363 616c 6172 0a20  index : scalar. 
+0001f2f0: 2020 2020 2020 2020 2020 2063 6f6c 756d             colum
+0001f300: 6e20 746f 2062 6520 696e 6465 780a 2020  n to be index.  
+0001f310: 2020 2020 2020 636f 6c75 6d6e 7320 3a20        columns : 
+0001f320: 7363 616c 6172 0a20 2020 2020 2020 2020  scalar.         
+0001f330: 2020 2063 6f6c 756d 6e20 746f 2062 6520     column to be 
+0001f340: 636f 6c75 6d6e 730a 2020 2020 2020 2020  columns.        
+0001f350: 6167 6766 756e 6320 3a20 7b27 6d65 616e  aggfunc : {'mean
+0001f360: 272c 2027 7375 6d27 2c20 2763 6f75 6e74  ', 'sum', 'count
+0001f370: 277d 2c20 6465 6661 756c 7420 276d 6561  '}, default 'mea
+0001f380: 6e27 0a0a 2020 2020 2020 2020 5265 7475  n'..        Retu
+0001f390: 726e 730a 2020 2020 2020 2020 2d2d 2d2d  rns.        ----
+0001f3a0: 2d2d 2d0a 2020 2020 2020 2020 7461 626c  ---.        tabl
+0001f3b0: 6520 3a20 4461 7461 4672 616d 650a 2020  e : DataFrame.  
+0001f3c0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0001f3d0: 2020 7265 7475 726e 2070 6976 6f74 5f74    return pivot_t
+0001f3e0: 6162 6c65 2873 656c 662c 2069 6e64 6578  able(self, index
+0001f3f0: 2c20 636f 6c75 6d6e 732c 2076 616c 7565  , columns, value
+0001f400: 732c 2061 6767 6675 6e63 290a 0a20 2020  s, aggfunc)..   
+0001f410: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+0001f420: 6566 2069 6c6f 6328 7365 6c66 293a 0a20  ef iloc(self):. 
+0001f430: 2020 2020 2020 2022 2222 5075 7265 6c79         """Purely
+0001f440: 2069 6e74 6567 6572 2d6c 6f63 6174 696f   integer-locatio
+0001f450: 6e20 6261 7365 6420 696e 6465 7869 6e67  n based indexing
+0001f460: 2066 6f72 2073 656c 6563 7469 6f6e 2062   for selection b
+0001f470: 7920 706f 7369 7469 6f6e 2e0a 0a20 2020  y position...   
+0001f480: 2020 2020 204f 6e6c 7920 696e 6465 7869       Only indexi
+0001f490: 6e67 2074 6865 2063 6f6c 756d 6e20 706f  ng the column po
+0001f4a0: 7369 7469 6f6e 7320 6973 2073 7570 706f  sitions is suppo
+0001f4b0: 7274 6564 2e20 5472 7969 6e67 2074 6f20  rted. Trying to 
+0001f4c0: 7365 6c65 6374 0a20 2020 2020 2020 2072  select.        r
+0001f4d0: 6f77 2070 6f73 6974 696f 6e73 2077 696c  ow positions wil
+0001f4e0: 6c20 7261 6973 6520 6120 5661 6c75 6545  l raise a ValueE
+0001f4f0: 7272 6f72 2e0a 0a20 2020 2020 2020 2053  rror...        S
+0001f500: 6565 203a 7265 663a 6064 6174 6166 7261  ee :ref:`datafra
+0001f510: 6d65 2e69 6e64 6578 696e 6760 2066 6f72  me.indexing` for
+0001f520: 206d 6f72 652e 0a0a 2020 2020 2020 2020   more...        
+0001f530: 4578 616d 706c 6573 0a20 2020 2020 2020  Examples.       
+0001f540: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
+0001f550: 2020 3e3e 3e20 6466 2e69 6c6f 635b 3a2c    >>> df.iloc[:,
+0001f560: 205b 322c 2030 2c20 315d 5d20 2023 2064   [2, 0, 1]]  # d
+0001f570: 6f63 7465 7374 3a20 2b53 4b49 500a 2020  octest: +SKIP.  
+0001f580: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0001f590: 2020 6672 6f6d 2064 6173 6b5f 6578 7072    from dask_expr
+0001f5a0: 2e5f 696e 6465 7869 6e67 2069 6d70 6f72  ._indexing impor
+0001f5b0: 7420 494c 6f63 496e 6465 7865 720a 0a20  t ILocIndexer.. 
+0001f5c0: 2020 2020 2020 2072 6574 7572 6e20 494c         return IL
+0001f5d0: 6f63 496e 6465 7865 7228 7365 6c66 290a  ocIndexer(self).
+0001f5e0: 0a20 2020 2064 6566 205f 636f 6d70 6172  .    def _compar
+0001f5f0: 6973 6f6e 5f6f 7028 7365 6c66 2c20 6578  ison_op(self, ex
+0001f600: 7072 5f63 6c73 2c20 6f74 6865 722c 206c  pr_cls, other, l
+0001f610: 6576 656c 2c20 6178 6973 293a 0a20 2020  evel, axis):.   
+0001f620: 2020 2020 2069 6620 6c65 7665 6c20 6973       if level is
+0001f630: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+0001f640: 2020 2020 2020 2072 6169 7365 204e 6f74         raise Not
+0001f650: 496d 706c 656d 656e 7465 6445 7272 6f72  ImplementedError
+0001f660: 2822 6c65 7665 6c20 6d75 7374 2062 6520  ("level must be 
+0001f670: 4e6f 6e65 2229 0a20 2020 2020 2020 2061  None").        a
+0001f680: 7869 7320 3d20 7365 6c66 2e5f 7661 6c69  xis = self._vali
+0001f690: 6461 7465 5f61 7869 7328 6178 6973 290a  date_axis(axis).
+0001f6a0: 2020 2020 2020 2020 7265 7475 726e 206e          return n
+0001f6b0: 6577 5f63 6f6c 6c65 6374 696f 6e28 6578  ew_collection(ex
+0001f6c0: 7072 5f63 6c73 2873 656c 662c 206f 7468  pr_cls(self, oth
+0001f6d0: 6572 2c20 6178 6973 2929 0a0a 2020 2020  er, axis))..    
+0001f6e0: 6465 6620 6c74 2873 656c 662c 206f 7468  def lt(self, oth
+0001f6f0: 6572 2c20 6c65 7665 6c3d 4e6f 6e65 2c20  er, level=None, 
+0001f700: 6178 6973 3d30 293a 0a20 2020 2020 2020  axis=0):.       
+0001f710: 2072 6574 7572 6e20 7365 6c66 2e5f 636f   return self._co
+0001f720: 6d70 6172 6973 6f6e 5f6f 7028 6578 7072  mparison_op(expr
+0001f730: 2e4c 5446 7261 6d65 2c20 6f74 6865 722c  .LTFrame, other,
+0001f740: 206c 6576 656c 2c20 6178 6973 290a 0a20   level, axis).. 
+0001f750: 2020 2064 6566 206c 6528 7365 6c66 2c20     def le(self, 
+0001f760: 6f74 6865 722c 206c 6576 656c 3d4e 6f6e  other, level=Non
+0001f770: 652c 2061 7869 733d 3029 3a0a 2020 2020  e, axis=0):.    
+0001f780: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0001f790: 5f63 6f6d 7061 7269 736f 6e5f 6f70 2865  _comparison_op(e
+0001f7a0: 7870 722e 4c45 4672 616d 652c 206f 7468  xpr.LEFrame, oth
+0001f7b0: 6572 2c20 6c65 7665 6c2c 2061 7869 7329  er, level, axis)
+0001f7c0: 0a0a 2020 2020 6465 6620 6774 2873 656c  ..    def gt(sel
+0001f7d0: 662c 206f 7468 6572 2c20 6c65 7665 6c3d  f, other, level=
+0001f7e0: 4e6f 6e65 2c20 6178 6973 3d30 293a 0a20  None, axis=0):. 
+0001f7f0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0001f800: 6c66 2e5f 636f 6d70 6172 6973 6f6e 5f6f  lf._comparison_o
+0001f810: 7028 6578 7072 2e47 5446 7261 6d65 2c20  p(expr.GTFrame, 
+0001f820: 6f74 6865 722c 206c 6576 656c 2c20 6178  other, level, ax
+0001f830: 6973 290a 0a20 2020 2064 6566 2067 6528  is)..    def ge(
+0001f840: 7365 6c66 2c20 6f74 6865 722c 206c 6576  self, other, lev
+0001f850: 656c 3d4e 6f6e 652c 2061 7869 733d 3029  el=None, axis=0)
+0001f860: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+0001f870: 2073 656c 662e 5f63 6f6d 7061 7269 736f   self._compariso
+0001f880: 6e5f 6f70 2865 7870 722e 4745 4672 616d  n_op(expr.GEFram
+0001f890: 652c 206f 7468 6572 2c20 6c65 7665 6c2c  e, other, level,
+0001f8a0: 2061 7869 7329 0a0a 2020 2020 6465 6620   axis)..    def 
+0001f8b0: 6e65 2873 656c 662c 206f 7468 6572 2c20  ne(self, other, 
+0001f8c0: 6c65 7665 6c3d 4e6f 6e65 2c20 6178 6973  level=None, axis
+0001f8d0: 3d30 293a 0a20 2020 2020 2020 2072 6574  =0):.        ret
+0001f8e0: 7572 6e20 7365 6c66 2e5f 636f 6d70 6172  urn self._compar
+0001f8f0: 6973 6f6e 5f6f 7028 6578 7072 2e4e 4546  ison_op(expr.NEF
+0001f900: 7261 6d65 2c20 6f74 6865 722c 206c 6576  rame, other, lev
+0001f910: 656c 2c20 6178 6973 290a 0a20 2020 2064  el, axis)..    d
+0001f920: 6566 2065 7128 7365 6c66 2c20 6f74 6865  ef eq(self, othe
+0001f930: 722c 206c 6576 656c 3d4e 6f6e 652c 2061  r, level=None, a
+0001f940: 7869 733d 3029 3a0a 2020 2020 2020 2020  xis=0):.        
+0001f950: 7265 7475 726e 2073 656c 662e 5f63 6f6d  return self._com
+0001f960: 7061 7269 736f 6e5f 6f70 2865 7870 722e  parison_op(expr.
+0001f970: 4551 4672 616d 652c 206f 7468 6572 2c20  EQFrame, other, 
+0001f980: 6c65 7665 6c2c 2061 7869 7329 0a0a 2020  level, axis)..  
+0001f990: 2020 6465 6620 6361 7465 676f 7269 7a65    def categorize
+0001f9a0: 2873 656c 662c 2063 6f6c 756d 6e73 3d4e  (self, columns=N
+0001f9b0: 6f6e 652c 2069 6e64 6578 3d4e 6f6e 652c  one, index=None,
+0001f9c0: 2073 706c 6974 5f65 7665 7279 3d4e 6f6e   split_every=Non
+0001f9d0: 652c 202a 2a6b 7761 7267 7329 3a0a 2020  e, **kwargs):.  
+0001f9e0: 2020 2020 2020 2222 2243 6f6e 7665 7274        """Convert
+0001f9f0: 2063 6f6c 756d 6e73 206f 6620 7468 6520   columns of the 
+0001fa00: 4461 7461 4672 616d 6520 746f 2063 6174  DataFrame to cat
+0001fa10: 6567 6f72 7920 6474 7970 652e 0a0a 2020  egory dtype...  
+0001fa20: 2020 2020 2020 2e2e 2077 6172 6e69 6e67        .. warning
+0001fa30: 3a3a 2054 6869 7320 6d65 7468 6f64 2065  :: This method e
+0001fa40: 6167 6572 6c79 2063 6f6d 7075 7465 7320  agerly computes 
+0001fa50: 7468 6520 6361 7465 676f 7269 6573 206f  the categories o
+0001fa60: 6620 7468 6520 6368 6f73 656e 2063 6f6c  f the chosen col
+0001fa70: 756d 6e73 2e0a 0a20 2020 2020 2020 2050  umns...        P
+0001fa80: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
+0001fa90: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
+0001faa0: 2020 2020 2063 6f6c 756d 6e73 203a 206c       columns : l
+0001fab0: 6973 742c 206f 7074 696f 6e61 6c0a 2020  ist, optional.  
+0001fac0: 2020 2020 2020 2020 2020 4120 6c69 7374            A list
+0001fad0: 206f 6620 636f 6c75 6d6e 206e 616d 6573   of column names
+0001fae0: 2074 6f20 636f 6e76 6572 7420 746f 2063   to convert to c
+0001faf0: 6174 6567 6f72 6963 616c 732e 2042 7920  ategoricals. By 
+0001fb00: 6465 6661 756c 7420 616e 790a 2020 2020  default any.    
+0001fb10: 2020 2020 2020 2020 636f 6c75 6d6e 2077          column w
+0001fb20: 6974 6820 616e 206f 626a 6563 7420 6474  ith an object dt
+0001fb30: 7970 6520 6973 2063 6f6e 7665 7274 6564  ype is converted
+0001fb40: 2074 6f20 6120 6361 7465 676f 7269 6361   to a categorica
+0001fb50: 6c2c 2061 6e64 2061 6e79 0a20 2020 2020  l, and any.     
+0001fb60: 2020 2020 2020 2075 6e6b 6e6f 776e 2063         unknown c
+0001fb70: 6174 6567 6f72 6963 616c 7320 6172 6520  ategoricals are 
+0001fb80: 6d61 6465 206b 6e6f 776e 2e0a 2020 2020  made known..    
+0001fb90: 2020 2020 696e 6465 7820 3a20 626f 6f6c      index : bool
+0001fba0: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+0001fbb0: 2020 2020 2020 2057 6865 7468 6572 2074         Whether t
+0001fbc0: 6f20 6361 7465 676f 7269 7a65 2074 6865  o categorize the
+0001fbd0: 2069 6e64 6578 2e20 4279 2064 6566 6175   index. By defau
+0001fbe0: 6c74 2c20 6f62 6a65 6374 2069 6e64 6963  lt, object indic
+0001fbf0: 6573 2061 7265 0a20 2020 2020 2020 2020  es are.         
+0001fc00: 2020 2063 6f6e 7665 7274 6564 2074 6f20     converted to 
+0001fc10: 6361 7465 676f 7269 6361 6c2c 2061 6e64  categorical, and
+0001fc20: 2075 6e6b 6e6f 776e 2063 6174 6567 6f72   unknown categor
+0001fc30: 6963 616c 2069 6e64 6963 6573 2061 7265  ical indices are
+0001fc40: 206d 6164 650a 2020 2020 2020 2020 2020   made.          
+0001fc50: 2020 6b6e 6f77 6e2e 2053 6574 2054 7275    known. Set Tru
+0001fc60: 6520 746f 2061 6c77 6179 7320 6361 7465  e to always cate
+0001fc70: 676f 7269 7a65 2074 6865 2069 6e64 6578  gorize the index
+0001fc80: 2c20 4661 6c73 6520 746f 206e 6576 6572  , False to never
+0001fc90: 2e0a 2020 2020 2020 2020 7370 6c69 745f  ..        split_
+0001fca0: 6576 6572 7920 3a20 696e 742c 206f 7074  every : int, opt
+0001fcb0: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
+0001fcc0: 2020 4772 6f75 7020 7061 7274 6974 696f    Group partitio
+0001fcd0: 6e73 2069 6e74 6f20 6772 6f75 7073 206f  ns into groups o
+0001fce0: 6620 7468 6973 2073 697a 6520 7768 696c  f this size whil
+0001fcf0: 6520 7065 7266 6f72 6d69 6e67 2061 0a20  e performing a. 
+0001fd00: 2020 2020 2020 2020 2020 2074 7265 652d             tree-
+0001fd10: 7265 6475 6374 696f 6e2e 2049 6620 7365  reduction. If se
+0001fd20: 7420 746f 2046 616c 7365 2c20 6e6f 2074  t to False, no t
+0001fd30: 7265 652d 7265 6475 6374 696f 6e20 7769  ree-reduction wi
+0001fd40: 6c6c 2062 6520 7573 6564 2e0a 2020 2020  ll be used..    
+0001fd50: 2020 2020 6b77 6172 6773 0a20 2020 2020      kwargs.     
+0001fd60: 2020 2020 2020 204b 6579 776f 7264 2061         Keyword a
+0001fd70: 7267 756d 656e 7473 2061 7265 2070 6173  rguments are pas
+0001fd80: 7365 6420 6f6e 2074 6f20 636f 6d70 7574  sed on to comput
+0001fd90: 652e 0a20 2020 2020 2020 2022 2222 0a20  e..        """. 
+0001fda0: 2020 2020 2020 2064 6620 3d20 7365 6c66         df = self
+0001fdb0: 0a20 2020 2020 2020 206d 6574 6120 3d20  .        meta = 
+0001fdc0: 6466 2e5f 6d65 7461 0a20 2020 2020 2020  df._meta.       
+0001fdd0: 2069 6620 636f 6c75 6d6e 7320 6973 204e   if columns is N
+0001fde0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+0001fdf0: 2063 6f6c 756d 6e73 203d 206c 6973 7428   columns = list(
+0001fe00: 6d65 7461 2e73 656c 6563 745f 6474 7970  meta.select_dtyp
+0001fe10: 6573 285b 226f 626a 6563 7422 2c20 2273  es(["object", "s
+0001fe20: 7472 696e 6722 2c20 2263 6174 6567 6f72  tring", "categor
+0001fe30: 7922 5d29 2e63 6f6c 756d 6e73 290a 2020  y"]).columns).  
+0001fe40: 2020 2020 2020 656c 6966 2069 735f 7363        elif is_sc
+0001fe50: 616c 6172 2863 6f6c 756d 6e73 293a 0a20  alar(columns):. 
+0001fe60: 2020 2020 2020 2020 2020 2063 6f6c 756d             colum
+0001fe70: 6e73 203d 205b 636f 6c75 6d6e 735d 0a0a  ns = [columns]..
+0001fe80: 2020 2020 2020 2020 2320 4669 6c74 6572          # Filter
+0001fe90: 206f 7574 206b 6e6f 776e 2063 6174 6567   out known categ
+0001fea0: 6f72 6963 616c 2063 6f6c 756d 6e73 0a20  orical columns. 
+0001feb0: 2020 2020 2020 2063 6f6c 756d 6e73 203d         columns =
+0001fec0: 205b 0a20 2020 2020 2020 2020 2020 2063   [.            c
+0001fed0: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+0001fee0: 2063 2069 6e20 636f 6c75 6d6e 730a 2020   c in columns.  
+0001fef0: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
+0001ff00: 2028 6973 5f63 6174 6567 6f72 6963 616c   (is_categorical
+0001ff10: 5f64 7479 7065 286d 6574 615b 635d 2920  _dtype(meta[c]) 
+0001ff20: 616e 6420 6861 735f 6b6e 6f77 6e5f 6361  and has_known_ca
+0001ff30: 7465 676f 7269 6573 286d 6574 615b 635d  tegories(meta[c]
+0001ff40: 2929 0a20 2020 2020 2020 205d 0a0a 2020  )).        ]..  
+0001ff50: 2020 2020 2020 6966 2069 6e64 6578 2069        if index i
+0001ff60: 7320 6e6f 7420 4661 6c73 653a 0a20 2020  s not False:.   
+0001ff70: 2020 2020 2020 2020 2069 6620 6973 5f63           if is_c
+0001ff80: 6174 6567 6f72 6963 616c 5f64 7479 7065  ategorical_dtype
+0001ff90: 286d 6574 612e 696e 6465 7829 3a0a 2020  (meta.index):.  
+0001ffa0: 2020 2020 2020 2020 2020 2020 2020 696e                in
+0001ffb0: 6465 7820 3d20 6e6f 7420 6861 735f 6b6e  dex = not has_kn
+0001ffc0: 6f77 6e5f 6361 7465 676f 7269 6573 286d  own_categories(m
+0001ffd0: 6574 612e 696e 6465 7829 0a20 2020 2020  eta.index).     
+0001ffe0: 2020 2020 2020 2065 6c69 6620 696e 6465         elif inde
+0001fff0: 7820 6973 204e 6f6e 653a 0a20 2020 2020  x is None:.     
+00020000: 2020 2020 2020 2020 2020 2069 6e64 6578             index
+00020010: 203d 2073 7472 286d 6574 612e 696e 6465   = str(meta.inde
+00020020: 782e 6474 7970 6529 2069 6e20 2822 6f62  x.dtype) in ("ob
+00020030: 6a65 6374 222c 2022 7374 7269 6e67 2229  ject", "string")
+00020040: 0a0a 2020 2020 2020 2020 2320 4e6f 7468  ..        # Noth
+00020050: 696e 6720 746f 2064 6f0a 2020 2020 2020  ing to do.      
+00020060: 2020 6966 206e 6f74 206c 656e 2863 6f6c    if not len(col
+00020070: 756d 6e73 2920 616e 6420 696e 6465 7820  umns) and index 
+00020080: 6973 2046 616c 7365 3a0a 2020 2020 2020  is False:.      
+00020090: 2020 2020 2020 7265 7475 726e 2064 660a        return df.
+000200a0: 0a20 2020 2020 2020 2066 726f 6d20 6461  .        from da
+000200b0: 736b 5f65 7870 722e 5f63 6f6c 6c65 6374  sk_expr._collect
+000200c0: 696f 6e20 696d 706f 7274 206e 6577 5f63  ion import new_c
+000200d0: 6f6c 6c65 6374 696f 6e0a 0a20 2020 2020  ollection..     
+000200e0: 2020 2023 2045 6167 6572 6c79 2063 6f6d     # Eagerly com
+000200f0: 7075 7465 2074 6865 2063 6174 6567 6f72  pute the categor
+00020100: 6965 730a 2020 2020 2020 2020 6361 7465  ies.        cate
+00020110: 676f 7269 6573 2c20 696e 6465 7820 3d20  gories, index = 
+00020120: 6e65 775f 636f 6c6c 6563 7469 6f6e 280a  new_collection(.
+00020130: 2020 2020 2020 2020 2020 2020 4765 7443              GetC
+00020140: 6174 6567 6f72 6965 7328 7365 6c66 2c20  ategories(self, 
+00020150: 636f 6c75 6d6e 733d 636f 6c75 6d6e 732c  columns=columns,
+00020160: 2069 6e64 6578 3d69 6e64 6578 2c20 7370   index=index, sp
+00020170: 6c69 745f 6576 6572 793d 7370 6c69 745f  lit_every=split_
+00020180: 6576 6572 7929 0a20 2020 2020 2020 2029  every).        )
+00020190: 2e63 6f6d 7075 7465 2829 0a0a 2020 2020  .compute()..    
+000201a0: 2020 2020 2320 536f 6d65 206f 7065 7261      # Some opera
+000201b0: 7469 6f6e 7320 6c69 6b65 2067 6574 5f64  tions like get_d
+000201c0: 756d 6d69 6573 2829 2072 656c 7920 6f6e  ummies() rely on
+000201d0: 2074 6865 206f 7264 6572 206f 6620 6361   the order of ca
+000201e0: 7465 676f 7269 6573 0a20 2020 2020 2020  tegories.       
+000201f0: 2063 6174 6567 6f72 6965 7320 3d20 7b6b   categories = {k
+00020200: 3a20 762e 736f 7274 5f76 616c 7565 7328  : v.sort_values(
+00020210: 2920 666f 7220 6b2c 2076 2069 6e20 6361  ) for k, v in ca
+00020220: 7465 676f 7269 6573 2e69 7465 6d73 2829  tegories.items()
+00020230: 7d0a 0a20 2020 2020 2020 2023 2043 6174  }..        # Cat
+00020240: 6567 6f72 697a 6520 6561 6368 2070 6172  egorize each par
+00020250: 7469 7469 6f6e 0a20 2020 2020 2020 2072  tition.        r
+00020260: 6574 7572 6e20 6e65 775f 636f 6c6c 6563  eturn new_collec
+00020270: 7469 6f6e 2843 6174 6567 6f72 697a 6528  tion(Categorize(
+00020280: 7365 6c66 2c20 6361 7465 676f 7269 6573  self, categories
+00020290: 2c20 696e 6465 7829 290a 0a20 2020 2040  , index))..    @
+000202a0: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
+000202b0: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
+000202c0: 6566 206e 756e 6971 7565 2873 656c 662c  ef nunique(self,
+000202d0: 2061 7869 733d 302c 2064 726f 706e 613d   axis=0, dropna=
+000202e0: 5472 7565 2c20 7370 6c69 745f 6576 6572  True, split_ever
+000202f0: 793d 4661 6c73 6529 3a0a 2020 2020 2020  y=False):.      
+00020300: 2020 6966 2061 7869 7320 3d3d 2031 3a0a    if axis == 1:.
+00020310: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00020320: 726e 206e 6577 5f63 6f6c 6c65 6374 696f  rn new_collectio
+00020330: 6e28 6578 7072 2e4e 556e 6971 7565 436f  n(expr.NUniqueCo
+00020340: 6c75 6d6e 7328 7365 6c66 2c20 6178 6973  lumns(self, axis
+00020350: 3d61 7869 732c 2064 726f 706e 613d 6472  =axis, dropna=dr
+00020360: 6f70 6e61 2929 0a20 2020 2020 2020 2065  opna)).        e
+00020370: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00020380: 2072 6574 7572 6e20 636f 6e63 6174 280a   return concat(.
+00020390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000203a0: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+000203b0: 2020 2020 2020 636f 6c2e 6e75 6e69 7175        col.nuniqu
+000203c0: 6528 6472 6f70 6e61 3d64 726f 706e 612c  e(dropna=dropna,
+000203d0: 2073 706c 6974 5f65 7665 7279 3d73 706c   split_every=spl
+000203e0: 6974 5f65 7665 7279 292e 746f 5f73 6572  it_every).to_ser
+000203f0: 6965 7328 6e61 6d65 290a 2020 2020 2020  ies(name).      
+00020400: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+00020410: 7220 6e61 6d65 2c20 636f 6c20 696e 2073  r name, col in s
+00020420: 656c 662e 6974 656d 7328 290a 2020 2020  elf.items().    
+00020430: 2020 2020 2020 2020 2020 2020 5d0a 2020              ].  
+00020440: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+00020450: 2064 6566 2071 7561 6e74 696c 6528 7365   def quantile(se
+00020460: 6c66 2c20 713d 302e 352c 2061 7869 733d  lf, q=0.5, axis=
+00020470: 302c 206e 756d 6572 6963 5f6f 6e6c 793d  0, numeric_only=
+00020480: 4661 6c73 652c 206d 6574 686f 643d 2264  False, method="d
+00020490: 6566 6175 6c74 2229 3a0a 2020 2020 2020  efault"):.      
+000204a0: 2020 2222 2241 7070 726f 7869 6d61 7465    """Approximate
+000204b0: 2072 6f77 2d77 6973 6520 616e 6420 7072   row-wise and pr
+000204c0: 6563 6973 6520 636f 6c75 6d6e 2d77 6973  ecise column-wis
+000204d0: 6520 7175 616e 7469 6c65 7320 6f66 2044  e quantiles of D
+000204e0: 6174 6146 7261 6d65 0a0a 2020 2020 2020  ataFrame..      
+000204f0: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
+00020500: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
+00020510: 2020 2020 2020 2020 7120 3a20 6c69 7374          q : list
+00020520: 2f61 7272 6179 206f 6620 666c 6f61 7473  /array of floats
+00020530: 2c20 6465 6661 756c 7420 302e 3520 2835  , default 0.5 (5
+00020540: 3025 290a 2020 2020 2020 2020 2020 2020  0%).            
+00020550: 4974 6572 6162 6c65 206f 6620 6e75 6d62  Iterable of numb
+00020560: 6572 7320 7261 6e67 696e 6720 6672 6f6d  ers ranging from
+00020570: 2030 2074 6f20 3120 666f 7220 7468 6520   0 to 1 for the 
+00020580: 6465 7369 7265 6420 7175 616e 7469 6c65  desired quantile
+00020590: 730a 2020 2020 2020 2020 6178 6973 203a  s.        axis :
+000205a0: 207b 302c 2031 2c20 2769 6e64 6578 272c   {0, 1, 'index',
+000205b0: 2027 636f 6c75 6d6e 7327 7d20 2864 6566   'columns'} (def
+000205c0: 6175 6c74 2030 290a 2020 2020 2020 2020  ault 0).        
+000205d0: 2020 2020 3020 6f72 2027 696e 6465 7827      0 or 'index'
+000205e0: 2066 6f72 2072 6f77 2d77 6973 652c 2031   for row-wise, 1
+000205f0: 206f 7220 2763 6f6c 756d 6e73 2720 666f   or 'columns' fo
+00020600: 7220 636f 6c75 6d6e 2d77 6973 650a 2020  r column-wise.  
+00020610: 2020 2020 2020 6d65 7468 6f64 203a 207b        method : {
+00020620: 2764 6566 6175 6c74 272c 2027 7464 6967  'default', 'tdig
+00020630: 6573 7427 2c20 2764 6173 6b27 7d2c 206f  est', 'dask'}, o
+00020640: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
+00020650: 2020 2020 5768 6174 206d 6574 686f 6420      What method 
+00020660: 746f 2075 7365 2e20 4279 2064 6566 6175  to use. By defau
+00020670: 6c74 2077 696c 6c20 7573 6520 6461 736b  lt will use dask
+00020680: 2773 2069 6e74 6572 6e61 6c20 6375 7374  's internal cust
+00020690: 6f6d 0a20 2020 2020 2020 2020 2020 2061  om.            a
+000206a0: 6c67 6f72 6974 686d 2028 6060 2764 6173  lgorithm (``'das
+000206b0: 6b27 6060 292e 2020 4966 2073 6574 2074  k'``).  If set t
+000206c0: 6f20 6060 2774 6469 6765 7374 2760 6020  o ``'tdigest'`` 
+000206d0: 7769 6c6c 2075 7365 2074 6469 6765 7374  will use tdigest
+000206e0: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+000206f0: 2066 6c6f 6174 7320 616e 6420 696e 7473   floats and ints
+00020700: 2061 6e64 2066 616c 6c62 6163 6b20 746f   and fallback to
+00020710: 2074 6865 2060 6027 6461 736b 2760 6020   the ``'dask'`` 
+00020720: 6f74 6865 7277 6973 652e 0a20 2020 2020  otherwise..     
+00020730: 2020 2022 2222 0a20 2020 2020 2020 2061     """.        a
+00020740: 6c6c 6f77 6564 5f6d 6574 686f 6473 203d  llowed_methods =
+00020750: 205b 2264 6566 6175 6c74 222c 2022 6461   ["default", "da
+00020760: 736b 222c 2022 7464 6967 6573 7422 5d0a  sk", "tdigest"].
+00020770: 2020 2020 2020 2020 6966 206d 6574 686f          if metho
+00020780: 6420 6e6f 7420 696e 2061 6c6c 6f77 6564  d not in allowed
+00020790: 5f6d 6574 686f 6473 3a0a 2020 2020 2020  _methods:.      
+000207a0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+000207b0: 6545 7272 6f72 2822 6d65 7468 6f64 2063  eError("method c
+000207c0: 616e 206f 6e6c 7920 6265 2027 6465 6661  an only be 'defa
+000207d0: 756c 7427 2c20 2764 6173 6b27 206f 7220  ult', 'dask' or 
+000207e0: 2774 6469 6765 7374 2722 290a 2020 2020  'tdigest'").    
+000207f0: 2020 2020 6d65 7461 203d 206d 616b 655f      meta = make_
+00020800: 6d65 7461 280a 2020 2020 2020 2020 2020  meta(.          
+00020810: 2020 6d65 7461 5f6e 6f6e 656d 7074 7928    meta_nonempty(
+00020820: 7365 6c66 2e5f 6d65 7461 292e 7175 616e  self._meta).quan
+00020830: 7469 6c65 280a 2020 2020 2020 2020 2020  tile(.          
+00020840: 2020 2020 2020 713d 712c 206e 756d 6572        q=q, numer
+00020850: 6963 5f6f 6e6c 793d 6e75 6d65 7269 635f  ic_only=numeric_
+00020860: 6f6e 6c79 2c20 6178 6973 3d61 7869 730a  only, axis=axis.
+00020870: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00020880: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+00020890: 2069 6620 6178 6973 203d 3d20 313a 0a20   if axis == 1:. 
+000208a0: 2020 2020 2020 2020 2020 2069 6620 6973             if is
+000208b0: 696e 7374 616e 6365 2871 2c20 6c69 7374  instance(q, list
+000208c0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+000208d0: 2020 2023 204e 6f74 2073 7570 706f 7274     # Not support
+000208e0: 6564 2c20 7468 6520 7265 7375 6c74 2077  ed, the result w
+000208f0: 696c 6c20 6861 7665 2063 7572 7265 6e74  ill have current
+00020900: 2069 6e64 6578 2061 7320 636f 6c75 6d6e   index as column
+00020910: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
+00020920: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+00020930: 6f72 2822 2771 2720 6d75 7374 2062 6520  or("'q' must be 
+00020940: 7363 616c 6172 2077 6865 6e20 6178 6973  scalar when axis
+00020950: 3d31 2069 7320 7370 6563 6966 6965 6422  =1 is specified"
+00020960: 290a 0a20 2020 2020 2020 2020 2020 2072  )..            r
+00020970: 6574 7572 6e20 7365 6c66 2e6d 6170 5f70  eturn self.map_p
+00020980: 6172 7469 7469 6f6e 7328 0a20 2020 2020  artitions(.     
+00020990: 2020 2020 2020 2020 2020 204d 2e71 7561             M.qua
+000209a0: 6e74 696c 652c 0a20 2020 2020 2020 2020  ntile,.         
+000209b0: 2020 2020 2020 2071 2c0a 2020 2020 2020         q,.      
+000209c0: 2020 2020 2020 2020 2020 6178 6973 2c0a            axis,.
+000209d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000209e0: 656e 666f 7263 655f 6d65 7461 6461 7461  enforce_metadata
+000209f0: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
+00020a00: 2020 2020 2020 2020 6d65 7461 3d6d 6574          meta=met
+00020a10: 612c 0a20 2020 2020 2020 2020 2020 2020  a,.             
+00020a20: 2020 206e 756d 6572 6963 5f6f 6e6c 793d     numeric_only=
+00020a30: 6e75 6d65 7269 635f 6f6e 6c79 2c0a 2020  numeric_only,.  
+00020a40: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+00020a50: 2020 2020 2069 6620 6e75 6d65 7269 635f       if numeric_
+00020a60: 6f6e 6c79 3a0a 2020 2020 2020 2020 2020  only:.          
+00020a70: 2020 6672 616d 6520 3d20 7365 6c66 2e73    frame = self.s
+00020a80: 656c 6563 745f 6474 7970 6573 280a 2020  elect_dtypes(.  
+00020a90: 2020 2020 2020 2020 2020 2020 2020 226e                "n
+00020aa0: 756d 6265 7222 2c20 6578 636c 7564 653d  umber", exclude=
+00020ab0: 5b6e 702e 7469 6d65 6465 6c74 6136 342c  [np.timedelta64,
+00020ac0: 206e 702e 6461 7465 7469 6d65 3634 5d0a   np.datetime64].
+00020ad0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00020ae0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00020af0: 2020 2020 2020 2020 6672 616d 6520 3d20          frame = 
+00020b00: 7365 6c66 0a0a 2020 2020 2020 2020 636f  self..        co
+00020b10: 6c6c 6563 7469 6f6e 7320 3d20 5b5d 0a20  llections = []. 
+00020b20: 2020 2020 2020 2066 6f72 205f 2c20 636f         for _, co
+00020b30: 6c20 696e 2066 7261 6d65 2e69 7465 6d73  l in frame.items
+00020b40: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
+00020b50: 636f 6c6c 6563 7469 6f6e 732e 6170 7065  collections.appe
+00020b60: 6e64 2863 6f6c 2e71 7561 6e74 696c 6528  nd(col.quantile(
+00020b70: 713d 712c 206d 6574 686f 643d 6d65 7468  q=q, method=meth
+00020b80: 6f64 2929 0a0a 2020 2020 2020 2020 6966  od))..        if
+00020b90: 206c 656e 2863 6f6c 6c65 6374 696f 6e73   len(collections
+00020ba0: 2920 3e20 3020 616e 6420 6973 696e 7374  ) > 0 and isinst
+00020bb0: 616e 6365 2863 6f6c 6c65 6374 696f 6e73  ance(collections
+00020bc0: 5b30 5d2c 2053 6361 6c61 7229 3a0a 2020  [0], Scalar):.  
+00020bd0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00020be0: 205f 6672 6f6d 5f73 6361 6c61 7273 2863   _from_scalars(c
+00020bf0: 6f6c 6c65 6374 696f 6e73 2c20 6d65 7461  ollections, meta
+00020c00: 2c20 6672 616d 652e 6578 7072 2e63 6f6c  , frame.expr.col
+00020c10: 756d 6e73 290a 0a20 2020 2020 2020 2072  umns)..        r
+00020c20: 6574 7572 6e20 636f 6e63 6174 2863 6f6c  eturn concat(col
+00020c30: 6c65 6374 696f 6e73 2c20 6178 6973 3d31  lections, axis=1
+00020c40: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
+00020c50: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
+00020c60: 6529 0a20 2020 2064 6566 206d 6564 6961  e).    def media
+00020c70: 6e28 7365 6c66 2c20 6178 6973 3d30 2c20  n(self, axis=0, 
+00020c80: 6e75 6d65 7269 635f 6f6e 6c79 3d46 616c  numeric_only=Fal
+00020c90: 7365 293a 0a20 2020 2020 2020 2069 6620  se):.        if 
+00020ca0: 6178 6973 203d 3d20 3120 6f72 2073 656c  axis == 1 or sel
+00020cb0: 662e 6e70 6172 7469 7469 6f6e 7320 3d3d  f.npartitions ==
+00020cc0: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
+00020cd0: 7265 7475 726e 2073 656c 662e 6d65 6469  return self.medi
+00020ce0: 616e 5f61 7070 726f 7869 6d61 7465 2861  an_approximate(a
+00020cf0: 7869 733d 6178 6973 2c20 6e75 6d65 7269  xis=axis, numeri
+00020d00: 635f 6f6e 6c79 3d6e 756d 6572 6963 5f6f  c_only=numeric_o
+00020d10: 6e6c 7929 0a20 2020 2020 2020 2072 6169  nly).        rai
+00020d20: 7365 204e 6f74 496d 706c 656d 656e 7465  se NotImplemente
+00020d30: 6445 7272 6f72 280a 2020 2020 2020 2020  dError(.        
+00020d40: 2020 2020 2244 6173 6b20 646f 6573 6e27      "Dask doesn'
+00020d50: 7420 696d 706c 656d 656e 7420 616e 2065  t implement an e
+00020d60: 7861 6374 206d 6564 6961 6e20 696e 2061  xact median in a
+00020d70: 6c6c 2063 6173 6573 2061 7320 7468 6973  ll cases as this
+00020d80: 2069 7320 6861 7264 2074 6f20 646f 2069   is hard to do i
+00020d90: 6e20 7061 7261 6c6c 656c 2e20 220a 2020  n parallel. ".  
+00020da0: 2020 2020 2020 2020 2020 2253 6565 2074            "See t
+00020db0: 6865 2060 6d65 6469 616e 5f61 7070 726f  he `median_appro
+00020dc0: 7869 6d61 7465 6020 6d65 7468 6f64 2069  ximate` method i
+00020dd0: 6e73 7465 6164 2c20 7768 6963 6820 7573  nstead, which us
+00020de0: 6573 2061 6e20 6170 7072 6f78 696d 6174  es an approximat
+00020df0: 6520 616c 676f 7269 7468 6d2e 220a 2020  e algorithm.".  
+00020e00: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
+00020e10: 206d 6564 6961 6e5f 6170 7072 6f78 696d   median_approxim
+00020e20: 6174 6528 7365 6c66 2c20 6178 6973 3d30  ate(self, axis=0
+00020e30: 2c20 6d65 7468 6f64 3d22 6465 6661 756c  , method="defaul
+00020e40: 7422 2c20 6e75 6d65 7269 635f 6f6e 6c79  t", numeric_only
+00020e50: 3d46 616c 7365 293a 0a20 2020 2020 2020  =False):.       
+00020e60: 2022 2222 5265 7475 726e 2074 6865 2061   """Return the a
+00020e70: 7070 726f 7869 6d61 7465 206d 6564 6961  pproximate media
+00020e80: 6e20 6f66 2074 6865 2076 616c 7565 7320  n of the values 
+00020e90: 6f76 6572 2074 6865 2072 6571 7565 7374  over the request
+00020ea0: 6564 2061 7869 732e 0a0a 2020 2020 2020  ed axis...      
+00020eb0: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
+00020ec0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
+00020ed0: 2020 2020 2020 2020 6178 6973 203a 207b          axis : {
+00020ee0: 302c 2031 2c20 2269 6e64 6578 222c 2022  0, 1, "index", "
+00020ef0: 636f 6c75 6d6e 7322 7d20 2864 6566 6175  columns"} (defau
+00020f00: 6c74 2030 290a 2020 2020 2020 2020 2020  lt 0).          
+00020f10: 2020 3020 6f72 2060 6022 696e 6465 7822    0 or ``"index"
+00020f20: 6060 2066 6f72 2072 6f77 2d77 6973 652c  `` for row-wise,
+00020f30: 2031 206f 7220 6060 2263 6f6c 756d 6e73   1 or ``"columns
+00020f40: 2260 6020 666f 7220 636f 6c75 6d6e 2d77  "`` for column-w
+00020f50: 6973 650a 2020 2020 2020 2020 6d65 7468  ise.        meth
+00020f60: 6f64 203a 207b 2764 6566 6175 6c74 272c  od : {'default',
+00020f70: 2027 7464 6967 6573 7427 2c20 2764 6173   'tdigest', 'das
+00020f80: 6b27 7d2c 206f 7074 696f 6e61 6c0a 2020  k'}, optional.  
+00020f90: 2020 2020 2020 2020 2020 5768 6174 206d            What m
+00020fa0: 6574 686f 6420 746f 2075 7365 2e20 4279  ethod to use. By
+00020fb0: 2064 6566 6175 6c74 2077 696c 6c20 7573   default will us
+00020fc0: 6520 4461 736b 2773 2069 6e74 6572 6e61  e Dask's interna
+00020fd0: 6c20 6375 7374 6f6d 0a20 2020 2020 2020  l custom.       
+00020fe0: 2020 2020 2061 6c67 6f72 6974 686d 2028       algorithm (
+00020ff0: 6060 2264 6173 6b22 6060 292e 2020 4966  ``"dask"``).  If
+00021000: 2073 6574 2074 6f20 6060 2274 6469 6765   set to ``"tdige
+00021010: 7374 2260 6020 7769 6c6c 2075 7365 2074  st"`` will use t
+00021020: 6469 6765 7374 0a20 2020 2020 2020 2020  digest.         
+00021030: 2020 2066 6f72 2066 6c6f 6174 7320 616e     for floats an
+00021040: 6420 696e 7473 2061 6e64 2066 616c 6c62  d ints and fallb
+00021050: 6163 6b20 746f 2074 6865 2060 6022 6461  ack to the ``"da
+00021060: 736b 2260 6020 6f74 6865 7277 6973 652e  sk"`` otherwise.
+00021070: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00021080: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00021090: 2e71 7561 6e74 696c 6528 0a20 2020 2020  .quantile(.     
+000210a0: 2020 2020 2020 2061 7869 733d 6178 6973         axis=axis
+000210b0: 2c20 6d65 7468 6f64 3d6d 6574 686f 642c  , method=method,
+000210c0: 206e 756d 6572 6963 5f6f 6e6c 793d 6e75   numeric_only=nu
+000210d0: 6d65 7269 635f 6f6e 6c79 0a20 2020 2020  meric_only.     
+000210e0: 2020 2029 2e72 656e 616d 6528 4e6f 6e65     ).rename(None
+000210f0: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
+00021100: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
+00021110: 6529 0a20 2020 2064 6566 2064 6573 6372  e).    def descr
+00021120: 6962 6528 0a20 2020 2020 2020 2073 656c  ibe(.        sel
+00021130: 662c 0a20 2020 2020 2020 2073 706c 6974  f,.        split
+00021140: 5f65 7665 7279 3d46 616c 7365 2c0a 2020  _every=False,.  
+00021150: 2020 2020 2020 7065 7263 656e 7469 6c65        percentile
+00021160: 733d 4e6f 6e65 2c0a 2020 2020 2020 2020  s=None,.        
+00021170: 7065 7263 656e 7469 6c65 735f 6d65 7468  percentiles_meth
+00021180: 6f64 3d22 6465 6661 756c 7422 2c0a 2020  od="default",.  
+00021190: 2020 2020 2020 696e 636c 7564 653d 4e6f        include=No
+000211a0: 6e65 2c0a 2020 2020 2020 2020 6578 636c  ne,.        excl
+000211b0: 7564 653d 4e6f 6e65 2c0a 2020 2020 293a  ude=None,.    ):
+000211c0: 0a20 2020 2020 2020 2023 2054 4f44 4f3a  .        # TODO:
+000211d0: 2064 7570 6c69 6361 7465 6420 636f 6c75   duplicated colu
+000211e0: 6d6e 730a 2020 2020 2020 2020 6966 2069  mns.        if i
+000211f0: 6e63 6c75 6465 2069 7320 4e6f 6e65 2061  nclude is None a
+00021200: 6e64 2065 7863 6c75 6465 2069 7320 4e6f  nd exclude is No
+00021210: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00021220: 5f69 6e63 6c75 6465 203d 205b 6e70 2e6e  _include = [np.n
+00021230: 756d 6265 722c 206e 702e 7469 6d65 6465  umber, np.timede
+00021240: 6c74 6136 342c 206e 702e 6461 7465 7469  lta64, np.dateti
+00021250: 6d65 3634 5d0a 2020 2020 2020 2020 2020  me64].          
+00021260: 2020 636f 6c75 6d6e 7320 3d20 7365 6c66    columns = self
+00021270: 2e5f 6d65 7461 2e73 656c 6563 745f 6474  ._meta.select_dt
+00021280: 7970 6573 2869 6e63 6c75 6465 3d5f 696e  ypes(include=_in
+00021290: 636c 7564 6529 2e63 6f6c 756d 6e73 0a20  clude).columns. 
+000212a0: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
+000212b0: 6e28 636f 6c75 6d6e 7329 203d 3d20 303a  n(columns) == 0:
+000212c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000212d0: 2063 6f6c 756d 6e73 203d 2073 656c 662e   columns = self.
+000212e0: 5f6d 6574 612e 636f 6c75 6d6e 730a 2020  _meta.columns.  
+000212f0: 2020 2020 2020 656c 6966 2069 6e63 6c75        elif inclu
+00021300: 6465 203d 3d20 2261 6c6c 223a 0a20 2020  de == "all":.   
+00021310: 2020 2020 2020 2020 2069 6620 6578 636c           if excl
+00021320: 7564 6520 6973 206e 6f74 204e 6f6e 653a  ude is not None:
+00021330: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00021340: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+00021350: 7228 2265 7863 6c75 6465 206d 7573 7420  r("exclude must 
+00021360: 6265 204e 6f6e 6520 7768 656e 2069 6e63  be None when inc
+00021370: 6c75 6465 2069 7320 2761 6c6c 2722 290a  lude is 'all'").
+00021380: 2020 2020 2020 2020 2020 2020 636f 6c75              colu
+00021390: 6d6e 7320 3d20 7365 6c66 2e5f 6d65 7461  mns = self._meta
+000213a0: 2e63 6f6c 756d 6e73 0a20 2020 2020 2020  .columns.       
+000213b0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+000213c0: 2020 2063 6f6c 756d 6e73 203d 2073 656c     columns = sel
+000213d0: 662e 5f6d 6574 612e 7365 6c65 6374 5f64  f._meta.select_d
+000213e0: 7479 7065 7328 696e 636c 7564 653d 696e  types(include=in
+000213f0: 636c 7564 652c 2065 7863 6c75 6465 3d65  clude, exclude=e
+00021400: 7863 6c75 6465 292e 636f 6c75 6d6e 730a  xclude).columns.
+00021410: 0a20 2020 2020 2020 2073 7461 7473 203d  .        stats =
+00021420: 205b 0a20 2020 2020 2020 2020 2020 2073   [.            s
+00021430: 656c 665b 636f 6c5d 2e64 6573 6372 6962  elf[col].describ
+00021440: 6528 0a20 2020 2020 2020 2020 2020 2020  e(.             
+00021450: 2020 2073 706c 6974 5f65 7665 7279 3d73     split_every=s
+00021460: 706c 6974 5f65 7665 7279 2c0a 2020 2020  plit_every,.    
+00021470: 2020 2020 2020 2020 2020 2020 7065 7263              perc
+00021480: 656e 7469 6c65 733d 7065 7263 656e 7469  entiles=percenti
+00021490: 6c65 732c 0a20 2020 2020 2020 2020 2020  les,.           
+000214a0: 2020 2020 2070 6572 6365 6e74 696c 6573       percentiles
+000214b0: 5f6d 6574 686f 643d 7065 7263 656e 7469  _method=percenti
+000214c0: 6c65 735f 6d65 7468 6f64 2c0a 2020 2020  les_method,.    
+000214d0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+000214e0: 2020 2020 2020 666f 7220 636f 6c20 696e        for col in
+000214f0: 2063 6f6c 756d 6e73 0a20 2020 2020 2020   columns.       
+00021500: 205d 0a20 2020 2020 2020 2072 6574 7572   ].        retur
+00021510: 6e20 636f 6e63 6174 2873 7461 7473 2c20  n concat(stats, 
+00021520: 6178 6973 3d31 290a 0a20 2020 2040 6465  axis=1)..    @de
+00021530: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
+00021540: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
+00021550: 2070 6f70 2873 656c 662c 2069 7465 6d29   pop(self, item)
+00021560: 3a0a 2020 2020 2020 2020 6f75 7420 3d20  :.        out = 
+00021570: 7365 6c66 5b69 7465 6d5d 0a20 2020 2020  self[item].     
+00021580: 2020 2073 656c 662e 5f65 7870 7220 3d20     self._expr = 
+00021590: 6578 7072 2e44 726f 7028 7365 6c66 2c20  expr.Drop(self, 
+000215a0: 636f 6c75 6d6e 733d 5b69 7465 6d5d 290a  columns=[item]).
+000215b0: 2020 2020 2020 2020 7265 7475 726e 206f          return o
+000215c0: 7574 0a0a 2020 2020 6465 6620 696e 666f  ut..    def info
+000215d0: 2873 656c 662c 2062 7566 3d4e 6f6e 652c  (self, buf=None,
+000215e0: 2076 6572 626f 7365 3d46 616c 7365 2c20   verbose=False, 
+000215f0: 6d65 6d6f 7279 5f75 7361 6765 3d46 616c  memory_usage=Fal
+00021600: 7365 293a 0a20 2020 2020 2020 2022 2222  se):.        """
+00021610: 0a20 2020 2020 2020 2043 6f6e 6369 7365  .        Concise
+00021620: 2073 756d 6d61 7279 206f 6620 6120 4461   summary of a Da
+00021630: 736b 2044 6174 6146 7261 6d65 0a20 2020  sk DataFrame.   
+00021640: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00021650: 2069 6620 6275 6620 6973 204e 6f6e 653a   if buf is None:
+00021660: 0a20 2020 2020 2020 2020 2020 2069 6d70  .            imp
+00021670: 6f72 7420 7379 730a 0a20 2020 2020 2020  ort sys..       
+00021680: 2020 2020 2062 7566 203d 2073 7973 2e73       buf = sys.s
+00021690: 7464 6f75 740a 2020 2020 2020 2020 6c69  tdout.        li
+000216a0: 6e65 7320 3d20 5b73 7472 2874 7970 6528  nes = [str(type(
+000216b0: 7365 6c66 2929 2e72 6570 6c61 6365 2822  self)).replace("
+000216c0: 2e5f 636f 6c6c 6563 7469 6f6e 222c 2022  ._collection", "
+000216d0: 2229 5d0a 0a20 2020 2020 2020 2069 6620  ")]..        if 
+000216e0: 6c65 6e28 7365 6c66 2e63 6f6c 756d 6e73  len(self.columns
+000216f0: 2920 3d3d 2030 3a0a 2020 2020 2020 2020  ) == 0:.        
+00021700: 2020 2020 6c69 6e65 732e 6170 7065 6e64      lines.append
+00021710: 2866 227b 7479 7065 2873 656c 662e 696e  (f"{type(self.in
+00021720: 6465 782e 5f6d 6574 6129 2e5f 5f6e 616d  dex._meta).__nam
+00021730: 655f 5f7d 3a20 3020 656e 7472 6965 7322  e__}: 0 entries"
+00021740: 290a 2020 2020 2020 2020 2020 2020 6c69  ).            li
+00021750: 6e65 732e 6170 7065 6e64 2866 2245 6d70  nes.append(f"Emp
+00021760: 7479 207b 7479 7065 2873 656c 6629 2e5f  ty {type(self)._
+00021770: 5f6e 616d 655f 5f7d 2229 0a20 2020 2020  _name__}").     
+00021780: 2020 2020 2020 2070 7574 5f6c 696e 6573         put_lines
+00021790: 2862 7566 2c20 6c69 6e65 7329 0a20 2020  (buf, lines).   
+000217a0: 2020 2020 2020 2020 2072 6574 7572 6e0a           return.
+000217b0: 0a20 2020 2020 2020 2023 2047 726f 7570  .        # Group
+000217c0: 2061 6e64 2065 7865 6375 7465 2074 6865   and execute the
+000217d0: 2072 6571 7569 7265 6420 636f 6d70 7574   required comput
+000217e0: 6174 696f 6e73 0a20 2020 2020 2020 2063  ations.        c
+000217f0: 6f6d 7075 7461 7469 6f6e 7320 3d20 7b7d  omputations = {}
+00021800: 0a20 2020 2020 2020 2069 6620 7665 7262  .        if verb
+00021810: 6f73 653a 0a20 2020 2020 2020 2020 2020  ose:.           
+00021820: 2063 6f6d 7075 7461 7469 6f6e 732e 7570   computations.up
+00021830: 6461 7465 287b 2269 6e64 6578 223a 2073  date({"index": s
+00021840: 656c 662e 696e 6465 782c 2022 636f 756e  elf.index, "coun
+00021850: 7422 3a20 7365 6c66 2e63 6f75 6e74 2829  t": self.count()
+00021860: 7d29 0a20 2020 2020 2020 2069 6620 6d65  }).        if me
+00021870: 6d6f 7279 5f75 7361 6765 3a0a 2020 2020  mory_usage:.    
+00021880: 2020 2020 2020 2020 636f 6d70 7574 6174          computat
+00021890: 696f 6e73 5b22 6d65 6d6f 7279 5f75 7361  ions["memory_usa
+000218a0: 6765 225d 203d 2073 656c 662e 6d65 6d6f  ge"] = self.memo
+000218b0: 7279 5f75 7361 6765 2864 6565 703d 5472  ry_usage(deep=Tr
+000218c0: 7565 2c20 696e 6465 783d 5472 7565 290a  ue, index=True).
+000218d0: 0a20 2020 2020 2020 2063 6f6d 7075 7461  .        computa
+000218e0: 7469 6f6e 7320 3d20 6469 6374 287a 6970  tions = dict(zip
+000218f0: 2863 6f6d 7075 7461 7469 6f6e 732e 6b65  (computations.ke
+00021900: 7973 2829 2c20 636f 6d70 7574 6528 2a63  ys(), compute(*c
+00021910: 6f6d 7075 7461 7469 6f6e 732e 7661 6c75  omputations.valu
+00021920: 6573 2829 2929 290a 0a20 2020 2020 2020  es())))..       
+00021930: 2069 6620 7665 7262 6f73 653a 0a20 2020   if verbose:.   
+00021940: 2020 2020 2020 2020 2069 6d70 6f72 7420           import 
+00021950: 7465 7874 7772 6170 0a0a 2020 2020 2020  textwrap..      
+00021960: 2020 2020 2020 696e 6465 7820 3d20 636f        index = co
+00021970: 6d70 7574 6174 696f 6e73 5b22 696e 6465  mputations["inde
+00021980: 7822 5d0a 2020 2020 2020 2020 2020 2020  x"].            
+00021990: 636f 756e 7473 203d 2063 6f6d 7075 7461  counts = computa
+000219a0: 7469 6f6e 735b 2263 6f75 6e74 225d 0a20  tions["count"]. 
+000219b0: 2020 2020 2020 2020 2020 206c 696e 6573             lines
+000219c0: 2e61 7070 656e 6428 696e 6465 785f 7375  .append(index_su
+000219d0: 6d6d 6172 7928 696e 6465 7829 290a 2020  mmary(index)).  
+000219e0: 2020 2020 2020 2020 2020 6c69 6e65 732e            lines.
+000219f0: 6170 7065 6e64 2866 2244 6174 6120 636f  append(f"Data co
+00021a00: 6c75 6d6e 7320 2874 6f74 616c 207b 6c65  lumns (total {le
+00021a10: 6e28 7365 6c66 2e63 6f6c 756d 6e73 297d  n(self.columns)}
+00021a20: 2063 6f6c 756d 6e73 293a 2229 0a0a 2020   columns):")..  
+00021a30: 2020 2020 2020 2020 2020 6672 6f6d 2070            from p
+00021a40: 616e 6461 732e 696f 2e66 6f72 6d61 7473  andas.io.formats
+00021a50: 2e70 7269 6e74 696e 6720 696d 706f 7274  .printing import
+00021a60: 2070 7072 696e 745f 7468 696e 670a 0a20   pprint_thing.. 
+00021a70: 2020 2020 2020 2020 2020 2073 7061 6365             space
+00021a80: 203d 206d 6178 286c 656e 2870 7072 696e   = max(len(pprin
+00021a90: 745f 7468 696e 6728 6b29 2920 666f 7220  t_thing(k)) for 
+00021aa0: 6b20 696e 2073 656c 662e 636f 6c75 6d6e  k in self.column
+00021ab0: 7329 202b 2031 0a20 2020 2020 2020 2020  s) + 1.         
+00021ac0: 2020 2063 6f6c 756d 6e5f 7769 6474 6820     column_width 
+00021ad0: 3d20 6d61 7828 7370 6163 652c 2037 290a  = max(space, 7).
+00021ae0: 0a20 2020 2020 2020 2020 2020 2068 6561  .            hea
+00021af0: 6465 7220 3d20 280a 2020 2020 2020 2020  der = (.        
+00021b00: 2020 2020 2020 2020 7465 7874 7772 6170          textwrap
+00021b10: 2e64 6564 656e 7428 0a20 2020 2020 2020  .dedent(.       
+00021b20: 2020 2020 2020 2020 2020 2020 2022 2222               """
+00021b30: 5c0a 2020 2020 2020 2020 2020 2020 2023  \.             #
+00021b40: 2020 207b 7b63 6f6c 756d 6e3a 3c7b 636f     {{column:<{co
+00021b50: 6c75 6d6e 5f77 6964 7468 7d7d 7d20 4e6f  lumn_width}}} No
+00021b60: 6e2d 4e75 6c6c 2043 6f75 6e74 2020 4474  n-Null Count  Dt
+00021b70: 7970 650a 2020 2020 2020 2020 2020 2020  ype.            
+00021b80: 2d2d 2d20 207b 7b75 6e64 6572 6c3a 3c7b  ---  {{underl:<{
+00021b90: 636f 6c75 6d6e 5f77 6964 7468 7d7d 7d20  column_width}}} 
+00021ba0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2020  --------------  
+00021bb0: 2d2d 2d2d 2d22 2222 0a20 2020 2020 2020  -----""".       
+00021bc0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00021bd0: 2020 2020 2020 2020 2020 202e 666f 726d             .form
+00021be0: 6174 2863 6f6c 756d 6e5f 7769 6474 683d  at(column_width=
+00021bf0: 636f 6c75 6d6e 5f77 6964 7468 290a 2020  column_width).  
+00021c00: 2020 2020 2020 2020 2020 2020 2020 2e66                .f
+00021c10: 6f72 6d61 7428 636f 6c75 6d6e 3d22 436f  ormat(column="Co
+00021c20: 6c75 6d6e 222c 2075 6e64 6572 6c3d 222d  lumn", underl="-
+00021c30: 2d2d 2d2d 2d22 290a 2020 2020 2020 2020  -----").        
+00021c40: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+00021c50: 2020 636f 6c75 6d6e 5f74 656d 706c 6174    column_templat
+00021c60: 6520 3d20 7465 7874 7772 6170 2e64 6564  e = textwrap.ded
+00021c70: 656e 7428 0a20 2020 2020 2020 2020 2020  ent(.           
+00021c80: 2020 2020 2022 2222 5c0a 2020 2020 2020       """\.      
+00021c90: 2020 2020 2020 7b7b 693a 5e33 7d7d 2020        {{i:^3}}  
+00021ca0: 7b7b 6e61 6d65 3a3c 7b63 6f6c 756d 6e5f  {{name:<{column_
+00021cb0: 7769 6474 687d 7d7d 207b 7b63 6f75 6e74  width}}} {{count
+00021cc0: 7d7d 206e 6f6e 2d6e 756c 6c20 2020 2020  }} non-null     
+00021cd0: 207b 7b64 7479 7065 7d7d 2222 222e 666f   {{dtype}}""".fo
+00021ce0: 726d 6174 280a 2020 2020 2020 2020 2020  rmat(.          
+00021cf0: 2020 2020 2020 2020 2020 636f 6c75 6d6e            column
+00021d00: 5f77 6964 7468 3d63 6f6c 756d 6e5f 7769  _width=column_wi
+00021d10: 6474 680a 2020 2020 2020 2020 2020 2020  dth.            
+00021d20: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+00021d30: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+00021d40: 636f 6c75 6d6e 5f69 6e66 6f20 3d20 5b0a  column_info = [.
+00021d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021d60: 636f 6c75 6d6e 5f74 656d 706c 6174 652e  column_template.
+00021d70: 666f 726d 6174 280a 2020 2020 2020 2020  format(.        
+00021d80: 2020 2020 2020 2020 2020 2020 693d 7070              i=pp
+00021d90: 7269 6e74 5f74 6869 6e67 2869 292c 0a20  rint_thing(i),. 
+00021da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021db0: 2020 206e 616d 653d 7070 7269 6e74 5f74     name=pprint_t
+00021dc0: 6869 6e67 286e 616d 6529 2c0a 2020 2020  hing(name),.    
+00021dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021de0: 636f 756e 743d 7070 7269 6e74 5f74 6869  count=pprint_thi
+00021df0: 6e67 2863 6f75 6e74 292c 0a20 2020 2020  ng(count),.     
+00021e00: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+00021e10: 7479 7065 3d70 7072 696e 745f 7468 696e  type=pprint_thin
+00021e20: 6728 6474 7970 6529 2c0a 2020 2020 2020  g(dtype),.      
+00021e30: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00021e40: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00021e50: 692c 2028 6e61 6d65 2c20 636f 756e 742c  i, (name, count,
+00021e60: 2064 7479 7065 2920 696e 2065 6e75 6d65   dtype) in enume
+00021e70: 7261 7465 280a 2020 2020 2020 2020 2020  rate(.          
+00021e80: 2020 2020 2020 2020 2020 2320 4e4f 5445            # NOTE
+00021e90: 3a20 5573 6520 6063 6f75 6e74 732e 7661  : Use `counts.va
+00021ea0: 6c75 6573 6020 666f 7220 6375 6466 2073  lues` for cudf s
+00021eb0: 7570 706f 7274 0a20 2020 2020 2020 2020  upport.         
+00021ec0: 2020 2020 2020 2020 2020 207a 6970 2873             zip(s
+00021ed0: 656c 662e 636f 6c75 6d6e 732c 2063 6f75  elf.columns, cou
+00021ee0: 6e74 732e 7661 6c75 6573 2c20 7365 6c66  nts.values, self
+00021ef0: 2e64 7479 7065 7329 0a20 2020 2020 2020  .dtypes).       
+00021f00: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00021f10: 2020 2020 2020 205d 0a20 2020 2020 2020         ].       
+00021f20: 2020 2020 206c 696e 6573 2e65 7874 656e       lines.exten
+00021f30: 6428 6865 6164 6572 2e73 706c 6974 2822  d(header.split("
+00021f40: 5c6e 2229 290a 2020 2020 2020 2020 656c  \n")).        el
+00021f50: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00021f60: 636f 6c75 6d6e 5f69 6e66 6f20 3d20 5b69  column_info = [i
+00021f70: 6e64 6578 5f73 756d 6d61 7279 2873 656c  ndex_summary(sel
+00021f80: 662e 636f 6c75 6d6e 732c 206e 616d 653d  f.columns, name=
+00021f90: 2243 6f6c 756d 6e73 2229 5d0a 0a20 2020  "Columns")]..   
+00021fa0: 2020 2020 206c 696e 6573 2e65 7874 656e       lines.exten
+00021fb0: 6428 636f 6c75 6d6e 5f69 6e66 6f29 0a20  d(column_info). 
+00021fc0: 2020 2020 2020 2064 7479 7065 5f63 6f75         dtype_cou
+00021fd0: 6e74 7320 3d20 5b0a 2020 2020 2020 2020  nts = [.        
+00021fe0: 2020 2020 2225 7328 2564 2922 2025 206b      "%s(%d)" % k
+00021ff0: 2066 6f72 206b 2069 6e20 736f 7274 6564   for k in sorted
+00022000: 2873 656c 662e 6474 7970 6573 2e76 616c  (self.dtypes.val
+00022010: 7565 5f63 6f75 6e74 7328 292e 6974 656d  ue_counts().item
+00022020: 7328 292c 206b 6579 3d73 7472 290a 2020  s(), key=str).  
+00022030: 2020 2020 2020 5d0a 2020 2020 2020 2020        ].        
+00022040: 6c69 6e65 732e 6170 7065 6e64 2822 6474  lines.append("dt
+00022050: 7970 6573 3a20 7b7d 222e 666f 726d 6174  ypes: {}".format
+00022060: 2822 2c20 222e 6a6f 696e 2864 7479 7065  (", ".join(dtype
+00022070: 5f63 6f75 6e74 7329 2929 0a0a 2020 2020  _counts)))..    
+00022080: 2020 2020 6966 206d 656d 6f72 795f 7573      if memory_us
+00022090: 6167 653a 0a20 2020 2020 2020 2020 2020  age:.           
+000220a0: 206d 656d 6f72 795f 696e 7420 3d20 636f   memory_int = co
+000220b0: 6d70 7574 6174 696f 6e73 5b22 6d65 6d6f  mputations["memo
+000220c0: 7279 5f75 7361 6765 225d 2e73 756d 2829  ry_usage"].sum()
+000220d0: 0a20 2020 2020 2020 2020 2020 206c 696e  .            lin
+000220e0: 6573 2e61 7070 656e 6428 6622 6d65 6d6f  es.append(f"memo
+000220f0: 7279 2075 7361 6765 3a20 7b6d 656d 6f72  ry usage: {memor
+00022100: 795f 7265 7072 286d 656d 6f72 795f 696e  y_repr(memory_in
+00022110: 7429 7d5c 6e22 290a 0a20 2020 2020 2020  t)}\n")..       
+00022120: 2070 7574 5f6c 696e 6573 2862 7566 2c20   put_lines(buf, 
+00022130: 6c69 6e65 7329 0a0a 2020 2020 4064 6572  lines)..    @der
+00022140: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
+00022150: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
+00022160: 636f 7628 7365 6c66 2c20 6d69 6e5f 7065  cov(self, min_pe
+00022170: 7269 6f64 733d 4e6f 6e65 2c20 6e75 6d65  riods=None, nume
+00022180: 7269 635f 6f6e 6c79 3d46 616c 7365 2c20  ric_only=False, 
+00022190: 7370 6c69 745f 6576 6572 793d 4661 6c73  split_every=Fals
+000221a0: 6529 3a0a 2020 2020 2020 2020 7265 7475  e):.        retu
+000221b0: 726e 2073 656c 662e 5f63 6f76 286d 696e  rn self._cov(min
+000221c0: 5f70 6572 696f 6473 2c20 6e75 6d65 7269  _periods, numeri
+000221d0: 635f 6f6e 6c79 2c20 7370 6c69 745f 6576  c_only, split_ev
+000221e0: 6572 7929 0a0a 2020 2020 4064 6572 6976  ery)..    @deriv
+000221f0: 6564 5f66 726f 6d28 7064 2e44 6174 6146  ed_from(pd.DataF
+00022200: 7261 6d65 290a 2020 2020 6465 6620 636f  rame).    def co
+00022210: 7272 280a 2020 2020 2020 2020 7365 6c66  rr(.        self
+00022220: 2c0a 2020 2020 2020 2020 6d65 7468 6f64  ,.        method
+00022230: 3d22 7065 6172 736f 6e22 2c0a 2020 2020  ="pearson",.    
+00022240: 2020 2020 6d69 6e5f 7065 7269 6f64 733d      min_periods=
+00022250: 4e6f 6e65 2c0a 2020 2020 2020 2020 6e75  None,.        nu
+00022260: 6d65 7269 635f 6f6e 6c79 3d46 616c 7365  meric_only=False
+00022270: 2c0a 2020 2020 2020 2020 7370 6c69 745f  ,.        split_
+00022280: 6576 6572 793d 4661 6c73 652c 0a20 2020  every=False,.   
+00022290: 2029 3a0a 2020 2020 2020 2020 7265 7475   ):.        retu
+000222a0: 726e 2073 656c 662e 5f63 6f72 7228 6d65  rn self._corr(me
+000222b0: 7468 6f64 2c20 6d69 6e5f 7065 7269 6f64  thod, min_period
+000222c0: 732c 206e 756d 6572 6963 5f6f 6e6c 792c  s, numeric_only,
+000222d0: 2073 706c 6974 5f65 7665 7279 290a 0a20   split_every).. 
+000222e0: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
+000222f0: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
+00022300: 2020 2064 6566 2074 6f5f 7374 7269 6e67     def to_string
+00022310: 2873 656c 662c 206d 6178 5f72 6f77 733d  (self, max_rows=
+00022320: 3529 3a0a 2020 2020 2020 2020 2320 6f70  5):.        # op
+00022330: 7469 6f6e 5f63 6f6e 7465 7874 2064 6f65  tion_context doe
+00022340: 736e 2774 2061 6666 6563 740a 2020 2020  sn't affect.    
+00022350: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00022360: 5f72 6570 725f 6461 7461 2829 2e74 6f5f  _repr_data().to_
+00022370: 7374 7269 6e67 286d 6178 5f72 6f77 733d  string(max_rows=
+00022380: 6d61 785f 726f 7773 2c20 7368 6f77 5f64  max_rows, show_d
+00022390: 696d 656e 7369 6f6e 733d 4661 6c73 6529  imensions=False)
+000223a0: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
+000223b0: 726f 6d28 7064 2e44 6174 6146 7261 6d65  rom(pd.DataFrame
+000223c0: 290a 2020 2020 6465 6620 746f 5f68 746d  ).    def to_htm
+000223d0: 6c28 7365 6c66 2c20 6d61 785f 726f 7773  l(self, max_rows
+000223e0: 3d35 293a 0a20 2020 2020 2020 2023 2070  =5):.        # p
+000223f0: 642e 5365 7269 6573 2064 6f65 736e 2774  d.Series doesn't
+00022400: 2068 6176 6520 6874 6d6c 2072 6570 720a   have html repr.
+00022410: 2020 2020 2020 2020 6461 7461 203d 2073          data = s
+00022420: 656c 662e 5f72 6570 725f 6461 7461 2829  elf._repr_data()
+00022430: 2e74 6f5f 6874 6d6c 286d 6178 5f72 6f77  .to_html(max_row
+00022440: 733d 6d61 785f 726f 7773 2c20 7368 6f77  s=max_rows, show
+00022450: 5f64 696d 656e 7369 6f6e 733d 4661 6c73  _dimensions=Fals
+00022460: 6529 0a20 2020 2020 2020 206e 5f65 7870  e).        n_exp
+00022470: 7220 3d20 6c65 6e28 7b65 2e5f 6e61 6d65  r = len({e._name
+00022480: 2066 6f72 2065 2069 6e20 7365 6c66 2e77   for e in self.w
+00022490: 616c 6b28 297d 290a 2020 2020 2020 2020  alk()}).        
+000224a0: 7265 7475 726e 2067 6574 5f74 656d 706c  return get_templ
+000224b0: 6174 6528 2264 6174 6166 7261 6d65 2e68  ate("dataframe.h
+000224c0: 746d 6c2e 6a32 2229 2e72 656e 6465 7228  tml.j2").render(
+000224d0: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
+000224e0: 613d 6461 7461 2c0a 2020 2020 2020 2020  a=data,.        
+000224f0: 2020 2020 6e61 6d65 3d73 656c 662e 5f6e      name=self._n
+00022500: 616d 652c 0a20 2020 2020 2020 2020 2020  ame,.           
+00022510: 206c 6179 6572 733d 6d61 7962 655f 706c   layers=maybe_pl
+00022520: 7572 616c 697a 6528 6e5f 6578 7072 2c20  uralize(n_expr, 
+00022530: 2265 7870 7265 7373 696f 6e22 292c 0a20  "expression"),. 
+00022540: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
+00022550: 6620 5f72 6570 725f 6461 7461 2873 656c  f _repr_data(sel
+00022560: 6629 3a0a 2020 2020 2020 2020 6d65 7461  f):.        meta
+00022570: 203d 2073 656c 662e 5f6d 6574 610a 2020   = self._meta.  
+00022580: 2020 2020 2020 696e 6465 7820 3d20 7365        index = se
+00022590: 6c66 2e5f 7265 7072 5f64 6976 6973 696f  lf._repr_divisio
+000225a0: 6e73 0a20 2020 2020 2020 2063 6f6c 7320  ns.        cols 
+000225b0: 3d20 6d65 7461 2e63 6f6c 756d 6e73 0a20  = meta.columns. 
+000225c0: 2020 2020 2020 2069 6620 6c65 6e28 636f         if len(co
+000225d0: 6c73 2920 3d3d 2030 3a0a 2020 2020 2020  ls) == 0:.      
+000225e0: 2020 2020 2020 7365 7269 6573 5f64 6620        series_df 
+000225f0: 3d20 7064 2e44 6174 6146 7261 6d65 285b  = pd.DataFrame([
+00022600: 5b5d 5d20 2a20 6c65 6e28 696e 6465 7829  []] * len(index)
+00022610: 2c20 636f 6c75 6d6e 733d 636f 6c73 2c20  , columns=cols, 
+00022620: 696e 6465 783d 696e 6465 7829 0a20 2020  index=index).   
+00022630: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00022640: 2020 2020 2020 2073 6572 6965 735f 6466         series_df
+00022650: 203d 2070 642e 636f 6e63 6174 280a 2020   = pd.concat(.  
+00022660: 2020 2020 2020 2020 2020 2020 2020 5b5f                [_
+00022670: 7265 7072 5f64 6174 615f 7365 7269 6573  repr_data_series
+00022680: 2873 2c20 696e 6465 783d 696e 6465 7829  (s, index=index)
+00022690: 2066 6f72 205f 2c20 7320 696e 206d 6574   for _, s in met
+000226a0: 612e 6974 656d 7328 295d 2c20 6178 6973  a.items()], axis
+000226b0: 3d31 0a20 2020 2020 2020 2020 2020 2029  =1.            )
+000226c0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+000226d0: 7365 7269 6573 5f64 660a 0a0a 636c 6173  series_df...clas
+000226e0: 7320 5365 7269 6573 2846 7261 6d65 4261  s Series(FrameBa
+000226f0: 7365 293a 0a20 2020 2022 2222 5365 7269  se):.    """Seri
+00022700: 6573 2d6c 696b 6520 4578 7072 2043 6f6c  es-like Expr Col
+00022710: 6c65 6374 696f 6e22 2222 0a0a 2020 2020  lection"""..    
+00022720: 5f61 6363 6573 736f 7273 3a20 436c 6173  _accessors: Clas
+00022730: 7356 6172 5b73 6574 5b73 7472 5d5d 203d  sVar[set[str]] =
+00022740: 2073 6574 2829 0a20 2020 205f 7061 7274   set().    _part
+00022750: 6974 696f 6e5f 7479 7065 203d 2070 642e  ition_type = pd.
+00022760: 5365 7269 6573 0a0a 2020 2020 4070 726f  Series..    @pro
+00022770: 7065 7274 790a 2020 2020 6465 6620 7368  perty.    def sh
+00022780: 6170 6528 7365 6c66 293a 0a20 2020 2020  ape(self):.     
+00022790: 2020 2022 2222 0a20 2020 2020 2020 2052     """.        R
+000227a0: 6574 7572 6e20 6120 7475 706c 6520 7265  eturn a tuple re
+000227b0: 7072 6573 656e 7469 6e67 2074 6865 2064  presenting the d
+000227c0: 696d 656e 7369 6f6e 616c 6974 7920 6f66  imensionality of
+000227d0: 2074 6865 2044 6174 6146 7261 6d65 2e0a   the DataFrame..
+000227e0: 0a20 2020 2020 2020 2054 6865 206e 756d  .        The num
+000227f0: 6265 7220 6f66 2072 6f77 7320 6973 2061  ber of rows is a
+00022800: 2044 656c 6179 6564 2072 6573 756c 742e   Delayed result.
+00022810: 2054 6865 206e 756d 6265 7220 6f66 2063   The number of c
+00022820: 6f6c 756d 6e73 0a20 2020 2020 2020 2069  olumns.        i
+00022830: 7320 6120 636f 6e63 7265 7465 2069 6e74  s a concrete int
+00022840: 6567 6572 2e0a 2020 2020 2020 2020 2222  eger..        ""
+00022850: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
+00022860: 2028 7365 6c66 2e73 697a 652c 290a 0a20   (self.size,).. 
+00022870: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+00022880: 2064 6566 2061 7865 7328 7365 6c66 293a   def axes(self):
+00022890: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+000228a0: 5b73 656c 662e 696e 6465 785d 0a0a 2020  [self.index]..  
+000228b0: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+000228c0: 6465 6620 6e64 696d 2873 656c 6629 3a0a  def ndim(self):.
+000228d0: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
+000228e0: 6e20 6469 6d65 6e73 696f 6e61 6c69 7479  n dimensionality
+000228f0: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
+00022900: 726e 2031 0a0a 2020 2020 4070 726f 7065  rn 1..    @prope
+00022910: 7274 790a 2020 2020 6465 6620 5f65 6c65  rty.    def _ele
+00022920: 6d77 6973 6528 7365 6c66 293a 0a20 2020  mwise(self):.   
+00022930: 2020 2020 2072 6574 7572 6e20 656c 656d       return elem
+00022940: 7769 7365 0a0a 2020 2020 6465 6620 5f5f  wise..    def __
+00022950: 6469 725f 5f28 7365 6c66 293a 0a20 2020  dir__(self):.   
+00022960: 2020 2020 206f 203d 2073 6574 2864 6972       o = set(dir
+00022970: 2874 7970 6528 7365 6c66 2929 290a 2020  (type(self))).  
+00022980: 2020 2020 2020 6f2e 7570 6461 7465 2873        o.update(s
+00022990: 656c 662e 5f5f 6469 6374 5f5f 290a 2020  elf.__dict__).  
+000229a0: 2020 2020 2020 6f2e 7570 6461 7465 2873        o.update(s
+000229b0: 6574 2864 6972 2865 7870 722e 4578 7072  et(dir(expr.Expr
+000229c0: 2929 290a 2020 2020 2020 2020 666f 7220  ))).        for 
+000229d0: 6163 6365 7373 6f72 2069 6e20 5b22 6361  accessor in ["ca
+000229e0: 7422 2c20 2273 7472 225d 3a0a 2020 2020  t", "str"]:.    
+000229f0: 2020 2020 2020 2020 6966 206e 6f74 2068          if not h
+00022a00: 6173 6174 7472 2873 656c 662e 5f6d 6574  asattr(self._met
+00022a10: 612c 2061 6363 6573 736f 7229 3a0a 2020  a, accessor):.  
+00022a20: 2020 2020 2020 2020 2020 2020 2020 6f2e                o.
+00022a30: 7265 6d6f 7665 2861 6363 6573 736f 7229  remove(accessor)
+00022a40: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00022a50: 6c69 7374 286f 290a 0a20 2020 2064 6566  list(o)..    def
+00022a60: 205f 5f63 6f6e 7461 696e 735f 5f28 7365   __contains__(se
+00022a70: 6c66 2c20 6974 656d 293a 0a20 2020 2020  lf, item):.     
+00022a80: 2020 2072 6169 7365 204e 6f74 496d 706c     raise NotImpl
+00022a90: 656d 656e 7465 6445 7272 6f72 280a 2020  ementedError(.  
+00022aa0: 2020 2020 2020 2020 2020 2255 7369 6e67            "Using
+00022ab0: 2027 696e 2720 746f 2074 6573 7420 666f   'in' to test fo
+00022ac0: 7220 6d65 6d62 6572 7368 6970 2069 7320  r membership is 
+00022ad0: 6e6f 7420 7375 7070 6f72 7465 642e 2055  not supported. U
+00022ae0: 7365 2074 6865 2076 616c 7565 7320 696e  se the values in
+00022af0: 7374 6561 6422 0a20 2020 2020 2020 2029  stead".        )
+00022b00: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
+00022b10: 726f 6d28 7064 2e53 6572 6965 7329 0a20  rom(pd.Series). 
+00022b20: 2020 2064 6566 205f 5f69 7465 725f 5f28     def __iter__(
+00022b30: 7365 6c66 293a 0a20 2020 2020 2020 2066  self):.        f
+00022b40: 7261 6d65 203d 2073 656c 662e 6f70 7469  rame = self.opti
+00022b50: 6d69 7a65 2829 0a20 2020 2020 2020 2066  mize().        f
+00022b60: 6f72 2069 2069 6e20 7261 6e67 6528 7365  or i in range(se
+00022b70: 6c66 2e6e 7061 7274 6974 696f 6e73 293a  lf.npartitions):
+00022b80: 0a20 2020 2020 2020 2020 2020 2073 203d  .            s =
+00022b90: 2066 7261 6d65 2e67 6574 5f70 6172 7469   frame.get_parti
+00022ba0: 7469 6f6e 2869 292e 636f 6d70 7574 6528  tion(i).compute(
+00022bb0: 290a 2020 2020 2020 2020 2020 2020 7969  ).            yi
+00022bc0: 656c 6420 6672 6f6d 2073 0a0a 2020 2020  eld from s..    
+00022bd0: 6465 6620 5f5f 6765 7469 7465 6d5f 5f28  def __getitem__(
+00022be0: 7365 6c66 2c20 6b65 7929 3a0a 2020 2020  self, key):.    
+00022bf0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+00022c00: 6528 6b65 792c 2053 6572 6965 7329 206f  e(key, Series) o
+00022c10: 7220 7365 6c66 2e6e 7061 7274 6974 696f  r self.npartitio
+00022c20: 6e73 203d 3d20 313a 0a20 2020 2020 2020  ns == 1:.       
+00022c30: 2020 2020 2072 6574 7572 6e20 7375 7065       return supe
+00022c40: 7228 292e 5f5f 6765 7469 7465 6d5f 5f28  r().__getitem__(
+00022c50: 6b65 7929 0a20 2020 2020 2020 2072 6574  key).        ret
+00022c60: 7572 6e20 7365 6c66 2e6c 6f63 5b6b 6579  urn self.loc[key
+00022c70: 5d0a 0a20 2020 2040 7072 6f70 6572 7479  ]..    @property
+00022c80: 0a20 2020 2064 6566 206e 616d 6528 7365  .    def name(se
+00022c90: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
+00022ca0: 7572 6e20 7365 6c66 2e65 7870 722e 5f6d  urn self.expr._m
+00022cb0: 6574 612e 6e61 6d65 0a0a 2020 2020 406e  eta.name..    @n
+00022cc0: 616d 652e 7365 7474 6572 0a20 2020 2064  ame.setter.    d
+00022cd0: 6566 206e 616d 6528 7365 6c66 2c20 6e61  ef name(self, na
+00022ce0: 6d65 293a 0a20 2020 2020 2020 2073 656c  me):.        sel
+00022cf0: 662e 5f65 7870 7220 3d20 7365 6c66 2e72  f._expr = self.r
+00022d00: 656e 616d 6528 696e 6465 783d 6e61 6d65  ename(index=name
+00022d10: 292e 5f65 7870 720a 0a20 2020 2040 7072  )._expr..    @pr
+00022d20: 6f70 6572 7479 0a20 2020 2064 6566 2064  operty.    def d
+00022d30: 7479 7065 2873 656c 6629 3a0a 2020 2020  type(self):.    
+00022d40: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00022d50: 6578 7072 2e5f 6d65 7461 2e64 7479 7065  expr._meta.dtype
+00022d60: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
+00022d70: 2020 2020 6465 6620 6e62 7974 6573 2873      def nbytes(s
+00022d80: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
+00022d90: 224e 756d 6265 7220 6f66 2062 7974 6573  "Number of bytes
+00022da0: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
+00022db0: 726e 206e 6577 5f63 6f6c 6c65 6374 696f  rn new_collectio
+00022dc0: 6e28 7365 6c66 2e65 7870 722e 6e62 7974  n(self.expr.nbyt
+00022dd0: 6573 290a 0a20 2020 2064 6566 205f 5f61  es)..    def __a
+00022de0: 7272 6179 5f75 6675 6e63 5f5f 2873 656c  rray_ufunc__(sel
+00022df0: 662c 206e 756d 7079 5f75 6675 6e63 2c20  f, numpy_ufunc, 
+00022e00: 6d65 7468 6f64 2c20 2a69 6e70 7574 732c  method, *inputs,
+00022e10: 202a 2a6b 7761 7267 7329 3a0a 2020 2020   **kwargs):.    
+00022e20: 2020 2020 6f75 7420 3d20 6b77 6172 6773      out = kwargs
+00022e30: 2e67 6574 2822 6f75 7422 2c20 2829 290a  .get("out", ()).
+00022e40: 2020 2020 2020 2020 666f 7220 7820 696e          for x in
+00022e50: 2069 6e70 7574 7320 2b20 6f75 743a 0a20   inputs + out:. 
+00022e60: 2020 2020 2020 2020 2020 2023 2075 6675             # ufu
+00022e70: 6e63 7320 776f 726b 2077 6974 6820 302d  ncs work with 0-
+00022e80: 6469 6d65 6e73 696f 6e61 6c20 4e75 6d50  dimensional NumP
+00022e90: 7920 6e64 6172 7261 7973 0a20 2020 2020  y ndarrays.     
+00022ea0: 2020 2020 2020 2023 2073 6f20 7765 2064         # so we d
+00022eb0: 6f6e 2774 2077 616e 7420 746f 2072 6169  on't want to rai
+00022ec0: 7365 204e 6f74 496d 706c 656d 656e 7465  se NotImplemente
+00022ed0: 640a 2020 2020 2020 2020 2020 2020 6966  d.            if
+00022ee0: 2069 7369 6e73 7461 6e63 6528 782c 206e   isinstance(x, n
+00022ef0: 702e 6e64 6172 7261 7929 2061 6e64 2078  p.ndarray) and x
+00022f00: 2e73 6861 7065 203d 3d20 2829 3a0a 2020  .shape == ():.  
+00022f10: 2020 2020 2020 2020 2020 2020 2020 636f                co
+00022f20: 6e74 696e 7565 0a20 2020 2020 2020 2020  ntinue.         
+00022f30: 2020 2065 6c69 6620 6e6f 7420 6973 696e     elif not isin
+00022f40: 7374 616e 6365 280a 2020 2020 2020 2020  stance(.        
+00022f50: 2020 2020 2020 2020 782c 2028 4e75 6d62          x, (Numb
+00022f60: 6572 2c20 5363 616c 6172 2c20 4672 616d  er, Scalar, Fram
+00022f70: 6542 6173 652c 2041 7272 6179 2c20 7064  eBase, Array, pd
+00022f80: 2e44 6174 6146 7261 6d65 2c20 7064 2e53  .DataFrame, pd.S
+00022f90: 6572 6965 732c 2070 642e 496e 6465 7829  eries, pd.Index)
+00022fa0: 0a20 2020 2020 2020 2020 2020 2029 3a0a  .            ):.
+00022fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022fc0: 7265 7475 726e 204e 6f74 496d 706c 656d  return NotImplem
+00022fd0: 656e 7465 640a 0a20 2020 2020 2020 2069  ented..        i
+00022fe0: 6620 6d65 7468 6f64 203d 3d20 225f 5f63  f method == "__c
+00022ff0: 616c 6c5f 5f22 3a0a 2020 2020 2020 2020  all__":.        
+00023000: 2020 2020 6966 206e 756d 7079 5f75 6675      if numpy_ufu
+00023010: 6e63 2e73 6967 6e61 7475 7265 2069 7320  nc.signature is 
+00023020: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+00023030: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00023040: 204e 6f74 496d 706c 656d 656e 7465 640a   NotImplemented.
+00023050: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+00023060: 756d 7079 5f75 6675 6e63 2e6e 6f75 7420  umpy_ufunc.nout 
+00023070: 3e20 313a 0a20 2020 2020 2020 2020 2020  > 1:.           
+00023080: 2020 2020 2023 2075 6675 6e63 7320 7769       # ufuncs wi
+00023090: 7468 206d 756c 7469 706c 6520 6f75 7470  th multiple outp
+000230a0: 7574 2076 616c 7565 730a 2020 2020 2020  ut values.      
+000230b0: 2020 2020 2020 2020 2020 2320 6172 6520            # are 
+000230c0: 6e6f 7420 7965 7420 7375 7070 6f72 7465  not yet supporte
+000230d0: 6420 666f 7220 6672 616d 6573 0a20 2020  d for frames.   
+000230e0: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+000230f0: 7572 6e20 4e6f 7449 6d70 6c65 6d65 6e74  urn NotImplement
+00023100: 6564 0a20 2020 2020 2020 2020 2020 2065  ed.            e
+00023110: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00023120: 2020 2020 2072 6574 7572 6e20 656c 656d       return elem
+00023130: 7769 7365 286e 756d 7079 5f75 6675 6e63  wise(numpy_ufunc
+00023140: 2c20 2a69 6e70 7574 732c 202a 2a6b 7761  , *inputs, **kwa
+00023150: 7267 7329 0a20 2020 2020 2020 2065 6c73  rgs).        els
+00023160: 653a 0a20 2020 2020 2020 2020 2020 2023  e:.            #
+00023170: 2075 6675 6e63 206d 6574 686f 6473 2061   ufunc methods a
+00023180: 7265 206e 6f74 2079 6574 2073 7570 706f  re not yet suppo
+00023190: 7274 6564 2066 6f72 2066 7261 6d65 730a  rted for frames.
+000231a0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+000231b0: 726e 204e 6f74 496d 706c 656d 656e 7465  rn NotImplemente
+000231c0: 640a 0a20 2020 2064 6566 205f 5f61 7272  d..    def __arr
+000231d0: 6179 5f77 7261 705f 5f28 7365 6c66 2c20  ay_wrap__(self, 
+000231e0: 6172 7261 792c 2063 6f6e 7465 7874 3d4e  array, context=N
+000231f0: 6f6e 6529 3a0a 2020 2020 2020 2020 6966  one):.        if
+00023200: 2069 7369 6e73 7461 6e63 6528 636f 6e74   isinstance(cont
+00023210: 6578 742c 2074 7570 6c65 2920 616e 6420  ext, tuple) and 
+00023220: 6c65 6e28 636f 6e74 6578 7429 203e 2030  len(context) > 0
+00023230: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+00023240: 2069 7369 6e73 7461 6e63 6528 636f 6e74   isinstance(cont
+00023250: 6578 745b 315d 5b30 5d2c 206e 702e 6e64  ext[1][0], np.nd
+00023260: 6172 7261 7929 2061 6e64 2063 6f6e 7465  array) and conte
+00023270: 7874 5b31 5d5b 305d 2e73 6861 7065 203d  xt[1][0].shape =
+00023280: 3d20 2829 3a0a 2020 2020 2020 2020 2020  = ():.          
+00023290: 2020 2020 2020 696e 6465 7820 3d20 4e6f        index = No
+000232a0: 6e65 0a20 2020 2020 2020 2020 2020 2065  ne.            e
+000232b0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+000232c0: 2020 2020 2069 6e64 6578 203d 2063 6f6e       index = con
+000232d0: 7465 7874 5b31 5d5b 305d 2e69 6e64 6578  text[1][0].index
+000232e0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+000232f0: 2020 2020 2020 2020 2020 2074 7279 3a0a             try:.
+00023300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023310: 696d 706f 7274 2069 6e73 7065 6374 0a0a  import inspect..
+00023320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023330: 6d65 7468 6f64 5f6e 616d 6520 3d20 6622  method_name = f"
+00023340: 607b 696e 7370 6563 742e 7374 6163 6b28  `{inspect.stack(
+00023350: 295b 335d 5b33 5d7d 6022 0a20 2020 2020  )[3][3]}`".     
+00023360: 2020 2020 2020 2065 7863 6570 7420 496e         except In
+00023370: 6465 7845 7272 6f72 3a0a 2020 2020 2020  dexError:.      
+00023380: 2020 2020 2020 2020 2020 6d65 7468 6f64            method
+00023390: 5f6e 616d 6520 3d20 2254 6869 7320 6d65  _name = "This me
+000233a0: 7468 6f64 220a 2020 2020 2020 2020 2020  thod".          
+000233b0: 2020 7261 6973 6520 4e6f 7449 6d70 6c65    raise NotImple
+000233c0: 6d65 6e74 6564 4572 726f 7228 0a20 2020  mentedError(.   
+000233d0: 2020 2020 2020 2020 2020 2020 2066 227b               f"{
+000233e0: 6d65 7468 6f64 5f6e 616d 657d 2069 7320  method_name} is 
+000233f0: 6e6f 7420 696d 706c 656d 656e 7465 6420  not implemented 
+00023400: 666f 7220 6064 6173 6b2e 6461 7461 6672  for `dask.datafr
+00023410: 616d 652e 5365 7269 6573 602e 220a 2020  ame.Series`.".  
+00023420: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+00023430: 2020 2020 2072 6574 7572 6e20 6d65 7461       return meta
+00023440: 5f73 6572 6965 735f 636f 6e73 7472 7563  _series_construc
+00023450: 746f 7228 7365 6c66 2928 6172 7261 792c  tor(self)(array,
+00023460: 2069 6e64 6578 3d69 6e64 6578 2c20 6e61   index=index, na
+00023470: 6d65 3d73 656c 662e 6e61 6d65 290a 0a20  me=self.name).. 
+00023480: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
+00023490: 2870 642e 5365 7269 6573 290a 2020 2020  (pd.Series).    
+000234a0: 6465 6620 6d61 7028 7365 6c66 2c20 6172  def map(self, ar
+000234b0: 672c 206e 615f 6163 7469 6f6e 3d4e 6f6e  g, na_action=Non
+000234c0: 652c 206d 6574 613d 4e6f 6e65 293a 0a20  e, meta=None):. 
+000234d0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+000234e0: 616e 6365 2861 7267 2c20 5365 7269 6573  ance(arg, Series
+000234f0: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
+00023500: 6620 6e6f 7420 6578 7072 2e61 7265 5f63  f not expr.are_c
+00023510: 6f5f 616c 6967 6e65 6428 7365 6c66 2e65  o_aligned(self.e
+00023520: 7870 722c 2061 7267 2e65 7870 7229 3a0a  xpr, arg.expr):.
+00023530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023540: 6966 206d 6574 6120 6973 204e 6f6e 653a  if meta is None:
+00023550: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00023560: 2020 2020 2077 6172 6e69 6e67 732e 7761       warnings.wa
+00023570: 726e 286d 6574 615f 7761 726e 696e 6728  rn(meta_warning(
+00023580: 6d65 7461 2929 0a20 2020 2020 2020 2020  meta)).         
+00023590: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
+000235a0: 775f 636f 6c6c 6563 7469 6f6e 280a 2020  w_collection(.  
+000235b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000235c0: 2020 6578 7072 2e4d 6170 416c 6967 6e28    expr.MapAlign(
+000235d0: 7365 6c66 2c20 6172 672c 206f 703d 4e6f  self, arg, op=No
+000235e0: 6e65 2c20 6e61 5f61 6374 696f 6e3d 6e61  ne, na_action=na
+000235f0: 5f61 6374 696f 6e2c 206d 6574 613d 6d65  _action, meta=me
+00023600: 7461 290a 2020 2020 2020 2020 2020 2020  ta).            
+00023610: 2020 2020 290a 2020 2020 2020 2020 6966      ).        if
+00023620: 206d 6574 6120 6973 204e 6f6e 653a 0a20   meta is None:. 
+00023630: 2020 2020 2020 2020 2020 206d 6574 6120             meta 
+00023640: 3d20 6578 7072 2e5f 656d 756c 6174 6528  = expr._emulate(
+00023650: 4d2e 6d61 702c 2073 656c 662c 2061 7267  M.map, self, arg
+00023660: 2c20 6e61 5f61 6374 696f 6e3d 6e61 5f61  , na_action=na_a
+00023670: 6374 696f 6e2c 2075 6466 3d54 7275 6529  ction, udf=True)
+00023680: 0a20 2020 2020 2020 2020 2020 2077 6172  .            war
+00023690: 6e69 6e67 732e 7761 726e 286d 6574 615f  nings.warn(meta_
+000236a0: 7761 726e 696e 6728 6d65 7461 2929 0a20  warning(meta)). 
+000236b0: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
+000236c0: 775f 636f 6c6c 6563 7469 6f6e 2865 7870  w_collection(exp
+000236d0: 722e 4d61 7028 7365 6c66 2c20 6172 673d  r.Map(self, arg=
+000236e0: 6172 672c 206e 615f 6163 7469 6f6e 3d6e  arg, na_action=n
+000236f0: 615f 6163 7469 6f6e 2c20 6d65 7461 3d6d  a_action, meta=m
+00023700: 6574 6129 290a 0a20 2020 2040 6465 7269  eta))..    @deri
+00023710: 7665 645f 6672 6f6d 2870 642e 5365 7269  ved_from(pd.Seri
+00023720: 6573 290a 2020 2020 6465 6620 636c 6970  es).    def clip
+00023730: 2873 656c 662c 206c 6f77 6572 3d4e 6f6e  (self, lower=Non
+00023740: 652c 2075 7070 6572 3d4e 6f6e 652c 2061  e, upper=None, a
+00023750: 7869 733d 4e6f 6e65 2c20 2a2a 6b77 6172  xis=None, **kwar
+00023760: 6773 293a 0a20 2020 2020 2020 2061 7869  gs):.        axi
+00023770: 7320 3d20 7365 6c66 2e5f 7661 6c69 6461  s = self._valida
+00023780: 7465 5f61 7869 7328 6178 6973 290a 2020  te_axis(axis).  
+00023790: 2020 2020 2020 7265 7475 726e 206e 6577        return new
+000237a0: 5f63 6f6c 6c65 6374 696f 6e28 7365 6c66  _collection(self
+000237b0: 2e65 7870 722e 636c 6970 286c 6f77 6572  .expr.clip(lower
+000237c0: 2c20 7570 7065 722c 2061 7869 7329 290a  , upper, axis)).
+000237d0: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
+000237e0: 6f6d 2870 642e 5365 7269 6573 290a 2020  om(pd.Series).  
+000237f0: 2020 6465 6620 746f 5f66 7261 6d65 2873    def to_frame(s
+00023800: 656c 662c 206e 616d 653d 6e6f 5f64 6566  elf, name=no_def
+00023810: 6175 6c74 293a 0a20 2020 2020 2020 2072  ault):.        r
+00023820: 6574 7572 6e20 6e65 775f 636f 6c6c 6563  eturn new_collec
+00023830: 7469 6f6e 2865 7870 722e 546f 4672 616d  tion(expr.ToFram
+00023840: 6528 7365 6c66 2c20 6e61 6d65 3d6e 616d  e(self, name=nam
+00023850: 6529 290a 0a20 2020 2064 6566 205f 636f  e))..    def _co
+00023860: 6d70 6172 6973 6f6e 5f6f 7028 7365 6c66  mparison_op(self
+00023870: 2c20 6578 7072 5f63 6c73 2c20 6f74 6865  , expr_cls, othe
+00023880: 722c 206c 6576 656c 2c20 6669 6c6c 5f76  r, level, fill_v
+00023890: 616c 7565 2c20 6178 6973 293a 0a20 2020  alue, axis):.   
+000238a0: 2020 2020 2069 6620 6c65 7665 6c20 6973       if level is
+000238b0: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+000238c0: 2020 2020 2020 2072 6169 7365 204e 6f74         raise Not
+000238d0: 496d 706c 656d 656e 7465 6445 7272 6f72  ImplementedError
+000238e0: 2822 6c65 7665 6c20 6d75 7374 2062 6520  ("level must be 
+000238f0: 4e6f 6e65 2229 0a20 2020 2020 2020 2073  None").        s
+00023900: 656c 662e 5f76 616c 6964 6174 655f 6178  elf._validate_ax
+00023910: 6973 2861 7869 7329 0a20 2020 2020 2020  is(axis).       
+00023920: 2072 6574 7572 6e20 6e65 775f 636f 6c6c   return new_coll
+00023930: 6563 7469 6f6e 2865 7870 725f 636c 7328  ection(expr_cls(
+00023940: 7365 6c66 2c20 6f74 6865 722c 2066 696c  self, other, fil
+00023950: 6c5f 7661 6c75 653d 6669 6c6c 5f76 616c  l_value=fill_val
+00023960: 7565 2929 0a0a 2020 2020 6465 6620 6c74  ue))..    def lt
+00023970: 2873 656c 662c 206f 7468 6572 2c20 6c65  (self, other, le
+00023980: 7665 6c3d 4e6f 6e65 2c20 6669 6c6c 5f76  vel=None, fill_v
+00023990: 616c 7565 3d4e 6f6e 652c 2061 7869 733d  alue=None, axis=
+000239a0: 3029 3a0a 2020 2020 2020 2020 7265 7475  0):.        retu
+000239b0: 726e 2073 656c 662e 5f63 6f6d 7061 7269  rn self._compari
+000239c0: 736f 6e5f 6f70 2865 7870 722e 4c54 5365  son_op(expr.LTSe
+000239d0: 7269 6573 2c20 6f74 6865 722c 206c 6576  ries, other, lev
+000239e0: 656c 2c20 6669 6c6c 5f76 616c 7565 2c20  el, fill_value, 
+000239f0: 6178 6973 290a 0a20 2020 2064 6566 206c  axis)..    def l
+00023a00: 6528 7365 6c66 2c20 6f74 6865 722c 206c  e(self, other, l
+00023a10: 6576 656c 3d4e 6f6e 652c 2066 696c 6c5f  evel=None, fill_
+00023a20: 7661 6c75 653d 4e6f 6e65 2c20 6178 6973  value=None, axis
+00023a30: 3d30 293a 0a20 2020 2020 2020 2072 6574  =0):.        ret
+00023a40: 7572 6e20 7365 6c66 2e5f 636f 6d70 6172  urn self._compar
+00023a50: 6973 6f6e 5f6f 7028 6578 7072 2e4c 4553  ison_op(expr.LES
+00023a60: 6572 6965 732c 206f 7468 6572 2c20 6c65  eries, other, le
+00023a70: 7665 6c2c 2066 696c 6c5f 7661 6c75 652c  vel, fill_value,
+00023a80: 2061 7869 7329 0a0a 2020 2020 6465 6620   axis)..    def 
+00023a90: 6774 2873 656c 662c 206f 7468 6572 2c20  gt(self, other, 
+00023aa0: 6c65 7665 6c3d 4e6f 6e65 2c20 6669 6c6c  level=None, fill
+00023ab0: 5f76 616c 7565 3d4e 6f6e 652c 2061 7869  _value=None, axi
+00023ac0: 733d 3029 3a0a 2020 2020 2020 2020 7265  s=0):.        re
+00023ad0: 7475 726e 2073 656c 662e 5f63 6f6d 7061  turn self._compa
+00023ae0: 7269 736f 6e5f 6f70 2865 7870 722e 4754  rison_op(expr.GT
+00023af0: 5365 7269 6573 2c20 6f74 6865 722c 206c  Series, other, l
+00023b00: 6576 656c 2c20 6669 6c6c 5f76 616c 7565  evel, fill_value
+00023b10: 2c20 6178 6973 290a 0a20 2020 2064 6566  , axis)..    def
+00023b20: 2067 6528 7365 6c66 2c20 6f74 6865 722c   ge(self, other,
+00023b30: 206c 6576 656c 3d4e 6f6e 652c 2066 696c   level=None, fil
+00023b40: 6c5f 7661 6c75 653d 4e6f 6e65 2c20 6178  l_value=None, ax
+00023b50: 6973 3d30 293a 0a20 2020 2020 2020 2072  is=0):.        r
+00023b60: 6574 7572 6e20 7365 6c66 2e5f 636f 6d70  eturn self._comp
+00023b70: 6172 6973 6f6e 5f6f 7028 6578 7072 2e47  arison_op(expr.G
+00023b80: 4553 6572 6965 732c 206f 7468 6572 2c20  ESeries, other, 
+00023b90: 6c65 7665 6c2c 2066 696c 6c5f 7661 6c75  level, fill_valu
+00023ba0: 652c 2061 7869 7329 0a0a 2020 2020 6465  e, axis)..    de
+00023bb0: 6620 6e65 2873 656c 662c 206f 7468 6572  f ne(self, other
+00023bc0: 2c20 6c65 7665 6c3d 4e6f 6e65 2c20 6669  , level=None, fi
+00023bd0: 6c6c 5f76 616c 7565 3d4e 6f6e 652c 2061  ll_value=None, a
+00023be0: 7869 733d 3029 3a0a 2020 2020 2020 2020  xis=0):.        
+00023bf0: 7265 7475 726e 2073 656c 662e 5f63 6f6d  return self._com
+00023c00: 7061 7269 736f 6e5f 6f70 2865 7870 722e  parison_op(expr.
+00023c10: 4e45 5365 7269 6573 2c20 6f74 6865 722c  NESeries, other,
+00023c20: 206c 6576 656c 2c20 6669 6c6c 5f76 616c   level, fill_val
+00023c30: 7565 2c20 6178 6973 290a 0a20 2020 2064  ue, axis)..    d
+00023c40: 6566 2065 7128 7365 6c66 2c20 6f74 6865  ef eq(self, othe
+00023c50: 722c 206c 6576 656c 3d4e 6f6e 652c 2066  r, level=None, f
+00023c60: 696c 6c5f 7661 6c75 653d 4e6f 6e65 2c20  ill_value=None, 
+00023c70: 6178 6973 3d30 293a 0a20 2020 2020 2020  axis=0):.       
+00023c80: 2072 6574 7572 6e20 7365 6c66 2e5f 636f   return self._co
+00023c90: 6d70 6172 6973 6f6e 5f6f 7028 6578 7072  mparison_op(expr
+00023ca0: 2e45 5153 6572 6965 732c 206f 7468 6572  .EQSeries, other
+00023cb0: 2c20 6c65 7665 6c2c 2066 696c 6c5f 7661  , level, fill_va
+00023cc0: 6c75 652c 2061 7869 7329 0a0a 2020 2020  lue, axis)..    
+00023cd0: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
+00023ce0: 2e53 6572 6965 7329 0a20 2020 2064 6566  .Series).    def
+00023cf0: 2076 616c 7565 5f63 6f75 6e74 7328 0a20   value_counts(. 
+00023d00: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+00023d10: 2020 2020 2073 6f72 743d 4e6f 6e65 2c0a       sort=None,.
+00023d20: 2020 2020 2020 2020 6173 6365 6e64 696e          ascendin
+00023d30: 673d 4661 6c73 652c 0a20 2020 2020 2020  g=False,.       
+00023d40: 2064 726f 706e 613d 5472 7565 2c0a 2020   dropna=True,.  
+00023d50: 2020 2020 2020 6e6f 726d 616c 697a 653d        normalize=
+00023d60: 4661 6c73 652c 0a20 2020 2020 2020 2073  False,.        s
+00023d70: 706c 6974 5f65 7665 7279 3d4e 6f6e 652c  plit_every=None,
+00023d80: 0a20 2020 2020 2020 2073 706c 6974 5f6f  .        split_o
+00023d90: 7574 3d6e 6f5f 6465 6661 756c 742c 0a20  ut=no_default,. 
+00023da0: 2020 2029 3a0a 2020 2020 2020 2020 6966     ):.        if
+00023db0: 2073 706c 6974 5f6f 7574 2069 7320 6e6f   split_out is no
+00023dc0: 5f64 6566 6175 6c74 3a0a 2020 2020 2020  _default:.      
+00023dd0: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
+00023de0: 6e63 6528 7365 6c66 2e64 7479 7065 2c20  nce(self.dtype, 
+00023df0: 4361 7465 676f 7269 6361 6c44 7479 7065  CategoricalDtype
+00023e00: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00023e10: 2020 2023 2075 6e6f 6273 6572 7665 6420     # unobserved 
+00023e20: 6361 7465 676f 7269 6573 2061 7265 2061  categories are a
+00023e30: 2070 6169 6e0a 2020 2020 2020 2020 2020   pain.          
+00023e40: 2020 2020 2020 7370 6c69 745f 6f75 7420        split_out 
+00023e50: 3d20 310a 2020 2020 2020 2020 2020 2020  = 1.            
+00023e60: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00023e70: 2020 2020 2020 7370 6c69 745f 6f75 7420        split_out 
+00023e80: 3d20 5472 7565 0a20 2020 2020 2020 2069  = True.        i
+00023e90: 6620 7370 6c69 745f 6f75 7420 3d3d 2031  f split_out == 1
+00023ea0: 2061 6e64 2073 706c 6974 5f6f 7574 2069   and split_out i
+00023eb0: 7320 6e6f 7420 5472 7565 2061 6e64 2073  s not True and s
+00023ec0: 6f72 7420 6973 204e 6f6e 653a 0a20 2020  ort is None:.   
+00023ed0: 2020 2020 2020 2020 2073 6f72 7420 3d20           sort = 
+00023ee0: 5472 7565 0a0a 2020 2020 2020 2020 6c65  True..        le
+00023ef0: 6e67 7468 203d 204e 6f6e 650a 2020 2020  ngth = None.    
+00023f00: 2020 2020 6966 2028 7370 6c69 745f 6f75      if (split_ou
+00023f10: 7420 3e20 3120 6f72 2073 706c 6974 5f6f  t > 1 or split_o
+00023f20: 7574 2069 7320 5472 7565 2920 616e 6420  ut is True) and 
+00023f30: 6e6f 726d 616c 697a 653a 0a20 2020 2020  normalize:.     
+00023f40: 2020 2020 2020 2066 7261 6d65 203d 2073         frame = s
+00023f50: 656c 6620 6966 206e 6f74 2064 726f 706e  elf if not dropn
+00023f60: 6120 656c 7365 2073 656c 662e 6472 6f70  a else self.drop
+00023f70: 6e61 2829 0a20 2020 2020 2020 2020 2020  na().           
+00023f80: 206c 656e 6774 6820 3d20 4c65 6e28 6672   length = Len(fr
+00023f90: 616d 6529 0a0a 2020 2020 2020 2020 7265  ame)..        re
+00023fa0: 7475 726e 206e 6577 5f63 6f6c 6c65 6374  turn new_collect
+00023fb0: 696f 6e28 0a20 2020 2020 2020 2020 2020  ion(.           
+00023fc0: 2056 616c 7565 436f 756e 7473 280a 2020   ValueCounts(.  
+00023fd0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00023fe0: 6c66 2c20 736f 7274 2c20 6173 6365 6e64  lf, sort, ascend
+00023ff0: 696e 672c 2064 726f 706e 612c 206e 6f72  ing, dropna, nor
+00024000: 6d61 6c69 7a65 2c20 7370 6c69 745f 6576  malize, split_ev
+00024010: 6572 792c 2073 706c 6974 5f6f 7574 2c20  ery, split_out, 
+00024020: 6c65 6e67 7468 0a20 2020 2020 2020 2020  length.         
+00024030: 2020 2029 0a20 2020 2020 2020 2029 0a0a     ).        )..
+00024040: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
+00024050: 6d28 7064 2e53 6572 6965 7329 0a20 2020  m(pd.Series).   
+00024060: 2064 6566 206d 6f64 6528 7365 6c66 2c20   def mode(self, 
+00024070: 6472 6f70 6e61 3d54 7275 652c 2073 706c  dropna=True, spl
+00024080: 6974 5f65 7665 7279 3d46 616c 7365 293a  it_every=False):
+00024090: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+000240a0: 6e65 775f 636f 6c6c 6563 7469 6f6e 2873  new_collection(s
+000240b0: 656c 662e 6578 7072 2e6d 6f64 6528 6472  elf.expr.mode(dr
+000240c0: 6f70 6e61 2c20 7370 6c69 745f 6576 6572  opna, split_ever
+000240d0: 7929 290a 0a20 2020 2040 6465 7269 7665  y))..    @derive
+000240e0: 645f 6672 6f6d 2870 642e 5365 7269 6573  d_from(pd.Series
+000240f0: 290a 2020 2020 6465 6620 6e6c 6172 6765  ).    def nlarge
+00024100: 7374 2873 656c 662c 206e 3d35 2c20 7370  st(self, n=5, sp
+00024110: 6c69 745f 6576 6572 793d 4e6f 6e65 293a  lit_every=None):
+00024120: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00024130: 6e65 775f 636f 6c6c 6563 7469 6f6e 284e  new_collection(N
+00024140: 4c61 7267 6573 7428 7365 6c66 2c20 6e3d  Largest(self, n=
+00024150: 6e2c 2073 706c 6974 5f65 7665 7279 3d73  n, split_every=s
+00024160: 706c 6974 5f65 7665 7279 2929 0a0a 2020  plit_every))..  
+00024170: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
+00024180: 7064 2e53 6572 6965 7329 0a20 2020 2064  pd.Series).    d
+00024190: 6566 206e 736d 616c 6c65 7374 2873 656c  ef nsmallest(sel
+000241a0: 662c 206e 3d35 2c20 7370 6c69 745f 6576  f, n=5, split_ev
+000241b0: 6572 793d 4e6f 6e65 293a 0a20 2020 2020  ery=None):.     
+000241c0: 2020 2072 6574 7572 6e20 6e65 775f 636f     return new_co
+000241d0: 6c6c 6563 7469 6f6e 284e 536d 616c 6c65  llection(NSmalle
+000241e0: 7374 2873 656c 662c 206e 3d6e 2c20 7370  st(self, n=n, sp
+000241f0: 6c69 745f 6576 6572 793d 7370 6c69 745f  lit_every=split_
+00024200: 6576 6572 7929 290a 0a20 2020 2040 6465  every))..    @de
+00024210: 7269 7665 645f 6672 6f6d 2870 642e 5365  rived_from(pd.Se
+00024220: 7269 6573 290a 2020 2020 6465 6620 6d65  ries).    def me
+00024230: 6d6f 7279 5f75 7361 6765 2873 656c 662c  mory_usage(self,
+00024240: 2064 6565 703d 4661 6c73 652c 2069 6e64   deep=False, ind
+00024250: 6578 3d54 7275 6529 3a0a 2020 2020 2020  ex=True):.      
+00024260: 2020 7265 7475 726e 206e 6577 5f63 6f6c    return new_col
+00024270: 6c65 6374 696f 6e28 4d65 6d6f 7279 5573  lection(MemoryUs
+00024280: 6167 6546 7261 6d65 2873 656c 662c 2064  ageFrame(self, d
+00024290: 6565 703d 6465 6570 2c20 5f69 6e64 6578  eep=deep, _index
+000242a0: 3d69 6e64 6578 2929 0a0a 2020 2020 6465  =index))..    de
+000242b0: 6620 756e 6971 7565 2873 656c 662c 2073  f unique(self, s
+000242c0: 706c 6974 5f65 7665 7279 3d4e 6f6e 652c  plit_every=None,
+000242d0: 2073 706c 6974 5f6f 7574 3d54 7275 652c   split_out=True,
+000242e0: 2073 6875 6666 6c65 5f6d 6574 686f 643d   shuffle_method=
+000242f0: 4e6f 6e65 293a 0a20 2020 2020 2020 2022  None):.        "
+00024300: 2222 0a20 2020 2020 2020 2052 6574 7572  "".        Retur
+00024310: 6e20 5365 7269 6573 206f 6620 756e 6971  n Series of uniq
+00024320: 7565 2076 616c 7565 7320 696e 2074 6865  ue values in the
+00024330: 206f 626a 6563 742e 2049 6e63 6c75 6465   object. Include
+00024340: 7320 4e41 2076 616c 7565 732e 0a0a 2020  s NA values...  
+00024350: 2020 2020 2020 5265 7475 726e 730a 2020        Returns.  
+00024360: 2020 2020 2020 2d2d 2d2d 2d2d 2d0a 2020        -------.  
+00024370: 2020 2020 2020 756e 6971 7565 7320 3a20        uniques : 
+00024380: 5365 7269 6573 0a20 2020 2020 2020 2022  Series.        "
+00024390: 2222 0a20 2020 2020 2020 2073 6875 6666  "".        shuff
+000243a0: 6c65 5f6d 6574 686f 6420 3d20 5f67 6574  le_method = _get
+000243b0: 5f73 6875 6666 6c65 5f70 7265 6665 7272  _shuffle_preferr
+000243c0: 696e 675f 6f72 6465 7228 7368 7566 666c  ing_order(shuffl
+000243d0: 655f 6d65 7468 6f64 290a 2020 2020 2020  e_method).      
+000243e0: 2020 7265 7475 726e 206e 6577 5f63 6f6c    return new_col
+000243f0: 6c65 6374 696f 6e28 556e 6971 7565 2873  lection(Unique(s
+00024400: 656c 662c 2073 706c 6974 5f65 7665 7279  elf, split_every
+00024410: 2c20 7370 6c69 745f 6f75 742c 2073 6875  , split_out, shu
+00024420: 6666 6c65 5f6d 6574 686f 6429 290a 0a20  ffle_method)).. 
+00024430: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
+00024440: 2870 642e 5365 7269 6573 290a 2020 2020  (pd.Series).    
+00024450: 6465 6620 6e75 6e69 7175 6528 7365 6c66  def nunique(self
+00024460: 2c20 6472 6f70 6e61 3d54 7275 652c 2073  , dropna=True, s
+00024470: 706c 6974 5f65 7665 7279 3d46 616c 7365  plit_every=False
+00024480: 2c20 7370 6c69 745f 6f75 743d 5472 7565  , split_out=True
+00024490: 293a 0a20 2020 2020 2020 2075 6e69 7173  ):.        uniqs
+000244a0: 203d 2073 656c 662e 6472 6f70 5f64 7570   = self.drop_dup
+000244b0: 6c69 6361 7465 7328 7370 6c69 745f 6576  licates(split_ev
+000244c0: 6572 793d 7370 6c69 745f 6576 6572 792c  ery=split_every,
+000244d0: 2073 706c 6974 5f6f 7574 3d73 706c 6974   split_out=split
+000244e0: 5f6f 7574 290a 2020 2020 2020 2020 6966  _out).        if
+000244f0: 2064 726f 706e 613a 0a20 2020 2020 2020   dropna:.       
+00024500: 2020 2020 2023 2063 6f75 6e74 206d 696d       # count mim
+00024510: 6963 7320 7061 6e64 6173 2062 6568 6176  ics pandas behav
+00024520: 696f 7220 616e 6420 6578 636c 7564 6573  ior and excludes
+00024530: 204e 4120 7661 6c75 6573 0a20 2020 2020   NA values.     
+00024540: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+00024550: 616e 6365 2875 6e69 7173 2c20 496e 6465  ance(uniqs, Inde
+00024560: 7829 3a0a 2020 2020 2020 2020 2020 2020  x):.            
+00024570: 2020 2020 756e 6971 7320 3d20 756e 6971      uniqs = uniq
+00024580: 732e 746f 5f73 6572 6965 7328 290a 2020  s.to_series().  
+00024590: 2020 2020 2020 2020 2020 7265 7475 726e            return
+000245a0: 2075 6e69 7173 2e63 6f75 6e74 2829 0a20   uniqs.count(). 
+000245b0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+000245c0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+000245d0: 756e 6971 732e 7369 7a65 0a0a 2020 2020  uniqs.size..    
+000245e0: 6465 6620 6472 6f70 5f64 7570 6c69 6361  def drop_duplica
+000245f0: 7465 7328 0a20 2020 2020 2020 2073 656c  tes(.        sel
+00024600: 662c 0a20 2020 2020 2020 2069 676e 6f72  f,.        ignor
+00024610: 655f 696e 6465 783d 4661 6c73 652c 0a20  e_index=False,. 
+00024620: 2020 2020 2020 2073 706c 6974 5f65 7665         split_eve
+00024630: 7279 3d4e 6f6e 652c 0a20 2020 2020 2020  ry=None,.       
+00024640: 2073 706c 6974 5f6f 7574 3d54 7275 652c   split_out=True,
+00024650: 0a20 2020 2020 2020 2073 6875 6666 6c65  .        shuffle
+00024660: 5f6d 6574 686f 643d 4e6f 6e65 2c0a 2020  _method=None,.  
+00024670: 2020 2020 2020 6b65 6570 3d22 6669 7273        keep="firs
+00024680: 7422 2c0a 2020 2020 293a 0a20 2020 2020  t",.    ):.     
+00024690: 2020 2073 6875 6666 6c65 5f6d 6574 686f     shuffle_metho
+000246a0: 6420 3d20 5f67 6574 5f73 6875 6666 6c65  d = _get_shuffle
+000246b0: 5f70 7265 6665 7272 696e 675f 6f72 6465  _preferring_orde
+000246c0: 7228 7368 7566 666c 655f 6d65 7468 6f64  r(shuffle_method
+000246d0: 290a 2020 2020 2020 2020 6966 206b 6565  ).        if kee
+000246e0: 7020 6973 2046 616c 7365 3a0a 2020 2020  p is False:.    
+000246f0: 2020 2020 2020 2020 7261 6973 6520 4e6f          raise No
+00024700: 7449 6d70 6c65 6d65 6e74 6564 4572 726f  tImplementedErro
+00024710: 7228 2264 726f 705f 6475 706c 6963 6174  r("drop_duplicat
+00024720: 6573 2077 6974 6820 6b65 6570 3d46 616c  es with keep=Fal
+00024730: 7365 2229 0a20 2020 2020 2020 2072 6574  se").        ret
+00024740: 7572 6e20 6e65 775f 636f 6c6c 6563 7469  urn new_collecti
+00024750: 6f6e 280a 2020 2020 2020 2020 2020 2020  on(.            
+00024760: 4472 6f70 4475 706c 6963 6174 6573 280a  DropDuplicates(.
+00024770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024780: 7365 6c66 2c0a 2020 2020 2020 2020 2020  self,.          
+00024790: 2020 2020 2020 6967 6e6f 7265 5f69 6e64        ignore_ind
+000247a0: 6578 3d69 676e 6f72 655f 696e 6465 782c  ex=ignore_index,
+000247b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000247c0: 2073 706c 6974 5f6f 7574 3d73 706c 6974   split_out=split
+000247d0: 5f6f 7574 2c0a 2020 2020 2020 2020 2020  _out,.          
+000247e0: 2020 2020 2020 7370 6c69 745f 6576 6572        split_ever
+000247f0: 793d 7370 6c69 745f 6576 6572 792c 0a20  y=split_every,. 
+00024800: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00024810: 6875 6666 6c65 5f6d 6574 686f 643d 7368  huffle_method=sh
+00024820: 7566 666c 655f 6d65 7468 6f64 2c0a 2020  uffle_method,.  
+00024830: 2020 2020 2020 2020 2020 2020 2020 6b65                ke
+00024840: 6570 3d6b 6565 702c 0a20 2020 2020 2020  ep=keep,.       
+00024850: 2020 2020 2029 0a20 2020 2020 2020 2029       ).        )
+00024860: 0a0a 2020 2020 4069 6e73 6572 745f 6d65  ..    @insert_me
+00024870: 7461 5f70 6172 616d 5f64 6573 6372 6970  ta_param_descrip
+00024880: 7469 6f6e 2870 6164 3d31 3229 0a20 2020  tion(pad=12).   
+00024890: 2064 6566 2061 7070 6c79 2873 656c 662c   def apply(self,
+000248a0: 2066 756e 6374 696f 6e2c 202a 6172 6773   function, *args
+000248b0: 2c20 6d65 7461 3d6e 6f5f 6465 6661 756c  , meta=no_defaul
+000248c0: 742c 2061 7869 733d 302c 202a 2a6b 7761  t, axis=0, **kwa
+000248d0: 7267 7329 3a0a 2020 2020 2020 2020 2222  rgs):.        ""
+000248e0: 2250 6172 616c 6c65 6c20 7665 7273 696f  "Parallel versio
+000248f0: 6e20 6f66 2070 616e 6461 732e 5365 7269  n of pandas.Seri
+00024900: 6573 2e61 7070 6c79 0a0a 2020 2020 2020  es.apply..      
+00024910: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
+00024920: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
+00024930: 2020 2020 2020 2020 6675 6e63 203a 2066          func : f
+00024940: 756e 6374 696f 6e0a 2020 2020 2020 2020  unction.        
+00024950: 2020 2020 4675 6e63 7469 6f6e 2074 6f20      Function to 
+00024960: 6170 706c 790a 2020 2020 2020 2020 244d  apply.        $M
+00024970: 4554 410a 2020 2020 2020 2020 6172 6773  ETA.        args
+00024980: 203a 2074 7570 6c65 0a20 2020 2020 2020   : tuple.       
+00024990: 2020 2020 2050 6f73 6974 696f 6e61 6c20       Positional 
+000249a0: 6172 6775 6d65 6e74 7320 746f 2070 6173  arguments to pas
+000249b0: 7320 746f 2066 756e 6374 696f 6e20 696e  s to function in
+000249c0: 2061 6464 6974 696f 6e20 746f 2074 6865   addition to the
+000249d0: 2076 616c 7565 2e0a 0a20 2020 2020 2020   value...       
+000249e0: 2041 6464 6974 696f 6e61 6c20 6b65 7977   Additional keyw
+000249f0: 6f72 6420 6172 6775 6d65 6e74 7320 7769  ord arguments wi
+00024a00: 6c6c 2062 6520 7061 7373 6564 2061 7320  ll be passed as 
+00024a10: 6b65 7977 6f72 6473 2074 6f20 7468 6520  keywords to the 
+00024a20: 6675 6e63 7469 6f6e 2e0a 0a20 2020 2020  function...     
+00024a30: 2020 2052 6574 7572 6e73 0a20 2020 2020     Returns.     
+00024a40: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2020     -------.     
+00024a50: 2020 2061 7070 6c69 6564 203a 2053 6572     applied : Ser
+00024a60: 6965 7320 6f72 2044 6174 6146 7261 6d65  ies or DataFrame
+00024a70: 2069 6620 6675 6e63 2072 6574 7572 6e73   if func returns
+00024a80: 2061 2053 6572 6965 732e 0a0a 2020 2020   a Series...    
+00024a90: 2020 2020 4578 616d 706c 6573 0a20 2020      Examples.   
+00024aa0: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
+00024ab0: 2020 2020 2020 3e3e 3e20 696d 706f 7274        >>> import
+00024ac0: 2064 6173 6b2e 6461 7461 6672 616d 6520   dask.dataframe 
+00024ad0: 6173 2064 640a 2020 2020 2020 2020 3e3e  as dd.        >>
+00024ae0: 3e20 7320 3d20 7064 2e53 6572 6965 7328  > s = pd.Series(
+00024af0: 7261 6e67 6528 3529 2c20 6e61 6d65 3d27  range(5), name='
+00024b00: 7827 290a 2020 2020 2020 2020 3e3e 3e20  x').        >>> 
+00024b10: 6473 203d 2064 642e 6672 6f6d 5f70 616e  ds = dd.from_pan
+00024b20: 6461 7328 732c 206e 7061 7274 6974 696f  das(s, npartitio
+00024b30: 6e73 3d32 290a 0a20 2020 2020 2020 2041  ns=2)..        A
+00024b40: 7070 6c79 2061 2066 756e 6374 696f 6e20  pply a function 
+00024b50: 656c 656d 656e 7477 6973 6520 6163 726f  elementwise acro
+00024b60: 7373 2074 6865 2053 6572 6965 732c 2070  ss the Series, p
+00024b70: 6173 7369 6e67 2069 6e20 6578 7472 610a  assing in extra.
+00024b80: 2020 2020 2020 2020 6172 6775 6d65 6e74          argument
+00024b90: 7320 696e 2060 6061 7267 7360 6020 616e  s in ``args`` an
+00024ba0: 6420 6060 6b77 6172 6773 6060 3a0a 0a20  d ``kwargs``:.. 
+00024bb0: 2020 2020 2020 203e 3e3e 2064 6566 206d         >>> def m
+00024bc0: 7961 6464 2878 2c20 612c 2062 3d31 293a  yadd(x, a, b=1):
+00024bd0: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+00024be0: 2072 6574 7572 6e20 7820 2b20 6120 2b20   return x + a + 
+00024bf0: 620a 2020 2020 2020 2020 3e3e 3e20 7265  b.        >>> re
+00024c00: 7320 3d20 6473 2e61 7070 6c79 286d 7961  s = ds.apply(mya
+00024c10: 6464 2c20 6172 6773 3d28 322c 292c 2062  dd, args=(2,), b
+00024c20: 3d31 2e35 2920 2023 2064 6f63 7465 7374  =1.5)  # doctest
+00024c30: 3a20 2b53 4b49 500a 0a20 2020 2020 2020  : +SKIP..       
+00024c40: 2042 7920 6465 6661 756c 742c 2064 6173   By default, das
+00024c50: 6b20 7472 6965 7320 746f 2069 6e66 6572  k tries to infer
+00024c60: 2074 6865 206f 7574 7075 7420 6d65 7461   the output meta
+00024c70: 6461 7461 2062 7920 7275 6e6e 696e 6720  data by running 
+00024c80: 796f 7572 0a20 2020 2020 2020 2070 726f  your.        pro
+00024c90: 7669 6465 6420 6675 6e63 7469 6f6e 206f  vided function o
+00024ca0: 6e20 736f 6d65 2066 616b 6520 6461 7461  n some fake data
+00024cb0: 2e20 5468 6973 2077 6f72 6b73 2077 656c  . This works wel
+00024cc0: 6c20 696e 206d 616e 7920 6361 7365 732c  l in many cases,
+00024cd0: 2062 7574 0a20 2020 2020 2020 2063 616e   but.        can
+00024ce0: 2073 6f6d 6574 696d 6573 2062 6520 6578   sometimes be ex
+00024cf0: 7065 6e73 6976 652c 206f 7220 6576 656e  pensive, or even
+00024d00: 2066 6169 6c2e 2054 6f20 6176 6f69 6420   fail. To avoid 
+00024d10: 7468 6973 2c20 796f 7520 6361 6e0a 2020  this, you can.  
+00024d20: 2020 2020 2020 6d61 6e75 616c 6c79 2073        manually s
+00024d30: 7065 6369 6679 2074 6865 206f 7574 7075  pecify the outpu
+00024d40: 7420 6d65 7461 6461 7461 2077 6974 6820  t metadata with 
+00024d50: 7468 6520 6060 6d65 7461 6060 206b 6579  the ``meta`` key
+00024d60: 776f 7264 2e20 5468 6973 0a20 2020 2020  word. This.     
+00024d70: 2020 2063 616e 2062 6520 7370 6563 6966     can be specif
+00024d80: 6965 6420 696e 206d 616e 7920 666f 726d  ied in many form
+00024d90: 732c 2066 6f72 206d 6f72 6520 696e 666f  s, for more info
+00024da0: 726d 6174 696f 6e20 7365 650a 2020 2020  rmation see.    
+00024db0: 2020 2020 6060 6461 736b 2e64 6174 6166      ``dask.dataf
+00024dc0: 7261 6d65 2e75 7469 6c73 2e6d 616b 655f  rame.utils.make_
+00024dd0: 6d65 7461 6060 2e0a 0a20 2020 2020 2020  meta``...       
+00024de0: 2048 6572 6520 7765 2073 7065 6369 6679   Here we specify
+00024df0: 2074 6865 206f 7574 7075 7420 6973 2061   the output is a
+00024e00: 2053 6572 6965 7320 7769 7468 206e 616d   Series with nam
+00024e10: 6520 6060 2778 2760 602c 2061 6e64 2064  e ``'x'``, and d
+00024e20: 7479 7065 0a20 2020 2020 2020 2060 6066  type.        ``f
+00024e30: 6c6f 6174 3634 6060 3a0a 0a20 2020 2020  loat64``:..     
+00024e40: 2020 203e 3e3e 2072 6573 203d 2064 732e     >>> res = ds.
+00024e50: 6170 706c 7928 6d79 6164 642c 2061 7267  apply(myadd, arg
+00024e60: 733d 2832 2c29 2c20 623d 312e 352c 206d  s=(2,), b=1.5, m
+00024e70: 6574 613d 2827 7827 2c20 2766 3827 2929  eta=('x', 'f8'))
+00024e80: 0a0a 2020 2020 2020 2020 496e 2074 6865  ..        In the
+00024e90: 2063 6173 6520 7768 6572 6520 7468 6520   case where the 
+00024ea0: 6d65 7461 6461 7461 2064 6f65 736e 2774  metadata doesn't
+00024eb0: 2063 6861 6e67 652c 2079 6f75 2063 616e   change, you can
+00024ec0: 2061 6c73 6f20 7061 7373 2069 6e0a 2020   also pass in.  
+00024ed0: 2020 2020 2020 7468 6520 6f62 6a65 6374        the object
+00024ee0: 2069 7473 656c 6620 6469 7265 6374 6c79   itself directly
+00024ef0: 3a0a 0a20 2020 2020 2020 203e 3e3e 2072  :..        >>> r
+00024f00: 6573 203d 2064 732e 6170 706c 7928 6c61  es = ds.apply(la
+00024f10: 6d62 6461 2078 3a20 7820 2b20 312c 206d  mbda x: x + 1, m
+00024f20: 6574 613d 6473 290a 0a20 2020 2020 2020  eta=ds)..       
+00024f30: 2053 6565 2041 6c73 6f0a 2020 2020 2020   See Also.      
+00024f40: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020    --------.     
+00024f50: 2020 2053 6572 6965 732e 6d61 705f 7061     Series.map_pa
+00024f60: 7274 6974 696f 6e73 0a20 2020 2020 2020  rtitions.       
+00024f70: 2022 2222 0a20 2020 2020 2020 2073 656c   """.        sel
+00024f80: 662e 5f76 616c 6964 6174 655f 6178 6973  f._validate_axis
+00024f90: 2861 7869 7329 0a20 2020 2020 2020 2069  (axis).        i
+00024fa0: 6620 6d65 7461 2069 7320 6e6f 5f64 6566  f meta is no_def
+00024fb0: 6175 6c74 3a0a 2020 2020 2020 2020 2020  ault:.          
+00024fc0: 2020 6d65 7461 203d 2065 7870 722e 5f65    meta = expr._e
+00024fd0: 6d75 6c61 7465 284d 2e61 7070 6c79 2c20  mulate(M.apply, 
+00024fe0: 7365 6c66 2c20 6675 6e63 7469 6f6e 2c20  self, function, 
+00024ff0: 6172 6773 3d61 7267 732c 2075 6466 3d54  args=args, udf=T
+00025000: 7275 652c 202a 2a6b 7761 7267 7329 0a20  rue, **kwargs). 
+00025010: 2020 2020 2020 2020 2020 2077 6172 6e69             warni
+00025020: 6e67 732e 7761 726e 286d 6574 615f 7761  ngs.warn(meta_wa
+00025030: 726e 696e 6728 6d65 7461 2929 0a20 2020  rning(meta)).   
+00025040: 2020 2020 2072 6574 7572 6e20 6e65 775f       return new_
+00025050: 636f 6c6c 6563 7469 6f6e 2873 656c 662e  collection(self.
+00025060: 6578 7072 2e61 7070 6c79 2866 756e 6374  expr.apply(funct
+00025070: 696f 6e2c 202a 6172 6773 2c20 6d65 7461  ion, *args, meta
+00025080: 3d6d 6574 612c 202a 2a6b 7761 7267 7329  =meta, **kwargs)
+00025090: 290a 0a20 2020 2040 636c 6173 736d 6574  )..    @classmet
+000250a0: 686f 640a 2020 2020 6465 6620 5f76 616c  hod.    def _val
+000250b0: 6964 6174 655f 6178 6973 2863 6c73 2c20  idate_axis(cls, 
+000250c0: 6178 6973 3d30 2c20 6e75 6d65 7269 635f  axis=0, numeric_
+000250d0: 6178 6973 3a20 626f 6f6c 203d 2054 7275  axis: bool = Tru
+000250e0: 6529 202d 3e20 4e6f 6e65 207c 204c 6974  e) -> None | Lit
+000250f0: 6572 616c 5b30 2c20 315d 3a0a 2020 2020  eral[0, 1]:.    
+00025100: 2020 2020 6966 2061 7869 7320 6e6f 7420      if axis not 
+00025110: 696e 2028 302c 2022 696e 6465 7822 2c20  in (0, "index", 
+00025120: 4e6f 6e65 293a 0a20 2020 2020 2020 2020  None):.         
+00025130: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+00025140: 726f 7228 6622 4e6f 2061 7869 7320 6e61  ror(f"No axis na
+00025150: 6d65 6420 7b61 7869 737d 2066 6f72 2053  med {axis} for S
+00025160: 6572 6965 7322 290a 2020 2020 2020 2020  eries").        
+00025170: 6966 206e 756d 6572 6963 5f61 7869 733a  if numeric_axis:
+00025180: 0a20 2020 2020 2020 2020 2020 206e 756d  .            num
+00025190: 5f61 7869 733a 2064 6963 745b 7374 7220  _axis: dict[str 
+000251a0: 7c20 4e6f 6e65 2c20 4c69 7465 7261 6c5b  | None, Literal[
+000251b0: 302c 2031 5d5d 203d 207b 2269 6e64 6578  0, 1]] = {"index
+000251c0: 223a 2030 7d0a 2020 2020 2020 2020 2020  ": 0}.          
+000251d0: 2020 7265 7475 726e 206e 756d 5f61 7869    return num_axi
+000251e0: 732e 6765 7428 6178 6973 2c20 6178 6973  s.get(axis, axis
+000251f0: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
+00025200: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00025210: 726e 2061 7869 730a 0a20 2020 2040 6465  rn axis..    @de
+00025220: 7269 7665 645f 6672 6f6d 2870 642e 5365  rived_from(pd.Se
+00025230: 7269 6573 290a 2020 2020 6465 6620 7371  ries).    def sq
+00025240: 7565 657a 6528 7365 6c66 293a 0a20 2020  ueeze(self):.   
+00025250: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00025260: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
+00025270: 726f 6d28 7064 2e53 6572 6965 7329 0a20  rom(pd.Series). 
+00025280: 2020 2064 6566 2064 726f 706e 6128 7365     def dropna(se
+00025290: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
+000252a0: 7572 6e20 6e65 775f 636f 6c6c 6563 7469  urn new_collecti
+000252b0: 6f6e 2865 7870 722e 4472 6f70 6e61 5365  on(expr.DropnaSe
+000252c0: 7269 6573 2873 656c 6629 290a 0a20 2020  ries(self))..   
+000252d0: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
+000252e0: 642e 5365 7269 6573 290a 2020 2020 6465  d.Series).    de
+000252f0: 6620 6265 7477 6565 6e28 7365 6c66 2c20  f between(self, 
+00025300: 6c65 6674 2c20 7269 6768 742c 2069 6e63  left, right, inc
+00025310: 6c75 7369 7665 3d22 626f 7468 2229 3a0a  lusive="both"):.
+00025320: 2020 2020 2020 2020 7265 7475 726e 206e          return n
+00025330: 6577 5f63 6f6c 6c65 6374 696f 6e28 0a20  ew_collection(. 
+00025340: 2020 2020 2020 2020 2020 2065 7870 722e             expr.
+00025350: 4265 7477 6565 6e28 7365 6c66 2c20 6c65  Between(self, le
+00025360: 6674 3d6c 6566 742c 2072 6967 6874 3d72  ft=left, right=r
+00025370: 6967 6874 2c20 696e 636c 7573 6976 653d  ight, inclusive=
+00025380: 696e 636c 7573 6976 6529 0a20 2020 2020  inclusive).     
+00025390: 2020 2029 0a0a 2020 2020 4064 6572 6976     )..    @deriv
+000253a0: 6564 5f66 726f 6d28 7064 2e53 6572 6965  ed_from(pd.Serie
+000253b0: 7329 0a20 2020 2064 6566 2063 6f6d 6269  s).    def combi
+000253c0: 6e65 2873 656c 662c 206f 7468 6572 2c20  ne(self, other, 
+000253d0: 6675 6e63 2c20 6669 6c6c 5f76 616c 7565  func, fill_value
+000253e0: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
+000253f0: 6f74 6865 7220 3d20 7365 6c66 2e5f 6372  other = self._cr
+00025400: 6561 7465 5f61 6c69 676e 6162 6c65 5f66  eate_alignable_f
+00025410: 7261 6d65 286f 7468 6572 2c20 226f 7574  rame(other, "out
+00025420: 6572 2229 0a20 2020 2020 2020 2069 6620  er").        if 
+00025430: 6e6f 7420 6578 7072 2e61 7265 5f63 6f5f  not expr.are_co_
+00025440: 616c 6967 6e65 6428 7365 6c66 2e65 7870  aligned(self.exp
+00025450: 722c 206f 7468 6572 2e65 7870 7229 3a0a  r, other.expr):.
+00025460: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00025470: 726e 206e 6577 5f63 6f6c 6c65 6374 696f  rn new_collectio
+00025480: 6e28 0a20 2020 2020 2020 2020 2020 2020  n(.             
+00025490: 2020 2065 7870 722e 436f 6d62 696e 6553     expr.CombineS
+000254a0: 6572 6965 7341 6c69 676e 2873 656c 662c  eriesAlign(self,
+000254b0: 206f 7468 6572 2c20 6675 6e63 2c20 6669   other, func, fi
+000254c0: 6c6c 5f76 616c 7565 290a 2020 2020 2020  ll_value).      
+000254d0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+000254e0: 7265 7475 726e 206e 6577 5f63 6f6c 6c65  return new_colle
+000254f0: 6374 696f 6e28 6578 7072 2e43 6f6d 6269  ction(expr.Combi
+00025500: 6e65 5365 7269 6573 2873 656c 662c 206f  neSeries(self, o
+00025510: 7468 6572 2c20 6675 6e63 2c20 6669 6c6c  ther, func, fill
+00025520: 5f76 616c 7565 2929 0a0a 2020 2020 4064  _value))..    @d
+00025530: 6572 6976 6564 5f66 726f 6d28 7064 2e53  erived_from(pd.S
+00025540: 6572 6965 7329 0a20 2020 2064 6566 2065  eries).    def e
+00025550: 7870 6c6f 6465 2873 656c 6629 3a0a 2020  xplode(self):.  
+00025560: 2020 2020 2020 7265 7475 726e 206e 6577        return new
+00025570: 5f63 6f6c 6c65 6374 696f 6e28 6578 7072  _collection(expr
+00025580: 2e45 7870 6c6f 6465 5365 7269 6573 2873  .ExplodeSeries(s
+00025590: 656c 6629 290a 0a20 2020 2040 6465 7269  elf))..    @deri
+000255a0: 7665 645f 6672 6f6d 2870 642e 5365 7269  ved_from(pd.Seri
+000255b0: 6573 290a 2020 2020 6465 6620 6164 645f  es).    def add_
+000255c0: 7072 6566 6978 2873 656c 662c 2070 7265  prefix(self, pre
+000255d0: 6669 7829 3a0a 2020 2020 2020 2020 7265  fix):.        re
+000255e0: 7475 726e 206e 6577 5f63 6f6c 6c65 6374  turn new_collect
+000255f0: 696f 6e28 6578 7072 2e41 6464 5072 6566  ion(expr.AddPref
+00025600: 6978 5365 7269 6573 2873 656c 662c 2070  ixSeries(self, p
+00025610: 7265 6669 7829 290a 0a20 2020 2040 6465  refix))..    @de
+00025620: 7269 7665 645f 6672 6f6d 2870 642e 5365  rived_from(pd.Se
+00025630: 7269 6573 290a 2020 2020 6465 6620 6164  ries).    def ad
+00025640: 645f 7375 6666 6978 2873 656c 662c 2073  d_suffix(self, s
+00025650: 7566 6669 7829 3a0a 2020 2020 2020 2020  uffix):.        
+00025660: 7265 7475 726e 206e 6577 5f63 6f6c 6c65  return new_colle
+00025670: 6374 696f 6e28 6578 7072 2e41 6464 5375  ction(expr.AddSu
+00025680: 6666 6978 5365 7269 6573 2873 656c 662c  ffixSeries(self,
+00025690: 2073 7566 6669 7829 290a 0a20 2020 2063   suffix))..    c
+000256a0: 6174 203d 2043 6163 6865 6441 6363 6573  at = CachedAcces
+000256b0: 736f 7228 2263 6174 222c 2043 6174 6567  sor("cat", Categ
+000256c0: 6f72 6963 616c 4163 6365 7373 6f72 290a  oricalAccessor).
+000256d0: 2020 2020 6474 203d 2043 6163 6865 6441      dt = CachedA
+000256e0: 6363 6573 736f 7228 2264 7422 2c20 4461  ccessor("dt", Da
+000256f0: 7465 7469 6d65 4163 6365 7373 6f72 290a  tetimeAccessor).
+00025700: 2020 2020 7374 7220 3d20 4361 6368 6564      str = Cached
+00025710: 4163 6365 7373 6f72 2822 7374 7222 2c20  Accessor("str", 
+00025720: 5374 7269 6e67 4163 6365 7373 6f72 290a  StringAccessor).
+00025730: 0a20 2020 2064 6566 205f 7265 7061 7274  .    def _repart
+00025740: 6974 696f 6e5f 7175 616e 7469 6c65 7328  ition_quantiles(
+00025750: 7365 6c66 2c20 6e70 6172 7469 7469 6f6e  self, npartition
+00025760: 732c 2075 7073 616d 706c 653d 312e 302c  s, upsample=1.0,
+00025770: 2072 616e 646f 6d5f 7374 6174 653d 4e6f   random_state=No
+00025780: 6e65 293a 0a20 2020 2020 2020 2072 6574  ne):.        ret
+00025790: 7572 6e20 6e65 775f 636f 6c6c 6563 7469  urn new_collecti
+000257a0: 6f6e 280a 2020 2020 2020 2020 2020 2020  on(.            
+000257b0: 5265 7061 7274 6974 696f 6e51 7561 6e74  RepartitionQuant
+000257c0: 696c 6573 2873 656c 662c 206e 7061 7274  iles(self, npart
+000257d0: 6974 696f 6e73 2c20 7570 7361 6d70 6c65  itions, upsample
+000257e0: 2c20 7261 6e64 6f6d 5f73 7461 7465 290a  , random_state).
+000257f0: 2020 2020 2020 2020 290a 0a20 2020 2040          )..    @
+00025800: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
+00025810: 5365 7269 6573 290a 2020 2020 6465 6620  Series).    def 
+00025820: 6772 6f75 7062 7928 7365 6c66 2c20 6279  groupby(self, by
+00025830: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
+00025840: 2020 2020 2066 726f 6d20 6461 736b 5f65       from dask_e
+00025850: 7870 722e 5f67 726f 7570 6279 2069 6d70  xpr._groupby imp
+00025860: 6f72 7420 5365 7269 6573 4772 6f75 7042  ort SeriesGroupB
+00025870: 790a 0a20 2020 2020 2020 2072 6574 7572  y..        retur
+00025880: 6e20 5365 7269 6573 4772 6f75 7042 7928  n SeriesGroupBy(
+00025890: 7365 6c66 2c20 6279 2c20 2a2a 6b77 6172  self, by, **kwar
+000258a0: 6773 290a 0a20 2020 2064 6566 2072 656e  gs)..    def ren
+000258b0: 616d 6528 7365 6c66 2c20 696e 6465 782c  ame(self, index,
+000258c0: 2073 6f72 7465 645f 696e 6465 783d 4661   sorted_index=Fa
+000258d0: 6c73 6529 3a0a 2020 2020 2020 2020 2222  lse):.        ""
+000258e0: 2241 6c74 6572 2053 6572 6965 7320 696e  "Alter Series in
+000258f0: 6465 7820 6c61 6265 6c73 206f 7220 6e61  dex labels or na
+00025900: 6d65 0a0a 2020 2020 2020 2020 4675 6e63  me..        Func
+00025910: 7469 6f6e 202f 2064 6963 7420 7661 6c75  tion / dict valu
+00025920: 6573 206d 7573 7420 6265 2075 6e69 7175  es must be uniqu
+00025930: 6520 2831 2d74 6f2d 3129 2e20 4c61 6265  e (1-to-1). Labe
+00025940: 6c73 206e 6f74 2063 6f6e 7461 696e 6564  ls not contained
+00025950: 2069 6e0a 2020 2020 2020 2020 6120 6469   in.        a di
+00025960: 6374 202f 2053 6572 6965 7320 7769 6c6c  ct / Series will
+00025970: 2062 6520 6c65 6674 2061 732d 6973 2e20   be left as-is. 
+00025980: 4578 7472 6120 6c61 6265 6c73 206c 6973  Extra labels lis
+00025990: 7465 6420 646f 6e27 7420 7468 726f 7720  ted don't throw 
+000259a0: 616e 0a20 2020 2020 2020 2065 7272 6f72  an.        error
+000259b0: 2e0a 0a20 2020 2020 2020 2041 6c74 6572  ...        Alter
+000259c0: 6e61 7469 7665 6c79 2c20 6368 616e 6765  natively, change
+000259d0: 2060 6053 6572 6965 732e 6e61 6d65 6060   ``Series.name``
+000259e0: 2077 6974 6820 6120 7363 616c 6172 2076   with a scalar v
+000259f0: 616c 7565 2e0a 0a20 2020 2020 2020 2050  alue...        P
+00025a00: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
+00025a10: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
+00025a20: 2020 2020 2069 6e64 6578 203a 2073 6361       index : sca
+00025a30: 6c61 722c 2068 6173 6861 626c 6520 7365  lar, hashable se
+00025a40: 7175 656e 6365 2c20 6469 6374 2d6c 696b  quence, dict-lik
+00025a50: 6520 6f72 2063 616c 6c61 626c 652c 206f  e or callable, o
+00025a60: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
+00025a70: 2020 2020 4966 2064 6963 742d 6c69 6b65      If dict-like
+00025a80: 206f 7220 6361 6c6c 6162 6c65 2c20 7468   or callable, th
+00025a90: 6520 7472 616e 7366 6f72 6d61 7469 6f6e  e transformation
+00025aa0: 2069 7320 6170 706c 6965 6420 746f 2074   is applied to t
+00025ab0: 6865 0a20 2020 2020 2020 2020 2020 2069  he.            i
+00025ac0: 6e64 6578 2e20 5363 616c 6172 206f 7220  ndex. Scalar or 
+00025ad0: 6861 7368 6162 6c65 2073 6571 7565 6e63  hashable sequenc
+00025ae0: 652d 6c69 6b65 2077 696c 6c20 616c 7465  e-like will alte
+00025af0: 7220 7468 650a 2020 2020 2020 2020 2020  r the.          
+00025b00: 2020 6060 5365 7269 6573 2e6e 616d 6560    ``Series.name`
+00025b10: 6020 6174 7472 6962 7574 652e 0a20 2020  ` attribute..   
+00025b20: 2020 2020 2069 6e70 6c61 6365 203a 2062       inplace : b
+00025b30: 6f6f 6c65 616e 2c20 6465 6661 756c 7420  oolean, default 
+00025b40: 4661 6c73 650a 2020 2020 2020 2020 2020  False.          
+00025b50: 2020 5768 6574 6865 7220 746f 2072 6574    Whether to ret
+00025b60: 7572 6e20 6120 6e65 7720 5365 7269 6573  urn a new Series
+00025b70: 206f 7220 6d6f 6469 6679 2074 6869 7320   or modify this 
+00025b80: 6f6e 6520 696e 706c 6163 652e 0a20 2020  one inplace..   
+00025b90: 2020 2020 2073 6f72 7465 645f 696e 6465       sorted_inde
+00025ba0: 7820 3a20 626f 6f6c 2c20 6465 6661 756c  x : bool, defaul
+00025bb0: 7420 4661 6c73 650a 2020 2020 2020 2020  t False.        
+00025bc0: 2020 2020 4966 2074 7275 652c 2074 6865      If true, the
+00025bd0: 206f 7574 7075 7420 6060 5365 7269 6573   output ``Series
+00025be0: 6060 2077 696c 6c20 6861 7665 206b 6e6f  `` will have kno
+00025bf0: 776e 2064 6976 6973 696f 6e73 2069 6e66  wn divisions inf
+00025c00: 6572 7265 640a 2020 2020 2020 2020 2020  erred.          
+00025c10: 2020 6672 6f6d 2074 6865 2069 6e70 7574    from the input
+00025c20: 2073 6572 6965 7320 616e 6420 7468 6520   series and the 
+00025c30: 7472 616e 7366 6f72 6d61 7469 6f6e 2e20  transformation. 
+00025c40: 4967 6e6f 7265 6420 666f 720a 2020 2020  Ignored for.    
+00025c50: 2020 2020 2020 2020 6e6f 6e2d 6361 6c6c          non-call
+00025c60: 6162 6c65 2f64 6963 742d 6c69 6b65 2060  able/dict-like `
+00025c70: 6069 6e64 6578 6060 206f 7220 7768 656e  `index`` or when
+00025c80: 2074 6865 2069 6e70 7574 2073 6572 6965   the input serie
+00025c90: 7320 6861 730a 2020 2020 2020 2020 2020  s has.          
+00025ca0: 2020 756e 6b6e 6f77 6e20 6469 7669 7369    unknown divisi
+00025cb0: 6f6e 732e 204e 6f74 6520 7468 6174 2074  ons. Note that t
+00025cc0: 6869 7320 6d61 7920 6f6e 6c79 2062 6520  his may only be 
+00025cd0: 7365 7420 746f 2060 6054 7275 6560 6020  set to ``True`` 
+00025ce0: 6966 0a20 2020 2020 2020 2020 2020 2079  if.            y
+00025cf0: 6f75 206b 6e6f 7720 7468 6174 2074 6865  ou know that the
+00025d00: 2074 7261 6e73 666f 726d 6564 2069 6e64   transformed ind
+00025d10: 6578 2069 7320 6d6f 6e6f 746f 6e69 6361  ex is monotonica
+00025d20: 6c6c 7920 696e 6372 6561 7369 6e67 2e20  lly increasing. 
+00025d30: 4461 736b 0a20 2020 2020 2020 2020 2020  Dask.           
+00025d40: 2077 696c 6c20 6368 6563 6b20 7468 6174   will check that
+00025d50: 2074 7261 6e73 666f 726d 6564 2064 6976   transformed div
+00025d60: 6973 696f 6e73 2061 7265 206d 6f6e 6f74  isions are monot
+00025d70: 6f6e 6963 2c20 6275 7420 6361 6e6e 6f74  onic, but cannot
+00025d80: 0a20 2020 2020 2020 2020 2020 2063 6865  .            che
+00025d90: 636b 2061 6c6c 2074 6865 2076 616c 7565  ck all the value
+00025da0: 7320 6265 7477 6565 6e20 6469 7669 7369  s between divisi
+00025db0: 6f6e 732c 2073 6f20 696e 636f 7272 6563  ons, so incorrec
+00025dc0: 746c 7920 7365 7474 696e 6720 7468 6973  tly setting this
+00025dd0: 0a20 2020 2020 2020 2020 2020 2063 616e  .            can
+00025de0: 2072 6573 756c 7420 696e 2062 7567 732e   result in bugs.
+00025df0: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+00025e00: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+00025e10: 2d0a 2020 2020 2020 2020 7265 6e61 6d65  -.        rename
+00025e20: 6420 3a20 5365 7269 6573 0a0a 2020 2020  d : Series..    
+00025e30: 2020 2020 5365 6520 416c 736f 0a20 2020      See Also.   
+00025e40: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
+00025e50: 2020 2020 2020 7061 6e64 6173 2e53 6572        pandas.Ser
+00025e60: 6965 732e 7265 6e61 6d65 0a20 2020 2020  ies.rename.     
+00025e70: 2020 2022 2222 0a20 2020 2020 2020 2072     """.        r
+00025e80: 6574 7572 6e20 6e65 775f 636f 6c6c 6563  eturn new_collec
+00025e90: 7469 6f6e 2865 7870 722e 5265 6e61 6d65  tion(expr.Rename
+00025ea0: 5365 7269 6573 2873 656c 662c 2069 6e64  Series(self, ind
+00025eb0: 6578 2c20 736f 7274 6564 5f69 6e64 6578  ex, sorted_index
+00025ec0: 2929 0a0a 2020 2020 6465 6620 7175 616e  ))..    def quan
+00025ed0: 7469 6c65 2873 656c 662c 2071 3d30 2e35  tile(self, q=0.5
+00025ee0: 2c20 6d65 7468 6f64 3d22 6465 6661 756c  , method="defaul
+00025ef0: 7422 293a 0a20 2020 2020 2020 2022 2222  t"):.        """
+00025f00: 4170 7072 6f78 696d 6174 6520 7175 616e  Approximate quan
+00025f10: 7469 6c65 7320 6f66 2053 6572 6965 730a  tiles of Series.
+00025f20: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+00025f30: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
+00025f40: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2071  ------.        q
+00025f50: 203a 206c 6973 742f 6172 7261 7920 6f66   : list/array of
+00025f60: 2066 6c6f 6174 732c 2064 6566 6175 6c74   floats, default
+00025f70: 2030 2e35 2028 3530 2529 0a20 2020 2020   0.5 (50%).     
+00025f80: 2020 2020 2020 2049 7465 7261 626c 6520         Iterable 
+00025f90: 6f66 206e 756d 6265 7273 2072 616e 6769  of numbers rangi
+00025fa0: 6e67 2066 726f 6d20 3020 746f 2031 2066  ng from 0 to 1 f
+00025fb0: 6f72 2074 6865 2064 6573 6972 6564 2071  or the desired q
+00025fc0: 7561 6e74 696c 6573 0a20 2020 2020 2020  uantiles.       
+00025fd0: 206d 6574 686f 6420 3a20 7b27 6465 6661   method : {'defa
+00025fe0: 756c 7427 2c20 2774 6469 6765 7374 272c  ult', 'tdigest',
+00025ff0: 2027 6461 736b 277d 2c20 6f70 7469 6f6e   'dask'}, option
+00026000: 616c 0a20 2020 2020 2020 2020 2020 2057  al.            W
+00026010: 6861 7420 6d65 7468 6f64 2074 6f20 7573  hat method to us
+00026020: 652e 2042 7920 6465 6661 756c 7420 7769  e. By default wi
+00026030: 6c6c 2075 7365 2064 6173 6b27 7320 696e  ll use dask's in
+00026040: 7465 726e 616c 2063 7573 746f 6d0a 2020  ternal custom.  
+00026050: 2020 2020 2020 2020 2020 616c 676f 7269            algori
+00026060: 7468 6d20 2860 6027 6461 736b 2760 6029  thm (``'dask'``)
+00026070: 2e20 2049 6620 7365 7420 746f 2060 6027  .  If set to ``'
+00026080: 7464 6967 6573 7427 6060 2077 696c 6c20  tdigest'`` will 
+00026090: 7573 6520 7464 6967 6573 740a 2020 2020  use tdigest.    
+000260a0: 2020 2020 2020 2020 666f 7220 666c 6f61          for floa
+000260b0: 7473 2061 6e64 2069 6e74 7320 616e 6420  ts and ints and 
+000260c0: 6661 6c6c 6261 636b 2074 6f20 7468 6520  fallback to the 
+000260d0: 6060 2764 6173 6b27 6060 206f 7468 6572  ``'dask'`` other
+000260e0: 7769 7365 2e0a 2020 2020 2020 2020 2222  wise..        ""
+000260f0: 220a 2020 2020 2020 2020 5f72 6169 7365  ".        _raise
+00026100: 5f69 665f 6f62 6a65 6374 5f73 6572 6965  _if_object_serie
+00026110: 7328 7365 6c66 2c20 2271 7561 6e74 696c  s(self, "quantil
+00026120: 6522 290a 2020 2020 2020 2020 616c 6c6f  e").        allo
+00026130: 7765 645f 6d65 7468 6f64 7320 3d20 5b22  wed_methods = ["
+00026140: 6465 6661 756c 7422 2c20 2264 6173 6b22  default", "dask"
+00026150: 2c20 2274 6469 6765 7374 225d 0a20 2020  , "tdigest"].   
+00026160: 2020 2020 2069 6620 6d65 7468 6f64 206e       if method n
+00026170: 6f74 2069 6e20 616c 6c6f 7765 645f 6d65  ot in allowed_me
+00026180: 7468 6f64 733a 0a20 2020 2020 2020 2020  thods:.         
+00026190: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+000261a0: 726f 7228 226d 6574 686f 6420 6361 6e20  ror("method can 
+000261b0: 6f6e 6c79 2062 6520 2764 6566 6175 6c74  only be 'default
+000261c0: 272c 2027 6461 736b 2720 6f72 2027 7464  ', 'dask' or 'td
+000261d0: 6967 6573 7427 2229 0a20 2020 2020 2020  igest'").       
+000261e0: 2072 6574 7572 6e20 6e65 775f 636f 6c6c   return new_coll
+000261f0: 6563 7469 6f6e 2853 6572 6965 7351 7561  ection(SeriesQua
+00026200: 6e74 696c 6528 7365 6c66 2c20 712c 206d  ntile(self, q, m
+00026210: 6574 686f 6429 290a 0a20 2020 2040 6465  ethod))..    @de
+00026220: 7269 7665 645f 6672 6f6d 2870 642e 5365  rived_from(pd.Se
+00026230: 7269 6573 290a 2020 2020 6465 6620 6d65  ries).    def me
+00026240: 6469 616e 2873 656c 6629 3a0a 2020 2020  dian(self):.    
+00026250: 2020 2020 6966 2073 656c 662e 6e70 6172      if self.npar
+00026260: 7469 7469 6f6e 7320 3d3d 2031 3a0a 2020  titions == 1:.  
+00026270: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00026280: 2073 656c 662e 6d65 6469 616e 5f61 7070   self.median_app
+00026290: 726f 7869 6d61 7465 2829 0a20 2020 2020  roximate().     
+000262a0: 2020 2072 6169 7365 204e 6f74 496d 706c     raise NotImpl
+000262b0: 656d 656e 7465 6445 7272 6f72 280a 2020  ementedError(.  
+000262c0: 2020 2020 2020 2020 2020 2244 6173 6b20            "Dask 
+000262d0: 646f 6573 6e27 7420 696d 706c 656d 656e  doesn't implemen
+000262e0: 7420 616e 2065 7861 6374 206d 6564 6961  t an exact media
+000262f0: 6e20 696e 2061 6c6c 2063 6173 6573 2061  n in all cases a
+00026300: 7320 7468 6973 2069 7320 6861 7264 2074  s this is hard t
+00026310: 6f20 646f 2069 6e20 7061 7261 6c6c 656c  o do in parallel
+00026320: 2e20 220a 2020 2020 2020 2020 2020 2020  . ".            
+00026330: 2253 6565 2074 6865 2060 6d65 6469 616e  "See the `median
+00026340: 5f61 7070 726f 7869 6d61 7465 6020 6d65  _approximate` me
+00026350: 7468 6f64 2069 6e73 7465 6164 2c20 7768  thod instead, wh
+00026360: 6963 6820 7573 6573 2061 6e20 6170 7072  ich uses an appr
+00026370: 6f78 696d 6174 6520 616c 676f 7269 7468  oximate algorith
+00026380: 6d2e 220a 2020 2020 2020 2020 290a 0a20  m.".        ).. 
+00026390: 2020 2064 6566 206d 6564 6961 6e5f 6170     def median_ap
+000263a0: 7072 6f78 696d 6174 6528 7365 6c66 2c20  proximate(self, 
+000263b0: 6d65 7468 6f64 3d22 6465 6661 756c 7422  method="default"
+000263c0: 293a 0a20 2020 2020 2020 2022 2222 5265  ):.        """Re
+000263d0: 7475 726e 2074 6865 2061 7070 726f 7869  turn the approxi
+000263e0: 6d61 7465 206d 6564 6961 6e20 6f66 2074  mate median of t
+000263f0: 6865 2076 616c 7565 7320 6f76 6572 2074  he values over t
+00026400: 6865 2072 6571 7565 7374 6564 2061 7869  he requested axi
+00026410: 732e 0a0a 2020 2020 2020 2020 5061 7261  s...        Para
+00026420: 6d65 7465 7273 0a20 2020 2020 2020 202d  meters.        -
+00026430: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+00026440: 2020 6d65 7468 6f64 203a 207b 2764 6566    method : {'def
+00026450: 6175 6c74 272c 2027 7464 6967 6573 7427  ault', 'tdigest'
+00026460: 2c20 2764 6173 6b27 7d2c 206f 7074 696f  , 'dask'}, optio
+00026470: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
+00026480: 5768 6174 206d 6574 686f 6420 746f 2075  What method to u
+00026490: 7365 2e20 4279 2064 6566 6175 6c74 2077  se. By default w
+000264a0: 696c 6c20 7573 6520 4461 736b 2773 2069  ill use Dask's i
+000264b0: 6e74 6572 6e61 6c20 6375 7374 6f6d 0a20  nternal custom. 
+000264c0: 2020 2020 2020 2020 2020 2061 6c67 6f72             algor
+000264d0: 6974 686d 2028 6060 2264 6173 6b22 6060  ithm (``"dask"``
+000264e0: 292e 2020 4966 2073 6574 2074 6f20 6060  ).  If set to ``
+000264f0: 2274 6469 6765 7374 2260 6020 7769 6c6c  "tdigest"`` will
+00026500: 2075 7365 2074 6469 6765 7374 0a20 2020   use tdigest.   
+00026510: 2020 2020 2020 2020 2066 6f72 2066 6c6f           for flo
+00026520: 6174 7320 616e 6420 696e 7473 2061 6e64  ats and ints and
+00026530: 2066 616c 6c62 6163 6b20 746f 2074 6865   fallback to the
+00026540: 2060 6022 6461 736b 2260 6020 6f74 6865   ``"dask"`` othe
+00026550: 7277 6973 652e 0a20 2020 2020 2020 2022  rwise..        "
+00026560: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
+00026570: 6e20 7365 6c66 2e71 7561 6e74 696c 6528  n self.quantile(
+00026580: 6d65 7468 6f64 3d6d 6574 686f 6429 0a0a  method=method)..
+00026590: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
+000265a0: 6d28 7064 2e53 6572 6965 7329 0a20 2020  m(pd.Series).   
+000265b0: 2064 6566 2063 6f76 2873 656c 662c 206f   def cov(self, o
+000265c0: 7468 6572 2c20 6d69 6e5f 7065 7269 6f64  ther, min_period
+000265d0: 733d 4e6f 6e65 2c20 7370 6c69 745f 6576  s=None, split_ev
+000265e0: 6572 793d 4661 6c73 6529 3a0a 2020 2020  ery=False):.    
+000265f0: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
+00026600: 7461 6e63 6528 6f74 6865 722c 2053 6572  tance(other, Ser
+00026610: 6965 7329 3a0a 2020 2020 2020 2020 2020  ies):.          
+00026620: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
+00026630: 7228 226f 7468 6572 206d 7573 7420 6265  r("other must be
+00026640: 2061 2064 6173 6b2e 6461 7461 6672 616d   a dask.datafram
+00026650: 652e 5365 7269 6573 2229 0a20 2020 2020  e.Series").     
+00026660: 2020 2064 6620 3d20 636f 6e63 6174 285b     df = concat([
+00026670: 7365 6c66 2c20 6f74 6865 725d 2c20 6178  self, other], ax
+00026680: 6973 3d31 290a 2020 2020 2020 2020 7265  is=1).        re
+00026690: 7475 726e 2064 662e 5f63 6f76 286d 696e  turn df._cov(min
+000266a0: 5f70 6572 696f 6473 2c20 5472 7565 2c20  _periods, True, 
+000266b0: 7370 6c69 745f 6576 6572 792c 2073 6361  split_every, sca
+000266c0: 6c61 723d 5472 7565 290a 0a20 2020 2040  lar=True)..    @
+000266d0: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
+000266e0: 5365 7269 6573 290a 2020 2020 6465 6620  Series).    def 
+000266f0: 636f 7272 2873 656c 662c 206f 7468 6572  corr(self, other
+00026700: 2c20 6d65 7468 6f64 3d22 7065 6172 736f  , method="pearso
+00026710: 6e22 2c20 6d69 6e5f 7065 7269 6f64 733d  n", min_periods=
+00026720: 4e6f 6e65 2c20 7370 6c69 745f 6576 6572  None, split_ever
+00026730: 793d 4661 6c73 6529 3a0a 2020 2020 2020  y=False):.      
+00026740: 2020 6966 206e 6f74 2069 7369 6e73 7461    if not isinsta
+00026750: 6e63 6528 6f74 6865 722c 2053 6572 6965  nce(other, Serie
+00026760: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
+00026770: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
+00026780: 226f 7468 6572 206d 7573 7420 6265 2061  "other must be a
+00026790: 2064 6173 6b2e 6461 7461 6672 616d 652e   dask.dataframe.
+000267a0: 5365 7269 6573 2229 0a20 2020 2020 2020  Series").       
+000267b0: 2064 6620 3d20 636f 6e63 6174 285b 7365   df = concat([se
+000267c0: 6c66 2c20 6f74 6865 725d 2c20 6178 6973  lf, other], axis
+000267d0: 3d31 290a 2020 2020 2020 2020 7265 7475  =1).        retu
+000267e0: 726e 2064 662e 5f63 6f72 7228 6d65 7468  rn df._corr(meth
+000267f0: 6f64 2c20 6d69 6e5f 7065 7269 6f64 732c  od, min_periods,
+00026800: 2054 7275 652c 2073 706c 6974 5f65 7665   True, split_eve
+00026810: 7279 2c20 7363 616c 6172 3d54 7275 6529  ry, scalar=True)
+00026820: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
+00026830: 726f 6d28 7064 2e53 6572 6965 7329 0a20  rom(pd.Series). 
+00026840: 2020 2064 6566 2061 7574 6f63 6f72 7228     def autocorr(
+00026850: 7365 6c66 2c20 6c61 673d 312c 2073 706c  self, lag=1, spl
+00026860: 6974 5f65 7665 7279 3d46 616c 7365 293a  it_every=False):
+00026870: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
+00026880: 6973 696e 7374 616e 6365 286c 6167 2c20  isinstance(lag, 
+00026890: 496e 7465 6772 616c 293a 0a20 2020 2020  Integral):.     
+000268a0: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
+000268b0: 6545 7272 6f72 2822 6c61 6720 6d75 7374  eError("lag must
+000268c0: 2062 6520 616e 2069 6e74 6567 6572 2229   be an integer")
+000268d0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+000268e0: 7365 6c66 2e63 6f72 7228 7365 6c66 2069  self.corr(self i
+000268f0: 6620 6c61 6720 3d3d 2030 2065 6c73 6520  f lag == 0 else 
+00026900: 7365 6c66 2e73 6869 6674 286c 6167 292c  self.shift(lag),
+00026910: 2073 706c 6974 5f65 7665 7279 3d73 706c   split_every=spl
+00026920: 6974 5f65 7665 7279 290a 0a20 2020 2040  it_every)..    @
+00026930: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
+00026940: 5365 7269 6573 290a 2020 2020 6465 6620  Series).    def 
+00026950: 6465 7363 7269 6265 280a 2020 2020 2020  describe(.      
+00026960: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+00026970: 7370 6c69 745f 6576 6572 793d 4661 6c73  split_every=Fals
+00026980: 652c 0a20 2020 2020 2020 2070 6572 6365  e,.        perce
+00026990: 6e74 696c 6573 3d4e 6f6e 652c 0a20 2020  ntiles=None,.   
+000269a0: 2020 2020 2070 6572 6365 6e74 696c 6573       percentiles
+000269b0: 5f6d 6574 686f 643d 2264 6566 6175 6c74  _method="default
+000269c0: 222c 0a20 2020 2020 2020 2069 6e63 6c75  ",.        inclu
+000269d0: 6465 3d4e 6f6e 652c 0a20 2020 2020 2020  de=None,.       
+000269e0: 2065 7863 6c75 6465 3d4e 6f6e 652c 0a20   exclude=None,. 
+000269f0: 2020 2029 3a0a 2020 2020 2020 2020 6966     ):.        if
+00026a00: 2028 0a20 2020 2020 2020 2020 2020 2069   (.            i
+00026a10: 735f 6e75 6d65 7269 635f 6474 7970 6528  s_numeric_dtype(
+00026a20: 7365 6c66 2e64 7479 7065 290a 2020 2020  self.dtype).    
+00026a30: 2020 2020 2020 2020 616e 6420 6e6f 7420          and not 
+00026a40: 6973 5f62 6f6f 6c5f 6474 7970 6528 7365  is_bool_dtype(se
+00026a50: 6c66 2e64 7479 7065 290a 2020 2020 2020  lf.dtype).      
+00026a60: 2020 2020 2020 6f72 2069 735f 7469 6d65        or is_time
+00026a70: 6465 6c74 6136 345f 6474 7970 6528 7365  delta64_dtype(se
+00026a80: 6c66 2e64 7479 7065 290a 2020 2020 2020  lf.dtype).      
+00026a90: 2020 2020 2020 6f72 2069 735f 6461 7465        or is_date
+00026aa0: 7469 6d65 3634 5f61 6e79 5f64 7479 7065  time64_any_dtype
+00026ab0: 2873 656c 662e 6474 7970 6529 0a20 2020  (self.dtype).   
+00026ac0: 2020 2020 2029 3a0a 2020 2020 2020 2020       ):.        
+00026ad0: 2020 2020 7265 7475 726e 206e 6577 5f63      return new_c
+00026ae0: 6f6c 6c65 6374 696f 6e28 0a20 2020 2020  ollection(.     
+00026af0: 2020 2020 2020 2020 2020 2044 6573 6372             Descr
+00026b00: 6962 654e 756d 6572 6963 2873 656c 662c  ibeNumeric(self,
+00026b10: 2073 706c 6974 5f65 7665 7279 2c20 7065   split_every, pe
+00026b20: 7263 656e 7469 6c65 732c 2070 6572 6365  rcentiles, perce
+00026b30: 6e74 696c 6573 5f6d 6574 686f 6429 0a20  ntiles_method). 
+00026b40: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00026b50: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00026b60: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
+00026b70: 775f 636f 6c6c 6563 7469 6f6e 280a 2020  w_collection(.  
+00026b80: 2020 2020 2020 2020 2020 2020 2020 4465                De
+00026b90: 7363 7269 6265 4e6f 6e4e 756d 6572 6963  scribeNonNumeric
+00026ba0: 2873 656c 662c 2073 706c 6974 5f65 7665  (self, split_eve
+00026bb0: 7279 2c20 7065 7263 656e 7469 6c65 732c  ry, percentiles,
+00026bc0: 2070 6572 6365 6e74 696c 6573 5f6d 6574   percentiles_met
+00026bd0: 686f 6429 0a20 2020 2020 2020 2020 2020  hod).           
+00026be0: 2029 0a0a 2020 2020 4070 726f 7065 7274   )..    @propert
+00026bf0: 790a 2020 2020 4064 6572 6976 6564 5f66  y.    @derived_f
+00026c00: 726f 6d28 7064 2e53 6572 6965 7329 0a20  rom(pd.Series). 
+00026c10: 2020 2064 6566 2069 735f 6d6f 6e6f 746f     def is_monoto
+00026c20: 6e69 635f 696e 6372 6561 7369 6e67 2873  nic_increasing(s
+00026c30: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
+00026c40: 7475 726e 206e 6577 5f63 6f6c 6c65 6374  turn new_collect
+00026c50: 696f 6e28 4973 4d6f 6e6f 746f 6e69 6349  ion(IsMonotonicI
+00026c60: 6e63 7265 6173 696e 6728 7365 6c66 2929  ncreasing(self))
+00026c70: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
+00026c80: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
+00026c90: 6d28 7064 2e53 6572 6965 7329 0a20 2020  m(pd.Series).   
+00026ca0: 2064 6566 2069 735f 6d6f 6e6f 746f 6e69   def is_monotoni
+00026cb0: 635f 6465 6372 6561 7369 6e67 2873 656c  c_decreasing(sel
+00026cc0: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
+00026cd0: 726e 206e 6577 5f63 6f6c 6c65 6374 696f  rn new_collectio
+00026ce0: 6e28 4973 4d6f 6e6f 746f 6e69 6344 6563  n(IsMonotonicDec
+00026cf0: 7265 6173 696e 6728 7365 6c66 2929 0a0a  reasing(self))..
+00026d00: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
+00026d10: 6d28 7064 2e53 6572 6965 7329 0a20 2020  m(pd.Series).   
+00026d20: 2064 6566 2074 6f5f 7374 7269 6e67 2873   def to_string(s
+00026d30: 656c 662c 206d 6178 5f72 6f77 733d 3529  elf, max_rows=5)
+00026d40: 3a0a 2020 2020 2020 2020 2320 6f70 7469  :.        # opti
+00026d50: 6f6e 5f63 6f6e 7465 7874 2064 6f65 736e  on_context doesn
+00026d60: 2774 2061 6666 6563 740a 2020 2020 2020  't affect.      
+00026d70: 2020 7265 7475 726e 2073 656c 662e 5f72    return self._r
+00026d80: 6570 725f 6461 7461 2829 2e74 6f5f 7374  epr_data().to_st
+00026d90: 7269 6e67 286d 6178 5f72 6f77 733d 6d61  ring(max_rows=ma
+00026da0: 785f 726f 7773 290a 0a20 2020 2064 6566  x_rows)..    def
+00026db0: 205f 7265 7072 5f64 6174 6128 7365 6c66   _repr_data(self
+00026dc0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+00026dd0: 6e20 5f72 6570 725f 6461 7461 5f73 6572  n _repr_data_ser
+00026de0: 6965 7328 7365 6c66 2e5f 6d65 7461 2c20  ies(self._meta, 
+00026df0: 7365 6c66 2e5f 7265 7072 5f64 6976 6973  self._repr_divis
+00026e00: 696f 6e73 290a 0a20 2020 2069 6620 5041  ions)..    if PA
+00026e10: 4e44 4153 5f47 455f 3232 303a 0a0a 2020  NDAS_GE_220:..  
+00026e20: 2020 2020 2020 4064 6572 6976 6564 5f66        @derived_f
+00026e30: 726f 6d28 7064 2e53 6572 6965 7329 0a20  rom(pd.Series). 
+00026e40: 2020 2020 2020 2064 6566 2063 6173 655f         def case_
+00026e50: 7768 656e 2873 656c 662c 2063 6173 656c  when(self, casel
+00026e60: 6973 7429 3a0a 2020 2020 2020 2020 2020  ist):.          
+00026e70: 2020 6966 206e 6f74 2069 7369 6e73 7461    if not isinsta
+00026e80: 6e63 6528 6361 7365 6c69 7374 2c20 6c69  nce(caselist, li
+00026e90: 7374 293a 0a20 2020 2020 2020 2020 2020  st):.           
+00026ea0: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
+00026eb0: 7272 6f72 2822 5468 6520 6361 7365 6c69  rror("The caseli
+00026ec0: 7374 2061 7267 756d 656e 7420 7368 6f75  st argument shou
+00026ed0: 6c64 2062 6520 6120 6c69 7374 2229 0a20  ld be a list"). 
+00026ee0: 2020 2020 2020 2020 2020 2063 6173 656c             casel
+00026ef0: 6973 7420 3d20 6c69 7374 2866 6c61 7474  ist = list(flatt
+00026f00: 656e 285b 5b63 2c20 765d 2066 6f72 2063  en([[c, v] for c
+00026f10: 2c20 7620 696e 2063 6173 656c 6973 745d  , v in caselist]
+00026f20: 2c20 636f 6e74 6169 6e65 723d 6c69 7374  , container=list
+00026f30: 2929 0a20 2020 2020 2020 2020 2020 2072  )).            r
+00026f40: 6574 7572 6e20 6e65 775f 636f 6c6c 6563  eturn new_collec
+00026f50: 7469 6f6e 2865 7870 722e 4361 7365 5768  tion(expr.CaseWh
+00026f60: 656e 2873 656c 662c 202a 6361 7365 6c69  en(self, *caseli
+00026f70: 7374 2929 0a0a 0a66 6f72 206e 616d 6520  st))...for name 
+00026f80: 696e 205b 0a20 2020 2022 6164 6422 2c0a  in [.    "add",.
+00026f90: 2020 2020 2273 7562 222c 0a20 2020 2022      "sub",.    "
+00026fa0: 6d75 6c22 2c0a 2020 2020 2264 6976 222c  mul",.    "div",
+00026fb0: 0a20 2020 2022 6469 7669 6465 222c 0a20  .    "divide",. 
+00026fc0: 2020 2022 7472 7565 6469 7622 2c0a 2020     "truediv",.  
+00026fd0: 2020 2266 6c6f 6f72 6469 7622 2c0a 2020    "floordiv",.  
+00026fe0: 2020 226d 6f64 222c 0a20 2020 2022 706f    "mod",.    "po
+00026ff0: 7722 2c0a 2020 2020 2272 6164 6422 2c0a  w",.    "radd",.
+00027000: 2020 2020 2272 7375 6222 2c0a 2020 2020      "rsub",.    
+00027010: 2272 6d75 6c22 2c0a 2020 2020 2272 6469  "rmul",.    "rdi
+00027020: 7622 2c0a 2020 2020 2272 7472 7565 6469  v",.    "rtruedi
+00027030: 7622 2c0a 2020 2020 2272 666c 6f6f 7264  v",.    "rfloord
+00027040: 6976 222c 0a20 2020 2022 726d 6f64 222c  iv",.    "rmod",
+00027050: 0a20 2020 2022 7270 6f77 222c 0a5d 3a0a  .    "rpow",.]:.
+00027060: 2020 2020 6173 7365 7274 206e 6f74 2068      assert not h
+00027070: 6173 6174 7472 2844 6174 6146 7261 6d65  asattr(DataFrame
+00027080: 2c20 6e61 6d65 292c 206e 616d 650a 2020  , name), name.  
+00027090: 2020 7365 7461 7474 7228 4461 7461 4672    setattr(DataFr
+000270a0: 616d 652c 206e 616d 652c 205f 7772 6170  ame, name, _wrap
+000270b0: 5f65 7870 725f 6d65 7468 6f64 5f6f 7065  _expr_method_ope
+000270c0: 7261 746f 7228 6e61 6d65 2c20 4461 7461  rator(name, Data
+000270d0: 4672 616d 6529 290a 0a20 2020 2061 7373  Frame))..    ass
+000270e0: 6572 7420 6e6f 7420 6861 7361 7474 7228  ert not hasattr(
+000270f0: 5365 7269 6573 2c20 6e61 6d65 292c 206e  Series, name), n
+00027100: 616d 650a 2020 2020 7365 7461 7474 7228  ame.    setattr(
+00027110: 5365 7269 6573 2c20 6e61 6d65 2c20 5f77  Series, name, _w
+00027120: 7261 705f 6578 7072 5f6d 6574 686f 645f  rap_expr_method_
+00027130: 6f70 6572 6174 6f72 286e 616d 652c 2053  operator(name, S
+00027140: 6572 6965 7329 290a 0a0a 636c 6173 7320  eries))...class 
+00027150: 496e 6465 7828 5365 7269 6573 293a 0a20  Index(Series):. 
+00027160: 2020 2022 2222 496e 6465 782d 6c69 6b65     """Index-like
+00027170: 2045 7870 7220 436f 6c6c 6563 7469 6f6e   Expr Collection
+00027180: 2222 220a 0a20 2020 205f 6163 6365 7373  """..    _access
+00027190: 6f72 733a 2043 6c61 7373 5661 725b 7365  ors: ClassVar[se
+000271a0: 745b 7374 725d 5d20 3d20 7365 7428 290a  t[str]] = set().
+000271b0: 2020 2020 5f70 6172 7469 7469 6f6e 5f74      _partition_t
+000271c0: 7970 6520 3d20 7064 2e49 6e64 6578 0a0a  ype = pd.Index..
+000271d0: 2020 2020 5f64 745f 6174 7472 6962 7574      _dt_attribut
+000271e0: 6573 203d 207b 0a20 2020 2020 2020 2022  es = {.        "
+000271f0: 6e61 6e6f 7365 636f 6e64 222c 0a20 2020  nanosecond",.   
+00027200: 2020 2020 2022 6d69 6372 6f73 6563 6f6e       "microsecon
+00027210: 6422 2c0a 2020 2020 2020 2020 226d 696c  d",.        "mil
+00027220: 6c69 7365 636f 6e64 222c 0a20 2020 2020  lisecond",.     
+00027230: 2020 2022 6461 796f 6679 6561 7222 2c0a     "dayofyear",.
+00027240: 2020 2020 2020 2020 226d 696e 7574 6522          "minute"
+00027250: 2c0a 2020 2020 2020 2020 2268 6f75 7222  ,.        "hour"
+00027260: 2c0a 2020 2020 2020 2020 2264 6179 222c  ,.        "day",
+00027270: 0a20 2020 2020 2020 2022 6461 796f 6677  .        "dayofw
+00027280: 6565 6b22 2c0a 2020 2020 2020 2020 2273  eek",.        "s
+00027290: 6563 6f6e 6422 2c0a 2020 2020 2020 2020  econd",.        
+000272a0: 2277 6565 6b22 2c0a 2020 2020 2020 2020  "week",.        
+000272b0: 2277 6565 6b64 6179 222c 0a20 2020 2020  "weekday",.     
+000272c0: 2020 2022 7765 656b 6f66 7965 6172 222c     "weekofyear",
+000272d0: 0a20 2020 2020 2020 2022 6d6f 6e74 6822  .        "month"
+000272e0: 2c0a 2020 2020 2020 2020 2271 7561 7274  ,.        "quart
+000272f0: 6572 222c 0a20 2020 2020 2020 2022 7965  er",.        "ye
+00027300: 6172 222c 0a20 2020 207d 0a0a 2020 2020  ar",.    }..    
+00027310: 5f63 6174 5f61 7474 7269 6275 7465 7320  _cat_attributes 
+00027320: 3d20 7b0a 2020 2020 2020 2020 226b 6e6f  = {.        "kno
+00027330: 776e 222c 0a20 2020 2020 2020 2022 6173  wn",.        "as
+00027340: 5f6b 6e6f 776e 222c 0a20 2020 2020 2020  _known",.       
+00027350: 2022 6173 5f75 6e6b 6e6f 776e 222c 0a20   "as_unknown",. 
+00027360: 2020 2020 2020 2022 6164 645f 6361 7465         "add_cate
+00027370: 676f 7269 6573 222c 0a20 2020 2020 2020  gories",.       
+00027380: 2022 6361 7465 676f 7269 6573 222c 0a20   "categories",. 
+00027390: 2020 2020 2020 2022 7265 6d6f 7665 5f63         "remove_c
+000273a0: 6174 6567 6f72 6965 7322 2c0a 2020 2020  ategories",.    
+000273b0: 2020 2020 2272 656f 7264 6572 5f63 6174      "reorder_cat
+000273c0: 6567 6f72 6965 7322 2c0a 2020 2020 2020  egories",.      
+000273d0: 2020 2261 735f 6f72 6465 7265 6422 2c0a    "as_ordered",.
+000273e0: 2020 2020 2020 2020 2263 6f64 6573 222c          "codes",
+000273f0: 0a20 2020 2020 2020 2022 7265 6d6f 7665  .        "remove
+00027400: 5f75 6e75 7365 645f 6361 7465 676f 7269  _unused_categori
+00027410: 6573 222c 0a20 2020 2020 2020 2022 7365  es",.        "se
+00027420: 745f 6361 7465 676f 7269 6573 222c 0a20  t_categories",. 
+00027430: 2020 2020 2020 2022 6173 5f75 6e6f 7264         "as_unord
+00027440: 6572 6564 222c 0a20 2020 2020 2020 2022  ered",.        "
+00027450: 6f72 6465 7265 6422 2c0a 2020 2020 2020  ordered",.      
+00027460: 2020 2272 656e 616d 655f 6361 7465 676f    "rename_catego
+00027470: 7269 6573 222c 0a20 2020 207d 0a0a 2020  ries",.    }..  
+00027480: 2020 6465 6620 5f5f 6765 7461 7474 725f    def __getattr_
+00027490: 5f28 7365 6c66 2c20 6b65 7929 3a0a 2020  _(self, key):.  
+000274a0: 2020 2020 2020 6966 2028 0a20 2020 2020        if (.     
+000274b0: 2020 2020 2020 2069 7369 6e73 7461 6e63         isinstanc
+000274c0: 6528 7365 6c66 2e5f 6d65 7461 2e64 7479  e(self._meta.dty
+000274d0: 7065 2c20 7064 2e43 6174 6567 6f72 6963  pe, pd.Categoric
+000274e0: 616c 4474 7970 6529 0a20 2020 2020 2020  alDtype).       
+000274f0: 2020 2020 2061 6e64 206b 6579 2069 6e20       and key in 
+00027500: 7365 6c66 2e5f 6361 745f 6174 7472 6962  self._cat_attrib
+00027510: 7574 6573 0a20 2020 2020 2020 2029 3a0a  utes.        ):.
+00027520: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00027530: 726e 2067 6574 6174 7472 2873 656c 662e  rn getattr(self.
+00027540: 6361 742c 206b 6579 290a 2020 2020 2020  cat, key).      
+00027550: 2020 656c 6966 206b 6579 2069 6e20 7365    elif key in se
+00027560: 6c66 2e5f 6474 5f61 7474 7269 6275 7465  lf._dt_attribute
+00027570: 733a 0a20 2020 2020 2020 2020 2020 2072  s:.            r
+00027580: 6574 7572 6e20 6765 7461 7474 7228 7365  eturn getattr(se
+00027590: 6c66 2e64 742c 206b 6579 290a 0a20 2020  lf.dt, key)..   
+000275a0: 2020 2020 2069 6620 6861 7361 7474 7228       if hasattr(
+000275b0: 7375 7065 7228 292c 206b 6579 293a 2020  super(), key):  
+000275c0: 2320 446f 6573 6e27 7420 7472 6967 6765  # Doesn't trigge
+000275d0: 7220 7375 7065 7228 292e 5f5f 6765 7461  r super().__geta
+000275e0: 7474 725f 5f0a 2020 2020 2020 2020 2020  ttr__.          
+000275f0: 2020 2320 4e6f 7420 6120 6d61 6769 6320    # Not a magic 
+00027600: 6174 7472 6962 7574 652e 2054 6869 7320  attribute. This 
+00027610: 6973 2061 2072 6561 6c20 6d65 7468 6f64  is a real method
+00027620: 206f 7220 7072 6f70 6572 7479 206f 6620   or property of 
+00027630: 5365 7269 6573 2074 6861 740a 2020 2020  Series that.    
+00027640: 2020 2020 2020 2020 2320 6861 7320 6265          # has be
+00027650: 656e 206f 7665 7272 6964 6465 6e20 6279  en overridden by
+00027660: 2052 6169 7365 4174 7472 6962 7574 6545   RaiseAttributeE
+00027670: 7272 6f72 2829 2e0a 2020 2020 2020 2020  rror()..        
+00027680: 2020 2020 7261 6973 6520 4174 7472 6962      raise Attrib
+00027690: 7574 6545 7272 6f72 280a 2020 2020 2020  uteError(.      
+000276a0: 2020 2020 2020 2020 2020 6622 7b73 656c            f"{sel
+000276b0: 662e 5f5f 636c 6173 735f 5f2e 5f5f 6e61  f.__class__.__na
+000276c0: 6d65 5f5f 2172 7d20 6f62 6a65 6374 2068  me__!r} object h
+000276d0: 6173 206e 6f20 6174 7472 6962 7574 6520  as no attribute 
+000276e0: 7b6b 6579 2172 7d22 0a20 2020 2020 2020  {key!r}".       
+000276f0: 2020 2020 2029 0a20 2020 2020 2020 2072       ).        r
+00027700: 6574 7572 6e20 7375 7065 7228 292e 5f5f  eturn super().__
+00027710: 6765 7461 7474 725f 5f28 6b65 7929 0a0a  getattr__(key)..
+00027720: 2020 2020 6465 6620 5f5f 7265 7072 5f5f      def __repr__
+00027730: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00027740: 7265 7475 726e 2066 223c 6461 736b 5f65  return f"<dask_e
+00027750: 7870 722e 6578 7072 2e49 6e64 6578 3a20  xpr.expr.Index: 
+00027760: 6578 7072 3d7b 7365 6c66 2e65 7870 727d  expr={self.expr}
+00027770: 3e22 0a0a 2020 2020 6465 6620 5f5f 6172  >"..    def __ar
+00027780: 7261 795f 7772 6170 5f5f 2873 656c 662c  ray_wrap__(self,
+00027790: 2061 7272 6179 2c20 636f 6e74 6578 743d   array, context=
+000277a0: 4e6f 6e65 293a 0a20 2020 2020 2020 2072  None):.        r
+000277b0: 6574 7572 6e20 7064 2e49 6e64 6578 2861  eturn pd.Index(a
+000277c0: 7272 6179 2c20 6e61 6d65 3d73 656c 662e  rray, name=self.
+000277d0: 6e61 6d65 290a 0a20 2020 2040 6465 7269  name)..    @deri
+000277e0: 7665 645f 6672 6f6d 2870 642e 496e 6465  ved_from(pd.Inde
+000277f0: 7829 0a20 2020 2064 6566 2074 6f5f 7365  x).    def to_se
+00027800: 7269 6573 2873 656c 662c 2069 6e64 6578  ries(self, index
+00027810: 3d4e 6f6e 652c 206e 616d 653d 6e6f 5f64  =None, name=no_d
+00027820: 6566 6175 6c74 293a 0a20 2020 2020 2020  efault):.       
+00027830: 2069 6620 696e 6465 7820 6973 206e 6f74   if index is not
+00027840: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+00027850: 2020 2072 6169 7365 204e 6f74 496d 706c     raise NotImpl
+00027860: 656d 656e 7465 6445 7272 6f72 0a20 2020  ementedError.   
+00027870: 2020 2020 2072 6574 7572 6e20 6e65 775f       return new_
+00027880: 636f 6c6c 6563 7469 6f6e 2865 7870 722e  collection(expr.
+00027890: 546f 5365 7269 6573 496e 6465 7828 7365  ToSeriesIndex(se
+000278a0: 6c66 2c20 696e 6465 783d 696e 6465 782c  lf, index=index,
+000278b0: 206e 616d 653d 6e61 6d65 2929 0a0a 2020   name=name))..  
+000278c0: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
+000278d0: 7064 2e49 6e64 6578 2c20 7561 5f61 7267  pd.Index, ua_arg
+000278e0: 733d 5b22 696e 6465 7822 5d29 0a20 2020  s=["index"]).   
+000278f0: 2064 6566 2074 6f5f 6672 616d 6528 7365   def to_frame(se
+00027900: 6c66 2c20 696e 6465 783d 5472 7565 2c20  lf, index=True, 
+00027910: 6e61 6d65 3d6e 6f5f 6465 6661 756c 7429  name=no_default)
+00027920: 3a0a 2020 2020 2020 2020 6966 206e 6f74  :.        if not
+00027930: 2069 6e64 6578 3a0a 2020 2020 2020 2020   index:.        
+00027940: 2020 2020 7261 6973 6520 4e6f 7449 6d70      raise NotImp
+00027950: 6c65 6d65 6e74 6564 4572 726f 720a 2020  lementedError.  
+00027960: 2020 2020 2020 7265 7475 726e 206e 6577        return new
+00027970: 5f63 6f6c 6c65 6374 696f 6e28 6578 7072  _collection(expr
+00027980: 2e54 6f46 7261 6d65 496e 6465 7828 7365  .ToFrameIndex(se
+00027990: 6c66 2c20 696e 6465 783d 696e 6465 782c  lf, index=index,
+000279a0: 206e 616d 653d 6e61 6d65 2929 0a0a 2020   name=name))..  
+000279b0: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
+000279c0: 7064 2e49 6e64 6578 290a 2020 2020 6465  pd.Index).    de
+000279d0: 6620 6d65 6d6f 7279 5f75 7361 6765 2873  f memory_usage(s
+000279e0: 656c 662c 2064 6565 703d 4661 6c73 6529  elf, deep=False)
+000279f0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+00027a00: 206e 6577 5f63 6f6c 6c65 6374 696f 6e28   new_collection(
+00027a10: 4d65 6d6f 7279 5573 6167 6549 6e64 6578  MemoryUsageIndex
+00027a20: 2873 656c 662c 2064 6565 703d 6465 6570  (self, deep=deep
+00027a30: 2929 0a0a 2020 2020 6465 6620 7368 6966  ))..    def shif
+00027a40: 7428 7365 6c66 2c20 7065 7269 6f64 733d  t(self, periods=
+00027a50: 312c 2066 7265 713d 4e6f 6e65 293a 0a20  1, freq=None):. 
+00027a60: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
+00027a70: 775f 636f 6c6c 6563 7469 6f6e 2865 7870  w_collection(exp
+00027a80: 722e 5368 6966 7449 6e64 6578 2873 656c  r.ShiftIndex(sel
+00027a90: 662c 2070 6572 696f 6473 2c20 6672 6571  f, periods, freq
+00027aa0: 2929 0a0a 2020 2020 4064 6572 6976 6564  ))..    @derived
+00027ab0: 5f66 726f 6d28 7064 2e49 6e64 6578 290a  _from(pd.Index).
+00027ac0: 2020 2020 6465 6620 6d61 7028 7365 6c66      def map(self
+00027ad0: 2c20 6172 672c 206e 615f 6163 7469 6f6e  , arg, na_action
+00027ae0: 3d4e 6f6e 652c 206d 6574 613d 4e6f 6e65  =None, meta=None
+00027af0: 2c20 6973 5f6d 6f6e 6f74 6f6e 6963 3d46  , is_monotonic=F
+00027b00: 616c 7365 293a 0a20 2020 2020 2020 2022  alse):.        "
+00027b10: 2222 0a20 2020 2020 2020 204e 6f74 6520  "".        Note 
+00027b20: 7468 6174 2074 6869 7320 6d65 7468 6f64  that this method
+00027b30: 2063 6c65 6172 7320 616e 7920 6b6e 6f77   clears any know
+00027b40: 6e20 6469 7669 7369 6f6e 732e 0a0a 2020  n divisions...  
+00027b50: 2020 2020 2020 4966 2079 6f75 7220 6d61        If your ma
+00027b60: 7070 696e 6720 6675 6e63 7469 6f6e 2069  pping function i
+00027b70: 7320 6d6f 6e6f 746f 6e69 6361 6c6c 7920  s monotonically 
+00027b80: 696e 6372 6561 7369 6e67 2074 6865 6e20  increasing then 
+00027b90: 7573 6520 6069 735f 6d6f 6e6f 746f 6e69  use `is_monotoni
+00027ba0: 6360 0a20 2020 2020 2020 2074 6f20 6170  c`.        to ap
+00027bb0: 706c 7920 7468 6520 6d61 7069 6e67 2066  ply the maping f
+00027bc0: 756e 6374 696f 6e20 746f 2074 6865 206f  unction to the o
+00027bd0: 6c64 2064 6976 6973 696f 6e73 2061 6e64  ld divisions and
+00027be0: 2061 7373 6967 6e20 7468 6520 6e65 770a   assign the new.
+00027bf0: 2020 2020 2020 2020 6469 7669 7369 6f6e          division
+00027c00: 7320 746f 2074 6865 206f 7574 7075 742e  s to the output.
+00027c10: 0a0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+00027c20: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
+00027c30: 6e63 6528 6172 672c 2053 6572 6965 7329  nce(arg, Series)
+00027c40: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+00027c50: 206e 6f74 2065 7870 722e 6172 655f 636f   not expr.are_co
+00027c60: 5f61 6c69 676e 6564 2873 656c 662e 6578  _aligned(self.ex
+00027c70: 7072 2c20 6172 672e 6578 7072 293a 0a20  pr, arg.expr):. 
+00027c80: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00027c90: 6620 6d65 7461 2069 7320 4e6f 6e65 3a0a  f meta is None:.
+00027ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027cb0: 2020 2020 7761 726e 696e 6773 2e77 6172      warnings.war
+00027cc0: 6e28 6d65 7461 5f77 6172 6e69 6e67 286d  n(meta_warning(m
+00027cd0: 6574 6129 290a 2020 2020 2020 2020 2020  eta)).          
+00027ce0: 2020 2020 2020 7265 7475 726e 206e 6577        return new
+00027cf0: 5f63 6f6c 6c65 6374 696f 6e28 0a20 2020  _collection(.   
+00027d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027d10: 2065 7870 722e 4d61 7049 6e64 6578 416c   expr.MapIndexAl
+00027d20: 6967 6e28 7365 6c66 2c20 6172 672c 206e  ign(self, arg, n
+00027d30: 615f 6163 7469 6f6e 2c20 6d65 7461 2c20  a_action, meta, 
+00027d40: 6973 5f6d 6f6e 6f74 6f6e 6963 290a 2020  is_monotonic).  
+00027d50: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+00027d60: 2020 2020 2020 2020 6966 206d 6574 6120          if meta 
+00027d70: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+00027d80: 2020 2020 206d 6574 6120 3d20 6578 7072       meta = expr
+00027d90: 2e5f 656d 756c 6174 6528 4d2e 6d61 702c  ._emulate(M.map,
+00027da0: 2073 656c 662c 2061 7267 2c20 6e61 5f61   self, arg, na_a
+00027db0: 6374 696f 6e3d 6e61 5f61 6374 696f 6e2c  ction=na_action,
+00027dc0: 2075 6466 3d54 7275 6529 0a20 2020 2020   udf=True).     
+00027dd0: 2020 2020 2020 2077 6172 6e69 6e67 732e         warnings.
+00027de0: 7761 726e 286d 6574 615f 7761 726e 696e  warn(meta_warnin
+00027df0: 6728 6d65 7461 2929 0a20 2020 2020 2020  g(meta)).       
+00027e00: 2072 6574 7572 6e20 6e65 775f 636f 6c6c   return new_coll
+00027e10: 6563 7469 6f6e 280a 2020 2020 2020 2020  ection(.        
+00027e20: 2020 2020 6578 7072 2e4d 6170 280a 2020      expr.Map(.  
+00027e30: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00027e40: 6c66 2c20 6172 673d 6172 672c 206e 615f  lf, arg=arg, na_
+00027e50: 6163 7469 6f6e 3d6e 615f 6163 7469 6f6e  action=na_action
+00027e60: 2c20 6d65 7461 3d6d 6574 612c 2069 735f  , meta=meta, is_
+00027e70: 6d6f 6e6f 746f 6e69 633d 6973 5f6d 6f6e  monotonic=is_mon
+00027e80: 6f74 6f6e 6963 0a20 2020 2020 2020 2020  otonic.         
+00027e90: 2020 2029 0a20 2020 2020 2020 2029 0a0a     ).        )..
+00027ea0: 2020 2020 6465 6620 5f5f 6469 725f 5f28      def __dir__(
+00027eb0: 7365 6c66 293a 0a20 2020 2020 2020 206f  self):.        o
+00027ec0: 203d 2073 6574 2864 6972 2874 7970 6528   = set(dir(type(
+00027ed0: 7365 6c66 2929 290a 2020 2020 2020 2020  self))).        
+00027ee0: 6f2e 7570 6461 7465 2873 656c 662e 5f5f  o.update(self.__
+00027ef0: 6469 6374 5f5f 290a 2020 2020 2020 2020  dict__).        
+00027f00: 6f2e 7570 6461 7465 2873 6574 2864 6972  o.update(set(dir
+00027f10: 2865 7870 722e 4578 7072 2929 290a 2020  (expr.Expr))).  
+00027f20: 2020 2020 2020 6f2e 7570 6461 7465 2873        o.update(s
+00027f30: 656c 662e 5f64 745f 6174 7472 6962 7574  elf._dt_attribut
+00027f40: 6573 290a 2020 2020 2020 2020 6966 2069  es).        if i
+00027f50: 7369 6e73 7461 6e63 6528 7365 6c66 2e64  sinstance(self.d
+00027f60: 7479 7065 2c20 7064 2e43 6174 6567 6f72  type, pd.Categor
+00027f70: 6963 616c 4474 7970 6529 3a0a 2020 2020  icalDtype):.    
+00027f80: 2020 2020 2020 2020 6f2e 7570 6461 7465          o.update
+00027f90: 2873 656c 662e 5f63 6174 5f61 7474 7269  (self._cat_attri
+00027fa0: 6275 7465 7329 0a20 2020 2020 2020 2072  butes).        r
+00027fb0: 6574 7572 6e20 6c69 7374 286f 290a 0a20  eturn list(o).. 
+00027fc0: 2020 2023 204d 6574 686f 6473 2061 6e64     # Methods and
+00027fd0: 2070 726f 7065 7274 6965 7320 6f66 2053   properties of S
+00027fe0: 6572 6965 7320 7468 6174 2061 7265 206e  eries that are n
+00027ff0: 6f74 2069 6d70 6c65 6d65 6e74 6564 206f  ot implemented o
+00028000: 6e20 496e 6465 780a 0a20 2020 2064 6566  n Index..    def
+00028010: 2063 6f75 6e74 2873 656c 662c 2073 706c   count(self, spl
+00028020: 6974 5f65 7665 7279 3d46 616c 7365 293a  it_every=False):
+00028030: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00028040: 6e65 775f 636f 6c6c 6563 7469 6f6e 2849  new_collection(I
+00028050: 6e64 6578 436f 756e 7428 7365 6c66 2c20  ndexCount(self, 
+00028060: 7370 6c69 745f 6576 6572 7929 290a 0a20  split_every)).. 
+00028070: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+00028080: 2064 6566 2069 6e64 6578 2873 656c 6629   def index(self)
+00028090: 3a0a 2020 2020 2020 2020 7261 6973 6520  :.        raise 
+000280a0: 4174 7472 6962 7574 6545 7272 6f72 2822  AttributeError("
+000280b0: 2749 6e64 6578 2720 6f62 6a65 6374 2068  'Index' object h
+000280c0: 6173 206e 6f20 6174 7472 6962 7574 6520  as no attribute 
+000280d0: 2769 6e64 6578 2722 290a 0a20 2020 2064  'index'")..    d
+000280e0: 6566 2073 756d 2873 656c 662c 202a 6172  ef sum(self, *ar
+000280f0: 6773 2c20 2a2a 6b77 6172 6773 293a 0a20  gs, **kwargs):. 
+00028100: 2020 2020 2020 2072 6169 7365 2041 7474         raise Att
+00028110: 7269 6275 7465 4572 726f 7228 2227 496e  ributeError("'In
+00028120: 6465 7827 206f 626a 6563 7420 6861 7320  dex' object has 
+00028130: 6e6f 2061 7474 7269 6275 7465 2027 7375  no attribute 'su
+00028140: 6d27 2229 0a0a 2020 2020 6465 6620 7072  m'")..    def pr
+00028150: 6f64 2873 656c 662c 202a 6172 6773 2c20  od(self, *args, 
+00028160: 2a2a 6b77 6172 6773 293a 0a20 2020 2020  **kwargs):.     
+00028170: 2020 2072 6169 7365 2041 7474 7269 6275     raise Attribu
+00028180: 7465 4572 726f 7228 2227 496e 6465 7827  teError("'Index'
+00028190: 206f 626a 6563 7420 6861 7320 6e6f 2061   object has no a
+000281a0: 7474 7269 6275 7465 2027 7072 6f64 2722  ttribute 'prod'"
+000281b0: 290a 0a20 2020 2064 6566 206d 6561 6e28  )..    def mean(
+000281c0: 7365 6c66 2c20 2a61 7267 732c 202a 2a6b  self, *args, **k
+000281d0: 7761 7267 7329 3a0a 2020 2020 2020 2020  wargs):.        
+000281e0: 7261 6973 6520 4174 7472 6962 7574 6545  raise AttributeE
+000281f0: 7272 6f72 2822 2749 6e64 6578 2720 6f62  rror("'Index' ob
+00028200: 6a65 6374 2068 6173 206e 6f20 6174 7472  ject has no attr
+00028210: 6962 7574 6520 276d 6561 6e27 2229 0a0a  ibute 'mean'")..
+00028220: 2020 2020 6465 6620 7374 6428 7365 6c66      def std(self
+00028230: 2c20 2a61 7267 732c 202a 2a6b 7761 7267  , *args, **kwarg
+00028240: 7329 3a0a 2020 2020 2020 2020 7261 6973  s):.        rais
+00028250: 6520 4174 7472 6962 7574 6545 7272 6f72  e AttributeError
+00028260: 2822 2749 6e64 6578 2720 6f62 6a65 6374  ("'Index' object
+00028270: 2068 6173 206e 6f20 6174 7472 6962 7574   has no attribut
+00028280: 6520 2773 7464 2722 290a 0a20 2020 2064  e 'std'")..    d
+00028290: 6566 2076 6172 2873 656c 662c 202a 6172  ef var(self, *ar
+000282a0: 6773 2c20 2a2a 6b77 6172 6773 293a 0a20  gs, **kwargs):. 
+000282b0: 2020 2020 2020 2072 6169 7365 2041 7474         raise Att
+000282c0: 7269 6275 7465 4572 726f 7228 2227 496e  ributeError("'In
+000282d0: 6465 7827 206f 626a 6563 7420 6861 7320  dex' object has 
+000282e0: 6e6f 2061 7474 7269 6275 7465 2027 7661  no attribute 'va
+000282f0: 7227 2229 0a0a 2020 2020 6465 6620 6964  r'")..    def id
+00028300: 786d 6178 2873 656c 662c 202a 6172 6773  xmax(self, *args
+00028310: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
+00028320: 2020 2020 2072 6169 7365 2041 7474 7269       raise Attri
+00028330: 6275 7465 4572 726f 7228 2227 496e 6465  buteError("'Inde
+00028340: 7827 206f 626a 6563 7420 6861 7320 6e6f  x' object has no
+00028350: 2061 7474 7269 6275 7465 2027 6964 786d   attribute 'idxm
+00028360: 6178 2722 290a 0a20 2020 2064 6566 2069  ax'")..    def i
+00028370: 6478 6d69 6e28 7365 6c66 2c20 2a61 7267  dxmin(self, *arg
+00028380: 732c 202a 2a6b 7761 7267 7329 3a0a 2020  s, **kwargs):.  
+00028390: 2020 2020 2020 7261 6973 6520 4174 7472        raise Attr
+000283a0: 6962 7574 6545 7272 6f72 2822 2749 6e64  ibuteError("'Ind
+000283b0: 6578 2720 6f62 6a65 6374 2068 6173 206e  ex' object has n
+000283c0: 6f20 6174 7472 6962 7574 6520 2769 6478  o attribute 'idx
+000283d0: 6d69 6e27 2229 0a0a 0a63 6c61 7373 2053  min'")...class S
+000283e0: 6361 6c61 7228 4672 616d 6542 6173 6529  calar(FrameBase)
+000283f0: 3a0a 2020 2020 2222 2253 6361 6c61 7220  :.    """Scalar 
+00028400: 4578 7072 2043 6f6c 6c65 6374 696f 6e22  Expr Collection"
+00028410: 2222 0a0a 2020 2020 6465 6620 5f5f 7265  ""..    def __re
+00028420: 7072 5f5f 2873 656c 6629 3a0a 2020 2020  pr__(self):.    
+00028430: 2020 2020 7265 7475 726e 2066 223c 6461      return f"<da
+00028440: 736b 5f65 7870 722e 6578 7072 2e53 6361  sk_expr.expr.Sca
+00028450: 6c61 723a 2065 7870 723d 7b73 656c 662e  lar: expr={self.
+00028460: 6578 7072 7d2c 2064 7479 7065 3d7b 7365  expr}, dtype={se
+00028470: 6c66 2e64 7479 7065 7d3e 220a 0a20 2020  lf.dtype}>"..   
+00028480: 2064 6566 205f 5f62 6f6f 6c5f 5f28 7365   def __bool__(se
+00028490: 6c66 293a 0a20 2020 2020 2020 2072 6169  lf):.        rai
+000284a0: 7365 2054 7970 6545 7272 6f72 280a 2020  se TypeError(.  
+000284b0: 2020 2020 2020 2020 2020 6622 5472 7969            f"Tryi
+000284c0: 6e67 2074 6f20 636f 6e76 6572 7420 7b73  ng to convert {s
+000284d0: 656c 667d 2074 6f20 6120 626f 6f6c 6561  elf} to a boolea
+000284e0: 6e20 7661 6c75 652e 2042 6563 6175 7365  n value. Because
+000284f0: 2044 6173 6b20 6f62 6a65 6374 7320 6172   Dask objects ar
+00028500: 6520 220a 2020 2020 2020 2020 2020 2020  e ".            
+00028510: 226c 617a 696c 7920 6576 616c 7561 7465  "lazily evaluate
+00028520: 642c 2074 6865 7920 6361 6e6e 6f74 2062  d, they cannot b
+00028530: 6520 636f 6e76 6572 7465 6420 746f 2061  e converted to a
+00028540: 2062 6f6f 6c65 616e 2076 616c 7565 206f   boolean value o
+00028550: 7220 7573 6564 2022 0a20 2020 2020 2020  r used ".       
+00028560: 2020 2020 2022 696e 2062 6f6f 6c65 616e       "in boolean
+00028570: 2063 6f6e 6469 7469 6f6e 7320 6c69 6b65   conditions like
+00028580: 2069 6620 7374 6174 656d 656e 7473 2e20   if statements. 
+00028590: 5472 7920 6361 6c6c 696e 6720 2e63 6f6d  Try calling .com
+000285a0: 7075 7465 2829 2074 6f20 220a 2020 2020  pute() to ".    
+000285b0: 2020 2020 2020 2020 2266 6f72 6365 2063          "force c
+000285c0: 6f6d 7075 7461 7469 6f6e 2070 7269 6f72  omputation prior
+000285d0: 2074 6f20 636f 6e76 6572 7469 6e67 2074   to converting t
+000285e0: 6f20 6120 626f 6f6c 6561 6e20 7661 6c75  o a boolean valu
+000285f0: 6520 6f72 2075 7369 6e67 2069 6e20 220a  e or using in ".
+00028600: 2020 2020 2020 2020 2020 2020 2261 2063              "a c
+00028610: 6f6e 6469 7469 6f6e 616c 2073 7461 7465  onditional state
+00028620: 6d65 6e74 2e22 0a20 2020 2020 2020 2029  ment.".        )
+00028630: 0a0a 2020 2020 6465 6620 5f5f 6461 736b  ..    def __dask
+00028640: 5f70 6f73 7463 6f6d 7075 7465 5f5f 2873  _postcompute__(s
+00028650: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
+00028660: 7475 726e 2066 6972 7374 2c20 2829 0a0a  turn first, ()..
+00028670: 2020 2020 6465 6620 746f 5f73 6572 6965      def to_serie
+00028680: 7328 7365 6c66 2c20 696e 6465 783d 3029  s(self, index=0)
+00028690: 202d 3e20 5365 7269 6573 3a0a 2020 2020   -> Series:.    
+000286a0: 2020 2020 7265 7475 726e 206e 6577 5f63      return new_c
+000286b0: 6f6c 6c65 6374 696f 6e28 6578 7072 2e53  ollection(expr.S
+000286c0: 6361 6c61 7254 6f53 6572 6965 7328 7365  calarToSeries(se
+000286d0: 6c66 2c20 696e 6465 783d 696e 6465 7829  lf, index=index)
+000286e0: 290a 0a20 2020 2064 6566 205f 5f61 7272  )..    def __arr
+000286f0: 6179 5f5f 2873 656c 6629 3a0a 2020 2020  ay__(self):.    
+00028700: 2020 2020 2320 6172 7261 7920 696e 7465      # array inte
+00028710: 7266 6163 6520 6973 2072 6571 7569 7265  rface is require
+00028720: 6420 746f 2073 7570 706f 7274 2070 616e  d to support pan
+00028730: 6461 7320 696e 7374 616e 6365 202b 2053  das instance + S
+00028740: 6361 6c61 720a 2020 2020 2020 2020 2320  calar.        # 
+00028750: 4f74 6865 7277 6973 652c 2061 626f 7665  Otherwise, above
+00028760: 206f 7020 7265 7375 6c74 7320 696e 2070   op results in p
+00028770: 642e 5365 7269 6573 206f 6620 5363 616c  d.Series of Scal
+00028780: 6172 2028 6f62 6a65 6374 2064 7479 7065  ar (object dtype
+00028790: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+000287a0: 206e 702e 6173 6172 7261 7928 7365 6c66   np.asarray(self
+000287b0: 2e63 6f6d 7075 7465 2829 290a 0a20 2020  .compute())..   
+000287c0: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+000287d0: 6566 2064 7479 7065 2873 656c 6629 3a0a  ef dtype(self):.
+000287e0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+000287f0: 656c 662e 5f6d 6574 612e 6474 7970 650a  elf._meta.dtype.
+00028800: 0a0a 6465 6620 6e65 775f 636f 6c6c 6563  ..def new_collec
+00028810: 7469 6f6e 2865 7870 7229 3a0a 2020 2020  tion(expr):.    
+00028820: 2222 2243 7265 6174 6520 6e65 7720 636f  """Create new co
+00028830: 6c6c 6563 7469 6f6e 2066 726f 6d20 616e  llection from an
+00028840: 2065 7870 7222 2222 0a20 2020 206d 6574   expr""".    met
+00028850: 6120 3d20 6578 7072 2e5f 6d65 7461 0a20  a = expr._meta. 
+00028860: 2020 2065 7870 722e 5f6e 616d 6520 2023     expr._name  #
+00028870: 2045 6e73 7572 6520 6261 636b 656e 6420   Ensure backend 
+00028880: 6973 2069 6d70 6f72 7465 640a 2020 2020  is imported.    
+00028890: 7265 7475 726e 2067 6574 5f63 6f6c 6c65  return get_colle
+000288a0: 6374 696f 6e5f 7479 7065 286d 6574 6129  ction_type(meta)
+000288b0: 2865 7870 7229 0a0a 0a64 6566 206f 7074  (expr)...def opt
+000288c0: 696d 697a 6528 636f 6c6c 6563 7469 6f6e  imize(collection
+000288d0: 2c20 6675 7365 3d54 7275 6529 3a0a 2020  , fuse=True):.  
+000288e0: 2020 7265 7475 726e 206e 6577 5f63 6f6c    return new_col
+000288f0: 6c65 6374 696f 6e28 6578 7072 2e6f 7074  lection(expr.opt
+00028900: 696d 697a 6528 636f 6c6c 6563 7469 6f6e  imize(collection
+00028910: 2e65 7870 722c 2066 7573 653d 6675 7365  .expr, fuse=fuse
+00028920: 2929 0a0a 0a64 6566 2066 726f 6d5f 7061  ))...def from_pa
+00028930: 6e64 6173 2864 6174 612c 206e 7061 7274  ndas(data, npart
+00028940: 6974 696f 6e73 3d4e 6f6e 652c 2073 6f72  itions=None, sor
+00028950: 743d 5472 7565 2c20 6368 756e 6b73 697a  t=True, chunksiz
+00028960: 653d 4e6f 6e65 293a 0a20 2020 2069 6620  e=None):.    if 
+00028970: 6368 756e 6b73 697a 6520 6973 206e 6f74  chunksize is not
+00028980: 204e 6f6e 6520 616e 6420 6e70 6172 7469   None and nparti
+00028990: 7469 6f6e 7320 6973 206e 6f74 204e 6f6e  tions is not Non
+000289a0: 653a 0a20 2020 2020 2020 2072 6169 7365  e:.        raise
+000289b0: 2056 616c 7565 4572 726f 7228 2245 7861   ValueError("Exa
+000289c0: 6374 6c79 206f 6e65 206f 6620 6e70 6172  ctly one of npar
+000289d0: 7469 7469 6f6e 7320 616e 6420 6368 756e  titions and chun
+000289e0: 6b73 697a 6520 6d75 7374 2062 6520 7370  ksize must be sp
+000289f0: 6563 6966 6965 642e 2229 0a20 2020 2065  ecified.").    e
+00028a00: 6c69 6620 6368 756e 6b73 697a 6520 6973  lif chunksize is
+00028a10: 204e 6f6e 6520 616e 6420 6e70 6172 7469   None and nparti
+00028a20: 7469 6f6e 7320 6973 204e 6f6e 653a 0a20  tions is None:. 
+00028a30: 2020 2020 2020 206e 7061 7274 6974 696f         npartitio
+00028a40: 6e73 203d 2031 0a0a 2020 2020 6966 206e  ns = 1..    if n
+00028a50: 6f74 2068 6173 5f70 6172 616c 6c65 6c5f  ot has_parallel_
+00028a60: 7479 7065 2864 6174 6129 3a0a 2020 2020  type(data):.    
+00028a70: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
+00028a80: 726f 7228 2249 6e70 7574 206d 7573 7420  ror("Input must 
+00028a90: 6265 2061 2070 616e 6461 7320 4461 7461  be a pandas Data
+00028aa0: 4672 616d 6520 6f72 2053 6572 6965 732e  Frame or Series.
+00028ab0: 2229 0a0a 2020 2020 6966 2064 6174 612e  ")..    if data.
+00028ac0: 696e 6465 782e 6973 6e61 2829 2e61 6e79  index.isna().any
+00028ad0: 2829 2061 6e64 206e 6f74 205f 6973 5f61  () and not _is_a
+00028ae0: 6e79 5f72 6561 6c5f 6e75 6d65 7269 635f  ny_real_numeric_
+00028af0: 6474 7970 6528 6461 7461 2e69 6e64 6578  dtype(data.index
+00028b00: 293a 0a20 2020 2020 2020 2072 6169 7365  ):.        raise
+00028b10: 204e 6f74 496d 706c 656d 656e 7465 6445   NotImplementedE
+00028b20: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+00028b30: 2020 2249 6e64 6578 2069 6e20 7061 7373    "Index in pass
+00028b40: 6564 2064 6174 6120 6973 206e 6f6e 2d6e  ed data is non-n
+00028b50: 756d 6572 6963 2061 6e64 2063 6f6e 7461  umeric and conta
+00028b60: 696e 7320 6e75 6c6c 732c 2077 6869 6368  ins nulls, which
+00028b70: 2044 6173 6b20 646f 6573 206e 6f74 2065   Dask does not e
+00028b80: 6e74 6972 656c 7920 7375 7070 6f72 742e  ntirely support.
+00028b90: 5c6e 220a 2020 2020 2020 2020 2020 2020  \n".            
+00028ba0: 2243 6f6e 7369 6465 7220 7061 7373 696e  "Consider passin
+00028bb0: 6720 6064 6174 612e 6c6f 635b 7e64 6174  g `data.loc[~dat
+00028bc0: 612e 6973 6e61 2829 5d60 2069 6e73 7465  a.isna()]` inste
+00028bd0: 6164 2e22 0a20 2020 2020 2020 2029 0a0a  ad.".        )..
+00028be0: 2020 2020 6966 206e 7061 7274 6974 696f      if npartitio
+00028bf0: 6e73 2069 7320 6e6f 7420 4e6f 6e65 2061  ns is not None a
+00028c00: 6e64 206e 6f74 2069 7369 6e73 7461 6e63  nd not isinstanc
+00028c10: 6528 6e70 6172 7469 7469 6f6e 732c 2069  e(npartitions, i
+00028c20: 6e74 293a 0a20 2020 2020 2020 2072 6169  nt):.        rai
+00028c30: 7365 2054 7970 6545 7272 6f72 280a 2020  se TypeError(.  
+00028c40: 2020 2020 2020 2020 2020 2250 6c65 6173            "Pleas
+00028c50: 6520 7072 6f76 6964 6520 6e70 6172 7469  e provide nparti
+00028c60: 7469 6f6e 7320 6173 2061 6e20 696e 742c  tions as an int,
+00028c70: 206f 7220 706f 7373 6962 6c79 2061 7320   or possibly as 
+00028c80: 4e6f 6e65 2069 6620 796f 7520 7370 6563  None if you spec
+00028c90: 6966 7920 6368 756e 6b73 697a 652e 220a  ify chunksize.".
+00028ca0: 2020 2020 2020 2020 290a 2020 2020 656c          ).    el
+00028cb0: 6966 2063 6875 6e6b 7369 7a65 2069 7320  if chunksize is 
+00028cc0: 6e6f 7420 4e6f 6e65 2061 6e64 206e 6f74  not None and not
+00028cd0: 2069 7369 6e73 7461 6e63 6528 6368 756e   isinstance(chun
+00028ce0: 6b73 697a 652c 2069 6e74 293a 0a20 2020  ksize, int):.   
+00028cf0: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
+00028d00: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+00028d10: 2020 2250 6c65 6173 6520 7072 6f76 6964    "Please provid
+00028d20: 6520 6368 756e 6b73 697a 6520 6173 2061  e chunksize as a
+00028d30: 6e20 696e 742c 206f 7220 706f 7373 6962  n int, or possib
+00028d40: 6c79 2061 7320 4e6f 6e65 2069 6620 796f  ly as None if yo
+00028d50: 7520 7370 6563 6966 7920 6e70 6172 7469  u specify nparti
+00028d60: 7469 6f6e 732e 220a 2020 2020 2020 2020  tions.".        
+00028d70: 290a 0a20 2020 2066 726f 6d20 6461 736b  )..    from dask
+00028d80: 5f65 7870 722e 696f 2e69 6f20 696d 706f  _expr.io.io impo
+00028d90: 7274 2046 726f 6d50 616e 6461 730a 0a20  rt FromPandas.. 
+00028da0: 2020 2072 6574 7572 6e20 6e65 775f 636f     return new_co
+00028db0: 6c6c 6563 7469 6f6e 280a 2020 2020 2020  llection(.      
+00028dc0: 2020 4672 6f6d 5061 6e64 6173 280a 2020    FromPandas(.  
+00028dd0: 2020 2020 2020 2020 2020 5f42 6163 6b65            _Backe
+00028de0: 6e64 4461 7461 2864 6174 612e 636f 7079  ndData(data.copy
+00028df0: 2829 292c 0a20 2020 2020 2020 2020 2020  ()),.           
+00028e00: 206e 7061 7274 6974 696f 6e73 3d6e 7061   npartitions=npa
+00028e10: 7274 6974 696f 6e73 2c0a 2020 2020 2020  rtitions,.      
+00028e20: 2020 2020 2020 736f 7274 3d73 6f72 742c        sort=sort,
+00028e30: 0a20 2020 2020 2020 2020 2020 2063 6875  .            chu
+00028e40: 6e6b 7369 7a65 3d63 6875 6e6b 7369 7a65  nksize=chunksize
+00028e50: 2c0a 2020 2020 2020 2020 2020 2020 7079  ,.            py
+00028e60: 6172 726f 775f 7374 7269 6e67 735f 656e  arrow_strings_en
+00028e70: 6162 6c65 643d 7079 6172 726f 775f 7374  abled=pyarrow_st
+00028e80: 7269 6e67 735f 656e 6162 6c65 6428 292c  rings_enabled(),
+00028e90: 0a20 2020 2020 2020 2029 0a20 2020 2029  .        ).    )
+00028ea0: 0a0a 0a64 6566 2066 726f 6d5f 6172 7261  ...def from_arra
+00028eb0: 7928 6172 722c 2063 6875 6e6b 7369 7a65  y(arr, chunksize
+00028ec0: 3d35 305f 3030 302c 2063 6f6c 756d 6e73  =50_000, columns
+00028ed0: 3d4e 6f6e 652c 206d 6574 613d 4e6f 6e65  =None, meta=None
+00028ee0: 293a 0a20 2020 2069 6d70 6f72 7420 6461  ):.    import da
+00028ef0: 736b 2e61 7272 6179 2061 7320 6461 0a0a  sk.array as da..
+00028f00: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+00028f10: 6528 6172 722c 2064 612e 4172 7261 7929  e(arr, da.Array)
+00028f20: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+00028f30: 2066 726f 6d5f 6461 736b 5f61 7272 6179   from_dask_array
+00028f40: 2861 7272 2c20 636f 6c75 6d6e 733d 636f  (arr, columns=co
+00028f50: 6c75 6d6e 732c 206d 6574 613d 6d65 7461  lumns, meta=meta
+00028f60: 290a 0a20 2020 2066 726f 6d20 6461 736b  )..    from dask
+00028f70: 5f65 7870 722e 696f 2e69 6f20 696d 706f  _expr.io.io impo
+00028f80: 7274 2046 726f 6d41 7272 6179 0a0a 2020  rt FromArray..  
+00028f90: 2020 7265 7375 6c74 203d 2046 726f 6d41    result = FromA
+00028fa0: 7272 6179 280a 2020 2020 2020 2020 6172  rray(.        ar
+00028fb0: 722c 0a20 2020 2020 2020 2063 6875 6e6b  r,.        chunk
+00028fc0: 7369 7a65 3d63 6875 6e6b 7369 7a65 2c0a  size=chunksize,.
+00028fd0: 2020 2020 2020 2020 6f72 6967 696e 616c          original
+00028fe0: 5f63 6f6c 756d 6e73 3d63 6f6c 756d 6e73  _columns=columns
+00028ff0: 2c0a 2020 2020 2020 2020 6d65 7461 3d6d  ,.        meta=m
+00029000: 6574 612c 0a20 2020 2029 0a20 2020 2069  eta,.    ).    i
+00029010: 6620 7079 6172 726f 775f 7374 7269 6e67  f pyarrow_string
+00029020: 735f 656e 6162 6c65 6428 2920 616e 6420  s_enabled() and 
+00029030: 6172 722e 6474 7970 652e 6b69 6e64 2069  arr.dtype.kind i
+00029040: 6e20 224f 5522 3a0a 2020 2020 2020 2020  n "OU":.        
+00029050: 7265 7375 6c74 203d 2065 7870 722e 4172  result = expr.Ar
+00029060: 726f 7753 7472 696e 6743 6f6e 7665 7273  rowStringConvers
+00029070: 696f 6e28 7265 7375 6c74 290a 2020 2020  ion(result).    
+00029080: 7265 7475 726e 206e 6577 5f63 6f6c 6c65  return new_colle
+00029090: 6374 696f 6e28 7265 7375 6c74 290a 0a0a  ction(result)...
+000290a0: 6465 6620 6672 6f6d 5f67 7261 7068 282a  def from_graph(*
+000290b0: 6172 6773 2c20 2a2a 6b77 6172 6773 293a  args, **kwargs):
+000290c0: 0a20 2020 2066 726f 6d20 6461 736b 5f65  .    from dask_e
+000290d0: 7870 722e 696f 2e69 6f20 696d 706f 7274  xpr.io.io import
+000290e0: 2046 726f 6d47 7261 7068 0a0a 2020 2020   FromGraph..    
+000290f0: 7265 7475 726e 206e 6577 5f63 6f6c 6c65  return new_colle
+00029100: 6374 696f 6e28 4672 6f6d 4772 6170 6828  ction(FromGraph(
+00029110: 2a61 7267 732c 202a 2a6b 7761 7267 7329  *args, **kwargs)
+00029120: 290a 0a0a 4064 6174 6166 7261 6d65 5f63  )...@dataframe_c
+00029130: 7265 6174 696f 6e5f 6469 7370 6174 6368  reation_dispatch
+00029140: 2e72 6567 6973 7465 725f 696e 706c 6163  .register_inplac
+00029150: 6528 2270 616e 6461 7322 290a 6465 6620  e("pandas").def 
+00029160: 6672 6f6d 5f64 6963 7428 0a20 2020 2064  from_dict(.    d
+00029170: 6174 612c 0a20 2020 206e 7061 7274 6974  ata,.    npartit
+00029180: 696f 6e73 2c0a 2020 2020 6f72 6965 6e74  ions,.    orient
+00029190: 3d22 636f 6c75 6d6e 7322 2c0a 2020 2020  ="columns",.    
+000291a0: 6474 7970 653d 4e6f 6e65 2c0a 2020 2020  dtype=None,.    
+000291b0: 636f 6c75 6d6e 733d 4e6f 6e65 2c0a 2020  columns=None,.  
+000291c0: 2020 636f 6e73 7472 7563 746f 723d 7064    constructor=pd
+000291d0: 2e44 6174 6146 7261 6d65 2c0a 293a 0a20  .DataFrame,.):. 
+000291e0: 2020 2022 2222 0a20 2020 2043 6f6e 7374     """.    Const
+000291f0: 7275 6374 2061 2044 6173 6b20 4461 7461  ruct a Dask Data
+00029200: 4672 616d 6520 6672 6f6d 2061 2050 7974  Frame from a Pyt
+00029210: 686f 6e20 4469 6374 696f 6e61 7279 0a0a  hon Dictionary..
+00029220: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
+00029230: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
+00029240: 2020 6461 7461 203a 2064 6963 740a 2020    data : dict.  
+00029250: 2020 2020 2020 4f66 2074 6865 2066 6f72        Of the for
+00029260: 6d20 7b66 6965 6c64 203a 2061 7272 6179  m {field : array
+00029270: 2d6c 696b 657d 206f 7220 7b66 6965 6c64  -like} or {field
+00029280: 203a 2064 6963 747d 2e0a 2020 2020 6e70   : dict}..    np
+00029290: 6172 7469 7469 6f6e 7320 3a20 696e 740a  artitions : int.
+000292a0: 2020 2020 2020 2020 5468 6520 6e75 6d62          The numb
+000292b0: 6572 206f 6620 7061 7274 6974 696f 6e73  er of partitions
+000292c0: 206f 6620 7468 6520 696e 6465 7820 746f   of the index to
+000292d0: 2063 7265 6174 652e 204e 6f74 6520 7468   create. Note th
+000292e0: 6174 2064 6570 656e 6469 6e67 206f 6e0a  at depending on.
+000292f0: 2020 2020 2020 2020 7468 6520 7369 7a65          the size
+00029300: 2061 6e64 2069 6e64 6578 206f 6620 7468   and index of th
+00029310: 6520 6461 7461 6672 616d 652c 2074 6865  e dataframe, the
+00029320: 206f 7574 7075 7420 6d61 7920 6861 7665   output may have
+00029330: 2066 6577 6572 0a20 2020 2020 2020 2070   fewer.        p
+00029340: 6172 7469 7469 6f6e 7320 7468 616e 2072  artitions than r
+00029350: 6571 7565 7374 6564 2e0a 2020 2020 6f72  equested..    or
+00029360: 6965 6e74 203a 207b 2763 6f6c 756d 6e73  ient : {'columns
+00029370: 272c 2027 696e 6465 7827 2c20 2774 6967  ', 'index', 'tig
+00029380: 6874 277d 2c20 6465 6661 756c 7420 2763  ht'}, default 'c
+00029390: 6f6c 756d 6e73 270a 2020 2020 2020 2020  olumns'.        
+000293a0: 5468 6520 226f 7269 656e 7461 7469 6f6e  The "orientation
+000293b0: 2220 6f66 2074 6865 2064 6174 612e 2049  " of the data. I
+000293c0: 6620 7468 6520 6b65 7973 206f 6620 7468  f the keys of th
+000293d0: 6520 7061 7373 6564 2064 6963 740a 2020  e passed dict.  
+000293e0: 2020 2020 2020 7368 6f75 6c64 2062 6520        should be 
+000293f0: 7468 6520 636f 6c75 6d6e 7320 6f66 2074  the columns of t
+00029400: 6865 2072 6573 756c 7469 6e67 2044 6174  he resulting Dat
+00029410: 6146 7261 6d65 2c20 7061 7373 2027 636f  aFrame, pass 'co
+00029420: 6c75 6d6e 7327 0a20 2020 2020 2020 2028  lumns'.        (
+00029430: 6465 6661 756c 7429 2e20 4f74 6865 7277  default). Otherw
+00029440: 6973 6520 6966 2074 6865 206b 6579 7320  ise if the keys 
+00029450: 7368 6f75 6c64 2062 6520 726f 7773 2c20  should be rows, 
+00029460: 7061 7373 2027 696e 6465 7827 2e0a 2020  pass 'index'..  
+00029470: 2020 2020 2020 4966 2027 7469 6768 7427        If 'tight'
+00029480: 2c20 6173 7375 6d65 2061 2064 6963 7420  , assume a dict 
+00029490: 7769 7468 206b 6579 730a 2020 2020 2020  with keys.      
+000294a0: 2020 5b27 696e 6465 7827 2c20 2763 6f6c    ['index', 'col
+000294b0: 756d 6e73 272c 2027 6461 7461 272c 2027  umns', 'data', '
+000294c0: 696e 6465 785f 6e61 6d65 7327 2c20 2763  index_names', 'c
+000294d0: 6f6c 756d 6e5f 6e61 6d65 7327 5d2e 0a20  olumn_names'].. 
+000294e0: 2020 2064 7479 7065 3a20 626f 6f6c 0a20     dtype: bool. 
+000294f0: 2020 2020 2020 2044 6174 6120 7479 7065         Data type
+00029500: 2074 6f20 666f 7263 652c 206f 7468 6572   to force, other
+00029510: 7769 7365 2069 6e66 6572 2e0a 2020 2020  wise infer..    
+00029520: 636f 6c75 6d6e 733a 2073 7472 696e 672c  columns: string,
+00029530: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
+00029540: 2020 436f 6c75 6d6e 206c 6162 656c 7320    Column labels 
+00029550: 746f 2075 7365 2077 6865 6e20 6060 6f72  to use when ``or
+00029560: 6965 6e74 3d27 696e 6465 7827 6060 2e20  ient='index'``. 
+00029570: 5261 6973 6573 2061 2056 616c 7565 4572  Raises a ValueEr
+00029580: 726f 720a 2020 2020 2020 2020 6966 2075  ror.        if u
+00029590: 7365 6420 7769 7468 2060 606f 7269 656e  sed with ``orien
+000295a0: 743d 2763 6f6c 756d 6e73 2760 6020 6f72  t='columns'`` or
+000295b0: 2060 606f 7269 656e 743d 2774 6967 6874   ``orient='tight
+000295c0: 2760 602e 0a20 2020 2063 6f6e 7374 7275  '``..    constru
+000295d0: 6374 6f72 3a20 636c 6173 732c 2064 6566  ctor: class, def
+000295e0: 6175 6c74 2070 642e 4461 7461 4672 616d  ault pd.DataFram
+000295f0: 650a 2020 2020 2020 2020 436c 6173 7320  e.        Class 
+00029600: 7769 7468 2077 6869 6368 2060 6066 726f  with which ``fro
+00029610: 6d5f 6469 6374 6060 2073 686f 756c 6420  m_dict`` should 
+00029620: 6265 2063 616c 6c65 6420 7769 7468 2e0a  be called with..
+00029630: 0a20 2020 2045 7861 6d70 6c65 730a 2020  .    Examples.  
+00029640: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 203e    --------.    >
+00029650: 3e3e 2069 6d70 6f72 7420 6461 736b 2e64  >> import dask.d
+00029660: 6174 6166 7261 6d65 2061 7320 6464 0a20  ataframe as dd. 
+00029670: 2020 203e 3e3e 2064 6466 203d 2064 642e     >>> ddf = dd.
+00029680: 6672 6f6d 5f64 6963 7428 7b22 6e75 6d31  from_dict({"num1
+00029690: 223a 205b 312c 2032 2c20 332c 2034 5d2c  ": [1, 2, 3, 4],
+000296a0: 2022 6e75 6d32 223a 205b 372c 2038 2c20   "num2": [7, 8, 
+000296b0: 392c 2031 305d 7d2c 206e 7061 7274 6974  9, 10]}, npartit
+000296c0: 696f 6e73 3d32 290a 2020 2020 2222 220a  ions=2).    """.
+000296d0: 0a20 2020 2063 6f6c 6c65 6374 696f 6e5f  .    collection_
+000296e0: 7479 7065 7320 3d20 7b74 7970 6528 7629  types = {type(v)
+000296f0: 2066 6f72 2076 2069 6e20 6461 7461 2e76   for v in data.v
+00029700: 616c 7565 7328 2920 6966 2069 735f 6461  alues() if is_da
+00029710: 736b 5f63 6f6c 6c65 6374 696f 6e28 7629  sk_collection(v)
+00029720: 7d0a 2020 2020 6966 2063 6f6c 6c65 6374  }.    if collect
+00029730: 696f 6e5f 7479 7065 733a 0a20 2020 2020  ion_types:.     
+00029740: 2020 2072 6169 7365 204e 6f74 496d 706c     raise NotImpl
+00029750: 656d 656e 7465 6445 7272 6f72 280a 2020  ementedError(.  
+00029760: 2020 2020 2020 2020 2020 2266 726f 6d5f            "from_
+00029770: 6469 6374 2064 6f65 736e 2774 2063 7572  dict doesn't cur
+00029780: 7265 6e74 6c79 2073 7570 706f 7274 2044  rently support D
+00029790: 6173 6b20 636f 6c6c 6563 7469 6f6e 7320  ask collections 
+000297a0: 6173 2069 6e70 7574 732e 2022 0a20 2020  as inputs. ".   
+000297b0: 2020 2020 2020 2020 2066 224f 626a 6563           f"Objec
+000297c0: 7473 206f 6620 7479 7065 207b 636f 6c6c  ts of type {coll
+000297d0: 6563 7469 6f6e 5f74 7970 6573 7d20 7765  ection_types} we
+000297e0: 7265 2067 6976 656e 2069 6e20 7468 6520  re given in the 
+000297f0: 696e 7075 7420 6469 6374 2e22 0a20 2020  input dict.".   
+00029800: 2020 2020 2029 0a0a 2020 2020 7265 7475       )..    retu
+00029810: 726e 2066 726f 6d5f 7061 6e64 6173 280a  rn from_pandas(.
+00029820: 2020 2020 2020 2020 636f 6e73 7472 7563          construc
+00029830: 746f 722e 6672 6f6d 5f64 6963 7428 6461  tor.from_dict(da
+00029840: 7461 2c20 6f72 6965 6e74 2c20 6474 7970  ta, orient, dtyp
+00029850: 652c 2063 6f6c 756d 6e73 292c 0a20 2020  e, columns),.   
+00029860: 2020 2020 206e 7061 7274 6974 696f 6e73       npartitions
+00029870: 2c0a 2020 2020 290a 0a0a 6465 6620 6672  ,.    )...def fr
+00029880: 6f6d 5f64 6173 6b5f 6461 7461 6672 616d  om_dask_datafram
+00029890: 6528 2a61 7267 732c 202a 2a6b 7761 7267  e(*args, **kwarg
+000298a0: 7329 202d 3e20 4672 616d 6542 6173 653a  s) -> FrameBase:
+000298b0: 0a20 2020 2022 2222 4372 6561 7465 2061  .    """Create a
+000298c0: 2064 6173 6b2d 6578 7072 2063 6f6c 6c65   dask-expr colle
+000298d0: 6374 696f 6e20 6672 6f6d 2061 206c 6567  ction from a leg
+000298e0: 6163 7920 6461 736b 2d64 6174 6166 7261  acy dask-datafra
+000298f0: 6d65 2063 6f6c 6c65 6374 696f 6e0a 0a20  me collection.. 
+00029900: 2020 2057 4152 4e49 4e47 3a20 5468 6973     WARNING: This
+00029910: 2041 5049 2069 7320 6465 7072 6563 6174   API is deprecat
+00029920: 6564 2e20 506c 6561 7365 2075 7365 2060  ed. Please use `
+00029930: 6672 6f6d 5f6c 6567 6163 795f 6461 7461  from_legacy_data
+00029940: 6672 616d 6560 2e0a 0a20 2020 2050 6172  frame`...    Par
+00029950: 616d 6574 6572 730a 2020 2020 2d2d 2d2d  ameters.    ----
+00029960: 2d2d 2d2d 2d2d 0a20 2020 206f 7074 696d  ------.    optim
+00029970: 697a 650a 2020 2020 2020 2020 5768 6574  ize.        Whet
+00029980: 6865 7220 746f 206f 7074 696d 697a 6520  her to optimize 
+00029990: 7468 6520 6772 6170 6820 6265 666f 7265  the graph before
+000299a0: 2063 6f6e 7665 7273 696f 6e2e 0a20 2020   conversion..   
+000299b0: 2022 2222 0a20 2020 2023 2054 4f44 4f3a   """.    # TODO:
+000299c0: 2044 6570 7265 6361 7465 2060 6672 6f6d   Deprecate `from
+000299d0: 5f64 6173 6b5f 6461 7461 6672 616d 6560  _dask_dataframe`
+000299e0: 0a20 2020 2023 2053 6565 3a20 6874 7470  .    # See: http
+000299f0: 733a 2f2f 6769 7468 7562 2e63 6f6d 2f64  s://github.com/d
+00029a00: 6173 6b2f 6461 736b 2d65 7870 722f 6973  ask/dask-expr/is
+00029a10: 7375 6573 2f39 3035 0a20 2020 2072 6574  sues/905.    ret
+00029a20: 7572 6e20 6672 6f6d 5f6c 6567 6163 795f  urn from_legacy_
+00029a30: 6461 7461 6672 616d 6528 2a61 7267 732c  dataframe(*args,
+00029a40: 202a 2a6b 7761 7267 7329 0a0a 0a64 6566   **kwargs)...def
+00029a50: 2066 726f 6d5f 6c65 6761 6379 5f64 6174   from_legacy_dat
+00029a60: 6166 7261 6d65 2864 6466 3a20 5f46 7261  aframe(ddf: _Fra
+00029a70: 6d65 2c20 6f70 7469 6d69 7a65 3a20 626f  me, optimize: bo
+00029a80: 6f6c 203d 2054 7275 6529 202d 3e20 4672  ol = True) -> Fr
+00029a90: 616d 6542 6173 653a 0a20 2020 2022 2222  ameBase:.    """
+00029aa0: 4372 6561 7465 2061 2064 6173 6b2d 6578  Create a dask-ex
+00029ab0: 7072 2063 6f6c 6c65 6374 696f 6e20 6672  pr collection fr
+00029ac0: 6f6d 2061 206c 6567 6163 7920 6461 736b  om a legacy dask
+00029ad0: 2d64 6174 6166 7261 6d65 2063 6f6c 6c65  -dataframe colle
+00029ae0: 6374 696f 6e0a 0a20 2020 2050 6172 616d  ction..    Param
+00029af0: 6574 6572 730a 2020 2020 2d2d 2d2d 2d2d  eters.    ------
+00029b00: 2d2d 2d2d 0a20 2020 206f 7074 696d 697a  ----.    optimiz
+00029b10: 650a 2020 2020 2020 2020 5768 6574 6865  e.        Whethe
+00029b20: 7220 746f 206f 7074 696d 697a 6520 7468  r to optimize th
+00029b30: 6520 6772 6170 6820 6265 666f 7265 2063  e graph before c
+00029b40: 6f6e 7665 7273 696f 6e2e 0a20 2020 2022  onversion..    "
+00029b50: 2222 0a20 2020 2067 7261 7068 203d 2064  "".    graph = d
+00029b60: 6466 2e64 6173 6b0a 2020 2020 6966 206f  df.dask.    if o
+00029b70: 7074 696d 697a 653a 0a20 2020 2020 2020  ptimize:.       
+00029b80: 2067 7261 7068 203d 2064 6466 2e5f 5f64   graph = ddf.__d
+00029b90: 6173 6b5f 6f70 7469 6d69 7a65 5f5f 2867  ask_optimize__(g
+00029ba0: 7261 7068 2c20 6464 662e 5f5f 6461 736b  raph, ddf.__dask
+00029bb0: 5f6b 6579 735f 5f28 2929 0a20 2020 2072  _keys__()).    r
+00029bc0: 6574 7572 6e20 6672 6f6d 5f67 7261 7068  eturn from_graph
+00029bd0: 280a 2020 2020 2020 2020 6772 6170 682c  (.        graph,
+00029be0: 2064 6466 2e5f 6d65 7461 2c20 6464 662e   ddf._meta, ddf.
+00029bf0: 6469 7669 7369 6f6e 732c 2064 6466 2e5f  divisions, ddf._
+00029c00: 5f64 6173 6b5f 6b65 7973 5f5f 2829 2c20  _dask_keys__(), 
+00029c10: 6b65 795f 7370 6c69 7428 6464 662e 5f6e  key_split(ddf._n
+00029c20: 616d 6529 0a20 2020 2029 0a0a 0a64 6566  ame).    )...def
+00029c30: 2066 726f 6d5f 6461 736b 5f61 7272 6179   from_dask_array
+00029c40: 2878 2c20 636f 6c75 6d6e 733d 4e6f 6e65  (x, columns=None
+00029c50: 2c20 696e 6465 783d 4e6f 6e65 2c20 6d65  , index=None, me
+00029c60: 7461 3d4e 6f6e 6529 3a0a 2020 2020 6672  ta=None):.    fr
+00029c70: 6f6d 2064 6173 6b2e 6461 7461 6672 616d  om dask.datafram
+00029c80: 652e 696f 2069 6d70 6f72 7420 6672 6f6d  e.io import from
+00029c90: 5f64 6173 6b5f 6172 7261 790a 0a20 2020  _dask_array..   
+00029ca0: 2069 6620 6973 696e 7374 616e 6365 2869   if isinstance(i
+00029cb0: 6e64 6578 2c20 4672 616d 6542 6173 6529  ndex, FrameBase)
+00029cc0: 3a0a 2020 2020 2020 2020 696e 6465 7820  :.        index 
+00029cd0: 3d20 696e 6465 782e 746f 5f6c 6567 6163  = index.to_legac
+00029ce0: 795f 6461 7461 6672 616d 6528 290a 2020  y_dataframe().  
+00029cf0: 2020 6966 2063 6f6c 756d 6e73 2069 7320    if columns is 
+00029d00: 6e6f 7420 4e6f 6e65 2061 6e64 206e 6f74  not None and not
+00029d10: 206c 656e 2863 6f6c 756d 6e73 293a 0a20   len(columns):. 
+00029d20: 2020 2020 2020 2063 6f6c 756d 6e73 203d         columns =
+00029d30: 204e 6f6e 650a 2020 2020 6466 203d 2066   None.    df = f
+00029d40: 726f 6d5f 6461 736b 5f61 7272 6179 2878  rom_dask_array(x
+00029d50: 2c20 636f 6c75 6d6e 733d 636f 6c75 6d6e  , columns=column
+00029d60: 732c 2069 6e64 6578 3d69 6e64 6578 2c20  s, index=index, 
+00029d70: 6d65 7461 3d6d 6574 6129 0a20 2020 2072  meta=meta).    r
+00029d80: 6574 7572 6e20 6672 6f6d 5f6c 6567 6163  eturn from_legac
+00029d90: 795f 6461 7461 6672 616d 6528 6466 2c20  y_dataframe(df, 
+00029da0: 6f70 7469 6d69 7a65 3d54 7275 6529 0a0a  optimize=True)..
+00029db0: 0a64 6566 2072 6561 645f 6373 7628 0a20  .def read_csv(. 
+00029dc0: 2020 2070 6174 682c 0a20 2020 202a 6172     path,.    *ar
+00029dd0: 6773 2c0a 2020 2020 6865 6164 6572 3d22  gs,.    header="
+00029de0: 696e 6665 7222 2c0a 2020 2020 7573 6563  infer",.    usec
+00029df0: 6f6c 733d 4e6f 6e65 2c0a 2020 2020 6474  ols=None,.    dt
+00029e00: 7970 655f 6261 636b 656e 643d 4e6f 6e65  ype_backend=None
+00029e10: 2c0a 2020 2020 7374 6f72 6167 655f 6f70  ,.    storage_op
+00029e20: 7469 6f6e 733d 4e6f 6e65 2c0a 2020 2020  tions=None,.    
+00029e30: 2a2a 6b77 6172 6773 2c0a 293a 0a20 2020  **kwargs,.):.   
+00029e40: 2066 726f 6d20 6461 736b 5f65 7870 722e   from dask_expr.
+00029e50: 696f 2e63 7376 2069 6d70 6f72 7420 5265  io.csv import Re
+00029e60: 6164 4353 560a 0a20 2020 2069 6620 6e6f  adCSV..    if no
+00029e70: 7420 6973 696e 7374 616e 6365 2870 6174  t isinstance(pat
+00029e80: 682c 2073 7472 293a 0a20 2020 2020 2020  h, str):.       
+00029e90: 2070 6174 6820 3d20 7374 7269 6e67 6966   path = stringif
+00029ea0: 795f 7061 7468 2870 6174 6829 0a20 2020  y_path(path).   
+00029eb0: 2072 6574 7572 6e20 6e65 775f 636f 6c6c   return new_coll
+00029ec0: 6563 7469 6f6e 280a 2020 2020 2020 2020  ection(.        
+00029ed0: 5265 6164 4353 5628 0a20 2020 2020 2020  ReadCSV(.       
+00029ee0: 2020 2020 2070 6174 682c 0a20 2020 2020       path,.     
+00029ef0: 2020 2020 2020 2063 6f6c 756d 6e73 3d75         columns=u
+00029f00: 7365 636f 6c73 2c0a 2020 2020 2020 2020  secols,.        
+00029f10: 2020 2020 6474 7970 655f 6261 636b 656e      dtype_backen
+00029f20: 643d 6474 7970 655f 6261 636b 656e 642c  d=dtype_backend,
+00029f30: 0a20 2020 2020 2020 2020 2020 2073 746f  .            sto
+00029f40: 7261 6765 5f6f 7074 696f 6e73 3d73 746f  rage_options=sto
+00029f50: 7261 6765 5f6f 7074 696f 6e73 2c0a 2020  rage_options,.  
+00029f60: 2020 2020 2020 2020 2020 6b77 6172 6773            kwargs
+00029f70: 3d6b 7761 7267 732c 0a20 2020 2020 2020  =kwargs,.       
+00029f80: 2020 2020 2068 6561 6465 723d 6865 6164       header=head
+00029f90: 6572 2c0a 2020 2020 2020 2020 290a 2020  er,.        ).  
+00029fa0: 2020 290a 0a0a 6465 6620 7265 6164 5f74    )...def read_t
+00029fb0: 6162 6c65 280a 2020 2020 7061 7468 2c0a  able(.    path,.
+00029fc0: 2020 2020 2a61 7267 732c 0a20 2020 2068      *args,.    h
+00029fd0: 6561 6465 723d 2269 6e66 6572 222c 0a20  eader="infer",. 
+00029fe0: 2020 2075 7365 636f 6c73 3d4e 6f6e 652c     usecols=None,
+00029ff0: 0a20 2020 2064 7479 7065 5f62 6163 6b65  .    dtype_backe
+0002a000: 6e64 3d4e 6f6e 652c 0a20 2020 2073 746f  nd=None,.    sto
+0002a010: 7261 6765 5f6f 7074 696f 6e73 3d4e 6f6e  rage_options=Non
+0002a020: 652c 0a20 2020 202a 2a6b 7761 7267 732c  e,.    **kwargs,
+0002a030: 0a29 3a0a 2020 2020 6672 6f6d 2064 6173  .):.    from das
+0002a040: 6b5f 6578 7072 2e69 6f2e 6373 7620 696d  k_expr.io.csv im
+0002a050: 706f 7274 2052 6561 6454 6162 6c65 0a0a  port ReadTable..
+0002a060: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
+0002a070: 7461 6e63 6528 7061 7468 2c20 7374 7229  tance(path, str)
+0002a080: 3a0a 2020 2020 2020 2020 7061 7468 203d  :.        path =
+0002a090: 2073 7472 696e 6769 6679 5f70 6174 6828   stringify_path(
+0002a0a0: 7061 7468 290a 2020 2020 7265 7475 726e  path).    return
+0002a0b0: 206e 6577 5f63 6f6c 6c65 6374 696f 6e28   new_collection(
+0002a0c0: 0a20 2020 2020 2020 2052 6561 6454 6162  .        ReadTab
+0002a0d0: 6c65 280a 2020 2020 2020 2020 2020 2020  le(.            
+0002a0e0: 7061 7468 2c0a 2020 2020 2020 2020 2020  path,.          
+0002a0f0: 2020 636f 6c75 6d6e 733d 7573 6563 6f6c    columns=usecol
+0002a100: 732c 0a20 2020 2020 2020 2020 2020 2064  s,.            d
+0002a110: 7479 7065 5f62 6163 6b65 6e64 3d64 7479  type_backend=dty
+0002a120: 7065 5f62 6163 6b65 6e64 2c0a 2020 2020  pe_backend,.    
+0002a130: 2020 2020 2020 2020 7374 6f72 6167 655f          storage_
+0002a140: 6f70 7469 6f6e 733d 7374 6f72 6167 655f  options=storage_
+0002a150: 6f70 7469 6f6e 732c 0a20 2020 2020 2020  options,.       
+0002a160: 2020 2020 206b 7761 7267 733d 6b77 6172       kwargs=kwar
+0002a170: 6773 2c0a 2020 2020 2020 2020 2020 2020  gs,.            
+0002a180: 6865 6164 6572 3d68 6561 6465 722c 0a20  header=header,. 
+0002a190: 2020 2020 2020 2029 0a20 2020 2029 0a0a         ).    )..
+0002a1a0: 0a64 6566 2072 6561 645f 6677 6628 0a20  .def read_fwf(. 
+0002a1b0: 2020 2070 6174 682c 0a20 2020 202a 6172     path,.    *ar
+0002a1c0: 6773 2c0a 2020 2020 6865 6164 6572 3d22  gs,.    header="
+0002a1d0: 696e 6665 7222 2c0a 2020 2020 7573 6563  infer",.    usec
+0002a1e0: 6f6c 733d 4e6f 6e65 2c0a 2020 2020 6474  ols=None,.    dt
+0002a1f0: 7970 655f 6261 636b 656e 643d 4e6f 6e65  ype_backend=None
+0002a200: 2c0a 2020 2020 7374 6f72 6167 655f 6f70  ,.    storage_op
+0002a210: 7469 6f6e 733d 4e6f 6e65 2c0a 2020 2020  tions=None,.    
+0002a220: 2a2a 6b77 6172 6773 2c0a 293a 0a20 2020  **kwargs,.):.   
+0002a230: 2066 726f 6d20 6461 736b 5f65 7870 722e   from dask_expr.
+0002a240: 696f 2e63 7376 2069 6d70 6f72 7420 5265  io.csv import Re
+0002a250: 6164 4677 660a 0a20 2020 2069 6620 6e6f  adFwf..    if no
+0002a260: 7420 6973 696e 7374 616e 6365 2870 6174  t isinstance(pat
+0002a270: 682c 2073 7472 293a 0a20 2020 2020 2020  h, str):.       
+0002a280: 2070 6174 6820 3d20 7374 7269 6e67 6966   path = stringif
+0002a290: 795f 7061 7468 2870 6174 6829 0a20 2020  y_path(path).   
+0002a2a0: 2072 6574 7572 6e20 6e65 775f 636f 6c6c   return new_coll
+0002a2b0: 6563 7469 6f6e 280a 2020 2020 2020 2020  ection(.        
+0002a2c0: 5265 6164 4677 6628 0a20 2020 2020 2020  ReadFwf(.       
+0002a2d0: 2020 2020 2070 6174 682c 0a20 2020 2020       path,.     
+0002a2e0: 2020 2020 2020 2063 6f6c 756d 6e73 3d75         columns=u
+0002a2f0: 7365 636f 6c73 2c0a 2020 2020 2020 2020  secols,.        
+0002a300: 2020 2020 6474 7970 655f 6261 636b 656e      dtype_backen
+0002a310: 643d 6474 7970 655f 6261 636b 656e 642c  d=dtype_backend,
+0002a320: 0a20 2020 2020 2020 2020 2020 2073 746f  .            sto
+0002a330: 7261 6765 5f6f 7074 696f 6e73 3d73 746f  rage_options=sto
+0002a340: 7261 6765 5f6f 7074 696f 6e73 2c0a 2020  rage_options,.  
+0002a350: 2020 2020 2020 2020 2020 6b77 6172 6773            kwargs
+0002a360: 3d6b 7761 7267 732c 0a20 2020 2020 2020  =kwargs,.       
+0002a370: 2020 2020 2068 6561 6465 723d 6865 6164       header=head
+0002a380: 6572 2c0a 2020 2020 2020 2020 290a 2020  er,.        ).  
+0002a390: 2020 290a 0a0a 6465 6620 7265 6164 5f70    )...def read_p
+0002a3a0: 6172 7175 6574 280a 2020 2020 7061 7468  arquet(.    path
+0002a3b0: 3d4e 6f6e 652c 0a20 2020 2063 6f6c 756d  =None,.    colum
+0002a3c0: 6e73 3d4e 6f6e 652c 0a20 2020 2066 696c  ns=None,.    fil
+0002a3d0: 7465 7273 3d4e 6f6e 652c 0a20 2020 2063  ters=None,.    c
+0002a3e0: 6174 6567 6f72 6965 733d 4e6f 6e65 2c0a  ategories=None,.
+0002a3f0: 2020 2020 696e 6465 783d 4e6f 6e65 2c0a      index=None,.
+0002a400: 2020 2020 7374 6f72 6167 655f 6f70 7469      storage_opti
+0002a410: 6f6e 733d 4e6f 6e65 2c0a 2020 2020 6474  ons=None,.    dt
+0002a420: 7970 655f 6261 636b 656e 643d 4e6f 6e65  ype_backend=None
+0002a430: 2c0a 2020 2020 6361 6c63 756c 6174 655f  ,.    calculate_
+0002a440: 6469 7669 7369 6f6e 733d 4661 6c73 652c  divisions=False,
+0002a450: 0a20 2020 2069 676e 6f72 655f 6d65 7461  .    ignore_meta
+0002a460: 6461 7461 5f66 696c 653d 4661 6c73 652c  data_file=False,
+0002a470: 0a20 2020 206d 6574 6164 6174 615f 7461  .    metadata_ta
+0002a480: 736b 5f73 697a 653d 4e6f 6e65 2c0a 2020  sk_size=None,.  
+0002a490: 2020 7370 6c69 745f 726f 775f 6772 6f75    split_row_grou
+0002a4a0: 7073 3d22 696e 6665 7222 2c0a 2020 2020  ps="infer",.    
+0002a4b0: 626c 6f63 6b73 697a 653d 2264 6566 6175  blocksize="defau
+0002a4c0: 6c74 222c 0a20 2020 2061 6767 7265 6761  lt",.    aggrega
+0002a4d0: 7465 5f66 696c 6573 3d4e 6f6e 652c 0a20  te_files=None,. 
+0002a4e0: 2020 2070 6172 7175 6574 5f66 696c 655f     parquet_file_
+0002a4f0: 6578 7465 6e73 696f 6e3d 2822 2e70 6172  extension=(".par
+0002a500: 7122 2c20 222e 7061 7271 7565 7422 2c20  q", ".parquet", 
+0002a510: 222e 7071 2229 2c0a 2020 2020 6669 6c65  ".pq"),.    file
+0002a520: 7379 7374 656d 3d22 6673 7370 6563 222c  system="fsspec",
+0002a530: 0a20 2020 2065 6e67 696e 653d 4e6f 6e65  .    engine=None
+0002a540: 2c0a 2020 2020 6172 726f 775f 746f 5f70  ,.    arrow_to_p
+0002a550: 616e 6461 733d 4e6f 6e65 2c0a 2020 2020  andas=None,.    
+0002a560: 2a2a 6b77 6172 6773 2c0a 293a 0a20 2020  **kwargs,.):.   
+0002a570: 2066 726f 6d20 6461 736b 5f65 7870 722e   from dask_expr.
+0002a580: 696f 2e70 6172 7175 6574 2069 6d70 6f72  io.parquet impor
+0002a590: 7420 280a 2020 2020 2020 2020 5265 6164  t (.        Read
+0002a5a0: 5061 7271 7565 7446 5353 7065 632c 0a20  ParquetFSSpec,. 
+0002a5b0: 2020 2020 2020 2052 6561 6450 6172 7175         ReadParqu
+0002a5c0: 6574 5079 6172 726f 7746 532c 0a20 2020  etPyarrowFS,.   
+0002a5d0: 2020 2020 205f 7365 745f 7061 7271 7565       _set_parque
+0002a5e0: 745f 656e 6769 6e65 2c0a 2020 2020 290a  t_engine,.    ).
+0002a5f0: 0a20 2020 2069 6620 6e6f 7420 6973 696e  .    if not isin
+0002a600: 7374 616e 6365 2870 6174 682c 2073 7472  stance(path, str
+0002a610: 293a 0a20 2020 2020 2020 2070 6174 6820  ):.        path 
+0002a620: 3d20 7374 7269 6e67 6966 795f 7061 7468  = stringify_path
+0002a630: 2870 6174 6829 0a0a 2020 2020 6b77 6172  (path)..    kwar
+0002a640: 6773 5b22 6474 7970 655f 6261 636b 656e  gs["dtype_backen
+0002a650: 6422 5d20 3d20 6474 7970 655f 6261 636b  d"] = dtype_back
+0002a660: 656e 640a 2020 2020 6966 2061 7272 6f77  end.    if arrow
+0002a670: 5f74 6f5f 7061 6e64 6173 3a0a 2020 2020  _to_pandas:.    
+0002a680: 2020 2020 6b77 6172 6773 5b22 6172 726f      kwargs["arro
+0002a690: 775f 746f 5f70 616e 6461 7322 5d20 3d20  w_to_pandas"] = 
+0002a6a0: 6172 726f 775f 746f 5f70 616e 6461 730a  arrow_to_pandas.
+0002a6b0: 0a20 2020 2069 6620 6669 6c74 6572 7320  .    if filters 
+0002a6c0: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+0002a6d0: 2020 2020 2066 6f72 2066 696c 7465 7220       for filter 
+0002a6e0: 696e 2066 6c61 7474 656e 2866 696c 7465  in flatten(filte
+0002a6f0: 7273 2c20 636f 6e74 6169 6e65 723d 6c69  rs, container=li
+0002a700: 7374 293a 0a20 2020 2020 2020 2020 2020  st):.           
+0002a710: 2063 6f6c 2c20 6f70 2c20 7661 6c20 3d20   col, op, val = 
+0002a720: 6669 6c74 6572 0a20 2020 2020 2020 2020  filter.         
+0002a730: 2020 2069 6620 6f70 203d 3d20 2269 6e22     if op == "in"
+0002a740: 2061 6e64 206e 6f74 2069 7369 6e73 7461   and not isinsta
+0002a750: 6e63 6528 7661 6c2c 2028 7365 742c 206c  nce(val, (set, l
+0002a760: 6973 742c 2074 7570 6c65 2929 3a0a 2020  ist, tuple)):.  
+0002a770: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+0002a780: 6973 6520 5479 7065 4572 726f 7228 2256  ise TypeError("V
+0002a790: 616c 7565 206f 6620 2769 6e27 2066 696c  alue of 'in' fil
+0002a7a0: 7465 7220 6d75 7374 2062 6520 6120 6c69  ter must be a li
+0002a7b0: 7374 2c20 7365 7420 6f72 2074 7570 6c65  st, set or tuple
+0002a7c0: 2e22 290a 0a20 2020 2069 6620 280a 2020  .")..    if (.  
+0002a7d0: 2020 2020 2020 6973 696e 7374 616e 6365        isinstance
+0002a7e0: 2866 696c 6573 7973 7465 6d2c 2070 615f  (filesystem, pa_
+0002a7f0: 6673 2e46 696c 6553 7973 7465 6d29 0a20  fs.FileSystem). 
+0002a800: 2020 2020 2020 206f 7220 6973 696e 7374         or isinst
+0002a810: 616e 6365 2866 696c 6573 7973 7465 6d2c  ance(filesystem,
+0002a820: 2073 7472 290a 2020 2020 2020 2020 616e   str).        an
+0002a830: 6420 6669 6c65 7379 7374 656d 2e6c 6f77  d filesystem.low
+0002a840: 6572 2829 2069 6e20 2822 6172 726f 7722  er() in ("arrow"
+0002a850: 2c20 2270 7961 7272 6f77 2229 0a20 2020  , "pyarrow").   
+0002a860: 2029 3a0a 2020 2020 2020 2020 6966 2070   ):.        if p
+0002a870: 6172 7365 5f76 6572 7369 6f6e 2870 612e  arse_version(pa.
+0002a880: 5f5f 7665 7273 696f 6e5f 5f29 203c 2070  __version__) < p
+0002a890: 6172 7365 5f76 6572 7369 6f6e 2822 3135  arse_version("15
+0002a8a0: 2e30 2e30 2229 3a0a 2020 2020 2020 2020  .0.0"):.        
+0002a8b0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+0002a8c0: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+0002a8d0: 2020 2020 2020 2270 7961 7272 6f77 3e3d        "pyarrow>=
+0002a8e0: 3135 2e30 2e30 2069 7320 7265 7175 6972  15.0.0 is requir
+0002a8f0: 6564 2074 6f20 7573 6520 7468 6520 7079  ed to use the py
+0002a900: 6172 726f 7720 6669 6c65 7379 7374 656d  arrow filesystem
+0002a910: 2e22 0a20 2020 2020 2020 2020 2020 2029  .".            )
+0002a920: 0a20 2020 2020 2020 2069 6620 6d65 7461  .        if meta
+0002a930: 6461 7461 5f74 6173 6b5f 7369 7a65 2069  data_task_size i
+0002a940: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
+0002a950: 2020 2020 2020 2020 7261 6973 6520 4e6f          raise No
+0002a960: 7449 6d70 6c65 6d65 6e74 6564 4572 726f  tImplementedErro
+0002a970: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
+0002a980: 2020 2022 6d65 7461 6461 7461 5f74 6173     "metadata_tas
+0002a990: 6b5f 7369 7a65 2069 7320 6e6f 7420 7375  k_size is not su
+0002a9a0: 7070 6f72 7465 6420 7768 656e 2075 7369  pported when usi
+0002a9b0: 6e67 2074 6865 2070 7961 7272 6f77 2066  ng the pyarrow f
+0002a9c0: 696c 6573 7973 7465 6d2e 220a 2020 2020  ilesystem.".    
+0002a9d0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0002a9e0: 2020 6966 2073 706c 6974 5f72 6f77 5f67    if split_row_g
+0002a9f0: 726f 7570 7320 213d 2022 696e 6665 7222  roups != "infer"
+0002aa00: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+0002aa10: 6973 6520 4e6f 7449 6d70 6c65 6d65 6e74  ise NotImplement
+0002aa20: 6564 4572 726f 7228 0a20 2020 2020 2020  edError(.       
+0002aa30: 2020 2020 2020 2020 2022 7370 6c69 745f           "split_
+0002aa40: 726f 775f 6772 6f75 7073 2069 7320 6e6f  row_groups is no
+0002aa50: 7420 7375 7070 6f72 7465 6420 7768 656e  t supported when
+0002aa60: 2075 7369 6e67 2074 6865 2070 7961 7272   using the pyarr
+0002aa70: 6f77 2066 696c 6573 7973 7465 6d2e 220a  ow filesystem.".
+0002aa80: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0002aa90: 2020 2020 2020 6966 2062 6c6f 636b 7369        if blocksi
+0002aaa0: 7a65 2069 7320 6e6f 7420 4e6f 6e65 2061  ze is not None a
+0002aab0: 6e64 2062 6c6f 636b 7369 7a65 2021 3d20  nd blocksize != 
+0002aac0: 2264 6566 6175 6c74 223a 0a20 2020 2020  "default":.     
+0002aad0: 2020 2020 2020 2072 6169 7365 204e 6f74         raise Not
+0002aae0: 496d 706c 656d 656e 7465 6445 7272 6f72  ImplementedError
+0002aaf0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0002ab00: 2020 2262 6c6f 636b 7369 7a65 2069 7320    "blocksize is 
+0002ab10: 6e6f 7420 7375 7070 6f72 7465 6420 7768  not supported wh
+0002ab20: 656e 2075 7369 6e67 2074 6865 2070 7961  en using the pya
+0002ab30: 7272 6f77 2066 696c 6573 7973 7465 6d2e  rrow filesystem.
+0002ab40: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
+0002ab50: 2020 2020 2020 2020 6966 2061 6767 7265          if aggre
+0002ab60: 6761 7465 5f66 696c 6573 2069 7320 6e6f  gate_files is no
+0002ab70: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
+0002ab80: 2020 2020 7261 6973 6520 4e6f 7449 6d70      raise NotImp
+0002ab90: 6c65 6d65 6e74 6564 4572 726f 7228 0a20  lementedError(. 
+0002aba0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0002abb0: 6167 6772 6567 6174 655f 6669 6c65 7320  aggregate_files 
+0002abc0: 6973 206e 6f74 2073 7570 706f 7274 6564  is not supported
+0002abd0: 2077 6865 6e20 7573 696e 6720 7468 6520   when using the 
+0002abe0: 7079 6172 726f 7720 6669 6c65 7379 7374  pyarrow filesyst
+0002abf0: 656d 2e22 0a20 2020 2020 2020 2020 2020  em.".           
+0002ac00: 2029 0a20 2020 2020 2020 2069 6620 7061   ).        if pa
+0002ac10: 7271 7565 745f 6669 6c65 5f65 7874 656e  rquet_file_exten
+0002ac20: 7369 6f6e 2021 3d20 2822 2e70 6172 7122  sion != (".parq"
+0002ac30: 2c20 222e 7061 7271 7565 7422 2c20 222e  , ".parquet", ".
+0002ac40: 7071 2229 3a0a 2020 2020 2020 2020 2020  pq"):.          
+0002ac50: 2020 7261 6973 6520 4e6f 7449 6d70 6c65    raise NotImple
+0002ac60: 6d65 6e74 6564 4572 726f 7228 0a20 2020  mentedError(.   
+0002ac70: 2020 2020 2020 2020 2020 2020 2022 7061               "pa
+0002ac80: 7271 7565 745f 6669 6c65 5f65 7874 656e  rquet_file_exten
+0002ac90: 7369 6f6e 2069 7320 6e6f 7420 7375 7070  sion is not supp
+0002aca0: 6f72 7465 6420 7768 656e 2075 7369 6e67  orted when using
+0002acb0: 2074 6865 2070 7961 7272 6f77 2066 696c   the pyarrow fil
+0002acc0: 6573 7973 7465 6d2e 220a 2020 2020 2020  esystem.".      
+0002acd0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0002ace0: 6966 2065 6e67 696e 6520 6973 206e 6f74  if engine is not
+0002acf0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+0002ad00: 2020 2072 6169 7365 204e 6f74 496d 706c     raise NotImpl
+0002ad10: 656d 656e 7465 6445 7272 6f72 280a 2020  ementedError(.  
+0002ad20: 2020 2020 2020 2020 2020 2020 2020 2265                "e
+0002ad30: 6e67 696e 6520 6973 206e 6f74 2073 7570  ngine is not sup
+0002ad40: 706f 7274 6564 2077 6865 6e20 7573 696e  ported when usin
+0002ad50: 6720 7468 6520 7079 6172 726f 7720 6669  g the pyarrow fi
+0002ad60: 6c65 7379 7374 656d 2e22 0a20 2020 2020  lesystem.".     
+0002ad70: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+0002ad80: 2020 7265 7475 726e 206e 6577 5f63 6f6c    return new_col
+0002ad90: 6c65 6374 696f 6e28 0a20 2020 2020 2020  lection(.       
+0002ada0: 2020 2020 2052 6561 6450 6172 7175 6574       ReadParquet
+0002adb0: 5079 6172 726f 7746 5328 0a20 2020 2020  PyarrowFS(.     
+0002adc0: 2020 2020 2020 2020 2020 2070 6174 682c             path,
+0002add0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002ade0: 2063 6f6c 756d 6e73 3d5f 636f 6e76 6572   columns=_conver
+0002adf0: 745f 746f 5f6c 6973 7428 636f 6c75 6d6e  t_to_list(column
+0002ae00: 7329 2c0a 2020 2020 2020 2020 2020 2020  s),.            
+0002ae10: 2020 2020 6669 6c74 6572 733d 6669 6c74      filters=filt
+0002ae20: 6572 732c 0a20 2020 2020 2020 2020 2020  ers,.           
+0002ae30: 2020 2020 2063 6174 6567 6f72 6965 733d       categories=
+0002ae40: 6361 7465 676f 7269 6573 2c0a 2020 2020  categories,.    
+0002ae50: 2020 2020 2020 2020 2020 2020 696e 6465              inde
+0002ae60: 783d 696e 6465 782c 0a20 2020 2020 2020  x=index,.       
+0002ae70: 2020 2020 2020 2020 2063 616c 6375 6c61           calcula
+0002ae80: 7465 5f64 6976 6973 696f 6e73 3d63 616c  te_divisions=cal
+0002ae90: 6375 6c61 7465 5f64 6976 6973 696f 6e73  culate_divisions
+0002aea0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0002aeb0: 2020 7374 6f72 6167 655f 6f70 7469 6f6e    storage_option
+0002aec0: 733d 7374 6f72 6167 655f 6f70 7469 6f6e  s=storage_option
+0002aed0: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
+0002aee0: 2020 2066 696c 6573 7973 7465 6d3d 6669     filesystem=fi
+0002aef0: 6c65 7379 7374 656d 2c0a 2020 2020 2020  lesystem,.      
+0002af00: 2020 2020 2020 2020 2020 6967 6e6f 7265            ignore
+0002af10: 5f6d 6574 6164 6174 615f 6669 6c65 3d69  _metadata_file=i
+0002af20: 676e 6f72 655f 6d65 7461 6461 7461 5f66  gnore_metadata_f
+0002af30: 696c 652c 0a20 2020 2020 2020 2020 2020  ile,.           
+0002af40: 2020 2020 2061 7272 6f77 5f74 6f5f 7061       arrow_to_pa
+0002af50: 6e64 6173 3d61 7272 6f77 5f74 6f5f 7061  ndas=arrow_to_pa
+0002af60: 6e64 6173 2c0a 2020 2020 2020 2020 2020  ndas,.          
+0002af70: 2020 2020 2020 7079 6172 726f 775f 7374        pyarrow_st
+0002af80: 7269 6e67 735f 656e 6162 6c65 643d 7079  rings_enabled=py
+0002af90: 6172 726f 775f 7374 7269 6e67 735f 656e  arrow_strings_en
+0002afa0: 6162 6c65 6428 292c 0a20 2020 2020 2020  abled(),.       
+0002afb0: 2020 2020 2020 2020 206b 7761 7267 733d           kwargs=
+0002afc0: 6b77 6172 6773 2c0a 2020 2020 2020 2020  kwargs,.        
+0002afd0: 2020 2020 2020 2020 5f73 6572 6965 733d          _series=
+0002afe0: 6973 696e 7374 616e 6365 2863 6f6c 756d  isinstance(colum
+0002aff0: 6e73 2c20 7374 7229 2c0a 2020 2020 2020  ns, str),.      
+0002b000: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0002b010: 290a 0a20 2020 2072 6574 7572 6e20 6e65  )..    return ne
+0002b020: 775f 636f 6c6c 6563 7469 6f6e 280a 2020  w_collection(.  
+0002b030: 2020 2020 2020 5265 6164 5061 7271 7565        ReadParque
+0002b040: 7446 5353 7065 6328 0a20 2020 2020 2020  tFSSpec(.       
+0002b050: 2020 2020 2070 6174 682c 0a20 2020 2020       path,.     
+0002b060: 2020 2020 2020 2063 6f6c 756d 6e73 3d5f         columns=_
+0002b070: 636f 6e76 6572 745f 746f 5f6c 6973 7428  convert_to_list(
+0002b080: 636f 6c75 6d6e 7329 2c0a 2020 2020 2020  columns),.      
+0002b090: 2020 2020 2020 6669 6c74 6572 733d 6669        filters=fi
+0002b0a0: 6c74 6572 732c 0a20 2020 2020 2020 2020  lters,.         
+0002b0b0: 2020 2063 6174 6567 6f72 6965 733d 6361     categories=ca
+0002b0c0: 7465 676f 7269 6573 2c0a 2020 2020 2020  tegories,.      
+0002b0d0: 2020 2020 2020 696e 6465 783d 696e 6465        index=inde
+0002b0e0: 782c 0a20 2020 2020 2020 2020 2020 2073  x,.            s
+0002b0f0: 746f 7261 6765 5f6f 7074 696f 6e73 3d73  torage_options=s
+0002b100: 746f 7261 6765 5f6f 7074 696f 6e73 2c0a  torage_options,.
+0002b110: 2020 2020 2020 2020 2020 2020 6361 6c63              calc
+0002b120: 756c 6174 655f 6469 7669 7369 6f6e 733d  ulate_divisions=
+0002b130: 6361 6c63 756c 6174 655f 6469 7669 7369  calculate_divisi
+0002b140: 6f6e 732c 0a20 2020 2020 2020 2020 2020  ons,.           
+0002b150: 2069 676e 6f72 655f 6d65 7461 6461 7461   ignore_metadata
+0002b160: 5f66 696c 653d 6967 6e6f 7265 5f6d 6574  _file=ignore_met
+0002b170: 6164 6174 615f 6669 6c65 2c0a 2020 2020  adata_file,.    
+0002b180: 2020 2020 2020 2020 6d65 7461 6461 7461          metadata
+0002b190: 5f74 6173 6b5f 7369 7a65 3d6d 6574 6164  _task_size=metad
+0002b1a0: 6174 615f 7461 736b 5f73 697a 652c 0a20  ata_task_size,. 
+0002b1b0: 2020 2020 2020 2020 2020 2073 706c 6974             split
+0002b1c0: 5f72 6f77 5f67 726f 7570 733d 7370 6c69  _row_groups=spli
+0002b1d0: 745f 726f 775f 6772 6f75 7073 2c0a 2020  t_row_groups,.  
+0002b1e0: 2020 2020 2020 2020 2020 626c 6f63 6b73            blocks
+0002b1f0: 697a 653d 626c 6f63 6b73 697a 652c 0a20  ize=blocksize,. 
+0002b200: 2020 2020 2020 2020 2020 2061 6767 7265             aggre
+0002b210: 6761 7465 5f66 696c 6573 3d61 6767 7265  gate_files=aggre
+0002b220: 6761 7465 5f66 696c 6573 2c0a 2020 2020  gate_files,.    
+0002b230: 2020 2020 2020 2020 7061 7271 7565 745f          parquet_
+0002b240: 6669 6c65 5f65 7874 656e 7369 6f6e 3d70  file_extension=p
+0002b250: 6172 7175 6574 5f66 696c 655f 6578 7465  arquet_file_exte
+0002b260: 6e73 696f 6e2c 0a20 2020 2020 2020 2020  nsion,.         
+0002b270: 2020 2066 696c 6573 7973 7465 6d3d 6669     filesystem=fi
+0002b280: 6c65 7379 7374 656d 2c0a 2020 2020 2020  lesystem,.      
+0002b290: 2020 2020 2020 656e 6769 6e65 3d5f 7365        engine=_se
+0002b2a0: 745f 7061 7271 7565 745f 656e 6769 6e65  t_parquet_engine
+0002b2b0: 2865 6e67 696e 6529 2c0a 2020 2020 2020  (engine),.      
+0002b2c0: 2020 2020 2020 6b77 6172 6773 3d6b 7761        kwargs=kwa
+0002b2d0: 7267 732c 0a20 2020 2020 2020 2020 2020  rgs,.           
+0002b2e0: 205f 7365 7269 6573 3d69 7369 6e73 7461   _series=isinsta
+0002b2f0: 6e63 6528 636f 6c75 6d6e 732c 2073 7472  nce(columns, str
+0002b300: 292c 0a20 2020 2020 2020 2029 0a20 2020  ),.        ).   
+0002b310: 2029 0a0a 0a64 6566 2063 6f6e 6361 7428   )...def concat(
+0002b320: 0a20 2020 2064 6673 2c0a 2020 2020 6178  .    dfs,.    ax
+0002b330: 6973 3d30 2c0a 2020 2020 6a6f 696e 3d22  is=0,.    join="
+0002b340: 6f75 7465 7222 2c0a 2020 2020 6967 6e6f  outer",.    igno
+0002b350: 7265 5f75 6e6b 6e6f 776e 5f64 6976 6973  re_unknown_divis
+0002b360: 696f 6e73 3d46 616c 7365 2c0a 2020 2020  ions=False,.    
+0002b370: 6967 6e6f 7265 5f6f 7264 6572 3d46 616c  ignore_order=Fal
+0002b380: 7365 2c0a 2020 2020 696e 7465 726c 6561  se,.    interlea
+0002b390: 7665 5f70 6172 7469 7469 6f6e 733d 4661  ve_partitions=Fa
+0002b3a0: 6c73 652c 0a20 2020 202a 2a6b 7761 7267  lse,.    **kwarg
+0002b3b0: 732c 0a29 3a0a 2020 2020 6966 206e 6f74  s,.):.    if not
+0002b3c0: 2069 7369 6e73 7461 6e63 6528 6466 732c   isinstance(dfs,
+0002b3d0: 206c 6973 7429 3a0a 2020 2020 2020 2020   list):.        
+0002b3e0: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
+0002b3f0: 2264 6673 206d 7573 7420 6265 2061 206c  "dfs must be a l
+0002b400: 6973 7420 6f66 2044 6174 6146 7261 6d65  ist of DataFrame
+0002b410: 732f 5365 7269 6573 206f 626a 6563 7473  s/Series objects
+0002b420: 2229 0a20 2020 2069 6620 6c65 6e28 6466  ").    if len(df
+0002b430: 7329 203d 3d20 303a 0a20 2020 2020 2020  s) == 0:.       
+0002b440: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+0002b450: 7228 224e 6f20 6f62 6a65 6374 7320 746f  r("No objects to
+0002b460: 2063 6f6e 6361 7465 6e61 7465 2229 0a20   concatenate"). 
+0002b470: 2020 2069 6620 6c65 6e28 6466 7329 203d     if len(dfs) =
+0002b480: 3d20 313a 0a20 2020 2020 2020 2069 6620  = 1:.        if 
+0002b490: 6178 6973 203d 3d20 3120 616e 6420 6973  axis == 1 and is
+0002b4a0: 696e 7374 616e 6365 2864 6673 5b30 5d2c  instance(dfs[0],
+0002b4b0: 2053 6572 6965 7329 3a0a 2020 2020 2020   Series):.      
+0002b4c0: 2020 2020 2020 7265 7475 726e 2064 6673        return dfs
+0002b4d0: 5b30 5d2e 746f 5f66 7261 6d65 2829 0a20  [0].to_frame(). 
+0002b4e0: 2020 2020 2020 2072 6574 7572 6e20 6466         return df
+0002b4f0: 735b 305d 0a0a 2020 2020 6966 206a 6f69  s[0]..    if joi
+0002b500: 6e20 6e6f 7420 696e 2028 2269 6e6e 6572  n not in ("inner
+0002b510: 222c 2022 6f75 7465 7222 293a 0a20 2020  ", "outer"):.   
+0002b520: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+0002b530: 4572 726f 7228 2227 6a6f 696e 2720 6d75  Error("'join' mu
+0002b540: 7374 2062 6520 2769 6e6e 6572 2720 6f72  st be 'inner' or
+0002b550: 2027 6f75 7465 7227 2229 0a0a 2020 2020   'outer'")..    
+0002b560: 6466 7320 3d20 5b66 726f 6d5f 7061 6e64  dfs = [from_pand
+0002b570: 6173 2864 6629 2069 6620 6e6f 7420 6973  as(df) if not is
+0002b580: 696e 7374 616e 6365 2864 662c 2046 7261  instance(df, Fra
+0002b590: 6d65 4261 7365 2920 656c 7365 2064 6620  meBase) else df 
+0002b5a0: 666f 7220 6466 2069 6e20 6466 735d 0a0a  for df in dfs]..
+0002b5b0: 2020 2020 6966 2061 7869 7320 3d3d 2031      if axis == 1
+0002b5c0: 3a0a 2020 2020 2020 2020 6466 7320 3d20  :.        dfs = 
+0002b5d0: 5b64 6620 666f 7220 6466 2069 6e20 6466  [df for df in df
+0002b5e0: 7320 6966 206c 656e 2864 662e 636f 6c75  s if len(df.colu
+0002b5f0: 6d6e 7329 203e 2030 206f 7220 6973 696e  mns) > 0 or isin
+0002b600: 7374 616e 6365 2864 662c 2053 6572 6965  stance(df, Serie
+0002b610: 7329 5d0a 0a20 2020 2072 6574 7572 6e20  s)]..    return 
+0002b620: 6e65 775f 636f 6c6c 6563 7469 6f6e 280a  new_collection(.
+0002b630: 2020 2020 2020 2020 436f 6e63 6174 280a          Concat(.
+0002b640: 2020 2020 2020 2020 2020 2020 6a6f 696e              join
+0002b650: 2c0a 2020 2020 2020 2020 2020 2020 6967  ,.            ig
+0002b660: 6e6f 7265 5f6f 7264 6572 2c0a 2020 2020  nore_order,.    
+0002b670: 2020 2020 2020 2020 6b77 6172 6773 2c0a          kwargs,.
+0002b680: 2020 2020 2020 2020 2020 2020 6178 6973              axis
+0002b690: 2c0a 2020 2020 2020 2020 2020 2020 6967  ,.            ig
+0002b6a0: 6e6f 7265 5f75 6e6b 6e6f 776e 5f64 6976  nore_unknown_div
+0002b6b0: 6973 696f 6e73 2c0a 2020 2020 2020 2020  isions,.        
+0002b6c0: 2020 2020 696e 7465 726c 6561 7665 5f70      interleave_p
+0002b6d0: 6172 7469 7469 6f6e 732c 0a20 2020 2020  artitions,.     
+0002b6e0: 2020 2020 2020 202a 6466 732c 0a20 2020         *dfs,.   
+0002b6f0: 2020 2020 2029 0a20 2020 2029 0a0a 0a64       ).    )...d
+0002b700: 6566 206d 6572 6765 280a 2020 2020 6c65  ef merge(.    le
+0002b710: 6674 2c0a 2020 2020 7269 6768 742c 0a20  ft,.    right,. 
+0002b720: 2020 2068 6f77 3d22 696e 6e65 7222 2c0a     how="inner",.
+0002b730: 2020 2020 6f6e 3d4e 6f6e 652c 0a20 2020      on=None,.   
+0002b740: 206c 6566 745f 6f6e 3d4e 6f6e 652c 0a20   left_on=None,. 
+0002b750: 2020 2072 6967 6874 5f6f 6e3d 4e6f 6e65     right_on=None
+0002b760: 2c0a 2020 2020 6c65 6674 5f69 6e64 6578  ,.    left_index
+0002b770: 3d46 616c 7365 2c0a 2020 2020 7269 6768  =False,.    righ
+0002b780: 745f 696e 6465 783d 4661 6c73 652c 0a20  t_index=False,. 
+0002b790: 2020 2073 7566 6669 7865 733d 2822 5f78     suffixes=("_x
+0002b7a0: 222c 2022 5f79 2229 2c0a 2020 2020 696e  ", "_y"),.    in
+0002b7b0: 6469 6361 746f 723d 4661 6c73 652c 0a20  dicator=False,. 
+0002b7c0: 2020 2073 6875 6666 6c65 5f6d 6574 686f     shuffle_metho
+0002b7d0: 643d 4e6f 6e65 2c0a 2020 2020 6e70 6172  d=None,.    npar
+0002b7e0: 7469 7469 6f6e 733d 4e6f 6e65 2c0a 2020  titions=None,.  
+0002b7f0: 2020 6272 6f61 6463 6173 743d 4e6f 6e65    broadcast=None
+0002b800: 2c0a 293a 0a20 2020 2066 6f72 206f 2069  ,.):.    for o i
+0002b810: 6e20 5b6f 6e2c 206c 6566 745f 6f6e 2c20  n [on, left_on, 
+0002b820: 7269 6768 745f 6f6e 5d3a 0a20 2020 2020  right_on]:.     
+0002b830: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+0002b840: 286f 2c20 4672 616d 6542 6173 6529 3a0a  (o, FrameBase):.
+0002b850: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0002b860: 6520 4e6f 7449 6d70 6c65 6d65 6e74 6564  e NotImplemented
+0002b870: 4572 726f 7228 290a 2020 2020 6966 206e  Error().    if n
+0002b880: 6f74 206f 6e20 616e 6420 6e6f 7420 6c65  ot on and not le
+0002b890: 6674 5f6f 6e20 616e 6420 6e6f 7420 7269  ft_on and not ri
+0002b8a0: 6768 745f 6f6e 2061 6e64 206e 6f74 206c  ght_on and not l
+0002b8b0: 6566 745f 696e 6465 7820 616e 6420 6e6f  eft_index and no
+0002b8c0: 7420 7269 6768 745f 696e 6465 783a 0a20  t right_index:. 
+0002b8d0: 2020 2020 2020 206f 6e20 3d20 5b63 2066         on = [c f
+0002b8e0: 6f72 2063 2069 6e20 6c65 6674 2e63 6f6c  or c in left.col
+0002b8f0: 756d 6e73 2069 6620 6320 696e 2072 6967  umns if c in rig
+0002b900: 6874 2e63 6f6c 756d 6e73 5d0a 2020 2020  ht.columns].    
+0002b910: 2020 2020 6966 206e 6f74 206f 6e3a 0a20      if not on:. 
+0002b920: 2020 2020 2020 2020 2020 206c 6566 745f             left_
+0002b930: 696e 6465 7820 3d20 7269 6768 745f 696e  index = right_in
+0002b940: 6465 7820 3d20 5472 7565 0a0a 2020 2020  dex = True..    
+0002b950: 6966 206f 6e20 616e 6420 6e6f 7420 6c65  if on and not le
+0002b960: 6674 5f6f 6e20 616e 6420 6e6f 7420 7269  ft_on and not ri
+0002b970: 6768 745f 6f6e 3a0a 2020 2020 2020 2020  ght_on:.        
+0002b980: 6c65 6674 5f6f 6e20 3d20 7269 6768 745f  left_on = right_
+0002b990: 6f6e 203d 206f 6e0a 0a20 2020 2073 7570  on = on..    sup
+0002b9a0: 706f 7274 6564 5f68 6f77 203d 2028 226c  ported_how = ("l
+0002b9b0: 6566 7422 2c20 2272 6967 6874 222c 2022  eft", "right", "
+0002b9c0: 6f75 7465 7222 2c20 2269 6e6e 6572 222c  outer", "inner",
+0002b9d0: 2022 6c65 6674 7365 6d69 2229 0a20 2020   "leftsemi").   
+0002b9e0: 2069 6620 686f 7720 6e6f 7420 696e 2073   if how not in s
+0002b9f0: 7570 706f 7274 6564 5f68 6f77 3a0a 2020  upported_how:.  
+0002ba00: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+0002ba10: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
+0002ba20: 2020 2020 6622 6461 736b 2e64 6174 6166      f"dask.dataf
+0002ba30: 7261 6d65 2e6d 6572 6765 2064 6f65 7320  rame.merge does 
+0002ba40: 6e6f 7420 7375 7070 6f72 7420 686f 773d  not support how=
+0002ba50: 277b 686f 777d 272e 220a 2020 2020 2020  '{how}'.".      
+0002ba60: 2020 2020 2020 6622 4f70 7469 6f6e 7320        f"Options 
+0002ba70: 6172 653a 207b 7375 7070 6f72 7465 645f  are: {supported_
+0002ba80: 686f 777d 2e22 0a20 2020 2020 2020 2029  how}.".        )
+0002ba90: 0a0a 2020 2020 6966 2068 6f77 203d 3d20  ..    if how == 
+0002baa0: 226c 6566 7473 656d 6922 3a0a 2020 2020  "leftsemi":.    
+0002bab0: 2020 2020 6966 2072 6967 6874 5f69 6e64      if right_ind
+0002bac0: 6578 206f 7220 616e 7928 0a20 2020 2020  ex or any(.     
+0002bad0: 2020 2020 2020 206f 206e 6f74 2069 6e20         o not in 
+0002bae0: 7269 6768 742e 636f 6c75 6d6e 7320 666f  right.columns fo
+0002baf0: 7220 6f20 696e 205f 636f 6e76 6572 745f  r o in _convert_
+0002bb00: 746f 5f6c 6973 7428 7269 6768 745f 6f6e  to_list(right_on
+0002bb10: 290a 2020 2020 2020 2020 293a 0a20 2020  ).        ):.   
+0002bb20: 2020 2020 2020 2020 2072 6169 7365 204e           raise N
+0002bb30: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
+0002bb40: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+0002bb50: 2020 2020 2268 6f77 3d27 6c65 6674 7365      "how='leftse
+0002bb60: 6d69 2720 646f 6573 206e 6f74 2073 7570  mi' does not sup
+0002bb70: 706f 7274 2072 6967 6874 5f69 6e64 6578  port right_index
+0002bb80: 3d54 7275 6520 6f72 206f 6e20 636f 6c75  =True or on colu
+0002bb90: 6d6e 7320 6672 6f6d 2074 6865 2069 6e64  mns from the ind
+0002bba0: 6578 220a 2020 2020 2020 2020 2020 2020  ex".            
+0002bbb0: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
+0002bbc0: 2020 2020 2020 2020 2020 2020 7269 6768              righ
+0002bbd0: 7420 3d20 7269 6768 745b 5f63 6f6e 7665  t = right[_conve
+0002bbe0: 7274 5f74 6f5f 6c69 7374 2872 6967 6874  rt_to_list(right
+0002bbf0: 5f6f 6e29 5d2e 7265 6e61 6d65 280a 2020  _on)].rename(.  
+0002bc00: 2020 2020 2020 2020 2020 2020 2020 636f                co
+0002bc10: 6c75 6d6e 733d 6469 6374 287a 6970 285f  lumns=dict(zip(_
+0002bc20: 636f 6e76 6572 745f 746f 5f6c 6973 7428  convert_to_list(
+0002bc30: 7269 6768 745f 6f6e 292c 205f 636f 6e76  right_on), _conv
+0002bc40: 6572 745f 746f 5f6c 6973 7428 6c65 6674  ert_to_list(left
+0002bc50: 5f6f 6e29 2929 0a20 2020 2020 2020 2020  _on))).         
+0002bc60: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+0002bc70: 2072 6967 6874 5f6f 6e20 3d20 6c65 6674   right_on = left
+0002bc80: 5f6f 6e0a 0a20 2020 2023 2054 7261 6e73  _on..    # Trans
+0002bc90: 666f 726d 2070 616e 6461 7320 6f62 6a65  form pandas obje
+0002bca0: 6374 7320 696e 746f 2064 6173 6b2e 6461  cts into dask.da
+0002bcb0: 7461 6672 616d 6520 6f62 6a65 6374 730a  taframe objects.
+0002bcc0: 2020 2020 6966 206e 6f74 2069 735f 6461      if not is_da
+0002bcd0: 736b 5f63 6f6c 6c65 6374 696f 6e28 6c65  sk_collection(le
+0002bce0: 6674 293a 0a20 2020 2020 2020 2069 6620  ft):.        if 
+0002bcf0: 7269 6768 745f 696e 6465 7820 616e 6420  right_index and 
+0002bd00: 6c65 6674 5f6f 6e3a 2020 2320 6368 616e  left_on:  # chan
+0002bd10: 6765 2074 6f20 6a6f 696e 206f 6e20 696e  ge to join on in
+0002bd20: 6465 780a 2020 2020 2020 2020 2020 2020  dex.            
+0002bd30: 6c65 6674 203d 206c 6566 742e 7365 745f  left = left.set_
+0002bd40: 696e 6465 7828 6c65 6674 5b6c 6566 745f  index(left[left_
+0002bd50: 6f6e 5d29 0a20 2020 2020 2020 2020 2020  on]).           
+0002bd60: 206c 6566 745f 6f6e 203d 204e 6f6e 650a   left_on = None.
+0002bd70: 2020 2020 2020 2020 2020 2020 6c65 6674              left
+0002bd80: 5f69 6e64 6578 203d 2054 7275 650a 2020  _index = True.  
+0002bd90: 2020 2020 2020 6c65 6674 203d 2066 726f        left = fro
+0002bda0: 6d5f 7061 6e64 6173 286c 6566 742c 206e  m_pandas(left, n
+0002bdb0: 7061 7274 6974 696f 6e73 3d31 290a 0a20  partitions=1).. 
+0002bdc0: 2020 2069 6620 6e6f 7420 6973 5f64 6173     if not is_das
+0002bdd0: 6b5f 636f 6c6c 6563 7469 6f6e 2872 6967  k_collection(rig
+0002bde0: 6874 293a 0a20 2020 2020 2020 2069 6620  ht):.        if 
+0002bdf0: 6c65 6674 5f69 6e64 6578 2061 6e64 2072  left_index and r
+0002be00: 6967 6874 5f6f 6e3a 2020 2320 6368 616e  ight_on:  # chan
+0002be10: 6765 2074 6f20 6a6f 696e 206f 6e20 696e  ge to join on in
+0002be20: 6465 780a 2020 2020 2020 2020 2020 2020  dex.            
+0002be30: 7269 6768 7420 3d20 7269 6768 742e 7365  right = right.se
+0002be40: 745f 696e 6465 7828 7269 6768 745b 7269  t_index(right[ri
+0002be50: 6768 745f 6f6e 5d29 0a20 2020 2020 2020  ght_on]).       
+0002be60: 2020 2020 2072 6967 6874 5f6f 6e20 3d20       right_on = 
+0002be70: 4e6f 6e65 0a20 2020 2020 2020 2020 2020  None.           
+0002be80: 2072 6967 6874 5f69 6e64 6578 203d 2054   right_index = T
+0002be90: 7275 650a 2020 2020 2020 2020 7269 6768  rue.        righ
+0002bea0: 7420 3d20 6672 6f6d 5f70 616e 6461 7328  t = from_pandas(
+0002beb0: 7269 6768 742c 206e 7061 7274 6974 696f  right, npartitio
+0002bec0: 6e73 3d31 290a 0a20 2020 2061 7373 6572  ns=1)..    asser
+0002bed0: 7420 6973 5f64 6174 6166 7261 6d65 5f6c  t is_dataframe_l
+0002bee0: 696b 6528 7269 6768 742e 5f6d 6574 6129  ike(right._meta)
+0002bef0: 0a20 2020 2069 6620 6c65 6674 5f6f 6e20  .    if left_on 
+0002bf00: 616e 6420 7269 6768 745f 6f6e 3a0a 2020  and right_on:.  
+0002bf10: 2020 2020 2020 7761 726e 5f64 7479 7065        warn_dtype
+0002bf20: 5f6d 6973 6d61 7463 6828 6c65 6674 2c20  _mismatch(left, 
+0002bf30: 7269 6768 742c 206c 6566 745f 6f6e 2c20  right, left_on, 
+0002bf40: 7269 6768 745f 6f6e 290a 0a20 2020 2072  right_on)..    r
+0002bf50: 6574 7572 6e20 6e65 775f 636f 6c6c 6563  eturn new_collec
+0002bf60: 7469 6f6e 280a 2020 2020 2020 2020 4d65  tion(.        Me
+0002bf70: 7267 6528 0a20 2020 2020 2020 2020 2020  rge(.           
+0002bf80: 206c 6566 742c 0a20 2020 2020 2020 2020   left,.         
+0002bf90: 2020 2072 6967 6874 2c0a 2020 2020 2020     right,.      
+0002bfa0: 2020 2020 2020 686f 773d 686f 772c 0a20        how=how,. 
+0002bfb0: 2020 2020 2020 2020 2020 206c 6566 745f             left_
+0002bfc0: 6f6e 3d6c 6566 745f 6f6e 2c0a 2020 2020  on=left_on,.    
+0002bfd0: 2020 2020 2020 2020 7269 6768 745f 6f6e          right_on
+0002bfe0: 3d72 6967 6874 5f6f 6e2c 0a20 2020 2020  =right_on,.     
+0002bff0: 2020 2020 2020 206c 6566 745f 696e 6465         left_inde
+0002c000: 783d 6c65 6674 5f69 6e64 6578 2c0a 2020  x=left_index,.  
+0002c010: 2020 2020 2020 2020 2020 7269 6768 745f            right_
+0002c020: 696e 6465 783d 7269 6768 745f 696e 6465  index=right_inde
+0002c030: 782c 0a20 2020 2020 2020 2020 2020 2073  x,.            s
+0002c040: 7566 6669 7865 733d 7375 6666 6978 6573  uffixes=suffixes
+0002c050: 2c0a 2020 2020 2020 2020 2020 2020 696e  ,.            in
+0002c060: 6469 6361 746f 723d 696e 6469 6361 746f  dicator=indicato
+0002c070: 722c 0a20 2020 2020 2020 2020 2020 2073  r,.            s
+0002c080: 6875 6666 6c65 5f6d 6574 686f 643d 6765  huffle_method=ge
+0002c090: 745f 7370 6563 6966 6965 645f 7368 7566  t_specified_shuf
+0002c0a0: 666c 6528 7368 7566 666c 655f 6d65 7468  fle(shuffle_meth
+0002c0b0: 6f64 292c 0a20 2020 2020 2020 2020 2020  od),.           
+0002c0c0: 205f 6e70 6172 7469 7469 6f6e 733d 6e70   _npartitions=np
+0002c0d0: 6172 7469 7469 6f6e 732c 0a20 2020 2020  artitions,.     
+0002c0e0: 2020 2020 2020 2062 726f 6164 6361 7374         broadcast
+0002c0f0: 3d62 726f 6164 6361 7374 2c0a 2020 2020  =broadcast,.    
+0002c100: 2020 2020 290a 2020 2020 290a 0a0a 6465      ).    )...de
+0002c110: 6620 6d65 7267 655f 6173 6f66 280a 2020  f merge_asof(.  
+0002c120: 2020 6c65 6674 2c0a 2020 2020 7269 6768    left,.    righ
+0002c130: 742c 0a20 2020 206f 6e3d 4e6f 6e65 2c0a  t,.    on=None,.
+0002c140: 2020 2020 6c65 6674 5f6f 6e3d 4e6f 6e65      left_on=None
+0002c150: 2c0a 2020 2020 7269 6768 745f 6f6e 3d4e  ,.    right_on=N
+0002c160: 6f6e 652c 0a20 2020 206c 6566 745f 696e  one,.    left_in
+0002c170: 6465 783d 4661 6c73 652c 0a20 2020 2072  dex=False,.    r
+0002c180: 6967 6874 5f69 6e64 6578 3d46 616c 7365  ight_index=False
+0002c190: 2c0a 2020 2020 6279 3d4e 6f6e 652c 0a20  ,.    by=None,. 
+0002c1a0: 2020 206c 6566 745f 6279 3d4e 6f6e 652c     left_by=None,
+0002c1b0: 0a20 2020 2072 6967 6874 5f62 793d 4e6f  .    right_by=No
+0002c1c0: 6e65 2c0a 2020 2020 7375 6666 6978 6573  ne,.    suffixes
+0002c1d0: 3d28 225f 7822 2c20 225f 7922 292c 0a20  =("_x", "_y"),. 
+0002c1e0: 2020 2074 6f6c 6572 616e 6365 3d4e 6f6e     tolerance=Non
+0002c1f0: 652c 0a20 2020 2061 6c6c 6f77 5f65 7861  e,.    allow_exa
+0002c200: 6374 5f6d 6174 6368 6573 3d54 7275 652c  ct_matches=True,
+0002c210: 0a20 2020 2064 6972 6563 7469 6f6e 3d22  .    direction="
+0002c220: 6261 636b 7761 7264 222c 0a29 3a0a 2020  backward",.):.  
+0002c230: 2020 6966 2064 6972 6563 7469 6f6e 206e    if direction n
+0002c240: 6f74 2069 6e20 5b22 6261 636b 7761 7264  ot in ["backward
+0002c250: 222c 2022 666f 7277 6172 6422 2c20 226e  ", "forward", "n
+0002c260: 6561 7265 7374 225d 3a0a 2020 2020 2020  earest"]:.      
+0002c270: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+0002c280: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+0002c290: 2249 6e76 616c 6964 206d 6572 6765 5f61  "Invalid merge_a
+0002c2a0: 736f 6620 6469 7265 6374 696f 6e2e 2043  sof direction. C
+0002c2b0: 686f 6f73 6520 6672 6f6d 2027 6261 636b  hoose from 'back
+0002c2c0: 7761 7264 2722 0a20 2020 2020 2020 2020  ward'".         
+0002c2d0: 2020 2022 2027 666f 7277 6172 6427 2c20     " 'forward', 
+0002c2e0: 6f72 2027 6e65 6172 6573 7427 220a 2020  or 'nearest'".  
+0002c2f0: 2020 2020 2020 290a 0a20 2020 206b 7761        )..    kwa
+0002c300: 7267 7320 3d20 7b0a 2020 2020 2020 2020  rgs = {.        
+0002c310: 226f 6e22 3a20 6f6e 2c0a 2020 2020 2020  "on": on,.      
+0002c320: 2020 226c 6566 745f 6f6e 223a 206c 6566    "left_on": lef
+0002c330: 745f 6f6e 2c0a 2020 2020 2020 2020 2272  t_on,.        "r
+0002c340: 6967 6874 5f6f 6e22 3a20 7269 6768 745f  ight_on": right_
+0002c350: 6f6e 2c0a 2020 2020 2020 2020 226c 6566  on,.        "lef
+0002c360: 745f 696e 6465 7822 3a20 6c65 6674 5f69  t_index": left_i
+0002c370: 6e64 6578 2c0a 2020 2020 2020 2020 2272  ndex,.        "r
+0002c380: 6967 6874 5f69 6e64 6578 223a 2072 6967  ight_index": rig
+0002c390: 6874 5f69 6e64 6578 2c0a 2020 2020 2020  ht_index,.      
+0002c3a0: 2020 2262 7922 3a20 6279 2c0a 2020 2020    "by": by,.    
+0002c3b0: 2020 2020 226c 6566 745f 6279 223a 206c      "left_by": l
+0002c3c0: 6566 745f 6279 2c0a 2020 2020 2020 2020  eft_by,.        
+0002c3d0: 2272 6967 6874 5f62 7922 3a20 7269 6768  "right_by": righ
+0002c3e0: 745f 6279 2c0a 2020 2020 2020 2020 2273  t_by,.        "s
+0002c3f0: 7566 6669 7865 7322 3a20 7375 6666 6978  uffixes": suffix
+0002c400: 6573 2c0a 2020 2020 2020 2020 2274 6f6c  es,.        "tol
+0002c410: 6572 616e 6365 223a 2074 6f6c 6572 616e  erance": toleran
+0002c420: 6365 2c0a 2020 2020 2020 2020 2261 6c6c  ce,.        "all
+0002c430: 6f77 5f65 7861 6374 5f6d 6174 6368 6573  ow_exact_matches
+0002c440: 223a 2061 6c6c 6f77 5f65 7861 6374 5f6d  ": allow_exact_m
+0002c450: 6174 6368 6573 2c0a 2020 2020 2020 2020  atches,.        
+0002c460: 2264 6972 6563 7469 6f6e 223a 2064 6972  "direction": dir
+0002c470: 6563 7469 6f6e 2c0a 2020 2020 7d0a 0a20  ection,.    }.. 
+0002c480: 2020 2069 6620 6c65 6674 2069 7320 4e6f     if left is No
+0002c490: 6e65 206f 7220 7269 6768 7420 6973 204e  ne or right is N
+0002c4a0: 6f6e 653a 0a20 2020 2020 2020 2072 6169  one:.        rai
+0002c4b0: 7365 2056 616c 7565 4572 726f 7228 2243  se ValueError("C
+0002c4c0: 616e 6e6f 7420 6d65 7267 655f 6173 6f66  annot merge_asof
+0002c4d0: 206f 6e20 4e6f 6e65 2229 0a0a 2020 2020   on None")..    
+0002c4e0: 2320 6966 2069 735f 6461 7461 6672 616d  # if is_datafram
+0002c4f0: 655f 6c69 6b65 286c 6566 7429 2061 6e64  e_like(left) and
+0002c500: 2069 735f 6461 7461 6672 616d 655f 6c69   is_dataframe_li
+0002c510: 6b65 2872 6967 6874 293a 0a20 2020 2069  ke(right):.    i
+0002c520: 6620 6973 696e 7374 616e 6365 286c 6566  f isinstance(lef
+0002c530: 742c 2070 642e 4461 7461 4672 616d 6529  t, pd.DataFrame)
+0002c540: 2061 6e64 2069 7369 6e73 7461 6e63 6528   and isinstance(
+0002c550: 7269 6768 742c 2070 642e 4461 7461 4672  right, pd.DataFr
+0002c560: 616d 6529 3a0a 2020 2020 2020 2020 7265  ame):.        re
+0002c570: 7475 726e 2070 642e 6d65 7267 655f 6173  turn pd.merge_as
+0002c580: 6f66 286c 6566 742c 2072 6967 6874 2c20  of(left, right, 
+0002c590: 2a2a 6b77 6172 6773 290a 0a20 2020 2069  **kwargs)..    i
+0002c5a0: 6620 6f6e 2069 7320 6e6f 7420 4e6f 6e65  f on is not None
+0002c5b0: 3a0a 2020 2020 2020 2020 6966 206c 6566  :.        if lef
+0002c5c0: 745f 6f6e 2069 7320 6e6f 7420 4e6f 6e65  t_on is not None
+0002c5d0: 206f 7220 7269 6768 745f 6f6e 2069 7320   or right_on is 
+0002c5e0: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+0002c5f0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+0002c600: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
+0002c610: 2020 2020 2020 2020 2243 616e 206f 6e6c          "Can onl
+0002c620: 7920 7061 7373 2061 7267 756d 656e 7420  y pass argument 
+0002c630: 276f 6e27 204f 5220 276c 6566 745f 6f6e  'on' OR 'left_on
+0002c640: 2720 616e 6420 2772 6967 6874 5f6f 6e27  ' and 'right_on'
+0002c650: 2c20 6e6f 7420 6120 220a 2020 2020 2020  , not a ".      
+0002c660: 2020 2020 2020 2020 2020 2263 6f6d 6269            "combi
+0002c670: 6e61 7469 6f6e 206f 6620 626f 7468 2e22  nation of both."
+0002c680: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+0002c690: 2020 2020 2020 206c 6566 745f 6f6e 203d         left_on =
+0002c6a0: 2072 6967 6874 5f6f 6e20 3d20 6f6e 0a20   right_on = on. 
+0002c6b0: 2020 2020 2020 206b 7761 7267 735b 226c         kwargs["l
+0002c6c0: 6566 745f 6f6e 225d 203d 206c 6566 745f  eft_on"] = left_
+0002c6d0: 6f6e 0a20 2020 2020 2020 206b 7761 7267  on.        kwarg
+0002c6e0: 735b 2272 6967 6874 5f6f 6e22 5d20 3d20  s["right_on"] = 
+0002c6f0: 7269 6768 745f 6f6e 0a20 2020 2064 656c  right_on.    del
+0002c700: 206b 7761 7267 735b 226f 6e22 5d0a 0a20   kwargs["on"].. 
+0002c710: 2020 2066 6f72 206f 2069 6e20 5b6c 6566     for o in [lef
+0002c720: 745f 6f6e 2c20 7269 6768 745f 6f6e 5d3a  t_on, right_on]:
+0002c730: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
+0002c740: 7374 616e 6365 286f 2c20 5f46 7261 6d65  stance(o, _Frame
+0002c750: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
+0002c760: 6169 7365 204e 6f74 496d 706c 656d 656e  aise NotImplemen
+0002c770: 7465 6445 7272 6f72 280a 2020 2020 2020  tedError(.      
+0002c780: 2020 2020 2020 2020 2020 2244 6173 6b20            "Dask 
+0002c790: 636f 6c6c 6563 7469 6f6e 7320 6e6f 7420  collections not 
+0002c7a0: 6375 7272 656e 746c 7920 616c 6c6f 7765  currently allowe
+0002c7b0: 6420 696e 206d 6572 6765 2063 6f6c 756d  d in merge colum
+0002c7c0: 6e73 220a 2020 2020 2020 2020 2020 2020  ns".            
+0002c7d0: 290a 0a20 2020 2069 6620 6e6f 7420 6973  )..    if not is
+0002c7e0: 5f64 6173 6b5f 636f 6c6c 6563 7469 6f6e  _dask_collection
+0002c7f0: 286c 6566 7429 3a0a 2020 2020 2020 2020  (left):.        
+0002c800: 6c65 6674 203d 2066 726f 6d5f 7061 6e64  left = from_pand
+0002c810: 6173 286c 6566 742c 206e 7061 7274 6974  as(left, npartit
+0002c820: 696f 6e73 3d31 290a 0a20 2020 2069 6620  ions=1)..    if 
+0002c830: 6e6f 7420 6973 5f64 6173 6b5f 636f 6c6c  not is_dask_coll
+0002c840: 6563 7469 6f6e 2872 6967 6874 293a 0a20  ection(right):. 
+0002c850: 2020 2020 2020 2072 6967 6874 203d 2066         right = f
+0002c860: 726f 6d5f 7061 6e64 6173 2872 6967 6874  rom_pandas(right
+0002c870: 2c20 6e70 6172 7469 7469 6f6e 733d 3129  , npartitions=1)
+0002c880: 0a0a 2020 2020 6966 2062 7920 6973 206e  ..    if by is n
+0002c890: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
+0002c8a0: 2069 6620 6c65 6674 5f62 7920 6973 206e   if left_by is n
+0002c8b0: 6f74 204e 6f6e 6520 6f72 2072 6967 6874  ot None or right
+0002c8c0: 5f62 7920 6973 206e 6f74 204e 6f6e 653a  _by is not None:
+0002c8d0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+0002c8e0: 7365 2056 616c 7565 4572 726f 7228 0a20  se ValueError(. 
+0002c8f0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0002c900: 4361 6e20 6f6e 6c79 2070 6173 7320 6172  Can only pass ar
+0002c910: 6775 6d65 6e74 2027 6279 2720 4f52 2027  gument 'by' OR '
+0002c920: 6c65 6674 5f62 7927 2061 6e64 2027 7269  left_by' and 'ri
+0002c930: 6768 745f 6279 272c 206e 6f74 2061 2063  ght_by', not a c
+0002c940: 6f6d 6269 6e61 7469 6f6e 206f 6620 626f  ombination of bo
+0002c950: 7468 2e22 0a20 2020 2020 2020 2020 2020  th.".           
+0002c960: 2029 0a20 2020 2020 2020 206b 7761 7267   ).        kwarg
+0002c970: 735b 226c 6566 745f 6279 225d 203d 206b  s["left_by"] = k
+0002c980: 7761 7267 735b 2272 6967 6874 5f62 7922  wargs["right_by"
+0002c990: 5d20 3d20 6279 0a20 2020 2064 656c 206b  ] = by.    del k
+0002c9a0: 7761 7267 735b 2262 7922 5d0a 0a20 2020  wargs["by"]..   
+0002c9b0: 2069 6620 6c65 6674 5f62 7920 6973 204e   if left_by is N
+0002c9c0: 6f6e 6520 616e 6420 7269 6768 745f 6279  one and right_by
+0002c9d0: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+0002c9e0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+0002c9f0: 6545 7272 6f72 2822 4d75 7374 2073 7065  eError("Must spe
+0002ca00: 6369 6679 2062 6f74 6820 6c65 6674 5f6f  cify both left_o
+0002ca10: 6e20 616e 6420 7269 6768 745f 6f6e 2069  n and right_on i
+0002ca20: 6620 6f6e 6520 6973 2073 7065 6369 6669  f one is specifi
+0002ca30: 6564 2e22 290a 2020 2020 6966 206c 6566  ed.").    if lef
+0002ca40: 745f 6279 2069 7320 6e6f 7420 4e6f 6e65  t_by is not None
+0002ca50: 2061 6e64 2072 6967 6874 5f62 7920 6973   and right_by is
+0002ca60: 204e 6f6e 653a 0a20 2020 2020 2020 2072   None:.        r
+0002ca70: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+0002ca80: 224d 7573 7420 7370 6563 6966 7920 626f  "Must specify bo
+0002ca90: 7468 206c 6566 745f 6f6e 2061 6e64 2072  th left_on and r
+0002caa0: 6967 6874 5f6f 6e20 6966 206f 6e65 2069  ight_on if one i
+0002cab0: 7320 7370 6563 6966 6965 642e 2229 0a0a  s specified.")..
+0002cac0: 2020 2020 6672 6f6d 2064 6173 6b5f 6578      from dask_ex
+0002cad0: 7072 2e5f 6d65 7267 655f 6173 6f66 2069  pr._merge_asof i
+0002cae0: 6d70 6f72 7420 4d65 7267 6541 736f 660a  mport MergeAsof.
+0002caf0: 0a20 2020 2072 6574 7572 6e20 6e65 775f  .    return new_
+0002cb00: 636f 6c6c 6563 7469 6f6e 284d 6572 6765  collection(Merge
+0002cb10: 4173 6f66 286c 6566 742c 2072 6967 6874  Asof(left, right
+0002cb20: 2c20 2a2a 6b77 6172 6773 2929 0a0a 0a64  , **kwargs))...d
+0002cb30: 6566 2066 726f 6d5f 6d61 7028 0a20 2020  ef from_map(.   
+0002cb40: 2066 756e 632c 0a20 2020 202a 6974 6572   func,.    *iter
+0002cb50: 6162 6c65 732c 0a20 2020 2061 7267 733d  ables,.    args=
+0002cb60: 4e6f 6e65 2c0a 2020 2020 6d65 7461 3d6e  None,.    meta=n
+0002cb70: 6f5f 6465 6661 756c 742c 0a20 2020 2064  o_default,.    d
+0002cb80: 6976 6973 696f 6e73 3d4e 6f6e 652c 0a20  ivisions=None,. 
+0002cb90: 2020 206c 6162 656c 3d4e 6f6e 652c 0a20     label=None,. 
+0002cba0: 2020 2065 6e66 6f72 6365 5f6d 6574 6164     enforce_metad
+0002cbb0: 6174 613d 4661 6c73 652c 0a20 2020 202a  ata=False,.    *
+0002cbc0: 2a6b 7761 7267 732c 0a29 3a0a 2020 2020  *kwargs,.):.    
+0002cbd0: 2222 2243 7265 6174 6520 6120 6461 736b  """Create a dask
+0002cbe0: 2d65 7870 7220 636f 6c6c 6563 7469 6f6e  -expr collection
+0002cbf0: 2066 726f 6d20 6120 6375 7374 6f6d 2066   from a custom f
+0002cc00: 756e 6374 696f 6e20 6d61 700a 0a20 2020  unction map..   
+0002cc10: 204e 4f54 453a 2054 6865 2075 6e64 6572   NOTE: The under
+0002cc20: 6c79 696e 6720 6060 4578 7072 6060 206f  lying ``Expr`` o
+0002cc30: 626a 6563 7420 7072 6f64 7563 6564 2062  bject produced b
+0002cc40: 7920 7468 6973 2041 5049 0a20 2020 2077  y this API.    w
+0002cc50: 696c 6c20 7375 7070 6f72 7420 636f 6c75  ill support colu
+0002cc60: 6d6e 2070 726f 6a65 6374 696f 6e20 2876  mn projection (v
+0002cc70: 6961 2060 6073 696d 706c 6966 7960 6029  ia ``simplify``)
+0002cc80: 2069 660a 2020 2020 7468 6520 6060 6675   if.    the ``fu
+0002cc90: 6e63 6060 2061 7267 756d 656e 7420 6861  nc`` argument ha
+0002cca0: 7320 2263 6f6c 756d 6e73 2220 696e 2069  s "columns" in i
+0002ccb0: 7473 2073 6967 6e61 7475 7265 2e0a 0a20  ts signature... 
+0002ccc0: 2020 2022 2222 0a20 2020 2066 726f 6d20     """.    from 
+0002ccd0: 6461 736b 2e64 6174 6166 7261 6d65 2e69  dask.dataframe.i
+0002cce0: 6f2e 7574 696c 7320 696d 706f 7274 2044  o.utils import D
+0002ccf0: 6174 6146 7261 6d65 494f 4675 6e63 7469  ataFrameIOFuncti
+0002cd00: 6f6e 0a0a 2020 2020 6672 6f6d 2064 6173  on..    from das
+0002cd10: 6b5f 6578 7072 2e69 6f20 696d 706f 7274  k_expr.io import
+0002cd20: 2046 726f 6d4d 6170 2c20 4672 6f6d 4d61   FromMap, FromMa
+0002cd30: 7050 726f 6a65 6374 6162 6c65 0a0a 2020  pProjectable..  
+0002cd40: 2020 6966 2022 746f 6b65 6e22 2069 6e20    if "token" in 
+0002cd50: 6b77 6172 6773 3a0a 2020 2020 2020 2020  kwargs:.        
+0002cd60: 2320 5468 6973 206f 7074 696f 6e20 646f  # This option do
+0002cd70: 6573 6e27 7420 7265 616c 6c79 206d 616b  esn't really mak
+0002cd80: 6520 7365 6e73 6520 696e 2064 6173 6b2d  e sense in dask-
+0002cd90: 6578 7072 0a20 2020 2020 2020 2072 6169  expr.        rai
+0002cda0: 7365 204e 6f74 496d 706c 656d 656e 7465  se NotImplemente
+0002cdb0: 6445 7272 6f72 2822 6461 736b 5f65 7870  dError("dask_exp
+0002cdc0: 7220 646f 6573 206e 6f74 2073 7570 706f  r does not suppo
+0002cdd0: 7274 2061 2074 6f6b 656e 2061 7267 756d  rt a token argum
+0002cde0: 656e 742e 2229 0a0a 2020 2020 6c65 6e67  ent.")..    leng
+0002cdf0: 7468 7320 3d20 7365 7428 290a 2020 2020  ths = set().    
+0002ce00: 6974 6572 6162 6c65 7320 3d20 6c69 7374  iterables = list
+0002ce10: 2869 7465 7261 626c 6573 290a 2020 2020  (iterables).    
+0002ce20: 666f 7220 692c 2069 7465 7261 626c 6520  for i, iterable 
+0002ce30: 696e 2065 6e75 6d65 7261 7465 2869 7465  in enumerate(ite
+0002ce40: 7261 626c 6573 293a 0a20 2020 2020 2020  rables):.       
+0002ce50: 2069 6620 6e6f 7420 6973 696e 7374 616e   if not isinstan
+0002ce60: 6365 2869 7465 7261 626c 652c 2049 7465  ce(iterable, Ite
+0002ce70: 7261 626c 6529 3a0a 2020 2020 2020 2020  rable):.        
+0002ce80: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+0002ce90: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+0002cea0: 2020 2020 2020 6622 416c 6c20 656c 656d        f"All elem
+0002ceb0: 656e 7473 206f 6620 6069 7465 7261 626c  ents of `iterabl
+0002cec0: 6573 6020 6d75 7374 2062 6520 4974 6572  es` must be Iter
+0002ced0: 6162 6c65 2c20 676f 7420 7b74 7970 6528  able, got {type(
+0002cee0: 6974 6572 6162 6c65 297d 220a 2020 2020  iterable)}".    
+0002cef0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0002cf00: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
+0002cf10: 2020 206c 656e 6774 6873 2e61 6464 286c     lengths.add(l
+0002cf20: 656e 2869 7465 7261 626c 6529 290a 2020  en(iterable)).  
+0002cf30: 2020 2020 2020 6578 6365 7074 2028 4174        except (At
+0002cf40: 7472 6962 7574 6545 7272 6f72 2c20 5479  tributeError, Ty
+0002cf50: 7065 4572 726f 7229 3a0a 2020 2020 2020  peError):.      
+0002cf60: 2020 2020 2020 6974 6572 6162 6c65 735b        iterables[
+0002cf70: 695d 203d 206c 6973 7428 6974 6572 6162  i] = list(iterab
+0002cf80: 6c65 290a 2020 2020 2020 2020 2020 2020  le).            
+0002cf90: 6c65 6e67 7468 732e 6164 6428 6c65 6e28  lengths.add(len(
+0002cfa0: 6974 6572 6162 6c65 735b 695d 2929 0a20  iterables[i])). 
+0002cfb0: 2020 2069 6620 6c65 6e28 6c65 6e67 7468     if len(length
+0002cfc0: 7329 203d 3d20 303a 0a20 2020 2020 2020  s) == 0:.       
+0002cfd0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+0002cfe0: 7228 2260 6672 6f6d 5f6d 6170 6020 7265  r("`from_map` re
+0002cff0: 7175 6972 6573 2061 7420 6c65 6173 7420  quires at least 
+0002d000: 6f6e 6520 4974 6572 6162 6c65 2069 6e70  one Iterable inp
+0002d010: 7574 2229 0a20 2020 2065 6c69 6620 6c65  ut").    elif le
+0002d020: 6e28 6c65 6e67 7468 7329 203e 2031 3a0a  n(lengths) > 1:.
+0002d030: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+0002d040: 6c75 6545 7272 6f72 2822 416c 6c20 6069  lueError("All `i
+0002d050: 7465 7261 626c 6573 6020 6d75 7374 2068  terables` must h
+0002d060: 6176 6520 7468 6520 7361 6d65 206c 656e  ave the same len
+0002d070: 6774 6822 290a 2020 2020 6966 206c 656e  gth").    if len
+0002d080: 6774 6873 203d 3d20 7b30 7d3a 0a20 2020  gths == {0}:.   
+0002d090: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+0002d0a0: 4572 726f 7228 2241 6c6c 2060 6974 6572  Error("All `iter
+0002d0b0: 6162 6c65 7360 206d 7573 7420 6861 7665  ables` must have
+0002d0c0: 2061 206e 6f6e 2d7a 6572 6f20 6c65 6e67   a non-zero leng
+0002d0d0: 7468 2229 0a0a 2020 2020 2320 4368 6563  th")..    # Chec
+0002d0e0: 6b20 6966 2060 6675 6e63 6020 7375 7070  k if `func` supp
+0002d0f0: 6f72 7473 2063 6f6c 756d 6e20 7072 6f6a  orts column proj
+0002d100: 6563 7469 6f6e 0a20 2020 2061 6c6c 6f77  ection.    allow
+0002d110: 5f70 726f 6a65 6374 696f 6e20 3d20 4661  _projection = Fa
+0002d120: 6c73 650a 2020 2020 636f 6c75 6d6e 735f  lse.    columns_
+0002d130: 6172 675f 7265 7175 6972 6564 203d 2046  arg_required = F
+0002d140: 616c 7365 0a20 2020 2069 6620 7061 7261  alse.    if para
+0002d150: 6d20 3a3d 2069 6e73 7065 6374 2e73 6967  m := inspect.sig
+0002d160: 6e61 7475 7265 2866 756e 6329 2e70 6172  nature(func).par
+0002d170: 616d 6574 6572 732e 6765 7428 2263 6f6c  ameters.get("col
+0002d180: 756d 6e73 222c 204e 6f6e 6529 3a0a 2020  umns", None):.  
+0002d190: 2020 2020 2020 616c 6c6f 775f 7072 6f6a        allow_proj
+0002d1a0: 6563 7469 6f6e 203d 2054 7275 650a 2020  ection = True.  
+0002d1b0: 2020 2020 2020 636f 6c75 6d6e 735f 6172        columns_ar
+0002d1c0: 675f 7265 7175 6972 6564 203d 2070 6172  g_required = par
+0002d1d0: 616d 2e64 6566 6175 6c74 2069 7320 7061  am.default is pa
+0002d1e0: 7261 6d2e 656d 7074 790a 2020 2020 2020  ram.empty.      
+0002d1f0: 2020 6966 206d 6574 6120 6973 206e 6f5f    if meta is no_
+0002d200: 6465 6661 756c 7420 616e 6420 636f 6c75  default and colu
+0002d210: 6d6e 735f 6172 675f 7265 7175 6972 6564  mns_arg_required
+0002d220: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+0002d230: 6973 6520 5479 7065 4572 726f 7228 0a20  ise TypeError(. 
+0002d240: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0002d250: 4172 6775 6d65 6e74 2060 6675 6e63 6020  Argument `func` 
+0002d260: 6f66 2060 6672 6f6d 5f6d 6170 6020 6861  of `from_map` ha
+0002d270: 7320 6120 7265 7175 6972 6564 2060 636f  s a required `co
+0002d280: 6c75 6d6e 7360 2022 0a20 2020 2020 2020  lumns` ".       
+0002d290: 2020 2020 2020 2020 2022 2070 6172 616d           " param
+0002d2a0: 6574 6572 2061 6e64 206e 6f74 2060 6d65  eter and not `me
+0002d2b0: 7461 6020 7072 6f76 6964 6564 2e22 0a20  ta` provided.". 
+0002d2c0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0002d2d0: 4569 7468 6572 2070 726f 7669 6465 2060  Either provide `
+0002d2e0: 6d65 7461 6020 796f 7572 7365 6c66 206f  meta` yourself o
+0002d2f0: 7220 6d61 6b65 2060 636f 6c75 6d6e 7360  r make `columns`
+0002d300: 2061 6e20 6f70 7469 6f6e 616c 2061 7267   an optional arg
+0002d310: 756d 656e 742e 220a 2020 2020 2020 2020  ument.".        
+0002d320: 2020 2020 290a 2020 2020 656c 6966 2069      ).    elif i
+0002d330: 7369 6e73 7461 6e63 6528 6675 6e63 2c20  sinstance(func, 
+0002d340: 4461 7461 4672 616d 6549 4f46 756e 6374  DataFrameIOFunct
+0002d350: 696f 6e29 3a0a 2020 2020 2020 2020 7761  ion):.        wa
+0002d360: 726e 696e 6773 2e77 6172 6e28 0a20 2020  rnings.warn(.   
+0002d370: 2020 2020 2020 2020 2022 6461 736b 5f65           "dask_e
+0002d380: 7870 7220 646f 6573 206e 6f74 2073 7570  xpr does not sup
+0002d390: 706f 7274 2074 6865 2044 6174 6146 7261  port the DataFra
+0002d3a0: 6d65 494f 4675 6e63 7469 6f6e 2022 0a20  meIOFunction ". 
+0002d3b0: 2020 2020 2020 2020 2020 2022 7072 6f74             "prot
+0002d3c0: 6f63 6f6c 2066 6f72 2063 6f6c 756d 6e20  ocol for column 
+0002d3d0: 7072 6f6a 6563 7469 6f6e 2e20 546f 2065  projection. To e
+0002d3e0: 6e61 626c 6520 636f 6c75 6d6e 2022 0a20  nable column ". 
+0002d3f0: 2020 2020 2020 2020 2020 2022 7072 6f6a             "proj
+0002d400: 6563 7469 6f6e 2c20 706c 6561 7365 2065  ection, please e
+0002d410: 6e73 7572 6520 7468 6174 2074 6865 2073  nsure that the s
+0002d420: 6967 6e61 7475 7265 206f 6620 6066 756e  ignature of `fun
+0002d430: 6360 2022 0a20 2020 2020 2020 2020 2020  c` ".           
+0002d440: 2022 696e 636c 7564 6573 2061 2060 636f   "includes a `co
+0002d450: 6c75 6d6e 733d 6020 6b65 7977 6f72 6420  lumns=` keyword 
+0002d460: 6172 6775 6d65 6e74 2069 6e73 7465 6164  argument instead
+0002d470: 2e22 0a20 2020 2020 2020 2029 0a20 2020  .".        ).   
+0002d480: 2065 6c73 653a 0a20 2020 2020 2020 2061   else:.        a
+0002d490: 6c6c 6f77 5f70 726f 6a65 6374 696f 6e20  llow_projection 
+0002d4a0: 3d20 4661 6c73 650a 0a20 2020 2061 7267  = False..    arg
+0002d4b0: 7320 3d20 5b5d 2069 6620 6172 6773 2069  s = [] if args i
+0002d4c0: 7320 4e6f 6e65 2065 6c73 6520 6172 6773  s None else args
+0002d4d0: 0a20 2020 206b 7761 7267 7320 3d20 7b7d  .    kwargs = {}
+0002d4e0: 2069 6620 6b77 6172 6773 2069 7320 4e6f   if kwargs is No
+0002d4f0: 6e65 2065 6c73 6520 6b77 6172 6773 0a20  ne else kwargs. 
+0002d500: 2020 2069 6620 616c 6c6f 775f 7072 6f6a     if allow_proj
+0002d510: 6563 7469 6f6e 3a0a 2020 2020 2020 2020  ection:.        
+0002d520: 636f 6c75 6d6e 7320 3d20 6b77 6172 6773  columns = kwargs
+0002d530: 2e70 6f70 2822 636f 6c75 6d6e 7322 2c20  .pop("columns", 
+0002d540: 4e6f 6e65 290a 2020 2020 2020 2020 7265  None).        re
+0002d550: 7375 6c74 203d 206e 6577 5f63 6f6c 6c65  sult = new_colle
+0002d560: 6374 696f 6e28 0a20 2020 2020 2020 2020  ction(.         
+0002d570: 2020 2046 726f 6d4d 6170 5072 6f6a 6563     FromMapProjec
+0002d580: 7461 626c 6528 0a20 2020 2020 2020 2020  table(.         
+0002d590: 2020 2020 2020 2066 756e 632c 0a20 2020         func,.   
+0002d5a0: 2020 2020 2020 2020 2020 2020 2069 7465               ite
+0002d5b0: 7261 626c 6573 2c0a 2020 2020 2020 2020  rables,.        
+0002d5c0: 2020 2020 2020 2020 636f 6c75 6d6e 732c          columns,
+0002d5d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002d5e0: 2061 7267 732c 0a20 2020 2020 2020 2020   args,.         
+0002d5f0: 2020 2020 2020 206b 7761 7267 732c 0a20         kwargs,. 
+0002d600: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+0002d610: 6f6c 756d 6e73 5f61 7267 5f72 6571 7569  olumns_arg_requi
+0002d620: 7265 642c 0a20 2020 2020 2020 2020 2020  red,.           
+0002d630: 2020 2020 206d 6574 612c 0a20 2020 2020       meta,.     
+0002d640: 2020 2020 2020 2020 2020 2065 6e66 6f72             enfor
+0002d650: 6365 5f6d 6574 6164 6174 612c 0a20 2020  ce_metadata,.   
+0002d660: 2020 2020 2020 2020 2020 2020 2064 6976               div
+0002d670: 6973 696f 6e73 2c0a 2020 2020 2020 2020  isions,.        
+0002d680: 2020 2020 2020 2020 6c61 6265 6c2c 0a20          label,. 
+0002d690: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0002d6a0: 2020 2020 2029 0a20 2020 2065 6c73 653a       ).    else:
+0002d6b0: 0a20 2020 2020 2020 2072 6573 756c 7420  .        result 
+0002d6c0: 3d20 6e65 775f 636f 6c6c 6563 7469 6f6e  = new_collection
+0002d6d0: 280a 2020 2020 2020 2020 2020 2020 4672  (.            Fr
+0002d6e0: 6f6d 4d61 7028 0a20 2020 2020 2020 2020  omMap(.         
+0002d6f0: 2020 2020 2020 2066 756e 632c 0a20 2020         func,.   
+0002d700: 2020 2020 2020 2020 2020 2020 2069 7465               ite
+0002d710: 7261 626c 6573 2c0a 2020 2020 2020 2020  rables,.        
+0002d720: 2020 2020 2020 2020 6172 6773 2c0a 2020          args,.  
+0002d730: 2020 2020 2020 2020 2020 2020 2020 6b77                kw
+0002d740: 6172 6773 2c0a 2020 2020 2020 2020 2020  args,.          
+0002d750: 2020 2020 2020 6d65 7461 2c0a 2020 2020        meta,.    
+0002d760: 2020 2020 2020 2020 2020 2020 656e 666f              enfo
+0002d770: 7263 655f 6d65 7461 6461 7461 2c0a 2020  rce_metadata,.  
+0002d780: 2020 2020 2020 2020 2020 2020 2020 6469                di
+0002d790: 7669 7369 6f6e 732c 0a20 2020 2020 2020  visions,.       
+0002d7a0: 2020 2020 2020 2020 206c 6162 656c 2c0a           label,.
+0002d7b0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0002d7c0: 2020 2020 2020 290a 2020 2020 6966 2070        ).    if p
+0002d7d0: 7961 7272 6f77 5f73 7472 696e 6773 5f65  yarrow_strings_e
+0002d7e0: 6e61 626c 6564 2829 3a0a 2020 2020 2020  nabled():.      
+0002d7f0: 2020 7265 7475 726e 206e 6577 5f63 6f6c    return new_col
+0002d800: 6c65 6374 696f 6e28 6578 7072 2e41 7272  lection(expr.Arr
+0002d810: 6f77 5374 7269 6e67 436f 6e76 6572 7369  owStringConversi
+0002d820: 6f6e 2872 6573 756c 7429 290a 2020 2020  on(result)).    
+0002d830: 7265 7475 726e 2072 6573 756c 740a 0a0a  return result...
+0002d840: 6465 6620 7265 7061 7274 6974 696f 6e28  def repartition(
+0002d850: 6466 2c20 6469 7669 7369 6f6e 732c 2066  df, divisions, f
+0002d860: 6f72 6365 3d46 616c 7365 293a 0a20 2020  orce=False):.   
+0002d870: 2022 2222 5265 7061 7274 6974 696f 6e20   """Repartition 
+0002d880: 6461 7461 6672 616d 6520 616c 6f6e 6720  dataframe along 
+0002d890: 6e65 7720 6469 7669 7369 6f6e 730a 0a20  new divisions.. 
+0002d8a0: 2020 2044 6173 6b2e 4461 7461 4672 616d     Dask.DataFram
+0002d8b0: 6520 6f62 6a65 6374 7320 6172 6520 7061  e objects are pa
+0002d8c0: 7274 6974 696f 6e65 6420 616c 6f6e 6720  rtitioned along 
+0002d8d0: 7468 6569 7220 696e 6465 782e 2020 4f66  their index.  Of
+0002d8e0: 7465 6e20 7768 656e 0a20 2020 206d 756c  ten when.    mul
+0002d8f0: 7469 706c 6520 6461 7461 6672 616d 6573  tiple dataframes
+0002d900: 2069 6e74 6572 6163 7420 7765 206e 6565   interact we nee
+0002d910: 6420 746f 2061 6c69 676e 2074 6865 7365  d to align these
+0002d920: 2070 6172 7469 7469 6f6e 696e 6773 2e20   partitionings. 
+0002d930: 2054 6865 0a20 2020 2060 6072 6570 6172   The.    ``repar
+0002d940: 7469 7469 6f6e 6060 2066 756e 6374 696f  tition`` functio
+0002d950: 6e20 636f 6e73 7472 7563 7473 2061 206e  n constructs a n
+0002d960: 6577 2044 6174 6146 7261 6d65 206f 626a  ew DataFrame obj
+0002d970: 6563 7420 686f 6c64 696e 6720 7468 6520  ect holding the 
+0002d980: 7361 6d65 0a20 2020 2064 6174 6120 6275  same.    data bu
+0002d990: 7420 7061 7274 6974 696f 6e65 6420 6f6e  t partitioned on
+0002d9a0: 2064 6966 6665 7265 6e74 2076 616c 7565   different value
+0002d9b0: 732e 2020 4974 2064 6f65 7320 7468 6973  s.  It does this
+0002d9c0: 2062 7920 7065 7266 6f72 6d69 6e67 2061   by performing a
+0002d9d0: 0a20 2020 2073 6571 7565 6e63 6520 6f66  .    sequence of
+0002d9e0: 2060 606c 6f63 6060 2061 6e64 2060 6063   ``loc`` and ``c
+0002d9f0: 6f6e 6361 7460 6020 6361 6c6c 7320 746f  oncat`` calls to
+0002da00: 2073 706c 6974 2061 6e64 206d 6572 6765   split and merge
+0002da10: 2074 6865 2070 7265 7669 6f75 730a 2020   the previous.  
+0002da20: 2020 6765 6e65 7261 7469 6f6e 206f 6620    generation of 
+0002da30: 7061 7274 6974 696f 6e73 2e0a 0a20 2020  partitions...   
+0002da40: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
+0002da50: 2d2d 2d2d 2d2d 2d2d 2d2d 0a0a 2020 2020  ----------..    
+0002da60: 6469 7669 7369 6f6e 7320 3a20 6c69 7374  divisions : list
+0002da70: 0a20 2020 2020 2020 204c 6973 7420 6f66  .        List of
+0002da80: 2070 6172 7469 7469 6f6e 7320 746f 2062   partitions to b
+0002da90: 6520 7573 6564 0a20 2020 2066 6f72 6365  e used.    force
+0002daa0: 203a 2062 6f6f 6c2c 2064 6566 6175 6c74   : bool, default
+0002dab0: 2046 616c 7365 0a20 2020 2020 2020 2041   False.        A
+0002dac0: 6c6c 6f77 7320 7468 6520 6578 7061 6e73  llows the expans
+0002dad0: 696f 6e20 6f66 2074 6865 2065 7869 7374  ion of the exist
+0002dae0: 696e 6720 6469 7669 7369 6f6e 732e 0a20  ing divisions.. 
+0002daf0: 2020 2020 2020 2049 6620 4661 6c73 6520         If False 
+0002db00: 7468 656e 2074 6865 206e 6577 2064 6976  then the new div
+0002db10: 6973 696f 6e73 206c 6f77 6572 2061 6e64  isions lower and
+0002db20: 2075 7070 6572 2062 6f75 6e64 7320 6d75   upper bounds mu
+0002db30: 7374 2062 650a 2020 2020 2020 2020 7468  st be.        th
+0002db40: 6520 7361 6d65 2061 7320 7468 6520 6f6c  e same as the ol
+0002db50: 6420 6469 7669 7369 6f6e 732e 0a0a 2020  d divisions...  
+0002db60: 2020 4578 616d 706c 6573 0a20 2020 202d    Examples.    -
+0002db70: 2d2d 2d2d 2d2d 2d0a 0a20 2020 203e 3e3e  -------..    >>>
+0002db80: 2064 6620 3d20 6466 2e72 6570 6172 7469   df = df.reparti
+0002db90: 7469 6f6e 285b 302c 2035 2c20 3130 2c20  tion([0, 5, 10, 
+0002dba0: 3230 5d29 2020 2320 646f 6374 6573 743a  20])  # doctest:
+0002dbb0: 202b 534b 4950 0a0a 2020 2020 416c 736f   +SKIP..    Also
+0002dbc0: 2077 6f72 6b73 206f 6e20 5061 6e64 6173   works on Pandas
+0002dbd0: 206f 626a 6563 7473 0a0a 2020 2020 3e3e   objects..    >>
+0002dbe0: 3e20 6464 6620 3d20 6464 2e72 6570 6172  > ddf = dd.repar
+0002dbf0: 7469 7469 6f6e 2864 662c 205b 302c 2035  tition(df, [0, 5
+0002dc00: 2c20 3130 2c20 3230 5d29 2020 2320 646f  , 10, 20])  # do
+0002dc10: 6374 6573 743a 202b 534b 4950 0a20 2020  ctest: +SKIP.   
+0002dc20: 2022 2222 0a20 2020 2069 6620 6973 696e   """.    if isin
+0002dc30: 7374 616e 6365 2864 662c 2046 7261 6d65  stance(df, Frame
+0002dc40: 4261 7365 293a 0a20 2020 2020 2020 2072  Base):.        r
+0002dc50: 6574 7572 6e20 6466 2e72 6570 6172 7469  eturn df.reparti
+0002dc60: 7469 6f6e 2864 6976 6973 696f 6e73 3d64  tion(divisions=d
+0002dc70: 6976 6973 696f 6e73 2c20 666f 7263 653d  ivisions, force=
+0002dc80: 666f 7263 6529 0a20 2020 2065 6c69 6620  force).    elif 
+0002dc90: 6973 5f64 6174 6166 7261 6d65 5f6c 696b  is_dataframe_lik
+0002dca0: 6528 6466 2920 6f72 2069 735f 7365 7269  e(df) or is_seri
+0002dcb0: 6573 5f6c 696b 6528 6466 293a 0a20 2020  es_like(df):.   
+0002dcc0: 2020 2020 2072 6574 7572 6e20 6e65 775f       return new_
+0002dcd0: 636f 6c6c 6563 7469 6f6e 280a 2020 2020  collection(.    
+0002dce0: 2020 2020 2020 2020 4672 6f6d 5061 6e64          FromPand
+0002dcf0: 6173 4469 7669 7369 6f6e 7328 0a20 2020  asDivisions(.   
+0002dd00: 2020 2020 2020 2020 2020 2020 205f 4261               _Ba
+0002dd10: 636b 656e 6444 6174 6128 6466 292c 0a20  ckendData(df),. 
+0002dd20: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+0002dd30: 6976 6973 696f 6e73 3d64 6976 6973 696f  ivisions=divisio
+0002dd40: 6e73 2c0a 2020 2020 2020 2020 2020 2020  ns,.            
+0002dd50: 2020 2020 7079 6172 726f 775f 7374 7269      pyarrow_stri
+0002dd60: 6e67 735f 656e 6162 6c65 643d 7079 6172  ngs_enabled=pyar
+0002dd70: 726f 775f 7374 7269 6e67 735f 656e 6162  row_strings_enab
+0002dd80: 6c65 6428 292c 0a20 2020 2020 2020 2020  led(),.         
+0002dd90: 2020 2029 0a20 2020 2020 2020 2029 0a20     ).        ). 
+0002dda0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0002ddb0: 2072 6169 7365 204e 6f74 496d 706c 656d   raise NotImplem
+0002ddc0: 656e 7465 6445 7272 6f72 2866 2272 6570  entedError(f"rep
+0002ddd0: 6172 7469 7469 6f6e 2069 7320 6e6f 7420  artition is not 
+0002dde0: 696d 706c 656d 656e 7465 6420 666f 7220  implemented for 
+0002ddf0: 7b74 7970 6528 6466 297d 2e22 290a 0a0a  {type(df)}.")...
+0002de00: 6465 6620 7069 766f 745f 7461 626c 6528  def pivot_table(
+0002de10: 6466 2c20 696e 6465 782c 2063 6f6c 756d  df, index, colum
+0002de20: 6e73 2c20 7661 6c75 6573 2c20 6167 6766  ns, values, aggf
+0002de30: 756e 633d 226d 6561 6e22 293a 0a20 2020  unc="mean"):.   
+0002de40: 2069 6620 6e6f 7420 6973 5f73 6361 6c61   if not is_scala
+0002de50: 7228 696e 6465 7829 206f 7220 696e 6465  r(index) or inde
+0002de60: 7820 6e6f 7420 696e 2064 662e 5f6d 6574  x not in df._met
+0002de70: 612e 636f 6c75 6d6e 733a 0a20 2020 2020  a.columns:.     
+0002de80: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+0002de90: 726f 7228 2227 696e 6465 7827 206d 7573  ror("'index' mus
+0002dea0: 7420 6265 2074 6865 206e 616d 6520 6f66  t be the name of
+0002deb0: 2061 6e20 6578 6973 7469 6e67 2063 6f6c   an existing col
+0002dec0: 756d 6e22 290a 2020 2020 6966 206e 6f74  umn").    if not
+0002ded0: 2069 735f 7363 616c 6172 2863 6f6c 756d   is_scalar(colum
+0002dee0: 6e73 2920 6f72 2063 6f6c 756d 6e73 206e  ns) or columns n
+0002def0: 6f74 2069 6e20 6466 2e5f 6d65 7461 2e63  ot in df._meta.c
+0002df00: 6f6c 756d 6e73 3a0a 2020 2020 2020 2020  olumns:.        
+0002df10: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+0002df20: 2822 2763 6f6c 756d 6e73 2720 6d75 7374  ("'columns' must
+0002df30: 2062 6520 7468 6520 6e61 6d65 206f 6620   be the name of 
+0002df40: 616e 2065 7869 7374 696e 6720 636f 6c75  an existing colu
+0002df50: 6d6e 2229 0a20 2020 2069 6620 6e6f 7420  mn").    if not 
+0002df60: 6d65 7468 6f64 732e 6973 5f63 6174 6567  methods.is_categ
+0002df70: 6f72 6963 616c 5f64 7479 7065 2864 662e  orical_dtype(df.
+0002df80: 5f6d 6574 615b 636f 6c75 6d6e 735d 293a  _meta[columns]):
+0002df90: 0a20 2020 2020 2020 2072 6169 7365 2056  .        raise V
+0002dfa0: 616c 7565 4572 726f 7228 2227 636f 6c75  alueError("'colu
+0002dfb0: 6d6e 7327 206d 7573 7420 6265 2063 6174  mns' must be cat
+0002dfc0: 6567 6f72 7920 6474 7970 6522 290a 2020  egory dtype").  
+0002dfd0: 2020 6966 206e 6f74 2068 6173 5f6b 6e6f    if not has_kno
+0002dfe0: 776e 5f63 6174 6567 6f72 6965 7328 6466  wn_categories(df
+0002dff0: 2e5f 6d65 7461 5b63 6f6c 756d 6e73 5d29  ._meta[columns])
+0002e000: 3a0a 2020 2020 2020 2020 7261 6973 6520  :.        raise 
+0002e010: 5661 6c75 6545 7272 6f72 2822 2763 6f6c  ValueError("'col
+0002e020: 756d 6e73 2720 6d75 7374 2068 6176 6520  umns' must have 
+0002e030: 6b6e 6f77 6e20 6361 7465 676f 7269 6573  known categories
+0002e040: 2229 0a0a 2020 2020 6966 206e 6f74 2028  ")..    if not (
+0002e050: 0a20 2020 2020 2020 2069 735f 7363 616c  .        is_scal
+0002e060: 6172 2876 616c 7565 7329 0a20 2020 2020  ar(values).     
+0002e070: 2020 2061 6e64 2076 616c 7565 7320 696e     and values in
+0002e080: 2064 662e 5f6d 6574 612e 636f 6c75 6d6e   df._meta.column
+0002e090: 730a 2020 2020 2020 2020 6f72 206e 6f74  s.        or not
+0002e0a0: 2069 735f 7363 616c 6172 2876 616c 7565   is_scalar(value
+0002e0b0: 7329 0a20 2020 2020 2020 2061 6e64 2061  s).        and a
+0002e0c0: 6c6c 2869 735f 7363 616c 6172 2878 2920  ll(is_scalar(x) 
+0002e0d0: 616e 6420 7820 696e 2064 662e 5f6d 6574  and x in df._met
+0002e0e0: 612e 636f 6c75 6d6e 7320 666f 7220 7820  a.columns for x 
+0002e0f0: 696e 2076 616c 7565 7329 0a20 2020 2029  in values).    )
+0002e100: 3a0a 2020 2020 2020 2020 7261 6973 6520  :.        raise 
+0002e110: 5661 6c75 6545 7272 6f72 2822 2776 616c  ValueError("'val
+0002e120: 7565 7327 206d 7573 7420 7265 6665 7220  ues' must refer 
+0002e130: 746f 2061 6e20 6578 6973 7469 6e67 2063  to an existing c
+0002e140: 6f6c 756d 6e20 6f72 2063 6f6c 756d 6e73  olumn or columns
+0002e150: 2229 0a0a 2020 2020 6176 6169 6c61 626c  ")..    availabl
+0002e160: 655f 6167 6766 756e 6373 203d 205b 226d  e_aggfuncs = ["m
+0002e170: 6561 6e22 2c20 2273 756d 222c 2022 636f  ean", "sum", "co
+0002e180: 756e 7422 2c20 2266 6972 7374 222c 2022  unt", "first", "
+0002e190: 6c61 7374 225d 0a0a 2020 2020 6966 206e  last"]..    if n
+0002e1a0: 6f74 2069 735f 7363 616c 6172 2861 6767  ot is_scalar(agg
+0002e1b0: 6675 6e63 2920 6f72 2061 6767 6675 6e63  func) or aggfunc
+0002e1c0: 206e 6f74 2069 6e20 6176 6169 6c61 626c   not in availabl
+0002e1d0: 655f 6167 6766 756e 6373 3a0a 2020 2020  e_aggfuncs:.    
+0002e1e0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+0002e1f0: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+0002e200: 2020 2261 6767 6675 6e63 206d 7573 7420    "aggfunc must 
+0002e210: 6265 2065 6974 6865 7220 2220 2b20 222c  be either " + ",
+0002e220: 2022 2e6a 6f69 6e28 6622 277b 787d 2722   ".join(f"'{x}'"
+0002e230: 2066 6f72 2078 2069 6e20 6176 6169 6c61   for x in availa
+0002e240: 626c 655f 6167 6766 756e 6373 290a 2020  ble_aggfuncs).  
+0002e250: 2020 2020 2020 290a 0a20 2020 2072 6574        )..    ret
+0002e260: 7572 6e20 6e65 775f 636f 6c6c 6563 7469  urn new_collecti
+0002e270: 6f6e 280a 2020 2020 2020 2020 5069 766f  on(.        Pivo
+0002e280: 7454 6162 6c65 2864 662c 2069 6e64 6578  tTable(df, index
+0002e290: 3d69 6e64 6578 2c20 636f 6c75 6d6e 733d  =index, columns=
+0002e2a0: 636f 6c75 6d6e 732c 2076 616c 7565 733d  columns, values=
+0002e2b0: 7661 6c75 6573 2c20 6167 6766 756e 633d  values, aggfunc=
+0002e2c0: 6167 6766 756e 6329 0a20 2020 2029 0a0a  aggfunc).    )..
+0002e2d0: 0a64 6566 2074 6f5f 6e75 6d65 7269 6328  .def to_numeric(
+0002e2e0: 6172 672c 2065 7272 6f72 733d 2272 6169  arg, errors="rai
+0002e2f0: 7365 222c 2064 6f77 6e63 6173 743d 4e6f  se", downcast=No
+0002e300: 6e65 2c20 6d65 7461 3d4e 6f6e 6529 3a0a  ne, meta=None):.
+0002e310: 2020 2020 2222 220a 2020 2020 5265 7475      """.    Retu
+0002e320: 726e 2074 7970 6520 6465 7065 6e64 7320  rn type depends 
+0002e330: 6f6e 2069 6e70 7574 2e20 4465 6c61 7965  on input. Delaye
+0002e340: 6420 6966 2073 6361 6c61 722c 206f 7468  d if scalar, oth
+0002e350: 6572 7769 7365 2073 616d 6520 6173 2069  erwise same as i
+0002e360: 6e70 7574 2e0a 2020 2020 466f 7220 6572  nput..    For er
+0002e370: 726f 7273 2c20 6f6e 6c79 2022 7261 6973  rors, only "rais
+0002e380: 6522 2061 6e64 2022 636f 6572 6365 2220  e" and "coerce" 
+0002e390: 6172 6520 616c 6c6f 7765 642e 0a20 2020  are allowed..   
+0002e3a0: 2022 2222 0a20 2020 2069 6620 6572 726f   """.    if erro
+0002e3b0: 7273 206e 6f74 2069 6e20 2822 7261 6973  rs not in ("rais
+0002e3c0: 6522 2c20 2263 6f65 7263 6522 293a 0a20  e", "coerce"):. 
+0002e3d0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+0002e3e0: 7565 4572 726f 7228 2269 6e76 616c 6964  ueError("invalid
+0002e3f0: 2065 7272 6f72 2076 616c 7565 2073 7065   error value spe
+0002e400: 6369 6669 6564 2229 0a0a 2020 2020 6966  cified")..    if
+0002e410: 2070 645f 6973 5f73 6361 6c61 7228 6172   pd_is_scalar(ar
+0002e420: 6729 3a0a 2020 2020 2020 2020 6966 206d  g):.        if m
+0002e430: 6574 6120 6973 206e 6f74 204e 6f6e 653a  eta is not None:
+0002e440: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+0002e450: 7365 204b 6579 4572 726f 7228 2260 606d  se KeyError("``m
+0002e460: 6574 6160 6020 6973 206e 6f74 2061 6c6c  eta`` is not all
+0002e470: 6f77 6564 2077 6865 6e20 696e 7075 7420  owed when input 
+0002e480: 6973 2061 2073 6361 6c61 722e 2229 0a20  is a scalar."). 
+0002e490: 2020 2020 2020 2072 6574 7572 6e20 6465         return de
+0002e4a0: 6c61 7965 6428 7064 2e74 6f5f 6e75 6d65  layed(pd.to_nume
+0002e4b0: 7269 632c 2070 7572 653d 5472 7565 2928  ric, pure=True)(
+0002e4c0: 6172 672c 2065 7272 6f72 733d 6572 726f  arg, errors=erro
+0002e4d0: 7273 2c20 646f 776e 6361 7374 3d64 6f77  rs, downcast=dow
+0002e4e0: 6e63 6173 7429 0a0a 2020 2020 6966 2069  ncast)..    if i
+0002e4f0: 735f 6172 7261 796c 696b 6528 6172 6729  s_arraylike(arg)
+0002e500: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+0002e510: 206e 6577 5f63 6f6c 6c65 6374 696f 6e28   new_collection(
+0002e520: 0a20 2020 2020 2020 2020 2020 2054 6f4e  .            ToN
+0002e530: 756d 6572 6963 280a 2020 2020 2020 2020  umeric(.        
+0002e540: 2020 2020 2020 2020 6672 6f6d 5f61 7272          from_arr
+0002e550: 6179 2861 7267 292e 6173 7479 7065 2861  ay(arg).astype(a
+0002e560: 7267 2e64 7479 7065 292c 2065 7272 6f72  rg.dtype), error
+0002e570: 733d 6572 726f 7273 2c20 646f 776e 6361  s=errors, downca
+0002e580: 7374 3d64 6f77 6e63 6173 740a 2020 2020  st=downcast.    
+0002e590: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0002e5a0: 2020 292e 746f 5f64 6173 6b5f 6172 7261    ).to_dask_arra
+0002e5b0: 7928 6d65 7461 3d6d 6574 6129 0a0a 2020  y(meta=meta)..  
+0002e5c0: 2020 6966 2069 735f 7365 7269 6573 5f6c    if is_series_l
+0002e5d0: 696b 6528 6172 6729 3a0a 2020 2020 2020  ike(arg):.      
+0002e5e0: 2020 7265 7475 726e 206e 6577 5f63 6f6c    return new_col
+0002e5f0: 6c65 6374 696f 6e28 0a20 2020 2020 2020  lection(.       
+0002e600: 2020 2020 2054 6f4e 756d 6572 6963 2866       ToNumeric(f
+0002e610: 7261 6d65 3d61 7267 2c20 6572 726f 7273  rame=arg, errors
+0002e620: 3d65 7272 6f72 732c 2064 6f77 6e63 6173  =errors, downcas
+0002e630: 743d 646f 776e 6361 7374 2c20 6d65 7461  t=downcast, meta
+0002e640: 3d6d 6574 6129 0a20 2020 2020 2020 2029  =meta).        )
+0002e650: 0a0a 2020 2020 7261 6973 6520 5479 7065  ..    raise Type
+0002e660: 4572 726f 7228 0a20 2020 2020 2020 2022  Error(.        "
+0002e670: 6172 6720 6d75 7374 2062 6520 6120 6c69  arg must be a li
+0002e680: 7374 2c20 7475 706c 652c 2064 6173 6b2e  st, tuple, dask.
+0002e690: 6172 7261 792e 4172 7261 792c 206f 7220  array.Array, or 
+0002e6a0: 6461 736b 2e64 6174 6166 7261 6d65 2e53  dask.dataframe.S
+0002e6b0: 6572 6965 7322 0a20 2020 2029 0a0a 0a64  eries".    )...d
+0002e6c0: 6566 2074 6f5f 6461 7465 7469 6d65 2861  ef to_datetime(a
+0002e6d0: 7267 2c20 6d65 7461 3d4e 6f6e 652c 202a  rg, meta=None, *
+0002e6e0: 2a6b 7761 7267 7329 3a0a 2020 2020 747a  *kwargs):.    tz
+0002e6f0: 5f6b 7761 7267 203d 207b 2274 7a22 3a20  _kwarg = {"tz": 
+0002e700: 2275 7463 227d 2069 6620 6b77 6172 6773  "utc"} if kwargs
+0002e710: 2e67 6574 2822 7574 6322 2920 656c 7365  .get("utc") else
+0002e720: 207b 7d0a 0a20 2020 2028 6172 672c 2920   {}..    (arg,) 
+0002e730: 3d20 5f6d 6179 6265 5f66 726f 6d5f 7061  = _maybe_from_pa
+0002e740: 6e64 6173 285b 6172 675d 290a 0a20 2020  ndas([arg])..   
+0002e750: 2069 6620 6d65 7461 2069 7320 4e6f 6e65   if meta is None
+0002e760: 3a0a 2020 2020 2020 2020 6966 2069 7369  :.        if isi
+0002e770: 6e73 7461 6e63 6528 6172 672c 2049 6e64  nstance(arg, Ind
+0002e780: 6578 293a 0a20 2020 2020 2020 2020 2020  ex):.           
+0002e790: 206d 6574 6120 3d20 6765 745f 6d65 7461   meta = get_meta
+0002e7a0: 5f6c 6962 7261 7279 2861 7267 292e 4461  _library(arg).Da
+0002e7b0: 7465 7469 6d65 496e 6465 7828 5b5d 2c20  tetimeIndex([], 
+0002e7c0: 2a2a 747a 5f6b 7761 7267 290a 2020 2020  **tz_kwarg).    
+0002e7d0: 2020 2020 2020 2020 6d65 7461 2e6e 616d          meta.nam
+0002e7e0: 6520 3d20 6172 672e 6e61 6d65 0a20 2020  e = arg.name.   
+0002e7f0: 2020 2020 2065 6c69 6620 6e6f 7420 2869       elif not (i
+0002e800: 735f 6461 7461 6672 616d 655f 6c69 6b65  s_dataframe_like
+0002e810: 2861 7267 2920 6f72 2069 735f 7365 7269  (arg) or is_seri
+0002e820: 6573 5f6c 696b 6528 6172 6729 293a 0a20  es_like(arg)):. 
+0002e830: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0002e840: 204e 6f74 496d 706c 656d 656e 7465 6445   NotImplementedE
+0002e850: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+0002e860: 2020 2020 2020 2264 6173 6b2e 6461 7461        "dask.data
+0002e870: 6672 616d 652e 746f 5f64 6174 6574 696d  frame.to_datetim
+0002e880: 6520 646f 6573 206e 6f74 2073 7570 706f  e does not suppo
+0002e890: 7274 2022 0a20 2020 2020 2020 2020 2020  rt ".           
+0002e8a0: 2020 2020 2022 6e6f 6e2d 696e 6465 782d       "non-index-
+0002e8b0: 6162 6c65 2061 7267 756d 656e 7473 2028  able arguments (
+0002e8c0: 6c69 6b65 2073 6361 6c61 7273 2922 0a20  like scalars)". 
+0002e8d0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0002e8e0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0002e8f0: 2020 2020 2020 206d 6574 6120 3d20 6d65         meta = me
+0002e900: 7461 5f73 6572 6965 735f 636f 6e73 7472  ta_series_constr
+0002e910: 7563 746f 7228 6172 6729 285b 7064 2e54  uctor(arg)([pd.T
+0002e920: 696d 6573 7461 6d70 2822 3230 3030 222c  imestamp("2000",
+0002e930: 202a 2a74 7a5f 6b77 6172 6729 5d29 0a20   **tz_kwarg)]). 
+0002e940: 2020 2020 2020 2020 2020 206d 6574 612e             meta.
+0002e950: 696e 6465 7820 3d20 6d65 7461 2e69 6e64  index = meta.ind
+0002e960: 6578 2e61 7374 7970 6528 6172 672e 696e  ex.astype(arg.in
+0002e970: 6465 782e 6474 7970 6529 0a20 2020 2020  dex.dtype).     
+0002e980: 2020 2020 2020 206d 6574 612e 696e 6465         meta.inde
+0002e990: 782e 6e61 6d65 203d 2061 7267 2e69 6e64  x.name = arg.ind
+0002e9a0: 6578 2e6e 616d 650a 0a20 2020 206b 7761  ex.name..    kwa
+0002e9b0: 7267 732e 706f 7028 2269 6e66 6572 5f64  rgs.pop("infer_d
+0002e9c0: 6174 6574 696d 655f 666f 726d 6174 222c  atetime_format",
+0002e9d0: 204e 6f6e 6529 0a0a 2020 2020 7265 7475   None)..    retu
+0002e9e0: 726e 206e 6577 5f63 6f6c 6c65 6374 696f  rn new_collectio
+0002e9f0: 6e28 546f 4461 7465 7469 6d65 2866 7261  n(ToDatetime(fra
+0002ea00: 6d65 3d61 7267 2c20 6b77 6172 6773 3d6b  me=arg, kwargs=k
+0002ea10: 7761 7267 732c 206d 6574 613d 6d65 7461  wargs, meta=meta
+0002ea20: 2929 0a0a 0a64 6566 2074 6f5f 7469 6d65  ))...def to_time
+0002ea30: 6465 6c74 6128 6172 672c 2075 6e69 743d  delta(arg, unit=
+0002ea40: 4e6f 6e65 2c20 6572 726f 7273 3d22 7261  None, errors="ra
+0002ea50: 6973 6522 293a 0a20 2020 2069 6620 6e6f  ise"):.    if no
+0002ea60: 7420 6973 696e 7374 616e 6365 2861 7267  t isinstance(arg
+0002ea70: 2c20 5365 7269 6573 293a 0a20 2020 2020  , Series):.     
+0002ea80: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
+0002ea90: 6f72 2822 6172 6720 6d75 7374 2062 6520  or("arg must be 
+0002eaa0: 6120 5365 7269 6573 2229 0a20 2020 2072  a Series").    r
+0002eab0: 6574 7572 6e20 6e65 775f 636f 6c6c 6563  eturn new_collec
+0002eac0: 7469 6f6e 2854 6f54 696d 6564 656c 7461  tion(ToTimedelta
+0002ead0: 2866 7261 6d65 3d61 7267 2c20 756e 6974  (frame=arg, unit
+0002eae0: 3d75 6e69 742c 2065 7272 6f72 733d 6572  =unit, errors=er
+0002eaf0: 726f 7273 2929 0a0a 0a64 6566 205f 6672  rors))...def _fr
+0002eb00: 6f6d 5f73 6361 6c61 7273 2873 6361 6c61  om_scalars(scala
+0002eb10: 7273 2c20 6d65 7461 2c20 6e61 6d65 7329  rs, meta, names)
+0002eb20: 3a0a 2020 2020 7265 7475 726e 206e 6577  :.    return new
+0002eb30: 5f63 6f6c 6c65 6374 696f 6e28 4672 6f6d  _collection(From
+0002eb40: 5363 616c 6172 7328 6d65 7461 2c20 6e61  Scalars(meta, na
+0002eb50: 6d65 732c 202a 7363 616c 6172 7329 290a  mes, *scalars)).
+0002eb60: 0a0a 4069 6e73 6572 745f 6d65 7461 5f70  ..@insert_meta_p
+0002eb70: 6172 616d 5f64 6573 6372 6970 7469 6f6e  aram_description
+0002eb80: 0a64 6566 206d 6170 5f70 6172 7469 7469  .def map_partiti
+0002eb90: 6f6e 7328 0a20 2020 2066 756e 632c 0a20  ons(.    func,. 
+0002eba0: 2020 202a 6172 6773 2c0a 2020 2020 6d65     *args,.    me
+0002ebb0: 7461 3d6e 6f5f 6465 6661 756c 742c 0a20  ta=no_default,. 
+0002ebc0: 2020 2065 6e66 6f72 6365 5f6d 6574 6164     enforce_metad
+0002ebd0: 6174 613d 5472 7565 2c0a 2020 2020 7472  ata=True,.    tr
+0002ebe0: 616e 7366 6f72 6d5f 6469 7669 7369 6f6e  ansform_division
+0002ebf0: 733d 5472 7565 2c0a 2020 2020 636c 6561  s=True,.    clea
+0002ec00: 725f 6469 7669 7369 6f6e 733d 4661 6c73  r_divisions=Fals
+0002ec10: 652c 0a20 2020 2061 6c69 676e 5f64 6174  e,.    align_dat
+0002ec20: 6166 7261 6d65 733d 4661 6c73 652c 0a20  aframes=False,. 
+0002ec30: 2020 2070 6172 656e 745f 6d65 7461 3d4e     parent_meta=N
+0002ec40: 6f6e 652c 0a20 2020 202a 2a6b 7761 7267  one,.    **kwarg
+0002ec50: 732c 0a29 3a0a 2020 2020 2222 2241 7070  s,.):.    """App
+0002ec60: 6c79 2050 7974 686f 6e20 6675 6e63 7469  ly Python functi
+0002ec70: 6f6e 206f 6e20 6561 6368 2044 6174 6146  on on each DataF
+0002ec80: 7261 6d65 2070 6172 7469 7469 6f6e 2e0a  rame partition..
+0002ec90: 0a20 2020 2050 6172 616d 6574 6572 730a  .    Parameters.
+0002eca0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
+0002ecb0: 2020 2066 756e 6320 3a20 6675 6e63 7469     func : functi
+0002ecc0: 6f6e 0a20 2020 2020 2020 2046 756e 6374  on.        Funct
+0002ecd0: 696f 6e20 6170 706c 6965 6420 746f 2065  ion applied to e
+0002ece0: 6163 6820 7061 7274 6974 696f 6e2e 0a20  ach partition.. 
+0002ecf0: 2020 2061 7267 732c 206b 7761 7267 7320     args, kwargs 
+0002ed00: 3a0a 2020 2020 2020 2020 4172 6775 6d65  :.        Argume
+0002ed10: 6e74 7320 616e 6420 6b65 7977 6f72 6473  nts and keywords
+0002ed20: 2074 6f20 7061 7373 2074 6f20 7468 6520   to pass to the 
+0002ed30: 6675 6e63 7469 6f6e 2e20 2041 7420 6c65  function.  At le
+0002ed40: 6173 7420 6f6e 6520 6f66 2074 6865 0a20  ast one of the. 
+0002ed50: 2020 2020 2020 2061 7267 7320 7368 6f75         args shou
+0002ed60: 6c64 2062 6520 6120 4461 736b 2e64 6174  ld be a Dask.dat
+0002ed70: 6166 7261 6d65 2e20 4172 6775 6d65 6e74  aframe. Argument
+0002ed80: 7320 616e 6420 6b65 7977 6f72 6473 206d  s and keywords m
+0002ed90: 6179 2063 6f6e 7461 696e 0a20 2020 2020  ay contain.     
+0002eda0: 2020 2060 6053 6361 6c61 7260 602c 2060     ``Scalar``, `
+0002edb0: 6044 656c 6179 6564 6060 206f 7220 7265  `Delayed`` or re
+0002edc0: 6775 6c61 7220 7079 7468 6f6e 206f 626a  gular python obj
+0002edd0: 6563 7473 2e20 4461 7461 4672 616d 652d  ects. DataFrame-
+0002ede0: 6c69 6b65 2061 7267 730a 2020 2020 2020  like args.      
+0002edf0: 2020 2862 6f74 6820 6461 736b 2061 6e64    (both dask and
+0002ee00: 2070 616e 6461 7329 2077 696c 6c20 6265   pandas) will be
+0002ee10: 2072 6570 6172 7469 7469 6f6e 6564 2074   repartitioned t
+0002ee20: 6f20 616c 6967 6e20 2869 6620 6e65 6365  o align (if nece
+0002ee30: 7373 6172 7929 0a20 2020 2020 2020 2062  ssary).        b
+0002ee40: 6566 6f72 6520 6170 706c 7969 6e67 2074  efore applying t
+0002ee50: 6865 2066 756e 6374 696f 6e20 2873 6565  he function (see
+0002ee60: 2060 6061 6c69 676e 5f64 6174 6166 7261   ``align_datafra
+0002ee70: 6d65 7360 6020 746f 2063 6f6e 7472 6f6c  mes`` to control
+0002ee80: 292e 0a20 2020 2065 6e66 6f72 6365 5f6d  )..    enforce_m
+0002ee90: 6574 6164 6174 6120 3a20 626f 6f6c 2c20  etadata : bool, 
+0002eea0: 6465 6661 756c 7420 5472 7565 0a20 2020  default True.   
+0002eeb0: 2020 2020 2057 6865 7468 6572 2074 6f20       Whether to 
+0002eec0: 656e 666f 7263 6520 6174 2072 756e 7469  enforce at runti
+0002eed0: 6d65 2074 6861 7420 7468 6520 7374 7275  me that the stru
+0002eee0: 6374 7572 6520 6f66 2074 6865 2044 6174  cture of the Dat
+0002eef0: 6146 7261 6d65 0a20 2020 2020 2020 2070  aFrame.        p
+0002ef00: 726f 6475 6365 6420 6279 2060 6066 756e  roduced by ``fun
+0002ef10: 6360 6020 6163 7475 616c 6c79 206d 6174  c`` actually mat
+0002ef20: 6368 6573 2074 6865 2073 7472 7563 7475  ches the structu
+0002ef30: 7265 206f 6620 6060 6d65 7461 6060 2e0a  re of ``meta``..
+0002ef40: 2020 2020 2020 2020 5468 6973 2077 696c          This wil
+0002ef50: 6c20 7265 6e61 6d65 2061 6e64 2072 656f  l rename and reo
+0002ef60: 7264 6572 2063 6f6c 756d 6e73 2066 6f72  rder columns for
+0002ef70: 2065 6163 6820 7061 7274 6974 696f 6e2c   each partition,
+0002ef80: 0a20 2020 2020 2020 2061 6e64 2077 696c  .        and wil
+0002ef90: 6c20 7261 6973 6520 616e 2065 7272 6f72  l raise an error
+0002efa0: 2069 6620 7468 6973 2064 6f65 736e 2774   if this doesn't
+0002efb0: 2077 6f72 6b2c 0a20 2020 2020 2020 2062   work,.        b
+0002efc0: 7574 2069 7420 776f 6e27 7420 7261 6973  ut it won't rais
+0002efd0: 6520 6966 2064 7479 7065 7320 646f 6e27  e if dtypes don'
+0002efe0: 7420 6d61 7463 682e 0a20 2020 2074 7261  t match..    tra
+0002eff0: 6e73 666f 726d 5f64 6976 6973 696f 6e73  nsform_divisions
+0002f000: 203a 2062 6f6f 6c2c 2064 6566 6175 6c74   : bool, default
+0002f010: 2054 7275 650a 2020 2020 2020 2020 5768   True.        Wh
+0002f020: 6574 6865 7220 746f 2061 7070 6c79 2074  ether to apply t
+0002f030: 6865 2066 756e 6374 696f 6e20 6f6e 746f  he function onto
+0002f040: 2074 6865 2064 6976 6973 696f 6e73 2061   the divisions a
+0002f050: 6e64 2061 7070 6c79 2074 686f 7365 0a20  nd apply those. 
+0002f060: 2020 2020 2020 2074 7261 6e73 666f 726d         transform
+0002f070: 6564 2064 6976 6973 696f 6e73 2074 6f20  ed divisions to 
+0002f080: 7468 6520 6f75 7470 7574 2e0a 2020 2020  the output..    
+0002f090: 616c 6967 6e5f 6461 7461 6672 616d 6573  align_dataframes
+0002f0a0: 203a 2062 6f6f 6c2c 2064 6566 6175 6c74   : bool, default
+0002f0b0: 2054 7275 650a 2020 2020 2020 2020 5768   True.        Wh
+0002f0c0: 6574 6865 7220 746f 2072 6570 6172 7469  ether to reparti
+0002f0d0: 7469 6f6e 2044 6174 6146 7261 6d65 2d20  tion DataFrame- 
+0002f0e0: 6f72 2053 6572 6965 732d 6c69 6b65 2061  or Series-like a
+0002f0f0: 7267 730a 2020 2020 2020 2020 2862 6f74  rgs.        (bot
+0002f100: 6820 6461 736b 2061 6e64 2070 616e 6461  h dask and panda
+0002f110: 7329 2073 6f20 7468 6569 7220 6469 7669  s) so their divi
+0002f120: 7369 6f6e 7320 616c 6967 6e20 6265 666f  sions align befo
+0002f130: 7265 2061 7070 6c79 696e 670a 2020 2020  re applying.    
+0002f140: 2020 2020 7468 6520 6675 6e63 7469 6f6e      the function
+0002f150: 2e20 5468 6973 2072 6571 7569 7265 7320  . This requires 
+0002f160: 616c 6c20 696e 7075 7473 2074 6f20 6861  all inputs to ha
+0002f170: 7665 206b 6e6f 776e 2064 6976 6973 696f  ve known divisio
+0002f180: 6e73 2e0a 2020 2020 2020 2020 5369 6e67  ns..        Sing
+0002f190: 6c65 2d70 6172 7469 7469 6f6e 2069 6e70  le-partition inp
+0002f1a0: 7574 7320 7769 6c6c 2062 6520 7370 6c69  uts will be spli
+0002f1b0: 7420 696e 746f 206d 756c 7469 706c 6520  t into multiple 
+0002f1c0: 7061 7274 6974 696f 6e73 2e0a 0a20 2020  partitions...   
+0002f1d0: 2020 2020 2049 6620 4661 6c73 652c 2061       If False, a
+0002f1e0: 6c6c 2069 6e70 7574 7320 6d75 7374 2068  ll inputs must h
+0002f1f0: 6176 6520 6569 7468 6572 2074 6865 2073  ave either the s
+0002f200: 616d 6520 6e75 6d62 6572 206f 6620 7061  ame number of pa
+0002f210: 7274 6974 696f 6e73 0a20 2020 2020 2020  rtitions.       
+0002f220: 206f 7220 6120 7369 6e67 6c65 2070 6172   or a single par
+0002f230: 7469 7469 6f6e 2e20 5369 6e67 6c65 2d70  tition. Single-p
+0002f240: 6172 7469 7469 6f6e 2069 6e70 7574 7320  artition inputs 
+0002f250: 7769 6c6c 2062 6520 6272 6f61 6463 6173  will be broadcas
+0002f260: 7420 746f 0a20 2020 2020 2020 2065 7665  t to.        eve
+0002f270: 7279 2070 6172 7469 7469 6f6e 206f 6620  ry partition of 
+0002f280: 6d75 6c74 692d 7061 7274 6974 696f 6e20  multi-partition 
+0002f290: 696e 7075 7473 2e0a 2020 2020 244d 4554  inputs..    $MET
+0002f2a0: 410a 2020 2020 2222 220a 2020 2020 6966  A.    """.    if
+0002f2b0: 2061 6c69 676e 5f64 6174 6166 7261 6d65   align_dataframe
+0002f2c0: 733a 0a20 2020 2020 2020 2023 2054 4f44  s:.        # TOD
+0002f2d0: 4f3a 2048 616e 646c 6520 616c 6967 6e6d  O: Handle alignm
+0002f2e0: 656e 743f 0a20 2020 2020 2020 2023 2050  ent?.        # P
+0002f2f0: 6572 6861 7073 2077 6520 6f6e 6c79 2068  erhaps we only h
+0002f300: 616e 646c 6520 7468 6520 6361 7365 2074  andle the case t
+0002f310: 6861 7420 616c 6c20 6045 7870 7260 206f  hat all `Expr` o
+0002f320: 7065 7261 6e64 730a 2020 2020 2020 2020  perands.        
+0002f330: 2320 6861 7665 2074 6865 2073 616d 6520  # have the same 
+0002f340: 6e75 6d62 6572 206f 6620 7061 7274 6974  number of partit
+0002f350: 696f 6e73 206f 7220 6361 6e20 6265 2062  ions or can be b
+0002f360: 726f 6164 6361 7374 6564 0a20 2020 2020  roadcasted.     
+0002f370: 2020 2023 2077 6974 6869 6e20 604d 6170     # within `Map
+0002f380: 5061 7274 6974 696f 6e73 602e 2049 6620  Partitions`. If 
+0002f390: 736f 2c20 7468 6520 606d 6170 5f70 6172  so, the `map_par
+0002f3a0: 7469 7469 6f6e 7360 2041 5049 0a20 2020  titions` API.   
+0002f3b0: 2020 2020 2023 2077 696c 6c20 6e65 6564       # will need
+0002f3c0: 2074 6f20 6361 6c6c 2060 5265 7061 7274   to call `Repart
+0002f3d0: 6974 696f 6e60 206f 6e20 6f70 6572 616e  ition` on operan
+0002f3e0: 6473 2074 6861 7420 6172 6520 6e6f 740a  ds that are not.
+0002f3f0: 2020 2020 2020 2020 2320 616c 6967 6e65          # aligne
+0002f400: 6420 7769 7468 2060 7365 6c66 2e65 7870  d with `self.exp
+0002f410: 7260 2e0a 2020 2020 2020 2020 7261 6973  r`..        rais
+0002f420: 6520 4e6f 7449 6d70 6c65 6d65 6e74 6564  e NotImplemented
+0002f430: 4572 726f 7228 290a 2020 2020 6e65 775f  Error().    new_
+0002f440: 6578 7072 203d 2065 7870 722e 4d61 7050  expr = expr.MapP
+0002f450: 6172 7469 7469 6f6e 7328 0a20 2020 2020  artitions(.     
+0002f460: 2020 2061 7267 735b 305d 2c0a 2020 2020     args[0],.    
+0002f470: 2020 2020 6675 6e63 2c0a 2020 2020 2020      func,.      
+0002f480: 2020 6d65 7461 2c0a 2020 2020 2020 2020    meta,.        
+0002f490: 656e 666f 7263 655f 6d65 7461 6461 7461  enforce_metadata
+0002f4a0: 2c0a 2020 2020 2020 2020 7472 616e 7366  ,.        transf
+0002f4b0: 6f72 6d5f 6469 7669 7369 6f6e 732c 0a20  orm_divisions,. 
+0002f4c0: 2020 2020 2020 2063 6c65 6172 5f64 6976         clear_div
+0002f4d0: 6973 696f 6e73 2c0a 2020 2020 2020 2020  isions,.        
+0002f4e0: 616c 6967 6e5f 6461 7461 6672 616d 6573  align_dataframes
+0002f4f0: 2c0a 2020 2020 2020 2020 7061 7265 6e74  ,.        parent
+0002f500: 5f6d 6574 612c 0a20 2020 2020 2020 206b  _meta,.        k
+0002f510: 7761 7267 732e 706f 7028 2274 6f6b 656e  wargs.pop("token
+0002f520: 222c 204e 6f6e 6529 2c0a 2020 2020 2020  ", None),.      
+0002f530: 2020 6b77 6172 6773 2c0a 2020 2020 2020    kwargs,.      
+0002f540: 2020 2a61 7267 735b 313a 5d2c 0a20 2020    *args[1:],.   
+0002f550: 2029 0a20 2020 2072 6574 7572 6e20 6e65   ).    return ne
+0002f560: 775f 636f 6c6c 6563 7469 6f6e 286e 6577  w_collection(new
+0002f570: 5f65 7870 7229 0a0a 0a64 6566 206d 6170  _expr)...def map
+0002f580: 5f6f 7665 726c 6170 280a 2020 2020 6675  _overlap(.    fu
+0002f590: 6e63 2c0a 2020 2020 6466 2c0a 2020 2020  nc,.    df,.    
+0002f5a0: 6265 666f 7265 2c0a 2020 2020 6166 7465  before,.    afte
+0002f5b0: 722c 0a20 2020 202a 6172 6773 2c0a 2020  r,.    *args,.  
+0002f5c0: 2020 6d65 7461 3d6e 6f5f 6465 6661 756c    meta=no_defaul
+0002f5d0: 742c 0a20 2020 2065 6e66 6f72 6365 5f6d  t,.    enforce_m
+0002f5e0: 6574 6164 6174 613d 5472 7565 2c0a 2020  etadata=True,.  
+0002f5f0: 2020 7472 616e 7366 6f72 6d5f 6469 7669    transform_divi
+0002f600: 7369 6f6e 733d 5472 7565 2c0a 2020 2020  sions=True,.    
+0002f610: 636c 6561 725f 6469 7669 7369 6f6e 733d  clear_divisions=
+0002f620: 4661 6c73 652c 0a20 2020 2061 6c69 676e  False,.    align
+0002f630: 5f64 6174 6166 7261 6d65 733d 4661 6c73  _dataframes=Fals
+0002f640: 652c 0a20 2020 202a 2a6b 7761 7267 732c  e,.    **kwargs,
+0002f650: 0a29 3a0a 2020 2020 6966 2069 7369 6e73  .):.    if isins
+0002f660: 7461 6e63 6528 6265 666f 7265 2c20 7374  tance(before, st
+0002f670: 7229 3a0a 2020 2020 2020 2020 6265 666f  r):.        befo
+0002f680: 7265 203d 2070 642e 746f 5f74 696d 6564  re = pd.to_timed
+0002f690: 656c 7461 2862 6566 6f72 6529 0a20 2020  elta(before).   
+0002f6a0: 2069 6620 6973 696e 7374 616e 6365 2861   if isinstance(a
+0002f6b0: 6674 6572 2c20 7374 7229 3a0a 2020 2020  fter, str):.    
+0002f6c0: 2020 2020 6166 7465 7220 3d20 7064 2e74      after = pd.t
+0002f6d0: 6f5f 7469 6d65 6465 6c74 6128 6166 7465  o_timedelta(afte
+0002f6e0: 7229 0a0a 2020 2020 6966 2069 7369 6e73  r)..    if isins
+0002f6f0: 7461 6e63 6528 6265 666f 7265 2c20 6461  tance(before, da
+0002f700: 7465 7469 6d65 2e74 696d 6564 656c 7461  tetime.timedelta
+0002f710: 2920 6f72 2069 7369 6e73 7461 6e63 6528  ) or isinstance(
+0002f720: 6166 7465 722c 2064 6174 6574 696d 652e  after, datetime.
+0002f730: 7469 6d65 6465 6c74 6129 3a0a 2020 2020  timedelta):.    
+0002f740: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+0002f750: 6528 6466 2c20 4672 616d 6542 6173 6529  e(df, FrameBase)
+0002f760: 3a0a 2020 2020 2020 2020 2020 2020 696e  :.            in
+0002f770: 6665 7272 6564 5f74 7970 6520 3d20 6466  ferred_type = df
+0002f780: 2e69 6e64 6578 2e5f 6d65 7461 5f6e 6f6e  .index._meta_non
+0002f790: 656d 7074 792e 696e 6665 7272 6564 5f74  empty.inferred_t
+0002f7a0: 7970 650a 2020 2020 2020 2020 656c 7365  ype.        else
+0002f7b0: 3a0a 2020 2020 2020 2020 2020 2020 696e  :.            in
+0002f7c0: 6665 7272 6564 5f74 7970 6520 3d20 6466  ferred_type = df
+0002f7d0: 2e69 6e64 6578 2e69 6e66 6572 7265 645f  .index.inferred_
+0002f7e0: 7479 7065 0a0a 2020 2020 2020 2020 6966  type..        if
+0002f7f0: 206e 6f74 2069 735f 6461 7465 7469 6d65   not is_datetime
+0002f800: 3634 5f61 6e79 5f64 7479 7065 2869 6e66  64_any_dtype(inf
+0002f810: 6572 7265 645f 7479 7065 293a 0a20 2020  erred_type):.   
+0002f820: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
+0002f830: 7970 6545 7272 6f72 280a 2020 2020 2020  ypeError(.      
+0002f840: 2020 2020 2020 2020 2020 224d 7573 7420            "Must 
+0002f850: 6861 7665 2061 2060 4461 7465 7469 6d65  have a `Datetime
+0002f860: 496e 6465 7860 2077 6865 6e20 7573 696e  Index` when usin
+0002f870: 6720 7374 7269 6e67 206f 6666 7365 7420  g string offset 
+0002f880: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+0002f890: 2020 2266 6f72 2060 6265 666f 7265 6020    "for `before` 
+0002f8a0: 616e 6420 6061 6674 6572 6022 0a20 2020  and `after`".   
+0002f8b0: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+0002f8c0: 656c 6966 206e 6f74 2028 0a20 2020 2020  elif not (.     
+0002f8d0: 2020 2069 7369 6e73 7461 6e63 6528 6265     isinstance(be
+0002f8e0: 666f 7265 2c20 496e 7465 6772 616c 290a  fore, Integral).
+0002f8f0: 2020 2020 2020 2020 616e 6420 6265 666f          and befo
+0002f900: 7265 203e 3d20 300a 2020 2020 2020 2020  re >= 0.        
+0002f910: 616e 6420 6973 696e 7374 616e 6365 2861  and isinstance(a
+0002f920: 6674 6572 2c20 496e 7465 6772 616c 290a  fter, Integral).
+0002f930: 2020 2020 2020 2020 616e 6420 6166 7465          and afte
+0002f940: 7220 3e3d 2030 0a20 2020 2029 3a0a 2020  r >= 0.    ):.  
+0002f950: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+0002f960: 6545 7272 6f72 2822 6265 666f 7265 2061  eError("before a
+0002f970: 6e64 2061 6674 6572 206d 7573 7420 6265  nd after must be
+0002f980: 2070 6f73 6974 6976 6520 696e 7465 6765   positive intege
+0002f990: 7273 2229 0a0a 2020 2020 6466 203d 205f  rs")..    df = _
+0002f9a0: 6d61 7962 655f 6672 6f6d 5f70 616e 6461  maybe_from_panda
+0002f9b0: 7328 5b64 665d 295b 305d 0a20 2020 2061  s([df])[0].    a
+0002f9c0: 7267 7320 3d20 5f6d 6179 6265 5f66 726f  rgs = _maybe_fro
+0002f9d0: 6d5f 7061 6e64 6173 2861 7267 7329 0a0a  m_pandas(args)..
+0002f9e0: 2020 2020 6966 2061 6c69 676e 5f64 6174      if align_dat
+0002f9f0: 6166 7261 6d65 733a 0a20 2020 2020 2020  aframes:.       
+0002fa00: 2064 6673 203d 205b 6466 5d20 2b20 6172   dfs = [df] + ar
+0002fa10: 6773 0a20 2020 2020 2020 2064 6673 203d  gs.        dfs =
+0002fa20: 205b 6466 2066 6f72 2064 6620 696e 2064   [df for df in d
+0002fa30: 6673 2069 6620 6973 696e 7374 616e 6365  fs if isinstance
+0002fa40: 2864 662c 2046 7261 6d65 4261 7365 295d  (df, FrameBase)]
+0002fa50: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
+0002fa60: 6466 7329 203e 2031 2061 6e64 206e 6f74  dfs) > 1 and not
+0002fa70: 2065 7870 722e 6172 655f 636f 5f61 6c69   expr.are_co_ali
+0002fa80: 676e 6564 282a 6466 7329 3a0a 2020 2020  gned(*dfs):.    
+0002fa90: 2020 2020 2020 2020 7265 7475 726e 206e          return n
+0002faa0: 6577 5f63 6f6c 6c65 6374 696f 6e28 0a20  ew_collection(. 
+0002fab0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0002fac0: 7870 722e 4d61 704f 7665 726c 6170 416c  xpr.MapOverlapAl
+0002fad0: 6967 6e28 0a20 2020 2020 2020 2020 2020  ign(.           
+0002fae0: 2020 2020 2020 2020 2064 662c 0a20 2020           df,.   
+0002faf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fb00: 2066 756e 632c 0a20 2020 2020 2020 2020   func,.         
+0002fb10: 2020 2020 2020 2020 2020 2062 6566 6f72             befor
+0002fb20: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+0002fb30: 2020 2020 2020 2061 6674 6572 2c0a 2020         after,.  
+0002fb40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fb50: 2020 6d65 7461 2c0a 2020 2020 2020 2020    meta,.        
+0002fb60: 2020 2020 2020 2020 2020 2020 656e 666f              enfo
+0002fb70: 7263 655f 6d65 7461 6461 7461 2c0a 2020  rce_metadata,.  
+0002fb80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fb90: 2020 7472 616e 7366 6f72 6d5f 6469 7669    transform_divi
+0002fba0: 7369 6f6e 732c 0a20 2020 2020 2020 2020  sions,.         
+0002fbb0: 2020 2020 2020 2020 2020 2063 6c65 6172             clear
+0002fbc0: 5f64 6976 6973 696f 6e73 2c0a 2020 2020  _divisions,.    
+0002fbd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fbe0: 616c 6967 6e5f 6461 7461 6672 616d 6573  align_dataframes
+0002fbf0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0002fc00: 2020 2020 2020 6b77 6172 6773 2e70 6f70        kwargs.pop
+0002fc10: 2822 746f 6b65 6e22 2c20 4e6f 6e65 292c  ("token", None),
+0002fc20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002fc30: 2020 2020 206b 7761 7267 732c 0a20 2020       kwargs,.   
+0002fc40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fc50: 202a 6172 6773 2c0a 2020 2020 2020 2020   *args,.        
+0002fc60: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0002fc70: 2020 2020 2020 290a 0a20 2020 206e 6577        )..    new
+0002fc80: 5f65 7870 7220 3d20 6578 7072 2e4d 6170  _expr = expr.Map
+0002fc90: 4f76 6572 6c61 7028 0a20 2020 2020 2020  Overlap(.       
+0002fca0: 2064 662c 0a20 2020 2020 2020 2066 756e   df,.        fun
+0002fcb0: 632c 0a20 2020 2020 2020 2062 6566 6f72  c,.        befor
+0002fcc0: 652c 0a20 2020 2020 2020 2061 6674 6572  e,.        after
+0002fcd0: 2c0a 2020 2020 2020 2020 6d65 7461 2c0a  ,.        meta,.
+0002fce0: 2020 2020 2020 2020 656e 666f 7263 655f          enforce_
+0002fcf0: 6d65 7461 6461 7461 2c0a 2020 2020 2020  metadata,.      
+0002fd00: 2020 7472 616e 7366 6f72 6d5f 6469 7669    transform_divi
+0002fd10: 7369 6f6e 732c 0a20 2020 2020 2020 2063  sions,.        c
+0002fd20: 6c65 6172 5f64 6976 6973 696f 6e73 2c0a  lear_divisions,.
+0002fd30: 2020 2020 2020 2020 616c 6967 6e5f 6461          align_da
+0002fd40: 7461 6672 616d 6573 2c0a 2020 2020 2020  taframes,.      
+0002fd50: 2020 6b77 6172 6773 2e70 6f70 2822 746f    kwargs.pop("to
+0002fd60: 6b65 6e22 2c20 4e6f 6e65 292c 0a20 2020  ken", None),.   
+0002fd70: 2020 2020 206b 7761 7267 732c 0a20 2020       kwargs,.   
+0002fd80: 2020 2020 202a 6172 6773 2c0a 2020 2020       *args,.    
+0002fd90: 290a 2020 2020 7265 7475 726e 206e 6577  ).    return new
+0002fda0: 5f63 6f6c 6c65 6374 696f 6e28 6e65 775f  _collection(new_
+0002fdb0: 6578 7072 290a 0a0a 6465 6620 6973 6e61  expr)...def isna
+0002fdc0: 2861 7267 293a 0a20 2020 2069 6620 6973  (arg):.    if is
+0002fdd0: 696e 7374 616e 6365 2861 7267 2c20 4672  instance(arg, Fr
+0002fde0: 616d 6542 6173 6529 3a0a 2020 2020 2020  ameBase):.      
+0002fdf0: 2020 7265 7475 726e 2061 7267 2e69 736e    return arg.isn
+0002fe00: 6128 290a 2020 2020 656c 7365 3a0a 2020  a().    else:.  
+0002fe10: 2020 2020 2020 7265 7475 726e 2066 726f        return fro
+0002fe20: 6d5f 7061 6e64 6173 2861 7267 292e 6973  m_pandas(arg).is
+0002fe30: 6e61 2829 0a0a 0a64 6566 2065 6c65 6d77  na()...def elemw
+0002fe40: 6973 6528 6f70 2c20 2a61 7267 732c 206d  ise(op, *args, m
+0002fe50: 6574 613d 6e6f 5f64 6566 6175 6c74 2c20  eta=no_default, 
+0002fe60: 6f75 743d 4e6f 6e65 2c20 7472 616e 7366  out=None, transf
+0002fe70: 6f72 6d5f 6469 7669 7369 6f6e 733d 5472  orm_divisions=Tr
+0002fe80: 7565 2c20 2a2a 6b77 6172 6773 293a 0a20  ue, **kwargs):. 
+0002fe90: 2020 2022 2222 456c 656d 656e 7477 6973     """Elementwis
+0002fea0: 6520 6f70 6572 6174 696f 6e20 666f 7220  e operation for 
+0002feb0: 4461 736b 2064 6174 6166 7261 6d65 730a  Dask dataframes.
+0002fec0: 0a20 2020 2050 6172 616d 6574 6572 730a  .    Parameters.
+0002fed0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
+0002fee0: 2020 206f 703a 2063 616c 6c61 626c 650a     op: callable.
+0002fef0: 2020 2020 2020 2020 4675 6e63 7469 6f6e          Function
+0002ff00: 2074 6f20 6170 706c 7920 6163 726f 7373   to apply across
+0002ff10: 2069 6e70 7574 2064 6174 6166 7261 6d65   input dataframe
+0002ff20: 730a 2020 2020 2a61 7267 733a 2044 6174  s.    *args: Dat
+0002ff30: 6146 7261 6d65 732c 2053 6572 6965 732c  aFrames, Series,
+0002ff40: 2053 6361 6c61 7273 2c20 4172 7261 7973   Scalars, Arrays
+0002ff50: 2c0a 2020 2020 2020 2020 5468 6520 6172  ,.        The ar
+0002ff60: 6775 6d65 6e74 7320 6f66 2074 6865 206f  guments of the o
+0002ff70: 7065 7261 7469 6f6e 0a20 2020 206d 6574  peration.    met
+0002ff80: 613a 2070 642e 4461 7461 4672 616d 652c  a: pd.DataFrame,
+0002ff90: 2070 642e 5365 7269 6573 2028 6f70 7469   pd.Series (opti
+0002ffa0: 6f6e 616c 290a 2020 2020 2020 2020 5661  onal).        Va
+0002ffb0: 6c69 6420 6d65 7461 6461 7461 2066 6f72  lid metadata for
+0002ffc0: 2074 6865 206f 7065 7261 7469 6f6e 2e20   the operation. 
+0002ffd0: 2057 696c 6c20 6576 616c 7561 7465 206f   Will evaluate o
+0002ffe0: 6e20 6120 736d 616c 6c20 7069 6563 6520  n a small piece 
+0002fff0: 6f66 0a20 2020 2020 2020 2064 6174 6120  of.        data 
+00030000: 6966 206e 6f74 2070 726f 7669 6465 642e  if not provided.
+00030010: 0a20 2020 2074 7261 6e73 666f 726d 5f64  .    transform_d
+00030020: 6976 6973 696f 6e73 3a20 626f 6f6c 6561  ivisions: boolea
+00030030: 6e0a 2020 2020 2020 2020 4966 2074 6865  n.        If the
+00030040: 2069 6e70 7574 2069 7320 6120 6060 6461   input is a ``da
+00030050: 736b 2e64 6174 6166 7261 6d65 2e49 6e64  sk.dataframe.Ind
+00030060: 6578 6060 2077 6520 6e6f 726d 616c 6c79  ex`` we normally
+00030070: 2077 696c 6c20 616c 736f 2061 7070 6c79   will also apply
+00030080: 0a20 2020 2020 2020 2074 6865 2066 756e  .        the fun
+00030090: 6374 696f 6e20 6f6e 746f 2074 6865 2064  ction onto the d
+000300a0: 6976 6973 696f 6e73 2061 6e64 2061 7070  ivisions and app
+000300b0: 6c79 2074 686f 7365 2074 7261 6e73 666f  ly those transfo
+000300c0: 726d 6564 2064 6976 6973 696f 6e73 0a20  rmed divisions. 
+000300d0: 2020 2020 2020 2074 6f20 7468 6520 6f75         to the ou
+000300e0: 7470 7574 2e20 2059 6f75 2063 616e 2070  tput.  You can p
+000300f0: 6173 7320 6060 7472 616e 7366 6f72 6d5f  ass ``transform_
+00030100: 6469 7669 7369 6f6e 733d 4661 6c73 6560  divisions=False`
+00030110: 6020 746f 206f 7665 7272 6964 650a 2020  ` to override.  
+00030120: 2020 2020 2020 7468 6973 2062 6568 6176        this behav
+00030130: 696f 720a 2020 2020 6f75 7420 3a20 6060  ior.    out : ``
+00030140: 6461 736b 2e61 7272 6179 6060 206f 7220  dask.array`` or 
+00030150: 6060 4e6f 6e65 6060 0a20 2020 2020 2020  ``None``.       
+00030160: 2049 6620 6f75 7420 6973 2061 2064 6173   If out is a das
+00030170: 6b2e 4461 7461 4672 616d 652c 2064 6173  k.DataFrame, das
+00030180: 6b2e 5365 7269 6573 206f 7220 6461 736b  k.Series or dask
+00030190: 2e53 6361 6c61 7220 7468 656e 0a20 2020  .Scalar then.   
+000301a0: 2020 2020 2074 6869 7320 6f76 6572 7772       this overwr
+000301b0: 6974 6573 2074 6865 2063 6f6e 7465 6e74  ites the content
+000301c0: 7320 6f66 2069 7420 7769 7468 2074 6865  s of it with the
+000301d0: 2072 6573 756c 740a 2020 2020 2a2a 6b77   result.    **kw
+000301e0: 6172 6773 3a20 7363 616c 6172 730a 0a20  args: scalars.. 
+000301f0: 2020 2045 7861 6d70 6c65 730a 2020 2020     Examples.    
+00030200: 2d2d 2d2d 2d2d 2d2d 0a20 2020 203e 3e3e  --------.    >>>
+00030210: 2065 6c65 6d77 6973 6528 6f70 6572 6174   elemwise(operat
+00030220: 6f72 2e61 6464 2c20 6466 2e78 2c20 6466  or.add, df.x, df
+00030230: 2e79 2920 2023 2064 6f63 7465 7374 3a20  .y)  # doctest: 
+00030240: 2b53 4b49 500a 2020 2020 2222 220a 0a20  +SKIP.    """.. 
+00030250: 2020 2061 7267 7320 3d20 5f6d 6179 6265     args = _maybe
+00030260: 5f66 726f 6d5f 7061 6e64 6173 2861 7267  _from_pandas(arg
+00030270: 7329 0a20 2020 2064 6673 203d 205b 6466  s).    dfs = [df
+00030280: 2066 6f72 2064 6620 696e 2061 7267 7320   for df in args 
+00030290: 6966 2069 7369 6e73 7461 6e63 6528 6466  if isinstance(df
+000302a0: 2c20 4672 616d 6542 6173 6529 5d0a 2020  , FrameBase)].  
+000302b0: 2020 6966 206c 656e 2864 6673 2920 3c3d    if len(dfs) <=
+000302c0: 2031 206f 7220 6578 7072 2e61 7265 5f63   1 or expr.are_c
+000302d0: 6f5f 616c 6967 6e65 6428 2a64 6673 293a  o_aligned(*dfs):
+000302e0: 0a20 2020 2020 2020 2072 6573 756c 7420  .        result 
+000302f0: 3d20 6e65 775f 636f 6c6c 6563 7469 6f6e  = new_collection
+00030300: 280a 2020 2020 2020 2020 2020 2020 6578  (.            ex
+00030310: 7072 2e55 4675 6e63 456c 656d 7769 7365  pr.UFuncElemwise
+00030320: 2864 6673 5b30 5d2c 206f 702c 206d 6574  (dfs[0], op, met
+00030330: 612c 2074 7261 6e73 666f 726d 5f64 6976  a, transform_div
+00030340: 6973 696f 6e73 2c20 6b77 6172 6773 2c20  isions, kwargs, 
+00030350: 2a61 7267 7329 0a20 2020 2020 2020 2029  *args).        )
+00030360: 0a20 2020 2065 6c73 653a 0a20 2020 2020  .    else:.     
+00030370: 2020 2072 6573 756c 7420 3d20 6e65 775f     result = new_
+00030380: 636f 6c6c 6563 7469 6f6e 2865 7870 722e  collection(expr.
+00030390: 5546 756e 6341 6c69 676e 2864 6673 5b30  UFuncAlign(dfs[0
+000303a0: 5d2c 206f 702c 206d 6574 612c 206b 7761  ], op, meta, kwa
+000303b0: 7267 732c 202a 6172 6773 2929 0a20 2020  rgs, *args)).   
+000303c0: 2072 6574 7572 6e20 6861 6e64 6c65 5f6f   return handle_o
+000303d0: 7574 286f 7574 2c20 7265 7375 6c74 290a  ut(out, result).
+000303e0: 0a0a 6465 6620 6861 6e64 6c65 5f6f 7574  ..def handle_out
+000303f0: 286f 7574 2c20 7265 7375 6c74 293a 0a20  (out, result):. 
+00030400: 2020 2022 2222 4861 6e64 6c65 206f 7574     """Handle out
+00030410: 2070 6172 616d 6574 6572 730a 0a20 2020   parameters..   
+00030420: 2049 6620 6f75 7420 6973 2061 2064 6173   If out is a das
+00030430: 6b2e 4461 7461 4672 616d 652c 2064 6173  k.DataFrame, das
+00030440: 6b2e 5365 7269 6573 206f 7220 6461 736b  k.Series or dask
+00030450: 2e53 6361 6c61 7220 7468 656e 0a20 2020  .Scalar then.   
+00030460: 2074 6869 7320 6f76 6572 7772 6974 6573   this overwrites
+00030470: 2074 6865 2063 6f6e 7465 6e74 7320 6f66   the contents of
+00030480: 2069 7420 7769 7468 2074 6865 2072 6573   it with the res
+00030490: 756c 742e 2054 6865 206d 6574 686f 640a  ult. The method.
+000304a0: 2020 2020 7265 706c 6163 6573 2074 6865      replaces the
+000304b0: 2065 7870 7265 7373 696f 6e20 6f66 2074   expression of t
+000304c0: 6865 206f 7574 2070 6172 616d 6574 6572  he out parameter
+000304d0: 2077 6974 6820 7468 6520 7265 7375 6c74   with the result
+000304e0: 0a20 2020 2066 726f 6d20 7468 6973 206f  .    from this o
+000304f0: 7065 7261 7469 6f6e 2074 6f20 7065 7266  peration to perf
+00030500: 6f72 6d20 736f 6d65 7468 696e 6720 616b  orm something ak
+00030510: 696e 2074 6f20 616e 2069 6e70 6c61 6365  in to an inplace
+00030520: 0a20 2020 206d 6f64 6966 6963 6174 696f  .    modificatio
+00030530: 6e2e 0a20 2020 2022 2222 0a20 2020 2069  n..    """.    i
+00030540: 6620 6973 696e 7374 616e 6365 286f 7574  f isinstance(out
+00030550: 2c20 7475 706c 6529 3a0a 2020 2020 2020  , tuple):.      
+00030560: 2020 6966 206c 656e 286f 7574 2920 3d3d    if len(out) ==
+00030570: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
+00030580: 6f75 7420 3d20 6f75 745b 305d 0a20 2020  out = out[0].   
+00030590: 2020 2020 2065 6c69 6620 6c65 6e28 6f75       elif len(ou
+000305a0: 7429 203e 2031 3a0a 2020 2020 2020 2020  t) > 1:.        
+000305b0: 2020 2020 7261 6973 6520 4e6f 7449 6d70      raise NotImp
+000305c0: 6c65 6d65 6e74 6564 4572 726f 7228 0a20  lementedError(. 
+000305d0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+000305e0: 5468 6520 606f 7574 6020 7061 7261 6d65  The `out` parame
+000305f0: 7465 7220 7769 7468 206c 656e 6774 6820  ter with length 
+00030600: 3e20 3120 6973 206e 6f74 2073 7570 706f  > 1 is not suppo
+00030610: 7274 6564 220a 2020 2020 2020 2020 2020  rted".          
+00030620: 2020 290a 2020 2020 2020 2020 656c 7365    ).        else
+00030630: 3a0a 2020 2020 2020 2020 2020 2020 6f75  :.            ou
+00030640: 7420 3d20 4e6f 6e65 0a0a 2020 2020 6966  t = None..    if
+00030650: 206f 7574 2069 7320 6e6f 7420 4e6f 6e65   out is not None
+00030660: 2061 6e64 206f 7574 2e5f 5f63 6c61 7373   and out.__class
+00030670: 5f5f 2021 3d20 7265 7375 6c74 2e5f 5f63  __ != result.__c
+00030680: 6c61 7373 5f5f 3a0a 2020 2020 2020 2020  lass__:.        
+00030690: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
+000306a0: 0a20 2020 2020 2020 2020 2020 2022 4d69  .            "Mi
+000306b0: 736d 6174 6368 6564 2074 7970 6573 2062  smatched types b
+000306c0: 6574 7765 656e 2072 6573 756c 7420 616e  etween result an
+000306d0: 6420 6f75 7420 7061 7261 6d65 7465 722e  d out parameter.
+000306e0: 2022 0a20 2020 2020 2020 2020 2020 2022   ".            "
+000306f0: 6f75 743d 2573 2c20 7265 7375 6c74 3d25  out=%s, result=%
+00030700: 7322 2025 2028 7374 7228 7479 7065 286f  s" % (str(type(o
+00030710: 7574 2929 2c20 7374 7228 7479 7065 2872  ut)), str(type(r
+00030720: 6573 756c 7429 2929 0a20 2020 2020 2020  esult))).       
+00030730: 2029 0a0a 2020 2020 6966 2069 7369 6e73   )..    if isins
+00030740: 7461 6e63 6528 6f75 742c 2044 6174 6146  tance(out, DataF
+00030750: 7261 6d65 293a 0a20 2020 2020 2020 2069  rame):.        i
+00030760: 6620 6c65 6e28 6f75 742e 636f 6c75 6d6e  f len(out.column
+00030770: 7329 2021 3d20 6c65 6e28 7265 7375 6c74  s) != len(result
+00030780: 2e63 6f6c 756d 6e73 293a 0a20 2020 2020  .columns):.     
+00030790: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+000307a0: 7565 4572 726f 7228 0a20 2020 2020 2020  ueError(.       
+000307b0: 2020 2020 2020 2020 2022 4d69 736d 6174           "Mismat
+000307c0: 6368 6564 2063 6f6c 756d 6e73 2063 6f75  ched columns cou
+000307d0: 6e74 2062 6574 7765 656e 2072 6573 756c  nt between resul
+000307e0: 7420 616e 6420 6f75 7420 7061 7261 6d65  t and out parame
+000307f0: 7465 722e 2022 0a20 2020 2020 2020 2020  ter. ".         
+00030800: 2020 2020 2020 2022 6f75 743d 2573 2c20         "out=%s, 
+00030810: 7265 7375 6c74 3d25 7322 2025 2028 7374  result=%s" % (st
+00030820: 7228 6c65 6e28 6f75 742e 636f 6c75 6d6e  r(len(out.column
+00030830: 7329 292c 2073 7472 286c 656e 2872 6573  s)), str(len(res
+00030840: 756c 742e 636f 6c75 6d6e 7329 2929 0a20  ult.columns))). 
+00030850: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
+00030860: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+00030870: 6f75 742c 2028 5365 7269 6573 2c20 4461  out, (Series, Da
+00030880: 7461 4672 616d 652c 2053 6361 6c61 7229  taFrame, Scalar)
+00030890: 293a 0a20 2020 2020 2020 206f 7574 2e5f  ):.        out._
+000308a0: 6578 7072 203d 2072 6573 756c 742e 5f65  expr = result._e
+000308b0: 7870 720a 2020 2020 656c 6966 206f 7574  xpr.    elif out
+000308c0: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+000308d0: 2020 2020 2020 6d73 6720 3d20 280a 2020        msg = (.  
+000308e0: 2020 2020 2020 2020 2020 2254 6865 206f            "The o
+000308f0: 7574 2070 6172 616d 6574 6572 2069 7320  ut parameter is 
+00030900: 6e6f 7420 6675 6c6c 7920 7375 7070 6f72  not fully suppor
+00030910: 7465 642e 220a 2020 2020 2020 2020 2020  ted.".          
+00030920: 2020 2220 5265 6365 6976 6564 2074 7970    " Received typ
+00030930: 6520 2573 2c20 6578 7065 6374 6564 2025  e %s, expected %
+00030940: 7320 220a 2020 2020 2020 2020 2020 2020  s ".            
+00030950: 2520 280a 2020 2020 2020 2020 2020 2020  % (.            
+00030960: 2020 2020 7479 7065 6e61 6d65 2874 7970      typename(typ
+00030970: 6528 6f75 7429 292c 0a20 2020 2020 2020  e(out)),.       
+00030980: 2020 2020 2020 2020 2074 7970 656e 616d           typenam
+00030990: 6528 7479 7065 2872 6573 756c 7429 292c  e(type(result)),
+000309a0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+000309b0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+000309c0: 2072 6169 7365 204e 6f74 496d 706c 656d   raise NotImplem
+000309d0: 656e 7465 6445 7272 6f72 286d 7367 290a  entedError(msg).
+000309e0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+000309f0: 2020 7265 7475 726e 2072 6573 756c 740a    return result.
+00030a00: 0a0a 6465 6620 5f63 6f6d 7075 7465 5f70  ..def _compute_p
+00030a10: 6172 7469 7469 6f6e 5f73 7461 7473 280a  artition_stats(.
+00030a20: 2020 2020 636f 6c75 6d6e 3a20 5365 7269      column: Seri
+00030a30: 6573 2c20 616c 6c6f 775f 6f76 6572 6c61  es, allow_overla
+00030a40: 703a 2062 6f6f 6c20 3d20 4661 6c73 650a  p: bool = False.
+00030a50: 2920 2d3e 2074 7570 6c65 5b6c 6973 742c  ) -> tuple[list,
+00030a60: 206c 6973 742c 206c 6973 745b 696e 745d   list, list[int]
+00030a70: 5d3a 0a20 2020 2022 2222 466f 7220 6120  ]:.    """For a 
+00030a80: 6769 7665 6e20 636f 6c75 6d6e 2c20 636f  given column, co
+00030a90: 6d70 7574 6520 7468 6520 6d69 6e2c 206d  mpute the min, m
+00030aa0: 6178 2c20 616e 6420 6c65 6e20 6f66 2065  ax, and len of e
+00030ab0: 6163 6820 7061 7274 6974 696f 6e2e 0a0a  ach partition...
+00030ac0: 2020 2020 416e 6420 6d61 6b65 2073 7572      And make sur
+00030ad0: 6520 7468 6174 2074 6865 2070 6172 7469  e that the parti
+00030ae0: 7469 6f6e 7320 6172 6520 736f 7274 6564  tions are sorted
+00030af0: 2072 656c 6174 6976 6520 746f 2065 6163   relative to eac
+00030b00: 6820 6f74 6865 722e 0a20 2020 204e 4f54  h other..    NOT
+00030b10: 453a 2074 6869 7320 646f 6573 206e 6f74  E: this does not
+00030b20: 2067 7561 7261 6e74 6565 2074 6861 7420   guarantee that 
+00030b30: 6576 6572 7920 7061 7274 6974 696f 6e20  every partition 
+00030b40: 6973 2069 6e74 6572 6e61 6c6c 7920 736f  is internally so
+00030b50: 7274 6564 2e0a 2020 2020 2222 220a 2020  rted..    """.  
+00030b60: 2020 6d69 6e73 203d 2063 6f6c 756d 6e2e    mins = column.
+00030b70: 6d61 705f 7061 7274 6974 696f 6e73 284d  map_partitions(M
+00030b80: 2e6d 696e 2c20 6d65 7461 3d63 6f6c 756d  .min, meta=colum
+00030b90: 6e29 0a20 2020 206d 6178 6573 203d 2063  n).    maxes = c
+00030ba0: 6f6c 756d 6e2e 6d61 705f 7061 7274 6974  olumn.map_partit
+00030bb0: 696f 6e73 284d 2e6d 6178 2c20 6d65 7461  ions(M.max, meta
+00030bc0: 3d63 6f6c 756d 6e29 0a20 2020 206c 656e  =column).    len
+00030bd0: 7320 3d20 636f 6c75 6d6e 2e6d 6170 5f70  s = column.map_p
+00030be0: 6172 7469 7469 6f6e 7328 6c65 6e2c 206d  artitions(len, m
+00030bf0: 6574 613d 636f 6c75 6d6e 290a 2020 2020  eta=column).    
+00030c00: 6d69 6e73 2c20 6d61 7865 732c 206c 656e  mins, maxes, len
+00030c10: 7320 3d20 636f 6d70 7574 6528 6d69 6e73  s = compute(mins
+00030c20: 2c20 6d61 7865 732c 206c 656e 7329 0a20  , maxes, lens). 
+00030c30: 2020 206d 696e 7320 3d20 6d69 6e73 2e62     mins = mins.b
+00030c40: 6669 6c6c 2829 2e74 6f6c 6973 7428 290a  fill().tolist().
+00030c50: 2020 2020 6d61 7865 7320 3d20 6d61 7865      maxes = maxe
+00030c60: 732e 6266 696c 6c28 292e 746f 6c69 7374  s.bfill().tolist
+00030c70: 2829 0a20 2020 206e 6f6e 5f65 6d70 7479  ().    non_empty
+00030c80: 5f6d 696e 7320 3d20 5b6d 2066 6f72 206d  _mins = [m for m
+00030c90: 2c20 6c65 6e67 7468 2069 6e20 7a69 7028  , length in zip(
+00030ca0: 6d69 6e73 2c20 6c65 6e73 2920 6966 206c  mins, lens) if l
+00030cb0: 656e 6774 6820 213d 2030 5d0a 2020 2020  ength != 0].    
+00030cc0: 6e6f 6e5f 656d 7074 795f 6d61 7865 7320  non_empty_maxes 
+00030cd0: 3d20 5b6d 2066 6f72 206d 2c20 6c65 6e67  = [m for m, leng
+00030ce0: 7468 2069 6e20 7a69 7028 6d61 7865 732c  th in zip(maxes,
+00030cf0: 206c 656e 7329 2069 6620 6c65 6e67 7468   lens) if length
+00030d00: 2021 3d20 305d 0a20 2020 2069 6620 280a   != 0].    if (.
+00030d10: 2020 2020 2020 2020 736f 7274 6564 286e          sorted(n
+00030d20: 6f6e 5f65 6d70 7479 5f6d 696e 7329 2021  on_empty_mins) !
+00030d30: 3d20 6e6f 6e5f 656d 7074 795f 6d69 6e73  = non_empty_mins
+00030d40: 0a20 2020 2020 2020 206f 7220 736f 7274  .        or sort
+00030d50: 6564 286e 6f6e 5f65 6d70 7479 5f6d 6178  ed(non_empty_max
+00030d60: 6573 2920 213d 206e 6f6e 5f65 6d70 7479  es) != non_empty
+00030d70: 5f6d 6178 6573 0a20 2020 2029 3a0a 2020  _maxes.    ):.  
+00030d80: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+00030d90: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
+00030da0: 2020 2020 6622 5061 7274 6974 696f 6e73      f"Partitions
+00030db0: 2061 7265 206e 6f74 2073 6f72 7465 6420   are not sorted 
+00030dc0: 6173 6365 6e64 696e 6720 6279 207b 636f  ascending by {co
+00030dd0: 6c75 6d6e 2e6e 616d 6520 6f72 2027 7468  lumn.name or 'th
+00030de0: 6520 696e 6465 7827 7d2e 2022 2c0a 2020  e index'}. ",.  
+00030df0: 2020 2020 2020 2020 2020 6622 496e 2079            f"In y
+00030e00: 6f75 7220 6461 7461 7365 7420 7468 6520  our dataset the 
+00030e10: 286d 696e 2c20 6d61 782c 206c 656e 2920  (min, max, len) 
+00030e20: 7661 6c75 6573 206f 6620 7b63 6f6c 756d  values of {colum
+00030e30: 6e2e 6e61 6d65 206f 7220 2774 6865 2069  n.name or 'the i
+00030e40: 6e64 6578 277d 2022 0a20 2020 2020 2020  ndex'} ".       
+00030e50: 2020 2020 2066 2266 6f72 2065 6163 6820       f"for each 
+00030e60: 7061 7274 6974 696f 6e20 6172 653a 207b  partition are: {
+00030e70: 6c69 7374 287a 6970 286d 696e 732c 206d  list(zip(mins, m
+00030e80: 6178 6573 2c20 6c65 6e73 2929 7d22 2c0a  axes, lens))}",.
+00030e90: 2020 2020 2020 2020 290a 2020 2020 6966          ).    if
+00030ea0: 206e 6f74 2061 6c6c 6f77 5f6f 7665 726c   not allow_overl
+00030eb0: 6170 2061 6e64 2061 6e79 280a 2020 2020  ap and any(.    
+00030ec0: 2020 2020 6120 3c3d 2062 2066 6f72 2061      a <= b for a
+00030ed0: 2c20 6220 696e 207a 6970 286e 6f6e 5f65  , b in zip(non_e
+00030ee0: 6d70 7479 5f6d 696e 735b 313a 5d2c 206e  mpty_mins[1:], n
+00030ef0: 6f6e 5f65 6d70 7479 5f6d 6178 6573 5b3a  on_empty_maxes[:
+00030f00: 2d31 5d29 0a20 2020 2029 3a0a 2020 2020  -1]).    ):.    
+00030f10: 2020 2020 7761 726e 696e 6773 2e77 6172      warnings.war
+00030f20: 6e28 0a20 2020 2020 2020 2020 2020 2022  n(.            "
+00030f30: 5061 7274 6974 696f 6e73 2068 6176 6520  Partitions have 
+00030f40: 6f76 6572 6c61 7070 696e 6720 7661 6c75  overlapping valu
+00030f50: 6573 2c20 736f 2064 6976 6973 696f 6e73  es, so divisions
+00030f60: 2061 7265 206e 6f6e 2d75 6e69 7175 652e   are non-unique.
+00030f70: 2022 0a20 2020 2020 2020 2020 2020 2022   ".            "
+00030f80: 5573 6520 6073 6574 5f69 6e64 6578 2873  Use `set_index(s
+00030f90: 6f72 7465 643d 5472 7565 2960 2077 6974  orted=True)` wit
+00030fa0: 6820 6e6f 2060 6469 7669 7369 6f6e 7360  h no `divisions`
+00030fb0: 2074 6f20 616c 6c6f 7720 6461 736b 2074   to allow dask t
+00030fc0: 6f20 6669 7820 7468 6520 6f76 6572 6c61  o fix the overla
+00030fd0: 702e 2022 0a20 2020 2020 2020 2020 2020  p. ".           
+00030fe0: 2066 2249 6e20 796f 7572 2064 6174 6173   f"In your datas
+00030ff0: 6574 2074 6865 2028 6d69 6e2c 206d 6178  et the (min, max
+00031000: 2c20 6c65 6e29 2076 616c 7565 7320 6f66  , len) values of
+00031010: 207b 636f 6c75 6d6e 2e6e 616d 6520 6f72   {column.name or
+00031020: 2027 7468 6520 696e 6465 7827 7d20 220a   'the index'} ".
+00031030: 2020 2020 2020 2020 2020 2020 6622 666f              f"fo
+00031040: 7220 6561 6368 2070 6172 7469 7469 6f6e  r each partition
+00031050: 2061 7265 203a 207b 6c69 7374 287a 6970   are : {list(zip
+00031060: 286d 696e 732c 206d 6178 6573 2c20 6c65  (mins, maxes, le
+00031070: 6e73 2929 7d22 2c0a 2020 2020 2020 2020  ns))}",.        
+00031080: 2020 2020 5573 6572 5761 726e 696e 672c      UserWarning,
+00031090: 0a20 2020 2020 2020 2029 0a20 2020 206c  .        ).    l
+000310a0: 656e 7320 3d20 6d65 7468 6f64 732e 746f  ens = methods.to
+000310b0: 6c69 7374 286c 656e 7329 0a20 2020 2069  list(lens).    i
+000310c0: 6620 6e6f 7420 616c 6c6f 775f 6f76 6572  f not allow_over
+000310d0: 6c61 703a 0a20 2020 2020 2020 2072 6574  lap:.        ret
+000310e0: 7572 6e20 286d 696e 732c 206d 6178 6573  urn (mins, maxes
+000310f0: 2c20 6c65 6e73 290a 2020 2020 656c 7365  , lens).    else
+00031100: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+00031110: 2028 6e6f 6e5f 656d 7074 795f 6d69 6e73   (non_empty_mins
+00031120: 2c20 6e6f 6e5f 656d 7074 795f 6d61 7865  , non_empty_maxe
+00031130: 732c 206c 656e 7329 0a                   s, lens).
```

### Comparing `dask-expr-1.0.5/dask_expr/_concat.py` & `dask-expr-1.0.6/dask_expr/_concat.py`

 * *Files identical despite different names*

### Comparing `dask-expr-1.0.5/dask_expr/_core.py` & `dask-expr-1.0.6/dask_expr/_core.py`

 * *Files 0% similar despite different names*

```diff
@@ -439,18 +439,20 @@
             expr = new
         return expr
 
     def _lower(self):
         return
 
     @functools.cached_property
+    def _funcname(self):
+        return funcname(type(self)).lower()
+
+    @functools.cached_property
     def _name(self):
-        return (
-            funcname(type(self)).lower() + "-" + _tokenize_deterministic(*self.operands)
-        )
+        return self._funcname + "-" + _tokenize_deterministic(*self.operands)
 
     @property
     def _meta(self):
         raise NotImplementedError()
 
     def __getattr__(self, key):
         try:
```

### Comparing `dask-expr-1.0.5/dask_expr/_cumulative.py` & `dask-expr-1.0.6/dask_expr/_cumulative.py`

 * *Files identical despite different names*

### Comparing `dask-expr-1.0.5/dask_expr/_datetime.py` & `dask-expr-1.0.6/dask_expr/_datetime.py`

 * *Files identical despite different names*

### Comparing `dask-expr-1.0.5/dask_expr/_describe.py` & `dask-expr-1.0.6/dask_expr/_describe.py`

 * *Files identical despite different names*

### Comparing `dask-expr-1.0.5/dask_expr/_dummies.py` & `dask-expr-1.0.6/dask_expr/_dummies.py`

 * *Files identical despite different names*

### Comparing `dask-expr-1.0.5/dask_expr/_expr.py` & `dask-expr-1.0.6/dask_expr/_expr.py`

 * *Files identical despite different names*

### Comparing `dask-expr-1.0.5/dask_expr/_groupby.py` & `dask-expr-1.0.6/dask_expr/_groupby.py`

 * *Files identical despite different names*

### Comparing `dask-expr-1.0.5/dask_expr/_indexing.py` & `dask-expr-1.0.6/dask_expr/_indexing.py`

 * *Files 0% similar despite different names*

```diff
@@ -12,15 +12,15 @@
     _partition_of_index_value,
     _partitions_of_index_values,
 )
 from dask.utils import is_arraylike, is_series_like
 from pandas.api.types import is_bool_dtype
 from pandas.errors import IndexingError
 
-from dask_expr._collection import Series, from_dask_dataframe, new_collection
+from dask_expr._collection import Series, from_legacy_dataframe, new_collection
 from dask_expr._expr import Blockwise, MaybeAlignPartitions, Projection, are_co_aligned
 from dask_expr._util import is_scalar
 
 
 class Indexer:
     def __init__(self, obj):
         self.obj = obj
@@ -118,16 +118,16 @@
         if cindexer is not None:
             frame = Projection(frame, cindexer)
         if check_alignment and not are_co_aligned(frame, iindexer.expr):
             return new_collection(LocAlign(frame, iindexer))
         return new_collection(Loc(frame, iindexer))
 
     def _loc_array(self, iindexer, cindexer):
-        iindexer_series = from_dask_dataframe(
-            iindexer.to_dask_dataframe("_", self.obj.index.to_dask_dataframe())
+        iindexer_series = from_legacy_dataframe(
+            iindexer.to_dask_dataframe("_", self.obj.index.to_legacy_dataframe())
         )
         return self._loc_series(iindexer_series, cindexer, check_alignment=False)
 
     def _maybe_partial_time_string(self, iindexer):
         """
         Convert index-indexer for partial time string slicing
         if obj.index is DatetimeIndex / PeriodIndex
```

### Comparing `dask-expr-1.0.5/dask_expr/_merge.py` & `dask-expr-1.0.6/dask_expr/_merge.py`

 * *Files identical despite different names*

### Comparing `dask-expr-1.0.5/dask_expr/_merge_asof.py` & `dask-expr-1.0.6/dask_expr/_merge_asof.py`

 * *Files identical despite different names*

### Comparing `dask-expr-1.0.5/dask_expr/_quantile.py` & `dask-expr-1.0.6/dask_expr/_quantile.py`

 * *Files identical despite different names*

### Comparing `dask-expr-1.0.5/dask_expr/_quantiles.py` & `dask-expr-1.0.6/dask_expr/_quantiles.py`

 * *Files identical despite different names*

### Comparing `dask-expr-1.0.5/dask_expr/_reductions.py` & `dask-expr-1.0.6/dask_expr/_reductions.py`

 * *Files identical despite different names*

### Comparing `dask-expr-1.0.5/dask_expr/_repartition.py` & `dask-expr-1.0.6/dask_expr/_repartition.py`

 * *Files identical despite different names*

### Comparing `dask-expr-1.0.5/dask_expr/_resample.py` & `dask-expr-1.0.6/dask_expr/_resample.py`

 * *Files identical despite different names*

### Comparing `dask-expr-1.0.5/dask_expr/_rolling.py` & `dask-expr-1.0.6/dask_expr/_rolling.py`

 * *Files identical despite different names*

### Comparing `dask-expr-1.0.5/dask_expr/_shuffle.py` & `dask-expr-1.0.6/dask_expr/_shuffle.py`

 * *Files identical despite different names*

### Comparing `dask-expr-1.0.5/dask_expr/_str_accessor.py` & `dask-expr-1.0.6/dask_expr/_str_accessor.py`

 * *Files identical despite different names*

### Comparing `dask-expr-1.0.5/dask_expr/_util.py` & `dask-expr-1.0.6/dask_expr/_util.py`

 * *Files identical despite different names*

### Comparing `dask-expr-1.0.5/dask_expr/datasets.py` & `dask-expr-1.0.6/dask_expr/datasets.py`

 * *Files identical despite different names*

### Comparing `dask-expr-1.0.5/dask_expr/diagnostics/_analyze.py` & `dask-expr-1.0.6/dask_expr/diagnostics/_analyze.py`

 * *Files identical despite different names*

### Comparing `dask-expr-1.0.5/dask_expr/diagnostics/_analyze_plugin.py` & `dask-expr-1.0.6/dask_expr/diagnostics/_analyze_plugin.py`

 * *Files identical despite different names*

### Comparing `dask-expr-1.0.5/dask_expr/diagnostics/_explain.py` & `dask-expr-1.0.6/dask_expr/diagnostics/_explain.py`

 * *Files identical despite different names*

### Comparing `dask-expr-1.0.5/dask_expr/io/_delayed.py` & `dask-expr-1.0.6/dask_expr/io/_delayed.py`

 * *Files identical despite different names*

### Comparing `dask-expr-1.0.5/dask_expr/io/csv.py` & `dask-expr-1.0.6/dask_expr/io/csv.py`

 * *Files 1% similar despite different names*

```diff
@@ -134,15 +134,15 @@
     header_first_partition_only=None,
     compute_kwargs=None,
     **kwargs,
 ):
     from dask.dataframe.io.csv import to_csv as _to_csv
 
     return _to_csv(
-        df.to_dask_dataframe(),
+        df.to_legacy_dataframe(),
         filename,
         single_file=single_file,
         encoding=encoding,
         mode=mode,
         name_function=name_function,
         compression=compression,
         compute=compute,
```

### Comparing `dask-expr-1.0.5/dask_expr/io/hdf.py` & `dask-expr-1.0.6/dask_expr/io/hdf.py`

 * *Files 11% similar despite different names*

```diff
@@ -1,8 +1,8 @@
-from dask_expr import from_dask_dataframe
+from dask_expr import from_legacy_dataframe
 
 
 def read_hdf(
     pattern,
     key,
     start=0,
     stop=None,
@@ -21,15 +21,15 @@
         stop=stop,
         columns=columns,
         chunksize=chunksize,
         sorted_index=sorted_index,
         lock=lock,
         mode=mode,
     )
-    return from_dask_dataframe(df)
+    return from_legacy_dataframe(df)
 
 
 def to_hdf(
     df,
     path,
     key,
     mode="a",
@@ -40,15 +40,15 @@
     lock=None,
     dask_kwargs=None,
     **kwargs,
 ):
     from dask.dataframe.io import to_hdf as _to_hdf
 
     return _to_hdf(
-        df.to_dask_dataframe(),
+        df.to_legacy_dataframe(),
         path,
         key,
         mode=mode,
         append=append,
         scheduler=scheduler,
         name_function=name_function,
         compute=compute,
```

### Comparing `dask-expr-1.0.5/dask_expr/io/io.py` & `dask-expr-1.0.6/dask_expr/io/io.py`

 * *Files identical despite different names*

```diff
@@ -99,15 +99,15 @@
 
 class FusedIO(BlockwiseIO):
     _parameters = ["_expr"]
 
     @functools.cached_property
     def _name(self):
         return (
-            funcname(type(self.operand("_expr"))).lower()
+            self.operand("_expr")._funcname
             + "-fused-"
             + _tokenize_deterministic(*self.operands)
         )
 
     @functools.cached_property
     def _meta(self):
         return self.operand("_expr")._meta
```

### Comparing `dask-expr-1.0.5/dask_expr/io/json.py` & `dask-expr-1.0.6/dask_expr/io/json.py`

 * *Files 7% similar despite different names*

```diff
@@ -1,12 +1,14 @@
 import pandas as pd
 
-from dask_expr import from_dask_dataframe
+from dask_expr import from_legacy_dataframe
+from dask_expr._backends import dataframe_creation_dispatch
 
 
+@dataframe_creation_dispatch.register_inplace("pandas")
 def read_json(
     url_path,
     orient="records",
     lines=None,
     storage_options=None,
     blocksize=None,
     sample=2**20,
@@ -33,15 +35,15 @@
         compression=compression,
         meta=meta,
         engine=engine,
         include_path_column=include_path_column,
         path_converter=path_converter,
         **kwargs,
     )
-    return from_dask_dataframe(df)
+    return from_legacy_dataframe(df)
 
 
 def to_json(
     df,
     url_path,
     orient="records",
     lines=None,
@@ -53,15 +55,15 @@
     compute_kwargs=None,
     name_function=None,
     **kwargs,
 ):
     from dask.dataframe.io.json import to_json
 
     return to_json(
-        df.to_dask_dataframe(),
+        df.to_legacy_dataframe(),
         url_path,
         orient=orient,
         lines=lines,
         storage_options=storage_options,
         compute=compute,
         encoding=encoding,
         errors=errors,
```

### Comparing `dask-expr-1.0.5/dask_expr/io/orc.py` & `dask-expr-1.0.6/dask_expr/io/orc.py`

 * *Files 13% similar despite different names*

```diff
@@ -1,10 +1,12 @@
-from dask_expr import from_dask_dataframe
+from dask_expr import from_legacy_dataframe
+from dask_expr._backends import dataframe_creation_dispatch
 
 
+@dataframe_creation_dispatch.register_inplace("pandas")
 def read_orc(
     path,
     engine="pyarrow",
     columns=None,
     index=None,
     split_stripes=1,
     aggregate_files=None,
@@ -17,30 +19,30 @@
         engine=engine,
         columns=columns,
         index=index,
         split_stripes=split_stripes,
         aggregate_files=aggregate_files,
         storage_options=storage_options,
     )
-    return from_dask_dataframe(df)
+    return from_legacy_dataframe(df)
 
 
 def to_orc(
     df,
     path,
     engine="pyarrow",
     write_index=True,
     storage_options=None,
     compute=True,
     compute_kwargs=None,
 ):
     from dask.dataframe.io import to_orc as _to_orc
 
     return _to_orc(
-        df.to_dask_dataframe(),
+        df.to_legacy_dataframe(),
         path,
         engine=engine,
         write_index=write_index,
         storage_options=storage_options,
         compute=compute,
         compute_kwargs=compute_kwargs,
     )
```

### Comparing `dask-expr-1.0.5/dask_expr/io/parquet.py` & `dask-expr-1.0.6/dask_expr/io/parquet.py`

 * *Files 1% similar despite different names*

```diff
@@ -456,15 +456,15 @@
             "and overwriting the corresponding value can render the "
             "entire dataset unreadable."
         )
 
     # Engine-specific initialization steps to write the dataset.
     # Possibly create parquet metadata, and load existing stuff if appending
     i_offset, fmd, metadata_file_exists, extra_write_kwargs = engine.initialize_write(
-        df.to_dask_dataframe(),
+        df.to_legacy_dataframe(),
         fs,
         path,
         append=append,
         ignore_divisions=ignore_divisions,
         partition_on=partition_on,
         division_info=division_info,
         index_cols=index_cols,
@@ -590,15 +590,17 @@
     def _simplify_up(self, parent, dependents):
         if isinstance(parent, Index):
             # Column projection
             columns = determine_column_projection(self, parent, dependents)
             if set(columns) == set(self.columns):
                 return
             columns = [col for col in self.columns if col in columns]
-            return self.substitute_parameters({"columns": columns, "_series": False})
+            return Index(
+                self.substitute_parameters({"columns": columns, "_series": False})
+            )
 
         if isinstance(parent, Projection):
             return super()._simplify_up(parent, dependents)
 
         if isinstance(parent, Filter) and self._filter_passthrough_available(
             parent, dependents
         ):
@@ -628,19 +630,25 @@
         columns_operand = self.operand("columns")
         if columns_operand is None:
             return list(self._meta.columns)
         else:
             return _convert_to_list(columns_operand)
 
     @cached_property
+    def _funcname(self):
+        return "read_parquet"
+
+    @cached_property
     def _name(self):
         return (
-            funcname(type(self)).lower()
+            self._funcname
             + "-"
-            + _tokenize_deterministic(self.checksum, *self.operands[:-1])
+            + _tokenize_deterministic(
+                funcname(type(self)), self.checksum, *self.operands[:-1]
+            )
         )
 
     @property
     def checksum(self):
         return self._dataset_info["checksum"]
 
     def _tree_repr_argument_construction(self, i, op, header):
@@ -664,15 +672,15 @@
     def _divisions(self):
         raise NotImplementedError
 
     @property
     def _fusion_compression_factor(self):
         if self.operand("columns") is None:
             return 1
-        nr_original_columns = len(self._dataset_info["schema"].names) - 1
+        nr_original_columns = max(len(self._dataset_info["schema"].names) - 1, 1)
         return max(
             len(_convert_to_list(self.operand("columns"))) / nr_original_columns, 0.001
         )
 
 
 class ReadParquetPyarrowFS(ReadParquet):
     _parameters = [
@@ -858,22 +866,26 @@
         # were to check the type of the path first.
         try:
             # At this point we will post a listbucket request which includes the
             # same data as a HEAD request. The information included here (see
             # pyarrow FileInfo) are size, type, path and modified since
             # timestamps This isn't free but realtively cheap (200-300ms or less
             # for ~1k files)
-            dataset_selector = pa_fs.FileSelector(path_normalized, recursive=True)
-            all_files = [
-                finfo
-                for finfo in self.fs.get_file_info(dataset_selector)
-                if finfo.type == pa.fs.FileType.File
-            ]
+            all_files = []
+            for path in path_normalized:
+                dataset_selector = pa_fs.FileSelector(path, recursive=True)
+                all_files.extend(
+                    [
+                        finfo
+                        for finfo in self.fs.get_file_info(dataset_selector)
+                        if finfo.type == pa.fs.FileType.File
+                    ]
+                )
         except (NotADirectoryError, FileNotFoundError):
-            all_files = [self.fs.get_file_info(path_normalized)]
+            all_files = [self.fs.get_file_info(path) for path in path_normalized]
         # TODO: At this point we could verify if we're dealing with a very
         # inhomogeneous datasets already without reading any further data
 
         metadata_file = False
         checksum = None
         dataset = None
         if not self.ignore_metadata_file:
@@ -1649,22 +1661,27 @@
         return {"num-rows": num_rows, "columns": column_stats_list}
 
     # Helper function used by _extract_statistics
     return [_read_partition_stats(part, fs, columns=columns) for part in parts]
 
 
 def _normalize_and_strip_protocol(path):
-    protocol_separators = ["://", "::"]
-    for sep in protocol_separators:
-        split = path.split(sep, 1)
-        if len(split) > 1:
-            path = split[1]
-            break
-    path = path.rstrip("/")
-    return path
+    if not isinstance(path, (list, tuple)):
+        path = [path]
+
+    result = []
+    for p in path:
+        protocol_separators = ["://", "::"]
+        for sep in protocol_separators:
+            split = p.split(sep, 1)
+            if len(split) > 1:
+                p = split[1]
+                break
+        result.append(p.rstrip("/"))
+    return result
 
 
 def _divisions_from_statistics(aggregated_stats, index_name):
     col_ix = -1
     peak_rg = aggregated_stats[0]
     for ix, col in enumerate(peak_rg["columns"]):
         if col["path_in_schema"] == index_name:
```

### Comparing `dask-expr-1.0.5/dask_expr/io/sql.py` & `dask-expr-1.0.6/dask_expr/io/sql.py`

 * *Files 22% similar despite different names*

```diff
@@ -1,15 +1,15 @@
-from dask_expr import from_dask_dataframe
+from dask_expr import from_legacy_dataframe
 
 
 def read_sql(sql, con, index_col, **kwargs):
     from dask.dataframe.io.sql import read_sql
 
     df = read_sql(sql, con, index_col, **kwargs)
-    return from_dask_dataframe(df)
+    return from_legacy_dataframe(df)
 
 
 def read_sql_table(
     table_name,
     con,
     index_col,
     divisions=None,
@@ -36,15 +36,15 @@
         bytes_per_chunk=bytes_per_chunk,
         head_rows=head_rows,
         schema=schema,
         meta=meta,
         engine_kwargs=engine_kwargs,
         **kwargs,
     )
-    return from_dask_dataframe(df)
+    return from_legacy_dataframe(df)
 
 
 def read_sql_query(
     sql,
     con,
     index_col,
     divisions=None,
@@ -67,15 +67,15 @@
         limits=limits,
         bytes_per_chunk=bytes_per_chunk,
         head_rows=head_rows,
         meta=meta,
         engine_kwargs=engine_kwargs,
         **kwargs,
     )
-    return from_dask_dataframe(df)
+    return from_legacy_dataframe(df)
 
 
 def to_sql(
     df,
     name: str,
     uri: str,
     schema=None,
@@ -88,15 +88,15 @@
     compute=True,
     parallel=False,
     engine_kwargs=None,
 ):
     from dask.dataframe.io.sql import to_sql as _to_sql
 
     return _to_sql(
-        df.to_dask_dataframe(),
+        df.to_legacy_dataframe(),
         name=name,
         uri=uri,
         schema=schema,
         if_exists=if_exists,
         index=index,
         index_label=index_label,
         chunksize=chunksize,
```

### Comparing `dask-expr-1.0.5/dask_expr.egg-info/PKG-INFO` & `dask-expr-1.0.6/dask_expr.egg-info/PKG-INFO`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: dask-expr
-Version: 1.0.5
+Version: 1.0.6
 Summary: High Level Expressions for Dask 
 Maintainer-email: Matthew Rocklin <mrocklin@gmail.com>
 License: BSD
 Project-URL: Source code, https://github.com/dask-contrib/dask-expr/
 Keywords: dask pandas
 Classifier: Intended Audience :: Developers
 Classifier: Intended Audience :: Science/Research
@@ -18,15 +18,15 @@
 Classifier: Programming Language :: Python :: 3.11
 Classifier: Programming Language :: Python :: 3.12
 Classifier: Topic :: Scientific/Engineering
 Classifier: Topic :: System :: Distributed Computing
 Requires-Python: >=3.9
 Description-Content-Type: text/markdown
 License-File: LICENSE.txt
-Requires-Dist: dask==2024.3.1
+Requires-Dist: dask==2024.4.0
 Requires-Dist: pyarrow>=7.0.0
 Requires-Dist: pandas>=2
 
 Dask Expressions
 ================
 
 Dask DataFrames with query optimization.
```

### Comparing `dask-expr-1.0.5/dask_expr.egg-info/SOURCES.txt` & `dask-expr-1.0.6/dask_expr.egg-info/SOURCES.txt`

 * *Files identical despite different names*

### Comparing `dask-expr-1.0.5/pyproject.toml` & `dask-expr-1.0.6/pyproject.toml`

 * *Files 4% similar despite different names*

```diff
@@ -22,15 +22,15 @@
     "Programming Language :: Python :: 3.12",
     "Topic :: Scientific/Engineering",
     "Topic :: System :: Distributed Computing",
 ]
 readme = "README.md"
 requires-python = ">=3.9"
 dependencies = [
-    "dask == 2024.3.1",
+    "dask == 2024.4.0",
     "pyarrow>=7.0.0",
     "pandas >= 2",
 ]
 
 dynamic = ["version"]
 
 [project.urls]
```

