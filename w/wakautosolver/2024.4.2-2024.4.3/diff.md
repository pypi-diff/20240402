# Comparing `tmp/wakautosolver-2024.4.2-py3-none-any.whl.zip` & `tmp/wakautosolver-2024.4.3-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,33 +1,33 @@
-Zip file size: 2005125 bytes, number of entries: 31
+Zip file size: 2005541 bytes, number of entries: 31
 -rw-r--r--  2.0 fat    16725 b- defN 20-Feb-02 00:00 LICENSE
 -rw-r--r--  2.0 fat   453356 b- defN 20-Feb-02 00:00 .venv/Lib/site-packages/scripts/item_data.bz2
 -rw-r--r--  2.0 fat   137411 b- defN 20-Feb-02 00:00 .venv/Lib/site-packages/scripts/locale_bundle.bz2
 -rw-r--r--  2.0 fat   453356 b- defN 20-Feb-02 00:00 scripts/item_data.bz2
--rw-r--r--  2.0 fat      510 b- defN 20-Feb-02 00:00 wakautosolver/__init__.py
+-rw-r--r--  2.0 fat      569 b- defN 20-Feb-02 00:00 wakautosolver/__init__.py
 -rw-r--r--  2.0 fat      764 b- defN 20-Feb-02 00:00 wakautosolver/__main__.py
 -rw-r--r--  2.0 fat     3851 b- defN 20-Feb-02 00:00 wakautosolver/_build_codes.py
 -rw-r--r--  2.0 fat     1274 b- defN 20-Feb-02 00:00 wakautosolver/_short_debug_info.py
 -rw-r--r--  2.0 fat     1713 b- defN 20-Feb-02 00:00 wakautosolver/_typing_memes.py
 -rw-r--r--  2.0 fat     4466 b- defN 20-Feb-02 00:00 wakautosolver/item_conditions.py
 -rw-r--r--  2.0 fat    11384 b- defN 20-Feb-02 00:00 wakautosolver/object_parsing.py
 -rw-r--r--  2.0 fat        0 b- defN 20-Feb-02 00:00 wakautosolver/py.typed
 -rw-r--r--  2.0 fat    17069 b- defN 20-Feb-02 00:00 wakautosolver/restructured_types.py
--rw-r--r--  2.0 fat    51522 b- defN 20-Feb-02 00:00 wakautosolver/solver.py
+-rw-r--r--  2.0 fat    52900 b- defN 20-Feb-02 00:00 wakautosolver/solver.py
 -rw-r--r--  2.0 fat      674 b- defN 20-Feb-02 00:00 wakautosolver/utils.py
--rw-r--r--  2.0 fat    12530 b- defN 20-Feb-02 00:00 wakautosolver/versioned_entrypoints.py
--rw-r--r--  2.0 fat     7126 b- defN 20-Feb-02 00:00 wakautosolver/wakforge_buildcodes.py
+-rw-r--r--  2.0 fat    12468 b- defN 20-Feb-02 00:00 wakautosolver/versioned_entrypoints.py
+-rw-r--r--  2.0 fat     7331 b- defN 20-Feb-02 00:00 wakautosolver/wakforge_buildcodes.py
 -rw-r--r--  2.0 fat      366 b- defN 20-Feb-02 00:00 wakautosolver/b2048/__init__.py
 -rw-r--r--  2.0 fat    49861 b- defN 20-Feb-02 00:00 wakautosolver/b2048/dec_table.py
 -rw-r--r--  2.0 fat    21610 b- defN 20-Feb-02 00:00 wakautosolver/b2048/enc_table.py
 -rw-r--r--  2.0 fat     3634 b- defN 20-Feb-02 00:00 wakautosolver/b2048/encoder.py
 -rw-r--r--  2.0 fat  1212416 b- defN 20-Feb-02 00:00 wakautosolver/data/items.db
 -rw-r--r--  2.0 fat  1992029 b- defN 20-Feb-02 00:00 wakautosolver/data/items.sql
 -rw-r--r--  2.0 fat   137716 b- defN 20-Feb-02 00:00 wakautosolver/data/locale_bundle.bz2
 -rw-r--r--  2.0 fat       75 b- defN 20-Feb-02 00:00 wakautosolver/data/readme.md
 -rw-r--r--  2.0 fat     2816 b- defN 20-Feb-02 00:00 wakautosolver/data/source_info.bz2
 -rw-r--r--  2.0 fat    85259 b- defN 20-Feb-02 00:00 wakautosolver/data/stat_only_bundle.bz2
-?rw-r--r--  2.0 fat     6104 b- defN 20-Feb-02 00:00 wakautosolver-2024.4.2.dist-info/METADATA
-?rw-r--r--  2.0 fat       87 b- defN 20-Feb-02 00:00 wakautosolver-2024.4.2.dist-info/WHEEL
-?rw-r--r--  2.0 fat    16725 b- defN 20-Feb-02 00:00 wakautosolver-2024.4.2.dist-info/licenses/LICENSE
-?rw-r--r--  2.0 fat     2713 b- defN 20-Feb-02 00:00 wakautosolver-2024.4.2.dist-info/RECORD
-31 files, 4705142 bytes uncompressed, 2000771 bytes compressed:  57.5%
+?rw-r--r--  2.0 fat     6104 b- defN 20-Feb-02 00:00 wakautosolver-2024.4.3.dist-info/METADATA
+?rw-r--r--  2.0 fat       87 b- defN 20-Feb-02 00:00 wakautosolver-2024.4.3.dist-info/WHEEL
+?rw-r--r--  2.0 fat    16725 b- defN 20-Feb-02 00:00 wakautosolver-2024.4.3.dist-info/licenses/LICENSE
+?rw-r--r--  2.0 fat     2713 b- defN 20-Feb-02 00:00 wakautosolver-2024.4.3.dist-info/RECORD
+31 files, 4706722 bytes uncompressed, 2001187 bytes compressed:  57.5%
```

## zipnote {}

```diff
@@ -75,20 +75,20 @@
 
 Filename: wakautosolver/data/source_info.bz2
 Comment: 
 
 Filename: wakautosolver/data/stat_only_bundle.bz2
 Comment: 
 
-Filename: wakautosolver-2024.4.2.dist-info/METADATA
+Filename: wakautosolver-2024.4.3.dist-info/METADATA
 Comment: 
 
-Filename: wakautosolver-2024.4.2.dist-info/WHEEL
+Filename: wakautosolver-2024.4.3.dist-info/WHEEL
 Comment: 
 
-Filename: wakautosolver-2024.4.2.dist-info/licenses/LICENSE
+Filename: wakautosolver-2024.4.3.dist-info/licenses/LICENSE
 Comment: 
 
-Filename: wakautosolver-2024.4.2.dist-info/RECORD
+Filename: wakautosolver-2024.4.3.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## wakautosolver/__init__.py

```diff
@@ -2,15 +2,16 @@
 This Source Code Form is subject to the terms of the Mozilla Public
 License, v. 2.0. If a copy of the MPL was not distributed with this
 file, You can obtain one at http://mozilla.org/MPL/2.0/.
 
 Copyright (C) 2023 Michael Hall <https://github.com/mikeshardmind>
 """
 
-__version__ = "2024.04.02"
+# Note: This is Year, month, monotonic not year, month, day
+__version__ = "2024.04.3"
 
 from . import object_parsing, solver
 from .b2048 import decode as b2048_decode
 from .b2048 import encode as b2048_encode
 
 __all__ = [
     "b2048_decode",
```

## wakautosolver/solver.py

```diff
@@ -94,14 +94,15 @@
 
 
 def solve(
     ns: v1Config,
     use_tqdm: bool = False,
     progress_callback: Callable[[int, int], None] | None = None,
     point_spread: StatSpread | None = None,
+    passives: list[int] | None = None,
 ) -> list[tuple[float, list[EquipableItem]]]:
     """Still has some debug stuff in here, will be refactoring this all later."""
 
     use_tqdm = use_tqdm or bool(os.getenv("USE_TQDM", None))
 
     set_locale(ns.locale)
 
@@ -604,14 +605,16 @@
 
     solve_CANIDATES: dict[str, list[EquipableItem]] = {
         k: [item for item in v if item.item_id not in _soft_unobtainable] for k, v in AOBJS.items()
     }
 
     def needs_full_sim_key(item: EquipableItem) -> Hashable:
         keys = {"disables_second_weapon", *ALWAYS_SIMMED}
+        if passives and 5100 in passives:
+            keys.add("block")
         return attrgetter(*keys)(item)
 
     if original_forced_counts:
         for slot, count in original_forced_counts.items():
             if (slot != "LEFT_HAND" and count == 1) or (slot == "LEFT_HAND" and count == 2):
                 solve_CANIDATES.pop(slot, None)
             elif slot == "LEFT_HAND" and count == 1:
@@ -925,15 +928,14 @@
     l_add = lru_cache(add)
     l_and = lru_cache(and_)
 
     for idx, (relic, epic) in enumerate(maybe_progress_bar, 1):
         if progress_callback:
             progress_callback(idx, re_len)
 
-
         if relic and epic:
             if relic.item_slot == epic.item_slot != "LEFT_HAND":
                 continue
 
             if relic.disables_second_weapon and epic.item_slot == "SECOND_WEAPON":
                 continue
 
@@ -975,15 +977,14 @@
         if epic and epic.item_slot not in REM_SLOTS and "WEAPON" not in epic.item_slot:
             continue
 
         main_hand_disabled = False
         off_hand_disabled = False
 
         for item in (*forced_items, relic, epic):
-
             if item is None:
                 continue
             if item.item_slot == "FIRST_WEAPON":
                 main_hand_disabled = True
                 if item.disables_second_weapon:
                     off_hand_disabled = True
             elif item.item_slot == "SECOND_WEAPON":
@@ -1039,17 +1040,40 @@
             mxs = reduce(l_and, filter(None, mxs), stat_maxs)
 
             if not mns <= statline <= mxs:
                 continue
 
             critical_hit = statline.critical_hit + 3
 
+            # Note: keep the class here even if it isn't needed for ease of reference
+
+            # innate passive
             if ns.wakfu_class == ClassesEnum.Ecaflip and critical_hit > 100:
                 statline += Stats(fd=0.5 * (critical_hit - 100))
 
+            # Bravery
+            if ns.wakfu_class == ClassesEnum.Iop and passives and 5100 in passives and ns.lv >= 90:
+                block_mod = min(max(0, statline.block // 2), 20)
+                if block_mod:
+                    statline += Stats(block=block_mod)
+
+            # Sram to the bone
+            if ns.wakfu_class == ClassesEnum.Sram and passives and 4610 in passives and ns.lv >= 100:
+                # TODO: (?) We assume shards will make up any missing lock/dodge right now
+                statline += Stats(critical_hit=20 if ns.lv < 200 else 30)
+
+            if ns.wakfu_class == ClassesEnum.Masq and passives:
+                # TODO: (?) We assume shards will make up any missing lock/dodge right now
+                if 7096 in passives and ns.lv >= 20:  # artful locker
+                    melee_mod = min(max(0, statline.lock // 2), ns.lv * 2)
+                    statline += Stats(melee_mastery=melee_mod)
+                if 7109 in passives and ns.lv >= 85:  # artful dodge
+                    distance_mod = min(max(0, statline.dodge // 2), ns.lv * 2)
+                    statline += Stats(distance_mastery=distance_mod)
+
             UNRAVEL_ACTIVE = ns.unraveling and critical_hit >= 40
 
             crit_chance = max(min(critical_hit, 100), 0)  # engine crit rate vs stat
 
             base_score = sum(score_key(i) for i in (*items, relic, epic)) + BASE_STAT_SCORE
 
             non_crit_score = base_score
```

## wakautosolver/versioned_entrypoints.py

```diff
@@ -371,17 +371,13 @@
         try:
             if item.item_id in item_ids:
                 build.add_elements_to_item(item.item_id, elements)
             else:
                 build.add_item(item, elements)
         except RuntimeError as exc:
             msg = "".join(traceback.format_exception(exc))
-            err = Wakforge_v2ShortError(
-                version=__version__,
-                solve_params=v2BuildConfig(build, config.objectives),
-                message=msg
-            )
+            err = Wakforge_v2ShortError(version=__version__, solve_params=v2BuildConfig(build, config.objectives), message=msg)
             return v2Result(None, "Unknown error, see debug info", debug_info=compressed_encode(err))
 
     debug_info = compressed_encode({"score": score})
 
     return v2Result(build.to_code(), None, found_item_ids, debug_info=debug_info)
```

## wakautosolver/wakforge_buildcodes.py

```diff
@@ -188,14 +188,18 @@
             raise RuntimeError(msg)
 
     def to_code(self) -> str:
         packed = msgpack.encode(self)
         compressor = zlib.compressobj(level=9, wbits=-15)
         return b2048.encode(compressor.compress(packed) + compressor.flush())
 
+    def get_passives(self) -> list[int]:
+        passives = (self.passive_1, self.passive_2, self.passive_3, self.passive_4, self.passive_5, self.passive_6)
+        return [p for p in passives if p > -1]
+
 
 def build_code_from_items(level: int, items: list[EquipableItem]) -> str:
     items = [i for i in items if i.item_id > 0]  # filter out placeholder items
     build = Buildv1(level=level)
     for item in items:
         build.add_item(item)
     packed = msgpack.encode(build)
```

## Comparing `wakautosolver-2024.4.2.dist-info/METADATA` & `wakautosolver-2024.4.3.dist-info/METADATA`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: wakautosolver
-Version: 2024.4.2
+Version: 2024.4.3
 Project-URL: Homepage, https://github.com/mikeshardmind/wakfu-utils
 Author-email: Michael Hall <michael@michaelhall.tech>
 License-Expression: MPL-2.0
 License-File: LICENSE
 Requires-Python: >=3.11
 Requires-Dist: msgspec>=0.18.4
 Requires-Dist: tqdm>=4.66.1
```

## Comparing `wakautosolver-2024.4.2.dist-info/licenses/LICENSE` & `wakautosolver-2024.4.3.dist-info/licenses/LICENSE`

 * *Files identical despite different names*

## Comparing `wakautosolver-2024.4.2.dist-info/RECORD` & `wakautosolver-2024.4.3.dist-info/RECORD`

 * *Files 12% similar despite different names*

```diff
@@ -1,31 +1,31 @@
 LICENSE,sha256=HyVuytGSiAUQ6ErWBHTqt1iSGHhLmlC8fO7jTCuR8dU,16725
 .venv/Lib/site-packages/scripts/item_data.bz2,sha256=f_QL9zVv3F1o1zt0tCyqb5-UOQ1hTxsvTtD-p-ZYFAU,453356
 .venv/Lib/site-packages/scripts/locale_bundle.bz2,sha256=vZRfALj01hgsmGrlDPpYgGaK9oEXnhrfJusqHTXCKHY,137411
 scripts/item_data.bz2,sha256=f_QL9zVv3F1o1zt0tCyqb5-UOQ1hTxsvTtD-p-ZYFAU,453356
-wakautosolver/__init__.py,sha256=8m6xaTfGCJuL5scSueFzA_dukcq-SkZ2vouffrniW2o,510
+wakautosolver/__init__.py,sha256=WOGu7KF_nPz56zEwxasF4z-3lDav68LtzN7cK3K97c8,569
 wakautosolver/__main__.py,sha256=UtGrY1NrAkSGgj2e5SBkbmgRFMuojHZZr0ZE25x-UVY,764
 wakautosolver/_build_codes.py,sha256=oTgmSQqZJYa-SVv4dL1ctVxGtz9gkvGR0mi0vkPPK1E,3851
 wakautosolver/_short_debug_info.py,sha256=8Dq1NJugZJBGWxlcjj5M5gAmXCWpaiqA0Bq2UOB-S7w,1274
 wakautosolver/_typing_memes.py,sha256=ygR25rAn58tPoflK4iZzU45B8e94cii1cqcAkQ6biVQ,1713
 wakautosolver/item_conditions.py,sha256=KnlUyLunO4dY_oO9rtX8cYhYv08kBMgCz0V2ghK-IDk,4466
 wakautosolver/object_parsing.py,sha256=Sb-YhvizUmiwNpkrxroMvjv1E48Oco-xIt5a0G4SgE4,11384
 wakautosolver/py.typed,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 wakautosolver/restructured_types.py,sha256=E2_uADC8HzkLAXnj0iD0xRtEGNgr6zalUdVcjuYhHYA,17069
-wakautosolver/solver.py,sha256=hig1PxtN3Pw22_8IjX6jeFEdPG27ERAz6yCFlk9WvFI,51522
+wakautosolver/solver.py,sha256=szjP2DEQ8-k1okUvA8CH7ykAR2ENGJ2c86FqsnUeE9c,52900
 wakautosolver/utils.py,sha256=KtuyMFKwOj4J1FMKyVTTuSVbQl3Eqw9GLSZLtaDAiRM,674
-wakautosolver/versioned_entrypoints.py,sha256=YceV9aIlzAn6L0LjGdqr3fainkANGeG3_oDyl5hIRnE,12530
-wakautosolver/wakforge_buildcodes.py,sha256=-xlIEkp4yV_lbkAH7eSNvlyMFHc6pnzeKO_1GmPlopQ,7126
+wakautosolver/versioned_entrypoints.py,sha256=DoonJjHyEVYOBIcnDkppozQi8bgor2ZymwyAttPbBwQ,12468
+wakautosolver/wakforge_buildcodes.py,sha256=RsabiDwaVBIimPz9KCALidWZcSEkM514tRiKuIXUU2o,7331
 wakautosolver/b2048/__init__.py,sha256=AbMdWj28dc94x-b-_NuF6uXrZ4eeUU2ZG9nDj8hq_jM,366
 wakautosolver/b2048/dec_table.py,sha256=1LZWoaSeQWs7OeSzkmrYA4FkoSSnDJK_y83gkqRZqQM,49861
 wakautosolver/b2048/enc_table.py,sha256=RE5kddBNQarcYjLbDxK-edOpP4iO5TgqyRoHQdpvHHk,21610
 wakautosolver/b2048/encoder.py,sha256=q8U17Vb-3pVNPxoAnKXEzhzzZDgZPxRNjk7UBnliV0s,3634
 wakautosolver/data/items.db,sha256=1YD6rj7orqZLYpzFvp7rtWxP40EB4ORsYtABY6AMmzE,1212416
 wakautosolver/data/items.sql,sha256=JVdEiOL0orOhBCnMzSwUgxFVjn8SH-Ru9UZvgUkromk,1992029
 wakautosolver/data/locale_bundle.bz2,sha256=qPnB2vjm0f6lx4L0Q3sG4ERn1a3wnWyyhj7OP67Fn_g,137716
 wakautosolver/data/readme.md,sha256=GQ8oPIi_oTVznNypRYsq6v-ptAKPTILRFI3OIJzsYko,75
 wakautosolver/data/source_info.bz2,sha256=GFoA1pup08aQLCFcwMSbqkEC_5kX9lQoTKdr3KsdRJ0,2816
 wakautosolver/data/stat_only_bundle.bz2,sha256=Yo2hDD3m96Ow10hxHXdoVqspJahe19yW3QFV71CY-cM,85259
-wakautosolver-2024.4.2.dist-info/METADATA,sha256=1ftNH0xnpcDhStqp8G3meKYXlAQRgfcE6bt0vpPK1xc,6104
-wakautosolver-2024.4.2.dist-info/WHEEL,sha256=9QBuHhg6FNW7lppboF2vKVbCGTVzsFykgRQjjlajrhA,87
-wakautosolver-2024.4.2.dist-info/licenses/LICENSE,sha256=HyVuytGSiAUQ6ErWBHTqt1iSGHhLmlC8fO7jTCuR8dU,16725
-wakautosolver-2024.4.2.dist-info/RECORD,,
+wakautosolver-2024.4.3.dist-info/METADATA,sha256=2lJL3L9em0IKAMxpYHbhSYc4uNIo8sPn2ZDPyig-Sx8,6104
+wakautosolver-2024.4.3.dist-info/WHEEL,sha256=9QBuHhg6FNW7lppboF2vKVbCGTVzsFykgRQjjlajrhA,87
+wakautosolver-2024.4.3.dist-info/licenses/LICENSE,sha256=HyVuytGSiAUQ6ErWBHTqt1iSGHhLmlC8fO7jTCuR8dU,16725
+wakautosolver-2024.4.3.dist-info/RECORD,,
```

