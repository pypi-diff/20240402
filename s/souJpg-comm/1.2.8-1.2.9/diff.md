# Comparing `tmp/souJpg_comm-1.2.8-py3-none-any.whl.zip` & `tmp/souJpg_comm-1.2.9-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,22 +1,22 @@
-Zip file size: 54160 bytes, number of entries: 48
+Zip file size: 54299 bytes, number of entries: 48
 -rw-rw-r--  2.0 unx      505 b- defN 23-Jul-14 22:49 souJpg/__init__.py
 -rw-rw-r--  2.0 unx        0 b- defN 23-May-23 03:15 souJpg/comm/__init__.py
 -rw-rw-r--  2.0 unx     2781 b- defN 23-Jul-14 06:39 souJpg/comm/apiResponse.py
 -rw-rw-r--  2.0 unx     2351 b- defN 23-Sep-06 06:22 souJpg/comm/contextManagers.py
 -rw-rw-r--  2.0 unx     2010 b- defN 23-Jul-11 09:32 souJpg/comm/cos.py
 -rw-rw-r--  2.0 unx     1415 b- defN 23-Sep-18 01:48 souJpg/comm/dbHelper.py
 -rw-rw-r--  2.0 unx     3816 b- defN 23-May-23 03:15 souJpg/comm/dbsCL.py
 -rw-rw-r--  2.0 unx     4676 b- defN 23-May-23 03:15 souJpg/comm/hdfsUtils.py
 -rw-rw-r--  2.0 unx    17648 b- defN 23-Dec-06 09:24 souJpg/comm/imageUtils.py
 -rw-rw-r--  2.0 unx     3719 b- defN 23-May-23 03:15 souJpg/comm/kafkaOps.py
 -rw-rw-r--  2.0 unx    10938 b- defN 23-May-23 03:15 souJpg/comm/labelUtils.py
 -rw-rw-r--  2.0 unx     1543 b- defN 23-May-23 03:15 souJpg/comm/mathUtils.py
 -rw-rw-r--  2.0 unx     1072 b- defN 23-May-23 03:15 souJpg/comm/projectUitls.py
--rw-rw-r--  2.0 unx     5899 b- defN 24-Mar-22 00:11 souJpg/comm/redisOps.py
+-rw-rw-r--  2.0 unx     6490 b- defN 24-Apr-02 00:33 souJpg/comm/redisOps.py
 -rw-rw-r--  2.0 unx     3539 b- defN 23-May-23 03:15 souJpg/comm/sparkApp.py
 -rw-rw-r--  2.0 unx     4623 b- defN 23-May-23 03:15 souJpg/comm/sparkBase.py
 -rw-rw-r--  2.0 unx      277 b- defN 23-Sep-16 04:46 souJpg/comm/threadPools.py
 -rw-rw-r--  2.0 unx      218 b- defN 23-May-23 03:15 souJpg/comm/utils.py
 -rw-rw-r--  2.0 unx     7924 b- defN 23-May-23 03:15 souJpg/comm/vcgUtils.py
 -rw-rw-r--  2.0 unx     2024 b- defN 23-May-23 03:15 souJpg/comm/videoUtils.py
 -rw-rw-r--  2.0 unx        0 b- defN 23-May-23 03:15 souJpg/comm/cfg/__init__.py
@@ -39,12 +39,12 @@
 -rw-rw-r--  2.0 unx    10100 b- defN 23-Oct-16 05:38 souJpg/comm/imageStore/test.py
 -rw-rw-r--  2.0 unx        0 b- defN 23-May-23 03:15 souJpg/comm/ops/__init__.py
 -rw-rw-r--  2.0 unx     7766 b- defN 23-Jul-20 13:05 souJpg/comm/ops/ops.py
 -rw-rw-r--  2.0 unx        0 b- defN 23-May-23 03:15 souJpg/comm/ops/test/__init__.py
 -rw-rw-r--  2.0 unx     6989 b- defN 23-May-23 03:15 souJpg/comm/ops/test/test.py
 -rw-rw-r--  2.0 unx        0 b- defN 23-May-23 03:15 souJpg/comm/test/__init__.py
 -rw-rw-r--  2.0 unx    22844 b- defN 24-Mar-18 00:58 souJpg/comm/test/test.py
--rw-rw-r--  2.0 unx      334 b- defN 24-Mar-24 03:23 souJpg_comm-1.2.8.dist-info/METADATA
--rw-rw-r--  2.0 unx       92 b- defN 24-Mar-24 03:23 souJpg_comm-1.2.8.dist-info/WHEEL
--rw-rw-r--  2.0 unx        7 b- defN 24-Mar-24 03:23 souJpg_comm-1.2.8.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     3954 b- defN 24-Mar-24 03:23 souJpg_comm-1.2.8.dist-info/RECORD
-48 files, 188698 bytes uncompressed, 47870 bytes compressed:  74.6%
+-rw-rw-r--  2.0 unx      334 b- defN 24-Apr-02 01:16 souJpg_comm-1.2.9.dist-info/METADATA
+-rw-rw-r--  2.0 unx       92 b- defN 24-Apr-02 01:16 souJpg_comm-1.2.9.dist-info/WHEEL
+-rw-rw-r--  2.0 unx        7 b- defN 24-Apr-02 01:16 souJpg_comm-1.2.9.dist-info/top_level.txt
+?rw-rw-r--  2.0 unx     3954 b- defN 24-Apr-02 01:16 souJpg_comm-1.2.9.dist-info/RECORD
+48 files, 189289 bytes uncompressed, 48009 bytes compressed:  74.6%
```

## zipnote {}

```diff
@@ -126,20 +126,20 @@
 
 Filename: souJpg/comm/test/__init__.py
 Comment: 
 
 Filename: souJpg/comm/test/test.py
 Comment: 
 
-Filename: souJpg_comm-1.2.8.dist-info/METADATA
+Filename: souJpg_comm-1.2.9.dist-info/METADATA
 Comment: 
 
-Filename: souJpg_comm-1.2.8.dist-info/WHEEL
+Filename: souJpg_comm-1.2.9.dist-info/WHEEL
 Comment: 
 
-Filename: souJpg_comm-1.2.8.dist-info/top_level.txt
+Filename: souJpg_comm-1.2.9.dist-info/top_level.txt
 Comment: 
 
-Filename: souJpg_comm-1.2.8.dist-info/RECORD
+Filename: souJpg_comm-1.2.9.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## souJpg/comm/redisOps.py

```diff
@@ -12,15 +12,14 @@
 from redis import StrictRedis
 from redisbloom.client import Client
 
 from souJpg.comm.contextManagers import ExceptionCatcher
 from souJpg import gcf
 encoding = "utf-8"
 
-
 class RedisOps:
     def __init__(self, params={}):
         self.params = params
         host = self.params.get("redis_host", gcf.redis_host)
         port = self.params.get("redis_port", gcf.redis_port)
         password = self.params.get("redis_password", gcf.redis_password)
         # avoid error when redis server is not available
@@ -82,15 +81,41 @@
                 self.createdBfNames.add(bfName)
 
     def bfExist(self, bfName=None, value=None):
         return self.bf.cfExists(bfName, value)
 
     def refresh(self, key=None):
         return self.r.expire(key, 1)
-
+    def params2Key(self, params=None, funcName=None,hashKey=False):
+        key=""
+        args_ = []
+        items=dict(sorted(params.items()))
+        for key, value in items.items():
+            logger.trace("key: {key}, value: {value}", key=key, value=value)
+            if value is not None:
+                if isinstance(value, BaseModel):
+                    value = value.dict()
+                if isinstance(value, dict):
+                    value=dict(sorted(value.items()))
+            args_.append(str(value))
+        key_parts = [funcName] + args_
+        key = "-".join(key_parts)
+        logger.debug("key: {key}", key=key)
+        
+        if hashKey:
+            if isinstance(key, dict):
+                key=json.dumps(key)
+                
+                    
+                   
+                
+            key=hashlib.sha256(key.encode()).digest()
+            key=base64.urlsafe_b64encode(key).decode()[:8]
+        logger.info("key: {key}", key=key)
+        return key
     def deleteKey(self, key=None):
         return self.r.delete(key)
 
 
 redisOps = RedisOps()
 
 
@@ -116,35 +141,23 @@
     """
 
     def cached_real(func):
         @wraps(func)
         def wrapper(*args, **kwargs):
             # Generate the cache key from the function's arguments.
             key = redisKey
+            logger.debug('kwargs: {kwargs}',kwargs=kwargs)
+            params_=kwargs.get("params",None)
+            if params_ is not None:
+                params_.pop("client_ip")
+                params_.pop("client_port")
+                params_.pop("requestId")
+            
             if key is None:
-                args_ = []
-                for key, value in kwargs.items():
-                    logger.trace("key: {key}, value: {value}", key=key, value=value)
-                    if value is not None:
-                        if isinstance(value, BaseModel):
-                            value = value.dict()
-                    args_.append(str(value))
-                    
-
-                key_parts = [func.__name__] + args_
-                key = "-".join(key_parts)
-            # check key is json
-            if hashKey:
-                if isinstance(key, dict):
-                    key=json.dumps(key)
-                    
-                   
-                
-                key=hashlib.sha256(key.encode()).digest()
-                key=base64.urlsafe_b64encode(key).decode()[:8]
+                key = redisOps.params2Key(params=kwargs, funcName=func.__name__,hashKey=hashKey)
             
                 
                 
                 
 
             result = None
             with ExceptionCatcher() as ec:
```

## Comparing `souJpg_comm-1.2.8.dist-info/RECORD` & `souJpg_comm-1.2.9.dist-info/RECORD`

 * *Files 3% similar despite different names*

```diff
@@ -7,15 +7,15 @@
 souJpg/comm/dbsCL.py,sha256=GMsu9lHYeXm2M_fmmE8BhUqKzDG2EasL6UYJW5KrJJc,3816
 souJpg/comm/hdfsUtils.py,sha256=S1Rm6t7L_fYm4VdtUpjtKdOIBfXfglEwQpEUXLJ7keM,4676
 souJpg/comm/imageUtils.py,sha256=Q0tjr-DXOB5jdCdl4dBss2DMPLe5iMWYARodg9bPpow,17648
 souJpg/comm/kafkaOps.py,sha256=_o3uqa0oDZf3SDq-SdfD4NIkCYWjaqA-MA4dwlezjzE,3719
 souJpg/comm/labelUtils.py,sha256=P5ntx05jV9ZBM-0bcItGop9TsuCJBSON2ieVk2RsPgE,10938
 souJpg/comm/mathUtils.py,sha256=r8MM_lmourx3X6CHlQodxoH-av0A51KfaGMgOE0J3XY,1543
 souJpg/comm/projectUitls.py,sha256=XXGwTeKH_xBFY7HuduE0sT9QNLCk-jHsLmyNTD6P918,1072
-souJpg/comm/redisOps.py,sha256=faLuueKTPcbGxqbZgjU3jPft73cop-hppsFjdzRfhAo,5899
+souJpg/comm/redisOps.py,sha256=l-R-v3DoB5_C6W_Zsrxk4T4PMVorvdTqX0IgRiXAYpM,6490
 souJpg/comm/sparkApp.py,sha256=qRKCCKpHcl84COnDYhyvp7mdicWVxth9aIFzJw-q0pc,3539
 souJpg/comm/sparkBase.py,sha256=3oYpZbhqaf4CjxRUfcyRkupw-2p8DdWRzReb8RofjKE,4623
 souJpg/comm/threadPools.py,sha256=PXI0arC_-irZc_PLFCga5o_qLbUt4PIC6b5XgNyTvFk,277
 souJpg/comm/utils.py,sha256=Qsc9zMsj4jYGM-9H_CdpKN5SCOPbI6YOqzrIKG1P6yw,218
 souJpg/comm/vcgUtils.py,sha256=iss80QaH3vgItp_t5dBId-f62OqvZKeQejt54oe90oU,7924
 souJpg/comm/videoUtils.py,sha256=CPSjWJ-46KnYsG33KnD1q3GAqqnNEL7oWGgmcqf9Tgc,2024
 souJpg/comm/cfg/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
@@ -38,11 +38,11 @@
 souJpg/comm/imageStore/test.py,sha256=xDzbR6rd2SazOwXHP_uAaA3EEOwTeB5XvJd-oqSBz-o,10100
 souJpg/comm/ops/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 souJpg/comm/ops/ops.py,sha256=eIKEQqXsim2snM9S2c5v1qklRzL039Mco4S9SVdz64o,7766
 souJpg/comm/ops/test/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 souJpg/comm/ops/test/test.py,sha256=9zZojTrnw_5EE0K_8cAFwznKKZ1qvJgCo1Qmtb1WYNI,6989
 souJpg/comm/test/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 souJpg/comm/test/test.py,sha256=cmRmu3_WTiM8aOwj2ayqdte7_luN6Imt03wWkhkK5uY,22844
-souJpg_comm-1.2.8.dist-info/METADATA,sha256=DBw1LDiiTFGAXnCBwkXBI8o4fGwjjO1CxTFVsnCSS-A,334
-souJpg_comm-1.2.8.dist-info/WHEEL,sha256=G16H4A3IeoQmnOrYV4ueZGKSjhipXx8zc8nu9FGlvMA,92
-souJpg_comm-1.2.8.dist-info/top_level.txt,sha256=pfOQRG1ECW8irsyGTyFOJxdejDSy3IufYfr8R2RHd1c,7
-souJpg_comm-1.2.8.dist-info/RECORD,,
+souJpg_comm-1.2.9.dist-info/METADATA,sha256=jBm54Ig3dgziEX5ZyRrZ31wMsFWp2FjkyVQTNfM_wKY,334
+souJpg_comm-1.2.9.dist-info/WHEEL,sha256=G16H4A3IeoQmnOrYV4ueZGKSjhipXx8zc8nu9FGlvMA,92
+souJpg_comm-1.2.9.dist-info/top_level.txt,sha256=pfOQRG1ECW8irsyGTyFOJxdejDSy3IufYfr8R2RHd1c,7
+souJpg_comm-1.2.9.dist-info/RECORD,,
```

