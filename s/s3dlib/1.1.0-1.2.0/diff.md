# Comparing `tmp/s3dlib-1.1.0.tar.gz` & `tmp/s3dlib-1.2.0.tar.gz`

## Comparing `s3dlib-1.1.0.tar` & `s3dlib-1.2.0.tar`

### file list

```diff
@@ -1,8 +1,8 @@
--rw-r--r--   0        0        0       21 2020-02-02 00:00:00.000000 s3dlib-1.1.0/src/s3dlib/__init__.py
--rw-r--r--   0        0        0    29077 2020-02-02 00:00:00.000000 s3dlib-1.1.0/src/s3dlib/cmap_utilities.py
--rw-r--r--   0        0        0    15498 2020-02-02 00:00:00.000000 s3dlib-1.1.0/src/s3dlib/cmap_xtra.py
--rw-r--r--   0        0        0   331538 2020-02-02 00:00:00.000000 s3dlib-1.1.0/src/s3dlib/surface.py
--rw-r--r--   0        0        0     1098 2020-02-02 00:00:00.000000 s3dlib-1.1.0/LICENSE
--rw-r--r--   0        0        0      718 2020-02-02 00:00:00.000000 s3dlib-1.1.0/README.md
--rw-r--r--   0        0        0     1097 2020-02-02 00:00:00.000000 s3dlib-1.1.0/pyproject.toml
--rw-r--r--   0        0        0     1761 2020-02-02 00:00:00.000000 s3dlib-1.1.0/PKG-INFO
+-rw-r--r--   0        0        0       21 2020-02-02 00:00:00.000000 s3dlib-1.2.0/src/s3dlib/__init__.py
+-rw-r--r--   0        0        0    30035 2020-02-02 00:00:00.000000 s3dlib-1.2.0/src/s3dlib/cmap_utilities.py
+-rw-r--r--   0        0        0    17419 2020-02-02 00:00:00.000000 s3dlib-1.2.0/src/s3dlib/cmap_xtra.py
+-rw-r--r--   0        0        0   355591 2020-02-02 00:00:00.000000 s3dlib-1.2.0/src/s3dlib/surface.py
+-rw-r--r--   0        0        0     1098 2020-02-02 00:00:00.000000 s3dlib-1.2.0/LICENSE
+-rw-r--r--   0        0        0      718 2020-02-02 00:00:00.000000 s3dlib-1.2.0/README.md
+-rw-r--r--   0        0        0     1359 2020-02-02 00:00:00.000000 s3dlib-1.2.0/pyproject.toml
+-rw-r--r--   0        0        0     1993 2020-02-02 00:00:00.000000 s3dlib-1.2.0/PKG-INFO
```

### Comparing `s3dlib-1.1.0/src/s3dlib/cmap_utilities.py` & `s3dlib-1.2.0/src/s3dlib/cmap_utilities.py`

 * *Files 13% similar despite different names*

```diff
@@ -12,25 +12,18 @@
 
 import string 
 import random
 import copy
 
 import numpy as np
 
-from matplotlib import cm, colors
+import matplotlib as mpl
+from matplotlib import colors     # update for v_1.2.0
 from matplotlib.colors import ListedColormap, LinearSegmentedColormap
 
-# +---------------------------------------------------------+
-# |  NOTE: depricated from 3.6:                             |
-# |            matplotlib.cm.get(name)                      |
-# |        to  matplotlib.colormaps[name]                   |
-# |  Note: depricated from 3.6:                             |
-# |            matplotlib.cm.register_cmap(name)            |
-# |        to  matplotlib.colormaps.register(name)          |
-# +---------------------------------------------------------+
 
 def rgb_cmap_gradient(lowColor='k', highColor='w', name=None, mirrored=False) :
     """
     A linear-in-RGB-space Colormap.
 
     Parameters
     ----------
@@ -69,15 +62,15 @@
     if not colors.is_color_like(highColor) :
         raise ValueError('Invalid posColor argument: ' + str(highColor))
     
     clist = [lowColor,highColor]
     if mirrored : clist = [lowColor,highColor,lowColor]
     cmap = LinearSegmentedColormap.from_list(call_name, clist )
     if name is not None :
-        cm.register_cmap(name,cmap)
+        mpl.colormaps.register(cmap,name=name)     # update for v_1.2.0
     return cmap
 
 def _smoothHue(lowHue,hiHue,eps,numbSegs) :
     # return an array (lenght of numbSegs) of 'smoothed' hue values from low to high
     #-----------------------------------------------------
     def _transformHue(x,eps) :
         # ....................................
@@ -142,15 +135,15 @@
     -------
     ListedColormap
         An instance of a colormap.
     """
     # ............................................................
     def stringToHSV(sVal) :
         addOne = False
-        if sVal[0] is '+':
+        if sVal[0] == '+':
             addOne = True
             sVal = sVal[1:]
         h,s,v = colors.rgb_to_hsv(colors.to_rgb(sVal))
         if addOne : h += 1
         return [h,s,v]    
     # ............................................................
     if not isinstance(mirrored, bool ) :
@@ -183,24 +176,24 @@
     clist = []
     for i in range( len(x)):
         n = x[i]
         h,s,v,a = np.add(lowColor, np.multiply(delta,n) )
         if smooth is None :
             h = np.mod(h, 1)
         else: h = hH[i]
-        r,g,b = cm.mpl.colors.hsv_to_rgb([h,s,v])
+        r,g,b = colors.hsv_to_rgb([h,s,v])     # update for v_1.2.0
         clist.append([r,g,b,a])  
     cmap = ListedColormap(clist)
     if mirrored :
         cmap = mirrored_cmap( cmap, name=name )
         return cmap # already registered
     
     if name is None :
         name = ''.join(random.choices(string.ascii_uppercase , k = 8))
-    cm.register_cmap(name,cmap)
+    mpl.colormaps.register(cmap,name=name)     # update for v_1.2.0
     cmap.name = name
         
     return cmap
 
 def binary_cmap(negColor='b', posColor='r', name=None, bndry=None ) :
     """
     A two-color Colormap.
@@ -242,15 +235,15 @@
         colorArr = np.array([colors.to_rgba(posColor)]*256)
         division = int(bndry*256)
         colorArr[:division, :] = np.array(colors.to_rgba(negColor))
         cmap = ListedColormap(colorArr)
 
     if name is None :
         name = ''.join(random.choices(string.ascii_uppercase , k = 8))
-    cm.register_cmap(name,cmap)
+    mpl.colormaps.register(cmap,name=name)     # update for v_1.2.0
     cmap.name = name
     return cmap
 
 def hue_cmap(lowHue=0, hiHue=None, smooth=1.6, name=None ) :
     """
     A 'smooth-HSV' colormap.
     
@@ -287,18 +280,18 @@
     -------
     ListedColormap
         An instance of a colormap.       
     """
     # ............................................................
     def stringToHue(sVal) :
         addOne = False
-        if sVal[0] is '+':
+        if sVal[0] == '+':
             addOne = True
             sVal = sVal[1:]
-        h,s,v = colors.rgb_to_hsv(colors.to_rgb(sVal))
+        h,_,_ = colors.rgb_to_hsv(colors.to_rgb(sVal))
         if addOne : h += 1
         return h    
     # ............................................................
     if (smooth<0.1 or smooth>10) :
         raise ValueError('smooth must be between 0.1 and 10. , found {}'.format(smooth))
 
     if isinstance(lowHue, str ): lowHue= stringToHue(lowHue)
@@ -317,20 +310,21 @@
         h = np.add(lowHue, np.multiply(delta,x) )
         h = np.mod(h,1)
     else :
         h = _smoothHue(lowHue,hiHue,smooth,256)
 
     one = np.ones(len(h))
     hsv = np.transpose([h,one,one])
-    rgb = cm.mpl.colors.hsv_to_rgb(hsv)
+    #rgb = cm.mpl.colors.hsv_to_rgb(hsv)
+    rgb = colors.hsv_to_rgb(hsv)     # update for v_1.2.0
     cmap = colors.ListedColormap(rgb)
 
     if name is None :
         name = ''.join(random.choices(string.ascii_uppercase , k = 8))
-    cm.register_cmap(name,cmap)
+    mpl.colormaps.register(cmap,name=name)     # update for v_1.2.0
     cmap.name = name
 
     return cmap
 
 def stitch_cmap( *maps, bndry=None, name=None) :
     """
     Colormap composed of multiple colormaps.
@@ -369,34 +363,34 @@
         if isinstance(bndry, float) : bndry = [bndry]
         numbBndry = len(bndry)
         if numbBndry != (numbMaps-1) :
             strgMsg = 'Number of boundaries, {}, is NOT equal to one less that the number of maps, {}. '
             raise ValueError(strgMsg.format(numbBndry,numbMaps))
     bndry.append(1.0)
 
-    colormaps = []
+    cmapList = []
     for cmap in maps :
-        if isinstance(cmap,str) : cmap = cm.get_cmap(cmap)  
-        colormaps.append(cmap)
+        if isinstance(cmap,str) : cmap = mpl.colormaps[cmap]     # update for v_1.2.0
+        cmapList.append(cmap)
 
     N = 256
     Nbndry = np.subtract(np.multiply(bndry,N),1)
     mapIndex, colorIndexStart = 0, 0
     clist = []
     for i in range(N) :
         if i > Nbndry[mapIndex] : 
             mapIndex += 1
             colorIndexStart = i
         d = 1/(Nbndry[mapIndex]-colorIndexStart)
         index = d*(i-colorIndexStart)
-        clist.append( colormaps[mapIndex](index) )
+        clist.append( cmapList[mapIndex](index) )
     cmap = ListedColormap(clist)
     if name is None :
         name = ''.join(random.choices(string.ascii_uppercase , k = 8))
-    cm.register_cmap(name,cmap)
+    mpl.colormaps.register(cmap,name=name)     # update for v_1.2.0
     cmap.name = name
     return cmap
 
 def stitch_color(*colorArr, bndry=None, name=None ) :
     """
     Colormap composed of multiple colors.
 
@@ -442,15 +436,15 @@
     N=256
     bIndx = [ int(N*b) for b in bndry ]
     RGBA = np.tile(RGBAvals[0],(N,1))
     for i,bI in enumerate(bIndx) : RGBA[bI:] = RGBAvals[i+1]
     cmap = ListedColormap(RGBA)
     if name is None :
         name = ''.join(random.choices(string.ascii_uppercase , k = 8))
-    cm.register_cmap(name,cmap)
+    mpl.colormaps.register(cmap,name=name)     # update for v_1.2.0
     cmap.name = name
 
     return cmap
 
 def alpha_cmap( cmap, alpha, constant=False, name=None )  :
     """
     Set the Colormap alpha channel.
@@ -480,33 +474,34 @@
         An instance of a colormap.
     """
 
     if alpha<0.0 or alpha>1.0 :
         raise ValueError('alpha must be between 0 and 1, found {}'.format(alpha))       
     
     if isinstance(cmap,str) : 
-        cmap = cm.get_cmap(cmap)
+        cmap = mpl.colormaps[cmap]      # update for v_1.2.0
     if name is None :
         name = cmap.name + '_a'
 
     if isinstance(cmap,LinearSegmentedColormap) :
         # LinearSegmentedColormap ...
         cdict = copy.copy(cmap._segmentdata)
         cdict['alpha'] = [ (0.0, alpha,alpha),(1.0, alpha,alpha) ]
-        cm.register_cmap(name, data=cdict)
-        newCmap = cm.get_cmap(name)
+        newCmap = LinearSegmentedColormap(name,cdict)
+        mpl.colormaps.register(newCmap,name=name)     # update for v_1.2.0
+
     else :
         # ListedColormap ............
         colorArr = copy.copy(cmap.colors)
         if not constant : 
             colorArr = np.array(colorArr)
             if colorArr.shape[1] == 4 : alpha = alpha*colorArr[:,3]
         colorArr = np.insert(colorArr,3,alpha,axis=1)[:,:4]
         newCmap = ListedColormap(colorArr,name)
-        cm.register_cmap(name,newCmap)
+        mpl.colormaps.register(newCmap,name=name)     # update for v_1.2.0
     return newCmap
 
 def mirrored_cmap( cmap, name=None, rev=False) :
     """ A mirrored colormap.
     
     Parameters
     ----------
@@ -518,27 +513,27 @@
         If None, '_m' will be appended to the colormap name.
     
     rev : boolean {True, False}, default: False
         If True, the reversed colormap will be used.
 
     """  
     if isinstance(cmap,str) : 
-        cmap = cm.get_cmap(cmap)
+        cmap = mpl.colormaps[cmap]     # update for v_1.2.0
     if name is None :
         name = cmap.name + '_m'
         if rev : name += 'r'
 
     numbSegs = 256
     x = np.linspace(0.0,1.0,num=numbSegs)
     n = 1-abs( 2.0*x - 1.0 )
     if rev : n = 1-n
     clist =cmap(n)
     cmap = ListedColormap(clist)
    
-    cm.register_cmap(name,cmap)
+    mpl.colormaps.register(cmap,name=name)     # update for v_1.2.0
     cmap.name = name
     return cmap
 
 def reversed_cmap( cmap, name=None ) :
     """
     A reversed colormap.
     
@@ -551,22 +546,34 @@
         The registered name to identify the colormap.
         If None, '_r' will be appended to the colormap name.
     
     """
 
     # for convenience to eliminate need for extra import.
     # Basically, same as Matplot colors.Colormap .reversed() method
+    
+    current_name = None
+
     if isinstance(cmap,str) : 
-        cmap = cm.get_cmap(cmap)    
+        current_name = cmap
+        cmap = mpl.colormaps[cmap]     # update for v_1.2.0
+    else:
+        current_name = cmap.name
+
+    # determine if revered cmap already exists.
+    new_name = current_name + '_r'
+    if name is not None : new_name = name
+    try:
+        cmap = mpl.colormaps[new_name]
+        return cmap
+    except : pass
+
     cmap = cmap.reversed()
-    if name is None :
-        name = cmap.name  # note: reverse returns name + '_r'
-    
-    cm.register_cmap(name,cmap)
-    cmap.name = name
+    mpl.colormaps.register(cmap,name=new_name)     # update for v_1.2.0
+    cmap.name = new_name
     return cmap
 
 def op_cmap(operation,rgb=True,name=None):
     """
     A Colormap defined by a function argument.
 
     Parameters
@@ -607,28 +614,30 @@
         return name
     # ----------------------------------------
     name = getFunctionName(operation,name)
     numbSegs = 256
     x = np.linspace(0.0,1.0,num=numbSegs)
     clist = operation(x)    
     clist = np.array(clist).T
-    hasAlpha = clist.shape[1] is 4
+    hasAlpha = clist.shape[1] == 4
     if not rgb :
         if hasAlpha :
             alp = clist[:,[3]]
             clist = clist[:,[0,1,2]]
-            clist = cm.colors.hsv_to_rgb(clist)
+            #clist = cm.colors.hsv_to_rgb(clist)
+            clist = colors.hsv_to_rgb(clist)     # update for v_1.2.0
             clist = np.append(clist,alp,1)
         else :
-            clist = cm.colors.hsv_to_rgb(clist)      
+            #clist = cm.colors.hsv_to_rgb(clist)      
+            clist = colors.hsv_to_rgb(clist)     # update for v_1.2.0
     
     cmap = ListedColormap(clist)
     if name is None :
         name = ''.join(random.choices(string.ascii_uppercase , k = 8))
-    cm.register_cmap(name,cmap)
+    mpl.colormaps.register(cmap,name=name)     # update for v_1.2.0
     cmap.name = name
     
     return cmap
 
 def op_alpha_cmap(cmap,operation,fit=True,name=None):
     """
     A Colormap modified by functional values of alpha.
@@ -677,26 +686,26 @@
     # ----------------------------------------
     def fitBounds(x) :
         mV,xV = np.amin(x),np.amax(x)
         return (x - mV)/(xV - mV)
     # ----------------------------------------
     name = getFunctionName(operation,name)
     if isinstance(cmap,str) : 
-        cmap = cm.get_cmap(cmap)
+        cmap = mpl.colormaps[cmap]    # update for v_1.2.0
     if name is None :
         name = cmap.name + '_a'
 
     numbSegs = 256
     x = np.linspace(0.0,1.0,num=numbSegs)
     alphalist = operation(x)    
     if fit : alphalist = fitBounds(alphalist)
     colorList = cmap(x).T
     colorList[3:] = alphalist
     newCmap = ListedColormap(colorList.T, name=name)
-    cm.register_cmap(name,newCmap)
+    mpl.colormaps.register(newCmap,name=name)     # update for v_1.2.0
     return newCmap
 
 def section_cmap(cmap,lowIndx,hiIndx,name=None) :
     """
     A Colormap from a section of a colormap.
 
     Parameters
@@ -721,29 +730,32 @@
     -------
     ListedColormap
         An instance of a colormap.
    
     """
 
     # ------------------------------------------------
-    def opFunc(t) : 
-        return cm.get_cmap(cmap)(lowIndx + (hiIndx-lowIndx)*t).T
+    def opFunc(t,cmap) :      # update for v_1.2.0
+        return mpl.colormaps.get_cmap(cmap)(lowIndx + (hiIndx-lowIndx)*t).T     # update for v_1.2.0
     # ------------------------------------------------
 
     if ( lowIndx <0.0 or lowIndx >0.97) :
         raise ValueError('Error: required that 0.0 <= lowIndx <= 0.97. , found {}'.format(lowIndx))
     if ( hiIndx <0.03 or hiIndx >1.0) :
         raise ValueError('Error: required that 0.03 <= hiIndx <= 1.0. , found {}'.format(hiIndx))
     indxRng = hiIndx-lowIndx
     if indxRng < 0.05 :    
         raise ValueError('Error: range of lowIndx to hiIndex is > 0.1 , found {}'.format(indxRng))
 
     if name is None : 
         name = ''.join(random.choices(string.ascii_uppercase , k = 8))
-    return op_cmap(opFunc,name=name)
+    if isinstance(cmap,str) : 
+        cmap = mpl.colormaps[cmap]     # update for v_1.2.0
+    op_lFunc = lambda t : opFunc(t,cmap)        # update for v_1.2.0 
+    return op_cmap(op_lFunc,name=name)     # update for v_1.2.0
 
 
 
 class DualCmap() :
     
     def __init__(self,xcmap,ycmap,kind='sum',norm=True,name=None) :
         """
@@ -761,18 +773,19 @@
         norm : bool, optional, default True
             Normalize array values in __call__
 
         name : string,optional.
             name to identify the dual colormap.
         """
         # FutDev: possible blend color modes?
+        #         Need documentation explaination for 'kind'.
 
         self._name = name if name is not None else ''
-        if isinstance(xcmap,str) : xcmap = cm.get_cmap(xcmap)
-        if isinstance(ycmap,str) : ycmap = cm.get_cmap(ycmap)
+        if isinstance(xcmap,str) : xcmap = mpl.colormaps[xcmap]     # update for v_1.2.0
+        if isinstance(ycmap,str) : ycmap = mpl.colormaps[ycmap]     # update for v_1.2.0
 
         self.xmap = xcmap
         self.ymap = ycmap
         self._kind = kind
         self._norm = norm
         self.pow = 0.5 
         if isinstance(kind,(int,float)): self.distfact(kind)
@@ -855,10 +868,10 @@
             raise ValueError('distfact {} must be between 0.2 and 4.0'.format(str(p)))
         self.pow = p
         self._kind = 'pwr'
         return self
 
 
 # =================================================================================+
-# DevNote : would be nice to have a function to create a 2D colorbar which could   |
-#           be added to the Matplotlib 3D Axes.                                    |
+# FutDev : would be nice to have a function to create a 2D colorbar which could    |
+#          be added to the Matplotlib 3D Axes.                                     |
 # =================================================================================+
```

### Comparing `s3dlib-1.1.0/src/s3dlib/cmap_xtra.py` & `s3dlib-1.2.0/src/s3dlib/cmap_xtra.py`

 * *Files 6% similar despite different names*

```diff
@@ -1,31 +1,27 @@
 # Copyright (C) Frank Zaverl, Jr.
 # See file LICENSE for license information.
 
 '''
 Auxiliary functions for use with Matplotlib.
 
 '''
+# These functions use the colorspacious module for
+# creating Lab color space colormaps.
+
 import string 
 import random
 import numpy as np
 
-from matplotlib import cm, colors
+import matplotlib as mpl
+from matplotlib import cm,colors     # update for v_1.2.0
 from matplotlib.colors import ListedColormap
-
 from colorspacious import cspace_converter
 
-# +---------------------------------------------------------+
-# |  NOTE: depricated from 3.6:                             |
-# |            matplotlib.cm.get(name)                      |
-# |        to  matplotlib.colormaps[name]                   |
-# |  Note: depricated from 3.6:                             |
-# |            matplotlib.cm.register_cmap(name)            |
-# |        to  matplotlib.colormaps.register(name)          |
-# +---------------------------------------------------------+
+import s3dlib.cmap_utilities as cmu
 
 def Lab_cmap_gradient(lowColor='k', highColor='w', name=None, mirrored=False) :
     """
     A linear-in-Lab-space Colormap, with option of registering the map.
 
     Parameters
     ----------
@@ -85,15 +81,15 @@
         rgb = cspace_converter("CAM02-UCS", "sRGB1")(lab)
         rgb = np.clip(rgb,0,1)
         rgba = np.append(rgb,alf)
         clist.append(rgba)  
     cmap = ListedColormap(clist)
     if name is None :
         name = ''.join(random.choices(string.ascii_uppercase , k = 8))
-    cm.register_cmap(name,cmap)
+    mpl.colormaps.register(cmap,name=name)     # update for v_1.2.0
     cmap.name = name
     return cmap
 
 
 def Hue_Lab_gradient( color, lowL=0.0, hiL=1.0, name=None ) :
     """
     A linear-in-Lab-space Colormap with a constant hue, with option of registering the map.
@@ -118,27 +114,27 @@
     ListedColormap
         An instance of a colormap.
     """
     # ...............................................................
     def get_arrays(hue,N) :
         hsv_0 = np.array([hue,1.0,1.0])
         rgb_0 = np.array(colors.hsv_to_rgb(hsv_0.T)).T
-        L_0,a,b = cspace_converter("sRGB1", "CAM02-UCS"  )(rgb_0.T).T
+        L_0,_,_ = cspace_converter("sRGB1", "CAM02-UCS"  )(rgb_0.T).T
         L_0 = L_0/100.0
         L = np.linspace(0.0,1.0,N)
         endS = (1.0 -L)/(1.0 - L_0)
         sttV = L/L_0
         ones = np.ones(len(L))
         L0vals = np.full(len(L),L_0)
         H = np.full(len(L),hue)
         S = np.where( L>L0vals, endS, ones )
         V = np.where( L>L0vals, ones, sttV )
         hsv = np.array( [H,S,V] )
         rgb = np.array(colors.hsv_to_rgb(hsv.T)).T
-        Lact,a,b = cspace_converter("sRGB1", "CAM02-UCS"  )(rgb.T).T
+        Lact,_,_ = cspace_converter("sRGB1", "CAM02-UCS"  )(rgb.T).T
         Lact = Lact/100.0
         Lact[0]=0.0
         Lact[len(Lact)-1] = 1.000001
         return Lact,S,V
     # ...............................................................
     def linIntrp(xVal,xArr,yArr) :
         i = np.where(xArr>xVal)[0][0]
@@ -146,18 +142,18 @@
         y0,y1 = yArr[i-1], yArr[i]
         m = (y1-y0)/(x1-x0)
         yVal = (xVal-x0)*m + y0
         return yVal
     # ...............................................................
 
     if isinstance(color, str ): 
-        hue,s,v = colors.rgb_to_hsv(colors.to_rgb(color))
+        hue,_,_ = colors.rgb_to_hsv(colors.to_rgb(color))
         if name is None : name = color+'_L'
     elif isinstance(color,(list,tuple)) :
-        hue,s,v = colors.rgb_to_hsv(colors.to_rgb(color))
+        hue,_,_ = colors.rgb_to_hsv(colors.to_rgb(color))
     else :
         hue = color
         if hue<0.0 or hue>1.0 :
             raise ValueError('Error: required that 0.0 <= hue <= 1.0. , found {}'.format(hue))
 
     Lval,Sval,Vval = get_arrays(hue,100)
 
@@ -169,20 +165,20 @@
     hsv = np.array( [H,S,V] )
     rgb = np.array(colors.hsv_to_rgb(hsv.T)).T
     rgba = np.vstack( (rgb, np.ones(len(L)) ) ).T
 
     cmap = ListedColormap(rgba)
     if name is None :
         name = ''.join(random.choices(string.ascii_uppercase , k = 8))
-    cm.register_cmap(name,cmap)
+    mpl.colormaps.register(cmap,name=name)     # update for v_1.2.0
     cmap.name = name
     return cmap
 
 
-def Cmap_Lab_gradient( cmap, lowL=0.0, hiL=1.0, name=None ) :
+def _Cmap_Lab_gradient( cmap, lowL=0.0, hiL=1.0, name=None ) :
     """
     A linear-in-Lab-space Colormap with a hue matched to cmap and maximum saturation.
     
     Parameters
     ----------
     cmap : colormap
 
@@ -235,15 +231,15 @@
         x0,x1 = xArr[i-1], xArr[i]
         y0,y1 = yArr[i-1], yArr[i]
         m = (y1-y0)/(x1-x0)
         yVal = (xVal-x0)*m + y0
         return yVal
     # ...............................................................
     if isinstance(cmap,str) : 
-        cmap = cm.get_cmap(cmap)
+        cmap = mpl.colormaps[cmap]      # update for v_1.2.0
     if name is None :
         name = cmap.name + '_L'
 
     Lval,aval,bval = get_arrays(cmap,lowL,hiL,100)
 
     N=256
     L = np.linspace(lowL,hiL,N)
@@ -252,19 +248,80 @@
     lab = np.array( [100*L,a,b]).T
     rgb = cspace_converter("CAM02-UCS", "sRGB1")(lab)
     rgba = np.vstack( (rgb.T, np.ones(len(L)) ) ).T
     rgba = np.clip(rgba, 0.0,1.0)
     cmap = ListedColormap(rgba)
     if name is None :
         name = ''.join(random.choices(string.ascii_uppercase , k = 8))
-    cm.register_cmap(name,cmap)
+    mpl.colormaps.register(cmap,name=name)     # update for v_1.2.0
     cmap.name = name
     return cmap
 
 
+def Cmap_Lab_gradient(cmap, lowL=None, hiL=None, name=None) :
+    """
+    A linear-in-Lab-space Colormap with a hue matched to cmap at maximum saturation.
+    
+    Parameters
+    ----------
+    cmap : colormap
+
+    lowL : number, optional, default: cmap min L* @ boundaries
+        The minimum L* lightness value in range 0 to <1
+
+    hiL  : number, optional, default: cmap max L* @ boundaries
+        The maximum L* lightness value in range >0 to 1.
+
+    name : str, optional, default: None
+        The registered name to identify the colormap.
+        If None, ‘_L’ will be appended to the colormap name.
+
+    Returns
+    -------
+    ListedColormap
+        An instance of a colormap.
+    """
+    
+    # DevNote: easier to just call the previous version of this function
+    # with reset defaults than to edit the previous function.
+
+    if isinstance(cmap,str) : 
+        cmap = mpl.colormaps[cmap]      # update for v_1.2.0
+
+    if lowL is None:
+        strRGB = cm.colors.to_rgb(cmap(0.0))
+        strLab = cspace_converter("sRGB1", "CAM02-UCS"  )(strRGB)
+        sLab = strLab[0]/100
+    else : sLab = 0.0
+
+    if hiL is None :
+        endRGB = cm.colors.to_rgb(cmap(1.0))
+        endLab = cspace_converter("sRGB1", "CAM02-UCS"  )(endRGB)
+        eLab = endLab[0]/100
+    else :  eLab = 1.0
+
+    if name is None :
+        name = cmap.name + '_L'
+
+    if sLab>eLab :   # then L* decrease from start to finish.
+        sLab, eLab = eLab, sLab
+        # don't want to auto-register the colormap name, use a tempName
+        # that's random so not to register an already given name.
+        tempName = ''.join(random.choices(string.ascii_uppercase , k=8))
+        cmap = cmu.reversed_cmap(cmap,name=tempName)
+        cmap = _Cmap_Lab_gradient(cmap, lowL=sLab, hiL=eLab)
+        newCmap = cmu.reversed_cmap(cmap,name=name)
+    else :
+        newCmap = _Cmap_Lab_gradient(cmap, lowL=sLab, hiL=eLab, name=name)
+    return newCmap
+
+
+
+
+
 def show_cmaps( plt, cmaps, onlyColormaps=True, show=True) :
     """
     Construct and show Matplotlib figures of colormaps.
     
     Parameters
     ----------
     plt : matplotlib.pyplot
@@ -321,22 +378,22 @@
                 else :
                     top = cmap(j/wdim)
                 X[i,j] = over_color(bottom, top)
         ax.imshow(X, aspect='auto')
         return
     # ...................................................................
     def hasTransparency(cmap) :
-        if isinstance(cmap,str) : cmap = cm.get_cmap(cmap)
+        if isinstance(cmap,str) : cmap = mpl.colormaps[cmap]      # update for v_1.2.0
         N = 256
         alpha = cmap(np.linspace(0, 1, N))[:,3:4]
         return np.any( np.where(alpha<1,True,False) )
     # ...................................................................
     def Lstar(cmap) :
         # x,y arrays for ploting L* of a colormap.
-        if isinstance(cmap,str) : cmap = cm.get_cmap(cmap)
+        if isinstance(cmap,str) : cmap = mpl.colormaps[cmap]      # update for v_1.2.0
         N = 256
         rgb = cmap(np.linspace(0, 1, N))[:,0:3]
         lab = cspace_converter("sRGB1", "CAM02-UCS")(rgb)        
         L = np.transpose(lab)[0]
         x = np.linspace(0, 1, N)
         return x,L,cmap.name
 
@@ -353,15 +410,15 @@
         ax.set_yticks([])
 
     grad = np.linspace(0, 1, 256)
     grad = np.vstack((grad, grad))
     for i in range(len(cmaps)):
         ax = axes[i]
         cmap=cmaps[i]
-        if isinstance(cmap,str) : cmap = cm.get_cmap(cmap)
+        if isinstance(cmap,str) : cmap = mpl.colormaps[cmap]      # update for v_1.2.0
         if hasTransparency(cmap) :
             show_trans_cmap(ax,cmap)
         else :
             ax.imshow(grad, aspect='auto', cmap=cmap)
         pos = list(ax.get_position().bounds)
         x_text = pos[0] - 0.01
         y_text = pos[1] + pos[3]/2.
@@ -377,15 +434,15 @@
         if numb==1 : axes = [axes]
         for ax in axes :
             ax.set_xticks([])
             ax.set_yticks([])
 
         for i in range(len(cmaps)):
             cmap = cmaps[i]
-            if isinstance(cmap,str) : cmap = cm.get_cmap(cmap)
+            if isinstance(cmap,str) : cmap = mpl.colormaps[cmap]      # update for v_1.2.0
             x,y,name = Lstar(cmap)
             grad =  np.float32(np.vstack((y, y)))
             ax = axes[i]
             if hasTransparency(cmap) :
                 show_trans_cmap(ax,cmap,y)
             else :
                 ax.imshow(grad, aspect='auto', cmap='binary_r', vmin=0., vmax=100.)
```

#### encoding

```diff
@@ -1 +1 @@
-us-ascii
+utf-8
```

### Comparing `s3dlib-1.1.0/src/s3dlib/surface.py` & `s3dlib-1.2.0/src/s3dlib/surface.py`

 * *Files 2% similar despite different names*

```diff
@@ -11,20712 +11,22215 @@
 000000a0: 726f 6d20 6675 6e63 746f 6f6c 7320 696d  rom functools im
 000000b0: 706f 7274 2072 6564 7563 650d 0a23 6672  port reduce..#fr
 000000c0: 6f6d 2074 696d 6520 696d 706f 7274 2074  om time import t
 000000d0: 696d 650d 0a0d 0a69 6d70 6f72 7420 6e75  ime....import nu
 000000e0: 6d70 7920 6173 206e 700d 0a66 726f 6d20  mpy as np..from 
 000000f0: 7363 6970 7920 696d 706f 7274 2069 6e74  scipy import int
 00000100: 6572 706f 6c61 7465 2c20 7370 6174 6961  erpolate, spatia
-00000110: 6c0d 0a0d 0a23 696d 706f 7274 206d 6174  l....#import mat
-00000120: 706c 6f74 6c69 6220 6173 206d 706c 0d0a  plotlib as mpl..
-00000130: 6672 6f6d 206d 6174 706c 6f74 6c69 6220  from matplotlib 
-00000140: 696d 706f 7274 2063 6d2c 2063 6f6c 6f72  import cm, color
-00000150: 732c 2069 6d61 6765 0d0a 6672 6f6d 206d  s, image..from m
-00000160: 706c 5f74 6f6f 6c6b 6974 732e 6d70 6c6f  pl_toolkits.mplo
-00000170: 7433 642e 6172 7433 6420 696d 706f 7274  t3d.art3d import
-00000180: 2050 6f6c 7933 4443 6f6c 6c65 6374 696f   Poly3DCollectio
-00000190: 6e2c 204c 696e 6533 4443 6f6c 6c65 6374  n, Line3DCollect
-000001a0: 696f 6e0d 0a0d 0a23 2e2e 2073 696d 706c  ion....#.. simpl
-000001b0: 6520 7761 726e 696e 6720 7374 7269 6e67  e warning string
-000001c0: 0d0a 7761 726e 696e 6773 2e66 6f72 6d61  ..warnings.forma
-000001d0: 7477 6172 6e69 6e67 203d 206c 616d 6264  twarning = lambd
-000001e0: 6120 6d2c 632c 6e2c 6c2c 6c69 6e65 3d30  a m,c,n,l,line=0
-000001f0: 203a 2073 7472 286d 292b 275c 6e27 0d0a   : str(m)+'\n'..
-00000200: 0d0a 5f4d 4158 5245 5a20 3d20 3820 2020  .._MAXREZ = 8   
-00000210: 2020 2020 2020 2023 2069 6e20 7375 6263         # in subc
-00000220: 6c61 7373 2073 7572 6661 6365 732c 206d  lass surfaces, m
-00000230: 6178 696d 756d 2072 6563 7572 7369 7665  aximum recursive
-00000240: 2074 7269 616e 6775 6c61 7469 6f6e 2e0d   triangulation..
-00000250: 0a5f 4d41 5850 4c52 455a 203d 2031 3020  ._MAXPLREZ = 10 
-00000260: 2020 2020 2020 2320 696e 2050 6172 616d        # in Param
-00000270: 6574 7269 634c 696e 6520 6c69 6e65 732c  etricLine lines,
-00000280: 206d 6178 696d 756d 2072 6563 7572 7369   maximum recursi
-00000290: 7665 2073 6567 6d65 6e74 6174 696f 6e2e  ve segmentation.
-000002a0: 0d0a 5f4d 494e 5241 4420 3d20 302e 3031  .._MINRAD = 0.01
-000002b0: 2020 2020 2020 2023 2069 6e20 7375 6263         # in subc
-000002c0: 6c61 7373 6564 2070 6f6c 6172 2061 6e64  lassed polar and
-000002d0: 2073 7068 6572 6963 616c 2073 7572 6661   spherical surfa
-000002e0: 6365 2073 706c 6974 2062 6173 6574 7970  ce split basetyp
-000002f0: 6573 2e0d 0a5f 5350 4c49 5453 495a 4520  es..._SPLITSIZE 
-00000300: 3d20 302e 3030 3031 2020 2320 666f 7220  = 0.0001  # for 
-00000310: 7370 6c69 7420 6772 6964 2067 656f 6d65  split grid geome
-00000320: 7472 6965 732c 2070 6869 206f 6666 7365  tries, phi offse
-00000330: 7420 6672 6f6d 2032 2a70 690d 0a0d 0a5f  t from 2*pi...._
-00000340: 434f 4f52 5f4b 5741 5247 5320 3d20 7b20  COOR_KWARGS = { 
-00000350: 2020 2020 2320 7573 6564 2066 6f72 2063      # used for c
-00000360: 6c69 7070 696e 6720 2620 636f 6e74 6f75  lipping & contou
-00000370: 7220 6c69 6e65 7320 616e 6420 6c69 6e65  r lines and line
-00000380: 2d66 696c 6c65 6420 7375 7266 6163 6573  -filled surfaces
-00000390: 0d0a 2020 2020 2763 6f6f 7227 3a20 5b20  ..    'coor': [ 
-000003a0: 5b30 5d2c 205b 302c 2027 706c 616e 6172  [0], [0, 'planar
-000003b0: 272c 2778 797a 272c 2770 272c 2750 275d  ','xyz','p','P']
-000003c0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-000003d0: 2020 2020 2020 5b31 2c20 2763 272c 2027        [1, 'c', '
-000003e0: 4327 2c20 2763 796c 696e 6465 7227 2c20  C', 'cylinder', 
-000003f0: 2027 6379 6c69 6e64 7269 6361 6c27 5d2c   'cylindrical'],
-00000400: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00000410: 2020 2020 205b 322c 2027 7327 2c20 2753       [2, 's', 'S
-00000420: 272c 2027 7370 6865 7265 272c 2027 7370  ', 'sphere', 'sp
-00000430: 6865 7269 6361 6c27 5d2c 0d0a 2020 2020  herical'],..    
-00000440: 2020 2020 2020 2020 2020 2020 2020 205b                 [
-00000450: 332c 2027 7827 2c20 2758 275d 2c0d 0a20  3, 'x', 'X'],.. 
-00000460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000470: 2020 5b34 2c20 2779 272c 2027 5927 5d2c    [4, 'y', 'Y'],
-00000480: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00000490: 2020 2020 205b 352c 2027 7a27 2c20 275a       [5, 'z', 'Z
-000004a0: 275d 205d 0d0a 7d0d 0a0d 0a5f 434f 4f52  '] ]..}...._COOR
-000004b0: 5359 5320 3d20 7b20 2258 595a 223a 2030  SYS = { "XYZ": 0
-000004c0: 2c20 2250 4f4c 4152 223a 2031 2c20 2243  , "POLAR": 1, "C
-000004d0: 594c 494e 4452 4943 414c 223a 2032 2c20  YLINDRICAL": 2, 
-000004e0: 2253 5048 4552 4943 414c 223a 2033 2c20  "SPHERICAL": 3, 
-000004f0: 224c 4f4e 474c 4154 223a 2034 207d 0d0a  "LONGLAT": 4 }..
-00000500: 0d0a 5f49 4c4c 554d 203d 2028 312c 302c  .._ILLUM = (1,0,
-00000510: 3129 2020 2320 6465 6661 756c 7420 6c69  1)  # default li
-00000520: 6768 7420 6469 7265 6374 696f 6e2c 2028  ght direction, (
-00000530: 636d 6170 5f6e 6f72 6d61 6c73 2c20 7368  cmap_normals, sh
-00000540: 6164 652c 2068 696c 6974 6520 2620 6c69  ade, hilite & li
-00000550: 6e65 2064 6972 6563 7469 6f6e 292e 0d0a  ne direction)...
-00000560: 5f44 4654 5f56 4c49 4d20 3d20 2020 2020  _DFT_VLIM =     
-00000570: 5b20 2d31 2e30 2c20 312e 3020 5d20 2020  [ -1.0, 1.0 ]   
-00000580: 2020 2020 2320 6465 6661 756c 7420 6661      # default fa
-00000590: 6365 2063 6f6c 6f72 2076 616c 7565 2062  ce color value b
-000005a0: 6f75 6e64 730d 0a5f 4446 545f 5645 5254  ounds.._DFT_VERT
-000005b0: 564c 494d 203d 205b 2020 302e 302c 2031  VLIM = [  0.0, 1
-000005c0: 2e30 205d 2020 2020 2020 2023 2064 6566  .0 ]       # def
-000005d0: 6175 6c74 2076 6563 746f 7220 6d61 676e  ault vector magn
-000005e0: 6974 7564 6520 7661 6c75 6520 626f 756e  itude value boun
-000005f0: 6473 0d0a 5f44 4654 5f41 4c52 203d 2030  ds.._DFT_ALR = 0
-00000600: 2e32 3520 2020 2320 6465 6661 756c 7420  .25   # default 
-00000610: 6178 6973 206c 656e 6774 6820 7261 7469  axis length rati
-00000620: 6f2c 2068 6561 6420 7369 7a65 2074 6f20  o, head size to 
-00000630: 7665 6374 6f72 206d 6167 6e69 7475 6465  vector magnitude
-00000640: 2e0d 0a5f 4446 545f 5649 4557 203d 205b  ..._DFT_VIEW = [
-00000650: 2020 3330 2c20 2d36 3020 5d20 2020 2020    30, -60 ]     
-00000660: 2020 2020 2020 2023 2064 6566 6175 6c74         # default
-00000670: 2c20 6178 6573 2065 6c65 7620 616e 6420  , axes elev and 
-00000680: 617a 696d 0d0a 0d0a 0d0a 2320 4675 7444  azim......# FutD
-00000690: 6576 3a20 4675 7475 7265 2044 6576 656c  ev: Future Devel
-000006a0: 6f70 6d65 6e74 206e 6f74 6573 2e0d 0a23  opment notes...#
-000006b0: 204d 524f 493a 2020 204d 696e 696d 756d   MROI:   Minimum
-000006c0: 2052 6574 7572 6e20 4f6e 2063 6f64 696e   Return On codin
-000006d0: 6720 6566 666f 7274 2049 6e76 6573 746d  g effort Investm
-000006e0: 656e 742e 0d0a 2320 2020 2020 2020 2020  ent...#         
-000006f0: 2874 6865 206a 7569 6365 2069 736e 2774  (the juice isn't
-00000700: 2077 6f72 7468 2074 6865 2073 7175 6565   worth the squee
-00000710: 7a65 2066 6f72 2063 7572 7265 6e74 2072  ze for current r
-00000720: 656c 6561 7365 290d 0a0d 0a23 202b 2d2d  elease)....# +--
+00000110: 6c0d 0a66 726f 6d20 736b 696d 6167 6520  l..from skimage 
+00000120: 696d 706f 7274 206d 6561 7375 7265 0d0a  import measure..
+00000130: 0d0a 6672 6f6d 206d 6174 706c 6f74 6c69  ..from matplotli
+00000140: 6220 696d 706f 7274 2063 6d2c 2063 6f6c  b import cm, col
+00000150: 6f72 732c 2069 6d61 6765 2c20 7472 690d  ors, image, tri.
+00000160: 0a66 726f 6d20 6d70 6c5f 746f 6f6c 6b69  .from mpl_toolki
+00000170: 7473 2e6d 706c 6f74 3364 2e61 7274 3364  ts.mplot3d.art3d
+00000180: 2069 6d70 6f72 7420 506f 6c79 3344 436f   import Poly3DCo
+00000190: 6c6c 6563 7469 6f6e 2c20 4c69 6e65 3344  llection, Line3D
+000001a0: 436f 6c6c 6563 7469 6f6e 0d0a 0d0a 232e  Collection....#.
+000001b0: 2e20 7369 6d70 6c65 2077 6172 6e69 6e67  . simple warning
+000001c0: 2073 7472 696e 670d 0a77 6172 6e69 6e67   string..warning
+000001d0: 732e 666f 726d 6174 7761 726e 696e 6720  s.formatwarning 
+000001e0: 3d20 6c61 6d62 6461 206d 2c63 2c6e 2c6c  = lambda m,c,n,l
+000001f0: 2c6c 696e 653d 3020 3a20 7374 7228 6d29  ,line=0 : str(m)
+00000200: 2b27 5c6e 270d 0a0d 0a5f 4d41 5852 455a  +'\n'...._MAXREZ
+00000210: 203d 2038 2020 2020 2020 2020 2020 2320   = 8          # 
+00000220: 696e 2073 7562 636c 6173 7320 7375 7266  in subclass surf
+00000230: 6163 6573 2c20 6d61 7869 6d75 6d20 7265  aces, maximum re
+00000240: 6375 7273 6976 6520 7472 6961 6e67 756c  cursive triangul
+00000250: 6174 696f 6e2e 0d0a 5f4d 4158 504c 5245  ation..._MAXPLRE
+00000260: 5a20 3d20 3130 2020 2020 2020 2023 2069  Z = 10       # i
+00000270: 6e20 5061 7261 6d65 7472 6963 4c69 6e65  n ParametricLine
+00000280: 206c 696e 6573 2c20 6d61 7869 6d75 6d20   lines, maximum 
+00000290: 7265 6375 7273 6976 6520 7365 676d 656e  recursive segmen
+000002a0: 7461 7469 6f6e 2e0d 0a5f 4d49 4e52 4144  tation..._MINRAD
+000002b0: 203d 2030 2e30 3120 2020 2020 2020 2320   = 0.01       # 
+000002c0: 696e 2073 7562 636c 6173 7365 6420 706f  in subclassed po
+000002d0: 6c61 7220 616e 6420 7370 6865 7269 6361  lar and spherica
+000002e0: 6c20 7375 7266 6163 6520 7370 6c69 7420  l surface split 
+000002f0: 6261 7365 7479 7065 732e 0d0a 5f53 504c  basetypes..._SPL
+00000300: 4954 5349 5a45 203d 2030 2e30 3030 3120  ITSIZE = 0.0001 
+00000310: 2023 2066 6f72 2073 706c 6974 2067 7269   # for split gri
+00000320: 6420 6765 6f6d 6574 7269 6573 2c20 7068  d geometries, ph
+00000330: 6920 6f66 6673 6574 2066 726f 6d20 322a  i offset from 2*
+00000340: 7069 0d0a 0d0a 5f43 4f4f 525f 4b57 4152  pi...._COOR_KWAR
+00000350: 4753 203d 207b 2020 2020 2023 2075 7365  GS = {     # use
+00000360: 6420 666f 7220 636c 6970 7069 6e67 2026  d for clipping &
+00000370: 2063 6f6e 746f 7572 206c 696e 6573 2061   contour lines a
+00000380: 6e64 206c 696e 652d 6669 6c6c 6564 2073  nd line-filled s
+00000390: 7572 6661 6365 730d 0a20 2020 2027 636f  urfaces..    'co
+000003a0: 6f72 273a 205b 205b 305d 2c20 5b30 2c20  or': [ [0], [0, 
+000003b0: 2770 6c61 6e61 7227 2c27 7879 7a27 2c27  'planar','xyz','
+000003c0: 7027 2c27 5027 5d2c 0d0a 2020 2020 2020  p','P'],..      
+000003d0: 2020 2020 2020 2020 2020 2020 205b 312c               [1,
+000003e0: 2027 6327 2c20 2743 272c 2027 6379 6c69   'c', 'C', 'cyli
+000003f0: 6e64 6572 272c 2020 2763 796c 696e 6472  nder',  'cylindr
+00000400: 6963 616c 275d 2c0d 0a20 2020 2020 2020  ical'],..       
+00000410: 2020 2020 2020 2020 2020 2020 5b32 2c20              [2, 
+00000420: 2773 272c 2027 5327 2c20 2773 7068 6572  's', 'S', 'spher
+00000430: 6527 2c20 2773 7068 6572 6963 616c 275d  e', 'spherical']
+00000440: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00000450: 2020 2020 2020 5b33 2c20 2778 272c 2027        [3, 'x', '
+00000460: 5827 5d2c 0d0a 2020 2020 2020 2020 2020  X'],..          
+00000470: 2020 2020 2020 2020 205b 342c 2027 7927           [4, 'y'
+00000480: 2c20 2759 275d 2c0d 0a20 2020 2020 2020  , 'Y'],..       
+00000490: 2020 2020 2020 2020 2020 2020 5b35 2c20              [5, 
+000004a0: 277a 272c 2027 5a27 5d20 5d0d 0a7d 0d0a  'z', 'Z'] ]..}..
+000004b0: 0d0a 5f43 4f4f 5253 5953 203d 207b 2022  .._COORSYS = { "
+000004c0: 5859 5a22 3a20 302c 2022 504f 4c41 5222  XYZ": 0, "POLAR"
+000004d0: 3a20 312c 2022 4359 4c49 4e44 5249 4341  : 1, "CYLINDRICA
+000004e0: 4c22 3a20 322c 2022 5350 4845 5249 4341  L": 2, "SPHERICA
+000004f0: 4c22 3a20 332c 2022 4c4f 4e47 4c41 5422  L": 3, "LONGLAT"
+00000500: 3a20 3420 7d0d 0a0d 0a5f 494c 4c55 4d20  : 4 }...._ILLUM 
+00000510: 3d20 2831 2c30 2c31 2920 2023 2064 6566  = (1,0,1)  # def
+00000520: 6175 6c74 206c 6967 6874 2064 6972 6563  ault light direc
+00000530: 7469 6f6e 2c20 2863 6d61 705f 6e6f 726d  tion, (cmap_norm
+00000540: 616c 732c 2073 6861 6465 2c20 6869 6c69  als, shade, hili
+00000550: 7465 2026 206c 696e 6520 6469 7265 6374  te & line direct
+00000560: 696f 6e29 2e0d 0a5f 4446 545f 564c 494d  ion)..._DFT_VLIM
+00000570: 203d 2020 2020 205b 202d 312e 302c 2031   =     [ -1.0, 1
+00000580: 2e30 205d 2020 2020 2020 2023 2064 6566  .0 ]       # def
+00000590: 6175 6c74 2066 6163 6520 636f 6c6f 7220  ault face color 
+000005a0: 7661 6c75 6520 626f 756e 6473 0d0a 5f44  value bounds.._D
+000005b0: 4654 5f56 4552 5456 4c49 4d20 3d20 5b20  FT_VERTVLIM = [ 
+000005c0: 2030 2e30 2c20 312e 3020 5d20 2020 2020   0.0, 1.0 ]     
+000005d0: 2020 2320 6465 6661 756c 7420 7665 6374    # default vect
+000005e0: 6f72 206d 6167 6e69 7475 6465 2076 616c  or magnitude val
+000005f0: 7565 2062 6f75 6e64 730d 0a5f 4446 545f  ue bounds.._DFT_
+00000600: 414c 5220 3d20 302e 3235 2020 2023 2064  ALR = 0.25   # d
+00000610: 6566 6175 6c74 2061 7869 7320 6c65 6e67  efault axis leng
+00000620: 7468 2072 6174 696f 2c20 6865 6164 2073  th ratio, head s
+00000630: 697a 6520 746f 2076 6563 746f 7220 6d61  ize to vector ma
+00000640: 676e 6974 7564 652e 0d0a 5f44 4654 5f56  gnitude..._DFT_V
+00000650: 4945 5720 3d20 5b20 2033 302c 202d 3630  IEW = [  30, -60
+00000660: 205d 2020 2020 2020 2020 2020 2020 2320   ]            # 
+00000670: 6465 6661 756c 742c 2061 7865 7320 656c  default, axes el
+00000680: 6576 2061 6e64 2061 7a69 6d0d 0a0d 0a0d  ev and azim.....
+00000690: 0a23 202b 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  .# +------------
+000006a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000006b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000006c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2b0d  --------------+.
+000006d0: 0a23 207c 2020 5323 446c 6962 2076 5f31  .# |  S#Dlib v_1
+000006e0: 2e32 2e30 2077 6173 2064 6576 656c 6f70  .2.0 was develop
+000006f0: 6564 2075 7369 6e67 204d 6174 706c 6f74  ed using Matplot
+00000700: 6c69 6220 765f 332e 382e 3020 2020 7c0d  lib v_3.8.0   |.
+00000710: 0a23 202b 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  .# +------------
+00000720: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
 00000730: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00000740: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00000750: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00000760: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00000770: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2b0d 0a23  ------------+..#
-00000780: 207c 2020 5468 6520 6375 7272 656e 7420   |  The current 
-00000790: 7665 7269 6f6e 206f 6620 7333 646c 6962  verion of s3dlib
-000007a0: 2077 6173 2064 6576 656c 6f70 6564 2075   was developed u
-000007b0: 7369 6e67 204d 6174 706c 6f74 6c69 6220  sing Matplotlib 
-000007c0: 7665 7273 696f 6e20 332e 302e 3220 2020  version 3.0.2   
-000007d0: 7c0d 0a23 207c 2020 4173 2061 2072 6573  |..# |  As a res
-000007e0: 756c 742c 2074 6865 2066 6f6c 6c6f 7769  ult, the followi
-000007f0: 6e67 204d 6174 706c 6f74 6c69 6220 3344  ng Matplotlib 3D
-00000800: 436f 6c6c 6563 7469 6f6e 2027 7072 6976  Collection 'priv
-00000810: 6174 6527 2070 726f 7065 7274 6965 7320  ate' properties 
-00000820: 2020 2020 7c0d 0a23 207c 2020 7765 7265      |..# |  were
-00000830: 206e 6565 6465 6420 666f 7220 6465 7665   needed for deve
-00000840: 6c6f 706d 656e 743a 2020 2020 2020 2020  lopment:        
-00000850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000870: 2020 2020 2020 2020 7c0d 0a23 207c 2020          |..# |  
-00000880: 2020 205f 6661 6365 636f 6c6f 7273 2c20     _facecolors, 
-00000890: 5f65 6467 6563 6f6c 6f72 732c 205f 6661  _edgecolors, _fa
-000008a0: 6365 636f 6c6f 7273 3364 2c20 5f65 6467  cecolors3d, _edg
-000008b0: 6563 6f6c 6f72 7333 4420 2020 2020 2020  ecolors3D       
-000008c0: 2020 2020 2020 2020 2020 2020 7c0d 0a23              |..#
-000008d0: 207c 2020 4e6f 7465 3a20 6675 7274 6865   |  Note: furthe
-000008e0: 7220 7665 7273 696f 6e73 206f 6620 4d61  r versions of Ma
-000008f0: 7470 6c6f 746c 6962 2069 6e63 6c75 6465  tplotlib include
-00000900: 206d 6574 686f 6473 3a20 2020 2020 2020   methods:       
-00000910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000920: 7c0d 0a23 207c 2020 2020 2067 6574 5f66  |..# |     get_f
-00000930: 6163 6563 6f6c 6f72 2829 202c 2020 2020  acecolor() ,    
-00000940: 2020 2067 6574 5f65 6467 6563 6f6c 6f72     get_edgecolor
-00000950: 2829 2020 2020 2020 2020 2020 2020 2020  ()              
-00000960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000970: 2020 2020 7c0d 0a23 207c 2020 5072 6976      |..# |  Priv
-00000980: 6174 6520 7072 6f70 6572 7469 6573 2074  ate properties t
-00000990: 6f20 6265 2072 656d 6f76 6564 2069 6e20  o be removed in 
-000009a0: 6675 7475 7265 2053 3344 6c69 6220 7665  future S3Dlib ve
-000009b0: 7273 696f 6e73 2c20 4d52 4f49 2e20 2020  rsions, MROI.   
-000009c0: 2020 2020 2020 2020 7c0d 0a23 202b 2d2d          |..# +--
-000009d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000009e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000009f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00000a00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00000a10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2b0d 0a0d  ------------+...
-00000a20: 0a0d 0a63 6c61 7373 2053 7572 6661 6365  ...class Surface
-00000a30: 3344 436f 6c6c 6563 7469 6f6e 2850 6f6c  3DCollection(Pol
-00000a40: 7933 4443 6f6c 6c65 6374 696f 6e29 3a0d  y3DCollection):.
-00000a50: 0a20 2020 2022 2222 0d0a 2020 2020 4261  .    """..    Ba
-00000a60: 7365 2063 6c61 7373 2066 6f72 2033 4420  se class for 3D 
-00000a70: 7375 7266 6163 6573 2e0d 0a20 2020 2022  surfaces...    "
-00000a80: 2222 0d0a 2020 2020 5f67 656f 6d54 7970  ""..    _geomTyp
-00000a90: 6520 3d20 5f43 4f4f 5253 5953 5b27 5859  e = _COORSYS['XY
-00000aa0: 5a27 5d0d 0a0d 0a20 2020 2040 7374 6174  Z']....    @stat
-00000ab0: 6963 6d65 7468 6f64 0d0a 2020 2020 6465  icmethod..    de
-00000ac0: 6620 6368 756c 6c28 706f 696e 7473 2c20  f chull(points, 
-00000ad0: 2a2a 6b61 7267 7329 203a 0d0a 2020 2020  **kargs) :..    
-00000ae0: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
-00000af0: 2053 7572 6661 6365 3344 436f 6c6c 6563   Surface3DCollec
-00000b00: 7469 6f6e 2043 6f6e 7665 7820 4875 6c6c  tion Convex Hull
-00000b10: 2066 6f72 2061 2073 6574 206f 6620 3344   for a set of 3D
-00000b20: 2070 6f69 6e74 732e 200d 0a20 2020 2020   points. ..     
-00000b30: 2020 200d 0a20 2020 2020 2020 2050 6172     ..        Par
-00000b40: 616d 6574 6572 730d 0a20 2020 2020 2020  ameters..       
-00000b50: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
-00000b60: 2020 2020 2070 6f69 6e74 7320 3a20 4e20       points : N 
-00000b70: 7820 3320 666c 6f61 7420 6172 7261 792d  x 3 float array-
-00000b80: 6c69 6b65 0d0a 0d0a 2020 2020 2020 2020  like....        
-00000b90: 5265 7475 726e 730d 0a20 2020 2020 2020  Returns..       
-00000ba0: 202d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020   -------..      
-00000bb0: 2020 5375 7266 6163 6533 4443 6f6c 6c65    Surface3DColle
-00000bc0: 6374 696f 6e20 6f62 6a65 6374 0d0a 0d0a  ction object....
-00000bd0: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
-00000be0: 2020 2020 2070 6f69 6e74 7320 3d20 6e70       points = np
-00000bf0: 2e61 7272 6179 2870 6f69 6e74 7329 0d0a  .array(points)..
-00000c00: 2020 2020 2020 2020 6875 6c6c 203d 2073          hull = s
-00000c10: 7061 7469 616c 2e43 6f6e 7665 7848 756c  patial.ConvexHul
-00000c20: 6c28 706f 696e 7473 290d 0a20 2020 2020  l(points)..     
-00000c30: 2020 2076 6572 7473 203d 2070 6f69 6e74     verts = point
-00000c40: 735b 6875 6c6c 2e76 6572 7469 6365 735d  s[hull.vertices]
-00000c50: 0d0a 2020 2020 2020 2020 6350 6e74 203d  ..        cPnt =
-00000c60: 2076 6572 7473 2e6d 6561 6e28 6178 6973   verts.mean(axis
-00000c70: 3d30 290d 0a20 2020 2020 2020 2023 2073  =0)..        # s
-00000c80: 6574 2074 6865 2066 6163 6549 6e64 6963  et the faceIndic
-00000c90: 6573 2072 6566 6572 656e 6369 6e67 2074  es referencing t
-00000ca0: 6865 2076 6572 7473 2c20 6e6f 7420 7468  he verts, not th
-00000cb0: 6520 706f 696e 7473 2e2e 2e2e 0d0a 2020  e points......  
-00000cc0: 2020 2020 2020 7265 766c 6b75 7020 3d20        revlkup = 
-00000cd0: 7b20 7661 6c3a 6920 666f 7220 692c 7661  { val:i for i,va
-00000ce0: 6c20 696e 2065 6e75 6d65 7261 7465 2868  l in enumerate(h
-00000cf0: 756c 6c2e 7665 7274 6963 6573 2920 7d0d  ull.vertices) }.
-00000d00: 0a20 2020 2020 2020 2066 496e 6469 6365  .        fIndice
-00000d10: 7320 3d20 5b4e 6f6e 655d 2a6c 656e 2820  s = [None]*len( 
-00000d20: 6875 6c6c 2e73 696d 706c 6963 6573 2029  hull.simplices )
-00000d30: 0d0a 2020 2020 2020 2020 666f 7220 692c  ..        for i,
-00000d40: 696e 6478 2069 6e20 656e 756d 6572 6174  indx in enumerat
-00000d50: 6528 6875 6c6c 2e73 696d 706c 6963 6573  e(hull.simplices
-00000d60: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-00000d70: 612c 622c 6320 3d20 696e 6478 0d0a 2020  a,b,c = indx..  
-00000d80: 2020 2020 2020 2020 2020 6649 6e64 6963            fIndic
-00000d90: 6573 5b69 5d20 3d20 5b20 7265 766c 6b75  es[i] = [ revlku
-00000da0: 705b 615d 202c 2072 6576 6c6b 7570 5b62  p[a] , revlkup[b
-00000db0: 5d20 2c20 7265 766c 6b75 705b 635d 205d  ] , revlkup[c] ]
-00000dc0: 200d 0a20 2020 2020 2020 2023 2073 6574   ..        # set
-00000dd0: 2074 6865 2066 6163 6520 696e 6469 6365   the face indice
-00000de0: 7320 7573 696e 6720 7468 6520 5248 5220  s using the RHR 
-00000df0: 666f 7220 6f75 7477 6172 6420 6e6f 726d  for outward norm
-00000e00: 616c 7320 6672 6f6d 2074 6865 2063 656e  als from the cen
-00000e10: 7465 722e 0d0a 2020 2020 2020 2020 7465  ter...        te
-00000e20: 6d70 203d 205b 4e6f 6e65 5d2a 6c65 6e28  mp = [None]*len(
-00000e30: 6649 6e64 6963 6573 290d 0a20 2020 2020  fIndices)..     
-00000e40: 2020 2066 6f72 2069 2c66 696e 6478 2069     for i,findx i
-00000e50: 6e20 656e 756d 6572 6174 6528 6649 6e64  n enumerate(fInd
-00000e60: 6963 6573 2920 3a0d 0a20 2020 2020 2020  ices) :..       
-00000e70: 2020 2020 2061 2c62 2c63 203d 2066 696e       a,b,c = fin
-00000e80: 6478 0d0a 2020 2020 2020 2020 2020 2020  dx..            
-00000e90: 6663 656e 7465 7220 3d20 2876 6572 7473  fcenter = (verts
-00000ea0: 5b61 5d20 2b20 7665 7274 735b 625d 202b  [a] + verts[b] +
-00000eb0: 2076 6572 7473 5b63 5d29 2f33 0d0a 2020   verts[c])/3..  
-00000ec0: 2020 2020 2020 2020 2020 6e6f 7264 6972            nordir
-00000ed0: 203d 206e 702e 6372 6f73 7328 7665 7274   = np.cross(vert
-00000ee0: 735b 625d 2d76 6572 7473 5b61 5d2c 7665  s[b]-verts[a],ve
-00000ef0: 7274 735b 635d 2d76 6572 7473 5b62 5d29  rts[c]-verts[b])
-00000f00: 0d0a 2020 2020 2020 2020 2020 2020 646f  ..            do
-00000f10: 7470 726f 6420 3d20 6e70 2e64 6f74 2866  tprod = np.dot(f
-00000f20: 6365 6e74 6572 2d63 506e 742c 6e6f 7264  center-cPnt,nord
-00000f30: 6972 290d 0a20 2020 2020 2020 2020 2020  ir)..           
-00000f40: 2074 656d 705b 695d 203d 205b 612c 622c   temp[i] = [a,b,
-00000f50: 635d 2069 6620 646f 7470 726f 643e 3020  c] if dotprod>0 
-00000f60: 656c 7365 205b 632c 622c 615d 0d0a 2020  else [c,b,a]..  
-00000f70: 2020 2020 2020 6649 6e64 6963 6573 203d        fIndices =
-00000f80: 2074 656d 700d 0a20 2020 2020 2020 2073   temp..        s
-00000f90: 7572 6661 6365 203d 2053 7572 6661 6365  urface = Surface
-00000fa0: 3344 436f 6c6c 6563 7469 6f6e 2876 6572  3DCollection(ver
-00000fb0: 7473 2c66 496e 6469 6365 732c 202a 2a6b  ts,fIndices, **k
-00000fc0: 6172 6773 290d 0a20 2020 2020 2020 2072  args)..        r
-00000fd0: 6574 7572 6e20 7375 7266 6163 650d 0a0d  eturn surface...
-00000fe0: 0a20 2020 2040 7374 6174 6963 6d65 7468  .    @staticmeth
-00000ff0: 6f64 0d0a 2020 2020 6465 6620 7472 6961  od..    def tria
-00001000: 6e67 756c 6174 6542 6173 6528 7265 7a2c  ngulateBase(rez,
-00001010: 6261 7365 5663 6f6f 722c 6261 7365 4661  baseVcoor,baseFa
-00001020: 6365 5665 7274 6578 496e 6469 6365 732c  ceVertexIndices,
-00001030: 206d 6964 5665 6374 4675 6e63 2920 3a0d   midVectFunc) :.
-00001040: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
-00001050: 2020 2020 2020 5265 6375 7273 6976 656c        Recursivel
-00001060: 7920 7375 6264 6976 6964 6520 7472 6961  y subdivide tria
-00001070: 6e67 6c65 732e 0d0a 0d0a 2020 2020 2020  ngles.....      
-00001080: 2020 4561 6368 2072 6563 7572 7369 6f6e    Each recursion
-00001090: 2073 7562 6469 7669 6465 7320 6561 6368   subdivides each
-000010a0: 2074 7269 616e 676c 6520 6279 2066 6f75   triangle by fou
-000010b0: 722e 0d0a 0d0a 2020 2020 2020 2020 5061  r.....        Pa
-000010c0: 7261 6d65 7465 7273 0d0a 2020 2020 2020  rameters..      
-000010d0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
-000010e0: 2020 2020 2020 7265 7a20 3a20 696e 7465        rez : inte
-000010f0: 6765 722c 206f 7074 696f 6e61 6c2c 2064  ger, optional, d
-00001100: 6566 6175 6c74 3a20 300d 0a20 2020 2020  efault: 0..     
-00001110: 2020 2020 2020 204e 756d 6265 7220 6f66         Number of
-00001120: 2072 6563 7572 7369 7665 2073 7562 6469   recursive subdi
-00001130: 7669 7369 6f6e 7320 6f66 2074 6865 2074  visions of the t
-00001140: 7269 616e 6775 6c61 7465 6420 6261 7365  riangulated base
-00001150: 2066 6163 6573 2e0d 0a20 2020 2020 2020   faces...       
-00001160: 2020 2020 2052 657a 2076 616c 7565 7320       Rez values 
-00001170: 7261 6e67 6520 6672 6f6d 2030 2074 6f20  range from 0 to 
-00001180: 372e 0d0a 0d0a 2020 2020 2020 2020 6261  7.....        ba
-00001190: 7365 5663 6f6f 7220 3a20 5620 7820 3320  seVcoor : V x 3 
-000011a0: 666c 6f61 7420 6172 7261 790d 0a20 2020  float array..   
-000011b0: 2020 2020 2020 2020 2041 6e20 6172 7261           An arra
-000011c0: 7920 6f66 2027 7627 206e 756d 6265 7220  y of 'v' number 
-000011d0: 6f66 2078 797a 2076 6572 7465 7820 636f  of xyz vertex co
-000011e0: 6f72 6469 6e61 7465 732e 0d0a 0d0a 2020  ordinates.....  
-000011f0: 2020 2020 2020 6261 7365 4661 6365 5665        baseFaceVe
-00001200: 7274 6578 7449 6e64 6963 6573 203a 2046  rtextIndices : F
-00001210: 2078 2033 2069 6e74 2061 7272 6179 0d0a   x 3 int array..
-00001220: 2020 2020 2020 2020 2020 2020 416e 2061              An a
-00001230: 7272 6179 206f 6620 2746 2720 6e75 6d62  rray of 'F' numb
-00001240: 6572 206f 6620 6661 6365 2076 6572 7465  er of face verte
-00001250: 7820 696e 6469 6365 732e 0d0a 0d0a 2020  x indices.....  
-00001260: 2020 2020 2020 6d69 6456 6563 7446 756e        midVectFun
-00001270: 6320 3a20 6675 6e63 7469 6f6e 206f 626a  c : function obj
-00001280: 6563 740d 0a20 2020 2020 2020 2020 2020  ect..           
-00001290: 2041 2066 756e 6374 696f 6e20 7468 6174   A function that
-000012a0: 2074 616b 6573 2074 776f 2078 797a 2063   takes two xyz c
-000012b0: 6f6f 7264 696e 6174 6520 286c 6973 7420  oordinate (list 
-000012c0: 6f66 2033 290d 0a20 2020 2020 2020 2020  of 3)..         
-000012d0: 2020 2072 6570 7265 7365 6e74 696e 6720     representing 
-000012e0: 6120 7375 7266 6163 6520 6661 6365 2065  a surface face e
-000012f0: 6467 652e 2020 5265 7475 726e 7320 6f6e  dge.  Returns on
-00001300: 6520 7879 7a20 636f 6f72 6469 6e61 7465  e xyz coordinate
-00001310: 0d0a 2020 2020 2020 2020 2020 2020 6174  ..            at
-00001320: 2074 6865 2062 6973 6563 7469 6f6e 206f   the bisection o
-00001330: 6620 7468 6520 6564 6765 2c20 6d61 7070  f the edge, mapp
-00001340: 6564 206f 6e20 7468 6520 7375 7266 6163  ed on the surfac
-00001350: 652e 0d0a 0d0a 2020 2020 2020 2020 5265  e.....        Re
-00001360: 7475 726e 730d 0a20 2020 2020 2020 202d  turns..        -
-00001370: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
-00001380: 696e 6465 784f 626a 203a 2061 2064 6963  indexObj : a dic
-00001390: 7469 6f6e 6172 7920 6f66 2076 6572 7465  tionary of verte
-000013a0: 7820 696e 6469 6365 732c 2066 6f72 2061  x indices, for a
-000013b0: 2073 7572 6661 6365 0d0a 2020 2020 2020   surface..      
-000013c0: 2020 2020 2020 6f66 2046 2066 6163 6573        of F faces
-000013d0: 2c20 4520 6564 6765 7320 616e 6420 5620  , E edges and V 
-000013e0: 7665 7274 6963 6573 2e0d 0a20 2020 2020  vertices...     
-000013f0: 2020 2020 2020 2027 6661 6365 2720 3a20         'face' : 
-00001400: 4620 7820 3320 696e 7420 6172 7261 790d  F x 3 int array.
-00001410: 0a20 2020 2020 2020 2020 2020 2027 6564  .            'ed
-00001420: 6765 2720 3a20 4520 7820 3220 696e 7420  ge' : E x 2 int 
-00001430: 6172 7261 790d 0a0d 0a20 2020 2020 2020  array....       
-00001440: 2076 6572 7443 6f6f 7220 3a20 5620 7820   vertCoor : V x 
-00001450: 3320 666c 6f61 7420 6172 7261 790d 0a20  3 float array.. 
-00001460: 2020 2020 2020 2020 2020 2041 6e20 6172             An ar
-00001470: 7261 7920 6f66 2056 206e 756d 6265 7220  ray of V number 
-00001480: 6f66 2078 797a 2076 6572 7465 7820 636f  of xyz vertex co
-00001490: 6f72 6469 6e61 7465 732e 0d0a 0d0a 2020  ordinates.....  
-000014a0: 2020 2020 2020 2222 220d 0a0d 0a20 2020        """....   
-000014b0: 2020 2020 2076 436f 6f72 203d 2062 6173       vCoor = bas
-000014c0: 6556 636f 6f72 2e63 6f70 7928 290d 0a20  eVcoor.copy().. 
-000014d0: 2020 2020 2020 2066 7649 6e64 6963 6573         fvIndices
-000014e0: 203d 205b 5d0d 0a20 2020 2020 2020 2065   = []..        e
-000014f0: 7649 6e64 6963 6573 203d 205b 5d0d 0a20  vIndices = [].. 
-00001500: 2020 2020 2020 2023 2e2e 2e2e 2e2e 2e2e         #........
-00001510: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00001520: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e20 2020  .............   
-00001530: 200d 0a20 2020 2020 2020 2064 6566 2067   ..        def g
-00001540: 6574 5665 7274 6963 6573 4c69 6e65 2864  etVerticesLine(d
-00001550: 6567 7265 652c 206c 6566 7449 6e64 6578  egree, leftIndex
-00001560: 2c20 7269 6768 7449 6e64 6578 2920 3a0d  , rightIndex) :.
-00001570: 0a20 2020 2020 2020 2020 2020 2064 6566  .            def
-00001580: 2072 6563 7572 735f 6564 6765 436f 6f72   recurs_edgeCoor
-00001590: 2864 6567 7265 652c 2069 6e64 6578 4f72  (degree, indexOr
-000015a0: 6967 696e 2c20 6973 5269 6768 742c 206c  igin, isRight, l
-000015b0: 6566 7449 6e64 6578 2c20 7269 6768 7449  eftIndex, rightI
-000015c0: 6e64 6578 2c20 4569 6e64 6578 2920 3a0d  ndex, Eindex) :.
-000015d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000015e0: 206d 203d 2064 6567 7265 6520 2d20 310d   m = degree - 1.
-000015f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00001600: 2064 656c 7461 203d 2069 6e74 286e 702e   delta = int(np.
-00001610: 706f 7765 7228 322c 6d29 290d 0a20 2020  power(2,m))..   
-00001620: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00001630: 6973 5269 6768 7420 3a20 6465 6c74 6120  isRight : delta 
-00001640: 3d20 2d64 656c 7461 0d0a 2020 2020 2020  = -delta..      
-00001650: 2020 2020 2020 2020 2020 6920 3d20 696e            i = in
-00001660: 6465 784f 7269 6769 6e20 2d20 6465 6c74  dexOrigin - delt
-00001670: 610d 0a20 2020 2020 2020 2020 2020 2020  a..             
-00001680: 2020 206d 6964 5f63 6f6f 7220 3d20 6d69     mid_coor = mi
-00001690: 6456 6563 7446 756e 6328 2076 436f 6f72  dVectFunc( vCoor
-000016a0: 5b6c 6566 7449 6e64 6578 5d2c 2076 436f  [leftIndex], vCo
-000016b0: 6f72 5b72 6967 6874 496e 6465 785d 2029  or[rightIndex] )
-000016c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000016d0: 2020 6375 7272 656e 7443 6f6f 7249 6e64    currentCoorInd
-000016e0: 6578 203d 206c 656e 2876 436f 6f72 290d  ex = len(vCoor).
-000016f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00001700: 2076 436f 6f72 2e61 7070 656e 6428 6d69   vCoor.append(mi
-00001710: 645f 636f 6f72 290d 0a20 2020 2020 2020  d_coor)..       
-00001720: 2020 2020 2020 2020 2045 696e 6465 785b           Eindex[
-00001730: 695d 203d 2063 7572 7265 6e74 436f 6f72  i] = currentCoor
-00001740: 496e 6465 780d 0a20 2020 2020 2020 2020  Index..         
-00001750: 2020 2020 2020 2069 6620 6d20 3c3d 2030         if m <= 0
-00001760: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
-00001770: 2020 2020 2020 2020 6576 496e 6469 6365          evIndice
-00001780: 732e 6170 7065 6e64 2820 5b6c 6566 7449  s.append( [leftI
-00001790: 6e64 6578 2c20 6375 7272 656e 7443 6f6f  ndex, currentCoo
-000017a0: 7249 6e64 6578 5d20 2920 2020 2020 2020  rIndex] )       
-000017b0: 2020 2020 2020 2020 2020 2020 200d 0a20               .. 
-000017c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000017d0: 2020 2065 7649 6e64 6963 6573 2e61 7070     evIndices.app
-000017e0: 656e 6428 205b 6375 7272 656e 7443 6f6f  end( [currentCoo
-000017f0: 7249 6e64 6578 2c20 7269 6768 7449 6e64  rIndex, rightInd
-00001800: 6578 5d20 2920 2020 2020 2020 2020 2020  ex] )           
-00001810: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-00001820: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00001830: 6574 7572 6e0d 0a20 2020 2020 2020 2020  eturn..         
-00001840: 2020 2020 2020 2072 6563 7572 735f 6564         recurs_ed
-00001850: 6765 436f 6f72 286d 2c69 2c46 616c 7365  geCoor(m,i,False
-00001860: 2c6c 6566 7449 6e64 6578 2c63 7572 7265  ,leftIndex,curre
-00001870: 6e74 436f 6f72 496e 6465 782c 2045 696e  ntCoorIndex, Ein
-00001880: 6465 7829 0d0a 2020 2020 2020 2020 2020  dex)..          
-00001890: 2020 2020 2020 7265 6375 7273 5f65 6467        recurs_edg
-000018a0: 6543 6f6f 7228 6d2c 692c 5472 7565 2c63  eCoor(m,i,True,c
-000018b0: 7572 7265 6e74 436f 6f72 496e 6465 782c  urrentCoorIndex,
-000018c0: 7269 6768 7449 6e64 6578 2c20 4569 6e64  rightIndex, Eind
-000018d0: 6578 290d 0a20 2020 2020 2020 2020 2020  ex)..           
-000018e0: 2020 2020 2072 6574 7572 6e0d 0a20 2020       return..   
-000018f0: 2020 2020 2020 2020 2023 2e2e 2e2e 2e2e           #......
-00001900: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00001910: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e20  ............... 
-00001920: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
-00001930: 2069 4f72 6967 696e 203d 2069 6e74 286e   iOrigin = int(n
-00001940: 702e 706f 7765 7228 322c 6465 6772 6565  p.power(2,degree
-00001950: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
-00001960: 4569 6e64 6578 203d 205b 4e6f 6e65 5d2a  Eindex = [None]*
-00001970: 2869 4f72 6967 696e 2b31 290d 0a20 2020  (iOrigin+1)..   
-00001980: 2020 2020 2020 2020 2045 696e 6465 785b           Eindex[
-00001990: 305d 203d 206c 6566 7449 6e64 6578 0d0a  0] = leftIndex..
-000019a0: 2020 2020 2020 2020 2020 2020 4569 6e64              Eind
-000019b0: 6578 5b69 4f72 6967 696e 5d20 3d20 7269  ex[iOrigin] = ri
-000019c0: 6768 7449 6e64 6578 0d0a 2020 2020 2020  ghtIndex..      
-000019d0: 2020 2020 2020 6966 2064 6567 7265 653d        if degree=
-000019e0: 3d30 203a 0d0a 2020 2020 2020 2020 2020  =0 :..          
-000019f0: 2020 2020 2020 6576 496e 6469 6365 732e        evIndices.
-00001a00: 6170 7065 6e64 2820 5b6c 6566 7449 6e64  append( [leftInd
-00001a10: 6578 2c20 7269 6768 7449 6e64 6578 5d20  ex, rightIndex] 
-00001a20: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00001a30: 2020 2072 6574 7572 6e20 4569 6e64 6578     return Eindex
-00001a40: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
-00001a50: 6375 7273 5f65 6467 6543 6f6f 7228 6465  curs_edgeCoor(de
-00001a60: 6772 6565 2c20 694f 7269 6769 6e2c 2046  gree, iOrigin, F
-00001a70: 616c 7365 2c20 6c65 6674 496e 6465 782c  alse, leftIndex,
-00001a80: 2072 6967 6874 496e 6465 782c 2045 696e   rightIndex, Ein
-00001a90: 6465 7829 0d0a 2020 2020 2020 2020 2020  dex)..          
-00001aa0: 2020 7265 7475 726e 2045 696e 6465 780d    return Eindex.
-00001ab0: 0a20 2020 2020 2020 2023 2e2e 2e2e 2e2e  .        #......
-00001ac0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00001ad0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e20  ............... 
-00001ae0: 2020 200d 0a20 2020 2020 2020 2064 6566     ..        def
-00001af0: 2072 6563 7572 735f 6661 6365 496e 6469   recurs_faceIndi
-00001b00: 6365 7328 412c 422c 432c 7265 7a2c 6174  ces(A,B,C,rez,at
-00001b10: 4365 6e74 6572 3d54 7275 6529 3a0d 0a20  Center=True):.. 
-00001b20: 2020 2020 2020 2020 2020 2069 6620 7265             if re
-00001b30: 7a3d 3d30 203a 0d0a 2020 2020 2020 2020  z==0 :..        
-00001b40: 2020 2020 2020 2020 6162 6320 3d20 5b20          abc = [ 
-00001b50: 415b 305d 2c20 425b 305d 2c20 435b 305d  A[0], B[0], C[0]
-00001b60: 205d 2020 2020 2020 2020 2020 2020 2020   ]              
-00001b70: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-00001b80: 2020 2066 7649 6e64 6963 6573 2e61 7070     fvIndices.app
-00001b90: 656e 6428 2061 6263 2029 0d0a 2020 2020  end( abc )..    
-00001ba0: 2020 2020 2020 2020 2020 2020 6966 2061              if a
-00001bb0: 7443 656e 7465 7220 3a20 6576 496e 6469  tCenter : evIndi
-00001bc0: 6365 732e 6170 7065 6e64 2820 5b20 425b  ces.append( [ B[
-00001bd0: 305d 2c20 435b 305d 205d 2029 0d0a 2020  0], C[0] ] )..  
-00001be0: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00001bf0: 7475 726e 0d0a 2020 2020 2020 2020 2020  turn..          
-00001c00: 2020 2320 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    # ------------
-00001c10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00001c20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00001c30: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
-00001c40: 2020 2020 2020 204a 203d 2069 6e74 2820         J = int( 
-00001c50: 286c 656e 2841 292d 3129 2f32 2029 0d0a  (len(A)-1)/2 )..
-00001c60: 2020 2020 2020 2020 2020 2020 4b20 3d20              K = 
-00001c70: 4a20 2b20 310d 0a20 2020 2020 2020 2020  J + 1..         
-00001c80: 2020 2023 2063 6f6e 7374 7275 6374 2074     # construct t
-00001c90: 6865 2063 656e 7465 7220 7375 6220 7472  he center sub tr
-00001ca0: 6961 6e67 6c65 2065 6467 6520 7665 7274  iangle edge vert
-00001cb0: 6963 6573 2e2e 2e2e 0d0a 2020 2020 2020  ices......      
-00001cc0: 2020 2020 2020 6966 2072 657a 3d3d 3120        if rez==1 
-00001cd0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00001ce0: 2020 2078 7a20 3d20 5b20 415b 315d 2c20     xz = [ A[1], 
-00001cf0: 435b 315d 205d 0d0a 2020 2020 2020 2020  C[1] ]..        
-00001d00: 2020 2020 2020 2020 7978 203d 205b 2042          yx = [ B
-00001d10: 5b31 5d2c 2041 5b31 5d20 5d0d 0a20 2020  [1], A[1] ]..   
-00001d20: 2020 2020 2020 2020 2020 2020 207a 7920               zy 
-00001d30: 3d20 5b20 435b 315d 2c20 425b 315d 205d  = [ C[1], B[1] ]
-00001d40: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
-00001d50: 7365 3a20 2020 2020 2020 2020 2020 2020  se:             
-00001d60: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
-00001d70: 2020 2020 787a 203d 2067 6574 5665 7274      xz = getVert
-00001d80: 6963 6573 4c69 6e65 2872 657a 2d31 2c20  icesLine(rez-1, 
-00001d90: 415b 4a5d 2c20 435b 4a5d 2029 0d0a 2020  A[J], C[J] )..  
-00001da0: 2020 2020 2020 2020 2020 2020 2020 7978                yx
-00001db0: 203d 2067 6574 5665 7274 6963 6573 4c69   = getVerticesLi
-00001dc0: 6e65 2872 657a 2d31 2c20 425b 4a5d 2c20  ne(rez-1, B[J], 
-00001dd0: 415b 4a5d 2029 0d0a 2020 2020 2020 2020  A[J] )..        
-00001de0: 2020 2020 2020 2020 7a79 203d 2067 6574          zy = get
-00001df0: 5665 7274 6963 6573 4c69 6e65 2872 657a  VerticesLine(rez
-00001e00: 2d31 2c20 435b 4a5d 2c20 425b 4a5d 2029  -1, C[J], B[J] )
-00001e10: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-00001e20: 636f 6e73 7472 7563 7420 7468 6520 3420  construct the 4 
-00001e30: 7375 6220 7472 6961 6e67 6c65 732e 2e2e  sub triangles...
-00001e40: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
-00001e50: 6375 7273 5f66 6163 6549 6e64 6963 6573  curs_faceIndices
-00001e60: 2841 5b3a 4b5d 2c78 7a2c 435b 4a3a 5d2c  (A[:K],xz,C[J:],
-00001e70: 7265 7a2d 3129 0d0a 2020 2020 2020 2020  rez-1)..        
-00001e80: 2020 2020 7265 6375 7273 5f66 6163 6549      recurs_faceI
-00001e90: 6e64 6963 6573 2842 5b3a 4b5d 2c79 782c  ndices(B[:K],yx,
-00001ea0: 415b 4a3a 5d2c 7265 7a2d 3129 0d0a 2020  A[J:],rez-1)..  
-00001eb0: 2020 2020 2020 2020 2020 7265 6375 7273            recurs
-00001ec0: 5f66 6163 6549 6e64 6963 6573 2843 5b3a  _faceIndices(C[:
-00001ed0: 4b5d 2c7a 792c 425b 4a3a 5d2c 7265 7a2d  K],zy,B[J:],rez-
-00001ee0: 3129 0d0a 2020 2020 2020 2020 2020 2020  1)..            
-00001ef0: 7265 6375 7273 5f66 6163 6549 6e64 6963  recurs_faceIndic
-00001f00: 6573 2879 785b 3a3a 2d31 5d2c 7a79 5b3a  es(yx[::-1],zy[:
-00001f10: 3a2d 315d 2c78 7a5b 3a3a 2d31 5d2c 7265  :-1],xz[::-1],re
-00001f20: 7a2d 312c 4661 6c73 6529 0d0a 2020 2020  z-1,False)..    
-00001f30: 2020 2020 2020 2020 7265 7475 726e 0d0a          return..
-00001f40: 2020 2020 2020 2020 232e 2e2e 2e2e 2e2e          #.......
-00001f50: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00001f60: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 0d0a  ................
-00001f70: 2020 2020 2020 2020 2320 6765 6e65 7261          # genera
-00001f80: 7465 2074 6865 2062 6173 6520 6564 6765  te the base edge
-00001f90: 2069 6e64 6963 6573 2066 6f72 2065 6163   indices for eac
-00001fa0: 6820 6661 6365 200d 0a20 2020 2020 2020  h face ..       
-00001fb0: 2062 6173 6546 6163 6545 6467 6549 6e64   baseFaceEdgeInd
-00001fc0: 6963 6573 203d 205b 5d0d 0a20 2020 2020  ices = []..     
-00001fd0: 2020 2065 6467 6541 7272 6179 496e 6465     edgeArrayInde
-00001fe0: 784d 6174 7269 7820 3d20 5b5b 4e6f 6e65  xMatrix = [[None
-00001ff0: 2066 6f72 2078 2069 6e20 7261 6e67 6528   for x in range(
-00002000: 6c65 6e28 7643 6f6f 7229 295d 2066 6f72  len(vCoor))] for
-00002010: 2079 2069 6e20 7261 6e67 6528 6c65 6e28   y in range(len(
-00002020: 7643 6f6f 7229 295d 2020 200d 0a20 2020  vCoor))]   ..   
-00002030: 2020 2020 2066 6f72 2066 6163 6520 696e       for face in
-00002040: 2062 6173 6546 6163 6556 6572 7465 7849   baseFaceVertexI
-00002050: 6e64 6963 6573 203a 0d0a 2020 2020 2020  ndices :..      
-00002060: 2020 2020 2020 4120 3d20 5b20 6661 6365        A = [ face
-00002070: 5b30 5d2c 6661 6365 5b31 5d5d 0d0a 2020  [0],face[1]]..  
-00002080: 2020 2020 2020 2020 2020 4220 3d20 5b20            B = [ 
-00002090: 6661 6365 5b31 5d2c 6661 6365 5b32 5d5d  face[1],face[2]]
-000020a0: 0d0a 2020 2020 2020 2020 2020 2020 4320  ..            C 
-000020b0: 3d20 5b20 6661 6365 5b32 5d2c 6661 6365  = [ face[2],face
-000020c0: 5b30 5d5d 0d0a 2020 2020 2020 2020 2020  [0]]..          
-000020d0: 2020 6564 6765 496e 6469 6365 7320 3d20    edgeIndices = 
-000020e0: 5b41 2c42 2c43 5d0d 0a20 2020 2020 2020  [A,B,C]..       
-000020f0: 2020 2020 2062 6173 6546 6163 6545 6467       baseFaceEdg
-00002100: 6549 6e64 6963 6573 2e61 7070 656e 6428  eIndices.append(
-00002110: 6564 6765 496e 6469 6365 7329 0d0a 2020  edgeIndices)..  
-00002120: 2020 2020 2020 2020 2020 666f 7220 7665            for ve
-00002130: 7274 6578 496e 6465 7820 696e 2065 6467  rtexIndex in edg
-00002140: 6549 6e64 6963 6573 203a 0d0a 2020 2020  eIndices :..    
-00002150: 2020 2020 2020 2020 2020 2020 6920 3d20              i = 
-00002160: 7665 7274 6578 496e 6465 785b 305d 0d0a  vertexIndex[0]..
-00002170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002180: 6a20 3d20 7665 7274 6578 496e 6465 785b  j = vertexIndex[
-00002190: 315d 0d0a 2020 2020 2020 2020 2020 2020  1]..            
-000021a0: 2020 2020 6966 2065 6467 6541 7272 6179      if edgeArray
-000021b0: 496e 6465 784d 6174 7269 785b 695d 5b6a  IndexMatrix[i][j
-000021c0: 5d20 6973 204e 6f6e 653a 0d0a 2020 2020  ] is None:..    
-000021d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000021e0: 6564 6765 4172 7261 7949 6e64 6578 4d61  edgeArrayIndexMa
-000021f0: 7472 6978 5b69 5d5b 6a5d 203d 2067 6574  trix[i][j] = get
-00002200: 5665 7274 6963 6573 4c69 6e65 2872 657a  VerticesLine(rez
-00002210: 2c20 692c 206a 2029 0d0a 2020 2020 2020  , i, j )..      
-00002220: 2020 2020 2020 2020 2020 2020 2020 6564                ed
-00002230: 6765 4172 7261 7949 6e64 6578 4d61 7472  geArrayIndexMatr
-00002240: 6978 5b6a 5d5b 695d 203d 2065 6467 6541  ix[j][i] = edgeA
-00002250: 7272 6179 496e 6465 784d 6174 7269 785b  rrayIndexMatrix[
-00002260: 695d 5b6a 5d2e 636f 7079 2829 5b3a 3a2d  i][j].copy()[::-
-00002270: 315d 0d0a 2020 2020 2020 2020 2320 7472  1]..        # tr
-00002280: 6961 6e67 6c75 6c61 7465 2074 6865 2062  ianglulate the b
-00002290: 6173 6520 7472 6961 6e67 6c65 730d 0a20  ase triangles.. 
-000022a0: 2020 2020 2020 2066 6f72 2066 6163 6520         for face 
-000022b0: 696e 2062 6173 6546 6163 6545 6467 6549  in baseFaceEdgeI
-000022c0: 6e64 6963 6573 203a 0d0a 2020 2020 2020  ndices :..      
-000022d0: 2020 2020 2020 4120 3d20 6564 6765 4172        A = edgeAr
-000022e0: 7261 7949 6e64 6578 4d61 7472 6978 5b66  rayIndexMatrix[f
-000022f0: 6163 655b 305d 5b30 5d5d 5b66 6163 655b  ace[0][0]][face[
-00002300: 305d 5b31 5d5d 0d0a 2020 2020 2020 2020  0][1]]..        
-00002310: 2020 2020 4220 3d20 6564 6765 4172 7261      B = edgeArra
-00002320: 7949 6e64 6578 4d61 7472 6978 5b66 6163  yIndexMatrix[fac
-00002330: 655b 315d 5b30 5d5d 5b66 6163 655b 315d  e[1][0]][face[1]
-00002340: 5b31 5d5d 0d0a 2020 2020 2020 2020 2020  [1]]..          
-00002350: 2020 4320 3d20 6564 6765 4172 7261 7949    C = edgeArrayI
-00002360: 6e64 6578 4d61 7472 6978 5b66 6163 655b  ndexMatrix[face[
-00002370: 325d 5b30 5d5d 5b66 6163 655b 325d 5b31  2][0]][face[2][1
-00002380: 5d5d 0d0a 2020 2020 2020 2020 2020 2020  ]]..            
-00002390: 7820 3d20 2872 657a 203e 2030 290d 0a20  x = (rez > 0).. 
-000023a0: 2020 2020 2020 2020 2020 2072 6563 7572             recur
-000023b0: 735f 6661 6365 496e 6469 6365 7328 412c  s_faceIndices(A,
-000023c0: 422c 432c 7265 7a2c 2078 290d 0a20 2020  B,C,rez, x)..   
-000023d0: 2020 2020 2076 6572 7465 7843 6f6f 7220       vertexCoor 
-000023e0: 3d20 6e70 2e61 7272 6179 2876 436f 6f72  = np.array(vCoor
-000023f0: 2920 0d0a 2020 2020 2020 2020 696e 6465  ) ..        inde
-00002400: 784f 626a 203d 207b 2027 6661 6365 273a  xObj = { 'face':
-00002410: 206e 702e 6172 7261 7928 6676 496e 6469   np.array(fvIndi
-00002420: 6365 7329 202c 2027 6564 6765 273a 206e  ces) , 'edge': n
-00002430: 702e 6172 7261 7928 6576 496e 6469 6365  p.array(evIndice
-00002440: 7329 207d 0d0a 2020 2020 2020 2020 7265  s) }..        re
-00002450: 7475 726e 2069 6e64 6578 4f62 6a20 2c76  turn indexObj ,v
-00002460: 6572 7465 7843 6f6f 720d 0a0d 0a20 2020  ertexCoor....   
-00002470: 2040 7374 6174 6963 6d65 7468 6f64 0d0a   @staticmethod..
-00002480: 2020 2020 6465 6620 7265 6374 616e 6775      def rectangu
-00002490: 6c61 7465 4261 7365 2872 657a 2c62 6173  lateBase(rez,bas
-000024a0: 6556 636f 6f72 2c62 6173 6546 6163 6556  eVcoor,baseFaceV
-000024b0: 6572 7465 7849 6e64 6963 6573 2c20 6d69  ertexIndices, mi
-000024c0: 6456 6563 7446 756e 6329 203a 0d0a 2020  dVectFunc) :..  
-000024d0: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
-000024e0: 2020 2052 6563 7572 7369 7665 6c79 2073     Recursively s
-000024f0: 7562 6469 7669 6465 2071 7561 6472 696c  ubdivide quadril
-00002500: 6174 6572 616c 732e 0d0a 0d0a 2020 2020  aterals.....    
-00002510: 2020 2020 4561 6368 2072 6563 7572 7369      Each recursi
-00002520: 6f6e 2073 7562 6469 7669 6465 7320 6561  on subdivides ea
-00002530: 6368 2071 7561 6472 696c 6174 6572 616c  ch quadrilateral
-00002540: 2062 7920 666f 7572 2e0d 0a0d 0a20 2020   by four.....   
-00002550: 2020 2020 2050 6172 616d 6574 6572 730d       Parameters.
-00002560: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00002570: 2d2d 2d0d 0a20 2020 2020 2020 2072 657a  ---..        rez
-00002580: 203a 2069 6e74 6567 6572 2c20 6f70 7469   : integer, opti
-00002590: 6f6e 616c 2c20 6465 6661 756c 743a 2030  onal, default: 0
-000025a0: 0d0a 2020 2020 2020 2020 2020 2020 4e75  ..            Nu
-000025b0: 6d62 6572 206f 6620 7265 6375 7273 6976  mber of recursiv
-000025c0: 6520 7375 6264 6976 6973 696f 6e73 206f  e subdivisions o
-000025d0: 6620 7468 6520 7265 6374 616e 676c 6520  f the rectangle 
-000025e0: 6261 7365 2066 6163 6573 2e0d 0a20 2020  base faces...   
-000025f0: 2020 2020 2020 2020 2052 657a 2076 616c           Rez val
-00002600: 7565 7320 7261 6e67 6520 6672 6f6d 2030  ues range from 0
-00002610: 2074 6f20 372e 0d0a 0d0a 2020 2020 2020   to 7.....      
-00002620: 2020 6261 7365 5663 6f6f 7220 3a20 5620    baseVcoor : V 
-00002630: 7820 3320 666c 6f61 7420 6172 7261 790d  x 3 float array.
-00002640: 0a20 2020 2020 2020 2020 2020 2041 6e20  .            An 
-00002650: 6172 7261 7920 6f66 2027 7627 206e 756d  array of 'v' num
-00002660: 6265 7220 6f66 2078 797a 2076 6572 7465  ber of xyz verte
-00002670: 7820 636f 6f72 6469 6e61 7465 732e 0d0a  x coordinates...
-00002680: 0d0a 2020 2020 2020 2020 6261 7365 4661  ..        baseFa
-00002690: 6365 5665 7274 6578 7449 6e64 6963 6573  ceVertextIndices
-000026a0: 203a 2046 2078 2034 2069 6e74 2061 7272   : F x 4 int arr
-000026b0: 6179 0d0a 2020 2020 2020 2020 2020 2020  ay..            
-000026c0: 416e 2061 7272 6179 206f 6620 2746 2720  An array of 'F' 
-000026d0: 6e75 6d62 6572 206f 6620 6661 6365 2076  number of face v
-000026e0: 6572 7465 7820 696e 6469 6365 732e 0d0a  ertex indices...
-000026f0: 0d0a 2020 2020 2020 2020 6d69 6456 6563  ..        midVec
-00002700: 7446 756e 6320 3a20 6675 6e63 7469 6f6e  tFunc : function
-00002710: 206f 626a 6563 740d 0a20 2020 2020 2020   object..       
-00002720: 2020 2020 2041 2066 756e 6374 696f 6e20       A function 
-00002730: 7468 6174 2074 616b 6573 2074 776f 2078  that takes two x
-00002740: 797a 2063 6f6f 7264 696e 6174 6520 286c  yz coordinate (l
-00002750: 6973 7420 6f66 2034 290d 0a20 2020 2020  ist of 4)..     
-00002760: 2020 2020 2020 2072 6570 7265 7365 6e74         represent
-00002770: 696e 6720 6120 7375 7266 6163 6520 6661  ing a surface fa
-00002780: 6365 2065 6467 652e 2020 5265 7475 726e  ce edge.  Return
-00002790: 7320 6f6e 6520 7879 7a20 636f 6f72 6469  s one xyz coordi
-000027a0: 6e61 7465 0d0a 2020 2020 2020 2020 2020  nate..          
-000027b0: 2020 6174 2074 6865 2062 6973 6563 7469    at the bisecti
-000027c0: 6f6e 206f 6620 7468 6520 6564 6765 2c20  on of the edge, 
-000027d0: 6d61 7070 6564 206f 6e20 7468 6520 7375  mapped on the su
-000027e0: 7266 6163 652e 0d0a 0d0a 2020 2020 2020  rface.....      
-000027f0: 2020 5265 7475 726e 730d 0a20 2020 2020    Returns..     
-00002800: 2020 202d 2d2d 2d2d 2d2d 0d0a 2020 2020     -------..    
-00002810: 2020 2020 696e 6465 784f 626a 203a 2061      indexObj : a
-00002820: 2064 6963 7469 6f6e 6172 7920 6f66 2076   dictionary of v
-00002830: 6572 7465 7820 696e 6469 6365 732c 2066  ertex indices, f
-00002840: 6f72 2061 2073 7572 6661 6365 0d0a 2020  or a surface..  
-00002850: 2020 2020 2020 2020 2020 6f66 2046 2066            of F f
-00002860: 6163 6573 2c20 4520 6564 6765 7320 616e  aces, E edges an
-00002870: 6420 5620 7665 7274 6963 6573 2e0d 0a20  d V vertices... 
-00002880: 2020 2020 2020 2020 2020 2027 6661 6365             'face
-00002890: 2720 3a20 4620 7820 3420 696e 7420 6172  ' : F x 4 int ar
-000028a0: 7261 790d 0a20 2020 2020 2020 2020 2020  ray..           
-000028b0: 2027 6564 6765 2720 3a20 4520 7820 3220   'edge' : E x 2 
-000028c0: 696e 7420 6172 7261 790d 0a0d 0a20 2020  int array....   
-000028d0: 2020 2020 2076 6572 7443 6f6f 7220 3a20       vertCoor : 
-000028e0: 5620 7820 3320 666c 6f61 7420 6172 7261  V x 3 float arra
-000028f0: 790d 0a20 2020 2020 2020 2020 2020 2041  y..            A
-00002900: 6e20 6172 7261 7920 6f66 2056 206e 756d  n array of V num
-00002910: 6265 7220 6f66 2078 797a 2076 6572 7465  ber of xyz verte
-00002920: 7820 636f 6f72 6469 6e61 7465 732e 0d0a  x coordinates...
-00002930: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
-00002940: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00002950: 2076 436f 6f72 203d 2062 6173 6556 636f   vCoor = baseVco
-00002960: 6f72 2e63 6f70 7928 290d 0a20 2020 2020  or.copy()..     
-00002970: 2020 2066 7649 6e64 6963 6573 203d 205b     fvIndices = [
-00002980: 5d0d 0a20 2020 2020 2020 2065 7649 6e64  ]..        evInd
-00002990: 6963 6573 203d 205b 5d0d 0a20 2020 2020  ices = []..     
-000029a0: 2020 2023 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e     #............
-000029b0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-000029c0: 2e2e 2e2e 2e2e 2e2e 2e20 2020 200d 0a20  .........    .. 
-000029d0: 2020 2020 2020 2064 6566 2067 6574 5665         def getVe
-000029e0: 7274 6963 6573 4c69 6e65 2864 6567 7265  rticesLine(degre
-000029f0: 652c 206c 6566 7449 6e64 6578 2c20 7269  e, leftIndex, ri
-00002a00: 6768 7449 6e64 6578 2920 3a0d 0a20 2020  ghtIndex) :..   
-00002a10: 2020 2020 2020 2020 2064 6566 2072 6563           def rec
-00002a20: 7572 735f 6564 6765 436f 6f72 2864 6567  urs_edgeCoor(deg
-00002a30: 7265 652c 2069 6e64 6578 4f72 6967 696e  ree, indexOrigin
-00002a40: 2c20 6973 5269 6768 742c 206c 6566 7449  , isRight, leftI
-00002a50: 6e64 6578 2c20 7269 6768 7449 6e64 6578  ndex, rightIndex
-00002a60: 2c20 4569 6e64 6578 2920 3a0d 0a20 2020  , Eindex) :..   
-00002a70: 2020 2020 2020 2020 2020 2020 206d 203d               m =
-00002a80: 2064 6567 7265 6520 2d20 310d 0a20 2020   degree - 1..   
-00002a90: 2020 2020 2020 2020 2020 2020 2064 656c               del
-00002aa0: 7461 203d 2069 6e74 286e 702e 706f 7765  ta = int(np.powe
-00002ab0: 7228 322c 6d29 290d 0a20 2020 2020 2020  r(2,m))..       
-00002ac0: 2020 2020 2020 2020 2069 6620 6973 5269           if isRi
-00002ad0: 6768 7420 3a20 6465 6c74 6120 3d20 2d64  ght : delta = -d
-00002ae0: 656c 7461 0d0a 2020 2020 2020 2020 2020  elta..          
-00002af0: 2020 2020 2020 6920 3d20 696e 6465 784f        i = indexO
-00002b00: 7269 6769 6e20 2d20 6465 6c74 610d 0a20  rigin - delta.. 
-00002b10: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-00002b20: 6964 5f63 6f6f 7220 3d20 6d69 6456 6563  id_coor = midVec
-00002b30: 7446 756e 6328 2076 436f 6f72 5b6c 6566  tFunc( vCoor[lef
-00002b40: 7449 6e64 6578 5d2c 2076 436f 6f72 5b72  tIndex], vCoor[r
-00002b50: 6967 6874 496e 6465 785d 2029 0d0a 2020  ightIndex] )..  
-00002b60: 2020 2020 2020 2020 2020 2020 2020 6375                cu
-00002b70: 7272 656e 7443 6f6f 7249 6e64 6578 203d  rrentCoorIndex =
-00002b80: 206c 656e 2876 436f 6f72 290d 0a20 2020   len(vCoor)..   
-00002b90: 2020 2020 2020 2020 2020 2020 2076 436f               vCo
-00002ba0: 6f72 2e61 7070 656e 6428 6d69 645f 636f  or.append(mid_co
-00002bb0: 6f72 290d 0a20 2020 2020 2020 2020 2020  or)..           
-00002bc0: 2020 2020 2045 696e 6465 785b 695d 203d       Eindex[i] =
-00002bd0: 2063 7572 7265 6e74 436f 6f72 496e 6465   currentCoorInde
-00002be0: 780d 0a20 2020 2020 2020 2020 2020 2020  x..             
-00002bf0: 2020 2069 6620 6d20 3c3d 2030 203a 0d0a     if m <= 0 :..
-00002c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002c10: 2020 2020 6576 496e 6469 6365 732e 6170      evIndices.ap
-00002c20: 7065 6e64 2820 5b6c 6566 7449 6e64 6578  pend( [leftIndex
-00002c30: 2c20 6375 7272 656e 7443 6f6f 7249 6e64  , currentCoorInd
-00002c40: 6578 5d20 2920 2020 2020 2020 2020 2020  ex] )           
-00002c50: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-00002c60: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00002c70: 7649 6e64 6963 6573 2e61 7070 656e 6428  vIndices.append(
-00002c80: 205b 6375 7272 656e 7443 6f6f 7249 6e64   [currentCoorInd
-00002c90: 6578 2c20 7269 6768 7449 6e64 6578 5d20  ex, rightIndex] 
-00002ca0: 2920 2020 2020 2020 2020 2020 2020 2020  )               
-00002cb0: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
-00002cc0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00002cd0: 6e0d 0a20 2020 2020 2020 2020 2020 2020  n..             
-00002ce0: 2020 2072 6563 7572 735f 6564 6765 436f     recurs_edgeCo
-00002cf0: 6f72 286d 2c69 2c46 616c 7365 2c6c 6566  or(m,i,False,lef
-00002d00: 7449 6e64 6578 2c63 7572 7265 6e74 436f  tIndex,currentCo
-00002d10: 6f72 496e 6465 782c 2045 696e 6465 7829  orIndex, Eindex)
-00002d20: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00002d30: 2020 7265 6375 7273 5f65 6467 6543 6f6f    recurs_edgeCoo
-00002d40: 7228 6d2c 692c 5472 7565 2c63 7572 7265  r(m,i,True,curre
-00002d50: 6e74 436f 6f72 496e 6465 782c 7269 6768  ntCoorIndex,righ
-00002d60: 7449 6e64 6578 2c20 4569 6e64 6578 290d  tIndex, Eindex).
-00002d70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00002d80: 2072 6574 7572 6e0d 0a20 2020 2020 2020   return..       
-00002d90: 2020 2020 2023 2e2e 2e2e 2e2e 2e2e 2e2e       #..........
-00002da0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00002db0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e20 2020 200d  ...........    .
-00002dc0: 0a20 2020 2020 2020 2020 2020 2069 4f72  .            iOr
-00002dd0: 6967 696e 203d 2069 6e74 286e 702e 706f  igin = int(np.po
-00002de0: 7765 7228 322c 6465 6772 6565 2929 0d0a  wer(2,degree))..
-00002df0: 2020 2020 2020 2020 2020 2020 4569 6e64              Eind
-00002e00: 6578 203d 205b 4e6f 6e65 5d2a 2869 4f72  ex = [None]*(iOr
-00002e10: 6967 696e 2b31 290d 0a20 2020 2020 2020  igin+1)..       
-00002e20: 2020 2020 2045 696e 6465 785b 305d 203d       Eindex[0] =
-00002e30: 206c 6566 7449 6e64 6578 0d0a 2020 2020   leftIndex..    
-00002e40: 2020 2020 2020 2020 4569 6e64 6578 5b69          Eindex[i
-00002e50: 4f72 6967 696e 5d20 3d20 7269 6768 7449  Origin] = rightI
-00002e60: 6e64 6578 0d0a 2020 2020 2020 2020 2020  ndex..          
-00002e70: 2020 6966 2064 6567 7265 653d 3d30 203a    if degree==0 :
-00002e80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00002e90: 2020 6576 496e 6469 6365 732e 6170 7065    evIndices.appe
-00002ea0: 6e64 2820 5b6c 6566 7449 6e64 6578 2c20  nd( [leftIndex, 
-00002eb0: 7269 6768 7449 6e64 6578 5d20 290d 0a20  rightIndex] ).. 
-00002ec0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00002ed0: 6574 7572 6e20 4569 6e64 6578 0d0a 2020  eturn Eindex..  
-00002ee0: 2020 2020 2020 2020 2020 7265 6375 7273            recurs
-00002ef0: 5f65 6467 6543 6f6f 7228 6465 6772 6565  _edgeCoor(degree
-00002f00: 2c20 694f 7269 6769 6e2c 2046 616c 7365  , iOrigin, False
-00002f10: 2c20 6c65 6674 496e 6465 782c 2072 6967  , leftIndex, rig
-00002f20: 6874 496e 6465 782c 2045 696e 6465 7829  htIndex, Eindex)
-00002f30: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
-00002f40: 7475 726e 2045 696e 6465 780d 0a20 2020  turn Eindex..   
-00002f50: 2020 2020 2023 2e2e 2e2e 2e2e 2e2e 2e2e       #..........
-00002f60: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00002f70: 2e2e 2e2e 2e2e 2e2e 2e2e 2e20 2020 200d  ...........    .
-00002f80: 0a20 2020 2020 2020 2064 6566 2072 6563  .        def rec
-00002f90: 7572 735f 6661 6365 496e 6469 6365 7328  urs_faceIndices(
-00002fa0: 412c 422c 432c 442c 7265 7a29 3a0d 0a20  A,B,C,D,rez):.. 
-00002fb0: 2020 2020 2020 2020 2020 2023 2073 696d             # sim
-00002fc0: 696c 6172 2074 6f20 696e 6e65 7220 6675  ilar to inner fu
-00002fd0: 6e63 7469 6f6e 206f 6620 7472 6961 6e67  nction of triang
-00002fe0: 756c 6174 6542 6173 650d 0a20 2020 2020  ulateBase..     
-00002ff0: 2020 2020 2020 2069 6620 7265 7a3d 3d30         if rez==0
-00003000: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
-00003010: 2020 2020 6162 6320 3d20 5b20 415b 305d      abc = [ A[0]
-00003020: 2c20 425b 305d 2c20 435b 305d 2c20 445b  , B[0], C[0], D[
-00003030: 305d 205d 2020 2020 2020 2020 2020 2020  0] ]            
-00003040: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
-00003050: 2020 2020 2066 7649 6e64 6963 6573 2e61       fvIndices.a
-00003060: 7070 656e 6428 2061 6263 2029 0d0a 2020  ppend( abc )..  
-00003070: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00003080: 7475 726e 0d0a 2020 2020 2020 2020 2020  turn..          
-00003090: 2020 2320 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    # ------------
-000030a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000030b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000030c0: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
-000030d0: 2020 2020 2020 204a 203d 2069 6e74 2820         J = int( 
-000030e0: 286c 656e 2841 292d 3129 2f32 2029 0d0a  (len(A)-1)/2 )..
-000030f0: 2020 2020 2020 2020 2020 2020 4b20 3d20              K = 
-00003100: 4a20 2b20 310d 0a20 2020 2020 2020 2020  J + 1..         
-00003110: 2020 2023 206d 6964 706f 696e 7420 696e     # midpoint in
-00003120: 6469 6365 7320 2e2e 2e2e 2e2e 2e2e 2e2e  dices ..........
-00003130: 2e2e 2e2e 2e0d 0a20 2020 2020 2020 2020  .......         
-00003140: 2020 206d 6964 5f63 6f6f 7220 3d20 6d69     mid_coor = mi
-00003150: 6456 6563 7446 756e 6328 2076 436f 6f72  dVectFunc( vCoor
-00003160: 5b20 445b 4a5d 205d 2c20 7643 6f6f 725b  [ D[J] ], vCoor[
-00003170: 2042 5b4a 5d20 5d20 290d 0a20 2020 2020   B[J] ] )..     
-00003180: 2020 2020 2020 2069 5f45 203d 206c 656e         i_E = len
-00003190: 2876 436f 6f72 290d 0a20 2020 2020 2020  (vCoor)..       
-000031a0: 2020 2020 2076 436f 6f72 2e61 7070 656e       vCoor.appen
-000031b0: 6428 6d69 645f 636f 6f72 290d 0a20 2020  d(mid_coor)..   
-000031c0: 2020 2020 2020 2020 2023 2061 7272 6179           # array
-000031d0: 7320 6f66 2074 6865 2066 6f75 7220 696e  s of the four in
-000031e0: 6e65 7220 7175 6164 7269 6c61 7465 7261  ner quadrilatera
-000031f0: 6c73 202e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ls .............
-00003200: 2e0d 0a20 2020 2020 2020 2020 2020 2070  ...            p
-00003210: 4520 3d20 6765 7456 6572 7469 6365 734c  E = getVerticesL
-00003220: 696e 6528 7265 7a2d 312c 2041 5b4a 5d2c  ine(rez-1, A[J],
-00003230: 2069 5f45 2029 0d0a 2020 2020 2020 2020   i_E )..        
-00003240: 2020 2020 7145 203d 2067 6574 5665 7274      qE = getVert
-00003250: 6963 6573 4c69 6e65 2872 657a 2d31 2c20  icesLine(rez-1, 
-00003260: 425b 4a5d 2c20 695f 4520 290d 0a20 2020  B[J], i_E )..   
-00003270: 2020 2020 2020 2020 2072 4520 3d20 6765           rE = ge
-00003280: 7456 6572 7469 6365 734c 696e 6528 7265  tVerticesLine(re
-00003290: 7a2d 312c 2043 5b4a 5d2c 2069 5f45 2029  z-1, C[J], i_E )
-000032a0: 0d0a 2020 2020 2020 2020 2020 2020 7345  ..            sE
-000032b0: 203d 2067 6574 5665 7274 6963 6573 4c69   = getVerticesLi
-000032c0: 6e65 2872 657a 2d31 2c20 445b 4a5d 2c20  ne(rez-1, D[J], 
-000032d0: 695f 4520 290d 0a20 2020 2020 2020 2020  i_E )..         
-000032e0: 2020 2023 2073 7564 6976 6964 6520 7468     # sudivide th
-000032f0: 6520 666f 7572 2069 6e6e 6572 2071 7561  e four inner qua
-00003300: 6472 6174 6572 616c 7320 2e2e 2e2e 2e2e  draterals ......
-00003310: 2e2e 2e2e 2e2e 2e2e 2e2e 2e0d 0a20 2020  .............   
-00003320: 2020 2020 2020 2020 2072 6563 7572 735f           recurs_
-00003330: 6661 6365 496e 6469 6365 7328 2041 5b3a  faceIndices( A[:
-00003340: 4b5d 2c20 7045 2c20 7345 5b3a 3a2d 315d  K], pE, sE[::-1]
-00003350: 2c20 445b 4a3a 5d2c 2072 657a 2d31 290d  , D[J:], rez-1).
-00003360: 0a20 2020 2020 2020 2020 2020 2072 6563  .            rec
-00003370: 7572 735f 6661 6365 496e 6469 6365 7328  urs_faceIndices(
-00003380: 2042 5b3a 4b5d 2c20 7145 2c20 7045 5b3a   B[:K], qE, pE[:
-00003390: 3a2d 315d 2c20 415b 4a3a 5d2c 2072 657a  :-1], A[J:], rez
-000033a0: 2d31 290d 0a20 2020 2020 2020 2020 2020  -1)..           
-000033b0: 2072 6563 7572 735f 6661 6365 496e 6469   recurs_faceIndi
-000033c0: 6365 7328 2043 5b3a 4b5d 2c20 7245 2c20  ces( C[:K], rE, 
-000033d0: 7145 5b3a 3a2d 315d 2c20 425b 4a3a 5d2c  qE[::-1], B[J:],
-000033e0: 2072 657a 2d31 290d 0a20 2020 2020 2020   rez-1)..       
-000033f0: 2020 2020 2072 6563 7572 735f 6661 6365       recurs_face
-00003400: 496e 6469 6365 7328 2044 5b3a 4b5d 2c20  Indices( D[:K], 
-00003410: 7345 2c20 7245 5b3a 3a2d 315d 2c20 435b  sE, rE[::-1], C[
-00003420: 4a3a 5d2c 2072 657a 2d31 290d 0a20 2020  J:], rez-1)..   
-00003430: 2020 2020 2020 2020 2072 6574 7572 6e0d           return.
-00003440: 0a20 2020 2020 2020 2023 2e2e 2e2e 2e2e  .        #......
-00003450: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00003460: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e0d  ................
-00003470: 0a0d 0a20 2020 2020 2020 2023 2067 656e  ...        # gen
-00003480: 6572 6174 6520 7468 6520 6261 7365 2065  erate the base e
-00003490: 6467 6520 696e 6469 6365 7320 666f 7220  dge indices for 
-000034a0: 6561 6368 2066 6163 6520 0d0a 2020 2020  each face ..    
-000034b0: 2020 2020 6261 7365 4661 6365 4564 6765      baseFaceEdge
-000034c0: 496e 6469 6365 7320 3d20 5b5d 0d0a 2020  Indices = []..  
-000034d0: 2020 2020 2020 6564 6765 4172 7261 7949        edgeArrayI
-000034e0: 6e64 6578 4d61 7472 6978 203d 205b 5b4e  ndexMatrix = [[N
-000034f0: 6f6e 6520 666f 7220 7820 696e 2072 616e  one for x in ran
-00003500: 6765 286c 656e 2876 436f 6f72 2929 5d20  ge(len(vCoor))] 
-00003510: 666f 7220 7920 696e 2072 616e 6765 286c  for y in range(l
-00003520: 656e 2876 436f 6f72 2929 5d20 2020 0d0a  en(vCoor))]   ..
-00003530: 2020 2020 2020 2020 666f 7220 6661 6365          for face
-00003540: 2069 6e20 6261 7365 4661 6365 5665 7274   in baseFaceVert
-00003550: 6578 496e 6469 6365 7320 3a0d 0a20 2020  exIndices :..   
-00003560: 2020 2020 2020 2020 2041 203d 205b 2066           A = [ f
-00003570: 6163 655b 305d 2c66 6163 655b 315d 5d0d  ace[0],face[1]].
-00003580: 0a20 2020 2020 2020 2020 2020 2042 203d  .            B =
-00003590: 205b 2066 6163 655b 315d 2c66 6163 655b   [ face[1],face[
-000035a0: 325d 5d0d 0a20 2020 2020 2020 2020 2020  2]]..           
-000035b0: 2043 203d 205b 2066 6163 655b 325d 2c66   C = [ face[2],f
-000035c0: 6163 655b 335d 5d0d 0a20 2020 2020 2020  ace[3]]..       
-000035d0: 2020 2020 2044 203d 205b 2066 6163 655b       D = [ face[
-000035e0: 335d 2c66 6163 655b 305d 5d0d 0a20 2020  3],face[0]]..   
-000035f0: 2020 2020 2020 2020 2065 6467 6549 6e64           edgeInd
-00003600: 6963 6573 203d 205b 412c 422c 432c 445d  ices = [A,B,C,D]
-00003610: 0d0a 2020 2020 2020 2020 2020 2020 6261  ..            ba
-00003620: 7365 4661 6365 4564 6765 496e 6469 6365  seFaceEdgeIndice
-00003630: 732e 6170 7065 6e64 2865 6467 6549 6e64  s.append(edgeInd
-00003640: 6963 6573 290d 0a20 2020 2020 2020 2020  ices)..         
-00003650: 2020 2066 6f72 2076 6572 7465 7849 6e64     for vertexInd
-00003660: 6578 2069 6e20 6564 6765 496e 6469 6365  ex in edgeIndice
-00003670: 7320 3a0d 0a20 2020 2020 2020 2020 2020  s :..           
-00003680: 2020 2020 2069 203d 2076 6572 7465 7849       i = vertexI
-00003690: 6e64 6578 5b30 5d0d 0a20 2020 2020 2020  ndex[0]..       
-000036a0: 2020 2020 2020 2020 206a 203d 2076 6572           j = ver
-000036b0: 7465 7849 6e64 6578 5b31 5d0d 0a20 2020  texIndex[1]..   
-000036c0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-000036d0: 6564 6765 4172 7261 7949 6e64 6578 4d61  edgeArrayIndexMa
-000036e0: 7472 6978 5b69 5d5b 6a5d 2069 7320 4e6f  trix[i][j] is No
-000036f0: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
-00003700: 2020 2020 2020 2020 2065 6467 6541 7272           edgeArr
-00003710: 6179 496e 6465 784d 6174 7269 785b 695d  ayIndexMatrix[i]
-00003720: 5b6a 5d20 3d20 6765 7456 6572 7469 6365  [j] = getVertice
-00003730: 734c 696e 6528 7265 7a2c 2069 2c20 6a20  sLine(rez, i, j 
-00003740: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00003750: 2020 2020 2020 2065 6467 6541 7272 6179         edgeArray
-00003760: 496e 6465 784d 6174 7269 785b 6a5d 5b69  IndexMatrix[j][i
-00003770: 5d20 3d20 6564 6765 4172 7261 7949 6e64  ] = edgeArrayInd
-00003780: 6578 4d61 7472 6978 5b69 5d5b 6a5d 2e63  exMatrix[i][j].c
-00003790: 6f70 7928 295b 3a3a 2d31 5d0d 0a20 2020  opy()[::-1]..   
-000037a0: 2020 2020 2023 2072 6563 7461 6e67 756c       # rectangul
-000037b0: 6174 6520 7468 6520 6261 7365 2071 7561  ate the base qua
-000037c0: 6472 696c 6174 6572 616c 730d 0a20 2020  drilaterals..   
-000037d0: 2020 2020 2066 6f72 2066 6163 6520 696e       for face in
-000037e0: 2062 6173 6546 6163 6545 6467 6549 6e64   baseFaceEdgeInd
-000037f0: 6963 6573 203a 0d0a 2020 2020 2020 2020  ices :..        
-00003800: 2020 2020 4120 3d20 6564 6765 4172 7261      A = edgeArra
-00003810: 7949 6e64 6578 4d61 7472 6978 5b66 6163  yIndexMatrix[fac
-00003820: 655b 305d 5b30 5d5d 5b66 6163 655b 305d  e[0][0]][face[0]
-00003830: 5b31 5d5d 0d0a 2020 2020 2020 2020 2020  [1]]..          
-00003840: 2020 4220 3d20 6564 6765 4172 7261 7949    B = edgeArrayI
-00003850: 6e64 6578 4d61 7472 6978 5b66 6163 655b  ndexMatrix[face[
-00003860: 315d 5b30 5d5d 5b66 6163 655b 315d 5b31  1][0]][face[1][1
-00003870: 5d5d 0d0a 2020 2020 2020 2020 2020 2020  ]]..            
-00003880: 4320 3d20 6564 6765 4172 7261 7949 6e64  C = edgeArrayInd
-00003890: 6578 4d61 7472 6978 5b66 6163 655b 325d  exMatrix[face[2]
-000038a0: 5b30 5d5d 5b66 6163 655b 325d 5b31 5d5d  [0]][face[2][1]]
-000038b0: 0d0a 2020 2020 2020 2020 2020 2020 4420  ..            D 
-000038c0: 3d20 6564 6765 4172 7261 7949 6e64 6578  = edgeArrayIndex
-000038d0: 4d61 7472 6978 5b66 6163 655b 335d 5b30  Matrix[face[3][0
-000038e0: 5d5d 5b66 6163 655b 335d 5b31 5d5d 0d0a  ]][face[3][1]]..
-000038f0: 2020 2020 2020 2020 2020 2020 7265 6375              recu
-00003900: 7273 5f66 6163 6549 6e64 6963 6573 2841  rs_faceIndices(A
-00003910: 2c42 2c43 2c44 2c72 657a 290d 0a20 2020  ,B,C,D,rez)..   
-00003920: 2020 2020 2076 6572 7465 7843 6f6f 7220       vertexCoor 
-00003930: 3d20 6e70 2e61 7272 6179 2876 436f 6f72  = np.array(vCoor
-00003940: 2920 0d0a 2020 2020 2020 2020 696e 6465  ) ..        inde
-00003950: 784f 626a 203d 207b 2027 6661 6365 273a  xObj = { 'face':
-00003960: 206e 702e 6172 7261 7928 6676 496e 6469   np.array(fvIndi
-00003970: 6365 7329 202c 2027 6564 6765 273a 206e  ces) , 'edge': n
-00003980: 702e 6172 7261 7928 6576 496e 6469 6365  p.array(evIndice
-00003990: 7329 207d 0d0a 2020 2020 2020 2020 7265  s) }..        re
-000039a0: 7475 726e 2069 6e64 6578 4f62 6a20 2c76  turn indexObj ,v
-000039b0: 6572 7465 7843 6f6f 720d 0a0d 0a20 2020  ertexCoor....   
-000039c0: 2040 7374 6174 6963 6d65 7468 6f64 0d0a   @staticmethod..
-000039d0: 2020 2020 6465 6620 636f 6f72 5f63 6f6e      def coor_con
-000039e0: 7665 7274 2878 797a 2c20 746f 6361 7274  vert(xyz, tocart
-000039f0: 3d54 7275 6529 203a 0d0a 2020 2020 2020  =True) :..      
-00003a00: 2020 2222 2243 6f6f 7264 696e 6174 6520    """Coordinate 
-00003a10: 7472 616e 7366 6f72 6d61 7469 6f6e 2e0d  transformation..
-00003a20: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
-00003a30: 2020 2020 2020 546f 2062 6520 6f76 6572        To be over
-00003a40: 7269 6464 6465 6e20 6279 2061 6e79 2073  riddden by any s
-00003a50: 7562 636c 6173 7320 6e6f 7420 696e 2043  ubclass not in C
-00003a60: 6172 7465 7369 616e 2063 6f6f 7264 696e  artesian coordin
-00003a70: 6174 6573 2e0d 0a20 2020 2020 2020 2022  ates...        "
-00003a80: 2222 0d0a 2020 2020 2020 2020 7879 7a20  ""..        xyz 
-00003a90: 3d20 6e70 2e61 7272 6179 2878 797a 290d  = np.array(xyz).
-00003aa0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00003ab0: 7879 7a0d 0a0d 0a20 2020 2040 7374 6174  xyz....    @stat
-00003ac0: 6963 6d65 7468 6f64 0d0a 2020 2020 6465  icmethod..    de
-00003ad0: 6620 5f6d 6170 3344 746f 3244 7371 7561  f _map3Dto2Dsqua
-00003ae0: 7265 2878 797a 2920 3a0d 0a20 2020 2020  re(xyz) :..     
-00003af0: 2020 2022 2222 204d 6170 2073 7572 6661     """ Map surfa
-00003b00: 6365 2074 6f20 7265 6374 616e 6775 6c61  ce to rectangula
-00003b10: 7220 756e 6974 2063 6f6f 7264 696e 6174  r unit coordinat
-00003b20: 6573 2028 302c 3129 2e20 2222 220d 0a0d  es (0,1). """...
-00003b30: 0a20 2020 2020 2020 2078 2c79 2c7a 203d  .        x,y,z =
-00003b40: 2078 797a 0d0a 2020 2020 2020 2020 6120   xyz..        a 
-00003b50: 3d20 2878 2b31 292f 320d 0a20 2020 2020  = (x+1)/2..     
-00003b60: 2020 2062 203d 2028 792b 3129 2f32 0d0a     b = (y+1)/2..
-00003b70: 2020 2020 2020 2020 7265 7475 726e 205b          return [
-00003b80: 612c 625d 0d0a 0d0a 2020 2020 4073 7461  a,b]....    @sta
-00003b90: 7469 636d 6574 686f 640d 0a20 2020 2064  ticmethod..    d
-00003ba0: 6566 205f 7366 6576 2872 657a 2c66 6576  ef _sfev(rez,fev
-00003bb0: 4172 7261 7929 203a 0d0a 2020 2020 2020  Array) :..      
-00003bc0: 2020 2222 2220 4361 6c63 756c 6174 6520    """ Calculate 
-00003bd0: 6e75 6d62 6572 206f 6620 7375 7266 6163  number of surfac
-00003be0: 6520 6661 6365 732c 2065 6467 6573 2c20  e faces, edges, 
-00003bf0: 7665 7274 6963 6573 2e20 2222 220d 0a20  vertices. """.. 
-00003c00: 2020 2020 2020 2023 2076 6573 7469 6769         # vestigi
-00003c10: 616c 0d0a 2020 2020 2020 2020 466f 2c20  al..        Fo, 
-00003c20: 7068 692c 2056 7820 3d20 6665 7641 7272  phi, Vx = fevArr
-00003c30: 6179 0d0a 2020 2020 2020 2020 6574 6120  ay..        eta 
-00003c40: 3d20 6e70 2e70 6f77 6572 2832 2c72 657a  = np.power(2,rez
-00003c50: 290d 0a20 2020 2020 2020 2046 203d 2065  )..        F = e
-00003c60: 7461 2a65 7461 2a46 6f0d 0a20 2020 2020  ta*eta*Fo..     
-00003c70: 2020 2045 203d 206e 702e 696e 7428 2033     E = np.int( 3
-00003c80: 2a46 2f32 202b 2065 7461 2a70 6869 2029  *F/2 + eta*phi )
-00003c90: 0d0a 2020 2020 2020 2020 5620 3d20 6e70  ..        V = np
-00003ca0: 2e69 6e74 2820 462f 3220 2b20 6574 612a  .int( F/2 + eta*
-00003cb0: 7068 6920 2b20 5678 2029 0d0a 2020 2020  phi + Vx )..    
-00003cc0: 2020 2020 7265 7475 726e 205b 462c 452c      return [F,E,
-00003cd0: 565d 0d0a 0d0a 2020 2020 4063 6c61 7373  V]....    @class
-00003ce0: 6d65 7468 6f64 0d0a 2020 2020 6465 6620  method..    def 
-00003cf0: 5f67 7269 645f 6661 6365 5f69 6e64 6963  _grid_face_indic
-00003d00: 6573 2863 6c73 2c55 2c20 562c 2069 7353  es(cls,U, V, isS
-00003d10: 706c 6974 3d46 616c 7365 2c20 6973 5472  plit=False, isTr
-00003d20: 6961 3d46 616c 7365 2920 3a0d 0a20 2020  ia=False) :..   
-00003d30: 2020 2020 2022 2222 206d 6574 686f 6420       """ method 
-00003d40: 6f6e 6c79 2063 616c 6c65 6420 6279 2074  only called by t
-00003d50: 6865 2063 6c61 7373 6d65 7468 6f64 205f  he classmethod _
-00003d60: 7371 7561 7265 5f6e 6574 206f 720d 0a20  square_net or.. 
-00003d70: 2020 2020 2020 2020 2020 2074 6865 2043             the C
-00003d80: 796c 696e 6472 6963 616c 5375 7266 6163  ylindricalSurfac
-00003d90: 6520 636c 6173 736d 6574 686f 6420 5f63  e classmethod _c
-00003da0: 796c 5f76 6f6c 5f73 7175 6172 655f 6e65  yl_vol_square_ne
-00003db0: 740d 0a20 2020 2020 2020 2022 2222 0d0a  t..        """..
-00003dc0: 2020 2020 2020 2020 6966 2069 7353 706c          if isSpl
-00003dd0: 6974 203a 0d0a 2020 2020 2020 2020 2020  it :..          
-00003de0: 2020 7420 3d20 6e70 2e6c 696e 7370 6163    t = np.linspac
-00003df0: 6528 302c 562a 2855 2b31 292d 312c 562a  e(0,V*(U+1)-1,V*
-00003e00: 2855 2b31 292c 6474 7970 653d 696e 7420  (U+1),dtype=int 
-00003e10: 290d 0a20 2020 2020 2020 2020 2020 2074  )..            t
-00003e20: 7320 3d20 742e 7265 7368 6170 6528 2028  s = t.reshape( (
-00003e30: 562c 552b 3129 2029 0d0a 2020 2020 2020  V,U+1) )..      
-00003e40: 2020 2020 2020 6120 3d20 7473 5b3a 2c30        a = ts[:,0
-00003e50: 3a55 5d2e 666c 6174 7465 6e28 290d 0a20  :U].flatten().. 
-00003e60: 2020 2020 2020 2020 2020 2066 696e 6478             findx
-00003e70: 203d 206e 702e 6172 7261 7928 205b 2061   = np.array( [ a
-00003e80: 2c20 612b 312c 2061 2b55 2b32 2c20 612b  , a+1, a+U+2, a+
-00003e90: 552b 3120 5d20 290d 0a20 2020 2020 2020  U+1 ] )..       
-00003ea0: 2065 6c73 6520 3a20 2020 200d 0a20 2020   else :    ..   
-00003eb0: 2020 2020 2020 2020 2061 203d 206e 702e           a = np.
-00003ec0: 6c69 6e73 7061 6365 2830 2c56 2a55 2d31  linspace(0,V*U-1
-00003ed0: 2c56 2a55 2c64 7479 7065 3d69 6e74 2029  ,V*U,dtype=int )
-00003ee0: 0d0a 2020 2020 2020 2020 2020 2020 6273  ..            bs
-00003ef0: 203d 2061 2e72 6573 6861 7065 2820 2856   = a.reshape( (V
-00003f00: 2c55 2920 292e 540d 0a20 2020 2020 2020  ,U) ).T..       
-00003f10: 2020 2020 206f 7264 6572 203d 206e 702e       order = np.
-00003f20: 6170 7065 6e64 286e 702e 6c69 6e73 7061  append(np.linspa
-00003f30: 6365 2831 2c55 2d31 2c55 2d31 2c64 7479  ce(1,U-1,U-1,dty
-00003f40: 7065 3d69 6e74 292c 3029 0d0a 2020 2020  pe=int),0)..    
-00003f50: 2020 2020 2020 2020 6220 3d20 6273 5b6f          b = bs[o
-00003f60: 7264 6572 5d2e 542e 666c 6174 7465 6e28  rder].T.flatten(
-00003f70: 290d 0a20 2020 2020 2020 2020 2020 2066  )..            f
-00003f80: 696e 6478 203d 206e 702e 6172 7261 7928  indx = np.array(
-00003f90: 205b 2061 2c20 622c 2062 2b55 2c20 612b   [ a, b, b+U, a+
-00003fa0: 5520 5d20 290d 0a20 2020 2020 2020 2069  U ] )..        i
-00003fb0: 6620 6973 5472 6961 203a 0d0a 2020 2020  f isTria :..    
-00003fc0: 2020 2020 2020 2020 612c 622c 632c 6420          a,b,c,d 
-00003fd0: 3d20 6669 6e64 780d 0a20 2020 2020 2020  = findx..       
-00003fe0: 2020 2020 2066 696e 6478 203d 206e 702e       findx = np.
-00003ff0: 636f 6e63 6174 656e 6174 6528 2028 205b  concatenate( ( [
-00004000: 612c 622c 635d 2c5b 632c 642c 615d 2029  a,b,c],[c,d,a] )
-00004010: 2c20 6178 6973 3d31 2020 2029 0d0a 2020  , axis=1   )..  
-00004020: 2020 2020 2020 7265 7475 726e 2066 696e        return fin
-00004030: 6478 2e54 0d0a 0d0a 2020 2020 4063 6c61  dx.T....    @cla
-00004040: 7373 6d65 7468 6f64 0d0a 2020 2020 6465  ssmethod..    de
-00004050: 6620 5f73 7175 6172 655f 6e65 7428 636c  f _square_net(cl
-00004060: 732c 206e 756d 562c 206e 756d 552c 2062  s, numV, numU, b
-00004070: 6173 6574 7970 652c 6d69 6e52 6164 2c20  asetype,minRad, 
-00004080: 7370 6c69 7453 697a 652c 206e 616d 652c  splitSize, name,
-00004090: 202a 2a6b 7761 7267 7329 203a 0d0a 2020   **kwargs) :..  
-000040a0: 2020 2020 2020 2222 2220 6d65 7468 6f64        """ method
-000040b0: 206f 6e6c 7920 6361 6c6c 6564 2062 7920   only called by 
-000040c0: 696e 6865 7269 7465 6420 636c 6173 7320  inherited class 
-000040d0: 636c 6173 736d 6574 686f 6473 2027 6772  classmethods 'gr
-000040e0: 6964 272e 2022 2222 0d0a 0d0a 2020 2020  id'. """....    
-000040f0: 2020 2020 6469 764c 696d 6974 7320 3d20      divLimits = 
-00004100: 5b31 2c33 5d0d 0a20 2020 2020 2020 2069  [1,3]..        i
-00004110: 6620 636c 732e 5f67 656f 6d54 7970 6520  f cls._geomType 
-00004120: 6973 205f 434f 4f52 5359 535b 2758 595a  is _COORSYS['XYZ
-00004130: 275d 2020 3a20 6469 764c 696d 6974 7320  ']  : divLimits 
-00004140: 3d20 5b31 2c31 5d0d 0a20 2020 2020 2020  = [1,1]..       
-00004150: 2069 6620 636c 732e 5f67 656f 6d54 7970   if cls._geomTyp
-00004160: 6520 6973 205f 434f 4f52 5359 535b 2753  e is _COORSYS['S
-00004170: 5048 4552 4943 414c 275d 203a 2064 6976  PHERICAL'] : div
-00004180: 4c69 6d69 7473 203d 205b 322c 335d 0d0a  Limits = [2,3]..
-00004190: 2020 2020 2020 2020 6966 206e 756d 5620          if numV 
-000041a0: 3c20 6469 764c 696d 6974 735b 305d 203a  < divLimits[0] :
-000041b0: 0d0a 2020 2020 2020 2020 2020 2020 7261  ..            ra
-000041c0: 6973 6520 5661 6c75 6545 7272 6f72 2827  ise ValueError('
-000041d0: 4772 6964 2064 6976 6973 696f 6e20 7b7d  Grid division {}
-000041e0: 206d 7573 7420 6265 2067 7265 6174 6572   must be greater
-000041f0: 206f 7220 6571 7561 6c20 746f 207b 7d27   or equal to {}'
-00004200: 2e66 6f72 6d61 7428 7374 7228 6e75 6d56  .format(str(numV
-00004210: 292c 6469 764c 696d 6974 735b 305d 2029  ),divLimits[0] )
-00004220: 290d 0a20 2020 2020 2020 2069 6620 6e75  )..        if nu
-00004230: 6d55 203c 2064 6976 4c69 6d69 7473 5b31  mU < divLimits[1
-00004240: 5d20 3a0d 0a20 2020 2020 2020 2020 2020  ] :..           
-00004250: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-00004260: 7228 2747 7269 6420 6469 7669 7369 6f6e  r('Grid division
-00004270: 207b 7d20 6d75 7374 2062 6520 6772 6561   {} must be grea
-00004280: 7465 7220 6f72 2065 7175 616c 2074 6f20  ter or equal to 
-00004290: 7b7d 272e 666f 726d 6174 2873 7472 286e  {}'.format(str(n
-000042a0: 756d 5529 2c64 6976 4c69 6d69 7473 5b31  umU),divLimits[1
-000042b0: 5d20 2929 0d0a 0d0a 2020 2020 2020 2020  ] ))....        
-000042c0: 6966 2062 6173 6574 7970 6520 3d3d 204e  if basetype == N
-000042d0: 6f6e 6520 3a20 6261 7365 7479 7065 203d  one : basetype =
-000042e0: 2027 6427 0d0a 2020 2020 2020 2020 6966   'd'..        if
-000042f0: 206d 696e 5261 6420 6973 204e 6f6e 6520   minRad is None 
-00004300: 3a20 6d69 6e52 6164 203d 205f 4d49 4e52  : minRad = _MINR
-00004310: 4144 0d0a 2020 2020 2020 2020 6966 2073  AD..        if s
-00004320: 706c 6974 5369 7a65 2069 7320 4e6f 6e65  plitSize is None
-00004330: 203a 2073 706c 6974 5369 7a65 203d 205f   : splitSize = _
-00004340: 5350 4c49 5453 495a 450d 0a0d 0a20 2020  SPLITSIZE....   
-00004350: 2020 2020 2062 6173 6574 7970 6520 3d20       basetype = 
-00004360: 6261 7365 7479 7065 2e6c 6f77 6572 2829  basetype.lower()
-00004370: 0d0a 2020 2020 2020 2020 6261 7365 6c69  ..        baseli
-00004380: 7374 203d 205b 2764 272c 2773 272c 2771  st = ['d','s','q
-00004390: 272c 2777 272c 2772 272c 2778 275d 0d0a  ','w','r','x']..
-000043a0: 2020 2020 2020 2020 6966 2062 6173 6574          if baset
-000043b0: 7970 6520 6e6f 7420 696e 2062 6173 656c  ype not in basel
-000043c0: 6973 7420 3a0d 0a20 2020 2020 2020 2020  ist :..         
-000043d0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-000043e0: 726f 7228 2247 7269 6420 6261 7365 7479  ror("Grid basety
-000043f0: 7065 2027 7b7d 2720 6973 206e 6f74 2072  pe '{}' is not r
-00004400: 6563 6f67 6e69 7a65 642e 2050 6f73 7369  ecognized. Possi
-00004410: 626c 6520 7661 6c75 6573 2061 7265 3a20  ble values are: 
-00004420: 7b7d 2e22 2e66 6f72 6d61 7428 6261 7365  {}.".format(base
-00004430: 7479 7065 2c6c 6973 7428 6261 7365 6c69  type,list(baseli
-00004440: 7374 2929 290d 0a0d 0a20 2020 2020 2020  st)))....       
-00004450: 2069 7353 706c 6974 203d 2028 6261 7365   isSplit = (base
-00004460: 7479 7065 203d 3d20 2773 2729 206f 7220  type == 's') or 
-00004470: 2862 6173 6574 7970 6520 3d3d 2027 7727  (basetype == 'w'
-00004480: 2920 6f72 2028 6261 7365 7479 7065 203d  ) or (basetype =
-00004490: 3d20 2778 2729 0d0a 2020 2020 2020 2020  = 'x')..        
-000044a0: 6e65 6564 7354 7269 6167 203d 206e 6f74  needsTriag = not
-000044b0: 2028 2028 6261 7365 7479 7065 203d 3d20   ( (basetype == 
-000044c0: 2772 2729 206f 7220 2862 6173 6574 7970  'r') or (basetyp
-000044d0: 6520 3d3d 2027 7827 2920 2029 0d0a 2020  e == 'x')  )..  
-000044e0: 2020 2020 2020 6861 7343 656e 7465 7220        hasCenter 
-000044f0: 3d20 2862 6173 6574 7970 6520 3d3d 2027  = (basetype == '
-00004500: 6427 2920 6f72 2028 6261 7365 7479 7065  d') or (basetype
-00004510: 203d 3d20 2773 2729 0d0a 2020 2020 2020   == 's')..      
-00004520: 2020 2320 6861 7343 656e 7465 7220 646f    # hasCenter do
-00004530: 6573 206e 6f74 2061 7070 6c79 2066 6f72  es not apply for
-00004540: 2063 796c 696e 6472 6963 616c 2067 7269   cylindrical gri
-00004550: 6473 206f 6620 7468 6973 2074 7970 652e  ds of this type.
-00004560: 0d0a 2020 2020 2020 2020 6966 2063 6c73  ..        if cls
-00004570: 2e5f 6765 6f6d 5479 7065 2069 7320 5f43  ._geomType is _C
-00004580: 4f4f 5253 5953 5b27 4359 4c49 4e44 5249  OORSYS['CYLINDRI
-00004590: 4341 4c27 5d20 3a20 6861 7343 656e 7465  CAL'] : hasCente
-000045a0: 723d 4661 6c73 650d 0a0d 0a20 2020 2020  r=False....     
-000045b0: 2020 2023 204e 6f74 653a 206e 756d 5820     # Note: numX 
-000045c0: 616e 6420 6e75 6d5f 5820 6172 6520 7468  and num_X are th
-000045d0: 6520 6e75 6d62 6572 206f 6620 6469 7669  e number of divi
-000045e0: 7369 6f6e 7320 616e 6420 7468 6520 6e75  sions and the nu
-000045f0: 6d62 6572 206f 6620 636f 6f72 2070 6f73  mber of coor pos
-00004600: 6974 696f 6e73 2e0d 0a20 2020 2020 2020  itions...       
-00004610: 2069 6620 636c 732e 5f67 656f 6d54 7970   if cls._geomTyp
-00004620: 6520 6973 205f 434f 4f52 5359 535b 2758  e is _COORSYS['X
-00004630: 595a 275d 2020 3a0d 0a20 2020 2020 2020  YZ']  :..       
-00004640: 2020 2020 2069 7353 706c 6974 203d 2054       isSplit = T
-00004650: 7275 650d 0a20 2020 2020 2020 2020 2020  rue..           
-00004660: 2068 6173 4365 6e74 6572 203d 2046 616c   hasCenter = Fal
-00004670: 7365 0d0a 2020 2020 2020 2020 2020 2020  se..            
-00004680: 6e75 6d5f 552c 6d69 6e5f 552c 206d 6178  num_U,min_U, max
-00004690: 5f55 203d 206e 756d 552b 312c 2d31 2e30  _U = numU+1,-1.0
-000046a0: 2c31 2e30 0d0a 2020 2020 2020 2020 2020  ,1.0..          
-000046b0: 2020 6e75 6d5f 5620 3d20 6e75 6d56 202b    num_V = numV +
-000046c0: 2031 0d0a 2020 2020 2020 2020 2020 2020   1..            
-000046d0: 636f 6f72 5f55 203d 206e 702e 6c69 6e73  coor_U = np.lins
-000046e0: 7061 6365 286d 696e 5f55 2c6d 6178 5f55  pace(min_U,max_U
-000046f0: 2c6e 756d 5f55 290d 0a20 2020 2020 2020  ,num_U)..       
-00004700: 2020 2020 2055 5f63 6f6f 7220 3d20 6e70       U_coor = np
-00004710: 2e74 696c 6528 636f 6f72 5f55 2c6e 756d  .tile(coor_U,num
-00004720: 5f56 290d 0a20 2020 2020 2020 2065 6c73  _V)..        els
-00004730: 6520 3a0d 0a20 2020 2020 2020 2020 2020  e :..           
-00004740: 2023 2054 2061 6e67 6c65 2072 616e 6765   # T angle range
-00004750: 732c 2075 7365 6420 666f 7220 6469 736b  s, used for disk
-00004760: 2c63 796c 696e 6465 7220 616e 6420 7370  ,cylinder and sp
-00004770: 6865 7265 2e2e 2e2e 2e0d 0a20 2020 2020  here.......     
-00004780: 2020 2020 2020 206e 756d 5f55 203d 206e         num_U = n
-00004790: 756d 552b 3120 6966 2069 7353 706c 6974  umU+1 if isSplit
-000047a0: 2065 6c73 6520 6e75 6d55 0d0a 2020 2020   else numU..    
-000047b0: 2020 2020 2020 2020 6966 2068 6173 4365          if hasCe
-000047c0: 6e74 6572 203a 0d0a 2020 2020 2020 2020  nter :..        
-000047d0: 2020 2020 2020 2020 6e75 6d5f 5620 3d20          num_V = 
-000047e0: 6e75 6d56 2069 6620 636c 732e 5f67 656f  numV if cls._geo
-000047f0: 6d54 7970 6520 6973 205f 434f 4f52 5359  mType is _COORSY
-00004800: 535b 2750 4f4c 4152 275d 2065 6c73 6520  S['POLAR'] else 
-00004810: 6e75 6d56 2d31 0d0a 2020 2020 2020 2020  numV-1..        
-00004820: 2020 2020 656c 7365 203a 0d0a 2020 2020      else :..    
-00004830: 2020 2020 2020 2020 2020 2020 6e75 6d5f              num_
-00004840: 5620 3d20 6e75 6d56 2b31 0d0a 2020 2020  V = numV+1..    
-00004850: 2020 2020 2020 2020 6d69 6e5f 5520 3d20          min_U = 
-00004860: 302e 300d 0a20 2020 2020 2020 2020 2020  0.0..           
-00004870: 206d 6178 5f55 203d 2028 312d 312f 6e75   max_U = (1-1/nu
-00004880: 6d5f 5529 2a32 2a6e 702e 7069 0d0a 2020  m_U)*2*np.pi..  
-00004890: 2020 2020 2020 2020 2020 6966 2069 7353            if isS
-000048a0: 706c 6974 203a 206d 6178 5f55 203d 2028  plit : max_U = (
-000048b0: 322d 7370 6c69 7453 697a 6529 2a6e 702e  2-splitSize)*np.
-000048c0: 7069 0d0a 2020 2020 2020 2020 2020 2020  pi..            
-000048d0: 636f 6f72 5f55 203d 206e 702e 6c69 6e73  coor_U = np.lins
-000048e0: 7061 6365 286d 696e 5f55 2c6d 6178 5f55  pace(min_U,max_U
-000048f0: 2c6e 756d 5f55 290d 0a20 2020 2020 2020  ,num_U)..       
-00004900: 2020 2020 2055 5f63 6f6f 7220 3d20 6e70       U_coor = np
-00004910: 2e74 696c 6528 636f 6f72 5f55 2c6e 756d  .tile(coor_U,num
-00004920: 5f56 290d 0a20 2020 2020 2020 2074 6f74  _V)..        tot
-00004930: 5665 7274 7320 3d20 6e75 6d5f 552a 6e75  Verts = num_U*nu
-00004940: 6d5f 560d 0a0d 0a20 2020 2020 2020 2069  m_V....        i
-00004950: 6620 636c 732e 5f67 656f 6d54 7970 6520  f cls._geomType 
-00004960: 6973 205f 434f 4f52 5359 535b 2758 595a  is _COORSYS['XYZ
-00004970: 275d 203a 0d0a 2020 2020 2020 2020 2020  '] :..          
-00004980: 2020 7661 6c5f 5720 3d20 302e 3020 2023    val_W = 0.0  #
-00004990: 207a 2069 7320 636f 6e73 7461 6e74 2061   z is constant a
-000049a0: 7420 302e 0d0a 2020 2020 2020 2020 2020  t 0...          
-000049b0: 2020 636f 6f72 5f56 203d 2020 6e70 2e6c    coor_V =  np.l
-000049c0: 696e 7370 6163 6528 2d31 2e30 2c31 2e30  inspace(-1.0,1.0
-000049d0: 2c6e 756d 5f56 290d 0a20 2020 2020 2020  ,num_V)..       
-000049e0: 2020 2020 206f 7264 6572 5f61 6263 203d       order_abc =
-000049f0: 206c 616d 6264 6120 752c 762c 7720 3a5b   lambda u,v,w :[
-00004a00: 752c 762c 775d 0d0a 2020 2020 2020 2020  u,v,w]..        
-00004a10: 6966 2063 6c73 2e5f 6765 6f6d 5479 7065  if cls._geomType
-00004a20: 2069 7320 5f43 4f4f 5253 5953 5b27 504f   is _COORSYS['PO
-00004a30: 4c41 5227 5d20 3a0d 0a20 2020 2020 2020  LAR'] :..       
-00004a40: 2020 2020 2076 616c 5f57 203d 2030 2e30       val_W = 0.0
-00004a50: 2020 2320 7a20 6973 2063 6f6e 7374 616e    # z is constan
-00004a60: 7420 6174 2030 2e0d 0a20 2020 2020 2020  t at 0...       
-00004a70: 2020 2020 2065 6e64 5f56 203d 2031 2f6e       end_V = 1/n
-00004a80: 756d 5620 6966 2068 6173 4365 6e74 6572  umV if hasCenter
-00004a90: 2065 6c73 6520 6d69 6e52 6164 0d0a 2020   else minRad..  
-00004aa0: 2020 2020 2020 2020 2020 636f 6f72 5f56            coor_V
-00004ab0: 203d 206e 702e 6c69 6e73 7061 6365 2831   = np.linspace(1
-00004ac0: 2e30 2c65 6e64 5f56 2c6e 756d 5f56 290d  .0,end_V,num_V).
-00004ad0: 0a20 2020 2020 2020 2020 2020 206f 7264  .            ord
-00004ae0: 6572 5f61 6263 203d 206c 616d 6264 6120  er_abc = lambda 
-00004af0: 752c 762c 7720 3a20 5b76 2c75 2c77 5d0d  u,v,w : [v,u,w].
-00004b00: 0a20 2020 2020 2020 2069 6620 636c 732e  .        if cls.
-00004b10: 5f67 656f 6d54 7970 6520 6973 205f 434f  _geomType is _CO
-00004b20: 4f52 5359 535b 2743 594c 494e 4452 4943  ORSYS['CYLINDRIC
-00004b30: 414c 275d 203a 0d0a 2020 2020 2020 2020  AL'] :..        
-00004b40: 2020 2020 7661 6c5f 5720 3d20 312e 3020      val_W = 1.0 
-00004b50: 2023 2072 2069 7320 636f 6e73 7461 6e74   # r is constant
-00004b60: 2061 7420 312e 0d0a 2020 2020 2020 2020   at 1...        
-00004b70: 2020 2020 636f 6f72 5f56 203d 2020 6e70      coor_V =  np
-00004b80: 2e6c 696e 7370 6163 6528 2d31 2e30 2c31  .linspace(-1.0,1
-00004b90: 2e30 2c6e 756d 5f56 290d 0a20 2020 2020  .0,num_V)..     
-00004ba0: 2020 2020 2020 206f 7264 6572 5f61 6263         order_abc
-00004bb0: 203d 206c 616d 6264 6120 752c 762c 7720   = lambda u,v,w 
-00004bc0: 3a20 5b77 2c75 2c76 5d0d 0a20 2020 2020  : [w,u,v]..     
-00004bd0: 2020 2069 6620 636c 732e 5f67 656f 6d54     if cls._geomT
-00004be0: 7970 6520 6973 205f 434f 4f52 5359 535b  ype is _COORSYS[
-00004bf0: 2753 5048 4552 4943 414c 275d 203a 0d0a  'SPHERICAL'] :..
-00004c00: 2020 2020 2020 2020 2020 2020 7661 6c5f              val_
-00004c10: 5720 3d20 312e 3020 2023 2072 2069 7320  W = 1.0  # r is 
-00004c20: 636f 6e73 7461 6e74 2061 7420 312e 0d0a  constant at 1...
-00004c30: 2020 2020 2020 2020 2020 2020 7374 5f61              st_a
-00004c40: 6e67 6c65 203d 206e 702e 7069 2f6e 756d  ngle = np.pi/num
-00004c50: 5620 6966 2068 6173 4365 6e74 6572 2065  V if hasCenter e
-00004c60: 6c73 6520 6e70 2e61 7263 7369 6e28 6d69  lse np.arcsin(mi
-00004c70: 6e52 6164 290d 0a20 2020 2020 2020 2020  nRad)..         
-00004c80: 2020 2073 7474 5f56 203d 206e 702e 7069     stt_V = np.pi
-00004c90: 202d 2073 745f 616e 676c 650d 0a20 2020   - st_angle..   
-00004ca0: 2020 2020 2020 2020 2065 6e64 5f56 203d           end_V =
-00004cb0: 2073 745f 616e 676c 650d 0a20 2020 2020   st_angle..     
-00004cc0: 2020 2020 2020 2063 6f6f 725f 5620 3d20         coor_V = 
-00004cd0: 206e 702e 6c69 6e73 7061 6365 2873 7474   np.linspace(stt
-00004ce0: 5f56 2c65 6e64 5f56 2c6e 756d 5f56 290d  _V,end_V,num_V).
-00004cf0: 0a20 2020 2020 2020 2020 2020 206f 7264  .            ord
-00004d00: 6572 5f61 6263 203d 206c 616d 6264 6120  er_abc = lambda 
-00004d10: 752c 762c 7720 3a20 5b77 2c75 2c76 5d0d  u,v,w : [w,u,v].
-00004d20: 0a0d 0a20 2020 2020 2020 2057 5f63 6f6f  ...        W_coo
-00004d30: 7220 3d20 6e70 2e74 696c 6528 7661 6c5f  r = np.tile(val_
-00004d40: 572c 746f 7456 6572 7473 290d 0a20 2020  W,totVerts)..   
-00004d50: 2020 2020 2056 5f63 6f6f 7220 3d20 6e70       V_coor = np
-00004d60: 2e74 696c 6528 636f 6f72 5f56 2c28 6e75  .tile(coor_V,(nu
-00004d70: 6d5f 552c 3129 290d 0a20 2020 2020 2020  m_U,1))..       
-00004d80: 2056 5f63 6f6f 7220 3d20 6e70 2e72 6176   V_coor = np.rav
-00004d90: 656c 2856 5f63 6f6f 722c 6f72 6465 723d  el(V_coor,order=
-00004da0: 2746 2729 0d0a 0d0a 2020 2020 2020 2020  'F')....        
-00004db0: 6162 6320 3d20 6f72 6465 725f 6162 6328  abc = order_abc(
-00004dc0: 555f 636f 6f72 2c56 5f63 6f6f 722c 575f  U_coor,V_coor,W_
-00004dd0: 636f 6f72 290d 0a20 2020 2020 2020 2061  coor)..        a
-00004de0: 6263 203d 206e 702e 6172 7261 7928 6162  bc = np.array(ab
-00004df0: 6329 0d0a 2020 2020 2020 2020 7879 7a20  c)..        xyz 
-00004e00: 3d20 636c 732e 636f 6f72 5f63 6f6e 7665  = cls.coor_conve
-00004e10: 7274 2861 6263 2c54 7275 6529 0d0a 2020  rt(abc,True)..  
-00004e20: 2020 2020 2020 7665 7274 7320 3d20 6e70        verts = np
-00004e30: 2e61 7272 6179 2878 797a 292e 540d 0a20  .array(xyz).T.. 
-00004e40: 2020 2020 2020 206e 756d 5674 203d 206e         numVt = n
-00004e50: 756d 5f56 2d31 2069 6620 6861 7343 656e  um_V-1 if hasCen
-00004e60: 7465 7220 656c 7365 206e 756d 560d 0a20  ter else numV.. 
-00004e70: 2020 2020 2020 2066 6163 6549 6e64 6963         faceIndic
-00004e80: 6573 203d 2063 6c73 2e5f 6772 6964 5f66  es = cls._grid_f
-00004e90: 6163 655f 696e 6469 6365 7328 6e75 6d55  ace_indices(numU
-00004ea0: 2c6e 756d 5674 2c69 7353 706c 6974 2c6e  ,numVt,isSplit,n
-00004eb0: 6565 6473 5472 6961 6729 0d0a 0d0a 2020  eedsTriag)....  
-00004ec0: 2020 2020 2020 6966 2068 6173 4365 6e74        if hasCent
-00004ed0: 6572 203a 0d0a 2020 2020 2020 2020 2020  er :..          
-00004ee0: 2020 2320 6164 6420 746f 7020 7472 6961    # add top tria
-00004ef0: 6e67 756c 6172 2066 6163 6573 2066 6f72  ngular faces for
-00004f00: 2070 6f6c 6172 2026 2073 7068 6572 6963   polar & spheric
-00004f10: 616c 2073 7572 6661 6365 7320 2e2e 2e0d  al surfaces ....
-00004f20: 0a20 2020 2020 2020 2020 2020 2074 6f70  .            top
-00004f30: 5665 7274 203d 206e 702e 6172 7261 7928  Vert = np.array(
-00004f40: 5b5b 302e 302c 302e 302c 7661 6c5f 575d  [[0.0,0.0,val_W]
-00004f50: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
-00004f60: 746f 7049 6e64 6578 203d 2074 6f74 5665  topIndex = totVe
-00004f70: 7274 730d 0a20 2020 2020 2020 2020 2020  rts..           
-00004f80: 2073 7461 7274 496e 6465 7820 3d20 746f   startIndex = to
-00004f90: 7049 6e64 6578 202d 206e 756d 5f55 0d0a  pIndex - num_U..
-00004fa0: 2020 2020 2020 2020 2020 2020 656e 6449              endI
-00004fb0: 6e64 6578 203d 2074 6f70 496e 6465 782d  ndex = topIndex-
-00004fc0: 3220 6966 2069 7353 706c 6974 2065 6c73  2 if isSplit els
-00004fd0: 6520 746f 7049 6e64 6578 2d31 0d0a 2020  e topIndex-1..  
-00004fe0: 2020 2020 2020 2020 2020 6120 3d20 6e70            a = np
-00004ff0: 2e6c 696e 7370 6163 6528 7374 6172 7449  .linspace(startI
-00005000: 6e64 6578 2c65 6e64 496e 6465 782c 6e75  ndex,endIndex,nu
-00005010: 6d55 2c64 7479 7065 3d69 6e74 290d 0a20  mU,dtype=int).. 
-00005020: 2020 2020 2020 2020 2020 2062 203d 2061             b = a
-00005030: 2b31 2069 6620 6973 5370 6c69 7420 656c  +1 if isSplit el
-00005040: 7365 206e 702e 6170 7065 6e64 2820 615b  se np.append( a[
-00005050: 313a 5d2c 205b 7374 6172 7449 6e64 6578  1:], [startIndex
-00005060: 5d20 290d 0a20 2020 2020 2020 2020 2020  ] )..           
-00005070: 2063 203d 206e 702e 6675 6c6c 286e 756d   c = np.full(num
-00005080: 552c 746f 7049 6e64 6578 290d 0a20 2020  U,topIndex)..   
-00005090: 2020 2020 2020 2020 2061 6263 203d 206e           abc = n
-000050a0: 702e 6172 7261 7928 5b61 2c62 2c63 5d29  p.array([a,b,c])
-000050b0: 2e54 0d0a 2020 2020 2020 2020 2020 2020  .T..            
-000050c0: 7665 7274 7320 3d20 6e70 2e61 7070 656e  verts = np.appen
-000050d0: 6428 7665 7274 732c 746f 7056 6572 742c  d(verts,topVert,
-000050e0: 2061 7869 733d 3029 0d0a 2020 2020 2020   axis=0)..      
-000050f0: 2020 2020 2020 6661 6365 496e 6469 6365        faceIndice
-00005100: 7320 3d20 6e70 2e61 7070 656e 6428 6661  s = np.append(fa
-00005110: 6365 496e 6469 6365 732c 6162 632c 2061  ceIndices,abc, a
-00005120: 7869 733d 3029 0d0a 2020 2020 2020 2020  xis=0)..        
-00005130: 2020 2020 6966 2063 6c73 2e5f 6765 6f6d      if cls._geom
-00005140: 5479 7065 2069 7320 5f43 4f4f 5253 5953  Type is _COORSYS
-00005150: 5b27 5350 4845 5249 4341 4c27 5d20 3a0d  ['SPHERICAL'] :.
-00005160: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00005170: 2023 2061 6464 2062 6f74 746f 6d20 7472   # add bottom tr
-00005180: 6961 6e67 756c 6172 2066 6163 6573 2066  iangular faces f
-00005190: 6f72 2073 7068 6572 6963 616c 2073 7572  or spherical sur
-000051a0: 6661 6365 7320 2e2e 2e0d 0a20 2020 2020  faces .....     
-000051b0: 2020 2020 2020 2020 2020 2062 746d 5665             btmVe
-000051c0: 7274 203d 206e 702e 6172 7261 7928 5b5b  rt = np.array([[
-000051d0: 302e 302c 302e 302c 2d76 616c 5f57 5d5d  0.0,0.0,-val_W]]
-000051e0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-000051f0: 2020 2062 746d 496e 6465 7820 3d20 746f     btmIndex = to
-00005200: 7456 6572 7473 2b31 0d0a 2020 2020 2020  tVerts+1..      
-00005210: 2020 2020 2020 2020 2020 7374 6172 7449            startI
-00005220: 6e64 6578 2c65 6e64 496e 6465 7820 3d20  ndex,endIndex = 
-00005230: 302c 6e75 6d55 2d31 0d0a 2020 2020 2020  0,numU-1..      
-00005240: 2020 2020 2020 2020 2020 6120 3d20 6e70            a = np
-00005250: 2e6c 696e 7370 6163 6528 7374 6172 7449  .linspace(startI
-00005260: 6e64 6578 2c65 6e64 496e 6465 782c 6e75  ndex,endIndex,nu
-00005270: 6d55 2c64 7479 7065 3d69 6e74 290d 0a20  mU,dtype=int).. 
-00005280: 2020 2020 2020 2020 2020 2020 2020 2062                 b
-00005290: 203d 2061 2b31 2069 6620 6973 5370 6c69   = a+1 if isSpli
-000052a0: 7420 656c 7365 206e 702e 6170 7065 6e64  t else np.append
-000052b0: 2820 615b 313a 5d2c 205b 7374 6172 7449  ( a[1:], [startI
-000052c0: 6e64 6578 5d20 290d 0a20 2020 2020 2020  ndex] )..       
-000052d0: 2020 2020 2020 2020 2063 203d 206e 702e           c = np.
-000052e0: 6675 6c6c 286e 756d 552c 6274 6d49 6e64  full(numU,btmInd
-000052f0: 6578 290d 0a20 2020 2020 2020 2020 2020  ex)..           
-00005300: 2020 2020 2062 6163 203d 206e 702e 6172       bac = np.ar
-00005310: 7261 7928 5b62 2c61 2c63 5d29 2e54 2020  ray([b,a,c]).T  
-00005320: 2320 6261 6320 696e 7374 6561 6420 666f  # bac instead fo
-00005330: 7220 6162 6320 666f 7220 6f75 7477 6172  r abc for outwar
-00005340: 6420 6e6f 726d 616c 732e 0d0a 2020 2020  d normals...    
-00005350: 2020 2020 2020 2020 2020 2020 7665 7274              vert
-00005360: 7320 3d20 6e70 2e61 7070 656e 6428 7665  s = np.append(ve
-00005370: 7274 732c 6274 6d56 6572 742c 2061 7869  rts,btmVert, axi
-00005380: 733d 3029 0d0a 2020 2020 2020 2020 2020  s=0)..          
-00005390: 2020 2020 2020 6661 6365 496e 6469 6365        faceIndice
-000053a0: 7320 3d20 6e70 2e61 7070 656e 6428 6661  s = np.append(fa
-000053b0: 6365 496e 6469 6365 732c 6261 632c 2061  ceIndices,bac, a
-000053c0: 7869 733d 3029 0d0a 0d0a 2020 2020 2020  xis=0)....      
-000053d0: 2020 7375 7266 6163 6520 3d20 636c 7328    surface = cls(
-000053e0: 2a2a 6b77 6172 6773 2920 2023 2073 6574  **kwargs)  # set
-000053f0: 2074 6f20 7468 6520 636c 6173 7320 6465   to the class de
-00005400: 6661 756c 7420 6f62 6a65 6374 0d0a 2020  fault object..  
-00005410: 2020 2020 2020 2320 7265 7365 7420 7665        # reset ve
-00005420: 7274 732c 2066 6163 6549 6e64 6963 6573  rts, faceIndices
-00005430: 2061 6e64 2065 6467 6573 2028 7265 7461   and edges (reta
-00005440: 696e 2063 6c61 7373 2063 6f6f 7264 696e  in class coordin
-00005450: 6174 6520 7379 7374 656d 292e 0d0a 2020  ate system)...  
-00005460: 2020 2020 2020 7375 7266 6163 652e 7665        surface.ve
-00005470: 7274 6578 436f 6f72 203d 2076 6572 7473  rtexCoor = verts
-00005480: 0d0a 2020 2020 2020 2020 7375 7266 6163  ..        surfac
-00005490: 652e 6676 496e 6469 6365 7320 3d20 6661  e.fvIndices = fa
-000054a0: 6365 496e 6469 6365 730d 0a20 2020 2020  ceIndices..     
-000054b0: 2020 2073 7572 6661 6365 2e65 7649 6e64     surface.evInd
-000054c0: 6963 6573 203d 2073 7572 6661 6365 2e5f  ices = surface._
-000054d0: 6765 745f 6564 6765 735f 6672 6f6d 5f66  get_edges_from_f
-000054e0: 6163 6573 2866 6163 6549 6e64 6963 6573  aces(faceIndices
-000054f0: 290d 0a20 2020 2020 2020 2073 7572 6661  )..        surfa
-00005500: 6365 2e76 6649 6e64 6963 6573 4c69 7374  ce.vfIndicesList
-00005510: 203d 2073 7572 6661 6365 2e5f 7665 7274   = surface._vert
-00005520: 6578 436f 6d6d 6f6e 4661 6365 496e 6469  exCommonFaceIndi
-00005530: 6365 7328 290d 0a20 2020 2020 2020 2073  ces()..        s
-00005540: 7572 6661 6365 2e65 6649 6e64 6963 6573  urface.efIndices
-00005550: 4c69 7374 203d 2073 7572 6661 6365 2e5f  List = surface._
-00005560: 6564 6765 436f 6d6d 6f6e 4661 6365 496e  edgeCommonFaceIn
-00005570: 6469 6365 7328 290d 0a20 2020 2020 2020  dices()..       
-00005580: 2073 7572 6661 6365 2e73 6574 5f76 6572   surface.set_ver
-00005590: 7473 2820 7665 7274 735b 6661 6365 496e  ts( verts[faceIn
-000055a0: 6469 6365 735d 2029 0d0a 2020 2020 2020  dices] )..      
-000055b0: 2020 7375 7266 6163 652e 5f73 6574 5f67    surface._set_g
-000055c0: 656f 6d65 7472 6963 5f62 6f75 6e64 7328  eometric_bounds(
-000055d0: 290d 0a20 2020 2020 2020 2073 7572 6661  )..        surfa
-000055e0: 6365 2e6e 616d 6520 3d20 6e61 6d65 0d0a  ce.name = name..
-000055f0: 2020 2020 2020 2020 7375 7266 6163 652e          surface.
-00005600: 5f62 6173 6574 7970 6520 3d20 2767 7269  _basetype = 'gri
-00005610: 645f 272b 6261 7365 7479 7065 0d0a 2020  d_'+basetype..  
-00005620: 2020 2020 2020 7265 7475 726e 2073 7572        return sur
-00005630: 6661 6365 0d0a 0d0a 2020 2020 4063 6c61  face....    @cla
-00005640: 7373 6d65 7468 6f64 0d0a 2020 2020 6465  ssmethod..    de
-00005650: 6620 5f66 6576 2863 6c73 2c72 657a 2c62  f _fev(cls,rez,b
-00005660: 6173 6574 7970 652c 6465 7263 6c73 2920  asetype,dercls) 
-00005670: 3a0d 0a20 2020 2020 2020 2022 2222 2053  :..        """ S
-00005680: 6574 7320 7570 205f 7366 6576 206d 6574  ets up _sfev met
-00005690: 686f 642c 2062 6173 6564 206f 6e20 6361  hod, based on ca
-000056a0: 6c6c 7320 6672 6f6d 2074 6865 2073 7562  lls from the sub
-000056b0: 636c 6173 7320 6465 7263 6c73 2e20 2222  class dercls. ""
-000056c0: 220d 0a20 2020 2020 2020 2023 2076 6573  "..        # ves
-000056d0: 7469 6769 616c 0d0a 2020 2020 2020 2020  tigial..        
-000056e0: 6966 2028 7265 7a3c 3029 206f 7220 2872  if (rez<0) or (r
-000056f0: 657a 3e5f 4d41 5852 455a 2920 3a0d 0a20  ez>_MAXREZ) :.. 
-00005700: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00005710: 2056 616c 7565 4572 726f 7228 2749 6e63   ValueError('Inc
-00005720: 6f72 7265 7374 2072 657a 206f 6620 7b7d  orrest rez of {}
-00005730: 2c20 6d75 7374 2062 6520 616e 2069 6e74  , must be an int
-00005740: 2c20 3020 3c3d 2072 657a 203c 3d20 7b7d  , 0 <= rez <= {}
-00005750: 272e 666f 726d 6174 2872 657a 2c5f 4d41  '.format(rez,_MA
-00005760: 5852 455a 2929 0d0a 2020 2020 2020 2020  XREZ))..        
-00005770: 6966 2062 6173 6574 7970 6520 6973 204e  if basetype is N
-00005780: 6f6e 653a 2062 6173 6574 7970 6520 3d20  one: basetype = 
-00005790: 6465 7263 6c73 2e5f 6465 6661 756c 745f  dercls._default_
-000057a0: 6261 7365 0d0a 2020 2020 2020 2020 6261  base..        ba
-000057b0: 7365 7375 7266 203d 2064 6572 636c 732e  sesurf = dercls.
-000057c0: 5f62 6173 655f 7375 7266 6163 6573 0d0a  _base_surfaces..
-000057d0: 2020 2020 2020 2020 6966 2062 6173 6574          if baset
-000057e0: 7970 6520 6e6f 7420 696e 2062 6173 6573  ype not in bases
-000057f0: 7572 6620 3a0d 0a20 2020 2020 2020 2020  urf :..         
-00005800: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-00005810: 726f 7228 2742 6173 6574 7970 6520 7b7d  ror('Basetype {}
-00005820: 2069 7320 6e6f 7420 7265 636f 676e 697a   is not recogniz
-00005830: 6564 2e20 506f 7373 6962 6c65 2076 616c  ed. Possible val
-00005840: 7565 7320 6172 653a 207b 7d27 2e66 6f72  ues are: {}'.for
-00005850: 6d61 7428 6261 7365 7479 7065 2c6c 6973  mat(basetype,lis
-00005860: 7428 6261 7365 7375 7266 2929 290d 0a20  t(basesurf))).. 
-00005870: 2020 2020 2020 2072 6574 7572 6e20 636c         return cl
-00005880: 732e 5f73 6665 7628 7265 7a2c 2062 6173  s._sfev(rez, bas
-00005890: 6573 7572 665b 6261 7365 7479 7065 5d5b  esurf[basetype][
-000058a0: 2766 6576 5061 7261 6d27 5d20 290d 0a0d  'fevParam'] )...
-000058b0: 0a20 2020 2040 636c 6173 736d 6574 686f  .    @classmetho
-000058c0: 640d 0a20 2020 2064 6566 205f 7576 775f  d..    def _uvw_
-000058d0: 746f 5f78 797a 2863 6c73 2c72 7374 2c61  to_xyz(cls,rst,a
-000058e0: 6263 2920 3a0d 0a20 2020 2020 2020 2022  bc) :..        "
-000058f0: 2222 2052 6f74 6174 696f 6e61 6c20 7472  "" Rotational tr
-00005900: 616e 7366 6f72 6d61 7469 6f6e 2061 7420  ansformation at 
-00005910: 6120 636f 6f72 6469 6e61 7465 2e0d 0a20  a coordinate... 
-00005920: 2020 2020 2020 2020 2020 2054 6f20 6265             To be
-00005930: 206f 7665 7272 6964 6465 6e20 6279 2061   overridden by a
-00005940: 6e79 2073 7562 636c 6173 7320 6e6f 7420  ny subclass not 
-00005950: 696e 2043 6172 7465 7369 616e 2063 6f6f  in Cartesian coo
-00005960: 7264 696e 6174 6573 2e0d 0a20 2020 2020  rdinates...     
-00005970: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
-00005980: 7265 7475 726e 206e 702e 7472 616e 7370  return np.transp
-00005990: 6f73 6528 7273 7429 0d0a 0d0a 2020 2020  ose(rst)....    
-000059a0: 4063 6c61 7373 6d65 7468 6f64 0d0a 2020  @classmethod..  
-000059b0: 2020 6465 6620 5f64 6973 705f 746f 5f78    def _disp_to_x
-000059c0: 797a 2820 636c 732c 2075 7677 2c20 7468  yz( cls, uvw, th
-000059d0: 6574 613d 4e6f 6e65 2c20 7068 693d 4e6f  eta=None, phi=No
-000059e0: 6e65 2920 3a0d 0a20 2020 2020 2020 2022  ne) :..        "
-000059f0: 2222 2052 6f74 6174 696f 6e61 6c20 7472  "" Rotational tr
-00005a00: 616e 7366 6f72 6d61 7469 6f6e 2066 726f  ansformation fro
-00005a10: 6d20 726f 7461 7469 6f6e 2061 6e67 6c65  m rotation angle
-00005a20: 732e 2022 2222 0d0a 0d0a 2020 2020 2020  s. """....      
-00005a30: 2020 6966 2074 6865 7461 2069 7320 4e6f    if theta is No
-00005a40: 6e65 203a 2072 6574 7572 6e20 7576 770d  ne : return uvw.
-00005a50: 0a20 2020 2020 2020 2023 2065 6163 6820  .        # each 
-00005a60: 7365 7420 6f66 2075 7677 2068 6173 2061  set of uvw has a
-00005a70: 2064 6966 6665 7265 6e74 2072 6f74 6174   different rotat
-00005a80: 696f 6e20 6d61 7472 6978 0d0a 2020 2020  ion matrix..    
-00005a90: 2020 2020 2320 7468 6174 206d 7573 7420      # that must 
-00005aa0: 6265 2065 7661 6c75 6174 6564 206f 6e65  be evaluated one
-00005ab0: 2061 7420 6120 7469 6d65 2e20 4d52 4f49   at a time. MROI
-00005ac0: 0d0a 2020 2020 2020 2020 6966 2070 6869  ..        if phi
-00005ad0: 2069 7320 4e6f 6e65 203a 2070 6869 203d   is None : phi =
-00005ae0: 206e 702e 7a65 726f 7328 206c 656e 2874   np.zeros( len(t
-00005af0: 6865 7461 2920 290d 0a20 2020 2020 2020  heta) )..       
-00005b00: 2075 7677 5420 3d20 6e70 2e74 7261 6e73   uvwT = np.trans
-00005b10: 706f 7365 2875 7677 290d 0a20 2020 2020  pose(uvw)..     
-00005b20: 2020 2064 6973 7056 6563 7420 3d20 5b5d     dispVect = []
-00005b30: 0d0a 2020 2020 2020 2020 666f 7220 6920  ..        for i 
-00005b40: 696e 2072 616e 6765 286c 656e 2874 6865  in range(len(the
-00005b50: 7461 2929 203a 0d0a 2020 2020 2020 2020  ta)) :..        
-00005b60: 2020 2020 726f 744d 7820 3d20 6575 6c65      rotMx = eule
-00005b70: 7252 6f74 2874 6865 7461 5b69 5d2c 7068  rRot(theta[i],ph
-00005b80: 695b 695d 2c20 696e 7261 643d 5472 7565  i[i], inrad=True
-00005b90: 290d 0a20 2020 2020 2020 2020 2020 2076  )..            v
-00005ba0: 6563 203d 206e 702e 646f 7428 2075 7677  ec = np.dot( uvw
-00005bb0: 545b 695d 2c20 726f 744d 7820 290d 0a20  T[i], rotMx ).. 
-00005bc0: 2020 2020 2020 2020 2020 2064 6973 7056             dispV
-00005bd0: 6563 742e 6170 7065 6e64 2876 6563 290d  ect.append(vec).
-00005be0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00005bf0: 6469 7370 5665 6374 0d0a 0d0a 2020 2020  dispVect....    
-00005c00: 6465 6620 5f70 6f73 7450 726f 635f 7375  def _postProc_su
-00005c10: 7266 6163 6543 6f6c 6f72 7328 7365 6c66  rfaceColors(self
-00005c20: 2c6f 6e6c 7946 6163 6573 3d46 616c 7365  ,onlyFaces=False
-00005c30: 2920 3a0d 0a20 2020 2020 2020 2022 2222  ) :..        """
-00005c40: 204d 6174 706c 6f74 6c69 6220 7769 6c6c   Matplotlib will
-00005c50: 2027 6669 6c6c 696e 2720 636f 6c6f 7273   'fillin' colors
-00005c60: 2064 7572 696e 6720 7265 6e64 6572 696e   during renderin
-00005c70: 6720 7573 696e 6720 7468 650d 0a20 2020  g using the..   
-00005c80: 2020 2020 2020 2020 2066 6163 6563 6f6c           facecol
-00005c90: 6f72 2061 7272 6179 2e20 2874 6869 7320  or array. (this 
-00005ca0: 6973 204e 4f54 2074 6865 2061 7373 6967  is NOT the assig
-00005cb0: 6e65 6420 636f 6c6f 7220 746f 2066 6163  ned color to fac
-00005cc0: 6573 292e 0d0a 2020 2020 2020 2020 2020  es)...          
-00005cd0: 2020 486f 7765 7665 722c 2053 3344 6c69    However, S3Dli
-00005ce0: 6220 7769 6c6c 2075 7365 2074 6865 2069  b will use the i
-00005cf0: 6e68 6572 6974 6564 205f 6661 6365 636f  nherited _faceco
-00005d00: 6c6f 7273 200d 0a20 2020 2020 2020 2020  lors ..         
-00005d10: 2020 2066 6f72 2074 6865 2061 7373 6967     for the assig
-00005d20: 6e65 6420 6661 6365 2063 6f6c 6f72 732e  ned face colors.
-00005d30: 0d0a 2020 2020 2020 2020 2020 2020 5768  ..            Wh
-00005d40: 656e 6576 6572 2063 6f6c 6f72 2069 7320  enever color is 
-00005d50: 2765 7874 6572 6e61 6c6c 7927 2061 7373  'externally' ass
-00005d60: 6967 6e65 6420 6f72 2072 6561 7373 6967  igned or reassig
-00005d70: 6e65 642c 0d0a 2020 2020 2020 2020 2020  ned,..          
-00005d80: 2020 6e65 6564 2074 6f20 6469 7265 6374    need to direct
-00005d90: 6c79 2061 7373 6967 6e20 636f 6c6f 7273  ly assign colors
-00005da0: 2066 6f72 2065 6163 6820 6661 6365 2066   for each face f
-00005db0: 6f72 2061 6e79 0d0a 2020 2020 2020 2020  or any..        
-00005dc0: 2020 2020 6d65 7468 6f64 2074 6861 7420      method that 
-00005dd0: 7573 6573 2066 6163 6563 6f6c 6f72 732e  uses facecolors.
-00005de0: 2020 5468 6973 206f 6363 7572 7320 696e    This occurs in
-00005df0: 6974 6961 6c6c 790d 0a20 2020 2020 2020  itially..       
-00005e00: 2020 2020 2069 6e20 7468 6520 6d65 7468       in the meth
-00005e10: 6f64 2062 6566 6f72 6520 636f 6c6f 7273  od before colors
-00005e20: 2061 7265 2061 7373 6967 6e65 6420 2020   are assigned   
-00005e30: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-00005e40: 2020 2020 2020 2028 7365 745f 636f 6c6f         (set_colo
-00005e50: 722c 202b 2c20 636c 6970 7069 6e67 2c20  r, +, clipping, 
-00005e60: 7368 6164 696e 672c 2065 6467 6573 2c20  shading, edges, 
-00005e70: 6574 632e 290d 0a20 2020 2020 2020 2020  etc.)..         
-00005e80: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
-00005e90: 204e 6f74 6520 7468 6174 2077 6865 6e20   Note that when 
-00005ea0: 696e 6974 6961 6c69 7a61 7469 6f6e 2075  initialization u
-00005eb0: 7369 6e67 202a 2a6b 6172 6773 2c0d 0a20  sing **kargs,.. 
-00005ec0: 2020 2020 2020 2020 2020 206f 6e6c 7946             onlyF
-00005ed0: 6163 6573 2073 686f 756c 6420 6265 2054  aces should be T
-00005ee0: 7275 6520 736f 2064 6f6e 2774 2072 6573  rue so don't res
-00005ef0: 6574 2065 6467 6563 6f6c 6f72 730d 0a20  et edgecolors.. 
-00005f00: 2020 2020 2020 2020 2020 2069 6620 7468             if th
-00005f10: 6579 2061 7265 2061 7373 6967 6e65 642e  ey are assigned.
-00005f20: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
-00005f30: 2020 2020 2020 204e 203d 206c 656e 2873         N = len(s
-00005f40: 656c 662e 6676 496e 6469 6365 7329 2020  elf.fvIndices)  
-00005f50: 2020 2020 2320 6e75 6d62 6572 206f 6620      # number of 
-00005f60: 6661 6365 730d 0a20 2020 2020 2020 2069  faces..        i
-00005f70: 6e69 7446 4320 3d20 7365 6c66 2e5f 6661  nitFC = self._fa
-00005f80: 6365 636f 6c6f 7273 0d0a 2020 2020 2020  cecolors..      
-00005f90: 2020 696e 4c65 6e20 3d20 6c65 6e28 696e    inLen = len(in
-00005fa0: 6974 4643 2920 2020 2020 2020 2020 2023  itFC)          #
-00005fb0: 206e 756d 6265 7220 6f66 2066 6163 6563   number of facec
-00005fc0: 6f6c 6f72 730d 0a20 2020 2020 2020 2069  olors..        i
-00005fd0: 6620 696e 4c65 6e20 3d3d 204e 203a 2072  f inLen == N : r
-00005fe0: 6574 7572 6e0d 0a20 2020 2020 2020 2069  eturn..        i
-00005ff0: 6620 6973 696e 7374 616e 6365 2869 6e69  f isinstance(ini
-00006000: 7446 432c 6e70 2e6e 6461 7272 6179 2920  tFC,np.ndarray) 
-00006010: 3a20 696e 6974 4643 203d 2069 6e69 7446  : initFC = initF
-00006020: 432e 746f 6c69 7374 2829 0d0a 2020 2020  C.tolist()..    
-00006030: 2020 2020 6e20 3d20 6d61 7468 2e63 6569      n = math.cei
-00006040: 6c28 4e2f 696e 4c65 6e29 0d0a 2020 2020  l(N/inLen)..    
-00006050: 2020 2020 636f 6c6f 7263 6f6c 6c20 3d20      colorcoll = 
-00006060: 696e 6974 4643 2a6e 0d0a 2020 2020 2020  initFC*n..      
-00006070: 2020 6966 206f 6e6c 7946 6163 6573 203a    if onlyFaces :
-00006080: 2073 656c 662e 7365 745f 6661 6365 636f   self.set_faceco
-00006090: 6c6f 7228 636f 6c6f 7263 6f6c 6c5b 303a  lor(colorcoll[0:
-000060a0: 4e5d 290d 0a20 2020 2020 2020 2065 6c73  N])..        els
-000060b0: 6520 3a20 2020 2020 2020 2020 7365 6c66  e :         self
-000060c0: 2e73 6574 5f63 6f6c 6f72 2863 6f6c 6f72  .set_color(color
-000060d0: 636f 6c6c 5b30 3a4e 5d29 0d0a 2020 2020  coll[0:N])..    
-000060e0: 2020 2020 7265 7475 726e 0d0a 0d0a 2020      return....  
-000060f0: 2020 6465 6620 5f73 6574 5f69 6e64 6578    def _set_index
-00006100: 5f72 656c 6174 696f 6e73 2873 656c 6629  _relations(self)
-00006110: 203a 0d0a 2020 2020 2020 2020 2222 2220   :..        """ 
-00006120: 6672 6f6d 2074 6865 2076 6572 7465 7820  from the vertex 
-00006130: 616e 6420 6661 6365 496e 6469 6365 732c  and faceIndices,
-00006140: 2073 6574 2074 6865 2069 6e64 6963 6573   set the indices
-00006150: 3a0d 0a20 2020 2020 2020 2020 2020 2065  :..            e
-00006160: 7649 6e64 6963 6573 3a20 2020 2020 4172  vIndices:     Ar
-00006170: 7261 792c 2066 6f72 2065 6163 6820 6564  ray, for each ed
-00006180: 6765 2c20 3220 7665 7274 6578 2069 6e64  ge, 2 vertex ind
-00006190: 6963 6965 732e 0d0a 2020 2020 2020 2020  icies...        
-000061a0: 2020 2020 7666 496e 6469 6365 734c 6973      vfIndicesLis
-000061b0: 743a 204c 6973 742c 2020 666f 7220 6561  t: List,  for ea
-000061c0: 6368 2076 6572 7465 782c 2066 6163 6520  ch vertex, face 
-000061d0: 696e 6469 6365 732e 0d0a 2020 2020 2020  indices...      
-000061e0: 2020 2020 2020 6566 496e 6469 6365 734c        efIndicesL
-000061f0: 6973 743a 204c 6973 742c 2020 666f 7220  ist: List,  for 
-00006200: 6561 6368 2065 6467 652c 2030 2074 6f20  each edge, 0 to 
-00006210: 3220 6661 6365 2069 6e64 6963 6573 2e0d  2 face indices..
-00006220: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
-00006230: 2020 2020 2020 6564 6765 496e 6469 6365        edgeIndice
-00006240: 7320 3d20 7365 6c66 2e5f 6765 745f 6564  s = self._get_ed
-00006250: 6765 735f 6672 6f6d 5f66 6163 6573 2873  ges_from_faces(s
-00006260: 656c 662e 6676 496e 6469 6365 7329 2020  elf.fvIndices)  
-00006270: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00006280: 2020 7365 6c66 2e65 7649 6e64 6963 6573    self.evIndices
-00006290: 203d 206e 702e 6172 7261 7928 6564 6765   = np.array(edge
-000062a0: 496e 6469 6365 7329 0d0a 2020 2020 2020  Indices)..      
-000062b0: 2020 7365 6c66 2e76 6649 6e64 6963 6573    self.vfIndices
-000062c0: 4c69 7374 203d 2073 656c 662e 5f76 6572  List = self._ver
-000062d0: 7465 7843 6f6d 6d6f 6e46 6163 6549 6e64  texCommonFaceInd
-000062e0: 6963 6573 2829 0d0a 2020 2020 2020 2020  ices()..        
-000062f0: 7365 6c66 2e65 6649 6e64 6963 6573 4c69  self.efIndicesLi
-00006300: 7374 203d 2073 656c 662e 5f65 6467 6543  st = self._edgeC
-00006310: 6f6d 6d6f 6e46 6163 6549 6e64 6963 6573  ommonFaceIndices
-00006320: 2829 0d0a 2020 2020 2020 2020 7265 7475  ()..        retu
-00006330: 726e 0d0a 0d0a 2020 2020 6465 6620 5f5f  rn....    def __
-00006340: 696e 6974 5f5f 2873 656c 662c 2076 6572  init__(self, ver
-00006350: 7465 7843 6f6f 722c 2066 6163 6549 6e64  texCoor, faceInd
-00006360: 6963 6573 2c20 6e61 6d65 3d4e 6f6e 652c  ices, name=None,
-00006370: 202a 2a6b 7761 7267 7329 3a0d 0a20 2020   **kwargs):..   
-00006380: 2020 2020 2022 2222 200d 0a20 2020 2020       """ ..     
-00006390: 2020 2033 4420 7375 7266 6163 6520 6f66     3D surface of
-000063a0: 2063 6f6e 6e65 6374 6564 2046 2066 6163   connected F fac
-000063b0: 6573 2c20 6561 6368 2066 6163 6520 7769  es, each face wi
-000063c0: 7468 204e 206e 756d 6265 7220 6f66 2076  th N number of v
-000063d0: 6572 7469 6365 732e 0d0a 2020 2020 2020  ertices...      
-000063e0: 2020 5468 6520 7375 7266 6163 6520 6861    The surface ha
-000063f0: 7320 5620 6e75 6d62 6572 206f 6620 7665  s V number of ve
-00006400: 7274 6963 6573 2061 6e64 2045 206e 756d  rtices and E num
-00006410: 6265 7220 6f66 2065 6467 6573 2e0d 0a20  ber of edges... 
-00006420: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00006430: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
-00006440: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
-00006450: 0a20 2020 2020 2020 2076 6572 7465 7843  .        vertexC
-00006460: 6f6f 7220 3a20 5620 7820 3320 666c 6f61  oor : V x 3 floa
-00006470: 7420 6172 7261 792d 6c69 6b65 200d 0a20  t array-like .. 
-00006480: 2020 2020 2020 2020 2020 2041 6e20 6172             An ar
-00006490: 7261 7920 6f66 2056 206e 756d 6265 7220  ray of V number 
-000064a0: 6f66 2078 797a 2076 6572 7465 7820 636f  of xyz vertex co
-000064b0: 6f72 6469 6e61 7465 732e 0d0a 0d0a 2020  ordinates.....  
-000064c0: 2020 2020 2020 6661 6365 496e 6469 6365        faceIndice
-000064d0: 7320 3a20 4620 7820 4e20 696e 7420 6c69  s : F x N int li
-000064e0: 7374 206f 7220 6172 7261 790d 0a20 2020  st or array..   
-000064f0: 2020 2020 2020 2020 2041 206c 6973 7420           A list 
-00006500: 6f72 2061 7272 6179 206f 6620 4620 6e75  or array of F nu
-00006510: 6d62 6572 206f 6620 6661 6365 7320 7769  mber of faces wi
-00006520: 7468 204e 2076 6572 7465 7820 696e 6469  th N vertex indi
-00006530: 6365 732e 0d0a 2020 2020 2020 2020 2020  ces...          
-00006540: 2020 466f 7220 6c69 7374 732c 204e 206d    For lists, N m
-00006550: 6179 2062 6520 6469 6666 6572 656e 7420  ay be different 
-00006560: 666f 7220 6561 6368 2066 6163 652e 0d0a  for each face...
-00006570: 0d0a 2020 2020 2020 2020 6e61 6d65 203a  ..        name :
-00006580: 2073 7472 696e 672c 206f 7074 696f 6e61   string, optiona
-00006590: 6c2c 2064 6566 6175 6c74 3a20 4e6f 6e65  l, default: None
-000065a0: 2e0d 0a20 2020 2020 2020 2020 2020 2044  ...            D
-000065b0: 6573 6372 6970 7469 7665 2069 6465 6e74  escriptive ident
-000065c0: 6966 6965 7220 666f 7220 7468 6520 6765  ifier for the ge
-000065d0: 6f6d 6574 7279 2e0d 0a0d 0a20 2020 2020  ometry.....     
-000065e0: 2020 204f 7468 6572 2050 6172 616d 6574     Other Paramet
-000065f0: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
-00006600: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20  -------------.. 
-00006610: 2020 2020 2020 202a 2a6b 7761 7267 730d         **kwargs.
-00006620: 0a20 2020 2020 2020 2020 2020 2041 6c6c  .            All
-00006630: 206f 7468 6572 2061 7267 756d 656e 7473   other arguments
-00006640: 2061 7265 2070 6173 7365 6420 6f6e 2074   are passed on t
-00006650: 6f20 6d70 6c5f 746f 6f6c 6b69 7473 2e6d  o mpl_toolkits.m
-00006660: 706c 6f74 3364 2e61 7274 3364 2e50 6f6c  plot3d.art3d.Pol
-00006670: 7933 4443 6f6c 6c65 6374 696f 6e2e 0d0a  y3DCollection...
-00006680: 2020 2020 2020 2020 2020 2020 5661 6c69              Vali
-00006690: 6420 6172 6775 6d65 6e74 206e 616d 6573  d argument names
-000066a0: 2069 6e63 6c75 6465 3a20 636f 6c6f 722c   include: color,
-000066b0: 2065 6467 6563 6f6c 6f72 732c 2066 6163   edgecolors, fac
-000066c0: 6563 6f6c 6f72 732c 206c 696e 6577 6964  ecolors, linewid
-000066d0: 7468 732c 2063 6d61 702e 0d0a 0d0a 2020  ths, cmap.....  
-000066e0: 2020 2020 2020 2222 220d 0a0d 0a20 2020        """....   
-000066f0: 2020 2020 2073 656c 662e 7665 7274 6578       self.vertex
-00006700: 436f 6f72 203d 206e 702e 6172 7261 7928  Coor = np.array(
-00006710: 7665 7274 6578 436f 6f72 2c64 7479 7065  vertexCoor,dtype
-00006720: 3d66 6c6f 6174 290d 0a20 2020 2020 2020  =float)..       
-00006730: 2073 656c 662e 6261 7365 5665 7274 6578   self.baseVertex
-00006740: 436f 6f72 203d 206e 702e 6172 7261 7928  Coor = np.array(
-00006750: 7665 7274 6578 436f 6f72 2c64 7479 7065  vertexCoor,dtype
-00006760: 3d66 6c6f 6174 290d 0a20 2020 2020 2020  =float)..       
-00006770: 2073 656c 662e 6676 496e 6469 6365 7320   self.fvIndices 
-00006780: 3d20 6e70 2e61 7272 6179 2866 6163 6549  = np.array(faceI
-00006790: 6e64 6963 6573 290d 0a20 2020 2020 2020  ndices)..       
-000067a0: 200d 0a20 2020 2020 2020 2069 6620 7365   ..        if se
-000067b0: 6c66 2e66 7649 6e64 6963 6573 2e6e 6469  lf.fvIndices.ndi
-000067c0: 6d20 3d3d 2031 203a 0d0a 2020 2020 2020  m == 1 :..      
-000067d0: 2020 2020 2020 2320 6173 7375 6d65 2069        # assume i
-000067e0: 6e70 7574 2069 7320 6120 6c69 7374 206f  nput is a list o
-000067f0: 6620 6661 6365 7320 7769 7468 2064 6966  f faces with dif
-00006800: 6665 7265 6e74 206e 756d 6265 7220 6f66  ferent number of
-00006810: 2065 6467 6573 2e0d 0a20 2020 2020 2020   edges...       
-00006820: 2020 2020 2073 656c 662e 5f69 6e69 7465       self._inite
-00006830: 6467 6573 203d 2073 656c 662e 5f67 6574  dges = self._get
-00006840: 5f65 6467 6573 5f66 726f 6d5f 6661 6365  _edges_from_face
-00006850: 7328 7365 6c66 2e66 7649 6e64 6963 6573  s(self.fvIndices
-00006860: 290d 0a20 2020 2020 2020 2020 2020 2073  )..            s
-00006870: 656c 662e 5f69 6e69 7476 6572 7473 203d  elf._initverts =
-00006880: 206e 702e 6172 7261 7928 7665 7274 6578   np.array(vertex
-00006890: 436f 6f72 2c64 7479 7065 3d66 6c6f 6174  Coor,dtype=float
-000068a0: 290d 0a20 2020 2020 2020 2020 2020 2066  )..            f
-000068b0: 7649 6e64 4e65 7720 3d20 7365 6c66 2e5f  vIndNew = self._
-000068c0: 7472 6961 6e67 756c 6174 655f 6661 6365  triangulate_face
-000068d0: 496e 6469 6365 7328 6661 6365 496e 6469  Indices(faceIndi
-000068e0: 6365 7329 0d0a 2020 2020 2020 2020 2020  ces)..          
-000068f0: 2020 6663 6f6c 6f72 203d 204e 6f6e 650d    fcolor = None.
-00006900: 0a20 2020 2020 2020 2020 2020 2023 206e  .            # n
-00006910: 6f74 653a 2069 6620 6564 6765 636f 6c6f  ote: if edgecolo
-00006920: 7273 2061 7265 206e 6f74 2064 6566 696e  rs are not defin
-00006930: 6564 2c20 6465 6661 756c 7420 746f 2064  ed, default to d
-00006940: 6566 696e 6564 2066 6163 6563 6f6c 6f72  efined facecolor
-00006950: 206c 6973 742c 0d0a 2020 2020 2020 2020   list,..        
-00006960: 2020 2020 2320 2020 2020 2020 6e6f 7420      #       not 
-00006970: 7468 6520 6465 6669 6e65 6420 636f 6c6f  the defined colo
-00006980: 7220 2820 636f 6e74 696e 7565 2077 6974  r ( continue wit
-00006990: 6820 6469 6666 6572 656e 7420 276d 6167  h different 'mag
-000069a0: 6963 2720 2920 4d52 4f49 2e0d 0a20 2020  ic' ) MROI...   
-000069b0: 2020 2020 2020 2020 2023 2066 6f6c 6c6f           # follo
-000069c0: 7769 6e67 2027 6d61 7927 2062 6520 7665  wing 'may' be ve
-000069d0: 7374 6967 6961 6c20 746f 2062 6520 7265  stigial to be re
-000069e0: 6d6f 7665 6420 3f0d 0a20 2020 2020 2020  moved ?..       
-000069f0: 2020 2020 2069 6620 2763 6f6c 6f72 2720       if 'color' 
-00006a00: 696e 206b 7761 7267 7320 3a20 6663 6f6c  in kwargs : fcol
-00006a10: 6f72 203d 206b 7761 7267 735b 2763 6f6c  or = kwargs['col
-00006a20: 6f72 275d 0d0a 2020 2020 2020 2020 2020  or']..          
-00006a30: 2020 6966 2027 6661 6365 636f 6c6f 7227    if 'facecolor'
-00006a40: 2069 6e20 6b77 6172 6773 203a 2066 636f   in kwargs : fco
-00006a50: 6c6f 7220 3d20 6b77 6172 6773 5b27 6661  lor = kwargs['fa
-00006a60: 6365 636f 6c6f 7227 5d0d 0a20 2020 2020  cecolor']..     
-00006a70: 2020 2020 2020 2069 6620 636f 6c6f 7273         if colors
-00006a80: 2e69 735f 636f 6c6f 725f 6c69 6b65 2866  .is_color_like(f
-00006a90: 636f 6c6f 7229 203a 0d0a 2020 2020 2020  color) :..      
-00006aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006ab0: 2020 2320 7369 6e67 6c65 2063 6f6c 6f72    # single color
-00006ac0: 2061 7373 6967 6e65 6420 0d0a 2020 2020   assigned ..    
-00006ad0: 2020 2020 2020 2020 2020 2020 6676 496e              fvIn
-00006ae0: 644e 6577 203d 2073 656c 662e 5f74 7269  dNew = self._tri
-00006af0: 616e 6775 6c61 7465 5f66 6163 6549 6e64  angulate_faceInd
-00006b00: 6963 6573 2866 6163 6549 6e64 6963 6573  ices(faceIndices
-00006b10: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
-00006b20: 6c73 6520 3a0d 0a20 2020 2020 2020 2020  lse :..         
-00006b30: 2020 2020 2020 2069 6620 6663 6f6c 6f72         if fcolor
-00006b40: 2069 7320 4e6f 6e65 203a 0d0a 2020 2020   is None :..    
-00006b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006b60: 2020 2020 2320 6e6f 2063 6f6c 6f72 2061      # no color a
-00006b70: 7373 6967 6e65 640d 0a20 2020 2020 2020  ssigned..       
-00006b80: 2020 2020 2020 2020 2020 2020 2066 7649               fvI
-00006b90: 6e64 4e65 7720 3d20 7365 6c66 2e5f 7472  ndNew = self._tr
-00006ba0: 6961 6e67 756c 6174 655f 6661 6365 496e  iangulate_faceIn
-00006bb0: 6469 6365 7328 6661 6365 496e 6469 6365  dices(faceIndice
-00006bc0: 7329 0d0a 2020 2020 2020 2020 2020 2020  s)..            
-00006bd0: 2020 2020 656c 7365 203a 2020 2320 6c69      else :  # li
-00006be0: 7374 206f 6620 636f 6c6f 7273 2061 7373  st of colors ass
-00006bf0: 6967 6e65 6420 200d 0a20 2020 2020 2020  igned  ..       
-00006c00: 2020 2020 2020 2020 2020 2020 2066 7649               fvI
-00006c10: 6e64 4e65 772c 2066 6163 6543 6f6c 6f72  ndNew, faceColor
-00006c20: 734e 6577 203d 2073 656c 662e 5f74 7269  sNew = self._tri
-00006c30: 616e 6775 6c61 7465 5f66 6163 6549 6e64  angulate_faceInd
-00006c40: 6963 6573 5f66 6163 6543 6f6c 6f72 7328  ices_faceColors(
-00006c50: 6661 6365 496e 6469 6365 732c 6663 6f6c  faceIndices,fcol
-00006c60: 6f72 290d 0a20 2020 2020 2020 2020 2020  or)..           
-00006c70: 2020 2020 2020 2020 206b 7761 7267 735b           kwargs[
-00006c80: 2766 6163 6563 6f6c 6f72 275d 203d 2066  'facecolor'] = f
-00006c90: 6163 6543 6f6c 6f72 734e 6577 200d 0a20  aceColorsNew .. 
-00006ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006cb0: 2020 206b 7761 7267 735b 2763 6f6c 6f72     kwargs['color
-00006cc0: 275d 203d 2066 6163 6543 6f6c 6f72 734e  '] = faceColorsN
-00006cd0: 6577 200d 0a20 2020 2020 2020 2020 2020  ew ..           
-00006ce0: 2073 656c 662e 6676 496e 6469 6365 7320   self.fvIndices 
-00006cf0: 3d20 6e70 2e61 7272 6179 2866 7649 6e64  = np.array(fvInd
-00006d00: 4e65 7729 0d0a 0d0a 2020 2020 2020 2020  New)....        
-00006d10: 7365 6c66 2e5f 7365 745f 696e 6465 785f  self._set_index_
-00006d20: 7265 6c61 7469 6f6e 7328 290d 0a20 2020  relations()..   
-00006d30: 2020 2020 2066 203d 2073 656c 662e 6676       f = self.fv
-00006d40: 496e 6469 6365 730d 0a20 2020 2020 2020  Indices..       
-00006d50: 2076 203d 2073 656c 662e 7665 7274 6578   v = self.vertex
-00006d60: 436f 6f72 0d0a 2020 2020 2020 2020 7375  Coor..        su
-00006d70: 7065 7228 292e 5f5f 696e 6974 5f5f 2876  per().__init__(v
-00006d80: 5b66 5d2c 202a 2a6b 7761 7267 7329 0d0a  [f], **kwargs)..
-00006d90: 2020 2020 2020 2020 2320 6e6f 7465 3a20          # note: 
-00006da0: 696e 2066 6f6c 6c6f 7769 6e67 2c20 6f6e  in following, on
-00006db0: 6c79 2073 6574 2074 6865 2066 6163 6563  ly set the facec
-00006dc0: 6f6c 6f72 7320 7369 6e63 6520 4d61 7470  olors since Matp
-00006dd0: 6c6f 746c 6962 2061 7574 6f2d 7365 7474  lotlib auto-sett
-00006de0: 696e 670d 0a20 2020 2020 2020 2023 2020  ing..        #  
-00006df0: 2020 2020 2074 6865 2065 6467 6573 2c20       the edges, 
-00006e00: 6966 206e 6f74 2065 7870 6c69 6369 7465  if not explicite
-00006e10: 6c79 2070 6173 7365 6420 7769 7468 2065  ly passed with e
-00006e20: 6467 6563 6f6c 6f72 206b 7761 7267 732e  dgecolor kwargs.
-00006e30: 0d0a 2020 2020 2020 2020 7365 6c66 2e5f  ..        self._
-00006e40: 706f 7374 5072 6f63 5f73 7572 6661 6365  postProc_surface
-00006e50: 436f 6c6f 7273 2854 7275 6529 200d 0a0d  Colors(True) ...
-00006e60: 0a20 2020 2020 2020 2023 7365 6c66 2e5f  .        #self._
-00006e70: 6765 6f6d 4e61 6d65 203d 204e 6f6e 6520  geomName = None 
-00006e80: 2020 2023 2052 6564 756e 6461 6e74 2066     # Redundant f
-00006e90: 726f 6d20 6e65 7874 206c 696e 652c 2069  rom next line, i
-00006ea0: 6e74 6572 6e61 6c20 7472 6163 6b69 6e67  nternal tracking
-00006eb0: 2074 6f20 6465 7465 726d 696e 6520 6966   to determine if
-00006ec0: 2073 6574 2e2e 2e0d 0a20 2020 2020 2020   set.....       
-00006ed0: 2073 656c 662e 6e61 6d65 203d 206e 616d   self.name = nam
-00006ee0: 650d 0a20 2020 2020 2020 2073 656c 662e  e..        self.
-00006ef0: 7661 6c75 6573 4e61 6d65 203d 204e 6f6e  valuesName = Non
-00006f00: 650d 0a20 2020 2020 2020 2023 203d 3d3d  e..        # ===
-00006f10: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00006f20: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00006f30: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00006f40: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00006f50: 3d3d 3d3d 3d0d 0a20 2020 2020 2020 2073  =====..        s
-00006f60: 656c 662e 636f 6f72 5479 7065 203d 205f  elf.coorType = _
-00006f70: 434f 4f52 5359 535b 2258 595a 225d 0d0a  COORSYS["XYZ"]..
-00006f80: 2020 2020 2020 2020 7365 6c66 2e62 6173          self.bas
-00006f90: 6553 7572 6661 6365 436f 6c6f 7220 3d20  eSurfaceColor = 
-00006fa0: 6e70 2e61 7272 6179 2873 656c 662e 5f66  np.array(self._f
-00006fb0: 6163 6563 6f6c 6f72 7333 645b 305d 292e  acecolors3d[0]).
-00006fc0: 666c 6174 7465 6e28 292e 746f 6c69 7374  flatten().tolist
-00006fd0: 2829 0d0a 2020 2020 2020 200d 0a20 2020  ()..       ..   
-00006fe0: 2020 2020 2073 656c 662e 7665 7274 6578       self.vertex
-00006ff0: 436f 6c6f 7220 3d20 6e70 2e61 7272 6179  Color = np.array
-00007000: 2873 656c 662e 5f66 6163 6563 6f6c 6f72  (self._facecolor
-00007010: 7333 645b 305d 292e 636f 7079 2829 5b6e  s3d[0]).copy()[n
-00007020: 702e 6e65 7761 7869 732c 3a5d 0d0a 2020  p.newaxis,:]..  
-00007030: 2020 2020 2020 2320 666f 6c6c 6f77 696e        # followin
-00007040: 6720 6173 7369 676e 6564 2077 6865 6e20  g assigned when 
-00007050: 7375 7266 6163 6520 636f 6c6f 7220 6170  surface color ap
-00007060: 706c 6965 6420 7573 696e 6720 616e 206f  plied using an o
-00007070: 7065 7261 7469 6f6e 0d0a 2020 2020 2020  peration..      
-00007080: 2020 7365 6c66 2e76 6572 7465 7856 616c    self.vertexVal
-00007090: 7565 7320 3d20 4e6f 6e65 0d0a 2020 2020  ues = None..    
-000070a0: 2020 2020 7365 6c66 2e66 6163 6556 616c      self.faceVal
-000070b0: 7565 7320 3d20 4e6f 6e65 0d0a 0d0a 2020  ues = None....  
-000070c0: 2020 2020 2020 6966 206c 656e 2028 7365        if len (se
-000070d0: 6c66 2e5f 6564 6765 636f 6c6f 7273 3364  lf._edgecolors3d
-000070e0: 2920 6973 2020 3020 3a0d 0a20 2020 2020  ) is  0 :..     
-000070f0: 2020 2020 2020 2073 656c 662e 6261 7365         self.base
-00007100: 4564 6765 436f 6c6f 7220 3d20 7365 6c66  EdgeColor = self
-00007110: 2e62 6173 6553 7572 6661 6365 436f 6c6f  .baseSurfaceColo
-00007120: 7220 0d0a 2020 2020 2020 2020 656c 7365  r ..        else
-00007130: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
-00007140: 7365 6c66 2e62 6173 6545 6467 6543 6f6c  self.baseEdgeCol
-00007150: 6f72 203d 206e 702e 6172 7261 7928 7365  or = np.array(se
-00007160: 6c66 2e5f 6564 6765 636f 6c6f 7273 3364  lf._edgecolors3d
-00007170: 5b30 5d29 2e66 6c61 7474 656e 2829 2e74  [0]).flatten().t
-00007180: 6f6c 6973 7428 290d 0a20 2020 2020 2020  olist()..       
-00007190: 200d 0a20 2020 2020 2020 2073 656c 662e   ..        self.
-000071a0: 6973 5375 7266 6163 6543 6f6c 6f72 6564  isSurfaceColored
-000071b0: 2020 2020 203d 2046 616c 7365 2020 2020       = False    
-000071c0: 2020 2023 2066 6c61 6720 7365 7420 5472     # flag set Tr
-000071d0: 7565 2066 6f72 2063 6f6c 6f72 2061 7272  ue for color arr
-000071e0: 6179 2065 7870 6f72 742e 0d0a 2020 2020  ay export...    
-000071f0: 2020 2020 7365 6c66 2e6f 6e6c 7943 6f6c      self.onlyCol
-00007200: 6f72 6564 4661 6365 7320 2020 2020 3d20  oredFaces     = 
-00007210: 4661 6c73 6520 2020 2020 2020 2320 666c  False       # fl
-00007220: 6167 2073 6574 2054 7275 6520 666f 7220  ag set True for 
-00007230: 636d 6170 206e 6f72 6d61 6c73 2e0d 0a20  cmap normals... 
-00007240: 2020 2020 2020 2073 656c 662e 5f73 7572         self._sur
-00007250: 6661 6365 5368 6170 6543 6861 6e67 6564  faceShapeChanged
-00007260: 203d 2046 616c 7365 2020 2020 2020 2023   = False       #
-00007270: 2063 6f6e 7472 6f6c 2066 6c61 6720 666f   control flag fo
-00007280: 7220 696d 6167 6520 6f70 6572 6174 696f  r image operatio
-00007290: 6e73 2020 2020 2020 0d0a 2020 2020 2020  ns      ..      
-000072a0: 2020 7365 6c66 2e5f 6973 436f 6d70 6f73    self._isCompos
-000072b0: 6974 6553 7572 6661 6365 2020 3d20 4661  iteSurface  = Fa
-000072c0: 6c73 6520 2020 2020 2020 2320 636f 6e74  lse       # cont
-000072d0: 726f 6c20 666c 6167 2066 6f72 2061 2063  rol flag for a c
-000072e0: 6f6d 706f 7369 7465 206f 626a 6563 742e  omposite object.
-000072f0: 0d0a 0d0a 2020 2020 2020 2020 7365 6c66  ....        self
-00007300: 2e64 6973 705f 5665 6374 6f72 203d 204e  .disp_Vector = N
-00007310: 6f6e 6520 2020 2020 2020 2020 2020 2020  one             
-00007320: 2020 2020 2320 6f76 6572 7269 6464 656e      # overridden
-00007330: 2069 6e20 7375 6263 6c61 7373 2e0d 0a20   in subclass... 
-00007340: 2020 2020 2020 2073 656c 662e 5f6e 6f72         self._nor
-00007350: 6d61 6c5f 7363 616c 6520 3d20 312e 3020  mal_scale = 1.0 
-00007360: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00007370: 206f 7665 7272 6964 6465 6e20 696e 2073   overridden in s
-00007380: 7562 636c 6173 7320 6465 6661 756c 740d  ubclass default.
-00007390: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
-000073a0: 2020 2073 656c 662e 7265 7374 6f72 6564     self.restored
-000073b0: 436c 6970 203d 204e 6f6e 6520 2020 2020  Clip = None     
-000073c0: 2020 2020 2020 2020 2020 2023 2064 6963             # dic
-000073d0: 7469 6f6e 6172 7920 746f 2072 6573 746f  tionary to resto
-000073e0: 7265 2066 726f 6d20 636c 6970 206f 7065  re from clip ope
-000073f0: 7261 7469 6f6e 2e0d 0a20 2020 2020 2020  ration...       
-00007400: 2073 656c 662e 7665 6374 6f72 5f66 6965   self.vector_fie
-00007410: 6c64 203d 204e 6f6e 6520 2020 2020 2020  ld = None       
-00007420: 2020 2020 2020 2020 2023 2066 6f72 2076           # for v
-00007430: 6563 746f 7220 6669 656c 6473 2077 6865  ector fields whe
-00007440: 6e20 7472 616e 7366 6f72 6d65 642e 0d0a  n transformed...
-00007450: 2020 2020 2020 2020 7365 6c66 2e5f 7376          self._sv
-00007460: 645f 6469 6374 2020 2020 3d20 4e6f 6e65  d_dict    = None
-00007470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007480: 2320 7265 7375 6c74 7320 6672 6f6d 206d  # results from m
-00007490: 6170 5f67 656f 6d5f 6672 6f6d 5f73 7664  ap_geom_from_svd
-000074a0: 0d0a 2020 2020 2020 2020 7365 6c66 2e73  ..        self.s
-000074b0: 6361 6c65 203d 205b 312c 312c 315d 2020  cale = [1,1,1]  
-000074c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000074d0: 2020 2320 666f 7220 6178 6973 2077 6865    # for axis whe
-000074e0: 6e20 7472 616e 7366 6f72 6d65 642e 0d0a  n transformed...
-000074f0: 2020 2020 2020 2020 7365 6c66 2e74 7261          self.tra
-00007500: 6e73 6c61 7469 6f6e 203d 205b 302c 302c  nslation = [0,0,
-00007510: 305d 2020 2020 2020 2020 2020 2020 2020  0]              
-00007520: 2320 666f 7220 6178 6973 2077 6865 6e20  # for axis when 
-00007530: 7472 616e 7366 6f72 6d65 642e 0d0a 2020  transformed...  
-00007540: 2020 2020 2020 7365 6c66 2e72 6f74 6174        self.rotat
-00007550: 696f 6e20 3d20 206e 702e 6964 656e 7469  ion =  np.identi
-00007560: 7479 2833 2920 2020 2020 2020 2020 2320  ty(3)         # 
-00007570: 666f 7220 6178 6973 2077 6865 6e20 7472  for axis when tr
-00007580: 616e 7366 6f72 6d65 642e 0d0a 0d0a 2020  ansformed.....  
-00007590: 2020 2020 2020 7365 6c66 2e5f 626f 756e        self._boun
-000075a0: 6473 203d 207b 7d0d 0a20 2020 2020 2020  ds = {}..       
-000075b0: 2073 656c 662e 5f73 6574 5f67 656f 6d65   self._set_geome
-000075c0: 7472 6963 5f62 6f75 6e64 7328 290d 0a20  tric_bounds().. 
-000075d0: 2020 2020 2020 2073 656c 662e 5f62 6f75         self._bou
-000075e0: 6e64 735b 2776 6c69 6d27 5d20 2020 2020  nds['vlim']     
-000075f0: 3d20 5f44 4654 5f56 4c49 4d20 2020 2020  = _DFT_VLIM     
-00007600: 2020 0d0a 2020 2020 2020 2020 7365 6c66    ..        self
-00007610: 2e5f 626f 756e 6473 5b27 7665 7274 766c  ._bounds['vertvl
-00007620: 696d 275d 203d 205f 4446 545f 5645 5254  im'] = _DFT_VERT
-00007630: 564c 494d 200d 0a20 2020 200d 0a20 2020  VLIM ..    ..   
-00007640: 2064 6566 205f 5f61 6464 5f5f 2873 656c   def __add__(sel
-00007650: 662c 206f 7468 7229 203a 0d0a 2020 2020  f, othr) :..    
-00007660: 2020 2020 2222 2253 7572 6661 6365 3344      """Surface3D
-00007670: 436f 6c6c 6563 7469 6f6e 206f 626a 6563  Collection objec
-00007680: 7420 6672 6f6d 2076 6572 7469 6365 732c  t from vertices,
-00007690: 2066 6163 6573 2061 6e64 2063 6f6c 6f72   faces and color
-000076a0: 7320 6f66 2074 776f 2073 7572 6661 6365  s of two surface
-000076b0: 206f 626a 6563 7473 2e20 2222 220d 0a0d   objects. """...
-000076c0: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
-000076d0: 6973 696e 7374 616e 6365 286f 7468 722c  isinstance(othr,
-000076e0: 2053 7572 6661 6365 3344 436f 6c6c 6563   Surface3DCollec
-000076f0: 7469 6f6e 2920 3a0d 0a20 2020 2020 2020  tion) :..       
-00007700: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-00007710: 4572 726f 7228 2741 6464 206f 7065 7261  Error('Add opera
-00007720: 7469 6f6e 7320 6361 6e20 6f6e 6c79 2061  tions can only a
-00007730: 7070 6c79 2062 6574 7765 656e 2053 7572  pply between Sur
-00007740: 6661 6365 3344 436f 6c6c 6563 7469 6f6e  face3DCollection
-00007750: 206f 626a 6563 7473 2e27 290d 0a0d 0a20   objects.').... 
-00007760: 2020 2020 2020 2023 204d 524f 493a 2073         # MROI: s
-00007770: 686f 756c 6420 6368 6563 6b20 6966 2032  hould check if 2
-00007780: 2073 7572 6661 6365 2066 6163 6573 2061   surface faces a
-00007790: 7265 2062 6f74 6820 7472 6961 6e67 756c  re both triangul
-000077a0: 6172 206f 7220 7175 6164 7269 6c61 7465  ar or quadrilate
-000077b0: 7261 6c0d 0a0d 0a20 2020 2020 2020 2074  ral....        t
-000077c0: 6f70 5665 7243 6f6f 7220 3d20 7365 6c66  opVerCoor = self
-000077d0: 2e76 6572 7465 7843 6f6f 720d 0a20 2020  .vertexCoor..   
-000077e0: 2020 2020 2062 6f74 5665 7243 6f6f 7220       botVerCoor 
-000077f0: 3d20 6f74 6872 2e76 6572 7465 7843 6f6f  = othr.vertexCoo
-00007800: 720d 0a20 2020 2020 2020 2074 6f74 5665  r..        totVe
-00007810: 7243 6f6f 7220 3d20 6e70 2e61 7070 656e  rCoor = np.appen
-00007820: 6428 746f 7056 6572 436f 6f72 2c62 6f74  d(topVerCoor,bot
-00007830: 5665 7243 6f6f 722c 6178 6973 3d30 290d  VerCoor,axis=0).
-00007840: 0a20 2020 2020 2020 206e 6578 7449 6e64  .        nextInd
-00007850: 6578 203d 206c 656e 2874 6f70 5665 7243  ex = len(topVerC
-00007860: 6f6f 7229 0d0a 0d0a 2020 2020 2020 2020  oor)....        
-00007870: 746f 7046 5669 6e64 6963 6573 203d 2073  topFVindices = s
-00007880: 656c 662e 6676 496e 6469 6365 730d 0a20  elf.fvIndices.. 
-00007890: 2020 2020 2020 2062 6f74 4656 696e 6469         botFVindi
-000078a0: 6365 7320 3d20 6f74 6872 2e66 7649 6e64  ces = othr.fvInd
-000078b0: 6963 6573 0d0a 2020 2020 2020 2020 4656  ices..        FV
-000078c0: 7461 696c 203d 206e 702e 6164 6428 626f  tail = np.add(bo
-000078d0: 7446 5669 6e64 6963 6573 2c6e 6578 7449  tFVindices,nextI
-000078e0: 6e64 6578 290d 0a20 2020 2020 2020 2074  ndex)..        t
-000078f0: 6f74 4656 696e 6469 6365 7320 3d20 6e70  otFVindices = np
-00007900: 2e61 7070 656e 6428 746f 7046 5669 6e64  .append(topFVind
-00007910: 6963 6573 2c46 5674 6169 6c2c 6178 6973  ices,FVtail,axis
-00007920: 3d30 290d 0a0d 0a20 2020 2020 2020 206f  =0)....        o
-00007930: 626a 203d 2053 7572 6661 6365 3344 436f  bj = Surface3DCo
-00007940: 6c6c 6563 7469 6f6e 2874 6f74 5665 7243  llection(totVerC
-00007950: 6f6f 722c 746f 7446 5669 6e64 6963 6573  oor,totFVindices
-00007960: 290d 0a20 2020 2020 2020 206f 626a 2e5f  )..        obj._
-00007970: 6973 436f 6d70 6f73 6974 6553 7572 6661  isCompositeSurfa
-00007980: 6365 203d 2054 7275 650d 0a20 2020 2020  ce = True..     
-00007990: 2020 200d 0a20 2020 2020 2020 2074 6f70     ..        top
-000079a0: 5f6f 6e65 6172 7220 3d20 6e70 2e6f 6e65  _onearr = np.one
-000079b0: 7328 206c 656e 2874 6f70 4656 696e 6469  s( len(topFVindi
-000079c0: 6365 7329 2029 5b3a 2c20 6e70 2e6e 6577  ces) )[:, np.new
-000079d0: 6178 6973 5d0d 0a20 2020 2020 2020 2074  axis]..        t
-000079e0: 6f70 5f6f 7269 675f 636f 6c6f 7273 203d  op_orig_colors =
-000079f0: 2073 656c 662e 5f66 6163 6563 6f6c 6f72   self._facecolor
-00007a00: 730d 0a20 2020 2020 2020 2069 6620 6c65  s..        if le
-00007a10: 6e28 746f 705f 6f72 6967 5f63 6f6c 6f72  n(top_orig_color
-00007a20: 7329 203d 3d20 3120 3a20 746f 705f 6f72  s) == 1 : top_or
-00007a30: 6967 5f63 6f6c 6f72 7320 3d20 746f 705f  ig_colors = top_
-00007a40: 6f72 6967 5f63 6f6c 6f72 732a 746f 705f  orig_colors*top_
-00007a50: 6f6e 6561 7272 0d0a 0d0a 2020 2020 2020  onearr....      
-00007a60: 2020 626f 745f 6f6e 6561 7272 203d 206e    bot_onearr = n
-00007a70: 702e 6f6e 6573 2820 6c65 6e28 626f 7446  p.ones( len(botF
-00007a80: 5669 6e64 6963 6573 2920 295b 3a2c 206e  Vindices) )[:, n
-00007a90: 702e 6e65 7761 7869 735d 0d0a 2020 2020  p.newaxis]..    
-00007aa0: 2020 2020 626f 745f 6f72 6967 5f63 6f6c      bot_orig_col
-00007ab0: 6f72 7320 3d20 6f74 6872 2e5f 6661 6365  ors = othr._face
-00007ac0: 636f 6c6f 7273 0d0a 2020 2020 2020 2020  colors..        
-00007ad0: 6966 206c 656e 2862 6f74 5f6f 7269 675f  if len(bot_orig_
-00007ae0: 636f 6c6f 7273 2920 3d3d 2031 203a 2062  colors) == 1 : b
-00007af0: 6f74 5f6f 7269 675f 636f 6c6f 7273 203d  ot_orig_colors =
-00007b00: 2062 6f74 5f6f 7269 675f 636f 6c6f 7273   bot_orig_colors
-00007b10: 2a62 6f74 5f6f 6e65 6172 720d 0a0d 0a20  *bot_onearr.... 
-00007b20: 2020 2020 2020 2074 6f74 616c 5f63 6f6c         total_col
-00007b30: 6f72 7320 3d20 6e70 2e61 7070 656e 6428  ors = np.append(
-00007b40: 746f 705f 6f72 6967 5f63 6f6c 6f72 732c  top_orig_colors,
-00007b50: 626f 745f 6f72 6967 5f63 6f6c 6f72 732c  bot_orig_colors,
-00007b60: 6178 6973 3d30 290d 0a20 2020 2020 2020  axis=0)..       
-00007b70: 206f 626a 2e73 6574 5f63 6f6c 6f72 2874   obj.set_color(t
-00007b80: 6f74 616c 5f63 6f6c 6f72 7329 2020 2020  otal_colors)    
-00007b90: 2020 2020 0d0a 0d0a 2020 2020 2020 2020      ....        
-00007ba0: 6f62 6a2e 5f73 6574 5f67 656f 6d65 7472  obj._set_geometr
-00007bb0: 6963 5f62 6f75 6e64 7328 290d 0a20 2020  ic_bounds()..   
-00007bc0: 2020 2020 2072 6574 7572 6e20 6f62 6a0d       return obj.
-00007bd0: 0a0d 0a20 2020 2064 6566 205f 5f73 7472  ...    def __str
-00007be0: 5f5f 2873 656c 6629 203a 0d0a 2020 2020  __(self) :..    
-00007bf0: 2020 2020 2320 7061 7265 6e74 2063 6c61      # parent cla
-00007c00: 7373 2064 6f65 736e 2774 2068 6176 6520  ss doesn't have 
-00007c10: 7370 6563 6966 6963 2070 726f 7065 7274  specific propert
-00007c20: 6965 732e 2e2e 0d0a 2020 2020 2020 2020  ies.....        
-00007c30: 2320 4e6f 7465 3a20 7365 6c66 2e5f 7265  # Note: self._re
-00007c40: 7a20 6d61 7920 6265 2061 2073 7472 696e  z may be a strin
-00007c50: 6720 6f72 2069 6e74 2e20 2070 726f 6261  g or int.  proba
-00007c60: 626c 7920 6e6f 7420 676f 6f64 2062 7574  bly not good but
-00007c70: 204d 524f 490d 0a20 2020 2020 2020 2074   MROI..        t
-00007c80: 7279 3a20 2020 2020 6273 203d 2027 2028  ry:     bs = ' (
-00007c90: 207b 7d20 2c20 7b7d 2029 272e 666f 726d   {} , {} )'.form
-00007ca0: 6174 2873 656c 662e 5f72 657a 2c73 656c  at(self._rez,sel
-00007cb0: 662e 5f62 6173 6574 7970 6529 0d0a 2020  f._basetype)..  
-00007cc0: 2020 2020 2020 6578 6365 7074 3a20 2062        except:  b
-00007cd0: 7320 3d20 2720 270d 0a20 2020 2020 2020  s = ' '..       
-00007ce0: 206e 756d 4661 6365 7320 3d20 6c65 6e28   numFaces = len(
-00007cf0: 7365 6c66 2e66 7649 6e64 6963 6573 290d  self.fvIndices).
-00007d00: 0a20 2020 2020 2020 206e 756d 5665 7274  .        numVert
-00007d10: 7320 3d20 6c65 6e28 7365 6c66 2e76 6572  s = len(self.ver
-00007d20: 7465 7843 6f6f 7229 0d0a 2020 2020 2020  texCoor)..      
-00007d30: 2020 6e61 6d65 203d 2073 656c 662e 5f5f    name = self.__
-00007d40: 636c 6173 735f 5f2e 5f5f 6e61 6d65 5f5f  class__.__name__
-00007d50: 0d0a 2020 2020 2020 2020 737a 203d 2027  ..        sz = '
-00007d60: 3a20 2066 6163 6573 3a20 7b7d 2c20 2076  :  faces: {},  v
-00007d70: 6572 7469 6365 733a 207b 7d27 2e66 6f72  ertices: {}'.for
-00007d80: 6d61 7428 6e75 6d46 6163 6573 2c6e 756d  mat(numFaces,num
-00007d90: 5665 7274 7329 0d0a 2020 2020 2020 2020  Verts)..        
-00007da0: 7661 6c20 3d20 6e61 6d65 2b62 732b 737a  val = name+bs+sz
-00007db0: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00007dc0: 2076 616c 0d0a 0d0a 2020 2020 6465 6620   val....    def 
-00007dd0: 5f63 616c 635f 7265 7a28 7365 6c66 2c4e  _calc_rez(self,N
-00007de0: 3029 203a 0d0a 2020 2020 2020 2020 2320  0) :..        # 
-00007df0: 7374 7269 6e67 2076 616c 2066 6f72 2065  string val for e
-00007e00: 7175 6976 616c 656e 7420 6772 6964 2072  quivalent grid r
-00007e10: 657a 200d 0a20 2020 2020 2020 206e 756d  ez ..        num
-00007e20: 4661 6365 7320 3d20 6c65 6e28 7365 6c66  Faces = len(self
-00007e30: 2e66 7649 6e64 6963 6573 290d 0a20 2020  .fvIndices)..   
-00007e40: 2020 2020 2063 5265 7a20 3d20 6e70 2e6c       cRez = np.l
-00007e50: 6f67 3228 6e75 6d46 6163 6573 2f4e 3029  og2(numFaces/N0)
-00007e60: 2f32 0d0a 2020 2020 2020 2020 7265 7475  /2..        retu
-00007e70: 726e 2027 7b3a 2e31 667d 272e 666f 726d  rn '{:.1f}'.form
-00007e80: 6174 2863 5265 7a29 0d0a 0d0a 2020 2020  at(cRez)....    
-00007e90: 6465 6620 5f76 6572 7465 7843 6f6d 6d6f  def _vertexCommo
-00007ea0: 6e46 6163 6549 6e64 6963 6573 2873 656c  nFaceIndices(sel
-00007eb0: 6629 203a 0d0a 2020 2020 2020 2020 2222  f) :..        ""
-00007ec0: 2220 6c69 7374 206f 6620 6661 6365 2069  " list of face i
-00007ed0: 6e64 6963 6573 2061 7420 6561 6368 2076  ndices at each v
-00007ee0: 6572 7465 782e 2022 2222 0d0a 0d0a 2020  ertex. """....  
-00007ef0: 2020 2020 2020 2320 6e6f 7465 3a20 6120        # note: a 
-00007f00: 7665 7274 6578 206d 6179 2068 6176 6520  vertex may have 
-00007f10: 4e4f 2066 6163 6573 2028 656d 7074 7920  NO faces (empty 
-00007f20: 6661 6365 496e 6465 7820 6c69 7374 290d  faceIndex list).
-00007f30: 0a20 2020 2020 2020 2023 2020 2020 2020  .        #      
-00007f40: 2064 7565 2074 6f20 636c 6970 7069 6e67   due to clipping
-00007f50: 206f 7220 6120 7665 7274 6578 206e 6f74   or a vertex not
-00007f60: 2075 7365 6420 666f 7220 6120 6661 6365   used for a face
-00007f70: 2c20 736f 3a0d 0a20 2020 2020 2020 2076  , so:..        v
-00007f80: 6649 6e64 6963 6573 4c69 7374 203d 205b  fIndicesList = [
-00007f90: 205b 5d20 666f 7220 6920 696e 2072 616e   [] for i in ran
-00007fa0: 6765 286c 656e 2873 656c 662e 7665 7274  ge(len(self.vert
-00007fb0: 6578 436f 6f72 2929 5d0d 0a20 2020 2020  exCoor))]..     
-00007fc0: 2020 2023 206e 6f74 653a 2075 7375 616c     # note: usual
-00007fd0: 6c79 2076 6572 7469 6365 7320 6d61 7920  ly vertices may 
-00007fe0: 6861 7665 2031 2074 6f20 3620 636f 6d6d  have 1 to 6 comm
-00007ff0: 6f6e 2066 6163 6573 0d0a 2020 2020 2020  on faces..      
-00008000: 2020 666f 7220 692c 6661 6365 2069 6e20    for i,face in 
-00008010: 656e 756d 6572 6174 6528 7365 6c66 2e66  enumerate(self.f
-00008020: 7649 6e64 6963 6573 2920 3a0d 0a20 2020  vIndices) :..   
-00008030: 2020 2020 2020 2020 2066 6f72 2076 496e           for vIn
-00008040: 7820 696e 2066 6163 6520 3a0d 0a20 2020  x in face :..   
-00008050: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00008060: 7666 496e 6469 6365 734c 6973 745b 7649  vfIndicesList[vI
-00008070: 6e78 5d20 6973 204e 6f6e 6520 3a20 2076  nx] is None :  v
-00008080: 6649 6e64 6963 6573 4c69 7374 5b76 496e  fIndicesList[vIn
-00008090: 785d 203d 205b 695d 0d0a 2020 2020 2020  x] = [i]..      
-000080a0: 2020 2020 2020 2020 2020 656c 7365 203a            else :
-000080b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000080c0: 2020 2020 2020 2020 2020 2020 7666 496e              vfIn
-000080d0: 6469 6365 734c 6973 745b 7649 6e78 5d2e  dicesList[vInx].
-000080e0: 6170 7065 6e64 2869 290d 0a20 2020 2020  append(i)..     
-000080f0: 2020 2072 6574 7572 6e20 7666 496e 6469     return vfIndi
-00008100: 6365 734c 6973 740d 0a20 2020 2020 2020  cesList..       
-00008110: 200d 0a20 2020 2064 6566 205f 6564 6765   ..    def _edge
-00008120: 436f 6d6d 6f6e 4661 6365 496e 6469 6365  CommonFaceIndice
-00008130: 7328 7365 6c66 2920 3a0d 0a20 2020 2020  s(self) :..     
-00008140: 2020 2022 2222 206c 6973 7420 6f66 2066     """ list of f
-00008150: 6163 6520 696e 6469 6365 7320 6164 6a61  ace indices adja
-00008160: 6365 6e74 2074 6f20 6561 6368 2065 6467  cent to each edg
-00008170: 652e 2022 2222 0d0a 0d0a 2020 2020 2020  e. """....      
-00008180: 2020 6566 496e 6469 6365 734c 6973 7420    efIndicesList 
-00008190: 3d20 5b4e 6f6e 655d 2a6c 656e 2873 656c  = [None]*len(sel
-000081a0: 662e 6576 496e 6469 6365 7329 0d0a 2020  f.evIndices)..  
-000081b0: 2020 2020 2020 2320 6e6f 7465 3a20 6564        # note: ed
-000081c0: 6765 7320 6d61 7920 6861 7665 2031 206f  ges may have 1 o
-000081d0: 7220 3220 636f 6d6d 6f6e 2066 6163 6573  r 2 common faces
-000081e0: 0d0a 2020 2020 2020 2020 666f 7220 692c  ..        for i,
-000081f0: 6549 6e64 6578 2069 6e20 656e 756d 6572  eIndex in enumer
-00008200: 6174 6528 7365 6c66 2e65 7649 6e64 6963  ate(self.evIndic
-00008210: 6573 2920 3a0d 0a20 2020 2020 2020 2020  es) :..         
-00008220: 2020 2068 6561 645f 7666 6920 3d20 7365     head_vfi = se
-00008230: 6c66 2e76 6649 6e64 6963 6573 4c69 7374  lf.vfIndicesList
-00008240: 5b20 6549 6e64 6578 5b30 5d20 5d0d 0a20  [ eIndex[0] ].. 
-00008250: 2020 2020 2020 2020 2020 2074 6169 6c5f             tail_
-00008260: 7666 6920 3d20 7365 6c66 2e76 6649 6e64  vfi = self.vfInd
-00008270: 6963 6573 4c69 7374 5b20 6549 6e64 6578  icesList[ eIndex
-00008280: 5b31 5d20 5d0d 0a20 2020 2020 2020 2020  [1] ]..         
-00008290: 2020 2066 6f72 2066 6920 696e 2068 6561     for fi in hea
-000082a0: 645f 7666 6920 3a0d 0a20 2020 2020 2020  d_vfi :..       
-000082b0: 2020 2020 2020 2020 2069 6620 2866 6920           if (fi 
-000082c0: 696e 2074 6169 6c5f 7666 6929 203a 0d0a  in tail_vfi) :..
-000082d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000082e0: 2020 2020 6966 2065 6649 6e64 6963 6573      if efIndices
-000082f0: 4c69 7374 5b69 5d20 6973 204e 6f6e 653a  List[i] is None:
-00008300: 2020 2065 6649 6e64 6963 6573 4c69 7374     efIndicesList
-00008310: 5b69 5d20 3d20 5b66 695d 2020 0d0a 2020  [i] = [fi]  ..  
-00008320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008330: 2020 656c 7365 3a20 2020 2020 2020 2020    else:         
-00008340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008350: 2065 6649 6e64 6963 6573 4c69 7374 5b69   efIndicesList[i
-00008360: 5d2e 6170 7065 6e64 2866 6929 0d0a 2020  ].append(fi)..  
-00008370: 2020 2020 2020 7265 7475 726e 2065 6649        return efI
-00008380: 6e64 6963 6573 4c69 7374 0d0a 0d0a 2020  ndicesList....  
-00008390: 2020 6465 6620 5f63 6f6e 746f 7572 4c69    def _contourLi
-000083a0: 6e65 436f 6c6c 6563 7469 6f6e 2820 7365  neCollection( se
-000083b0: 6c66 2c20 646f 7470 726f 642c 2070 726f  lf, dotprod, pro
-000083c0: 6a56 6563 742c 202a 6172 6773 2029 203a  jVect, *args ) :
-000083d0: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
-000083e0: 2020 2020 2020 2020 2020 2043 6f6c 6f72             Color
-000083f0: 4c69 6e65 3344 436f 6c6c 6563 7469 6f6e  Line3DCollection
-00008400: 206f 6620 7365 676d 656e 7473 206f 6e20   of segments on 
-00008410: 6661 6365 7320 696e 7465 7265 6374 696e  faces interectin
-00008420: 6720 6120 706c 616e 652e 0d0a 0d0a 2020  g a plane.....  
-00008430: 2020 2020 2020 2020 2020 646f 7470 726f            dotpro
-00008440: 6420 202d 2064 6f74 2070 726f 6475 6374  d  - dot product
-00008450: 2062 6574 7765 656e 2065 6163 6820 7665   between each ve
-00008460: 7274 6578 2061 6e64 2070 6c61 6e65 206e  rtex and plane n
-00008470: 6f72 6d61 6c2e 0d0a 2020 2020 2020 2020  ormal...        
-00008480: 2020 2020 7072 6f6a 5665 6374 202d 2069      projVect - i
-00008490: 6e74 6572 6563 7469 6f6e 2070 6c61 6e65  nterection plane
-000084a0: 206e 6f72 6d61 6c0d 0a20 2020 2020 2020   normal..       
-000084b0: 2020 2020 202a 6172 6773 2020 2020 2d20       *args    - 
-000084c0: 6c69 7374 206f 6620 6469 7374 616e 6365  list of distance
-000084d0: 7320 6f66 2074 6865 2070 6c61 6e65 2074  s of the plane t
-000084e0: 6f20 7468 6520 6f72 6967 696e 2e0d 0a20  o the origin... 
-000084f0: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
-00008500: 2020 2020 2320 4675 7444 6576 3a20 5468      # FutDev: Th
-00008510: 6572 6520 6172 6520 2776 6573 7469 6761  ere are 'vestiga
-00008520: 6c27 206c 6f6f 7073 2064 7572 696e 6720  l' loops during 
-00008530: 6561 726c 7920 6465 7665 6c6f 706d 656e  early developmen
-00008540: 740d 0a20 2020 2020 2020 2023 2064 6562  t..        # deb
-00008550: 7567 6769 6e67 2077 6869 6368 206e 6565  ugging which nee
-00008560: 6420 746f 2062 6520 636c 6561 6e65 6420  d to be cleaned 
-00008570: 6f75 742e 2028 4d52 4f49 2066 6f72 2072  out. (MROI for r
-00008580: 656c 6561 7365 290d 0a20 2020 2020 2020  elease)..       
-00008590: 2023 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   # -------------
-000085a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000085b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000085c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000085d0: 2d2d 0d0a 2020 2020 2020 2020 6465 6620  --..        def 
-000085e0: 6765 744c 696e 6556 616c 7328 2064 6f74  getLineVals( dot
-000085f0: 7072 6f64 2c61 4c65 6e2c 7072 6f6a 5665  prod,aLen,projVe
-00008600: 6374 2920 3a0d 0a20 2020 2020 2020 2020  ct) :..         
-00008610: 2020 2023 202e 2e2e 2e2e 2e2e 2e2e 2e2e     # ...........
-00008620: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00008630: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00008640: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00008650: 2e2e 2e2e 2e0d 0a20 2020 2020 2020 2020  .......         
-00008660: 2020 2064 6566 206f 7264 6572 5f76 616c     def order_val
-00008670: 7565 2820 6661 6365 2c65 496e 6469 6365  ue( face,eIndice
-00008680: 732c 2063 6f6e 436f 6f72 2c20 706c 616e  s, conCoor, plan
-00008690: 654e 6f72 6d61 6c29 203a 0d0a 2020 2020  eNormal) :..    
-000086a0: 2020 2020 2020 2020 2020 2020 4120 3d20              A = 
-000086b0: 6549 6e64 6963 6573 5b30 5d0d 0a20 2020  eIndices[0]..   
-000086c0: 2020 2020 2020 2020 2020 2020 2042 203d               B =
-000086d0: 2065 496e 6469 6365 735b 315d 0d0a 2020   eIndices[1]..  
-000086e0: 2020 2020 2020 2020 2020 2020 2020 6676                fv
-000086f0: 6920 3d20 7365 6c66 2e66 7649 6e64 6963  i = self.fvIndic
-00008700: 6573 5b66 6163 655d 0d0a 2020 2020 2020  es[face]..      
-00008710: 2020 2020 2020 2020 2020 7665 7274 7320            verts 
-00008720: 3d20 7365 6c66 2e76 6572 7465 7843 6f6f  = self.vertexCoo
-00008730: 725b 2066 7669 205d 0d0a 2020 2020 2020  r[ fvi ]..      
-00008740: 2020 2020 2020 2020 2020 6661 6365 4e6f            faceNo
-00008750: 726d 616c 203d 2073 656c 662e 5f67 6574  rmal = self._get
-00008760: 5f66 6163 655f 6e6f 726d 616c 7328 5b76  _face_normals([v
-00008770: 6572 7473 5d29 0d0a 0d0a 2020 2020 2020  erts])....      
-00008780: 2020 2020 2020 2020 2020 6564 6765 5665            edgeVe
-00008790: 7274 5f41 203d 2063 6f6e 436f 6f72 5b41  rt_A = conCoor[A
-000087a0: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
-000087b0: 2020 2065 6467 6556 6572 745f 4220 3d20     edgeVert_B = 
-000087c0: 636f 6e43 6f6f 725b 425d 0d0a 2020 2020  conCoor[B]..    
-000087d0: 2020 2020 2020 2020 2020 2020 415f 746f              A_to
-000087e0: 5f42 203d 206e 702e 7375 6274 7261 6374  _B = np.subtract
-000087f0: 2865 6467 6556 6572 745f 422c 2065 6467  (edgeVert_B, edg
-00008800: 6556 6572 745f 4129 0d0a 2020 2020 2020  eVert_A)..      
-00008810: 2020 2020 2020 2020 2020 6564 6765 4372            edgeCr
-00008820: 6f73 7320 3d20 6e70 2e63 726f 7373 2841  oss = np.cross(A
-00008830: 5f74 6f5f 422c 2070 6c61 6e65 4e6f 726d  _to_B, planeNorm
-00008840: 616c 2029 0d0a 2020 2020 2020 2020 2020  al )..          
-00008850: 2020 2020 2020 6564 6765 4372 6f73 733d        edgeCross=
-00008860: 206e 702e 6469 7669 6465 2820 6564 6765   np.divide( edge
-00008870: 4372 6f73 732c 206e 702e 6c69 6e61 6c67  Cross, np.linalg
-00008880: 2e6e 6f72 6d28 6564 6765 4372 6f73 7329  .norm(edgeCross)
-00008890: 2029 0d0a 2020 2020 2020 2020 2020 2020   )..            
-000088a0: 2020 2020 7465 7374 203d 206e 702e 646f      test = np.do
-000088b0: 7428 6661 6365 4e6f 726d 616c 2c20 6564  t(faceNormal, ed
-000088c0: 6765 4372 6f73 7329 0d0a 2020 2020 2020  geCross)..      
-000088d0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-000088e0: 205b 412c 425d 2069 6620 7465 7374 3e30   [A,B] if test>0
-000088f0: 2065 6c73 6520 5b42 2c41 5d0d 0a20 2020   else [B,A]..   
-00008900: 2020 2020 2020 2020 2023 202e 2e2e 2e2e           # .....
-00008910: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00008920: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00008930: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00008940: 2e2e 2e2e 2e2e 2e2e 2e2e 2e0d 0a20 2020  .............   
-00008950: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-00008960: 2020 2020 2020 2023 202e 2e20 6765 7420         # .. get 
-00008970: 696e 7465 7273 6563 7420 636f 6f72 2066  intersect coor f
-00008980: 6f72 2065 6163 6820 6564 6765 2e2e 2e2e  or each edge....
-00008990: 2e2e 2e2e 0d0a 2020 2020 2020 2020 2020  ......          
-000089a0: 2020 6576 6920 3d20 7365 6c66 2e65 7649    evi = self.evI
-000089b0: 6e64 6963 6573 0d0a 2020 2020 2020 2020  ndices..        
-000089c0: 2020 2020 7665 7274 7320 3d20 7365 6c66      verts = self
-000089d0: 2e76 6572 7465 7843 6f6f 720d 0a20 2020  .vertexCoor..   
-000089e0: 2020 2020 2020 2020 2064 705f 6120 3d20           dp_a = 
-000089f0: 614c 656e 202d 2064 6f74 7072 6f64 0d0a  aLen - dotprod..
-00008a00: 2020 2020 2020 2020 2020 2020 6545 6c65              eEle
-00008a10: 7620 3d20 6470 5f61 5b65 7669 5d0d 0a20  v = dp_a[evi].. 
-00008a20: 2020 2020 2020 2020 2020 2023 2065 456c             # eEl
-00008a30: 6576 2069 7320 7468 6520 6469 7374 616e  ev is the distan
-00008a40: 6365 206f 6620 7468 6520 7477 6f20 6564  ce of the two ed
-00008a50: 6765 2076 6572 7469 6365 7320 6162 6f76  ge vertices abov
-00008a60: 652f 6265 6c6f 7720 7468 6520 706c 616e  e/below the plan
-00008a70: 652e 0d0a 2020 2020 2020 2020 2020 2020  e...            
-00008a80: 2320 6564 6765 7320 6372 6f73 7320 7468  # edges cross th
-00008a90: 6520 706c 616e 6520 6966 206f 6e65 2076  e plane if one v
-00008aa0: 6572 7465 7820 6973 2061 626f 7665 2c20  ertex is above, 
-00008ab0: 7468 6520 6f74 6865 7220 6265 6c6f 772e  the other below.
-00008ac0: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-00008ad0: 6865 6e63 6520 7468 6520 7072 6f64 7563  hence the produc
-00008ae0: 7420 6f66 2074 6865 2074 776f 2064 6973  t of the two dis
-00008af0: 7461 6e63 6573 2069 7320 6e65 6761 7469  tances is negati
-00008b00: 7665 2069 6620 6564 6765 2063 726f 7373  ve if edge cross
-00008b10: 6573 2074 6865 2070 6c61 6e65 2e0d 0a20  es the plane... 
-00008b20: 2020 2020 2020 2020 2020 2065 6443 686b             edChk
-00008b30: 203d 2065 456c 6576 5b3a 2c30 5d2a 6545   = eElev[:,0]*eE
-00008b40: 6c65 765b 3a2c 315d 0d0a 2020 2020 2020  lev[:,1]..      
-00008b50: 2020 2020 2020 7843 6f6f 7220 3d20 5b5d        xCoor = []
-00008b60: 2020 2320 696e 7465 7273 6563 7420 636f    # intersect co
-00008b70: 6f72 6469 6e61 7465 732e 0d0a 2020 2020  ordinates...    
-00008b80: 2020 2020 2020 2020 6576 6978 203d 205b          evix = [
-00008b90: 5d20 2020 2320 7468 6520 6564 6765 2069  ]   # the edge i
-00008ba0: 6e64 6578 206f 6620 7468 6520 696e 7465  ndex of the inte
-00008bb0: 7273 6563 7420 636f 6f72 6469 6e61 7465  rsect coordinate
-00008bc0: 2e0d 0a20 2020 2020 2020 2020 2020 2066  ...            f
-00008bd0: 6f72 2069 2069 6e20 7261 6e67 6528 206c  or i in range( l
-00008be0: 656e 2865 7669 2920 2920 3a0d 0a20 2020  en(evi) ) :..   
-00008bf0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00008c00: 6564 4368 6b5b 695d 203c 2030 2e30 203a  edChk[i] < 0.0 :
-00008c10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00008c20: 2020 2020 2020 7031 203d 2076 6572 7473        p1 = verts
-00008c30: 5b20 6576 695b 692c 305d 205d 0d0a 2020  [ evi[i,0] ]..  
-00008c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008c50: 2020 7032 203d 2076 6572 7473 5b20 6576    p2 = verts[ ev
-00008c60: 695b 692c 315d 205d 0d0a 2020 2020 2020  i[i,1] ]..      
-00008c70: 2020 2020 2020 2020 2020 2020 2020 6470                dp
-00008c80: 3120 3d20 646f 7470 726f 6420 5b20 6576  1 = dotprod [ ev
-00008c90: 695b 692c 305d 205d 0d0a 2020 2020 2020  i[i,0] ]..      
-00008ca0: 2020 2020 2020 2020 2020 2020 2020 6470                dp
-00008cb0: 3220 3d20 646f 7470 726f 6420 5b20 6576  2 = dotprod [ ev
-00008cc0: 695b 692c 315d 205d 0d0a 2020 2020 2020  i[i,1] ]..      
-00008cd0: 2020 2020 2020 2020 2020 2020 2020 615f                a_
-00008ce0: 6d64 7031 203d 2064 705f 6120 5b20 6576  mdp1 = dp_a [ ev
-00008cf0: 695b 692c 305d 205d 0d0a 2020 2020 2020  i[i,0] ]..      
-00008d00: 2020 2020 2020 2020 2020 2020 2020 6c6d                lm
-00008d10: 6220 3d20 615f 6d64 7031 2f28 2064 7032  b = a_mdp1/( dp2
-00008d20: 202d 2064 7031 2029 0d0a 2020 2020 2020   - dp1 )..      
-00008d30: 2020 2020 2020 2020 2020 2020 2020 7078                px
-00008d40: 203d 206c 6d62 2a6e 702e 7375 6274 7261   = lmb*np.subtra
-00008d50: 6374 2870 322c 7031 2920 2b20 7031 0d0a  ct(p2,p1) + p1..
-00008d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008d70: 2020 2020 7843 6f6f 722e 6170 7065 6e64      xCoor.append
-00008d80: 2870 7829 0d0a 2020 2020 2020 2020 2020  (px)..          
-00008d90: 2020 2020 2020 2020 2020 6576 6978 2e61            evix.a
-00008da0: 7070 656e 6428 6929 0d0a 0d0a 2020 2020  ppend(i)....    
-00008db0: 2020 2020 2020 2020 2320 2e2e 2064 6574          # .. det
-00008dc0: 6572 6d69 6e65 2066 6163 6573 2068 6176  ermine faces hav
-00008dd0: 696e 6720 6564 6765 7320 7768 6963 6820  ing edges which 
-00008de0: 6861 7665 2061 6e20 696e 7465 7273 6563  have an intersec
-00008df0: 742e 2e2e 2e2e 0d0a 2020 2020 2020 2020  t.......        
-00008e00: 2020 2020 6966 206c 656e 2878 436f 6f72      if len(xCoor
-00008e10: 2920 3d3d 2030 203a 2072 6574 7572 6e20  ) == 0 : return 
-00008e20: 4e6f 6e65 2c4e 6f6e 652c 4e6f 6e65 0d0a  None,None,None..
-00008e30: 2020 2020 2020 2020 2020 2020 6566 6920              efi 
-00008e40: 3d20 7365 6c66 2e65 6649 6e64 6963 6573  = self.efIndices
-00008e50: 4c69 7374 0d0a 2020 2020 2020 2020 2020  List..          
-00008e60: 2020 6e75 6d62 5865 6467 6573 203d 206c    numbXedges = l
-00008e70: 656e 2865 7669 7829 0d0a 2020 2020 2020  en(evix)..      
-00008e80: 2020 2020 2020 6669 6e64 6578 4469 6374        findexDict
-00008e90: 203d 207b 7d20 2023 2066 6163 6573 286b   = {}  # faces(k
-00008ea0: 6579 3d66 6163 6520 696e 6465 7829 2077  ey=face index) w
-00008eb0: 6869 6368 2068 6176 6520 7477 6f20 6564  hich have two ed
-00008ec0: 6765 7320 2876 616c 7565 3d78 436f 6f72  ges (value=xCoor
-00008ed0: 2069 6e64 6578 290d 0a20 2020 2020 2020   index)..       
-00008ee0: 2020 2020 2066 6f72 2069 2069 6e20 7261       for i in ra
-00008ef0: 6e67 6528 6e75 6d62 5865 6467 6573 2920  nge(numbXedges) 
-00008f00: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00008f10: 2020 2065 6920 3d20 6576 6978 5b69 5d0d     ei = evix[i].
-00008f20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00008f30: 2065 6669 4172 7220 3d20 6566 695b 6569   efiArr = efi[ei
-00008f40: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
-00008f50: 2020 2066 6f72 2066 6920 696e 2065 6669     for fi in efi
-00008f60: 4172 7220 3a0d 0a20 2020 2020 2020 2020  Arr :..         
-00008f70: 2020 2020 2020 2020 2020 2069 6620 6669             if fi
-00008f80: 2069 6e20 6669 6e64 6578 4469 6374 203a   in findexDict :
-00008f90: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00008fa0: 2020 2020 2020 2020 2020 6375 7256 616c            curVal
-00008fb0: 203d 2066 696e 6465 7844 6963 745b 6669   = findexDict[fi
-00008fc0: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
-00008fd0: 2020 2020 2020 2020 2020 2069 6620 6973             if is
-00008fe0: 696e 7374 616e 6365 2863 7572 5661 6c2c  instance(curVal,
-00008ff0: 6c69 7374 2920 3a0d 0a20 2020 2020 2020  list) :..       
-00009000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009010: 2020 2020 2023 2044 6576 4e6f 7465 3a20       # DevNote: 
-00009020: 7468 6973 206d 6f64 6966 6963 6174 696f  this modificatio
-00009030: 6e73 2069 7320 6120 636f 6e73 6571 7565  ns is a conseque
-00009040: 6e63 6520 6f66 2071 7561 6472 696c 6174  nce of quadrilat
-00009050: 6572 616c 0d0a 2020 2020 2020 2020 2020  eral..          
-00009060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009070: 2020 2320 6661 6365 732c 2077 6869 6368    # faces, which
-00009080: 206d 6179 2068 6176 6520 6d6f 7265 2074   may have more t
-00009090: 6861 6e20 6f6e 6520 696e 7465 7273 6563  han one intersec
-000090a0: 7469 6f6f 6e20 746f 2061 2070 6c61 6e65  tioon to a plane
-000090b0: 2e0d 0a20 2020 2020 2020 2020 2020 2020  ...             
-000090c0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-000090d0: 2054 6869 7320 6f6e 6c79 2065 6c69 6d69   This only elimi
-000090e0: 6e61 7465 7320 7275 6e74 696d 6520 6572  nates runtime er
-000090f0: 726f 722e 2020 536f 6c75 7469 6f6e 2069  ror.  Solution i
-00009100: 7320 746f 2075 7365 2061 2073 7572 6661  s to use a surfa
-00009110: 6365 0d0a 2020 2020 2020 2020 2020 2020  ce..            
-00009120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009130: 2320 7769 7468 206c 7265 7a20 3e20 302c  # with lrez > 0,
-00009140: 2074 6865 6e20 6765 6e65 7261 7465 6420   then generated 
-00009150: 636f 6e74 6f75 7273 2e20 0d0a 2020 2020  contours. ..    
-00009160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009170: 2020 2020 2020 2020 6e65 7756 616c 203d          newVal =
-00009180: 205b 6375 7256 616c 5b30 5d2c 695d 0d0a   [curVal[0],i]..
-00009190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000091a0: 2020 2020 2020 2020 656c 7365 203a 0d0a          else :..
-000091b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000091c0: 2020 2020 2020 2020 2020 2020 6e65 7756              newV
-000091d0: 616c 203d 205b 6375 7256 616c 2c69 5d20  al = [curVal,i] 
-000091e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000091f0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-00009200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009210: 6669 6e64 6578 4469 6374 5b66 695d 203d  findexDict[fi] =
-00009220: 206e 6577 5661 6c0d 0a20 2020 2020 2020   newVal..       
-00009230: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-00009240: 6520 3a0d 0a20 2020 2020 2020 2020 2020  e :..           
-00009250: 2020 2020 2020 2020 2020 2020 2066 696e               fin
-00009260: 6465 7844 6963 745b 6669 5d20 3d20 690d  dexDict[fi] = i.
-00009270: 0a20 2020 2020 2020 2020 2020 2023 2072  .            # r
-00009280: 656d 6f76 6520 6661 6365 2069 6e74 6572  emove face inter
-00009290: 7365 7420 706f 696e 7473 2069 6620 6661  set points if fa
-000092a0: 6365 206f 6e6c 7920 6861 7320 6f6e 6520  ce only has one 
-000092b0: 696e 7465 7273 6563 7420 6564 6765 0d0a  intersect edge..
-000092c0: 2020 2020 2020 2020 2020 2020 2320 2820              # ( 
-000092d0: 696e 7465 7273 6563 7420 6d61 7920 6265  intersect may be
-000092e0: 206f 6e20 6120 7665 7274 6578 2029 0d0a   on a vertex )..
-000092f0: 2020 2020 2020 2020 2020 2020 230d 0a20              #.. 
-00009300: 2020 2020 2020 2020 2020 2074 6573 7420             test 
-00009310: 3d20 5b20 7820 666f 7220 7820 696e 2066  = [ x for x in f
-00009320: 696e 6465 7844 6963 742e 7661 6c75 6573  indexDict.values
-00009330: 2829 2069 6620 7479 7065 2878 2920 6973  () if type(x) is
-00009340: 206c 6973 7420 5d0d 0a20 2020 2020 2020   list ]..       
-00009350: 2020 2020 2069 6620 6c65 6e28 7465 7374       if len(test
-00009360: 2920 3d3d 2030 203a 2072 6574 7572 6e20  ) == 0 : return 
-00009370: 4e6f 6e65 2c4e 6f6e 652c 4e6f 6e65 0d0a  None,None,None..
-00009380: 2020 2020 2020 2020 2020 2020 230d 0a20              #.. 
-00009390: 2020 2020 2020 2020 2020 2066 6163 652c             face,
-000093a0: 2063 6f6f 7249 6e78 203d 205b 5d2c 205b   coorInx = [], [
-000093b0: 5d0d 0a20 2020 2020 2020 2020 2020 2066  ]..            f
-000093c0: 6f72 206b 6579 2c76 616c 7565 2069 6e20  or key,value in 
-000093d0: 6669 6e64 6578 4469 6374 2e69 7465 6d73  findexDict.items
-000093e0: 2829 203a 0d0a 2020 2020 2020 2020 2020  () :..          
-000093f0: 2020 2020 2020 6966 2074 7970 6528 7661        if type(va
-00009400: 6c75 6529 2069 7320 6c69 7374 203a 0d0a  lue) is list :..
-00009410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009420: 2020 2020 7661 6c75 6558 203d 206f 7264      valueX = ord
-00009430: 6572 5f76 616c 7565 286b 6579 2c76 616c  er_value(key,val
-00009440: 7565 2c78 436f 6f72 2c70 726f 6a56 6563  ue,xCoor,projVec
-00009450: 7429 0d0a 2020 2020 2020 2020 2020 2020  t)..            
-00009460: 2020 2020 2020 2020 636f 6f72 496e 782e          coorInx.
-00009470: 6170 7065 6e64 2876 616c 7565 5829 0d0a  append(valueX)..
-00009480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009490: 2020 2020 6661 6365 2e61 7070 656e 6428      face.append(
-000094a0: 6b65 7929 0d0a 0d0a 2020 2020 2020 2020  key)....        
-000094b0: 2020 2020 6966 206c 656e 2863 6f6f 7249      if len(coorI
-000094c0: 6e78 2920 3d3d 2030 203a 2072 6574 7572  nx) == 0 : retur
-000094d0: 6e20 4e6f 6e65 2c4e 6f6e 652c 4e6f 6e65  n None,None,None
-000094e0: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
-000094f0: 7475 726e 206e 702e 6172 7261 7928 7843  turn np.array(xC
-00009500: 6f6f 7229 2c20 636f 6f72 496e 782c 2066  oor), coorInx, f
-00009510: 6163 650d 0a20 2020 2020 2020 2023 202d  ace..        # -
-00009520: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00009530: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00009540: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00009550: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a  --------------..
-00009560: 2020 2020 2020 2020 6465 6620 6765 7443          def getC
-00009570: 6f6c 6f72 7328 636f 6c6f 7273 2c20 696e  olors(colors, in
-00009580: 6469 6365 7329 203a 0d0a 2020 2020 2020  dices) :..      
-00009590: 2020 2020 2020 636f 6e5f 636f 6c6f 7273        con_colors
-000095a0: 203d 205b 4e6f 6e65 5d2a 6c65 6e28 696e   = [None]*len(in
-000095b0: 6469 6365 7329 0d0a 2020 2020 2020 2020  dices)..        
-000095c0: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
-000095d0: 6765 286c 656e 2869 6e64 6963 6573 2929  ge(len(indices))
-000095e0: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
-000095f0: 2020 2020 636f 6e5f 636f 6c6f 7273 5b69      con_colors[i
-00009600: 5d20 3d20 636f 6c6f 7273 5b69 6e64 6963  ] = colors[indic
-00009610: 6573 5b69 5d5d 0d0a 2020 2020 2020 2020  es[i]]..        
-00009620: 2020 2020 7265 7475 726e 2063 6f6e 5f63      return con_c
-00009630: 6f6c 6f72 730d 0a20 2020 2020 2020 2023  olors..        #
-00009640: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
-00009650: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00009660: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00009670: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00009680: 0d0a 2020 2020 2020 2020 2320 6765 7420  ..        # get 
-00009690: 7468 6520 7375 7266 6163 6520 636f 6c6f  the surface colo
-000096a0: 7273 2077 6869 6368 2077 696c 6c20 6265  rs which will be
-000096b0: 2061 7070 6c69 6564 2074 6f20 7468 6520   applied to the 
-000096c0: 6465 6661 756c 7420 636f 6e74 6f75 7220  default contour 
-000096d0: 636f 6c6f 7273 0d0a 2020 2020 2020 2020  colors..        
-000096e0: 7365 6c66 2e5f 706f 7374 5072 6f63 5f73  self._postProc_s
-000096f0: 7572 6661 6365 436f 6c6f 7273 2829 0d0a  urfaceColors()..
-00009700: 2020 2020 2020 2020 7375 7266 5f63 6f6c          surf_col
-00009710: 6f72 7320 3d20 7365 6c66 2e5f 6661 6365  ors = self._face
-00009720: 636f 6c6f 7273 0d0a 0d0a 2020 2020 2020  colors....      
-00009730: 2020 6966 2074 7970 6528 6172 6773 5b30    if type(args[0
-00009740: 5d29 2069 7320 7475 706c 6520 3a20 6172  ]) is tuple : ar
-00009750: 6773 3d61 7267 735b 305d 0d0a 2020 2020  gs=args[0]..    
-00009760: 2020 2020 6c69 6e65 203d 204e 6f6e 650d      line = None.
-00009770: 0a20 2020 2020 2020 2066 6f72 2061 4c65  .        for aLe
-00009780: 6e20 696e 2061 7267 7320 3a0d 0a20 2020  n in args :..   
-00009790: 2020 2020 2020 2020 2076 6572 7465 7843           vertexC
-000097a0: 6f6f 722c 7365 676d 496e 6469 6365 732c  oor,segmIndices,
-000097b0: 6661 6365 496e 6469 6365 7320 3d20 6765  faceIndices = ge
-000097c0: 744c 696e 6556 616c 7328 2064 6f74 7072  tLineVals( dotpr
-000097d0: 6f64 2c61 4c65 6e2c 7072 6f6a 5665 6374  od,aLen,projVect
-000097e0: 2020 290d 0a20 2020 2020 2020 2020 2020    )..           
-000097f0: 2069 6620 7665 7274 6578 436f 6f72 2069   if vertexCoor i
-00009800: 7320 4e6f 6e65 203a 0d0a 2020 2020 2020  s None :..      
-00009810: 2020 2020 2020 2020 2020 7761 726e 696e            warnin
-00009820: 6773 2e77 6172 6e28 2027 5375 7266 6163  gs.warn( 'Surfac
-00009830: 6520 636f 6e74 6f75 724c 696e 6573 206e  e contourLines n
-00009840: 6f74 2066 6f75 6e64 2066 6f72 2064 6973  ot found for dis
-00009850: 7420 7661 6c75 6520 6f66 207b 7d27 2e66  t value of {}'.f
-00009860: 6f72 6d61 7428 614c 656e 2920 290d 0a20  ormat(aLen) ).. 
-00009870: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00009880: 6f6e 7469 6e75 650d 0a20 2020 2020 2020  ontinue..       
-00009890: 2020 2020 2074 6c69 6e65 203d 2043 6f6c       tline = Col
-000098a0: 6f72 4c69 6e65 3344 436f 6c6c 6563 7469  orLine3DCollecti
-000098b0: 6f6e 2876 6572 7465 7843 6f6f 722c 7365  on(vertexCoor,se
-000098c0: 676d 496e 6469 6365 7329 0d0a 2020 2020  gmIndices)..    
-000098d0: 2020 2020 2020 2020 6966 2074 6c69 6e65          if tline
-000098e0: 2069 7320 4e6f 6e65 203a 2063 6f6e 7469   is None : conti
-000098f0: 6e75 650d 0a20 2020 2020 2020 2020 2020  nue..           
-00009900: 2074 6c69 6e65 2e73 6574 5f63 6f6c 6f72   tline.set_color
-00009910: 2867 6574 436f 6c6f 7273 2873 7572 665f  (getColors(surf_
-00009920: 636f 6c6f 7273 2c66 6163 6549 6e64 6963  colors,faceIndic
-00009930: 6573 2929 2023 2064 6566 6175 6c74 2073  es)) # default s
-00009940: 7572 6661 6365 2063 6f6c 6f72 0d0a 2020  urface color..  
-00009950: 2020 2020 2020 2020 2020 6966 206c 696e            if lin
-00009960: 6520 6973 204e 6f6e 653a 206c 696e 6520  e is None: line 
-00009970: 3d20 746c 696e 650d 0a20 2020 2020 2020  = tline..       
-00009980: 2020 2020 2065 6c73 653a 206c 696e 6520       else: line 
-00009990: 2b3d 2074 6c69 6e65 200d 0a20 2020 2020  += tline ..     
-000099a0: 2020 2072 6574 7572 6e20 6c69 6e65 0d0a     return line..
-000099b0: 0d0a 2020 2020 6465 6620 5f74 7261 6e73  ..    def _trans
-000099c0: 666f 726d 5665 6374 6f72 2873 656c 662c  formVector(self,
-000099d0: 206f 7267 436f 6f72 2c20 6f70 6572 6174   orgCoor, operat
-000099e0: 696f 6e2c 2072 6574 7572 6e78 797a 2920  ion, returnxyz) 
-000099f0: 3a0d 0a20 2020 2020 2020 2022 2222 2046  :..        """ F
-00009a00: 756e 6374 696f 6e61 6c20 7472 616e 7366  unctional transf
-00009a10: 6f72 6d61 7469 6f6e 206f 6620 636f 6f72  ormation of coor
-00009a20: 6469 6e61 7465 732e 2022 2222 0d0a 2020  dinates. """..  
-00009a30: 2020 2020 2020 7879 7a20 3d20 6e70 2e74        xyz = np.t
-00009a40: 7261 6e73 706f 7365 286f 7267 436f 6f72  ranspose(orgCoor
-00009a50: 290d 0a20 2020 2020 2020 2061 6263 203d  )..        abc =
-00009a60: 2073 656c 662e 636f 6f72 5f63 6f6e 7665   self.coor_conve
-00009a70: 7274 2878 797a 290d 0a20 2020 2020 2020  rt(xyz)..       
-00009a80: 2072 7374 203d 206e 702e 6172 7261 7928   rst = np.array(
-00009a90: 6f70 6572 6174 696f 6e28 6162 6329 290d  operation(abc)).
-00009aa0: 0a20 2020 2020 2020 2069 6620 7265 7475  .        if retu
-00009ab0: 726e 7879 7a20 3a20 5859 5a20 3d20 7273  rnxyz : XYZ = rs
-00009ac0: 740d 0a20 2020 2020 2020 2065 6c73 6520  t..        else 
-00009ad0: 3a20 2020 2020 2020 2020 5859 5a20 3d20  :         XYZ = 
-00009ae0: 7365 6c66 2e63 6f6f 725f 636f 6e76 6572  self.coor_conver
-00009af0: 7428 2072 7374 202c 2074 6f63 6172 743d  t( rst , tocart=
-00009b00: 5472 7565 2029 0d0a 2020 2020 2020 2020  True )..        
-00009b10: 7265 7475 726e 206e 702e 7472 616e 7370  return np.transp
-00009b20: 6f73 6528 5859 5a29 0d0a 0d0a 2020 2020  ose(XYZ)....    
-00009b30: 6465 6620 5f67 6574 5f76 6563 746f 7266  def _get_vectorf
-00009b40: 6965 6c64 5f4c 696e 6533 4443 6f6c 6c65  ield_Line3DColle
-00009b50: 6374 696f 6e28 7365 6c66 2c20 7665 6374  ction(self, vect
-00009b60: 6f72 5f66 6965 6c64 2c20 636f 6c6f 722c  or_field, color,
-00009b70: 2077 6964 7468 2c20 616c 7229 203a 0d0a   width, alr) :..
-00009b80: 2020 2020 2020 2020 2222 2256 6563 746f          """Vecto
-00009b90: 7233 4443 6f6c 6c65 6374 696f 6e20 6174  r3DCollection at
-00009ba0: 2073 7572 6661 6365 2076 6572 7469 6365   surface vertice
-00009bb0: 732e 2222 2220 0d0a 0d0a 2020 2020 2020  s.""" ....      
-00009bc0: 2020 7365 6c66 2e76 6563 746f 725f 6669    self.vector_fi
-00009bd0: 656c 6420 3d20 7665 6374 6f72 5f66 6965  eld = vector_fie
-00009be0: 6c64 0d0a 2020 2020 2020 2020 0d0a 2020  ld..        ..  
-00009bf0: 2020 2020 2020 6c63 6f6c 203d 2056 6563        lcol = Vec
-00009c00: 746f 7233 4443 6f6c 6c65 6374 696f 6e28  tor3DCollection(
-00009c10: 7365 6c66 2e76 6572 7465 7843 6f6f 722c  self.vertexCoor,
-00009c20: 7665 6374 6f72 5f66 6965 6c64 2c61 6c72  vector_field,alr
-00009c30: 2c63 6f6c 6f72 733d 636f 6c6f 722c 206c  ,colors=color, l
-00009c40: 696e 6577 6964 7468 733d 7769 6474 6829  inewidths=width)
-00009c50: 0d0a 2020 2020 2020 2020 2320 2d2d 2d20  ..        # --- 
-00009c60: 312e 3120 6d6f 6420 2d2d 2d2d 2d2d 2d2d  1.1 mod --------
-00009c70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020  ------------..  
-00009c80: 2020 2020 2020 6c63 6f6c 2e63 6f6f 7254        lcol.coorT
-00009c90: 7970 6520 3d20 7365 6c66 2e63 6f6f 7254  ype = self.coorT
-00009ca0: 7970 650d 0a20 2020 2020 2020 206c 636f  ype..        lco
-00009cb0: 6c2e 7576 774f 7269 656e 7461 7469 6f6e  l.uvwOrientation
-00009cc0: 5479 7065 203d 2073 656c 662e 636f 6f72  Type = self.coor
-00009cd0: 5479 7065 0d0a 2020 2020 2020 2020 7265  Type..        re
-00009ce0: 7475 726e 206c 636f 6c0d 0a0d 0a20 2020  turn lcol....   
-00009cf0: 2064 6566 205f 6765 745f 7665 7274 6578   def _get_vertex
-00009d00: 5f6e 6f72 6d61 6c73 2873 656c 6629 203a  _normals(self) :
-00009d10: 0d0a 2020 2020 2020 2020 2222 2255 6e69  ..        """Uni
-00009d20: 7420 6e6f 726d 616c 7320 6f66 2061 7420  t normals of at 
-00009d30: 7665 7274 6578 2063 6f6f 7264 696e 6174  vertex coordinat
-00009d40: 6573 2e20 2222 220d 0a0d 0a20 2020 2020  es. """....     
-00009d50: 2020 2023 2054 6865 206e 6f72 6d61 6c69     # The normali
-00009d60: 7a65 6420 756e 7765 6967 6874 6564 2061  zed unweighted a
-00009d70: 7665 7261 6765 206f 6620 7468 6520 7375  verage of the su
-00009d80: 7266 6163 650d 0a20 2020 2020 2020 2023  rface..        #
-00009d90: 206e 6f72 6d61 6c73 206f 6620 7468 6520   normals of the 
-00009da0: 6661 6365 7320 7468 6174 2063 6f6e 7461  faces that conta
-00009db0: 696e 2074 6861 7420 7665 7274 6578 2e0d  in that vertex..
-00009dc0: 0a0d 0a20 2020 2020 2020 2076 6572 7473  ...        verts
-00009dd0: 203d 2073 656c 662e 7665 7274 6578 436f   = self.vertexCo
-00009de0: 6f72 5b20 7365 6c66 2e66 7649 6e64 6963  or[ self.fvIndic
-00009df0: 6573 205d 0d0a 2020 2020 2020 2020 6661  es ]..        fa
-00009e00: 6365 4e6f 726d 616c 436f 6f72 203d 2073  ceNormalCoor = s
-00009e10: 656c 662e 5f67 6574 5f66 6163 655f 6e6f  elf._get_face_no
-00009e20: 726d 616c 7328 7665 7274 7329 0d0a 2020  rmals(verts)..  
-00009e30: 2020 2020 2020 2320 6e6f 7465 3a20 666f        # note: fo
-00009e40: 6c6c 6f77 696e 6720 6c69 7374 2061 7265  llowing list are
-00009e50: 2074 6865 2066 6163 6520 696e 6469 6365   the face indice
-00009e60: 7320 7468 6174 2065 6163 6820 7665 7274  s that each vert
-00009e70: 6578 2069 7320 6120 6d65 6d62 6572 2e0d  ex is a member..
-00009e80: 0a20 2020 2020 2020 2023 2020 2020 2020  .        #      
-00009e90: 2053 696e 6365 2074 6865 206e 756d 6265   Since the numbe
-00009ea0: 7220 6f66 2066 6163 6573 2061 2076 6572  r of faces a ver
-00009eb0: 7465 7820 6973 2061 7474 6163 6865 6420  tex is attached 
-00009ec0: 7261 6e67 6573 2066 726f 6d20 3120 2d20  ranges from 1 - 
-00009ed0: 362c 0d0a 2020 2020 2020 2020 2320 2020  6,..        #   
-00009ee0: 2020 2020 6e65 6564 7320 6120 6c69 7374      needs a list
-00009ef0: 2c20 6e6f 7420 616e 206e 702e 6172 7261  , not an np.arra
-00009f00: 792e 0d0a 2020 2020 2020 2020 7666 496e  y...        vfIn
-00009f10: 6469 6365 734c 6973 7420 3d20 5b20 4e6f  dicesList = [ No
-00009f20: 6e65 205d 202a 6c65 6e28 7365 6c66 2e76  ne ] *len(self.v
-00009f30: 6572 7465 7843 6f6f 7229 0d0a 2020 2020  ertexCoor)..    
-00009f40: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
-00009f50: 6765 286c 656e 2876 6649 6e64 6963 6573  ge(len(vfIndices
-00009f60: 4c69 7374 2929 203a 2076 6649 6e64 6963  List)) : vfIndic
-00009f70: 6573 4c69 7374 5b69 5d20 3d20 5b5d 0d0a  esList[i] = []..
-00009f80: 0d0a 2020 2020 2020 2020 666f 7220 6649  ..        for fI
-00009f90: 6e78 2069 6e20 7261 6e67 6528 206c 656e  nx in range( len
-00009fa0: 2873 656c 662e 6676 496e 6469 6365 7329  (self.fvIndices)
-00009fb0: 2029 203a 0d0a 2020 2020 2020 2020 2020   ) :..          
-00009fc0: 2020 6661 6365 203d 2073 656c 662e 6676    face = self.fv
-00009fd0: 496e 6469 6365 735b 6649 6e78 5d0d 0a20  Indices[fInx].. 
-00009fe0: 2020 2020 2020 2020 2020 2066 6f72 2076             for v
-00009ff0: 496e 7820 696e 2066 6163 6520 3a0d 0a20  Inx in face :.. 
-0000a000: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-0000a010: 6649 6e64 6963 6573 4c69 7374 5b76 496e  fIndicesList[vIn
-0000a020: 785d 2e61 7070 656e 6428 6649 6e78 290d  x].append(fInx).
-0000a030: 0a0d 0a20 2020 2020 2020 2023 2044 6576  ...        # Dev
-0000a040: 4e6f 7465 3a20 7072 6f62 6162 6c79 2061  Note: probably a
-0000a050: 2027 636c 6561 6e65 7227 206d 6574 686f   'cleaner' metho
-0000a060: 643f 2020 4d52 4f49 0d0a 2020 2020 2020  d?  MROI..      
-0000a070: 2020 6e6f 726d 616c 7320 3d20 5b20 4e6f    normals = [ No
-0000a080: 6e65 205d 202a 6c65 6e28 7365 6c66 2e76  ne ] *len(self.v
-0000a090: 6572 7465 7843 6f6f 7229 0d0a 2020 2020  ertexCoor)..    
-0000a0a0: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
-0000a0b0: 6765 286c 656e 286e 6f72 6d61 6c73 2929  ge(len(normals))
-0000a0c0: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
-0000a0d0: 7665 7274 203d 2076 6649 6e64 6963 6573  vert = vfIndices
-0000a0e0: 4c69 7374 5b69 5d0d 0a20 2020 2020 2020  List[i]..       
-0000a0f0: 2020 2020 2076 6572 744c 6973 7420 3d20       vertList = 
-0000a100: 6661 6365 4e6f 726d 616c 436f 6f72 5b20  faceNormalCoor[ 
-0000a110: 7665 7274 205d 0d0a 2020 2020 2020 2020  vert ]..        
-0000a120: 2020 2020 7665 7274 5375 6d20 3d20 6e70      vertSum = np
-0000a130: 2e73 756d 2876 6572 744c 6973 742c 6178  .sum(vertList,ax
-0000a140: 6973 3d30 292f 6c65 6e28 7665 7274 4c69  is=0)/len(vertLi
-0000a150: 7374 290d 0a20 2020 2020 2020 2020 2020  st)..           
-0000a160: 2075 6e69 7456 6563 746f 7220 3d20 6e70   unitVector = np
-0000a170: 2e64 6976 6964 6528 2076 6572 7453 756d  .divide( vertSum
-0000a180: 2c20 6e70 2e6c 696e 616c 672e 6e6f 726d  , np.linalg.norm
-0000a190: 2876 6572 7453 756d 2920 290d 0a20 2020  (vertSum) )..   
-0000a1a0: 2020 2020 2020 2020 206e 6f72 6d61 6c73           normals
-0000a1b0: 5b69 5d20 3d20 756e 6974 5665 6374 6f72  [i] = unitVector
-0000a1c0: 0d0a 0d0a 2020 2020 2020 2020 6e6f 726d  ....        norm
-0000a1d0: 616c 7320 3d20 6e70 2e61 7272 6179 286e  als = np.array(n
-0000a1e0: 6f72 6d61 6c73 290d 0a20 2020 2020 2020  ormals)..       
-0000a1f0: 2072 6574 7572 6e20 6e6f 726d 616c 730d   return normals.
-0000a200: 0a0d 0a20 2020 2064 6566 205f 6765 745f  ...    def _get_
-0000a210: 6661 6365 5f6e 6f72 6d61 6c73 2873 656c  face_normals(sel
-0000a220: 662c 6661 6365 436f 6f72 2c61 7573 663d  f,faceCoor,ausf=
-0000a230: 4e6f 6e65 2920 3a0d 0a20 2020 2020 2020  None) :..       
-0000a240: 2022 2222 2055 6e69 7420 6e6f 726d 616c   """ Unit normal
-0000a250: 7320 6f66 2074 7269 616e 6775 6c61 7220  s of triangular 
-0000a260: 6661 6365 2063 6f6f 7264 696e 6174 6573  face coordinates
-0000a270: 2e22 2222 0d0a 0d0a 2020 2020 2020 2020  ."""....        
-0000a280: 7666 5420 3d20 6e70 2e74 7261 6e73 706f  vfT = np.transpo
-0000a290: 7365 2866 6163 6543 6f6f 722c 2028 312c  se(faceCoor, (1,
-0000a2a0: 322c 3029 2029 0d0a 2020 2020 2020 2020  2,0) )..        
-0000a2b0: 7641 4220 3d20 6e70 2e73 7562 7472 6163  vAB = np.subtrac
-0000a2c0: 7428 2076 6654 5b31 5d2c 2076 6654 5b30  t( vfT[1], vfT[0
-0000a2d0: 5d20 2029 0d0a 2020 2020 2020 2020 7641  ]  )..        vA
-0000a2e0: 4320 3d20 6e70 2e73 7562 7472 6163 7428  C = np.subtract(
-0000a2f0: 2076 6654 5b32 5d2c 2076 6654 5b30 5d20   vfT[2], vfT[0] 
-0000a300: 2029 0d0a 2020 2020 2020 2020 7641 4274   )..        vABt
-0000a310: 203d 206e 702e 7472 616e 7370 6f73 6528   = np.transpose(
-0000a320: 7641 4229 0d0a 2020 2020 2020 2020 7641  vAB)..        vA
-0000a330: 4374 203d 206e 702e 7472 616e 7370 6f73  Ct = np.transpos
-0000a340: 6528 7641 4329 0d0a 2020 2020 2020 2020  e(vAC)..        
-0000a350: 6966 2061 7573 6620 6973 206e 6f74 204e  if ausf is not N
-0000a360: 6f6e 653a 0d0a 2020 2020 2020 2020 2020  one:..          
-0000a370: 2020 7641 4274 203d 2076 4142 742a 6175    vABt = vABt*au
-0000a380: 7366 0d0a 2020 2020 2020 2020 2020 2020  sf..            
-0000a390: 7641 4374 203d 2076 4143 742a 6175 7366  vACt = vACt*ausf
-0000a3a0: 0d0a 2020 2020 2020 2020 6372 6f73 7320  ..        cross 
-0000a3b0: 3d20 6e70 2e63 726f 7373 2876 4142 742c  = np.cross(vABt,
-0000a3c0: 7641 4374 290d 0a20 2020 2020 2020 2073  vACt)..        s
-0000a3d0: 7a20 3d20 6e70 2e6c 696e 616c 672e 6e6f  z = np.linalg.no
-0000a3e0: 726d 2863 726f 7373 2c61 7869 733d 3129  rm(cross,axis=1)
-0000a3f0: 5b3a 2c6e 702e 6e65 7761 7869 735d 0d0a  [:,np.newaxis]..
-0000a400: 2020 2020 2020 2020 7265 7475 726e 206e          return n
-0000a410: 702e 6469 7669 6465 2863 726f 7373 2c73  p.divide(cross,s
-0000a420: 7a29 0d0a 0d0a 2020 2020 6465 6620 5f67  z)....    def _g
-0000a430: 6574 5f66 6163 655f 6365 6e74 6572 7328  et_face_centers(
-0000a440: 7365 6c66 2c66 6163 6543 6f6f 7229 203a  self,faceCoor) :
-0000a450: 0d0a 2020 2020 2020 2020 2222 2220 4661  ..        """ Fa
-0000a460: 6365 2063 656e 7465 7273 2066 726f 6d20  ce centers from 
-0000a470: 6661 6365 2076 6572 7465 7820 636f 6f72  face vertex coor
-0000a480: 6469 6e61 7465 732e 2022 2222 0d0a 2020  dinates. """..  
-0000a490: 2020 2020 2020 7666 5420 3d20 6e70 2e74        vfT = np.t
-0000a4a0: 7261 6e73 706f 7365 2866 6163 6543 6f6f  ranspose(faceCoo
-0000a4b0: 722c 2028 312c 322c 3029 2029 0d0a 2020  r, (1,2,0) )..  
-0000a4c0: 2020 2020 2020 6e75 6d56 6572 7473 203d        numVerts =
-0000a4d0: 2076 6654 2e73 6861 7065 5b30 5d0d 0a20   vfT.shape[0].. 
-0000a4e0: 2020 2020 2020 2073 756d 5620 3d20 6e70         sumV = np
-0000a4f0: 2e73 756d 2876 6654 2c20 6178 6973 3d30  .sum(vfT, axis=0
-0000a500: 290d 0a20 2020 2020 2020 2072 6574 7572  )..        retur
-0000a510: 6e20 6e70 2e74 7261 6e73 706f 7365 2873  n np.transpose(s
-0000a520: 756d 5629 2f6e 756d 5665 7274 730d 0a0d  umV)/numVerts...
-0000a530: 0a20 2020 2064 6566 205f 7365 745f 6765  .    def _set_ge
-0000a540: 6f6d 6574 7269 635f 626f 756e 6473 2873  ometric_bounds(s
-0000a550: 656c 6629 203a 0d0a 2020 2020 2020 2020  elf) :..        
-0000a560: 2222 2220 7365 7420 7468 6520 626f 756e  """ set the boun
-0000a570: 6473 2064 6963 7469 6f6e 6172 7920 6672  ds dictionary fr
-0000a580: 6f6d 2073 7572 6661 6365 2076 6572 7465  om surface verte
-0000a590: 7820 636f 6f72 6469 6e61 7465 732e 2022  x coordinates. "
-0000a5a0: 2222 0d0a 2020 2020 2020 2020 5f73 6574  ""..        _set
-0000a5b0: 5f67 656f 6d42 6f75 6e64 7328 7365 6c66  _geomBounds(self
-0000a5c0: 2e76 6572 7465 7843 6f6f 722c 7365 6c66  .vertexCoor,self
-0000a5d0: 2e5f 626f 756e 6473 290d 0a20 2020 2020  ._bounds)..     
-0000a5e0: 2020 2072 6574 7572 6e20 2020 200d 0a0d     return    ...
-0000a5f0: 0a20 2020 2064 6566 205f 7669 6577 706f  .    def _viewpo
-0000a600: 7274 436f 6f72 2873 656c 662c 7879 7a43  rtCoor(self,xyzC
-0000a610: 6f6f 722c 7669 6577 706f 7274 3d4e 6f6e  oor,viewport=Non
-0000a620: 6529 203a 0d0a 2020 2020 2020 2020 2222  e) :..        ""
-0000a630: 2220 5556 2063 6f6f 7264 696e 6174 6573  " UV coordinates
-0000a640: 2066 6f72 2069 6d61 6765 2074 6578 7475   for image textu
-0000a650: 7265 206d 6170 7069 6e67 2022 2222 0d0a  re mapping """..
-0000a660: 2020 2020 2020 2020 2320 6265 7474 6572          # better
-0000a670: 2077 6179 2074 6f20 646f 2074 6869 733f   way to do this?
-0000a680: 204d 524f 490d 0a20 2020 2020 2020 2078   MROI..        x
-0000a690: 797a 203d 206e 702e 7472 616e 7370 6f73  yz = np.transpos
-0000a6a0: 6528 7879 7a43 6f6f 7229 0d0a 2020 2020  e(xyzCoor)..    
-0000a6b0: 2020 2020 6162 203d 2073 656c 662e 5f6d      ab = self._m
-0000a6c0: 6170 3344 746f 3244 7371 7561 7265 2820  ap3Dto2Dsquare( 
-0000a6d0: 7879 7a20 290d 0a20 2020 2020 2020 2061  xyz )..        a
-0000a6e0: 2c62 203d 2061 620d 0a20 2020 2020 2020  ,b = ab..       
-0000a6f0: 2069 6620 7669 6577 706f 7274 2069 7320   if viewport is 
-0000a700: 4e6f 6e65 203a 2072 6574 7572 6e20 612c  None : return a,
-0000a710: 622c 6e70 2e66 756c 6c28 6c65 6e28 6129  b,np.full(len(a)
-0000a720: 2c54 7275 6529 0d0a 2020 2020 2020 2020  ,True)..        
-0000a730: 4173 2c42 732c 4165 2c42 6520 3d20 7669  As,Bs,Ae,Be = vi
-0000a740: 6577 706f 7274 0d0a 2020 2020 2020 2020  ewport..        
-0000a750: 4172 6566 203d 2031 2e30 2d41 730d 0a20  Aref = 1.0-As.. 
-0000a760: 2020 2020 2020 2042 7265 6620 3d20 312e         Bref = 1.
-0000a770: 302d 4273 0d0a 2020 2020 2020 2020 4164  0-Bs..        Ad
-0000a780: 656c 7461 203d 206e 702e 6d6f 6428 4165  elta = np.mod(Ae
-0000a790: 2b41 7265 662c 312e 3029 0d0a 2020 2020  +Aref,1.0)..    
-0000a7a0: 2020 2020 4264 656c 7461 203d 206e 702e      Bdelta = np.
-0000a7b0: 6d6f 6428 4265 2b42 7265 662c 312e 3029  mod(Be+Bref,1.0)
-0000a7c0: 0d0a 2020 2020 2020 2020 6966 2041 6465  ..        if Ade
-0000a7d0: 6c74 6120 3c3d 302e 3020 3a20 4164 656c  lta <=0.0 : Adel
-0000a7e0: 7461 203d 2031 2e30 0d0a 2020 2020 2020  ta = 1.0..      
-0000a7f0: 2020 6966 2042 6465 6c74 6120 3c3d 302e    if Bdelta <=0.
-0000a800: 3020 3a20 4264 656c 7461 203d 2031 2e30  0 : Bdelta = 1.0
-0000a810: 0d0a 2020 2020 2020 2020 4170 203d 206e  ..        Ap = n
-0000a820: 702e 6d6f 6428 612b 4172 6566 2c31 2e30  p.mod(a+Aref,1.0
-0000a830: 290d 0a20 2020 2020 2020 2042 7020 3d20  )..        Bp = 
-0000a840: 6e70 2e6d 6f64 2862 2b42 7265 662c 312e  np.mod(b+Bref,1.
-0000a850: 3029 0d0a 2020 2020 2020 2020 4176 203d  0)..        Av =
-0000a860: 206e 702e 6469 7669 6465 2841 702c 4164   np.divide(Ap,Ad
-0000a870: 656c 7461 290d 0a20 2020 2020 2020 2042  elta)..        B
-0000a880: 7620 3d20 6e70 2e64 6976 6964 6528 4270  v = np.divide(Bp
-0000a890: 2c42 6465 6c74 6129 0d0a 2020 2020 2020  ,Bdelta)..      
-0000a8a0: 2020 696e 5669 6577 706f 7274 203d 2041    inViewport = A
-0000a8b0: 763c 3d31 0d0a 2020 2020 2020 2020 696e  v<=1..        in
-0000a8c0: 5669 6577 706f 7274 203d 206e 702e 7768  Viewport = np.wh
-0000a8d0: 6572 6528 4276 3e31 2c6e 702e 6675 6c6c  ere(Bv>1,np.full
-0000a8e0: 286c 656e 2869 6e56 6965 7770 6f72 7429  (len(inViewport)
-0000a8f0: 2c46 616c 7365 292c 696e 5669 6577 706f  ,False),inViewpo
-0000a900: 7274 290d 0a20 2020 2020 2020 2041 7620  rt)..        Av 
-0000a910: 3d20 6e70 2e63 6c69 7028 4176 2c30 2e30  = np.clip(Av,0.0
-0000a920: 2c31 2e30 290d 0a20 2020 2020 2020 2042  ,1.0)..        B
-0000a930: 7620 3d20 6e70 2e63 6c69 7028 4276 2c30  v = np.clip(Bv,0
-0000a940: 2e30 2c31 2e30 290d 0a20 2020 2020 2020  .0,1.0)..       
-0000a950: 2072 6574 7572 6e20 4176 2c42 762c 696e   return Av,Bv,in
-0000a960: 5669 6577 706f 7274 0d0a 0d0a 2020 2020  Viewport....    
-0000a970: 6465 6620 5f74 7269 616e 6775 6c61 7465  def _triangulate
-0000a980: 5f66 6163 6549 6e64 6963 6573 2873 656c  _faceIndices(sel
-0000a990: 662c 6676 496e 6478 2920 3a0d 0a20 2020  f,fvIndx) :..   
-0000a9a0: 2020 2020 2066 7649 6e64 6963 6573 2c20       fvIndices, 
-0000a9b0: 6643 6f6c 6f72 7320 3d20 7365 6c66 2e5f  fColors = self._
-0000a9c0: 7472 6961 6e67 756c 6174 655f 6661 6365  triangulate_face
-0000a9d0: 496e 6469 6365 735f 6661 6365 436f 6c6f  Indices_faceColo
-0000a9e0: 7273 2866 7649 6e64 7829 0d0a 2020 2020  rs(fvIndx)..    
-0000a9f0: 2020 2020 7265 7475 726e 2066 7649 6e64      return fvInd
-0000aa00: 6963 6573 0d0a 0d0a 2020 2020 6465 6620  ices....    def 
-0000aa10: 5f74 7269 616e 6775 6c61 7465 5f66 6163  _triangulate_fac
-0000aa20: 6549 6e64 6963 6573 5f66 6163 6543 6f6c  eIndices_faceCol
-0000aa30: 6f72 7328 7365 6c66 2c66 7649 6e64 782c  ors(self,fvIndx,
-0000aa40: 6661 6365 436f 6c6f 7273 3d4e 6f6e 6529  faceColors=None)
-0000aa50: 203a 0d0a 2020 2020 2020 2020 2222 220d   :..        """.
-0000aa60: 0a20 2020 2020 2020 2053 7562 6469 7669  .        Subdivi
-0000aa70: 6465 2061 6c6c 2066 6163 6573 2069 6e74  de all faces int
-0000aa80: 6f20 7472 6961 6e67 6c65 732e 2020 5477  o triangles.  Tw
-0000aa90: 6f20 7573 6573 2077 6974 6820 6e75 6d62  o uses with numb
-0000aaa0: 6572 2066 6163 6520 6564 6765 7320 6973  er face edges is
-0000aab0: 2033 2c34 2c35 206f 7220 363a 0d0a 2020   3,4,5 or 6:..  
-0000aac0: 2020 2020 2020 2031 2e20 696e 6974 6961         1. initia
-0000aad0: 6c20 7472 6961 6e67 756c 6174 6520 636f  l triangulate co
-0000aae0: 6c6c 6563 7469 6f6e 206f 6620 6661 6365  llection of face
-0000aaf0: 7320 6861 7669 6e67 2061 2064 6966 6665  s having a diffe
-0000ab00: 726e 7420 6e75 6d62 6572 206f 6620 6564  rnt number of ed
-0000ab10: 6765 730d 0a20 2020 2020 2020 2020 2020  ges..           
-0000ab20: 2063 616c 6c65 6420 6672 6f6d 205f 5f69   called from __i
-0000ab30: 6e69 745f 5f20 7769 7468 2066 6163 6549  nit__ with faceI
-0000ab40: 6e64 6963 6573 2070 6173 7365 6420 6173  ndices passed as
-0000ab50: 2061 206c 6973 742e 200d 0a20 2020 2020   a list. ..     
-0000ab60: 2020 2020 322e 2074 7269 616e 6775 6c61      2. triangula
-0000ab70: 7465 2063 6f6c 6c65 6374 696f 6e20 6f66  te collection of
-0000ab80: 2066 6163 6573 2077 6974 6820 6964 656e   faces with iden
-0000ab90: 7469 6361 6c20 6e75 6d62 6572 206f 6620  tical number of 
-0000aba0: 6564 6765 730d 0a20 2020 2020 2020 2020  edges..         
-0000abb0: 2020 2063 616c 6c65 6420 6672 6f6d 2074     called from t
-0000abc0: 7269 616e 6775 6c61 7465 2077 6865 7265  riangulate where
-0000abd0: 2066 6163 6549 6e64 6963 6573 7320 6973   faceIndicess is
-0000abe0: 2061 206e 756d 7079 2061 7272 6179 0d0a   a numpy array..
-0000abf0: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
-0000ac00: 2020 2020 2023 202e 2e2e 2e2e 2e2e 2e2e       # .........
-0000ac10: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0000ac20: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0000ac30: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0000ac40: 2e2e 2e2e 0d0a 2020 2020 2020 2020 6465  ......        de
-0000ac50: 6620 6469 7669 6465 4661 6365 3428 6661  f divideFace4(fa
-0000ac60: 6365 2920 3a0d 0a20 2020 2020 2020 2020  ce) :..         
-0000ac70: 2020 2064 6973 745f 6120 3d20 6e70 2e6c     dist_a = np.l
-0000ac80: 696e 616c 672e 6e6f 726d 2820 7365 6c66  inalg.norm( self
-0000ac90: 2e76 6572 7465 7843 6f6f 725b 2066 6163  .vertexCoor[ fac
-0000aca0: 655b 305d 5d20 2d20 7365 6c66 2e76 6572  e[0]] - self.ver
-0000acb0: 7465 7843 6f6f 725b 2066 6163 655b 325d  texCoor[ face[2]
-0000acc0: 5d20 290d 0a20 2020 2020 2020 2020 2020  ] )..           
-0000acd0: 2064 6973 745f 6220 3d20 6e70 2e6c 696e   dist_b = np.lin
-0000ace0: 616c 672e 6e6f 726d 2820 7365 6c66 2e76  alg.norm( self.v
-0000acf0: 6572 7465 7843 6f6f 725b 2066 6163 655b  ertexCoor[ face[
-0000ad00: 315d 5d20 2d20 7365 6c66 2e76 6572 7465  1]] - self.verte
-0000ad10: 7843 6f6f 725b 2066 6163 655b 335d 5d20  xCoor[ face[3]] 
-0000ad20: 290d 0a20 2020 2020 2020 2020 2020 2069  )..            i
-0000ad30: 6620 6469 7374 5f61 203c 2064 6973 745f  f dist_a < dist_
-0000ad40: 6220 3a0d 0a20 2020 2020 2020 2020 2020  b :..           
-0000ad50: 2020 2020 2066 6163 6531 203d 205b 2066       face1 = [ f
-0000ad60: 6163 655b 305d 2c20 6661 6365 5b31 5d2c  ace[0], face[1],
-0000ad70: 2066 6163 655b 325d 205d 0d0a 2020 2020   face[2] ]..    
-0000ad80: 2020 2020 2020 2020 2020 2020 6661 6365              face
-0000ad90: 3220 3d20 5b20 6661 6365 5b32 5d2c 2066  2 = [ face[2], f
-0000ada0: 6163 655b 335d 2c20 6661 6365 5b30 5d20  ace[3], face[0] 
-0000adb0: 5d0d 0a20 2020 2020 2020 2020 2020 2065  ]..            e
-0000adc0: 6c73 6520 3a0d 0a20 2020 2020 2020 2020  lse :..         
-0000add0: 2020 2020 2020 2066 6163 6531 203d 205b         face1 = [
-0000ade0: 2066 6163 655b 315d 2c20 6661 6365 5b32   face[1], face[2
-0000adf0: 5d2c 2066 6163 655b 335d 205d 0d0a 2020  ], face[3] ]..  
-0000ae00: 2020 2020 2020 2020 2020 2020 2020 6661                fa
-0000ae10: 6365 3220 3d20 5b20 6661 6365 5b33 5d2c  ce2 = [ face[3],
-0000ae20: 2066 6163 655b 305d 2c20 6661 6365 5b31   face[0], face[1
-0000ae30: 5d20 5d20 2020 2020 2020 2020 2020 2020  ] ]             
-0000ae40: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
-0000ae50: 7265 7475 726e 2066 6163 6531 2c20 6661  return face1, fa
-0000ae60: 6365 320d 0a20 2020 2020 2020 2064 6566  ce2..        def
-0000ae70: 2064 6976 6964 6546 6163 6535 2866 6163   divideFace5(fac
-0000ae80: 6529 203a 0d0a 2020 2020 2020 2020 2020  e) :..          
-0000ae90: 2020 6469 6167 203d 206c 616d 6264 6120    diag = lambda 
-0000aea0: 6920 3a20 7365 6c66 2e76 6572 7465 7843  i : self.vertexC
-0000aeb0: 6f6f 725b 2066 6163 655b 695d 5d20 2d20  oor[ face[i]] - 
-0000aec0: 7365 6c66 2e76 6572 7465 7843 6f6f 725b  self.vertexCoor[
-0000aed0: 2066 6163 655b 2869 2b32 2925 355d 205d   face[(i+2)%5] ]
-0000aee0: 0d0a 2020 2020 2020 2020 2020 2020 6663  ..            fc
-0000aef0: 3320 3d20 6c61 6d62 6461 2069 203a 205b  3 = lambda i : [
-0000af00: 2066 6163 655b 695d 2c20 6661 6365 5b28   face[i], face[(
-0000af10: 692b 3129 2535 5d2c 2066 6163 655b 2869  i+1)%5], face[(i
-0000af20: 2b32 2925 355d 205d 0d0a 2020 2020 2020  +2)%5] ]..      
-0000af30: 2020 2020 2020 6663 3420 3d20 6c61 6d62        fc4 = lamb
-0000af40: 6461 2069 203a 205b 2066 6163 655b 2869  da i : [ face[(i
-0000af50: 2b32 2925 355d 2c20 6661 6365 5b28 692b  +2)%5], face[(i+
-0000af60: 3329 2535 5d2c 2066 6163 655b 2869 2b34  3)%5], face[(i+4
-0000af70: 2925 355d 2c20 6661 6365 5b28 692b 3529  )%5], face[(i+5)
-0000af80: 2535 5d20 5d0d 0a20 2020 2020 2020 2020  %5] ]..         
-0000af90: 2020 2064 6973 7420 3d20 5b4e 6f6e 655d     dist = [None]
-0000afa0: 2a35 0d0a 2020 2020 2020 2020 2020 2020  *5..            
-0000afb0: 666f 7220 6920 696e 2072 616e 6765 2835  for i in range(5
-0000afc0: 2920 3a20 6469 7374 5b69 5d20 3d20 6e70  ) : dist[i] = np
-0000afd0: 2e6c 696e 616c 672e 6e6f 726d 2820 6469  .linalg.norm( di
-0000afe0: 6167 2869 2920 290d 0a20 2020 2020 2020  ag(i) )..       
-0000aff0: 2020 2020 206d 696e 4469 6167 203d 2030       minDiag = 0
-0000b000: 0d0a 2020 2020 2020 2020 2020 2020 666f  ..            fo
-0000b010: 7220 6920 696e 2072 616e 6765 2831 2c35  r i in range(1,5
-0000b020: 2920 3a0d 0a20 2020 2020 2020 2020 2020  ) :..           
-0000b030: 2020 2020 2069 6620 6469 7374 5b69 5d20       if dist[i] 
-0000b040: 3c20 6469 7374 5b6d 696e 4469 6167 5d20  < dist[minDiag] 
-0000b050: 3a20 6d69 6e44 6961 6720 3d20 690d 0a20  : minDiag = i.. 
-0000b060: 2020 2020 2020 2020 2020 2066 6163 6531             face1
-0000b070: 203d 2066 6333 286d 696e 4469 6167 290d   = fc3(minDiag).
-0000b080: 0a20 2020 2020 2020 2020 2020 206f 7468  .            oth
-0000b090: 6572 4661 6365 203d 2066 6334 286d 696e  erFace = fc4(min
-0000b0a0: 4469 6167 290d 0a20 2020 2020 2020 2020  Diag)..         
-0000b0b0: 2020 2066 6163 6532 2c20 6661 6365 3320     face2, face3 
-0000b0c0: 3d20 6469 7669 6465 4661 6365 3428 6f74  = divideFace4(ot
-0000b0d0: 6865 7246 6163 6529 0d0a 2020 2020 2020  herFace)..      
-0000b0e0: 2020 2020 2020 7265 7475 726e 2066 6163        return fac
-0000b0f0: 6531 2c20 6661 6365 322c 2066 6163 6533  e1, face2, face3
-0000b100: 0d0a 2020 2020 2020 2020 6465 6620 6469  ..        def di
-0000b110: 7669 6465 4661 6365 7336 2866 6163 6529  videFaces6(face)
-0000b120: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
-0000b130: 2320 2e2e 206e 6f74 2074 6865 2062 6573  # .. not the bes
-0000b140: 742c 2062 7574 2065 6173 6965 7374 2028  t, but easiest (
-0000b150: 636f 756c 6420 6361 6c63 206d 6964 706f  could calc midpo
-0000b160: 696e 7429 2e20 4d52 4f49 0d0a 2020 2020  int). MROI..    
-0000b170: 2020 2020 2020 2020 6469 7374 203d 205b          dist = [
-0000b180: 4e6f 6e65 5d2a 330d 0a20 2020 2020 2020  None]*3..       
-0000b190: 2020 2020 2064 6973 745b 305d 203d 206e       dist[0] = n
-0000b1a0: 702e 6c69 6e61 6c67 2e6e 6f72 6d28 2073  p.linalg.norm( s
-0000b1b0: 656c 662e 7665 7274 6578 436f 6f72 5b20  elf.vertexCoor[ 
-0000b1c0: 6661 6365 5b30 5d5d 202d 2073 656c 662e  face[0]] - self.
-0000b1d0: 7665 7274 6578 436f 6f72 5b20 6661 6365  vertexCoor[ face
-0000b1e0: 5b33 5d5d 2029 0d0a 2020 2020 2020 2020  [3]] )..        
-0000b1f0: 2020 2020 6469 7374 5b31 5d20 3d20 6e70      dist[1] = np
-0000b200: 2e6c 696e 616c 672e 6e6f 726d 2820 7365  .linalg.norm( se
-0000b210: 6c66 2e76 6572 7465 7843 6f6f 725b 2066  lf.vertexCoor[ f
-0000b220: 6163 655b 315d 5d20 2d20 7365 6c66 2e76  ace[1]] - self.v
-0000b230: 6572 7465 7843 6f6f 725b 2066 6163 655b  ertexCoor[ face[
-0000b240: 345d 5d20 290d 0a20 2020 2020 2020 2020  4]] )..         
-0000b250: 2020 2064 6973 745b 325d 203d 206e 702e     dist[2] = np.
-0000b260: 6c69 6e61 6c67 2e6e 6f72 6d28 2073 656c  linalg.norm( sel
-0000b270: 662e 7665 7274 6578 436f 6f72 5b20 6661  f.vertexCoor[ fa
-0000b280: 6365 5b32 5d5d 202d 2073 656c 662e 7665  ce[2]] - self.ve
-0000b290: 7274 6578 436f 6f72 5b20 6661 6365 5b35  rtexCoor[ face[5
-0000b2a0: 5d5d 2029 0d0a 2020 2020 2020 2020 2020  ]] )..          
-0000b2b0: 2020 694d 696e 203d 2030 0d0a 2020 2020    iMin = 0..    
-0000b2c0: 2020 2020 2020 2020 6966 2064 6973 745b          if dist[
-0000b2d0: 315d 203c 2064 6973 745b 305d 2020 2020  1] < dist[0]    
-0000b2e0: 3a20 694d 696e 203d 2031 0d0a 2020 2020  : iMin = 1..    
-0000b2f0: 2020 2020 2020 2020 6966 2064 6973 745b          if dist[
-0000b300: 325d 203c 2064 6973 745b 694d 696e 5d20  2] < dist[iMin] 
-0000b310: 3a20 694d 696e 203d 2032 0d0a 2020 2020  : iMin = 2..    
-0000b320: 2020 2020 2020 2020 6661 6365 4120 3d20          faceA = 
-0000b330: 5b20 6661 6365 5b69 4d69 6e5d 2c20 2020  [ face[iMin],   
-0000b340: 6661 6365 5b20 694d 696e 2b31 205d 2c20  face[ iMin+1 ], 
-0000b350: 2020 6661 6365 5b20 694d 696e 2b32 205d    face[ iMin+2 ]
-0000b360: 2c20 2020 6661 6365 5b20 694d 696e 2b33  ,   face[ iMin+3
-0000b370: 205d 205d 0d0a 2020 2020 2020 2020 2020   ] ]..          
-0000b380: 2020 6661 6365 4220 3d20 5b20 6661 6365    faceB = [ face
-0000b390: 5b69 4d69 6e2b 335d 2c20 6661 6365 5b28  [iMin+3], face[(
-0000b3a0: 694d 696e 2b34 2925 365d 2c20 6661 6365  iMin+4)%6], face
-0000b3b0: 5b28 694d 696e 2b35 2925 365d 2c20 6661  [(iMin+5)%6], fa
-0000b3c0: 6365 5b28 694d 696e 2b36 2925 365d 205d  ce[(iMin+6)%6] ]
-0000b3d0: 0d0a 2020 2020 2020 2020 2020 2020 6661  ..            fa
-0000b3e0: 6365 312c 2066 6163 6532 203d 2064 6976  ce1, face2 = div
-0000b3f0: 6964 6546 6163 6534 2866 6163 6541 290d  ideFace4(faceA).
-0000b400: 0a20 2020 2020 2020 2020 2020 2066 6163  .            fac
-0000b410: 6533 2c20 6661 6365 3420 3d20 6469 7669  e3, face4 = divi
-0000b420: 6465 4661 6365 3428 6661 6365 4229 0d0a  deFace4(faceB)..
-0000b430: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0000b440: 726e 2066 6163 6531 2c20 6661 6365 322c  rn face1, face2,
-0000b450: 2066 6163 6533 2c20 6661 6365 340d 0a20   face3, face4.. 
-0000b460: 2020 2020 2020 2023 202e 2e2e 2e2e 2e2e         # .......
-0000b470: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0000b480: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0000b490: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0000b4a0: 2e2e 2e2e 2e2e 0d0a 2020 2020 2020 2020  ........        
-0000b4b0: 2320 4675 7444 6576 3a20 6561 7379 2074  # FutDev: easy t
-0000b4c0: 6f20 756e 6465 7273 7461 6e64 2062 7574  o understand but
-0000b4d0: 206e 6565 6420 746f 2063 6c65 616e 7570   need to cleanup
-0000b4e0: 2c20 4d52 4f49 0d0a 2020 2020 2020 2020  , MROI..        
-0000b4f0: 7375 6246 6163 6549 6e64 6963 6573 203d  subFaceIndices =
-0000b500: 205b 5d0d 0a20 2020 2020 2020 2066 436f   []..        fCo
-0000b510: 6c6f 7220 3d20 5b5d 0d0a 2020 2020 2020  lor = []..      
-0000b520: 2020 7365 7443 6f6c 6f72 7320 3d20 4661    setColors = Fa
-0000b530: 6c73 650d 0a20 2020 2020 2020 2069 6620  lse..        if 
-0000b540: 6661 6365 436f 6c6f 7273 2069 7320 6e6f  faceColors is no
-0000b550: 7420 4e6f 6e65 3a0d 0a20 2020 2020 2020  t None:..       
-0000b560: 2020 2020 2073 6574 436f 6c6f 7273 203d       setColors =
-0000b570: 2054 7275 650d 0a20 2020 2020 2020 2020   True..         
-0000b580: 2020 2069 6620 6c65 6e28 6676 496e 6478     if len(fvIndx
-0000b590: 2920 213d 206c 656e 2866 6163 6543 6f6c  ) != len(faceCol
-0000b5a0: 6f72 7329 203a 0d0a 2020 2020 2020 2020  ors) :..        
-0000b5b0: 2020 2020 2020 2020 2320 6966 2066 6163          # if fac
-0000b5c0: 6543 6f6c 6f72 732c 2074 6865 6e20 7468  eColors, then th
-0000b5d0: 6973 2073 686f 756c 6420 6e6f 7420 6861  is should not ha
-0000b5e0: 7070 656e 2c20 6275 7420 7265 706f 7274  ppen, but report
-0000b5f0: 2069 6620 736f 2e2e 2e2e 0d0a 2020 2020   if so......    
-0000b600: 2020 2020 2020 2020 2020 2020 7761 726e              warn
-0000b610: 696e 6773 2e77 6172 6e28 2749 6e74 6572  ings.warn('Inter
-0000b620: 6e61 6c20 4552 524f 523a 2074 6663 3030  nal ERROR: tfc00
-0000b630: 3127 290d 0a20 2020 2020 2020 2020 2020  1')..           
-0000b640: 2020 2020 2072 6574 7572 6e20 4e6f 6e65       return None
-0000b650: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000b660: 2020 0d0a 2020 2020 2020 2020 666f 7220    ..        for 
-0000b670: 692c 2066 6163 6520 696e 2065 6e75 6d65  i, face in enume
-0000b680: 7261 7465 2866 7649 6e64 7829 203a 0d0a  rate(fvIndx) :..
-0000b690: 2020 2020 2020 2020 2020 2020 6e75 6d56              numV
-0000b6a0: 6572 7473 203d 206c 656e 2866 6163 6529  erts = len(face)
-0000b6b0: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-0000b6c0: 206e 756d 5665 7274 7320 3d3d 2033 203a   numVerts == 3 :
-0000b6d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000b6e0: 2020 7375 6246 6163 6549 6e64 6963 6573    subFaceIndices
-0000b6f0: 2e61 7070 656e 6428 6661 6365 290d 0a20  .append(face).. 
-0000b700: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0000b710: 6620 7365 7443 6f6c 6f72 7320 3a20 6643  f setColors : fC
-0000b720: 6f6c 6f72 202b 3d20 5b66 6163 6543 6f6c  olor += [faceCol
-0000b730: 6f72 735b 695d 5d2a 310d 0a20 2020 2020  ors[i]]*1..     
-0000b740: 2020 2020 2020 2065 6c69 6620 6e75 6d56         elif numV
-0000b750: 6572 7473 203d 3d20 3420 3a0d 0a20 2020  erts == 4 :..   
-0000b760: 2020 2020 2020 2020 2020 2020 2066 312c               f1,
-0000b770: 2066 3220 3d20 6469 7669 6465 4661 6365   f2 = divideFace
-0000b780: 3428 6661 6365 290d 0a20 2020 2020 2020  4(face)..       
-0000b790: 2020 2020 2020 2020 2073 7562 4661 6365           subFace
-0000b7a0: 496e 6469 6365 732e 6170 7065 6e64 2866  Indices.append(f
-0000b7b0: 3129 0d0a 2020 2020 2020 2020 2020 2020  1)..            
-0000b7c0: 2020 2020 7375 6246 6163 6549 6e64 6963      subFaceIndic
-0000b7d0: 6573 2e61 7070 656e 6428 6632 290d 0a20  es.append(f2).. 
-0000b7e0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0000b7f0: 6620 7365 7443 6f6c 6f72 7320 3a20 6643  f setColors : fC
-0000b800: 6f6c 6f72 202b 3d20 5b66 6163 6543 6f6c  olor += [faceCol
-0000b810: 6f72 735b 695d 5d2a 320d 0a20 2020 2020  ors[i]]*2..     
-0000b820: 2020 2020 2020 2065 6c69 6620 6e75 6d56         elif numV
-0000b830: 6572 7473 203d 3d20 3520 3a0d 0a20 2020  erts == 5 :..   
-0000b840: 2020 2020 2020 2020 2020 2020 2066 312c               f1,
-0000b850: 2066 322c 2066 3320 3d20 6469 7669 6465   f2, f3 = divide
-0000b860: 4661 6365 3528 6661 6365 290d 0a20 2020  Face5(face)..   
-0000b870: 2020 2020 2020 2020 2020 2020 2073 7562               sub
-0000b880: 4661 6365 496e 6469 6365 732e 6170 7065  FaceIndices.appe
-0000b890: 6e64 2866 3129 0d0a 2020 2020 2020 2020  nd(f1)..        
-0000b8a0: 2020 2020 2020 2020 7375 6246 6163 6549          subFaceI
-0000b8b0: 6e64 6963 6573 2e61 7070 656e 6428 6632  ndices.append(f2
-0000b8c0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0000b8d0: 2020 2073 7562 4661 6365 496e 6469 6365     subFaceIndice
-0000b8e0: 732e 6170 7065 6e64 2866 3329 0d0a 2020  s.append(f3)..  
-0000b8f0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0000b900: 2073 6574 436f 6c6f 7273 203a 2066 436f   setColors : fCo
-0000b910: 6c6f 7220 2b3d 205b 6661 6365 436f 6c6f  lor += [faceColo
-0000b920: 7273 5b69 5d5d 2a33 0d0a 2020 2020 2020  rs[i]]*3..      
-0000b930: 2020 2020 2020 656c 6966 206e 756d 5665        elif numVe
-0000b940: 7274 7320 3d3d 2036 203a 0d0a 2020 2020  rts == 6 :..    
-0000b950: 2020 2020 2020 2020 2020 2020 6631 2c20              f1, 
-0000b960: 6632 2c20 6633 2c20 6634 203d 2064 6976  f2, f3, f4 = div
-0000b970: 6964 6546 6163 6573 3628 6661 6365 290d  ideFaces6(face).
-0000b980: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000b990: 2073 7562 4661 6365 496e 6469 6365 732e   subFaceIndices.
-0000b9a0: 6170 7065 6e64 2866 3129 0d0a 2020 2020  append(f1)..    
-0000b9b0: 2020 2020 2020 2020 2020 2020 7375 6246              subF
-0000b9c0: 6163 6549 6e64 6963 6573 2e61 7070 656e  aceIndices.appen
-0000b9d0: 6428 6632 290d 0a20 2020 2020 2020 2020  d(f2)..         
-0000b9e0: 2020 2020 2020 2073 7562 4661 6365 496e         subFaceIn
-0000b9f0: 6469 6365 732e 6170 7065 6e64 2866 3329  dices.append(f3)
-0000ba00: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000ba10: 2020 7375 6246 6163 6549 6e64 6963 6573    subFaceIndices
-0000ba20: 2e61 7070 656e 6428 6634 290d 0a20 2020  .append(f4)..   
-0000ba30: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0000ba40: 7365 7443 6f6c 6f72 7320 3a20 6643 6f6c  setColors : fCol
-0000ba50: 6f72 202b 3d20 5b66 6163 6543 6f6c 6f72  or += [faceColor
-0000ba60: 735b 695d 5d2a 340d 0a20 2020 2020 2020  s[i]]*4..       
-0000ba70: 200d 0a20 2020 2020 2020 2072 6574 7572   ..        retur
-0000ba80: 6e20 6e70 2e61 7272 6179 2873 7562 4661  n np.array(subFa
-0000ba90: 6365 496e 6469 6365 7329 2c20 6643 6f6c  ceIndices), fCol
-0000baa0: 6f72 0d0a 0d0a 2020 2020 6465 6620 5f67  or....    def _g
-0000bab0: 6574 5f65 6467 6573 5f66 726f 6d5f 6661  et_edges_from_fa
-0000bac0: 6365 7328 7365 6c66 2c66 7649 6e64 7829  ces(self,fvIndx)
-0000bad0: 203a 0d0a 2020 2020 2020 2020 2222 220d   :..        """.
-0000bae0: 0a20 2020 2020 2020 2055 7365 6420 696e  .        Used in
-0000baf0: 205f 5f69 6e69 745f 5f20 6966 2065 6467   __init__ if edg
-0000bb00: 6549 6e64 6963 6573 3d4e 6f6e 6520 746f  eIndices=None to
-0000bb10: 2063 7265 6174 6520 6564 6765 496e 6469   create edgeIndi
-0000bb20: 6365 732e 0d0a 2020 2020 2020 2020 2222  ces...        ""
-0000bb30: 220d 0a20 2020 2020 2020 2023 202e 2e2e  "..        # ...
-0000bb40: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0000bb50: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0000bb60: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0000bb70: 2e2e 2e2e 2e2e 2e2e 2e2e 0d0a 2020 2020  ............    
-0000bb80: 2020 2020 6465 6620 6564 6765 735f 6672      def edges_fr
-0000bb90: 6f6d 5f66 6163 654c 6973 7428 2066 7649  om_faceList( fvI
-0000bba0: 6e64 7820 2920 3a0d 0a20 2020 2020 2020  ndx ) :..       
-0000bbb0: 2020 2020 2023 204e 4f54 453a 2076 6572       # NOTE: ver
-0000bbc0: 7920 706f 6f72 2065 7865 6375 7469 6f6e  y poor execution
-0000bbd0: 2074 696d 652e 2028 7e32 206f 7264 6572   time. (~2 order
-0000bbe0: 732d 6f66 2d6d 6167 6e69 7475 6465 2073  s-of-magnitude s
-0000bbf0: 6c6f 7765 7229 0d0a 2020 2020 2020 2020  lower)..        
-0000bc00: 2020 2020 2320 6661 6365 2069 6e64 6578      # face index
-0000bc10: 206c 6973 7420 6f66 206c 6973 7473 2063   list of lists c
-0000bc20: 616e 2774 2062 6520 7573 6564 2061 7320  an't be used as 
-0000bc30: 6120 4e75 6d70 7920 6172 7261 790d 0a20  a Numpy array.. 
-0000bc40: 2020 2020 2020 2020 2020 2023 2073 696e             # sin
-0000bc50: 6365 2065 6467 6520 6c69 7374 206f 6620  ce edge list of 
-0000bc60: 6d75 6c74 692d 7479 7065 2066 6163 6573  multi-type faces
-0000bc70: 2e0d 0a20 2020 2020 2020 2020 2020 2077  ...            w
-0000bc80: 6172 6e69 6e67 732e 7761 726e 2827 6d75  arnings.warn('mu
-0000bc90: 6c74 692d 7479 7065 2070 6f6c 7968 6564  lti-type polyhed
-0000bca0: 726f 6e20 6661 6365 733a 2075 7365 206f  ron faces: use o
-0000bcb0: 6620 6e6f 6e2d 6f70 7469 6d69 7a65 6420  f non-optimized 
-0000bcc0: 6564 6765 2063 616c 632e 2729 0d0a 2020  edge calc.')..  
-0000bcd0: 2020 2020 2020 2020 2020 6b65 794c 6973            keyLis
-0000bce0: 742c 2065 6467 654c 6973 7420 3d20 5b5d  t, edgeList = []
-0000bcf0: 2c5b 5d0d 0a20 2020 2020 2020 2020 2020  ,[]..           
-0000bd00: 2073 7472 6b65 7920 3d20 6c61 6d62 6461   strkey = lambda
-0000bd10: 2061 2c62 203a 2073 7472 286d 6178 2861   a,b : str(max(a
-0000bd20: 2c62 2929 202b 2027 5f27 202b 2073 7472  ,b)) + '_' + str
-0000bd30: 286d 696e 2861 2c62 2929 0d0a 2020 2020  (min(a,b))..    
-0000bd40: 2020 2020 2020 2020 666f 7220 6661 6365          for face
-0000bd50: 2069 6e20 6676 496e 6478 203a 0d0a 2020   in fvIndx :..  
-0000bd60: 2020 2020 2020 2020 2020 2020 2020 6e75                nu
-0000bd70: 6d45 6467 6573 203d 206c 656e 2866 6163  mEdges = len(fac
-0000bd80: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
-0000bd90: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
-0000bda0: 6765 286e 756d 4564 6765 7329 203a 0d0a  ge(numEdges) :..
-0000bdb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bdc0: 2020 2020 6120 3d20 6661 6365 5b69 5d0d      a = face[i].
-0000bdd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000bde0: 2020 2020 2062 203d 2066 6163 655b 2028       b = face[ (
-0000bdf0: 692b 3129 256e 756d 4564 6765 735d 0d0a  i+1)%numEdges]..
-0000be00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000be10: 2020 2020 6b65 7920 3d20 7374 726b 6579      key = strkey
-0000be20: 2861 2c62 290d 0a20 2020 2020 2020 2020  (a,b)..         
-0000be30: 2020 2020 2020 2020 2020 2069 6620 6b65             if ke
-0000be40: 7920 6e6f 7420 696e 206b 6579 4c69 7374  y not in keyList
-0000be50: 203a 200d 0a20 2020 2020 2020 2020 2020   : ..           
-0000be60: 2020 2020 2020 2020 2020 2020 206b 6579               key
-0000be70: 4c69 7374 2e61 7070 656e 6428 6b65 7929  List.append(key)
-0000be80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000be90: 2020 2020 2020 2020 2020 6564 6765 4c69            edgeLi
-0000bea0: 7374 2e61 7070 656e 6428 5b61 2c62 5d29  st.append([a,b])
-0000beb0: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
-0000bec0: 7475 726e 206e 702e 6172 7261 7928 6564  turn np.array(ed
-0000bed0: 6765 4c69 7374 290d 0a20 2020 2020 2020  geList)..       
-0000bee0: 2023 202e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e   # .............
-0000bef0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0000bf00: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0000bf10: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0000bf20: 0d0a 2020 2020 2020 2020 2320 666f 6c6c  ..        # foll
-0000bf30: 6f77 696e 6720 6c69 6e65 206f 6e6c 7920  owing line only 
-0000bf40: 6e65 6564 6564 2077 6865 6e20 6361 6c6c  needed when call
-0000bf50: 6564 2066 6f72 206d 6978 6564 2070 6f6c  ed for mixed pol
-0000bf60: 7967 6f6e 2066 6163 6573 0d0a 2020 2020  ygon faces..    
-0000bf70: 2020 2020 6966 2066 7649 6e64 782e 6e64      if fvIndx.nd
-0000bf80: 696d 203d 3d20 3120 3a20 7265 7475 726e  im == 1 : return
-0000bf90: 2065 6467 6573 5f66 726f 6d5f 6661 6365   edges_from_face
-0000bfa0: 4c69 7374 2866 7649 6e64 7829 0d0a 0d0a  List(fvIndx)....
-0000bfb0: 2020 2020 2020 2020 6e75 6d45 6467 6573          numEdges
-0000bfc0: 203d 2066 7649 6e64 782e 7368 6170 655b   = fvIndx.shape[
-0000bfd0: 315d 0d0a 2020 2020 2020 2020 696e 6469  1]..        indi
-0000bfe0: 6369 6573 203d 205b 2028 692b 3129 256e  cies = [ (i+1)%n
-0000bff0: 756d 4564 6765 7320 666f 7220 6920 696e  umEdges for i in
-0000c000: 2072 616e 6765 286e 756d 4564 6765 7329   range(numEdges)
-0000c010: 205d 0d0a 2020 2020 2020 2020 6f66 735f   ]..        ofs_
-0000c020: 6676 496e 6478 203d 2066 7649 6e64 785b  fvIndx = fvIndx[
-0000c030: 3a2c 696e 6469 6369 6573 5d0d 0a20 2020  :,indicies]..   
-0000c040: 2020 2020 2073 7465 7041 203d 206e 702e       stepA = np.
-0000c050: 7374 6163 6b28 2028 6676 496e 6478 2c6f  stack( (fvIndx,o
-0000c060: 6673 5f66 7649 6e64 7829 2c20 6178 6973  fs_fvIndx), axis
-0000c070: 3d2d 3120 2029 0d0a 2020 2020 2020 2020  =-1  )..        
-0000c080: 7374 6570 4220 3d20 6e70 2e72 6573 6861  stepB = np.resha
-0000c090: 7065 2820 7374 6570 412c 2028 2d31 2c32  pe( stepA, (-1,2
-0000c0a0: 2029 2029 0d0a 2020 2020 2020 2020 7374   ) )..        st
-0000c0b0: 6570 4320 3d20 6e70 2e73 6f72 7428 7374  epC = np.sort(st
-0000c0c0: 6570 422c 6178 6973 3d31 290d 0a20 2020  epB,axis=1)..   
-0000c0d0: 2020 2020 2075 2c20 696e 6469 6365 7320       u, indices 
-0000c0e0: 3d20 6e70 2e75 6e69 7175 6528 7374 6570  = np.unique(step
-0000c0f0: 432c 2061 7869 733d 302c 2072 6574 7572  C, axis=0, retur
-0000c100: 6e5f 696e 6465 783d 5472 7565 290d 0a20  n_index=True).. 
-0000c110: 2020 2020 2020 2065 6467 654c 6973 7420         edgeList 
-0000c120: 3d20 7374 6570 435b 696e 6469 6365 735d  = stepC[indices]
-0000c130: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-0000c140: 2065 6467 654c 6973 740d 0a0d 0a20 2020   edgeList....   
-0000c150: 2040 7072 6f70 6572 7479 0d0a 2020 2020   @property..    
-0000c160: 6465 6620 766c 696d 2873 656c 6629 203a  def vlim(self) :
-0000c170: 0d0a 2020 2020 2020 2020 2727 2752 616e  ..        '''Ran
-0000c180: 6765 206f 6620 7661 6c75 6573 2061 7373  ge of values ass
-0000c190: 6f63 6961 7465 6420 7769 7468 2063 6f6c  ociated with col
-0000c1a0: 6f72 2727 270d 0a20 2020 2020 2020 2072  or'''..        r
-0000c1b0: 6574 7572 6e20 7365 6c66 2e5f 626f 756e  eturn self._boun
-0000c1c0: 6473 5b27 766c 696d 275d 0d0a 0d0a 2020  ds['vlim']....  
-0000c1d0: 2020 4076 6c69 6d2e 7365 7474 6572 0d0a    @vlim.setter..
-0000c1e0: 2020 2020 6465 6620 766c 696d 2873 656c      def vlim(sel
-0000c1f0: 662c 7661 6c29 203a 0d0a 2020 2020 2020  f,val) :..      
-0000c200: 2020 7365 6c66 2e5f 626f 756e 6473 5b27    self._bounds['
-0000c210: 766c 696d 275d 203d 2076 616c 0d0a 2020  vlim'] = val..  
-0000c220: 2020 2020 2020 7265 7475 726e 0d0a 0d0a        return....
-0000c230: 2020 2020 4070 726f 7065 7274 790d 0a20      @property.. 
-0000c240: 2020 2064 6566 206e 616d 6528 7365 6c66     def name(self
-0000c250: 2920 3a0d 0a20 2020 2020 2020 2027 2727  ) :..        '''
-0000c260: 4465 7363 7269 7074 6976 6520 6964 656e  Descriptive iden
-0000c270: 7469 6669 6572 2066 6f72 2074 6865 2073  tifier for the s
-0000c280: 7572 6661 6365 2067 656f 6d65 7472 792e  urface geometry.
-0000c290: 2727 270d 0a20 2020 2020 2020 2069 6620  '''..        if 
-0000c2a0: 7365 6c66 2e5f 6765 6f6d 4e61 6d65 2069  self._geomName i
-0000c2b0: 7320 4e6f 6e65 203a 2072 6574 7572 6e20  s None : return 
-0000c2c0: 2727 0d0a 2020 2020 2020 2020 7265 7475  ''..        retu
-0000c2d0: 726e 2073 656c 662e 5f67 656f 6d4e 616d  rn self._geomNam
-0000c2e0: 650d 0a0d 0a20 2020 2040 6e61 6d65 2e73  e....    @name.s
-0000c2f0: 6574 7465 720d 0a20 2020 2064 6566 206e  etter..    def n
-0000c300: 616d 6528 7365 6c66 2c20 7661 6c29 203a  ame(self, val) :
-0000c310: 0d0a 2020 2020 2020 2020 7365 6c66 2e5f  ..        self._
-0000c320: 6765 6f6d 4e61 6d65 203d 2076 616c 0d0a  geomName = val..
-0000c330: 2020 2020 2020 2020 7365 6c66 2e73 6574          self.set
-0000c340: 5f6c 6162 656c 2820 2727 2069 6620 7661  _label( '' if va
-0000c350: 6c20 6973 204e 6f6e 6520 656c 7365 2076  l is None else v
-0000c360: 616c 2029 0d0a 2020 2020 2020 2020 7265  al )..        re
-0000c370: 7475 726e 0d0a 0d0a 2020 2020 4070 726f  turn....    @pro
-0000c380: 7065 7274 790d 0a20 2020 2064 6566 2063  perty..    def c
-0000c390: 6e61 6d65 2873 656c 6629 203a 0d0a 2020  name(self) :..  
-0000c3a0: 2020 2020 2020 2727 2744 6573 6372 6970        '''Descrip
-0000c3b0: 7469 7665 2069 6465 6e74 6966 6965 7220  tive identifier 
-0000c3c0: 666f 7220 7661 6c75 6573 2069 6e64 6963  for values indic
-0000c3d0: 6174 6564 2062 7920 636f 6c6f 722e 2727  ated by color.''
-0000c3e0: 270d 0a20 2020 2020 2020 2069 6620 7365  '..        if se
-0000c3f0: 6c66 2e76 616c 7565 734e 616d 6520 6973  lf.valuesName is
-0000c400: 204e 6f6e 6520 3a20 7265 7475 726e 2027   None : return '
-0000c410: 270d 0a20 2020 2020 2020 2072 6574 7572  '..        retur
-0000c420: 6e20 7365 6c66 2e76 616c 7565 734e 616d  n self.valuesNam
-0000c430: 650d 0a0d 0a20 2020 2040 636e 616d 652e  e....    @cname.
-0000c440: 7365 7474 6572 0d0a 2020 2020 6465 6620  setter..    def 
-0000c450: 636e 616d 6528 7365 6c66 2c20 7661 6c29  cname(self, val)
-0000c460: 203a 0d0a 2020 2020 2020 2020 7365 6c66   :..        self
-0000c470: 2e76 616c 7565 734e 616d 6520 3d20 7661  .valuesName = va
-0000c480: 6c0d 0a20 2020 2020 2020 2072 6574 7572  l..        retur
-0000c490: 6e0d 0a0d 0a20 2020 2040 7072 6f70 6572  n....    @proper
-0000c4a0: 7479 0d0a 2020 2020 6465 6620 626f 756e  ty..    def boun
-0000c4b0: 6473 2873 656c 6629 203a 0d0a 2020 2020  ds(self) :..    
-0000c4c0: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
-0000c4d0: 2044 6963 7469 6f6e 6172 7920 6f66 2073   Dictionary of s
-0000c4e0: 7572 6661 6365 2067 656f 6d65 7472 6963  urface geometric
-0000c4f0: 2061 6e64 2076 616c 7565 2072 616e 6765   and value range
-0000c500: 732e 0d0a 2020 2020 2020 2020 0d0a 2020  s...        ..  
-0000c510: 2020 2020 2020 4561 6368 2064 6963 7469        Each dicti
-0000c520: 6f6e 6172 7920 7661 6c75 6520 6973 2061  onary value is a
-0000c530: 2032 2066 6c6f 6174 2061 7272 6179 206f   2 float array o
-0000c540: 6620 6d69 6e69 6d75 6d0d 0a20 2020 2020  f minimum..     
-0000c550: 2020 2061 6e64 206d 6178 696d 756d 2076     and maximum v
-0000c560: 616c 7565 7320 6f66 2074 6865 2073 7572  alues of the sur
-0000c570: 6661 6365 2e20 204b 6579 7320 6172 653a  face.  Keys are:
-0000c580: 0d0a 0d0a 2020 2020 2020 2020 2778 6c69  ....        'xli
-0000c590: 6d27 203a 2078 2d63 6f6f 7264 696e 6174  m' : x-coordinat
-0000c5a0: 650d 0a0d 0a20 2020 2020 2020 2027 796c  e....        'yl
-0000c5b0: 696d 2720 3a20 792d 636f 6f72 6469 6e61  im' : y-coordina
-0000c5c0: 7465 0d0a 0d0a 2020 2020 2020 2020 277a  te....        'z
-0000c5d0: 6c69 6d27 203a 207a 2d63 6f6f 7264 696e  lim' : z-coordin
-0000c5e0: 6174 650d 0a0d 0a20 2020 2020 2020 2027  ate....        '
-0000c5f0: 725f 7879 2720 3a20 7261 6469 616c 2064  r_xy' : radial d
-0000c600: 6973 7461 6e63 6520 6672 6f6d 2074 6865  istance from the
-0000c610: 207a 2061 7869 730d 0a0d 0a20 2020 2020   z axis....     
-0000c620: 2020 2027 726f 7267 2720 3a20 7261 6469     'rorg' : radi
-0000c630: 616c 2064 6973 7461 6e63 6520 6672 6f6d  al distance from
-0000c640: 2074 6865 206f 7269 6769 6e0d 0a0d 0a20   the origin.... 
-0000c650: 2020 2020 2020 2027 766c 696d 2720 3a20         'vlim' : 
-0000c660: 7661 6c75 6520 6675 6e63 7469 6f6e 616c  value functional
-0000c670: 2061 7373 6967 6e6d 656e 7473 2e0d 0a20   assignments... 
-0000c680: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
-0000c690: 2020 2020 2056 616c 7565 7320 6172 6520       Values are 
-0000c6a0: 6173 7369 676e 6564 2066 726f 6d20 7468  assigned from th
-0000c6b0: 6520 6765 6f6d 6574 7279 2061 6e64 2063  e geometry and c
-0000c6c0: 6f6c 6f72 206d 6170 7069 6e67 206d 6574  olor mapping met
-0000c6d0: 686f 6473 2c0d 0a20 2020 2020 2020 2069  hods,..        i
-0000c6e0: 6e63 6c75 6469 6e67 2063 6c69 7070 696e  ncluding clippin
-0000c6f0: 672e 0d0a 0d0a 2020 2020 2020 2020 2222  g.....        ""
-0000c700: 220d 0a0d 0a20 2020 2020 2020 2072 6574  "....        ret
-0000c710: 7572 6e20 7365 6c66 2e5f 626f 756e 6473  urn self._bounds
-0000c720: 0d0a 0d0a 2020 2020 4070 726f 7065 7274  ....    @propert
-0000c730: 790d 0a20 2020 2064 6566 2063 4261 725f  y..    def cBar_
-0000c740: 5363 616c 6172 4d61 7070 6162 6c65 2873  ScalarMappable(s
-0000c750: 656c 6629 203a 0d0a 2020 2020 2020 2020  elf) :..        
-0000c760: 2222 226d 6174 706c 6f74 6c69 622e 636d  """matplotlib.cm
-0000c770: 2e53 6361 6c61 724d 6170 7061 626c 6520  .ScalarMappable 
-0000c780: 6f62 6a65 6374 2066 6f72 2073 7572 6661  object for surfa
-0000c790: 6365 2076 616c 7565 732e 2222 220d 0a20  ce values.""".. 
-0000c7a0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-0000c7b0: 2076 6d69 6e2c 2076 6d61 7820 3d20 7365   vmin, vmax = se
-0000c7c0: 6c66 2e5f 626f 756e 6473 5b27 766c 696d  lf._bounds['vlim
-0000c7d0: 275d 0d0a 2020 2020 2020 2020 6e6f 726d  ']..        norm
-0000c7e0: 203d 2063 6f6c 6f72 732e 4e6f 726d 616c   = colors.Normal
-0000c7f0: 697a 6528 766d 696e 3d76 6d69 6e2c 766d  ize(vmin=vmin,vm
-0000c800: 6178 3d76 6d61 7829 0d0a 2020 2020 2020  ax=vmax)..      
-0000c810: 2020 6f62 6a4d 6170 203d 2073 656c 662e    objMap = self.
-0000c820: 6765 745f 636d 6170 2829 0d0a 2020 2020  get_cmap()..    
-0000c830: 2020 2020 736d 203d 2063 6d2e 5363 616c      sm = cm.Scal
-0000c840: 6172 4d61 7070 6162 6c65 2863 6d61 703d  arMappable(cmap=
-0000c850: 6f62 6a4d 6170 2c20 6e6f 726d 3d6e 6f72  objMap, norm=nor
-0000c860: 6d29 0d0a 2020 2020 2020 2020 736d 2e73  m)..        sm.s
-0000c870: 6574 5f61 7272 6179 285b 5d29 0d0a 2020  et_array([])..  
-0000c880: 2020 2020 2020 7265 7475 726e 2073 6d20        return sm 
-0000c890: 2020 2020 2020 200d 0a20 2020 200d 0a20         ..    .. 
-0000c8a0: 2020 2040 7072 6f70 6572 7479 0d0a 2020     @property..  
-0000c8b0: 2020 6465 6620 6564 6765 7328 7365 6c66    def edges(self
-0000c8c0: 2920 3a0d 0a20 2020 2020 2020 2022 2222  ) :..        """
-0000c8d0: 436f 6c6f 724c 696e 6533 4443 6f6c 6c65  ColorLine3DColle
-0000c8e0: 6374 696f 6e20 6f66 2074 6865 2073 7572  ction of the sur
-0000c8f0: 6661 6365 2065 6467 6573 2066 726f 6d20  face edges from 
-0000c900: 6661 6365 636f 6c6f 7273 2e22 2222 0d0a  facecolors."""..
-0000c910: 2020 2020 2020 2020 2320 2e2e 2e2e 2e2e          # ......
-0000c920: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0000c930: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0000c940: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0000c950: 0d0a 2020 2020 2020 2020 6465 6620 6765  ..        def ge
-0000c960: 745f 6564 6765 5f63 6f6c 6f72 2829 203a  t_edge_color() :
-0000c970: 0d0a 2020 2020 2020 2020 2020 2020 6566  ..            ef
-0000c980: 634c 6973 7420 3d20 636f 7079 2e63 6f70  cList = copy.cop
-0000c990: 7928 7365 6c66 2e65 6649 6e64 6963 6573  y(self.efIndices
-0000c9a0: 4c69 7374 290d 0a20 2020 2020 2020 2020  List)..         
-0000c9b0: 2020 2023 2061 6e20 6564 6765 206d 6179     # an edge may
-0000c9c0: 2068 6176 6520 3120 6f72 2032 2061 646a   have 1 or 2 adj
-0000c9d0: 6163 656e 7420 6661 6365 732e 2e2e 2e0d  acent faces.....
-0000c9e0: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-0000c9f0: 2069 2c63 4c69 7374 2069 6e20 656e 756d   i,cList in enum
-0000ca00: 6572 6174 6528 7365 6c66 2e65 6649 6e64  erate(self.efInd
-0000ca10: 6963 6573 4c69 7374 2920 3a0d 0a20 2020  icesList) :..   
-0000ca20: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0000ca30: 6c65 6e28 634c 6973 7429 3d3d 3120 3a20  len(cList)==1 : 
-0000ca40: 6566 634c 6973 745b 695d 2e61 7070 656e  efcList[i].appen
-0000ca50: 6428 6566 634c 6973 745b 695d 5b30 5d29  d(efcList[i][0])
-0000ca60: 0d0a 2020 2020 2020 2020 2020 2020 6566  ..            ef
-0000ca70: 6341 7272 6179 203d 206e 702e 6172 7261  cArray = np.arra
-0000ca80: 7928 6566 634c 6973 7429 0d0a 2020 2020  y(efcList)..    
-0000ca90: 2020 2020 2020 2020 7365 6c66 2e5f 706f          self._po
-0000caa0: 7374 5072 6f63 5f73 7572 6661 6365 436f  stProc_surfaceCo
-0000cab0: 6c6f 7273 2854 7275 6529 0d0a 2020 2020  lors(True)..    
-0000cac0: 2020 2020 2020 2020 636f 6c6f 7241 203d          colorA =
-0000cad0: 2073 656c 662e 6661 6365 636f 6c6f 7273   self.facecolors
-0000cae0: 5b65 6663 4172 7261 792e 545b 305d 5d0d  [efcArray.T[0]].
-0000caf0: 0a20 2020 2020 2020 2020 2020 2063 6f6c  .            col
-0000cb00: 6f72 4220 3d20 7365 6c66 2e66 6163 6563  orB = self.facec
-0000cb10: 6f6c 6f72 735b 6566 6341 7272 6179 2e54  olors[efcArray.T
-0000cb20: 5b31 5d5d 0d0a 2020 2020 2020 2020 2020  [1]]..          
-0000cb30: 2020 2320 6176 6572 6167 6520 6f66 2061    # average of a
-0000cb40: 646a 6163 656e 7420 6661 6365 2052 4742  djacent face RGB
-0000cb50: 2063 6f6c 6f72 730d 0a20 2020 2020 2020   colors..       
-0000cb60: 2020 2020 2072 6574 7572 6e20 2820 636f       return ( co
-0000cb70: 6c6f 7241 2b63 6f6c 6f72 4229 2f32 0d0a  lorA+colorB)/2..
-0000cb80: 2020 2020 2020 2020 2320 2e2e 2e2e 2e2e          # ......
+00000740: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2b0d  --------------+.
+00000750: 0a0d 0a23 2046 7574 4465 763a 2046 7574  ...# FutDev: Fut
+00000760: 7572 6520 4465 7665 6c6f 706d 656e 7420  ure Development 
+00000770: 6e6f 7465 732e 0d0a 2320 4d52 4f49 3a20  notes...# MROI: 
+00000780: 2020 4d69 6e69 6d75 6d20 5265 7475 726e    Minimum Return
+00000790: 204f 6e20 636f 6469 6e67 2065 6666 6f72   On coding effor
+000007a0: 7420 496e 7665 7374 6d65 6e74 2e0d 0a23  t Investment...#
+000007b0: 2020 2020 2020 2020 2028 7468 6520 6a75           (the ju
+000007c0: 6963 6520 6973 6e27 7420 776f 7274 6820  ice isn't worth 
+000007d0: 7468 6520 7371 7565 657a 6520 666f 7220  the squeeze for 
+000007e0: 6375 7272 656e 7420 7265 6c65 6173 6529  current release)
+000007f0: 0d0a 0d0a 0d0a 636c 6173 7320 5375 7266  ......class Surf
+00000800: 6163 6533 4443 6f6c 6c65 6374 696f 6e28  ace3DCollection(
+00000810: 506f 6c79 3344 436f 6c6c 6563 7469 6f6e  Poly3DCollection
+00000820: 293a 0d0a 2020 2020 2222 220d 0a20 2020  ):..    """..   
+00000830: 2042 6173 6520 636c 6173 7320 666f 7220   Base class for 
+00000840: 3344 2073 7572 6661 6365 732e 0d0a 2020  3D surfaces...  
+00000850: 2020 2222 220d 0a20 2020 205f 6765 6f6d    """..    _geom
+00000860: 5479 7065 203d 205f 434f 4f52 5359 535b  Type = _COORSYS[
+00000870: 2758 595a 275d 0d0a 0d0a 2020 2020 4073  'XYZ']....    @s
+00000880: 7461 7469 636d 6574 686f 640d 0a20 2020  taticmethod..   
+00000890: 2064 6566 2063 6875 6c6c 2870 6f69 6e74   def chull(point
+000008a0: 732c 202a 2a6b 6172 6773 2920 3a0d 0a20  s, **kargs) :.. 
+000008b0: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
+000008c0: 2020 2020 5375 7266 6163 6533 4443 6f6c      Surface3DCol
+000008d0: 6c65 6374 696f 6e20 436f 6e76 6578 2048  lection Convex H
+000008e0: 756c 6c20 666f 7220 6120 7365 7420 6f66  ull for a set of
+000008f0: 2033 4420 706f 696e 7473 2e20 0d0a 2020   3D points. ..  
+00000900: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00000910: 5061 7261 6d65 7465 7273 0d0a 2020 2020  Parameters..    
+00000920: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a      ----------..
+00000930: 2020 2020 2020 2020 706f 696e 7473 203a          points :
+00000940: 204e 2078 2033 2066 6c6f 6174 2061 7272   N x 3 float arr
+00000950: 6179 2d6c 696b 650d 0a0d 0a20 2020 2020  ay-like....     
+00000960: 2020 2052 6574 7572 6e73 0d0a 2020 2020     Returns..    
+00000970: 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020      -------..   
+00000980: 2020 2020 2053 7572 6661 6365 3344 436f       Surface3DCo
+00000990: 6c6c 6563 7469 6f6e 206f 626a 6563 740d  llection object.
+000009a0: 0a0d 0a20 2020 2020 2020 2022 2222 0d0a  ...        """..
+000009b0: 2020 2020 2020 2020 706f 696e 7473 203d          points =
+000009c0: 206e 702e 6172 7261 7928 706f 696e 7473   np.array(points
+000009d0: 290d 0a20 2020 2020 2020 2068 756c 6c20  )..        hull 
+000009e0: 3d20 7370 6174 6961 6c2e 436f 6e76 6578  = spatial.Convex
+000009f0: 4875 6c6c 2870 6f69 6e74 7329 0d0a 2020  Hull(points)..  
+00000a00: 2020 2020 2020 7665 7274 7320 3d20 706f        verts = po
+00000a10: 696e 7473 5b68 756c 6c2e 7665 7274 6963  ints[hull.vertic
+00000a20: 6573 5d0d 0a20 2020 2020 2020 2063 506e  es]..        cPn
+00000a30: 7420 3d20 7665 7274 732e 6d65 616e 2861  t = verts.mean(a
+00000a40: 7869 733d 3029 0d0a 2020 2020 2020 2020  xis=0)..        
+00000a50: 2320 7365 7420 7468 6520 6661 6365 496e  # set the faceIn
+00000a60: 6469 6365 7320 7265 6665 7265 6e63 696e  dices referencin
+00000a70: 6720 7468 6520 7665 7274 732c 206e 6f74  g the verts, not
+00000a80: 2074 6865 2070 6f69 6e74 732e 2e2e 2e0d   the points.....
+00000a90: 0a20 2020 2020 2020 2072 6576 6c6b 7570  .        revlkup
+00000aa0: 203d 207b 2076 616c 3a69 2066 6f72 2069   = { val:i for i
+00000ab0: 2c76 616c 2069 6e20 656e 756d 6572 6174  ,val in enumerat
+00000ac0: 6528 6875 6c6c 2e76 6572 7469 6365 7329  e(hull.vertices)
+00000ad0: 207d 0d0a 2020 2020 2020 2020 6649 6e64   }..        fInd
+00000ae0: 6963 6573 203d 205b 4e6f 6e65 5d2a 6c65  ices = [None]*le
+00000af0: 6e28 2068 756c 6c2e 7369 6d70 6c69 6365  n( hull.simplice
+00000b00: 7320 290d 0a20 2020 2020 2020 2066 6f72  s )..        for
+00000b10: 2069 2c69 6e64 7820 696e 2065 6e75 6d65   i,indx in enume
+00000b20: 7261 7465 2868 756c 6c2e 7369 6d70 6c69  rate(hull.simpli
+00000b30: 6365 7329 3a0d 0a20 2020 2020 2020 2020  ces):..         
+00000b40: 2020 2061 2c62 2c63 203d 2069 6e64 780d     a,b,c = indx.
+00000b50: 0a20 2020 2020 2020 2020 2020 2066 496e  .            fIn
+00000b60: 6469 6365 735b 695d 203d 205b 2072 6576  dices[i] = [ rev
+00000b70: 6c6b 7570 5b61 5d20 2c20 7265 766c 6b75  lkup[a] , revlku
+00000b80: 705b 625d 202c 2072 6576 6c6b 7570 5b63  p[b] , revlkup[c
+00000b90: 5d20 5d20 0d0a 2020 2020 2020 2020 2320  ] ] ..        # 
+00000ba0: 7365 7420 7468 6520 6661 6365 2069 6e64  set the face ind
+00000bb0: 6963 6573 2075 7369 6e67 2074 6865 2052  ices using the R
+00000bc0: 4852 2066 6f72 206f 7574 7761 7264 206e  HR for outward n
+00000bd0: 6f72 6d61 6c73 2066 726f 6d20 7468 6520  ormals from the 
+00000be0: 6365 6e74 6572 2e0d 0a20 2020 2020 2020  center...       
+00000bf0: 2074 656d 7020 3d20 5b4e 6f6e 655d 2a6c   temp = [None]*l
+00000c00: 656e 2866 496e 6469 6365 7329 0d0a 2020  en(fIndices)..  
+00000c10: 2020 2020 2020 666f 7220 692c 6669 6e64        for i,find
+00000c20: 7820 696e 2065 6e75 6d65 7261 7465 2866  x in enumerate(f
+00000c30: 496e 6469 6365 7329 203a 0d0a 2020 2020  Indices) :..    
+00000c40: 2020 2020 2020 2020 612c 622c 6320 3d20          a,b,c = 
+00000c50: 6669 6e64 780d 0a20 2020 2020 2020 2020  findx..         
+00000c60: 2020 2066 6365 6e74 6572 203d 2028 7665     fcenter = (ve
+00000c70: 7274 735b 615d 202b 2076 6572 7473 5b62  rts[a] + verts[b
+00000c80: 5d20 2b20 7665 7274 735b 635d 292f 330d  ] + verts[c])/3.
+00000c90: 0a20 2020 2020 2020 2020 2020 206e 6f72  .            nor
+00000ca0: 6469 7220 3d20 6e70 2e63 726f 7373 2876  dir = np.cross(v
+00000cb0: 6572 7473 5b62 5d2d 7665 7274 735b 615d  erts[b]-verts[a]
+00000cc0: 2c76 6572 7473 5b63 5d2d 7665 7274 735b  ,verts[c]-verts[
+00000cd0: 625d 290d 0a20 2020 2020 2020 2020 2020  b])..           
+00000ce0: 2064 6f74 7072 6f64 203d 206e 702e 646f   dotprod = np.do
+00000cf0: 7428 6663 656e 7465 722d 6350 6e74 2c6e  t(fcenter-cPnt,n
+00000d00: 6f72 6469 7229 0d0a 2020 2020 2020 2020  ordir)..        
+00000d10: 2020 2020 7465 6d70 5b69 5d20 3d20 5b61      temp[i] = [a
+00000d20: 2c62 2c63 5d20 6966 2064 6f74 7072 6f64  ,b,c] if dotprod
+00000d30: 3e30 2065 6c73 6520 5b63 2c62 2c61 5d0d  >0 else [c,b,a].
+00000d40: 0a20 2020 2020 2020 2066 496e 6469 6365  .        fIndice
+00000d50: 7320 3d20 7465 6d70 0d0a 2020 2020 2020  s = temp..      
+00000d60: 2020 7375 7266 6163 6520 3d20 5375 7266    surface = Surf
+00000d70: 6163 6533 4443 6f6c 6c65 6374 696f 6e28  ace3DCollection(
+00000d80: 7665 7274 732c 6649 6e64 6963 6573 2c20  verts,fIndices, 
+00000d90: 2a2a 6b61 7267 7329 0d0a 2020 2020 2020  **kargs)..      
+00000da0: 2020 7265 7475 726e 2073 7572 6661 6365    return surface
+00000db0: 0d0a 0d0a 2020 2020 4073 7461 7469 636d  ....    @staticm
+00000dc0: 6574 686f 640d 0a20 2020 2064 6566 2069  ethod..    def i
+00000dd0: 6d70 6c73 7572 6628 6f70 6572 6174 696f  mplsurf(operatio
+00000de0: 6e2c 2064 7265 7a3d 322e 302c 2064 6f6d  n, drez=2.0, dom
+00000df0: 6169 6e3d 312c 206e 616d 653d 4e6f 6e65  ain=1, name=None
+00000e00: 2c20 2a2a 6b77 6172 6773 2920 3a0d 0a20  , **kwargs) :.. 
+00000e10: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
+00000e20: 2020 2020 5375 7266 6163 6533 4443 6f6c      Surface3DCol
+00000e30: 6c65 6374 696f 6e20 6465 6669 6e65 6420  lection defined 
+00000e40: 6279 2061 6e20 696d 706c 6963 6974 2066  by an implicit f
+00000e50: 756e 6374 696f 6e20 6628 782c 792c 7a29  unction f(x,y,z)
+00000e60: 203d 2030 2e0d 0a0d 0a20 2020 2020 2020   = 0.....       
+00000e70: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
+00000e80: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
+00000e90: 0a20 2020 2020 2020 206f 7065 7261 7469  .        operati
+00000ea0: 6f6e 203a 2066 756e 6374 696f 6e20 6f62  on : function ob
+00000eb0: 6a65 6374 0d0a 2020 2020 2020 2020 2020  ject..          
+00000ec0: 2020 496d 706c 6963 6974 2066 756e 6374    Implicit funct
+00000ed0: 696f 6e20 7468 6174 2074 616b 6573 206f  ion that takes o
+00000ee0: 6e65 0d0a 2020 2020 2020 2020 2020 2020  ne..            
+00000ef0: 6172 6775 6d65 6e74 2c20 6120 3378 4e20  argument, a 3xN 
+00000f00: 4e75 6d70 7920 6172 7261 7920 6f66 2078  Numpy array of x
+00000f10: 2c79 2c7a 2063 6f6f 7264 696e 6174 6573  ,y,z coordinates
+00000f20: 2e0d 0a20 2020 2020 2020 2020 2020 2054  ...            T
+00000f30: 6865 2066 756e 6374 696f 6e20 7265 7475  he function retu
+00000f40: 726e 7320 6120 7369 6e67 6c65 2073 6361  rns a single sca
+00000f50: 6c61 7220 7661 6c75 652e 0d0a 2020 2020  lar value...    
+00000f60: 2020 2020 2020 2020 5468 6520 7661 6c75          The valu
+00000f70: 6520 6f66 207a 6572 6f20 6465 6669 6e65  e of zero define
+00000f80: 7320 7468 6520 696d 706c 6963 6974 2073  s the implicit s
+00000f90: 7572 6661 6365 2e0d 0a0d 0a20 2020 2020  urface.....     
+00000fa0: 2020 2064 7265 7a20 3a20 466c 6f61 742c     drez : Float,
+00000fb0: 206f 7074 696f 6e61 6c2c 2064 6566 6175   optional, defau
+00000fc0: 6c74 3a20 322e 300d 0a20 2020 2020 2020  lt: 2.0..       
+00000fd0: 2020 2020 204d 756c 7469 706c 6965 7220       Multiplier 
+00000fe0: 666f 7220 7468 6520 6e75 6d62 6572 206f  for the number o
+00000ff0: 6620 7375 6264 6976 6973 696f 6e73 2077  f subdivisions w
+00001000: 6974 6869 6e20 7468 6520 646f 6d61 696e  ithin the domain
+00001010: 2e0d 0a20 2020 2020 2020 2020 2020 2046  ...            F
+00001020: 7265 7a20 7661 6c75 6573 2072 616e 6765  rez values range
+00001030: 2066 726f 6d20 3120 746f 2031 302e 2020   from 1 to 10.  
+00001040: 4675 6e63 7469 6f6e 2065 7661 6c75 6174  Function evaluat
+00001050: 696f 6e20 7769 6c6c 2062 650d 0a20 2020  ion will be..   
+00001060: 2020 2020 2020 2020 2074 6865 206f 7264           the ord
+00001070: 6572 206f 6620 6672 657a 2063 7562 6564  er of frez cubed
+00001080: 2e0d 0a0d 0a20 2020 2020 2020 2064 6f6d  .....        dom
+00001090: 6169 6e20 3a20 6120 6e75 6d62 6572 2c20  ain : a number, 
+000010a0: 6c69 7374 206f 7220 6172 7261 792c 2064  list or array, d
+000010b0: 6566 6175 6c74 3a20 310d 0a20 2020 2020  efault: 1..     
+000010c0: 2020 2020 2020 2054 6865 2064 6f6d 6169         The domai
+000010d0: 6e20 6f66 2074 6865 2066 756e 6374 696f  n of the functio
+000010e0: 6e20 6576 616c 7561 7469 6f6e 2e20 2046  n evaluation.  F
+000010f0: 6f72 2061 206e 756d 6265 722c 206e 2c0d  or a number, n,.
+00001100: 0a20 2020 2020 2020 2020 2020 2074 6865  .            the
+00001110: 2078 2c79 2c7a 2061 7865 7320 646f 6d61   x,y,z axes doma
+00001120: 696e 7320 7769 6c6c 2062 6520 5b2d 6e2c  ins will be [-n,
+00001130: 6e5d 2e20 466f 7220 6120 312d 6469 6d65  n]. For a 1-dime
+00001140: 6e73 696f 6e61 6c20 322d 656c 656d 656e  nsional 2-elemen
+00001150: 7420 6c69 7374 2c0d 0a20 2020 2020 2020  t list,..       
+00001160: 2020 2020 205b 612c 625d 2077 696c 6c20       [a,b] will 
+00001170: 6265 2061 7373 6967 6e65 6420 7468 6520  be assigned the 
+00001180: 646f 6d61 696e 2066 6f72 2061 6c6c 2033  domain for all 3
+00001190: 2061 7865 732e 2020 5573 696e 6720 6120   axes.  Using a 
+000011a0: 6c69 7374 206f 6620 6c69 7374 2028 6172  list of list (ar
+000011b0: 7261 7929 2c0d 0a20 2020 2020 2020 2020  ray),..         
+000011c0: 2020 2061 7320 5b20 5b61 2c62 5d2c 5b63     as [ [a,b],[c
+000011d0: 2c64 5d2c 5b65 2c66 5d20 5d2c 2074 6865  ,d],[e,f] ], the
+000011e0: 2064 6f6d 6169 6e20 6973 2061 7373 6967   domain is assig
+000011f0: 6e65 6420 696e 6469 7669 6475 616c 6c79  ned individually
+00001200: 2066 6f72 2065 6163 6820 6f66 2074 6865   for each of the
+00001210: 0d0a 2020 2020 2020 2020 2020 2020 7468  ..            th
+00001220: 7265 6520 636f 6f72 6469 6e61 7465 2061  ree coordinate a
+00001230: 7865 732e 0d0a 0d0a 2020 2020 2020 2020  xes.....        
+00001240: 5265 7475 726e 730d 0a20 2020 2020 2020  Returns..       
+00001250: 202d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020   -------..      
+00001260: 2020 5375 7266 6163 6533 4443 6f6c 6c65    Surface3DColle
+00001270: 6374 696f 6e20 6f62 6a65 6374 0d0a 0d0a  ction object....
+00001280: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
+00001290: 2020 2020 2023 2e2e 2e2e 2e2e 2e2e 2e2e       #..........
+000012a0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+000012b0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e20 2020 200d  ...........    .
+000012c0: 0a20 2020 2020 2020 2064 6566 2067 6574  .        def get
+000012d0: 5f56 4628 6f70 2c4e 2c64 6d29 203a 0d0a  _VF(op,N,dm) :..
+000012e0: 2020 2020 2020 2020 2020 2020 5844 2c59              XD,Y
+000012f0: 442c 5a44 203d 2064 6d5b 305d 2c64 6d5b  D,ZD = dm[0],dm[
+00001300: 315d 2c64 6d5b 325d 0d0a 2020 2020 2020  1],dm[2]..      
+00001310: 2020 2020 2020 646d 5420 3d20 646d 2e54        dmT = dm.T
+00001320: 0d0a 2020 2020 2020 2020 2020 2020 4120  ..            A 
+00001330: 3d20 646d 545b 315d 2d64 6d54 5b30 5d0d  = dmT[1]-dmT[0].
+00001340: 0a20 2020 2020 2020 2020 2020 2042 3d6e  .            B=n
+00001350: 702e 6172 7261 7928 205b 2058 445b 305d  p.array( [ XD[0]
+00001360: 2c59 445b 305d 2c5a 445b 305d 205d 290d  ,YD[0],ZD[0] ]).
+00001370: 0a20 2020 2020 2020 2020 2020 2073 702c  .            sp,
+00001380: 6c65 7665 6c20 3d20 312f 4e2c 2030 2e30  level = 1/N, 0.0
+00001390: 3031 2020 2020 2320 4675 7444 6576 3a20  01    # FutDev: 
+000013a0: 6c65 7665 6c20 7368 6f75 6c64 206e 6f74  level should not
+000013b0: 2062 6520 6120 636f 6e73 7461 6e74 2e0d   be a constant..
+000013c0: 0a20 2020 2020 2020 2020 2020 204e 6a20  .            Nj 
+000013d0: 3d20 284e 2b31 292a 316a 0d0a 2020 2020  = (N+1)*1j..    
+000013e0: 2020 2020 2020 2020 7879 7a20 3d20 6e70          xyz = np
+000013f0: 2e6d 6772 6964 5b58 445b 305d 3a58 445b  .mgrid[XD[0]:XD[
+00001400: 315d 3a4e 6a2c 5944 5b30 5d3a 5944 5b31  1]:Nj,YD[0]:YD[1
+00001410: 5d3a 4e6a 2c20 5a44 5b30 5d3a 5a44 5b31  ]:Nj, ZD[0]:ZD[1
+00001420: 5d3a 4e6a 205d 0d0a 2020 2020 2020 2020  ]:Nj ]..        
+00001430: 2020 2020 7665 7274 732c 2066 7649 6e64      verts, fvInd
+00001440: 6963 6573 2c20 5f2c 205f 203d 206d 6561  ices, _, _ = mea
+00001450: 7375 7265 2e6d 6172 6368 696e 675f 6375  sure.marching_cu
+00001460: 6265 7328 6f70 2878 797a 292c 206c 6576  bes(op(xyz), lev
+00001470: 656c 2c20 7370 6163 696e 673d 2873 702c  el, spacing=(sp,
+00001480: 2073 702c 2073 7029 290d 0a20 2020 2020   sp, sp))..     
+00001490: 2020 2020 2020 2043 203d 206e 702e 656d         C = np.em
+000014a0: 7074 7928 5b6c 656e 2876 6572 7473 292c  pty([len(verts),
+000014b0: 335d 290d 0a20 2020 2020 2020 2020 2020  3])..           
+000014c0: 2043 5b3a 5d20 3d20 410d 0a20 2020 2020   C[:] = A..     
+000014d0: 2020 2020 2020 2076 6572 7473 203d 2043         verts = C
+000014e0: 2a76 6572 7473 202b 2042 0d0a 2020 2020  *verts + B..    
+000014f0: 2020 2020 2020 2020 7265 7475 726e 2076          return v
+00001500: 6572 7473 2c66 7649 6e64 6963 6573 0d0a  erts,fvIndices..
+00001510: 2020 2020 2020 2020 232e 2e2e 2e2e 2e2e          #.......
+00001520: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00001530: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2020  ..............  
+00001540: 2020 0d0a 2020 2020 2020 2020 6466 7444    ..        dftD
+00001550: 6d20 3d20 5375 7266 6163 6533 4443 6f6c  m = Surface3DCol
+00001560: 6c65 6374 696f 6e2e 5f69 6e74 6572 7072  lection._interpr
+00001570: 6574 5f64 6f6d 6169 6e28 646f 6d61 696e  et_domain(domain
+00001580: 290d 0a20 2020 2020 2020 2069 6620 6e6f  )..        if no
+00001590: 7420 6973 696e 7374 616e 6365 2864 7265  t isinstance(dre
+000015a0: 7a2c 2028 696e 742c 666c 6f61 7429 2920  z, (int,float)) 
+000015b0: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
+000015c0: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+000015d0: 2822 496e 636f 7272 6563 7420 6472 657a  ("Incorrect drez
+000015e0: 2061 7267 756d 656e 7420 6461 7461 7479   argument dataty
+000015f0: 7065 2070 6173 7365 6420 746f 2069 6d70  pe passed to imp
+00001600: 663a 222c 2064 7265 7a29 0d0a 2020 2020  f:", drez)..    
+00001610: 2020 2020 6966 2064 7265 7a3c 3120 6f72      if drez<1 or
+00001620: 2064 7265 7a3e 3130 203a 0d0a 2020 2020   drez>10 :..    
+00001630: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+00001640: 6c75 6545 7272 6f72 2822 4572 726f 723a  lueError("Error:
+00001650: 2069 6e63 6f72 7265 6374 2076 616c 7565   incorrect value
+00001660: 2064 7265 7a20 7061 7373 6564 2074 6f20   drez passed to 
+00001670: 696d 7066 3a22 2c20 6472 657a 290d 0a20  impf:", drez).. 
+00001680: 2020 2020 2020 204e 203d 2069 6e74 2820         N = int( 
+00001690: 3130 2a64 7265 7a20 290d 0a20 2020 2020  10*drez )..     
+000016a0: 2020 2076 6572 7473 2c20 6661 6365 7320     verts, faces 
+000016b0: 3d20 6765 745f 5646 286f 7065 7261 7469  = get_VF(operati
+000016c0: 6f6e 2c4e 2c64 6674 446d 290d 0a20 2020  on,N,dftDm)..   
+000016d0: 2020 2020 2073 7572 6661 6365 203d 2053       surface = S
+000016e0: 7572 6661 6365 3344 436f 6c6c 6563 7469  urface3DCollecti
+000016f0: 6f6e 2820 7665 7274 732c 2066 6163 6573  on( verts, faces
+00001700: 2c20 2a2a 6b77 6172 6773 290d 0a0d 0a20  , **kwargs).... 
+00001710: 2020 2020 2020 2069 6620 6e61 6d65 2069         if name i
+00001720: 7320 4e6f 6e65 3a20 6e61 6d65 203d 205f  s None: name = _
+00001730: 6765 7446 756e 6374 696f 6e4e 616d 6528  getFunctionName(
+00001740: 6f70 6572 6174 696f 6e2c 6e61 6d65 290d  operation,name).
+00001750: 0a20 2020 2020 2020 2069 6620 6e61 6d65  .        if name
+00001760: 2069 7320 6e6f 7420 4e6f 6e65 3a20 7375   is not None: su
+00001770: 7266 6163 652e 5f67 656f 6d4e 616d 6520  rface._geomName 
+00001780: 3d20 6e61 6d65 0d0a 2020 2020 2020 2020  = name..        
+00001790: 7265 7475 726e 2073 7572 6661 6365 0d0a  return surface..
+000017a0: 0d0a 2020 2020 4073 7461 7469 636d 6574  ..    @staticmet
+000017b0: 686f 640d 0a20 2020 2064 6566 2074 7269  hod..    def tri
+000017c0: 616e 6775 6c61 7465 4261 7365 2872 657a  angulateBase(rez
+000017d0: 2c62 6173 6556 636f 6f72 2c62 6173 6546  ,baseVcoor,baseF
+000017e0: 6163 6556 6572 7465 7849 6e64 6963 6573  aceVertexIndices
+000017f0: 2c20 6d69 6456 6563 7446 756e 6329 203a  , midVectFunc) :
+00001800: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
+00001810: 2020 2020 2020 2052 6563 7572 7369 7665         Recursive
+00001820: 6c79 2073 7562 6469 7669 6465 2074 7269  ly subdivide tri
+00001830: 616e 676c 6573 2e0d 0a0d 0a20 2020 2020  angles.....     
+00001840: 2020 2045 6163 6820 7265 6375 7273 696f     Each recursio
+00001850: 6e20 7375 6264 6976 6964 6573 2065 6163  n subdivides eac
+00001860: 6820 7472 6961 6e67 6c65 2062 7920 666f  h triangle by fo
+00001870: 7572 2e0d 0a0d 0a20 2020 2020 2020 2050  ur.....        P
+00001880: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
+00001890: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
+000018a0: 2020 2020 2020 2072 657a 203a 2069 6e74         rez : int
+000018b0: 6567 6572 2c20 6f70 7469 6f6e 616c 2c20  eger, optional, 
+000018c0: 6465 6661 756c 743a 2030 0d0a 2020 2020  default: 0..    
+000018d0: 2020 2020 2020 2020 4e75 6d62 6572 206f          Number o
+000018e0: 6620 7265 6375 7273 6976 6520 7375 6264  f recursive subd
+000018f0: 6976 6973 696f 6e73 206f 6620 7468 6520  ivisions of the 
+00001900: 7472 6961 6e67 756c 6174 6564 2062 6173  triangulated bas
+00001910: 6520 6661 6365 732e 0d0a 2020 2020 2020  e faces...      
+00001920: 2020 2020 2020 5265 7a20 7661 6c75 6573        Rez values
+00001930: 2072 616e 6765 2066 726f 6d20 3020 746f   range from 0 to
+00001940: 2037 2e0d 0a0d 0a20 2020 2020 2020 2062   7.....        b
+00001950: 6173 6556 636f 6f72 203a 2056 2078 2033  aseVcoor : V x 3
+00001960: 2066 6c6f 6174 2061 7272 6179 0d0a 2020   float array..  
+00001970: 2020 2020 2020 2020 2020 416e 2061 7272            An arr
+00001980: 6179 206f 6620 2776 2720 6e75 6d62 6572  ay of 'v' number
+00001990: 206f 6620 7879 7a20 7665 7274 6578 2063   of xyz vertex c
+000019a0: 6f6f 7264 696e 6174 6573 2e0d 0a0d 0a20  oordinates..... 
+000019b0: 2020 2020 2020 2062 6173 6546 6163 6556         baseFaceV
+000019c0: 6572 7465 7874 496e 6469 6365 7320 3a20  ertextIndices : 
+000019d0: 4620 7820 3320 696e 7420 6172 7261 790d  F x 3 int array.
+000019e0: 0a20 2020 2020 2020 2020 2020 2041 6e20  .            An 
+000019f0: 6172 7261 7920 6f66 2027 4627 206e 756d  array of 'F' num
+00001a00: 6265 7220 6f66 2066 6163 6520 7665 7274  ber of face vert
+00001a10: 6578 2069 6e64 6963 6573 2e0d 0a0d 0a20  ex indices..... 
+00001a20: 2020 2020 2020 206d 6964 5665 6374 4675         midVectFu
+00001a30: 6e63 203a 2066 756e 6374 696f 6e20 6f62  nc : function ob
+00001a40: 6a65 6374 0d0a 2020 2020 2020 2020 2020  ject..          
+00001a50: 2020 4120 6675 6e63 7469 6f6e 2074 6861    A function tha
+00001a60: 7420 7461 6b65 7320 7477 6f20 7879 7a20  t takes two xyz 
+00001a70: 636f 6f72 6469 6e61 7465 2028 6c69 7374  coordinate (list
+00001a80: 206f 6620 3329 0d0a 2020 2020 2020 2020   of 3)..        
+00001a90: 2020 2020 7265 7072 6573 656e 7469 6e67      representing
+00001aa0: 2061 2073 7572 6661 6365 2066 6163 6520   a surface face 
+00001ab0: 6564 6765 2e20 2052 6574 7572 6e73 206f  edge.  Returns o
+00001ac0: 6e65 2078 797a 2063 6f6f 7264 696e 6174  ne xyz coordinat
+00001ad0: 650d 0a20 2020 2020 2020 2020 2020 2061  e..            a
+00001ae0: 7420 7468 6520 6269 7365 6374 696f 6e20  t the bisection 
+00001af0: 6f66 2074 6865 2065 6467 652c 206d 6170  of the edge, map
+00001b00: 7065 6420 6f6e 2074 6865 2073 7572 6661  ped on the surfa
+00001b10: 6365 2e0d 0a0d 0a20 2020 2020 2020 2052  ce.....        R
+00001b20: 6574 7572 6e73 0d0a 2020 2020 2020 2020  eturns..        
+00001b30: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
+00001b40: 2069 6e64 6578 4f62 6a20 3a20 6120 6469   indexObj : a di
+00001b50: 6374 696f 6e61 7279 206f 6620 7665 7274  ctionary of vert
+00001b60: 6578 2069 6e64 6963 6573 2c20 666f 7220  ex indices, for 
+00001b70: 6120 7375 7266 6163 650d 0a20 2020 2020  a surface..     
+00001b80: 2020 2020 2020 206f 6620 4620 6661 6365         of F face
+00001b90: 732c 2045 2065 6467 6573 2061 6e64 2056  s, E edges and V
+00001ba0: 2076 6572 7469 6365 732e 0d0a 2020 2020   vertices...    
+00001bb0: 2020 2020 2020 2020 2766 6163 6527 203a          'face' :
+00001bc0: 2046 2078 2033 2069 6e74 2061 7272 6179   F x 3 int array
+00001bd0: 0d0a 2020 2020 2020 2020 2020 2020 2765  ..            'e
+00001be0: 6467 6527 203a 2045 2078 2032 2069 6e74  dge' : E x 2 int
+00001bf0: 2061 7272 6179 0d0a 0d0a 2020 2020 2020   array....      
+00001c00: 2020 7665 7274 436f 6f72 203a 2056 2078    vertCoor : V x
+00001c10: 2033 2066 6c6f 6174 2061 7272 6179 0d0a   3 float array..
+00001c20: 2020 2020 2020 2020 2020 2020 416e 2061              An a
+00001c30: 7272 6179 206f 6620 5620 6e75 6d62 6572  rray of V number
+00001c40: 206f 6620 7879 7a20 7665 7274 6578 2063   of xyz vertex c
+00001c50: 6f6f 7264 696e 6174 6573 2e0d 0a0d 0a20  oordinates..... 
+00001c60: 2020 2020 2020 2022 2222 0d0a 0d0a 2020         """....  
+00001c70: 2020 2020 2020 7643 6f6f 7220 3d20 6261        vCoor = ba
+00001c80: 7365 5663 6f6f 722e 636f 7079 2829 0d0a  seVcoor.copy()..
+00001c90: 2020 2020 2020 2020 6676 496e 6469 6365          fvIndice
+00001ca0: 7320 3d20 5b5d 0d0a 2020 2020 2020 2020  s = []..        
+00001cb0: 6576 496e 6469 6365 7320 3d20 5b5d 0d0a  evIndices = []..
+00001cc0: 2020 2020 2020 2020 232e 2e2e 2e2e 2e2e          #.......
+00001cd0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00001ce0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2020  ..............  
+00001cf0: 2020 0d0a 2020 2020 2020 2020 6465 6620    ..        def 
+00001d00: 6765 7456 6572 7469 6365 734c 696e 6528  getVerticesLine(
+00001d10: 6465 6772 6565 2c20 6c65 6674 496e 6465  degree, leftInde
+00001d20: 782c 2072 6967 6874 496e 6465 7829 203a  x, rightIndex) :
+00001d30: 0d0a 2020 2020 2020 2020 2020 2020 6465  ..            de
+00001d40: 6620 7265 6375 7273 5f65 6467 6543 6f6f  f recurs_edgeCoo
+00001d50: 7228 6465 6772 6565 2c20 696e 6465 784f  r(degree, indexO
+00001d60: 7269 6769 6e2c 2069 7352 6967 6874 2c20  rigin, isRight, 
+00001d70: 6c65 6674 496e 6465 782c 2072 6967 6874  leftIndex, right
+00001d80: 496e 6465 782c 2045 696e 6465 7829 203a  Index, Eindex) :
+00001d90: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00001da0: 2020 6d20 3d20 6465 6772 6565 202d 2031    m = degree - 1
+00001db0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00001dc0: 2020 6465 6c74 6120 3d20 696e 7428 6e70    delta = int(np
+00001dd0: 2e70 6f77 6572 2832 2c6d 2929 0d0a 2020  .power(2,m))..  
+00001de0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00001df0: 2069 7352 6967 6874 203a 2064 656c 7461   isRight : delta
+00001e00: 203d 202d 6465 6c74 610d 0a20 2020 2020   = -delta..     
+00001e10: 2020 2020 2020 2020 2020 2069 203d 2069             i = i
+00001e20: 6e64 6578 4f72 6967 696e 202d 2064 656c  ndexOrigin - del
+00001e30: 7461 0d0a 2020 2020 2020 2020 2020 2020  ta..            
+00001e40: 2020 2020 6d69 645f 636f 6f72 203d 206d      mid_coor = m
+00001e50: 6964 5665 6374 4675 6e63 2820 7643 6f6f  idVectFunc( vCoo
+00001e60: 725b 6c65 6674 496e 6465 785d 2c20 7643  r[leftIndex], vC
+00001e70: 6f6f 725b 7269 6768 7449 6e64 6578 5d20  oor[rightIndex] 
+00001e80: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00001e90: 2020 2063 7572 7265 6e74 436f 6f72 496e     currentCoorIn
+00001ea0: 6465 7820 3d20 6c65 6e28 7643 6f6f 7229  dex = len(vCoor)
+00001eb0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00001ec0: 2020 7643 6f6f 722e 6170 7065 6e64 286d    vCoor.append(m
+00001ed0: 6964 5f63 6f6f 7229 0d0a 2020 2020 2020  id_coor)..      
+00001ee0: 2020 2020 2020 2020 2020 4569 6e64 6578            Eindex
+00001ef0: 5b69 5d20 3d20 6375 7272 656e 7443 6f6f  [i] = currentCoo
+00001f00: 7249 6e64 6578 0d0a 2020 2020 2020 2020  rIndex..        
+00001f10: 2020 2020 2020 2020 6966 206d 203c 3d20          if m <= 
+00001f20: 3020 3a0d 0a20 2020 2020 2020 2020 2020  0 :..           
+00001f30: 2020 2020 2020 2020 2065 7649 6e64 6963           evIndic
+00001f40: 6573 2e61 7070 656e 6428 205b 6c65 6674  es.append( [left
+00001f50: 496e 6465 782c 2063 7572 7265 6e74 436f  Index, currentCo
+00001f60: 6f72 496e 6465 785d 2029 2020 2020 2020  orIndex] )      
+00001f70: 2020 2020 2020 2020 2020 2020 2020 0d0a                ..
+00001f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001f90: 2020 2020 6576 496e 6469 6365 732e 6170      evIndices.ap
+00001fa0: 7065 6e64 2820 5b63 7572 7265 6e74 436f  pend( [currentCo
+00001fb0: 6f72 496e 6465 782c 2072 6967 6874 496e  orIndex, rightIn
+00001fc0: 6465 785d 2029 2020 2020 2020 2020 2020  dex] )          
+00001fd0: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+00001fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001ff0: 7265 7475 726e 0d0a 2020 2020 2020 2020  return..        
+00002000: 2020 2020 2020 2020 7265 6375 7273 5f65          recurs_e
+00002010: 6467 6543 6f6f 7228 6d2c 692c 4661 6c73  dgeCoor(m,i,Fals
+00002020: 652c 6c65 6674 496e 6465 782c 6375 7272  e,leftIndex,curr
+00002030: 656e 7443 6f6f 7249 6e64 6578 2c20 4569  entCoorIndex, Ei
+00002040: 6e64 6578 290d 0a20 2020 2020 2020 2020  ndex)..         
+00002050: 2020 2020 2020 2072 6563 7572 735f 6564         recurs_ed
+00002060: 6765 436f 6f72 286d 2c69 2c54 7275 652c  geCoor(m,i,True,
+00002070: 6375 7272 656e 7443 6f6f 7249 6e64 6578  currentCoorIndex
+00002080: 2c72 6967 6874 496e 6465 782c 2045 696e  ,rightIndex, Ein
+00002090: 6465 7829 0d0a 2020 2020 2020 2020 2020  dex)..          
+000020a0: 2020 2020 2020 7265 7475 726e 0d0a 2020        return..  
+000020b0: 2020 2020 2020 2020 2020 232e 2e2e 2e2e            #.....
+000020c0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+000020d0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+000020e0: 2020 2020 0d0a 2020 2020 2020 2020 2020      ..          
+000020f0: 2020 694f 7269 6769 6e20 3d20 696e 7428    iOrigin = int(
+00002100: 6e70 2e70 6f77 6572 2832 2c64 6567 7265  np.power(2,degre
+00002110: 6529 290d 0a20 2020 2020 2020 2020 2020  e))..           
+00002120: 2045 696e 6465 7820 3d20 5b4e 6f6e 655d   Eindex = [None]
+00002130: 2a28 694f 7269 6769 6e2b 3129 0d0a 2020  *(iOrigin+1)..  
+00002140: 2020 2020 2020 2020 2020 4569 6e64 6578            Eindex
+00002150: 5b30 5d20 3d20 6c65 6674 496e 6465 780d  [0] = leftIndex.
+00002160: 0a20 2020 2020 2020 2020 2020 2045 696e  .            Ein
+00002170: 6465 785b 694f 7269 6769 6e5d 203d 2072  dex[iOrigin] = r
+00002180: 6967 6874 496e 6465 780d 0a20 2020 2020  ightIndex..     
+00002190: 2020 2020 2020 2069 6620 6465 6772 6565         if degree
+000021a0: 3d3d 3020 3a0d 0a20 2020 2020 2020 2020  ==0 :..         
+000021b0: 2020 2020 2020 2065 7649 6e64 6963 6573         evIndices
+000021c0: 2e61 7070 656e 6428 205b 6c65 6674 496e  .append( [leftIn
+000021d0: 6465 782c 2072 6967 6874 496e 6465 785d  dex, rightIndex]
+000021e0: 2029 0d0a 2020 2020 2020 2020 2020 2020   )..            
+000021f0: 2020 2020 7265 7475 726e 2045 696e 6465      return Einde
+00002200: 780d 0a20 2020 2020 2020 2020 2020 2072  x..            r
+00002210: 6563 7572 735f 6564 6765 436f 6f72 2864  ecurs_edgeCoor(d
+00002220: 6567 7265 652c 2069 4f72 6967 696e 2c20  egree, iOrigin, 
+00002230: 4661 6c73 652c 206c 6566 7449 6e64 6578  False, leftIndex
+00002240: 2c20 7269 6768 7449 6e64 6578 2c20 4569  , rightIndex, Ei
+00002250: 6e64 6578 290d 0a20 2020 2020 2020 2020  ndex)..         
+00002260: 2020 2072 6574 7572 6e20 4569 6e64 6578     return Eindex
+00002270: 0d0a 2020 2020 2020 2020 232e 2e2e 2e2e  ..        #.....
+00002280: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00002290: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+000022a0: 2020 2020 0d0a 2020 2020 2020 2020 6465      ..        de
+000022b0: 6620 7265 6375 7273 5f66 6163 6549 6e64  f recurs_faceInd
+000022c0: 6963 6573 2841 2c42 2c43 2c72 657a 2c61  ices(A,B,C,rez,a
+000022d0: 7443 656e 7465 723d 5472 7565 293a 0d0a  tCenter=True):..
+000022e0: 2020 2020 2020 2020 2020 2020 6966 2072              if r
+000022f0: 657a 3d3d 3020 3a0d 0a20 2020 2020 2020  ez==0 :..       
+00002300: 2020 2020 2020 2020 2061 6263 203d 205b           abc = [
+00002310: 2041 5b30 5d2c 2042 5b30 5d2c 2043 5b30   A[0], B[0], C[0
+00002320: 5d20 5d20 2020 2020 2020 2020 2020 2020  ] ]             
+00002330: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
+00002340: 2020 2020 6676 496e 6469 6365 732e 6170      fvIndices.ap
+00002350: 7065 6e64 2820 6162 6320 290d 0a20 2020  pend( abc )..   
+00002360: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00002370: 6174 4365 6e74 6572 203a 2065 7649 6e64  atCenter : evInd
+00002380: 6963 6573 2e61 7070 656e 6428 205b 2042  ices.append( [ B
+00002390: 5b30 5d2c 2043 5b30 5d20 5d20 290d 0a20  [0], C[0] ] ).. 
+000023a0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+000023b0: 6574 7572 6e0d 0a20 2020 2020 2020 2020  eturn..         
+000023c0: 2020 2023 202d 2d2d 2d2d 2d2d 2d2d 2d2d     # -----------
+000023d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000023e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000023f0: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
+00002400: 2020 2020 2020 2020 4a20 3d20 696e 7428          J = int(
+00002410: 2028 6c65 6e28 4129 2d31 292f 3220 290d   (len(A)-1)/2 ).
+00002420: 0a20 2020 2020 2020 2020 2020 204b 203d  .            K =
+00002430: 204a 202b 2031 0d0a 2020 2020 2020 2020   J + 1..        
+00002440: 2020 2020 2320 636f 6e73 7472 7563 7420      # construct 
+00002450: 7468 6520 6365 6e74 6572 2073 7562 2074  the center sub t
+00002460: 7269 616e 676c 6520 6564 6765 2076 6572  riangle edge ver
+00002470: 7469 6365 732e 2e2e 2e0d 0a20 2020 2020  tices......     
+00002480: 2020 2020 2020 2069 6620 7265 7a3d 3d31         if rez==1
+00002490: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
+000024a0: 2020 2020 787a 203d 205b 2041 5b31 5d2c      xz = [ A[1],
+000024b0: 2043 5b31 5d20 5d0d 0a20 2020 2020 2020   C[1] ]..       
+000024c0: 2020 2020 2020 2020 2079 7820 3d20 5b20           yx = [ 
+000024d0: 425b 315d 2c20 415b 315d 205d 0d0a 2020  B[1], A[1] ]..  
+000024e0: 2020 2020 2020 2020 2020 2020 2020 7a79                zy
+000024f0: 203d 205b 2043 5b31 5d2c 2042 5b31 5d20   = [ C[1], B[1] 
+00002500: 5d0d 0a20 2020 2020 2020 2020 2020 2065  ]..            e
+00002510: 6c73 653a 2020 2020 2020 2020 2020 2020  lse:            
+00002520: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
+00002530: 2020 2020 2078 7a20 3d20 6765 7456 6572       xz = getVer
+00002540: 7469 6365 734c 696e 6528 7265 7a2d 312c  ticesLine(rez-1,
+00002550: 2041 5b4a 5d2c 2043 5b4a 5d20 290d 0a20   A[J], C[J] ).. 
+00002560: 2020 2020 2020 2020 2020 2020 2020 2079                 y
+00002570: 7820 3d20 6765 7456 6572 7469 6365 734c  x = getVerticesL
+00002580: 696e 6528 7265 7a2d 312c 2042 5b4a 5d2c  ine(rez-1, B[J],
+00002590: 2041 5b4a 5d20 290d 0a20 2020 2020 2020   A[J] )..       
+000025a0: 2020 2020 2020 2020 207a 7920 3d20 6765           zy = ge
+000025b0: 7456 6572 7469 6365 734c 696e 6528 7265  tVerticesLine(re
+000025c0: 7a2d 312c 2043 5b4a 5d2c 2042 5b4a 5d20  z-1, C[J], B[J] 
+000025d0: 290d 0a20 2020 2020 2020 2020 2020 2023  )..            #
+000025e0: 2063 6f6e 7374 7275 6374 2074 6865 2034   construct the 4
+000025f0: 2073 7562 2074 7269 616e 676c 6573 2e2e   sub triangles..
+00002600: 2e0d 0a20 2020 2020 2020 2020 2020 2072  ...            r
+00002610: 6563 7572 735f 6661 6365 496e 6469 6365  ecurs_faceIndice
+00002620: 7328 415b 3a4b 5d2c 787a 2c43 5b4a 3a5d  s(A[:K],xz,C[J:]
+00002630: 2c72 657a 2d31 290d 0a20 2020 2020 2020  ,rez-1)..       
+00002640: 2020 2020 2072 6563 7572 735f 6661 6365       recurs_face
+00002650: 496e 6469 6365 7328 425b 3a4b 5d2c 7978  Indices(B[:K],yx
+00002660: 2c41 5b4a 3a5d 2c72 657a 2d31 290d 0a20  ,A[J:],rez-1).. 
+00002670: 2020 2020 2020 2020 2020 2072 6563 7572             recur
+00002680: 735f 6661 6365 496e 6469 6365 7328 435b  s_faceIndices(C[
+00002690: 3a4b 5d2c 7a79 2c42 5b4a 3a5d 2c72 657a  :K],zy,B[J:],rez
+000026a0: 2d31 290d 0a20 2020 2020 2020 2020 2020  -1)..           
+000026b0: 2072 6563 7572 735f 6661 6365 496e 6469   recurs_faceIndi
+000026c0: 6365 7328 7978 5b3a 3a2d 315d 2c7a 795b  ces(yx[::-1],zy[
+000026d0: 3a3a 2d31 5d2c 787a 5b3a 3a2d 315d 2c72  ::-1],xz[::-1],r
+000026e0: 657a 2d31 2c46 616c 7365 290d 0a20 2020  ez-1,False)..   
+000026f0: 2020 2020 2020 2020 2072 6574 7572 6e0d           return.
+00002700: 0a20 2020 2020 2020 2023 2e2e 2e2e 2e2e  .        #......
+00002710: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00002720: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e0d  ................
+00002730: 0a20 2020 2020 2020 2023 2067 656e 6572  .        # gener
+00002740: 6174 6520 7468 6520 6261 7365 2065 6467  ate the base edg
+00002750: 6520 696e 6469 6365 7320 666f 7220 6561  e indices for ea
+00002760: 6368 2066 6163 6520 0d0a 2020 2020 2020  ch face ..      
+00002770: 2020 6261 7365 4661 6365 4564 6765 496e    baseFaceEdgeIn
+00002780: 6469 6365 7320 3d20 5b5d 0d0a 2020 2020  dices = []..    
+00002790: 2020 2020 6564 6765 4172 7261 7949 6e64      edgeArrayInd
+000027a0: 6578 4d61 7472 6978 203d 205b 5b4e 6f6e  exMatrix = [[Non
+000027b0: 6520 666f 7220 7820 696e 2072 616e 6765  e for x in range
+000027c0: 286c 656e 2876 436f 6f72 2929 5d20 666f  (len(vCoor))] fo
+000027d0: 7220 7920 696e 2072 616e 6765 286c 656e  r y in range(len
+000027e0: 2876 436f 6f72 2929 5d20 2020 0d0a 2020  (vCoor))]   ..  
+000027f0: 2020 2020 2020 666f 7220 6661 6365 2069        for face i
+00002800: 6e20 6261 7365 4661 6365 5665 7274 6578  n baseFaceVertex
+00002810: 496e 6469 6365 7320 3a0d 0a20 2020 2020  Indices :..     
+00002820: 2020 2020 2020 2041 203d 205b 2066 6163         A = [ fac
+00002830: 655b 305d 2c66 6163 655b 315d 5d0d 0a20  e[0],face[1]].. 
+00002840: 2020 2020 2020 2020 2020 2042 203d 205b             B = [
+00002850: 2066 6163 655b 315d 2c66 6163 655b 325d   face[1],face[2]
+00002860: 5d0d 0a20 2020 2020 2020 2020 2020 2043  ]..            C
+00002870: 203d 205b 2066 6163 655b 325d 2c66 6163   = [ face[2],fac
+00002880: 655b 305d 5d0d 0a20 2020 2020 2020 2020  e[0]]..         
+00002890: 2020 2065 6467 6549 6e64 6963 6573 203d     edgeIndices =
+000028a0: 205b 412c 422c 435d 0d0a 2020 2020 2020   [A,B,C]..      
+000028b0: 2020 2020 2020 6261 7365 4661 6365 4564        baseFaceEd
+000028c0: 6765 496e 6469 6365 732e 6170 7065 6e64  geIndices.append
+000028d0: 2865 6467 6549 6e64 6963 6573 290d 0a20  (edgeIndices).. 
+000028e0: 2020 2020 2020 2020 2020 2066 6f72 2076             for v
+000028f0: 6572 7465 7849 6e64 6578 2069 6e20 6564  ertexIndex in ed
+00002900: 6765 496e 6469 6365 7320 3a0d 0a20 2020  geIndices :..   
+00002910: 2020 2020 2020 2020 2020 2020 2069 203d               i =
+00002920: 2076 6572 7465 7849 6e64 6578 5b30 5d0d   vertexIndex[0].
+00002930: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00002940: 206a 203d 2076 6572 7465 7849 6e64 6578   j = vertexIndex
+00002950: 5b31 5d0d 0a20 2020 2020 2020 2020 2020  [1]..           
+00002960: 2020 2020 2069 6620 6564 6765 4172 7261       if edgeArra
+00002970: 7949 6e64 6578 4d61 7472 6978 5b69 5d5b  yIndexMatrix[i][
+00002980: 6a5d 2069 7320 4e6f 6e65 3a0d 0a20 2020  j] is None:..   
+00002990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000029a0: 2065 6467 6541 7272 6179 496e 6465 784d   edgeArrayIndexM
+000029b0: 6174 7269 785b 695d 5b6a 5d20 3d20 6765  atrix[i][j] = ge
+000029c0: 7456 6572 7469 6365 734c 696e 6528 7265  tVerticesLine(re
+000029d0: 7a2c 2069 2c20 6a20 290d 0a20 2020 2020  z, i, j )..     
+000029e0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+000029f0: 6467 6541 7272 6179 496e 6465 784d 6174  dgeArrayIndexMat
+00002a00: 7269 785b 6a5d 5b69 5d20 3d20 6564 6765  rix[j][i] = edge
+00002a10: 4172 7261 7949 6e64 6578 4d61 7472 6978  ArrayIndexMatrix
+00002a20: 5b69 5d5b 6a5d 2e63 6f70 7928 295b 3a3a  [i][j].copy()[::
+00002a30: 2d31 5d0d 0a20 2020 2020 2020 2023 2074  -1]..        # t
+00002a40: 7269 616e 676c 756c 6174 6520 7468 6520  rianglulate the 
+00002a50: 6261 7365 2074 7269 616e 676c 6573 0d0a  base triangles..
+00002a60: 2020 2020 2020 2020 666f 7220 6661 6365          for face
+00002a70: 2069 6e20 6261 7365 4661 6365 4564 6765   in baseFaceEdge
+00002a80: 496e 6469 6365 7320 3a0d 0a20 2020 2020  Indices :..     
+00002a90: 2020 2020 2020 2041 203d 2065 6467 6541         A = edgeA
+00002aa0: 7272 6179 496e 6465 784d 6174 7269 785b  rrayIndexMatrix[
+00002ab0: 6661 6365 5b30 5d5b 305d 5d5b 6661 6365  face[0][0]][face
+00002ac0: 5b30 5d5b 315d 5d0d 0a20 2020 2020 2020  [0][1]]..       
+00002ad0: 2020 2020 2042 203d 2065 6467 6541 7272       B = edgeArr
+00002ae0: 6179 496e 6465 784d 6174 7269 785b 6661  ayIndexMatrix[fa
+00002af0: 6365 5b31 5d5b 305d 5d5b 6661 6365 5b31  ce[1][0]][face[1
+00002b00: 5d5b 315d 5d0d 0a20 2020 2020 2020 2020  ][1]]..         
+00002b10: 2020 2043 203d 2065 6467 6541 7272 6179     C = edgeArray
+00002b20: 496e 6465 784d 6174 7269 785b 6661 6365  IndexMatrix[face
+00002b30: 5b32 5d5b 305d 5d5b 6661 6365 5b32 5d5b  [2][0]][face[2][
+00002b40: 315d 5d0d 0a20 2020 2020 2020 2020 2020  1]]..           
+00002b50: 2078 203d 2028 7265 7a20 3e20 3029 0d0a   x = (rez > 0)..
+00002b60: 2020 2020 2020 2020 2020 2020 7265 6375              recu
+00002b70: 7273 5f66 6163 6549 6e64 6963 6573 2841  rs_faceIndices(A
+00002b80: 2c42 2c43 2c72 657a 2c20 7829 0d0a 2020  ,B,C,rez, x)..  
+00002b90: 2020 2020 2020 7665 7274 6578 436f 6f72        vertexCoor
+00002ba0: 203d 206e 702e 6172 7261 7928 7643 6f6f   = np.array(vCoo
+00002bb0: 7229 200d 0a20 2020 2020 2020 2069 6e64  r) ..        ind
+00002bc0: 6578 4f62 6a20 3d20 7b20 2766 6163 6527  exObj = { 'face'
+00002bd0: 3a20 6e70 2e61 7272 6179 2866 7649 6e64  : np.array(fvInd
+00002be0: 6963 6573 2920 2c20 2765 6467 6527 3a20  ices) , 'edge': 
+00002bf0: 6e70 2e61 7272 6179 2865 7649 6e64 6963  np.array(evIndic
+00002c00: 6573 2920 7d0d 0a20 2020 2020 2020 2072  es) }..        r
+00002c10: 6574 7572 6e20 696e 6465 784f 626a 202c  eturn indexObj ,
+00002c20: 7665 7274 6578 436f 6f72 0d0a 0d0a 2020  vertexCoor....  
+00002c30: 2020 4073 7461 7469 636d 6574 686f 640d    @staticmethod.
+00002c40: 0a20 2020 2064 6566 2072 6563 7461 6e67  .    def rectang
+00002c50: 756c 6174 6542 6173 6528 7265 7a2c 6261  ulateBase(rez,ba
+00002c60: 7365 5663 6f6f 722c 6261 7365 4661 6365  seVcoor,baseFace
+00002c70: 5665 7274 6578 496e 6469 6365 732c 206d  VertexIndices, m
+00002c80: 6964 5665 6374 4675 6e63 2920 3a0d 0a20  idVectFunc) :.. 
+00002c90: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
+00002ca0: 2020 2020 5265 6375 7273 6976 656c 7920      Recursively 
+00002cb0: 7375 6264 6976 6964 6520 7175 6164 7269  subdivide quadri
+00002cc0: 6c61 7465 7261 6c73 2e0d 0a0d 0a20 2020  laterals.....   
+00002cd0: 2020 2020 2045 6163 6820 7265 6375 7273       Each recurs
+00002ce0: 696f 6e20 7375 6264 6976 6964 6573 2065  ion subdivides e
+00002cf0: 6163 6820 7175 6164 7269 6c61 7465 7261  ach quadrilatera
+00002d00: 6c20 6279 2066 6f75 722e 0d0a 0d0a 2020  l by four.....  
+00002d10: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+00002d20: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
+00002d30: 2d2d 2d2d 0d0a 2020 2020 2020 2020 7265  ----..        re
+00002d40: 7a20 3a20 696e 7465 6765 722c 206f 7074  z : integer, opt
+00002d50: 696f 6e61 6c2c 2064 6566 6175 6c74 3a20  ional, default: 
+00002d60: 300d 0a20 2020 2020 2020 2020 2020 204e  0..            N
+00002d70: 756d 6265 7220 6f66 2072 6563 7572 7369  umber of recursi
+00002d80: 7665 2073 7562 6469 7669 7369 6f6e 7320  ve subdivisions 
+00002d90: 6f66 2074 6865 2072 6563 7461 6e67 6c65  of the rectangle
+00002da0: 2062 6173 6520 6661 6365 732e 0d0a 2020   base faces...  
+00002db0: 2020 2020 2020 2020 2020 5265 7a20 7661            Rez va
+00002dc0: 6c75 6573 2072 616e 6765 2066 726f 6d20  lues range from 
+00002dd0: 3020 746f 2037 2e0d 0a0d 0a20 2020 2020  0 to 7.....     
+00002de0: 2020 2062 6173 6556 636f 6f72 203a 2056     baseVcoor : V
+00002df0: 2078 2033 2066 6c6f 6174 2061 7272 6179   x 3 float array
+00002e00: 0d0a 2020 2020 2020 2020 2020 2020 416e  ..            An
+00002e10: 2061 7272 6179 206f 6620 2776 2720 6e75   array of 'v' nu
+00002e20: 6d62 6572 206f 6620 7879 7a20 7665 7274  mber of xyz vert
+00002e30: 6578 2063 6f6f 7264 696e 6174 6573 2e0d  ex coordinates..
+00002e40: 0a0d 0a20 2020 2020 2020 2062 6173 6546  ...        baseF
+00002e50: 6163 6556 6572 7465 7874 496e 6469 6365  aceVertextIndice
+00002e60: 7320 3a20 4620 7820 3420 696e 7420 6172  s : F x 4 int ar
+00002e70: 7261 790d 0a20 2020 2020 2020 2020 2020  ray..           
+00002e80: 2041 6e20 6172 7261 7920 6f66 2027 4627   An array of 'F'
+00002e90: 206e 756d 6265 7220 6f66 2066 6163 6520   number of face 
+00002ea0: 7665 7274 6578 2069 6e64 6963 6573 2e0d  vertex indices..
+00002eb0: 0a0d 0a20 2020 2020 2020 206d 6964 5665  ...        midVe
+00002ec0: 6374 4675 6e63 203a 2066 756e 6374 696f  ctFunc : functio
+00002ed0: 6e20 6f62 6a65 6374 0d0a 2020 2020 2020  n object..      
+00002ee0: 2020 2020 2020 4120 6675 6e63 7469 6f6e        A function
+00002ef0: 2074 6861 7420 7461 6b65 7320 7477 6f20   that takes two 
+00002f00: 7879 7a20 636f 6f72 6469 6e61 7465 2028  xyz coordinate (
+00002f10: 6c69 7374 206f 6620 3429 0d0a 2020 2020  list of 4)..    
+00002f20: 2020 2020 2020 2020 7265 7072 6573 656e          represen
+00002f30: 7469 6e67 2061 2073 7572 6661 6365 2066  ting a surface f
+00002f40: 6163 6520 6564 6765 2e20 2052 6574 7572  ace edge.  Retur
+00002f50: 6e73 206f 6e65 2078 797a 2063 6f6f 7264  ns one xyz coord
+00002f60: 696e 6174 650d 0a20 2020 2020 2020 2020  inate..         
+00002f70: 2020 2061 7420 7468 6520 6269 7365 6374     at the bisect
+00002f80: 696f 6e20 6f66 2074 6865 2065 6467 652c  ion of the edge,
+00002f90: 206d 6170 7065 6420 6f6e 2074 6865 2073   mapped on the s
+00002fa0: 7572 6661 6365 2e0d 0a0d 0a20 2020 2020  urface.....     
+00002fb0: 2020 2052 6574 7572 6e73 0d0a 2020 2020     Returns..    
+00002fc0: 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020      -------..   
+00002fd0: 2020 2020 2069 6e64 6578 4f62 6a20 3a20       indexObj : 
+00002fe0: 6120 6469 6374 696f 6e61 7279 206f 6620  a dictionary of 
+00002ff0: 7665 7274 6578 2069 6e64 6963 6573 2c20  vertex indices, 
+00003000: 666f 7220 6120 7375 7266 6163 650d 0a20  for a surface.. 
+00003010: 2020 2020 2020 2020 2020 206f 6620 4620             of F 
+00003020: 6661 6365 732c 2045 2065 6467 6573 2061  faces, E edges a
+00003030: 6e64 2056 2076 6572 7469 6365 732e 0d0a  nd V vertices...
+00003040: 2020 2020 2020 2020 2020 2020 2766 6163              'fac
+00003050: 6527 203a 2046 2078 2034 2069 6e74 2061  e' : F x 4 int a
+00003060: 7272 6179 0d0a 2020 2020 2020 2020 2020  rray..          
+00003070: 2020 2765 6467 6527 203a 2045 2078 2032    'edge' : E x 2
+00003080: 2069 6e74 2061 7272 6179 0d0a 0d0a 2020   int array....  
+00003090: 2020 2020 2020 7665 7274 436f 6f72 203a        vertCoor :
+000030a0: 2056 2078 2033 2066 6c6f 6174 2061 7272   V x 3 float arr
+000030b0: 6179 0d0a 2020 2020 2020 2020 2020 2020  ay..            
+000030c0: 416e 2061 7272 6179 206f 6620 5620 6e75  An array of V nu
+000030d0: 6d62 6572 206f 6620 7879 7a20 7665 7274  mber of xyz vert
+000030e0: 6578 2063 6f6f 7264 696e 6174 6573 2e0d  ex coordinates..
+000030f0: 0a0d 0a20 2020 2020 2020 2022 2222 0d0a  ...        """..
+00003100: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+00003110: 2020 7643 6f6f 7220 3d20 6261 7365 5663    vCoor = baseVc
+00003120: 6f6f 722e 636f 7079 2829 0d0a 2020 2020  oor.copy()..    
+00003130: 2020 2020 6676 496e 6469 6365 7320 3d20      fvIndices = 
+00003140: 5b5d 0d0a 2020 2020 2020 2020 6576 496e  []..        evIn
+00003150: 6469 6365 7320 3d20 5b5d 0d0a 2020 2020  dices = []..    
+00003160: 2020 2020 232e 2e2e 2e2e 2e2e 2e2e 2e2e      #...........
+00003170: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00003180: 2e2e 2e2e 2e2e 2e2e 2e2e 2020 2020 0d0a  ..........    ..
+00003190: 2020 2020 2020 2020 6465 6620 6765 7456          def getV
+000031a0: 6572 7469 6365 734c 696e 6528 6465 6772  erticesLine(degr
+000031b0: 6565 2c20 6c65 6674 496e 6465 782c 2072  ee, leftIndex, r
+000031c0: 6967 6874 496e 6465 7829 203a 0d0a 2020  ightIndex) :..  
+000031d0: 2020 2020 2020 2020 2020 6465 6620 7265            def re
+000031e0: 6375 7273 5f65 6467 6543 6f6f 7228 6465  curs_edgeCoor(de
+000031f0: 6772 6565 2c20 696e 6465 784f 7269 6769  gree, indexOrigi
+00003200: 6e2c 2069 7352 6967 6874 2c20 6c65 6674  n, isRight, left
+00003210: 496e 6465 782c 2072 6967 6874 496e 6465  Index, rightInde
+00003220: 782c 2045 696e 6465 7829 203a 0d0a 2020  x, Eindex) :..  
+00003230: 2020 2020 2020 2020 2020 2020 2020 6d20                m 
+00003240: 3d20 6465 6772 6565 202d 2031 0d0a 2020  = degree - 1..  
+00003250: 2020 2020 2020 2020 2020 2020 2020 6465                de
+00003260: 6c74 6120 3d20 696e 7428 6e70 2e70 6f77  lta = int(np.pow
+00003270: 6572 2832 2c6d 2929 0d0a 2020 2020 2020  er(2,m))..      
+00003280: 2020 2020 2020 2020 2020 6966 2069 7352            if isR
+00003290: 6967 6874 203a 2064 656c 7461 203d 202d  ight : delta = -
+000032a0: 6465 6c74 610d 0a20 2020 2020 2020 2020  delta..         
+000032b0: 2020 2020 2020 2069 203d 2069 6e64 6578         i = index
+000032c0: 4f72 6967 696e 202d 2064 656c 7461 0d0a  Origin - delta..
+000032d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000032e0: 6d69 645f 636f 6f72 203d 206d 6964 5665  mid_coor = midVe
+000032f0: 6374 4675 6e63 2820 7643 6f6f 725b 6c65  ctFunc( vCoor[le
+00003300: 6674 496e 6465 785d 2c20 7643 6f6f 725b  ftIndex], vCoor[
+00003310: 7269 6768 7449 6e64 6578 5d20 290d 0a20  rightIndex] ).. 
+00003320: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00003330: 7572 7265 6e74 436f 6f72 496e 6465 7820  urrentCoorIndex 
+00003340: 3d20 6c65 6e28 7643 6f6f 7229 0d0a 2020  = len(vCoor)..  
+00003350: 2020 2020 2020 2020 2020 2020 2020 7643                vC
+00003360: 6f6f 722e 6170 7065 6e64 286d 6964 5f63  oor.append(mid_c
+00003370: 6f6f 7229 0d0a 2020 2020 2020 2020 2020  oor)..          
+00003380: 2020 2020 2020 4569 6e64 6578 5b69 5d20        Eindex[i] 
+00003390: 3d20 6375 7272 656e 7443 6f6f 7249 6e64  = currentCoorInd
+000033a0: 6578 0d0a 2020 2020 2020 2020 2020 2020  ex..            
+000033b0: 2020 2020 6966 206d 203c 3d20 3020 3a0d      if m <= 0 :.
+000033c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000033d0: 2020 2020 2065 7649 6e64 6963 6573 2e61       evIndices.a
+000033e0: 7070 656e 6428 205b 6c65 6674 496e 6465  ppend( [leftInde
+000033f0: 782c 2063 7572 7265 6e74 436f 6f72 496e  x, currentCoorIn
+00003400: 6465 785d 2029 2020 2020 2020 2020 2020  dex] )          
+00003410: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+00003420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003430: 6576 496e 6469 6365 732e 6170 7065 6e64  evIndices.append
+00003440: 2820 5b63 7572 7265 6e74 436f 6f72 496e  ( [currentCoorIn
+00003450: 6465 782c 2072 6967 6874 496e 6465 785d  dex, rightIndex]
+00003460: 2029 2020 2020 2020 2020 2020 2020 2020   )              
+00003470: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00003480: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00003490: 726e 0d0a 2020 2020 2020 2020 2020 2020  rn..            
+000034a0: 2020 2020 7265 6375 7273 5f65 6467 6543      recurs_edgeC
+000034b0: 6f6f 7228 6d2c 692c 4661 6c73 652c 6c65  oor(m,i,False,le
+000034c0: 6674 496e 6465 782c 6375 7272 656e 7443  ftIndex,currentC
+000034d0: 6f6f 7249 6e64 6578 2c20 4569 6e64 6578  oorIndex, Eindex
+000034e0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+000034f0: 2020 2072 6563 7572 735f 6564 6765 436f     recurs_edgeCo
+00003500: 6f72 286d 2c69 2c54 7275 652c 6375 7272  or(m,i,True,curr
+00003510: 656e 7443 6f6f 7249 6e64 6578 2c72 6967  entCoorIndex,rig
+00003520: 6874 496e 6465 782c 2045 696e 6465 7829  htIndex, Eindex)
+00003530: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00003540: 2020 7265 7475 726e 0d0a 2020 2020 2020    return..      
+00003550: 2020 2020 2020 232e 2e2e 2e2e 2e2e 2e2e        #.........
+00003560: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00003570: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2020 2020  ............    
+00003580: 0d0a 2020 2020 2020 2020 2020 2020 694f  ..            iO
+00003590: 7269 6769 6e20 3d20 696e 7428 6e70 2e70  rigin = int(np.p
+000035a0: 6f77 6572 2832 2c64 6567 7265 6529 290d  ower(2,degree)).
+000035b0: 0a20 2020 2020 2020 2020 2020 2045 696e  .            Ein
+000035c0: 6465 7820 3d20 5b4e 6f6e 655d 2a28 694f  dex = [None]*(iO
+000035d0: 7269 6769 6e2b 3129 0d0a 2020 2020 2020  rigin+1)..      
+000035e0: 2020 2020 2020 4569 6e64 6578 5b30 5d20        Eindex[0] 
+000035f0: 3d20 6c65 6674 496e 6465 780d 0a20 2020  = leftIndex..   
+00003600: 2020 2020 2020 2020 2045 696e 6465 785b           Eindex[
+00003610: 694f 7269 6769 6e5d 203d 2072 6967 6874  iOrigin] = right
+00003620: 496e 6465 780d 0a20 2020 2020 2020 2020  Index..         
+00003630: 2020 2069 6620 6465 6772 6565 3d3d 3020     if degree==0 
+00003640: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00003650: 2020 2065 7649 6e64 6963 6573 2e61 7070     evIndices.app
+00003660: 656e 6428 205b 6c65 6674 496e 6465 782c  end( [leftIndex,
+00003670: 2072 6967 6874 496e 6465 785d 2029 0d0a   rightIndex] )..
+00003680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003690: 7265 7475 726e 2045 696e 6465 780d 0a20  return Eindex.. 
+000036a0: 2020 2020 2020 2020 2020 2072 6563 7572             recur
+000036b0: 735f 6564 6765 436f 6f72 2864 6567 7265  s_edgeCoor(degre
+000036c0: 652c 2069 4f72 6967 696e 2c20 4661 6c73  e, iOrigin, Fals
+000036d0: 652c 206c 6566 7449 6e64 6578 2c20 7269  e, leftIndex, ri
+000036e0: 6768 7449 6e64 6578 2c20 4569 6e64 6578  ghtIndex, Eindex
+000036f0: 290d 0a20 2020 2020 2020 2020 2020 2072  )..            r
+00003700: 6574 7572 6e20 4569 6e64 6578 0d0a 2020  eturn Eindex..  
+00003710: 2020 2020 2020 232e 2e2e 2e2e 2e2e 2e2e        #.........
+00003720: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00003730: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2020 2020  ............    
+00003740: 0d0a 2020 2020 2020 2020 6465 6620 7265  ..        def re
+00003750: 6375 7273 5f66 6163 6549 6e64 6963 6573  curs_faceIndices
+00003760: 2841 2c42 2c43 2c44 2c72 657a 293a 0d0a  (A,B,C,D,rez):..
+00003770: 2020 2020 2020 2020 2020 2020 2320 7369              # si
+00003780: 6d69 6c61 7220 746f 2069 6e6e 6572 2066  milar to inner f
+00003790: 756e 6374 696f 6e20 6f66 2074 7269 616e  unction of trian
+000037a0: 6775 6c61 7465 4261 7365 0d0a 2020 2020  gulateBase..    
+000037b0: 2020 2020 2020 2020 6966 2072 657a 3d3d          if rez==
+000037c0: 3020 3a0d 0a20 2020 2020 2020 2020 2020  0 :..           
+000037d0: 2020 2020 2061 6263 203d 205b 2041 5b30       abc = [ A[0
+000037e0: 5d2c 2042 5b30 5d2c 2043 5b30 5d2c 2044  ], B[0], C[0], D
+000037f0: 5b30 5d20 5d20 2020 2020 2020 2020 2020  [0] ]           
+00003800: 2020 2020 0d0a 2020 2020 2020 2020 2020      ..          
+00003810: 2020 2020 2020 6676 496e 6469 6365 732e        fvIndices.
+00003820: 6170 7065 6e64 2820 6162 6320 290d 0a20  append( abc ).. 
+00003830: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00003840: 6574 7572 6e0d 0a20 2020 2020 2020 2020  eturn..         
+00003850: 2020 2023 202d 2d2d 2d2d 2d2d 2d2d 2d2d     # -----------
+00003860: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00003870: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00003880: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
+00003890: 2020 2020 2020 2020 4a20 3d20 696e 7428          J = int(
+000038a0: 2028 6c65 6e28 4129 2d31 292f 3220 290d   (len(A)-1)/2 ).
+000038b0: 0a20 2020 2020 2020 2020 2020 204b 203d  .            K =
+000038c0: 204a 202b 2031 0d0a 2020 2020 2020 2020   J + 1..        
+000038d0: 2020 2020 2320 6d69 6470 6f69 6e74 2069      # midpoint i
+000038e0: 6e64 6963 6573 202e 2e2e 2e2e 2e2e 2e2e  ndices .........
+000038f0: 2e2e 2e2e 2e2e 0d0a 2020 2020 2020 2020  ........        
+00003900: 2020 2020 6d69 645f 636f 6f72 203d 206d      mid_coor = m
+00003910: 6964 5665 6374 4675 6e63 2820 7643 6f6f  idVectFunc( vCoo
+00003920: 725b 2044 5b4a 5d20 5d2c 2076 436f 6f72  r[ D[J] ], vCoor
+00003930: 5b20 425b 4a5d 205d 2029 0d0a 2020 2020  [ B[J] ] )..    
+00003940: 2020 2020 2020 2020 695f 4520 3d20 6c65          i_E = le
+00003950: 6e28 7643 6f6f 7229 0d0a 2020 2020 2020  n(vCoor)..      
+00003960: 2020 2020 2020 7643 6f6f 722e 6170 7065        vCoor.appe
+00003970: 6e64 286d 6964 5f63 6f6f 7229 0d0a 2020  nd(mid_coor)..  
+00003980: 2020 2020 2020 2020 2020 2320 6172 7261            # arra
+00003990: 7973 206f 6620 7468 6520 666f 7572 2069  ys of the four i
+000039a0: 6e6e 6572 2071 7561 6472 696c 6174 6572  nner quadrilater
+000039b0: 616c 7320 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  als ............
+000039c0: 2e2e 0d0a 2020 2020 2020 2020 2020 2020  ....            
+000039d0: 7045 203d 2067 6574 5665 7274 6963 6573  pE = getVertices
+000039e0: 4c69 6e65 2872 657a 2d31 2c20 415b 4a5d  Line(rez-1, A[J]
+000039f0: 2c20 695f 4520 290d 0a20 2020 2020 2020  , i_E )..       
+00003a00: 2020 2020 2071 4520 3d20 6765 7456 6572       qE = getVer
+00003a10: 7469 6365 734c 696e 6528 7265 7a2d 312c  ticesLine(rez-1,
+00003a20: 2042 5b4a 5d2c 2069 5f45 2029 0d0a 2020   B[J], i_E )..  
+00003a30: 2020 2020 2020 2020 2020 7245 203d 2067            rE = g
+00003a40: 6574 5665 7274 6963 6573 4c69 6e65 2872  etVerticesLine(r
+00003a50: 657a 2d31 2c20 435b 4a5d 2c20 695f 4520  ez-1, C[J], i_E 
+00003a60: 290d 0a20 2020 2020 2020 2020 2020 2073  )..            s
+00003a70: 4520 3d20 6765 7456 6572 7469 6365 734c  E = getVerticesL
+00003a80: 696e 6528 7265 7a2d 312c 2044 5b4a 5d2c  ine(rez-1, D[J],
+00003a90: 2069 5f45 2029 0d0a 2020 2020 2020 2020   i_E )..        
+00003aa0: 2020 2020 2320 7375 6469 7669 6465 2074      # sudivide t
+00003ab0: 6865 2066 6f75 7220 696e 6e65 7220 7175  he four inner qu
+00003ac0: 6164 7261 7465 7261 6c73 202e 2e2e 2e2e  adraterals .....
+00003ad0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 0d0a 2020  ..............  
+00003ae0: 2020 2020 2020 2020 2020 7265 6375 7273            recurs
+00003af0: 5f66 6163 6549 6e64 6963 6573 2820 415b  _faceIndices( A[
+00003b00: 3a4b 5d2c 2070 452c 2073 455b 3a3a 2d31  :K], pE, sE[::-1
+00003b10: 5d2c 2044 5b4a 3a5d 2c20 7265 7a2d 3129  ], D[J:], rez-1)
+00003b20: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
+00003b30: 6375 7273 5f66 6163 6549 6e64 6963 6573  curs_faceIndices
+00003b40: 2820 425b 3a4b 5d2c 2071 452c 2070 455b  ( B[:K], qE, pE[
+00003b50: 3a3a 2d31 5d2c 2041 5b4a 3a5d 2c20 7265  ::-1], A[J:], re
+00003b60: 7a2d 3129 0d0a 2020 2020 2020 2020 2020  z-1)..          
+00003b70: 2020 7265 6375 7273 5f66 6163 6549 6e64    recurs_faceInd
+00003b80: 6963 6573 2820 435b 3a4b 5d2c 2072 452c  ices( C[:K], rE,
+00003b90: 2071 455b 3a3a 2d31 5d2c 2042 5b4a 3a5d   qE[::-1], B[J:]
+00003ba0: 2c20 7265 7a2d 3129 0d0a 2020 2020 2020  , rez-1)..      
+00003bb0: 2020 2020 2020 7265 6375 7273 5f66 6163        recurs_fac
+00003bc0: 6549 6e64 6963 6573 2820 445b 3a4b 5d2c  eIndices( D[:K],
+00003bd0: 2073 452c 2072 455b 3a3a 2d31 5d2c 2043   sE, rE[::-1], C
+00003be0: 5b4a 3a5d 2c20 7265 7a2d 3129 0d0a 2020  [J:], rez-1)..  
+00003bf0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00003c00: 0d0a 2020 2020 2020 2020 232e 2e2e 2e2e  ..        #.....
+00003c10: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00003c20: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00003c30: 0d0a 0d0a 2020 2020 2020 2020 2320 6765  ....        # ge
+00003c40: 6e65 7261 7465 2074 6865 2062 6173 6520  nerate the base 
+00003c50: 6564 6765 2069 6e64 6963 6573 2066 6f72  edge indices for
+00003c60: 2065 6163 6820 6661 6365 200d 0a20 2020   each face ..   
+00003c70: 2020 2020 2062 6173 6546 6163 6545 6467       baseFaceEdg
+00003c80: 6549 6e64 6963 6573 203d 205b 5d0d 0a20  eIndices = [].. 
+00003c90: 2020 2020 2020 2065 6467 6541 7272 6179         edgeArray
+00003ca0: 496e 6465 784d 6174 7269 7820 3d20 5b5b  IndexMatrix = [[
+00003cb0: 4e6f 6e65 2066 6f72 2078 2069 6e20 7261  None for x in ra
+00003cc0: 6e67 6528 6c65 6e28 7643 6f6f 7229 295d  nge(len(vCoor))]
+00003cd0: 2066 6f72 2079 2069 6e20 7261 6e67 6528   for y in range(
+00003ce0: 6c65 6e28 7643 6f6f 7229 295d 2020 200d  len(vCoor))]   .
+00003cf0: 0a20 2020 2020 2020 2066 6f72 2066 6163  .        for fac
+00003d00: 6520 696e 2062 6173 6546 6163 6556 6572  e in baseFaceVer
+00003d10: 7465 7849 6e64 6963 6573 203a 0d0a 2020  texIndices :..  
+00003d20: 2020 2020 2020 2020 2020 4120 3d20 5b20            A = [ 
+00003d30: 6661 6365 5b30 5d2c 6661 6365 5b31 5d5d  face[0],face[1]]
+00003d40: 0d0a 2020 2020 2020 2020 2020 2020 4220  ..            B 
+00003d50: 3d20 5b20 6661 6365 5b31 5d2c 6661 6365  = [ face[1],face
+00003d60: 5b32 5d5d 0d0a 2020 2020 2020 2020 2020  [2]]..          
+00003d70: 2020 4320 3d20 5b20 6661 6365 5b32 5d2c    C = [ face[2],
+00003d80: 6661 6365 5b33 5d5d 0d0a 2020 2020 2020  face[3]]..      
+00003d90: 2020 2020 2020 4420 3d20 5b20 6661 6365        D = [ face
+00003da0: 5b33 5d2c 6661 6365 5b30 5d5d 0d0a 2020  [3],face[0]]..  
+00003db0: 2020 2020 2020 2020 2020 6564 6765 496e            edgeIn
+00003dc0: 6469 6365 7320 3d20 5b41 2c42 2c43 2c44  dices = [A,B,C,D
+00003dd0: 5d0d 0a20 2020 2020 2020 2020 2020 2062  ]..            b
+00003de0: 6173 6546 6163 6545 6467 6549 6e64 6963  aseFaceEdgeIndic
+00003df0: 6573 2e61 7070 656e 6428 6564 6765 496e  es.append(edgeIn
+00003e00: 6469 6365 7329 0d0a 2020 2020 2020 2020  dices)..        
+00003e10: 2020 2020 666f 7220 7665 7274 6578 496e      for vertexIn
+00003e20: 6465 7820 696e 2065 6467 6549 6e64 6963  dex in edgeIndic
+00003e30: 6573 203a 0d0a 2020 2020 2020 2020 2020  es :..          
+00003e40: 2020 2020 2020 6920 3d20 7665 7274 6578        i = vertex
+00003e50: 496e 6465 785b 305d 0d0a 2020 2020 2020  Index[0]..      
+00003e60: 2020 2020 2020 2020 2020 6a20 3d20 7665            j = ve
+00003e70: 7274 6578 496e 6465 785b 315d 0d0a 2020  rtexIndex[1]..  
+00003e80: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00003e90: 2065 6467 6541 7272 6179 496e 6465 784d   edgeArrayIndexM
+00003ea0: 6174 7269 785b 695d 5b6a 5d20 6973 204e  atrix[i][j] is N
+00003eb0: 6f6e 653a 0d0a 2020 2020 2020 2020 2020  one:..          
+00003ec0: 2020 2020 2020 2020 2020 6564 6765 4172            edgeAr
+00003ed0: 7261 7949 6e64 6578 4d61 7472 6978 5b69  rayIndexMatrix[i
+00003ee0: 5d5b 6a5d 203d 2067 6574 5665 7274 6963  ][j] = getVertic
+00003ef0: 6573 4c69 6e65 2872 657a 2c20 692c 206a  esLine(rez, i, j
+00003f00: 2029 0d0a 2020 2020 2020 2020 2020 2020   )..            
+00003f10: 2020 2020 2020 2020 6564 6765 4172 7261          edgeArra
+00003f20: 7949 6e64 6578 4d61 7472 6978 5b6a 5d5b  yIndexMatrix[j][
+00003f30: 695d 203d 2065 6467 6541 7272 6179 496e  i] = edgeArrayIn
+00003f40: 6465 784d 6174 7269 785b 695d 5b6a 5d2e  dexMatrix[i][j].
+00003f50: 636f 7079 2829 5b3a 3a2d 315d 0d0a 2020  copy()[::-1]..  
+00003f60: 2020 2020 2020 2320 7265 6374 616e 6775        # rectangu
+00003f70: 6c61 7465 2074 6865 2062 6173 6520 7175  late the base qu
+00003f80: 6164 7269 6c61 7465 7261 6c73 0d0a 2020  adrilaterals..  
+00003f90: 2020 2020 2020 666f 7220 6661 6365 2069        for face i
+00003fa0: 6e20 6261 7365 4661 6365 4564 6765 496e  n baseFaceEdgeIn
+00003fb0: 6469 6365 7320 3a0d 0a20 2020 2020 2020  dices :..       
+00003fc0: 2020 2020 2041 203d 2065 6467 6541 7272       A = edgeArr
+00003fd0: 6179 496e 6465 784d 6174 7269 785b 6661  ayIndexMatrix[fa
+00003fe0: 6365 5b30 5d5b 305d 5d5b 6661 6365 5b30  ce[0][0]][face[0
+00003ff0: 5d5b 315d 5d0d 0a20 2020 2020 2020 2020  ][1]]..         
+00004000: 2020 2042 203d 2065 6467 6541 7272 6179     B = edgeArray
+00004010: 496e 6465 784d 6174 7269 785b 6661 6365  IndexMatrix[face
+00004020: 5b31 5d5b 305d 5d5b 6661 6365 5b31 5d5b  [1][0]][face[1][
+00004030: 315d 5d0d 0a20 2020 2020 2020 2020 2020  1]]..           
+00004040: 2043 203d 2065 6467 6541 7272 6179 496e   C = edgeArrayIn
+00004050: 6465 784d 6174 7269 785b 6661 6365 5b32  dexMatrix[face[2
+00004060: 5d5b 305d 5d5b 6661 6365 5b32 5d5b 315d  ][0]][face[2][1]
+00004070: 5d0d 0a20 2020 2020 2020 2020 2020 2044  ]..            D
+00004080: 203d 2065 6467 6541 7272 6179 496e 6465   = edgeArrayInde
+00004090: 784d 6174 7269 785b 6661 6365 5b33 5d5b  xMatrix[face[3][
+000040a0: 305d 5d5b 6661 6365 5b33 5d5b 315d 5d0d  0]][face[3][1]].
+000040b0: 0a20 2020 2020 2020 2020 2020 2072 6563  .            rec
+000040c0: 7572 735f 6661 6365 496e 6469 6365 7328  urs_faceIndices(
+000040d0: 412c 422c 432c 442c 7265 7a29 0d0a 2020  A,B,C,D,rez)..  
+000040e0: 2020 2020 2020 7665 7274 6578 436f 6f72        vertexCoor
+000040f0: 203d 206e 702e 6172 7261 7928 7643 6f6f   = np.array(vCoo
+00004100: 7229 200d 0a20 2020 2020 2020 2069 6e64  r) ..        ind
+00004110: 6578 4f62 6a20 3d20 7b20 2766 6163 6527  exObj = { 'face'
+00004120: 3a20 6e70 2e61 7272 6179 2866 7649 6e64  : np.array(fvInd
+00004130: 6963 6573 2920 2c20 2765 6467 6527 3a20  ices) , 'edge': 
+00004140: 6e70 2e61 7272 6179 2865 7649 6e64 6963  np.array(evIndic
+00004150: 6573 2920 7d0d 0a20 2020 2020 2020 2072  es) }..        r
+00004160: 6574 7572 6e20 696e 6465 784f 626a 202c  eturn indexObj ,
+00004170: 7665 7274 6578 436f 6f72 0d0a 0d0a 2020  vertexCoor....  
+00004180: 2020 4073 7461 7469 636d 6574 686f 640d    @staticmethod.
+00004190: 0a20 2020 2064 6566 2063 6f6f 725f 636f  .    def coor_co
+000041a0: 6e76 6572 7428 7879 7a2c 2074 6f63 6172  nvert(xyz, tocar
+000041b0: 743d 4661 6c73 6529 203a 0d0a 2020 2020  t=False) :..    
+000041c0: 2020 2020 2222 2243 6f6f 7264 696e 6174      """Coordinat
+000041d0: 6520 7472 616e 7366 6f72 6d61 7469 6f6e  e transformation
+000041e0: 2e0d 0a20 2020 2020 2020 200d 0a20 2020  ...        ..   
+000041f0: 2020 2020 2020 2020 546f 2062 6520 6f76          To be ov
+00004200: 6572 7269 6464 6465 6e20 6279 2061 6e79  erriddden by any
+00004210: 2073 7562 636c 6173 7320 6e6f 7420 696e   subclass not in
+00004220: 2043 6172 7465 7369 616e 2063 6f6f 7264   Cartesian coord
+00004230: 696e 6174 6573 2e0d 0a20 2020 2020 2020  inates...       
+00004240: 2022 2222 0d0a 2020 2020 2020 2020 7879   """..        xy
+00004250: 7a20 3d20 6e70 2e61 7272 6179 2878 797a  z = np.array(xyz
+00004260: 290d 0a20 2020 2020 2020 2072 6574 7572  )..        retur
+00004270: 6e20 7879 7a0d 0a0d 0a20 2020 2040 7374  n xyz....    @st
+00004280: 6174 6963 6d65 7468 6f64 0d0a 2020 2020  aticmethod..    
+00004290: 6465 6620 5f69 6e74 6572 7072 6574 5f64  def _interpret_d
+000042a0: 6f6d 6169 6e28 646f 6d61 696e 2920 3a0d  omain(domain) :.
+000042b0: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
+000042c0: 2020 2020 2020 5072 6f63 6573 7320 646f        Process do
+000042d0: 6d61 696e 2061 7267 756d 656e 7420 666f  main argument fo
+000042e0: 7220 696d 706c 7375 7266 2061 6e64 2043  r implsurf and C
+000042f0: 7562 6963 5375 7266 6163 652e 646f 6d61  ubicSurface.doma
+00004300: 696e 2074 6f0d 0a20 2020 2020 2020 2074  in to..        t
+00004310: 6865 2064 6f6d 6169 6e20 666f 7220 782c  he domain for x,
+00004320: 792c 7a20 646f 6d61 696e 732e 0d0a 2020  y,z domains...  
+00004330: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
+00004340: 2020 2065 7272 436f 6465 203d 2030 0d0a     errCode = 0..
+00004350: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+00004360: 7461 6e63 6528 646f 6d61 696e 2c20 2869  tance(domain, (i
+00004370: 6e74 2c66 6c6f 6174 2929 203a 200d 0a20  nt,float)) : .. 
+00004380: 2020 2020 2020 2020 2020 2064 6674 446d             dftDm
+00004390: 203d 206e 702e 6172 7261 7928 205b 205b   = np.array( [ [
+000043a0: 2d64 6f6d 6169 6e2c 646f 6d61 696e 205d  -domain,domain ]
+000043b0: 2c20 5b2d 646f 6d61 696e 2c64 6f6d 6169  , [-domain,domai
+000043c0: 6e20 5d2c 205b 2d64 6f6d 6169 6e2c 646f  n ], [-domain,do
+000043d0: 6d61 696e 205d 205d 2029 0d0a 2020 2020  main ] ] )..    
+000043e0: 2020 2020 656c 7365 203a 0d0a 2020 2020      else :..    
+000043f0: 2020 2020 2020 2020 636f 7272 6563 7444          correctD
+00004400: 6f6d 6169 6e20 3d20 5472 7565 0d0a 2020  omain = True..  
+00004410: 2020 2020 2020 2020 2020 7472 7920 3a0d            try :.
+00004420: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00004430: 2020 2020 206e 7044 6d20 3d20 6e70 2e61       npDm = np.a
+00004440: 7272 6179 2864 6f6d 6169 6e2c 2064 7479  rray(domain, dty
+00004450: 7065 3d66 6c6f 6174 290d 0a20 2020 2020  pe=float)..     
+00004460: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00004470: 6844 6d20 3d20 6e70 446d 2e73 6861 7065  hDm = npDm.shape
+00004480: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00004490: 2020 2020 2020 6e62 446d 203d 206e 7044        nbDm = npD
+000044a0: 6d2e 6e64 696d 0d0a 2020 2020 2020 2020  m.ndim..        
+000044b0: 2020 2020 2020 2020 2020 2020 636f 7272              corr
+000044c0: 6563 7444 6f6d 6169 6e20 3d20 6e62 446d  ectDomain = nbDm
+000044d0: 3d3d 3120 6f72 206e 6244 6d3d 3d32 0d0a  ==1 or nbDm==2..
+000044e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000044f0: 2020 2020 6572 7243 6f64 6520 3d20 310d      errCode = 1.
+00004500: 0a20 2020 2020 2020 2020 2020 2065 7863  .            exc
+00004510: 6570 7420 3a0d 0a20 2020 2020 2020 2020  ept :..         
+00004520: 2020 2020 2020 2063 6f72 7265 6374 446f         correctDo
+00004530: 6d61 696e 203d 2046 616c 7365 0d0a 2020  main = False..  
+00004540: 2020 2020 2020 2020 2020 2020 2020 6572                er
+00004550: 7243 6f64 6520 3d20 320d 0a20 2020 2020  rCode = 2..     
+00004560: 2020 2020 2020 2069 6620 636f 7272 6563         if correc
+00004570: 7444 6f6d 6169 6e20 3a0d 0a20 2020 2020  tDomain :..     
+00004580: 2020 2020 2020 2020 2020 2069 6620 6e62             if nb
+00004590: 446d 203d 3d20 3120 3a20 0d0a 2020 2020  Dm == 1 : ..    
+000045a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000045b0: 6466 7444 6d20 3d20 6e70 2e61 7272 6179  dftDm = np.array
+000045c0: 2820 5b20 646f 6d61 696e 2c20 646f 6d61  ( [ domain, doma
+000045d0: 696e 2c20 646f 6d61 696e 5d20 290d 0a20  in, domain] ).. 
+000045e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000045f0: 2020 2063 6f72 7265 6374 446f 6d61 696e     correctDomain
+00004600: 203d 2073 6844 6d5b 305d 203d 3d20 320d   = shDm[0] == 2.
+00004610: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00004620: 2020 2020 2065 7272 436f 6465 3d33 0d0a       errCode=3..
+00004630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004640: 656c 6966 206e 6244 6d20 3d3d 2032 203a  elif nbDm == 2 :
+00004650: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+00004660: 2020 2020 2020 2064 6674 446d 203d 206e         dftDm = n
+00004670: 702e 6172 7261 7928 2064 6f6d 6169 6e20  p.array( domain 
+00004680: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00004690: 2020 2020 2020 2063 6f72 7265 6374 446f         correctDo
+000046a0: 6d61 696e 203d 2073 6844 6d5b 305d 3d3d  main = shDm[0]==
+000046b0: 3320 616e 6420 7368 446d 5b31 5d3d 3d32  3 and shDm[1]==2
+000046c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000046d0: 2020 2020 2020 6572 7243 6f64 653d 340d        errCode=4.
+000046e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000046f0: 2065 6c73 6520 3a0d 0a20 2020 2020 2020   else :..       
+00004700: 2020 2020 2020 2020 2020 2020 2063 6f72               cor
+00004710: 7265 6374 446f 6d61 696e 203d 2046 616c  rectDomain = Fal
+00004720: 7365 0d0a 2020 2020 2020 2020 2020 2020  se..            
+00004730: 2020 2020 2020 2020 6572 7243 6f64 653d          errCode=
+00004740: 350d 0a20 2020 2020 2020 2020 2020 2069  5..            i
+00004750: 6620 6e6f 7420 636f 7272 6563 7444 6f6d  f not correctDom
+00004760: 6169 6e20 3a0d 0a20 2020 2020 2020 2020  ain :..         
+00004770: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+00004780: 7565 4572 726f 7228 2249 6e63 6f72 7265  ueError("Incorre
+00004790: 6374 2064 6f6d 6169 6e20 6172 6775 6d65  ct domain argume
+000047a0: 6e74 2070 6173 7365 6420 746f 2069 6d70  nt passed to imp
+000047b0: 662e 222c 2065 7272 436f 6465 290d 0a20  f.", errCode).. 
+000047c0: 2020 2020 2020 2072 6574 7572 6e20 6466         return df
+000047d0: 7444 6d0d 0a0d 0a20 2020 2040 7374 6174  tDm....    @stat
+000047e0: 6963 6d65 7468 6f64 0d0a 2020 2020 6465  icmethod..    de
+000047f0: 6620 5f6d 6170 3344 746f 3244 7371 7561  f _map3Dto2Dsqua
+00004800: 7265 2878 797a 2920 3a0d 0a20 2020 2020  re(xyz) :..     
+00004810: 2020 2022 2222 204d 6170 2073 7572 6661     """ Map surfa
+00004820: 6365 2074 6f20 7265 6374 616e 6775 6c61  ce to rectangula
+00004830: 7220 756e 6974 2063 6f6f 7264 696e 6174  r unit coordinat
+00004840: 6573 2028 302c 3129 2e20 2222 220d 0a0d  es (0,1). """...
+00004850: 0a20 2020 2020 2020 2078 2c79 2c5f 203d  .        x,y,_ =
+00004860: 2078 797a 0d0a 2020 2020 2020 2020 6120   xyz..        a 
+00004870: 3d20 2878 2b31 292f 320d 0a20 2020 2020  = (x+1)/2..     
+00004880: 2020 2062 203d 2028 792b 3129 2f32 0d0a     b = (y+1)/2..
+00004890: 2020 2020 2020 2020 7265 7475 726e 205b          return [
+000048a0: 612c 625d 0d0a 0d0a 2020 2020 4073 7461  a,b]....    @sta
+000048b0: 7469 636d 6574 686f 640d 0a20 2020 2064  ticmethod..    d
+000048c0: 6566 205f 7366 6576 2872 657a 2c66 6576  ef _sfev(rez,fev
+000048d0: 4172 7261 7929 203a 0d0a 2020 2020 2020  Array) :..      
+000048e0: 2020 2222 2220 4361 6c63 756c 6174 6520    """ Calculate 
+000048f0: 6e75 6d62 6572 206f 6620 7375 7266 6163  number of surfac
+00004900: 6520 6661 6365 732c 2065 6467 6573 2c20  e faces, edges, 
+00004910: 7665 7274 6963 6573 2e20 2222 220d 0a20  vertices. """.. 
+00004920: 2020 2020 2020 2023 2076 6573 7469 6769         # vestigi
+00004930: 616c 0d0a 2020 2020 2020 2020 466f 2c20  al..        Fo, 
+00004940: 7068 692c 2056 7820 3d20 6665 7641 7272  phi, Vx = fevArr
+00004950: 6179 0d0a 2020 2020 2020 2020 6574 6120  ay..        eta 
+00004960: 3d20 6e70 2e70 6f77 6572 2832 2c72 657a  = np.power(2,rez
+00004970: 290d 0a20 2020 2020 2020 2046 203d 2065  )..        F = e
+00004980: 7461 2a65 7461 2a46 6f0d 0a20 2020 2020  ta*eta*Fo..     
+00004990: 2020 2045 203d 206e 702e 696e 7428 2033     E = np.int( 3
+000049a0: 2a46 2f32 202b 2065 7461 2a70 6869 2029  *F/2 + eta*phi )
+000049b0: 0d0a 2020 2020 2020 2020 5620 3d20 6e70  ..        V = np
+000049c0: 2e69 6e74 2820 462f 3220 2b20 6574 612a  .int( F/2 + eta*
+000049d0: 7068 6920 2b20 5678 2029 0d0a 2020 2020  phi + Vx )..    
+000049e0: 2020 2020 7265 7475 726e 205b 462c 452c      return [F,E,
+000049f0: 565d 0d0a 0d0a 2020 2020 4063 6c61 7373  V]....    @class
+00004a00: 6d65 7468 6f64 0d0a 2020 2020 6465 6620  method..    def 
+00004a10: 5f67 7269 645f 6661 6365 5f69 6e64 6963  _grid_face_indic
+00004a20: 6573 2863 6c73 2c55 2c20 562c 2069 7353  es(cls,U, V, isS
+00004a30: 706c 6974 3d46 616c 7365 2c20 6973 5472  plit=False, isTr
+00004a40: 6961 3d46 616c 7365 2920 3a0d 0a20 2020  ia=False) :..   
+00004a50: 2020 2020 2022 2222 206d 6574 686f 6420       """ method 
+00004a60: 6f6e 6c79 2063 616c 6c65 6420 6279 2074  only called by t
+00004a70: 6865 2063 6c61 7373 6d65 7468 6f64 205f  he classmethod _
+00004a80: 7371 7561 7265 5f6e 6574 206f 720d 0a20  square_net or.. 
+00004a90: 2020 2020 2020 2020 2020 2074 6865 2043             the C
+00004aa0: 796c 696e 6472 6963 616c 5375 7266 6163  ylindricalSurfac
+00004ab0: 6520 636c 6173 736d 6574 686f 6420 5f63  e classmethod _c
+00004ac0: 796c 5f76 6f6c 5f73 7175 6172 655f 6e65  yl_vol_square_ne
+00004ad0: 740d 0a20 2020 2020 2020 2022 2222 0d0a  t..        """..
+00004ae0: 2020 2020 2020 2020 6966 2069 7353 706c          if isSpl
+00004af0: 6974 203a 0d0a 2020 2020 2020 2020 2020  it :..          
+00004b00: 2020 7420 3d20 6e70 2e6c 696e 7370 6163    t = np.linspac
+00004b10: 6528 302c 562a 2855 2b31 292d 312c 562a  e(0,V*(U+1)-1,V*
+00004b20: 2855 2b31 292c 6474 7970 653d 696e 7420  (U+1),dtype=int 
+00004b30: 290d 0a20 2020 2020 2020 2020 2020 2074  )..            t
+00004b40: 7320 3d20 742e 7265 7368 6170 6528 2028  s = t.reshape( (
+00004b50: 562c 552b 3129 2029 0d0a 2020 2020 2020  V,U+1) )..      
+00004b60: 2020 2020 2020 6120 3d20 7473 5b3a 2c30        a = ts[:,0
+00004b70: 3a55 5d2e 666c 6174 7465 6e28 290d 0a20  :U].flatten().. 
+00004b80: 2020 2020 2020 2020 2020 2066 696e 6478             findx
+00004b90: 203d 206e 702e 6172 7261 7928 205b 2061   = np.array( [ a
+00004ba0: 2c20 612b 312c 2061 2b55 2b32 2c20 612b  , a+1, a+U+2, a+
+00004bb0: 552b 3120 5d20 290d 0a20 2020 2020 2020  U+1 ] )..       
+00004bc0: 2065 6c73 6520 3a20 2020 200d 0a20 2020   else :    ..   
+00004bd0: 2020 2020 2020 2020 2061 203d 206e 702e           a = np.
+00004be0: 6c69 6e73 7061 6365 2830 2c56 2a55 2d31  linspace(0,V*U-1
+00004bf0: 2c56 2a55 2c64 7479 7065 3d69 6e74 2029  ,V*U,dtype=int )
+00004c00: 0d0a 2020 2020 2020 2020 2020 2020 6273  ..            bs
+00004c10: 203d 2061 2e72 6573 6861 7065 2820 2856   = a.reshape( (V
+00004c20: 2c55 2920 292e 540d 0a20 2020 2020 2020  ,U) ).T..       
+00004c30: 2020 2020 206f 7264 6572 203d 206e 702e       order = np.
+00004c40: 6170 7065 6e64 286e 702e 6c69 6e73 7061  append(np.linspa
+00004c50: 6365 2831 2c55 2d31 2c55 2d31 2c64 7479  ce(1,U-1,U-1,dty
+00004c60: 7065 3d69 6e74 292c 3029 0d0a 2020 2020  pe=int),0)..    
+00004c70: 2020 2020 2020 2020 6220 3d20 6273 5b6f          b = bs[o
+00004c80: 7264 6572 5d2e 542e 666c 6174 7465 6e28  rder].T.flatten(
+00004c90: 290d 0a20 2020 2020 2020 2020 2020 2066  )..            f
+00004ca0: 696e 6478 203d 206e 702e 6172 7261 7928  indx = np.array(
+00004cb0: 205b 2061 2c20 622c 2062 2b55 2c20 612b   [ a, b, b+U, a+
+00004cc0: 5520 5d20 290d 0a20 2020 2020 2020 2069  U ] )..        i
+00004cd0: 6620 6973 5472 6961 203a 0d0a 2020 2020  f isTria :..    
+00004ce0: 2020 2020 2020 2020 612c 622c 632c 6420          a,b,c,d 
+00004cf0: 3d20 6669 6e64 780d 0a20 2020 2020 2020  = findx..       
+00004d00: 2020 2020 2066 696e 6478 203d 206e 702e       findx = np.
+00004d10: 636f 6e63 6174 656e 6174 6528 2028 205b  concatenate( ( [
+00004d20: 612c 622c 635d 2c5b 632c 642c 615d 2029  a,b,c],[c,d,a] )
+00004d30: 2c20 6178 6973 3d31 2020 2029 0d0a 2020  , axis=1   )..  
+00004d40: 2020 2020 2020 7265 7475 726e 2066 696e        return fin
+00004d50: 6478 2e54 0d0a 0d0a 2020 2020 4063 6c61  dx.T....    @cla
+00004d60: 7373 6d65 7468 6f64 0d0a 2020 2020 6465  ssmethod..    de
+00004d70: 6620 5f73 7175 6172 655f 6e65 7428 636c  f _square_net(cl
+00004d80: 732c 206e 756d 562c 206e 756d 552c 2062  s, numV, numU, b
+00004d90: 6173 6574 7970 652c 6d69 6e52 6164 2c20  asetype,minRad, 
+00004da0: 7370 6c69 7453 697a 652c 206e 616d 652c  splitSize, name,
+00004db0: 202a 2a6b 7761 7267 7329 203a 0d0a 2020   **kwargs) :..  
+00004dc0: 2020 2020 2020 2222 2220 6d65 7468 6f64        """ method
+00004dd0: 206f 6e6c 7920 6361 6c6c 6564 2062 7920   only called by 
+00004de0: 696e 6865 7269 7465 6420 636c 6173 7320  inherited class 
+00004df0: 636c 6173 736d 6574 686f 6473 2027 6772  classmethods 'gr
+00004e00: 6964 272e 2022 2222 0d0a 0d0a 2020 2020  id'. """....    
+00004e10: 2020 2020 6469 764c 696d 6974 7320 3d20      divLimits = 
+00004e20: 5b31 2c33 5d0d 0a20 2020 2020 2020 2069  [1,3]..        i
+00004e30: 6620 636c 732e 5f67 656f 6d54 7970 6520  f cls._geomType 
+00004e40: 6973 205f 434f 4f52 5359 535b 2758 595a  is _COORSYS['XYZ
+00004e50: 275d 2020 3a20 6469 764c 696d 6974 7320  ']  : divLimits 
+00004e60: 3d20 5b31 2c31 5d0d 0a20 2020 2020 2020  = [1,1]..       
+00004e70: 2069 6620 636c 732e 5f67 656f 6d54 7970   if cls._geomTyp
+00004e80: 6520 6973 205f 434f 4f52 5359 535b 2753  e is _COORSYS['S
+00004e90: 5048 4552 4943 414c 275d 203a 2064 6976  PHERICAL'] : div
+00004ea0: 4c69 6d69 7473 203d 205b 322c 335d 0d0a  Limits = [2,3]..
+00004eb0: 2020 2020 2020 2020 6966 206e 756d 5620          if numV 
+00004ec0: 3c20 6469 764c 696d 6974 735b 305d 203a  < divLimits[0] :
+00004ed0: 0d0a 2020 2020 2020 2020 2020 2020 7261  ..            ra
+00004ee0: 6973 6520 5661 6c75 6545 7272 6f72 2827  ise ValueError('
+00004ef0: 4772 6964 2064 6976 6973 696f 6e20 7b7d  Grid division {}
+00004f00: 206d 7573 7420 6265 2067 7265 6174 6572   must be greater
+00004f10: 206f 7220 6571 7561 6c20 746f 207b 7d27   or equal to {}'
+00004f20: 2e66 6f72 6d61 7428 7374 7228 6e75 6d56  .format(str(numV
+00004f30: 292c 6469 764c 696d 6974 735b 305d 2029  ),divLimits[0] )
+00004f40: 290d 0a20 2020 2020 2020 2069 6620 6e75  )..        if nu
+00004f50: 6d55 203c 2064 6976 4c69 6d69 7473 5b31  mU < divLimits[1
+00004f60: 5d20 3a0d 0a20 2020 2020 2020 2020 2020  ] :..           
+00004f70: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+00004f80: 7228 2747 7269 6420 6469 7669 7369 6f6e  r('Grid division
+00004f90: 207b 7d20 6d75 7374 2062 6520 6772 6561   {} must be grea
+00004fa0: 7465 7220 6f72 2065 7175 616c 2074 6f20  ter or equal to 
+00004fb0: 7b7d 272e 666f 726d 6174 2873 7472 286e  {}'.format(str(n
+00004fc0: 756d 5529 2c64 6976 4c69 6d69 7473 5b31  umU),divLimits[1
+00004fd0: 5d20 2929 0d0a 0d0a 2020 2020 2020 2020  ] ))....        
+00004fe0: 6966 2062 6173 6574 7970 6520 3d3d 204e  if basetype == N
+00004ff0: 6f6e 6520 3a20 6261 7365 7479 7065 203d  one : basetype =
+00005000: 2027 6427 0d0a 2020 2020 2020 2020 6966   'd'..        if
+00005010: 206d 696e 5261 6420 6973 204e 6f6e 6520   minRad is None 
+00005020: 3a20 6d69 6e52 6164 203d 205f 4d49 4e52  : minRad = _MINR
+00005030: 4144 0d0a 2020 2020 2020 2020 6966 2073  AD..        if s
+00005040: 706c 6974 5369 7a65 2069 7320 4e6f 6e65  plitSize is None
+00005050: 203a 2073 706c 6974 5369 7a65 203d 205f   : splitSize = _
+00005060: 5350 4c49 5453 495a 450d 0a0d 0a20 2020  SPLITSIZE....   
+00005070: 2020 2020 2062 6173 6574 7970 6520 3d20       basetype = 
+00005080: 6261 7365 7479 7065 2e6c 6f77 6572 2829  basetype.lower()
+00005090: 0d0a 2020 2020 2020 2020 6261 7365 6c69  ..        baseli
+000050a0: 7374 203d 205b 2764 272c 2773 272c 2771  st = ['d','s','q
+000050b0: 272c 2777 272c 2772 272c 2778 275d 0d0a  ','w','r','x']..
+000050c0: 2020 2020 2020 2020 6966 2062 6173 6574          if baset
+000050d0: 7970 6520 6e6f 7420 696e 2062 6173 656c  ype not in basel
+000050e0: 6973 7420 3a0d 0a20 2020 2020 2020 2020  ist :..         
+000050f0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+00005100: 726f 7228 2247 7269 6420 6261 7365 7479  ror("Grid basety
+00005110: 7065 2027 7b7d 2720 6973 206e 6f74 2072  pe '{}' is not r
+00005120: 6563 6f67 6e69 7a65 642e 2050 6f73 7369  ecognized. Possi
+00005130: 626c 6520 7661 6c75 6573 2061 7265 3a20  ble values are: 
+00005140: 7b7d 2e22 2e66 6f72 6d61 7428 6261 7365  {}.".format(base
+00005150: 7479 7065 2c6c 6973 7428 6261 7365 6c69  type,list(baseli
+00005160: 7374 2929 290d 0a0d 0a20 2020 2020 2020  st)))....       
+00005170: 2069 7353 706c 6974 203d 2028 6261 7365   isSplit = (base
+00005180: 7479 7065 203d 3d20 2773 2729 206f 7220  type == 's') or 
+00005190: 2862 6173 6574 7970 6520 3d3d 2027 7727  (basetype == 'w'
+000051a0: 2920 6f72 2028 6261 7365 7479 7065 203d  ) or (basetype =
+000051b0: 3d20 2778 2729 0d0a 2020 2020 2020 2020  = 'x')..        
+000051c0: 6e65 6564 7354 7269 6167 203d 206e 6f74  needsTriag = not
+000051d0: 2028 2028 6261 7365 7479 7065 203d 3d20   ( (basetype == 
+000051e0: 2772 2729 206f 7220 2862 6173 6574 7970  'r') or (basetyp
+000051f0: 6520 3d3d 2027 7827 2920 2029 0d0a 2020  e == 'x')  )..  
+00005200: 2020 2020 2020 6861 7343 656e 7465 7220        hasCenter 
+00005210: 3d20 2862 6173 6574 7970 6520 3d3d 2027  = (basetype == '
+00005220: 6427 2920 6f72 2028 6261 7365 7479 7065  d') or (basetype
+00005230: 203d 3d20 2773 2729 0d0a 2020 2020 2020   == 's')..      
+00005240: 2020 2320 6861 7343 656e 7465 7220 646f    # hasCenter do
+00005250: 6573 206e 6f74 2061 7070 6c79 2066 6f72  es not apply for
+00005260: 2063 796c 696e 6472 6963 616c 2067 7269   cylindrical gri
+00005270: 6473 206f 6620 7468 6973 2074 7970 652e  ds of this type.
+00005280: 0d0a 2020 2020 2020 2020 6966 2063 6c73  ..        if cls
+00005290: 2e5f 6765 6f6d 5479 7065 2069 7320 5f43  ._geomType is _C
+000052a0: 4f4f 5253 5953 5b27 4359 4c49 4e44 5249  OORSYS['CYLINDRI
+000052b0: 4341 4c27 5d20 3a20 6861 7343 656e 7465  CAL'] : hasCente
+000052c0: 723d 4661 6c73 650d 0a0d 0a20 2020 2020  r=False....     
+000052d0: 2020 2023 204e 6f74 653a 206e 756d 5820     # Note: numX 
+000052e0: 616e 6420 6e75 6d5f 5820 6172 6520 7468  and num_X are th
+000052f0: 6520 6e75 6d62 6572 206f 6620 6469 7669  e number of divi
+00005300: 7369 6f6e 7320 616e 6420 7468 6520 6e75  sions and the nu
+00005310: 6d62 6572 206f 6620 636f 6f72 2070 6f73  mber of coor pos
+00005320: 6974 696f 6e73 2e0d 0a20 2020 2020 2020  itions...       
+00005330: 2069 6620 636c 732e 5f67 656f 6d54 7970   if cls._geomTyp
+00005340: 6520 6973 205f 434f 4f52 5359 535b 2758  e is _COORSYS['X
+00005350: 595a 275d 2020 3a0d 0a20 2020 2020 2020  YZ']  :..       
+00005360: 2020 2020 2069 7353 706c 6974 203d 2054       isSplit = T
+00005370: 7275 650d 0a20 2020 2020 2020 2020 2020  rue..           
+00005380: 2068 6173 4365 6e74 6572 203d 2046 616c   hasCenter = Fal
+00005390: 7365 0d0a 2020 2020 2020 2020 2020 2020  se..            
+000053a0: 6e75 6d5f 552c 6d69 6e5f 552c 206d 6178  num_U,min_U, max
+000053b0: 5f55 203d 206e 756d 552b 312c 2d31 2e30  _U = numU+1,-1.0
+000053c0: 2c31 2e30 0d0a 2020 2020 2020 2020 2020  ,1.0..          
+000053d0: 2020 6e75 6d5f 5620 3d20 6e75 6d56 202b    num_V = numV +
+000053e0: 2031 0d0a 2020 2020 2020 2020 2020 2020   1..            
+000053f0: 636f 6f72 5f55 203d 206e 702e 6c69 6e73  coor_U = np.lins
+00005400: 7061 6365 286d 696e 5f55 2c6d 6178 5f55  pace(min_U,max_U
+00005410: 2c6e 756d 5f55 290d 0a20 2020 2020 2020  ,num_U)..       
+00005420: 2020 2020 2055 5f63 6f6f 7220 3d20 6e70       U_coor = np
+00005430: 2e74 696c 6528 636f 6f72 5f55 2c6e 756d  .tile(coor_U,num
+00005440: 5f56 290d 0a20 2020 2020 2020 2065 6c73  _V)..        els
+00005450: 6520 3a0d 0a20 2020 2020 2020 2020 2020  e :..           
+00005460: 2023 2054 2061 6e67 6c65 2072 616e 6765   # T angle range
+00005470: 732c 2075 7365 6420 666f 7220 6469 736b  s, used for disk
+00005480: 2c63 796c 696e 6465 7220 616e 6420 7370  ,cylinder and sp
+00005490: 6865 7265 2e2e 2e2e 2e0d 0a20 2020 2020  here.......     
+000054a0: 2020 2020 2020 206e 756d 5f55 203d 206e         num_U = n
+000054b0: 756d 552b 3120 6966 2069 7353 706c 6974  umU+1 if isSplit
+000054c0: 2065 6c73 6520 6e75 6d55 0d0a 2020 2020   else numU..    
+000054d0: 2020 2020 2020 2020 6966 2068 6173 4365          if hasCe
+000054e0: 6e74 6572 203a 0d0a 2020 2020 2020 2020  nter :..        
+000054f0: 2020 2020 2020 2020 6e75 6d5f 5620 3d20          num_V = 
+00005500: 6e75 6d56 2069 6620 636c 732e 5f67 656f  numV if cls._geo
+00005510: 6d54 7970 6520 6973 205f 434f 4f52 5359  mType is _COORSY
+00005520: 535b 2750 4f4c 4152 275d 2065 6c73 6520  S['POLAR'] else 
+00005530: 6e75 6d56 2d31 0d0a 2020 2020 2020 2020  numV-1..        
+00005540: 2020 2020 656c 7365 203a 0d0a 2020 2020      else :..    
+00005550: 2020 2020 2020 2020 2020 2020 6e75 6d5f              num_
+00005560: 5620 3d20 6e75 6d56 2b31 0d0a 2020 2020  V = numV+1..    
+00005570: 2020 2020 2020 2020 6d69 6e5f 5520 3d20          min_U = 
+00005580: 302e 300d 0a20 2020 2020 2020 2020 2020  0.0..           
+00005590: 206d 6178 5f55 203d 2028 312d 312f 6e75   max_U = (1-1/nu
+000055a0: 6d5f 5529 2a32 2a6e 702e 7069 0d0a 2020  m_U)*2*np.pi..  
+000055b0: 2020 2020 2020 2020 2020 6966 2069 7353            if isS
+000055c0: 706c 6974 203a 206d 6178 5f55 203d 2028  plit : max_U = (
+000055d0: 322d 7370 6c69 7453 697a 6529 2a6e 702e  2-splitSize)*np.
+000055e0: 7069 0d0a 2020 2020 2020 2020 2020 2020  pi..            
+000055f0: 636f 6f72 5f55 203d 206e 702e 6c69 6e73  coor_U = np.lins
+00005600: 7061 6365 286d 696e 5f55 2c6d 6178 5f55  pace(min_U,max_U
+00005610: 2c6e 756d 5f55 290d 0a20 2020 2020 2020  ,num_U)..       
+00005620: 2020 2020 2055 5f63 6f6f 7220 3d20 6e70       U_coor = np
+00005630: 2e74 696c 6528 636f 6f72 5f55 2c6e 756d  .tile(coor_U,num
+00005640: 5f56 290d 0a20 2020 2020 2020 2074 6f74  _V)..        tot
+00005650: 5665 7274 7320 3d20 6e75 6d5f 552a 6e75  Verts = num_U*nu
+00005660: 6d5f 560d 0a0d 0a20 2020 2020 2020 2069  m_V....        i
+00005670: 6620 636c 732e 5f67 656f 6d54 7970 6520  f cls._geomType 
+00005680: 6973 205f 434f 4f52 5359 535b 2758 595a  is _COORSYS['XYZ
+00005690: 275d 203a 0d0a 2020 2020 2020 2020 2020  '] :..          
+000056a0: 2020 7661 6c5f 5720 3d20 302e 3020 2023    val_W = 0.0  #
+000056b0: 207a 2069 7320 636f 6e73 7461 6e74 2061   z is constant a
+000056c0: 7420 302e 0d0a 2020 2020 2020 2020 2020  t 0...          
+000056d0: 2020 636f 6f72 5f56 203d 2020 6e70 2e6c    coor_V =  np.l
+000056e0: 696e 7370 6163 6528 2d31 2e30 2c31 2e30  inspace(-1.0,1.0
+000056f0: 2c6e 756d 5f56 290d 0a20 2020 2020 2020  ,num_V)..       
+00005700: 2020 2020 206f 7264 6572 5f61 6263 203d       order_abc =
+00005710: 206c 616d 6264 6120 752c 762c 7720 3a5b   lambda u,v,w :[
+00005720: 752c 762c 775d 0d0a 2020 2020 2020 2020  u,v,w]..        
+00005730: 6966 2063 6c73 2e5f 6765 6f6d 5479 7065  if cls._geomType
+00005740: 2069 7320 5f43 4f4f 5253 5953 5b27 504f   is _COORSYS['PO
+00005750: 4c41 5227 5d20 3a0d 0a20 2020 2020 2020  LAR'] :..       
+00005760: 2020 2020 2076 616c 5f57 203d 2030 2e30       val_W = 0.0
+00005770: 2020 2320 7a20 6973 2063 6f6e 7374 616e    # z is constan
+00005780: 7420 6174 2030 2e0d 0a20 2020 2020 2020  t at 0...       
+00005790: 2020 2020 2065 6e64 5f56 203d 2031 2f6e       end_V = 1/n
+000057a0: 756d 5620 6966 2068 6173 4365 6e74 6572  umV if hasCenter
+000057b0: 2065 6c73 6520 6d69 6e52 6164 0d0a 2020   else minRad..  
+000057c0: 2020 2020 2020 2020 2020 636f 6f72 5f56            coor_V
+000057d0: 203d 206e 702e 6c69 6e73 7061 6365 2831   = np.linspace(1
+000057e0: 2e30 2c65 6e64 5f56 2c6e 756d 5f56 290d  .0,end_V,num_V).
+000057f0: 0a20 2020 2020 2020 2020 2020 206f 7264  .            ord
+00005800: 6572 5f61 6263 203d 206c 616d 6264 6120  er_abc = lambda 
+00005810: 752c 762c 7720 3a20 5b76 2c75 2c77 5d0d  u,v,w : [v,u,w].
+00005820: 0a20 2020 2020 2020 2069 6620 636c 732e  .        if cls.
+00005830: 5f67 656f 6d54 7970 6520 6973 205f 434f  _geomType is _CO
+00005840: 4f52 5359 535b 2743 594c 494e 4452 4943  ORSYS['CYLINDRIC
+00005850: 414c 275d 203a 0d0a 2020 2020 2020 2020  AL'] :..        
+00005860: 2020 2020 7661 6c5f 5720 3d20 312e 3020      val_W = 1.0 
+00005870: 2023 2072 2069 7320 636f 6e73 7461 6e74   # r is constant
+00005880: 2061 7420 312e 0d0a 2020 2020 2020 2020   at 1...        
+00005890: 2020 2020 636f 6f72 5f56 203d 2020 6e70      coor_V =  np
+000058a0: 2e6c 696e 7370 6163 6528 2d31 2e30 2c31  .linspace(-1.0,1
+000058b0: 2e30 2c6e 756d 5f56 290d 0a20 2020 2020  .0,num_V)..     
+000058c0: 2020 2020 2020 206f 7264 6572 5f61 6263         order_abc
+000058d0: 203d 206c 616d 6264 6120 752c 762c 7720   = lambda u,v,w 
+000058e0: 3a20 5b77 2c75 2c76 5d0d 0a20 2020 2020  : [w,u,v]..     
+000058f0: 2020 2069 6620 636c 732e 5f67 656f 6d54     if cls._geomT
+00005900: 7970 6520 6973 205f 434f 4f52 5359 535b  ype is _COORSYS[
+00005910: 2753 5048 4552 4943 414c 275d 203a 0d0a  'SPHERICAL'] :..
+00005920: 2020 2020 2020 2020 2020 2020 7661 6c5f              val_
+00005930: 5720 3d20 312e 3020 2023 2072 2069 7320  W = 1.0  # r is 
+00005940: 636f 6e73 7461 6e74 2061 7420 312e 0d0a  constant at 1...
+00005950: 2020 2020 2020 2020 2020 2020 7374 5f61              st_a
+00005960: 6e67 6c65 203d 206e 702e 7069 2f6e 756d  ngle = np.pi/num
+00005970: 5620 6966 2068 6173 4365 6e74 6572 2065  V if hasCenter e
+00005980: 6c73 6520 6e70 2e61 7263 7369 6e28 6d69  lse np.arcsin(mi
+00005990: 6e52 6164 290d 0a20 2020 2020 2020 2020  nRad)..         
+000059a0: 2020 2073 7474 5f56 203d 206e 702e 7069     stt_V = np.pi
+000059b0: 202d 2073 745f 616e 676c 650d 0a20 2020   - st_angle..   
+000059c0: 2020 2020 2020 2020 2065 6e64 5f56 203d           end_V =
+000059d0: 2073 745f 616e 676c 650d 0a20 2020 2020   st_angle..     
+000059e0: 2020 2020 2020 2063 6f6f 725f 5620 3d20         coor_V = 
+000059f0: 206e 702e 6c69 6e73 7061 6365 2873 7474   np.linspace(stt
+00005a00: 5f56 2c65 6e64 5f56 2c6e 756d 5f56 290d  _V,end_V,num_V).
+00005a10: 0a20 2020 2020 2020 2020 2020 206f 7264  .            ord
+00005a20: 6572 5f61 6263 203d 206c 616d 6264 6120  er_abc = lambda 
+00005a30: 752c 762c 7720 3a20 5b77 2c75 2c76 5d0d  u,v,w : [w,u,v].
+00005a40: 0a0d 0a20 2020 2020 2020 2057 5f63 6f6f  ...        W_coo
+00005a50: 7220 3d20 6e70 2e74 696c 6528 7661 6c5f  r = np.tile(val_
+00005a60: 572c 746f 7456 6572 7473 290d 0a20 2020  W,totVerts)..   
+00005a70: 2020 2020 2056 5f63 6f6f 7220 3d20 6e70       V_coor = np
+00005a80: 2e74 696c 6528 636f 6f72 5f56 2c28 6e75  .tile(coor_V,(nu
+00005a90: 6d5f 552c 3129 290d 0a20 2020 2020 2020  m_U,1))..       
+00005aa0: 2056 5f63 6f6f 7220 3d20 6e70 2e72 6176   V_coor = np.rav
+00005ab0: 656c 2856 5f63 6f6f 722c 6f72 6465 723d  el(V_coor,order=
+00005ac0: 2746 2729 0d0a 0d0a 2020 2020 2020 2020  'F')....        
+00005ad0: 6162 6320 3d20 6f72 6465 725f 6162 6328  abc = order_abc(
+00005ae0: 555f 636f 6f72 2c56 5f63 6f6f 722c 575f  U_coor,V_coor,W_
+00005af0: 636f 6f72 290d 0a20 2020 2020 2020 2061  coor)..        a
+00005b00: 6263 203d 206e 702e 6172 7261 7928 6162  bc = np.array(ab
+00005b10: 6329 0d0a 2020 2020 2020 2020 7879 7a20  c)..        xyz 
+00005b20: 3d20 636c 732e 636f 6f72 5f63 6f6e 7665  = cls.coor_conve
+00005b30: 7274 2861 6263 2c54 7275 6529 0d0a 2020  rt(abc,True)..  
+00005b40: 2020 2020 2020 7665 7274 7320 3d20 6e70        verts = np
+00005b50: 2e61 7272 6179 2878 797a 292e 540d 0a20  .array(xyz).T.. 
+00005b60: 2020 2020 2020 206e 756d 5674 203d 206e         numVt = n
+00005b70: 756d 5f56 2d31 2069 6620 6861 7343 656e  um_V-1 if hasCen
+00005b80: 7465 7220 656c 7365 206e 756d 560d 0a20  ter else numV.. 
+00005b90: 2020 2020 2020 2066 6163 6549 6e64 6963         faceIndic
+00005ba0: 6573 203d 2063 6c73 2e5f 6772 6964 5f66  es = cls._grid_f
+00005bb0: 6163 655f 696e 6469 6365 7328 6e75 6d55  ace_indices(numU
+00005bc0: 2c6e 756d 5674 2c69 7353 706c 6974 2c6e  ,numVt,isSplit,n
+00005bd0: 6565 6473 5472 6961 6729 0d0a 0d0a 2020  eedsTriag)....  
+00005be0: 2020 2020 2020 6966 2068 6173 4365 6e74        if hasCent
+00005bf0: 6572 203a 0d0a 2020 2020 2020 2020 2020  er :..          
+00005c00: 2020 2320 6164 6420 746f 7020 7472 6961    # add top tria
+00005c10: 6e67 756c 6172 2066 6163 6573 2066 6f72  ngular faces for
+00005c20: 2070 6f6c 6172 2026 2073 7068 6572 6963   polar & spheric
+00005c30: 616c 2073 7572 6661 6365 7320 2e2e 2e0d  al surfaces ....
+00005c40: 0a20 2020 2020 2020 2020 2020 2074 6f70  .            top
+00005c50: 5665 7274 203d 206e 702e 6172 7261 7928  Vert = np.array(
+00005c60: 5b5b 302e 302c 302e 302c 7661 6c5f 575d  [[0.0,0.0,val_W]
+00005c70: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
+00005c80: 746f 7049 6e64 6578 203d 2074 6f74 5665  topIndex = totVe
+00005c90: 7274 730d 0a20 2020 2020 2020 2020 2020  rts..           
+00005ca0: 2073 7461 7274 496e 6465 7820 3d20 746f   startIndex = to
+00005cb0: 7049 6e64 6578 202d 206e 756d 5f55 0d0a  pIndex - num_U..
+00005cc0: 2020 2020 2020 2020 2020 2020 656e 6449              endI
+00005cd0: 6e64 6578 203d 2074 6f70 496e 6465 782d  ndex = topIndex-
+00005ce0: 3220 6966 2069 7353 706c 6974 2065 6c73  2 if isSplit els
+00005cf0: 6520 746f 7049 6e64 6578 2d31 0d0a 2020  e topIndex-1..  
+00005d00: 2020 2020 2020 2020 2020 6120 3d20 6e70            a = np
+00005d10: 2e6c 696e 7370 6163 6528 7374 6172 7449  .linspace(startI
+00005d20: 6e64 6578 2c65 6e64 496e 6465 782c 6e75  ndex,endIndex,nu
+00005d30: 6d55 2c64 7479 7065 3d69 6e74 290d 0a20  mU,dtype=int).. 
+00005d40: 2020 2020 2020 2020 2020 2062 203d 2061             b = a
+00005d50: 2b31 2069 6620 6973 5370 6c69 7420 656c  +1 if isSplit el
+00005d60: 7365 206e 702e 6170 7065 6e64 2820 615b  se np.append( a[
+00005d70: 313a 5d2c 205b 7374 6172 7449 6e64 6578  1:], [startIndex
+00005d80: 5d20 290d 0a20 2020 2020 2020 2020 2020  ] )..           
+00005d90: 2063 203d 206e 702e 6675 6c6c 286e 756d   c = np.full(num
+00005da0: 552c 746f 7049 6e64 6578 290d 0a20 2020  U,topIndex)..   
+00005db0: 2020 2020 2020 2020 2061 6263 203d 206e           abc = n
+00005dc0: 702e 6172 7261 7928 5b61 2c62 2c63 5d29  p.array([a,b,c])
+00005dd0: 2e54 0d0a 2020 2020 2020 2020 2020 2020  .T..            
+00005de0: 7665 7274 7320 3d20 6e70 2e61 7070 656e  verts = np.appen
+00005df0: 6428 7665 7274 732c 746f 7056 6572 742c  d(verts,topVert,
+00005e00: 2061 7869 733d 3029 0d0a 2020 2020 2020   axis=0)..      
+00005e10: 2020 2020 2020 6661 6365 496e 6469 6365        faceIndice
+00005e20: 7320 3d20 6e70 2e61 7070 656e 6428 6661  s = np.append(fa
+00005e30: 6365 496e 6469 6365 732c 6162 632c 2061  ceIndices,abc, a
+00005e40: 7869 733d 3029 0d0a 2020 2020 2020 2020  xis=0)..        
+00005e50: 2020 2020 6966 2063 6c73 2e5f 6765 6f6d      if cls._geom
+00005e60: 5479 7065 2069 7320 5f43 4f4f 5253 5953  Type is _COORSYS
+00005e70: 5b27 5350 4845 5249 4341 4c27 5d20 3a0d  ['SPHERICAL'] :.
+00005e80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00005e90: 2023 2061 6464 2062 6f74 746f 6d20 7472   # add bottom tr
+00005ea0: 6961 6e67 756c 6172 2066 6163 6573 2066  iangular faces f
+00005eb0: 6f72 2073 7068 6572 6963 616c 2073 7572  or spherical sur
+00005ec0: 6661 6365 7320 2e2e 2e0d 0a20 2020 2020  faces .....     
+00005ed0: 2020 2020 2020 2020 2020 2062 746d 5665             btmVe
+00005ee0: 7274 203d 206e 702e 6172 7261 7928 5b5b  rt = np.array([[
+00005ef0: 302e 302c 302e 302c 2d76 616c 5f57 5d5d  0.0,0.0,-val_W]]
+00005f00: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00005f10: 2020 2062 746d 496e 6465 7820 3d20 746f     btmIndex = to
+00005f20: 7456 6572 7473 2b31 0d0a 2020 2020 2020  tVerts+1..      
+00005f30: 2020 2020 2020 2020 2020 7374 6172 7449            startI
+00005f40: 6e64 6578 2c65 6e64 496e 6465 7820 3d20  ndex,endIndex = 
+00005f50: 302c 6e75 6d55 2d31 0d0a 2020 2020 2020  0,numU-1..      
+00005f60: 2020 2020 2020 2020 2020 6120 3d20 6e70            a = np
+00005f70: 2e6c 696e 7370 6163 6528 7374 6172 7449  .linspace(startI
+00005f80: 6e64 6578 2c65 6e64 496e 6465 782c 6e75  ndex,endIndex,nu
+00005f90: 6d55 2c64 7479 7065 3d69 6e74 290d 0a20  mU,dtype=int).. 
+00005fa0: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+00005fb0: 203d 2061 2b31 2069 6620 6973 5370 6c69   = a+1 if isSpli
+00005fc0: 7420 656c 7365 206e 702e 6170 7065 6e64  t else np.append
+00005fd0: 2820 615b 313a 5d2c 205b 7374 6172 7449  ( a[1:], [startI
+00005fe0: 6e64 6578 5d20 290d 0a20 2020 2020 2020  ndex] )..       
+00005ff0: 2020 2020 2020 2020 2063 203d 206e 702e           c = np.
+00006000: 6675 6c6c 286e 756d 552c 6274 6d49 6e64  full(numU,btmInd
+00006010: 6578 290d 0a20 2020 2020 2020 2020 2020  ex)..           
+00006020: 2020 2020 2062 6163 203d 206e 702e 6172       bac = np.ar
+00006030: 7261 7928 5b62 2c61 2c63 5d29 2e54 2020  ray([b,a,c]).T  
+00006040: 2320 6261 6320 696e 7374 6561 6420 666f  # bac instead fo
+00006050: 7220 6162 6320 666f 7220 6f75 7477 6172  r abc for outwar
+00006060: 6420 6e6f 726d 616c 732e 0d0a 2020 2020  d normals...    
+00006070: 2020 2020 2020 2020 2020 2020 7665 7274              vert
+00006080: 7320 3d20 6e70 2e61 7070 656e 6428 7665  s = np.append(ve
+00006090: 7274 732c 6274 6d56 6572 742c 2061 7869  rts,btmVert, axi
+000060a0: 733d 3029 0d0a 2020 2020 2020 2020 2020  s=0)..          
+000060b0: 2020 2020 2020 6661 6365 496e 6469 6365        faceIndice
+000060c0: 7320 3d20 6e70 2e61 7070 656e 6428 6661  s = np.append(fa
+000060d0: 6365 496e 6469 6365 732c 6261 632c 2061  ceIndices,bac, a
+000060e0: 7869 733d 3029 0d0a 0d0a 2020 2020 2020  xis=0)....      
+000060f0: 2020 7375 7266 6163 6520 3d20 636c 7328    surface = cls(
+00006100: 2a2a 6b77 6172 6773 2920 2023 2073 6574  **kwargs)  # set
+00006110: 2074 6f20 7468 6520 636c 6173 7320 6465   to the class de
+00006120: 6661 756c 7420 6f62 6a65 6374 0d0a 2020  fault object..  
+00006130: 2020 2020 2020 2320 7265 7365 7420 7665        # reset ve
+00006140: 7274 732c 2066 6163 6549 6e64 6963 6573  rts, faceIndices
+00006150: 2061 6e64 2065 6467 6573 2028 7265 7461   and edges (reta
+00006160: 696e 2063 6c61 7373 2063 6f6f 7264 696e  in class coordin
+00006170: 6174 6520 7379 7374 656d 292e 0d0a 2020  ate system)...  
+00006180: 2020 2020 2020 7375 7266 6163 652e 7665        surface.ve
+00006190: 7274 6578 436f 6f72 203d 2076 6572 7473  rtexCoor = verts
+000061a0: 0d0a 2020 2020 2020 2020 7375 7266 6163  ..        surfac
+000061b0: 652e 6676 496e 6469 6365 7320 3d20 6661  e.fvIndices = fa
+000061c0: 6365 496e 6469 6365 730d 0a20 2020 2020  ceIndices..     
+000061d0: 2020 2073 7572 6661 6365 2e65 7649 6e64     surface.evInd
+000061e0: 6963 6573 203d 2073 7572 6661 6365 2e5f  ices = surface._
+000061f0: 6765 745f 6564 6765 735f 6672 6f6d 5f66  get_edges_from_f
+00006200: 6163 6573 2866 6163 6549 6e64 6963 6573  aces(faceIndices
+00006210: 290d 0a20 2020 2020 2020 2073 7572 6661  )..        surfa
+00006220: 6365 2e76 6649 6e64 6963 6573 4c69 7374  ce.vfIndicesList
+00006230: 203d 2073 7572 6661 6365 2e5f 7665 7274   = surface._vert
+00006240: 6578 436f 6d6d 6f6e 4661 6365 496e 6469  exCommonFaceIndi
+00006250: 6365 7328 290d 0a20 2020 2020 2020 2073  ces()..        s
+00006260: 7572 6661 6365 2e65 6649 6e64 6963 6573  urface.efIndices
+00006270: 4c69 7374 203d 2073 7572 6661 6365 2e5f  List = surface._
+00006280: 6564 6765 436f 6d6d 6f6e 4661 6365 496e  edgeCommonFaceIn
+00006290: 6469 6365 7328 290d 0a20 2020 2020 2020  dices()..       
+000062a0: 2073 7572 6661 6365 2e73 6574 5f76 6572   surface.set_ver
+000062b0: 7473 2820 7665 7274 735b 6661 6365 496e  ts( verts[faceIn
+000062c0: 6469 6365 735d 2029 0d0a 2020 2020 2020  dices] )..      
+000062d0: 2020 7375 7266 6163 652e 5f73 6574 5f67    surface._set_g
+000062e0: 656f 6d65 7472 6963 5f62 6f75 6e64 7328  eometric_bounds(
+000062f0: 290d 0a20 2020 2020 2020 2073 7572 6661  )..        surfa
+00006300: 6365 2e6e 616d 6520 3d20 6e61 6d65 0d0a  ce.name = name..
+00006310: 2020 2020 2020 2020 7375 7266 6163 652e          surface.
+00006320: 5f62 6173 6574 7970 6520 3d20 2767 7269  _basetype = 'gri
+00006330: 645f 272b 6261 7365 7479 7065 0d0a 2020  d_'+basetype..  
+00006340: 2020 2020 2020 7265 7475 726e 2073 7572        return sur
+00006350: 6661 6365 0d0a 0d0a 2020 2020 4063 6c61  face....    @cla
+00006360: 7373 6d65 7468 6f64 0d0a 2020 2020 6465  ssmethod..    de
+00006370: 6620 5f66 6576 2863 6c73 2c72 657a 2c62  f _fev(cls,rez,b
+00006380: 6173 6574 7970 652c 6465 7263 6c73 2920  asetype,dercls) 
+00006390: 3a0d 0a20 2020 2020 2020 2022 2222 2053  :..        """ S
+000063a0: 6574 7320 7570 205f 7366 6576 206d 6574  ets up _sfev met
+000063b0: 686f 642c 2062 6173 6564 206f 6e20 6361  hod, based on ca
+000063c0: 6c6c 7320 6672 6f6d 2074 6865 2073 7562  lls from the sub
+000063d0: 636c 6173 7320 6465 7263 6c73 2e20 2222  class dercls. ""
+000063e0: 220d 0a20 2020 2020 2020 2023 2076 6573  "..        # ves
+000063f0: 7469 6769 616c 0d0a 2020 2020 2020 2020  tigial..        
+00006400: 6966 2028 7265 7a3c 3029 206f 7220 2872  if (rez<0) or (r
+00006410: 657a 3e5f 4d41 5852 455a 2920 3a0d 0a20  ez>_MAXREZ) :.. 
+00006420: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00006430: 2056 616c 7565 4572 726f 7228 2749 6e63   ValueError('Inc
+00006440: 6f72 7265 7374 2072 657a 206f 6620 7b7d  orrest rez of {}
+00006450: 2c20 6d75 7374 2062 6520 616e 2069 6e74  , must be an int
+00006460: 2c20 3020 3c3d 2072 657a 203c 3d20 7b7d  , 0 <= rez <= {}
+00006470: 272e 666f 726d 6174 2872 657a 2c5f 4d41  '.format(rez,_MA
+00006480: 5852 455a 2929 0d0a 2020 2020 2020 2020  XREZ))..        
+00006490: 6966 2062 6173 6574 7970 6520 6973 204e  if basetype is N
+000064a0: 6f6e 653a 2062 6173 6574 7970 6520 3d20  one: basetype = 
+000064b0: 6465 7263 6c73 2e5f 6465 6661 756c 745f  dercls._default_
+000064c0: 6261 7365 0d0a 2020 2020 2020 2020 6261  base..        ba
+000064d0: 7365 7375 7266 203d 2064 6572 636c 732e  sesurf = dercls.
+000064e0: 5f62 6173 655f 7375 7266 6163 6573 0d0a  _base_surfaces..
+000064f0: 2020 2020 2020 2020 6966 2062 6173 6574          if baset
+00006500: 7970 6520 6e6f 7420 696e 2062 6173 6573  ype not in bases
+00006510: 7572 6620 3a0d 0a20 2020 2020 2020 2020  urf :..         
+00006520: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+00006530: 726f 7228 2742 6173 6574 7970 6520 7b7d  ror('Basetype {}
+00006540: 2069 7320 6e6f 7420 7265 636f 676e 697a   is not recogniz
+00006550: 6564 2e20 506f 7373 6962 6c65 2076 616c  ed. Possible val
+00006560: 7565 7320 6172 653a 207b 7d27 2e66 6f72  ues are: {}'.for
+00006570: 6d61 7428 6261 7365 7479 7065 2c6c 6973  mat(basetype,lis
+00006580: 7428 6261 7365 7375 7266 2929 290d 0a20  t(basesurf))).. 
+00006590: 2020 2020 2020 2072 6574 7572 6e20 636c         return cl
+000065a0: 732e 5f73 6665 7628 7265 7a2c 2062 6173  s._sfev(rez, bas
+000065b0: 6573 7572 665b 6261 7365 7479 7065 5d5b  esurf[basetype][
+000065c0: 2766 6576 5061 7261 6d27 5d20 290d 0a0d  'fevParam'] )...
+000065d0: 0a20 2020 2040 636c 6173 736d 6574 686f  .    @classmetho
+000065e0: 640d 0a20 2020 2064 6566 205f 7576 775f  d..    def _uvw_
+000065f0: 746f 5f78 797a 2863 6c73 2c72 7374 2c61  to_xyz(cls,rst,a
+00006600: 6263 2920 3a0d 0a20 2020 2020 2020 2022  bc) :..        "
+00006610: 2222 2052 6f74 6174 696f 6e61 6c20 7472  "" Rotational tr
+00006620: 616e 7366 6f72 6d61 7469 6f6e 2061 7420  ansformation at 
+00006630: 6120 636f 6f72 6469 6e61 7465 2e0d 0a20  a coordinate... 
+00006640: 2020 2020 2020 2020 2020 2054 6f20 6265             To be
+00006650: 206f 7665 7272 6964 6465 6e20 6279 2061   overridden by a
+00006660: 6e79 2073 7562 636c 6173 7320 6e6f 7420  ny subclass not 
+00006670: 696e 2043 6172 7465 7369 616e 2063 6f6f  in Cartesian coo
+00006680: 7264 696e 6174 6573 2e0d 0a20 2020 2020  rdinates...     
+00006690: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
+000066a0: 7265 7475 726e 206e 702e 7472 616e 7370  return np.transp
+000066b0: 6f73 6528 7273 7429 0d0a 0d0a 2020 2020  ose(rst)....    
+000066c0: 4063 6c61 7373 6d65 7468 6f64 0d0a 2020  @classmethod..  
+000066d0: 2020 6465 6620 5f64 6973 705f 746f 5f78    def _disp_to_x
+000066e0: 797a 2820 636c 732c 2075 7677 2c20 7468  yz( cls, uvw, th
+000066f0: 6574 613d 4e6f 6e65 2c20 7068 693d 4e6f  eta=None, phi=No
+00006700: 6e65 2920 3a0d 0a20 2020 2020 2020 2022  ne) :..        "
+00006710: 2222 2052 6f74 6174 696f 6e61 6c20 7472  "" Rotational tr
+00006720: 616e 7366 6f72 6d61 7469 6f6e 2066 726f  ansformation fro
+00006730: 6d20 726f 7461 7469 6f6e 2061 6e67 6c65  m rotation angle
+00006740: 732e 2022 2222 0d0a 0d0a 2020 2020 2020  s. """....      
+00006750: 2020 6966 2074 6865 7461 2069 7320 4e6f    if theta is No
+00006760: 6e65 203a 2072 6574 7572 6e20 7576 770d  ne : return uvw.
+00006770: 0a20 2020 2020 2020 2023 2065 6163 6820  .        # each 
+00006780: 7365 7420 6f66 2075 7677 2068 6173 2061  set of uvw has a
+00006790: 2064 6966 6665 7265 6e74 2072 6f74 6174   different rotat
+000067a0: 696f 6e20 6d61 7472 6978 0d0a 2020 2020  ion matrix..    
+000067b0: 2020 2020 2320 7468 6174 206d 7573 7420      # that must 
+000067c0: 6265 2065 7661 6c75 6174 6564 206f 6e65  be evaluated one
+000067d0: 2061 7420 6120 7469 6d65 2e20 4d52 4f49   at a time. MROI
+000067e0: 0d0a 2020 2020 2020 2020 6966 2070 6869  ..        if phi
+000067f0: 2069 7320 4e6f 6e65 203a 2070 6869 203d   is None : phi =
+00006800: 206e 702e 7a65 726f 7328 206c 656e 2874   np.zeros( len(t
+00006810: 6865 7461 2920 290d 0a20 2020 2020 2020  heta) )..       
+00006820: 2075 7677 5420 3d20 6e70 2e74 7261 6e73   uvwT = np.trans
+00006830: 706f 7365 2875 7677 290d 0a20 2020 2020  pose(uvw)..     
+00006840: 2020 2064 6973 7056 6563 7420 3d20 5b5d     dispVect = []
+00006850: 0d0a 2020 2020 2020 2020 666f 7220 6920  ..        for i 
+00006860: 696e 2072 616e 6765 286c 656e 2874 6865  in range(len(the
+00006870: 7461 2929 203a 0d0a 2020 2020 2020 2020  ta)) :..        
+00006880: 2020 2020 726f 744d 7820 3d20 6575 6c65      rotMx = eule
+00006890: 7252 6f74 2874 6865 7461 5b69 5d2c 7068  rRot(theta[i],ph
+000068a0: 695b 695d 2c20 696e 7261 643d 5472 7565  i[i], inrad=True
+000068b0: 290d 0a20 2020 2020 2020 2020 2020 2076  )..            v
+000068c0: 6563 203d 206e 702e 646f 7428 2075 7677  ec = np.dot( uvw
+000068d0: 545b 695d 2c20 726f 744d 7820 290d 0a20  T[i], rotMx ).. 
+000068e0: 2020 2020 2020 2020 2020 2064 6973 7056             dispV
+000068f0: 6563 742e 6170 7065 6e64 2876 6563 290d  ect.append(vec).
+00006900: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00006910: 6469 7370 5665 6374 0d0a 0d0a 2020 2020  dispVect....    
+00006920: 6465 6620 5f70 6f73 7450 726f 635f 7375  def _postProc_su
+00006930: 7266 6163 6543 6f6c 6f72 7328 7365 6c66  rfaceColors(self
+00006940: 2c6f 6e6c 7946 6163 6573 3d46 616c 7365  ,onlyFaces=False
+00006950: 2920 3a0d 0a20 2020 2020 2020 2022 2222  ) :..        """
+00006960: 204d 6174 706c 6f74 6c69 6220 7769 6c6c   Matplotlib will
+00006970: 2027 6669 6c6c 696e 2720 636f 6c6f 7273   'fillin' colors
+00006980: 2064 7572 696e 6720 7265 6e64 6572 696e   during renderin
+00006990: 6720 7573 696e 6720 7468 650d 0a20 2020  g using the..   
+000069a0: 2020 2020 2020 2020 2066 6163 6563 6f6c           facecol
+000069b0: 6f72 2061 7272 6179 2e20 2874 6869 7320  or array. (this 
+000069c0: 6973 204e 4f54 2074 6865 2061 7373 6967  is NOT the assig
+000069d0: 6e65 6420 636f 6c6f 7220 746f 2066 6163  ned color to fac
+000069e0: 6573 292e 0d0a 2020 2020 2020 2020 2020  es)...          
+000069f0: 2020 486f 7765 7665 722c 2053 3344 6c69    However, S3Dli
+00006a00: 6220 7769 6c6c 2075 7365 2074 6865 2069  b will use the i
+00006a10: 6e68 6572 6974 6564 205f 6661 6365 636f  nherited _faceco
+00006a20: 6c6f 7273 200d 0a20 2020 2020 2020 2020  lors ..         
+00006a30: 2020 2066 6f72 2074 6865 2061 7373 6967     for the assig
+00006a40: 6e65 6420 6661 6365 2063 6f6c 6f72 732e  ned face colors.
+00006a50: 0d0a 2020 2020 2020 2020 2020 2020 5768  ..            Wh
+00006a60: 656e 6576 6572 2063 6f6c 6f72 2069 7320  enever color is 
+00006a70: 2765 7874 6572 6e61 6c6c 7927 2061 7373  'externally' ass
+00006a80: 6967 6e65 6420 6f72 2072 6561 7373 6967  igned or reassig
+00006a90: 6e65 642c 0d0a 2020 2020 2020 2020 2020  ned,..          
+00006aa0: 2020 6e65 6564 2074 6f20 6469 7265 6374    need to direct
+00006ab0: 6c79 2061 7373 6967 6e20 636f 6c6f 7273  ly assign colors
+00006ac0: 2066 6f72 2065 6163 6820 6661 6365 2066   for each face f
+00006ad0: 6f72 2061 6e79 0d0a 2020 2020 2020 2020  or any..        
+00006ae0: 2020 2020 6d65 7468 6f64 2074 6861 7420      method that 
+00006af0: 7573 6573 2066 6163 6563 6f6c 6f72 732e  uses facecolors.
+00006b00: 2020 5468 6973 206f 6363 7572 7320 696e    This occurs in
+00006b10: 6974 6961 6c6c 790d 0a20 2020 2020 2020  itially..       
+00006b20: 2020 2020 2069 6e20 7468 6520 6d65 7468       in the meth
+00006b30: 6f64 2062 6566 6f72 6520 636f 6c6f 7273  od before colors
+00006b40: 2061 7265 2061 7373 6967 6e65 6420 2020   are assigned   
+00006b50: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
+00006b60: 2020 2020 2020 2028 7365 745f 636f 6c6f         (set_colo
+00006b70: 722c 202b 2c20 636c 6970 7069 6e67 2c20  r, +, clipping, 
+00006b80: 7368 6164 696e 672c 2065 6467 6573 2c20  shading, edges, 
+00006b90: 6574 632e 290d 0a20 2020 2020 2020 2020  etc.)..         
+00006ba0: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
+00006bb0: 204e 6f74 6520 7468 6174 2077 6865 6e20   Note that when 
+00006bc0: 696e 6974 6961 6c69 7a61 7469 6f6e 2075  initialization u
+00006bd0: 7369 6e67 202a 2a6b 6172 6773 2c0d 0a20  sing **kargs,.. 
+00006be0: 2020 2020 2020 2020 2020 206f 6e6c 7946             onlyF
+00006bf0: 6163 6573 2073 686f 756c 6420 6265 2054  aces should be T
+00006c00: 7275 6520 736f 2064 6f6e 2774 2072 6573  rue so don't res
+00006c10: 6574 2065 6467 6563 6f6c 6f72 730d 0a20  et edgecolors.. 
+00006c20: 2020 2020 2020 2020 2020 2069 6620 7468             if th
+00006c30: 6579 2061 7265 2061 7373 6967 6e65 642e  ey are assigned.
+00006c40: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
+00006c50: 2020 2020 2020 204e 203d 206c 656e 2873         N = len(s
+00006c60: 656c 662e 6676 496e 6469 6365 7329 2020  elf.fvIndices)  
+00006c70: 2020 2020 2320 6e75 6d62 6572 206f 6620      # number of 
+00006c80: 6661 6365 730d 0a20 2020 2020 2020 2069  faces..        i
+00006c90: 6e69 7446 4320 3d20 7365 6c66 2e5f 6466  nitFC = self._df
+00006ca0: 6163 6563 6f6c 6f72 7320 2020 2320 7570  acecolors   # up
+00006cb0: 6461 7465 2066 6f72 2076 5f31 2e32 2e30  date for v_1.2.0
+00006cc0: 0d0a 2020 2020 2020 2020 696e 4c65 6e20  ..        inLen 
+00006cd0: 3d20 6c65 6e28 696e 6974 4643 2920 2020  = len(initFC)   
+00006ce0: 2020 2020 2020 2023 206e 756d 6265 7220         # number 
+00006cf0: 6f66 2066 6163 6563 6f6c 6f72 730d 0a20  of facecolors.. 
+00006d00: 2020 2020 2020 2069 6620 696e 4c65 6e20         if inLen 
+00006d10: 3d3d 204e 203a 2072 6574 7572 6e0d 0a20  == N : return.. 
+00006d20: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+00006d30: 616e 6365 2869 6e69 7446 432c 6e70 2e6e  ance(initFC,np.n
+00006d40: 6461 7272 6179 2920 3a20 696e 6974 4643  darray) : initFC
+00006d50: 203d 2069 6e69 7446 432e 746f 6c69 7374   = initFC.tolist
+00006d60: 2829 0d0a 2020 2020 2020 2020 6e20 3d20  ()..        n = 
+00006d70: 6d61 7468 2e63 6569 6c28 4e2f 696e 4c65  math.ceil(N/inLe
+00006d80: 6e29 0d0a 2020 2020 2020 2020 636f 6c6f  n)..        colo
+00006d90: 7263 6f6c 6c20 3d20 696e 6974 4643 2a6e  rcoll = initFC*n
+00006da0: 0d0a 2020 2020 2020 2020 6966 206f 6e6c  ..        if onl
+00006db0: 7946 6163 6573 203a 2073 656c 662e 7365  yFaces : self.se
+00006dc0: 745f 6661 6365 636f 6c6f 7228 636f 6c6f  t_facecolor(colo
+00006dd0: 7263 6f6c 6c5b 303a 4e5d 290d 0a20 2020  rcoll[0:N])..   
+00006de0: 2020 2020 2023 6966 206f 6e6c 7946 6163       #if onlyFac
+00006df0: 6573 203a 2073 656c 662e 5f64 6661 6365  es : self._dface
+00006e00: 636f 6c6f 7273 203d 2063 6f6c 6f72 636f  colors = colorco
+00006e10: 6c6c 5b30 3a4e 5d20 2020 2320 7570 6461  ll[0:N]   # upda
+00006e20: 7465 2066 6f72 2076 5f31 2e32 2e30 0d0a  te for v_1.2.0..
+00006e30: 2020 2020 2020 2020 656c 7365 203a 2020          else :  
+00006e40: 2020 2020 2020 2073 656c 662e 7365 745f         self.set_
+00006e50: 636f 6c6f 7228 636f 6c6f 7263 6f6c 6c5b  color(colorcoll[
+00006e60: 303a 4e5d 290d 0a20 2020 2020 2020 2072  0:N])..        r
+00006e70: 6574 7572 6e0d 0a0d 0a20 2020 2064 6566  eturn....    def
+00006e80: 205f 7365 745f 696e 6465 785f 7265 6c61   _set_index_rela
+00006e90: 7469 6f6e 7328 7365 6c66 2920 3a0d 0a20  tions(self) :.. 
+00006ea0: 2020 2020 2020 2022 2222 2066 726f 6d20         """ from 
+00006eb0: 7468 6520 7665 7274 6578 2061 6e64 2066  the vertex and f
+00006ec0: 6163 6549 6e64 6963 6573 2c20 7365 7420  aceIndices, set 
+00006ed0: 7468 6520 696e 6469 6365 733a 0d0a 2020  the indices:..  
+00006ee0: 2020 2020 2020 2020 2020 6576 496e 6469            evIndi
+00006ef0: 6365 733a 2020 2020 2041 7272 6179 2c20  ces:     Array, 
+00006f00: 666f 7220 6561 6368 2065 6467 652c 2032  for each edge, 2
+00006f10: 2076 6572 7465 7820 696e 6469 6369 6573   vertex indicies
+00006f20: 2e0d 0a20 2020 2020 2020 2020 2020 2076  ...            v
+00006f30: 6649 6e64 6963 6573 4c69 7374 3a20 4c69  fIndicesList: Li
+00006f40: 7374 2c20 2066 6f72 2065 6163 6820 7665  st,  for each ve
+00006f50: 7274 6578 2c20 6661 6365 2069 6e64 6963  rtex, face indic
+00006f60: 6573 2e0d 0a20 2020 2020 2020 2020 2020  es...           
+00006f70: 2065 6649 6e64 6963 6573 4c69 7374 3a20   efIndicesList: 
+00006f80: 4c69 7374 2c20 2066 6f72 2065 6163 6820  List,  for each 
+00006f90: 6564 6765 2c20 3020 746f 2032 2066 6163  edge, 0 to 2 fac
+00006fa0: 6520 696e 6469 6365 732e 0d0a 2020 2020  e indices...    
+00006fb0: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
+00006fc0: 2065 6467 6549 6e64 6963 6573 203d 2073   edgeIndices = s
+00006fd0: 656c 662e 5f67 6574 5f65 6467 6573 5f66  elf._get_edges_f
+00006fe0: 726f 6d5f 6661 6365 7328 7365 6c66 2e66  rom_faces(self.f
+00006ff0: 7649 6e64 6963 6573 2920 2020 2020 2020  vIndices)       
+00007000: 2020 200d 0a20 2020 2020 2020 2073 656c     ..        sel
+00007010: 662e 6576 496e 6469 6365 7320 3d20 6e70  f.evIndices = np
+00007020: 2e61 7272 6179 2865 6467 6549 6e64 6963  .array(edgeIndic
+00007030: 6573 290d 0a20 2020 2020 2020 2073 656c  es)..        sel
+00007040: 662e 7666 496e 6469 6365 734c 6973 7420  f.vfIndicesList 
+00007050: 3d20 7365 6c66 2e5f 7665 7274 6578 436f  = self._vertexCo
+00007060: 6d6d 6f6e 4661 6365 496e 6469 6365 7328  mmonFaceIndices(
+00007070: 290d 0a20 2020 2020 2020 2073 656c 662e  )..        self.
+00007080: 6566 496e 6469 6365 734c 6973 7420 3d20  efIndicesList = 
+00007090: 7365 6c66 2e5f 6564 6765 436f 6d6d 6f6e  self._edgeCommon
+000070a0: 4661 6365 496e 6469 6365 7328 290d 0a20  FaceIndices().. 
+000070b0: 2020 2020 2020 2072 6574 7572 6e0d 0a0d         return...
+000070c0: 0a20 2020 2064 6566 205f 5f69 6e69 745f  .    def __init_
+000070d0: 5f28 7365 6c66 2c20 7665 7274 6578 436f  _(self, vertexCo
+000070e0: 6f72 2c20 6661 6365 496e 6469 6365 732c  or, faceIndices,
+000070f0: 206e 616d 653d 4e6f 6e65 2c20 7663 6f6c   name=None, vcol
+00007100: 6f72 3d4e 6f6e 652c 202a 2a6b 7761 7267  or=None, **kwarg
+00007110: 7329 203a 0d0a 2020 2020 2020 2020 2222  s) :..        ""
+00007120: 2220 0d0a 2020 2020 2020 2020 3344 2073  " ..        3D s
+00007130: 7572 6661 6365 206f 6620 636f 6e6e 6563  urface of connec
+00007140: 7465 6420 4620 6661 6365 732c 2065 6163  ted F faces, eac
+00007150: 6820 6661 6365 2077 6974 6820 4e20 6e75  h face with N nu
+00007160: 6d62 6572 206f 6620 7665 7274 6963 6573  mber of vertices
+00007170: 2e0d 0a20 2020 2020 2020 2054 6865 2073  ...        The s
+00007180: 7572 6661 6365 2068 6173 2056 206e 756d  urface has V num
+00007190: 6265 7220 6f66 2076 6572 7469 6365 7320  ber of vertices 
+000071a0: 616e 6420 4520 6e75 6d62 6572 206f 6620  and E number of 
+000071b0: 6564 6765 732e 0d0a 2020 2020 2020 2020  edges...        
+000071c0: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
+000071d0: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
+000071e0: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
+000071f0: 2020 7665 7274 6578 436f 6f72 203a 2056    vertexCoor : V
+00007200: 2078 2033 2066 6c6f 6174 2061 7272 6179   x 3 float array
+00007210: 2d6c 696b 6520 0d0a 2020 2020 2020 2020  -like ..        
+00007220: 2020 2020 416e 2061 7272 6179 206f 6620      An array of 
+00007230: 5620 6e75 6d62 6572 206f 6620 7879 7a20  V number of xyz 
+00007240: 7665 7274 6578 2063 6f6f 7264 696e 6174  vertex coordinat
+00007250: 6573 2e0d 0a0d 0a20 2020 2020 2020 2066  es.....        f
+00007260: 6163 6549 6e64 6963 6573 203a 2046 2078  aceIndices : F x
+00007270: 204e 2069 6e74 206c 6973 7420 6f72 2061   N int list or a
+00007280: 7272 6179 0d0a 2020 2020 2020 2020 2020  rray..          
+00007290: 2020 4120 6c69 7374 206f 7220 6172 7261    A list or arra
+000072a0: 7920 6f66 2046 206e 756d 6265 7220 6f66  y of F number of
+000072b0: 2066 6163 6573 2077 6974 6820 4e20 7665   faces with N ve
+000072c0: 7274 6578 2069 6e64 6963 6573 2e0d 0a20  rtex indices... 
+000072d0: 2020 2020 2020 2020 2020 2046 6f72 206c             For l
+000072e0: 6973 7473 2c20 4e20 6d61 7920 6265 2064  ists, N may be d
+000072f0: 6966 6665 7265 6e74 2066 6f72 2065 6163  ifferent for eac
+00007300: 6820 6661 6365 2e0d 0a0d 0a20 2020 2020  h face.....     
+00007310: 2020 206e 616d 6520 3a20 7374 7269 6e67     name : string
+00007320: 2c20 6f70 7469 6f6e 616c 2c20 6465 6661  , optional, defa
+00007330: 756c 743a 204e 6f6e 652e 0d0a 2020 2020  ult: None...    
+00007340: 2020 2020 2020 2020 4465 7363 7269 7074          Descript
+00007350: 6976 6520 6964 656e 7469 6669 6572 2066  ive identifier f
+00007360: 6f72 2074 6865 2067 656f 6d65 7472 792e  or the geometry.
+00007370: 0d0a 0d0a 2020 2020 2020 2020 7663 6f6c  ....        vcol
+00007380: 6f72 203a 2056 2078 2033 2066 6c6f 6174  or : V x 3 float
+00007390: 2061 7272 6179 2d6c 696b 652c 2064 6566   array-like, def
+000073a0: 6175 6c74 3a20 4e6f 6e65 2e0d 0a20 2020  ault: None...   
+000073b0: 2020 2020 2020 2020 2041 6e20 6172 7261           An arra
+000073c0: 7920 6f66 2056 206e 756d 6265 7220 6f66  y of V number of
+000073d0: 2076 6572 7465 7820 636f 6c6f 7273 2e0d   vertex colors..
+000073e0: 0a20 2020 2020 2020 2020 2020 2028 6e6f  .            (no
+000073f0: 7420 696d 706c 656d 656e 7465 642c 2072  t implemented, r
+00007400: 6573 6572 7665 6420 666f 7220 6675 7475  eserved for futu
+00007410: 7265 2064 6576 656c 6f70 6d65 6e74 290d  re development).
+00007420: 0a0d 0a20 2020 2020 2020 204f 7468 6572  ...        Other
+00007430: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
+00007440: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+00007450: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 202a  -----..        *
+00007460: 2a6b 7761 7267 730d 0a20 2020 2020 2020  *kwargs..       
+00007470: 2020 2020 2041 6c6c 206f 7468 6572 2061       All other a
+00007480: 7267 756d 656e 7473 2061 7265 2070 6173  rguments are pas
+00007490: 7365 6420 6f6e 2074 6f20 6d70 6c5f 746f  sed on to mpl_to
+000074a0: 6f6c 6b69 7473 2e6d 706c 6f74 3364 2e61  olkits.mplot3d.a
+000074b0: 7274 3364 2e50 6f6c 7933 4443 6f6c 6c65  rt3d.Poly3DColle
+000074c0: 6374 696f 6e2e 0d0a 2020 2020 2020 2020  ction...        
+000074d0: 2020 2020 5661 6c69 6420 6172 6775 6d65      Valid argume
+000074e0: 6e74 206e 616d 6573 2069 6e63 6c75 6465  nt names include
+000074f0: 3a20 636f 6c6f 722c 2065 6467 6563 6f6c  : color, edgecol
+00007500: 6f72 732c 2066 6163 6563 6f6c 6f72 732c  ors, facecolors,
+00007510: 206c 696e 6577 6964 7468 732c 2063 6d61   linewidths, cma
+00007520: 702e 0d0a 0d0a 2020 2020 2020 2020 2222  p.....        ""
+00007530: 220d 0a0d 0a20 2020 2020 2020 2073 656c  "....        sel
+00007540: 662e 7665 7274 6578 436f 6f72 203d 206e  f.vertexCoor = n
+00007550: 702e 6172 7261 7928 7665 7274 6578 436f  p.array(vertexCo
+00007560: 6f72 2c64 7479 7065 3d66 6c6f 6174 290d  or,dtype=float).
+00007570: 0a20 2020 2020 2020 2073 656c 662e 6261  .        self.ba
+00007580: 7365 5665 7274 6578 436f 6f72 203d 206e  seVertexCoor = n
+00007590: 702e 6172 7261 7928 7665 7274 6578 436f  p.array(vertexCo
+000075a0: 6f72 2c64 7479 7065 3d66 6c6f 6174 290d  or,dtype=float).
+000075b0: 0a20 2020 2020 2020 2073 656c 662e 6676  .        self.fv
+000075c0: 496e 6469 6365 7320 3d20 6e70 2e61 7272  Indices = np.arr
+000075d0: 6179 2866 6163 6549 6e64 6963 6573 2c20  ay(faceIndices, 
+000075e0: 6474 7970 653d 6f62 6a65 6374 2920 2023  dtype=object)  #
+000075f0: 2075 7064 6174 6520 666f 7220 765f 312e   update for v_1.
+00007600: 322e 300d 0a20 2020 2020 2020 200d 0a20  2.0..        .. 
+00007610: 2020 2020 2020 2069 6620 7365 6c66 2e66         if self.f
+00007620: 7649 6e64 6963 6573 2e6e 6469 6d20 3d3d  vIndices.ndim ==
+00007630: 2031 203a 0d0a 2020 2020 2020 2020 2020   1 :..          
+00007640: 2020 2320 6173 7375 6d65 2069 6e70 7574    # assume input
+00007650: 2069 7320 6120 6c69 7374 206f 6620 6661   is a list of fa
+00007660: 6365 7320 7769 7468 2064 6966 6665 7265  ces with differe
+00007670: 6e74 206e 756d 6265 7220 6f66 2065 6467  nt number of edg
+00007680: 6573 2e0d 0a20 2020 2020 2020 2020 2020  es...           
+00007690: 2073 656c 662e 5f69 6e69 7465 6467 6573   self._initedges
+000076a0: 203d 2073 656c 662e 5f67 6574 5f65 6467   = self._get_edg
+000076b0: 6573 5f66 726f 6d5f 6661 6365 7328 7365  es_from_faces(se
+000076c0: 6c66 2e66 7649 6e64 6963 6573 290d 0a20  lf.fvIndices).. 
+000076d0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000076e0: 5f69 6e69 7476 6572 7473 203d 206e 702e  _initverts = np.
+000076f0: 6172 7261 7928 7665 7274 6578 436f 6f72  array(vertexCoor
+00007700: 2c64 7479 7065 3d66 6c6f 6174 290d 0a20  ,dtype=float).. 
+00007710: 2020 2020 2020 2020 2020 2066 7649 6e64             fvInd
+00007720: 4e65 7720 3d20 7365 6c66 2e5f 7472 6961  New = self._tria
+00007730: 6e67 756c 6174 655f 6661 6365 496e 6469  ngulate_faceIndi
+00007740: 6365 7328 6661 6365 496e 6469 6365 7329  ces(faceIndices)
+00007750: 0d0a 2020 2020 2020 2020 2020 2020 6663  ..            fc
+00007760: 6f6c 6f72 203d 204e 6f6e 650d 0a20 2020  olor = None..   
+00007770: 2020 2020 2020 2020 2023 206e 6f74 653a           # note:
+00007780: 2069 6620 6564 6765 636f 6c6f 7273 2061   if edgecolors a
+00007790: 7265 206e 6f74 2064 6566 696e 6564 2c20  re not defined, 
+000077a0: 6465 6661 756c 7420 746f 2064 6566 696e  default to defin
+000077b0: 6564 2066 6163 6563 6f6c 6f72 206c 6973  ed facecolor lis
+000077c0: 742c 0d0a 2020 2020 2020 2020 2020 2020  t,..            
+000077d0: 2320 2020 2020 2020 6e6f 7420 7468 6520  #       not the 
+000077e0: 6465 6669 6e65 6420 636f 6c6f 7220 2820  defined color ( 
+000077f0: 636f 6e74 696e 7565 2077 6974 6820 6469  continue with di
+00007800: 6666 6572 656e 7420 276d 6167 6963 2720  fferent 'magic' 
+00007810: 2920 4d52 4f49 2e0d 0a20 2020 2020 2020  ) MROI...       
+00007820: 2020 2020 2023 2066 6f6c 6c6f 7769 6e67       # following
+00007830: 2027 6d61 7927 2062 6520 7665 7374 6967   'may' be vestig
+00007840: 6961 6c20 746f 2062 6520 7265 6d6f 7665  ial to be remove
+00007850: 6420 3f0d 0a20 2020 2020 2020 2020 2020  d ?..           
+00007860: 2069 6620 2763 6f6c 6f72 2720 696e 206b   if 'color' in k
+00007870: 7761 7267 7320 3a20 6663 6f6c 6f72 203d  wargs : fcolor =
+00007880: 206b 7761 7267 735b 2763 6f6c 6f72 275d   kwargs['color']
+00007890: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+000078a0: 2027 6661 6365 636f 6c6f 7227 2069 6e20   'facecolor' in 
+000078b0: 6b77 6172 6773 203a 2066 636f 6c6f 7220  kwargs : fcolor 
+000078c0: 3d20 6b77 6172 6773 5b27 6661 6365 636f  = kwargs['faceco
+000078d0: 6c6f 7227 5d0d 0a20 2020 2020 2020 2020  lor']..         
+000078e0: 2020 2069 6620 636f 6c6f 7273 2e69 735f     if colors.is_
+000078f0: 636f 6c6f 725f 6c69 6b65 2866 636f 6c6f  color_like(fcolo
+00007900: 7229 203a 0d0a 2020 2020 2020 2020 2020  r) :..          
+00007910: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+00007920: 7369 6e67 6c65 2063 6f6c 6f72 2061 7373  single color ass
+00007930: 6967 6e65 6420 0d0a 2020 2020 2020 2020  igned ..        
+00007940: 2020 2020 2020 2020 6676 496e 644e 6577          fvIndNew
+00007950: 203d 2073 656c 662e 5f74 7269 616e 6775   = self._triangu
+00007960: 6c61 7465 5f66 6163 6549 6e64 6963 6573  late_faceIndices
+00007970: 2866 6163 6549 6e64 6963 6573 290d 0a20  (faceIndices).. 
+00007980: 2020 2020 2020 2020 2020 2065 6c73 6520             else 
+00007990: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+000079a0: 2020 2069 6620 6663 6f6c 6f72 2069 7320     if fcolor is 
+000079b0: 4e6f 6e65 203a 0d0a 2020 2020 2020 2020  None :..        
+000079c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000079d0: 2320 6e6f 2063 6f6c 6f72 2061 7373 6967  # no color assig
+000079e0: 6e65 640d 0a20 2020 2020 2020 2020 2020  ned..           
+000079f0: 2020 2020 2020 2020 2066 7649 6e64 4e65           fvIndNe
+00007a00: 7720 3d20 7365 6c66 2e5f 7472 6961 6e67  w = self._triang
+00007a10: 756c 6174 655f 6661 6365 496e 6469 6365  ulate_faceIndice
+00007a20: 7328 6661 6365 496e 6469 6365 7329 0d0a  s(faceIndices)..
+00007a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007a40: 656c 7365 203a 2020 2320 6c69 7374 206f  else :  # list o
+00007a50: 6620 636f 6c6f 7273 2061 7373 6967 6e65  f colors assigne
+00007a60: 6420 200d 0a20 2020 2020 2020 2020 2020  d  ..           
+00007a70: 2020 2020 2020 2020 2066 7649 6e64 4e65           fvIndNe
+00007a80: 772c 2066 6163 6543 6f6c 6f72 734e 6577  w, faceColorsNew
+00007a90: 203d 2073 656c 662e 5f74 7269 616e 6775   = self._triangu
+00007aa0: 6c61 7465 5f66 6163 6549 6e64 6963 6573  late_faceIndices
+00007ab0: 5f66 6163 6543 6f6c 6f72 7328 6661 6365  _faceColors(face
+00007ac0: 496e 6469 6365 732c 6663 6f6c 6f72 290d  Indices,fcolor).
+00007ad0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00007ae0: 2020 2020 206b 7761 7267 735b 2766 6163       kwargs['fac
+00007af0: 6563 6f6c 6f72 275d 203d 2066 6163 6543  ecolor'] = faceC
+00007b00: 6f6c 6f72 734e 6577 200d 0a20 2020 2020  olorsNew ..     
+00007b10: 2020 2020 2020 2020 2020 2020 2020 206b                 k
+00007b20: 7761 7267 735b 2763 6f6c 6f72 275d 203d  wargs['color'] =
+00007b30: 2066 6163 6543 6f6c 6f72 734e 6577 200d   faceColorsNew .
+00007b40: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00007b50: 662e 6676 496e 6469 6365 7320 3d20 6e70  f.fvIndices = np
+00007b60: 2e61 7272 6179 2866 7649 6e64 4e65 7729  .array(fvIndNew)
+00007b70: 0d0a 2020 2020 2020 2020 656c 7365 203a  ..        else :
+00007b80: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
+00007b90: 6c66 2e66 7649 6e64 6963 6573 203d 206e  lf.fvIndices = n
+00007ba0: 702e 6172 7261 7928 6661 6365 496e 6469  p.array(faceIndi
+00007bb0: 6365 7329 2020 2320 7570 6461 7465 2066  ces)  # update f
+00007bc0: 6f72 2076 5f31 2e32 2e30 0d0a 2020 2020  or v_1.2.0..    
+00007bd0: 2020 2020 7365 6c66 2e5f 7365 745f 696e      self._set_in
+00007be0: 6465 785f 7265 6c61 7469 6f6e 7328 290d  dex_relations().
+00007bf0: 0a20 2020 2020 2020 2066 203d 2073 656c  .        f = sel
+00007c00: 662e 6676 496e 6469 6365 730d 0a20 2020  f.fvIndices..   
+00007c10: 2020 2020 2076 203d 2073 656c 662e 7665       v = self.ve
+00007c20: 7274 6578 436f 6f72 0d0a 2020 2020 2020  rtexCoor..      
+00007c30: 2020 7375 7065 7228 292e 5f5f 696e 6974    super().__init
+00007c40: 5f5f 2876 5b66 5d2c 202a 2a6b 7761 7267  __(v[f], **kwarg
+00007c50: 7329 0d0a 2020 2020 2020 2020 2320 6e6f  s)..        # no
+00007c60: 7465 3a20 696e 2066 6f6c 6c6f 7769 6e67  te: in following
+00007c70: 2c20 6f6e 6c79 2073 6574 2074 6865 2066  , only set the f
+00007c80: 6163 6563 6f6c 6f72 7320 7369 6e63 6520  acecolors since 
+00007c90: 4d61 7470 6c6f 746c 6962 2061 7574 6f2d  Matplotlib auto-
+00007ca0: 7365 7474 696e 670d 0a20 2020 2020 2020  setting..       
+00007cb0: 2023 2020 2020 2020 2074 6865 2065 6467   #       the edg
+00007cc0: 6573 2c20 6966 206e 6f74 2065 7870 6c69  es, if not expli
+00007cd0: 6369 7465 6c79 2070 6173 7365 6420 7769  citely passed wi
+00007ce0: 7468 2065 6467 6563 6f6c 6f72 206b 7761  th edgecolor kwa
+00007cf0: 7267 732e 0d0a 2020 2020 2020 2020 7365  rgs...        se
+00007d00: 6c66 2e5f 706f 7374 5072 6f63 5f73 7572  lf._postProc_sur
+00007d10: 6661 6365 436f 6c6f 7273 2854 7275 6529  faceColors(True)
+00007d20: 200d 0a0d 0a20 2020 2020 2020 2023 7365   ....        #se
+00007d30: 6c66 2e5f 6765 6f6d 4e61 6d65 203d 204e  lf._geomName = N
+00007d40: 6f6e 6520 2020 2023 2052 6564 756e 6461  one    # Redunda
+00007d50: 6e74 2066 726f 6d20 6e65 7874 206c 696e  nt from next lin
+00007d60: 652c 2069 6e74 6572 6e61 6c20 7472 6163  e, internal trac
+00007d70: 6b69 6e67 2074 6f20 6465 7465 726d 696e  king to determin
+00007d80: 6520 6966 2073 6574 2e2e 2e0d 0a20 2020  e if set.....   
+00007d90: 2020 2020 2073 656c 662e 6e61 6d65 203d       self.name =
+00007da0: 206e 616d 650d 0a20 2020 2020 2020 2073   name..        s
+00007db0: 656c 662e 7661 6c75 6573 4e61 6d65 203d  elf.valuesName =
+00007dc0: 204e 6f6e 650d 0a20 2020 2020 2020 2023   None..        #
+00007dd0: 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d   ===============
+00007de0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00007df0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00007e00: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00007e10: 3d3d 3d3d 3d3d 3d3d 3d0d 0a20 2020 2020  =========..     
+00007e20: 2020 2073 656c 662e 636f 6f72 5479 7065     self.coorType
+00007e30: 203d 205f 434f 4f52 5359 535b 2258 595a   = _COORSYS["XYZ
+00007e40: 225d 0d0a 2020 2020 2020 2020 7365 6c66  "]..        self
+00007e50: 2e62 6173 6553 7572 6661 6365 436f 6c6f  .baseSurfaceColo
+00007e60: 7220 3d20 6e70 2e61 7272 6179 2873 656c  r = np.array(sel
+00007e70: 662e 5f64 6661 6365 636f 6c6f 7273 5b30  f._dfacecolors[0
+00007e80: 5d29 2e66 6c61 7474 656e 2829 2e74 6f6c  ]).flatten().tol
+00007e90: 6973 7428 2920 2023 2075 7064 6174 6520  ist()  # update 
+00007ea0: 666f 7220 765f 312e 322e 300d 0a20 2020  for v_1.2.0..   
+00007eb0: 2020 2020 0d0a 2020 2020 2020 2020 7365      ..        se
+00007ec0: 6c66 2e76 6572 7465 7843 6f6c 6f72 203d  lf.vertexColor =
+00007ed0: 206e 702e 6172 7261 7928 7365 6c66 2e5f   np.array(self._
+00007ee0: 6466 6163 6563 6f6c 6f72 735b 305d 292e  dfacecolors[0]).
+00007ef0: 636f 7079 2829 5b6e 702e 6e65 7761 7869  copy()[np.newaxi
+00007f00: 732c 3a5d 2020 2020 2023 2075 7064 6174  s,:]     # updat
+00007f10: 6520 666f 7220 765f 312e 322e 300d 0a20  e for v_1.2.0.. 
+00007f20: 2020 2020 2020 2023 2066 6f6c 6c6f 7769         # followi
+00007f30: 6e67 2061 7373 6967 6e65 6420 7768 656e  ng assigned when
+00007f40: 2073 7572 6661 6365 2063 6f6c 6f72 2061   surface color a
+00007f50: 7070 6c69 6564 2075 7369 6e67 2061 6e20  pplied using an 
+00007f60: 6f70 6572 6174 696f 6e0d 0a20 2020 2020  operation..     
+00007f70: 2020 2073 656c 662e 7665 7274 6578 5661     self.vertexVa
+00007f80: 6c75 6573 203d 204e 6f6e 650d 0a20 2020  lues = None..   
+00007f90: 2020 2020 2073 656c 662e 6661 6365 5661       self.faceVa
+00007fa0: 6c75 6573 203d 204e 6f6e 650d 0a0d 0a20  lues = None.... 
+00007fb0: 2020 2020 2020 2069 6620 6c65 6e20 2873         if len (s
+00007fc0: 656c 662e 5f64 6564 6765 636f 6c6f 7273  elf._dedgecolors
+00007fd0: 2920 3d3d 2020 3020 3a20 2020 2020 2320  ) ==  0 :     # 
+00007fe0: 7570 6461 7465 2066 6f72 2076 5f31 2e32  update for v_1.2
+00007ff0: 2e30 0d0a 2020 2020 2020 2020 2020 2020  .0..            
+00008000: 7365 6c66 2e62 6173 6545 6467 6543 6f6c  self.baseEdgeCol
+00008010: 6f72 203d 2073 656c 662e 6261 7365 5375  or = self.baseSu
+00008020: 7266 6163 6543 6f6c 6f72 200d 0a20 2020  rfaceColor ..   
+00008030: 2020 2020 2065 6c73 6520 3a0d 0a20 2020       else :..   
+00008040: 2020 2020 2020 2020 2073 656c 662e 6261           self.ba
+00008050: 7365 4564 6765 436f 6c6f 7220 3d20 6e70  seEdgeColor = np
+00008060: 2e61 7272 6179 2873 656c 662e 5f64 6564  .array(self._ded
+00008070: 6765 636f 6c6f 7273 5b30 5d29 2e66 6c61  gecolors[0]).fla
+00008080: 7474 656e 2829 2e74 6f6c 6973 7428 2920  tten().tolist() 
+00008090: 2020 2020 2320 7570 6461 7465 2066 6f72      # update for
+000080a0: 2076 5f31 2e32 2e30 0d0a 2020 2020 2020   v_1.2.0..      
+000080b0: 2020 0d0a 2020 2020 2020 2020 7365 6c66    ..        self
+000080c0: 2e69 7353 7572 6661 6365 436f 6c6f 7265  .isSurfaceColore
+000080d0: 6420 2020 2020 3d20 4661 6c73 6520 2020  d     = False   
+000080e0: 2020 2020 2320 666c 6167 2073 6574 2054      # flag set T
+000080f0: 7275 6520 666f 7220 636f 6c6f 7220 6172  rue for color ar
+00008100: 7261 7920 6578 706f 7274 2e0d 0a20 2020  ray export...   
+00008110: 2020 2020 2073 656c 662e 6f6e 6c79 436f       self.onlyCo
+00008120: 6c6f 7265 6446 6163 6573 2020 2020 203d  loredFaces     =
+00008130: 2046 616c 7365 2020 2020 2020 2023 2066   False       # f
+00008140: 6c61 6720 7365 7420 5472 7565 2066 6f72  lag set True for
+00008150: 2063 6d61 7020 6e6f 726d 616c 732e 0d0a   cmap normals...
+00008160: 2020 2020 2020 2020 7365 6c66 2e5f 7375          self._su
+00008170: 7266 6163 6553 6861 7065 4368 616e 6765  rfaceShapeChange
+00008180: 6420 3d20 4661 6c73 6520 2020 2020 2020  d = False       
+00008190: 2320 636f 6e74 726f 6c20 666c 6167 2066  # control flag f
+000081a0: 6f72 2069 6d61 6765 206f 7065 7261 7469  or image operati
+000081b0: 6f6e 7320 2020 2020 200d 0a20 2020 2020  ons      ..     
+000081c0: 2020 2073 656c 662e 5f69 7343 6f6d 706f     self._isCompo
+000081d0: 7369 7465 5375 7266 6163 6520 203d 2046  siteSurface  = F
+000081e0: 616c 7365 2020 2020 2020 2023 2063 6f6e  alse       # con
+000081f0: 7472 6f6c 2066 6c61 6720 666f 7220 6120  trol flag for a 
+00008200: 636f 6d70 6f73 6974 6520 6f62 6a65 6374  composite object
+00008210: 2e0d 0a0d 0a20 2020 2020 2020 2073 656c  .....        sel
+00008220: 662e 6469 7370 5f56 6563 746f 7220 3d20  f.disp_Vector = 
+00008230: 4e6f 6e65 2020 2020 2020 2020 2020 2020  None            
+00008240: 2020 2020 2023 206f 7665 7272 6964 6465       # overridde
+00008250: 6e20 696e 2073 7562 636c 6173 732e 0d0a  n in subclass...
+00008260: 2020 2020 2020 2020 7365 6c66 2e5f 6e6f          self._no
+00008270: 726d 616c 5f73 6361 6c65 203d 2031 2e30  rmal_scale = 1.0
+00008280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008290: 2320 6f76 6572 7269 6464 656e 2069 6e20  # overridden in 
+000082a0: 7375 6263 6c61 7373 2064 6566 6175 6c74  subclass default
+000082b0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+000082c0: 2020 2020 7365 6c66 2e72 6573 746f 7265      self.restore
+000082d0: 6443 6c69 7020 3d20 4e6f 6e65 2020 2020  dClip = None    
+000082e0: 2020 2020 2020 2020 2020 2020 2320 6469              # di
+000082f0: 6374 696f 6e61 7279 2074 6f20 7265 7374  ctionary to rest
+00008300: 6f72 6520 6672 6f6d 2063 6c69 7020 6f70  ore from clip op
+00008310: 6572 6174 696f 6e2e 0d0a 2020 2020 2020  eration...      
+00008320: 2020 7365 6c66 2e76 6563 746f 725f 6669    self.vector_fi
+00008330: 656c 6420 3d20 4e6f 6e65 2020 2020 2020  eld = None      
+00008340: 2020 2020 2020 2020 2020 2320 666f 7220            # for 
+00008350: 7665 6374 6f72 2066 6965 6c64 7320 7768  vector fields wh
+00008360: 656e 2074 7261 6e73 666f 726d 6564 2e0d  en transformed..
+00008370: 0a20 2020 2020 2020 2073 656c 662e 5f73  .        self._s
+00008380: 7664 5f64 6963 7420 2020 203d 204e 6f6e  vd_dict    = Non
+00008390: 6520 2020 2020 2020 2020 2020 2020 2020  e               
+000083a0: 2023 2072 6573 756c 7473 2066 726f 6d20   # results from 
+000083b0: 6d61 705f 6765 6f6d 5f66 726f 6d5f 7376  map_geom_from_sv
+000083c0: 640d 0a20 2020 2020 2020 2073 656c 662e  d..        self.
+000083d0: 7363 616c 6520 3d20 5b31 2c31 2c31 5d20  scale = [1,1,1] 
+000083e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000083f0: 2020 2023 2066 6f72 2061 7869 7320 7768     # for axis wh
+00008400: 656e 2074 7261 6e73 666f 726d 6564 2e0d  en transformed..
+00008410: 0a20 2020 2020 2020 2073 656c 662e 7472  .        self.tr
+00008420: 616e 736c 6174 696f 6e20 3d20 5b30 2c30  anslation = [0,0
+00008430: 2c30 5d20 2020 2020 2020 2020 2020 2020  ,0]             
+00008440: 2023 2066 6f72 2061 7869 7320 7768 656e   # for axis when
+00008450: 2074 7261 6e73 666f 726d 6564 2e0d 0a20   transformed... 
+00008460: 2020 2020 2020 2073 656c 662e 726f 7461         self.rota
+00008470: 7469 6f6e 203d 2020 6e70 2e69 6465 6e74  tion =  np.ident
+00008480: 6974 7928 3329 2020 2020 2020 2020 2023  ity(3)         #
+00008490: 2066 6f72 2061 7869 7320 7768 656e 2074   for axis when t
+000084a0: 7261 6e73 666f 726d 6564 2e0d 0a20 2020  ransformed...   
+000084b0: 2020 2020 2073 656c 662e 5f72 657a 203d       self._rez =
+000084c0: 2030 2020 2020 2020 2020 2020 2020 2020   0              
+000084d0: 2020 2020 2020 2020 2020 2020 2023 2075               # u
+000084e0: 7365 6420 6279 2063 6869 6c64 2063 6c61  sed by child cla
+000084f0: 7373 6573 2e0d 0a0d 0a20 2020 2020 2020  sses.....       
+00008500: 2073 656c 662e 5f62 6f75 6e64 7320 3d20   self._bounds = 
+00008510: 7b7d 0d0a 2020 2020 2020 2020 7365 6c66  {}..        self
+00008520: 2e5f 7365 745f 6765 6f6d 6574 7269 635f  ._set_geometric_
+00008530: 626f 756e 6473 2829 0d0a 2020 2020 2020  bounds()..      
+00008540: 2020 7365 6c66 2e5f 626f 756e 6473 5b27    self._bounds['
+00008550: 766c 696d 275d 2020 2020 203d 205f 4446  vlim']     = _DF
+00008560: 545f 564c 494d 2020 2020 2020 200d 0a20  T_VLIM       .. 
+00008570: 2020 2020 2020 2073 656c 662e 5f62 6f75         self._bou
+00008580: 6e64 735b 2776 6572 7476 6c69 6d27 5d20  nds['vertvlim'] 
+00008590: 3d20 5f44 4654 5f56 4552 5456 4c49 4d20  = _DFT_VERTVLIM 
+000085a0: 0d0a 2020 2020 0d0a 2020 2020 6465 6620  ..    ..    def 
+000085b0: 5f5f 6164 645f 5f28 7365 6c66 2c20 6f74  __add__(self, ot
+000085c0: 6872 2920 3a0d 0a20 2020 2020 2020 2022  hr) :..        "
+000085d0: 2222 0d0a 2020 2020 2020 2020 436f 6d62  ""..        Comb
+000085e0: 696e 6520 7477 6f20 7375 7266 6163 6520  ine two surface 
+000085f0: 6f62 6a65 6374 7320 696e 746f 2061 2073  objects into a s
+00008600: 696e 676c 6520 7375 7266 6163 6520 6f62  ingle surface ob
+00008610: 6a65 6374 2e0d 0a0d 0a20 2020 2020 2020  ject.....       
+00008620: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
+00008630: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
+00008640: 0a20 2020 2020 2020 206f 7468 7220 3a20  .        othr : 
+00008650: 5375 7266 6163 6533 4443 6f6c 6c65 6374  Surface3DCollect
+00008660: 696f 6e20 6f62 6a65 6374 200d 0a0d 0a20  ion object .... 
+00008670: 2020 2020 2020 2052 6574 7572 6e73 0d0a         Returns..
+00008680: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0d          -------.
+00008690: 0a20 2020 2020 2020 2053 7572 6661 6365  .        Surface
+000086a0: 3344 436f 6c6c 6563 7469 6f6e 206f 626a  3DCollection obj
+000086b0: 6563 740d 0a0d 0a20 2020 2020 2020 2022  ect....        "
+000086c0: 2222 0d0a 0d0a 2020 2020 2020 2020 6966  ""....        if
+000086d0: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
+000086e0: 6f74 6872 2c20 5375 7266 6163 6533 4443  othr, Surface3DC
+000086f0: 6f6c 6c65 6374 696f 6e29 203a 0d0a 2020  ollection) :..  
+00008700: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00008710: 5661 6c75 6545 7272 6f72 2827 4164 6420  ValueError('Add 
+00008720: 6f70 6572 6174 696f 6e73 2063 616e 206f  operations can o
+00008730: 6e6c 7920 6170 706c 7920 6265 7477 6565  nly apply betwee
+00008740: 6e20 5375 7266 6163 6533 4443 6f6c 6c65  n Surface3DColle
+00008750: 6374 696f 6e20 6f62 6a65 6374 732e 2729  ction objects.')
+00008760: 0d0a 0d0a 2020 2020 2020 2020 2320 4d52  ....        # MR
+00008770: 4f49 3a20 7368 6f75 6c64 2063 6865 636b  OI: should check
+00008780: 2069 6620 3220 7375 7266 6163 6520 6661   if 2 surface fa
+00008790: 6365 7320 6172 6520 626f 7468 2074 7269  ces are both tri
+000087a0: 616e 6775 6c61 7220 6f72 2071 7561 6472  angular or quadr
+000087b0: 696c 6174 6572 616c 0d0a 0d0a 2020 2020  ilateral....    
+000087c0: 2020 2020 746f 7056 6572 436f 6f72 203d      topVerCoor =
+000087d0: 2073 656c 662e 7665 7274 6578 436f 6f72   self.vertexCoor
+000087e0: 0d0a 2020 2020 2020 2020 626f 7456 6572  ..        botVer
+000087f0: 436f 6f72 203d 206f 7468 722e 7665 7274  Coor = othr.vert
+00008800: 6578 436f 6f72 0d0a 2020 2020 2020 2020  exCoor..        
+00008810: 746f 7456 6572 436f 6f72 203d 206e 702e  totVerCoor = np.
+00008820: 6170 7065 6e64 2874 6f70 5665 7243 6f6f  append(topVerCoo
+00008830: 722c 626f 7456 6572 436f 6f72 2c61 7869  r,botVerCoor,axi
+00008840: 733d 3029 0d0a 2020 2020 2020 2020 6e65  s=0)..        ne
+00008850: 7874 496e 6465 7820 3d20 6c65 6e28 746f  xtIndex = len(to
+00008860: 7056 6572 436f 6f72 290d 0a0d 0a20 2020  pVerCoor)....   
+00008870: 2020 2020 2074 6f70 4656 696e 6469 6365       topFVindice
+00008880: 7320 3d20 7365 6c66 2e66 7649 6e64 6963  s = self.fvIndic
+00008890: 6573 0d0a 2020 2020 2020 2020 626f 7446  es..        botF
+000088a0: 5669 6e64 6963 6573 203d 206f 7468 722e  Vindices = othr.
+000088b0: 6676 496e 6469 6365 730d 0a20 2020 2020  fvIndices..     
+000088c0: 2020 2046 5674 6169 6c20 3d20 6e70 2e61     FVtail = np.a
+000088d0: 6464 2862 6f74 4656 696e 6469 6365 732c  dd(botFVindices,
+000088e0: 6e65 7874 496e 6465 7829 0d0a 2020 2020  nextIndex)..    
+000088f0: 2020 2020 746f 7446 5669 6e64 6963 6573      totFVindices
+00008900: 203d 206e 702e 6170 7065 6e64 2874 6f70   = np.append(top
+00008910: 4656 696e 6469 6365 732c 4656 7461 696c  FVindices,FVtail
+00008920: 2c61 7869 733d 3029 0d0a 0d0a 2020 2020  ,axis=0)....    
+00008930: 2020 2020 6f62 6a20 3d20 5375 7266 6163      obj = Surfac
+00008940: 6533 4443 6f6c 6c65 6374 696f 6e28 746f  e3DCollection(to
+00008950: 7456 6572 436f 6f72 2c74 6f74 4656 696e  tVerCoor,totFVin
+00008960: 6469 6365 7329 0d0a 2020 2020 2020 2020  dices)..        
+00008970: 6f62 6a2e 5f69 7343 6f6d 706f 7369 7465  obj._isComposite
+00008980: 5375 7266 6163 6520 3d20 5472 7565 0d0a  Surface = True..
+00008990: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+000089a0: 2020 746f 705f 6f6e 6561 7272 203d 206e    top_onearr = n
+000089b0: 702e 6f6e 6573 2820 6c65 6e28 746f 7046  p.ones( len(topF
+000089c0: 5669 6e64 6963 6573 2920 295b 3a2c 206e  Vindices) )[:, n
+000089d0: 702e 6e65 7761 7869 735d 0d0a 2020 2020  p.newaxis]..    
+000089e0: 2020 2020 746f 705f 6f72 6967 5f63 6f6c      top_orig_col
+000089f0: 6f72 7320 3d20 7365 6c66 2e5f 6466 6163  ors = self._dfac
+00008a00: 6563 6f6c 6f72 7320 2023 2075 7064 6174  ecolors  # updat
+00008a10: 6520 666f 7220 765f 312e 322e 300d 0a20  e for v_1.2.0.. 
+00008a20: 2020 2020 2020 2069 6620 6c65 6e28 746f         if len(to
+00008a30: 705f 6f72 6967 5f63 6f6c 6f72 7329 203d  p_orig_colors) =
+00008a40: 3d20 3120 3a20 746f 705f 6f72 6967 5f63  = 1 : top_orig_c
+00008a50: 6f6c 6f72 7320 3d20 746f 705f 6f72 6967  olors = top_orig
+00008a60: 5f63 6f6c 6f72 732a 746f 705f 6f6e 6561  _colors*top_onea
+00008a70: 7272 0d0a 0d0a 2020 2020 2020 2020 626f  rr....        bo
+00008a80: 745f 6f6e 6561 7272 203d 206e 702e 6f6e  t_onearr = np.on
+00008a90: 6573 2820 6c65 6e28 626f 7446 5669 6e64  es( len(botFVind
+00008aa0: 6963 6573 2920 295b 3a2c 206e 702e 6e65  ices) )[:, np.ne
+00008ab0: 7761 7869 735d 0d0a 2020 2020 2020 2020  waxis]..        
+00008ac0: 626f 745f 6f72 6967 5f63 6f6c 6f72 7320  bot_orig_colors 
+00008ad0: 3d20 6f74 6872 2e5f 6466 6163 6563 6f6c  = othr._dfacecol
+00008ae0: 6f72 7320 2023 2075 7064 6174 6520 666f  ors  # update fo
+00008af0: 7220 765f 312e 322e 300d 0a20 2020 2020  r v_1.2.0..     
+00008b00: 2020 2069 6620 6c65 6e28 626f 745f 6f72     if len(bot_or
+00008b10: 6967 5f63 6f6c 6f72 7329 203d 3d20 3120  ig_colors) == 1 
+00008b20: 3a20 626f 745f 6f72 6967 5f63 6f6c 6f72  : bot_orig_color
+00008b30: 7320 3d20 626f 745f 6f72 6967 5f63 6f6c  s = bot_orig_col
+00008b40: 6f72 732a 626f 745f 6f6e 6561 7272 0d0a  ors*bot_onearr..
+00008b50: 0d0a 2020 2020 2020 2020 746f 7461 6c5f  ..        total_
+00008b60: 636f 6c6f 7273 203d 206e 702e 6170 7065  colors = np.appe
+00008b70: 6e64 2874 6f70 5f6f 7269 675f 636f 6c6f  nd(top_orig_colo
+00008b80: 7273 2c62 6f74 5f6f 7269 675f 636f 6c6f  rs,bot_orig_colo
+00008b90: 7273 2c61 7869 733d 3029 0d0a 2020 2020  rs,axis=0)..    
+00008ba0: 2020 2020 6f62 6a2e 7365 745f 636f 6c6f      obj.set_colo
+00008bb0: 7228 746f 7461 6c5f 636f 6c6f 7273 2920  r(total_colors) 
+00008bc0: 2020 2020 2020 200d 0a0d 0a20 2020 2020         ....     
+00008bd0: 2020 206f 626a 2e5f 7365 745f 6765 6f6d     obj._set_geom
+00008be0: 6574 7269 635f 626f 756e 6473 2829 0d0a  etric_bounds()..
+00008bf0: 2020 2020 2020 2020 7265 7475 726e 206f          return o
+00008c00: 626a 0d0a 0d0a 2020 2020 6465 6620 5f5f  bj....    def __
+00008c10: 7374 725f 5f28 7365 6c66 2920 3a0d 0a20  str__(self) :.. 
+00008c20: 2020 2020 2020 2023 2070 6172 656e 7420         # parent 
+00008c30: 636c 6173 7320 646f 6573 6e27 7420 6861  class doesn't ha
+00008c40: 7665 2073 7065 6369 6669 6320 7072 6f70  ve specific prop
+00008c50: 6572 7469 6573 2e2e 2e0d 0a20 2020 2020  erties.....     
+00008c60: 2020 2023 204e 6f74 653a 2073 656c 662e     # Note: self.
+00008c70: 5f72 657a 206d 6179 2062 6520 6120 7374  _rez may be a st
+00008c80: 7269 6e67 206f 7220 696e 742e 2020 7072  ring or int.  pr
+00008c90: 6f62 6162 6c79 206e 6f74 2067 6f6f 6420  obably not good 
+00008ca0: 6275 7420 4d52 4f49 0d0a 2020 2020 2020  but MROI..      
+00008cb0: 2020 7472 793a 2020 2020 2062 7320 3d20    try:     bs = 
+00008cc0: 2720 2820 7b7d 202c 207b 7d20 2927 2e66  ' ( {} , {} )'.f
+00008cd0: 6f72 6d61 7428 7365 6c66 2e5f 7265 7a2c  ormat(self._rez,
+00008ce0: 7365 6c66 2e5f 6261 7365 7479 7065 290d  self._basetype).
+00008cf0: 0a20 2020 2020 2020 2065 7863 6570 743a  .        except:
+00008d00: 2020 6273 203d 2027 2027 0d0a 2020 2020    bs = ' '..    
+00008d10: 2020 2020 6e75 6d46 6163 6573 203d 206c      numFaces = l
+00008d20: 656e 2873 656c 662e 6676 496e 6469 6365  en(self.fvIndice
+00008d30: 7329 0d0a 2020 2020 2020 2020 6e75 6d56  s)..        numV
+00008d40: 6572 7473 203d 206c 656e 2873 656c 662e  erts = len(self.
+00008d50: 7665 7274 6578 436f 6f72 290d 0a20 2020  vertexCoor)..   
+00008d60: 2020 2020 206e 616d 6520 3d20 7365 6c66       name = self
+00008d70: 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e 616d  .__class__.__nam
+00008d80: 655f 5f0d 0a20 2020 2020 2020 2073 7a20  e__..        sz 
+00008d90: 3d20 273a 2020 6661 6365 733a 207b 7d2c  = ':  faces: {},
+00008da0: 2020 7665 7274 6963 6573 3a20 7b7d 272e    vertices: {}'.
+00008db0: 666f 726d 6174 286e 756d 4661 6365 732c  format(numFaces,
+00008dc0: 6e75 6d56 6572 7473 290d 0a20 2020 2020  numVerts)..     
+00008dd0: 2020 2076 616c 203d 206e 616d 652b 6273     val = name+bs
+00008de0: 2b73 7a0d 0a20 2020 2020 2020 2072 6574  +sz..        ret
+00008df0: 7572 6e20 7661 6c0d 0a0d 0a20 2020 2064  urn val....    d
+00008e00: 6566 205f 6361 6c63 5f72 657a 2873 656c  ef _calc_rez(sel
+00008e10: 662c 4e30 2920 3a0d 0a20 2020 2020 2020  f,N0) :..       
+00008e20: 2023 2073 7472 696e 6720 7661 6c20 666f   # string val fo
+00008e30: 7220 6571 7569 7661 6c65 6e74 2067 7269  r equivalent gri
+00008e40: 6420 7265 7a20 0d0a 2020 2020 2020 2020  d rez ..        
+00008e50: 6e75 6d46 6163 6573 203d 206c 656e 2873  numFaces = len(s
+00008e60: 656c 662e 6676 496e 6469 6365 7329 0d0a  elf.fvIndices)..
+00008e70: 2020 2020 2020 2020 6352 657a 203d 206e          cRez = n
+00008e80: 702e 6c6f 6732 286e 756d 4661 6365 732f  p.log2(numFaces/
+00008e90: 4e30 292f 320d 0a20 2020 2020 2020 2072  N0)/2..        r
+00008ea0: 6574 7572 6e20 277b 3a2e 3166 7d27 2e66  eturn '{:.1f}'.f
+00008eb0: 6f72 6d61 7428 6352 657a 290d 0a0d 0a20  ormat(cRez).... 
+00008ec0: 2020 2064 6566 205f 7665 7274 6578 436f     def _vertexCo
+00008ed0: 6d6d 6f6e 4661 6365 496e 6469 6365 7328  mmonFaceIndices(
+00008ee0: 7365 6c66 2920 3a0d 0a20 2020 2020 2020  self) :..       
+00008ef0: 2022 2222 206c 6973 7420 6f66 2066 6163   """ list of fac
+00008f00: 6520 696e 6469 6365 7320 6174 2065 6163  e indices at eac
+00008f10: 6820 7665 7274 6578 2e20 2222 220d 0a0d  h vertex. """...
+00008f20: 0a20 2020 2020 2020 2023 206e 6f74 653a  .        # note:
+00008f30: 2061 2076 6572 7465 7820 6d61 7920 6861   a vertex may ha
+00008f40: 7665 204e 4f20 6661 6365 7320 2865 6d70  ve NO faces (emp
+00008f50: 7479 2066 6163 6549 6e64 6578 206c 6973  ty faceIndex lis
+00008f60: 7429 0d0a 2020 2020 2020 2020 2320 2020  t)..        #   
+00008f70: 2020 2020 6475 6520 746f 2063 6c69 7070      due to clipp
+00008f80: 696e 6720 6f72 2061 2076 6572 7465 7820  ing or a vertex 
+00008f90: 6e6f 7420 7573 6564 2066 6f72 2061 2066  not used for a f
+00008fa0: 6163 652c 2073 6f3a 0d0a 2020 2020 2020  ace, so:..      
+00008fb0: 2020 7666 496e 6469 6365 734c 6973 7420    vfIndicesList 
+00008fc0: 3d20 5b20 5b5d 2066 6f72 2069 2069 6e20  = [ [] for i in 
+00008fd0: 7261 6e67 6528 6c65 6e28 7365 6c66 2e76  range(len(self.v
+00008fe0: 6572 7465 7843 6f6f 7229 295d 0d0a 2020  ertexCoor))]..  
+00008ff0: 2020 2020 2020 2320 6e6f 7465 3a20 7573        # note: us
+00009000: 7561 6c6c 7920 7665 7274 6963 6573 206d  ually vertices m
+00009010: 6179 2068 6176 6520 3120 746f 2036 2063  ay have 1 to 6 c
+00009020: 6f6d 6d6f 6e20 6661 6365 730d 0a20 2020  ommon faces..   
+00009030: 2020 2020 2066 6f72 2069 2c66 6163 6520       for i,face 
+00009040: 696e 2065 6e75 6d65 7261 7465 2873 656c  in enumerate(sel
+00009050: 662e 6676 496e 6469 6365 7329 203a 0d0a  f.fvIndices) :..
+00009060: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00009070: 7649 6e78 2069 6e20 6661 6365 203a 0d0a  vInx in face :..
+00009080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009090: 6966 2076 6649 6e64 6963 6573 4c69 7374  if vfIndicesList
+000090a0: 5b76 496e 785d 2069 7320 4e6f 6e65 203a  [vInx] is None :
+000090b0: 2020 7666 496e 6469 6365 734c 6973 745b    vfIndicesList[
+000090c0: 7649 6e78 5d20 3d20 5b69 5d0d 0a20 2020  vInx] = [i]..   
+000090d0: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+000090e0: 6520 3a20 2020 2020 2020 2020 2020 2020  e :             
+000090f0: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+00009100: 6649 6e64 6963 6573 4c69 7374 5b76 496e  fIndicesList[vIn
+00009110: 785d 2e61 7070 656e 6428 6929 0d0a 2020  x].append(i)..  
+00009120: 2020 2020 2020 7265 7475 726e 2076 6649        return vfI
+00009130: 6e64 6963 6573 4c69 7374 0d0a 2020 2020  ndicesList..    
+00009140: 2020 2020 0d0a 2020 2020 6465 6620 5f65      ..    def _e
+00009150: 6467 6543 6f6d 6d6f 6e46 6163 6549 6e64  dgeCommonFaceInd
+00009160: 6963 6573 2873 656c 6629 203a 0d0a 2020  ices(self) :..  
+00009170: 2020 2020 2020 2222 2220 6c69 7374 206f        """ list o
+00009180: 6620 6661 6365 2069 6e64 6963 6573 2061  f face indices a
+00009190: 646a 6163 656e 7420 746f 2065 6163 6820  djacent to each 
+000091a0: 6564 6765 2e20 2222 220d 0a0d 0a20 2020  edge. """....   
+000091b0: 2020 2020 2065 6649 6e64 6963 6573 4c69       efIndicesLi
+000091c0: 7374 203d 205b 4e6f 6e65 5d2a 6c65 6e28  st = [None]*len(
+000091d0: 7365 6c66 2e65 7649 6e64 6963 6573 290d  self.evIndices).
+000091e0: 0a20 2020 2020 2020 2023 206e 6f74 653a  .        # note:
+000091f0: 2065 6467 6573 206d 6179 2068 6176 6520   edges may have 
+00009200: 3120 6f72 2032 2063 6f6d 6d6f 6e20 6661  1 or 2 common fa
+00009210: 6365 730d 0a20 2020 2020 2020 2066 6f72  ces..        for
+00009220: 2069 2c65 496e 6465 7820 696e 2065 6e75   i,eIndex in enu
+00009230: 6d65 7261 7465 2873 656c 662e 6576 496e  merate(self.evIn
+00009240: 6469 6365 7329 203a 0d0a 2020 2020 2020  dices) :..      
+00009250: 2020 2020 2020 6865 6164 5f76 6669 203d        head_vfi =
+00009260: 2073 656c 662e 7666 496e 6469 6365 734c   self.vfIndicesL
+00009270: 6973 745b 2065 496e 6465 785b 305d 205d  ist[ eIndex[0] ]
+00009280: 0d0a 2020 2020 2020 2020 2020 2020 7461  ..            ta
+00009290: 696c 5f76 6669 203d 2073 656c 662e 7666  il_vfi = self.vf
+000092a0: 496e 6469 6365 734c 6973 745b 2065 496e  IndicesList[ eIn
+000092b0: 6465 785b 315d 205d 0d0a 2020 2020 2020  dex[1] ]..      
+000092c0: 2020 2020 2020 666f 7220 6669 2069 6e20        for fi in 
+000092d0: 6865 6164 5f76 6669 203a 0d0a 2020 2020  head_vfi :..    
+000092e0: 2020 2020 2020 2020 2020 2020 6966 2028              if (
+000092f0: 6669 2069 6e20 7461 696c 5f76 6669 2920  fi in tail_vfi) 
+00009300: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00009310: 2020 2020 2020 2069 6620 6566 496e 6469         if efIndi
+00009320: 6365 734c 6973 745b 695d 2069 7320 4e6f  cesList[i] is No
+00009330: 6e65 3a20 2020 6566 496e 6469 6365 734c  ne:   efIndicesL
+00009340: 6973 745b 695d 203d 205b 6669 5d20 200d  ist[i] = [fi]  .
+00009350: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009360: 2020 2020 2065 6c73 653a 2020 2020 2020       else:      
+00009370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009380: 2020 2020 6566 496e 6469 6365 734c 6973      efIndicesLis
+00009390: 745b 695d 2e61 7070 656e 6428 6669 290d  t[i].append(fi).
+000093a0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+000093b0: 6566 496e 6469 6365 734c 6973 740d 0a0d  efIndicesList...
+000093c0: 0a20 2020 2064 6566 205f 636f 6e74 6f75  .    def _contou
+000093d0: 724c 696e 6543 6f6c 6c65 6374 696f 6e28  rLineCollection(
+000093e0: 2073 656c 662c 2064 6f74 7072 6f64 2c20   self, dotprod, 
+000093f0: 7072 6f6a 5665 6374 2c20 2a61 7267 7320  projVect, *args 
+00009400: 2920 3a0d 0a20 2020 2020 2020 2022 2222  ) :..        """
+00009410: 0d0a 2020 2020 2020 2020 2020 2020 436f  ..            Co
+00009420: 6c6f 724c 696e 6533 4443 6f6c 6c65 6374  lorLine3DCollect
+00009430: 696f 6e20 6f66 2073 6567 6d65 6e74 7320  ion of segments 
+00009440: 6f6e 2066 6163 6573 2069 6e74 6572 6563  on faces interec
+00009450: 7469 6e67 2061 2070 6c61 6e65 2e0d 0a0d  ting a plane....
+00009460: 0a20 2020 2020 2020 2020 2020 2064 6f74  .            dot
+00009470: 7072 6f64 2020 2d20 646f 7420 7072 6f64  prod  - dot prod
+00009480: 7563 7420 6265 7477 6565 6e20 6561 6368  uct between each
+00009490: 2076 6572 7465 7820 616e 6420 706c 616e   vertex and plan
+000094a0: 6520 6e6f 726d 616c 2e0d 0a20 2020 2020  e normal...     
+000094b0: 2020 2020 2020 2070 726f 6a56 6563 7420         projVect 
+000094c0: 2d20 696e 7465 7265 6374 696f 6e20 706c  - interection pl
+000094d0: 616e 6520 6e6f 726d 616c 0d0a 2020 2020  ane normal..    
+000094e0: 2020 2020 2020 2020 2a61 7267 7320 2020          *args   
+000094f0: 202d 206c 6973 7420 6f66 2064 6973 7461   - list of dista
+00009500: 6e63 6573 206f 6620 7468 6520 706c 616e  nces of the plan
+00009510: 6520 746f 2074 6865 206f 7269 6769 6e2e  e to the origin.
+00009520: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
+00009530: 2020 2020 2020 2023 2046 7574 4465 763a         # FutDev:
+00009540: 2054 6865 7265 2061 7265 2027 7665 7374   There are 'vest
+00009550: 6967 616c 2720 6c6f 6f70 7320 6475 7269  igal' loops duri
+00009560: 6e67 2065 6172 6c79 2064 6576 656c 6f70  ng early develop
+00009570: 6d65 6e74 0d0a 2020 2020 2020 2020 2320  ment..        # 
+00009580: 6465 6275 6767 696e 6720 7768 6963 6820  debugging which 
+00009590: 6e65 6564 2074 6f20 6265 2063 6c65 616e  need to be clean
+000095a0: 6564 206f 7574 2e20 284d 524f 4920 666f  ed out. (MROI fo
+000095b0: 7220 7265 6c65 6173 6529 0d0a 2020 2020  r release)..    
+000095c0: 2020 2020 2320 2d2d 2d2d 2d2d 2d2d 2d2d      # ----------
+000095d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000095e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000095f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00009600: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2064  -----..        d
+00009610: 6566 2067 6574 4c69 6e65 5661 6c73 2820  ef getLineVals( 
+00009620: 646f 7470 726f 642c 614c 656e 2c70 726f  dotprod,aLen,pro
+00009630: 6a56 6563 7429 203a 0d0a 2020 2020 2020  jVect) :..      
+00009640: 2020 2020 2020 2320 2e2e 2e2e 2e2e 2e2e        # ........
+00009650: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00009660: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00009670: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00009680: 2e2e 2e2e 2e2e 2e2e 0d0a 2020 2020 2020  ..........      
+00009690: 2020 2020 2020 6465 6620 6f72 6465 725f        def order_
+000096a0: 7661 6c75 6528 2066 6163 652c 6549 6e64  value( face,eInd
+000096b0: 6963 6573 2c20 636f 6e43 6f6f 722c 2070  ices, conCoor, p
+000096c0: 6c61 6e65 4e6f 726d 616c 2920 3a0d 0a20  laneNormal) :.. 
+000096d0: 2020 2020 2020 2020 2020 2020 2020 2041                 A
+000096e0: 203d 2065 496e 6469 6365 735b 305d 0d0a   = eIndices[0]..
+000096f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009700: 4220 3d20 6549 6e64 6963 6573 5b31 5d0d  B = eIndices[1].
+00009710: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009720: 2066 7669 203d 2073 656c 662e 6676 496e   fvi = self.fvIn
+00009730: 6469 6365 735b 6661 6365 5d0d 0a20 2020  dices[face]..   
+00009740: 2020 2020 2020 2020 2020 2020 2076 6572               ver
+00009750: 7473 203d 2073 656c 662e 7665 7274 6578  ts = self.vertex
+00009760: 436f 6f72 5b20 6676 6920 5d0d 0a20 2020  Coor[ fvi ]..   
+00009770: 2020 2020 2020 2020 2020 2020 2066 6163               fac
+00009780: 654e 6f72 6d61 6c20 3d20 7365 6c66 2e5f  eNormal = self._
+00009790: 6765 745f 6661 6365 5f6e 6f72 6d61 6c73  get_face_normals
+000097a0: 285b 7665 7274 735d 290d 0a0d 0a20 2020  ([verts])....   
+000097b0: 2020 2020 2020 2020 2020 2020 2065 6467               edg
+000097c0: 6556 6572 745f 4120 3d20 636f 6e43 6f6f  eVert_A = conCoo
+000097d0: 725b 415d 0d0a 2020 2020 2020 2020 2020  r[A]..          
+000097e0: 2020 2020 2020 6564 6765 5665 7274 5f42        edgeVert_B
+000097f0: 203d 2063 6f6e 436f 6f72 5b42 5d0d 0a20   = conCoor[B].. 
+00009800: 2020 2020 2020 2020 2020 2020 2020 2041                 A
+00009810: 5f74 6f5f 4220 3d20 6e70 2e73 7562 7472  _to_B = np.subtr
+00009820: 6163 7428 6564 6765 5665 7274 5f42 2c20  act(edgeVert_B, 
+00009830: 6564 6765 5665 7274 5f41 290d 0a20 2020  edgeVert_A)..   
+00009840: 2020 2020 2020 2020 2020 2020 2065 6467               edg
+00009850: 6543 726f 7373 203d 206e 702e 6372 6f73  eCross = np.cros
+00009860: 7328 415f 746f 5f42 2c20 706c 616e 654e  s(A_to_B, planeN
+00009870: 6f72 6d61 6c20 290d 0a20 2020 2020 2020  ormal )..       
+00009880: 2020 2020 2020 2020 2065 6467 6543 726f           edgeCro
+00009890: 7373 3d20 6e70 2e64 6976 6964 6528 2065  ss= np.divide( e
+000098a0: 6467 6543 726f 7373 2c20 6e70 2e6c 696e  dgeCross, np.lin
+000098b0: 616c 672e 6e6f 726d 2865 6467 6543 726f  alg.norm(edgeCro
+000098c0: 7373 2920 290d 0a20 2020 2020 2020 2020  ss) )..         
+000098d0: 2020 2020 2020 2074 6573 7420 3d20 6e70         test = np
+000098e0: 2e64 6f74 2866 6163 654e 6f72 6d61 6c2c  .dot(faceNormal,
+000098f0: 2065 6467 6543 726f 7373 290d 0a20 2020   edgeCross)..   
+00009900: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+00009910: 7572 6e20 5b41 2c42 5d20 6966 2074 6573  urn [A,B] if tes
+00009920: 743e 3020 656c 7365 205b 422c 415d 0d0a  t>0 else [B,A]..
+00009930: 2020 2020 2020 2020 2020 2020 2320 2e2e              # ..
+00009940: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00009950: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00009960: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00009970: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 0d0a  ................
+00009980: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
+00009990: 2020 2020 2020 2020 2020 2320 2e2e 2067            # .. g
+000099a0: 6574 2069 6e74 6572 7365 6374 2063 6f6f  et intersect coo
+000099b0: 7220 666f 7220 6561 6368 2065 6467 652e  r for each edge.
+000099c0: 2e2e 2e2e 2e2e 2e0d 0a20 2020 2020 2020  .........       
+000099d0: 2020 2020 2065 7669 203d 2073 656c 662e       evi = self.
+000099e0: 6576 496e 6469 6365 730d 0a20 2020 2020  evIndices..     
+000099f0: 2020 2020 2020 2076 6572 7473 203d 2073         verts = s
+00009a00: 656c 662e 7665 7274 6578 436f 6f72 0d0a  elf.vertexCoor..
+00009a10: 2020 2020 2020 2020 2020 2020 6470 5f61              dp_a
+00009a20: 203d 2061 4c65 6e20 2d20 646f 7470 726f   = aLen - dotpro
+00009a30: 640d 0a20 2020 2020 2020 2020 2020 2065  d..            e
+00009a40: 456c 6576 203d 2064 705f 615b 6576 695d  Elev = dp_a[evi]
+00009a50: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+00009a60: 6545 6c65 7620 6973 2074 6865 2064 6973  eElev is the dis
+00009a70: 7461 6e63 6520 6f66 2074 6865 2074 776f  tance of the two
+00009a80: 2065 6467 6520 7665 7274 6963 6573 2061   edge vertices a
+00009a90: 626f 7665 2f62 656c 6f77 2074 6865 2070  bove/below the p
+00009aa0: 6c61 6e65 2e0d 0a20 2020 2020 2020 2020  lane...         
+00009ab0: 2020 2023 2065 6467 6573 2063 726f 7373     # edges cross
+00009ac0: 2074 6865 2070 6c61 6e65 2069 6620 6f6e   the plane if on
+00009ad0: 6520 7665 7274 6578 2069 7320 6162 6f76  e vertex is abov
+00009ae0: 652c 2074 6865 206f 7468 6572 2062 656c  e, the other bel
+00009af0: 6f77 2e0d 0a20 2020 2020 2020 2020 2020  ow...           
+00009b00: 2023 2068 656e 6365 2074 6865 2070 726f   # hence the pro
+00009b10: 6475 6374 206f 6620 7468 6520 7477 6f20  duct of the two 
+00009b20: 6469 7374 616e 6365 7320 6973 206e 6567  distances is neg
+00009b30: 6174 6976 6520 6966 2065 6467 6520 6372  ative if edge cr
+00009b40: 6f73 7365 7320 7468 6520 706c 616e 652e  osses the plane.
+00009b50: 0d0a 2020 2020 2020 2020 2020 2020 6564  ..            ed
+00009b60: 4368 6b20 3d20 6545 6c65 765b 3a2c 305d  Chk = eElev[:,0]
+00009b70: 2a65 456c 6576 5b3a 2c31 5d0d 0a20 2020  *eElev[:,1]..   
+00009b80: 2020 2020 2020 2020 2078 436f 6f72 203d           xCoor =
+00009b90: 205b 5d20 2023 2069 6e74 6572 7365 6374   []  # intersect
+00009ba0: 2063 6f6f 7264 696e 6174 6573 2e0d 0a20   coordinates... 
+00009bb0: 2020 2020 2020 2020 2020 2065 7669 7820             evix 
+00009bc0: 3d20 5b5d 2020 2023 2074 6865 2065 6467  = []   # the edg
+00009bd0: 6520 696e 6465 7820 6f66 2074 6865 2069  e index of the i
+00009be0: 6e74 6572 7365 6374 2063 6f6f 7264 696e  ntersect coordin
+00009bf0: 6174 652e 0d0a 2020 2020 2020 2020 2020  ate...          
+00009c00: 2020 666f 7220 6920 696e 2072 616e 6765    for i in range
+00009c10: 2820 6c65 6e28 6576 6929 2029 203a 0d0a  ( len(evi) ) :..
+00009c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009c30: 6966 2065 6443 686b 5b69 5d20 3c20 302e  if edChk[i] < 0.
+00009c40: 3020 3a0d 0a20 2020 2020 2020 2020 2020  0 :..           
+00009c50: 2020 2020 2020 2020 2070 3120 3d20 7665           p1 = ve
+00009c60: 7274 735b 2065 7669 5b69 2c30 5d20 5d0d  rts[ evi[i,0] ].
+00009c70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009c80: 2020 2020 2070 3220 3d20 7665 7274 735b       p2 = verts[
+00009c90: 2065 7669 5b69 2c31 5d20 5d0d 0a20 2020   evi[i,1] ]..   
+00009ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009cb0: 2064 7031 203d 2064 6f74 7072 6f64 205b   dp1 = dotprod [
+00009cc0: 2065 7669 5b69 2c30 5d20 5d0d 0a20 2020   evi[i,0] ]..   
+00009cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009ce0: 2064 7032 203d 2064 6f74 7072 6f64 205b   dp2 = dotprod [
+00009cf0: 2065 7669 5b69 2c31 5d20 5d0d 0a20 2020   evi[i,1] ]..   
+00009d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009d10: 2061 5f6d 6470 3120 3d20 6470 5f61 205b   a_mdp1 = dp_a [
+00009d20: 2065 7669 5b69 2c30 5d20 5d0d 0a20 2020   evi[i,0] ]..   
+00009d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009d40: 206c 6d62 203d 2061 5f6d 6470 312f 2820   lmb = a_mdp1/( 
+00009d50: 6470 3220 2d20 6470 3120 290d 0a20 2020  dp2 - dp1 )..   
+00009d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009d70: 2070 7820 3d20 6c6d 622a 6e70 2e73 7562   px = lmb*np.sub
+00009d80: 7472 6163 7428 7032 2c70 3129 202b 2070  tract(p2,p1) + p
+00009d90: 310d 0a20 2020 2020 2020 2020 2020 2020  1..             
+00009da0: 2020 2020 2020 2078 436f 6f72 2e61 7070         xCoor.app
+00009db0: 656e 6428 7078 290d 0a20 2020 2020 2020  end(px)..       
+00009dc0: 2020 2020 2020 2020 2020 2020 2065 7669               evi
+00009dd0: 782e 6170 7065 6e64 2869 290d 0a0d 0a20  x.append(i).... 
+00009de0: 2020 2020 2020 2020 2020 2023 202e 2e20             # .. 
+00009df0: 6465 7465 726d 696e 6520 6661 6365 7320  determine faces 
+00009e00: 6861 7669 6e67 2065 6467 6573 2077 6869  having edges whi
+00009e10: 6368 2068 6176 6520 616e 2069 6e74 6572  ch have an inter
+00009e20: 7365 6374 2e2e 2e2e 2e0d 0a20 2020 2020  sect.......     
+00009e30: 2020 2020 2020 2069 6620 6c65 6e28 7843         if len(xC
+00009e40: 6f6f 7229 203d 3d20 3020 3a20 7265 7475  oor) == 0 : retu
+00009e50: 726e 204e 6f6e 652c 4e6f 6e65 2c4e 6f6e  rn None,None,Non
+00009e60: 650d 0a20 2020 2020 2020 2020 2020 2065  e..            e
+00009e70: 6669 203d 2073 656c 662e 6566 496e 6469  fi = self.efIndi
+00009e80: 6365 734c 6973 740d 0a20 2020 2020 2020  cesList..       
+00009e90: 2020 2020 206e 756d 6258 6564 6765 7320       numbXedges 
+00009ea0: 3d20 6c65 6e28 6576 6978 290d 0a20 2020  = len(evix)..   
+00009eb0: 2020 2020 2020 2020 2066 696e 6465 7844           findexD
+00009ec0: 6963 7420 3d20 7b7d 2020 2320 6661 6365  ict = {}  # face
+00009ed0: 7328 6b65 793d 6661 6365 2069 6e64 6578  s(key=face index
+00009ee0: 2920 7768 6963 6820 6861 7665 2074 776f  ) which have two
+00009ef0: 2065 6467 6573 2028 7661 6c75 653d 7843   edges (value=xC
+00009f00: 6f6f 7220 696e 6465 7829 0d0a 2020 2020  oor index)..    
+00009f10: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
+00009f20: 2072 616e 6765 286e 756d 6258 6564 6765   range(numbXedge
+00009f30: 7329 203a 0d0a 2020 2020 2020 2020 2020  s) :..          
+00009f40: 2020 2020 2020 6569 203d 2065 7669 785b        ei = evix[
+00009f50: 695d 0d0a 2020 2020 2020 2020 2020 2020  i]..            
+00009f60: 2020 2020 6566 6941 7272 203d 2065 6669      efiArr = efi
+00009f70: 5b65 695d 0d0a 2020 2020 2020 2020 2020  [ei]..          
+00009f80: 2020 2020 2020 666f 7220 6669 2069 6e20        for fi in 
+00009f90: 6566 6941 7272 203a 0d0a 2020 2020 2020  efiArr :..      
+00009fa0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00009fb0: 2066 6920 696e 2066 696e 6465 7844 6963   fi in findexDic
+00009fc0: 7420 3a0d 0a20 2020 2020 2020 2020 2020  t :..           
+00009fd0: 2020 2020 2020 2020 2020 2020 2063 7572               cur
+00009fe0: 5661 6c20 3d20 6669 6e64 6578 4469 6374  Val = findexDict
+00009ff0: 5b66 695d 0d0a 2020 2020 2020 2020 2020  [fi]..          
+0000a000: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0000a010: 2069 7369 6e73 7461 6e63 6528 6375 7256   isinstance(curV
+0000a020: 616c 2c6c 6973 7429 203a 0d0a 2020 2020  al,list) :..    
+0000a030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a040: 2020 2020 2020 2020 2320 4465 764e 6f74          # DevNot
+0000a050: 653a 2074 6869 7320 6d6f 6469 6669 6361  e: this modifica
+0000a060: 7469 6f6e 7320 6973 2061 2063 6f6e 7365  tions is a conse
+0000a070: 7175 656e 6365 206f 6620 7175 6164 7269  quence of quadri
+0000a080: 6c61 7465 7261 6c0d 0a20 2020 2020 2020  lateral..       
+0000a090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a0a0: 2020 2020 2023 2066 6163 6573 2c20 7768       # faces, wh
+0000a0b0: 6963 6820 6d61 7920 6861 7665 206d 6f72  ich may have mor
+0000a0c0: 6520 7468 616e 206f 6e65 2069 6e74 6572  e than one inter
+0000a0d0: 7365 6374 696f 6f6e 2074 6f20 6120 706c  sectioon to a pl
+0000a0e0: 616e 652e 0d0a 2020 2020 2020 2020 2020  ane...          
+0000a0f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a100: 2020 2320 5468 6973 206f 6e6c 7920 656c    # This only el
+0000a110: 696d 696e 6174 6573 2072 756e 7469 6d65  iminates runtime
+0000a120: 2065 7272 6f72 2e20 2053 6f6c 7574 696f   error.  Solutio
+0000a130: 6e20 6973 2074 6f20 7573 6520 6120 7375  n is to use a su
+0000a140: 7266 6163 650d 0a20 2020 2020 2020 2020  rface..         
+0000a150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a160: 2020 2023 2077 6974 6820 6c72 657a 203e     # with lrez >
+0000a170: 2030 2c20 7468 656e 2067 656e 6572 6174   0, then generat
+0000a180: 6564 2063 6f6e 746f 7572 732e 200d 0a20  ed contours. .. 
+0000a190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a1a0: 2020 2020 2020 2020 2020 206e 6577 5661             newVa
+0000a1b0: 6c20 3d20 5b63 7572 5661 6c5b 305d 2c69  l = [curVal[0],i
+0000a1c0: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
+0000a1d0: 2020 2020 2020 2020 2020 2065 6c73 6520             else 
+0000a1e0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0000a1f0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+0000a200: 6577 5661 6c20 3d20 5b63 7572 5661 6c2c  ewVal = [curVal,
+0000a210: 695d 2020 2020 2020 2020 2020 2020 2020  i]              
+0000a220: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
+0000a230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a240: 2020 2066 696e 6465 7844 6963 745b 6669     findexDict[fi
+0000a250: 5d20 3d20 6e65 7756 616c 0d0a 2020 2020  ] = newVal..    
+0000a260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a270: 656c 7365 203a 0d0a 2020 2020 2020 2020  else :..        
+0000a280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a290: 6669 6e64 6578 4469 6374 5b66 695d 203d  findexDict[fi] =
+0000a2a0: 2069 0d0a 2020 2020 2020 2020 2020 2020   i..            
+0000a2b0: 2320 7265 6d6f 7665 2066 6163 6520 696e  # remove face in
+0000a2c0: 7465 7273 6574 2070 6f69 6e74 7320 6966  terset points if
+0000a2d0: 2066 6163 6520 6f6e 6c79 2068 6173 206f   face only has o
+0000a2e0: 6e65 2069 6e74 6572 7365 6374 2065 6467  ne intersect edg
+0000a2f0: 650d 0a20 2020 2020 2020 2020 2020 2023  e..            #
+0000a300: 2028 2069 6e74 6572 7365 6374 206d 6179   ( intersect may
+0000a310: 2062 6520 6f6e 2061 2076 6572 7465 7820   be on a vertex 
+0000a320: 290d 0a20 2020 2020 2020 2020 2020 2023  )..            #
+0000a330: 0d0a 2020 2020 2020 2020 2020 2020 7465  ..            te
+0000a340: 7374 203d 205b 2078 2066 6f72 2078 2069  st = [ x for x i
+0000a350: 6e20 6669 6e64 6578 4469 6374 2e76 616c  n findexDict.val
+0000a360: 7565 7328 2920 6966 2074 7970 6528 7829  ues() if type(x)
+0000a370: 2069 7320 6c69 7374 205d 0d0a 2020 2020   is list ]..    
+0000a380: 2020 2020 2020 2020 6966 206c 656e 2874          if len(t
+0000a390: 6573 7429 203d 3d20 3020 3a20 7265 7475  est) == 0 : retu
+0000a3a0: 726e 204e 6f6e 652c 4e6f 6e65 2c4e 6f6e  rn None,None,Non
+0000a3b0: 650d 0a20 2020 2020 2020 2020 2020 2023  e..            #
+0000a3c0: 0d0a 2020 2020 2020 2020 2020 2020 6661  ..            fa
+0000a3d0: 6365 2c20 636f 6f72 496e 7820 3d20 5b5d  ce, coorInx = []
+0000a3e0: 2c20 5b5d 0d0a 2020 2020 2020 2020 2020  , []..          
+0000a3f0: 2020 666f 7220 6b65 792c 7661 6c75 6520    for key,value 
+0000a400: 696e 2066 696e 6465 7844 6963 742e 6974  in findexDict.it
+0000a410: 656d 7328 2920 3a0d 0a20 2020 2020 2020  ems() :..       
+0000a420: 2020 2020 2020 2020 2069 6620 7479 7065           if type
+0000a430: 2876 616c 7565 2920 6973 206c 6973 7420  (value) is list 
+0000a440: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0000a450: 2020 2020 2020 2076 616c 7565 5820 3d20         valueX = 
+0000a460: 6f72 6465 725f 7661 6c75 6528 6b65 792c  order_value(key,
+0000a470: 7661 6c75 652c 7843 6f6f 722c 7072 6f6a  value,xCoor,proj
+0000a480: 5665 6374 290d 0a20 2020 2020 2020 2020  Vect)..         
+0000a490: 2020 2020 2020 2020 2020 2063 6f6f 7249             coorI
+0000a4a0: 6e78 2e61 7070 656e 6428 7661 6c75 6558  nx.append(valueX
+0000a4b0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0000a4c0: 2020 2020 2020 2066 6163 652e 6170 7065         face.appe
+0000a4d0: 6e64 286b 6579 290d 0a0d 0a20 2020 2020  nd(key)....     
+0000a4e0: 2020 2020 2020 2069 6620 6c65 6e28 636f         if len(co
+0000a4f0: 6f72 496e 7829 203d 3d20 3020 3a20 7265  orInx) == 0 : re
+0000a500: 7475 726e 204e 6f6e 652c 4e6f 6e65 2c4e  turn None,None,N
+0000a510: 6f6e 650d 0a20 2020 2020 2020 2020 2020  one..           
+0000a520: 2072 6574 7572 6e20 6e70 2e61 7272 6179   return np.array
+0000a530: 2878 436f 6f72 292c 2063 6f6f 7249 6e78  (xCoor), coorInx
+0000a540: 2c20 6661 6365 0d0a 2020 2020 2020 2020  , face..        
+0000a550: 2320 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  # --------------
+0000a560: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000a570: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000a580: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000a590: 2d0d 0a20 2020 2020 2020 2064 6566 2067  -..        def g
+0000a5a0: 6574 436f 6c6f 7273 2863 6f6c 6f72 732c  etColors(colors,
+0000a5b0: 2069 6e64 6963 6573 2920 3a0d 0a20 2020   indices) :..   
+0000a5c0: 2020 2020 2020 2020 2063 6f6e 5f63 6f6c           con_col
+0000a5d0: 6f72 7320 3d20 5b4e 6f6e 655d 2a6c 656e  ors = [None]*len
+0000a5e0: 2869 6e64 6963 6573 290d 0a20 2020 2020  (indices)..     
+0000a5f0: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
+0000a600: 7261 6e67 6528 6c65 6e28 696e 6469 6365  range(len(indice
+0000a610: 7329 2920 3a0d 0a20 2020 2020 2020 2020  s)) :..         
+0000a620: 2020 2020 2020 2063 6f6e 5f63 6f6c 6f72         con_color
+0000a630: 735b 695d 203d 2063 6f6c 6f72 735b 696e  s[i] = colors[in
+0000a640: 6469 6365 735b 695d 5d0d 0a20 2020 2020  dices[i]]..     
+0000a650: 2020 2020 2020 2072 6574 7572 6e20 636f         return co
+0000a660: 6e5f 636f 6c6f 7273 0d0a 2020 2020 2020  n_colors..      
+0000a670: 2020 2320 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    # ------------
+0000a680: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000a690: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000a6a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000a6b0: 2d2d 2d0d 0a20 2020 2020 2020 2023 2067  ---..        # g
+0000a6c0: 6574 2074 6865 2073 7572 6661 6365 2063  et the surface c
+0000a6d0: 6f6c 6f72 7320 7768 6963 6820 7769 6c6c  olors which will
+0000a6e0: 2062 6520 6170 706c 6965 6420 746f 2074   be applied to t
+0000a6f0: 6865 2064 6566 6175 6c74 2063 6f6e 746f  he default conto
+0000a700: 7572 2063 6f6c 6f72 730d 0a20 2020 2020  ur colors..     
+0000a710: 2020 2073 656c 662e 5f70 6f73 7450 726f     self._postPro
+0000a720: 635f 7375 7266 6163 6543 6f6c 6f72 7328  c_surfaceColors(
+0000a730: 290d 0a20 2020 2020 2020 2073 7572 665f  )..        surf_
+0000a740: 636f 6c6f 7273 203d 2073 656c 662e 5f64  colors = self._d
+0000a750: 6661 6365 636f 6c6f 7273 2020 2320 7570  facecolors  # up
+0000a760: 6461 7465 2066 6f72 2076 5f31 2e32 2e30  date for v_1.2.0
+0000a770: 0d0a 0d0a 2020 2020 2020 2020 6966 2074  ....        if t
+0000a780: 7970 6528 6172 6773 5b30 5d29 2069 7320  ype(args[0]) is 
+0000a790: 7475 706c 6520 3a20 6172 6773 3d61 7267  tuple : args=arg
+0000a7a0: 735b 305d 0d0a 2020 2020 2020 2020 6c69  s[0]..        li
+0000a7b0: 6e65 203d 204e 6f6e 650d 0a20 2020 2020  ne = None..     
+0000a7c0: 2020 2066 6f72 2061 4c65 6e20 696e 2061     for aLen in a
+0000a7d0: 7267 7320 3a0d 0a20 2020 2020 2020 2020  rgs :..         
+0000a7e0: 2020 2076 6572 7465 7843 6f6f 722c 7365     vertexCoor,se
+0000a7f0: 676d 496e 6469 6365 732c 6661 6365 496e  gmIndices,faceIn
+0000a800: 6469 6365 7320 3d20 6765 744c 696e 6556  dices = getLineV
+0000a810: 616c 7328 2064 6f74 7072 6f64 2c61 4c65  als( dotprod,aLe
+0000a820: 6e2c 7072 6f6a 5665 6374 2020 290d 0a20  n,projVect  ).. 
+0000a830: 2020 2020 2020 2020 2020 2069 6620 7665             if ve
+0000a840: 7274 6578 436f 6f72 2069 7320 4e6f 6e65  rtexCoor is None
+0000a850: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
+0000a860: 2020 2020 7761 726e 696e 6773 2e77 6172      warnings.war
+0000a870: 6e28 2027 5375 7266 6163 6520 636f 6e74  n( 'Surface cont
+0000a880: 6f75 724c 696e 6573 206e 6f74 2066 6f75  ourLines not fou
+0000a890: 6e64 2066 6f72 2064 6973 7420 7661 6c75  nd for dist valu
+0000a8a0: 6520 6f66 207b 7d27 2e66 6f72 6d61 7428  e of {}'.format(
+0000a8b0: 614c 656e 2920 290d 0a20 2020 2020 2020  aLen) )..       
+0000a8c0: 2020 2020 2020 2020 2063 6f6e 7469 6e75           continu
+0000a8d0: 650d 0a20 2020 2020 2020 2020 2020 2074  e..            t
+0000a8e0: 6c69 6e65 203d 2043 6f6c 6f72 4c69 6e65  line = ColorLine
+0000a8f0: 3344 436f 6c6c 6563 7469 6f6e 2876 6572  3DCollection(ver
+0000a900: 7465 7843 6f6f 722c 7365 676d 496e 6469  texCoor,segmIndi
+0000a910: 6365 7329 0d0a 2020 2020 2020 2020 2020  ces)..          
+0000a920: 2020 6966 2074 6c69 6e65 2069 7320 4e6f    if tline is No
+0000a930: 6e65 203a 2063 6f6e 7469 6e75 650d 0a20  ne : continue.. 
+0000a940: 2020 2020 2020 2020 2020 2074 6c69 6e65             tline
+0000a950: 2e73 6574 5f63 6f6c 6f72 2867 6574 436f  .set_color(getCo
+0000a960: 6c6f 7273 2873 7572 665f 636f 6c6f 7273  lors(surf_colors
+0000a970: 2c66 6163 6549 6e64 6963 6573 2929 2023  ,faceIndices)) #
+0000a980: 2064 6566 6175 6c74 2073 7572 6661 6365   default surface
+0000a990: 2063 6f6c 6f72 0d0a 2020 2020 2020 2020   color..        
+0000a9a0: 2020 2020 6966 206c 696e 6520 6973 204e      if line is N
+0000a9b0: 6f6e 653a 206c 696e 6520 3d20 746c 696e  one: line = tlin
+0000a9c0: 650d 0a20 2020 2020 2020 2020 2020 2065  e..            e
+0000a9d0: 6c73 653a 206c 696e 6520 2b3d 2074 6c69  lse: line += tli
+0000a9e0: 6e65 200d 0a20 2020 2020 2020 2072 6574  ne ..        ret
+0000a9f0: 7572 6e20 6c69 6e65 0d0a 0d0a 2020 2020  urn line....    
+0000aa00: 6465 6620 5f74 7261 6e73 666f 726d 5665  def _transformVe
+0000aa10: 6374 6f72 2873 656c 662c 206f 7267 436f  ctor(self, orgCo
+0000aa20: 6f72 2c20 6f70 6572 6174 696f 6e2c 2072  or, operation, r
+0000aa30: 6574 7572 6e78 797a 2920 3a0d 0a20 2020  eturnxyz) :..   
+0000aa40: 2020 2020 2022 2222 2046 756e 6374 696f       """ Functio
+0000aa50: 6e61 6c20 7472 616e 7366 6f72 6d61 7469  nal transformati
+0000aa60: 6f6e 206f 6620 636f 6f72 6469 6e61 7465  on of coordinate
+0000aa70: 732e 2022 2222 0d0a 2020 2020 2020 2020  s. """..        
+0000aa80: 7879 7a20 3d20 6e70 2e74 7261 6e73 706f  xyz = np.transpo
+0000aa90: 7365 286f 7267 436f 6f72 290d 0a20 2020  se(orgCoor)..   
+0000aaa0: 2020 2020 2061 6263 203d 2073 656c 662e       abc = self.
+0000aab0: 636f 6f72 5f63 6f6e 7665 7274 2878 797a  coor_convert(xyz
+0000aac0: 290d 0a20 2020 2020 2020 2072 7374 203d  )..        rst =
+0000aad0: 206e 702e 6172 7261 7928 6f70 6572 6174   np.array(operat
+0000aae0: 696f 6e28 6162 6329 290d 0a20 2020 2020  ion(abc))..     
+0000aaf0: 2020 2069 6620 7265 7475 726e 7879 7a20     if returnxyz 
+0000ab00: 3a20 5859 5a20 3d20 7273 740d 0a20 2020  : XYZ = rst..   
+0000ab10: 2020 2020 2065 6c73 6520 3a20 2020 2020       else :     
+0000ab20: 2020 2020 5859 5a20 3d20 7365 6c66 2e63      XYZ = self.c
+0000ab30: 6f6f 725f 636f 6e76 6572 7428 2072 7374  oor_convert( rst
+0000ab40: 202c 2074 6f63 6172 743d 5472 7565 2029   , tocart=True )
+0000ab50: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+0000ab60: 206e 702e 7472 616e 7370 6f73 6528 5859   np.transpose(XY
+0000ab70: 5a29 0d0a 0d0a 2020 2020 6465 6620 5f67  Z)....    def _g
+0000ab80: 6574 5f76 6563 746f 7266 6965 6c64 5f4c  et_vectorfield_L
+0000ab90: 696e 6533 4443 6f6c 6c65 6374 696f 6e28  ine3DCollection(
+0000aba0: 7365 6c66 2c20 7665 6374 6f72 5f66 6965  self, vector_fie
+0000abb0: 6c64 2c20 636f 6c6f 722c 2077 6964 7468  ld, color, width
+0000abc0: 2c20 616c 7229 203a 0d0a 2020 2020 2020  , alr) :..      
+0000abd0: 2020 2222 2256 6563 746f 7233 4443 6f6c    """Vector3DCol
+0000abe0: 6c65 6374 696f 6e20 6174 2073 7572 6661  lection at surfa
+0000abf0: 6365 2076 6572 7469 6365 732e 2222 2220  ce vertices.""" 
+0000ac00: 0d0a 0d0a 2020 2020 2020 2020 7365 6c66  ....        self
+0000ac10: 2e76 6563 746f 725f 6669 656c 6420 3d20  .vector_field = 
+0000ac20: 7665 6374 6f72 5f66 6965 6c64 0d0a 2020  vector_field..  
+0000ac30: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+0000ac40: 6c63 6f6c 203d 2056 6563 746f 7233 4443  lcol = Vector3DC
+0000ac50: 6f6c 6c65 6374 696f 6e28 7365 6c66 2e76  ollection(self.v
+0000ac60: 6572 7465 7843 6f6f 722c 7665 6374 6f72  ertexCoor,vector
+0000ac70: 5f66 6965 6c64 2c61 6c72 2c63 6f6c 6f72  _field,alr,color
+0000ac80: 733d 636f 6c6f 722c 206c 696e 6577 6964  s=color, linewid
+0000ac90: 7468 733d 7769 6474 6829 0d0a 2020 2020  ths=width)..    
+0000aca0: 2020 2020 2320 2d2d 2d20 312e 3120 6d6f      # --- 1.1 mo
+0000acb0: 6420 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  d --------------
+0000acc0: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
+0000acd0: 6c63 6f6c 2e63 6f6f 7254 7970 6520 3d20  lcol.coorType = 
+0000ace0: 7365 6c66 2e63 6f6f 7254 7970 650d 0a20  self.coorType.. 
+0000acf0: 2020 2020 2020 206c 636f 6c2e 7576 774f         lcol.uvwO
+0000ad00: 7269 656e 7461 7469 6f6e 5479 7065 203d  rientationType =
+0000ad10: 2073 656c 662e 636f 6f72 5479 7065 0d0a   self.coorType..
+0000ad20: 2020 2020 2020 2020 7265 7475 726e 206c          return l
+0000ad30: 636f 6c0d 0a0d 0a20 2020 2064 6566 205f  col....    def _
+0000ad40: 6765 745f 7665 7274 6578 5f6e 6f72 6d61  get_vertex_norma
+0000ad50: 6c73 2873 656c 6629 203a 0d0a 2020 2020  ls(self) :..    
+0000ad60: 2020 2020 2222 2255 6e69 7420 6e6f 726d      """Unit norm
+0000ad70: 616c 7320 6f66 2061 7420 7665 7274 6578  als of at vertex
+0000ad80: 2063 6f6f 7264 696e 6174 6573 2e20 2222   coordinates. ""
+0000ad90: 220d 0a0d 0a20 2020 2020 2020 2023 2054  "....        # T
+0000ada0: 6865 206e 6f72 6d61 6c69 7a65 6420 756e  he normalized un
+0000adb0: 7765 6967 6874 6564 2061 7665 7261 6765  weighted average
+0000adc0: 206f 6620 7468 6520 7375 7266 6163 650d   of the surface.
+0000add0: 0a20 2020 2020 2020 2023 206e 6f72 6d61  .        # norma
+0000ade0: 6c73 206f 6620 7468 6520 6661 6365 7320  ls of the faces 
+0000adf0: 7468 6174 2063 6f6e 7461 696e 2074 6861  that contain tha
+0000ae00: 7420 7665 7274 6578 2e0d 0a0d 0a20 2020  t vertex.....   
+0000ae10: 2020 2020 2076 6572 7473 203d 2073 656c       verts = sel
+0000ae20: 662e 7665 7274 6578 436f 6f72 5b20 7365  f.vertexCoor[ se
+0000ae30: 6c66 2e66 7649 6e64 6963 6573 205d 0d0a  lf.fvIndices ]..
+0000ae40: 2020 2020 2020 2020 6661 6365 4e6f 726d          faceNorm
+0000ae50: 616c 436f 6f72 203d 2073 656c 662e 5f67  alCoor = self._g
+0000ae60: 6574 5f66 6163 655f 6e6f 726d 616c 7328  et_face_normals(
+0000ae70: 7665 7274 7329 0d0a 2020 2020 2020 2020  verts)..        
+0000ae80: 2320 6e6f 7465 3a20 666f 6c6c 6f77 696e  # note: followin
+0000ae90: 6720 6c69 7374 2061 7265 2074 6865 2066  g list are the f
+0000aea0: 6163 6520 696e 6469 6365 7320 7468 6174  ace indices that
+0000aeb0: 2065 6163 6820 7665 7274 6578 2069 7320   each vertex is 
+0000aec0: 6120 6d65 6d62 6572 2e0d 0a20 2020 2020  a member...     
+0000aed0: 2020 2023 2020 2020 2020 2053 696e 6365     #       Since
+0000aee0: 2074 6865 206e 756d 6265 7220 6f66 2066   the number of f
+0000aef0: 6163 6573 2061 2076 6572 7465 7820 6973  aces a vertex is
+0000af00: 2061 7474 6163 6865 6420 7261 6e67 6573   attached ranges
+0000af10: 2066 726f 6d20 3120 2d20 362c 0d0a 2020   from 1 - 6,..  
+0000af20: 2020 2020 2020 2320 2020 2020 2020 6e65        #       ne
+0000af30: 6564 7320 6120 6c69 7374 2c20 6e6f 7420  eds a list, not 
+0000af40: 616e 206e 702e 6172 7261 792e 0d0a 2020  an np.array...  
+0000af50: 2020 2020 2020 7666 496e 6469 6365 734c        vfIndicesL
+0000af60: 6973 7420 3d20 5b20 4e6f 6e65 205d 202a  ist = [ None ] *
+0000af70: 6c65 6e28 7365 6c66 2e76 6572 7465 7843  len(self.vertexC
+0000af80: 6f6f 7229 0d0a 2020 2020 2020 2020 666f  oor)..        fo
+0000af90: 7220 6920 696e 2072 616e 6765 286c 656e  r i in range(len
+0000afa0: 2876 6649 6e64 6963 6573 4c69 7374 2929  (vfIndicesList))
+0000afb0: 203a 2076 6649 6e64 6963 6573 4c69 7374   : vfIndicesList
+0000afc0: 5b69 5d20 3d20 5b5d 0d0a 0d0a 2020 2020  [i] = []....    
+0000afd0: 2020 2020 666f 7220 6649 6e78 2069 6e20      for fInx in 
+0000afe0: 7261 6e67 6528 206c 656e 2873 656c 662e  range( len(self.
+0000aff0: 6676 496e 6469 6365 7329 2029 203a 0d0a  fvIndices) ) :..
+0000b000: 2020 2020 2020 2020 2020 2020 6661 6365              face
+0000b010: 203d 2073 656c 662e 6676 496e 6469 6365   = self.fvIndice
+0000b020: 735b 6649 6e78 5d0d 0a20 2020 2020 2020  s[fInx]..       
+0000b030: 2020 2020 2066 6f72 2076 496e 7820 696e       for vInx in
+0000b040: 2066 6163 6520 3a0d 0a20 2020 2020 2020   face :..       
+0000b050: 2020 2020 2020 2020 2076 6649 6e64 6963           vfIndic
+0000b060: 6573 4c69 7374 5b76 496e 785d 2e61 7070  esList[vInx].app
+0000b070: 656e 6428 6649 6e78 290d 0a0d 0a20 2020  end(fInx)....   
+0000b080: 2020 2020 2023 2044 6576 4e6f 7465 3a20       # DevNote: 
+0000b090: 7072 6f62 6162 6c79 2061 2027 636c 6561  probably a 'clea
+0000b0a0: 6e65 7227 206d 6574 686f 643f 2020 4d52  ner' method?  MR
+0000b0b0: 4f49 0d0a 2020 2020 2020 2020 6e6f 726d  OI..        norm
+0000b0c0: 616c 7320 3d20 5b20 4e6f 6e65 205d 202a  als = [ None ] *
+0000b0d0: 6c65 6e28 7365 6c66 2e76 6572 7465 7843  len(self.vertexC
+0000b0e0: 6f6f 7229 0d0a 2020 2020 2020 2020 666f  oor)..        fo
+0000b0f0: 7220 6920 696e 2072 616e 6765 286c 656e  r i in range(len
+0000b100: 286e 6f72 6d61 6c73 2929 203a 0d0a 2020  (normals)) :..  
+0000b110: 2020 2020 2020 2020 2020 7665 7274 203d            vert =
+0000b120: 2076 6649 6e64 6963 6573 4c69 7374 5b69   vfIndicesList[i
+0000b130: 5d0d 0a20 2020 2020 2020 2020 2020 2076  ]..            v
+0000b140: 6572 744c 6973 7420 3d20 6661 6365 4e6f  ertList = faceNo
+0000b150: 726d 616c 436f 6f72 5b20 7665 7274 205d  rmalCoor[ vert ]
+0000b160: 0d0a 2020 2020 2020 2020 2020 2020 7665  ..            ve
+0000b170: 7274 5375 6d20 3d20 6e70 2e73 756d 2876  rtSum = np.sum(v
+0000b180: 6572 744c 6973 742c 6178 6973 3d30 292f  ertList,axis=0)/
+0000b190: 6c65 6e28 7665 7274 4c69 7374 290d 0a20  len(vertList).. 
+0000b1a0: 2020 2020 2020 2020 2020 2075 6e69 7456             unitV
+0000b1b0: 6563 746f 7220 3d20 6e70 2e64 6976 6964  ector = np.divid
+0000b1c0: 6528 2076 6572 7453 756d 2c20 6e70 2e6c  e( vertSum, np.l
+0000b1d0: 696e 616c 672e 6e6f 726d 2876 6572 7453  inalg.norm(vertS
+0000b1e0: 756d 2920 290d 0a20 2020 2020 2020 2020  um) )..         
+0000b1f0: 2020 206e 6f72 6d61 6c73 5b69 5d20 3d20     normals[i] = 
+0000b200: 756e 6974 5665 6374 6f72 0d0a 0d0a 2020  unitVector....  
+0000b210: 2020 2020 2020 6e6f 726d 616c 7320 3d20        normals = 
+0000b220: 6e70 2e61 7272 6179 286e 6f72 6d61 6c73  np.array(normals
+0000b230: 290d 0a20 2020 2020 2020 2072 6574 7572  )..        retur
+0000b240: 6e20 6e6f 726d 616c 730d 0a0d 0a20 2020  n normals....   
+0000b250: 2064 6566 205f 6765 745f 6661 6365 5f6e   def _get_face_n
+0000b260: 6f72 6d61 6c73 2873 656c 662c 6661 6365  ormals(self,face
+0000b270: 436f 6f72 2c61 7573 663d 4e6f 6e65 2920  Coor,ausf=None) 
+0000b280: 3a0d 0a20 2020 2020 2020 2022 2222 2055  :..        """ U
+0000b290: 6e69 7420 6e6f 726d 616c 7320 6f66 2074  nit normals of t
+0000b2a0: 7269 616e 6775 6c61 7220 6661 6365 2063  riangular face c
+0000b2b0: 6f6f 7264 696e 6174 6573 2e22 2222 0d0a  oordinates."""..
+0000b2c0: 0d0a 2020 2020 2020 2020 7666 5420 3d20  ..        vfT = 
+0000b2d0: 6e70 2e74 7261 6e73 706f 7365 2866 6163  np.transpose(fac
+0000b2e0: 6543 6f6f 722c 2028 312c 322c 3029 2029  eCoor, (1,2,0) )
+0000b2f0: 0d0a 2020 2020 2020 2020 7641 4220 3d20  ..        vAB = 
+0000b300: 6e70 2e73 7562 7472 6163 7428 2076 6654  np.subtract( vfT
+0000b310: 5b31 5d2c 2076 6654 5b30 5d20 2029 0d0a  [1], vfT[0]  )..
+0000b320: 2020 2020 2020 2020 7641 4320 3d20 6e70          vAC = np
+0000b330: 2e73 7562 7472 6163 7428 2076 6654 5b32  .subtract( vfT[2
+0000b340: 5d2c 2076 6654 5b30 5d20 2029 0d0a 2020  ], vfT[0]  )..  
+0000b350: 2020 2020 2020 7641 4274 203d 206e 702e        vABt = np.
+0000b360: 7472 616e 7370 6f73 6528 7641 4229 0d0a  transpose(vAB)..
+0000b370: 2020 2020 2020 2020 7641 4374 203d 206e          vACt = n
+0000b380: 702e 7472 616e 7370 6f73 6528 7641 4329  p.transpose(vAC)
+0000b390: 0d0a 2020 2020 2020 2020 6966 2061 7573  ..        if aus
+0000b3a0: 6620 6973 206e 6f74 204e 6f6e 653a 0d0a  f is not None:..
+0000b3b0: 2020 2020 2020 2020 2020 2020 7641 4274              vABt
+0000b3c0: 203d 2076 4142 742a 6175 7366 0d0a 2020   = vABt*ausf..  
+0000b3d0: 2020 2020 2020 2020 2020 7641 4374 203d            vACt =
+0000b3e0: 2076 4143 742a 6175 7366 0d0a 2020 2020   vACt*ausf..    
+0000b3f0: 2020 2020 6372 6f73 7320 3d20 6e70 2e63      cross = np.c
+0000b400: 726f 7373 2876 4142 742c 7641 4374 290d  ross(vABt,vACt).
+0000b410: 0a20 2020 2020 2020 2073 7a20 3d20 6e70  .        sz = np
+0000b420: 2e6c 696e 616c 672e 6e6f 726d 2863 726f  .linalg.norm(cro
+0000b430: 7373 2c61 7869 733d 3129 5b3a 2c6e 702e  ss,axis=1)[:,np.
+0000b440: 6e65 7761 7869 735d 0d0a 2020 2020 2020  newaxis]..      
+0000b450: 2020 7265 7475 726e 206e 702e 6469 7669    return np.divi
+0000b460: 6465 2863 726f 7373 2c73 7a29 0d0a 0d0a  de(cross,sz)....
+0000b470: 2020 2020 6465 6620 5f67 6574 5f66 6163      def _get_fac
+0000b480: 655f 6365 6e74 6572 7328 7365 6c66 2c66  e_centers(self,f
+0000b490: 6163 6543 6f6f 7229 203a 0d0a 2020 2020  aceCoor) :..    
+0000b4a0: 2020 2020 2222 2220 4661 6365 2063 656e      """ Face cen
+0000b4b0: 7465 7273 2066 726f 6d20 6661 6365 2076  ters from face v
+0000b4c0: 6572 7465 7820 636f 6f72 6469 6e61 7465  ertex coordinate
+0000b4d0: 732e 2022 2222 0d0a 2020 2020 2020 2020  s. """..        
+0000b4e0: 7666 5420 3d20 6e70 2e74 7261 6e73 706f  vfT = np.transpo
+0000b4f0: 7365 2866 6163 6543 6f6f 722c 2028 312c  se(faceCoor, (1,
+0000b500: 322c 3029 2029 0d0a 2020 2020 2020 2020  2,0) )..        
+0000b510: 6e75 6d56 6572 7473 203d 2076 6654 2e73  numVerts = vfT.s
+0000b520: 6861 7065 5b30 5d0d 0a20 2020 2020 2020  hape[0]..       
+0000b530: 2073 756d 5620 3d20 6e70 2e73 756d 2876   sumV = np.sum(v
+0000b540: 6654 2c20 6178 6973 3d30 290d 0a20 2020  fT, axis=0)..   
+0000b550: 2020 2020 2072 6574 7572 6e20 6e70 2e74       return np.t
+0000b560: 7261 6e73 706f 7365 2873 756d 5629 2f6e  ranspose(sumV)/n
+0000b570: 756d 5665 7274 730d 0a0d 0a20 2020 2064  umVerts....    d
+0000b580: 6566 205f 7365 745f 6765 6f6d 6574 7269  ef _set_geometri
+0000b590: 635f 626f 756e 6473 2873 656c 6629 203a  c_bounds(self) :
+0000b5a0: 0d0a 2020 2020 2020 2020 2222 2220 7365  ..        """ se
+0000b5b0: 7420 7468 6520 626f 756e 6473 2064 6963  t the bounds dic
+0000b5c0: 7469 6f6e 6172 7920 6672 6f6d 2073 7572  tionary from sur
+0000b5d0: 6661 6365 2076 6572 7465 7820 636f 6f72  face vertex coor
+0000b5e0: 6469 6e61 7465 732e 2022 2222 0d0a 2020  dinates. """..  
+0000b5f0: 2020 2020 2020 5f73 6574 5f67 656f 6d42        _set_geomB
+0000b600: 6f75 6e64 7328 7365 6c66 2e76 6572 7465  ounds(self.verte
+0000b610: 7843 6f6f 722c 7365 6c66 2e5f 626f 756e  xCoor,self._boun
+0000b620: 6473 290d 0a20 2020 2020 2020 2072 6574  ds)..        ret
+0000b630: 7572 6e20 2020 200d 0a0d 0a20 2020 2064  urn    ....    d
+0000b640: 6566 205f 7669 6577 706f 7274 436f 6f72  ef _viewportCoor
+0000b650: 2873 656c 662c 7879 7a43 6f6f 722c 7669  (self,xyzCoor,vi
+0000b660: 6577 706f 7274 3d4e 6f6e 6529 203a 0d0a  ewport=None) :..
+0000b670: 2020 2020 2020 2020 2222 2220 5556 2063          """ UV c
+0000b680: 6f6f 7264 696e 6174 6573 2066 6f72 2069  oordinates for i
+0000b690: 6d61 6765 2074 6578 7475 7265 206d 6170  mage texture map
+0000b6a0: 7069 6e67 2022 2222 0d0a 2020 2020 2020  ping """..      
+0000b6b0: 2020 2320 6265 7474 6572 2077 6179 2074    # better way t
+0000b6c0: 6f20 646f 2074 6869 733f 204d 524f 490d  o do this? MROI.
+0000b6d0: 0a20 2020 2020 2020 2078 797a 203d 206e  .        xyz = n
+0000b6e0: 702e 7472 616e 7370 6f73 6528 7879 7a43  p.transpose(xyzC
+0000b6f0: 6f6f 7229 0d0a 2020 2020 2020 2020 6162  oor)..        ab
+0000b700: 203d 2073 656c 662e 5f6d 6170 3344 746f   = self._map3Dto
+0000b710: 3244 7371 7561 7265 2820 7879 7a20 290d  2Dsquare( xyz ).
+0000b720: 0a20 2020 2020 2020 2061 2c62 203d 2061  .        a,b = a
+0000b730: 620d 0a20 2020 2020 2020 2069 6620 7669  b..        if vi
+0000b740: 6577 706f 7274 2069 7320 4e6f 6e65 203a  ewport is None :
+0000b750: 2072 6574 7572 6e20 612c 622c 6e70 2e66   return a,b,np.f
+0000b760: 756c 6c28 6c65 6e28 6129 2c54 7275 6529  ull(len(a),True)
+0000b770: 0d0a 2020 2020 2020 2020 4173 2c42 732c  ..        As,Bs,
+0000b780: 4165 2c42 6520 3d20 7669 6577 706f 7274  Ae,Be = viewport
+0000b790: 0d0a 2020 2020 2020 2020 4172 6566 203d  ..        Aref =
+0000b7a0: 2031 2e30 2d41 730d 0a20 2020 2020 2020   1.0-As..       
+0000b7b0: 2042 7265 6620 3d20 312e 302d 4273 0d0a   Bref = 1.0-Bs..
+0000b7c0: 2020 2020 2020 2020 4164 656c 7461 203d          Adelta =
+0000b7d0: 206e 702e 6d6f 6428 4165 2b41 7265 662c   np.mod(Ae+Aref,
+0000b7e0: 312e 3029 0d0a 2020 2020 2020 2020 4264  1.0)..        Bd
+0000b7f0: 656c 7461 203d 206e 702e 6d6f 6428 4265  elta = np.mod(Be
+0000b800: 2b42 7265 662c 312e 3029 0d0a 2020 2020  +Bref,1.0)..    
+0000b810: 2020 2020 6966 2041 6465 6c74 6120 3c3d      if Adelta <=
+0000b820: 302e 3020 3a20 4164 656c 7461 203d 2031  0.0 : Adelta = 1
+0000b830: 2e30 0d0a 2020 2020 2020 2020 6966 2042  .0..        if B
+0000b840: 6465 6c74 6120 3c3d 302e 3020 3a20 4264  delta <=0.0 : Bd
+0000b850: 656c 7461 203d 2031 2e30 0d0a 2020 2020  elta = 1.0..    
+0000b860: 2020 2020 4170 203d 206e 702e 6d6f 6428      Ap = np.mod(
+0000b870: 612b 4172 6566 2c31 2e30 290d 0a20 2020  a+Aref,1.0)..   
+0000b880: 2020 2020 2042 7020 3d20 6e70 2e6d 6f64       Bp = np.mod
+0000b890: 2862 2b42 7265 662c 312e 3029 0d0a 2020  (b+Bref,1.0)..  
+0000b8a0: 2020 2020 2020 4176 203d 206e 702e 6469        Av = np.di
+0000b8b0: 7669 6465 2841 702c 4164 656c 7461 290d  vide(Ap,Adelta).
+0000b8c0: 0a20 2020 2020 2020 2042 7620 3d20 6e70  .        Bv = np
+0000b8d0: 2e64 6976 6964 6528 4270 2c42 6465 6c74  .divide(Bp,Bdelt
+0000b8e0: 6129 0d0a 2020 2020 2020 2020 696e 5669  a)..        inVi
+0000b8f0: 6577 706f 7274 203d 2041 763c 3d31 0d0a  ewport = Av<=1..
+0000b900: 2020 2020 2020 2020 696e 5669 6577 706f          inViewpo
+0000b910: 7274 203d 206e 702e 7768 6572 6528 4276  rt = np.where(Bv
+0000b920: 3e31 2c6e 702e 6675 6c6c 286c 656e 2869  >1,np.full(len(i
+0000b930: 6e56 6965 7770 6f72 7429 2c46 616c 7365  nViewport),False
+0000b940: 292c 696e 5669 6577 706f 7274 290d 0a20  ),inViewport).. 
+0000b950: 2020 2020 2020 2041 7620 3d20 6e70 2e63         Av = np.c
+0000b960: 6c69 7028 4176 2c30 2e30 2c31 2e30 290d  lip(Av,0.0,1.0).
+0000b970: 0a20 2020 2020 2020 2042 7620 3d20 6e70  .        Bv = np
+0000b980: 2e63 6c69 7028 4276 2c30 2e30 2c31 2e30  .clip(Bv,0.0,1.0
+0000b990: 290d 0a20 2020 2020 2020 2072 6574 7572  )..        retur
+0000b9a0: 6e20 4176 2c42 762c 696e 5669 6577 706f  n Av,Bv,inViewpo
+0000b9b0: 7274 0d0a 0d0a 2020 2020 6465 6620 5f74  rt....    def _t
+0000b9c0: 7269 616e 6775 6c61 7465 5f66 6163 6549  riangulate_faceI
+0000b9d0: 6e64 6963 6573 2873 656c 662c 6676 496e  ndices(self,fvIn
+0000b9e0: 6478 2920 3a0d 0a20 2020 2020 2020 2066  dx) :..        f
+0000b9f0: 7649 6e64 6963 6573 2c20 5f20 3d20 7365  vIndices, _ = se
+0000ba00: 6c66 2e5f 7472 6961 6e67 756c 6174 655f  lf._triangulate_
+0000ba10: 6661 6365 496e 6469 6365 735f 6661 6365  faceIndices_face
+0000ba20: 436f 6c6f 7273 2866 7649 6e64 7829 0d0a  Colors(fvIndx)..
+0000ba30: 2020 2020 2020 2020 7265 7475 726e 2066          return f
+0000ba40: 7649 6e64 6963 6573 0d0a 0d0a 2020 2020  vIndices....    
+0000ba50: 6465 6620 5f74 7269 616e 6775 6c61 7465  def _triangulate
+0000ba60: 5f66 6163 6549 6e64 6963 6573 5f66 6163  _faceIndices_fac
+0000ba70: 6543 6f6c 6f72 7328 7365 6c66 2c66 7649  eColors(self,fvI
+0000ba80: 6e64 782c 6661 6365 436f 6c6f 7273 3d4e  ndx,faceColors=N
+0000ba90: 6f6e 6529 203a 0d0a 2020 2020 2020 2020  one) :..        
+0000baa0: 2222 220d 0a20 2020 2020 2020 2053 7562  """..        Sub
+0000bab0: 6469 7669 6465 2061 6c6c 2066 6163 6573  divide all faces
+0000bac0: 2069 6e74 6f20 7472 6961 6e67 6c65 732e   into triangles.
+0000bad0: 2020 5477 6f20 7573 6573 2077 6974 6820    Two uses with 
+0000bae0: 6e75 6d62 6572 2066 6163 6520 6564 6765  number face edge
+0000baf0: 7320 6973 2033 2c34 2c35 206f 7220 363a  s is 3,4,5 or 6:
+0000bb00: 0d0a 2020 2020 2020 2020 2031 2e20 696e  ..         1. in
+0000bb10: 6974 6961 6c20 7472 6961 6e67 756c 6174  itial triangulat
+0000bb20: 6520 636f 6c6c 6563 7469 6f6e 206f 6620  e collection of 
+0000bb30: 6661 6365 7320 6861 7669 6e67 2061 2064  faces having a d
+0000bb40: 6966 6665 726e 7420 6e75 6d62 6572 206f  iffernt number o
+0000bb50: 6620 6564 6765 730d 0a20 2020 2020 2020  f edges..       
+0000bb60: 2020 2020 2063 616c 6c65 6420 6672 6f6d       called from
+0000bb70: 205f 5f69 6e69 745f 5f20 7769 7468 2066   __init__ with f
+0000bb80: 6163 6549 6e64 6963 6573 2070 6173 7365  aceIndices passe
+0000bb90: 6420 6173 2061 206c 6973 742e 200d 0a20  d as a list. .. 
+0000bba0: 2020 2020 2020 2020 322e 2074 7269 616e          2. trian
+0000bbb0: 6775 6c61 7465 2063 6f6c 6c65 6374 696f  gulate collectio
+0000bbc0: 6e20 6f66 2066 6163 6573 2077 6974 6820  n of faces with 
+0000bbd0: 6964 656e 7469 6361 6c20 6e75 6d62 6572  identical number
+0000bbe0: 206f 6620 6564 6765 730d 0a20 2020 2020   of edges..     
+0000bbf0: 2020 2020 2020 2063 616c 6c65 6420 6672         called fr
+0000bc00: 6f6d 2074 7269 616e 6775 6c61 7465 2077  om triangulate w
+0000bc10: 6865 7265 2066 6163 6549 6e64 6963 6573  here faceIndices
+0000bc20: 7320 6973 2061 206e 756d 7079 2061 7272  s is a numpy arr
+0000bc30: 6179 0d0a 2020 2020 2020 2020 2222 220d  ay..        """.
+0000bc40: 0a20 2020 2020 2020 2023 202e 2e2e 2e2e  .        # .....
+0000bc50: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0000bc60: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0000bc70: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0000bc80: 2e2e 2e2e 2e2e 2e2e 0d0a 2020 2020 2020  ..........      
+0000bc90: 2020 6465 6620 6469 7669 6465 4661 6365    def divideFace
+0000bca0: 3428 6661 6365 2920 3a0d 0a20 2020 2020  4(face) :..     
+0000bcb0: 2020 2020 2020 2064 6973 745f 6120 3d20         dist_a = 
+0000bcc0: 6e70 2e6c 696e 616c 672e 6e6f 726d 2820  np.linalg.norm( 
+0000bcd0: 7365 6c66 2e76 6572 7465 7843 6f6f 725b  self.vertexCoor[
+0000bce0: 2066 6163 655b 305d 5d20 2d20 7365 6c66   face[0]] - self
+0000bcf0: 2e76 6572 7465 7843 6f6f 725b 2066 6163  .vertexCoor[ fac
+0000bd00: 655b 325d 5d20 290d 0a20 2020 2020 2020  e[2]] )..       
+0000bd10: 2020 2020 2064 6973 745f 6220 3d20 6e70       dist_b = np
+0000bd20: 2e6c 696e 616c 672e 6e6f 726d 2820 7365  .linalg.norm( se
+0000bd30: 6c66 2e76 6572 7465 7843 6f6f 725b 2066  lf.vertexCoor[ f
+0000bd40: 6163 655b 315d 5d20 2d20 7365 6c66 2e76  ace[1]] - self.v
+0000bd50: 6572 7465 7843 6f6f 725b 2066 6163 655b  ertexCoor[ face[
+0000bd60: 335d 5d20 290d 0a20 2020 2020 2020 2020  3]] )..         
+0000bd70: 2020 2069 6620 6469 7374 5f61 203c 2064     if dist_a < d
+0000bd80: 6973 745f 6220 3a0d 0a20 2020 2020 2020  ist_b :..       
+0000bd90: 2020 2020 2020 2020 2066 6163 6531 203d           face1 =
+0000bda0: 205b 2066 6163 655b 305d 2c20 6661 6365   [ face[0], face
+0000bdb0: 5b31 5d2c 2066 6163 655b 325d 205d 0d0a  [1], face[2] ]..
+0000bdc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bdd0: 6661 6365 3220 3d20 5b20 6661 6365 5b32  face2 = [ face[2
+0000bde0: 5d2c 2066 6163 655b 335d 2c20 6661 6365  ], face[3], face
+0000bdf0: 5b30 5d20 5d0d 0a20 2020 2020 2020 2020  [0] ]..         
+0000be00: 2020 2065 6c73 6520 3a0d 0a20 2020 2020     else :..     
+0000be10: 2020 2020 2020 2020 2020 2066 6163 6531             face1
+0000be20: 203d 205b 2066 6163 655b 315d 2c20 6661   = [ face[1], fa
+0000be30: 6365 5b32 5d2c 2066 6163 655b 335d 205d  ce[2], face[3] ]
+0000be40: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000be50: 2020 6661 6365 3220 3d20 5b20 6661 6365    face2 = [ face
+0000be60: 5b33 5d2c 2066 6163 655b 305d 2c20 6661  [3], face[0], fa
+0000be70: 6365 5b31 5d20 5d20 2020 2020 2020 2020  ce[1] ]         
+0000be80: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+0000be90: 2020 2020 7265 7475 726e 2066 6163 6531      return face1
+0000bea0: 2c20 6661 6365 320d 0a20 2020 2020 2020  , face2..       
+0000beb0: 2064 6566 2064 6976 6964 6546 6163 6535   def divideFace5
+0000bec0: 2866 6163 6529 203a 0d0a 2020 2020 2020  (face) :..      
+0000bed0: 2020 2020 2020 6469 6167 203d 206c 616d        diag = lam
+0000bee0: 6264 6120 6920 3a20 7365 6c66 2e76 6572  bda i : self.ver
+0000bef0: 7465 7843 6f6f 725b 2066 6163 655b 695d  texCoor[ face[i]
+0000bf00: 5d20 2d20 7365 6c66 2e76 6572 7465 7843  ] - self.vertexC
+0000bf10: 6f6f 725b 2066 6163 655b 2869 2b32 2925  oor[ face[(i+2)%
+0000bf20: 355d 205d 0d0a 2020 2020 2020 2020 2020  5] ]..          
+0000bf30: 2020 6663 3320 3d20 6c61 6d62 6461 2069    fc3 = lambda i
+0000bf40: 203a 205b 2066 6163 655b 695d 2c20 6661   : [ face[i], fa
+0000bf50: 6365 5b28 692b 3129 2535 5d2c 2066 6163  ce[(i+1)%5], fac
+0000bf60: 655b 2869 2b32 2925 355d 205d 0d0a 2020  e[(i+2)%5] ]..  
+0000bf70: 2020 2020 2020 2020 2020 6663 3420 3d20            fc4 = 
+0000bf80: 6c61 6d62 6461 2069 203a 205b 2066 6163  lambda i : [ fac
+0000bf90: 655b 2869 2b32 2925 355d 2c20 6661 6365  e[(i+2)%5], face
+0000bfa0: 5b28 692b 3329 2535 5d2c 2066 6163 655b  [(i+3)%5], face[
+0000bfb0: 2869 2b34 2925 355d 2c20 6661 6365 5b28  (i+4)%5], face[(
+0000bfc0: 692b 3529 2535 5d20 5d0d 0a20 2020 2020  i+5)%5] ]..     
+0000bfd0: 2020 2020 2020 2064 6973 7420 3d20 5b4e         dist = [N
+0000bfe0: 6f6e 655d 2a35 0d0a 2020 2020 2020 2020  one]*5..        
+0000bff0: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
+0000c000: 6765 2835 2920 3a20 6469 7374 5b69 5d20  ge(5) : dist[i] 
+0000c010: 3d20 6e70 2e6c 696e 616c 672e 6e6f 726d  = np.linalg.norm
+0000c020: 2820 6469 6167 2869 2920 290d 0a20 2020  ( diag(i) )..   
+0000c030: 2020 2020 2020 2020 206d 696e 4469 6167           minDiag
+0000c040: 203d 2030 0d0a 2020 2020 2020 2020 2020   = 0..          
+0000c050: 2020 666f 7220 6920 696e 2072 616e 6765    for i in range
+0000c060: 2831 2c35 2920 3a0d 0a20 2020 2020 2020  (1,5) :..       
+0000c070: 2020 2020 2020 2020 2069 6620 6469 7374           if dist
+0000c080: 5b69 5d20 3c20 6469 7374 5b6d 696e 4469  [i] < dist[minDi
+0000c090: 6167 5d20 3a20 6d69 6e44 6961 6720 3d20  ag] : minDiag = 
+0000c0a0: 690d 0a20 2020 2020 2020 2020 2020 2066  i..            f
+0000c0b0: 6163 6531 203d 2066 6333 286d 696e 4469  ace1 = fc3(minDi
+0000c0c0: 6167 290d 0a20 2020 2020 2020 2020 2020  ag)..           
+0000c0d0: 206f 7468 6572 4661 6365 203d 2066 6334   otherFace = fc4
+0000c0e0: 286d 696e 4469 6167 290d 0a20 2020 2020  (minDiag)..     
+0000c0f0: 2020 2020 2020 2066 6163 6532 2c20 6661         face2, fa
+0000c100: 6365 3320 3d20 6469 7669 6465 4661 6365  ce3 = divideFace
+0000c110: 3428 6f74 6865 7246 6163 6529 0d0a 2020  4(otherFace)..  
+0000c120: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0000c130: 2066 6163 6531 2c20 6661 6365 322c 2066   face1, face2, f
+0000c140: 6163 6533 0d0a 2020 2020 2020 2020 6465  ace3..        de
+0000c150: 6620 6469 7669 6465 4661 6365 7336 2866  f divideFaces6(f
+0000c160: 6163 6529 203a 0d0a 2020 2020 2020 2020  ace) :..        
+0000c170: 2020 2020 2320 2e2e 206e 6f74 2074 6865      # .. not the
+0000c180: 2062 6573 742c 2062 7574 2065 6173 6965   best, but easie
+0000c190: 7374 2028 636f 756c 6420 6361 6c63 206d  st (could calc m
+0000c1a0: 6964 706f 696e 7429 2e20 4d52 4f49 0d0a  idpoint). MROI..
+0000c1b0: 2020 2020 2020 2020 2020 2020 6469 7374              dist
+0000c1c0: 203d 205b 4e6f 6e65 5d2a 330d 0a20 2020   = [None]*3..   
+0000c1d0: 2020 2020 2020 2020 2064 6973 745b 305d           dist[0]
+0000c1e0: 203d 206e 702e 6c69 6e61 6c67 2e6e 6f72   = np.linalg.nor
+0000c1f0: 6d28 2073 656c 662e 7665 7274 6578 436f  m( self.vertexCo
+0000c200: 6f72 5b20 6661 6365 5b30 5d5d 202d 2073  or[ face[0]] - s
+0000c210: 656c 662e 7665 7274 6578 436f 6f72 5b20  elf.vertexCoor[ 
+0000c220: 6661 6365 5b33 5d5d 2029 0d0a 2020 2020  face[3]] )..    
+0000c230: 2020 2020 2020 2020 6469 7374 5b31 5d20          dist[1] 
+0000c240: 3d20 6e70 2e6c 696e 616c 672e 6e6f 726d  = np.linalg.norm
+0000c250: 2820 7365 6c66 2e76 6572 7465 7843 6f6f  ( self.vertexCoo
+0000c260: 725b 2066 6163 655b 315d 5d20 2d20 7365  r[ face[1]] - se
+0000c270: 6c66 2e76 6572 7465 7843 6f6f 725b 2066  lf.vertexCoor[ f
+0000c280: 6163 655b 345d 5d20 290d 0a20 2020 2020  ace[4]] )..     
+0000c290: 2020 2020 2020 2064 6973 745b 325d 203d         dist[2] =
+0000c2a0: 206e 702e 6c69 6e61 6c67 2e6e 6f72 6d28   np.linalg.norm(
+0000c2b0: 2073 656c 662e 7665 7274 6578 436f 6f72   self.vertexCoor
+0000c2c0: 5b20 6661 6365 5b32 5d5d 202d 2073 656c  [ face[2]] - sel
+0000c2d0: 662e 7665 7274 6578 436f 6f72 5b20 6661  f.vertexCoor[ fa
+0000c2e0: 6365 5b35 5d5d 2029 0d0a 2020 2020 2020  ce[5]] )..      
+0000c2f0: 2020 2020 2020 694d 696e 203d 2030 0d0a        iMin = 0..
+0000c300: 2020 2020 2020 2020 2020 2020 6966 2064              if d
+0000c310: 6973 745b 315d 203c 2064 6973 745b 305d  ist[1] < dist[0]
+0000c320: 2020 2020 3a20 694d 696e 203d 2031 0d0a      : iMin = 1..
+0000c330: 2020 2020 2020 2020 2020 2020 6966 2064              if d
+0000c340: 6973 745b 325d 203c 2064 6973 745b 694d  ist[2] < dist[iM
+0000c350: 696e 5d20 3a20 694d 696e 203d 2032 0d0a  in] : iMin = 2..
+0000c360: 2020 2020 2020 2020 2020 2020 6661 6365              face
+0000c370: 4120 3d20 5b20 6661 6365 5b69 4d69 6e5d  A = [ face[iMin]
+0000c380: 2c20 2020 6661 6365 5b20 694d 696e 2b31  ,   face[ iMin+1
+0000c390: 205d 2c20 2020 6661 6365 5b20 694d 696e   ],   face[ iMin
+0000c3a0: 2b32 205d 2c20 2020 6661 6365 5b20 694d  +2 ],   face[ iM
+0000c3b0: 696e 2b33 205d 205d 0d0a 2020 2020 2020  in+3 ] ]..      
+0000c3c0: 2020 2020 2020 6661 6365 4220 3d20 5b20        faceB = [ 
+0000c3d0: 6661 6365 5b69 4d69 6e2b 335d 2c20 6661  face[iMin+3], fa
+0000c3e0: 6365 5b28 694d 696e 2b34 2925 365d 2c20  ce[(iMin+4)%6], 
+0000c3f0: 6661 6365 5b28 694d 696e 2b35 2925 365d  face[(iMin+5)%6]
+0000c400: 2c20 6661 6365 5b28 694d 696e 2b36 2925  , face[(iMin+6)%
+0000c410: 365d 205d 0d0a 2020 2020 2020 2020 2020  6] ]..          
+0000c420: 2020 6661 6365 312c 2066 6163 6532 203d    face1, face2 =
+0000c430: 2064 6976 6964 6546 6163 6534 2866 6163   divideFace4(fac
+0000c440: 6541 290d 0a20 2020 2020 2020 2020 2020  eA)..           
+0000c450: 2066 6163 6533 2c20 6661 6365 3420 3d20   face3, face4 = 
+0000c460: 6469 7669 6465 4661 6365 3428 6661 6365  divideFace4(face
+0000c470: 4229 0d0a 2020 2020 2020 2020 2020 2020  B)..            
+0000c480: 7265 7475 726e 2066 6163 6531 2c20 6661  return face1, fa
+0000c490: 6365 322c 2066 6163 6533 2c20 6661 6365  ce2, face3, face
+0000c4a0: 340d 0a20 2020 2020 2020 2023 202e 2e2e  4..        # ...
+0000c4b0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0000c4c0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0000c4d0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0000c4e0: 2e2e 2e2e 2e2e 2e2e 2e2e 0d0a 2020 2020  ............    
+0000c4f0: 2020 2020 2320 4675 7444 6576 3a20 6561      # FutDev: ea
+0000c500: 7379 2074 6f20 756e 6465 7273 7461 6e64  sy to understand
+0000c510: 2062 7574 206e 6565 6420 746f 2063 6c65   but need to cle
+0000c520: 616e 7570 2c20 4d52 4f49 0d0a 2020 2020  anup, MROI..    
+0000c530: 2020 2020 7375 6246 6163 6549 6e64 6963      subFaceIndic
+0000c540: 6573 203d 205b 5d0d 0a20 2020 2020 2020  es = []..       
+0000c550: 2066 436f 6c6f 7220 3d20 5b5d 0d0a 2020   fColor = []..  
+0000c560: 2020 2020 2020 7365 7443 6f6c 6f72 7320        setColors 
+0000c570: 3d20 4661 6c73 650d 0a20 2020 2020 2020  = False..       
+0000c580: 2069 6620 6661 6365 436f 6c6f 7273 2069   if faceColors i
+0000c590: 7320 6e6f 7420 4e6f 6e65 3a0d 0a20 2020  s not None:..   
+0000c5a0: 2020 2020 2020 2020 2073 6574 436f 6c6f           setColo
+0000c5b0: 7273 203d 2054 7275 650d 0a20 2020 2020  rs = True..     
+0000c5c0: 2020 2020 2020 2069 6620 6c65 6e28 6676         if len(fv
+0000c5d0: 496e 6478 2920 213d 206c 656e 2866 6163  Indx) != len(fac
+0000c5e0: 6543 6f6c 6f72 7329 203a 0d0a 2020 2020  eColors) :..    
+0000c5f0: 2020 2020 2020 2020 2020 2020 2320 6966              # if
+0000c600: 2066 6163 6543 6f6c 6f72 732c 2074 6865   faceColors, the
+0000c610: 6e20 7468 6973 2073 686f 756c 6420 6e6f  n this should no
+0000c620: 7420 6861 7070 656e 2c20 6275 7420 7265  t happen, but re
+0000c630: 706f 7274 2069 6620 736f 2e2e 2e2e 0d0a  port if so......
+0000c640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c650: 7761 726e 696e 6773 2e77 6172 6e28 2749  warnings.warn('I
+0000c660: 6e74 6572 6e61 6c20 4552 524f 523a 2074  nternal ERROR: t
+0000c670: 6663 3030 3127 290d 0a20 2020 2020 2020  fc001')..       
+0000c680: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0000c690: 4e6f 6e65 0d0a 2020 2020 2020 2020 2020  None..          
+0000c6a0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+0000c6b0: 666f 7220 692c 2066 6163 6520 696e 2065  for i, face in e
+0000c6c0: 6e75 6d65 7261 7465 2866 7649 6e64 7829  numerate(fvIndx)
+0000c6d0: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
+0000c6e0: 6e75 6d56 6572 7473 203d 206c 656e 2866  numVerts = len(f
+0000c6f0: 6163 6529 0d0a 2020 2020 2020 2020 2020  ace)..          
+0000c700: 2020 6966 206e 756d 5665 7274 7320 3d3d    if numVerts ==
+0000c710: 2033 203a 0d0a 2020 2020 2020 2020 2020   3 :..          
+0000c720: 2020 2020 2020 7375 6246 6163 6549 6e64        subFaceInd
+0000c730: 6963 6573 2e61 7070 656e 6428 6661 6365  ices.append(face
+0000c740: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0000c750: 2020 2069 6620 7365 7443 6f6c 6f72 7320     if setColors 
+0000c760: 3a20 6643 6f6c 6f72 202b 3d20 5b66 6163  : fColor += [fac
+0000c770: 6543 6f6c 6f72 735b 695d 5d2a 310d 0a20  eColors[i]]*1.. 
+0000c780: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+0000c790: 6e75 6d56 6572 7473 203d 3d20 3420 3a0d  numVerts == 4 :.
+0000c7a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000c7b0: 2066 312c 2066 3220 3d20 6469 7669 6465   f1, f2 = divide
+0000c7c0: 4661 6365 3428 6661 6365 290d 0a20 2020  Face4(face)..   
+0000c7d0: 2020 2020 2020 2020 2020 2020 2073 7562               sub
+0000c7e0: 4661 6365 496e 6469 6365 732e 6170 7065  FaceIndices.appe
+0000c7f0: 6e64 2866 3129 0d0a 2020 2020 2020 2020  nd(f1)..        
+0000c800: 2020 2020 2020 2020 7375 6246 6163 6549          subFaceI
+0000c810: 6e64 6963 6573 2e61 7070 656e 6428 6632  ndices.append(f2
+0000c820: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0000c830: 2020 2069 6620 7365 7443 6f6c 6f72 7320     if setColors 
+0000c840: 3a20 6643 6f6c 6f72 202b 3d20 5b66 6163  : fColor += [fac
+0000c850: 6543 6f6c 6f72 735b 695d 5d2a 320d 0a20  eColors[i]]*2.. 
+0000c860: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+0000c870: 6e75 6d56 6572 7473 203d 3d20 3520 3a0d  numVerts == 5 :.
+0000c880: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000c890: 2066 312c 2066 322c 2066 3320 3d20 6469   f1, f2, f3 = di
+0000c8a0: 7669 6465 4661 6365 3528 6661 6365 290d  videFace5(face).
+0000c8b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000c8c0: 2073 7562 4661 6365 496e 6469 6365 732e   subFaceIndices.
+0000c8d0: 6170 7065 6e64 2866 3129 0d0a 2020 2020  append(f1)..    
+0000c8e0: 2020 2020 2020 2020 2020 2020 7375 6246              subF
+0000c8f0: 6163 6549 6e64 6963 6573 2e61 7070 656e  aceIndices.appen
+0000c900: 6428 6632 290d 0a20 2020 2020 2020 2020  d(f2)..         
+0000c910: 2020 2020 2020 2073 7562 4661 6365 496e         subFaceIn
+0000c920: 6469 6365 732e 6170 7065 6e64 2866 3329  dices.append(f3)
+0000c930: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000c940: 2020 6966 2073 6574 436f 6c6f 7273 203a    if setColors :
+0000c950: 2066 436f 6c6f 7220 2b3d 205b 6661 6365   fColor += [face
+0000c960: 436f 6c6f 7273 5b69 5d5d 2a33 0d0a 2020  Colors[i]]*3..  
+0000c970: 2020 2020 2020 2020 2020 656c 6966 206e            elif n
+0000c980: 756d 5665 7274 7320 3d3d 2036 203a 0d0a  umVerts == 6 :..
+0000c990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c9a0: 6631 2c20 6632 2c20 6633 2c20 6634 203d  f1, f2, f3, f4 =
+0000c9b0: 2064 6976 6964 6546 6163 6573 3628 6661   divideFaces6(fa
+0000c9c0: 6365 290d 0a20 2020 2020 2020 2020 2020  ce)..           
+0000c9d0: 2020 2020 2073 7562 4661 6365 496e 6469       subFaceIndi
+0000c9e0: 6365 732e 6170 7065 6e64 2866 3129 0d0a  ces.append(f1)..
+0000c9f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ca00: 7375 6246 6163 6549 6e64 6963 6573 2e61  subFaceIndices.a
+0000ca10: 7070 656e 6428 6632 290d 0a20 2020 2020  ppend(f2)..     
+0000ca20: 2020 2020 2020 2020 2020 2073 7562 4661             subFa
+0000ca30: 6365 496e 6469 6365 732e 6170 7065 6e64  ceIndices.append
+0000ca40: 2866 3329 0d0a 2020 2020 2020 2020 2020  (f3)..          
+0000ca50: 2020 2020 2020 7375 6246 6163 6549 6e64        subFaceInd
+0000ca60: 6963 6573 2e61 7070 656e 6428 6634 290d  ices.append(f4).
+0000ca70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000ca80: 2069 6620 7365 7443 6f6c 6f72 7320 3a20   if setColors : 
+0000ca90: 6643 6f6c 6f72 202b 3d20 5b66 6163 6543  fColor += [faceC
+0000caa0: 6f6c 6f72 735b 695d 5d2a 340d 0a20 2020  olors[i]]*4..   
+0000cab0: 2020 2020 200d 0a20 2020 2020 2020 2072       ..        r
+0000cac0: 6574 7572 6e20 6e70 2e61 7272 6179 2873  eturn np.array(s
+0000cad0: 7562 4661 6365 496e 6469 6365 7329 2c20  ubFaceIndices), 
+0000cae0: 6643 6f6c 6f72 0d0a 0d0a 2020 2020 6465  fColor....    de
+0000caf0: 6620 5f67 6574 5f65 6467 6573 5f66 726f  f _get_edges_fro
+0000cb00: 6d5f 6661 6365 7328 7365 6c66 2c66 7649  m_faces(self,fvI
+0000cb10: 6e64 7829 203a 0d0a 2020 2020 2020 2020  ndx) :..        
+0000cb20: 2222 220d 0a20 2020 2020 2020 2055 7365  """..        Use
+0000cb30: 6420 696e 205f 5f69 6e69 745f 5f20 6966  d in __init__ if
+0000cb40: 2065 6467 6549 6e64 6963 6573 3d4e 6f6e   edgeIndices=Non
+0000cb50: 6520 746f 2063 7265 6174 6520 6564 6765  e to create edge
+0000cb60: 496e 6469 6365 732e 0d0a 2020 2020 2020  Indices...      
+0000cb70: 2020 2222 220d 0a20 2020 2020 2020 2023    """..        #
+0000cb80: 202e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e   ...............
 0000cb90: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
 0000cba0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0000cbb0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0000cbc0: 0d0a 2020 2020 2020 2020 7620 3d20 7365  ..        v = se
-0000cbd0: 6c66 2e76 6572 7465 7843 6f6f 720d 0a20  lf.vertexCoor.. 
-0000cbe0: 2020 2020 2020 2065 203d 2073 656c 662e         e = self.
-0000cbf0: 5f67 6574 5f65 6467 6573 5f66 726f 6d5f  _get_edges_from_
-0000cc00: 6661 6365 7328 7365 6c66 2e66 7649 6e64  faces(self.fvInd
-0000cc10: 6963 6573 2920 2023 2061 6363 6f75 6e74  ices)  # account
-0000cc20: 7320 666f 7220 636c 6970 7069 6e67 2e2e  s for clipping..
-0000cc30: 2e0d 0a20 2020 2020 2020 206c 636f 6c20  ...        lcol 
-0000cc40: 3d20 436f 6c6f 724c 696e 6533 4443 6f6c  = ColorLine3DCol
-0000cc50: 6c65 6374 696f 6e28 762c 652c 2765 6467  lection(v,e,'edg
-0000cc60: 6573 2729 0d0a 2020 2020 2020 2020 6c63  es')..        lc
-0000cc70: 6f6c 2e5f 6564 6765 636f 6c6f 7273 203d  ol._edgecolors =
-0000cc80: 2067 6574 5f65 6467 655f 636f 6c6f 7228   get_edge_color(
-0000cc90: 290d 0a20 2020 2020 2020 2072 6574 7572  )..        retur
-0000cca0: 6e20 6c63 6f6c 0d0a 0d0a 2020 2020 4070  n lcol....    @p
-0000ccb0: 726f 7065 7274 790d 0a20 2020 2064 6566  roperty..    def
-0000ccc0: 2069 6e69 7465 6467 6573 2873 656c 6629   initedges(self)
-0000ccd0: 203a 0d0a 2020 2020 2020 2020 2727 2720   :..        ''' 
-0000cce0: 436f 6c6f 724c 696e 6533 4443 6f6c 6c65  ColorLine3DColle
-0000ccf0: 6374 696f 6e20 6f66 2074 6865 2069 6e69  ction of the ini
-0000cd00: 7469 616c 2073 7572 6661 6365 2065 6467  tial surface edg
-0000cd10: 6573 2e0d 0a20 2020 2020 2020 2020 2020  es...           
-0000cd20: 204f 4e4c 5920 6176 6169 6c61 626c 6520   ONLY available 
-0000cd30: 666f 7220 7375 7266 6163 6573 2077 6865  for surfaces whe
-0000cd40: 7265 2074 6865 206e 756d 6265 7220 6f66  re the number of
-0000cd50: 0d0a 2020 2020 2020 2020 2020 2020 6661  ..            fa
-0000cd60: 6365 2065 6467 6573 2064 6966 6665 7220  ce edges differ 
-0000cd70: 616d 6f6e 6720 6661 6365 732e 0d0a 0d0a  among faces.....
-0000cd80: 2020 2020 2020 2020 2727 270d 0a0d 0a20          '''.... 
-0000cd90: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
-0000cda0: 696e 6974 6564 6765 7320 6973 204e 6f6e  initedges is Non
-0000cdb0: 6520 3a0d 0a20 2020 2020 2020 2020 2020  e :..           
-0000cdc0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-0000cdd0: 7228 2769 6e69 7465 6467 6573 2070 726f  r('initedges pro
-0000cde0: 7065 7274 7920 6e6f 7420 6176 6169 6c61  perty not availa
-0000cdf0: 626c 652c 2061 6c6c 2069 6e69 7469 616c  ble, all initial
-0000ce00: 2066 6163 6573 2068 6176 6520 6571 7561   faces have equa
-0000ce10: 6c20 6e75 6d62 6572 206f 6620 6564 6765  l number of edge
-0000ce20: 7320 2875 7365 2065 6467 6573 2070 726f  s (use edges pro
-0000ce30: 7065 7274 7929 2729 2020 2020 2020 200d  perty)')       .
-0000ce40: 0a20 2020 2020 2020 2065 203d 2073 656c  .        e = sel
-0000ce50: 662e 5f69 6e69 7465 6467 6573 0d0a 2020  f._initedges..  
-0000ce60: 2020 2020 2020 7620 3d20 7365 6c66 2e5f        v = self._
-0000ce70: 696e 6974 7665 7274 730d 0a20 2020 2020  initverts..     
-0000ce80: 2020 206c 636f 6c20 3d20 436f 6c6f 724c     lcol = ColorL
-0000ce90: 696e 6533 4443 6f6c 6c65 6374 696f 6e28  ine3DCollection(
-0000cea0: 762c 652c 2765 6467 6573 2729 0d0a 2020  v,e,'edges')..  
-0000ceb0: 2020 2020 2020 7265 7475 726e 206c 636f        return lco
-0000cec0: 6c0d 0a0d 0a20 2020 2040 7072 6f70 6572  l....    @proper
-0000ced0: 7479 0d0a 2020 2020 6465 6620 7665 7274  ty..    def vert
-0000cee0: 6963 6573 2873 656c 6629 203a 0d0a 2020  ices(self) :..  
-0000cef0: 2020 2020 2020 2222 2241 2033 2078 204e        """A 3 x N
-0000cf00: 2061 7272 6179 206f 6620 7375 7266 6163   array of surfac
-0000cf10: 6520 7665 7274 6963 6573 2e22 2222 0d0a  e vertices."""..
-0000cf20: 2020 2020 2020 2020 7620 3d20 7365 6c66          v = self
-0000cf30: 2e76 6572 7465 7843 6f6f 720d 0a20 2020  .vertexCoor..   
-0000cf40: 2020 2020 206d 203d 206e 702e 7472 616e       m = np.tran
-0000cf50: 7370 6f73 6528 7629 0d0a 2020 2020 2020  spose(v)..      
-0000cf60: 2020 7265 7475 726e 206d 0d0a 0d0a 2020    return m....  
-0000cf70: 2020 4070 726f 7065 7274 790d 0a20 2020    @property..   
-0000cf80: 2064 6566 2066 6163 6563 656e 7465 7273   def facecenters
-0000cf90: 2873 656c 6629 203a 0d0a 2020 2020 2020  (self) :..      
-0000cfa0: 2020 2222 2241 2033 2078 204e 2061 7272    """A 3 x N arr
-0000cfb0: 6179 206f 6620 7375 7266 6163 6520 6661  ay of surface fa
-0000cfc0: 6365 2063 656e 7465 7220 636f 6f72 6469  ce center coordi
-0000cfd0: 6e61 7465 732e 2222 220d 0a20 2020 2020  nates."""..     
-0000cfe0: 2020 2076 6572 7473 203d 2073 656c 662e     verts = self.
-0000cff0: 7665 7274 6578 436f 6f72 5b20 7365 6c66  vertexCoor[ self
-0000d000: 2e66 7649 6e64 6963 6573 205d 0d0a 2020  .fvIndices ]..  
-0000d010: 2020 2020 2020 6661 6365 4365 6e74 6572        faceCenter
-0000d020: 436f 6f72 203d 2073 656c 662e 5f67 6574  Coor = self._get
-0000d030: 5f66 6163 655f 6365 6e74 6572 7328 7665  _face_centers(ve
-0000d040: 7274 7329 0d0a 2020 2020 2020 2020 6d20  rts)..        m 
-0000d050: 3d20 6e70 2e74 7261 6e73 706f 7365 2866  = np.transpose(f
-0000d060: 6163 6543 656e 7465 7243 6f6f 7229 0d0a  aceCenterCoor)..
-0000d070: 2020 2020 2020 2020 7265 7475 726e 206d          return m
-0000d080: 0d0a 0d0a 2020 2020 4070 726f 7065 7274  ....    @propert
-0000d090: 790d 0a20 2020 2064 6566 2066 6163 6563  y..    def facec
-0000d0a0: 6f6c 6f72 7328 7365 6c66 2920 3a0d 0a20  olors(self) :.. 
-0000d0b0: 2020 2020 2020 2022 2222 4120 4e20 7820         """A N x 
-0000d0c0: 3420 6172 7261 7920 6f66 2073 7572 6661  4 array of surfa
-0000d0d0: 6365 2066 6163 6520 636f 6c6f 7273 2e22  ce face colors."
-0000d0e0: 2222 0d0a 2020 2020 2020 2020 7365 6c66  ""..        self
-0000d0f0: 2e5f 706f 7374 5072 6f63 5f73 7572 6661  ._postProc_surfa
-0000d100: 6365 436f 6c6f 7273 2829 0d0a 2020 2020  ceColors()..    
-0000d110: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-0000d120: 5f66 6163 6563 6f6c 6f72 730d 0a0d 0a20  _facecolors.... 
-0000d130: 2020 2040 7072 6f70 6572 7479 0d0a 2020     @property..  
-0000d140: 2020 6465 6620 7376 645f 6469 6374 2873    def svd_dict(s
-0000d150: 656c 6629 203a 0d0a 2020 2020 2020 2020  elf) :..        
-0000d160: 2222 220d 0a20 2020 2020 2020 2041 2064  """..        A d
-0000d170: 6963 7469 6f6e 6172 7920 6f66 2072 6573  ictionary of res
-0000d180: 756c 7473 2066 726f 6d20 6120 5369 6e67  ults from a Sing
-0000d190: 756c 6172 2056 616c 7565 2044 6563 6f6d  ular Value Decom
-0000d1a0: 706f 7369 7469 6f6e 206f 6620 7468 6520  position of the 
-0000d1b0: 6461 7461 2e0d 0a20 2020 2020 2020 200d  data...        .
-0000d1c0: 0a20 2020 2020 2020 204b 6579 7320 6172  .        Keys ar
-0000d1d0: 653a 0d0a 0d0a 2020 2020 2020 2020 2764  e:....        'd
-0000d1e0: 6973 6172 7227 203a 2061 7272 6179 206f  isarr' : array o
-0000d1f0: 6620 4e20 666c 6f61 7473 2c20 6e6f 726d  f N floats, norm
-0000d200: 616c 697a 6564 2074 6f20 7468 6520 7375  alized to the su
-0000d210: 7266 6163 6520 7369 7a65 2e0d 0a20 2020  rface size...   
-0000d220: 2020 2020 200d 0a20 2020 2020 2020 2027       ..        '
-0000d230: 7369 676d 6127 203a 2073 7461 6e64 6172  sigma' : standar
-0000d240: 6420 6465 7669 6174 696f 6e0d 0a0d 0a20  d deviation.... 
-0000d250: 2020 2020 2020 2027 7472 616e 7327 203a         'trans' :
-0000d260: 205b 726f 7461 7469 6f6e 206d 6174 7269   [rotation matri
-0000d270: 782c 2073 6361 6c69 6e67 2c20 7472 616e  x, scaling, tran
-0000d280: 736c 6174 696f 6e5d 0d0a 2020 2020 0d0a  slation]..    ..
-0000d290: 2020 2020 2020 2020 5661 6c75 6573 2061          Values a
-0000d2a0: 7265 2061 7373 6967 6e65 6420 7573 696e  re assigned usin
-0000d2b0: 6720 7468 6520 6d61 705f 6765 6f6d 5f66  g the map_geom_f
-0000d2c0: 726f 6d5f 7376 6420 6d65 7468 6f64 2e0d  rom_svd method..
-0000d2d0: 0a20 2020 2020 2020 2054 6865 2064 6963  .        The dic
-0000d2e0: 7469 6f6e 6172 7920 6973 204e 6f6e 6520  tionary is None 
-0000d2f0: 6966 2074 6865 206d 6574 686f 6420 6861  if the method ha
-0000d300: 7320 6e6f 7420 6265 656e 2063 616c 6c65  s not been calle
-0000d310: 6420 6279 2074 6865 2073 7572 6661 6365  d by the surface
-0000d320: 206f 626a 6563 742e 0d0a 2020 2020 2020   object...      
-0000d330: 2020 0d0a 2020 2020 2020 2020 2222 220d    ..        """.
-0000d340: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0000d350: 7365 6c66 2e5f 7376 645f 6469 6374 0d0a  self._svd_dict..
-0000d360: 0d0a 2020 2020 4070 726f 7065 7274 790d  ..    @property.
-0000d370: 0a20 2020 2064 6566 2061 7265 615f 6832  .    def area_h2
-0000d380: 6228 7365 6c66 2920 3a0d 0a20 2020 2020  b(self) :..     
-0000d390: 2020 2022 2222 2041 2032 2078 204e 2061     """ A 2 x N a
-0000d3a0: 7272 6179 206f 6620 6e6f 726d 616c 697a  rray of normaliz
-0000d3b0: 6564 204e 2066 6163 6520 6172 6561 7320  ed N face areas 
-0000d3c0: 616e 6420 7368 6170 6573 2e22 2222 0d0a  and shapes."""..
-0000d3d0: 2020 2020 2020 2020 662c 7620 3d20 7365          f,v = se
-0000d3e0: 6c66 2e66 7649 6e64 6963 6573 2c20 7365  lf.fvIndices, se
-0000d3f0: 6c66 2e76 6572 7465 7843 6f6f 720d 0a20  lf.vertexCoor.. 
-0000d400: 2020 2020 2020 2069 6620 662e 7368 6170         if f.shap
-0000d410: 655b 315d 2069 7320 3320 3a20 2320 7472  e[1] is 3 : # tr
-0000d420: 6961 6e67 756c 6172 0d0a 2020 2020 2020  iangular..      
-0000d430: 2020 2020 2020 4120 3d20 765b 2066 5b3a        A = v[ f[:
-0000d440: 2c31 5d20 5d20 2d20 765b 2066 5b3a 2c30  ,1] ] - v[ f[:,0
-0000d450: 5d20 5d0d 0a20 2020 2020 2020 2020 2020  ] ]..           
-0000d460: 2042 203d 2076 5b20 665b 3a2c 325d 205d   B = v[ f[:,2] ]
-0000d470: 202d 2076 5b20 665b 3a2c 305d 205d 0d0a   - v[ f[:,0] ]..
-0000d480: 2020 2020 2020 2020 2020 2020 4320 3d20              C = 
-0000d490: 765b 2066 5b3a 2c32 5d20 5d20 2d20 765b  v[ f[:,2] ] - v[
-0000d4a0: 2066 5b3a 2c31 5d20 5d0d 0a20 2020 2020   f[:,1] ]..     
-0000d4b0: 2020 2020 2020 2061 7265 6120 3d20 302e         area = 0.
-0000d4c0: 352a 6e70 2e6c 696e 616c 672e 6e6f 726d  5*np.linalg.norm
-0000d4d0: 2820 6e70 2e63 726f 7373 2841 2c42 292c  ( np.cross(A,B),
-0000d4e0: 6178 6973 3d31 2029 0d0a 2020 2020 2020  axis=1 )..      
-0000d4f0: 2020 2020 2020 6176 6541 7265 6120 3d20        aveArea = 
-0000d500: 6e70 2e61 7665 7261 6765 2861 7265 6129  np.average(area)
-0000d510: 0d0a 2020 2020 2020 2020 2020 2020 6e6f  ..            no
-0000d520: 726d 4172 6561 203d 2061 7265 612f 6176  rmArea = area/av
-0000d530: 6541 7265 610d 0a20 2020 2020 2020 2020  eArea..         
-0000d540: 2020 2065 6467 6573 203d 206e 702e 6c69     edges = np.li
-0000d550: 6e61 6c67 2e6e 6f72 6d28 206e 702e 6172  nalg.norm( np.ar
-0000d560: 7261 7928 205b 412c 422c 435d 292c 6178  ray( [A,B,C]),ax
-0000d570: 6973 3d32 290d 0a20 2020 2020 2020 2020  is=2)..         
-0000d580: 2020 206d 6178 7369 7a65 7320 3d20 6e70     maxsizes = np
-0000d590: 2e61 6d61 7828 6564 6765 732c 6178 6973  .amax(edges,axis
-0000d5a0: 3d30 290d 0a20 2020 2020 2020 2020 2020  =0)..           
-0000d5b0: 2066 203d 2034 2a6e 702e 7371 7274 2833   f = 4*np.sqrt(3
-0000d5c0: 292f 3320 2320 6571 7569 6c61 7465 7261  )/3 # equilatera
-0000d5d0: 6c20 7472 6961 6e67 6c65 0d0a 2020 2020  l triangle..    
-0000d5e0: 2020 2020 2020 2020 736b 6577 203d 2066          skew = f
-0000d5f0: 2a61 7265 612f 286d 6178 7369 7a65 732a  *area/(maxsizes*
-0000d600: 6d61 7873 697a 6573 290d 0a20 2020 2020  maxsizes)..     
-0000d610: 2020 2065 6c73 6520 3a20 2320 7175 6164     else : # quad
-0000d620: 7261 7465 7261 6c20 6973 2074 776f 2074  rateral is two t
-0000d630: 7269 616e 676c 6573 2e0d 0a20 2020 2020  riangles...     
-0000d640: 2020 2020 2020 2062 3032 203d 2076 5b20         b02 = v[ 
-0000d650: 665b 3a2c 325d 205d 202d 2076 5b20 665b  f[:,2] ] - v[ f[
-0000d660: 3a2c 305d 205d 200d 0a20 2020 2020 2020  :,0] ] ..       
-0000d670: 2020 2020 2062 3133 203d 2076 5b20 665b       b13 = v[ f[
-0000d680: 3a2c 335d 205d 202d 2076 5b20 665b 3a2c  :,3] ] - v[ f[:,
-0000d690: 315d 205d 0d0a 2020 2020 2020 2020 2020  1] ]..          
-0000d6a0: 2020 6261 7365 203d 206e 702e 6172 7261    base = np.arra
-0000d6b0: 7928 205b 6230 322c 6231 335d 2029 0d0a  y( [b02,b13] )..
-0000d6c0: 2020 2020 2020 2020 2020 2020 6469 6167              diag
-0000d6d0: 203d 206e 702e 6c69 6e61 6c67 2e6e 6f72   = np.linalg.nor
-0000d6e0: 6d28 2062 6173 6520 2c61 7869 733d 3229  m( base ,axis=2)
-0000d6f0: 0d0a 2020 2020 2020 2020 2020 2020 6920  ..            i 
-0000d700: 3d20 6e70 2e77 6865 7265 2864 6961 675b  = np.where(diag[
-0000d710: 305d 3e64 6961 675b 315d 2c20 6e70 2e7a  0]>diag[1], np.z
-0000d720: 6572 6f73 286c 656e 2866 292c 696e 7429  eros(len(f),int)
-0000d730: 2c20 6e70 2e6f 6e65 7328 6c65 6e28 6629  , np.ones(len(f)
-0000d740: 2c69 6e74 2920 290d 0a20 2020 2020 2020  ,int) )..       
-0000d750: 2020 2020 206d 6178 7369 7a65 7320 3d20       maxsizes = 
-0000d760: 2064 6961 675b 692c 315d 0d0a 2020 2020   diag[i,1]..    
-0000d770: 2020 2020 2020 2020 4120 3d20 6230 320d          A = b02.
-0000d780: 0a20 2020 2020 2020 2020 2020 2023 2074  .            # t
-0000d790: 6f70 2074 7269 616e 676c 6520 2e2e 2e2e  op triangle ....
-0000d7a0: 0d0a 2020 2020 2020 2020 2020 2020 4220  ..            B 
-0000d7b0: 3d20 765b 2066 5b3a 2c33 5d20 5d20 2d20  = v[ f[:,3] ] - 
-0000d7c0: 765b 2066 5b3a 2c30 5d20 5d0d 0a20 2020  v[ f[:,0] ]..   
-0000d7d0: 2020 2020 2020 2020 2061 7265 6154 6f70           areaTop
-0000d7e0: 203d 2030 2e35 2a6e 702e 6c69 6e61 6c67   = 0.5*np.linalg
-0000d7f0: 2e6e 6f72 6d28 206e 702e 6372 6f73 7328  .norm( np.cross(
-0000d800: 412c 4229 2c61 7869 733d 3120 290d 0a20  A,B),axis=1 ).. 
-0000d810: 2020 2020 2020 2020 2020 2023 2062 6f74             # bot
-0000d820: 746f 6d20 7472 6961 6e67 6c65 202e 2e2e  tom triangle ...
-0000d830: 2e0d 0a20 2020 2020 2020 2020 2020 2042  ...            B
-0000d840: 203d 2076 5b20 665b 3a2c 315d 205d 202d   = v[ f[:,1] ] -
-0000d850: 2076 5b20 665b 3a2c 325d 205d 0d0a 2020   v[ f[:,2] ]..  
-0000d860: 2020 2020 2020 2020 2020 6172 6561 4274            areaBt
-0000d870: 6d20 3d20 302e 352a 6e70 2e6c 696e 616c  m = 0.5*np.linal
-0000d880: 672e 6e6f 726d 2820 6e70 2e63 726f 7373  g.norm( np.cross
-0000d890: 282d 412c 4229 2c61 7869 733d 3120 290d  (-A,B),axis=1 ).
-0000d8a0: 0a20 2020 2020 2020 2020 2020 2061 7265  .            are
-0000d8b0: 6120 3d20 6e70 2e61 6464 2820 6172 6561  a = np.add( area
-0000d8c0: 546f 702c 6172 6561 4274 6d29 0d0a 2020  Top,areaBtm)..  
-0000d8d0: 2020 2020 2020 2020 2020 6176 6541 7265            aveAre
-0000d8e0: 6120 3d20 6e70 2e61 7665 7261 6765 2861  a = np.average(a
-0000d8f0: 7265 6129 0d0a 2020 2020 2020 2020 2020  rea)..          
-0000d900: 2020 6e6f 726d 4172 6561 203d 2061 7265    normArea = are
-0000d910: 612f 6176 6541 7265 610d 0a20 2020 2020  a/aveArea..     
-0000d920: 2020 2020 2020 2066 203d 2031 2023 2073         f = 1 # s
-0000d930: 7175 6172 650d 0a20 2020 2020 2020 2020  quare..         
-0000d940: 2020 2073 6b65 7720 3d20 662a 6172 6561     skew = f*area
-0000d950: 2f28 6d61 7873 697a 6573 2a6d 6178 7369  /(maxsizes*maxsi
-0000d960: 7a65 7329 0d0a 2020 2020 2020 2020 2320  zes)..        # 
-0000d970: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0000d980: 2e2e 2e2e 0d0a 2020 2020 2020 2020 7265  ......        re
-0000d990: 7475 726e 205b 6e6f 726d 4172 6561 2c73  turn [normArea,s
-0000d9a0: 6b65 775d 0d0a 2020 2020 0d0a 2020 2020  kew]..    ..    
-0000d9b0: 6465 6620 7472 6961 6e67 756c 6174 6528  def triangulate(
-0000d9c0: 7365 6c66 2c20 7265 7a3d 3029 203a 0d0a  self, rez=0) :..
-0000d9d0: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
-0000d9e0: 2020 2020 2050 4c41 4e41 5220 7375 6264       PLANAR subd
-0000d9f0: 6976 6973 696f 6e20 6f66 2065 6163 6820  ivision of each 
-0000da00: 6661 6365 2069 6e74 6f20 7472 6961 6e67  face into triang
-0000da10: 756c 6172 2066 6163 6573 2e0d 0a20 2020  ular faces...   
-0000da20: 2020 2020 200d 0a20 2020 2020 2020 2050       ..        P
-0000da30: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
-0000da40: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
-0000da50: 2020 2020 2020 2072 657a 203a 2069 6e74         rez : int
-0000da60: 6567 6572 2c20 6f70 7469 6f6e 616c 2c20  eger, optional, 
-0000da70: 6465 6661 756c 743a 2030 0d0a 2020 2020  default: 0..    
-0000da80: 2020 2020 2020 2020 4e75 6d62 6572 206f          Number o
-0000da90: 6620 7265 6375 7273 6976 6520 7375 6264  f recursive subd
-0000daa0: 6976 6973 696f 6e73 206f 6620 7468 6520  ivisions of the 
-0000dab0: 6261 7365 2066 6163 6573 0d0a 2020 2020  base faces..    
-0000dac0: 2020 2020 2020 2020 696e 746f 2074 7269          into tri
-0000dad0: 616e 6775 6c61 7220 6661 6365 732c 2066  angular faces, f
-0000dae0: 6f75 7220 6661 6365 7320 7065 7220 7265  our faces per re
-0000daf0: 7a2e 0d0a 2020 2020 2020 2020 2020 2020  z...            
-0000db00: 5265 7a20 7661 6c75 6573 2072 616e 6765  Rez values range
-0000db10: 2066 726f 6d20 3020 746f 2037 2e0d 0a20   from 0 to 7... 
-0000db20: 2020 2020 2020 2020 2020 2046 6f72 2073             For s
-0000db30: 7572 6661 6365 7320 7769 7468 2034 2076  urfaces with 4 v
-0000db40: 6572 7469 6365 7320 7065 7220 6661 6365  ertices per face
-0000db50: 2c20 6561 6368 2066 6163 6520 6973 2066  , each face is f
-0000db60: 6972 7374 0d0a 2020 2020 2020 2020 2020  irst..          
-0000db70: 2020 7375 6264 6976 6964 6564 2069 6e74    subdivided int
-0000db80: 6f20 7477 6f20 6661 6365 732c 2074 6865  o two faces, the
-0000db90: 6e20 7265 6375 7273 696f 6e20 7072 6f63  n recursion proc
-0000dba0: 6565 6473 2e0d 0a20 2020 2020 2020 2020  eeds...         
-0000dbb0: 2020 2046 6f72 2073 7572 6661 6365 7320     For surfaces 
-0000dbc0: 7769 7468 2035 2076 6572 7469 6365 7320  with 5 vertices 
-0000dbd0: 7065 7220 6661 6365 2c20 6561 6368 2066  per face, each f
-0000dbe0: 6163 6520 6973 2066 6972 7374 0d0a 2020  ace is first..  
-0000dbf0: 2020 2020 2020 2020 2020 7375 6264 6976            subdiv
-0000dc00: 6964 6564 2069 6e74 6f20 7468 7265 6520  ided into three 
-0000dc10: 6661 6365 732c 2074 6865 6e20 7265 6375  faces, then recu
-0000dc20: 7273 696f 6e20 7072 6f63 6565 6473 2e0d  rsion proceeds..
-0000dc30: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
-0000dc40: 2020 2020 2020 2052 6574 7572 6e73 0d0a         Returns..
-0000dc50: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0d          -------.
-0000dc60: 0a20 2020 2020 2020 2073 656c 6620 3a20  .        self : 
-0000dc70: 7375 7266 6163 6520 6f62 6a65 6374 0d0a  surface object..
-0000dc80: 2020 2020 2020 2020 0d0a 0d0a 2020 2020          ....    
-0000dc90: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
-0000dca0: 2023 202e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e   # .............
-0000dcb0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0000dcc0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0000dcd0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0000dce0: 0d0a 2020 2020 2020 2020 6465 6620 6d69  ..        def mi
-0000dcf0: 6456 4675 6e28 7665 6374 412c 2076 6563  dVFun(vectA, vec
-0000dd00: 7442 2920 3a0d 0a20 2020 2020 2020 2020  tB) :..         
-0000dd10: 2020 206d 6964 203d 206e 702e 6164 6428     mid = np.add(
-0000dd20: 7665 6374 412c 7665 6374 4229 0d0a 2020  vectA,vectB)..  
-0000dd30: 2020 2020 2020 2020 2020 6d69 6420 3d20            mid = 
-0000dd40: 6e70 2e6d 756c 7469 706c 7928 302e 352c  np.multiply(0.5,
-0000dd50: 6d69 6429 0d0a 2020 2020 2020 2020 2020  mid)..          
-0000dd60: 2020 7265 7475 726e 206d 6964 2020 2020    return mid    
-0000dd70: 2020 200d 0a20 2020 2020 2020 2023 202e     ..        # .
-0000dd80: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0000dd90: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0000dda0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0000ddb0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 0d0a 2020  ..............  
-0000ddc0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-0000ddd0: 7365 6c66 2e5f 706f 7374 5072 6f63 5f73  self._postProc_s
-0000dde0: 7572 6661 6365 436f 6c6f 7273 2854 7275  urfaceColors(Tru
-0000ddf0: 6529 0d0a 0d0a 0d0a 2020 2020 2020 2020  e)......        
-0000de00: 6966 2073 656c 662e 6676 496e 6469 6365  if self.fvIndice
-0000de10: 732e 7368 6170 655b 315d 203e 2033 203a  s.shape[1] > 3 :
-0000de20: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-0000de30: 6966 206e 6565 6465 642c 2062 7265 616b  if needed, break
-0000de40: 2066 6163 6573 2069 6e74 6f20 7472 6961   faces into tria
-0000de50: 6e67 6c65 7320 6265 666f 7265 2070 726f  ngles before pro
-0000de60: 6365 6564 696e 672e 2e2e 2e0d 0a20 2020  ceeding......   
-0000de70: 2020 2020 2020 2020 2073 7562 4469 7620           subDiv 
-0000de80: 3d20 7365 6c66 2e66 7649 6e64 6963 6573  = self.fvIndices
-0000de90: 2e73 6861 7065 5b31 5d20 2d20 320d 0a20  .shape[1] - 2.. 
-0000dea0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000deb0: 6676 496e 6469 6365 7320 3d20 7365 6c66  fvIndices = self
-0000dec0: 2e5f 7472 6961 6e67 756c 6174 655f 6661  ._triangulate_fa
-0000ded0: 6365 496e 6469 6365 7328 7365 6c66 2e66  ceIndices(self.f
-0000dee0: 7649 6e64 6963 6573 290d 0a0d 0a20 2020  vIndices)....   
-0000def0: 2020 2020 2020 2020 206e 6577 4661 6365           newFace
-0000df00: 436f 6c6f 7273 203d 205b 5d0d 0a20 2020  Colors = []..   
-0000df10: 2020 2020 2020 2020 2066 6f72 2066 436f           for fCo
-0000df20: 6c6f 7220 696e 2073 656c 662e 5f66 6163  lor in self._fac
-0000df30: 6563 6f6c 6f72 7320 3a0d 0a20 2020 2020  ecolors :..     
-0000df40: 2020 2020 2020 2020 2020 206e 6577 4661             newFa
-0000df50: 6365 436f 6c6f 7273 202b 3d20 5b66 436f  ceColors += [fCo
-0000df60: 6c6f 725d 2a73 7562 4469 760d 0a20 2020  lor]*subDiv..   
-0000df70: 2020 2020 2020 2020 2073 656c 662e 7365           self.se
-0000df80: 745f 6661 6365 636f 6c6f 7228 206e 702e  t_facecolor( np.
-0000df90: 6172 7261 7928 6e65 7746 6163 6543 6f6c  array(newFaceCol
-0000dfa0: 6f72 7329 2029 0d0a 0d0a 2020 2020 2020  ors) )....      
-0000dfb0: 2020 696e 6465 784f 626a 202c 7665 7274    indexObj ,vert
-0000dfc0: 6578 436f 6f72 203d 2073 656c 662e 7472  exCoor = self.tr
-0000dfd0: 6961 6e67 756c 6174 6542 6173 6528 7265  iangulateBase(re
-0000dfe0: 7a2c 6c69 7374 2873 656c 662e 7665 7274  z,list(self.vert
-0000dff0: 6578 436f 6f72 292c 7365 6c66 2e66 7649  exCoor),self.fvI
-0000e000: 6e64 6963 6573 2c20 6d69 6456 4675 6e29  ndices, midVFun)
-0000e010: 0d0a 0d0a 2020 2020 2020 2020 7365 6c66  ....        self
-0000e020: 2e66 7649 6e64 6963 6573 203d 2069 6e64  .fvIndices = ind
-0000e030: 6578 4f62 6a5b 2766 6163 6527 5d0d 0a20  exObj['face'].. 
-0000e040: 2020 2020 2020 2073 656c 662e 7665 7274         self.vert
-0000e050: 6578 436f 6f72 203d 2076 6572 7465 7843  exCoor = vertexC
-0000e060: 6f6f 720d 0a20 2020 2020 2020 2073 656c  oor..        sel
-0000e070: 662e 6576 496e 6469 6365 7320 3d20 7365  f.evIndices = se
-0000e080: 6c66 2e5f 6765 745f 6564 6765 735f 6672  lf._get_edges_fr
-0000e090: 6f6d 5f66 6163 6573 2873 656c 662e 6676  om_faces(self.fv
-0000e0a0: 496e 6469 6365 7329 0d0a 2020 2020 2020  Indices)..      
-0000e0b0: 2020 7365 6c66 2e76 6649 6e64 6963 6573    self.vfIndices
-0000e0c0: 4c69 7374 203d 2073 656c 662e 5f76 6572  List = self._ver
-0000e0d0: 7465 7843 6f6d 6d6f 6e46 6163 6549 6e64  texCommonFaceInd
-0000e0e0: 6963 6573 2829 0d0a 2020 2020 2020 2020  ices()..        
-0000e0f0: 7365 6c66 2e65 6649 6e64 6963 6573 4c69  self.efIndicesLi
-0000e100: 7374 203d 2073 656c 662e 5f65 6467 6543  st = self._edgeC
-0000e110: 6f6d 6d6f 6e46 6163 6549 6e64 6963 6573  ommonFaceIndices
-0000e120: 2829 0d0a 0d0a 2020 2020 2020 2020 7620  ()....        v 
-0000e130: 3d20 7365 6c66 2e76 6572 7465 7843 6f6f  = self.vertexCoo
-0000e140: 720d 0a20 2020 2020 2020 2076 6572 7473  r..        verts
-0000e150: 203d 2076 5b73 656c 662e 6676 496e 6469   = v[self.fvIndi
-0000e160: 6365 735d 0d0a 2020 2020 2020 2020 7365  ces]..        se
-0000e170: 6c66 2e73 6574 5f76 6572 7473 2820 7665  lf.set_verts( ve
-0000e180: 7274 7320 290d 0a20 2020 2020 2020 2073  rts )..        s
-0000e190: 656c 662e 5f73 6574 5f67 656f 6d65 7472  elf._set_geometr
-0000e1a0: 6963 5f62 6f75 6e64 7328 290d 0a0d 0a20  ic_bounds().... 
-0000e1b0: 2020 2020 2020 2069 6620 7265 7a20 213d         if rez !=
-0000e1c0: 2030 203a 0d0a 2020 2020 2020 2020 2020   0 :..          
-0000e1d0: 2020 6e65 7746 6163 6543 6f6c 6f72 7320    newFaceColors 
-0000e1e0: 3d20 5b5d 0d0a 2020 2020 2020 2020 2020  = []..          
-0000e1f0: 2020 7375 6244 6976 203d 2034 2a2a 7265    subDiv = 4**re
-0000e200: 7a0d 0a20 2020 2020 2020 2020 2020 2066  z..            f
-0000e210: 6f72 2066 436f 6c6f 7220 696e 2073 656c  or fColor in sel
-0000e220: 662e 5f66 6163 6563 6f6c 6f72 7320 3a0d  f._facecolors :.
-0000e230: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000e240: 206e 6577 4661 6365 436f 6c6f 7273 202b   newFaceColors +
-0000e250: 3d20 5b66 436f 6c6f 725d 2a73 7562 4469  = [fColor]*subDi
-0000e260: 760d 0a20 2020 2020 2020 2020 2020 2073  v..            s
-0000e270: 656c 662e 7365 745f 6661 6365 636f 6c6f  elf.set_facecolo
-0000e280: 7228 206e 702e 6172 7261 7928 6e65 7746  r( np.array(newF
-0000e290: 6163 6543 6f6c 6f72 7329 2029 0d0a 0d0a  aceColors) )....
-0000e2a0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0000e2b0: 656c 6620 2020 2020 2020 200d 0a0d 0a20  elf        .... 
-0000e2c0: 2020 2064 6566 206e 6f72 6d61 6c69 7a65     def normalize
-0000e2d0: 5f73 6361 6c65 2873 656c 6629 203a 0d0a  _scale(self) :..
-0000e2e0: 2020 2020 2020 2020 2222 2253 6361 6c69          """Scali
-0000e2f0: 6e67 206e 6f72 6d61 6c69 7a61 7469 6f6e  ng normalization
-0000e300: 2061 7272 6179 2061 6e64 2072 6563 6970   array and recip
-0000e310: 726f 6361 6c2e 2222 220d 0a20 2020 2020  rocal."""..     
-0000e320: 2020 2062 6f75 6e64 7320 3d20 7365 6c66     bounds = self
-0000e330: 2e62 6f75 6e64 730d 0a20 2020 2020 2020  .bounds..       
-0000e340: 2073 6358 203d 2028 2062 6f75 6e64 735b   scX = ( bounds[
-0000e350: 2778 6c69 6d27 5d5b 315d 202d 2062 6f75  'xlim'][1] - bou
-0000e360: 6e64 735b 2778 6c69 6d27 5d5b 305d 2020  nds['xlim'][0]  
-0000e370: 290d 0a20 2020 2020 2020 2073 6359 203d  )..        scY =
-0000e380: 2028 2062 6f75 6e64 735b 2779 6c69 6d27   ( bounds['ylim'
-0000e390: 5d5b 315d 202d 2062 6f75 6e64 735b 2779  ][1] - bounds['y
-0000e3a0: 6c69 6d27 5d5b 305d 2020 290d 0a20 2020  lim'][0]  )..   
-0000e3b0: 2020 2020 2073 635a 203d 2028 2062 6f75       scZ = ( bou
-0000e3c0: 6e64 735b 277a 6c69 6d27 5d5b 315d 202d  nds['zlim'][1] -
-0000e3d0: 2062 6f75 6e64 735b 277a 6c69 6d27 5d5b   bounds['zlim'][
-0000e3e0: 305d 2020 290d 0a20 2020 2020 2020 2072  0]  )..        r
-0000e3f0: 6563 6970 203d 205b 7363 582c 7363 592c  ecip = [scX,scY,
-0000e400: 7363 5a5d 0d0a 2020 2020 2020 2020 7363  scZ]..        sc
-0000e410: 616c 6520 3d20 6e70 2e72 6563 6970 726f  ale = np.recipro
-0000e420: 6361 6c28 7265 6369 7029 0d0a 2020 2020  cal(recip)..    
-0000e430: 2020 2020 7265 7475 726e 2073 6361 6c65      return scale
-0000e440: 2c20 7265 6369 700d 0a0d 0a20 2020 2064  , recip....    d
-0000e450: 6566 2076 6572 7465 786e 6f72 6d61 6c73  ef vertexnormals
-0000e460: 2873 656c 662c 202a 2a6b 6172 6773 2920  (self, **kargs) 
-0000e470: 3a0d 0a20 2020 2020 2020 2022 2222 0d0a  :..        """..
-0000e480: 2020 2020 2020 2020 556e 6974 2064 6972          Unit dir
-0000e490: 6563 7469 6f6e 7320 6f72 2056 6563 746f  ections or Vecto
-0000e4a0: 7233 4443 6f6c 6c65 6374 696f 6e20 6f66  r3DCollection of
-0000e4b0: 2076 6572 7465 7820 6e6f 726d 616c 7320   vertex normals 
-0000e4c0: 6174 2076 6572 7469 6365 732e 0d0a 0d0a  at vertices.....
-0000e4d0: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
-0000e4e0: 7273 0d0a 2020 2020 2020 2020 2d2d 2d2d  rs..        ----
-0000e4f0: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
-0000e500: 7363 616c 653a 206e 756d 6265 722c 206f  scale: number, o
-0000e510: 7074 696f 6e61 6c0d 0a20 2020 2020 2020  ptional..       
-0000e520: 2020 2020 2049 6620 6e6f 7420 7370 6563       If not spec
-0000e530: 7469 6669 6564 2c20 7363 616c 6564 2070  tified, scaled p
-0000e540: 726f 706f 7274 696f 6e61 6c20 746f 2074  roportional to t
-0000e550: 6865 206d 6561 6e20 6564 6765 0d0a 2020  he mean edge..  
-0000e560: 2020 2020 2020 2020 2020 6c65 6e67 7468            length
-0000e570: 206f 6620 7375 7266 6163 6520 6261 7365   of surface base
-0000e580: 2066 6163 6573 2e0d 0a0d 0a20 2020 2020   faces.....     
-0000e590: 2020 2076 3364 3a20 626f 6f6c 6561 6e2c     v3d: boolean,
-0000e5a0: 206f 7074 696f 6e61 6c2c 2064 6566 6175   optional, defau
-0000e5b0: 6c74 3a20 5472 7565 0d0a 2020 2020 2020  lt: True..      
-0000e5c0: 2020 2020 2020 4966 2054 7275 652c 2056        If True, V
-0000e5d0: 6563 746f 7233 4443 6f6c 6c65 6374 696f  ector3DCollectio
-0000e5e0: 6e20 6973 2072 6574 7572 6e65 642c 2065  n is returned, e
-0000e5f0: 6c73 6520 6120 4e20 7820 3320 6172 7261  lse a N x 3 arra
-0000e600: 790d 0a20 2020 2020 2020 2020 2020 206f  y..            o
-0000e610: 6620 756e 6974 2076 6563 746f 7220 7665  f unit vector ve
-0000e620: 7274 6578 206e 6f72 6d61 6c73 2069 7320  rtex normals is 
-0000e630: 7265 7475 726e 6564 2069 6620 4661 6c73  returned if Fals
-0000e640: 652e 0d0a 0d0a 2020 2020 2020 2020 636f  e.....        co
-0000e650: 6c6f 7220 3a20 7374 7220 6f72 2066 6c6f  lor : str or flo
-0000e660: 6174 206c 6973 7420 6f66 206c 656e 6774  at list of lengt
-0000e670: 6820 3320 6f72 2034 2e0d 0a20 2020 2020  h 3 or 4...     
-0000e680: 2020 2020 2020 2052 4742 206f 7220 5247         RGB or RG
-0000e690: 4241 2063 6f6c 6f72 2c20 6569 7468 6572  BA color, either
-0000e6a0: 2061 204d 6174 706c 6f74 6c69 6220 666f   a Matplotlib fo
-0000e6b0: 726d 6174 2073 7472 696e 6720 6f72 2061  rmat string or a
-0000e6c0: 200d 0a20 2020 2020 2020 2020 2020 206c   ..            l
-0000e6d0: 6973 7420 6f66 2063 6f6c 6f72 2076 616c  ist of color val
-0000e6e0: 7565 7320 696e 2072 616e 6765 205b 302c  ues in range [0,
-0000e6f0: 315d 2e0d 0a20 2020 2020 2020 200d 0a20  1]...        .. 
-0000e700: 2020 2020 2020 2077 6964 7468 203a 206e         width : n
-0000e710: 756d 6265 722c 206f 7074 696f 6e61 6c2c  umber, optional,
-0000e720: 2064 6566 6175 6c74 3a20 310d 0a20 2020   default: 1..   
-0000e730: 2020 2020 2020 2020 204c 696e 6520 7769           Line wi
-0000e740: 6474 6820 6f66 2074 6865 2076 6563 746f  dth of the vecto
-0000e750: 722e 0d0a 0d0a 2020 2020 2020 2020 616c  r.....        al
-0000e760: 7220 3a20 7363 616c 6172 2c20 6f70 7469  r : scalar, opti
-0000e770: 6f6e 616c 2c20 6465 6661 756c 743a 2030  onal, default: 0
-0000e780: 2e32 350d 0a20 2020 2020 2020 2020 2020  .25..           
-0000e790: 2041 7869 7320 6c65 6e67 7468 2072 6174   Axis length rat
-0000e7a0: 696f 2c20 6865 6164 2073 697a 6520 746f  io, head size to
-0000e7b0: 2076 6563 746f 7220 6d61 676e 6974 7564   vector magnitud
-0000e7c0: 652e 0d0a 0d0a 2020 2020 2020 2020 5265  e.....        Re
-0000e7d0: 7475 726e 730d 0a20 2020 2020 2020 202d  turns..        -
-0000e7e0: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
-0000e7f0: 5665 6374 6f72 3344 436f 6c6c 6563 7469  Vector3DCollecti
-0000e800: 6f6e 206f 626a 6563 7420 6f72 2061 7272  on object or arr
-0000e810: 6179 206f 6620 756e 6974 2064 6972 6563  ay of unit direc
-0000e820: 7469 6f6e 2076 6563 746f 7273 0d0a 0d0a  tion vectors....
-0000e830: 2020 2020 2020 2020 2222 220d 0a0d 0a20          """.... 
-0000e840: 2020 2020 2020 206b 6172 6744 6674 203d         kargDft =
-0000e850: 207b 2027 7363 616c 6527 3a73 656c 662e   { 'scale':self.
-0000e860: 5f6e 6f72 6d61 6c5f 7363 616c 652c 2027  _normal_scale, '
-0000e870: 7633 6427 3a54 7275 652c 2027 636f 6c6f  v3d':True, 'colo
-0000e880: 7227 3a4e 6f6e 652c 2027 7769 6474 6827  r':None, 'width'
-0000e890: 3a31 2c20 2761 6c72 273a 5f44 4654 5f41  :1, 'alr':_DFT_A
-0000e8a0: 4c52 2020 7d0d 0a20 2020 2020 2020 204b  LR  }..        K
-0000e8b0: 5720 3d20 4b57 7072 6f63 6573 736f 7228  W = KWprocessor(
-0000e8c0: 6b61 7267 4466 742c 2776 6563 746f 7266  kargDft,'vectorf
-0000e8d0: 6965 6c64 5f66 726f 6d5f 6f70 272c 2a2a  ield_from_op',**
-0000e8e0: 6b61 7267 7329 0d0a 2020 2020 2020 2020  kargs)..        
-0000e8f0: 7363 616c 6520 3d20 4b57 2e67 6574 5661  scale = KW.getVa
-0000e900: 6c28 2773 6361 6c65 2729 0d0a 2020 2020  l('scale')..    
-0000e910: 2020 2020 6973 5633 4420 3d20 4b57 2e67      isV3D = KW.g
-0000e920: 6574 5661 6c28 2776 3364 2729 0d0a 2020  etVal('v3d')..  
-0000e930: 2020 2020 2020 636f 6c6f 7220 3d20 4b57        color = KW
-0000e940: 2e67 6574 5661 6c28 2763 6f6c 6f72 2729  .getVal('color')
-0000e950: 0d0a 2020 2020 2020 2020 7769 6474 6820  ..        width 
-0000e960: 3d20 4b57 2e67 6574 5661 6c28 2777 6964  = KW.getVal('wid
-0000e970: 7468 2729 0d0a 2020 2020 2020 2020 616c  th')..        al
-0000e980: 7220 3d20 4b57 2e67 6574 5661 6c28 2761  r = KW.getVal('a
-0000e990: 6c72 2729 0d0a 0d0a 2020 2020 2020 2020  lr')....        
-0000e9a0: 7665 7274 7320 3d20 7365 6c66 2e76 6572  verts = self.ver
-0000e9b0: 7465 7843 6f6f 720d 0a20 2020 2020 2020  texCoor..       
-0000e9c0: 206e 6f72 6d73 203d 2073 656c 662e 5f67   norms = self._g
-0000e9d0: 6574 5f76 6572 7465 785f 6e6f 726d 616c  et_vertex_normal
-0000e9e0: 7328 290d 0a20 2020 2020 2020 2069 6620  s()..        if 
-0000e9f0: 6e6f 7420 6973 5633 4420 3a20 7265 7475  not isV3D : retu
-0000ea00: 726e 206e 6f72 6d73 0d0a 2020 2020 2020  rn norms..      
-0000ea10: 2020 6e61 6d65 203d 2027 7665 7274 6578    name = 'vertex
-0000ea20: 5f6e 6f72 6d61 6c73 270d 0a20 2020 2020  _normals'..     
-0000ea30: 2020 206c 636f 6c20 3d20 5665 6374 6f72     lcol = Vector
-0000ea40: 3344 436f 6c6c 6563 7469 6f6e 2876 6572  3DCollection(ver
-0000ea50: 7473 2c6e 6f72 6d73 2a73 6361 6c65 2c61  ts,norms*scale,a
-0000ea60: 6c72 2c6e 616d 652c 636f 6c6f 7273 3d63  lr,name,colors=c
-0000ea70: 6f6c 6f72 2c20 6c69 6e65 7769 6474 6873  olor, linewidths
-0000ea80: 3d77 6964 7468 290d 0a20 2020 2020 2020  =width)..       
-0000ea90: 206c 636f 6c2e 636f 6f72 5479 7065 203d   lcol.coorType =
-0000eaa0: 2073 656c 662e 636f 6f72 5479 7065 0d0a   self.coorType..
-0000eab0: 2020 2020 2020 2020 6c63 6f6c 2e75 7677          lcol.uvw
-0000eac0: 4f72 6965 6e74 6174 696f 6e54 7970 6520  OrientationType 
-0000ead0: 3d20 5f43 4f4f 5253 5953 5b22 5859 5a22  = _COORSYS["XYZ"
-0000eae0: 5d0d 0a20 2020 2020 2020 2069 6620 636f  ]..        if co
-0000eaf0: 6c6f 7220 6973 204e 6f6e 6520 3a20 6c63  lor is None : lc
-0000eb00: 6f6c 2e5f 7365 745f 7665 6374 436f 6c6f  ol._set_vectColo
-0000eb10: 7228 2073 656c 662e 7665 7274 6578 436f  r( self.vertexCo
-0000eb20: 6c6f 7220 290d 0a20 2020 2020 2020 2072  lor )..        r
-0000eb30: 6574 7572 6e20 6c63 6f6c 0d0a 0d0a 2020  eturn lcol....  
-0000eb40: 2020 6465 6620 6661 6365 6e6f 726d 616c    def facenormal
-0000eb50: 7328 7365 6c66 2c20 2a2a 6b61 7267 7329  s(self, **kargs)
-0000eb60: 203a 0d0a 2020 2020 2020 2020 2222 220d   :..        """.
-0000eb70: 0a20 2020 2020 2020 2055 6e69 7420 6469  .        Unit di
-0000eb80: 7265 6374 696f 6e73 206f 7220 5665 6374  rections or Vect
-0000eb90: 6f72 3344 436f 6c6c 6563 7469 6f6e 206f  or3DCollection o
-0000eba0: 6620 6661 6365 206e 6f72 6d61 6c73 2061  f face normals a
-0000ebb0: 7420 6661 6365 2063 656e 7465 7273 2e0d  t face centers..
-0000ebc0: 0a0d 0a20 2020 2020 2020 2050 6172 616d  ...        Param
-0000ebd0: 6574 6572 730d 0a20 2020 2020 2020 202d  eters..        -
-0000ebe0: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
-0000ebf0: 2020 2073 6361 6c65 3a20 6e75 6d62 6572     scale: number
-0000ec00: 2c20 6f70 7469 6f6e 616c 0d0a 2020 2020  , optional..    
-0000ec10: 2020 2020 2020 2020 4966 206e 6f74 2073          If not s
-0000ec20: 7065 6374 6966 6965 642c 2073 6361 6c65  pectified, scale
-0000ec30: 6420 7072 6f70 6f72 7469 6f6e 616c 2074  d proportional t
-0000ec40: 6f20 7468 6520 6d65 616e 2065 6467 650d  o the mean edge.
-0000ec50: 0a20 2020 2020 2020 2020 2020 206c 656e  .            len
-0000ec60: 6774 6820 6f66 2073 7572 6661 6365 2062  gth of surface b
-0000ec70: 6173 6520 6661 6365 732e 0d0a 0d0a 2020  ase faces.....  
-0000ec80: 2020 2020 2020 7633 643a 2062 6f6f 6c65        v3d: boole
-0000ec90: 616e 2c20 6f70 7469 6f6e 616c 2c20 6465  an, optional, de
-0000eca0: 6661 756c 743a 2054 7275 650d 0a20 2020  fault: True..   
-0000ecb0: 2020 2020 2020 2020 2049 6620 5472 7565           If True
-0000ecc0: 2c20 5665 6374 6f72 3344 436f 6c6c 6563  , Vector3DCollec
-0000ecd0: 7469 6f6e 2069 7320 7265 7475 726e 6564  tion is returned
-0000ece0: 2c20 656c 7365 2061 204e 2078 2033 2061  , else a N x 3 a
-0000ecf0: 7272 6179 0d0a 2020 2020 2020 2020 2020  rray..          
-0000ed00: 2020 6f66 2075 6e69 7420 7665 6374 6f72    of unit vector
-0000ed10: 2066 6163 6520 6e6f 726d 616c 7320 6973   face normals is
-0000ed20: 2072 6574 7572 6e65 6420 6966 2046 616c   returned if Fal
-0000ed30: 7365 2e0d 0a0d 0a20 2020 2020 2020 2063  se.....        c
-0000ed40: 6f6c 6f72 203a 2073 7472 206f 7220 666c  olor : str or fl
-0000ed50: 6f61 7420 6c69 7374 206f 6620 6c65 6e67  oat list of leng
-0000ed60: 7468 2033 206f 7220 342e 0d0a 2020 2020  th 3 or 4...    
-0000ed70: 2020 2020 2020 2020 5247 4220 6f72 2052          RGB or R
-0000ed80: 4742 4120 636f 6c6f 722c 2065 6974 6865  GBA color, eithe
-0000ed90: 7220 6120 4d61 7470 6c6f 746c 6962 2066  r a Matplotlib f
-0000eda0: 6f72 6d61 7420 7374 7269 6e67 206f 7220  ormat string or 
-0000edb0: 6120 0d0a 2020 2020 2020 2020 2020 2020  a ..            
-0000edc0: 6c69 7374 206f 6620 636f 6c6f 7220 7661  list of color va
-0000edd0: 6c75 6573 2069 6e20 7261 6e67 6520 5b30  lues in range [0
-0000ede0: 2c31 5d2e 0d0a 2020 2020 2020 2020 0d0a  ,1]...        ..
-0000edf0: 2020 2020 2020 2020 7769 6474 6820 3a20          width : 
-0000ee00: 6e75 6d62 6572 2c20 6f70 7469 6f6e 616c  number, optional
-0000ee10: 2c20 6465 6661 756c 743a 2031 0d0a 2020  , default: 1..  
-0000ee20: 2020 2020 2020 2020 2020 4c69 6e65 2077            Line w
-0000ee30: 6964 7468 206f 6620 7468 6520 7665 6374  idth of the vect
-0000ee40: 6f72 2e0d 0a0d 0a20 2020 2020 2020 2061  or.....        a
-0000ee50: 6c72 203a 2073 6361 6c61 722c 206f 7074  lr : scalar, opt
-0000ee60: 696f 6e61 6c2c 2064 6566 6175 6c74 3a20  ional, default: 
-0000ee70: 302e 3235 0d0a 2020 2020 2020 2020 2020  0.25..          
-0000ee80: 2020 4178 6973 206c 656e 6774 6820 7261    Axis length ra
-0000ee90: 7469 6f2c 2068 6561 6420 7369 7a65 2074  tio, head size t
-0000eea0: 6f20 7665 6374 6f72 206d 6167 6e69 7475  o vector magnitu
-0000eeb0: 6465 2e0d 0a0d 0a20 2020 2020 2020 2052  de.....        R
-0000eec0: 6574 7572 6e73 0d0a 2020 2020 2020 2020  eturns..        
-0000eed0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-0000eee0: 2056 6563 746f 7233 4443 6f6c 6c65 6374   Vector3DCollect
-0000eef0: 696f 6e20 6f62 6a65 6374 206f 7220 6172  ion object or ar
-0000ef00: 7261 7920 6f66 2075 6e69 7420 6469 7265  ray of unit dire
-0000ef10: 6374 696f 6e20 7665 6374 6f72 730d 0a0d  ction vectors...
-0000ef20: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
-0000ef30: 2020 2020 2020 234e 6f74 653a 2064 6566        #Note: def
-0000ef40: 6175 6c74 2063 6f6c 6f72 3a4e 6f6e 6520  ault color:None 
-0000ef50: 736f 2074 6861 7420 6361 6e20 7573 6520  so that can use 
-0000ef60: 6173 2061 2066 6c61 6720 746f 2075 7365  as a flag to use
-0000ef70: 2066 6163 6520 636f 6c6f 7273 2069 6620   face colors if 
-0000ef80: 6e6f 7420 6465 6669 6e65 642e 200d 0a20  not defined. .. 
-0000ef90: 2020 2020 2020 206b 6172 6744 6674 203d         kargDft =
-0000efa0: 207b 2027 7363 616c 6527 3a73 656c 662e   { 'scale':self.
-0000efb0: 5f6e 6f72 6d61 6c5f 7363 616c 652c 2027  _normal_scale, '
-0000efc0: 7633 6427 3a54 7275 652c 2027 636f 6c6f  v3d':True, 'colo
-0000efd0: 7227 3a4e 6f6e 652c 2027 7769 6474 6827  r':None, 'width'
-0000efe0: 3a31 2c20 2761 6c72 273a 5f44 4654 5f41  :1, 'alr':_DFT_A
-0000eff0: 4c52 2020 7d0d 0a20 2020 2020 2020 204b  LR  }..        K
-0000f000: 5720 3d20 4b57 7072 6f63 6573 736f 7228  W = KWprocessor(
-0000f010: 6b61 7267 4466 742c 2776 6563 746f 7266  kargDft,'vectorf
-0000f020: 6965 6c64 5f66 726f 6d5f 6f70 272c 2a2a  ield_from_op',**
-0000f030: 6b61 7267 7329 0d0a 2020 2020 2020 2020  kargs)..        
-0000f040: 7363 616c 6520 3d20 4b57 2e67 6574 5661  scale = KW.getVa
-0000f050: 6c28 2773 6361 6c65 2729 0d0a 2020 2020  l('scale')..    
-0000f060: 2020 2020 6973 5633 4420 3d20 4b57 2e67      isV3D = KW.g
-0000f070: 6574 5661 6c28 2776 3364 2729 0d0a 2020  etVal('v3d')..  
-0000f080: 2020 2020 2020 636f 6c6f 7220 3d20 4b57        color = KW
-0000f090: 2e67 6574 5661 6c28 2763 6f6c 6f72 2729  .getVal('color')
-0000f0a0: 0d0a 2020 2020 2020 2020 7769 6474 6820  ..        width 
-0000f0b0: 3d20 4b57 2e67 6574 5661 6c28 2777 6964  = KW.getVal('wid
-0000f0c0: 7468 2729 0d0a 2020 2020 2020 2020 616c  th')..        al
-0000f0d0: 7220 3d20 4b57 2e67 6574 5661 6c28 2761  r = KW.getVal('a
-0000f0e0: 6c72 2729 0d0a 0d0a 2020 2020 2020 2020  lr')....        
-0000f0f0: 7665 7274 7320 3d20 7365 6c66 2e76 6572  verts = self.ver
-0000f100: 7465 7843 6f6f 725b 2073 656c 662e 6676  texCoor[ self.fv
-0000f110: 496e 6469 6365 7320 5d0d 0a20 2020 2020  Indices ]..     
-0000f120: 2020 2066 6163 6543 656e 7465 7243 6f6f     faceCenterCoo
-0000f130: 7220 3d20 7365 6c66 2e5f 6765 745f 6661  r = self._get_fa
-0000f140: 6365 5f63 656e 7465 7273 2876 6572 7473  ce_centers(verts
-0000f150: 290d 0a20 2020 2020 2020 2066 6163 654e  )..        faceN
-0000f160: 6f72 6d61 6c43 6f6f 7220 3d20 7365 6c66  ormalCoor = self
-0000f170: 2e5f 6765 745f 6661 6365 5f6e 6f72 6d61  ._get_face_norma
-0000f180: 6c73 2876 6572 7473 290d 0a20 2020 2020  ls(verts)..     
-0000f190: 2020 2069 6620 6e6f 7420 6973 5633 4420     if not isV3D 
-0000f1a0: 3a20 7265 7475 726e 2066 6163 654e 6f72  : return faceNor
-0000f1b0: 6d61 6c43 6f6f 720d 0a20 2020 2020 2020  malCoor..       
-0000f1c0: 206e 616d 6520 3d20 2766 6163 655f 6e6f   name = 'face_no
-0000f1d0: 726d 616c 7327 0d0a 2020 2020 2020 2020  rmals'..        
-0000f1e0: 6c63 6f6c 203d 2056 6563 746f 7233 4443  lcol = Vector3DC
-0000f1f0: 6f6c 6c65 6374 696f 6e28 6661 6365 4365  ollection(faceCe
-0000f200: 6e74 6572 436f 6f72 2c66 6163 654e 6f72  nterCoor,faceNor
-0000f210: 6d61 6c43 6f6f 722a 7363 616c 652c 616c  malCoor*scale,al
-0000f220: 722c 6e61 6d65 2c63 6f6c 6f72 733d 636f  r,name,colors=co
-0000f230: 6c6f 722c 206c 696e 6577 6964 7468 733d  lor, linewidths=
-0000f240: 7769 6474 6829 0d0a 2020 2020 2020 2020  width)..        
-0000f250: 2320 2d2d 2d20 312e 3120 6d6f 6420 2d2d  # --- 1.1 mod --
-0000f260: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0000f270: 2d2d 0d0a 2020 2020 2020 2020 6c63 6f6c  --..        lcol
-0000f280: 2e63 6f6f 7254 7970 6520 3d20 7365 6c66  .coorType = self
-0000f290: 2e63 6f6f 7254 7970 650d 0a20 2020 2020  .coorType..     
-0000f2a0: 2020 206c 636f 6c2e 7576 774f 7269 656e     lcol.uvwOrien
-0000f2b0: 7461 7469 6f6e 5479 7065 203d 205f 434f  tationType = _CO
-0000f2c0: 4f52 5359 535b 2258 595a 225d 0d0a 2020  ORSYS["XYZ"]..  
-0000f2d0: 2020 2020 2020 6966 2063 6f6c 6f72 2069        if color i
-0000f2e0: 7320 4e6f 6e65 203a 206c 636f 6c2e 5f73  s None : lcol._s
-0000f2f0: 6574 5f76 6563 7443 6f6c 6f72 2873 656c  et_vectColor(sel
-0000f300: 662e 5f66 6163 6563 6f6c 6f72 7329 0d0a  f._facecolors)..
-0000f310: 2020 2020 2020 2020 7265 7475 726e 206c          return l
-0000f320: 636f 6c0d 0a0d 0a20 2020 2064 6566 2064  col....    def d
-0000f330: 6973 7066 6965 6c64 5f66 726f 6d5f 6f70  ispfield_from_op
-0000f340: 2873 656c 662c 206f 7065 7261 7469 6f6e  (self, operation
-0000f350: 2c20 2a2a 6b61 7267 7329 203a 0d0a 2020  , **kargs) :..  
-0000f360: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
-0000f370: 2020 2056 6563 746f 7233 4443 6f6c 6c65     Vector3DColle
-0000f380: 6374 696f 6e20 6f66 2064 6973 706c 6163  ction of displac
-0000f390: 656d 656e 7420 6f66 2076 6572 7469 6365  ement of vertice
-0000f3a0: 7320 746f 2061 2064 6966 6665 7265 6e74  s to a different
-0000f3b0: 2070 6f73 6974 696f 6e2e 0d0a 0d0a 2020   position.....  
-0000f3c0: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
-0000f3d0: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-0000f3e0: 2d2d 2d2d 0d0a 2020 2020 2020 2020 6f70  ----..        op
-0000f3f0: 6572 6174 696f 6e20 3a20 6675 6e63 7469  eration : functi
-0000f400: 6f6e 206f 626a 6563 740d 0a20 2020 2020  on object..     
-0000f410: 2020 2020 2020 2046 756e 6374 696f 6e20         Function 
-0000f420: 7468 6174 2074 616b 6573 206f 6e65 2063  that takes one c
-0000f430: 6f6f 7264 696e 6174 650d 0a20 2020 2020  oordinate..     
-0000f440: 2020 2020 2020 2061 7267 756d 656e 742c         argument,
-0000f450: 2061 2033 784e 204e 756d 7079 2061 7272   a 3xN Numpy arr
-0000f460: 6179 2e0d 0a20 2020 2020 2020 2020 2020  ay...           
-0000f470: 2054 6865 2066 756e 6374 696f 6e20 7265   The function re
-0000f480: 7475 726e 7320 6120 3378 4e20 6172 7261  turns a 3xN arra
-0000f490: 7920 6f66 2076 6563 746f 7273 2e0d 0a20  y of vectors... 
-0000f4a0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-0000f4b0: 2072 6574 7572 6e78 797a 203a 2062 6f6f   returnxyz : boo
-0000f4c0: 6c20 7b20 5472 7565 2c20 4661 6c73 6520  l { True, False 
-0000f4d0: 7d2c 206f 7074 696f 6e61 6c2c 2064 6566  }, optional, def
-0000f4e0: 6175 6c74 3a20 4661 6c73 650d 0a20 2020  ault: False..   
-0000f4f0: 2020 2020 2020 2020 2042 7920 6465 6661           By defa
-0000f500: 756c 742c 206e 6174 6976 6520 636f 6f72  ult, native coor
-0000f510: 6469 6e61 7465 7320 6172 6520 7265 7475  dinates are retu
-0000f520: 726e 6564 2062 7920 7468 650d 0a20 2020  rned by the..   
-0000f530: 2020 2020 2020 2020 206f 7065 7261 7469           operati
-0000f540: 6f6e 2066 756e 6374 696f 6e2e 2020 4966  on function.  If
-0000f550: 2073 6574 2054 7275 652c 2074 6865 206f   set True, the o
-0000f560: 7065 7261 7469 6f6e 0d0a 2020 2020 2020  peration..      
-0000f570: 2020 2020 2020 7265 7475 726e 7320 7879        returns xy
-0000f580: 7a20 4361 7274 6573 6961 6e20 636f 6f72  z Cartesian coor
-0000f590: 6469 6e61 7465 732e 0d0a 0d0a 2020 2020  dinates.....    
-0000f5a0: 2020 2020 7573 6542 6173 6520 3a20 626f      useBase : bo
-0000f5b0: 6f6c 207b 2054 7275 652c 2046 616c 7365  ol { True, False
-0000f5c0: 207d 2c20 6f70 7469 6f6e 616c 2c20 6465   }, optional, de
-0000f5d0: 6661 756c 743a 2046 616c 7365 0d0a 2020  fault: False..  
-0000f5e0: 2020 2020 2020 2020 2020 5768 656e 2073            When s
-0000f5f0: 6574 2046 616c 7365 2c20 7665 7274 6963  et False, vertic
-0000f600: 6573 206f 6620 7468 6520 7375 7266 6163  es of the surfac
-0000f610: 652c 2070 7269 6f72 2074 6f0d 0a20 2020  e, prior to..   
-0000f620: 2020 2020 2020 2020 2061 6e79 2067 656f           any geo
-0000f630: 6d65 7472 6963 206d 6170 7069 6e67 206f  metric mapping o
-0000f640: 7220 7472 616e 7366 6f72 6d73 2c20 6172  r transforms, ar
-0000f650: 6520 7061 7373 6564 2074 6f0d 0a20 2020  e passed to..   
-0000f660: 2020 2020 2020 2020 2074 6865 206f 7065           the ope
-0000f670: 7261 7469 6f6e 2066 756e 6374 696f 6e2e  ration function.
-0000f680: 2020 4f74 6865 7277 6973 652c 2077 6865    Otherwise, whe
-0000f690: 6e20 5472 7565 2c20 7468 650d 0a20 2020  n True, the..   
-0000f6a0: 2020 2020 2020 2020 2063 7572 7265 6e74           current
-0000f6b0: 2073 7572 6661 6365 2076 6572 7469 6365   surface vertice
-0000f6c0: 7320 6172 6520 7061 7373 6564 2e0d 0a0d  s are passed....
-0000f6d0: 0a20 2020 2020 2020 2073 6361 6c65 3a20  .        scale: 
-0000f6e0: 6e75 6d62 6572 2c20 6f70 7469 6f6e 616c  number, optional
-0000f6f0: 2c20 6465 6661 756c 743a 2031 2e0d 0a0d  , default: 1....
-0000f700: 0a20 2020 2020 2020 2063 6f6c 6f72 203a  .        color :
-0000f710: 2073 7472 206f 7220 666c 6f61 7420 6c69   str or float li
-0000f720: 7374 206f 6620 6c65 6e67 7468 2033 206f  st of length 3 o
-0000f730: 7220 342e 0d0a 2020 2020 2020 2020 2020  r 4...          
-0000f740: 2020 5247 4220 6f72 2052 4742 4120 636f    RGB or RGBA co
-0000f750: 6c6f 722c 2065 6974 6865 7220 6120 4d61  lor, either a Ma
-0000f760: 7470 6c6f 746c 6962 2066 6f72 6d61 7420  tplotlib format 
-0000f770: 7374 7269 6e67 206f 7220 6120 0d0a 2020  string or a ..  
-0000f780: 2020 2020 2020 2020 2020 6c69 7374 206f            list o
-0000f790: 6620 636f 6c6f 7220 7661 6c75 6573 2069  f color values i
-0000f7a0: 6e20 7261 6e67 6520 5b30 2c31 5d2e 0d0a  n range [0,1]...
-0000f7b0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-0000f7c0: 2020 7769 6474 6820 3a20 6e75 6d62 6572    width : number
-0000f7d0: 2c20 6f70 7469 6f6e 616c 2c20 6465 6661  , optional, defa
-0000f7e0: 756c 743a 2031 0d0a 2020 2020 2020 2020  ult: 1..        
-0000f7f0: 2020 2020 4c69 6e65 2077 6964 7468 206f      Line width o
-0000f800: 6620 7468 6520 7665 6374 6f72 2e0d 0a0d  f the vector....
-0000f810: 0a20 2020 2020 2020 2061 6c72 203a 2073  .        alr : s
-0000f820: 6361 6c61 722c 206f 7074 696f 6e61 6c2c  calar, optional,
-0000f830: 2064 6566 6175 6c74 3a20 302e 3235 0d0a   default: 0.25..
-0000f840: 2020 2020 2020 2020 2020 2020 4178 6973              Axis
-0000f850: 206c 656e 6774 6820 7261 7469 6f2c 2068   length ratio, h
-0000f860: 6561 6420 7369 7a65 2074 6f20 7665 6374  ead size to vect
-0000f870: 6f72 206d 6167 6e69 7475 6465 2e0d 0a0d  or magnitude....
-0000f880: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-0000f890: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-0000f8a0: 2d0d 0a20 2020 2020 2020 2056 6563 746f  -..        Vecto
-0000f8b0: 7233 4443 6f6c 6c65 6374 696f 6e20 6f62  r3DCollection ob
-0000f8c0: 6a65 6374 0d0a 0d0a 2020 2020 2020 2020  ject....        
-0000f8d0: 2222 220d 0a0d 0a20 2020 2020 2020 206b  """....        k
-0000f8e0: 6172 6744 6674 203d 207b 2027 7265 7475  argDft = { 'retu
-0000f8f0: 726e 7879 7a27 3a46 616c 7365 2c20 2775  rnxyz':False, 'u
-0000f900: 7365 4261 7365 273a 4661 6c73 652c 200d  seBase':False, .
-0000f910: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000f920: 2020 2020 2027 7363 616c 6527 3a31 2c20       'scale':1, 
-0000f930: 2763 6f6c 6f72 273a 2762 6c61 636b 272c  'color':'black',
-0000f940: 2027 7769 6474 6827 3a31 2c20 2761 6c72   'width':1, 'alr
-0000f950: 273a 5f44 4654 5f41 4c52 2020 7d0d 0a20  ':_DFT_ALR  }.. 
-0000f960: 2020 2020 2020 204b 5720 3d20 4b57 7072         KW = KWpr
-0000f970: 6f63 6573 736f 7228 6b61 7267 4466 742c  ocessor(kargDft,
-0000f980: 2764 6973 7066 6965 6c64 5f66 726f 6d5f  'dispfield_from_
-0000f990: 6f70 272c 2a2a 6b61 7267 7329 0d0a 2020  op',**kargs)..  
-0000f9a0: 2020 2020 2020 7265 7475 726e 7879 7a20        returnxyz 
-0000f9b0: 3d20 4b57 2e67 6574 5661 6c28 2772 6574  = KW.getVal('ret
-0000f9c0: 7572 6e78 797a 2729 0d0a 2020 2020 2020  urnxyz')..      
-0000f9d0: 2020 7573 6542 6173 6520 3d20 4b57 2e67    useBase = KW.g
-0000f9e0: 6574 5661 6c28 2775 7365 4261 7365 2729  etVal('useBase')
-0000f9f0: 0d0a 2020 2020 2020 2020 7363 616c 6520  ..        scale 
-0000fa00: 3d20 4b57 2e67 6574 5661 6c28 2773 6361  = KW.getVal('sca
-0000fa10: 6c65 2729 0d0a 2020 2020 2020 2020 636f  le')..        co
-0000fa20: 6c6f 7220 3d20 4b57 2e67 6574 5661 6c28  lor = KW.getVal(
-0000fa30: 2763 6f6c 6f72 2729 0d0a 2020 2020 2020  'color')..      
-0000fa40: 2020 7769 6474 6820 3d20 4b57 2e67 6574    width = KW.get
-0000fa50: 5661 6c28 2777 6964 7468 2729 0d0a 2020  Val('width')..  
-0000fa60: 2020 2020 2020 616c 7220 3d20 4b57 2e67        alr = KW.g
-0000fa70: 6574 5661 6c28 2761 6c72 2729 0d0a 0d0a  etVal('alr')....
-0000fa80: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-0000fa90: 5f69 7343 6f6d 706f 7369 7465 5375 7266  _isCompositeSurf
-0000faa0: 6163 6520 3a0d 0a20 2020 2020 2020 2020  ace :..         
-0000fab0: 2020 2077 6172 6e69 6e67 732e 7761 726e     warnings.warn
-0000fac0: 2827 5665 6374 6f72 206f 7065 7261 7469  ('Vector operati
-0000fad0: 6f6e 206e 6f74 2061 7661 696c 6162 6c65  on not available
-0000fae0: 2066 6f72 2063 6f6d 6269 6e65 6420 7368   for combined sh
-0000faf0: 6170 6573 2e27 290d 0a20 2020 2020 2020  apes.')..       
-0000fb00: 2020 2020 2072 6574 7572 6e0d 0a20 2020       return..   
-0000fb10: 2020 2020 2073 7461 7274 5f63 6f6f 7220       start_coor 
-0000fb20: 3d20 7365 6c66 2e76 6572 7465 7843 6f6f  = self.vertexCoo
-0000fb30: 720d 0a20 2020 2020 2020 2069 6620 7573  r..        if us
-0000fb40: 6542 6173 6520 3a20 7374 6172 745f 636f  eBase : start_co
-0000fb50: 6f72 203d 2073 656c 662e 6261 7365 5665  or = self.baseVe
-0000fb60: 7274 6578 436f 6f72 0d0a 2020 2020 2020  rtexCoor..      
-0000fb70: 2020 7620 3d20 7365 6c66 2e5f 7472 616e    v = self._tran
-0000fb80: 7366 6f72 6d56 6563 746f 7228 7374 6172  sformVector(star
-0000fb90: 745f 636f 6f72 2c20 6f70 6572 6174 696f  t_coor, operatio
-0000fba0: 6e2c 2072 6574 7572 6e78 797a 290d 0a20  n, returnxyz).. 
-0000fbb0: 2020 2020 2020 2064 656c 7461 203d 2076         delta = v
-0000fbc0: 202d 2073 656c 662e 7665 7274 6578 436f   - self.vertexCo
-0000fbd0: 6f72 0d0a 2020 2020 2020 2020 6465 6c74  or..        delt
-0000fbe0: 6120 3d20 7363 616c 652a 6465 6c74 610d  a = scale*delta.
-0000fbf0: 0a20 2020 2020 2020 2023 202d 2d2d 2031  .        # --- 1
-0000fc00: 2e31 206d 6f64 202d 2d2d 2d2d 2d2d 2d2d  .1 mod ---------
-0000fc10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020  -----------..   
-0000fc20: 2020 2020 2076 4669 656c 6420 3d20 7365       vField = se
-0000fc30: 6c66 2e5f 6765 745f 7665 6374 6f72 6669  lf._get_vectorfi
-0000fc40: 656c 645f 4c69 6e65 3344 436f 6c6c 6563  eld_Line3DCollec
-0000fc50: 7469 6f6e 2864 656c 7461 2c20 636f 6c6f  tion(delta, colo
-0000fc60: 722c 2077 6964 7468 2c20 616c 7229 0d0a  r, width, alr)..
-0000fc70: 2020 2020 2020 2020 6966 2072 6574 7572          if retur
-0000fc80: 6e78 797a 203a 2076 4669 656c 642e 7576  nxyz : vField.uv
-0000fc90: 774f 7269 656e 7461 7469 6f6e 5479 7065  wOrientationType
-0000fca0: 203d 205f 434f 4f52 5359 535b 2258 595a   = _COORSYS["XYZ
-0000fcb0: 225d 0d0a 2020 2020 2020 2020 7265 7475  "]..        retu
-0000fcc0: 726e 2076 4669 656c 640d 0a0d 0a20 2020  rn vField....   
-0000fcd0: 2064 6566 2076 6563 746f 7266 6965 6c64   def vectorfield
-0000fce0: 5f66 726f 6d5f 6f70 2873 656c 662c 206f  _from_op(self, o
-0000fcf0: 7065 7261 7469 6f6e 2c20 2a2a 6b61 7267  peration, **karg
-0000fd00: 7329 203a 0d0a 2020 2020 2020 2020 2222  s) :..        ""
-0000fd10: 220d 0a20 2020 2020 2020 2056 6563 746f  "..        Vecto
-0000fd20: 7233 4443 6f6c 6c65 6374 696f 6e20 6f66  r3DCollection of
-0000fd30: 2076 6563 746f 7273 2069 6e20 752c 762c   vectors in u,v,
-0000fd40: 7720 636f 6f72 6469 6e61 7465 7320 6174  w coordinates at
-0000fd50: 2073 7572 6661 6365 2076 6572 7469 6365   surface vertice
-0000fd60: 732e 0d0a 0d0a 2020 2020 2020 2020 5061  s.....        Pa
-0000fd70: 7261 6d65 7465 7273 0d0a 2020 2020 2020  rameters..      
-0000fd80: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
-0000fd90: 2020 2020 2020 6f70 6572 6174 696f 6e20        operation 
-0000fda0: 3a20 6675 6e63 7469 6f6e 206f 626a 6563  : function objec
-0000fdb0: 740d 0a20 2020 2020 2020 2020 2020 2046  t..            F
-0000fdc0: 756e 6374 696f 6e20 7468 6174 2074 616b  unction that tak
-0000fdd0: 6573 206f 6e65 2063 6f6f 7264 696e 6174  es one coordinat
-0000fde0: 650d 0a20 2020 2020 2020 2020 2020 2061  e..            a
-0000fdf0: 7267 756d 656e 742c 2061 2033 784e 204e  rgument, a 3xN N
-0000fe00: 756d 7079 2061 7272 6179 206f 6620 6e61  umpy array of na
-0000fe10: 7469 7665 2063 6f6f 7264 696e 6174 6573  tive coordinates
-0000fe20: 2e0d 0a20 2020 2020 2020 2020 2020 2054  ...            T
-0000fe30: 6865 2066 756e 6374 696f 6e20 7265 7475  he function retu
-0000fe40: 726e 7320 6120 3378 4e20 6172 7261 7920  rns a 3xN array 
-0000fe50: 6f66 2076 6563 746f 7273 2e0d 0a20 2020  of vectors...   
-0000fe60: 2020 2020 200d 0a20 2020 2020 2020 2073       ..        s
-0000fe70: 6361 6c65 3a20 6e75 6d62 6572 2c20 6f70  cale: number, op
-0000fe80: 7469 6f6e 616c 2c20 6465 6661 756c 743a  tional, default:
-0000fe90: 2031 2e0d 0a0d 0a20 2020 2020 2020 2063   1.....        c
-0000fea0: 6f6c 6f72 203a 2073 7472 206f 7220 666c  olor : str or fl
-0000feb0: 6f61 7420 6c69 7374 206f 6620 6c65 6e67  oat list of leng
-0000fec0: 7468 2033 206f 7220 342e 0d0a 2020 2020  th 3 or 4...    
-0000fed0: 2020 2020 2020 2020 5247 4220 6f72 2052          RGB or R
-0000fee0: 4742 4120 636f 6c6f 722c 2065 6974 6865  GBA color, eithe
-0000fef0: 7220 6120 4d61 7470 6c6f 746c 6962 2066  r a Matplotlib f
-0000ff00: 6f72 6d61 7420 7374 7269 6e67 206f 7220  ormat string or 
-0000ff10: 6120 0d0a 2020 2020 2020 2020 2020 2020  a ..            
-0000ff20: 6c69 7374 206f 6620 636f 6c6f 7220 7661  list of color va
-0000ff30: 6c75 6573 2069 6e20 7261 6e67 6520 5b30  lues in range [0
-0000ff40: 2c31 5d2e 0d0a 2020 2020 2020 2020 0d0a  ,1]...        ..
-0000ff50: 2020 2020 2020 2020 7769 6474 6820 3a20          width : 
-0000ff60: 6e75 6d62 6572 2c20 6f70 7469 6f6e 616c  number, optional
-0000ff70: 2c20 6465 6661 756c 743a 2031 0d0a 2020  , default: 1..  
-0000ff80: 2020 2020 2020 2020 2020 4c69 6e65 2077            Line w
-0000ff90: 6964 7468 206f 6620 7468 6520 7665 6374  idth of the vect
-0000ffa0: 6f72 2e0d 0a0d 0a20 2020 2020 2020 2061  or.....        a
-0000ffb0: 6c72 203a 2073 6361 6c61 722c 206f 7074  lr : scalar, opt
-0000ffc0: 696f 6e61 6c2c 2064 6566 6175 6c74 3a20  ional, default: 
-0000ffd0: 302e 3235 0d0a 2020 2020 2020 2020 2020  0.25..          
-0000ffe0: 2020 4178 6973 206c 656e 6774 6820 7261    Axis length ra
-0000fff0: 7469 6f2c 2068 6561 6420 7369 7a65 2074  tio, head size t
-00010000: 6f20 7665 6374 6f72 206d 6167 6e69 7475  o vector magnitu
-00010010: 6465 2e0d 0a0d 0a20 2020 2020 2020 2052  de.....        R
-00010020: 6574 7572 6e73 0d0a 2020 2020 2020 2020  eturns..        
-00010030: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-00010040: 2056 6563 746f 7233 4443 6f6c 6c65 6374   Vector3DCollect
-00010050: 696f 6e20 6f62 6a65 6374 0d0a 0d0a 2020  ion object....  
-00010060: 2020 2020 2020 2222 220d 0a0d 0a20 2020        """....   
-00010070: 2020 2020 206b 6172 6744 6674 203d 207b       kargDft = {
-00010080: 2027 7363 616c 6527 3a31 2c20 2763 6f6c   'scale':1, 'col
-00010090: 6f72 273a 2762 6c61 636b 272c 2027 7769  or':'black', 'wi
-000100a0: 6474 6827 3a31 2c20 2761 6c72 273a 5f44  dth':1, 'alr':_D
-000100b0: 4654 5f41 4c52 2020 7d0d 0a20 2020 2020  FT_ALR  }..     
-000100c0: 2020 204b 5720 3d20 4b57 7072 6f63 6573     KW = KWproces
-000100d0: 736f 7228 6b61 7267 4466 742c 2776 6563  sor(kargDft,'vec
-000100e0: 746f 7266 6965 6c64 5f66 726f 6d5f 6f70  torfield_from_op
-000100f0: 272c 2a2a 6b61 7267 7329 0d0a 2020 2020  ',**kargs)..    
-00010100: 2020 2020 7363 616c 6520 3d20 4b57 2e67      scale = KW.g
-00010110: 6574 5661 6c28 2773 6361 6c65 2729 0d0a  etVal('scale')..
-00010120: 2020 2020 2020 2020 636f 6c6f 7220 3d20          color = 
-00010130: 4b57 2e67 6574 5661 6c28 2763 6f6c 6f72  KW.getVal('color
-00010140: 2729 0d0a 2020 2020 2020 2020 7769 6474  ')..        widt
-00010150: 6820 3d20 4b57 2e67 6574 5661 6c28 2777  h = KW.getVal('w
-00010160: 6964 7468 2729 0d0a 2020 2020 2020 2020  idth')..        
-00010170: 616c 7220 3d20 4b57 2e67 6574 5661 6c28  alr = KW.getVal(
-00010180: 2761 6c72 2729 0d0a 0d0a 2020 2020 2020  'alr')....      
-00010190: 2020 6966 2073 656c 662e 5f69 7343 6f6d    if self._isCom
-000101a0: 706f 7369 7465 5375 7266 6163 6520 3a0d  positeSurface :.
-000101b0: 0a20 2020 2020 2020 2020 2020 2077 6172  .            war
-000101c0: 6e69 6e67 732e 7761 726e 2827 5665 6374  nings.warn('Vect
-000101d0: 6f72 206f 7065 7261 7469 6f6e 206e 6f74  or operation not
-000101e0: 2061 7661 696c 6162 6c65 2066 6f72 2063   available for c
-000101f0: 6f6d 6269 6e65 6420 7368 6170 6573 2e27  ombined shapes.'
-00010200: 290d 0a20 2020 2020 2020 2020 2020 2072  )..            r
-00010210: 6574 7572 6e0d 0a0d 0a20 2020 2020 2020  eturn....       
-00010220: 2078 797a 203d 206e 702e 7472 616e 7370   xyz = np.transp
-00010230: 6f73 6528 7365 6c66 2e76 6572 7465 7843  ose(self.vertexC
-00010240: 6f6f 7229 0d0a 2020 2020 2020 2020 6162  oor)..        ab
-00010250: 6320 3d20 7365 6c66 2e63 6f6f 725f 636f  c = self.coor_co
-00010260: 6e76 6572 7428 7879 7a29 0d0a 2020 2020  nvert(xyz)..    
-00010270: 2020 2020 6162 6320 3d20 6e70 2e61 7272      abc = np.arr
-00010280: 6179 2861 6263 290d 0a20 2020 2020 2020  ay(abc)..       
-00010290: 2072 7374 203d 206e 702e 6172 7261 7928   rst = np.array(
-000102a0: 6f70 6572 6174 696f 6e28 6162 6329 290d  operation(abc)).
-000102b0: 0a20 2020 2020 2020 2072 7374 203d 2073  .        rst = s
-000102c0: 6361 6c65 2a72 7374 0d0a 2020 2020 2020  cale*rst..      
-000102d0: 2020 6465 6c74 6120 3d20 7365 6c66 2e5f    delta = self._
-000102e0: 7576 775f 746f 5f78 797a 2872 7374 2c61  uvw_to_xyz(rst,a
-000102f0: 6263 290d 0a20 2020 2020 2020 2023 202d  bc)..        # -
-00010300: 2d2d 2031 2e31 206d 6f64 202d 2d2d 2d2d  -- 1.1 mod -----
-00010310: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d  ---------------.
-00010320: 0a20 2020 2020 2020 2064 656c 7461 203d  .        delta =
-00010330: 206e 702e 6172 7261 7928 6465 6c74 6129   np.array(delta)
-00010340: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00010350: 2073 656c 662e 5f67 6574 5f76 6563 746f   self._get_vecto
-00010360: 7266 6965 6c64 5f4c 696e 6533 4443 6f6c  rfield_Line3DCol
-00010370: 6c65 6374 696f 6e28 6465 6c74 612c 2063  lection(delta, c
-00010380: 6f6c 6f72 2c20 7769 6474 682c 2061 6c72  olor, width, alr
-00010390: 290d 0a0d 0a20 2020 2064 6566 2076 6563  )....    def vec
-000103a0: 746f 7266 6965 6c64 5f74 6f5f 7375 7266  torfield_to_surf
-000103b0: 6163 6528 7365 6c66 2c20 7375 7266 6163  ace(self, surfac
-000103c0: 652c 202a 2a6b 6172 6773 2920 3a0d 0a20  e, **kargs) :.. 
-000103d0: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
-000103e0: 2020 2020 5665 6374 6f72 3344 436f 6c6c      Vector3DColl
-000103f0: 6563 7469 6f6e 206f 6620 7665 6374 6f72  ection of vector
-00010400: 7320 6672 6f6d 2073 7572 6661 6365 2074  s from surface t
-00010410: 6f20 7375 7266 6163 6520 7665 7274 6578  o surface vertex
-00010420: 2063 6f6f 7264 696e 6174 6573 2e0d 0a0d   coordinates....
-00010430: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-00010440: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
-00010450: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-00010460: 2073 7572 6661 6365 203a 2073 7572 6661   surface : surfa
-00010470: 6365 206f 626a 6563 740d 0a20 2020 2020  ce object..     
-00010480: 2020 2020 2020 2053 7572 6661 6365 2074         Surface t
-00010490: 6861 7420 6d61 7463 6865 7320 7468 6520  hat matches the 
-000104a0: 6361 6c6c 696e 6720 7375 7266 6163 6520  calling surface 
-000104b0: 7665 6374 6f72 732e 0d0a 2020 2020 2020  vectors...      
-000104c0: 2020 2020 2020 5368 6f75 6c64 2062 6520        Should be 
-000104d0: 7468 6520 7361 6d65 2062 6173 6574 7970  the same basetyp
-000104e0: 6520 616e 6420 7265 7a20 666f 7220 7375  e and rez for su
-000104f0: 7266 6163 6520 7375 6263 6c61 7373 6573  rface subclasses
-00010500: 2e0d 0a0d 0a20 2020 2020 2020 2073 6361  .....        sca
-00010510: 6c65 3a20 6e75 6d62 6572 2c20 6f70 7469  le: number, opti
-00010520: 6f6e 616c 2c20 6465 6661 756c 743a 2031  onal, default: 1
-00010530: 2e0d 0a0d 0a20 2020 2020 2020 2063 6f6c  .....        col
-00010540: 6f72 203a 2073 7472 206f 7220 666c 6f61  or : str or floa
-00010550: 7420 6c69 7374 206f 6620 6c65 6e67 7468  t list of length
-00010560: 2033 206f 7220 342e 0d0a 2020 2020 2020   3 or 4...      
-00010570: 2020 2020 2020 5247 4220 6f72 2052 4742        RGB or RGB
-00010580: 4120 636f 6c6f 722c 2065 6974 6865 7220  A color, either 
-00010590: 6120 4d61 7470 6c6f 746c 6962 2066 6f72  a Matplotlib for
-000105a0: 6d61 7420 7374 7269 6e67 206f 7220 6120  mat string or a 
-000105b0: 0d0a 2020 2020 2020 2020 2020 2020 6c69  ..            li
-000105c0: 7374 206f 6620 636f 6c6f 7220 7661 6c75  st of color valu
-000105d0: 6573 2069 6e20 7261 6e67 6520 5b30 2c31  es in range [0,1
-000105e0: 5d2e 0d0a 2020 2020 2020 2020 0d0a 2020  ]...        ..  
-000105f0: 2020 2020 2020 7769 6474 6820 3a20 6e75        width : nu
-00010600: 6d62 6572 2c20 6f70 7469 6f6e 616c 2c20  mber, optional, 
-00010610: 6465 6661 756c 743a 2031 0d0a 2020 2020  default: 1..    
-00010620: 2020 2020 2020 2020 4c69 6e65 2077 6964          Line wid
-00010630: 7468 206f 6620 7468 6520 7665 6374 6f72  th of the vector
-00010640: 2e0d 0a0d 0a20 2020 2020 2020 2061 6c72  .....        alr
-00010650: 203a 2073 6361 6c61 722c 206f 7074 696f   : scalar, optio
-00010660: 6e61 6c2c 2064 6566 6175 6c74 3a20 302e  nal, default: 0.
-00010670: 3235 0d0a 2020 2020 2020 2020 2020 2020  25..            
-00010680: 4178 6973 206c 656e 6774 6820 7261 7469  Axis length rati
-00010690: 6f2c 2068 6561 6420 7369 7a65 2074 6f20  o, head size to 
-000106a0: 7665 6374 6f72 206d 6167 6e69 7475 6465  vector magnitude
-000106b0: 2e0d 0a0d 0a20 2020 2020 2020 2052 6169  .....        Rai
-000106c0: 7365 730d 0a20 2020 2020 2020 202d 2d2d  ses..        ---
-000106d0: 2d2d 2d0d 0a20 2020 2020 2020 2056 616c  ---..        Val
-000106e0: 7565 4572 726f 720d 0a20 2020 2020 2020  ueError..       
-000106f0: 2020 2020 204d 6973 6d61 7463 6865 6420       Mismatched 
-00010700: 7375 7266 6163 6573 2062 6173 6564 206f  surfaces based o
-00010710: 6e20 7468 6520 6e75 6d62 6572 206f 6620  n the number of 
-00010720: 7665 7274 6963 6573 2e0d 0a0d 0a20 2020  vertices.....   
-00010730: 2020 2020 2052 6574 7572 6e73 0d0a 2020       Returns..  
-00010740: 2020 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20        -------.. 
-00010750: 2020 2020 2020 2056 6563 746f 7233 4443         Vector3DC
-00010760: 6f6c 6c65 6374 696f 6e20 6f62 6a65 6374  ollection object
-00010770: 0d0a 0d0a 2020 2020 2020 2020 2222 220d  ....        """.
-00010780: 0a0d 0a20 2020 2020 2020 206b 6172 6744  ...        kargD
-00010790: 6674 203d 207b 2027 7363 616c 6527 3a31  ft = { 'scale':1
-000107a0: 2c20 2763 6f6c 6f72 273a 2762 6c61 636b  , 'color':'black
-000107b0: 272c 2027 7769 6474 6827 3a31 2c20 2761  ', 'width':1, 'a
-000107c0: 6c72 273a 5f44 4654 5f41 4c52 2020 7d0d  lr':_DFT_ALR  }.
-000107d0: 0a20 2020 2020 2020 204b 5720 3d20 4b57  .        KW = KW
-000107e0: 7072 6f63 6573 736f 7228 6b61 7267 4466  processor(kargDf
-000107f0: 742c 2776 6563 746f 7266 6965 6c64 5f74  t,'vectorfield_t
-00010800: 6f5f 7375 7266 6163 6527 2c2a 2a6b 6172  o_surface',**kar
-00010810: 6773 290d 0a20 2020 2020 2020 2073 6361  gs)..        sca
-00010820: 6c65 203d 204b 572e 6765 7456 616c 2827  le = KW.getVal('
-00010830: 7363 616c 6527 290d 0a20 2020 2020 2020  scale')..       
-00010840: 2063 6f6c 6f72 203d 204b 572e 6765 7456   color = KW.getV
-00010850: 616c 2827 636f 6c6f 7227 290d 0a20 2020  al('color')..   
-00010860: 2020 2020 2077 6964 7468 203d 204b 572e       width = KW.
-00010870: 6765 7456 616c 2827 7769 6474 6827 290d  getVal('width').
-00010880: 0a20 2020 2020 2020 2061 6c72 203d 204b  .        alr = K
-00010890: 572e 6765 7456 616c 2827 616c 7227 290d  W.getVal('alr').
-000108a0: 0a0d 0a20 2020 2020 2020 2073 7572 4c65  ...        surLe
-000108b0: 6e2c 2073 656c 664c 656e 203d 206c 656e  n, selfLen = len
-000108c0: 2873 7572 6661 6365 2e76 6572 7465 7843  (surface.vertexC
-000108d0: 6f6f 7229 202c 206c 656e 2873 656c 662e  oor) , len(self.
-000108e0: 7665 7274 6578 436f 6f72 290d 0a20 2020  vertexCoor)..   
-000108f0: 2020 2020 2023 6966 2073 7572 4c65 6e20       #if surLen 
-00010900: 6973 206e 6f74 2073 656c 664c 656e 203a  is not selfLen :
-00010910: 2020 2320 312e 3120 6572 722e 2063 6f72    # 1.1 err. cor
-00010920: 7265 6374 6564 0d0a 2020 2020 2020 2020  rected..        
-00010930: 6966 2073 7572 4c65 6e20 213d 2073 656c  if surLen != sel
-00010940: 664c 656e 203a 0d0a 2020 2020 2020 2020  fLen :..        
-00010950: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-00010960: 7272 6f72 2827 5375 7266 6163 6573 2068  rror('Surfaces h
-00010970: 6176 6520 756e 6571 7561 6c20 6e75 6d62  ave unequal numb
-00010980: 6572 206f 6620 7665 7274 6963 6573 2c20  er of vertices, 
-00010990: 7b7d 2021 3d20 7b7d 272e 666f 726d 6174  {} != {}'.format
-000109a0: 2873 7572 4c65 6e2c 2073 656c 664c 656e  (surLen, selfLen
-000109b0: 2929 2020 2020 2020 2020 2020 2020 0d0a  ))            ..
-000109c0: 2020 2020 2020 2020 6465 6c74 6120 3d20          delta = 
-000109d0: 2073 7572 6661 6365 2e76 6572 7465 7843   surface.vertexC
-000109e0: 6f6f 7220 2d20 7365 6c66 2e76 6572 7465  oor - self.verte
-000109f0: 7843 6f6f 720d 0a20 2020 2020 2020 2064  xCoor..        d
-00010a00: 656c 7461 203d 2073 6361 6c65 2a64 656c  elta = scale*del
-00010a10: 7461 0d0a 2020 2020 2020 2020 2320 2d2d  ta..        # --
-00010a20: 2d20 312e 3120 6d6f 6420 2d2d 2d2d 2d2d  - 1.1 mod ------
-00010a30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a  --------------..
-00010a40: 2020 2020 2020 2020 7646 6965 6c64 203d          vField =
-00010a50: 2073 656c 662e 5f67 6574 5f76 6563 746f   self._get_vecto
-00010a60: 7266 6965 6c64 5f4c 696e 6533 4443 6f6c  rfield_Line3DCol
-00010a70: 6c65 6374 696f 6e28 6465 6c74 612c 2063  lection(delta, c
-00010a80: 6f6c 6f72 2c20 7769 6474 682c 2061 6c72  olor, width, alr
-00010a90: 290d 0a20 2020 2020 2020 2076 4669 656c  )..        vFiel
-00010aa0: 642e 7576 774f 7269 656e 7461 7469 6f6e  d.uvwOrientation
-00010ab0: 5479 7065 203d 205f 434f 4f52 5359 535b  Type = _COORSYS[
-00010ac0: 2258 595a 225d 0d0a 2020 2020 2020 2020  "XYZ"]..        
-00010ad0: 7265 7475 726e 2076 4669 656c 640d 0a0d  return vField...
-00010ae0: 0a20 2020 2064 6566 205f 6d61 705f 636f  .    def _map_co
-00010af0: 6c6f 725f 6672 6f6d 5f69 6d61 6765 5f76  lor_from_image_v
-00010b00: 6572 7428 7365 6c66 2c20 696d 672c 2076  ert(self, img, v
-00010b10: 6965 7770 6f72 7420 2920 3a0d 0a0d 0a20  iewport ) :.... 
-00010b20: 2020 2020 2020 2061 2c62 2c69 6e56 6965         a,b,inVie
-00010b30: 7770 6f72 7420 3d20 7365 6c66 2e5f 7669  wport = self._vi
-00010b40: 6577 706f 7274 436f 6f72 2873 656c 662e  ewportCoor(self.
-00010b50: 7665 7274 6578 436f 6f72 2c76 6965 7770  vertexCoor,viewp
-00010b60: 6f72 7429 0d0a 2020 2020 2020 2020 0d0a  ort)..        ..
-00010b70: 2020 2020 2020 2020 6865 6967 6874 2c20          height, 
-00010b80: 7769 6474 6820 3d20 6e70 2e73 7562 7472  width = np.subtr
-00010b90: 6163 7428 696d 672e 7368 6170 655b 3a32  act(img.shape[:2
-00010ba0: 5d2c 3129 0d0a 2020 2020 2020 2020 4d5f  ],1)..        M_
-00010bb0: 696e 6465 7820 3d20 2820 2831 2d62 292a  index = ( (1-b)*
-00010bc0: 6865 6967 6874 2029 2e61 7374 7970 6528  height ).astype(
-00010bd0: 696e 7429 0d0a 2020 2020 2020 2020 4e5f  int)..        N_
-00010be0: 696e 6465 7820 3d20 2820 612a 7769 6474  index = ( a*widt
-00010bf0: 6820 292e 6173 7479 7065 2869 6e74 290d  h ).astype(int).
-00010c00: 0a20 2020 2020 2020 2023 2727 270d 0a0d  .        #'''...
-00010c10: 0a20 2020 2020 2020 206f 7269 675f 636f  .        orig_co
-00010c20: 6c6f 7273 203d 2073 656c 662e 7665 7274  lors = self.vert
-00010c30: 6578 436f 6c6f 720d 0a0d 0a20 2020 2020  exColor....     
-00010c40: 2020 2069 6620 6c65 6e28 6f72 6967 5f63     if len(orig_c
-00010c50: 6f6c 6f72 7329 203d 3d20 3120 3a0d 0a20  olors) == 1 :.. 
-00010c60: 2020 2020 2020 2020 2020 206f 6e65 6172             onear
-00010c70: 7220 3d20 6e70 2e6f 6e65 7328 206c 656e  r = np.ones( len
-00010c80: 2873 656c 662e 7665 7274 6578 436f 6f72  (self.vertexCoor
-00010c90: 2920 295b 3a2c 206e 702e 6e65 7761 7869  ) )[:, np.newaxi
-00010ca0: 735d 0d0a 2020 2020 2020 2020 2020 2020  s]..            
-00010cb0: 6f72 6967 5f63 6f6c 6f72 7320 3d20 6f72  orig_colors = or
-00010cc0: 6967 5f63 6f6c 6f72 732a 6f6e 6561 7272  ig_colors*onearr
-00010cd0: 2020 2020 2020 200d 0a0d 0a20 2020 2020         ....     
-00010ce0: 2020 2063 6f6c 6f72 4d61 7020 3d20 5b5d     colorMap = []
-00010cf0: 0d0a 2020 2020 2020 2020 6f6e 6541 6c70  ..        oneAlp
-00010d00: 203d 206e 702e 6172 7261 7928 5b31 2e30   = np.array([1.0
-00010d10: 5d29 0d0a 2020 2020 2020 2020 6966 2076  ])..        if v
-00010d20: 6965 7770 6f72 7420 6973 204e 6f6e 6520  iewport is None 
-00010d30: 3a20 636f 6c6f 724d 6170 203d 2069 6d67  : colorMap = img
-00010d40: 5b4d 5f69 6e64 6578 2c4e 5f69 6e64 6578  [M_index,N_index
-00010d50: 5d0d 0a20 2020 2020 2020 2065 6c73 6520  ]..        else 
-00010d60: 3a0d 0a20 2020 2020 2020 2020 2020 2023  :..            #
-00010d70: 2046 7574 4465 763a 2075 7365 206e 756d   FutDev: use num
-00010d80: 7079 206d 6574 686f 6473 2074 6f20 6f70  py methods to op
-00010d90: 7469 6d69 7a65 2065 6666 6963 6965 6e63  timize efficienc
-00010da0: 793f 0d0a 2020 2020 2020 2020 2020 2020  y?..            
-00010db0: 666f 7220 6920 696e 2072 616e 6765 2820  for i in range( 
-00010dc0: 6c65 6e28 6f72 6967 5f63 6f6c 6f72 7329  len(orig_colors)
-00010dd0: 2029 203a 0d0a 2020 2020 2020 2020 2020   ) :..          
-00010de0: 2020 2020 2020 636f 6c6f 724d 6170 2e61        colorMap.a
-00010df0: 7070 656e 6428 6f72 6967 5f63 6f6c 6f72  ppend(orig_color
-00010e00: 735b 695d 290d 0a20 2020 2020 2020 2020  s[i])..         
-00010e10: 2020 2020 2020 2069 6620 696e 5669 6577         if inView
-00010e20: 706f 7274 5b69 5d20 3a0d 0a20 2020 2020  port[i] :..     
-00010e30: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-00010e40: 656d 7020 3d20 2069 6d67 5b4d 5f69 6e64  emp =  img[M_ind
-00010e50: 6578 5b69 5d2c 4e5f 696e 6465 785b 695d  ex[i],N_index[i]
-00010e60: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
-00010e70: 2020 2020 2020 2023 2e2e 206e 6f74 653a         #.. note:
-00010e80: 2069 6d67 206d 6179 206f 7220 6d61 7920   img may or may 
-00010e90: 6e6f 7420 6861 7665 2061 6e20 616c 7068  not have an alph
-00010ea0: 6120 6368 616e 6e65 6c2e 2e0d 0a20 2020  a channel....   
-00010eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010ec0: 2074 656d 7032 203d 2074 656d 705b 303a   temp2 = temp[0:
-00010ed0: 335d 0d0a 2020 2020 2020 2020 2020 2020  3]..            
-00010ee0: 2020 2020 2020 2020 636f 6c6f 724d 6170          colorMap
-00010ef0: 5b69 5d20 3d20 6e70 2e63 6f6e 6361 7465  [i] = np.concate
-00010f00: 6e61 7465 2828 7465 6d70 322c 6f6e 6541  nate((temp2,oneA
-00010f10: 6c70 2929 2020 200d 0a0d 0a20 2020 2020  lp))   ....     
-00010f20: 2020 2073 656c 662e 7665 7274 6578 436f     self.vertexCo
-00010f30: 6c6f 7220 3d20 6e70 2e61 7272 6179 2863  lor = np.array(c
-00010f40: 6f6c 6f72 4d61 7029 0d0a 2020 2020 2020  olorMap)..      
-00010f50: 2020 7265 7475 726e 0d0a 0d0a 2020 2020    return....    
-00010f60: 6465 6620 6d61 705f 636f 6c6f 725f 6672  def map_color_fr
-00010f70: 6f6d 5f69 6d61 6765 2873 656c 662c 2066  om_image(self, f
-00010f80: 6e61 6d65 2c20 7669 6577 706f 7274 3d4e  name, viewport=N
-00010f90: 6f6e 6529 203a 0d0a 2020 2020 2020 2020  one) :..        
-00010fa0: 2222 220d 0a20 2020 2020 2020 2041 7373  """..        Ass
-00010fb0: 6967 6e20 696d 6167 6520 636f 6c6f 7220  ign image color 
-00010fc0: 7661 6c75 6573 2074 6f20 7375 7266 6163  values to surfac
-00010fd0: 6520 6661 6365 2063 6f6c 6f72 732e 0d0a  e face colors...
-00010fe0: 0d0a 2020 2020 2020 2020 5468 6973 206d  ..        This m
-00010ff0: 6574 686f 6420 6973 206e 6f74 2061 7661  ethod is not ava
-00011000: 696c 6162 6c65 2066 6f72 2063 6f6d 706f  ilable for compo
-00011010: 7369 7465 2073 7572 6661 6365 732e 0d0a  site surfaces...
-00011020: 2020 2020 2020 2020 5468 6520 656e 7469          The enti
-00011030: 7265 2069 6d61 6765 2064 6f6d 6169 6e20  re image domain 
-00011040: 6973 2061 7070 6c69 6564 2074 6f20 7468  is applied to th
-00011050: 6520 636f 6c6f 7269 6e67 206f 7065 7261  e coloring opera
-00011060: 7469 6f6e 2e0d 0a0d 0a20 2020 2020 2020  tion.....       
-00011070: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
-00011080: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
-00011090: 0a20 2020 2020 2020 2066 6e61 6d65 203a  .        fname :
-000110a0: 2073 7472 206f 7220 6669 6c65 2d6c 696b   str or file-lik
-000110b0: 650d 0a20 2020 2020 2020 2020 2020 2054  e..            T
-000110c0: 6865 2069 6d61 6765 2066 696c 6520 746f  he image file to
-000110d0: 2072 6561 643a 2061 2066 696c 656e 616d   read: a filenam
-000110e0: 652c 2061 2055 524c 206f 7220 6120 6669  e, a URL or a fi
-000110f0: 6c65 2d6c 696b 6520 6f62 6a65 6374 206f  le-like object o
-00011100: 7065 6e65 640d 0a20 2020 2020 2020 2020  pened..         
-00011110: 2020 2069 6e20 7265 6164 2d62 696e 6172     in read-binar
-00011120: 7920 6d6f 6465 2e20 2043 7572 7265 6e74  y mode.  Current
-00011130: 6c79 2072 6573 7472 6963 7465 6420 746f  ly restricted to
-00011140: 2050 4e47 2066 6f72 6d61 742e 0d0a 2020   PNG format...  
-00011150: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-00011160: 7669 6577 706f 7274 203a 2034 4420 6172  viewport : 4D ar
-00011170: 7261 792d 6c69 6b65 2c20 6f70 7469 6f6e  ray-like, option
-00011180: 616c 2c20 6465 6661 756c 743a 204e 6f6e  al, default: Non
-00011190: 650d 0a20 2020 2020 2020 2020 2020 2056  e..            V
-000111a0: 6965 7770 6f72 7420 6465 6669 6e65 7320  iewport defines 
-000111b0: 7468 6520 7375 6264 6f6d 6169 6e20 6f66  the subdomain of
-000111c0: 2074 6865 2073 7572 6661 6365 206f 6e74   the surface ont
-000111d0: 6f20 7768 6963 680d 0a20 2020 2020 2020  o which..       
-000111e0: 2020 2020 2074 6865 2069 6d61 6765 2069       the image i
-000111f0: 7320 6d61 7070 6564 2e20 2054 6865 2073  s mapped.  The s
-00011200: 7562 646f 6d61 696e 2069 7320 7365 7420  ubdomain is set 
-00011210: 6279 206e 6f72 6d61 6c69 7a65 640d 0a20  by normalized.. 
-00011220: 2020 2020 2020 2020 2020 206e 6174 6976             nativ
-00011230: 6520 7375 7266 6163 6520 636f 6f72 6469  e surface coordi
-00011240: 6e61 7465 7320 696e 2061 2034 4420 6172  nates in a 4D ar
-00011250: 7261 792e 0d0a 2020 2020 2020 2020 2020  ray...          
-00011260: 2020 5468 6520 656e 7469 7265 2073 7572    The entire sur
-00011270: 6661 6365 2069 7320 636f 6c6f 7265 6420  face is colored 
-00011280: 666f 7220 7468 6520 6465 6661 756c 7420  for the default 
-00011290: 6f66 204e 6f6e 652e 0d0a 0d0a 2020 2020  of None.....    
-000112a0: 2020 2020 5265 7475 726e 730d 0a20 2020      Returns..   
-000112b0: 2020 2020 202d 2d2d 2d2d 2d2d 0d0a 2020       -------..  
-000112c0: 2020 2020 2020 7365 6c66 203a 2073 7572        self : sur
-000112d0: 6661 6365 206f 626a 6563 740d 0a0d 0a20  face object.... 
-000112e0: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
-000112f0: 2020 2020 0d0a 2020 2020 2020 2020 6966      ..        if
-00011300: 2073 656c 662e 5f69 7343 6f6d 706f 7369   self._isComposi
-00011310: 7465 5375 7266 6163 6520 3a0d 0a20 2020  teSurface :..   
-00011320: 2020 2020 2020 2020 2077 6172 6e69 6e67           warning
-00011330: 732e 7761 726e 2827 496d 6167 6520 6f70  s.warn('Image op
-00011340: 6572 6174 696f 6e20 6e6f 7420 6176 6169  eration not avai
-00011350: 6c61 626c 6520 666f 7220 636f 6d62 696e  lable for combin
-00011360: 6564 2073 6861 7065 732e 2729 0d0a 2020  ed shapes.')..  
-00011370: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00011380: 2073 656c 660d 0a20 2020 2020 2020 2069   self..        i
-00011390: 6620 7365 6c66 2e5f 7375 7266 6163 6553  f self._surfaceS
-000113a0: 6861 7065 4368 616e 6765 6420 3a0d 0a20  hapeChanged :.. 
-000113b0: 2020 2020 2020 2020 2020 2077 6172 6e69             warni
-000113c0: 6e67 732e 7761 726e 2827 496d 6167 6520  ngs.warn('Image 
-000113d0: 6f70 6572 6174 696f 6e20 6d61 7920 6265  operation may be
-000113e0: 2061 6e6f 6d61 6c6f 7573 2061 6674 6572   anomalous after
-000113f0: 2073 6861 7065 206d 6f64 6966 6963 6174   shape modificat
-00011400: 696f 6e2e 2729 0d0a 0d0a 2020 2020 2020  ion.')....      
-00011410: 2020 6966 2076 6965 7770 6f72 7420 6973    if viewport is
-00011420: 206e 6f74 204e 6f6e 6520 3a0d 0a20 2020   not None :..   
-00011430: 2020 2020 2020 2020 2076 6965 7770 6f72           viewpor
-00011440: 7420 3d20 6e70 2e61 7272 6179 2876 6965  t = np.array(vie
-00011450: 7770 6f72 7429 0d0a 2020 2020 2020 2020  wport)..        
-00011460: 2020 2020 6966 206e 702e 616e 7928 2028      if np.any( (
-00011470: 7669 6577 706f 7274 3c30 2920 7c20 2876  viewport<0) | (v
-00011480: 6965 7770 6f72 743e 3129 2029 203a 0d0a  iewport>1) ) :..
-00011490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000114a0: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-000114b0: 2827 7669 6577 706f 7274 206c 6973 7420  ('viewport list 
-000114c0: 7661 6c75 6573 2c20 7b7d 2c20 6d75 7374  values, {}, must
-000114d0: 2062 6520 6265 7477 6565 6e20 3020 616e   be between 0 an
-000114e0: 6420 3127 2e66 6f72 6d61 7428 7669 6577  d 1'.format(view
-000114f0: 706f 7274 2929 0d0a 2020 2020 2020 2020  port))..        
-00011500: 2020 2020 6966 206c 656e 2876 6965 7770      if len(viewp
-00011510: 6f72 7429 2021 3d20 3420 3a0d 0a20 2020  ort) != 4 :..   
-00011520: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-00011530: 7365 2056 616c 7565 4572 726f 7228 2776  se ValueError('v
-00011540: 6965 7770 6f72 7420 6c69 7374 206d 7573  iewport list mus
-00011550: 7420 6265 206c 656e 6774 6820 342c 2066  t be length 4, f
-00011560: 6f75 6e64 207b 7d27 2e66 6f72 6d61 7428  ound {}'.format(
-00011570: 6c65 6e28 7669 6577 706f 7274 2929 2920  len(viewport))) 
-00011580: 2020 2020 200d 0a20 2020 2020 2020 2076       ..        v
-00011590: 6572 7473 203d 2073 656c 662e 7665 7274  erts = self.vert
-000115a0: 6578 436f 6f72 5b20 7365 6c66 2e66 7649  exCoor[ self.fvI
-000115b0: 6e64 6963 6573 205d 0d0a 2020 2020 2020  ndices ]..      
-000115c0: 2020 0d0a 2020 2020 2020 2020 6661 6365    ..        face
-000115d0: 4365 6e74 6572 436f 6f72 203d 2073 656c  CenterCoor = sel
-000115e0: 662e 5f67 6574 5f66 6163 655f 6365 6e74  f._get_face_cent
-000115f0: 6572 7328 7665 7274 7329 0d0a 2020 2020  ers(verts)..    
-00011600: 2020 2020 612c 622c 696e 5669 6577 706f      a,b,inViewpo
-00011610: 7274 203d 2073 656c 662e 5f76 6965 7770  rt = self._viewp
-00011620: 6f72 7443 6f6f 7228 6661 6365 4365 6e74  ortCoor(faceCent
-00011630: 6572 436f 6f72 2c76 6965 7770 6f72 7429  erCoor,viewport)
-00011640: 0d0a 2020 2020 2020 2020 696d 6720 3d20  ..        img = 
-00011650: 696d 6167 652e 696d 7265 6164 2866 6e61  image.imread(fna
-00011660: 6d65 290d 0a20 2020 2020 2020 200d 0a20  me)..        .. 
-00011670: 2020 2020 2020 2068 6569 6768 742c 2077         height, w
-00011680: 6964 7468 203d 206e 702e 7375 6274 7261  idth = np.subtra
-00011690: 6374 2869 6d67 2e73 6861 7065 5b3a 325d  ct(img.shape[:2]
-000116a0: 2c31 290d 0a20 2020 2020 2020 204d 5f69  ,1)..        M_i
-000116b0: 6e64 6578 203d 2028 2028 312d 6229 2a68  ndex = ( (1-b)*h
-000116c0: 6569 6768 7420 292e 6173 7479 7065 2869  eight ).astype(i
-000116d0: 6e74 290d 0a20 2020 2020 2020 204e 5f69  nt)..        N_i
-000116e0: 6e64 6578 203d 2028 2061 2a77 6964 7468  ndex = ( a*width
-000116f0: 2029 2e61 7374 7970 6528 696e 7429 0d0a   ).astype(int)..
-00011700: 2020 2020 2020 2020 2327 2727 0d0a 2020          #'''..  
-00011710: 2020 2020 2020 6f72 6967 5f63 6f6c 6f72        orig_color
-00011720: 7320 3d20 7365 6c66 2e5f 6661 6365 636f  s = self._faceco
-00011730: 6c6f 7273 0d0a 0d0a 2020 2020 2020 2020  lors....        
-00011740: 6966 206c 656e 286f 7269 675f 636f 6c6f  if len(orig_colo
-00011750: 7273 2920 3d3d 2031 203a 0d0a 2020 2020  rs) == 1 :..    
-00011760: 2020 2020 2020 2020 6f6e 6561 7272 203d          onearr =
-00011770: 206e 702e 6f6e 6573 2820 6c65 6e28 6661   np.ones( len(fa
-00011780: 6365 4365 6e74 6572 436f 6f72 2920 295b  ceCenterCoor) )[
-00011790: 3a2c 206e 702e 6e65 7761 7869 735d 0d0a  :, np.newaxis]..
-000117a0: 2020 2020 2020 2020 2020 2020 6f72 6967              orig
-000117b0: 5f63 6f6c 6f72 7320 3d20 6f72 6967 5f63  _colors = orig_c
-000117c0: 6f6c 6f72 732a 6f6e 6561 7272 2020 2020  olors*onearr    
-000117d0: 2020 200d 0a0d 0a20 2020 2020 2020 2063     ....        c
-000117e0: 6f6c 6f72 4d61 7020 3d20 5b5d 0d0a 2020  olorMap = []..  
-000117f0: 2020 2020 2020 6966 2076 6965 7770 6f72        if viewpor
-00011800: 7420 6973 204e 6f6e 6520 3a20 636f 6c6f  t is None : colo
-00011810: 724d 6170 203d 2069 6d67 5b4d 5f69 6e64  rMap = img[M_ind
-00011820: 6578 2c4e 5f69 6e64 6578 5d0d 0a20 2020  ex,N_index]..   
-00011830: 2020 2020 2065 6c73 6520 3a0d 0a20 2020       else :..   
-00011840: 2020 2020 2020 2020 2023 2046 7574 4465           # FutDe
-00011850: 763a 2075 7365 206e 756d 7079 206d 6574  v: use numpy met
-00011860: 686f 6473 2074 6f20 6f70 7469 6d69 7a65  hods to optimize
-00011870: 2065 6666 6963 6965 6e63 793f 0d0a 2020   efficiency?..  
-00011880: 2020 2020 2020 2020 2020 666f 7220 6920            for i 
-00011890: 696e 2072 616e 6765 2820 6c65 6e28 6f72  in range( len(or
-000118a0: 6967 5f63 6f6c 6f72 7329 2029 203a 0d0a  ig_colors) ) :..
-000118b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000118c0: 636f 6c6f 724d 6170 2e61 7070 656e 6428  colorMap.append(
-000118d0: 6f72 6967 5f63 6f6c 6f72 735b 695d 290d  orig_colors[i]).
-000118e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000118f0: 2069 6620 696e 5669 6577 706f 7274 5b69   if inViewport[i
-00011900: 5d20 3a20 636f 6c6f 724d 6170 5b69 5d20  ] : colorMap[i] 
-00011910: 3d20 696d 675b 4d5f 696e 6465 785b 695d  = img[M_index[i]
-00011920: 2c4e 5f69 6e64 6578 5b69 5d5d 2020 2020  ,N_index[i]]    
-00011930: 0d0a 2020 2020 2020 2020 7365 6c66 2e73  ..        self.s
-00011940: 6574 5f63 6f6c 6f72 2863 6f6c 6f72 4d61  et_color(colorMa
-00011950: 7029 0d0a 2020 2020 2020 2020 7365 6c66  p)..        self
-00011960: 2e69 7353 7572 6661 6365 436f 6c6f 7265  .isSurfaceColore
-00011970: 6420 3d20 5472 7565 0d0a 2020 2020 2020  d = True..      
-00011980: 2020 7365 6c66 2e76 6572 7465 7856 616c    self.vertexVal
-00011990: 7565 7320 3d20 4e6f 6e65 0d0a 2020 2020  ues = None..    
-000119a0: 2020 2020 2320 3d3d 3d3d 3d3d 3d3d 3d3d      # ==========
-000119b0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000119c0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000119d0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000119e0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a  ==============..
-000119f0: 2020 2020 2020 2020 7365 6c66 2e5f 6d61          self._ma
-00011a00: 705f 636f 6c6f 725f 6672 6f6d 5f69 6d61  p_color_from_ima
-00011a10: 6765 5f76 6572 7428 696d 672c 7669 6577  ge_vert(img,view
-00011a20: 706f 7274 2029 0d0a 2020 2020 2020 2020  port )..        
-00011a30: 2320 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  # ==============
-00011a40: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00011a50: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00011a60: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00011a70: 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a 0d0a 2020  ==========....  
-00011a80: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00011a90: 660d 0a0d 0a20 2020 2064 6566 205f 6d61  f....    def _ma
-00011aa0: 705f 636f 6c6f 725f 6672 6f6d 5f6f 705f  p_color_from_op_
-00011ab0: 7665 7274 2873 656c 662c 206f 7065 7261  vert(self, opera
-00011ac0: 7469 6f6e 2c20 7267 623d 5472 7565 2920  tion, rgb=True) 
-00011ad0: 3a0d 0a20 2020 2020 2020 2078 797a 203d  :..        xyz =
-00011ae0: 206e 702e 7472 616e 7370 6f73 6528 7365   np.transpose(se
-00011af0: 6c66 2e76 6572 7465 7843 6f6f 7229 0d0a  lf.vertexCoor)..
-00011b00: 2020 2020 2020 2020 6162 6320 3d20 7365          abc = se
-00011b10: 6c66 2e63 6f6f 725f 636f 6e76 6572 7428  lf.coor_convert(
-00011b20: 7879 7a29 0d0a 2020 2020 2020 2020 636f  xyz)..        co
-00011b30: 6c6f 7273 203d 206e 702e 6172 7261 7928  lors = np.array(
-00011b40: 6f70 6572 6174 696f 6e28 6162 6329 290d  operation(abc)).
-00011b50: 0a20 2020 2020 2020 2063 6f6c 6f72 7320  .        colors 
-00011b60: 3d20 6e70 2e74 7261 6e73 706f 7365 2863  = np.transpose(c
-00011b70: 6f6c 6f72 7329 0d0a 2020 2020 2020 2020  olors)..        
-00011b80: 636f 6c6f 7273 203d 206e 702e 636c 6970  colors = np.clip
-00011b90: 2863 6f6c 6f72 732c 302c 3129 0d0a 2020  (colors,0,1)..  
-00011ba0: 2020 2020 2020 6966 2072 6762 203a 2052        if rgb : R
-00011bb0: 4742 203d 2063 6f6c 6f72 730d 0a20 2020  GB = colors..   
-00011bc0: 2020 2020 2065 6c73 6520 3a20 2020 5247       else :   RG
-00011bd0: 4220 3d20 636d 2e63 6f6c 6f72 732e 6873  B = cm.colors.hs
-00011be0: 765f 746f 5f72 6762 2863 6f6c 6f72 7329  v_to_rgb(colors)
-00011bf0: 0d0a 0d0a 2020 2020 2020 2020 6966 2052  ....        if R
-00011c00: 4742 2e73 6861 7065 5b31 5d20 6973 2033  GB.shape[1] is 3
-00011c10: 203a 2020 2320 6164 6420 616c 7068 6120   :  # add alpha 
-00011c20: 6368 616e 6e65 6c2e 0d0a 2020 2020 2020  channel...      
-00011c30: 2020 2020 2020 6f6e 6573 203d 206e 702e        ones = np.
-00011c40: 6172 7261 7928 205b 6e70 2e6f 6e65 7328  array( [np.ones(
-00011c50: 2052 4742 2e73 6861 7065 5b30 5d20 295d   RGB.shape[0] )]
-00011c60: 2029 2e54 0d0a 2020 2020 2020 2020 2020   ).T..          
-00011c70: 2020 5247 4220 3d20 6e70 2e63 6f6e 6361    RGB = np.conca
-00011c80: 7465 6e61 7465 2820 2852 4742 2c20 6f6e  tenate( (RGB, on
-00011c90: 6573 2029 2c20 6178 6973 3d31 2020 290d  es ), axis=1  ).
-00011ca0: 0a0d 0a20 2020 2020 2020 2073 656c 662e  ...        self.
-00011cb0: 7665 7274 6578 436f 6c6f 7220 3d20 5247  vertexColor = RG
-00011cc0: 4220 0d0a 2020 2020 2020 2020 7365 6c66  B ..        self
-00011cd0: 2e5f 626f 756e 6473 5b27 7665 7274 766c  ._bounds['vertvl
-00011ce0: 696d 275d 203d 205f 4446 545f 5645 5254  im'] = _DFT_VERT
-00011cf0: 564c 494d 0d0a 0d0a 2020 2020 2020 2020  VLIM....        
-00011d00: 7265 7475 726e 200d 0a0d 0a20 2020 2064  return ....    d
-00011d10: 6566 206d 6170 5f63 6f6c 6f72 5f66 726f  ef map_color_fro
-00011d20: 6d5f 6f70 2873 656c 662c 206f 7065 7261  m_op(self, opera
-00011d30: 7469 6f6e 2c20 7267 623d 5472 7565 2c20  tion, rgb=True, 
-00011d40: 636e 616d 653d 4e6f 6e65 2920 3a0d 0a20  cname=None) :.. 
-00011d50: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
-00011d60: 2020 2020 4173 7369 676e 6d65 6e74 206f      Assignment o
-00011d70: 6620 6661 6365 2063 6f6c 6f72 2066 726f  f face color fro
-00011d80: 6d20 6120 6675 6e63 7469 6f6e 2e0d 0a0d  m a function....
-00011d90: 0a20 2020 2020 2020 2046 6163 6520 636f  .        Face co
-00011da0: 6c6f 7273 2061 7265 2061 7373 6967 6e65  lors are assigne
-00011db0: 6420 6672 6f6d 2061 2066 756e 6374 696f  d from a functio
-00011dc0: 6e0d 0a20 2020 2020 2020 206f 6620 6661  n..        of fa
-00011dd0: 6365 2063 6f6f 7264 696e 6174 6573 2e0d  ce coordinates..
-00011de0: 0a0d 0a20 2020 2020 2020 2050 6172 616d  ...        Param
-00011df0: 6574 6572 730d 0a20 2020 2020 2020 202d  eters..        -
-00011e00: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
-00011e10: 2020 206f 7065 7261 7469 6f6e 203a 2066     operation : f
-00011e20: 756e 6374 696f 6e20 6f62 6a65 6374 0d0a  unction object..
-00011e30: 2020 2020 2020 2020 2020 2020 4675 6e63              Func
-00011e40: 7469 6f6e 2074 6861 7420 7461 6b65 7320  tion that takes 
-00011e50: 6f6e 6520 6172 6775 6d65 6e74 2c0d 0a20  one argument,.. 
-00011e60: 2020 2020 2020 2020 2020 2061 2033 784e             a 3xN
-00011e70: 204e 756d 7079 2061 7272 6179 206f 6620   Numpy array of 
-00011e80: 6e61 7469 7665 2063 6f6f 7264 696e 6174  native coordinat
-00011e90: 6573 2e0d 0a20 2020 2020 2020 2020 2020  es...           
-00011ea0: 2054 6865 2066 756e 6374 696f 6e20 7265   The function re
-00011eb0: 7475 726e 7320 6120 3378 4e20 636f 6c6f  turns a 3xN colo
-00011ec0: 7220 7661 6c75 652e 0d0a 0d0a 2020 2020  r value.....    
-00011ed0: 2020 2020 7267 6220 3a20 626f 6f6c 207b      rgb : bool {
-00011ee0: 5472 7565 2c20 4661 6c73 657d 2c20 6f70  True, False}, op
-00011ef0: 7469 6f6e 616c 2c20 6465 6661 756c 743a  tional, default:
-00011f00: 2054 7275 650d 0a20 2020 2020 2020 2020   True..         
-00011f10: 2020 2042 7920 6465 6661 756c 742c 2052     By default, R
-00011f20: 4742 2063 6f6c 6f72 2076 616c 7565 7320  GB color values 
-00011f30: 6172 6520 7265 7475 726e 6564 2062 7920  are returned by 
-00011f40: 7468 650d 0a20 2020 2020 2020 2020 2020  the..           
-00011f50: 206f 7065 7261 7469 6f6e 2066 756e 6374   operation funct
-00011f60: 696f 6e2e 2020 4966 2073 6574 2046 616c  ion.  If set Fal
-00011f70: 7365 2c20 7468 6520 6f70 6572 6174 696f  se, the operatio
-00011f80: 6e0d 0a20 2020 2020 2020 2020 2020 2072  n..            r
-00011f90: 6574 7572 6e73 2048 5356 2063 6f6c 6f72  eturns HSV color
-00011fa0: 2076 616c 7565 732e 0d0a 0d0a 2020 2020   values.....    
-00011fb0: 2020 2020 636e 616d 6520 3a20 7374 7269      cname : stri
-00011fc0: 6e67 2c20 6f70 7469 6f6e 616c 2c20 6465  ng, optional, de
-00011fd0: 6661 756c 743a 204e 6f6e 6520 6f72 206f  fault: None or o
-00011fe0: 7020 6675 6e63 7469 6f6e 206e 616d 652e  p function name.
-00011ff0: 0d0a 2020 2020 2020 2020 2020 2020 4465  ..            De
-00012000: 7363 7269 7074 6976 6520 6964 656e 7469  scriptive identi
-00012010: 6669 6572 2066 6f72 2076 616c 7565 7320  fier for values 
-00012020: 696e 6469 6361 7465 6420 6279 2063 6f6c  indicated by col
-00012030: 6f72 2e0d 0a0d 0a20 2020 2020 2020 2052  or.....        R
-00012040: 6574 7572 6e73 0d0a 2020 2020 2020 2020  eturns..        
-00012050: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-00012060: 2073 656c 6620 3a20 7375 7266 6163 6520   self : surface 
-00012070: 6f62 6a65 6374 0d0a 0d0a 2020 2020 2020  object....      
-00012080: 2020 2222 220d 0a0d 0a20 2020 2020 2020    """....       
-00012090: 2076 6572 7473 203d 2073 656c 662e 7665   verts = self.ve
-000120a0: 7274 6578 436f 6f72 5b20 7365 6c66 2e66  rtexCoor[ self.f
-000120b0: 7649 6e64 6963 6573 205d 0d0a 2020 2020  vIndices ]..    
-000120c0: 2020 2020 6661 6365 4365 6e74 6572 436f      faceCenterCo
-000120d0: 6f72 203d 2073 656c 662e 5f67 6574 5f66  or = self._get_f
-000120e0: 6163 655f 6365 6e74 6572 7328 7665 7274  ace_centers(vert
-000120f0: 7329 0d0a 2020 2020 2020 2020 7879 7a20  s)..        xyz 
-00012100: 3d20 6e70 2e74 7261 6e73 706f 7365 2866  = np.transpose(f
-00012110: 6163 6543 656e 7465 7243 6f6f 7229 0d0a  aceCenterCoor)..
-00012120: 2020 2020 2020 2020 6162 6320 3d20 7365          abc = se
-00012130: 6c66 2e63 6f6f 725f 636f 6e76 6572 7428  lf.coor_convert(
-00012140: 7879 7a29 0d0a 2020 2020 2020 2020 636f  xyz)..        co
-00012150: 6c6f 7273 203d 206e 702e 6172 7261 7928  lors = np.array(
-00012160: 6f70 6572 6174 696f 6e28 6162 6329 290d  operation(abc)).
-00012170: 0a20 2020 2020 2020 2063 6f6c 6f72 7320  .        colors 
-00012180: 3d20 6e70 2e74 7261 6e73 706f 7365 2863  = np.transpose(c
-00012190: 6f6c 6f72 7329 0d0a 2020 2020 2020 2020  olors)..        
-000121a0: 636f 6c6f 7273 203d 206e 702e 636c 6970  colors = np.clip
-000121b0: 2863 6f6c 6f72 732c 302c 3129 0d0a 2020  (colors,0,1)..  
-000121c0: 2020 2020 2020 6966 2072 6762 203a 2052        if rgb : R
-000121d0: 4742 203d 2063 6f6c 6f72 730d 0a20 2020  GB = colors..   
-000121e0: 2020 2020 2065 6c73 6520 3a20 2020 5247       else :   RG
-000121f0: 4220 3d20 636d 2e63 6f6c 6f72 732e 6873  B = cm.colors.hs
-00012200: 765f 746f 5f72 6762 2863 6f6c 6f72 7329  v_to_rgb(colors)
-00012210: 0d0a 2020 2020 2020 2020 7365 6c66 2e73  ..        self.s
-00012220: 6574 5f63 6f6c 6f72 2852 4742 290d 0a20  et_color(RGB).. 
-00012230: 2020 2020 2020 2073 656c 662e 6973 5375         self.isSu
-00012240: 7266 6163 6543 6f6c 6f72 6564 203d 2054  rfaceColored = T
-00012250: 7275 650d 0a20 2020 2020 2020 2063 6e61  rue..        cna
-00012260: 6d65 203d 205f 6765 7446 756e 6374 696f  me = _getFunctio
-00012270: 6e4e 616d 6528 6f70 6572 6174 696f 6e2c  nName(operation,
-00012280: 636e 616d 6529 200d 0a20 2020 2020 2020  cname) ..       
-00012290: 2069 6620 636e 616d 6520 6973 206e 6f74   if cname is not
-000122a0: 204e 6f6e 6520 3a20 7365 6c66 2e76 616c   None : self.val
-000122b0: 7565 734e 616d 6520 3d20 636e 616d 6520  uesName = cname 
-000122c0: 0d0a 2020 2020 2020 2020 7365 6c66 2e5f  ..        self._
-000122d0: 626f 756e 6473 5b27 766c 696d 275d 203d  bounds['vlim'] =
-000122e0: 205f 4446 545f 564c 494d 0d0a 0d0a 2020   _DFT_VLIM....  
-000122f0: 2020 2020 2020 7365 6c66 2e5f 6d61 705f        self._map_
-00012300: 636f 6c6f 725f 6672 6f6d 5f6f 705f 7665  color_from_op_ve
-00012310: 7274 286f 7065 7261 7469 6f6e 2c20 7267  rt(operation, rg
-00012320: 6229 0d0a 0d0a 2020 2020 2020 2020 7265  b)....        re
-00012330: 7475 726e 2073 656c 660d 0a0d 0a20 2020  turn self....   
-00012340: 2064 6566 205f 6d61 705f 636d 6170 5f66   def _map_cmap_f
-00012350: 726f 6d5f 6461 7461 6772 6964 5f76 6572  rom_datagrid_ver
-00012360: 7428 7365 6c66 2c20 6461 7461 6772 6964  t(self, datagrid
-00012370: 2c20 636d 6170 3d4e 6f6e 652c 2076 6965  , cmap=None, vie
-00012380: 7770 6f72 743d 4e6f 6e65 2920 3a0d 0a0d  wport=None) :...
-00012390: 0a20 2020 2020 2020 2061 2c62 2c69 6e56  .        a,b,inV
-000123a0: 6965 7770 6f72 7420 3d20 7365 6c66 2e5f  iewport = self._
-000123b0: 7669 6577 706f 7274 436f 6f72 2873 656c  viewportCoor(sel
-000123c0: 662e 7665 7274 6578 436f 6f72 2c76 6965  f.vertexCoor,vie
-000123d0: 7770 6f72 7429 2020 2020 2020 0d0a 2020  wport)      ..  
-000123e0: 2020 2020 2020 6461 7461 203d 2064 6174        data = dat
-000123f0: 6167 7269 640d 0a20 2020 2020 2020 2064  agrid..        d
-00012400: 6d61 7820 3d20 6e70 2e61 6d61 7828 6461  max = np.amax(da
-00012410: 7461 6772 6964 290d 0a20 2020 2020 2020  tagrid)..       
-00012420: 2064 6d69 6e20 3d20 6e70 2e61 6d69 6e28   dmin = np.amin(
-00012430: 6461 7461 6772 6964 290d 0a20 2020 2020  datagrid)..     
-00012440: 2020 2078 6420 3d20 6e70 2e6c 696e 7370     xd = np.linsp
-00012450: 6163 6528 302c 2031 2c20 6461 7461 2e73  ace(0, 1, data.s
-00012460: 6861 7065 5b30 5d20 290d 0a20 2020 2020  hape[0] )..     
-00012470: 2020 2079 6420 3d20 6e70 2e6c 696e 7370     yd = np.linsp
-00012480: 6163 6528 302c 2031 2c20 6461 7461 2e73  ace(0, 1, data.s
-00012490: 6861 7065 5b31 5d20 290d 0a20 2020 2020  hape[1] )..     
-000124a0: 2020 2067 203d 2020 696e 7465 7270 6f6c     g =  interpol
-000124b0: 6174 652e 696e 7465 7270 3264 2879 642c  ate.interp2d(yd,
-000124c0: 2078 642c 2064 6174 612c 206b 696e 643d   xd, data, kind=
-000124d0: 2763 7562 6963 2729 0d0a 2020 2020 2020  'cubic')..      
-000124e0: 2020 6420 3d20 5b5d 0d0a 2020 2020 2020    d = []..      
-000124f0: 2020 2320 4675 7444 6576 3a20 7573 6520    # FutDev: use 
-00012500: 6e75 6d70 7920 6d65 7468 6f64 7320 746f  numpy methods to
-00012510: 206f 7074 696d 697a 6520 6566 6669 6369   optimize effici
-00012520: 656e 6379 2e0d 0a20 2020 2020 2020 2066  ency...        f
-00012530: 6f72 2061 6220 696e 206e 702e 7472 616e  or ab in np.tran
-00012540: 7370 6f73 6528 5b61 2c62 5d29 203a 0d0a  spose([a,b]) :..
-00012550: 2020 2020 2020 2020 2020 2020 642e 6170              d.ap
-00012560: 7065 6e64 2820 6728 6162 5b30 5d2c 6162  pend( g(ab[0],ab
-00012570: 5b31 5d29 5b30 5d20 2920 2020 0d0a 2020  [1])[0] )   ..  
-00012580: 2020 2020 2020 6420 3d20 6e70 2e77 6865        d = np.whe
-00012590: 7265 2869 6e56 6965 7770 6f72 742c 642c  re(inViewport,d,
-000125a0: 6e70 2e66 756c 6c28 6c65 6e28 6429 2c64  np.full(len(d),d
-000125b0: 6d69 6e29 290d 0a20 2020 2020 2020 200d  min))..        .
-000125c0: 0a20 2020 2020 2020 2069 6620 636d 6170  .        if cmap
-000125d0: 2069 7320 6e6f 7420 4e6f 6e65 203a 0d0a   is not None :..
-000125e0: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-000125f0: 7369 6e73 7461 6e63 6528 636d 6170 2c73  sinstance(cmap,s
-00012600: 7472 2920 3a20 0d0a 2020 2020 2020 2020  tr) : ..        
-00012610: 2020 2020 2020 2020 7365 6c66 2e73 6574          self.set
-00012620: 5f63 6d61 7028 636d 2e67 6574 5f63 6d61  _cmap(cm.get_cma
-00012630: 7028 636d 6170 2929 0d0a 2020 2020 2020  p(cmap))..      
-00012640: 2020 2020 2020 656c 7365 203a 0d0a 2020        else :..  
-00012650: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00012660: 6c66 2e73 6574 5f63 6d61 7028 636d 6170  lf.set_cmap(cmap
-00012670: 290d 0a20 2020 2020 2020 2063 6d61 7020  )..        cmap 
-00012680: 3d20 7365 6c66 2e67 6574 5f63 6d61 7028  = self.get_cmap(
-00012690: 290d 0a20 2020 2020 2020 200d 0a20 2020  )..        ..   
-000126a0: 2020 2020 206f 7269 675f 636f 6c6f 7273       orig_colors
-000126b0: 203d 2073 656c 662e 7665 7274 6578 436f   = self.vertexCo
-000126c0: 6c6f 720d 0a0d 0a20 2020 2020 2020 2069  lor....        i
-000126d0: 6620 6c65 6e28 6f72 6967 5f63 6f6c 6f72  f len(orig_color
-000126e0: 7329 203d 3d20 3120 3a0d 0a20 2020 2020  s) == 1 :..     
-000126f0: 2020 2020 2020 206f 6e65 6172 7220 3d20         onearr = 
-00012700: 6e70 2e6f 6e65 7328 206c 656e 2873 656c  np.ones( len(sel
-00012710: 662e 7665 7274 6578 436f 6f72 2920 295b  f.vertexCoor) )[
-00012720: 3a2c 206e 702e 6e65 7761 7869 735d 0d0a  :, np.newaxis]..
-00012730: 2020 2020 2020 2020 2020 2020 6f72 6967              orig
-00012740: 5f63 6f6c 6f72 7320 3d20 6f72 6967 5f63  _colors = orig_c
-00012750: 6f6c 6f72 732a 6f6e 6561 7272 2020 2020  olors*onearr    
-00012760: 2020 200d 0a20 2020 2020 2020 200d 0a20     ..        .. 
-00012770: 2020 2020 2020 206e 6f72 6d20 3d20 636f         norm = co
-00012780: 6c6f 7273 2e4e 6f72 6d61 6c69 7a65 2864  lors.Normalize(d
-00012790: 6d69 6e2c 646d 6178 290d 0a20 2020 2020  min,dmax)..     
-000127a0: 2020 2074 656d 7020 3d20 636d 6170 286e     temp = cmap(n
-000127b0: 6f72 6d28 6429 290d 0a20 2020 2020 2020  orm(d))..       
-000127c0: 2069 6620 7669 6577 706f 7274 2069 7320   if viewport is 
-000127d0: 4e6f 6e65 203a 0d0a 2020 2020 2020 2020  None :..        
-000127e0: 2020 2020 636f 6c6f 724d 6170 203d 2074      colorMap = t
-000127f0: 656d 700d 0a20 2020 2020 2020 2065 6c73  emp..        els
-00012800: 6520 3a0d 0a20 2020 2020 2020 2020 2020  e :..           
-00012810: 2063 6f6c 6f72 4d61 7020 3d20 6e70 2e77   colorMap = np.w
-00012820: 6865 7265 2869 6e56 6965 7770 6f72 745b  here(inViewport[
-00012830: 3a2c 206e 702e 6e65 7761 7869 735d 2c20  :, np.newaxis], 
-00012840: 7465 6d70 2c20 6f72 6967 5f63 6f6c 6f72  temp, orig_color
-00012850: 7320 290d 0a0d 0a20 2020 2020 2020 2023  s )....        #
-00012860: 2046 7574 4465 763a 2073 6574 5f63 6f6c   FutDev: set_col
-00012870: 6f72 2075 7365 6420 696e 7374 6561 6420  or used instead 
-00012880: 6f66 2073 6574 5f66 6163 6563 6f6c 6f72  of set_facecolor
-00012890: 2074 6f20 656c 696d 696e 6174 6520 2767   to eliminate 'g
-000128a0: 6170 7327 2062 6574 7765 656e 2066 6163  aps' between fac
-000128b0: 6573 2c20 203c 3c3c 3c3c 0d0a 2020 2020  es,  <<<<<..    
-000128c0: 2020 2020 2320 686f 7765 7665 722c 2073      # however, s
-000128d0: 6574 5f65 6467 6563 6f6c 6f72 2072 6571  et_edgecolor req
-000128e0: 7569 7265 6420 6166 7465 7220 696c 6c75  uired after illu
-000128f0: 6d69 6e61 7469 6f6e 2069 6620 6564 6765  mination if edge
-00012900: 7320 6172 6520 746f 2062 6520 6469 7370  s are to be disp
-00012910: 6c61 7965 642e 2020 2020 3c3c 3c3c 3c0d  layed.    <<<<<.
-00012920: 0a20 2020 2020 2020 2023 2048 4f57 4556  .        # HOWEV
-00012930: 4552 2021 2121 2120 2069 6620 636f 6c6f  ER !!!!  if colo
-00012940: 724d 6170 2068 6173 2061 2061 6c70 6861  rMap has a alpha
-00012950: 3c31 2c20 7468 6573 6520 646f 6e27 7420  <1, these don't 
-00012960: 7265 6769 7374 6572 2077 6974 6820 7468  register with th
-00012970: 6520 6564 6765 732e 2020 2020 2020 203c  e edges.       <
-00012980: 3c3c 3c3c 0d0a 0d0a 2020 2020 2020 2020  <<<<....        
-00012990: 2373 656c 662e 7665 7274 6578 5661 6c75  #self.vertexValu
-000129a0: 6573 203d 2064 2020 203c 3c3c 3c20 4e4f  es = d   <<<< NO
-000129b0: 2e2e 2069 6e74 6572 706f 6c61 7465 6420  .. interpolated 
-000129c0: 7661 6c75 6573 206f 6e6c 7920 696e 2076  values only in v
-000129d0: 6965 7770 6f72 742c 0d0a 2020 2020 2020  iewport,..      
-000129e0: 2020 7365 6c66 2e76 6572 7465 7843 6f6c    self.vertexCol
-000129f0: 6f72 203d 206e 702e 6172 7261 7928 636f  or = np.array(co
-00012a00: 6c6f 724d 6170 290d 0a0d 0a20 2020 2020  lorMap)....     
-00012a10: 2020 2072 6574 7572 6e0d 0a0d 0a20 2020     return....   
-00012a20: 2064 6566 206d 6170 5f63 6d61 705f 6672   def map_cmap_fr
-00012a30: 6f6d 5f64 6174 6167 7269 6428 7365 6c66  om_datagrid(self
-00012a40: 2c20 6461 7461 6772 6964 2c20 636d 6170  , datagrid, cmap
-00012a50: 3d4e 6f6e 652c 2076 6965 7770 6f72 743d  =None, viewport=
-00012a60: 4e6f 6e65 2c20 636e 616d 653d 4e6f 6e65  None, cname=None
-00012a70: 2920 3a0d 0a20 2020 2020 2020 2022 2222  ) :..        """
-00012a80: 0d0a 2020 2020 2020 2020 4661 6365 2063  ..        Face c
-00012a90: 6f6c 6f72 2061 7373 6967 6e6d 656e 7420  olor assignment 
-00012aa0: 7573 696e 6720 6120 3244 2064 6174 6167  using a 2D datag
-00012ab0: 7269 6420 7375 7266 6163 652e 0d0a 2020  rid surface...  
-00012ac0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-00012ad0: 4461 7461 6772 6964 2076 616c 7565 7320  Datagrid values 
-00012ae0: 6172 6520 6e6f 726d 616c 697a 6564 2069  are normalized i
-00012af0: 6e20 7468 6520 7261 6e67 6520 3020 746f  n the range 0 to
-00012b00: 2031 2e0d 0a0d 0a20 2020 2020 2020 2054   1.....        T
-00012b10: 6869 7320 6d65 7468 6f64 2069 7320 6e6f  his method is no
-00012b20: 7420 6176 6169 6c61 626c 6520 666f 7220  t available for 
-00012b30: 636f 6d70 6f73 6974 6520 7375 7266 6163  composite surfac
-00012b40: 6573 2e0d 0a20 2020 2020 2020 2054 6865  es...        The
-00012b50: 2065 6e74 6972 6520 6461 7461 6772 6964   entire datagrid
-00012b60: 2064 6f6d 6169 6e20 6973 2061 7070 6c69   domain is appli
-00012b70: 6564 2074 6f20 7468 6520 6765 6f6d 6574  ed to the geomet
-00012b80: 7269 6320 6f70 6572 6174 696f 6e2e 0d0a  ric operation...
-00012b90: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-00012ba0: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
-00012bb0: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
-00012bc0: 2020 6461 7461 6772 6964 203a 2032 4420    datagrid : 2D 
-00012bd0: 666c 6f61 7420 6172 7261 790d 0a0d 0a20  float array.... 
-00012be0: 2020 2020 2020 2063 6d61 7020 3a20 7374         cmap : st
-00012bf0: 7220 6f72 2043 6f6c 6f72 6d61 702c 206f  r or Colormap, o
-00012c00: 7074 696f 6e61 6c0d 0a20 2020 2020 2020  ptional..       
-00012c10: 2020 2020 2041 2043 6f6c 6f72 6d61 7020       A Colormap 
-00012c20: 696e 7374 616e 6365 206f 7220 7265 6769  instance or regi
-00012c30: 7374 6572 6564 2063 6f6c 6f72 6d61 7020  stered colormap 
-00012c40: 6e61 6d65 2e0d 0a20 2020 2020 2020 2020  name...         
-00012c50: 2020 2049 6620 6e6f 7420 6173 7369 676e     If not assign
-00012c60: 6564 2c20 7468 6520 7375 7266 6163 6520  ed, the surface 
-00012c70: 436f 6c6f 726d 6170 2069 7320 7573 6564  Colormap is used
-00012c80: 2e0d 0a20 2020 2020 2020 2020 2020 2054  ...            T
-00012c90: 6865 2063 6f6c 6f72 6d61 7020 6d61 7073  he colormap maps
-00012ca0: 2074 6865 2064 6174 6167 7269 6420 7661   the datagrid va
-00012cb0: 6c75 6573 2074 6f20 636f 6c6f 7273 2e0d  lues to colors..
-00012cc0: 0a0d 0a20 2020 2020 2020 2076 6965 7770  ...        viewp
-00012cd0: 6f72 7420 3a20 3444 2061 7272 6179 2d6c  ort : 4D array-l
-00012ce0: 696b 652c 206f 7074 696f 6e61 6c2c 2064  ike, optional, d
-00012cf0: 6566 6175 6c74 3a20 4e6f 6e65 0d0a 2020  efault: None..  
-00012d00: 2020 2020 2020 2020 2020 5669 6577 706f            Viewpo
-00012d10: 7274 2064 6566 696e 6573 2074 6865 2073  rt defines the s
-00012d20: 7562 646f 6d61 696e 206f 6620 7468 6520  ubdomain of the 
-00012d30: 7375 7266 6163 6520 6f6e 746f 2077 6869  surface onto whi
-00012d40: 6368 0d0a 2020 2020 2020 2020 2020 2020  ch..            
-00012d50: 7468 6520 6461 7461 6772 6964 2069 7320  the datagrid is 
-00012d60: 6d61 7070 6564 2e20 2054 6865 2073 7562  mapped.  The sub
-00012d70: 646f 6d61 696e 2069 7320 7365 7420 6279  domain is set by
-00012d80: 206e 6f72 6d61 6c69 7a65 640d 0a20 2020   normalized..   
-00012d90: 2020 2020 2020 2020 206e 6174 6976 6520           native 
-00012da0: 7375 7266 6163 6520 636f 6f72 6469 6e61  surface coordina
-00012db0: 7465 7320 696e 2061 2034 4420 6172 7261  tes in a 4D arra
-00012dc0: 792e 0d0a 2020 2020 2020 2020 2020 2020  y...            
-00012dd0: 5468 6520 656e 7469 7265 2073 7572 6661  The entire surfa
-00012de0: 6365 2069 7320 636f 6c6f 7265 6420 666f  ce is colored fo
-00012df0: 7220 7468 6520 6465 6661 756c 7420 6f66  r the default of
-00012e00: 204e 6f6e 652e 0d0a 0d0a 2020 2020 2020   None.....      
-00012e10: 2020 636e 616d 6520 3a20 7374 7269 6e67    cname : string
-00012e20: 2c20 6f70 7469 6f6e 616c 2c20 6465 6661  , optional, defa
-00012e30: 756c 743a 204e 6f6e 652e 0d0a 2020 2020  ult: None...    
-00012e40: 2020 2020 2020 2020 4465 7363 7269 7074          Descript
-00012e50: 6976 6520 6964 656e 7469 6669 6572 2066  ive identifier f
-00012e60: 6f72 2076 616c 7565 7320 696e 6469 6361  or values indica
-00012e70: 7465 6420 6279 2063 6f6c 6f72 2e0d 0a0d  ted by color....
-00012e80: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-00012e90: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-00012ea0: 2d0d 0a20 2020 2020 2020 2073 656c 6620  -..        self 
-00012eb0: 3a20 7375 7266 6163 6520 6f62 6a65 6374  : surface object
-00012ec0: 0d0a 0d0a 2020 2020 2020 2020 2222 220d  ....        """.
-00012ed0: 0a0d 0a20 2020 2020 2020 2069 6620 7365  ...        if se
-00012ee0: 6c66 2e5f 6973 436f 6d70 6f73 6974 6553  lf._isCompositeS
-00012ef0: 7572 6661 6365 203a 0d0a 2020 2020 2020  urface :..      
-00012f00: 2020 2020 2020 7761 726e 696e 6773 2e77        warnings.w
-00012f10: 6172 6e28 2744 6174 6167 7269 6420 6f70  arn('Datagrid op
-00012f20: 6572 6174 696f 6e20 6e6f 7420 6176 6169  eration not avai
-00012f30: 6c61 626c 6520 666f 7220 636f 6d62 696e  lable for combin
-00012f40: 6564 2073 6861 7065 732e 2729 0d0a 2020  ed shapes.')..  
-00012f50: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00012f60: 2073 656c 660d 0a20 2020 2020 2020 2069   self..        i
-00012f70: 6620 7365 6c66 2e5f 7375 7266 6163 6553  f self._surfaceS
-00012f80: 6861 7065 4368 616e 6765 6420 3a0d 0a20  hapeChanged :.. 
-00012f90: 2020 2020 2020 2020 2020 2077 6172 6e69             warni
-00012fa0: 6e67 732e 7761 726e 2827 4461 7461 6772  ngs.warn('Datagr
-00012fb0: 6964 206f 7065 7261 7469 6f6e 206d 6179  id operation may
-00012fc0: 2062 6520 616e 6f6d 616c 6f75 7320 6166   be anomalous af
-00012fd0: 7465 7220 7368 6170 6520 6d6f 6469 6669  ter shape modifi
-00012fe0: 6361 7469 6f6e 2e27 290d 0a0d 0a20 2020  cation.')....   
-00012ff0: 2020 2020 2076 6572 7473 203d 2073 656c       verts = sel
-00013000: 662e 7665 7274 6578 436f 6f72 5b20 7365  f.vertexCoor[ se
-00013010: 6c66 2e66 7649 6e64 6963 6573 205d 0d0a  lf.fvIndices ]..
-00013020: 2020 2020 2020 2020 6661 6365 4365 6e74          faceCent
-00013030: 6572 436f 6f72 203d 2073 656c 662e 5f67  erCoor = self._g
-00013040: 6574 5f66 6163 655f 6365 6e74 6572 7328  et_face_centers(
-00013050: 7665 7274 7329 0d0a 2020 2020 2020 2020  verts)..        
-00013060: 612c 622c 696e 5669 6577 706f 7274 203d  a,b,inViewport =
-00013070: 2073 656c 662e 5f76 6965 7770 6f72 7443   self._viewportC
-00013080: 6f6f 7228 6661 6365 4365 6e74 6572 436f  oor(faceCenterCo
-00013090: 6f72 2c76 6965 7770 6f72 7429 2020 2020  or,viewport)    
-000130a0: 2020 0d0a 2020 2020 2020 2020 6461 7461    ..        data
-000130b0: 203d 2064 6174 6167 7269 640d 0a20 2020   = datagrid..   
-000130c0: 2020 2020 2064 6d61 7820 3d20 6e70 2e61       dmax = np.a
-000130d0: 6d61 7828 6461 7461 6772 6964 290d 0a20  max(datagrid).. 
-000130e0: 2020 2020 2020 2064 6d69 6e20 3d20 6e70         dmin = np
-000130f0: 2e61 6d69 6e28 6461 7461 6772 6964 290d  .amin(datagrid).
-00013100: 0a20 2020 2020 2020 2078 6420 3d20 6e70  .        xd = np
-00013110: 2e6c 696e 7370 6163 6528 302c 2031 2c20  .linspace(0, 1, 
-00013120: 6461 7461 2e73 6861 7065 5b30 5d20 290d  data.shape[0] ).
-00013130: 0a20 2020 2020 2020 2079 6420 3d20 6e70  .        yd = np
-00013140: 2e6c 696e 7370 6163 6528 302c 2031 2c20  .linspace(0, 1, 
-00013150: 6461 7461 2e73 6861 7065 5b31 5d20 290d  data.shape[1] ).
-00013160: 0a20 2020 2020 2020 2067 203d 2020 696e  .        g =  in
-00013170: 7465 7270 6f6c 6174 652e 696e 7465 7270  terpolate.interp
-00013180: 3264 2879 642c 2078 642c 2064 6174 612c  2d(yd, xd, data,
-00013190: 206b 696e 643d 2763 7562 6963 2729 0d0a   kind='cubic')..
-000131a0: 2020 2020 2020 2020 6420 3d20 5b5d 0d0a          d = []..
-000131b0: 2020 2020 2020 2020 2320 4675 7444 6576          # FutDev
-000131c0: 3a20 7573 6520 6e75 6d70 7920 6d65 7468  : use numpy meth
-000131d0: 6f64 7320 746f 206f 7074 696d 697a 6520  ods to optimize 
-000131e0: 6566 6669 6369 656e 6379 2e0d 0a20 2020  efficiency...   
-000131f0: 2020 2020 2066 6f72 2061 6220 696e 206e       for ab in n
-00013200: 702e 7472 616e 7370 6f73 6528 5b61 2c62  p.transpose([a,b
-00013210: 5d29 203a 0d0a 2020 2020 2020 2020 2020  ]) :..          
-00013220: 2020 642e 6170 7065 6e64 2820 6728 6162    d.append( g(ab
-00013230: 5b30 5d2c 6162 5b31 5d29 5b30 5d20 2920  [0],ab[1])[0] ) 
-00013240: 2020 0d0a 2020 2020 2020 2020 6420 3d20    ..        d = 
-00013250: 6e70 2e77 6865 7265 2869 6e56 6965 7770  np.where(inViewp
-00013260: 6f72 742c 642c 6e70 2e66 756c 6c28 6c65  ort,d,np.full(le
-00013270: 6e28 6429 2c64 6d69 6e29 290d 0a20 2020  n(d),dmin))..   
-00013280: 2020 2020 200d 0a20 2020 2020 2020 2069       ..        i
-00013290: 6620 636d 6170 2069 7320 6e6f 7420 4e6f  f cmap is not No
-000132a0: 6e65 203a 0d0a 2020 2020 2020 2020 2020  ne :..          
-000132b0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-000132c0: 636d 6170 2c73 7472 2920 3a20 0d0a 2020  cmap,str) : ..  
-000132d0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-000132e0: 6c66 2e73 6574 5f63 6d61 7028 636d 2e67  lf.set_cmap(cm.g
-000132f0: 6574 5f63 6d61 7028 636d 6170 2929 0d0a  et_cmap(cmap))..
-00013300: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00013310: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
-00013320: 2020 2020 7365 6c66 2e73 6574 5f63 6d61      self.set_cma
-00013330: 7028 636d 6170 290d 0a20 2020 2020 2020  p(cmap)..       
-00013340: 2063 6d61 7020 3d20 7365 6c66 2e67 6574   cmap = self.get
-00013350: 5f63 6d61 7028 290d 0a20 2020 2020 2020  _cmap()..       
-00013360: 200d 0a20 2020 2020 2020 206f 7269 675f   ..        orig_
-00013370: 636f 6c6f 7273 203d 2073 656c 662e 5f66  colors = self._f
-00013380: 6163 6563 6f6c 6f72 730d 0a0d 0a20 2020  acecolors....   
-00013390: 2020 2020 2069 6620 6c65 6e28 6f72 6967       if len(orig
-000133a0: 5f63 6f6c 6f72 7329 203d 3d20 3120 3a0d  _colors) == 1 :.
-000133b0: 0a20 2020 2020 2020 2020 2020 206f 6e65  .            one
-000133c0: 6172 7220 3d20 6e70 2e6f 6e65 7328 206c  arr = np.ones( l
-000133d0: 656e 2866 6163 6543 656e 7465 7243 6f6f  en(faceCenterCoo
-000133e0: 7229 2029 5b3a 2c20 6e70 2e6e 6577 6178  r) )[:, np.newax
-000133f0: 6973 5d0d 0a20 2020 2020 2020 2020 2020  is]..           
-00013400: 206f 7269 675f 636f 6c6f 7273 203d 206f   orig_colors = o
-00013410: 7269 675f 636f 6c6f 7273 2a6f 6e65 6172  rig_colors*onear
-00013420: 7220 2020 2020 2020 0d0a 2020 2020 2020  r       ..      
-00013430: 2020 0d0a 2020 2020 2020 2020 6e6f 726d    ..        norm
-00013440: 203d 2063 6f6c 6f72 732e 4e6f 726d 616c   = colors.Normal
-00013450: 697a 6528 646d 696e 2c64 6d61 7829 0d0a  ize(dmin,dmax)..
-00013460: 2020 2020 2020 2020 7465 6d70 203d 2063          temp = c
-00013470: 6d61 7028 6e6f 726d 2864 2929 0d0a 2020  map(norm(d))..  
-00013480: 2020 2020 2020 6966 2076 6965 7770 6f72        if viewpor
-00013490: 7420 6973 204e 6f6e 6520 3a0d 0a20 2020  t is None :..   
-000134a0: 2020 2020 2020 2020 2063 6f6c 6f72 4d61           colorMa
-000134b0: 7020 3d20 7465 6d70 0d0a 2020 2020 2020  p = temp..      
-000134c0: 2020 656c 7365 203a 0d0a 2020 2020 2020    else :..      
-000134d0: 2020 2020 2020 636f 6c6f 724d 6170 203d        colorMap =
-000134e0: 206e 702e 7768 6572 6528 696e 5669 6577   np.where(inView
-000134f0: 706f 7274 5b3a 2c20 6e70 2e6e 6577 6178  port[:, np.newax
-00013500: 6973 5d2c 2074 656d 702c 206f 7269 675f  is], temp, orig_
-00013510: 636f 6c6f 7273 2029 0d0a 0d0a 2020 2020  colors )....    
-00013520: 2020 2020 2320 4675 7444 6576 3a20 7365      # FutDev: se
-00013530: 745f 636f 6c6f 7220 7573 6564 2069 6e73  t_color used ins
-00013540: 7465 6164 206f 6620 7365 745f 6661 6365  tead of set_face
-00013550: 636f 6c6f 7220 746f 2065 6c69 6d69 6e61  color to elimina
-00013560: 7465 2027 6761 7073 2720 6265 7477 6565  te 'gaps' betwee
-00013570: 6e20 6661 6365 732c 0d0a 2020 2020 2020  n faces,..      
-00013580: 2020 2320 686f 7765 7665 722c 2073 6574    # however, set
-00013590: 5f65 6467 6563 6f6c 6f72 2072 6571 7569  _edgecolor requi
-000135a0: 7265 6420 6166 7465 7220 696c 6c75 6d69  red after illumi
-000135b0: 6e61 7469 6f6e 2069 6620 6564 6765 7320  nation if edges 
-000135c0: 6172 6520 746f 2062 6520 6469 7370 6c61  are to be displa
-000135d0: 7965 642e 0d0a 2020 2020 2020 2020 2320  yed...        # 
-000135e0: 484f 5745 5645 5220 2121 2121 2020 6966  HOWEVER !!!!  if
-000135f0: 2063 6f6c 6f72 4d61 7020 6861 7320 6120   colorMap has a 
-00013600: 616c 7068 613c 312c 2074 6865 7365 2064  alpha<1, these d
-00013610: 6f6e 2774 2072 6567 6973 7465 7220 7769  on't register wi
-00013620: 7468 2074 6865 2065 6467 6573 2e0d 0a20  th the edges... 
-00013630: 2020 2020 2020 2073 656c 662e 7365 745f         self.set_
-00013640: 636f 6c6f 7228 636f 6c6f 724d 6170 290d  color(colorMap).
-00013650: 0a20 2020 2020 2020 2073 656c 662e 6973  .        self.is
-00013660: 5375 7266 6163 6543 6f6c 6f72 6564 203d  SurfaceColored =
-00013670: 2054 7275 650d 0a20 2020 2020 2020 2073   True..        s
-00013680: 656c 662e 5f62 6f75 6e64 735b 2776 6c69  elf._bounds['vli
-00013690: 6d27 5d20 3d20 5b20 646d 696e 2c20 646d  m'] = [ dmin, dm
-000136a0: 6178 205d 0d0a 0d0a 2020 2020 2020 2020  ax ]....        
-000136b0: 7365 6c66 2e76 616c 7565 734e 616d 6520  self.valuesName 
-000136c0: 3d20 636e 616d 650d 0a20 2020 2020 2020  = cname..       
-000136d0: 2023 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d   # =============
-000136e0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000136f0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00013700: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00013710: 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d 0a20 2020  ===========..   
-00013720: 2020 2020 2073 656c 662e 5f6d 6170 5f63       self._map_c
-00013730: 6d61 705f 6672 6f6d 5f64 6174 6167 7269  map_from_datagri
-00013740: 645f 7665 7274 2864 6174 6167 7269 642c  d_vert(datagrid,
-00013750: 2063 6d61 702c 2076 6965 7770 6f72 7420   cmap, viewport 
-00013760: 290d 0a20 2020 2020 2020 2023 203d 3d3d  )..        # ===
-00013770: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00013780: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00013790: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000137a0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000137b0: 3d3d 3d3d 3d0d 0a0d 0a20 2020 2020 2020  =====....       
-000137c0: 2072 6574 7572 6e20 7365 6c66 0d0a 0d0a   return self....
-000137d0: 2020 2020 6465 6620 5f67 6574 436f 6c6f      def _getColo
-000137e0: 724d 6170 5f66 726f 6d4e 6f72 6d61 6c73  rMap_fromNormals
-000137f0: 2873 656c 662c 6676 6f2c 636d 6170 2c20  (self,fvo,cmap, 
-00013800: 6469 7265 6374 696f 6e2c 2069 7341 6273  direction, isAbs
-00013810: 2920 3a0d 0a20 2020 2020 2020 2022 2222  ) :..        """
-00013820: 2075 7365 6420 6279 206d 6170 5f63 6d61   used by map_cma
-00013830: 705f 6672 6f6d 5f6e 6f72 6d61 6c73 2829  p_from_normals()
-00013840: 2026 205f 6d61 705f 636d 6170 5f66 726f   & _map_cmap_fro
-00013850: 6d5f 6e6f 726d 616c 735f 7665 7274 2829  m_normals_vert()
-00013860: 2022 2222 0d0a 2020 2020 2020 2020 756e   """..        un
-00013870: 6974 5665 6374 6f72 203d 206c 616d 6264  itVector = lambd
-00013880: 6120 7620 3a20 6e70 2e64 6976 6964 6528  a v : np.divide(
-00013890: 2076 2c20 6e70 2e6c 696e 616c 672e 6e6f   v, np.linalg.no
-000138a0: 726d 2876 2920 290d 0a20 2020 2020 2020  rm(v) )..       
-000138b0: 2069 6e63 6964 656e 744c 6967 6874 203d   incidentLight =
-000138c0: 2075 6e69 7456 6563 746f 7228 2064 6972   unitVector( dir
-000138d0: 6563 7469 6f6e 2029 0d0a 2020 2020 2020  ection )..      
-000138e0: 2020 6420 3d20 6e70 2e64 6f74 2866 766f    d = np.dot(fvo
-000138f0: 2c69 6e63 6964 656e 744c 6967 6874 290d  ,incidentLight).
-00013900: 0a20 2020 2020 2020 2069 6620 6973 4162  .        if isAb
-00013910: 7320 3a20 7620 3d20 3120 2d20 6e70 2e61  s : v = 1 - np.a
-00013920: 6273 2864 290d 0a20 2020 2020 2020 2065  bs(d)..        e
-00013930: 6c73 6520 3a0d 0a20 2020 2020 2020 2020  lse :..         
-00013940: 2020 2076 203d 2028 2064 202b 2031 2029     v = ( d + 1 )
-00013950: 2f32 0d0a 2020 2020 2020 2020 7620 3d20  /2..        v = 
-00013960: 6e70 2e61 6273 2876 2920 2023 2074 6f20  np.abs(v)  # to 
-00013970: 696e 7375 7265 2070 6f73 6974 6976 6520  insure positive 
-00013980: 7661 6c75 6573 206e 6561 7220 7a65 726f  values near zero
-00013990: 0d0a 2020 2020 2020 2020 636f 6c6f 724d  ..        colorM
-000139a0: 6170 203d 2063 6d61 7028 7629 0d0a 2020  ap = cmap(v)..  
-000139b0: 2020 2020 2020 7265 7475 726e 2063 6f6c        return col
-000139c0: 6f72 4d61 700d 0a0d 0a20 2020 2064 6566  orMap....    def
-000139d0: 205f 6d61 705f 636d 6170 5f66 726f 6d5f   _map_cmap_from_
-000139e0: 6e6f 726d 616c 735f 7665 7274 2873 656c  normals_vert(sel
-000139f0: 662c 2063 6d61 702c 2064 6972 6563 7469  f, cmap, directi
-00013a00: 6f6e 2c20 6973 4162 7329 203a 0d0a 2020  on, isAbs) :..  
-00013a10: 2020 2020 2020 766f 626a 203d 2073 656c        vobj = sel
-00013a20: 662e 5f67 6574 5f76 6572 7465 785f 6e6f  f._get_vertex_no
-00013a30: 726d 616c 7328 290d 0a20 2020 2020 2020  rmals()..       
-00013a40: 2063 4d61 7020 3d20 7365 6c66 2e5f 6765   cMap = self._ge
-00013a50: 7443 6f6c 6f72 4d61 705f 6672 6f6d 4e6f  tColorMap_fromNo
-00013a60: 726d 616c 7328 766f 626a 2c20 636d 6170  rmals(vobj, cmap
-00013a70: 2c20 6469 7265 6374 696f 6e2c 2069 7341  , direction, isA
-00013a80: 6273 290d 0a20 2020 2020 2020 2073 656c  bs)..        sel
-00013a90: 662e 7665 7274 6578 436f 6c6f 7220 3d20  f.vertexColor = 
-00013aa0: 6e70 2e61 7272 6179 2863 4d61 7029 0d0a  np.array(cMap)..
-00013ab0: 2020 2020 2020 2020 7265 7475 726e 0d0a          return..
-00013ac0: 0d0a 2020 2020 6465 6620 6d61 705f 636d  ..    def map_cm
-00013ad0: 6170 5f66 726f 6d5f 6e6f 726d 616c 7328  ap_from_normals(
-00013ae0: 7365 6c66 2c20 636d 6170 3d4e 6f6e 652c  self, cmap=None,
-00013af0: 2064 6972 6563 7469 6f6e 3d4e 6f6e 652c   direction=None,
-00013b00: 2063 6e61 6d65 3d4e 6f6e 652c 2069 7341   cname=None, isA
-00013b10: 6273 3d46 616c 7365 2920 3a0d 0a20 2020  bs=False) :..   
-00013b20: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
-00013b30: 2020 4661 6365 2063 6f6c 6f72 2061 7373    Face color ass
-00013b40: 6967 6e6d 656e 7420 7573 696e 6720 6e6f  ignment using no
-00013b50: 726d 616c 7320 7265 6c61 7469 7665 2074  rmals relative t
-00013b60: 6f20 6120 6469 7265 6374 696f 6e2e 0d0a  o a direction...
-00013b70: 0d0a 2020 2020 2020 2020 5468 6520 646f  ..        The do
-00013b80: 7420 7072 6f64 7563 7420 6f66 2066 6163  t product of fac
-00013b90: 6520 6e6f 726d 616c 7320 7769 7468 2074  e normals with t
-00013ba0: 6865 2064 6972 6563 7469 6f6e 200d 0a20  he direction .. 
-00013bb0: 2020 2020 2020 2069 7320 7573 6564 2074         is used t
-00013bc0: 6f20 6173 7369 676e 2066 6163 6520 636f  o assign face co
-00013bd0: 6c6f 7273 2066 726f 6d20 6120 636f 6c6f  lors from a colo
-00013be0: 726d 6170 2e0d 0a0d 0a20 2020 2020 2020  rmap.....       
-00013bf0: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
-00013c00: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
-00013c10: 0a20 2020 2020 2020 2063 6d61 7020 3a20  .        cmap : 
-00013c20: 7374 7220 6f72 2043 6f6c 6f72 6d61 702c  str or Colormap,
-00013c30: 206f 7074 696f 6e61 6c0d 0a20 2020 2020   optional..     
-00013c40: 2020 2020 2020 2041 2043 6f6c 6f72 6d61         A Colorma
-00013c50: 7020 696e 7374 616e 6365 206f 7220 7265  p instance or re
-00013c60: 6769 7374 6572 6564 2063 6f6c 6f72 6d61  gistered colorma
-00013c70: 7020 6e61 6d65 2e0d 0a20 2020 2020 2020  p name...       
-00013c80: 2020 2020 2049 6620 6e6f 7420 6173 7369       If not assi
-00013c90: 676e 6564 2c20 7468 6520 7375 7266 6163  gned, the surfac
-00013ca0: 6520 436f 6c6f 726d 6170 2069 7320 7573  e Colormap is us
-00013cb0: 6564 2e0d 0a20 2020 2020 2020 2020 2020  ed...           
-00013cc0: 2054 6865 2063 6f6c 6f72 6d61 7020 6d61   The colormap ma
-00013cd0: 7073 2074 6865 2064 6f74 2070 726f 6475  ps the dot produ
-00013ce0: 6374 2076 616c 7565 7320 746f 2063 6f6c  ct values to col
-00013cf0: 6f72 732e 0d0a 2020 2020 2020 2020 0d0a  ors...        ..
-00013d00: 2020 2020 2020 2020 6469 7265 6374 696f          directio
-00013d10: 6e20 3a20 6c69 7374 206f 6620 7369 7a65  n : list of size
-00013d20: 2033 2c20 6f70 7469 6f6e 616c 2c20 6465   3, optional, de
-00013d30: 6661 756c 743a 205b 312c 302c 315d 0d0a  fault: [1,0,1]..
-00013d40: 2020 2020 2020 2020 2020 2020 4120 3344              A 3D
-00013d50: 2076 6563 746f 7220 696e 2078 797a 2043   vector in xyz C
-00013d60: 6172 7465 7369 616e 2063 6f6f 7264 696e  artesian coordin
-00013d70: 6174 6573 2064 6573 6967 6e61 7469 6e67  ates designating
-00013d80: 0d0a 2020 2020 2020 2020 2020 2020 7468  ..            th
-00013d90: 6520 6469 7265 6374 696f 6e20 6f66 2074  e direction of t
-00013da0: 6865 2069 6c6c 756d 696e 6174 696f 6e20  he illumination 
-00013db0: 736f 7572 6365 2e0d 0a20 2020 2020 2020  source...       
-00013dc0: 2020 2020 2049 6620 6173 7369 676e 6564       If assigned
-00013dd0: 2074 6865 2041 7865 7333 442c 2077 696c   the Axes3D, wil
-00013de0: 6c20 7573 6520 7468 6520 7669 6577 2064  l use the view d
-00013df0: 6972 6563 7469 6f6e 2e0d 0a0d 0a20 2020  irection.....   
-00013e00: 2020 2020 2063 6e61 6d65 203a 2073 7472       cname : str
-00013e10: 696e 672c 206f 7074 696f 6e61 6c2c 2064  ing, optional, d
-00013e20: 6566 6175 6c74 3a20 4e6f 6e65 2e0d 0a20  efault: None... 
-00013e30: 2020 2020 2020 2020 2020 2044 6573 6372             Descr
-00013e40: 6970 7469 7665 2069 6465 6e74 6966 6965  iptive identifie
-00013e50: 7220 666f 7220 7661 6c75 6573 2069 6e64  r for values ind
-00013e60: 6963 6174 6564 2062 7920 636f 6c6f 722e  icated by color.
-00013e70: 0d0a 0d0a 2020 2020 2020 2020 6973 4162  ....        isAb
-00013e80: 7320 3a20 626f 6f6c 6561 6e2c 206f 7074  s : boolean, opt
-00013e90: 696f 6e61 6c2c 2064 6566 6175 6c74 3a20  ional, default: 
-00013ea0: 4661 6c73 650d 0a20 2020 2020 2020 2020  False..         
-00013eb0: 2020 2049 6620 7365 7420 5472 7565 2c20     If set True, 
-00013ec0: 7468 6520 6162 736f 6c75 7465 2076 616c  the absolute val
-00013ed0: 7565 206f 6620 7468 6520 646f 7420 7072  ue of the dot pr
-00013ee0: 6f64 7563 740d 0a20 2020 2020 2020 2020  oduct..         
-00013ef0: 2020 2062 6574 7765 656e 2066 6163 6520     between face 
-00013f00: 6e6f 726d 616c 7320 616e 6420 696c 6c75  normals and illu
-00013f10: 6d69 6e61 7469 6f6e 2064 6972 6563 7469  mination directi
-00013f20: 6f6e 2069 730d 0a20 2020 2020 2020 2020  on is..         
-00013f30: 2020 2075 7365 642e 0d0a 0d0a 2020 2020     used.....    
-00013f40: 2020 2020 5265 7475 726e 730d 0a20 2020      Returns..   
-00013f50: 2020 2020 202d 2d2d 2d2d 2d2d 0d0a 2020       -------..  
-00013f60: 2020 2020 2020 7365 6c66 203a 2073 7572        self : sur
-00013f70: 6661 6365 206f 626a 6563 740d 0a0d 0a20  face object.... 
-00013f80: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
-00013f90: 2020 2020 6966 2064 6972 6563 7469 6f6e      if direction
-00013fa0: 2069 7320 6e6f 7420 4e6f 6e65 3a0d 0a20   is not None:.. 
-00013fb0: 2020 2020 2020 2020 2020 2074 656d 7020             temp 
-00013fc0: 3d20 6469 7265 6374 696f 6e0d 0a20 2020  = direction..   
-00013fd0: 2020 2020 2020 2020 2074 7279 203a 2020           try :  
-00013fe0: 2320 6368 6563 6b20 6966 2064 6972 6563  # check if direc
-00013ff0: 7469 6f6e 2068 6f6c 6473 2074 6865 2065  tion holds the e
-00014000: 6c65 762c 2061 7a69 6d20 2869 652e 2033  lev, azim (ie. 3
-00014010: 4420 6178 6973 290d 0a20 2020 2020 2020  D axis)..       
-00014020: 2020 2020 2020 2020 2065 6c65 762c 617a           elev,az
-00014030: 696d 203d 2074 656d 702e 656c 6576 2c20  im = temp.elev, 
-00014040: 7465 6d70 2e61 7a69 6d0d 0a20 2020 2020  temp.azim..     
-00014050: 2020 2020 2020 2020 2020 2064 6972 6563             direc
-00014060: 7469 6f6e 203d 2065 6c65 765f 617a 696d  tion = elev_azim
-00014070: 5f32 7665 6374 6f72 2865 6c65 762c 617a  _2vector(elev,az
-00014080: 696d 290d 0a20 2020 2020 2020 2020 2020  im)..           
-00014090: 2065 7863 6570 7420 3a0d 0a20 2020 2020   except :..     
-000140a0: 2020 2020 2020 2020 2020 2064 6972 6563             direc
-000140b0: 7469 6f6e 203d 2074 656d 700d 0a20 2020  tion = temp..   
-000140c0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-000140d0: 6c65 6e28 6469 7265 6374 696f 6e29 2021  len(direction) !
-000140e0: 3d20 3320 3a0d 0a20 2020 2020 2020 2020  = 3 :..         
-000140f0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00014100: 2056 616c 7565 4572 726f 7228 2743 6d61   ValueError('Cma
-00014110: 7020 6672 6f6d 206e 6f72 6d61 6c73 2064  p from normals d
-00014120: 6972 6563 7469 6f6e 206d 7573 7420 6265  irection must be
-00014130: 2061 2061 7272 6179 206f 6620 6c65 6e67   a array of leng
-00014140: 7468 2033 2c20 6f72 2061 204d 6174 706c  th 3, or a Matpl
-00014150: 6f74 6c69 6220 4178 6573 3344 206f 626a  otlib Axes3D obj
-00014160: 6563 742e 2729 0d0a 2020 2020 2020 2020  ect.')..        
-00014170: 656c 7365 203a 2064 6972 6563 7469 6f6e  else : direction
-00014180: 203d 205f 494c 4c55 4d0d 0a0d 0a20 2020   = _ILLUM....   
-00014190: 2020 2020 2069 6620 636d 6170 2069 7320       if cmap is 
-000141a0: 6e6f 7420 4e6f 6e65 203a 0d0a 2020 2020  not None :..    
-000141b0: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-000141c0: 7461 6e63 6528 636d 6170 2c73 7472 2920  tance(cmap,str) 
-000141d0: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
-000141e0: 2020 2020 7365 6c66 2e73 6574 5f63 6d61      self.set_cma
-000141f0: 7028 636d 2e67 6574 5f63 6d61 7028 636d  p(cm.get_cmap(cm
-00014200: 6170 2929 0d0a 2020 2020 2020 2020 2020  ap))..          
-00014210: 2020 656c 7365 203a 0d0a 2020 2020 2020    else :..      
-00014220: 2020 2020 2020 2020 2020 7365 6c66 2e73            self.s
-00014230: 6574 5f63 6d61 7028 636d 6170 290d 0a20  et_cmap(cmap).. 
-00014240: 2020 2020 2020 2063 6d5f 636f 6c6f 724d         cm_colorM
-00014250: 6170 203d 2073 656c 662e 6765 745f 636d  ap = self.get_cm
-00014260: 6170 2829 0d0a 0d0a 2020 2020 2020 2020  ap()....        
-00014270: 7665 7274 7320 3d20 7365 6c66 2e76 6572  verts = self.ver
-00014280: 7465 7843 6f6f 725b 2073 656c 662e 6676  texCoor[ self.fv
-00014290: 496e 6469 6365 7320 5d0d 0a20 2020 2020  Indices ]..     
-000142a0: 2020 2066 766f 626a 203d 2073 656c 662e     fvobj = self.
-000142b0: 5f67 6574 5f66 6163 655f 6e6f 726d 616c  _get_face_normal
-000142c0: 7328 7665 7274 7329 0d0a 2020 2020 2020  s(verts)..      
-000142d0: 2020 634d 6170 203d 2073 656c 662e 5f67    cMap = self._g
-000142e0: 6574 436f 6c6f 724d 6170 5f66 726f 6d4e  etColorMap_fromN
-000142f0: 6f72 6d61 6c73 2866 766f 626a 2c20 636d  ormals(fvobj, cm
-00014300: 5f63 6f6c 6f72 4d61 702c 2064 6972 6563  _colorMap, direc
-00014310: 7469 6f6e 2c20 6973 4162 7329 0d0a 2020  tion, isAbs)..  
-00014320: 2020 2020 2020 7365 6c66 2e73 6574 5f63        self.set_c
-00014330: 6d61 7028 636d 5f63 6f6c 6f72 4d61 7029  map(cm_colorMap)
-00014340: 0d0a 2020 2020 2020 2020 7365 6c66 2e73  ..        self.s
-00014350: 6574 5f63 6f6c 6f72 2863 4d61 7029 0d0a  et_color(cMap)..
-00014360: 2020 2020 2020 2020 7365 6c66 2e69 7353          self.isS
-00014370: 7572 6661 6365 436f 6c6f 7265 6420 3d20  urfaceColored = 
-00014380: 5472 7565 0d0a 2020 2020 2020 2020 7365  True..        se
-00014390: 6c66 2e6f 6e6c 7943 6f6c 6f72 6564 4661  lf.onlyColoredFa
-000143a0: 6365 7320 3d20 5472 7565 0d0a 0d0a 2020  ces = True....  
-000143b0: 2020 2020 2020 7365 6c66 2e76 616c 7565        self.value
-000143c0: 734e 616d 6520 3d20 636e 616d 650d 0a20  sName = cname.. 
-000143d0: 2020 2020 2020 2023 203d 3d3d 3d3d 3d3d         # =======
-000143e0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000143f0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00014400: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00014410: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00014420: 3d0d 0a20 2020 2020 2020 2073 656c 662e  =..        self.
-00014430: 5f6d 6170 5f63 6d61 705f 6672 6f6d 5f6e  _map_cmap_from_n
-00014440: 6f72 6d61 6c73 5f76 6572 7428 2063 6d5f  ormals_vert( cm_
-00014450: 636f 6c6f 724d 6170 2c20 6469 7265 6374  colorMap, direct
-00014460: 696f 6e2c 2069 7341 6273 2029 0d0a 2020  ion, isAbs )..  
-00014470: 2020 2020 2020 2320 3d3d 3d3d 3d3d 3d3d        # ========
-00014480: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00014490: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000144a0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000144b0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000144c0: 0d0a 0d0a 2020 2020 2020 2020 7265 7475  ....        retu
-000144d0: 726e 2073 656c 660d 0a0d 0a20 2020 2064  rn self....    d
-000144e0: 6566 205f 6d61 705f 636d 6170 5f66 726f  ef _map_cmap_fro
-000144f0: 6d5f 6f70 5f76 6572 7428 7365 6c66 2c20  m_op_vert(self, 
-00014500: 6f70 6572 6174 696f 6e2c 2063 6d61 7029  operation, cmap)
-00014510: 203a 0d0a 2020 2020 2020 2020 0d0a 2020   :..        ..  
-00014520: 2020 2020 2020 7879 7a20 3d20 6e70 2e74        xyz = np.t
-00014530: 7261 6e73 706f 7365 2873 656c 662e 7665  ranspose(self.ve
-00014540: 7274 6578 436f 6f72 290d 0a20 2020 2020  rtexCoor)..     
-00014550: 2020 2023 202e 2e2e 2e2e 0d0a 2020 2020     # .......    
-00014560: 2020 2020 6162 6320 3d20 7365 6c66 2e63      abc = self.c
-00014570: 6f6f 725f 636f 6e76 6572 7428 7879 7a29  oor_convert(xyz)
-00014580: 0d0a 2020 2020 2020 2020 7620 3d20 6e70  ..        v = np
-00014590: 2e61 7272 6179 286f 7065 7261 7469 6f6e  .array(operation
-000145a0: 2861 6263 2929 0d0a 2020 2020 2020 2020  (abc))..        
-000145b0: 7365 6c66 2e76 6572 7465 7856 616c 7565  self.vertexValue
-000145c0: 7320 3d20 760d 0a20 2020 2020 2020 206e  s = v..        n
-000145d0: 6f72 6d20 3d20 636f 6c6f 7273 2e4e 6f72  orm = colors.Nor
-000145e0: 6d61 6c69 7a65 2876 6d69 6e3d 762e 6d69  malize(vmin=v.mi
-000145f0: 6e28 292c 766d 6178 3d76 2e6d 6178 2829  n(),vmax=v.max()
-00014600: 290d 0a20 2020 2020 2020 2063 6f6c 6f72  )..        color
-00014610: 4d61 7020 3d20 636d 6170 286e 6f72 6d28  Map = cmap(norm(
-00014620: 7629 290d 0a20 2020 2020 2020 2073 656c  v))..        sel
-00014630: 662e 7665 7274 6578 436f 6c6f 7220 3d20  f.vertexColor = 
-00014640: 636f 6c6f 724d 6170 0d0a 2020 2020 2020  colorMap..      
-00014650: 2020 636f 6c6f 724d 6170 203d 206e 702e    colorMap = np.
-00014660: 6172 7261 7928 636f 6c6f 724d 6170 290d  array(colorMap).
-00014670: 0a0d 0a20 2020 2020 2020 2073 656c 662e  ...        self.
-00014680: 5f62 6f75 6e64 735b 2776 6572 7476 6c69  _bounds['vertvli
-00014690: 6d27 5d20 3d20 5b20 762e 6d69 6e28 292c  m'] = [ v.min(),
-000146a0: 2076 2e6d 6178 2829 205d 0d0a 0d0a 2020   v.max() ]....  
-000146b0: 2020 2020 2020 7265 7475 726e 200d 0a0d        return ...
-000146c0: 0a20 2020 2064 6566 206d 6170 5f63 6d61  .    def map_cma
-000146d0: 705f 6672 6f6d 5f6f 7028 7365 6c66 2c20  p_from_op(self, 
-000146e0: 6f70 6572 6174 696f 6e3d 4e6f 6e65 2c20  operation=None, 
-000146f0: 636d 6170 3d4e 6f6e 652c 2063 6e61 6d65  cmap=None, cname
-00014700: 3d4e 6f6e 6529 203a 0d0a 2020 2020 2020  =None) :..      
-00014710: 2020 2222 220d 0a20 2020 2020 2020 2046    """..        F
-00014720: 756e 6374 696f 6e61 6c20 6173 7369 676e  unctional assign
-00014730: 6d65 6e74 206f 6620 6120 636f 6c6f 7220  ment of a color 
-00014740: 6672 6f6d 2061 2063 6f6c 6f72 206d 6170  from a color map
-00014750: 2e0d 0a0d 0a20 2020 2020 2020 2046 6163  .....        Fac
-00014760: 6520 636f 6f72 6469 6e61 7465 7320 6172  e coordinates ar
-00014770: 6520 7573 6564 2074 6f20 6361 6c63 756c  e used to calcul
-00014780: 6174 6520 6120 7363 616c 6172 200d 0a20  ate a scalar .. 
-00014790: 2020 2020 2020 2077 6869 6368 2069 7320         which is 
-000147a0: 7468 656e 2075 7365 6420 746f 2061 7373  then used to ass
-000147b0: 6967 6e20 6661 6365 2063 6f6c 6f72 7320  ign face colors 
-000147c0: 6672 6f6d 2061 0d0a 2020 2020 2020 2020  from a..        
-000147d0: 636f 6c6f 726d 6170 2e0d 0a0d 0a20 2020  colormap.....   
-000147e0: 2020 2020 2050 6172 616d 6574 6572 730d       Parameters.
-000147f0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00014800: 2d2d 2d0d 0a20 2020 2020 2020 206f 7065  ---..        ope
-00014810: 7261 7469 6f6e 203a 2066 756e 6374 696f  ration : functio
-00014820: 6e20 6f62 6a65 6374 2c20 6465 6661 756c  n object, defaul
-00014830: 7420 3a20 4e6f 6e65 0d0a 2020 2020 2020  t : None..      
-00014840: 2020 2020 2020 4675 6e63 7469 6f6e 2074        Function t
-00014850: 6861 7420 7461 6b65 7320 6f6e 6520 6172  hat takes one ar
-00014860: 6775 6d65 6e74 2c0d 0a20 2020 2020 2020  gument,..       
-00014870: 2020 2020 2061 2033 784e 204e 756d 7079       a 3xN Numpy
-00014880: 2061 7272 6179 206f 6620 6e61 7469 7665   array of native
-00014890: 2063 6f6f 7264 696e 6174 6573 2e0d 0a20   coordinates... 
-000148a0: 2020 2020 2020 2020 2020 2054 6865 2066             The f
-000148b0: 756e 6374 696f 6e20 7265 7475 726e 7320  unction returns 
-000148c0: 6120 4e75 6d70 7920 6172 7261 7920 6f66  a Numpy array of
-000148d0: 2073 6361 6c61 7220 7661 6c75 6573 2e0d   scalar values..
-000148e0: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
-000148f0: 6675 6e63 7469 6f6e 2069 7320 4e6f 6e65  function is None
-00014900: 2c20 6675 6e63 7469 6f6e 2077 696c 6c20  , function will 
-00014910: 6d61 7020 696e 2074 6865 207a 2d64 6972  map in the z-dir
-00014920: 6563 7469 6f6e 2e0d 0a0d 0a20 2020 2020  ection.....     
-00014930: 2020 2063 6d61 7020 3a20 7374 7220 6f72     cmap : str or
-00014940: 2043 6f6c 6f72 6d61 702c 206f 7074 696f   Colormap, optio
-00014950: 6e61 6c0d 0a20 2020 2020 2020 2020 2020  nal..           
-00014960: 2041 2043 6f6c 6f72 6d61 7020 696e 7374   A Colormap inst
-00014970: 616e 6365 206f 7220 7265 6769 7374 6572  ance or register
-00014980: 6564 2063 6f6c 6f72 6d61 7020 6e61 6d65  ed colormap name
-00014990: 2e0d 0a20 2020 2020 2020 2020 2020 2049  ...            I
-000149a0: 6620 6e6f 7420 6173 7369 676e 6564 2c20  f not assigned, 
-000149b0: 7468 6520 7375 7266 6163 6520 436f 6c6f  the surface Colo
-000149c0: 726d 6170 2069 7320 7573 6564 2e0d 0a20  rmap is used... 
-000149d0: 2020 2020 2020 2020 2020 2054 6865 2063             The c
-000149e0: 6f6c 6f72 6d61 7020 6d61 7073 2074 6865  olormap maps the
-000149f0: 2066 756e 6374 696f 6e20 7265 7475 726e   function return
-00014a00: 2076 616c 7565 7320 746f 2063 6f6c 6f72   values to color
-00014a10: 732e 0d0a 2020 2020 2020 2020 0d0a 2020  s...        ..  
-00014a20: 2020 2020 2020 636e 616d 6520 3a20 7374        cname : st
-00014a30: 7269 6e67 2c20 6f70 7469 6f6e 616c 2c20  ring, optional, 
-00014a40: 6465 6661 756c 743a 204e 6f6e 6520 6f72  default: None or
-00014a50: 206f 7020 6675 6e63 7469 6f6e 206e 616d   op function nam
-00014a60: 652e 0d0a 2020 2020 2020 2020 2020 2020  e...            
-00014a70: 4465 7363 7269 7074 6976 6520 6964 656e  Descriptive iden
-00014a80: 7469 6669 6572 2066 6f72 2076 616c 7565  tifier for value
-00014a90: 7320 696e 6469 6361 7465 6420 6279 2063  s indicated by c
-00014aa0: 6f6c 6f72 2e0d 0a0d 0a20 2020 2020 2020  olor.....       
-00014ab0: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
-00014ac0: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
-00014ad0: 2020 2073 656c 6620 3a20 7375 7266 6163     self : surfac
-00014ae0: 6520 6f62 6a65 6374 0d0a 0d0a 2020 2020  e object....    
-00014af0: 2020 2020 2222 220d 0a0d 0a20 2020 2020      """....     
-00014b00: 2020 2069 6620 6f70 6572 6174 696f 6e20     if operation 
-00014b10: 6973 204e 6f6e 6520 3a0d 0a20 2020 2020  is None :..     
-00014b20: 2020 2020 2020 206f 7065 7261 7469 6f6e         operation
-00014b30: 203d 206c 616d 6264 6120 6320 3a20 635b   = lambda c : c[
-00014b40: 325d 0d0a 0d0a 2020 2020 2020 2020 6966  2]....        if
-00014b50: 2063 6d61 7020 6973 206e 6f74 204e 6f6e   cmap is not Non
-00014b60: 6520 3a0d 0a20 2020 2020 2020 2020 2020  e :..           
-00014b70: 2069 6620 6973 696e 7374 616e 6365 2863   if isinstance(c
-00014b80: 6d61 702c 7374 7229 203a 200d 0a20 2020  map,str) : ..   
-00014b90: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00014ba0: 662e 7365 745f 636d 6170 2863 6d2e 6765  f.set_cmap(cm.ge
-00014bb0: 745f 636d 6170 2863 6d61 7029 290d 0a20  t_cmap(cmap)).. 
-00014bc0: 2020 2020 2020 2020 2020 2065 6c73 6520             else 
-00014bd0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00014be0: 2020 2073 656c 662e 7365 745f 636d 6170     self.set_cmap
-00014bf0: 2863 6d61 7029 0d0a 2020 2020 2020 2020  (cmap)..        
-00014c00: 636d 6170 203d 2073 656c 662e 6765 745f  cmap = self.get_
-00014c10: 636d 6170 2829 0d0a 0d0a 2020 2020 2020  cmap()....      
-00014c20: 2020 7665 7274 7320 3d20 7365 6c66 2e76    verts = self.v
-00014c30: 6572 7465 7843 6f6f 725b 2073 656c 662e  ertexCoor[ self.
-00014c40: 6676 496e 6469 6365 7320 5d0d 0a20 2020  fvIndices ]..   
-00014c50: 2020 2020 2066 6163 6543 656e 7465 7243       faceCenterC
-00014c60: 6f6f 7220 3d20 7365 6c66 2e5f 6765 745f  oor = self._get_
-00014c70: 6661 6365 5f63 656e 7465 7273 2876 6572  face_centers(ver
-00014c80: 7473 290d 0a20 2020 2020 2020 2078 797a  ts)..        xyz
-00014c90: 203d 206e 702e 7472 616e 7370 6f73 6528   = np.transpose(
-00014ca0: 6661 6365 4365 6e74 6572 436f 6f72 290d  faceCenterCoor).
-00014cb0: 0a20 2020 2020 2020 2023 202e 2e2e 2e2e  .        # .....
-00014cc0: 0d0a 2020 2020 2020 2020 6162 6320 3d20  ..        abc = 
-00014cd0: 7365 6c66 2e63 6f6f 725f 636f 6e76 6572  self.coor_conver
-00014ce0: 7428 7879 7a29 0d0a 2020 2020 2020 2020  t(xyz)..        
-00014cf0: 7620 3d20 6e70 2e61 7272 6179 286f 7065  v = np.array(ope
-00014d00: 7261 7469 6f6e 2861 6263 2929 0d0a 2020  ration(abc))..  
-00014d10: 2020 2020 2020 7365 6c66 2e66 6163 6556        self.faceV
-00014d20: 616c 7565 7320 3d20 760d 0a20 2020 2020  alues = v..     
-00014d30: 2020 2076 6d69 6e2c 2076 6d61 7820 3d20     vmin, vmax = 
-00014d40: 762e 6d69 6e28 292c 2076 2e6d 6178 2829  v.min(), v.max()
-00014d50: 0d0a 2020 2020 2020 2020 6e6f 726d 203d  ..        norm =
-00014d60: 2063 6f6c 6f72 732e 4e6f 726d 616c 697a   colors.Normaliz
-00014d70: 6528 766d 696e 3d76 2e6d 696e 2829 2c76  e(vmin=v.min(),v
-00014d80: 6d61 783d 762e 6d61 7828 2929 0d0a 2020  max=v.max())..  
-00014d90: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-00014da0: 636f 6c6f 724d 6170 203d 2063 6d61 7028  colorMap = cmap(
-00014db0: 6e6f 726d 2876 2929 0d0a 2020 2020 2020  norm(v))..      
-00014dc0: 2020 2320 4675 7444 6576 3a20 7365 745f    # FutDev: set_
-00014dd0: 636f 6c6f 7220 7573 6564 2069 6e73 7465  color used inste
-00014de0: 6164 206f 6620 7365 745f 6661 6365 636f  ad of set_faceco
-00014df0: 6c6f 7220 746f 2065 6c69 6d69 6e61 7465  lor to eliminate
-00014e00: 2027 6761 7073 2720 6265 7477 6565 6e20   'gaps' between 
-00014e10: 6661 6365 732c 0d0a 2020 2020 2020 2020  faces,..        
-00014e20: 2320 686f 7765 7665 722c 2073 6574 5f65  # however, set_e
-00014e30: 6467 6563 6f6c 6f72 2072 6571 7569 7265  dgecolor require
-00014e40: 6420 6166 7465 7220 696c 6c75 6d69 6e61  d after illumina
-00014e50: 7469 6f6e 2069 6620 6564 6765 7320 6172  tion if edges ar
-00014e60: 6520 746f 2062 6520 6469 7370 6c61 7965  e to be displaye
-00014e70: 642e 0d0a 2020 2020 2020 2020 2320 484f  d...        # HO
-00014e80: 5745 5645 5220 2121 2121 2020 6966 2063  WEVER !!!!  if c
-00014e90: 6f6c 6f72 4d61 7020 6861 7320 6120 616c  olorMap has a al
-00014ea0: 7068 613c 312c 2074 6865 7365 2064 6f6e  pha<1, these don
-00014eb0: 2774 2072 6567 6973 7465 7220 7769 7468  't register with
-00014ec0: 2074 6865 2065 6467 6573 2e0d 0a20 2020   the edges...   
-00014ed0: 2020 2020 2073 656c 662e 7365 745f 636f       self.set_co
-00014ee0: 6c6f 7228 636f 6c6f 724d 6170 290d 0a20  lor(colorMap).. 
-00014ef0: 2020 2020 2020 2073 656c 662e 6973 5375         self.isSu
-00014f00: 7266 6163 6543 6f6c 6f72 6564 203d 2054  rfaceColored = T
-00014f10: 7275 650d 0a20 2020 2020 2020 2073 656c  rue..        sel
-00014f20: 662e 5f62 6f75 6e64 735b 2776 6c69 6d27  f._bounds['vlim'
-00014f30: 5d20 3d20 5b20 766d 696e 2c20 766d 6178  ] = [ vmin, vmax
-00014f40: 205d 200d 0a0d 0a20 2020 2020 2020 2063   ] ....        c
-00014f50: 6e61 6d65 203d 205f 6765 7446 756e 6374  name = _getFunct
-00014f60: 696f 6e4e 616d 6528 6f70 6572 6174 696f  ionName(operatio
-00014f70: 6e2c 636e 616d 6529 0d0a 2020 2020 2020  n,cname)..      
-00014f80: 2020 6966 2063 6e61 6d65 2069 7320 6e6f    if cname is no
-00014f90: 7420 4e6f 6e65 203a 2073 656c 662e 7661  t None : self.va
-00014fa0: 6c75 6573 4e61 6d65 203d 2063 6e61 6d65  luesName = cname
-00014fb0: 0d0a 2020 2020 2020 2020 2320 3d3d 3d3d  ..        # ====
-00014fc0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00014fd0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00014fe0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00014ff0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00015000: 3d3d 3d3d 0d0a 2020 2020 2020 2020 7365  ====..        se
-00015010: 6c66 2e5f 6d61 705f 636d 6170 5f66 726f  lf._map_cmap_fro
-00015020: 6d5f 6f70 5f76 6572 7428 6f70 6572 6174  m_op_vert(operat
-00015030: 696f 6e2c 2063 6d61 7029 0d0a 2020 2020  ion, cmap)..    
-00015040: 2020 2020 2320 3d3d 3d3d 3d3d 3d3d 3d3d      # ==========
-00015050: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00015060: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00015070: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00015080: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a  ==============..
-00015090: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-000150a0: 2020 7265 7475 726e 2073 656c 660d 0a0d    return self...
-000150b0: 0a20 2020 2064 6566 206d 6170 5f67 656f  .    def map_geo
-000150c0: 6d5f 6672 6f6d 5f64 6174 6167 7269 6428  m_from_datagrid(
-000150d0: 7365 6c66 2c64 6174 6167 7269 642c 2073  self,datagrid, s
-000150e0: 6361 6c65 3d31 2e30 2c20 7669 6577 706f  cale=1.0, viewpo
-000150f0: 7274 3d4e 6f6e 652c 206e 616d 653d 4e6f  rt=None, name=No
-00015100: 6e65 2029 203a 0d0a 2020 2020 2020 2020  ne ) :..        
-00015110: 2222 220d 0a20 2020 2020 2020 2041 7070  """..        App
-00015120: 656e 6420 7375 7266 6163 6520 7665 7274  end surface vert
-00015130: 6963 6573 2070 726f 706f 7274 696f 6e61  ices proportiona
-00015140: 6c20 746f 2032 4420 6461 7461 6772 6964  l to 2D datagrid
-00015150: 2073 7572 6661 6365 2e0d 0a20 2020 2020   surface...     
-00015160: 2020 200d 0a20 2020 2020 2020 2044 6174     ..        Dat
-00015170: 6167 7269 6420 7661 6c75 6573 2061 7265  agrid values are
-00015180: 206e 6f72 6d61 6c69 7a65 6420 696e 2074   normalized in t
-00015190: 6865 2072 616e 6765 2030 2074 6f20 312e  he range 0 to 1.
-000151a0: 0d0a 0d0a 2020 2020 2020 2020 5468 6973  ....        This
-000151b0: 206d 6574 686f 6420 6973 206e 6f74 2061   method is not a
-000151c0: 7661 696c 6162 6c65 2066 6f72 2063 6f6d  vailable for com
-000151d0: 706f 7369 7465 2073 7572 6661 6365 732e  posite surfaces.
-000151e0: 0d0a 2020 2020 2020 2020 5468 6520 656e  ..        The en
-000151f0: 7469 7265 2064 6174 6167 7269 6420 646f  tire datagrid do
-00015200: 6d61 696e 2069 7320 6170 706c 6965 6420  main is applied 
-00015210: 746f 2074 6865 2067 656f 6d65 7472 6963  to the geometric
-00015220: 206f 7065 7261 7469 6f6e 2e0d 0a0d 0a20   operation..... 
-00015230: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-00015240: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
-00015250: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2064  -----..        d
-00015260: 6174 6167 7269 6420 3a20 3244 2061 7272  atagrid : 2D arr
-00015270: 6179 0d0a 0d0a 2020 2020 2020 2020 7363  ay....        sc
-00015280: 616c 6520 3a20 6e75 6d62 6572 2c20 6f70  ale : number, op
-00015290: 7469 6f6e 616c 2c20 6465 6661 756c 743a  tional, default:
-000152a0: 2031 0d0a 0d0a 2020 2020 2020 2020 7669   1....        vi
-000152b0: 6577 706f 7274 203a 2034 4420 6172 7261  ewport : 4D arra
-000152c0: 792d 6c69 6b65 2c20 6f70 7469 6f6e 616c  y-like, optional
-000152d0: 2c20 6465 6661 756c 743a 204e 6f6e 650d  , default: None.
-000152e0: 0a20 2020 2020 2020 2020 2020 2056 6965  .            Vie
-000152f0: 7770 6f72 7420 6465 6669 6e65 7320 7468  wport defines th
-00015300: 6520 7375 6264 6f6d 6169 6e20 6f66 2074  e subdomain of t
-00015310: 6865 2073 7572 6661 6365 206f 6e74 6f20  he surface onto 
-00015320: 7768 6963 680d 0a20 2020 2020 2020 2020  which..         
-00015330: 2020 2074 6865 2064 6174 6167 7269 6420     the datagrid 
-00015340: 6973 206d 6170 7065 642e 2020 5468 6520  is mapped.  The 
-00015350: 7375 6264 6f6d 6169 6e20 6973 2073 6574  subdomain is set
-00015360: 2062 7920 6e6f 726d 616c 697a 6564 0d0a   by normalized..
-00015370: 2020 2020 2020 2020 2020 2020 6e61 7469              nati
-00015380: 7665 2073 7572 6661 6365 2063 6f6f 7264  ve surface coord
-00015390: 696e 6174 6573 2069 6e20 6120 3444 2061  inates in a 4D a
-000153a0: 7272 6179 2e0d 0a20 2020 2020 2020 2020  rray...         
-000153b0: 2020 2054 6865 2065 6e74 6972 6520 7375     The entire su
-000153c0: 7266 6163 6520 6973 2067 656f 6d65 7472  rface is geometr
-000153d0: 6963 616c 6c79 206d 6170 7065 6420 666f  ically mapped fo
-000153e0: 7220 7468 6520 6465 6661 756c 7420 6f66  r the default of
-000153f0: 204e 6f6e 652e 0d0a 2020 2020 2020 2020   None...        
-00015400: 0d0a 2020 2020 2020 2020 6e61 6d65 203a  ..        name :
-00015410: 2073 7472 696e 672c 206f 7074 696f 6e61   string, optiona
-00015420: 6c2c 2064 6566 6175 6c74 3a20 4e6f 6e65  l, default: None
-00015430: 0d0a 2020 2020 2020 2020 2020 2020 4465  ..            De
-00015440: 7363 7269 7074 6976 6520 6964 656e 7469  scriptive identi
-00015450: 6669 6572 2066 6f72 2074 6865 2067 656f  fier for the geo
-00015460: 6d65 7472 792e 0d0a 0d0a 2020 2020 2020  metry.....      
-00015470: 2020 5265 7475 726e 730d 0a20 2020 2020    Returns..     
-00015480: 2020 202d 2d2d 2d2d 2d2d 0d0a 2020 2020     -------..    
-00015490: 2020 2020 7365 6c66 203a 2073 7572 6661      self : surfa
-000154a0: 6365 206f 626a 6563 740d 0a0d 0a20 2020  ce object....   
-000154b0: 2020 2020 2022 2222 0d0a 0d0a 2020 2020       """....    
-000154c0: 2020 2020 6966 2073 656c 662e 5f69 7343      if self._isC
-000154d0: 6f6d 706f 7369 7465 5375 7266 6163 6520  ompositeSurface 
-000154e0: 3a0d 0a20 2020 2020 2020 2020 2020 2077  :..            w
-000154f0: 6172 6e69 6e67 732e 7761 726e 2827 4461  arnings.warn('Da
-00015500: 7461 6772 6964 206f 7065 7261 7469 6f6e  tagrid operation
-00015510: 206e 6f74 2061 7661 696c 6162 6c65 2066   not available f
-00015520: 6f72 2063 6f6d 6269 6e65 6420 7368 6170  or combined shap
-00015530: 6573 2e27 290d 0a20 2020 2020 2020 2020  es.')..         
-00015540: 2020 2072 6574 7572 6e20 7365 6c66 0d0a     return self..
-00015550: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00015560: 5f73 7572 6661 6365 5368 6170 6543 6861  _surfaceShapeCha
-00015570: 6e67 6564 203a 0d0a 2020 2020 2020 2020  nged :..        
-00015580: 2020 2020 2377 6172 6e69 6e67 732e 7761      #warnings.wa
-00015590: 726e 2827 4461 7461 6772 6964 206f 7065  rn('Datagrid ope
-000155a0: 7261 7469 6f6e 206d 6179 2062 6520 616e  ration may be an
-000155b0: 6f6d 616c 6f75 7320 6166 7465 7220 7368  omalous after sh
-000155c0: 6170 6520 6d6f 6469 6669 6361 7469 6f6e  ape modification
-000155d0: 2e27 290d 0a20 2020 2020 2020 2020 2020  .')..           
-000155e0: 2077 6172 6e69 6e67 732e 7761 726e 2827   warnings.warn('
-000155f0: 4461 7461 6772 6964 206f 7065 7261 7469  Datagrid operati
-00015600: 6f6e 206e 6f74 2061 7661 696c 6162 6c65  on not available
-00015610: 2061 6674 6572 2073 6861 7065 206d 6f64   after shape mod
-00015620: 6966 6963 6174 696f 6e2e 2729 0d0a 2020  ification.')..  
-00015630: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00015640: 2073 656c 660d 0a0d 0a20 2020 2020 2020   self....       
-00015650: 2061 2c62 2c69 6e56 6965 7770 6f72 7420   a,b,inViewport 
-00015660: 3d20 7365 6c66 2e5f 7669 6577 706f 7274  = self._viewport
-00015670: 436f 6f72 2873 656c 662e 7665 7274 6578  Coor(self.vertex
-00015680: 436f 6f72 2c76 6965 7770 6f72 7429 0d0a  Coor,viewport)..
-00015690: 0d0a 2020 2020 2020 2020 6461 7461 203d  ..        data =
-000156a0: 2064 6174 6167 7269 640d 0a20 2020 2020   datagrid..     
-000156b0: 2020 2064 6d61 7820 3d20 6e70 2e61 6d61     dmax = np.ama
-000156c0: 7828 6461 7461 6772 6964 290d 0a20 2020  x(datagrid)..   
-000156d0: 2020 2020 2064 6d69 6e20 3d20 6e70 2e61       dmin = np.a
-000156e0: 6d69 6e28 6461 7461 6772 6964 290d 0a20  min(datagrid).. 
-000156f0: 2020 2020 2020 2064 656c 7461 203d 2064         delta = d
-00015700: 6d61 782d 646d 696e 0d0a 2020 2020 2020  max-dmin..      
-00015710: 2020 6461 7461 203d 2028 6461 7461 6772    data = (datagr
-00015720: 6964 202d 2064 6d69 6e29 2f64 656c 7461  id - dmin)/delta
-00015730: 0d0a 2020 2020 2020 2020 7864 203d 206e  ..        xd = n
-00015740: 702e 6c69 6e73 7061 6365 2830 2c20 312c  p.linspace(0, 1,
-00015750: 2064 6174 612e 7368 6170 655b 305d 2029   data.shape[0] )
-00015760: 0d0a 2020 2020 2020 2020 7964 203d 206e  ..        yd = n
-00015770: 702e 6c69 6e73 7061 6365 2830 2c20 312c  p.linspace(0, 1,
-00015780: 2064 6174 612e 7368 6170 655b 315d 2029   data.shape[1] )
-00015790: 0d0a 2020 2020 2020 2020 6720 3d20 2069  ..        g =  i
-000157a0: 6e74 6572 706f 6c61 7465 2e69 6e74 6572  nterpolate.inter
-000157b0: 7032 6428 7964 2c20 7864 2c20 6461 7461  p2d(yd, xd, data
-000157c0: 2c20 6b69 6e64 3d27 6375 6269 6327 290d  , kind='cubic').
-000157d0: 0a0d 0a20 2020 2020 2020 2023 2046 7574  ...        # Fut
-000157e0: 4465 763a 206f 7074 696d 697a 6520 6566  Dev: optimize ef
-000157f0: 6669 6369 656e 6379 2028 3f29 2e0d 0a20  ficiency (?)... 
-00015800: 2020 2020 2020 2064 203d 205b 5d0d 0a20         d = [].. 
-00015810: 2020 2020 2020 2066 6f72 2061 6220 696e         for ab in
-00015820: 206e 702e 7472 616e 7370 6f73 6528 5b61   np.transpose([a
-00015830: 2c62 5d29 203a 0d0a 2020 2020 2020 2020  ,b]) :..        
-00015840: 2020 2020 642e 6170 7065 6e64 2820 6728      d.append( g(
-00015850: 6162 5b30 5d2c 6162 5b31 5d29 5b30 5d20  ab[0],ab[1])[0] 
-00015860: 290d 0a20 2020 2020 2020 2064 203d 206e  )..        d = n
-00015870: 702e 7768 6572 6528 696e 5669 6577 706f  p.where(inViewpo
-00015880: 7274 2c64 2c6e 702e 7a65 726f 7328 6c65  rt,d,np.zeros(le
-00015890: 6e28 6429 2929 0d0a 2020 2020 2020 2020  n(d)))..        
-000158a0: 6420 3d20 645b 3a2c 206e 702e 6e65 7761  d = d[:, np.newa
-000158b0: 7869 735d 0d0a 0d0a 2020 2020 2020 2020  xis]....        
-000158c0: 2320 4675 7444 6576 3a20 2766 5661 6c27  # FutDev: 'fVal'
-000158d0: 206f 6e6c 7920 6170 706c 6963 6162 6c65   only applicable
-000158e0: 2066 6f72 2069 6e69 7469 616c 2073 7562   for initial sub
-000158f0: 636c 6173 7365 640d 0a20 2020 2020 2020  classed..       
-00015900: 2023 2073 7572 6661 6365 7320 746f 2067   # surfaces to g
-00015910: 6574 2073 7572 6661 6365 206e 6f72 6d61  et surface norma
-00015920: 6c73 2061 7420 6120 7665 7274 6578 2e0d  ls at a vertex..
-00015930: 0a20 2020 2020 2020 2023 2046 7574 7572  .        # Futur
-00015940: 6520 776f 726b 3a20 746f 206d 616b 6520  e work: to make 
-00015950: 7468 6973 2067 656e 6572 6963 2066 6f72  this generic for
-00015960: 2061 6e79 2073 7572 6661 6365 2e0d 0a20   any surface... 
-00015970: 2020 2020 2020 2066 5661 6c20 3d20 6e70         fVal = np
-00015980: 2e61 7272 6179 285b 302e 2c30 2e2c 312e  .array([0.,0.,1.
-00015990: 5d29 0d0a 2020 2020 2020 2020 6966 2073  ])..        if s
-000159a0: 656c 662e 6469 7370 5f56 6563 746f 7220  elf.disp_Vector 
-000159b0: 6973 206e 6f74 204e 6f6e 6520 3a0d 0a20  is not None :.. 
-000159c0: 2020 2020 2020 2020 2020 2066 5661 6c20             fVal 
-000159d0: 3d20 7365 6c66 2e76 6572 7465 7843 6f6f  = self.vertexCoo
-000159e0: 722a 7365 6c66 2e64 6973 705f 5665 6374  r*self.disp_Vect
-000159f0: 6f72 0d0a 0d0a 2020 2020 2020 2020 7620  or....        v 
-00015a00: 3d20 2073 656c 662e 7665 7274 6578 436f  =  self.vertexCo
-00015a10: 6f72 202b 2073 6361 6c65 2a64 2a66 5661  or + scale*d*fVa
-00015a20: 6c0d 0a20 2020 2020 2020 2076 6572 7473  l..        verts
-00015a30: 203d 2076 5b73 656c 662e 6676 496e 6469   = v[self.fvIndi
-00015a40: 6365 735d 0d0a 2020 2020 2020 2020 7365  ces]..        se
-00015a50: 6c66 2e76 6572 7465 7843 6f6f 7220 3d20  lf.vertexCoor = 
-00015a60: 760d 0a20 2020 2020 2020 2073 656c 662e  v..        self.
-00015a70: 5f73 6574 5f67 656f 6d65 7472 6963 5f62  _set_geometric_b
-00015a80: 6f75 6e64 7328 290d 0a20 2020 2020 2020  ounds()..       
-00015a90: 2073 656c 662e 7365 745f 7665 7274 7328   self.set_verts(
-00015aa0: 2076 6572 7473 2029 0d0a 2020 2020 2020   verts )..      
-00015ab0: 2020 7365 6c66 2e5f 7375 7266 6163 6553    self._surfaceS
-00015ac0: 6861 7065 4368 616e 6765 6420 3d20 5472  hapeChanged = Tr
-00015ad0: 7565 0d0a 2020 2020 2020 2020 6966 206e  ue..        if n
-00015ae0: 616d 6520 6973 206e 6f74 204e 6f6e 653a  ame is not None:
-00015af0: 2073 656c 662e 5f67 656f 6d4e 616d 6520   self._geomName 
-00015b00: 3d20 6e61 6d65 0d0a 2020 2020 2020 2020  = name..        
-00015b10: 7265 7475 726e 2073 656c 660d 0a0d 0a20  return self.... 
-00015b20: 2020 2064 6566 206d 6170 5f67 656f 6d5f     def map_geom_
-00015b30: 6672 6f6d 5f69 6d61 6765 2873 656c 662c  from_image(self,
-00015b40: 2066 6e61 6d65 2c20 7363 616c 653d 312e   fname, scale=1.
-00015b50: 302c 2076 6965 7770 6f72 743d 4e6f 6e65  0, viewport=None
-00015b60: 2c20 6372 6566 3d27 7627 2c20 687a 6572  , cref='v', hzer
-00015b70: 6f3d 302c 206e 616d 653d 4e6f 6e65 2029  o=0, name=None )
-00015b80: 203a 0d0a 2020 2020 2020 2020 2222 220d   :..        """.
-00015b90: 0a20 2020 2020 2020 2041 7070 656e 6420  .        Append 
-00015ba0: 7375 7266 6163 6520 7665 7274 6963 6573  surface vertices
-00015bb0: 2070 726f 706f 7274 696f 6e61 6c20 746f   proportional to
-00015bc0: 2069 6d61 6765 2063 6f6c 6f72 2063 6f6d   image color com
-00015bd0: 706f 6e65 6e74 2076 616c 7565 732e 0d0a  ponent values...
-00015be0: 0d0a 2020 2020 2020 2020 466f 7220 706c  ..        For pl
-00015bf0: 616e 6172 2061 6e64 2070 6f6c 6172 2063  anar and polar c
-00015c00: 6f6f 7264 696e 6174 6573 2c20 7468 6520  oordinates, the 
-00015c10: 7a2d 636f 6f72 6469 6e61 7465 2069 7320  z-coordinate is 
-00015c20: 6170 7065 6e64 6564 2e0d 0a20 2020 2020  appended...     
-00015c30: 2020 2046 6f72 2063 796c 696e 6472 6963     For cylindric
-00015c40: 616c 2061 6e64 2073 7068 6572 6963 616c  al and spherical
-00015c50: 2063 6f6f 7264 696e 6174 6573 2c20 7468   coordinates, th
-00015c60: 6520 722d 636f 6f72 6469 6e61 7465 2069  e r-coordinate i
-00015c70: 7320 6170 7065 6e64 6564 2e0d 0a0d 0a20  s appended..... 
-00015c80: 2020 2020 2020 2054 6869 7320 6d65 7468         This meth
-00015c90: 6f64 2069 7320 6e6f 7420 6176 6169 6c61  od is not availa
-00015ca0: 626c 6520 666f 7220 636f 6d70 6f73 6974  ble for composit
-00015cb0: 6520 7375 7266 6163 6573 2e0d 0a20 2020  e surfaces...   
-00015cc0: 2020 2020 2054 6865 2065 6e74 6972 6520       The entire 
-00015cd0: 696d 6167 6520 646f 6d61 696e 2069 7320  image domain is 
-00015ce0: 6170 706c 6965 6420 746f 2074 6865 2067  applied to the g
-00015cf0: 656f 6d65 7472 6963 206f 7065 7261 7469  eometric operati
-00015d00: 6f6e 2e0d 0a0d 0a20 2020 2020 2020 2050  on.....        P
-00015d10: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
-00015d20: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
-00015d30: 2020 2020 2020 2066 6e61 6d65 203a 2073         fname : s
-00015d40: 7472 206f 7220 6669 6c65 2d6c 696b 650d  tr or file-like.
-00015d50: 0a20 2020 2020 2020 2020 2020 2054 6865  .            The
-00015d60: 2069 6d61 6765 2066 696c 6520 746f 2072   image file to r
-00015d70: 6561 643a 2061 2066 696c 656e 616d 652c  ead: a filename,
-00015d80: 2061 2055 524c 206f 7220 6120 6669 6c65   a URL or a file
-00015d90: 2d6c 696b 6520 6f62 6a65 6374 206f 7065  -like object ope
-00015da0: 6e65 640d 0a20 2020 2020 2020 2020 2020  ned..           
-00015db0: 2069 6e20 7265 6164 2d62 696e 6172 7920   in read-binary 
-00015dc0: 6d6f 6465 2e20 2043 7572 7265 6e74 6c79  mode.  Currently
-00015dd0: 2072 6573 7472 6963 7465 6420 746f 2050   restricted to P
-00015de0: 4e47 2066 6f72 6d61 742e 0d0a 0d0a 2020  NG format.....  
-00015df0: 2020 2020 2020 7363 616c 6520 3a20 6e75        scale : nu
-00015e00: 6d62 6572 0d0a 0d0a 2020 2020 2020 2020  mber....        
-00015e10: 6372 6566 203a 207b 2772 272c 2767 272c  cref : {'r','g',
-00015e20: 2762 272c 2768 272c 2773 272c 2776 277d  'b','h','s','v'}
-00015e30: 2c20 6f70 7469 6f6e 616c 2c20 6465 6661  , optional, defa
-00015e40: 756c 743a 2027 7627 0d0a 2020 2020 2020  ult: 'v'..      
-00015e50: 2020 2020 2020 5365 7473 2077 6869 6368        Sets which
-00015e60: 2063 6f6c 6f72 2074 7570 6c65 2076 616c   color tuple val
-00015e70: 7565 2074 6f20 7573 6520 666f 7220 6765  ue to use for ge
-00015e80: 6f6d 6574 7279 206d 6170 7069 6e67 2e0d  ometry mapping..
-00015e90: 0a20 2020 2020 2020 2020 2020 204e 6f74  .            Not
-00015ea0: 653a 206f 6e6c 7920 7468 6520 6669 7273  e: only the firs
-00015eb0: 7420 6368 6172 6163 7465 7220 6f66 2074  t character of t
-00015ec0: 6865 2073 7472 696e 6720 6973 2065 7661  he string is eva
-00015ed0: 6c75 6174 6564 2e0d 0a0d 0a20 2020 2020  luated.....     
-00015ee0: 2020 2068 7a65 726f 203a 206e 756d 6265     hzero : numbe
-00015ef0: 7220 6f72 204e 6f6e 652c 206f 7074 696f  r or None, optio
-00015f00: 6e61 6c2c 2064 6566 6175 6c74 3a20 300d  nal, default: 0.
-00015f10: 0a20 2020 2020 2020 2020 2020 2041 7267  .            Arg
-00015f20: 756d 656e 7420 6973 2075 7365 6420 6966  ument is used if
-00015f30: 2063 7265 6620 6973 2073 6574 2074 6f20   cref is set to 
-00015f40: 2768 272e 0d0a 2020 2020 2020 2020 2020  'h'...          
-00015f50: 2020 5468 6520 687a 6572 6f20 6d61 676e    The hzero magn
-00015f60: 6974 7564 6520 696e 6469 6361 7465 7320  itude indicates 
-00015f70: 7468 6520 4875 6520 7661 6c75 6520 666f  the Hue value fo
-00015f80: 7220 6120 7a65 726f 2063 6f6f 7264 696e  r a zero coordin
-00015f90: 6174 650d 0a20 2020 2020 2020 2020 2020  ate..           
-00015fa0: 2064 6970 6c61 6365 6d65 6e74 2e20 5468   diplacement. Th
-00015fb0: 6520 687a 6572 6f20 7369 676e 2028 706f  e hzero sign (po
-00015fc0: 7369 7469 7665 206f 7220 6e65 6761 7469  sitive or negati
-00015fd0: 7665 292c 0d0a 2020 2020 2020 2020 2020  ve),..          
-00015fe0: 2020 696e 6469 6361 7465 7320 7468 6520    indicates the 
-00015ff0: 6469 7265 6374 696f 6e20 6f66 2069 6e63  direction of inc
-00016000: 7265 6173 696e 6720 7661 6c75 6520 696e  reasing value in
-00016010: 2074 6865 0d0a 2020 2020 2020 2020 2020   the..          
-00016020: 2020 6170 7065 6e64 6564 2063 6f6f 7264    appended coord
-00016030: 696e 6174 6520 7769 7468 2068 7565 2076  inate with hue v
-00016040: 616c 7565 2e20 2052 616e 6765 206f 6620  alue.  Range of 
-00016050: 687a 6572 6f20 6973 205b 2d31 2c31 5d2e  hzero is [-1,1].
-00016060: 0d0a 0d0a 2020 2020 2020 2020 7669 6577  ....        view
-00016070: 706f 7274 203a 2034 4420 6172 7261 792d  port : 4D array-
-00016080: 6c69 6b65 2c20 6f70 7469 6f6e 616c 2c20  like, optional, 
-00016090: 6465 6661 756c 743a 204e 6f6e 650d 0a20  default: None.. 
-000160a0: 2020 2020 2020 2020 2020 2056 6965 7770             Viewp
-000160b0: 6f72 7420 6465 6669 6e65 7320 7468 6520  ort defines the 
-000160c0: 7375 6264 6f6d 6169 6e20 6f66 2074 6865  subdomain of the
-000160d0: 2073 7572 6661 6365 206f 6e74 6f20 7768   surface onto wh
-000160e0: 6963 680d 0a20 2020 2020 2020 2020 2020  ich..           
-000160f0: 2074 6865 2069 6d61 6765 2069 7320 6d61   the image is ma
-00016100: 7070 6564 2e20 2054 6865 2073 7562 646f  pped.  The subdo
-00016110: 6d61 696e 2069 7320 7365 7420 6279 206e  main is set by n
-00016120: 6f72 6d61 6c69 7a65 640d 0a20 2020 2020  ormalized..     
-00016130: 2020 2020 2020 206e 6174 6976 6520 7375         native su
-00016140: 7266 6163 6520 636f 6f72 6469 6e61 7465  rface coordinate
-00016150: 7320 696e 2061 2034 4420 6172 7261 792e  s in a 4D array.
-00016160: 0d0a 2020 2020 2020 2020 2020 2020 5468  ..            Th
-00016170: 6520 656e 7469 7265 2073 7572 6661 6365  e entire surface
-00016180: 2069 7320 6765 6f6d 6574 7269 6361 6c6c   is geometricall
-00016190: 7920 6d61 7070 6564 2066 6f72 2074 6865  y mapped for the
-000161a0: 2064 6566 6175 6c74 206f 6620 4e6f 6e65   default of None
-000161b0: 2e0d 0a0d 0a20 2020 2020 2020 206e 616d  .....        nam
-000161c0: 6520 3a20 7374 7269 6e67 2c20 6f70 7469  e : string, opti
-000161d0: 6f6e 616c 2c20 6465 6661 756c 743a 204e  onal, default: N
-000161e0: 6f6e 650d 0a20 2020 2020 2020 2020 2020  one..           
-000161f0: 2044 6573 6372 6970 7469 7665 2069 6465   Descriptive ide
-00016200: 6e74 6966 6965 7220 666f 7220 7468 6520  ntifier for the 
-00016210: 6765 6f6d 6574 7279 2e0d 0a0d 0a20 2020  geometry.....   
-00016220: 2020 2020 2052 6574 7572 6e73 0d0a 2020       Returns..  
-00016230: 2020 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20        -------.. 
-00016240: 2020 2020 2020 2073 656c 6620 3a20 7375         self : su
-00016250: 7266 6163 6520 6f62 6a65 6374 0d0a 0d0a  rface object....
-00016260: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
-00016270: 2020 2020 2023 202e 2e2e 2e2e 2e2e 2e2e       # .........
-00016280: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00016290: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-000162a0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-000162b0: 2e2e 2e2e 2e0d 0a20 2020 2020 2020 2064  .......        d
-000162c0: 6566 2067 6574 496e 6465 7828 6372 6566  ef getIndex(cref
-000162d0: 2920 3a0d 0a20 2020 2020 2020 2020 2020  ) :..           
-000162e0: 2063 7265 6620 3d20 6372 6566 5b30 5d2e   cref = cref[0].
-000162f0: 6c6f 7765 7228 290d 0a20 2020 2020 2020  lower()..       
-00016300: 2020 2020 2076 616c 496e 6465 7820 3d20       valIndex = 
-00016310: 2772 6762 6873 7627 2e66 696e 6428 6372  'rgbhsv'.find(cr
-00016320: 6566 290d 0a20 2020 2020 2020 2020 2020  ef)..           
-00016330: 2069 6620 7661 6c49 6e64 6578 203c 2030   if valIndex < 0
-00016340: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
-00016350: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-00016360: 7272 6f72 2827 496e 7661 6c69 6420 6372  rror('Invalid cr
-00016370: 6566 2061 7267 756d 656e 743a 2027 202b  ef argument: ' +
-00016380: 2073 7472 2863 7265 6629 290d 0a20 2020   str(cref))..   
-00016390: 2020 2020 2020 2020 2069 7348 5356 203d           isHSV =
-000163a0: 2046 616c 7365 0d0a 2020 2020 2020 2020   False..        
-000163b0: 2020 2020 6966 2076 616c 496e 6465 7820      if valIndex 
-000163c0: 3e20 3220 3a0d 0a20 2020 2020 2020 2020  > 2 :..         
-000163d0: 2020 2020 2020 2076 616c 496e 6465 7820         valIndex 
-000163e0: 2d3d 2033 0d0a 2020 2020 2020 2020 2020  -= 3..          
-000163f0: 2020 2020 2020 6973 4853 5620 3d20 5472        isHSV = Tr
-00016400: 7565 0d0a 2020 2020 2020 2020 2020 2020  ue..            
-00016410: 7265 7475 726e 2076 616c 496e 6465 782c  return valIndex,
-00016420: 2069 7348 5356 0d0a 2020 2020 2020 2020   isHSV..        
-00016430: 2320 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  # ..............
-00016440: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00016450: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00016460: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00016470: 0d0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
-00016480: 662e 5f69 7343 6f6d 706f 7369 7465 5375  f._isCompositeSu
-00016490: 7266 6163 6520 3a0d 0a20 2020 2020 2020  rface :..       
-000164a0: 2020 2020 2077 6172 6e69 6e67 732e 7761       warnings.wa
-000164b0: 726e 2827 496d 6167 6520 6f70 6572 6174  rn('Image operat
-000164c0: 696f 6e20 6e6f 7420 6176 6169 6c61 626c  ion not availabl
-000164d0: 6520 666f 7220 636f 6d62 696e 6564 2073  e for combined s
-000164e0: 6861 7065 732e 2729 0d0a 2020 2020 2020  hapes.')..      
-000164f0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00016500: 660d 0a20 2020 2020 2020 2069 6620 7365  f..        if se
-00016510: 6c66 2e5f 7375 7266 6163 6553 6861 7065  lf._surfaceShape
-00016520: 4368 616e 6765 6420 3a0d 0a20 2020 2020  Changed :..     
-00016530: 2020 2020 2020 2077 6172 6e69 6e67 732e         warnings.
-00016540: 7761 726e 2827 496d 6167 6520 6f70 6572  warn('Image oper
-00016550: 6174 696f 6e20 6d61 7920 6265 2061 6e6f  ation may be ano
-00016560: 6d61 6c6f 7573 2061 6674 6572 2073 6861  malous after sha
-00016570: 7065 206d 6f64 6966 6963 6174 696f 6e2e  pe modification.
-00016580: 2729 0d0a 2020 2020 2020 2020 0d0a 2020  ')..        ..  
-00016590: 2020 2020 2020 6966 2028 687a 6572 6f3c        if (hzero<
-000165a0: 2d31 2920 6f72 2028 687a 6572 6f3e 3129  -1) or (hzero>1)
-000165b0: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
-000165c0: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-000165d0: 2827 687a 6572 6f20 6d75 7374 2062 6520  ('hzero must be 
-000165e0: 6265 7477 6565 6e20 2d31 2061 6e64 2031  between -1 and 1
-000165f0: 2c20 666f 756e 6420 7b7d 272e 666f 726d  , found {}'.form
-00016600: 6174 2868 7a65 726f 2929 0d0a 2020 2020  at(hzero))..    
-00016610: 2020 2020 686f 203d 2028 312e 3020 2d68      ho = (1.0 -h
-00016620: 7a65 726f 290d 0a20 2020 2020 2020 2068  zero)..        h
-00016630: 7367 6e20 3d20 6e70 2e73 6967 6e28 687a  sgn = np.sign(hz
-00016640: 6572 6f29 0d0a 2020 2020 2020 2020 685f  ero)..        h_
-00016650: 7265 6620 3d20 6c61 6d62 6461 2068 203a  ref = lambda h :
-00016660: 206e 702e 6d6f 6428 2068 6f20 2b20 6873   np.mod( ho + hs
-00016670: 676e 2a68 202c 2031 2e30 290d 0a20 2020  gn*h , 1.0)..   
-00016680: 2020 2020 2023 202e 2e2e 2e2e 2e2e 2e2e       # .........
-00016690: 2e2e 2e2e 2e2e 2e2e 2e2e 0d0a 2020 2020  ............    
-000166a0: 2020 2020 612c 622c 696e 5669 6577 706f      a,b,inViewpo
-000166b0: 7274 203d 2073 656c 662e 5f76 6965 7770  rt = self._viewp
-000166c0: 6f72 7443 6f6f 7228 7365 6c66 2e76 6572  ortCoor(self.ver
-000166d0: 7465 7843 6f6f 722c 7669 6577 706f 7274  texCoor,viewport
-000166e0: 290d 0a20 2020 2020 2020 2069 6d67 203d  )..        img =
-000166f0: 2069 6d61 6765 2e69 6d72 6561 6428 666e   image.imread(fn
-00016700: 616d 6529 0d0a 2020 2020 2020 2020 6865  ame)..        he
-00016710: 6967 6874 2c20 7769 6474 6820 3d20 6e70  ight, width = np
-00016720: 2e73 7562 7472 6163 7428 696d 672e 7368  .subtract(img.sh
-00016730: 6170 655b 3a32 5d2c 3129 0d0a 2020 2020  ape[:2],1)..    
-00016740: 2020 2020 785f 696e 6465 7820 3d20 2820      x_index = ( 
-00016750: 2831 2d62 292a 6865 6967 6874 2029 2e61  (1-b)*height ).a
-00016760: 7374 7970 6528 696e 7429 0d0a 2020 2020  stype(int)..    
-00016770: 2020 2020 795f 696e 6465 7820 3d20 2820      y_index = ( 
-00016780: 612a 7769 6474 6820 292e 6173 7479 7065  a*width ).astype
-00016790: 2869 6e74 290d 0a0d 0a20 2020 2020 2020  (int)....       
-000167a0: 2076 616c 496e 6465 782c 2069 7348 5356   valIndex, isHSV
-000167b0: 203d 2067 6574 496e 6465 7828 6372 6566   = getIndex(cref
-000167c0: 290d 0a20 2020 2020 2020 2072 6762 636f  )..        rgbco
-000167d0: 6c6f 7220 3d20 696d 675b 785f 696e 6465  lor = img[x_inde
-000167e0: 782c 795f 696e 6465 785d 0d0a 2020 2020  x,y_index]..    
-000167f0: 2020 2020 6966 2069 7348 5356 203a 0d0a      if isHSV :..
-00016800: 2020 2020 2020 2020 2020 2020 6873 7663              hsvc
-00016810: 6f6c 6f72 203d 2063 6f6c 6f72 732e 7267  olor = colors.rg
-00016820: 625f 746f 5f68 7376 2872 6762 636f 6c6f  b_to_hsv(rgbcolo
-00016830: 7229 0d0a 2020 2020 2020 2020 2020 2020  r)..            
-00016840: 6873 7663 6f6c 6f72 203d 206e 702e 7472  hsvcolor = np.tr
-00016850: 616e 7370 6f73 6528 6873 7663 6f6c 6f72  anspose(hsvcolor
-00016860: 290d 0a20 2020 2020 2020 2020 2020 2069  )..            i
-00016870: 6620 7661 6c49 6e64 6578 3d3d 3020 3a20  f valIndex==0 : 
-00016880: 643d 2068 5f72 6566 2868 7376 636f 6c6f  d= h_ref(hsvcolo
-00016890: 725b 305d 290d 0a20 2020 2020 2020 2020  r[0])..         
-000168a0: 2020 2065 6c73 6520 3a20 2020 2020 2020     else :       
-000168b0: 2020 2020 6420 3d20 6873 7663 6f6c 6f72      d = hsvcolor
-000168c0: 5b76 616c 496e 6465 785d 0d0a 2020 2020  [valIndex]..    
-000168d0: 2020 2020 656c 7365 203a 0d0a 2020 2020      else :..    
-000168e0: 2020 2020 2020 2020 7267 6263 6f6c 6f72          rgbcolor
-000168f0: 203d 206e 702e 7472 616e 7370 6f73 6528   = np.transpose(
-00016900: 7267 6263 6f6c 6f72 290d 0a20 2020 2020  rgbcolor)..     
-00016910: 2020 2020 2020 2064 203d 2072 6762 636f         d = rgbco
-00016920: 6c6f 725b 7661 6c49 6e64 6578 5d0d 0a0d  lor[valIndex]...
-00016930: 0a20 2020 2020 2020 2064 203d 206e 702e  .        d = np.
-00016940: 7768 6572 6528 696e 5669 6577 706f 7274  where(inViewport
-00016950: 2c64 2c6e 702e 7a65 726f 7328 6c65 6e28  ,d,np.zeros(len(
-00016960: 6429 2929 0d0a 2020 2020 2020 2020 6420  d)))..        d 
-00016970: 3d20 645b 3a2c 206e 702e 6e65 7761 7869  = d[:, np.newaxi
-00016980: 735d 0d0a 2020 2020 2020 2020 0d0a 2020  s]..        ..  
-00016990: 2020 2020 2020 2320 4675 7444 6576 3a20        # FutDev: 
-000169a0: 2766 5661 6c27 206f 6e6c 7920 6170 706c  'fVal' only appl
-000169b0: 6963 6162 6c65 2066 6f72 2069 6e69 7469  icable for initi
-000169c0: 616c 2073 7562 636c 6173 7365 6420 7375  al subclassed su
-000169d0: 7266 6163 6573 0d0a 2020 2020 2020 2020  rfaces..        
-000169e0: 2320 7375 7266 6163 6573 2074 6f20 6765  # surfaces to ge
-000169f0: 7420 7375 7266 6163 6520 6e6f 726d 616c  t surface normal
-00016a00: 7320 6174 2061 2076 6572 7465 782e 0d0a  s at a vertex...
-00016a10: 2020 2020 2020 2020 2320 4675 7475 7265          # Future
-00016a20: 2077 6f72 6b3a 2074 6f20 6d61 6b65 2074   work: to make t
-00016a30: 6869 7320 6765 6e65 7269 6320 666f 7220  his generic for 
-00016a40: 616e 7920 7375 7266 6163 652e 0d0a 2020  any surface...  
-00016a50: 2020 2020 2020 6656 616c 203d 206e 702e        fVal = np.
-00016a60: 6172 7261 7928 5b30 2e2c 302e 2c31 2e5d  array([0.,0.,1.]
-00016a70: 290d 0a20 2020 2020 2020 2069 6620 7365  )..        if se
-00016a80: 6c66 2e64 6973 705f 5665 6374 6f72 2069  lf.disp_Vector i
-00016a90: 7320 6e6f 7420 4e6f 6e65 203a 0d0a 2020  s not None :..  
-00016aa0: 2020 2020 2020 2020 2020 6656 616c 203d            fVal =
-00016ab0: 2073 656c 662e 7665 7274 6578 436f 6f72   self.vertexCoor
-00016ac0: 2a73 656c 662e 6469 7370 5f56 6563 746f  *self.disp_Vecto
-00016ad0: 720d 0a0d 0a20 2020 2020 2020 2076 203d  r....        v =
-00016ae0: 2020 7365 6c66 2e76 6572 7465 7843 6f6f    self.vertexCoo
-00016af0: 7220 2b20 7363 616c 652a 642a 6656 616c  r + scale*d*fVal
-00016b00: 0d0a 2020 2020 2020 2020 7665 7274 7320  ..        verts 
-00016b10: 3d20 765b 7365 6c66 2e66 7649 6e64 6963  = v[self.fvIndic
-00016b20: 6573 5d0d 0a20 2020 2020 2020 2073 656c  es]..        sel
-00016b30: 662e 7665 7274 6578 436f 6f72 203d 2076  f.vertexCoor = v
-00016b40: 0d0a 2020 2020 2020 2020 7365 6c66 2e5f  ..        self._
-00016b50: 7365 745f 6765 6f6d 6574 7269 635f 626f  set_geometric_bo
-00016b60: 756e 6473 2829 0d0a 2020 2020 2020 2020  unds()..        
-00016b70: 7365 6c66 2e73 6574 5f76 6572 7473 2820  self.set_verts( 
-00016b80: 7665 7274 7320 290d 0a20 2020 2020 2020  verts )..       
-00016b90: 2073 656c 662e 5f73 7572 6661 6365 5368   self._surfaceSh
-00016ba0: 6170 6543 6861 6e67 6564 203d 2054 7275  apeChanged = Tru
-00016bb0: 650d 0a20 2020 2020 2020 2069 6620 6e61  e..        if na
-00016bc0: 6d65 2069 7320 6e6f 7420 4e6f 6e65 3a20  me is not None: 
-00016bd0: 7365 6c66 2e5f 6765 6f6d 4e61 6d65 203d  self._geomName =
-00016be0: 206e 616d 650d 0a20 2020 2020 2020 2072   name..        r
-00016bf0: 6574 7572 6e20 7365 6c66 0d0a 2020 2020  eturn self..    
-00016c00: 0d0a 2020 2020 6465 6620 6d61 705f 6765  ..    def map_ge
-00016c10: 6f6d 5f66 726f 6d5f 6f70 2873 656c 662c  om_from_op(self,
-00016c20: 206f 7065 7261 7469 6f6e 2c20 7265 7475   operation, retu
-00016c30: 726e 7879 7a3d 4661 6c73 652c 206e 616d  rnxyz=False, nam
-00016c40: 653d 4e6f 6e65 2920 3a0d 0a20 2020 2020  e=None) :..     
-00016c50: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
-00016c60: 4675 6e63 7469 6f6e 616c 2074 7261 6e73  Functional trans
-00016c70: 666f 726d 6174 696f 6e20 6f66 2073 7572  formation of sur
-00016c80: 6661 6365 2076 6572 7465 7820 636f 6f72  face vertex coor
-00016c90: 6469 6e61 7465 732e 0d0a 0d0a 2020 2020  dinates.....    
-00016ca0: 2020 2020 5468 6973 206d 6574 686f 6420      This method 
-00016cb0: 6973 206e 6f74 2061 7661 696c 6162 6c65  is not available
-00016cc0: 2066 6f72 2063 6f6d 706f 7369 7465 2073   for composite s
-00016cd0: 7572 6661 6365 732e 0d0a 0d0a 2020 2020  urfaces.....    
-00016ce0: 2020 2020 5061 7261 6d65 7465 7273 0d0a      Parameters..
-00016cf0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00016d00: 2d2d 0d0a 2020 2020 2020 2020 6f70 6572  --..        oper
-00016d10: 6174 696f 6e20 3a20 6675 6e63 7469 6f6e  ation : function
-00016d20: 206f 626a 6563 740d 0a20 2020 2020 2020   object..       
-00016d30: 2020 2020 2043 6f6f 7264 696e 6174 6520       Coordinate 
-00016d40: 6d61 7070 696e 6720 6675 6e63 7469 6f6e  mapping function
-00016d50: 2074 6861 7420 7461 6b65 7320 6f6e 650d   that takes one.
-00016d60: 0a20 2020 2020 2020 2020 2020 2061 7267  .            arg
-00016d70: 756d 656e 742c 2061 2033 784e 204e 756d  ument, a 3xN Num
-00016d80: 7079 2061 7272 6179 206f 6620 6e61 7469  py array of nati
-00016d90: 7665 2063 6f6f 7264 696e 6174 6573 2e0d  ve coordinates..
-00016da0: 0a20 2020 2020 2020 2020 2020 2054 6865  .            The
-00016db0: 2066 756e 6374 696f 6e20 7265 7475 726e   function return
-00016dc0: 7320 6120 3378 4e20 6172 7261 7920 6f66  s a 3xN array of
-00016dd0: 2063 6f6f 7264 696e 6174 6573 2e0d 0a0d   coordinates....
-00016de0: 0a20 2020 2020 2020 2072 6574 7572 6e78  .        returnx
-00016df0: 797a 203a 2062 6f6f 6c20 7b20 5472 7565  yz : bool { True
-00016e00: 2c20 4661 6c73 6520 7d2c 206f 7074 696f  , False }, optio
-00016e10: 6e61 6c2c 2064 6566 6175 6c74 3a20 4661  nal, default: Fa
-00016e20: 6c73 650d 0a20 2020 2020 2020 2020 2020  lse..           
-00016e30: 2042 7920 6465 6661 756c 742c 206e 6174   By default, nat
-00016e40: 6976 6520 636f 6f72 6469 6e61 7465 7320  ive coordinates 
-00016e50: 6172 6520 7265 7475 726e 6564 2062 7920  are returned by 
-00016e60: 7468 650d 0a20 2020 2020 2020 2020 2020  the..           
-00016e70: 206f 7065 7261 7469 6f6e 2066 756e 6374   operation funct
-00016e80: 696f 6e2e 2020 4966 2073 6574 2054 7275  ion.  If set Tru
-00016e90: 652c 2074 6865 206f 7065 7261 7469 6f6e  e, the operation
-00016ea0: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
-00016eb0: 7475 726e 7320 7879 7a20 4361 7274 6573  turns xyz Cartes
-00016ec0: 6961 6e20 636f 6f72 6469 6e61 7465 732e  ian coordinates.
-00016ed0: 0d0a 0d0a 2020 2020 2020 2020 6e61 6d65  ....        name
-00016ee0: 203a 2073 7472 696e 672c 206f 7074 696f   : string, optio
-00016ef0: 6e61 6c2c 2064 6566 6175 6c74 3a20 4e6f  nal, default: No
-00016f00: 6e65 206f 7220 6f70 2066 756e 6374 696f  ne or op functio
-00016f10: 6e20 6e61 6d65 2e0d 0a20 2020 2020 2020  n name...       
-00016f20: 2020 2020 2044 6573 6372 6970 7469 7665       Descriptive
-00016f30: 2069 6465 6e74 6966 6965 7220 666f 7220   identifier for 
-00016f40: 7468 6520 6765 6f6d 6574 7279 2e0d 0a0d  the geometry....
-00016f50: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-00016f60: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-00016f70: 2d0d 0a20 2020 2020 2020 2073 656c 6620  -..        self 
-00016f80: 3a20 7375 7266 6163 6520 6f62 6a65 6374  : surface object
-00016f90: 0d0a 0d0a 2020 2020 2020 2020 2222 220d  ....        """.
-00016fa0: 0a0d 0a20 2020 2020 2020 2072 6574 7572  ...        retur
-00016fb0: 6e20 7365 6c66 2e5f 6d61 705f 6765 6f6d  n self._map_geom
-00016fc0: 5f66 726f 6d5f 6f70 2820 6f70 6572 6174  _from_op( operat
-00016fd0: 696f 6e2c 2072 6574 7572 6e78 797a 2c20  ion, returnxyz, 
-00016fe0: 6e61 6d65 2c20 6368 6563 6b3d 5472 7565  name, check=True
-00016ff0: 290d 0a0d 0a20 2020 2064 6566 205f 6d61  )....    def _ma
-00017000: 705f 6765 6f6d 5f66 726f 6d5f 6f70 2873  p_geom_from_op(s
-00017010: 656c 662c 206f 7065 7261 7469 6f6e 2c20  elf, operation, 
-00017020: 7265 7475 726e 7879 7a2c 206e 616d 652c  returnxyz, name,
-00017030: 2063 6865 636b 2920 3a0d 0a20 2020 2020   check) :..     
-00017040: 2020 200d 0a20 2020 2020 2020 2023 2075     ..        # u
-00017050: 7365 6420 6279 2064 6f6d 6169 6e20 7769  sed by domain wi
-00017060: 7468 2063 6865 636b 3d46 616c 7365 2074  th check=False t
-00017070: 6f20 616c 6c6f 7720 636f 6d70 6f73 6974  o allow composit
-00017080: 6573 2073 6361 6c69 6e67 2e0d 0a20 2020  es scaling...   
-00017090: 2020 2020 2023 206f 7468 6572 7769 7365       # otherwise
-000170a0: 2c20 6e6f 7420 616c 6c6f 7765 6420 6279  , not allowed by
-000170b0: 206d 6170 5f67 656f 6d5f 6672 6f6d 5f6f   map_geom_from_o
-000170c0: 7020 6d65 7468 6f64 2e0d 0a0d 0a20 2020  p method.....   
-000170d0: 2020 2020 2069 6620 7365 6c66 2e5f 6973       if self._is
-000170e0: 436f 6d70 6f73 6974 6553 7572 6661 6365  CompositeSurface
-000170f0: 2061 6e64 2063 6865 636b 203a 0d0a 2020   and check :..  
-00017100: 2020 2020 2020 2020 2020 7761 726e 696e            warnin
-00017110: 6773 2e77 6172 6e28 274d 6170 206f 7065  gs.warn('Map ope
-00017120: 7261 7469 6f6e 204d 5553 5420 7573 6520  ration MUST use 
-00017130: 7879 7a20 636f 6f72 6469 6e61 7465 7320  xyz coordinates 
-00017140: 666f 7220 636f 6d62 696e 6564 2073 6861  for combined sha
-00017150: 7065 732e 2729 0d0a 2020 2020 2020 2020  pes.')..        
-00017160: 2020 2020 2377 6172 6e69 6e67 732e 7761      #warnings.wa
-00017170: 726e 2827 4d61 7020 6f70 6572 6174 696f  rn('Map operatio
-00017180: 6e20 6e6f 7420 6176 6169 6c61 626c 6520  n not available 
-00017190: 666f 7220 636f 6d62 696e 6564 2073 6861  for combined sha
-000171a0: 7065 732e 2729 0d0a 2020 2020 2020 2020  pes.')..        
-000171b0: 2020 2020 2372 6574 7572 6e20 7365 6c66      #return self
-000171c0: 0d0a 2020 2020 2020 2020 7620 3d20 7365  ..        v = se
-000171d0: 6c66 2e5f 7472 616e 7366 6f72 6d56 6563  lf._transformVec
-000171e0: 746f 7228 7365 6c66 2e76 6572 7465 7843  tor(self.vertexC
-000171f0: 6f6f 722c 206f 7065 7261 7469 6f6e 2c20  oor, operation, 
-00017200: 7265 7475 726e 7879 7a29 0d0a 2020 2020  returnxyz)..    
-00017210: 2020 2020 7665 7274 7320 3d20 765b 7365      verts = v[se
-00017220: 6c66 2e66 7649 6e64 6963 6573 5d0d 0a20  lf.fvIndices].. 
-00017230: 2020 2020 2020 2073 656c 662e 7665 7274         self.vert
-00017240: 6578 436f 6f72 203d 2076 0d0a 2020 2020  exCoor = v..    
-00017250: 2020 2020 7365 6c66 2e5f 7365 745f 6765      self._set_ge
-00017260: 6f6d 6574 7269 635f 626f 756e 6473 2829  ometric_bounds()
-00017270: 0d0a 2020 2020 2020 2020 7365 6c66 2e73  ..        self.s
-00017280: 6574 5f76 6572 7473 2820 7665 7274 7320  et_verts( verts 
-00017290: 290d 0a20 2020 2020 2020 2073 656c 662e  )..        self.
-000172a0: 5f73 7572 6661 6365 5368 6170 6543 6861  _surfaceShapeCha
-000172b0: 6e67 6564 203d 2054 7275 650d 0a20 2020  nged = True..   
-000172c0: 2020 2020 2069 6620 6e61 6d65 2069 7320       if name is 
-000172d0: 4e6f 6e65 203a 206e 616d 6520 3d20 7365  None : name = se
-000172e0: 6c66 2e5f 6765 6f6d 4e61 6d65 0d0a 2020  lf._geomName..  
-000172f0: 2020 2020 2020 6e61 6d65 203d 205f 6765        name = _ge
-00017300: 7446 756e 6374 696f 6e4e 616d 6528 6f70  tFunctionName(op
-00017310: 6572 6174 696f 6e2c 6e61 6d65 290d 0a20  eration,name).. 
-00017320: 2020 2020 2020 2069 6620 6e61 6d65 2069         if name i
-00017330: 7320 6e6f 7420 4e6f 6e65 3a20 7365 6c66  s not None: self
-00017340: 2e5f 6765 6f6d 4e61 6d65 203d 206e 616d  ._geomName = nam
-00017350: 650d 0a20 2020 2020 2020 2072 6574 7572  e..        retur
-00017360: 6e20 7365 6c66 0d0a 2020 2020 0d0a 2020  n self..    ..  
-00017370: 2020 6465 6620 636c 6970 2873 656c 662c    def clip(self,
-00017380: 206f 7065 7261 7469 6f6e 2c20 7573 6578   operation, usex
-00017390: 797a 3d46 616c 7365 2920 3a0d 0a20 2020  yz=False) :..   
-000173a0: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
-000173b0: 2020 5265 6d6f 7665 2066 6163 6573 2066    Remove faces f
-000173c0: 726f 6d20 7468 6520 7375 7266 6163 6520  rom the surface 
-000173d0: 6261 7365 6420 6f6e 2070 6f73 6974 696f  based on positio
-000173e0: 6e2e 0d0a 0d0a 2020 2020 2020 2020 5061  n.....        Pa
-000173f0: 7261 6d65 7465 7273 0d0a 2020 2020 2020  rameters..      
-00017400: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
-00017410: 2020 2020 2020 6f70 6572 6174 696f 6e20        operation 
-00017420: 3a20 6675 6e63 7469 6f6e 206f 626a 6563  : function objec
-00017430: 740d 0a20 2020 2020 2020 2020 2020 2046  t..            F
-00017440: 756e 6374 696f 6e20 7468 6174 2074 616b  unction that tak
-00017450: 6573 206f 6e65 2061 7267 756d 656e 742c  es one argument,
-00017460: 2061 2033 784e 204e 756d 7079 2061 7272   a 3xN Numpy arr
-00017470: 6179 206f 6620 636f 6f72 6469 6e61 7465  ay of coordinate
-00017480: 732e 0d0a 2020 2020 2020 2020 2020 2020  s...            
-00017490: 5468 6520 6675 6e63 7469 6f6e 2072 6574  The function ret
-000174a0: 7572 6e73 2061 2062 6f6f 6c20 7b20 5472  urns a bool { Tr
-000174b0: 7565 2c20 4661 6c73 6520 7d20 696e 6469  ue, False } indi
-000174c0: 6361 7469 6e67 2069 660d 0a20 2020 2020  cating if..     
-000174d0: 2020 2020 2020 2074 6865 2066 6163 652c         the face,
-000174e0: 2061 7420 7468 6520 6661 6365 2063 656e   at the face cen
-000174f0: 7465 7265 6420 636f 6f72 6469 6e61 7465  tered coordinate
-00017500: 2c20 6973 2074 6f20 6265 200d 0a20 2020  , is to be ..   
-00017510: 2020 2020 2020 2020 2072 6574 6169 6e65           retaine
-00017520: 6420 2854 7275 6529 2c20 6f74 6865 7277  d (True), otherw
-00017530: 6973 652c 2074 6865 2066 6163 6520 6973  ise, the face is
-00017540: 2072 656d 6f76 6564 2066 726f 6d20 7468   removed from th
-00017550: 650d 0a20 2020 2020 2020 2020 2020 2073  e..            s
-00017560: 7572 6661 6365 2028 4661 6c73 6529 2e0d  urface (False)..
-00017570: 0a0d 0a20 2020 2020 2020 2075 7365 7879  ...        usexy
-00017580: 7a20 3a20 626f 6f6c 207b 2054 7275 652c  z : bool { True,
-00017590: 2046 616c 7365 207d 2c20 6465 6661 756c   False }, defaul
-000175a0: 743a 2046 616c 7365 0d0a 2020 2020 2020  t: False..      
-000175b0: 2020 2020 2020 4966 2054 7275 652c 2066        If True, f
-000175c0: 6163 6520 6365 6e74 6572 7320 6172 6520  ace centers are 
-000175d0: 7061 7373 6564 2074 6f20 7468 6520 6f70  passed to the op
-000175e0: 6572 6174 696f 6e20 6675 6e63 7469 6f6e  eration function
-000175f0: 0d0a 2020 2020 2020 2020 2020 2020 696e  ..            in
-00017600: 2078 797a 2063 6f6f 7264 696e 6174 6573   xyz coordinates
-00017610: 2e20 2049 6620 4661 6c73 652c 2066 6163  .  If False, fac
-00017620: 6520 6365 6e74 6572 7320 6172 6520 7061  e centers are pa
-00017630: 7373 6564 0d0a 2020 2020 2020 2020 2020  ssed..          
-00017640: 2020 696e 206e 6174 6976 6520 636f 6f72    in native coor
-00017650: 6469 6e61 7465 732e 0d0a 0d0a 2020 2020  dinates.....    
-00017660: 2020 2020 5265 7475 726e 730d 0a20 2020      Returns..   
-00017670: 2020 2020 202d 2d2d 2d2d 2d2d 0d0a 2020       -------..  
-00017680: 2020 2020 2020 7365 6c66 203a 2073 7572        self : sur
-00017690: 6661 6365 206f 626a 6563 740d 0a0d 0a20  face object.... 
-000176a0: 2020 2020 2020 2022 2222 0d0a 0d0a 2020         """....  
-000176b0: 2020 2020 2020 2320 436c 6970 206f 7065        # Clip ope
-000176c0: 7261 7469 6f6e 204d 5553 5420 7573 6520  ration MUST use 
-000176d0: 7879 7a20 636f 6f72 6469 6e61 7465 7320  xyz coordinates 
-000176e0: 666f 7220 636f 6d62 696e 6564 2073 6861  for combined sha
-000176f0: 7065 732e 0d0a 2020 2020 2020 2020 2320  pes...        # 
-00017700: 7369 6e63 6520 6e61 7469 7665 2063 6f6f  since native coo
-00017710: 7264 696e 6174 6520 6d61 7920 6265 2075  rdinate may be u
-00017720: 6e64 6566 696e 6564 2e0d 0a20 2020 2020  ndefined...     
-00017730: 2020 2069 6620 7365 6c66 2e5f 6973 436f     if self._isCo
-00017740: 6d70 6f73 6974 6553 7572 6661 6365 203a  mpositeSurface :
-00017750: 2075 7365 7879 7a20 3d20 5472 7565 0d0a   usexyz = True..
-00017760: 0d0a 2020 2020 2020 2020 7665 7274 7320  ..        verts 
-00017770: 3d20 7365 6c66 2e76 6572 7465 7843 6f6f  = self.vertexCoo
-00017780: 725b 2073 656c 662e 6676 496e 6469 6365  r[ self.fvIndice
-00017790: 7320 5d0d 0a20 2020 2020 2020 2066 6163  s ]..        fac
-000177a0: 6543 656e 7465 7243 6f6f 7220 3d20 7365  eCenterCoor = se
-000177b0: 6c66 2e5f 6765 745f 6661 6365 5f63 656e  lf._get_face_cen
-000177c0: 7465 7273 2876 6572 7473 290d 0a0d 0a20  ters(verts).... 
-000177d0: 2020 2020 2020 2073 656c 662e 5f70 6f73         self._pos
-000177e0: 7450 726f 635f 7375 7266 6163 6543 6f6c  tProc_surfaceCol
-000177f0: 6f72 7328 290d 0a20 2020 2020 2020 206f  ors()..        o
-00017800: 7269 675f 636f 6c6f 7273 203d 2073 656c  rig_colors = sel
-00017810: 662e 5f66 6163 6563 6f6c 6f72 730d 0a0d  f._facecolors...
-00017820: 0a20 2020 2020 2020 2078 797a 203d 206e  .        xyz = n
-00017830: 702e 7472 616e 7370 6f73 6528 6661 6365  p.transpose(face
-00017840: 4365 6e74 6572 436f 6f72 290d 0a20 2020  CenterCoor)..   
-00017850: 2020 2020 2069 6620 7573 6578 797a 2069       if usexyz i
-00017860: 7320 4661 6c73 6520 3a20 2078 797a 203d  s False :  xyz =
-00017870: 2073 656c 662e 636f 6f72 5f63 6f6e 7665   self.coor_conve
-00017880: 7274 2878 797a 290d 0a20 2020 2020 2020  rt(xyz)..       
-00017890: 2061 6263 203d 2078 797a 0d0a 2020 2020   abc = xyz..    
-000178a0: 2020 2020 7368 6f75 6c64 4b65 6570 203d      shouldKeep =
-000178b0: 206e 702e 6172 7261 7928 6f70 6572 6174   np.array(operat
-000178c0: 696f 6e28 6162 6329 290d 0a20 2020 2020  ion(abc))..     
-000178d0: 2020 2069 6620 6e70 2e61 6e79 2873 686f     if np.any(sho
-000178e0: 756c 644b 6565 7029 2069 7320 4e6f 6e65  uldKeep) is None
-000178f0: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
-00017900: 7761 726e 696e 6773 2e77 6172 6e28 2757  warnings.warn('W
-00017910: 4152 4e49 4e47 3a20 436c 6970 7069 6e67  ARNING: Clipping
-00017920: 2072 6573 756c 7465 6420 696e 206e 6f20   resulted in no 
-00017930: 6661 6365 7320 666f 756e 642c 2073 7572  faces found, sur
-00017940: 6661 6365 2072 6574 7572 6e20 756e 636c  face return uncl
-00017950: 6970 7065 642e 2729 0d0a 2020 2020 2020  ipped.')..      
-00017960: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00017970: 660d 0a0d 0a20 2020 2020 2020 2066 7669  f....        fvi
-00017980: 203d 2073 656c 662e 6676 496e 6469 6365   = self.fvIndice
-00017990: 735b 7368 6f75 6c64 4b65 6570 5d0d 0a20  s[shouldKeep].. 
-000179a0: 2020 2020 2020 2066 636f 6c20 3d20 6f72         fcol = or
-000179b0: 6967 5f63 6f6c 6f72 735b 7368 6f75 6c64  ig_colors[should
-000179c0: 4b65 6570 5d0d 0a0d 0a20 2020 2020 2020  Keep]....       
-000179d0: 2023 2074 6869 7320 7065 726d 6974 7320   # this permits 
-000179e0: 6d75 6c74 6970 6c65 2063 6c69 7073 2077  multiple clips w
-000179f0: 6974 686f 7574 2063 6861 6e67 696e 6720  ithout changing 
-00017a00: 6f72 6967 696e 616c 2c20 736f 2072 6573  original, so res
-00017a10: 746f 7265 2069 7320 6176 6169 6c61 626c  tore is availabl
-00017a20: 652e 0d0a 2020 2020 2020 2020 6966 2073  e...        if s
-00017a30: 656c 662e 7265 7374 6f72 6564 436c 6970  elf.restoredClip
-00017a40: 2069 7320 4e6f 6e65 203a 0d0a 2020 2020   is None :..    
-00017a50: 2020 2020 2020 2020 7365 6c66 2e72 6573          self.res
-00017a60: 746f 7265 6443 6c69 7020 3d20 7b20 2766  toredClip = { 'f
-00017a70: 6163 6573 2720 3a20 7365 6c66 2e66 7649  aces' : self.fvI
-00017a80: 6e64 6963 6573 2c20 2763 6f6c 6f72 7327  ndices, 'colors'
-00017a90: 203a 206f 7269 675f 636f 6c6f 7273 207d   : orig_colors }
-00017aa0: 0d0a 0d0a 2020 2020 2020 2020 6676 6920  ....        fvi 
-00017ab0: 3d20 6e70 2e61 7272 6179 2866 7669 290d  = np.array(fvi).
-00017ac0: 0a20 2020 2020 2020 2073 656c 662e 6676  .        self.fv
-00017ad0: 496e 6469 6365 7320 3d20 6676 690d 0a20  Indices = fvi.. 
-00017ae0: 2020 2020 2020 2073 656c 662e 7365 745f         self.set_
-00017af0: 636f 6c6f 7228 6663 6f6c 2920 2020 2020  color(fcol)     
-00017b00: 2020 200d 0a20 2020 2020 2020 2076 203d     ..        v =
-00017b10: 2073 656c 662e 7665 7274 6578 436f 6f72   self.vertexCoor
-00017b20: 0d0a 2020 2020 2020 2020 7666 7669 203d  ..        vfvi =
-00017b30: 2076 5b66 7669 5d0d 0a20 2020 2020 2020   v[fvi]..       
-00017b40: 2073 656c 662e 7365 745f 7665 7274 7328   self.set_verts(
-00017b50: 2076 6676 6920 290d 0a0d 0a20 2020 2020   vfvi )....     
-00017b60: 2020 2063 6c69 7056 6572 7473 2020 3d20     clipVerts  = 
-00017b70: 6e70 2e72 6573 6861 7065 2876 6676 692c  np.reshape(vfvi,
-00017b80: 282d 312c 3329 290d 0a20 2020 2020 2020  (-1,3))..       
-00017b90: 205f 7365 745f 6765 6f6d 426f 756e 6473   _set_geomBounds
-00017ba0: 2820 636c 6970 5665 7274 732c 7365 6c66  ( clipVerts,self
-00017bb0: 2e62 6f75 6e64 7320 290d 0a20 2020 2020  .bounds )..     
-00017bc0: 2020 2073 656c 662e 5f73 6574 5f69 6e64     self._set_ind
-00017bd0: 6578 5f72 656c 6174 696f 6e73 2829 0d0a  ex_relations()..
-00017be0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00017bf0: 656c 660d 0a0d 0a20 2020 2064 6566 2063  elf....    def c
-00017c00: 6c69 705f 616c 7068 6128 7365 6c66 2c61  lip_alpha(self,a
-00017c10: 6c70 6861 4375 742c 7573 6576 616c 3d46  lphaCut,useval=F
-00017c20: 616c 7365 2920 3a0d 0a20 2020 2020 2020  alse) :..       
-00017c30: 2022 2222 0d0a 2020 2020 2020 2020 5265   """..        Re
-00017c40: 6d6f 7665 2066 6163 6573 2066 726f 6d20  move faces from 
-00017c50: 7468 6520 7375 7266 6163 6520 6261 7365  the surface base
-00017c60: 6420 6f6e 2061 6c70 6861 2074 7261 6e73  d on alpha trans
-00017c70: 7061 7265 6e63 792e 0d0a 0d0a 2020 2020  parency.....    
-00017c80: 2020 2020 5061 7261 6d65 7465 7273 0d0a      Parameters..
-00017c90: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00017ca0: 2d2d 0d0a 2020 2020 2020 2020 616c 7068  --..        alph
-00017cb0: 6143 7574 203a 2073 6361 6c61 720d 0a20  aCut : scalar.. 
-00017cc0: 2020 2020 2020 2020 2020 2049 6620 7468             If th
-00017cd0: 6520 6661 6365 2063 6f6c 6f72 2061 6c70  e face color alp
-00017ce0: 6861 2069 7320 6772 6561 7465 7220 7468  ha is greater th
-00017cf0: 616e 2061 6c70 6861 4375 742c 2074 6865  an alphaCut, the
-00017d00: 2066 6163 6520 6973 200d 0a20 2020 2020   face is ..     
-00017d10: 2020 2020 2020 2072 6574 6169 6e65 642c         retained,
-00017d20: 206f 7468 6572 7769 7365 2c20 7468 6520   otherwise, the 
-00017d30: 6661 6365 2069 7320 7265 6d6f 7665 6420  face is removed 
-00017d40: 6672 6f6d 2074 6865 2073 7572 6661 6365  from the surface
-00017d50: 2e0d 0a0d 0a20 2020 2020 2020 2075 7365  .....        use
-00017d60: 7661 6c20 3a20 626f 6f6c 207b 2054 7275  val : bool { Tru
-00017d70: 652c 2046 616c 7365 207d 2c20 6465 6661  e, False }, defa
-00017d80: 756c 743a 2046 616c 7365 0d0a 2020 2020  ult: False..    
-00017d90: 2020 2020 2020 2020 4966 2054 7275 652c          If True,
-00017da0: 2063 6c69 7070 696e 6720 6261 7365 6420   clipping based 
-00017db0: 6f6e 2063 6f6c 6f72 2048 5356 2076 616c  on color HSV val
-00017dc0: 7565 2e20 204f 7468 6572 7769 7365 2c0d  ue.  Otherwise,.
-00017dd0: 0a20 2020 2020 2020 2020 2020 2063 6c69  .            cli
-00017de0: 7070 696e 6720 6973 2062 6173 6564 206f  pping is based o
-00017df0: 6e20 7468 6520 636f 6c6f 7220 616c 7068  n the color alph
-00017e00: 6120 7661 6c75 652e 0d0a 0d0a 2020 2020  a value.....    
-00017e10: 2020 2020 5265 7475 726e 730d 0a20 2020      Returns..   
-00017e20: 2020 2020 202d 2d2d 2d2d 2d2d 0d0a 2020       -------..  
-00017e30: 2020 2020 2020 7365 6c66 203a 2073 7572        self : sur
-00017e40: 6661 6365 206f 626a 6563 740d 0a0d 0a20  face object.... 
-00017e50: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
-00017e60: 2020 2020 7365 6c66 2e5f 706f 7374 5072      self._postPr
-00017e70: 6f63 5f73 7572 6661 6365 436f 6c6f 7273  oc_surfaceColors
-00017e80: 2829 0d0a 2020 2020 2020 2020 6f72 6967  ()..        orig
-00017e90: 5f63 6f6c 6f72 7320 3d20 7365 6c66 2e5f  _colors = self._
-00017ea0: 6661 6365 636f 6c6f 7273 0d0a 0d0a 2020  facecolors....  
-00017eb0: 2020 2020 2020 6966 2075 7365 7661 6c20        if useval 
-00017ec0: 3a0d 0a20 2020 2020 2020 2020 2020 206f  :..            o
-00017ed0: 7269 675f 6873 7620 3d20 636f 6c6f 7273  rig_hsv = colors
-00017ee0: 2e72 6762 5f74 6f5f 6873 7628 6f72 6967  .rgb_to_hsv(orig
-00017ef0: 5f63 6f6c 6f72 735b 3a2c 3a33 5d29 0d0a  _colors[:,:3])..
-00017f00: 2020 2020 2020 2020 2020 2020 616c 7068              alph
-00017f10: 6173 203d 206e 702e 7261 7665 6c28 206f  as = np.ravel( o
-00017f20: 7269 675f 6873 765b 3a2c 323a 335d 2029  rig_hsv[:,2:3] )
-00017f30: 0d0a 2020 2020 2020 2020 656c 7365 203a  ..        else :
-00017f40: 0d0a 2020 2020 2020 2020 2020 2020 616c  ..            al
-00017f50: 7068 6173 203d 206e 702e 7261 7665 6c28  phas = np.ravel(
-00017f60: 206f 7269 675f 636f 6c6f 7273 5b3a 2c33   orig_colors[:,3
-00017f70: 3a34 5d20 290d 0a20 2020 2020 2020 2063  :4] )..        c
-00017f80: 7574 7320 3d20 6e70 2e66 756c 6c28 6c65  uts = np.full(le
-00017f90: 6e28 616c 7068 6173 292c 616c 7068 6143  n(alphas),alphaC
-00017fa0: 7574 290d 0a20 2020 2020 2020 2073 686f  ut)..        sho
-00017fb0: 756c 644b 6565 7020 3d20 616c 7068 6173  uldKeep = alphas
-00017fc0: 3e63 7574 730d 0a0d 0a20 2020 2020 2020  >cuts....       
-00017fd0: 2069 6620 6e70 2e61 6e79 2873 686f 756c   if np.any(shoul
-00017fe0: 644b 6565 7029 2069 7320 4e6f 6e65 203a  dKeep) is None :
-00017ff0: 0d0a 2020 2020 2020 2020 2020 2020 7761  ..            wa
-00018000: 726e 696e 6773 2e77 6172 6e28 2757 4152  rnings.warn('WAR
-00018010: 4e49 4e47 3a20 416c 7068 6120 636c 6970  NING: Alpha clip
-00018020: 7069 6e67 2072 6573 756c 7465 6420 696e  ping resulted in
-00018030: 206e 6f20 6661 6365 7320 666f 756e 642c   no faces found,
-00018040: 2073 7572 6661 6365 2072 6574 7572 6e20   surface return 
-00018050: 756e 636c 6970 7065 642e 2729 0d0a 2020  unclipped.')..  
-00018060: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00018070: 2073 656c 660d 0a20 2020 2020 2020 2066   self..        f
-00018080: 7669 203d 2073 656c 662e 6676 496e 6469  vi = self.fvIndi
-00018090: 6365 735b 7368 6f75 6c64 4b65 6570 5d0d  ces[shouldKeep].
-000180a0: 0a20 2020 2020 2020 2066 636f 6c20 3d20  .        fcol = 
-000180b0: 6f72 6967 5f63 6f6c 6f72 735b 7368 6f75  orig_colors[shou
-000180c0: 6c64 4b65 6570 5d0d 0a0d 0a20 2020 2020  ldKeep]....     
-000180d0: 2020 2023 2074 6869 7320 7065 726d 6974     # this permit
-000180e0: 7320 6d75 6c74 6970 6c65 2063 6c69 7073  s multiple clips
-000180f0: 2077 6974 686f 7574 2063 6861 6e67 696e   without changin
-00018100: 6720 6f72 6967 696e 616c 2c20 736f 2072  g original, so r
-00018110: 6573 746f 7265 2069 7320 6176 6169 6c61  estore is availa
-00018120: 626c 652e 0d0a 2020 2020 2020 2020 6966  ble...        if
-00018130: 2073 656c 662e 7265 7374 6f72 6564 436c   self.restoredCl
-00018140: 6970 2069 7320 4e6f 6e65 203a 0d0a 2020  ip is None :..  
-00018150: 2020 2020 2020 2020 2020 7365 6c66 2e72            self.r
-00018160: 6573 746f 7265 6443 6c69 7020 3d20 7b20  estoredClip = { 
-00018170: 2766 6163 6573 2720 3a20 7365 6c66 2e66  'faces' : self.f
-00018180: 7649 6e64 6963 6573 2c20 2763 6f6c 6f72  vIndices, 'color
-00018190: 7327 203a 206f 7269 675f 636f 6c6f 7273  s' : orig_colors
-000181a0: 207d 0d0a 0d0a 2020 2020 2020 2020 6676   }....        fv
-000181b0: 6920 3d20 6e70 2e61 7272 6179 2866 7669  i = np.array(fvi
-000181c0: 290d 0a20 2020 2020 2020 2073 656c 662e  )..        self.
-000181d0: 6676 496e 6469 6365 7320 3d20 6676 690d  fvIndices = fvi.
-000181e0: 0a20 2020 2020 2020 2073 656c 662e 7365  .        self.se
-000181f0: 745f 636f 6c6f 7228 6663 6f6c 2920 2020  t_color(fcol)   
-00018200: 2020 2020 200d 0a20 2020 2020 2020 2076       ..        v
-00018210: 203d 2073 656c 662e 7665 7274 6578 436f   = self.vertexCo
-00018220: 6f72 0d0a 2020 2020 2020 2020 7666 7669  or..        vfvi
-00018230: 203d 2076 5b66 7669 5d0d 0a20 2020 2020   = v[fvi]..     
-00018240: 2020 2073 656c 662e 7365 745f 7665 7274     self.set_vert
-00018250: 7328 2076 6676 6920 290d 0a0d 0a20 2020  s( vfvi )....   
-00018260: 2020 2020 2063 6c69 7056 6572 7473 2020       clipVerts  
-00018270: 3d20 6e70 2e72 6573 6861 7065 2876 6676  = np.reshape(vfv
-00018280: 692c 282d 312c 3329 290d 0a20 2020 2020  i,(-1,3))..     
-00018290: 2020 205f 7365 745f 6765 6f6d 426f 756e     _set_geomBoun
-000182a0: 6473 2820 636c 6970 5665 7274 732c 7365  ds( clipVerts,se
-000182b0: 6c66 2e62 6f75 6e64 7320 290d 0a20 2020  lf.bounds )..   
-000182c0: 2020 2020 2073 656c 662e 5f73 6574 5f69       self._set_i
-000182d0: 6e64 6578 5f72 656c 6174 696f 6e73 2829  ndex_relations()
-000182e0: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-000182f0: 2073 656c 660d 0a0d 0a20 2020 2064 6566   self....    def
-00018300: 2063 6c69 705f 706c 616e 6528 7365 6c66   clip_plane(self
-00018310: 2c64 6973 742c 2a2a 6b61 7267 7329 203a  ,dist,**kargs) :
-00018320: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
-00018330: 2020 2020 2020 2052 656d 6f76 6520 6661         Remove fa
-00018340: 6365 7320 6672 6f6d 2074 6865 2073 7572  ces from the sur
-00018350: 6661 6365 2062 6173 6564 206f 6e20 6120  face based on a 
-00018360: 636c 6970 2073 7572 6661 6365 2e0d 0a0d  clip surface....
-00018370: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-00018380: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
-00018390: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-000183a0: 2064 6973 7420 3a20 666c 6f61 740d 0a20   dist : float.. 
-000183b0: 2020 2020 2020 2020 2020 2044 6973 7461             Dista
-000183c0: 6e63 6520 6672 6f6d 2074 6865 206f 7269  nce from the ori
-000183d0: 6769 6e20 746f 2074 6865 2063 6c69 7020  gin to the clip 
-000183e0: 7375 7266 6163 652c 0d0a 2020 2020 2020  surface,..      
-000183f0: 2020 2020 2020 616c 6f6e 6720 7468 6520        along the 
-00018400: 6469 7265 6374 696f 6e20 7665 6374 6f72  direction vector
-00018410: 2e0d 0a20 2020 2020 2020 200d 0a20 2020  ...        ..   
-00018420: 2020 2020 2064 6972 6563 7469 6f6e 203a       direction :
-00018430: 2061 7272 6179 2d6c 696b 652c 206f 7074   array-like, opt
-00018440: 696f 6e61 6c2c 2064 6566 6175 6c74 3a20  ional, default: 
-00018450: 5b30 2c30 2c31 5d0d 0a20 2020 2020 2020  [0,0,1]..       
-00018460: 2020 2020 2041 2078 797a 2076 6563 746f       A xyz vecto
-00018470: 7220 6e6f 726d 616c 2074 6f20 7468 6520  r normal to the 
-00018480: 696e 7465 7273 6563 7469 6f6e 2070 6c61  intersection pla
-00018490: 6e65 0d0a 2020 2020 2020 2020 2020 2020  ne..            
-000184a0: 666f 7220 6120 706c 616e 6172 2063 6c69  for a planar cli
-000184b0: 7020 7375 7266 6163 6520 6f72 2061 7869  p surface or axi
-000184c0: 616c 2064 6972 6563 7469 6f6e 206f 660d  al direction of.
-000184d0: 0a20 2020 2020 2020 2020 2020 2061 2063  .            a c
-000184e0: 796c 696e 6465 7220 666f 7220 6120 6379  ylinder for a cy
-000184f0: 6c69 6e64 7269 6361 6c20 636c 6970 2073  lindrical clip s
-00018500: 7572 6661 6365 2e0d 0a0d 0a20 2020 2020  urface.....     
-00018510: 2020 2063 6f6f 7220 3a20 696e 7465 6765     coor : intege
-00018520: 7220 6f72 2073 7472 696e 6720 696e 6469  r or string indi
-00018530: 6361 7469 6e67 2074 6865 2074 7970 6520  cating the type 
-00018540: 6f66 2063 6c69 7020 7375 7266 6163 653a  of clip surface:
-00018550: 0d0a 2020 2020 2020 2020 2020 2020 302c  ..            0,
-00018560: 2070 2c20 502c 2078 797a 2c70 6c61 6e61   p, P, xyz,plana
-00018570: 7220 2020 2020 2020 2020 2020 2020 2020  r               
-00018580: 2020 2d20 706c 616e 6172 2028 6465 6661    - planar (defa
-00018590: 756c 7429 0d0a 2020 2020 2020 2020 2020  ult)..          
-000185a0: 2020 312c 2063 2c20 432c 2063 796c 696e    1, c, C, cylin
-000185b0: 6465 722c 7070 6c61 722c 6379 6c69 6e64  der,pplar,cylind
-000185c0: 7269 6361 6c20 2d20 6379 6c69 6e64 6572  rical - cylinder
-000185d0: 0d0a 2020 2020 2020 2020 2020 2020 322c  ..            2,
-000185e0: 2073 2c20 532c 2073 7068 6572 652c 7370   s, S, sphere,sp
-000185f0: 6865 7269 6361 6c20 2020 2020 2020 2020  herical         
-00018600: 2020 2d20 7370 6865 7265 0d0a 2020 2020    - sphere..    
-00018610: 2020 2020 2020 2020 332c 2078 2c20 5820          3, x, X 
-00018620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018630: 2020 2020 2020 2020 2020 2020 2d20 792d              - y-
-00018640: 7a20 706c 616e 650d 0a20 2020 2020 2020  z plane..       
-00018650: 2020 2020 2034 2c20 792c 2059 2020 2020       4, y, Y    
-00018660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018670: 2020 2020 2020 2020 202d 2078 2d7a 2070           - x-z p
-00018680: 6c61 6e65 0d0a 2020 2020 2020 2020 2020  lane..          
-00018690: 2020 352c 207a 2c20 5a20 2020 2020 2020    5, z, Z       
-000186a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000186b0: 2020 2020 2020 2d20 782d 7920 706c 616e        - x-y plan
-000186c0: 650d 0a0d 0a20 2020 2020 2020 2052 6574  e....        Ret
-000186d0: 7572 6e73 0d0a 2020 2020 2020 2020 2d2d  urns..        --
-000186e0: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2073  -----..        s
-000186f0: 656c 6620 3a20 7375 7266 6163 6520 6f62  elf : surface ob
-00018700: 6a65 6374 0d0a 0d0a 2020 2020 2020 2020  ject....        
-00018710: 2222 220d 0a20 2020 2020 2020 2023 202e  """..        # .
-00018720: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00018730: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00018740: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00018750: 2e2e 2e2e 2e2e 2e2e 2e2e 0d0a 2020 2020  ............    
-00018760: 2020 2020 6465 6620 636c 6970 5f6f 7028      def clip_op(
-00018770: 7879 7a2c 6469 7374 2c63 6f6f 722c 6469  xyz,dist,coor,di
-00018780: 7265 6374 696f 6e29 203a 0d0a 2020 2020  rection) :..    
-00018790: 2020 2020 2020 2020 6162 6320 3d20 6e70          abc = np
-000187a0: 2e74 7261 6e73 706f 7365 2878 797a 290d  .transpose(xyz).
-000187b0: 0a20 2020 2020 2020 2020 2020 2064 6f74  .            dot
-000187c0: 7072 6f64 203d 205f 636f 6f72 5f64 6f74  prod = _coor_dot
-000187d0: 7072 6f64 2864 6972 6563 7469 6f6e 2c63  prod(direction,c
-000187e0: 6f6f 722c 6162 6329 0d0a 2020 2020 2020  oor,abc)..      
-000187f0: 2020 2020 2020 6966 2063 6f6f 7220 3e20        if coor > 
-00018800: 3020 3a0d 0a20 2020 2020 2020 2020 2020  0 :..           
-00018810: 2020 2020 2069 6620 6469 7374 203c 2030       if dist < 0
-00018820: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
-00018830: 2020 2020 2020 2020 7368 6f75 6c64 636c          shouldcl
-00018840: 6970 203d 206e 702e 6772 6561 7465 7228  ip = np.greater(
-00018850: 646f 7470 726f 642c 6e70 2e66 756c 6c28  dotprod,np.full(
-00018860: 6c65 6e28 646f 7470 726f 6429 2c2d 6469  len(dotprod),-di
-00018870: 7374 2929 0d0a 2020 2020 2020 2020 2020  st))..          
-00018880: 2020 2020 2020 656c 7365 203a 0d0a 2020        else :..  
-00018890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000188a0: 2020 7368 6f75 6c64 636c 6970 203d 206e    shouldclip = n
-000188b0: 702e 6c65 7373 2864 6f74 7072 6f64 2c6e  p.less(dotprod,n
-000188c0: 702e 6675 6c6c 286c 656e 2864 6f74 7072  p.full(len(dotpr
-000188d0: 6f64 292c 6469 7374 2929 0d0a 2020 2020  od),dist))..    
-000188e0: 2020 2020 2020 2020 656c 7365 203a 2020          else :  
-000188f0: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
-00018900: 2020 2020 7368 6f75 6c64 636c 6970 203d      shouldclip =
-00018910: 206e 702e 6c65 7373 2864 6f74 7072 6f64   np.less(dotprod
-00018920: 2c6e 702e 6675 6c6c 286c 656e 2864 6f74  ,np.full(len(dot
-00018930: 7072 6f64 292c 6469 7374 2929 0d0a 2020  prod),dist))..  
-00018940: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00018950: 2073 686f 756c 6463 6c69 700d 0a20 2020   shouldclip..   
-00018960: 2020 2020 2023 202e 2e2e 2e2e 2e2e 2e2e       # .........
-00018970: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00018980: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00018990: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-000189a0: 2e2e 0d0a 2020 2020 2020 2020 6469 7244  ....        dirD
-000189b0: 6674 203d 207b 2027 6469 7265 6374 696f  ft = { 'directio
-000189c0: 6e27 3a20 5b30 2c30 2c31 2e30 5d20 7d0d  n': [0,0,1.0] }.
-000189d0: 0a20 2020 2020 2020 206b 6172 6744 6674  .        kargDft
-000189e0: 203d 207b 202a 2a5f 434f 4f52 5f4b 5741   = { **_COOR_KWA
-000189f0: 5247 532c 202a 2a64 6972 4466 7420 7d0d  RGS, **dirDft }.
-00018a00: 0a20 2020 2020 2020 204b 5720 3d20 4b57  .        KW = KW
-00018a10: 7072 6f63 6573 736f 7228 206b 6172 6744  processor( kargD
-00018a20: 6674 2c20 2763 6c69 705f 706c 616e 6527  ft, 'clip_plane'
-00018a30: 2c20 2a2a 6b61 7267 7329 0d0a 2020 2020  , **kargs)..    
-00018a40: 2020 2020 636f 6f72 203d 204b 572e 6765      coor = KW.ge
-00018a50: 7456 616c 2827 636f 6f72 2729 0d0a 2020  tVal('coor')..  
-00018a60: 2020 2020 2020 6469 7265 6374 696f 6e20        direction 
-00018a70: 3d20 4b57 2e67 6574 5661 6c28 2764 6972  = KW.getVal('dir
-00018a80: 6563 7469 6f6e 2729 0d0a 0d0a 2020 2020  ection')....    
-00018a90: 2020 2020 6966 2063 6f6f 723d 3d33 203a      if coor==3 :
-00018aa0: 2063 6f6f 722c 2064 6972 6563 7469 6f6e   coor, direction
-00018ab0: 203d 2030 2c20 5b20 312c 302c 3020 5d0d   = 0, [ 1,0,0 ].
-00018ac0: 0a20 2020 2020 2020 2069 6620 636f 6f72  .        if coor
-00018ad0: 3d3d 3420 3a20 636f 6f72 2c20 6469 7265  ==4 : coor, dire
-00018ae0: 6374 696f 6e20 3d20 302c 205b 2030 2c31  ction = 0, [ 0,1
-00018af0: 2c30 205d 0d0a 2020 2020 2020 2020 6966  ,0 ]..        if
-00018b00: 2063 6f6f 723d 3d35 203a 2063 6f6f 722c   coor==5 : coor,
-00018b10: 2064 6972 6563 7469 6f6e 203d 2030 2c20   direction = 0, 
-00018b20: 5b20 302c 302c 3120 5d0d 0a0d 0a20 2020  [ 0,0,1 ]....   
-00018b30: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00018b40: 2e63 6c69 7028 206c 616d 6264 6120 7879  .clip( lambda xy
-00018b50: 7a20 3a20 636c 6970 5f6f 7028 7879 7a2c  z : clip_op(xyz,
-00018b60: 6469 7374 2c63 6f6f 722c 6469 7265 6374  dist,coor,direct
-00018b70: 696f 6e29 2c54 7275 6529 0d0a 0d0a 2020  ion),True)....  
-00018b80: 2020 6465 6620 636c 6970 5f6e 6f72 6d61    def clip_norma
-00018b90: 6c73 2873 656c 662c 6469 7265 6374 696f  ls(self,directio
-00018ba0: 6e3d 4e6f 6e65 2920 3a0d 0a20 2020 2020  n=None) :..     
-00018bb0: 2020 2022 2222 200d 0a20 2020 2020 2020     """ ..       
-00018bc0: 2052 656d 6f76 6520 6661 6365 7320 6672   Remove faces fr
-00018bd0: 6f6d 2074 6865 2073 7572 6661 6365 2062  om the surface b
-00018be0: 6173 6564 206f 6e20 6120 6469 7265 6374  ased on a direct
-00018bf0: 696f 6e20 7265 6c61 7469 7665 2074 6f20  ion relative to 
-00018c00: 6661 6365 206e 6f72 6d61 6c73 2e0d 0a0d  face normals....
-00018c10: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-00018c20: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
-00018c30: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-00018c40: 2064 6972 6563 7469 6f6e 203a 2061 7272   direction : arr
-00018c50: 6179 2d6c 696b 6520 6f72 2033 4461 7869  ay-like or 3Daxi
-00018c60: 732c 206f 7074 696f 6e61 6c2c 2064 6566  s, optional, def
-00018c70: 6175 6c74 3a20 2833 302c 2d36 3029 0d0a  ault: (30,-60)..
-00018c80: 2020 2020 2020 2020 2020 2020 5468 6520              The 
-00018c90: 7665 6374 6f72 2064 6972 6563 7469 6f6e  vector direction
-00018ca0: 2066 6f72 2076 6965 7769 6e67 2028 656c   for viewing (el
-00018cb0: 6576 2c61 7a69 6d29 206f 7220 3344 6178  ev,azim) or 3Dax
-00018cc0: 6973 2e20 0d0a 0d0a 2020 2020 2020 2020  is. ....        
-00018cd0: 5265 7475 726e 730d 0a20 2020 2020 2020  Returns..       
-00018ce0: 202d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020   -------..      
-00018cf0: 2020 7365 6c66 203a 2073 7572 6661 6365    self : surface
-00018d00: 206f 626a 6563 740d 0a0d 0a20 2020 2020   object....     
-00018d10: 2020 2022 2222 0d0a 0d0a 2020 2020 2020     """....      
-00018d20: 2020 6966 2064 6972 6563 7469 6f6e 2069    if direction i
-00018d30: 7320 6e6f 7420 4e6f 6e65 3a0d 0a20 2020  s not None:..   
-00018d40: 2020 2020 2020 2020 2074 656d 7020 3d20           temp = 
-00018d50: 6469 7265 6374 696f 6e0d 0a20 2020 2020  direction..     
-00018d60: 2020 2020 2020 2074 7279 203a 2020 2320         try :  # 
-00018d70: 6368 6563 6b20 6966 2064 6972 6563 7469  check if directi
-00018d80: 6f6e 2068 6f6c 6473 2074 6865 2065 6c65  on holds the ele
-00018d90: 762c 2061 7a69 6d20 2869 652e 2033 4420  v, azim (ie. 3D 
-00018da0: 6178 6973 290d 0a20 2020 2020 2020 2020  axis)..         
-00018db0: 2020 2020 2020 2065 6c65 762c 617a 696d         elev,azim
-00018dc0: 203d 2074 656d 702e 656c 6576 2c20 7465   = temp.elev, te
-00018dd0: 6d70 2e61 7a69 6d0d 0a20 2020 2020 2020  mp.azim..       
-00018de0: 2020 2020 2020 2020 2064 6972 6563 7469           directi
-00018df0: 6f6e 203d 206e 702e 6172 7261 7928 2065  on = np.array( e
-00018e00: 6c65 765f 617a 696d 5f32 7665 6374 6f72  lev_azim_2vector
-00018e10: 2865 6c65 762c 617a 696d 2920 290d 0a20  (elev,azim) ).. 
-00018e20: 2020 2020 2020 2020 2020 2065 7863 6570             excep
-00018e30: 7420 3a0d 0a20 2020 2020 2020 2020 2020  t :..           
-00018e40: 2020 2020 2064 6972 6563 7469 6f6e 203d       direction =
-00018e50: 2074 656d 700d 0a20 2020 2020 2020 2020   temp..         
-00018e60: 2020 2020 2020 2069 6620 6c65 6e28 6469         if len(di
-00018e70: 7265 6374 696f 6e29 2021 3d20 3320 3a0d  rection) != 3 :.
-00018e80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018e90: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-00018ea0: 4572 726f 7228 2743 6c69 7020 6672 6f6d  Error('Clip from
-00018eb0: 206e 6f72 6d61 6c73 2064 6972 6563 7469   normals directi
-00018ec0: 6f6e 206d 7573 7420 6265 2061 2061 7272  on must be a arr
-00018ed0: 6179 206f 6620 6c65 6e67 7468 2033 2c20  ay of length 3, 
-00018ee0: 6f72 2061 204d 6174 706c 6f74 6c69 6220  or a Matplotlib 
-00018ef0: 4178 6573 3344 206f 626a 6563 742e 2729  Axes3D object.')
-00018f00: 0d0a 2020 2020 2020 2020 656c 7365 203a  ..        else :
-00018f10: 2064 6972 6563 7469 6f6e 203d 206e 702e   direction = np.
-00018f20: 6172 7261 7928 2065 6c65 765f 617a 696d  array( elev_azim
-00018f30: 5f32 7665 6374 6f72 2820 2a5f 4446 545f  _2vector( *_DFT_
-00018f40: 5649 4557 2029 2029 0d0a 0d0a 2020 2020  VIEW ) )....    
-00018f50: 2020 2020 7665 7274 7320 3d20 7365 6c66      verts = self
-00018f60: 2e76 6572 7465 7843 6f6f 725b 2073 656c  .vertexCoor[ sel
-00018f70: 662e 6676 496e 6469 6365 7320 5d0d 0a20  f.fvIndices ].. 
-00018f80: 2020 2020 2020 2066 6163 654e 6f72 6d61         faceNorma
-00018f90: 6c43 6f6f 7220 3d20 7365 6c66 2e5f 6765  lCoor = self._ge
-00018fa0: 745f 6661 6365 5f6e 6f72 6d61 6c73 2876  t_face_normals(v
-00018fb0: 6572 7473 290d 0a0d 0a20 2020 2020 2020  erts)....       
-00018fc0: 2073 656c 662e 5f70 6f73 7450 726f 635f   self._postProc_
-00018fd0: 7375 7266 6163 6543 6f6c 6f72 7328 290d  surfaceColors().
-00018fe0: 0a20 2020 2020 2020 206f 7269 675f 636f  .        orig_co
-00018ff0: 6c6f 7273 203d 2073 656c 662e 5f66 6163  lors = self._fac
-00019000: 6563 6f6c 6f72 730d 0a0d 0a20 2020 2020  ecolors....     
-00019010: 2020 2073 686f 756c 644b 6565 7020 3d20     shouldKeep = 
-00019020: 6e70 2e64 6f74 2866 6163 654e 6f72 6d61  np.dot(faceNorma
-00019030: 6c43 6f6f 722c 6469 7265 6374 696f 6e29  lCoor,direction)
-00019040: 203e 2030 2e30 0d0a 0d0a 2020 2020 2020   > 0.0....      
-00019050: 2020 6966 206e 702e 616e 7928 7368 6f75    if np.any(shou
-00019060: 6c64 4b65 6570 2920 6973 204e 6f6e 6520  ldKeep) is None 
-00019070: 3a0d 0a20 2020 2020 2020 2020 2020 2077  :..            w
-00019080: 6172 6e69 6e67 732e 7761 726e 2827 5741  arnings.warn('WA
-00019090: 524e 494e 473a 204e 6f72 6d61 6c20 636c  RNING: Normal cl
-000190a0: 6970 7069 6e67 2072 6573 756c 7465 6420  ipping resulted 
-000190b0: 696e 206e 6f20 6661 6365 7320 666f 756e  in no faces foun
-000190c0: 642c 2073 7572 6661 6365 2072 6574 7572  d, surface retur
-000190d0: 6e20 756e 636c 6970 7065 642e 2729 0d0a  n unclipped.')..
-000190e0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-000190f0: 726e 2073 656c 660d 0a20 2020 2020 2020  rn self..       
-00019100: 2066 7669 203d 2073 656c 662e 6676 496e   fvi = self.fvIn
-00019110: 6469 6365 735b 7368 6f75 6c64 4b65 6570  dices[shouldKeep
-00019120: 5d0d 0a20 2020 2020 2020 2066 636f 6c20  ]..        fcol 
-00019130: 3d20 6f72 6967 5f63 6f6c 6f72 735b 7368  = orig_colors[sh
-00019140: 6f75 6c64 4b65 6570 5d0d 0a0d 0a20 2020  ouldKeep]....   
-00019150: 2020 2020 2023 2074 6869 7320 7065 726d       # this perm
-00019160: 6974 7320 6d75 6c74 6970 6c65 2063 6c69  its multiple cli
-00019170: 7073 2077 6974 686f 7574 2063 6861 6e67  ps without chang
-00019180: 696e 6720 6f72 6967 696e 616c 2c20 736f  ing original, so
-00019190: 2072 6573 746f 7265 2069 7320 6176 6169   restore is avai
-000191a0: 6c61 626c 652e 0d0a 2020 2020 2020 2020  lable...        
-000191b0: 6966 2073 656c 662e 7265 7374 6f72 6564  if self.restored
-000191c0: 436c 6970 2069 7320 4e6f 6e65 203a 0d0a  Clip is None :..
-000191d0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000191e0: 2e72 6573 746f 7265 6443 6c69 7020 3d20  .restoredClip = 
-000191f0: 7b20 2766 6163 6573 2720 3a20 7365 6c66  { 'faces' : self
-00019200: 2e66 7649 6e64 6963 6573 2c20 2763 6f6c  .fvIndices, 'col
-00019210: 6f72 7327 203a 206f 7269 675f 636f 6c6f  ors' : orig_colo
-00019220: 7273 207d 0d0a 0d0a 2020 2020 2020 2020  rs }....        
-00019230: 6676 6920 3d20 6e70 2e61 7272 6179 2866  fvi = np.array(f
-00019240: 7669 290d 0a20 2020 2020 2020 2073 656c  vi)..        sel
-00019250: 662e 6676 496e 6469 6365 7320 3d20 6676  f.fvIndices = fv
-00019260: 690d 0a20 2020 2020 2020 2073 656c 662e  i..        self.
-00019270: 7365 745f 636f 6c6f 7228 6663 6f6c 2920  set_color(fcol) 
-00019280: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00019290: 2076 203d 2073 656c 662e 7665 7274 6578   v = self.vertex
-000192a0: 436f 6f72 0d0a 2020 2020 2020 2020 7666  Coor..        vf
-000192b0: 7669 203d 2076 5b66 7669 5d0d 0a20 2020  vi = v[fvi]..   
-000192c0: 2020 2020 2073 656c 662e 7365 745f 7665       self.set_ve
-000192d0: 7274 7328 2076 6676 6920 290d 0a0d 0a20  rts( vfvi ).... 
-000192e0: 2020 2020 2020 2063 6c69 7056 6572 7473         clipVerts
-000192f0: 2020 3d20 6e70 2e72 6573 6861 7065 2876    = np.reshape(v
-00019300: 6676 692c 282d 312c 3329 290d 0a20 2020  fvi,(-1,3))..   
-00019310: 2020 2020 205f 7365 745f 6765 6f6d 426f       _set_geomBo
-00019320: 756e 6473 2820 636c 6970 5665 7274 732c  unds( clipVerts,
-00019330: 7365 6c66 2e62 6f75 6e64 7320 290d 0a20  self.bounds ).. 
-00019340: 2020 2020 2020 2073 656c 662e 5f73 6574         self._set
-00019350: 5f69 6e64 6578 5f72 656c 6174 696f 6e73  _index_relations
-00019360: 2829 0d0a 2020 2020 2020 2020 7265 7475  ()..        retu
-00019370: 726e 2073 656c 660d 0a0d 0a20 2020 2064  rn self....    d
-00019380: 6566 205f 7265 7374 6f72 655f 6672 6f6d  ef _restore_from
-00019390: 5f63 6c69 7028 7365 6c66 2920 3a0d 0a20  _clip(self) :.. 
-000193a0: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
-000193b0: 2020 2020 5265 7365 7420 6661 6365 2061      Reset face a
-000193c0: 6e64 2063 6f6c 6f72 7320 7072 696f 7220  nd colors prior 
-000193d0: 746f 2061 6e79 2063 6c69 7020 6f70 6572  to any clip oper
-000193e0: 6174 696f 6e2e 0d0a 2020 2020 2020 2020  ation...        
-000193f0: 2869 6e20 6465 7665 6c6f 706d 656e 7429  (in development)
-00019400: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
-00019410: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00019420: 2023 2046 7574 4465 763a 2074 6869 7320   # FutDev: this 
-00019430: 6d65 7468 6f64 206e 6565 6473 2074 686f  method needs tho
-00019440: 726f 7567 6820 7465 7374 696e 672e 0d0a  rough testing...
-00019450: 2020 2020 2020 2020 2320 7072 6f62 6162          # probab
-00019460: 6c79 2064 6f65 736e 2774 2077 6f72 6b20  ly doesn't work 
-00019470: 6173 2069 732e 0d0a 2020 2020 2020 2020  as is...        
-00019480: 6966 2073 656c 662e 7265 7374 6f72 6564  if self.restored
-00019490: 436c 6970 2069 7320 4e6f 6e65 203a 0d0a  Clip is None :..
-000194a0: 2020 2020 2020 2020 2020 2020 7761 726e              warn
-000194b0: 696e 6773 2e77 6172 6e28 2754 6865 7265  ings.warn('There
-000194c0: 2069 7320 6e6f 2063 6c69 7070 6564 2073   is no clipped s
-000194d0: 7572 6661 6365 2074 6f20 7265 7374 6f72  urface to restor
-000194e0: 652e 2729 0d0a 2020 2020 2020 2020 2020  e.')..          
-000194f0: 2020 7265 7475 726e 2073 656c 660d 0a20    return self.. 
-00019500: 2020 2020 2020 2066 7669 203d 2073 656c         fvi = sel
-00019510: 662e 7265 7374 6f72 6564 436c 6970 5b27  f.restoredClip['
-00019520: 6661 6365 7327 5d0d 0a20 2020 2020 2020  faces']..       
-00019530: 2066 636f 6c20 3d20 7365 6c66 2e72 6573   fcol = self.res
-00019540: 746f 7265 6443 6c69 705b 2763 6f6c 6f72  toredClip['color
-00019550: 7327 5d0d 0a20 2020 2020 2020 2073 656c  s']..        sel
-00019560: 662e 7265 7374 6f72 6564 436c 6970 203d  f.restoredClip =
-00019570: 204e 6f6e 650d 0a20 2020 2020 2020 2073   None..        s
-00019580: 656c 662e 6676 496e 6469 6365 7320 3d20  elf.fvIndices = 
-00019590: 6676 690d 0a20 2020 2020 2020 2073 656c  fvi..        sel
-000195a0: 662e 7365 745f 636f 6c6f 7228 6663 6f6c  f.set_color(fcol
-000195b0: 2920 2020 2020 2020 200d 0a20 2020 2020  )        ..     
-000195c0: 2020 2076 203d 2073 656c 662e 7665 7274     v = self.vert
-000195d0: 6578 436f 6f72 0d0a 2020 2020 2020 2020  exCoor..        
-000195e0: 7365 6c66 2e73 6574 5f76 6572 7473 2876  self.set_verts(v
-000195f0: 5b20 6e70 2e61 7272 6179 2866 7669 2920  [ np.array(fvi) 
-00019600: 5d29 0d0a 2020 2020 2020 2020 7365 6c66  ])..        self
-00019610: 2e5f 7365 745f 6765 6f6d 6574 7269 635f  ._set_geometric_
-00019620: 626f 756e 6473 2829 2023 2072 6573 6574  bounds() # reset
-00019630: 2074 6f20 6f72 6967 696e 616c 2062 6f75   to original bou
-00019640: 6e64 732e 2e2e 0d0a 2020 2020 2020 2020  nds.....        
-00019650: 7265 7475 726e 2073 656c 660d 0a0d 0a20  return self.... 
-00019660: 2020 2064 6566 2073 6574 5f73 7572 6661     def set_surfa
-00019670: 6365 5f61 6c70 6861 2873 656c 662c 2061  ce_alpha(self, a
-00019680: 6c70 6861 2c20 636f 6e73 7461 6e74 3d46  lpha, constant=F
-00019690: 616c 7365 2c20 6164 6a75 7374 6c77 3d54  alse, adjustlw=T
-000196a0: 7275 6529 203a 0d0a 2020 2020 2020 2020  rue) :..        
-000196b0: 2222 220d 0a20 2020 2020 2020 2041 646a  """..        Adj
-000196c0: 7573 7420 7468 6520 6661 6365 2063 6f6c  ust the face col
-000196d0: 6f72 2061 6c70 6861 2076 616c 7565 7320  or alpha values 
-000196e0: 616e 6420 6c69 6e65 7769 6474 6820 6f66  and linewidth of
-000196f0: 2074 6865 2073 7572 6661 6365 2e0d 0a0d   the surface....
-00019700: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-00019710: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
-00019720: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-00019730: 2061 6c70 6861 203a 2073 6361 6c61 720d   alpha : scalar.
-00019740: 0a20 2020 2020 2020 2020 2020 2020 2041  .              A
-00019750: 6c70 6861 2069 7320 696e 2074 6865 2072  lpha is in the r
-00019760: 616e 6765 2030 2074 6f20 312e 0d0a 0d0a  ange 0 to 1.....
-00019770: 2020 2020 2020 2020 636f 6e73 7461 6e74          constant
-00019780: 203a 2062 6f6f 6c20 7b20 5472 7565 2c20   : bool { True, 
-00019790: 4661 6c73 6520 7d2c 206f 7074 696f 6e61  False }, optiona
-000197a0: 6c2c 2046 616c 7365 0d0a 2020 2020 2020  l, False..      
-000197b0: 2020 2020 2020 4966 2046 616c 7365 2c20        If False, 
-000197c0: 6661 6365 2063 6f6c 6f72 2076 616c 7565  face color value
-000197d0: 7320 6172 6520 6d75 6c74 6970 6c69 6564  s are multiplied
-000197e0: 2062 790d 0a20 2020 2020 2020 2020 2020   by..           
-000197f0: 2061 6c70 6861 2e20 2049 6620 5472 7565   alpha.  If True
-00019800: 2c20 616c 6c20 6661 6365 2063 6f6c 6f72  , all face color
-00019810: 7320 616c 7068 6120 6368 616e 6e65 6c73  s alpha channels
-00019820: 0d0a 2020 2020 2020 2020 2020 2020 6172  ..            ar
-00019830: 6520 6173 7369 676e 6564 2074 6f20 616c  e assigned to al
-00019840: 7068 612e 0d0a 0d0a 2020 2020 2020 2020  pha.....        
-00019850: 6164 6a75 7374 6c77 203a 2062 6f6f 6c20  adjustlw : bool 
-00019860: 7b20 5472 7565 2c20 4661 6c73 6520 7d2c  { True, False },
-00019870: 206f 7074 696f 6e61 6c2c 2054 7275 650d   optional, True.
-00019880: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
-00019890: 5472 7565 2c20 7468 6520 7375 7266 6163  True, the surfac
-000198a0: 6520 6c69 6e65 7769 6474 6820 7769 6c6c  e linewidth will
-000198b0: 2062 6520 7365 740d 0a20 2020 2020 2020   be set..       
-000198c0: 2020 2020 2074 6f20 6d61 6b65 2074 6865       to make the
-000198d0: 2065 6467 6573 2076 6973 7561 6c6c 7920   edges visually 
-000198e0: 7472 616e 7370 6172 656e 7420 7769 7468  transparent with
-000198f0: 0d0a 2020 2020 2020 2020 2020 2020 7468  ..            th
-00019900: 6520 6661 6365 7320 666f 7220 4d61 7470  e faces for Matp
-00019910: 6c6f 746c 6962 2072 656e 6465 7269 6e67  lotlib rendering
-00019920: 2e0d 0a20 2020 2020 2020 2020 2020 200d  ...            .
-00019930: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-00019940: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-00019950: 2d0d 0a20 2020 2020 2020 2073 656c 6620  -..        self 
-00019960: 3a20 7375 7266 6163 6520 6f62 6a65 6374  : surface object
-00019970: 0d0a 0d0a 2020 2020 2020 2020 2222 220d  ....        """.
-00019980: 0a0d 0a20 2020 2020 2020 2069 6620 2861  ...        if (a
-00019990: 6c70 6861 3c30 2e30 2920 6f72 2028 616c  lpha<0.0) or (al
-000199a0: 7068 613e 312e 3029 203a 0d0a 2020 2020  pha>1.0) :..    
-000199b0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-000199c0: 6c75 6545 7272 6f72 2827 7375 7266 6163  lueError('surfac
-000199d0: 6520 616c 7068 6120 6d75 7374 2062 6520  e alpha must be 
-000199e0: 6265 7477 6565 6e20 3020 616e 6420 312c  between 0 and 1,
-000199f0: 2066 6f75 6e64 207b 7d27 2e66 6f72 6d61   found {}'.forma
-00019a00: 7428 616c 7068 6129 290d 0a0d 0a20 2020  t(alpha))....   
-00019a10: 2020 2020 2073 656c 662e 5f70 6f73 7450       self._postP
-00019a20: 726f 635f 7375 7266 6163 6543 6f6c 6f72  roc_surfaceColor
-00019a30: 7328 290d 0a20 2020 2020 2020 206f 7269  s()..        ori
-00019a40: 675f 636f 6c6f 7273 203d 2073 656c 662e  g_colors = self.
-00019a50: 5f66 6163 6563 6f6c 6f72 730d 0a20 2020  _facecolors..   
-00019a60: 2020 2020 2069 6620 636f 6e73 7461 6e74       if constant
-00019a70: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
-00019a80: 6e70 2e70 7574 5f61 6c6f 6e67 5f61 7869  np.put_along_axi
-00019a90: 7328 6f72 6967 5f63 6f6c 6f72 732c 206e  s(orig_colors, n
-00019aa0: 702e 6172 7261 7928 5b5b 335d 5d29 2c20  p.array([[3]]), 
-00019ab0: 616c 7068 612c 2061 7869 733d 3129 0d0a  alpha, axis=1)..
-00019ac0: 2020 2020 2020 2020 2020 2020 636f 6c6f              colo
-00019ad0: 724d 6170 203d 206f 7269 675f 636f 6c6f  rMap = orig_colo
-00019ae0: 7273 0d0a 2020 2020 2020 2020 656c 7365  rs..        else
-00019af0: 3a0d 0a20 2020 2020 2020 2020 2020 2063  :..            c
-00019b00: 6f6c 6f72 4d61 7020 3d20 6e70 2e6d 756c  olorMap = np.mul
-00019b10: 7469 706c 7928 6f72 6967 5f63 6f6c 6f72  tiply(orig_color
-00019b20: 732c 6e70 2e61 7272 6179 285b 312e 302c  s,np.array([1.0,
-00019b30: 312e 302c 312e 302c 616c 7068 615d 2929  1.0,1.0,alpha]))
-00019b40: 0d0a 2020 2020 2020 2020 7365 6c66 2e73  ..        self.s
-00019b50: 6574 5f63 6f6c 6f72 2863 6f6c 6f72 4d61  et_color(colorMa
-00019b60: 7029 2020 2020 2020 0d0a 2020 2020 2020  p)      ..      
-00019b70: 2020 6966 2061 646a 7573 746c 7720 3a20    if adjustlw : 
-00019b80: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-00019b90: 6865 7572 6973 7469 6320 6170 7072 6f61  heuristic approa
-00019ba0: 6368 2074 6f20 6869 6464 696e 6720 6661  ch to hidding fa
-00019bb0: 6365 2065 6467 6573 2e0d 0a20 2020 2020  ce edges...     
-00019bc0: 2020 2020 2020 206c 7720 3d20 2030 2e30         lw =  0.0
-00019bd0: 3036 332a 6e70 2e65 7870 2834 2e32 2a61  063*np.exp(4.2*a
-00019be0: 6c70 6861 290d 0a20 2020 2020 2020 2020  lpha)..         
-00019bf0: 2020 2073 656c 662e 7365 745f 6c69 6e65     self.set_line
-00019c00: 7769 6474 6828 6c77 290d 0a20 2020 2020  width(lw)..     
-00019c10: 2020 2072 6574 7572 6e20 7365 6c66 2020     return self  
-00019c20: 200d 0a20 2020 0d0a 2020 2020 6465 6620   ..   ..    def 
-00019c30: 7368 6164 6528 7365 6c66 2c20 6465 7074  shade(self, dept
-00019c40: 683d 302c 2064 6972 6563 7469 6f6e 3d4e  h=0, direction=N
-00019c50: 6f6e 652c 2063 6f6e 7472 6173 743d 4e6f  one, contrast=No
-00019c60: 6e65 2c20 6973 4162 733d 4661 6c73 652c  ne, isAbs=False,
-00019c70: 2061 783d 4e6f 6e65 2c20 7276 6965 773d   ax=None, rview=
-00019c80: 4661 6c73 6529 203a 0d0a 2020 2020 2020  False) :..      
-00019c90: 2020 2222 220d 0a20 2020 2020 2020 2052    """..        R
-00019ca0: 6564 7563 6520 7375 7266 6163 6520 4853  educe surface HS
-00019cb0: 5620 636f 6c6f 7220 5661 6c75 6520 6261  V color Value ba
-00019cc0: 7365 6420 6f6e 2066 6163 6520 6e6f 726d  sed on face norm
-00019cd0: 616c 732e 0d0a 2020 2020 2020 2020 0d0a  als...        ..
-00019ce0: 2020 2020 2020 2020 5468 6520 646f 7420          The dot 
-00019cf0: 7072 6f64 7563 7420 6f66 2066 6163 6520  product of face 
-00019d00: 6e6f 726d 616c 7320 7769 7468 2074 6865  normals with the
-00019d10: 2069 6c6c 756d 696e 6174 696f 6e20 6469   illumination di
-00019d20: 7265 6374 696f 6e20 0d0a 2020 2020 2020  rection ..      
-00019d30: 2020 6973 2075 7365 6420 746f 2061 646a    is used to adj
-00019d40: 7573 7420 6661 6365 2048 5356 2063 6f6c  ust face HSV col
-00019d50: 6f72 2076 616c 7565 2e0d 0a0d 0a20 2020  or value.....   
-00019d60: 2020 2020 2050 6172 616d 6574 6572 730d       Parameters.
-00019d70: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00019d80: 2d2d 2d0d 0a20 2020 2020 2020 2064 6570  ---..        dep
-00019d90: 7468 203a 2073 6361 6c61 722c 206f 7074  th : scalar, opt
-00019da0: 696f 6e61 6c2c 2064 6566 6175 6c74 3a20  ional, default: 
-00019db0: 300d 0a20 2020 2020 2020 2020 2020 204d  0..            M
-00019dc0: 696e 696d 756d 2063 6f6c 6f72 2076 616c  inimum color val
-00019dd0: 7565 206f 6620 7368 6164 6564 2073 7572  ue of shaded sur
-00019de0: 6661 6365 2066 6163 6573 2e0d 0a20 2020  face faces...   
-00019df0: 2020 2020 2020 2020 2044 6570 7468 2076           Depth v
-00019e00: 616c 7565 2072 616e 6765 7320 6672 6f6d  alue ranges from
-00019e10: 2030 2074 6f20 312e 0d0a 0d0a 2020 2020   0 to 1.....    
-00019e20: 2020 2020 6469 7265 6374 696f 6e20 3a20      direction : 
-00019e30: 6172 7261 792d 6c69 6b65 2c20 6f70 7469  array-like, opti
-00019e40: 6f6e 616c 2c20 6465 6661 756c 743a 2028  onal, default: (
-00019e50: 312c 302c 3129 0d0a 2020 2020 2020 2020  1,0,1)..        
-00019e60: 2020 2020 4120 7879 7a20 7665 6374 6f72      A xyz vector
-00019e70: 2070 6f69 6e74 696e 6720 746f 2074 6865   pointing to the
-00019e80: 2069 6c6c 756d 696e 6174 696f 6e20 736f   illumination so
-00019e90: 7572 6365 2e20 0d0a 0d0a 2020 2020 2020  urce. ....      
-00019ea0: 2020 636f 6e74 7261 7374 203a 2073 6361    contrast : sca
-00019eb0: 6c61 722c 206f 7074 696f 6e61 6c2c 2064  lar, optional, d
-00019ec0: 6566 6175 6c74 3a20 310d 0a20 2020 2020  efault: 1..     
-00019ed0: 2020 2020 2020 2053 6861 6469 6e67 2063         Shading c
-00019ee0: 6f6e 7472 6173 7420 6164 6a75 7374 6d65  ontrast adjustme
-00019ef0: 6e74 2066 726f 6d20 6c6f 7720 746f 2068  nt from low to h
-00019f00: 6967 6820 7769 7468 2061 2076 616c 7565  igh with a value
-00019f10: 0d0a 2020 2020 2020 2020 2020 2020 6f66  ..            of
-00019f20: 2031 2066 6f72 206c 696e 6561 7220 7661   1 for linear va
-00019f30: 7269 6174 696f 6e73 2077 6974 6820 7468  riations with th
-00019f40: 6520 6e6f 726d 616c 2064 6972 6563 7469  e normal directi
-00019f50: 6f6e 2e0d 0a20 2020 2020 2020 2020 2020  on...           
-00019f60: 2043 6f6e 7472 6173 7420 7661 6c75 6520   Contrast value 
-00019f70: 7261 6e67 6573 2066 726f 6d20 302e 3120  ranges from 0.1 
-00019f80: 746f 2033 2e20 2020 2020 0d0a 2020 2020  to 3.     ..    
-00019f90: 2020 2020 0d0a 2020 2020 2020 2020 6973      ..        is
-00019fa0: 4162 7320 3a20 626f 6f6c 2c20 6f70 7469  Abs : bool, opti
-00019fb0: 6f6e 616c 2c20 6465 6661 756c 743a 2046  onal, default: F
-00019fc0: 616c 7365 0d0a 2020 2020 2020 2020 2020  alse..          
-00019fd0: 2020 4966 2054 7275 652c 2074 6865 2061    If True, the a
-00019fe0: 6273 6f6c 7574 6520 7661 6c75 6520 6f66  bsolute value of
-00019ff0: 2074 6865 2064 6f74 2070 726f 6475 6374   the dot product
-0001a000: 2069 730d 0a20 2020 2020 2020 2020 2020   is..           
-0001a010: 2069 7320 7573 6564 2074 6f20 6465 7465   is used to dete
-0001a020: 726d 696e 6520 636f 6c6f 7220 7661 6c75  rmine color valu
-0001a030: 652e 0d0a 0d0a 2020 2020 2020 2020 6178  e.....        ax
-0001a040: 203a 204d 6174 706c 6f74 6c69 6220 3344   : Matplotlib 3D
-0001a050: 2061 7865 732e 0d0a 0d0a 2020 2020 2020   axes.....      
-0001a060: 2020 7276 6965 7720 3a20 626f 6f6c 6561    rview : boolea
-0001a070: 6e2c 2064 6566 6175 6c74 3a20 4661 6c73  n, default: Fals
-0001a080: 650d 0a20 2020 2020 2020 2020 2020 2049  e..            I
-0001a090: 6620 5472 7565 2c20 6469 7265 6374 696f  f True, directio
-0001a0a0: 6e20 6973 2072 656c 6174 6976 6520 746f  n is relative to
-0001a0b0: 2074 6865 2076 6965 772c 0d0a 2020 2020   the view,..    
-0001a0c0: 2020 2020 2020 2020 206f 7468 6572 7769           otherwi
-0001a0d0: 7365 2c20 7265 6c61 7469 7665 2074 6f20  se, relative to 
-0001a0e0: 7468 6520 6178 6573 2e0d 0a0d 0a20 2020  the axes.....   
-0001a0f0: 2020 2020 2052 6574 7572 6e73 0d0a 2020       Returns..  
-0001a100: 2020 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20        -------.. 
-0001a110: 2020 2020 2020 2073 656c 6620 3a20 7375         self : su
-0001a120: 7266 6163 6520 6f62 6a65 6374 0d0a 0d0a  rface object....
-0001a130: 2020 2020 2020 2020 2222 220d 0a0d 0a20          """.... 
-0001a140: 2020 2020 2020 2069 6620 6469 7265 6374         if direct
-0001a150: 696f 6e20 6973 204e 6f6e 6520 3a20 6469  ion is None : di
-0001a160: 7265 6374 696f 6e20 3d20 5f49 4c4c 554d  rection = _ILLUM
-0001a170: 0d0a 2020 2020 2020 2020 7669 6577 6469  ..        viewdi
-0001a180: 722c 6175 7366 203d 204e 6f6e 652c 4e6f  r,ausf = None,No
-0001a190: 6e65 0d0a 2020 2020 2020 2020 6966 2061  ne..        if a
-0001a1a0: 7820 6973 206e 6f74 204e 6f6e 653a 0d0a  x is not None:..
-0001a1b0: 2020 2020 2020 2020 2020 2020 6175 7366              ausf
-0001a1c0: 203d 205f 6178 6973 5553 4628 6178 290d   = _axisUSF(ax).
-0001a1d0: 0a20 2020 2020 2020 2020 2020 2076 6965  .            vie
-0001a1e0: 7764 6972 203d 2065 6c65 765f 617a 696d  wdir = elev_azim
-0001a1f0: 5f32 7665 6374 6f72 2861 782e 656c 6576  _2vector(ax.elev
-0001a200: 2c61 782e 617a 696d 290d 0a20 2020 2020  ,ax.azim)..     
-0001a210: 2020 2020 2020 2069 6620 7276 6965 7720         if rview 
-0001a220: 3a20 6469 7265 6374 696f 6e20 3d20 7274  : direction = rt
-0001a230: 7628 6469 7265 6374 696f 6e2c 6178 2e65  v(direction,ax.e
-0001a240: 6c65 762c 6178 2e61 7a69 6d29 0d0a 0d0a  lev,ax.azim)....
-0001a250: 2020 2020 2020 2020 6966 206e 702e 616e          if np.an
-0001a260: 7928 2028 6465 7074 683c 3029 207c 2028  y( (depth<0) | (
-0001a270: 6465 7074 683e 3129 2029 203a 0d0a 2020  depth>1) ) :..  
-0001a280: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0001a290: 5661 6c75 6545 7272 6f72 2827 6465 7074  ValueError('dept
-0001a2a0: 6820 7661 6c75 6573 2c20 7b7d 2c20 6d75  h values, {}, mu
-0001a2b0: 7374 2062 6520 6265 7477 6565 6e20 3020  st be between 0 
-0001a2c0: 616e 6420 3127 2e66 6f72 6d61 7428 6465  and 1'.format(de
-0001a2d0: 7074 6829 290d 0a20 2020 2020 2020 2069  pth))..        i
-0001a2e0: 6620 636f 6e74 7261 7374 2069 7320 6e6f  f contrast is no
-0001a2f0: 7420 4e6f 6e65 3a0d 0a20 2020 2020 2020  t None:..       
-0001a300: 2020 2020 2069 6620 2863 6f6e 7472 6173       if (contras
-0001a310: 743c 302e 3120 6f72 2063 6f6e 7472 6173  t<0.1 or contras
-0001a320: 743e 3329 203a 0d0a 2020 2020 2020 2020  t>3) :..        
-0001a330: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-0001a340: 6c75 6545 7272 6f72 2827 636f 6e74 7261  lueError('contra
-0001a350: 7374 206d 7573 7420 6265 2062 6574 7765  st must be betwe
-0001a360: 656e 2030 2e31 2061 6e64 2033 2e20 2c20  en 0.1 and 3. , 
-0001a370: 666f 756e 6420 7b7d 272e 666f 726d 6174  found {}'.format
-0001a380: 2863 6f6e 7472 6173 7429 290d 0a20 2020  (contrast))..   
-0001a390: 200d 0a20 2020 2020 2020 2076 6572 7473   ..        verts
-0001a3a0: 203d 2073 656c 662e 7665 7274 6578 436f   = self.vertexCo
-0001a3b0: 6f72 5b20 6e70 2e61 7272 6179 2873 656c  or[ np.array(sel
-0001a3c0: 662e 6676 496e 6469 6365 7329 205d 0d0a  f.fvIndices) ]..
-0001a3d0: 2020 2020 2020 2020 6e6f 726d 7320 3d20          norms = 
-0001a3e0: 7365 6c66 2e5f 6765 745f 6661 6365 5f6e  self._get_face_n
-0001a3f0: 6f72 6d61 6c73 2876 6572 7473 2c61 7573  ormals(verts,aus
-0001a400: 6629 0d0a 2020 2020 2020 2020 756e 6974  f)..        unit
-0001a410: 4469 7265 6374 696f 6e20 3d20 6e70 2e64  Direction = np.d
-0001a420: 6976 6964 6528 2064 6972 6563 7469 6f6e  ivide( direction
-0001a430: 2c20 6e70 2e6c 696e 616c 672e 6e6f 726d  , np.linalg.norm
-0001a440: 2864 6972 6563 7469 6f6e 2920 290d 0a20  (direction) ).. 
-0001a450: 2020 2020 2020 2064 7072 6f64 203d 206e         dprod = n
-0001a460: 702e 646f 7428 206e 6f72 6d73 2c20 756e  p.dot( norms, un
-0001a470: 6974 4469 7265 6374 696f 6e20 290d 0a0d  itDirection )...
-0001a480: 0a20 2020 2020 2020 2069 6620 7669 6577  .        if view
-0001a490: 6469 7220 6973 206e 6f74 204e 6f6e 6520  dir is not None 
-0001a4a0: 3a0d 0a20 2020 2020 2020 2020 2020 2076  :..            v
-0001a4b0: 646f 7420 3d20 6e70 2e64 6f74 286e 6f72  dot = np.dot(nor
-0001a4c0: 6d73 2c76 6965 7764 6972 290d 0a20 2020  ms,viewdir)..   
-0001a4d0: 2020 2020 2020 2020 2064 7072 6f64 203d           dprod =
-0001a4e0: 206e 702e 7768 6572 6528 6e70 2e6c 6573   np.where(np.les
-0001a4f0: 7328 7664 6f74 2c5b 302e 305d 292c 2d64  s(vdot,[0.0]),-d
-0001a500: 7072 6f64 2c64 7072 6f64 290d 0a0d 0a20  prod,dprod).... 
-0001a510: 2020 2020 2020 2023 2030 3c64 3c31 2c20         # 0<d<1, 
-0001a520: 6865 7572 6973 7469 6320 6675 6e63 7469  heuristic functi
-0001a530: 6f6e 2066 6f72 200d 0a20 2020 2020 2020  on for ..       
-0001a540: 2023 206e 6f72 6d61 6c69 7a65 6420 646f   # normalized do
-0001a550: 6d61 696e 206f 6620 6566 6665 6374 6976  main of effectiv
-0001a560: 6520 646f 7420 7072 6f64 7563 742c 2064  e dot product, d
-0001a570: 3d66 2864 7072 6f64 290d 0a20 2020 2020  =f(dprod)..     
-0001a580: 2020 2069 6620 6973 4162 7320 3a20 6420     if isAbs : d 
-0001a590: 3d20 3120 2d20 6e70 2e61 6273 2864 7072  = 1 - np.abs(dpr
-0001a5a0: 6f64 290d 0a20 2020 2020 2020 2065 6c73  od)..        els
-0001a5b0: 6520 3a0d 0a20 2020 2020 2020 2020 2020  e :..           
-0001a5c0: 2064 203d 2028 2064 7072 6f64 202b 2031   d = ( dprod + 1
-0001a5d0: 2029 2f32 0d0a 2020 2020 2020 2020 6420   )/2..        d 
-0001a5e0: 3d20 6e70 2e61 6273 2864 2920 2023 2074  = np.abs(d)  # t
-0001a5f0: 6f20 696e 7375 7265 2070 6f73 6974 6976  o insure positiv
-0001a600: 6520 7661 6c75 6573 206e 6561 7220 7a65  e values near ze
-0001a610: 726f 0d0a 0d0a 2020 2020 2020 2020 6966  ro....        if
-0001a620: 2063 6f6e 7472 6173 7420 6973 206e 6f74   contrast is not
-0001a630: 204e 6f6e 6520 3a0d 0a20 2020 2020 2020   None :..       
-0001a640: 2020 2020 2064 203d 2020 302e 352a 2820       d =  0.5*( 
-0001a650: 3120 2b20 6e70 2e73 6967 6e28 6470 726f  1 + np.sign(dpro
-0001a660: 6429 2a6e 702e 706f 7765 7228 206e 702e  d)*np.power( np.
-0001a670: 6162 7328 6470 726f 6429 202c 2031 2f63  abs(dprod) , 1/c
-0001a680: 6f6e 7472 6173 7429 2029 2020 2020 2020  ontrast) )      
-0001a690: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-0001a6a0: 2020 2020 2320 6578 7472 6163 7420 4853      # extract HS
-0001a6b0: 562c 206c 6561 7669 6e67 2061 6c70 6861  V, leaving alpha
-0001a6c0: 2075 6e63 6861 6e67 6564 2e0d 0a20 2020   unchanged...   
-0001a6d0: 2020 2020 2073 656c 662e 5f70 6f73 7450       self._postP
-0001a6e0: 726f 635f 7375 7266 6163 6543 6f6c 6f72  roc_surfaceColor
-0001a6f0: 7328 290d 0a20 2020 2020 2020 206f 7269  s()..        ori
-0001a700: 675f 636f 6c6f 7273 203d 2073 656c 662e  g_colors = self.
-0001a710: 5f66 6163 6563 6f6c 6f72 730d 0a20 2020  _facecolors..   
-0001a720: 2020 2020 2061 6c70 6861 7320 3d20 6f72       alphas = or
-0001a730: 6967 5f63 6f6c 6f72 735b 3a2c 333a 345d  ig_colors[:,3:4]
-0001a740: 0d0a 2020 2020 2020 2020 6663 5f6c 6573  ..        fc_les
-0001a750: 735f 616c 7068 6120 3d20 6f72 6967 5f63  s_alpha = orig_c
-0001a760: 6f6c 6f72 735b 3a2c 3a33 5d0d 0a20 2020  olors[:,:3]..   
-0001a770: 2020 2020 2068 7376 5f76 616c 7320 3d20       hsv_vals = 
-0001a780: 636d 2e63 6f6c 6f72 732e 7267 625f 746f  cm.colors.rgb_to
-0001a790: 5f68 7376 2866 635f 6c65 7373 5f61 6c70  _hsv(fc_less_alp
-0001a7a0: 6861 290d 0a0d 0a20 2020 2020 2020 2023  ha)....        #
-0001a7b0: 2061 646a 7573 7420 636f 6c6f 7220 7661   adjust color va
-0001a7c0: 6c75 6520 7769 7468 206d 756c 7469 706c  lue with multipl
-0001a7d0: 6965 722e 0d0a 2020 2020 2020 2020 6376  ier...        cv
-0001a7e0: 6d20 3d20 2828 312d 6465 7074 6829 2a64  m = ((1-depth)*d
-0001a7f0: 202b 2064 6570 7468 2a6e 702e 6f6e 6573   + depth*np.ones
-0001a800: 286c 656e 2864 2929 295b 3a2c 206e 702e  (len(d)))[:, np.
-0001a810: 6e65 7761 7869 735d 0d0a 2020 2020 2020  newaxis]..      
-0001a820: 2020 6873 765f 7661 6c73 5b3a 2c32 5d20    hsv_vals[:,2] 
-0001a830: 3d20 2863 766d 2a68 7376 5f76 616c 735b  = (cvm*hsv_vals[
-0001a840: 3a2c 323a 335d 295b 3a2c 305d 0d0a 2020  :,2:3])[:,0]..  
-0001a850: 2020 2020 2020 7267 625f 7661 6c73 203d        rgb_vals =
-0001a860: 2020 636d 2e63 6f6c 6f72 732e 6873 765f    cm.colors.hsv_
-0001a870: 746f 5f72 6762 2868 7376 5f76 616c 7329  to_rgb(hsv_vals)
-0001a880: 0d0a 2020 2020 2020 2020 7368 6164 655f  ..        shade_
-0001a890: 636f 6c6f 7273 203d 206e 702e 636f 6e63  colors = np.conc
-0001a8a0: 6174 656e 6174 6528 2872 6762 5f76 616c  atenate((rgb_val
-0001a8b0: 732c 2061 6c70 6861 7329 2c20 6178 6973  s, alphas), axis
-0001a8c0: 3d31 290d 0a20 2020 2020 2020 2073 656c  =1)..        sel
-0001a8d0: 662e 7365 745f 636f 6c6f 7228 7368 6164  f.set_color(shad
-0001a8e0: 655f 636f 6c6f 7273 2920 2023 204e 4f54  e_colors)  # NOT
-0001a8f0: 453a 2074 6869 7320 7769 6c6c 2061 6c73  E: this will als
-0001a900: 6f20 7365 7420 6170 7072 6f70 7269 6174  o set appropriat
-0001a910: 6520 6564 6765 2063 6f6c 6f72 732e 0d0a  e edge colors...
-0001a920: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0001a930: 656c 660d 0a0d 0a20 2020 2064 6566 2068  elf....    def h
-0001a940: 696c 6974 6528 7365 6c66 2c20 6865 6967  ilite(self, heig
-0001a950: 6874 3d31 2c20 6469 7265 6374 696f 6e3d  ht=1, direction=
-0001a960: 4e6f 6e65 2c20 666f 6375 733d 4e6f 6e65  None, focus=None
-0001a970: 2c20 6178 3d4e 6f6e 652c 2072 7669 6577  , ax=None, rview
-0001a980: 3d46 616c 7365 2920 3a0d 0a20 2020 2020  =False) :..     
-0001a990: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
-0001a9a0: 496e 6372 6561 7365 2073 7572 6661 6365  Increase surface
-0001a9b0: 2048 5356 2063 6f6c 6f72 2056 616c 7565   HSV color Value
-0001a9c0: 2061 6e64 2072 6564 7563 6520 5361 7475   and reduce Satu
-0001a9d0: 7261 7469 6f6e 2c20 6261 7365 6420 6f6e  ration, based on
-0001a9e0: 2066 6163 6520 6e6f 726d 616c 732e 0d0a   face normals...
-0001a9f0: 0d0a 2020 2020 2020 2020 5468 6520 646f  ..        The do
-0001aa00: 7420 7072 6f64 7563 7420 6f66 2066 6163  t product of fac
-0001aa10: 6520 6e6f 726d 616c 7320 7769 7468 2074  e normals with t
-0001aa20: 6865 2069 6c6c 756d 696e 6174 696f 6e20  he illumination 
-0001aa30: 6469 7265 6374 696f 6e20 0d0a 2020 2020  direction ..    
-0001aa40: 2020 2020 6973 2075 7365 6420 746f 2061      is used to a
-0001aa50: 646a 7573 7420 6661 6365 2048 5356 2063  djust face HSV c
-0001aa60: 6f6c 6f72 2076 616c 7565 2061 6e64 2073  olor value and s
-0001aa70: 6174 7572 6174 696f 6e2e 0d0a 2020 2020  aturation...    
-0001aa80: 2020 2020 4661 6365 7320 6861 7669 6e67      Faces having
-0001aa90: 206e 6f72 6d61 6c73 2077 6974 6820 6120   normals with a 
-0001aaa0: 6e65 6761 7469 7665 2063 6f6d 706f 6e65  negative compone
-0001aab0: 6e74 2069 6e20 7468 6520 6469 7265 6374  nt in the direct
-0001aac0: 696f 6e20 6f66 0d0a 2020 2020 2020 2020  ion of..        
-0001aad0: 696c 6c75 6d69 6e61 7469 6f6e 2061 7265  illumination are
-0001aae0: 206e 6f74 2061 6666 6563 7465 642e 2054   not affected. T
-0001aaf0: 6865 2072 6564 7563 7469 6f6e 206f 6620  he reduction of 
-0001ab00: 636f 6c6f 7220 7361 7475 7261 7469 6f6e  color saturation
-0001ab10: 2069 730d 0a20 2020 2020 2020 2070 726f   is..        pro
-0001ab20: 706f 7274 696f 6e61 6c20 746f 2074 6865  portional to the
-0001ab30: 2069 6e63 7265 6173 6520 696e 2063 6f6c   increase in col
-0001ab40: 6f72 2076 616c 7565 2e0d 0a0d 0a20 2020  or value.....   
-0001ab50: 2020 2020 2050 6172 616d 6574 6572 730d       Parameters.
-0001ab60: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0001ab70: 2d2d 2d0d 0a20 2020 2020 2020 2068 6569  ---..        hei
-0001ab80: 6768 7420 3a20 7363 616c 6172 2c20 6f70  ght : scalar, op
-0001ab90: 7469 6f6e 616c 2c20 6465 6661 756c 743a  tional, default:
-0001aba0: 2031 0d0a 2020 2020 2020 2020 2020 2020   1..            
-0001abb0: 4d61 7869 6d75 6d20 636f 6c6f 7220 7661  Maximum color va
-0001abc0: 6c75 6520 6f66 2068 6967 686c 6967 6874  lue of highlight
-0001abd0: 6564 2073 7572 6661 6365 2066 6163 6573  ed surface faces
-0001abe0: 2e0d 0a20 2020 2020 2020 2020 2020 2048  ...            H
-0001abf0: 6569 6768 7420 7661 6c75 6520 7261 6e67  eight value rang
-0001ac00: 6573 2066 726f 6d20 3020 746f 2031 2e0d  es from 0 to 1..
-0001ac10: 0a0d 0a20 2020 2020 2020 2064 6972 6563  ...        direc
-0001ac20: 7469 6f6e 203a 2061 7272 6179 2d6c 696b  tion : array-lik
-0001ac30: 652c 206f 7074 696f 6e61 6c2c 2064 6566  e, optional, def
-0001ac40: 6175 6c74 3a20 2831 2c30 2c31 290d 0a20  ault: (1,0,1).. 
-0001ac50: 2020 2020 2020 2020 2020 2041 2078 797a             A xyz
-0001ac60: 2076 6563 746f 7220 706f 696e 7469 6e67   vector pointing
-0001ac70: 2074 6f20 7468 6520 696c 6c75 6d69 6e61   to the illumina
-0001ac80: 7469 6f6e 2073 6f75 7263 652e 200d 0a0d  tion source. ...
-0001ac90: 0a20 2020 2020 2020 2066 6f63 7573 203a  .        focus :
-0001aca0: 2073 6361 6c61 722c 206f 7074 696f 6e61   scalar, optiona
-0001acb0: 6c2c 2064 6566 6175 6c74 3a20 310d 0a20  l, default: 1.. 
-0001acc0: 2020 2020 2020 2020 2020 2048 6967 686c             Highl
-0001acd0: 6967 6874 696e 6720 666f 6375 7320 6164  ighting focus ad
-0001ace0: 6a75 7374 6d65 6e74 2066 726f 6d20 6c6f  justment from lo
-0001acf0: 7720 746f 2068 6967 6820 7769 7468 2061  w to high with a
-0001ad00: 2076 616c 7565 0d0a 2020 2020 2020 2020   value..        
-0001ad10: 2020 2020 6f66 2031 2066 6f72 2071 7561      of 1 for qua
-0001ad20: 6472 6174 6963 2076 6172 6961 7469 6f6e  dratic variation
-0001ad30: 7320 7769 7468 2074 6865 206e 6f72 6d61  s with the norma
-0001ad40: 6c20 6469 7265 6374 696f 6e2e 0d0a 2020  l direction...  
-0001ad50: 2020 2020 2020 2020 2020 466f 6375 7320            Focus 
-0001ad60: 7661 6c75 6520 7261 6e67 6573 2066 726f  value ranges fro
-0001ad70: 6d20 302e 3120 746f 2033 2e20 2020 2020  m 0.1 to 3.     
-0001ad80: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-0001ad90: 2020 2020 6178 203a 204d 6174 706c 6f74      ax : Matplot
-0001ada0: 6c69 6220 3344 2061 7865 732e 0d0a 0d0a  lib 3D axes.....
-0001adb0: 2020 2020 2020 2020 7276 6965 7720 3a20          rview : 
-0001adc0: 626f 6f6c 6561 6e2c 2064 6566 6175 6c74  boolean, default
-0001add0: 3a20 4661 6c73 650d 0a20 2020 2020 2020  : False..       
-0001ade0: 2020 2020 2049 6620 5472 7565 2c20 6469       If True, di
-0001adf0: 7265 6374 696f 6e20 6973 2072 656c 6174  rection is relat
-0001ae00: 6976 6520 746f 2074 6865 2076 6965 772c  ive to the view,
-0001ae10: 0d0a 2020 2020 2020 2020 2020 2020 206f  ..             o
-0001ae20: 7468 6572 7769 7365 2c20 7265 6c61 7469  therwise, relati
-0001ae30: 7665 2074 6f20 7468 6520 6178 6573 2e0d  ve to the axes..
-0001ae40: 0a0d 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
-0001ae50: 6e73 0d0a 2020 2020 2020 2020 2d2d 2d2d  ns..        ----
-0001ae60: 2d2d 2d0d 0a20 2020 2020 2020 2073 656c  ---..        sel
-0001ae70: 6620 3a20 7375 7266 6163 6520 6f62 6a65  f : surface obje
-0001ae80: 6374 0d0a 0d0a 2020 2020 2020 2020 2222  ct....        ""
-0001ae90: 220d 0a0d 0a20 2020 2020 2020 2069 6620  "....        if 
-0001aea0: 6469 7265 6374 696f 6e20 6973 204e 6f6e  direction is Non
-0001aeb0: 6520 3a20 6469 7265 6374 696f 6e20 3d20  e : direction = 
-0001aec0: 5f49 4c4c 554d 0d0a 2020 2020 2020 2020  _ILLUM..        
-0001aed0: 7669 6577 6469 722c 6175 7366 203d 204e  viewdir,ausf = N
-0001aee0: 6f6e 652c 4e6f 6e65 0d0a 2020 2020 2020  one,None..      
-0001aef0: 2020 6966 2061 7820 6973 206e 6f74 204e    if ax is not N
-0001af00: 6f6e 653a 0d0a 2020 2020 2020 2020 2020  one:..          
-0001af10: 2020 6175 7366 203d 205f 6178 6973 5553    ausf = _axisUS
-0001af20: 4628 6178 290d 0a20 2020 2020 2020 2020  F(ax)..         
-0001af30: 2020 2076 6965 7764 6972 203d 2065 6c65     viewdir = ele
-0001af40: 765f 617a 696d 5f32 7665 6374 6f72 2861  v_azim_2vector(a
-0001af50: 782e 656c 6576 2c61 782e 617a 696d 290d  x.elev,ax.azim).
-0001af60: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0001af70: 7276 6965 7720 3a20 6469 7265 6374 696f  rview : directio
-0001af80: 6e20 3d20 7274 7628 6469 7265 6374 696f  n = rtv(directio
-0001af90: 6e2c 6178 2e65 6c65 762c 6178 2e61 7a69  n,ax.elev,ax.azi
-0001afa0: 6d29 0d0a 0d0a 2020 2020 2020 2020 6966  m)....        if
-0001afb0: 206e 702e 616e 7928 2028 6865 6967 6874   np.any( (height
-0001afc0: 3c30 2920 7c20 2868 6569 6768 743e 3129  <0) | (height>1)
-0001afd0: 2029 203a 0d0a 2020 2020 2020 2020 2020   ) :..          
-0001afe0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-0001aff0: 6f72 2827 6865 6967 6874 2076 616c 7565  or('height value
-0001b000: 732c 207b 7d2c 206d 7573 7420 6265 2062  s, {}, must be b
-0001b010: 6574 7765 656e 2030 2061 6e64 2031 272e  etween 0 and 1'.
-0001b020: 666f 726d 6174 2868 6569 6768 7429 290d  format(height)).
-0001b030: 0a20 2020 2020 2020 2069 6620 666f 6375  .        if focu
-0001b040: 7320 6973 206e 6f74 204e 6f6e 653a 0d0a  s is not None:..
-0001b050: 2020 2020 2020 2020 2020 2020 6966 2028              if (
-0001b060: 666f 6375 733c 302e 3120 6f72 2066 6f63  focus<0.1 or foc
-0001b070: 7573 3e33 2920 3a0d 0a20 2020 2020 2020  us>3) :..       
-0001b080: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-0001b090: 616c 7565 4572 726f 7228 2766 6f63 7573  alueError('focus
-0001b0a0: 206d 7573 7420 6265 2062 6574 7765 656e   must be between
-0001b0b0: 2030 2e31 2061 6e64 2033 2e20 2c20 666f   0.1 and 3. , fo
-0001b0c0: 756e 6420 7b7d 272e 666f 726d 6174 2866  und {}'.format(f
-0001b0d0: 6f63 7573 2929 0d0a 2020 2020 0d0a 2020  ocus))..    ..  
-0001b0e0: 2020 2020 2020 7665 7274 7320 3d20 7365        verts = se
-0001b0f0: 6c66 2e76 6572 7465 7843 6f6f 725b 2073  lf.vertexCoor[ s
-0001b100: 656c 662e 6676 496e 6469 6365 7320 5d0d  elf.fvIndices ].
-0001b110: 0a20 2020 2020 2020 206e 6f72 6d73 203d  .        norms =
-0001b120: 2073 656c 662e 5f67 6574 5f66 6163 655f   self._get_face_
-0001b130: 6e6f 726d 616c 7328 7665 7274 732c 6175  normals(verts,au
-0001b140: 7366 290d 0a20 2020 2020 2020 2075 6e69  sf)..        uni
-0001b150: 7444 6972 6563 7469 6f6e 203d 206e 702e  tDirection = np.
-0001b160: 6469 7669 6465 2820 6469 7265 6374 696f  divide( directio
-0001b170: 6e2c 206e 702e 6c69 6e61 6c67 2e6e 6f72  n, np.linalg.nor
-0001b180: 6d28 6469 7265 6374 696f 6e29 2029 0d0a  m(direction) )..
-0001b190: 2020 2020 2020 2020 6470 726f 6420 3d20          dprod = 
-0001b1a0: 6e70 2e64 6f74 2820 6e6f 726d 732c 2075  np.dot( norms, u
-0001b1b0: 6e69 7444 6972 6563 7469 6f6e 2029 0d0a  nitDirection )..
-0001b1c0: 0d0a 2020 2020 2020 2020 6966 2076 6965  ..        if vie
-0001b1d0: 7764 6972 2069 7320 6e6f 7420 4e6f 6e65  wdir is not None
-0001b1e0: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
-0001b1f0: 7664 6f74 203d 206e 702e 646f 7428 6e6f  vdot = np.dot(no
-0001b200: 726d 732c 7669 6577 6469 7229 0d0a 2020  rms,viewdir)..  
-0001b210: 2020 2020 2020 2020 2020 6470 726f 6420            dprod 
-0001b220: 3d20 6e70 2e77 6865 7265 286e 702e 6c65  = np.where(np.le
-0001b230: 7373 2876 646f 742c 5b30 2e30 5d29 2c2d  ss(vdot,[0.0]),-
-0001b240: 6470 726f 642c 6470 726f 6429 0d0a 0d0a  dprod,dprod)....
-0001b250: 2020 2020 2020 2020 2320 303c 643c 312c          # 0<d<1,
-0001b260: 2068 6575 7269 7374 6963 2066 756e 6374   heuristic funct
-0001b270: 696f 6e20 666f 7220 0d0a 2020 2020 2020  ion for ..      
-0001b280: 2020 2320 6e6f 726d 616c 697a 6564 2064    # normalized d
-0001b290: 6f6d 6169 6e20 6f66 2065 6666 6563 7469  omain of effecti
-0001b2a0: 7665 2064 6f74 2070 726f 6475 6374 2c20  ve dot product, 
-0001b2b0: 643d 6628 6470 726f 6429 0d0a 2020 2020  d=f(dprod)..    
-0001b2c0: 2020 2020 6420 3d20 6e70 2e77 6865 7265      d = np.where
-0001b2d0: 2864 7072 6f64 3c30 202c 2030 2c20 6470  (dprod<0 , 0, dp
-0001b2e0: 726f 6429 2020 2020 2020 200d 0a20 2020  rod)       ..   
-0001b2f0: 2020 2020 2069 6620 666f 6375 7320 6973       if focus is
-0001b300: 204e 6f6e 6520 3a20 666f 6375 7320 3d20   None : focus = 
-0001b310: 310d 0a20 2020 2020 2020 2064 3020 3d20  1..        d0 = 
-0001b320: 6e70 2e70 6f77 6572 2866 6f63 7573 2c31  np.power(focus,1
-0001b330: 2f32 292f 322e 300d 0a20 2020 2020 2020  /2)/2.0..       
-0001b340: 2079 203d 2028 642d 6430 292f 2831 2d64   y = (d-d0)/(1-d
-0001b350: 3029 0d0a 2020 2020 2020 2020 6420 3d20  0)..        d = 
-0001b360: 6e70 2e77 6865 7265 2879 3c30 202c 2030  np.where(y<0 , 0
-0001b370: 2c20 7929 0d0a 2020 2020 2020 2020 6420  , y)..        d 
-0001b380: 3d20 6e70 2e70 6f77 6572 2864 2c31 2e30  = np.power(d,1.0
-0001b390: 2b32 2a66 6f63 7573 290d 0a0d 0a20 2020  +2*focus)....   
-0001b3a0: 2020 2020 2023 2065 7874 7261 6374 2048       # extract H
-0001b3b0: 5356 2c20 6c65 6176 696e 6720 616c 7068  SV, leaving alph
-0001b3c0: 6120 756e 6368 616e 6765 642e 0d0a 2020  a unchanged...  
-0001b3d0: 2020 2020 2020 7365 6c66 2e5f 706f 7374        self._post
-0001b3e0: 5072 6f63 5f73 7572 6661 6365 436f 6c6f  Proc_surfaceColo
-0001b3f0: 7273 2829 0d0a 2020 2020 2020 2020 6f72  rs()..        or
-0001b400: 6967 5f63 6f6c 6f72 7320 3d20 7365 6c66  ig_colors = self
-0001b410: 2e5f 6661 6365 636f 6c6f 7273 0d0a 2020  ._facecolors..  
-0001b420: 2020 2020 2020 616c 7068 6173 203d 206f        alphas = o
-0001b430: 7269 675f 636f 6c6f 7273 5b3a 2c33 3a34  rig_colors[:,3:4
-0001b440: 5d0d 0a20 2020 2020 2020 2066 635f 6c65  ]..        fc_le
-0001b450: 7373 5f61 6c70 6861 203d 206f 7269 675f  ss_alpha = orig_
-0001b460: 636f 6c6f 7273 5b3a 2c3a 335d 0d0a 2020  colors[:,:3]..  
-0001b470: 2020 2020 2020 6873 765f 7661 6c73 203d        hsv_vals =
-0001b480: 2063 6d2e 636f 6c6f 7273 2e72 6762 5f74   cm.colors.rgb_t
-0001b490: 6f5f 6873 7628 6663 5f6c 6573 735f 616c  o_hsv(fc_less_al
-0001b4a0: 7068 6129 0d0a 0d0a 2020 2020 2020 2020  pha)....        
-0001b4b0: 2320 6164 6a75 7374 2063 6f6c 6f72 2073  # adjust color s
-0001b4c0: 6174 7572 6174 696f 6e20 616e 6420 7661  aturation and va
-0001b4d0: 6c75 652c 206c 696e 6561 7220 7769 7468  lue, linear with
-0001b4e0: 206e 6f72 6d61 6c69 7a65 6420 646f 6d61   normalized doma
-0001b4f0: 696e 2e0d 0a20 2020 2020 2020 2068 6420  in...        hd 
-0001b500: 3d20 6865 6967 6874 2a64 0d0a 2020 2020  = height*d..    
-0001b510: 2020 2020 6f6d 6864 203d 2028 6e70 2e6f      omhd = (np.o
-0001b520: 6e65 7328 206c 656e 286e 6f72 6d73 2920  nes( len(norms) 
-0001b530: 2920 2d20 6864 290d 0a20 2020 2020 2020  ) - hd)..       
-0001b540: 206f 6d68 6420 3d20 6f6d 6864 5b3a 2c6e   omhd = omhd[:,n
-0001b550: 702e 6e65 7761 7869 735d 0d0a 2020 2020  p.newaxis]..    
-0001b560: 2020 2020 6873 765f 7661 6c73 5b3a 2c31      hsv_vals[:,1
-0001b570: 5d20 3d20 286f 6d68 642a 6873 765f 7661  ] = (omhd*hsv_va
-0001b580: 6c73 5b3a 2c31 3a32 5d29 5b3a 2c30 5d0d  ls[:,1:2])[:,0].
-0001b590: 0a20 2020 2020 2020 2068 7376 5f76 616c  .        hsv_val
-0001b5a0: 735b 3a2c 325d 203d 2028 6f6d 6864 2a68  s[:,2] = (omhd*h
-0001b5b0: 7376 5f76 616c 735b 3a2c 323a 335d 295b  sv_vals[:,2:3])[
-0001b5c0: 3a2c 305d 0d0a 2020 2020 2020 2020 6873  :,0]..        hs
-0001b5d0: 765f 7661 6c73 5b3a 2c32 5d20 2b3d 2068  v_vals[:,2] += h
-0001b5e0: 640d 0a20 2020 2020 2020 2072 6762 5f76  d..        rgb_v
-0001b5f0: 616c 7320 3d20 2063 6d2e 636f 6c6f 7273  als =  cm.colors
-0001b600: 2e68 7376 5f74 6f5f 7267 6228 6873 765f  .hsv_to_rgb(hsv_
-0001b610: 7661 6c73 290d 0a20 2020 2020 2020 2068  vals)..        h
-0001b620: 696c 6974 655f 636f 6c6f 7273 203d 206e  ilite_colors = n
-0001b630: 702e 636f 6e63 6174 656e 6174 6528 2872  p.concatenate((r
-0001b640: 6762 5f76 616c 732c 2061 6c70 6861 7329  gb_vals, alphas)
-0001b650: 2c20 6178 6973 3d31 290d 0a20 2020 2020  , axis=1)..     
-0001b660: 2020 2073 656c 662e 7365 745f 636f 6c6f     self.set_colo
-0001b670: 7228 6869 6c69 7465 5f63 6f6c 6f72 7329  r(hilite_colors)
-0001b680: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-0001b690: 2073 656c 660d 0a0d 0a20 2020 2064 6566   self....    def
-0001b6a0: 2066 6164 6528 7365 6c66 2c64 6570 7468   fade(self,depth
-0001b6b0: 3d30 2c65 6c65 763d 4e6f 6e65 2c61 7a69  =0,elev=None,azi
-0001b6c0: 6d3d 4e6f 6e65 2c61 783d 4e6f 6e65 2920  m=None,ax=None) 
-0001b6d0: 3a0d 0a20 2020 2020 2020 2022 2222 0d0a  :..        """..
-0001b6e0: 2020 2020 2020 2020 5265 6475 6365 2073          Reduce s
-0001b6f0: 7572 6661 6365 2066 6163 6520 6f70 6163  urface face opac
-0001b700: 6974 7920 6261 7365 6420 6f6e 2066 6163  ity based on fac
-0001b710: 6520 706f 7369 7469 6f6e 2072 656c 6174  e position relat
-0001b720: 6976 650d 0a20 2020 2020 2020 2074 6f20  ive..        to 
-0001b730: 7468 6520 7669 6577 206f 7269 656e 7461  the view orienta
-0001b740: 7469 6f6e 2e20 0d0a 2020 2020 2020 2020  tion. ..        
-0001b750: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-0001b760: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
-0001b770: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
-0001b780: 2020 6465 7074 6820 3a20 7363 616c 6172    depth : scalar
-0001b790: 2c20 6f70 7469 6f6e 616c 2c20 6465 6661  , optional, defa
-0001b7a0: 756c 743a 2030 0d0a 2020 2020 2020 2020  ult: 0..        
-0001b7b0: 2020 2020 4d69 6e69 6d75 6d20 6f70 6163      Minimum opac
-0001b7c0: 6974 7920 746f 2031 2066 6f72 2066 6163  ity to 1 for fac
-0001b7d0: 6520 6f70 6163 6974 7920 6672 6f6d 2062  e opacity from b
-0001b7e0: 6163 6b0d 0a20 2020 2020 2020 2020 2020  ack..           
-0001b7f0: 2074 6f20 6672 6f6e 7420 6661 6365 2063   to front face c
-0001b800: 656e 7465 7220 706f 7369 7469 6f6e 2e0d  enter position..
-0001b810: 0a20 2020 2020 2020 2020 2020 2044 6570  .            Dep
-0001b820: 7468 2076 616c 7565 2072 616e 6765 7320  th value ranges 
-0001b830: 6672 6f6d 2030 2074 6f20 312e 0d0a 0d0a  from 0 to 1.....
-0001b840: 2020 2020 2020 2020 656c 6576 203a 2073          elev : s
-0001b850: 6361 6c61 722c 206f 7074 696f 6e61 6c2c  calar, optional,
-0001b860: 2064 6566 6175 6c74 3a20 3330 0d0a 2020   default: 30..  
-0001b870: 2020 2020 2020 2020 2020 456c 6576 6174            Elevat
-0001b880: 696f 6e20 6f66 2074 6865 2061 7865 7320  ion of the axes 
-0001b890: 7669 6577 2e0d 0a0d 0a20 2020 2020 2020  view.....       
-0001b8a0: 2061 7a69 6d20 3a20 7363 616c 6172 2c20   azim : scalar, 
-0001b8b0: 6f70 7469 6f6e 616c 2c20 6465 6661 756c  optional, defaul
-0001b8c0: 743a 202d 3630 0d0a 2020 2020 2020 2020  t: -60..        
-0001b8d0: 2020 2020 417a 696d 7574 6820 6f66 2074      Azimuth of t
-0001b8e0: 6865 2061 7865 7320 7669 6577 2e20 0d0a  he axes view. ..
-0001b8f0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-0001b900: 2020 6178 3a20 4d61 7470 6c6f 746c 6962    ax: Matplotlib
-0001b910: 2033 4420 6178 6573 2e0d 0a20 2020 2020   3D axes...     
-0001b920: 2020 2020 2020 2049 6620 6e6f 7420 4e6f         If not No
-0001b930: 6e65 2c20 656c 6576 2061 6e64 2061 7a69  ne, elev and azi
-0001b940: 6d20 6172 6520 7461 6b65 6e20 6672 6f6d  m are taken from
-0001b950: 2074 6865 2061 782e 0d0a 2020 2020 2020   the ax...      
-0001b960: 2020 0d0a 2020 2020 2020 2020 5265 7475    ..        Retu
-0001b970: 726e 730d 0a20 2020 2020 2020 202d 2d2d  rns..        ---
-0001b980: 2d2d 2d2d 0d0a 2020 2020 2020 2020 7365  ----..        se
-0001b990: 6c66 203a 2073 7572 6661 6365 206f 626a  lf : surface obj
-0001b9a0: 6563 740d 0a0d 0a20 2020 2020 2020 2022  ect....        "
-0001b9b0: 2222 0d0a 0d0a 2020 2020 2020 2020 6966  ""....        if
-0001b9c0: 2061 7820 6973 204e 6f6e 6520 3a0d 0a20   ax is None :.. 
-0001b9d0: 2020 2020 2020 2020 2020 2069 6620 656c             if el
-0001b9e0: 6576 2069 7320 4e6f 6e65 3a20 656c 6576  ev is None: elev
-0001b9f0: 203d 205f 4446 545f 5649 4557 5b30 5d0d   = _DFT_VIEW[0].
-0001ba00: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0001ba10: 617a 696d 2069 7320 4e6f 6e65 3a20 617a  azim is None: az
-0001ba20: 696d 203d 205f 4446 545f 5649 4557 5b31  im = _DFT_VIEW[1
-0001ba30: 5d0d 0a20 2020 2020 2020 2065 6c73 6520  ]..        else 
-0001ba40: 3a0d 0a20 2020 2020 2020 2020 2020 2065  :..            e
-0001ba50: 6c65 7620 3d20 6178 2e65 6c65 760d 0a20  lev = ax.elev.. 
-0001ba60: 2020 2020 2020 2020 2020 2061 7a69 6d20             azim 
-0001ba70: 3d20 6178 2e61 7a69 6d0d 0a20 2020 2020  = ax.azim..     
-0001ba80: 2020 2064 6972 6563 7469 6f6e 203d 2065     direction = e
-0001ba90: 6c65 765f 617a 696d 5f32 7665 6374 6f72  lev_azim_2vector
-0001baa0: 2865 6c65 762c 2061 7a69 6d29 0d0a 2020  (elev, azim)..  
-0001bab0: 2020 2020 2020 756e 6974 4469 7265 6374        unitDirect
-0001bac0: 696f 6e20 3d20 6e70 2e64 6976 6964 6528  ion = np.divide(
-0001bad0: 2064 6972 6563 7469 6f6e 2c20 6e70 2e6c   direction, np.l
-0001bae0: 696e 616c 672e 6e6f 726d 2864 6972 6563  inalg.norm(direc
-0001baf0: 7469 6f6e 2920 290d 0a0d 0a20 2020 2020  tion) )....     
-0001bb00: 2020 2069 6620 6e70 2e61 6e79 2820 2864     if np.any( (d
-0001bb10: 6570 7468 3c30 2920 6f72 2028 6465 7074  epth<0) or (dept
-0001bb20: 683e 3129 2029 203a 0d0a 2020 2020 2020  h>1) ) :..      
-0001bb30: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-0001bb40: 6545 7272 6f72 2827 6465 7074 6820 7661  eError('depth va
-0001bb50: 6c75 6573 2c20 7b7d 2c20 6d75 7374 2062  lues, {}, must b
-0001bb60: 6520 6265 7477 6565 6e20 3020 616e 6420  e between 0 and 
-0001bb70: 3127 2e66 6f72 6d61 7428 6465 7074 6829  1'.format(depth)
-0001bb80: 290d 0a0d 0a20 2020 2020 2020 2076 6572  )....        ver
-0001bb90: 7473 203d 2073 656c 662e 7665 7274 6578  ts = self.vertex
-0001bba0: 436f 6f72 5b20 6e70 2e61 7272 6179 2873  Coor[ np.array(s
-0001bbb0: 656c 662e 6676 496e 6469 6365 7329 205d  elf.fvIndices) ]
-0001bbc0: 0d0a 2020 2020 2020 2020 6661 6365 4365  ..        faceCe
-0001bbd0: 6e74 6572 436f 6f72 203d 2073 656c 662e  nterCoor = self.
-0001bbe0: 5f67 6574 5f66 6163 655f 6365 6e74 6572  _get_face_center
-0001bbf0: 7328 7665 7274 7329 0d0a 0d0a 2020 2020  s(verts)....    
-0001bc00: 2020 2020 7365 6c66 2e5f 706f 7374 5072      self._postPr
-0001bc10: 6f63 5f73 7572 6661 6365 436f 6c6f 7273  oc_surfaceColors
-0001bc20: 2829 0d0a 2020 2020 2020 2020 636f 6c6f  ()..        colo
-0001bc30: 7273 203d 2073 656c 662e 5f66 6163 6563  rs = self._facec
-0001bc40: 6f6c 6f72 730d 0a20 2020 2020 2020 2069  olors..        i
-0001bc50: 6620 6c65 6e28 6661 6365 4365 6e74 6572  f len(faceCenter
-0001bc60: 436f 6f72 2920 3d3d 2031 203a 2072 6574  Coor) == 1 : ret
-0001bc70: 7572 6e20 7365 6c66 2023 2066 6164 6520  urn self # fade 
-0001bc80: 6e6f 7420 6176 6169 6c61 626c 6520 666f  not available fo
-0001bc90: 7220 7369 6e67 6c65 2066 6163 6520 6c69  r single face li
-0001bca0: 6e65 200d 0a20 2020 2020 2020 2064 7470  ne ..        dtp
-0001bcb0: 726f 6420 3d20 6e70 2e64 6f74 2866 6163  rod = np.dot(fac
-0001bcc0: 6543 656e 7465 7243 6f6f 722c 756e 6974  eCenterCoor,unit
-0001bcd0: 4469 7265 6374 696f 6e29 0d0a 2020 2020  Direction)..    
-0001bce0: 2020 2020 6470 7261 6e67 6520 3d20 6e70      dprange = np
-0001bcf0: 2e61 6d61 7828 6474 7072 6f64 292d 6e70  .amax(dtprod)-np
-0001bd00: 2e61 6d69 6e28 6474 7072 6f64 290d 0a20  .amin(dtprod).. 
-0001bd10: 2020 2020 2020 206e 6f72 6d5f 6470 203d         norm_dp =
-0001bd20: 2028 6474 7072 6f64 202d 206e 702e 616d   (dtprod - np.am
-0001bd30: 696e 2864 7470 726f 6429 292f 6470 7261  in(dtprod))/dpra
-0001bd40: 6e67 650d 0a20 2020 2020 2020 2066 6164  nge..        fad
-0001bd50: 6578 203d 2028 312d 6465 7074 6829 2a6e  ex = (1-depth)*n
-0001bd60: 6f72 6d5f 6470 202b 2064 6570 7468 0d0a  orm_dp + depth..
-0001bd70: 0d0a 2020 2020 2020 2020 6f72 6967 5f63  ..        orig_c
-0001bd80: 6f6c 6f72 7320 3d20 636f 6c6f 7273 0d0a  olors = colors..
-0001bd90: 2020 2020 2020 2020 6663 5f6c 6573 735f          fc_less_
-0001bda0: 616c 7068 6120 3d20 6f72 6967 5f63 6f6c  alpha = orig_col
-0001bdb0: 6f72 735b 3a2c 3a33 5d0d 0a20 2020 2020  ors[:,:3]..     
-0001bdc0: 2020 2066 6164 6564 5f63 6f6c 6f72 7320     faded_colors 
-0001bdd0: 3d20 6e70 2e63 6f6e 6361 7465 6e61 7465  = np.concatenate
-0001bde0: 2828 6663 5f6c 6573 735f 616c 7068 612c  ((fc_less_alpha,
-0001bdf0: 2066 6164 6578 5b3a 2c6e 702e 6e65 7761   fadex[:,np.newa
-0001be00: 7869 735d 2029 2c20 6178 6973 3d31 290d  xis] ), axis=1).
-0001be10: 0a20 2020 2020 2020 2073 656c 662e 7365  .        self.se
-0001be20: 745f 636f 6c6f 7228 6661 6465 645f 636f  t_color(faded_co
-0001be30: 6c6f 7273 2920 2020 0d0a 2020 2020 2020  lors)   ..      
-0001be40: 2020 7265 7475 726e 2073 656c 660d 0a0d    return self...
-0001be50: 0a20 2020 2064 6566 2074 7261 6e73 666f  .    def transfo
-0001be60: 726d 2873 656c 662c 2072 6f74 6174 653d  rm(self, rotate=
-0001be70: 4e6f 6e65 2c20 7363 616c 653d 312e 302c  None, scale=1.0,
-0001be80: 2074 7261 6e73 6c61 7465 3d5b 302c 302c   translate=[0,0,
-0001be90: 305d 2029 2020 3a0d 0a20 2020 2020 2020  0] )  :..       
-0001bea0: 2022 2222 0d0a 2020 2020 2020 2020 4c69   """..        Li
-0001beb0: 6e65 6172 2074 7261 6e73 666f 726d 6174  near transformat
-0001bec0: 696f 6e20 6f66 2074 6865 2073 7572 6661  ion of the surfa
-0001bed0: 6365 206f 626a 6563 742e 0d0a 0d0a 2020  ce object.....  
-0001bee0: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
-0001bef0: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-0001bf00: 2d2d 2d2d 0d0a 2020 2020 2020 2020 726f  ----..        ro
-0001bf10: 7461 7465 203a 2020 6172 7261 792d 6c69  tate :  array-li
-0001bf20: 6b65 2c20 6f70 7469 6f6e 616c 2c20 6465  ke, optional, de
-0001bf30: 6661 756c 743a 204e 6f6e 650d 0a20 2020  fault: None..   
-0001bf40: 2020 2020 2020 2020 2041 2033 2062 7920           A 3 by 
-0001bf50: 3320 726f 7461 7469 6f6e 206d 6174 7269  3 rotation matri
-0001bf60: 782e 0d0a 0d0a 2020 2020 2020 2020 7363  x.....        sc
-0001bf70: 616c 6520 3a20 3344 2061 7272 6179 206f  ale : 3D array o
-0001bf80: 7220 7363 616c 6172 2c20 6f70 7469 6f6e  r scalar, option
-0001bf90: 616c 2c20 6465 6661 756c 743a 2031 2e30  al, default: 1.0
-0001bfa0: 0d0a 2020 2020 2020 2020 2020 2020 4d75  ..            Mu
-0001bfb0: 6c74 6970 6c69 6572 7320 6f66 2074 6865  ltipliers of the
-0001bfc0: 206f 626a 6563 7420 636f 6f72 6469 6e61   object coordina
-0001bfd0: 7465 732c 2069 6e0d 0a20 2020 2020 2020  tes, in..       
-0001bfe0: 2020 2020 2078 797a 2063 6f6f 7264 696e       xyz coordin
-0001bff0: 6174 6573 2e20 4966 2061 2073 696e 676c  ates. If a singl
-0001c000: 6520 7363 616c 6172 2c20 7468 7265 650d  e scalar, three.
-0001c010: 0a20 2020 2020 2020 2020 2020 206d 756c  .            mul
-0001c020: 7469 706c 6965 7273 2061 7265 2074 6865  tipliers are the
-0001c030: 2073 616d 6520 7661 6c75 652e 0d0a 2020   same value...  
-0001c040: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-0001c050: 7472 616e 736c 6174 6520 3a20 6172 7261  translate : arra
-0001c060: 792d 6c69 6b65 2c20 6f70 7469 6f6e 616c  y-like, optional
-0001c070: 2c20 6465 6661 756c 743a 205b 302c 302c  , default: [0,0,
-0001c080: 305d 0d0a 2020 2020 2020 2020 2020 2020  0]..            
-0001c090: 4120 7879 7a20 7472 616e 736c 6174 696f  A xyz translatio
-0001c0a0: 6e20 7665 6374 6f72 206f 6620 6f62 6a65  n vector of obje
-0001c0b0: 6374 206f 7269 6769 6e2e 200d 0a0d 0a20  ct origin. .... 
-0001c0c0: 2020 2020 2020 2052 6574 7572 6e73 0d0a         Returns..
-0001c0d0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0d          -------.
-0001c0e0: 0a20 2020 2020 2020 2073 656c 6620 3a20  .        self : 
-0001c0f0: 7375 7266 6163 6520 6f62 6a65 6374 0d0a  surface object..
-0001c100: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
-0001c110: 2020 2020 2020 2069 6620 726f 7461 7465         if rotate
-0001c120: 2069 7320 4e6f 6e65 203a 2072 6f74 6174   is None : rotat
-0001c130: 6520 3d20 6e70 2e69 6465 6e74 6974 7928  e = np.identity(
-0001c140: 3329 0d0a 2020 2020 2020 2020 6966 2069  3)..        if i
-0001c150: 7369 6e73 7461 6e63 6528 7363 616c 652c  sinstance(scale,
-0001c160: 2869 6e74 2c66 6c6f 6174 2929 203a 0d0a  (int,float)) :..
-0001c170: 2020 2020 2020 2020 2020 2020 7363 616c              scal
-0001c180: 6520 3d20 206e 702e 6675 6c6c 2833 2c73  e =  np.full(3,s
-0001c190: 6361 6c65 292e 6173 7479 7065 2866 6c6f  cale).astype(flo
-0001c1a0: 6174 290d 0a20 2020 2020 2020 2023 2e2e  at)..        #..
-0001c1b0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0001c1c0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0001c1d0: 2e2e 2e20 2020 200d 0a20 2020 2020 2020  ...    ..       
-0001c1e0: 2064 6566 2069 734f 7274 6828 4d29 203a   def isOrth(M) :
-0001c1f0: 0d0a 2020 2020 2020 2020 2020 2020 4d20  ..            M 
-0001c200: 3d20 6e70 2e61 7272 6179 284d 290d 0a20  = np.array(M).. 
-0001c210: 2020 2020 2020 2020 2020 2074 6f6c 203d             tol =
-0001c220: 2030 2e30 3030 3031 0d0a 2020 2020 2020   0.00001..      
-0001c230: 2020 2020 2020 7072 6f64 203d 206e 702e        prod = np.
-0001c240: 646f 7428 4d2c 4d2e 5429 0d0a 2020 2020  dot(M,M.T)..    
-0001c250: 2020 2020 2020 2020 6e70 2e66 696c 6c5f          np.fill_
-0001c260: 6469 6167 6f6e 616c 2870 726f 642c 302e  diagonal(prod,0.
-0001c270: 3029 0d0a 2020 2020 2020 2020 2020 2020  0)..            
-0001c280: 7265 7475 726e 206e 6f74 2028 6e70 2e61  return not (np.a
-0001c290: 6273 2870 726f 6429 3e74 6f6c 292e 616e  bs(prod)>tol).an
-0001c2a0: 7928 290d 0a20 2020 2020 2020 2023 2e2e  y()..        #..
-0001c2b0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0001c2c0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0001c2d0: 2e2e 2e20 2020 200d 0a20 2020 2020 2020  ...    ..       
-0001c2e0: 2074 7261 6e73 203d 206c 616d 6264 6120   trans = lambda 
-0001c2f0: 562c 532c 5420 3a20 6e70 2e61 6464 2820  V,S,T : np.add( 
-0001c300: 206e 702e 646f 7428 206e 702e 6d75 6c74   np.dot( np.mult
-0001c310: 6970 6c79 2856 2c53 292c 726f 7461 7465  iply(V,S),rotate
-0001c320: 2920 2c54 290d 0a20 2020 2020 2020 2023  ) ,T)..        #
-0001c330: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0001c340: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0001c350: 2e2e 2e2e 2e20 2020 200d 0a20 2020 2020  .....    ..     
-0001c360: 2020 2069 6620 6e6f 7420 6973 4f72 7468     if not isOrth
-0001c370: 2872 6f74 6174 6529 203a 0d0a 2020 2020  (rotate) :..    
-0001c380: 2020 2020 2020 2020 7761 726e 696e 6773          warnings
-0001c390: 2e77 6172 6e28 2754 7261 6e73 666f 726d  .warn('Transform
-0001c3a0: 2072 6f74 6174 6520 6d61 7472 6978 2069   rotate matrix i
-0001c3b0: 7320 4e4f 5420 4f72 7468 6f67 696e 616c  s NOT Orthoginal
-0001c3c0: 2e27 290d 0a0d 0a20 2020 2020 2020 2076  .')....        v
-0001c3d0: 203d 2074 7261 6e73 2820 7365 6c66 2e76   = trans( self.v
-0001c3e0: 6572 7465 7843 6f6f 722c 2073 6361 6c65  ertexCoor, scale
-0001c3f0: 2c20 7472 616e 736c 6174 6520 2029 0d0a  , translate  )..
-0001c400: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-0001c410: 7665 6374 6f72 5f66 6965 6c64 2069 7320  vector_field is 
-0001c420: 6e6f 7420 4e6f 6e65 203a 200d 0a20 2020  not None : ..   
-0001c430: 2020 2020 2020 2020 206e 5363 616c 203d           nScal =
-0001c440: 206e 702e 6469 7669 6465 2873 6361 6c65   np.divide(scale
-0001c450: 2c20 6e70 2e6c 696e 616c 672e 6e6f 726d  , np.linalg.norm
-0001c460: 2873 6361 6c65 2920 2020 290d 0a20 2020  (scale)   )..   
-0001c470: 2020 2020 2020 2020 2073 656c 662e 7665           self.ve
-0001c480: 6374 6f72 5f66 6965 6c64 203d 2074 7261  ctor_field = tra
-0001c490: 6e73 2820 7365 6c66 2e76 6563 746f 725f  ns( self.vector_
-0001c4a0: 6669 656c 642c 206e 5363 616c 2c20 5b30  field, nScal, [0
-0001c4b0: 2c30 2c30 5d20 2029 0d0a 2020 2020 2020  ,0,0]  )..      
-0001c4c0: 2020 7365 6c66 2e76 6572 7465 7843 6f6f    self.vertexCoo
-0001c4d0: 7220 3d20 760d 0a20 2020 2020 2020 2073  r = v..        s
-0001c4e0: 656c 662e 5f73 6574 5f67 656f 6d65 7472  elf._set_geometr
-0001c4f0: 6963 5f62 6f75 6e64 7328 290d 0a20 2020  ic_bounds()..   
-0001c500: 2020 2020 2073 656c 662e 7365 745f 7665       self.set_ve
-0001c510: 7274 7328 2076 5b20 6e70 2e61 7272 6179  rts( v[ np.array
-0001c520: 2873 656c 662e 6676 496e 6469 6365 7329  (self.fvIndices)
-0001c530: 205d 2029 0d0a 2020 2020 2020 2020 7365   ] )..        se
-0001c540: 6c66 2e5f 7375 7266 6163 6553 6861 7065  lf._surfaceShape
-0001c550: 4368 616e 6765 6420 3d20 5472 7565 0d0a  Changed = True..
-0001c560: 2020 2020 2020 2020 7365 6c66 2e73 6361          self.sca
-0001c570: 6c65 203d 2073 6361 6c65 0d0a 2020 2020  le = scale..    
-0001c580: 2020 2020 7365 6c66 2e74 7261 6e73 6c61      self.transla
-0001c590: 7469 6f6e 203d 2074 7261 6e73 6c61 7465  tion = translate
-0001c5a0: 0d0a 2020 2020 2020 2020 7365 6c66 2e72  ..        self.r
-0001c5b0: 6f74 6174 696f 6e20 3d20 726f 7461 7465  otation = rotate
-0001c5c0: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-0001c5d0: 2073 656c 660d 0a0d 0a20 2020 2064 6566   self....    def
-0001c5e0: 2067 6574 5f74 7261 6e73 666f 726d 4178   get_transformAx
-0001c5f0: 6973 2873 656c 662c 202a 2a6b 6172 6773  is(self, **kargs
-0001c600: 2920 3a0d 0a20 2020 2020 2020 2022 2222  ) :..        """
-0001c610: 0d0a 2020 2020 2020 2020 4c69 6e65 3344  ..        Line3D
-0001c620: 436f 6c6c 6563 7469 6f6e 206f 6620 7468  Collection of th
-0001c630: 6520 276c 6173 7427 2074 7261 6e73 666f  e 'last' transfo
-0001c640: 726d 6564 2073 7572 6661 6365 2063 6f6f  rmed surface coo
-0001c650: 7264 696e 6174 6520 6178 6973 2e0d 0a20  rdinate axis... 
-0001c660: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-0001c670: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
-0001c680: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
-0001c690: 0a20 2020 2020 2020 206c 656e 6d75 6c74  .        lenmult
-0001c6a0: 203a 2073 6361 6c61 7220 6f72 2033 4420   : scalar or 3D 
-0001c6b0: 6172 7261 792c 206f 7074 696f 6e61 6c2c  array, optional,
-0001c6c0: 2064 6566 6175 6c74 3a20 310d 0a20 2020   default: 1..   
-0001c6d0: 2020 2020 2020 2020 2053 6361 6c61 7220           Scalar 
-0001c6e0: 6d75 6c74 6970 6c69 6572 206f 6620 7468  multiplier of th
-0001c6f0: 6520 7468 7265 6520 636f 6f72 6469 6e61  e three coordina
-0001c700: 7465 2061 7869 732e 0d0a 0d0a 2020 2020  te axis.....    
-0001c710: 2020 2020 7769 6474 6820 3a20 7363 616c      width : scal
-0001c720: 6172 2c20 6f70 7469 6f6e 616c 2c20 6465  ar, optional, de
-0001c730: 6661 756c 743a 2031 2e35 0d0a 2020 2020  fault: 1.5..    
-0001c740: 2020 2020 2020 2020 4c69 6e65 2077 6964          Line wid
-0001c750: 7468 206f 6620 7468 6520 636f 6f72 6469  th of the coordi
-0001c760: 6e61 7465 2061 7869 732e 2020 200d 0a0d  nate axis.   ...
-0001c770: 0a20 2020 2020 2020 2063 6f6c 6f72 203a  .        color :
-0001c780: 2061 2043 6f6c 6f72 206f 7220 3344 2061   a Color or 3D a
-0001c790: 7272 6179 206f 6620 436f 6c6f 7273 2c20  rray of Colors, 
-0001c7a0: 6f70 7469 6f6e 616c 2c20 6465 6661 756c  optional, defaul
-0001c7b0: 743a 205b 2772 272c 2767 272c 2762 275d  t: ['r','g','b']
-0001c7c0: 0d0a 0d0a 2020 2020 2020 2020 6e65 6761  ....        nega
-0001c7d0: 7869 7320 3a20 626f 6f6c 6561 6e2c 206f  xis : boolean, o
-0001c7e0: 7074 696f 6e61 6c2c 2064 6566 6175 6c74  ptional, default
-0001c7f0: 3a20 4661 6c73 650d 0a20 2020 2020 2020  : False..       
-0001c800: 2020 2020 2049 6620 5472 7565 2c20 696e       If True, in
-0001c810: 636c 7564 6520 7468 6520 6e65 6761 7469  clude the negati
-0001c820: 7665 2061 7869 732c 206f 7468 6572 7769  ve axis, otherwi
-0001c830: 7365 2061 7869 7320 7374 6172 7420 6174  se axis start at
-0001c840: 206f 7269 6769 6e2e 0d0a 0d0a 2020 2020   origin.....    
-0001c850: 2020 2020 5265 7475 726e 730d 0a20 2020      Returns..   
-0001c860: 2020 2020 202d 2d2d 2d2d 2d2d 0d0a 2020       -------..  
-0001c870: 2020 2020 2020 4c69 6e65 3344 436f 6c6c        Line3DColl
-0001c880: 6563 7469 6f6e 206f 626a 6563 740d 0a0d  ection object...
-0001c890: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
-0001c8a0: 2020 2020 2020 6b61 7267 4466 7420 3d20        kargDft = 
-0001c8b0: 7b20 276c 656e 6d75 6c74 273a 312e 302c  { 'lenmult':1.0,
-0001c8c0: 2027 7769 6474 6827 3a31 2e35 2c20 2763   'width':1.5, 'c
-0001c8d0: 6f6c 6f72 273a 5b27 7227 2c27 6727 2c27  olor':['r','g','
-0001c8e0: 6227 5d2c 2027 6e65 6761 7869 7327 3a46  b'], 'negaxis':F
-0001c8f0: 616c 7365 207d 0d0a 2020 2020 2020 2020  alse }..        
-0001c900: 4b57 203d 204b 5770 726f 6365 7373 6f72  KW = KWprocessor
-0001c910: 286b 6172 6744 6674 2c27 6765 745f 7472  (kargDft,'get_tr
-0001c920: 616e 7366 6f72 6d41 7869 7327 2c2a 2a6b  ansformAxis',**k
-0001c930: 6172 6773 290d 0a20 2020 2020 2020 206c  args)..        l
-0001c940: 656e 6d75 6c74 203d 204b 572e 6765 7456  enmult = KW.getV
-0001c950: 616c 2827 6c65 6e6d 756c 7427 290d 0a20  al('lenmult').. 
-0001c960: 2020 2020 2020 2077 6964 7468 203d 204b         width = K
-0001c970: 572e 6765 7456 616c 2827 7769 6474 6827  W.getVal('width'
-0001c980: 290d 0a20 2020 2020 2020 2063 6f6c 6f72  )..        color
-0001c990: 203d 204b 572e 6765 7456 616c 2827 636f   = KW.getVal('co
-0001c9a0: 6c6f 7227 290d 0a20 2020 2020 2020 206e  lor')..        n
-0001c9b0: 6567 6178 6973 203d 204b 572e 6765 7456  egaxis = KW.getV
-0001c9c0: 616c 2827 6e65 6761 7869 7327 290d 0a20  al('negaxis').. 
-0001c9d0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-0001c9e0: 2073 656c 6650 726f 7020 3d20 7b0d 0a20   selfProp = {.. 
-0001c9f0: 2020 2020 2020 2020 2020 2027 7363 616c             'scal
-0001ca00: 6527 203a 2073 656c 662e 7363 616c 652c  e' : self.scale,
-0001ca10: 0d0a 2020 2020 2020 2020 2020 2020 2772  ..            'r
-0001ca20: 6f74 6174 696f 6e27 203a 2073 656c 662e  otation' : self.
-0001ca30: 726f 7461 7469 6f6e 2c0d 0a20 2020 2020  rotation,..     
-0001ca40: 2020 2020 2020 2027 7472 616e 736c 6174         'translat
-0001ca50: 696f 6e27 203a 2073 656c 662e 7472 616e  ion' : self.tran
-0001ca60: 736c 6174 696f 6e0d 0a20 2020 2020 2020  slation..       
-0001ca70: 207d 0d0a 2020 2020 2020 2020 7265 7475   }..        retu
-0001ca80: 726e 205f 7472 616e 7366 6f72 6d41 7869  rn _transformAxi
-0001ca90: 7328 7365 6c66 5072 6f70 2c6c 656e 6d75  s(selfProp,lenmu
-0001caa0: 6c74 2c20 7769 6474 682c 2063 6f6c 6f72  lt, width, color
-0001cab0: 2c20 6e65 6761 7869 7329 0d0a 0d0a 2020  , negaxis)....  
-0001cac0: 2020 6465 6620 6d61 705f 6765 6f6d 5f66    def map_geom_f
-0001cad0: 726f 6d5f 7376 6428 7365 6c66 2c20 6461  rom_svd(self, da
-0001cae0: 7461 2c20 7063 3d4e 6f6e 6520 2920 3a0d  ta, pc=None ) :.
-0001caf0: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
-0001cb00: 2020 2020 2020 5472 616e 7366 6f72 6d20        Transform 
-0001cb10: 7375 7266 6163 6520 6765 6f6d 6574 7279  surface geometry
-0001cb20: 2062 6173 6564 206f 6e20 6120 5043 4120   based on a PCA 
-0001cb30: 616e 616c 7973 6973 206f 6620 6120 6461  analysis of a da
-0001cb40: 7461 2073 6574 2e0d 0a20 2020 2020 2020  ta set...       
-0001cb50: 2052 6573 756c 7420 7661 6c75 6573 2063   Result values c
-0001cb60: 6f6e 7461 696e 6564 2069 6e20 7468 6520  ontained in the 
-0001cb70: 7375 7266 6163 6520 7072 6f70 6572 7479  surface property
-0001cb80: 2073 7664 5f64 6963 742e 0d0a 2020 2020   svd_dict...    
-0001cb90: 2020 2020 0d0a 2020 2020 2020 2020 5061      ..        Pa
-0001cba0: 7261 6d65 7465 7273 0d0a 2020 2020 2020  rameters..      
-0001cbb0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
-0001cbc0: 2020 2020 2020 6461 7461 203a 204e 2078        data : N x
-0001cbd0: 2033 2061 7272 6179 206f 6620 782c 792c   3 array of x,y,
-0001cbe0: 7a20 6461 7461 2063 6f6f 7264 696e 6174  z data coordinat
-0001cbf0: 6573 2e0d 0a20 2020 2020 2020 200d 0a20  es...        .. 
-0001cc00: 2020 2020 2020 2070 6320 3a20 7363 616c         pc : scal
-0001cc10: 6172 2c20 6f70 7469 6f6e 616c 2c20 6465  ar, optional, de
-0001cc20: 6661 756c 743a 204e 6f6e 650d 0a20 2020  fault: None..   
-0001cc30: 2020 2020 2020 2020 2053 6574 7320 7468           Sets th
-0001cc40: 6520 6d69 6e69 6d75 6d20 7369 7a65 206f  e minimum size o
-0001cc50: 6620 7468 6520 7375 7266 6163 6520 6261  f the surface ba
-0001cc60: 7365 6420 6f6e 2074 6865 0d0a 2020 2020  sed on the..    
-0001cc70: 2020 2020 2020 2020 7265 6c61 7469 7665          relative
-0001cc80: 206e 756d 6265 7220 6f66 2064 6174 612e   number of data.
-0001cc90: 2020 5661 6c75 6520 7261 6e67 6520 6672    Value range fr
-0001cca0: 6f6d 2030 2074 6f20 312c 200d 0a20 2020  om 0 to 1, ..   
-0001ccb0: 2020 2020 2020 2020 2077 6974 6820 3120           with 1 
-0001ccc0: 666f 7220 3130 3025 2e20 2049 6620 4e6f  for 100%.  If No
-0001ccd0: 6e65 2c20 6f6e 6520 7374 616e 6461 7264  ne, one standard
-0001cce0: 2064 6576 6961 7469 6f6e 0d0a 2020 2020   deviation..    
-0001ccf0: 2020 2020 2020 2020 6f66 2074 6865 2064          of the d
-0001cd00: 6174 6120 7365 7473 2074 6865 2073 7572  ata sets the sur
-0001cd10: 6661 6365 2073 697a 652e 0d0a 2020 2020  face size...    
-0001cd20: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-0001cd30: 2020 5265 7475 726e 730d 0a20 2020 2020    Returns..     
-0001cd40: 2020 202d 2d2d 2d2d 2d2d 0d0a 2020 2020     -------..    
-0001cd50: 2020 2020 7365 6c66 203a 2073 7572 6661      self : surfa
-0001cd60: 6365 206f 626a 6563 740d 0a0d 0a20 2020  ce object....   
-0001cd70: 2020 2020 2022 2222 0d0a 0d0a 2020 2020       """....    
-0001cd80: 2020 2020 6966 2073 656c 662e 5f69 7343      if self._isC
-0001cd90: 6f6d 706f 7369 7465 5375 7266 6163 6520  ompositeSurface 
-0001cda0: 3a0d 0a20 2020 2020 2020 2020 2020 2077  :..            w
-0001cdb0: 6172 6e69 6e67 732e 7761 726e 2827 4461  arnings.warn('Da
-0001cdc0: 7461 206f 7065 7261 7469 6f6e 206e 6f74  ta operation not
-0001cdd0: 2061 7661 696c 6162 6c65 2066 6f72 2063   available for c
-0001cde0: 6f6d 6269 6e65 6420 7368 6170 6573 2e27  ombined shapes.'
-0001cdf0: 290d 0a20 2020 2020 2020 2020 2020 2072  )..            r
-0001ce00: 6574 7572 6e20 7365 6c66 0d0a 2020 2020  eturn self..    
-0001ce10: 2020 2020 6461 7461 5f6d 6561 6e20 3d20      data_mean = 
-0001ce20: 6461 7461 2e6d 6561 6e28 6178 6973 3d30  data.mean(axis=0
-0001ce30: 290d 0a20 2020 2020 2020 2064 6174 615f  )..        data_
-0001ce40: 6365 6e74 6572 6564 203d 2064 6174 6120  centered = data 
-0001ce50: 2d20 6461 7461 5f6d 6561 6e0d 0a0d 0a20  - data_mean.... 
-0001ce60: 2020 2020 2020 2055 612c 2073 612c 2056         Ua, sa, V
-0001ce70: 7461 203d 206e 702e 6c69 6e61 6c67 2e73  ta = np.linalg.s
-0001ce80: 7664 2864 6174 615f 6365 6e74 6572 6564  vd(data_centered
-0001ce90: 290d 0a20 2020 2020 2020 2064 6174 6141  )..        dataA
-0001cea0: 7665 203d 206e 702e 6d65 616e 2873 6129  ve = np.mean(sa)
-0001ceb0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-0001cec0: 2073 6361 6c65 203d 2073 612f 6461 7461   scale = sa/data
-0001ced0: 4176 650d 0a20 2020 2020 2020 2074 7261  Ave..        tra
-0001cee0: 6e44 6174 6120 3d20 6e70 2e64 6976 6964  nData = np.divid
-0001cef0: 6528 6e70 2e64 6f74 2864 6174 615f 6365  e(np.dot(data_ce
-0001cf00: 6e74 6572 6564 2c56 7461 2e54 292c 7363  ntered,Vta.T),sc
-0001cf10: 616c 6520 2920 2020 2020 2020 0d0a 2020  ale )       ..  
-0001cf20: 2020 2020 2020 6469 7341 7272 3d6e 702e        disArr=np.
-0001cf30: 6c69 6e61 6c67 2e6e 6f72 6d28 7472 616e  linalg.norm(tran
-0001cf40: 4461 7461 2c61 7869 733d 3129 2020 2020  Data,axis=1)    
-0001cf50: 2020 0d0a 2020 2020 2020 2020 6469 7341    ..        disA
-0001cf60: 7272 5375 6d20 3d20 6e70 2e6c 696e 616c  rrSum = np.linal
-0001cf70: 672e 6e6f 726d 2864 6973 4172 7229 0d0a  g.norm(disArr)..
-0001cf80: 2020 2020 2020 2020 6c65 6e64 6973 4172          lendisAr
-0001cf90: 7220 3d20 6c65 6e28 6469 7341 7272 290d  r = len(disArr).
-0001cfa0: 0a20 2020 2020 2020 2072 6566 4c65 6e20  .        refLen 
-0001cfb0: 3d20 6469 7341 7272 5375 6d2f 6e70 2e73  = disArrSum/np.s
-0001cfc0: 7172 7428 6c65 6e64 6973 4172 7229 2020  qrt(lendisArr)  
-0001cfd0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-0001cfe0: 733d 7265 664c 656e 0d0a 2020 2020 2020  s=refLen..      
-0001cff0: 2020 6469 7341 7272 2020 3d20 6e70 2e64    disArr  = np.d
-0001d000: 6976 6964 6528 6469 7341 7272 2c72 6566  ivide(disArr,ref
-0001d010: 4c65 6e29 0d0a 2020 2020 2020 2020 0d0a  Len)..        ..
-0001d020: 2020 2020 2020 2020 6966 2070 6320 6973          if pc is
-0001d030: 206e 6f74 204e 6f6e 653a 0d0a 2020 2020   not None:..    
-0001d040: 2020 2020 2020 2020 646c 656e 203d 206c          dlen = l
-0001d050: 656e 2864 6973 4172 7229 0d0a 2020 2020  en(disArr)..    
-0001d060: 2020 2020 2020 2020 6469 6e64 6578 203d          dindex =
-0001d070: 2069 6e74 2864 6c65 6e2a 7063 290d 0a20   int(dlen*pc).. 
-0001d080: 2020 2020 2020 2020 2020 2069 6620 6469             if di
-0001d090: 6e64 6578 203e 3d20 646c 656e 203a 2064  ndex >= dlen : d
-0001d0a0: 696e 6465 7820 3d20 646c 656e 202d 2031  index = dlen - 1
-0001d0b0: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-0001d0c0: 2064 696e 6465 7820 3c20 2030 2020 2020   dindex <  0    
-0001d0d0: 3a20 6469 6e64 6578 203d 2030 0d0a 2020  : dindex = 0..  
-0001d0e0: 2020 2020 2020 2020 2020 7320 3d20 6e70            s = np
-0001d0f0: 2e73 6f72 7428 6469 7341 7272 295b 6469  .sort(disArr)[di
-0001d100: 6e64 6578 5d0d 0a20 2020 2020 2020 2020  ndex]..         
-0001d110: 2020 2064 6973 4172 7220 3d20 6469 7341     disArr = disA
-0001d120: 7272 2f73 0d0a 2020 2020 2020 2020 2020  rr/s..          
-0001d130: 2020 7320 3d20 732a 7265 664c 656e 0d0a    s = s*refLen..
-0001d140: 0d0a 2020 2020 2020 2020 7365 6c66 2e74  ..        self.t
-0001d150: 7261 6e73 666f 726d 2856 7461 2c73 2a73  ransform(Vta,s*s
-0001d160: 6361 6c65 2c64 6174 615f 6d65 616e 2920  cale,data_mean) 
-0001d170: 0d0a 2020 2020 2020 2020 7365 6c66 2e5f  ..        self._
-0001d180: 7376 645f 6469 6374 203d 207b 0d0a 2020  svd_dict = {..  
-0001d190: 2020 2020 2020 2020 2020 2764 6973 6172            'disar
-0001d1a0: 7227 3a20 6469 7341 7272 2c20 2773 6967  r': disArr, 'sig
-0001d1b0: 6d61 273a 2072 6566 4c65 6e2c 2027 7472  ma': refLen, 'tr
-0001d1c0: 616e 7327 3a20 5b56 7461 2c73 2a73 6361  ans': [Vta,s*sca
-0001d1d0: 6c65 2c64 6174 615f 6d65 616e 5d0d 0a20  le,data_mean].. 
-0001d1e0: 2020 2020 2020 207d 0d0a 2020 2020 2020         }..      
-0001d1f0: 2020 7265 7475 726e 2073 656c 660d 0a0d    return self...
-0001d200: 0a20 2020 2064 6566 2063 6f6e 746f 7572  .    def contour
-0001d210: 4c69 6e65 7328 7365 6c66 2c2a 6469 7374  Lines(self,*dist
-0001d220: 2c2a 2a6b 6172 6773 2920 3a0d 0a20 2020  ,**kargs) :..   
-0001d230: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
-0001d240: 2020 436f 6c6f 724c 696e 6533 4443 6f6c    ColorLine3DCol
-0001d250: 6c65 6374 696f 6e20 636f 6e74 6f75 7220  lection contour 
-0001d260: 6c69 6e65 7320 6f6e 2074 6865 2073 7572  lines on the sur
-0001d270: 6661 6365 2e0d 0a0d 0a20 2020 2020 2020  face.....       
-0001d280: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
-0001d290: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
-0001d2a0: 0a20 2020 2020 2020 2064 6973 7420 3a20  .        dist : 
-0001d2b0: 666c 6f61 7473 0d0a 2020 2020 2020 2020  floats..        
-0001d2c0: 2020 2020 4469 7374 616e 6365 7320 6672      Distances fr
-0001d2d0: 6f6d 2074 6865 206f 7269 6769 6e20 746f  om the origin to
-0001d2e0: 2074 6865 2073 7572 6661 6365 206f 6620   the surface of 
-0001d2f0: 696e 7465 7273 6563 7469 6f6e 2c0d 0a20  intersection,.. 
-0001d300: 2020 2020 2020 2020 2020 2061 6c6f 6e67             along
-0001d310: 2074 6865 2064 6972 6563 7469 6f6e 2076   the direction v
-0001d320: 6563 746f 722e 0d0a 2020 2020 2020 2020  ector...        
-0001d330: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-0001d340: 6469 7265 6374 696f 6e20 3a20 6172 7261  direction : arra
-0001d350: 792d 6c69 6b65 2c20 6f70 7469 6f6e 616c  y-like, optional
-0001d360: 2c20 6465 6661 756c 743a 205b 302c 302c  , default: [0,0,
-0001d370: 315d 0d0a 2020 2020 2020 2020 2020 2020  1]..            
-0001d380: 4120 7879 7a20 7665 6374 6f72 206e 6f72  A xyz vector nor
-0001d390: 6d61 6c20 746f 2074 6865 2069 6e74 6572  mal to the inter
-0001d3a0: 7365 6374 696f 6e20 706c 616e 6573 0d0a  section planes..
-0001d3b0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-0001d3c0: 706c 616e 6172 2063 6f6e 746f 7572 7320  planar contours 
-0001d3d0: 6f72 2061 7869 616c 2064 6972 6563 7469  or axial directi
-0001d3e0: 6f6e 206f 660d 0a20 2020 2020 2020 2020  on of..         
-0001d3f0: 2020 2063 796c 696e 6465 7273 2066 6f72     cylinders for
-0001d400: 2063 796c 696e 6472 6963 616c 2063 6f6e   cylindrical con
-0001d410: 746f 7572 732e 0d0a 0d0a 2020 2020 2020  tours.....      
-0001d420: 2020 6e61 6d65 203a 2073 7472 696e 6720    name : string 
-0001d430: 6964 656e 7469 6669 6572 2028 6465 6661  identifier (defa
-0001d440: 756c 7420 4e6f 6e65 290d 0a0d 0a20 2020  ult None)....   
-0001d450: 2020 2020 2063 6f6c 6f72 203a 2063 6f6c       color : col
-0001d460: 6f72 2028 6465 6661 756c 7420 6973 2074  or (default is t
-0001d470: 6865 2073 7572 6661 6365 2063 6f6c 6f72  he surface color
-0001d480: 7329 0d0a 0d0a 2020 2020 2020 2020 636f  s)....        co
-0001d490: 6f72 203a 2069 6e74 6567 6572 206f 7220  or : integer or 
-0001d4a0: 7374 7269 6e67 2069 6e64 6963 6174 696e  string indicatin
-0001d4b0: 6720 7468 6520 7479 7065 206f 6620 636f  g the type of co
-0001d4c0: 6e74 6f75 7220 7375 7266 6163 653a 0d0a  ntour surface:..
-0001d4d0: 2020 2020 2020 2020 2020 2020 302c 2070              0, p
-0001d4e0: 2c20 502c 2078 797a 2c70 6c61 6e61 7220  , P, xyz,planar 
-0001d4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d500: 2d20 706c 616e 6172 2028 6465 6661 756c  - planar (defaul
-0001d510: 7429 0d0a 2020 2020 2020 2020 2020 2020  t)..            
-0001d520: 312c 2063 2c20 432c 2063 796c 696e 6465  1, c, C, cylinde
-0001d530: 722c 7070 6c61 722c 6379 6c69 6e64 7269  r,pplar,cylindri
-0001d540: 6361 6c20 2d20 6379 6c69 6e64 6572 0d0a  cal - cylinder..
-0001d550: 2020 2020 2020 2020 2020 2020 322c 2073              2, s
-0001d560: 2c20 532c 2073 7068 6572 652c 7370 6865  , S, sphere,sphe
-0001d570: 7269 6361 6c20 2020 2020 2020 2020 2020  rical           
-0001d580: 2d20 7370 6865 7265 0d0a 2020 2020 2020  - sphere..      
-0001d590: 2020 2020 2020 332c 2078 2c20 5820 2020        3, x, X   
-0001d5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d5b0: 2020 2020 2020 2020 2020 2d20 792d 7a20            - y-z 
-0001d5c0: 706c 616e 650d 0a20 2020 2020 2020 2020  plane..         
-0001d5d0: 2020 2034 2c20 792c 2059 2020 2020 2020     4, y, Y      
-0001d5e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d5f0: 2020 2020 2020 202d 2078 2d7a 2070 6c61         - x-z pla
-0001d600: 6e65 0d0a 2020 2020 2020 2020 2020 2020  ne..            
-0001d610: 352c 207a 2c20 5a20 2020 2020 2020 2020  5, z, Z         
-0001d620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d630: 2020 2020 2d20 782d 7920 706c 616e 650d      - x-y plane.
-0001d640: 0a0d 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
-0001d650: 6e73 0d0a 2020 2020 2020 2020 2d2d 2d2d  ns..        ----
-0001d660: 2d2d 2d0d 0a20 2020 2020 2020 2073 656c  ---..        sel
-0001d670: 6620 3a20 6c69 6e65 206f 626a 6563 740d  f : line object.
-0001d680: 0a0d 0a20 2020 2020 2020 2022 2222 0d0a  ...        """..
-0001d690: 2020 2020 2020 2020 6578 7444 6674 203d          extDft =
-0001d6a0: 207b 2027 6469 7265 6374 696f 6e27 3a5b   { 'direction':[
-0001d6b0: 302c 302c 312e 305d 2c20 276e 616d 6527  0,0,1.0], 'name'
-0001d6c0: 3a20 4e6f 6e65 2c20 2763 6f6c 6f72 273a  : None, 'color':
-0001d6d0: 204e 6f6e 6520 7d0d 0a20 2020 2020 2020   None }..       
-0001d6e0: 206b 6172 6744 6674 203d 207b 202a 2a5f   kargDft = { **_
-0001d6f0: 434f 4f52 5f4b 5741 5247 532c 202a 2a65  COOR_KWARGS, **e
-0001d700: 7874 4466 7420 7d0d 0a20 2020 2020 2020  xtDft }..       
-0001d710: 204b 5720 3d20 4b57 7072 6f63 6573 736f   KW = KWprocesso
-0001d720: 7228 6b61 7267 4466 742c 2763 6f6e 746f  r(kargDft,'conto
-0001d730: 7572 4c69 6e65 7327 2c2a 2a6b 6172 6773  urLines',**kargs
-0001d740: 290d 0a20 2020 2020 2020 2063 496e 6465  )..        cInde
-0001d750: 7820 3d20 4b57 2e67 6574 5661 6c28 2763  x = KW.getVal('c
-0001d760: 6f6f 7227 290d 0a20 2020 2020 2020 2064  oor')..        d
-0001d770: 6972 6563 7469 6f6e 203d 204b 572e 6765  irection = KW.ge
-0001d780: 7456 616c 2827 6469 7265 6374 696f 6e27  tVal('direction'
-0001d790: 290d 0a20 2020 2020 2020 206e 616d 6520  )..        name 
-0001d7a0: 3d20 4b57 2e67 6574 5661 6c28 276e 616d  = KW.getVal('nam
-0001d7b0: 6527 290d 0a20 2020 2020 2020 2063 6f6c  e')..        col
-0001d7c0: 6f72 203d 204b 572e 6765 7456 616c 2827  or = KW.getVal('
-0001d7d0: 636f 6c6f 7227 290d 0a0d 0a20 2020 2020  color')....     
-0001d7e0: 2020 2069 6620 6469 7265 6374 696f 6e20     if direction 
-0001d7f0: 6973 204e 6f6e 6520 3a20 6469 7265 6374  is None : direct
-0001d800: 696f 6e20 3d20 6578 7444 6674 5b27 6469  ion = extDft['di
-0001d810: 7265 6374 696f 6e27 5d0d 0a20 2020 2020  rection']..     
-0001d820: 2020 2069 6620 6349 6e64 6578 3d3d 3320     if cIndex==3 
-0001d830: 3a20 6349 6e64 6578 2c20 6469 7265 6374  : cIndex, direct
-0001d840: 696f 6e20 3d20 302c 205b 2031 2c30 2c30  ion = 0, [ 1,0,0
-0001d850: 205d 0d0a 2020 2020 2020 2020 6966 2063   ]..        if c
-0001d860: 496e 6465 783d 3d34 203a 2063 496e 6465  Index==4 : cInde
-0001d870: 782c 2064 6972 6563 7469 6f6e 203d 2030  x, direction = 0
-0001d880: 2c20 5b20 302c 312c 3020 5d0d 0a20 2020  , [ 0,1,0 ]..   
-0001d890: 2020 2020 2069 6620 6349 6e64 6578 3d3d       if cIndex==
-0001d8a0: 3520 3a20 6349 6e64 6578 2c20 6469 7265  5 : cIndex, dire
-0001d8b0: 6374 696f 6e20 3d20 302c 205b 2030 2c30  ction = 0, [ 0,0
-0001d8c0: 2c31 205d 0d0a 0d0a 2020 2020 2020 2020  ,1 ]....        
-0001d8d0: 646f 7470 726f 6420 3d20 5f63 6f6f 725f  dotprod = _coor_
-0001d8e0: 646f 7470 726f 6428 6469 7265 6374 696f  dotprod(directio
-0001d8f0: 6e2c 6349 6e64 6578 2c73 656c 662e 7665  n,cIndex,self.ve
-0001d900: 7274 6578 436f 6f72 290d 0a20 2020 2020  rtexCoor)..     
-0001d910: 2020 2063 6f6e 4c69 6e65 7320 3d20 2073     conLines =  s
-0001d920: 656c 662e 5f63 6f6e 746f 7572 4c69 6e65  elf._contourLine
-0001d930: 436f 6c6c 6563 7469 6f6e 2820 646f 7470  Collection( dotp
-0001d940: 726f 642c 6469 7265 6374 696f 6e2c 2a64  rod,direction,*d
-0001d950: 6973 7420 290d 0a20 2020 2020 2020 2069  ist )..        i
-0001d960: 6620 636f 6e4c 696e 6573 2069 7320 4e6f  f conLines is No
-0001d970: 6e65 203a 0d0a 2020 2020 2020 2020 2020  ne :..          
-0001d980: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-0001d990: 6f72 2827 4e6f 2073 7572 6661 6365 2e63  or('No surface.c
-0001d9a0: 6f6e 746f 7572 4c69 6e65 7320 7765 7265  ontourLines were
-0001d9b0: 2066 6f75 6e64 2e27 290d 0a20 2020 2020   found.')..     
-0001d9c0: 2020 2069 6620 6349 6e64 6578 203d 3d20     if cIndex == 
-0001d9d0: 3020 3a20 636f 6e4c 696e 6573 2e5f 706c  0 : conLines._pl
-0001d9e0: 616e 654e 6f72 6d61 6c20 3d20 6469 7265  aneNormal = dire
-0001d9f0: 6374 696f 6e0d 0a20 2020 2020 2020 2069  ction..        i
-0001da00: 6620 6e61 6d65 2069 7320 6e6f 7420 4e6f  f name is not No
-0001da10: 6e65 2020 3a20 636f 6e4c 696e 6573 2e6e  ne  : conLines.n
-0001da20: 616d 6520 3d20 6b61 7267 735b 276e 616d  ame = kargs['nam
-0001da30: 6527 5d0d 0a20 2020 2020 2020 2069 6620  e']..        if 
-0001da40: 636f 6c6f 7220 6973 206e 6f74 204e 6f6e  color is not Non
-0001da50: 6520 3a20 636f 6e4c 696e 6573 2e73 6574  e : conLines.set
-0001da60: 5f63 6f6c 6f72 286b 6172 6773 5b27 636f  _color(kargs['co
-0001da70: 6c6f 7227 5d29 0d0a 2020 2020 2020 2020  lor'])..        
-0001da80: 7265 7475 726e 2063 6f6e 4c69 6e65 730d  return conLines.
-0001da90: 0a0d 0a20 2020 2064 6566 2063 6f6e 746f  ...    def conto
-0001daa0: 7572 4c69 6e65 5365 7428 7365 6c66 2c6e  urLineSet(self,n
-0001dab0: 756d 623d 322c 2a2a 6b61 7267 7329 203a  umb=2,**kargs) :
-0001dac0: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
-0001dad0: 2020 2020 2020 2043 6f6c 6f72 4c69 6e65         ColorLine
-0001dae0: 3344 436f 6c6c 6563 7469 6f6e 206f 6620  3DCollection of 
-0001daf0: 6576 656e 6c79 2073 7061 6365 6420 636f  evenly spaced co
-0001db00: 6e74 6f75 7220 6c69 6e65 7320 6f6e 2074  ntour lines on t
-0001db10: 6865 2073 7572 6661 6365 2e0d 0a0d 0a20  he surface..... 
-0001db20: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-0001db30: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
-0001db40: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 206e  -----..        n
-0001db50: 756d 6220 3a20 696e 7465 6765 720d 0a20  umb : integer.. 
-0001db60: 2020 2020 2020 2020 2020 204e 756d 6265             Numbe
-0001db70: 7220 6f66 2063 6f6e 746f 7572 206c 696e  r of contour lin
-0001db80: 6573 2069 6e74 6572 7365 6374 696e 6720  es intersecting 
-0001db90: 6120 7375 7266 6163 652e 0d0a 2020 2020  a surface...    
-0001dba0: 2020 2020 2020 2020 4e75 6d62 2076 616c          Numb val
-0001dbb0: 7565 206d 7573 7420 6265 2067 6574 7465  ue must be gette
-0001dbc0: 7220 7468 616e 207a 6572 6f2e 2020 2020  r than zero.    
-0001dbd0: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
-0001dbe0: 2020 2020 2064 6972 6563 7469 6f6e 203a       direction :
-0001dbf0: 2061 7272 6179 2d6c 696b 652c 206f 7074   array-like, opt
-0001dc00: 696f 6e61 6c2c 2064 6566 6175 6c74 3a20  ional, default: 
-0001dc10: 5b30 2c30 2c31 5d0d 0a20 2020 2020 2020  [0,0,1]..       
-0001dc20: 2020 2020 2041 2078 797a 2076 6563 746f       A xyz vecto
-0001dc30: 7220 6e6f 726d 616c 2074 6f20 7468 6520  r normal to the 
-0001dc40: 696e 7465 7273 6563 7469 6f6e 2070 6c61  intersection pla
-0001dc50: 6e65 730d 0a20 2020 2020 2020 2020 2020  nes..           
-0001dc60: 2066 6f72 2070 6c61 6e61 7220 636f 6e74   for planar cont
-0001dc70: 6f75 7273 206f 7220 6178 6961 6c20 6469  ours or axial di
-0001dc80: 7265 6374 696f 6e20 6f66 0d0a 2020 2020  rection of..    
-0001dc90: 2020 2020 2020 2020 6379 6c69 6e64 6572          cylinder
-0001dca0: 7320 666f 7220 6379 6c69 6e64 7269 6361  s for cylindrica
-0001dcb0: 6c20 636f 6e74 6f75 7273 2e0d 0a0d 0a20  l contours..... 
-0001dcc0: 2020 2020 2020 206e 616d 6520 203a 2073         name  : s
-0001dcd0: 7472 696e 6720 6964 656e 7469 6669 6572  tring identifier
-0001dce0: 2028 6465 6661 756c 7420 4e6f 6e65 290d   (default None).
-0001dcf0: 0a0d 0a20 2020 2020 2020 2063 6f6c 6f72  ...        color
-0001dd00: 203a 2063 6f6c 6f72 2028 6465 6661 756c   : color (defaul
-0001dd10: 7420 6973 2074 6865 2073 7572 6661 6365  t is the surface
-0001dd20: 2063 6f6c 6f72 7329 0d0a 0d0a 2020 2020   colors)....    
-0001dd30: 2020 2020 636f 6f72 203a 2069 6e74 6567      coor : integ
-0001dd40: 6572 206f 7220 7374 7269 6e67 2069 6e64  er or string ind
-0001dd50: 6963 6174 696e 6720 7468 6520 7479 7065  icating the type
-0001dd60: 206f 6620 636f 6e74 6f75 7220 7375 7266   of contour surf
-0001dd70: 6163 653a 0d0a 2020 2020 2020 2020 2020  ace:..          
-0001dd80: 2020 302c 2070 2c20 502c 2078 797a 2c70    0, p, P, xyz,p
-0001dd90: 6c61 6e61 7220 2020 2020 2020 2020 2020  lanar           
-0001dda0: 2020 2020 2020 2d20 706c 616e 6172 2028        - planar (
-0001ddb0: 6465 6661 756c 7429 0d0a 2020 2020 2020  default)..      
-0001ddc0: 2020 2020 2020 312c 2063 2c20 432c 2063        1, c, C, c
-0001ddd0: 796c 696e 6465 722c 7070 6c61 722c 6379  ylinder,pplar,cy
-0001dde0: 6c69 6e64 7269 6361 6c20 2d20 6379 6c69  lindrical - cyli
-0001ddf0: 6e64 6572 0d0a 2020 2020 2020 2020 2020  nder..          
-0001de00: 2020 322c 2073 2c20 532c 2073 7068 6572    2, s, S, spher
-0001de10: 652c 7370 6865 7269 6361 6c20 2020 2020  e,spherical     
-0001de20: 2020 2020 2020 2d20 7370 6865 7265 0d0a        - sphere..
-0001de30: 2020 2020 2020 2020 2020 2020 332c 2078              3, x
-0001de40: 2c20 5820 2020 2020 2020 2020 2020 2020  , X             
-0001de50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001de60: 2d20 792d 7a20 706c 616e 650d 0a20 2020  - y-z plane..   
-0001de70: 2020 2020 2020 2020 2034 2c20 792c 2059           4, y, Y
-0001de80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001de90: 2020 2020 2020 2020 2020 2020 202d 2078               - x
-0001dea0: 2d7a 2070 6c61 6e65 0d0a 2020 2020 2020  -z plane..      
-0001deb0: 2020 2020 2020 352c 207a 2c20 5a20 2020        5, z, Z   
-0001dec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ded0: 2020 2020 2020 2020 2020 2d20 782d 7920            - x-y 
-0001dee0: 706c 616e 650d 0a0d 0a20 2020 2020 2020  plane....       
-0001def0: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
-0001df00: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
-0001df10: 2020 2073 656c 6620 3a20 6c69 6e65 206f     self : line o
-0001df20: 626a 6563 740d 0a0d 0a20 2020 2020 2020  bject....       
-0001df30: 2022 2222 0d0a 2020 2020 2020 2020 6578   """..        ex
-0001df40: 7444 6674 203d 207b 2027 6469 7265 6374  tDft = { 'direct
-0001df50: 696f 6e27 3a5b 302c 302c 312e 305d 2c20  ion':[0,0,1.0], 
-0001df60: 276e 616d 6527 3a20 4e6f 6e65 2c20 2763  'name': None, 'c
-0001df70: 6f6c 6f72 273a 204e 6f6e 6520 7d0d 0a20  olor': None }.. 
-0001df80: 2020 2020 2020 206b 6172 6744 6674 203d         kargDft =
-0001df90: 207b 202a 2a5f 434f 4f52 5f4b 5741 5247   { **_COOR_KWARG
-0001dfa0: 532c 202a 2a65 7874 4466 7420 7d0d 0a20  S, **extDft }.. 
-0001dfb0: 2020 2020 2020 204b 5720 3d20 4b57 7072         KW = KWpr
-0001dfc0: 6f63 6573 736f 7228 6b61 7267 4466 742c  ocessor(kargDft,
-0001dfd0: 2763 6f6e 746f 7572 4c69 6e65 5365 7427  'contourLineSet'
-0001dfe0: 2c2a 2a6b 6172 6773 290d 0a20 2020 2020  ,**kargs)..     
-0001dff0: 2020 2063 496e 6465 7820 3d20 4b57 2e67     cIndex = KW.g
-0001e000: 6574 5661 6c28 2763 6f6f 7227 290d 0a20  etVal('coor').. 
-0001e010: 2020 2020 2020 2064 6972 6563 7469 6f6e         direction
-0001e020: 203d 204b 572e 6765 7456 616c 2827 6469   = KW.getVal('di
-0001e030: 7265 6374 696f 6e27 290d 0a20 2020 2020  rection')..     
-0001e040: 2020 206e 616d 6520 3d20 4b57 2e67 6574     name = KW.get
-0001e050: 5661 6c28 276e 616d 6527 290d 0a20 2020  Val('name')..   
-0001e060: 2020 2020 2063 6f6c 6f72 203d 204b 572e       color = KW.
-0001e070: 6765 7456 616c 2827 636f 6c6f 7227 290d  getVal('color').
-0001e080: 0a0d 0a20 2020 2020 2020 2064 6f74 7072  ...        dotpr
-0001e090: 6f64 203d 205f 636f 6f72 5f64 6f74 7072  od = _coor_dotpr
-0001e0a0: 6f64 2864 6972 6563 7469 6f6e 2c63 496e  od(direction,cIn
-0001e0b0: 6465 782c 7365 6c66 2e76 6572 7465 7843  dex,self.vertexC
-0001e0c0: 6f6f 7229 2020 0d0a 2020 2020 2020 2020  oor)  ..        
-0001e0d0: 6d61 7864 203d 206e 702e 616d 6178 2864  maxd = np.amax(d
-0001e0e0: 6f74 7072 6f64 290d 0a20 2020 2020 2020  otprod)..       
-0001e0f0: 206d 696e 6420 3d20 6e70 2e61 6d69 6e28   mind = np.amin(
-0001e100: 646f 7470 726f 6429 0d0a 2020 2020 2020  dotprod)..      
-0001e110: 2020 636f 6e76 616c 7320 3d20 6e70 2e6c    convals = np.l
-0001e120: 696e 7370 6163 6528 6d69 6e64 2c6d 6178  inspace(mind,max
-0001e130: 642c 6e75 6d62 2b32 295b 313a 6e75 6d62  d,numb+2)[1:numb
-0001e140: 2b31 5d0d 0a20 2020 2020 2020 2063 6f6e  +1]..        con
-0001e150: 7661 6c73 203d 2074 7570 6c65 2863 6f6e  vals = tuple(con
-0001e160: 7661 6c73 2920 0d0a 2020 2020 2020 2020  vals) ..        
-0001e170: 636f 6e4c 696e 6573 203d 2073 656c 662e  conLines = self.
-0001e180: 5f63 6f6e 746f 7572 4c69 6e65 436f 6c6c  _contourLineColl
-0001e190: 6563 7469 6f6e 2820 646f 7470 726f 642c  ection( dotprod,
-0001e1a0: 6469 7265 6374 696f 6e2c 636f 6e76 616c  direction,conval
-0001e1b0: 7320 290d 0a20 2020 2020 2020 2069 6620  s )..        if 
-0001e1c0: 6349 6e64 6578 203d 3d20 3020 3a20 636f  cIndex == 0 : co
-0001e1d0: 6e4c 696e 6573 2e5f 706c 616e 654e 6f72  nLines._planeNor
-0001e1e0: 6d61 6c20 3d20 6469 7265 6374 696f 6e0d  mal = direction.
-0001e1f0: 0a20 2020 2020 2020 2069 6620 6e61 6d65  .        if name
-0001e200: 2069 7320 6e6f 7420 4e6f 6e65 2020 3a20   is not None  : 
-0001e210: 636f 6e4c 696e 6573 2e6e 616d 6520 3d20  conLines.name = 
-0001e220: 6b61 7267 735b 276e 616d 6527 5d0d 0a20  kargs['name'].. 
-0001e230: 2020 2020 2020 2069 6620 636f 6c6f 7220         if color 
-0001e240: 6973 206e 6f74 204e 6f6e 6520 3a20 636f  is not None : co
-0001e250: 6e4c 696e 6573 2e73 6574 5f63 6f6c 6f72  nLines.set_color
-0001e260: 286b 6172 6773 5b27 636f 6c6f 7227 5d29  (kargs['color'])
-0001e270: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-0001e280: 2020 2020 7265 7475 726e 2063 6f6e 4c69      return conLi
-0001e290: 6e65 730d 0a0d 0a20 2020 2064 6566 2065  nes....    def e
-0001e2a0: 7665 7274 2873 656c 6629 203a 0d0a 2020  vert(self) :..  
-0001e2b0: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
-0001e2c0: 2020 2052 6576 6572 7365 2064 6972 6563     Reverse direc
-0001e2d0: 7469 6f6e 206f 6620 6661 6365 206e 6f72  tion of face nor
-0001e2e0: 6d61 6c73 2e0d 0a20 2020 2020 2020 2022  mals...        "
-0001e2f0: 2222 0d0a 2020 2020 2020 2020 7365 6c66  ""..        self
-0001e300: 2e66 7649 6e64 6963 6573 203d 206e 702e  .fvIndices = np.
-0001e310: 666c 6970 2873 656c 662e 6676 496e 6469  flip(self.fvIndi
-0001e320: 6365 732c 2061 7869 733d 3129 0d0a 2020  ces, axis=1)..  
-0001e330: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-0001e340: 660d 0a0d 0a20 2020 2064 6566 2064 6f6d  f....    def dom
-0001e350: 6169 6e28 7365 6c66 2c20 786c 696d 3d4e  ain(self, xlim=N
-0001e360: 6f6e 652c 2079 6c69 6d3d 4e6f 6e65 2c20  one, ylim=None, 
-0001e370: 7a6c 696d 3d4e 6f6e 6529 203a 0d0a 2020  zlim=None) :..  
-0001e380: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
-0001e390: 2020 2053 6574 2074 6865 2064 6f6d 6169     Set the domai
-0001e3a0: 6e20 6f66 2074 6865 2073 7572 6661 6365  n of the surface
-0001e3b0: 2e0d 0a0d 0a20 2020 2020 2020 2055 7365  .....        Use
-0001e3c0: 6420 666f 7220 7365 7474 696e 6720 7468  d for setting th
-0001e3d0: 6520 646f 6d61 696e 206f 6620 7468 6520  e domain of the 
-0001e3e0: 6261 7365 2e0d 0a0d 0a20 2020 2020 2020  base.....       
-0001e3f0: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
-0001e400: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
-0001e410: 0a20 2020 2020 2020 2078 6c69 6d2c 2079  .        xlim, y
-0001e420: 6c69 6d2c 207a 6c69 6d20 3a20 3264 2061  lim, zlim : 2d a
-0001e430: 7272 6179 730d 0a20 2020 2020 2020 2020  rrays..         
-0001e440: 2020 204d 696e 696d 756d 2061 6e64 206d     Minimum and m
-0001e450: 6178 696d 756d 2076 616c 7565 7320 6f66  aximum values of
-0001e460: 2074 6865 2061 7272 6179 7320 6172 6520   the arrays are 
-0001e470: 7573 6564 2074 6f20 7363 616c 650d 0a20  used to scale.. 
-0001e480: 2020 2020 2020 2020 2020 2061 6e64 2074             and t
-0001e490: 7261 6e73 6c61 7465 2074 6865 2073 7572  ranslate the sur
-0001e4a0: 6661 6365 2066 726f 6d20 616e 2069 6e74  face from an int
-0001e4b0: 6961 6c20 646f 6d61 696e 7320 6f66 0d0a  ial domains of..
-0001e4c0: 2020 2020 2020 2020 2020 2020 5b20 2d31              [ -1
-0001e4d0: 2c20 3120 5d0d 0a20 2020 2020 2020 2020  , 1 ]..         
-0001e4e0: 2020 2049 6620 7365 7420 746f 204e 6f6e     If set to Non
-0001e4f0: 652c 2074 6865 2064 6f6d 6169 6e73 2061  e, the domains a
-0001e500: 7265 2075 6e63 6861 6e67 6564 2e0d 0a0d  re unchanged....
-0001e510: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-0001e520: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-0001e530: 2d0d 0a20 2020 2020 2020 2073 656c 6620  -..        self 
-0001e540: 3a20 7375 7266 6163 6520 6f62 6a65 6374  : surface object
-0001e550: 0d0a 0d0a 2020 2020 2020 2020 2222 220d  ....        """.
-0001e560: 0a20 2020 2020 2020 2064 6566 2073 6574  .        def set
-0001e570: 446f 6d61 696e 2878 797a 2c20 6d78 2c62  Domain(xyz, mx,b
-0001e580: 782c 206d 792c 6279 2c20 6d7a 2c62 7a29  x, my,by, mz,bz)
-0001e590: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
-0001e5a0: 782c 792c 7a20 3d20 7879 7a0d 0a20 2020  x,y,z = xyz..   
-0001e5b0: 2020 2020 2020 2020 2058 203d 206d 782a           X = mx*
-0001e5c0: 7820 2b20 6278 0d0a 2020 2020 2020 2020  x + bx..        
-0001e5d0: 2020 2020 5920 3d20 6d79 2a79 202b 2062      Y = my*y + b
-0001e5e0: 790d 0a20 2020 2020 2020 2020 2020 205a  y..            Z
-0001e5f0: 203d 206d 7a2a 7a20 2b20 627a 0d0a 2020   = mz*z + bz..  
-0001e600: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0001e610: 2058 2c59 2c5a 2020 2020 2020 200d 0a20   X,Y,Z       .. 
-0001e620: 2020 2020 2020 2064 6566 2067 6574 436f         def getCo
-0001e630: 6e74 2820 6c69 6d73 2029 203a 0d0a 2020  nt( lims ) :..  
-0001e640: 2020 2020 2020 2020 2020 6d2c 2062 203d            m, b =
-0001e650: 2031 2e30 2c20 302e 300d 0a20 2020 2020   1.0, 0.0..     
-0001e660: 2020 2020 2020 2069 6620 6c69 6d73 2069         if lims i
-0001e670: 7320 6e6f 7420 4e6f 6e65 203a 0d0a 2020  s not None :..  
-0001e680: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-0001e690: 616c 6c6f 7720 7369 6e67 6c65 2062 6e64  allow single bnd
-0001e6a0: 7279 2074 6f20 6265 2069 6e70 7574 2061  ry to be input a
-0001e6b0: 7320 6120 666c 6f61 740d 0a20 2020 2020  s a float..     
-0001e6c0: 2020 2020 2020 2020 2020 2069 6620 6973             if is
-0001e6d0: 696e 7374 616e 6365 286c 696d 732c 2028  instance(lims, (
-0001e6e0: 696e 742c 666c 6f61 7429 2920 3a20 6c69  int,float)) : li
-0001e6f0: 6d73 203d 205b 2d6c 696d 732c 6c69 6d73  ms = [-lims,lims
-0001e700: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
-0001e710: 2020 206d 2c20 6220 3d20 302e 352a 286c     m, b = 0.5*(l
-0001e720: 696d 735b 315d 2d6c 696d 735b 305d 2920  ims[1]-lims[0]) 
-0001e730: 2c20 302e 352a 286c 696d 735b 315d 2b6c  , 0.5*(lims[1]+l
-0001e740: 696d 735b 305d 290d 0a20 2020 2020 2020  ims[0])..       
-0001e750: 2020 2020 2072 6574 7572 6e20 6d2c 2062       return m, b
-0001e760: 0d0a 2020 2020 2020 2020 6d78 2c20 6278  ..        mx, bx
-0001e770: 203d 2067 6574 436f 6e74 2878 6c69 6d29   = getCont(xlim)
-0001e780: 0d0a 2020 2020 2020 2020 6d79 2c20 6279  ..        my, by
-0001e790: 203d 2067 6574 436f 6e74 2879 6c69 6d29   = getCont(ylim)
-0001e7a0: 0d0a 2020 2020 2020 2020 6d7a 2c20 627a  ..        mz, bz
-0001e7b0: 203d 2067 6574 436f 6e74 287a 6c69 6d29   = getCont(zlim)
-0001e7c0: 0d0a 2020 2020 2020 2020 7365 6c66 2e5f  ..        self._
-0001e7d0: 6d61 705f 6765 6f6d 5f66 726f 6d5f 6f70  map_geom_from_op
-0001e7e0: 286c 616d 6264 6120 4120 3a20 7365 7444  (lambda A : setD
-0001e7f0: 6f6d 6169 6e28 412c 206d 782c 6278 2c20  omain(A, mx,bx, 
-0001e800: 6d79 2c62 792c 206d 7a2c 627a 292c 4661  my,by, mz,bz),Fa
-0001e810: 6c73 652c 4e6f 6e65 2c46 616c 7365 290d  lse,None,False).
-0001e820: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0001e830: 7365 6c66 0d0a 0d0a 0d0a 636c 6173 7320  self......class 
-0001e840: 4375 6269 6353 7572 6661 6365 2853 7572  CubicSurface(Sur
-0001e850: 6661 6365 3344 436f 6c6c 6563 7469 6f6e  face3DCollection
-0001e860: 2920 3a0d 0a20 2020 2022 2222 0d0a 2020  ) :..    """..  
-0001e870: 2020 4375 6269 6320 3344 2073 7572 6661    Cubic 3D surfa
-0001e880: 6365 2069 6e20 4361 7274 6573 6961 6e20  ce in Cartesian 
-0001e890: 636f 6f72 6469 6e61 7465 7320 7769 7468  coordinates with
-0001e8a0: 2072 6563 7461 6e67 756c 6172 2066 6163   rectangular fac
-0001e8b0: 6573 2e0d 0a0d 0a20 2020 204d 6574 686f  es.....    Metho
-0001e8c0: 6473 2061 7265 2069 6e68 6572 6974 6564  ds are inherited
-0001e8d0: 2066 726f 6d20 7468 6520 5375 7266 6163   from the Surfac
-0001e8e0: 6533 4443 6f6c 6c65 6374 696f 6e2e 0d0a  e3DCollection...
-0001e8f0: 0d0a 2020 2020 2222 220d 0a20 2020 200d  ..    """..    .
-0001e900: 0a20 2020 2040 7374 6174 6963 6d65 7468  .    @staticmeth
-0001e910: 6f64 200d 0a20 2020 2064 6566 205f 6765  od ..    def _ge
-0001e920: 745f 6375 6269 635f 7375 7266 6163 655f  t_cubic_surface_
-0001e930: 6469 6374 696f 6e61 7279 2829 203a 0d0a  dictionary() :..
-0001e940: 2020 2020 2020 2020 2222 2220 436f 6e73          """ Cons
-0001e950: 7472 7563 7473 2074 6865 2064 6963 7469  tructs the dicti
-0001e960: 6f6e 6172 7920 6f66 2062 6173 6520 706c  onary of base pl
-0001e970: 616e 6172 2073 7572 6661 6365 2067 656f  anar surface geo
-0001e980: 6d65 7472 6965 732e 2022 2222 0d0a 0d0a  metries. """....
-0001e990: 2020 2020 2020 2020 7375 7266 6163 6573          surfaces
-0001e9a0: 4469 6374 696f 6e61 7279 203d 207b 7d0d  Dictionary = {}.
-0001e9b0: 0a20 2020 2020 2020 2062 6173 6556 6572  .        baseVer
-0001e9c0: 7420 3d20 5b5d 0d0a 0d0a 2020 2020 2020  t = []....      
-0001e9d0: 2020 6261 7365 5665 7274 203d 205b 205b    baseVert = [ [
-0001e9e0: 2031 2c2d 312c 202d 315d 2c20 5b20 312c   1,-1, -1], [ 1,
-0001e9f0: 2031 2c20 2d31 5d2c 205b 2d31 2c20 312c   1, -1], [-1, 1,
-0001ea00: 202d 315d 2c20 5b2d 312c 2d31 2c20 2d31   -1], [-1,-1, -1
-0001ea10: 5d2c 0d0a 2020 2020 2020 2020 2020 2020  ],..            
-0001ea20: 2020 2020 2020 2020 205b 2031 2c2d 312c           [ 1,-1,
-0001ea30: 2020 315d 2c20 5b20 312c 2031 2c20 2031    1], [ 1, 1,  1
-0001ea40: 5d2c 205b 2d31 2c20 312c 2020 315d 2c20  ], [-1, 1,  1], 
-0001ea50: 5b2d 312c 2d31 2c20 2031 5d20 5d0d 0a0d  [-1,-1,  1] ]...
-0001ea60: 0a20 2020 2020 2020 2063 7562 6546 6163  .        cubeFac
-0001ea70: 6573 3d28 0d0a 2020 2020 2020 2020 2020  es=(..          
-0001ea80: 2020 5b30 2c31 2c35 2c34 5d2c 205b 312c    [0,1,5,4], [1,
-0001ea90: 322c 362c 355d 2c20 5b32 2c33 2c37 2c36  2,6,5], [2,3,7,6
-0001eaa0: 5d2c 205b 332c 302c 342c 375d 2c0d 0a20  ], [3,0,4,7],.. 
-0001eab0: 2020 2020 2020 2020 2020 205b 342c 352c             [4,5,
-0001eac0: 362c 375d 2c20 5b30 2c33 2c32 2c31 5d0d  6,7], [0,3,2,1].
-0001ead0: 0a20 2020 2020 2020 2029 0d0a 0d0a 2020  .        )....  
-0001eae0: 2020 2020 2020 4663 203d 206c 656e 2863        Fc = len(c
-0001eaf0: 7562 6546 6163 6573 290d 0a0d 0a20 2020  ubeFaces)....   
-0001eb00: 2020 2020 2063 7562 6520 3d20 207b 2027       cube =  { '
-0001eb10: 6261 7365 4661 6365 496e 6469 6365 7327  baseFaceIndices'
-0001eb20: 203a 2063 7562 6546 6163 6573 202c 2027   : cubeFaces , '
-0001eb30: 6261 7365 5665 7274 6963 6573 436f 6f72  baseVerticesCoor
-0001eb40: 2720 3a20 6261 7365 5665 7274 2c20 2766  ' : baseVert, 'f
-0001eb50: 6576 5061 7261 6d27 203a 205b 4663 2c30  evParam' : [Fc,0
-0001eb60: 2c32 5d20 7d0d 0a20 2020 2020 2020 2073  ,2] }..        s
-0001eb70: 7572 6661 6365 7344 6963 7469 6f6e 6172  urfacesDictionar
-0001eb80: 795b 2763 7562 6963 275d 203d 2063 7562  y['cubic'] = cub
-0001eb90: 650d 0a0d 0a20 2020 2020 2020 2072 6574  e....        ret
-0001eba0: 7572 6e20 7375 7266 6163 6573 4469 6374  urn surfacesDict
-0001ebb0: 696f 6e61 7279 0d0a 0d0a 2020 2020 5f62  ionary....    _b
-0001ebc0: 6173 655f 7375 7266 6163 6573 203d 205f  ase_surfaces = _
-0001ebd0: 6765 745f 6375 6269 635f 7375 7266 6163  get_cubic_surfac
-0001ebe0: 655f 6469 6374 696f 6e61 7279 2e5f 5f66  e_dictionary.__f
-0001ebf0: 756e 635f 5f28 290d 0a20 2020 205f 6465  unc__()..    _de
-0001ec00: 6661 756c 745f 6261 7365 203d 2027 6375  fault_base = 'cu
-0001ec10: 6269 6327 2020 2320 6465 6661 756c 7420  bic'  # default 
-0001ec20: 6173 7369 676e 6d65 6e74 2069 7320 696e  assignment is in
-0001ec30: 6469 6361 7465 6420 696e 205f 5f69 6e69  dicated in __ini
-0001ec40: 7420 446f 6373 7472 696e 672e 0d0a 0d0a  t Docstring.....
-0001ec50: 2020 2020 4063 6c61 7373 6d65 7468 6f64      @classmethod
-0001ec60: 0d0a 2020 2020 6465 6620 5f58 6665 7628  ..    def _Xfev(
-0001ec70: 636c 732c 7265 7a2c 2062 6173 6574 7970  cls,rez, basetyp
-0001ec80: 653d 4e6f 6e65 2920 3a0d 0a20 2020 2020  e=None) :..     
-0001ec90: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
-0001eca0: 4361 6c63 756c 6174 6573 2074 6865 206e  Calculates the n
-0001ecb0: 756d 6265 7220 6f66 2066 6163 6573 2c20  umber of faces, 
-0001ecc0: 6564 6765 732c 2061 6e64 2076 6572 7469  edges, and verti
-0001ecd0: 6365 7320 6f66 2061 2043 7562 6963 5375  ces of a CubicSu
-0001ece0: 7266 6163 652e 0d0a 0d0a 2020 2020 2020  rface.....      
-0001ecf0: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
-0001ed00: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-0001ed10: 0d0a 2020 2020 2020 2020 7265 7a20 3a20  ..        rez : 
-0001ed20: 696e 7465 6765 720d 0a20 2020 2020 2020  integer..       
-0001ed30: 2020 2020 204e 756d 6265 7220 6f66 2072       Number of r
-0001ed40: 6563 7572 7369 7665 2073 7562 6469 7669  ecursive subdivi
-0001ed50: 7369 6f6e 7320 6f66 2061 2074 7269 616e  sions of a trian
-0001ed60: 6775 6c61 7465 6420 6261 7365 2066 6163  gulated base fac
-0001ed70: 6573 2e0d 0a20 2020 2020 2020 200d 0a20  es...        .. 
-0001ed80: 2020 2020 2020 2062 6173 6574 7970 6520         basetype 
-0001ed90: 3a20 4e6f 6e65 0d0a 2020 2020 2020 2020  : None..        
-0001eda0: 2020 2020 506c 6163 6568 6f6c 6465 7220      Placeholder 
-0001edb0: 6172 6775 6d65 6e74 2068 6173 206e 6f20  argument has no 
-0001edc0: 6566 6665 6374 2e0d 0a20 2020 2020 2020  effect...       
-0001edd0: 200d 0a20 2020 2020 2020 2052 6574 7572   ..        Retur
-0001ede0: 6e73 0d0a 2020 2020 2020 2020 2d2d 2d2d  ns..        ----
-0001edf0: 2d2d 2d0d 0a20 2020 2020 2020 206c 6973  ---..        lis
-0001ee00: 743a 2074 6865 206e 756d 6265 7220 6f66  t: the number of
-0001ee10: 2066 6163 6573 2c20 6564 6765 732c 2061   faces, edges, a
-0001ee20: 6e64 2076 6572 7469 6365 732e 0d0a 0d0a  nd vertices.....
-0001ee30: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
-0001ee40: 2020 2020 2046 203d 2036 2a28 342a 2a72       F = 6*(4**r
-0001ee50: 657a 2920 0d0a 2020 2020 2020 2020 7265  ez) ..        re
-0001ee60: 7475 726e 205b 2020 462c 2032 2a46 2c20  turn [  F, 2*F, 
-0001ee70: 462b 3220 205d 0d0a 0d0a 2020 2020 6465  F+2  ]....    de
-0001ee80: 6620 5f5f 696e 6974 5f5f 2873 656c 662c  f __init__(self,
-0001ee90: 2072 657a 3d30 2c20 6e61 6d65 3d4e 6f6e   rez=0, name=Non
-0001eea0: 652c 202a 2a6b 7761 7267 7329 3a0d 0a20  e, **kwargs):.. 
-0001eeb0: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
-0001eec0: 2020 2020 4372 6561 7465 2061 2063 7562      Create a cub
-0001eed0: 6963 2073 7572 6661 6365 206f 6620 3220  ic surface of 2 
-0001eee0: 7820 3220 7820 3220 756e 6974 732e 0d0a  x 2 x 2 units...
-0001eef0: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-0001ef00: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
-0001ef10: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
-0001ef20: 2020 7265 7a20 3a20 696e 7465 6765 722c    rez : integer,
-0001ef30: 206f 7074 696f 6e61 6c2c 2064 6566 6175   optional, defau
-0001ef40: 6c74 3a20 300d 0a20 2020 2020 2020 2020  lt: 0..         
-0001ef50: 2020 204e 756d 6265 7220 6f66 2072 6563     Number of rec
-0001ef60: 7572 7369 7665 2073 7562 6469 7669 7369  ursive subdivisi
-0001ef70: 6f6e 7320 6f66 2074 6865 2072 6563 7461  ons of the recta
-0001ef80: 6e67 756c 6174 6564 2062 6173 6520 6661  ngulated base fa
-0001ef90: 6365 732e 0d0a 2020 2020 2020 2020 2020  ces...          
-0001efa0: 2020 5265 7a20 7661 6c75 6573 2072 616e    Rez values ran
-0001efb0: 6765 2066 726f 6d20 3020 746f 2037 2e0d  ge from 0 to 7..
-0001efc0: 0a0d 0a20 2020 2020 2020 206e 616d 6520  ...        name 
-0001efd0: 3a20 7374 7269 6e67 2c20 6f70 7469 6f6e  : string, option
-0001efe0: 616c 2c20 6465 6661 756c 743a 204e 6f6e  al, default: Non
-0001eff0: 652e 0d0a 2020 2020 2020 2020 2020 2020  e...            
-0001f000: 4465 7363 7269 7074 6976 6520 6964 656e  Descriptive iden
-0001f010: 7469 6669 6572 2066 6f72 2074 6865 2067  tifier for the g
-0001f020: 656f 6d65 7472 792e 0d0a 2020 2020 2020  eometry...      
-0001f030: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-0001f040: 5261 6973 6573 0d0a 2020 2020 2020 2020  Raises..        
-0001f050: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
-0001f060: 5661 6c75 6545 7272 6f72 0d0a 2020 2020  ValueError..    
-0001f070: 2020 2020 2020 2020 4966 2072 657a 2069          If rez i
-0001f080: 7320 6e6f 7420 616e 2069 6e74 6567 6572  s not an integer
-0001f090: 2069 6e20 7261 6e67 6520 3020 746f 2037   in range 0 to 7
-0001f0a0: 2e0d 0a0d 0a20 2020 2020 2020 204f 7468  .....        Oth
-0001f0b0: 6572 2050 6172 616d 6574 6572 730d 0a20  er Parameters.. 
-0001f0c0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-0001f0d0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-0001f0e0: 202a 2a6b 7761 7267 730d 0a20 2020 2020   **kwargs..     
-0001f0f0: 2020 2020 2020 2041 6c6c 206f 7468 6572         All other
-0001f100: 2070 6172 616d 6574 6572 7320 6172 6520   parameters are 
-0001f110: 7061 7373 6564 206f 6e20 746f 2027 7333  passed on to 's3
-0001f120: 646c 6962 2e73 7572 6661 6365 2e53 7572  dlib.surface.Sur
-0001f130: 6661 6365 3344 436f 6c6c 6563 7469 6f6e  face3DCollection
-0001f140: 272e 0d0a 0d0a 2020 2020 2020 2020 2222  '.....        ""
-0001f150: 220d 0a20 2020 2020 2020 2023 202e 2e2e  "..        # ...
-0001f160: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0001f170: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0001f180: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0001f190: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e0d 0a20  ............... 
-0001f1a0: 2020 2020 2020 2064 6566 206d 6964 5646         def midVF
-0001f1b0: 756e 2876 6563 7441 2c20 7665 6374 4229  un(vectA, vectB)
-0001f1c0: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
-0001f1d0: 2222 224d 6964 2d70 6f69 6e74 2062 6574  """Mid-point bet
-0001f1e0: 7765 656e 2074 776f 2070 6f69 6e74 7320  ween two points 
-0001f1f0: 696e 2074 6865 2078 7920 706c 616e 652e  in the xy plane.
-0001f200: 2222 220d 0a20 2020 2020 2020 2020 2020  """..           
-0001f210: 206d 6964 203d 206e 702e 6164 6428 7665   mid = np.add(ve
-0001f220: 6374 412c 7665 6374 4229 0d0a 2020 2020  ctA,vectB)..    
-0001f230: 2020 2020 2020 2020 6d69 6420 3d20 6e70          mid = np
-0001f240: 2e6d 756c 7469 706c 7928 302e 352c 6d69  .multiply(0.5,mi
-0001f250: 6429 0d0a 2020 2020 2020 2020 2020 2020  d)..            
-0001f260: 7265 7475 726e 206d 6964 0d0a 2020 2020  return mid..    
-0001f270: 2020 2020 2320 2e2e 2e2e 2e2e 2e2e 2e2e      # ..........
-0001f280: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0001f290: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0001f2a0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0001f2b0: 2e2e 2e2e 2e2e 0d0a 0d0a 2020 2020 2020  ..........      
-0001f2c0: 2020 6966 206e 6f74 2069 7369 6e73 7461    if not isinsta
-0001f2d0: 6e63 6528 7265 7a2c 2069 6e74 2920 3a0d  nce(rez, int) :.
-0001f2e0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-0001f2f0: 7365 2056 616c 7565 4572 726f 7228 2749  se ValueError('I
-0001f300: 6e63 6f72 7265 6374 2072 657a 2074 7970  ncorrect rez typ
-0001f310: 652c 206d 7573 7420 6261 206f 6620 7479  e, must ba of ty
-0001f320: 7065 2069 6e74 2729 0d0a 2020 2020 2020  pe int')..      
-0001f330: 2020 6966 2028 7265 7a3c 3029 206f 7220    if (rez<0) or 
-0001f340: 2872 657a 3e5f 4d41 5852 455a 2920 3a0d  (rez>_MAXREZ) :.
-0001f350: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-0001f360: 7365 2056 616c 7565 4572 726f 7228 2749  se ValueError('I
-0001f370: 6e63 6f72 7265 7374 2072 657a 206f 6620  ncorrest rez of 
-0001f380: 7b7d 2c20 6d75 7374 2062 6520 616e 2069  {}, must be an i
-0001f390: 6e74 2c20 3020 3c3d 2072 657a 203c 3d20  nt, 0 <= rez <= 
-0001f3a0: 7b7d 272e 666f 726d 6174 2872 657a 2c5f  {}'.format(rez,_
-0001f3b0: 4d41 5852 455a 2929 0d0a 2020 2020 2020  MAXREZ))..      
-0001f3c0: 2020 6261 7365 7479 7065 203d 2073 656c    basetype = sel
-0001f3d0: 662e 5f64 6566 6175 6c74 5f62 6173 650d  f._default_base.
-0001f3e0: 0a20 2020 2020 2020 2062 6173 6553 7572  .        baseSur
-0001f3f0: 664f 626a 203d 2073 656c 662e 5f62 6173  fObj = self._bas
-0001f400: 655f 7375 7266 6163 6573 5b62 6173 6574  e_surfaces[baset
-0001f410: 7970 655d 0d0a 2020 2020 2020 2020 6261  ype]..        ba
-0001f420: 7365 5663 6f6f 7220 3d20 6261 7365 5375  seVcoor = baseSu
-0001f430: 7266 4f62 6a5b 2762 6173 6556 6572 7469  rfObj['baseVerti
-0001f440: 6365 7343 6f6f 7227 5d0d 0a20 2020 2020  cesCoor']..     
-0001f450: 2020 2062 6173 6546 6163 6556 6572 7465     baseFaceVerte
-0001f460: 7849 6e64 6963 6573 203d 6261 7365 5375  xIndices =baseSu
-0001f470: 7266 4f62 6a5b 2762 6173 6546 6163 6549  rfObj['baseFaceI
-0001f480: 6e64 6963 6573 275d 0d0a 2020 2020 2020  ndices']..      
-0001f490: 2020 0d0a 2020 2020 2020 2020 696e 6465    ..        inde
-0001f4a0: 784f 626a 2c76 6572 7465 7843 6f6f 7220  xObj,vertexCoor 
-0001f4b0: 3d20 7365 6c66 2e72 6563 7461 6e67 756c  = self.rectangul
-0001f4c0: 6174 6542 6173 6528 7265 7a2c 6261 7365  ateBase(rez,base
-0001f4d0: 5663 6f6f 722c 6261 7365 4661 6365 5665  Vcoor,baseFaceVe
-0001f4e0: 7274 6578 496e 6469 6365 732c 206d 6964  rtexIndices, mid
-0001f4f0: 5646 756e 290d 0a20 2020 2020 2020 2066  VFun)..        f
-0001f500: 6163 6549 6e64 6963 6573 203d 2069 6e64  aceIndices = ind
-0001f510: 6578 4f62 6a5b 2766 6163 6527 5d0d 0a20  exObj['face'].. 
-0001f520: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-0001f530: 2073 7570 6572 2829 2e5f 5f69 6e69 745f   super().__init_
-0001f540: 5f28 7665 7274 6578 436f 6f72 2c20 6661  _(vertexCoor, fa
-0001f550: 6365 496e 6469 6365 732c 206e 616d 652c  ceIndices, name,
-0001f560: 202a 2a6b 7761 7267 7329 0d0a 0d0a 2020   **kwargs)....  
-0001f570: 2020 2020 2020 7365 6c66 2e63 6f6f 7254        self.coorT
-0001f580: 7970 6520 3d20 5f43 4f4f 5253 5953 5b22  ype = _COORSYS["
-0001f590: 5859 5a22 5d0d 0a20 2020 2020 2020 2073  XYZ"]..        s
-0001f5a0: 656c 662e 5f6e 6f72 6d61 6c5f 7363 616c  elf._normal_scal
-0001f5b0: 6520 3d20 5f6e 6f72 6d4c 656e 6774 6828  e = _normLength(
-0001f5c0: 206c 656e 2866 6163 6549 6e64 6963 6573   len(faceIndices
-0001f5d0: 292c 2030 2e36 312c 2031 2e35 3020 290d  ), 0.61, 1.50 ).
-0001f5e0: 0a20 2020 2020 2020 2073 656c 662e 5f72  .        self._r
-0001f5f0: 657a 203d 2072 657a 0d0a 2020 2020 2020  ez = rez..      
-0001f600: 2020 7365 6c66 2e5f 6261 7365 7479 7065    self._basetype
-0001f610: 203d 2062 6173 6574 7970 650d 0a20 2020   = basetype..   
-0001f620: 2020 2020 2072 6574 7572 6e0d 0a0d 0a63       return....c
-0001f630: 6c61 7373 2050 6c61 6e61 7253 7572 6661  lass PlanarSurfa
-0001f640: 6365 2853 7572 6661 6365 3344 436f 6c6c  ce(Surface3DColl
-0001f650: 6563 7469 6f6e 2920 3a0d 0a20 2020 2022  ection) :..    "
-0001f660: 2222 0d0a 2020 2020 466c 6174 2073 7175  ""..    Flat squ
-0001f670: 6172 6520 3344 2073 7572 6661 6365 2069  are 3D surface i
-0001f680: 6e20 4361 7274 6573 6961 6e20 636f 6f72  n Cartesian coor
-0001f690: 6469 6e61 7465 732e 0d0a 0d0a 2020 2020  dinates.....    
-0001f6a0: 4d65 7468 6f64 7320 6172 6520 696e 6865  Methods are inhe
-0001f6b0: 7269 7465 6420 6672 6f6d 2074 6865 2053  rited from the S
-0001f6c0: 7572 6661 6365 3344 436f 6c6c 6563 7469  urface3DCollecti
-0001f6d0: 6f6e 2e0d 0a20 2020 2050 6c61 6e61 7220  on...    Planar 
-0001f6e0: 7375 7266 6163 6520 6765 6f6d 6574 7269  surface geometri
-0001f6f0: 6573 2061 7265 2063 7265 6174 6564 2069  es are created i
-0001f700: 6e20 7468 6973 2073 7562 636c 6173 732e  n this subclass.
-0001f710: 0d0a 0d0a 2020 2020 2222 220d 0a20 2020  ....    """..   
-0001f720: 200d 0a20 2020 2040 7374 6174 6963 6d65   ..    @staticme
-0001f730: 7468 6f64 0d0a 2020 2020 6465 6620 7261  thod..    def ra
-0001f740: 6e64 2872 657a 3d30 2c73 6565 643d 4e6f  nd(rez=0,seed=No
-0001f750: 6e65 2c6e 616d 653d 4e6f 6e65 2c6b 696e  ne,name=None,kin
-0001f760: 643d 4e6f 6e65 2c2a 2a6b 6172 6773 2920  d=None,**kargs) 
-0001f770: 3a0d 0a20 2020 2020 2020 2022 2222 0d0a  :..        """..
-0001f780: 2020 2020 2020 2020 506c 616e 6172 5375          PlanarSu
-0001f790: 7266 6163 6520 7769 7468 2072 616e 646f  rface with rando
-0001f7a0: 6d20 7472 6961 6e67 756c 6172 2066 6163  m triangular fac
-0001f7b0: 6573 2e0d 0a0d 0a20 2020 2020 2020 2050  es.....        P
-0001f7c0: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
-0001f7d0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
-0001f7e0: 2020 2020 2020 2072 657a 203a 206e 756d         rez : num
-0001f7f0: 6265 722c 206f 7074 696f 6e61 6c2c 2064  ber, optional, d
-0001f800: 6566 6175 6c74 3a20 300d 0a20 2020 2020  efault: 0..     
-0001f810: 2020 2020 2020 204e 756d 6265 7220 6f66         Number of
-0001f820: 2027 7265 6375 7273 6976 6527 2073 7562   'recursive' sub
-0001f830: 6469 7669 7369 6f6e 7320 6f66 2074 6865  divisions of the
-0001f840: 2074 7269 616e 6775 6c61 7465 6420 6261   triangulated ba
-0001f850: 7365 2066 6163 6573 2e0d 0a20 2020 2020  se faces...     
-0001f860: 2020 2020 2020 2052 657a 2076 616c 7565         Rez value
-0001f870: 7320 7261 6e67 6520 6672 6f6d 2030 2074  s range from 0 t
-0001f880: 6f20 372e 0d0a 0d0a 2020 2020 2020 2020  o 7.....        
-0001f890: 7365 6564 203a 2069 6e74 6567 6572 2c20  seed : integer, 
-0001f8a0: 6f70 7469 6f6e 616c 2c20 6465 6661 756c  optional, defaul
-0001f8b0: 743a 204e 6f6e 650d 0a20 2020 2020 2020  t: None..       
-0001f8c0: 2020 2020 2041 6e20 696e 6974 6961 6c69       An initiali
-0001f8d0: 7a61 7469 6f6e 2073 6565 6420 666f 7220  zation seed for 
-0001f8e0: 7261 6e64 6f6d 2067 656e 6572 6174 696f  random generatio
-0001f8f0: 6e2e 0d0a 0d0a 2020 2020 2020 2020 6e61  n.....        na
-0001f900: 6d65 203a 2073 7472 696e 672c 206f 7074  me : string, opt
-0001f910: 696f 6e61 6c2c 2064 6566 6175 6c74 3a20  ional, default: 
-0001f920: 4e6f 6e65 2e0d 0a20 2020 2020 2020 2020  None...         
-0001f930: 2020 2044 6573 6372 6970 7469 7665 2069     Descriptive i
-0001f940: 6465 6e74 6966 6965 7220 666f 7220 7468  dentifier for th
-0001f950: 6520 6765 6f6d 6574 7279 2e0d 0a0d 0a20  e geometry..... 
-0001f960: 2020 2020 2020 206b 696e 6420 3a20 7374         kind : st
-0001f970: 7269 6e67 2c20 6f70 7469 6f6e 616c 2c20  ring, optional, 
-0001f980: 6465 6661 756c 743a 204e 6f6e 650d 0a20  default: None.. 
-0001f990: 2020 2020 2020 2020 2020 2028 7265 7365             (rese
-0001f9a0: 7276 6564 2c20 6e6f 7420 696d 706c 656d  rved, not implem
-0001f9b0: 656e 7465 6429 200d 0a0d 0a20 2020 2020  ented) ....     
-0001f9c0: 2020 2052 6169 7365 730d 0a20 2020 2020     Raises..     
-0001f9d0: 2020 202d 2d2d 2d2d 2d0d 0a20 2020 2020     ------..     
-0001f9e0: 2020 2056 616c 7565 4572 726f 720d 0a20     ValueError.. 
-0001f9f0: 2020 2020 2020 2020 2020 2049 6620 7265             If re
-0001fa00: 7a20 6973 206e 6f74 2061 6e20 696e 7465  z is not an inte
-0001fa10: 6765 7220 696e 2072 616e 6765 2030 2074  ger in range 0 t
-0001fa20: 6f20 372e 0d0a 2020 2020 2020 2020 2020  o 7...          
-0001fa30: 2020 4966 2062 6173 6574 7970 6520 6973    If basetype is
-0001fa40: 206e 6f74 2072 6563 6f67 6e69 7a65 6420   not recognized 
-0001fa50: 666f 7220 7468 6973 2073 7572 6661 6365  for this surface
-0001fa60: 2063 6f6e 7374 7275 6374 6f72 2e0d 0a0d   constructor....
-0001fa70: 0a20 2020 2020 2020 204f 7468 6572 2050  .        Other P
-0001fa80: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
-0001fa90: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
-0001faa0: 2d2d 2d0d 0a20 2020 2020 2020 202a 2a6b  ---..        **k
-0001fab0: 7761 7267 730d 0a20 2020 2020 2020 2020  wargs..         
-0001fac0: 2020 2041 6c6c 206f 7468 6572 2070 6172     All other par
-0001fad0: 616d 6574 6572 7320 6172 6520 7061 7373  ameters are pass
-0001fae0: 6564 206f 6e20 746f 2027 7333 646c 6962  ed on to 's3dlib
-0001faf0: 2e73 7572 6661 6365 2e53 7572 6661 6365  .surface.Surface
-0001fb00: 3344 436f 6c6c 6563 7469 6f6e 272e 0d0a  3DCollection'...
-0001fb10: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-0001fb20: 2020 5265 7475 726e 730d 0a20 2020 2020    Returns..     
-0001fb30: 2020 202d 2d2d 2d2d 2d2d 0d0a 2020 2020     -------..    
-0001fb40: 2020 2020 7375 7266 6163 6520 3a20 506c      surface : Pl
-0001fb50: 616e 6172 5375 7266 6163 6520 6f62 6a65  anarSurface obje
-0001fb60: 6374 2e0d 0a0d 0a20 2020 2020 2020 2022  ct.....        "
-0001fb70: 2222 0d0a 0d0a 2020 2020 2020 2020 6966  ""....        if
-0001fb80: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
-0001fb90: 7265 7a2c 2028 696e 742c 666c 6f61 7429  rez, (int,float)
-0001fba0: 2920 3a0d 0a20 2020 2020 2020 2020 2020  ) :..           
-0001fbb0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-0001fbc0: 7228 2749 6e63 6f72 7265 6374 2072 657a  r('Incorrect rez
-0001fbd0: 2074 7970 652c 206d 7573 7420 6265 2061   type, must be a
-0001fbe0: 206e 756d 6265 7227 290d 0a20 2020 2020   number')..     
-0001fbf0: 2020 2069 6620 2872 657a 3c30 2920 6f72     if (rez<0) or
-0001fc00: 2028 7265 7a3e 5f4d 4158 5245 5a29 203a   (rez>_MAXREZ) :
-0001fc10: 0d0a 2020 2020 2020 2020 2020 2020 7261  ..            ra
-0001fc20: 6973 6520 5661 6c75 6545 7272 6f72 2827  ise ValueError('
-0001fc30: 496e 636f 7272 6573 7420 7265 7a20 6f66  Incorrest rez of
-0001fc40: 207b 7d2c 206d 7573 7420 6265 2061 6e20   {}, must be an 
-0001fc50: 696e 742c 2030 203c 3d20 7265 7a20 3c3d  int, 0 <= rez <=
-0001fc60: 207b 7d27 2e66 6f72 6d61 7428 7265 7a2c   {}'.format(rez,
-0001fc70: 5f4d 4158 5245 5a29 290d 0a0d 0a20 2020  _MAXREZ))....   
-0001fc80: 2020 2020 2069 6620 7365 6564 2069 7320       if seed is 
-0001fc90: 6e6f 7420 4e6f 6e65 203a 0d0a 2020 2020  not None :..    
-0001fca0: 2020 2020 2020 2020 6966 206e 6f74 2069          if not i
-0001fcb0: 7369 6e73 7461 6e63 6528 7365 6564 2c20  sinstance(seed, 
-0001fcc0: 696e 7429 203a 0d0a 2020 2020 2020 2020  int) :..        
-0001fcd0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-0001fce0: 6c75 6545 7272 6f72 2827 496e 636f 7272  lueError('Incorr
-0001fcf0: 6563 7420 7365 6564 2074 7970 652c 206d  ect seed type, m
-0001fd00: 7573 7420 6261 206f 6620 7479 7065 2069  ust ba of type i
-0001fd10: 6e74 2729 200d 0a20 2020 2020 2020 2020  nt') ..         
-0001fd20: 2020 206e 702e 7261 6e64 6f6d 2e73 6565     np.random.see
-0001fd30: 6428 7365 6564 290d 0a0d 0a20 2020 2020  d(seed)....     
-0001fd40: 2020 204e 203d 2069 6e74 2820 382a 2834     N = int( 8*(4
-0001fd50: 2a2a 7265 7a29 2f32 202b 2034 2a28 322a  **rez)/2 + 4*(2*
-0001fd60: 2a72 657a 2920 2b20 3120 290d 0a20 2020  *rez) + 1 )..   
-0001fd70: 2020 2020 2078 203d 2032 2a6e 702e 7261       x = 2*np.ra
-0001fd80: 6e64 6f6d 2e72 616e 6428 204e 2029 202d  ndom.rand( N ) -
-0001fd90: 2031 0d0a 2020 2020 2020 2020 7920 3d20   1..        y = 
-0001fda0: 322a 6e70 2e72 616e 646f 6d2e 7261 6e64  2*np.random.rand
-0001fdb0: 2820 4e20 2920 2d20 3120 0d0a 2020 2020  ( N ) - 1 ..    
-0001fdc0: 2020 2020 7879 6461 7461 203d 206e 702e      xydata = np.
-0001fdd0: 6172 7261 7928 5b78 2c79 5d29 2e54 0d0a  array([x,y]).T..
-0001fde0: 2020 2020 2020 2020 7465 7373 203d 2073          tess = s
-0001fdf0: 7061 7469 616c 2e44 656c 6175 6e61 7928  patial.Delaunay(
-0001fe00: 7879 6461 7461 290d 0a0d 0a20 2020 2020  xydata)....     
-0001fe10: 2020 2073 7572 6661 6365 203d 2050 6c61     surface = Pla
-0001fe20: 6e61 7253 7572 6661 6365 286e 616d 653d  narSurface(name=
-0001fe30: 6e61 6d65 2c2a 2a6b 6172 6773 2920 2023  name,**kargs)  #
-0001fe40: 2073 6574 2074 6f20 7468 6520 636c 6173   set to the clas
-0001fe50: 7320 6465 6661 756c 7420 6f62 6a65 6374  s default object
-0001fe60: 0d0a 2020 2020 2020 2020 2320 7265 7365  ..        # rese
-0001fe70: 7420 7665 7274 732c 2066 6163 6549 6e64  t verts, faceInd
-0001fe80: 6963 6573 2061 6e64 2065 6467 6573 2028  ices and edges (
-0001fe90: 7265 7461 696e 2063 6c61 7373 2063 6f6f  retain class coo
-0001fea0: 7264 696e 6174 6520 7379 7374 656d 292e  rdinate system).
-0001feb0: 0d0a 2020 2020 2020 2020 7665 7274 7320  ..        verts 
-0001fec0: 3d20 6e70 2e7a 6572 6f73 2820 284e 2c33  = np.zeros( (N,3
-0001fed0: 2929 0d0a 2020 2020 2020 2020 7665 7274  ))..        vert
-0001fee0: 735b 3a2c 3a32 5d20 3d20 7465 7373 2e70  s[:,:2] = tess.p
-0001fef0: 6f69 6e74 730d 0a20 2020 2020 2020 2066  oints..        f
-0001ff00: 6163 6549 6e64 6963 6573 203d 2074 6573  aceIndices = tes
-0001ff10: 732e 7369 6d70 6c69 6365 730d 0a20 2020  s.simplices..   
-0001ff20: 2020 2020 200d 0a20 2020 2020 2020 2073       ..        s
-0001ff30: 7572 6661 6365 2e76 6572 7465 7843 6f6f  urface.vertexCoo
-0001ff40: 7220 3d20 7665 7274 730d 0a20 2020 2020  r = verts..     
-0001ff50: 2020 2073 7572 6661 6365 2e66 7649 6e64     surface.fvInd
-0001ff60: 6963 6573 203d 2066 6163 6549 6e64 6963  ices = faceIndic
-0001ff70: 6573 0d0a 2020 2020 2020 2020 7375 7266  es..        surf
-0001ff80: 6163 652e 6576 496e 6469 6365 7320 3d20  ace.evIndices = 
-0001ff90: 7375 7266 6163 652e 5f67 6574 5f65 6467  surface._get_edg
-0001ffa0: 6573 5f66 726f 6d5f 6661 6365 7328 6661  es_from_faces(fa
-0001ffb0: 6365 496e 6469 6365 7329 0d0a 2020 2020  ceIndices)..    
-0001ffc0: 2020 2020 7375 7266 6163 652e 7666 496e      surface.vfIn
-0001ffd0: 6469 6365 734c 6973 7420 3d20 7375 7266  dicesList = surf
-0001ffe0: 6163 652e 5f76 6572 7465 7843 6f6d 6d6f  ace._vertexCommo
-0001fff0: 6e46 6163 6549 6e64 6963 6573 2829 0d0a  nFaceIndices()..
-00020000: 2020 2020 2020 2020 7375 7266 6163 652e          surface.
-00020010: 6566 496e 6469 6365 734c 6973 7420 3d20  efIndicesList = 
-00020020: 7375 7266 6163 652e 5f65 6467 6543 6f6d  surface._edgeCom
-00020030: 6d6f 6e46 6163 6549 6e64 6963 6573 2829  monFaceIndices()
-00020040: 0d0a 2020 2020 2020 2020 7375 7266 6163  ..        surfac
-00020050: 652e 7365 745f 7665 7274 7328 2076 6572  e.set_verts( ver
-00020060: 7473 5b66 6163 6549 6e64 6963 6573 5d20  ts[faceIndices] 
-00020070: 290d 0a20 2020 2020 2020 2073 7572 6661  )..        surfa
-00020080: 6365 2e5f 7365 745f 6765 6f6d 6574 7269  ce._set_geometri
-00020090: 635f 626f 756e 6473 2829 0d0a 2020 2020  c_bounds()..    
-000200a0: 2020 2020 7375 7266 6163 652e 5f72 657a      surface._rez
-000200b0: 203d 2073 7472 2872 657a 2920 6966 2069   = str(rez) if i
-000200c0: 7369 6e73 7461 6e63 6528 7265 7a2c 696e  sinstance(rez,in
-000200d0: 7429 2065 6c73 6520 277b 3a2e 3166 7d27  t) else '{:.1f}'
-000200e0: 2e66 6f72 6d61 7428 7265 7a29 0d0a 2020  .format(rez)..  
-000200f0: 2020 2020 2020 7375 7266 6163 652e 5f62        surface._b
-00020100: 6173 6574 7970 6520 3d20 2772 616e 645f  asetype = 'rand_
-00020110: 272b 7374 7228 7365 6564 290d 0a20 2020  '+str(seed)..   
-00020120: 2020 2020 2072 6574 7572 6e20 7375 7266       return surf
-00020130: 6163 650d 0a0d 0a20 2020 2040 7374 6174  ace....    @stat
-00020140: 6963 6d65 7468 6f64 0d0a 2020 2020 6465  icmethod..    de
-00020150: 6620 5f67 6574 5f70 6c61 6e61 725f 7375  f _get_planar_su
-00020160: 7266 6163 6573 5f64 6963 7469 6f6e 6172  rfaces_dictionar
-00020170: 7928 2920 3a0d 0a20 2020 2020 2020 2022  y() :..        "
-00020180: 2222 2043 6f6e 7374 7275 6374 7320 7468  "" Constructs th
-00020190: 6520 6469 6374 696f 6e61 7279 206f 6620  e dictionary of 
-000201a0: 6261 7365 2070 6c61 6e61 7220 7375 7266  base planar surf
-000201b0: 6163 6520 6765 6f6d 6574 7269 6573 2e20  ace geometries. 
-000201c0: 2222 220d 0a0d 0a20 2020 2020 2020 2073  """....        s
-000201d0: 7572 6661 6365 7344 6963 7469 6f6e 6172  urfacesDictionar
-000201e0: 7920 3d20 7b7d 0d0a 0d0a 2020 2020 2020  y = {}....      
-000201f0: 2020 6261 7365 5665 7274 203d 205b 205b    baseVert = [ [
-00020200: 302c 302c 305d 2c0d 0a20 2020 2020 2020  0,0,0],..       
-00020210: 2020 2020 2020 2020 2020 2020 2020 5b31                [1
-00020220: 2c31 2c30 5d2c 205b 2d31 2c31 2c30 5d2c  ,1,0], [-1,1,0],
-00020230: 205b 2d31 2c2d 312c 305d 2c20 5b31 2c2d   [-1,-1,0], [1,-
-00020240: 312c 305d 2c0d 0a20 2020 2020 2020 2020  1,0],..         
-00020250: 2020 2020 2020 2020 2020 2020 5b31 2c30              [1,0
-00020260: 2c30 5d2c 205b 302c 312c 305d 2c20 5b2d  ,0], [0,1,0], [-
-00020270: 312c 302c 305d 2c20 5b30 2c2d 312c 305d  1,0,0], [0,-1,0]
-00020280: 205d 0d0a 0d0a 2020 2020 2020 2020 7156   ]....        qV
-00020290: 6572 7420 3d20 5b20 6261 7365 5665 7274  ert = [ baseVert
-000202a0: 5b69 5d20 666f 7220 6920 696e 2072 616e  [i] for i in ran
-000202b0: 6765 2830 2c35 2920 5d0d 0a0d 0a20 2020  ge(0,5) ]....   
-000202c0: 2020 2020 2071 7561 6446 6163 6573 3d28       quadFaces=(
-000202d0: 200d 0a20 2020 2020 2020 2020 2020 205b   ..            [
-000202e0: 302c 312c 325d 2c5b 302c 322c 335d 2c5b  0,1,2],[0,2,3],[
-000202f0: 302c 332c 345d 2c5b 302c 342c 315d 2029  0,3,4],[0,4,1] )
-00020300: 0d0a 2020 2020 2020 2020 6f63 7446 6163  ..        octFac
-00020310: 6573 313d 280d 0a20 2020 2020 2020 2020  es1=(..         
-00020320: 2020 205b 302c 352c 365d 2c5b 302c 362c     [0,5,6],[0,6,
-00020330: 375d 2c5b 302c 372c 385d 2c5b 302c 382c  7],[0,7,8],[0,8,
-00020340: 355d 2c0d 0a20 2020 2020 2020 2020 2020  5],..           
-00020350: 205b 352c 312c 365d 2c5b 362c 322c 375d   [5,1,6],[6,2,7]
-00020360: 2c5b 372c 332c 385d 2c5b 382c 342c 355d  ,[7,3,8],[8,4,5]
-00020370: 2029 0d0a 2020 2020 2020 2020 6f63 7446   )..        octF
-00020380: 6163 6573 323d 280d 0a20 2020 2020 2020  aces2=(..       
-00020390: 2020 2020 205b 302c 352c 315d 2c5b 302c       [0,5,1],[0,
-000203a0: 312c 365d 2c5b 302c 362c 325d 2c5b 302c  1,6],[0,6,2],[0,
-000203b0: 322c 375d 2c0d 0a20 2020 2020 2020 2020  2,7],..         
-000203c0: 2020 205b 302c 372c 335d 2c5b 302c 332c     [0,7,3],[0,3,
-000203d0: 385d 2c5b 302c 382c 345d 2c5b 302c 342c  8],[0,8,4],[0,4,
-000203e0: 355d 2029 0d0a 2020 2020 2020 2020 6772  5] )..        gr
-000203f0: 6964 4661 6365 733d 280d 0a20 2020 2020  idFaces=(..     
-00020400: 2020 2020 2020 205b 302c 352c 312c 365d         [0,5,1,6]
-00020410: 2c20 5b30 2c36 2c32 2c37 5d2c 205b 302c  , [0,6,2,7], [0,
-00020420: 372c 332c 385d 2c20 5b30 2c38 2c34 2c35  7,3,8], [0,8,4,5
-00020430: 5d0d 0a20 2020 2020 2020 2029 0d0a 0d0a  ]..        )....
-00020440: 2020 2020 2020 2020 4671 203d 206c 656e          Fq = len
-00020450: 2871 7561 6446 6163 6573 290d 0a20 2020  (quadFaces)..   
-00020460: 2020 2020 2046 3120 3d20 6c65 6e28 6f63       F1 = len(oc
-00020470: 7446 6163 6573 3129 0d0a 2020 2020 2020  tFaces1)..      
-00020480: 2020 4632 203d 206c 656e 286f 6374 4661    F2 = len(octFa
-00020490: 6365 7332 290d 0a20 2020 2020 2020 2046  ces2)..        F
-000204a0: 6320 3d20 6c65 6e28 6772 6964 4661 6365  c = len(gridFace
-000204b0: 7329 0d0a 2020 2020 2020 2020 0d0a 2020  s)..        ..  
-000204c0: 2020 2020 2020 7175 6164 203d 2020 7b20        quad =  { 
-000204d0: 2762 6173 6546 6163 6549 6e64 6963 6573  'baseFaceIndices
-000204e0: 2720 3a20 7175 6164 4661 6365 7320 2c20  ' : quadFaces , 
-000204f0: 2762 6173 6556 6572 7469 6365 7343 6f6f  'baseVerticesCoo
-00020500: 7227 203a 2071 5665 7274 2c20 2766 6576  r' : qVert, 'fev
-00020510: 5061 7261 6d27 203a 205b 4671 2c32 2c31  Param' : [Fq,2,1
-00020520: 5d20 7d0d 0a20 2020 2020 2020 206f 6374  ] }..        oct
-00020530: 3120 3d20 207b 2027 6261 7365 4661 6365  1 =  { 'baseFace
-00020540: 496e 6469 6365 7327 203a 206f 6374 4661  Indices' : octFa
-00020550: 6365 7331 202c 2027 6261 7365 5665 7274  ces1 , 'baseVert
-00020560: 6963 6573 436f 6f72 2720 3a20 6261 7365  icesCoor' : base
-00020570: 5665 7274 2c20 2766 6576 5061 7261 6d27  Vert, 'fevParam'
-00020580: 203a 205b 4631 2c34 2c31 5d20 7d0d 0a20   : [F1,4,1] }.. 
-00020590: 2020 2020 2020 206f 6374 3220 3d20 207b         oct2 =  {
-000205a0: 2027 6261 7365 4661 6365 496e 6469 6365   'baseFaceIndice
-000205b0: 7327 203a 206f 6374 4661 6365 7332 202c  s' : octFaces2 ,
-000205c0: 2027 6261 7365 5665 7274 6963 6573 436f   'baseVerticesCo
-000205d0: 6f72 2720 3a20 6261 7365 5665 7274 2c20  or' : baseVert, 
-000205e0: 2766 6576 5061 7261 6d27 203a 205b 4632  'fevParam' : [F2
-000205f0: 2c34 2c31 5d20 7d0d 0a20 2020 2020 2020  ,4,1] }..       
-00020600: 2067 7269 6420 3d20 207b 2027 6261 7365   grid =  { 'base
-00020610: 4661 6365 496e 6469 6365 7327 203a 2067  FaceIndices' : g
-00020620: 7269 6446 6163 6573 202c 2027 6261 7365  ridFaces , 'base
-00020630: 5665 7274 6963 6573 436f 6f72 2720 3a20  VerticesCoor' : 
-00020640: 6261 7365 5665 7274 2c20 2766 6576 5061  baseVert, 'fevPa
-00020650: 7261 6d27 203a 205b 4663 2c30 2c32 5d20  ram' : [Fc,0,2] 
-00020660: 7d0d 0a0d 0a20 2020 2020 2020 2073 7572  }....        sur
-00020670: 6661 6365 7344 6963 7469 6f6e 6172 795b  facesDictionary[
-00020680: 2771 7561 6427 5d20 3d20 7175 6164 0d0a  'quad'] = quad..
-00020690: 2020 2020 2020 2020 7375 7266 6163 6573          surfaces
-000206a0: 4469 6374 696f 6e61 7279 5b27 6f63 7431  Dictionary['oct1
-000206b0: 275d 203d 206f 6374 310d 0a20 2020 2020  '] = oct1..     
-000206c0: 2020 2073 7572 6661 6365 7344 6963 7469     surfacesDicti
-000206d0: 6f6e 6172 795b 276f 6374 3227 5d20 3d20  onary['oct2'] = 
-000206e0: 6f63 7432 0d0a 2020 2020 2020 2020 7375  oct2..        su
-000206f0: 7266 6163 6573 4469 6374 696f 6e61 7279  rfacesDictionary
-00020700: 5b27 7371 7527 5d20 3d20 6772 6964 0d0a  ['squ'] = grid..
-00020710: 0d0a 2020 2020 2020 2020 2320 2d2d 2d2d  ..        # ----
-00020720: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00020730: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00020740: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00020750: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
-00020760: 6d72 203d 2030 2e30 310d 0a20 2020 2020  mr = 0.01..     
-00020770: 2020 204d 5220 3d20 6d72 2a6e 702e 7371     MR = mr*np.sq
-00020780: 7274 2832 290d 0a20 2020 2020 2020 2071  rt(2)..        q
-00020790: 5665 7274 533d 636f 7079 2e63 6f70 7928  VertS=copy.copy(
-000207a0: 2073 7572 6661 6365 7344 6963 7469 6f6e   surfacesDiction
-000207b0: 6172 795b 2771 7561 6427 5d5b 2762 6173  ary['quad']['bas
-000207c0: 6556 6572 7469 6365 7343 6f6f 7227 5d20  eVerticesCoor'] 
-000207d0: 290d 0a20 2020 2020 2020 2071 5665 7274  )..        qVert
-000207e0: 535b 305d 203d 2020 205b 204d 522c 2020  S[0] =   [ MR,  
-000207f0: 302c 2030 5d0d 0a20 2020 2020 2020 2071  0, 0]..        q
-00020800: 5665 7274 532e 6170 7065 6e64 285b 2020  VertS.append([  
-00020810: 302c 204d 522c 2030 5d29 0d0a 2020 2020  0, MR, 0])..    
-00020820: 2020 2020 7156 6572 7453 2e61 7070 656e      qVertS.appen
-00020830: 6428 5b2d 4d52 2c20 2030 2c20 305d 290d  d([-MR,  0, 0]).
-00020840: 0a20 2020 2020 2020 2071 5665 7274 532e  .        qVertS.
-00020850: 6170 7065 6e64 285b 3020 202c 2d4d 522c  append([0  ,-MR,
-00020860: 2030 5d29 0d0a 0d0a 2020 2020 2020 2020   0])....        
-00020870: 6261 7365 5665 7274 5320 3d20 636f 7079  baseVertS = copy
-00020880: 2e63 6f70 7928 7375 7266 6163 6573 4469  .copy(surfacesDi
-00020890: 6374 696f 6e61 7279 5b27 6f63 7431 275d  ctionary['oct1']
-000208a0: 5b27 6261 7365 5665 7274 6963 6573 436f  ['baseVerticesCo
-000208b0: 6f72 275d 290d 0a20 2020 2020 2020 2062  or'])..        b
-000208c0: 6173 6556 6572 7453 5b30 5d20 3d20 2020  aseVertS[0] =   
-000208d0: 5b20 6d72 2c20 6d72 2c20 305d 0d0a 2020  [ mr, mr, 0]..  
-000208e0: 2020 2020 2020 6261 7365 5665 7274 532e        baseVertS.
-000208f0: 6170 7065 6e64 285b 2d6d 722c 206d 722c  append([-mr, mr,
-00020900: 2030 5d29 0d0a 2020 2020 2020 2020 6261   0])..        ba
-00020910: 7365 5665 7274 532e 6170 7065 6e64 285b  seVertS.append([
-00020920: 2d6d 722c 2d6d 722c 2030 5d29 0d0a 2020  -mr,-mr, 0])..  
-00020930: 2020 2020 2020 6261 7365 5665 7274 532e        baseVertS.
-00020940: 6170 7065 6e64 285b 206d 722c 2d6d 722c  append([ mr,-mr,
-00020950: 2030 5d29 0d0a 0d0a 2020 2020 2020 2020   0])....        
-00020960: 7175 6164 4661 6365 7353 3d28 200d 0a20  quadFacesS=( .. 
-00020970: 2020 2020 2020 2020 2020 205b 352c 312c             [5,1,
-00020980: 325d 2c5b 362c 322c 335d 2c5b 372c 332c  2],[6,2,3],[7,3,
-00020990: 345d 2c5b 302c 342c 315d 2c0d 0a20 2020  4],[0,4,1],..   
-000209a0: 2020 2020 2020 2020 205b 312c 352c 305d           [1,5,0]
-000209b0: 2c5b 322c 362c 355d 2c5b 332c 372c 365d  ,[2,6,5],[3,7,6]
-000209c0: 2c5b 342c 302c 375d 2029 0d0a 0d0a 2020  ,[4,0,7] )....  
-000209d0: 2020 2020 2020 6f63 7446 6163 6573 3153        octFaces1S
-000209e0: 3d28 0d0a 2020 2020 2020 2020 2020 2020  =(..            
-000209f0: 5b20 302c 2035 2c20 365d 2c5b 2039 2c20  [ 0, 5, 6],[ 9, 
-00020a00: 362c 2037 5d2c 5b31 302c 2037 2c20 385d  6, 7],[10, 7, 8]
-00020a10: 2c5b 3131 2c20 382c 2035 5d2c 0d0a 2020  ,[11, 8, 5],..  
-00020a20: 2020 2020 2020 2020 2020 5b20 352c 2031            [ 5, 1
-00020a30: 2c20 365d 2c5b 2036 2c20 322c 2037 5d2c  , 6],[ 6, 2, 7],
-00020a40: 5b20 372c 2033 2c20 385d 2c5b 2038 2c20  [ 7, 3, 8],[ 8, 
-00020a50: 342c 2035 5d2c 0d0a 2020 2020 2020 2020  4, 5],..        
-00020a60: 2020 2020 5b20 352c 2030 2c31 315d 2c5b      [ 5, 0,11],[
-00020a70: 2036 2c20 392c 2030 5d2c 5b20 372c 3130   6, 9, 0],[ 7,10
-00020a80: 2c20 395d 2c5b 2038 2c31 312c 3130 5d20  , 9],[ 8,11,10] 
-00020a90: 290d 0a0d 0a20 2020 2020 2020 206f 6374  )....        oct
-00020aa0: 4661 6365 7332 533d 280d 0a20 2020 2020  Faces2S=(..     
-00020ab0: 2020 2020 2020 205b 2030 2c20 352c 2031         [ 0, 5, 1
-00020ac0: 5d2c 5b20 302c 2031 2c20 365d 2c5b 2039  ],[ 0, 1, 6],[ 9
-00020ad0: 2c20 362c 2032 5d2c 5b20 392c 2032 2c20  , 6, 2],[ 9, 2, 
-00020ae0: 375d 2c0d 0a20 2020 2020 2020 2020 2020  7],..           
-00020af0: 205b 3130 2c20 372c 2033 5d2c 5b31 302c   [10, 7, 3],[10,
-00020b00: 2033 2c20 385d 2c5b 3131 2c20 382c 2034   3, 8],[11, 8, 4
-00020b10: 5d2c 5b31 312c 2034 2c20 355d 2c0d 0a20  ],[11, 4, 5],.. 
-00020b20: 2020 2020 2020 2020 2020 205b 2035 2c20             [ 5, 
-00020b30: 302c 3131 5d2c 5b20 362c 2039 2c20 305d  0,11],[ 6, 9, 0]
-00020b40: 2c5b 2037 2c31 302c 2039 5d2c 5b20 382c  ,[ 7,10, 9],[ 8,
-00020b50: 3131 2c31 305d 2029 0d0a 0d0a 0d0a 2020  11,10] )......  
-00020b60: 2020 2020 2020 4671 5320 3d20 6c65 6e28        FqS = len(
-00020b70: 7175 6164 4661 6365 7353 290d 0a20 2020  quadFacesS)..   
-00020b80: 2020 2020 2046 3153 203d 206c 656e 286f       F1S = len(o
-00020b90: 6374 4661 6365 7331 5329 0d0a 2020 2020  ctFaces1S)..    
-00020ba0: 2020 2020 4632 5320 3d20 6c65 6e28 6f63      F2S = len(oc
-00020bb0: 7446 6163 6573 3253 290d 0a20 2020 2020  tFaces2S)..     
-00020bc0: 2020 2071 7561 6453 203d 2020 7b20 2762     quadS =  { 'b
-00020bd0: 6173 6546 6163 6549 6e64 6963 6573 2720  aseFaceIndices' 
-00020be0: 3a20 7175 6164 4661 6365 7353 202c 2027  : quadFacesS , '
-00020bf0: 6261 7365 5665 7274 6963 6573 436f 6f72  baseVerticesCoor
-00020c00: 2720 3a20 7156 6572 7453 2c20 2766 6576  ' : qVertS, 'fev
-00020c10: 5061 7261 6d27 203a 205b 4671 532c 322c  Param' : [FqS,2,
-00020c20: 315d 207d 0d0a 2020 2020 2020 2020 6f63  1] }..        oc
-00020c30: 7431 5320 3d20 207b 2027 6261 7365 4661  t1S =  { 'baseFa
-00020c40: 6365 496e 6469 6365 7327 203a 206f 6374  ceIndices' : oct
-00020c50: 4661 6365 7331 5320 2c20 2762 6173 6556  Faces1S , 'baseV
-00020c60: 6572 7469 6365 7343 6f6f 7227 203a 2062  erticesCoor' : b
-00020c70: 6173 6556 6572 7453 2c20 2766 6576 5061  aseVertS, 'fevPa
-00020c80: 7261 6d27 203a 205b 4631 532c 342c 315d  ram' : [F1S,4,1]
-00020c90: 207d 0d0a 2020 2020 2020 2020 6f63 7432   }..        oct2
-00020ca0: 5320 3d20 207b 2027 6261 7365 4661 6365  S =  { 'baseFace
-00020cb0: 496e 6469 6365 7327 203a 206f 6374 4661  Indices' : octFa
-00020cc0: 6365 7332 5320 2c20 2762 6173 6556 6572  ces2S , 'baseVer
-00020cd0: 7469 6365 7343 6f6f 7227 203a 2062 6173  ticesCoor' : bas
-00020ce0: 6556 6572 7453 2c20 2766 6576 5061 7261  eVertS, 'fevPara
-00020cf0: 6d27 203a 205b 4632 532c 342c 315d 207d  m' : [F2S,4,1] }
-00020d00: 0d0a 0d0a 2020 2020 2020 2020 7375 7266  ....        surf
-00020d10: 6163 6573 4469 6374 696f 6e61 7279 5b27  acesDictionary['
-00020d20: 7175 6164 5f63 275d 203d 2071 7561 6453  quad_c'] = quadS
-00020d30: 0d0a 2020 2020 2020 2020 7375 7266 6163  ..        surfac
-00020d40: 6573 4469 6374 696f 6e61 7279 5b27 6f63  esDictionary['oc
-00020d50: 7431 5f63 275d 203d 206f 6374 3153 0d0a  t1_c'] = oct1S..
-00020d60: 2020 2020 2020 2020 7375 7266 6163 6573          surfaces
-00020d70: 4469 6374 696f 6e61 7279 5b27 6f63 7432  Dictionary['oct2
-00020d80: 5f63 275d 203d 206f 6374 3253 0d0a 0d0a  _c'] = oct2S....
-00020d90: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00020da0: 7572 6661 6365 7344 6963 7469 6f6e 6172  urfacesDictionar
-00020db0: 790d 0a20 2020 200d 0a20 2020 2040 7374  y..    ..    @st
-00020dc0: 6174 6963 6d65 7468 6f64 0d0a 2020 2020  aticmethod..    
-00020dd0: 6465 6620 5f6d 6964 5665 6374 6f72 4675  def _midVectorFu
-00020de0: 6e28 7665 6374 412c 2076 6563 7442 2920  n(vectA, vectB) 
-00020df0: 3a0d 0a20 2020 2020 2020 2022 2222 4d69  :..        """Mi
-00020e00: 642d 706f 696e 7420 6265 7477 6565 6e20  d-point between 
-00020e10: 7477 6f20 706f 696e 7473 2069 6e20 7468  two points in th
-00020e20: 6520 7879 2070 6c61 6e65 2e22 2222 0d0a  e xy plane."""..
-00020e30: 0d0a 2020 2020 2020 2020 6d69 6420 3d20  ..        mid = 
-00020e40: 6e70 2e61 6464 2876 6563 7441 2c76 6563  np.add(vectA,vec
-00020e50: 7442 290d 0a20 2020 2020 2020 206d 6964  tB)..        mid
-00020e60: 203d 206e 702e 6d75 6c74 6970 6c79 2830   = np.multiply(0
-00020e70: 2e35 2c6d 6964 290d 0a20 2020 2020 2020  .5,mid)..       
-00020e80: 2072 6574 7572 6e20 6d69 640d 0a20 2020   return mid..   
-00020e90: 200d 0a20 2020 205f 6261 7365 5f73 7572   ..    _base_sur
-00020ea0: 6661 6365 7320 3d20 5f67 6574 5f70 6c61  faces = _get_pla
-00020eb0: 6e61 725f 7375 7266 6163 6573 5f64 6963  nar_surfaces_dic
-00020ec0: 7469 6f6e 6172 792e 5f5f 6675 6e63 5f5f  tionary.__func__
-00020ed0: 2829 0d0a 2020 2020 5f64 6566 6175 6c74  ()..    _default
-00020ee0: 5f62 6173 6520 3d20 2771 7561 6427 2020  _base = 'quad'  
-00020ef0: 2320 6465 6661 756c 7420 6173 7369 676e  # default assign
-00020f00: 6d65 6e74 2069 7320 696e 6469 6361 7465  ment is indicate
-00020f10: 6420 696e 205f 5f69 6e69 7420 446f 6373  d in __init Docs
-00020f20: 7472 696e 672e 0d0a 0d0a 2020 2020 4063  tring.....    @c
-00020f30: 6c61 7373 6d65 7468 6f64 0d0a 2020 2020  lassmethod..    
-00020f40: 6465 6620 6772 6964 2863 6c73 2c78 6469  def grid(cls,xdi
-00020f50: 762c 2079 6469 762c 2062 6173 6574 7970  v, ydiv, basetyp
-00020f60: 653d 2772 272c 206d 696e 7261 643d 4e6f  e='r', minrad=No
-00020f70: 6e65 2c20 6e61 6d65 3d4e 6f6e 652c 202a  ne, name=None, *
-00020f80: 2a6b 7761 7267 7329 203a 0d0a 2020 2020  *kwargs) :..    
-00020f90: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
-00020fa0: 2050 6c61 6e61 7253 7572 6661 6365 2077   PlanarSurface w
-00020fb0: 6974 6820 5820 616e 6420 5920 7265 6374  ith X and Y rect
-00020fc0: 616e 6775 6c61 7220 6661 6365 732e 0d0a  angular faces...
-00020fd0: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-00020fe0: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
-00020ff0: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
-00021000: 2020 7864 6976 203a 2069 6e74 6567 6572    xdiv : integer
-00021010: 2c20 7265 7175 6972 6564 2e0d 0a20 2020  , required...   
-00021020: 2020 2020 2020 2020 204e 756d 6265 7220           Number 
-00021030: 6f66 2058 2064 6976 6973 696f 6e73 2e0d  of X divisions..
-00021040: 0a0d 0a20 2020 2020 2020 2079 6469 7620  ...        ydiv 
-00021050: 3a20 696e 7465 6765 722c 2072 6571 7569  : integer, requi
-00021060: 7265 642e 0d0a 2020 2020 2020 2020 2020  red...          
-00021070: 2020 4e75 6d62 6572 206f 6620 5920 6469    Number of Y di
-00021080: 7669 7369 6f6e 732e 0d0a 0d0a 2020 2020  visions.....    
-00021090: 2020 2020 6261 7365 7479 7065 203a 207b      basetype : {
-000210a0: 2764 272c 2772 277d 2c20 6f70 7469 6f6e  'd','r'}, option
-000210b0: 616c 2c20 6465 6661 756c 743a 2027 7227  al, default: 'r'
-000210c0: 0d0a 2020 2020 2020 2020 2020 2020 5374  ..            St
-000210d0: 6172 7469 6e67 2073 7572 6661 6365 2067  arting surface g
-000210e0: 656f 6d65 7472 6965 7320 6672 6f6d 2077  eometries from w
-000210f0: 6869 6368 2074 6865 2073 7572 6661 6365  hich the surface
-00021100: 2069 730d 0a20 2020 2020 2020 2020 2020   is..           
-00021110: 2063 6f6e 7374 7275 6374 6564 2069 6e64   constructed ind
-00021120: 6963 6174 696e 6720 6661 6365 2073 6861  icating face sha
-00021130: 7065 2e0d 0a0d 0a20 2020 2020 2020 206d  pe.....        m
-00021140: 696e 7261 6420 3a20 706c 6163 6568 6f6c  inrad : placehol
-00021150: 6465 722c 206e 6f74 2075 7365 642e 0d0a  der, not used...
-00021160: 0d0a 2020 2020 2020 2020 6e61 6d65 203a  ..        name :
-00021170: 2073 7472 696e 672c 206f 7074 696f 6e61   string, optiona
-00021180: 6c2c 2064 6566 6175 6c74 3a20 4e6f 6e65  l, default: None
-00021190: 2e0d 0a20 2020 2020 2020 2020 2020 2044  ...            D
-000211a0: 6573 6372 6970 7469 7665 2069 6465 6e74  escriptive ident
-000211b0: 6966 6965 722e 0d0a 0d0a 2020 2020 2020  ifier.....      
-000211c0: 2020 5261 6973 6573 0d0a 2020 2020 2020    Raises..      
-000211d0: 2020 2d2d 2d2d 2d2d 0d0a 2020 2020 2020    ------..      
-000211e0: 2020 5661 6c75 6545 7272 6f72 0d0a 2020    ValueError..  
-000211f0: 2020 2020 2020 2020 2020 4966 2078 6469            If xdi
-00021200: 7620 6973 206e 6f74 2061 6e20 696e 7465  v is not an inte
-00021210: 6765 7220 6772 6561 7465 7220 6f72 2065  ger greater or e
-00021220: 7175 616c 2074 6f20 312e 0d0a 2020 2020  qual to 1...    
-00021230: 2020 2020 2020 2020 4966 2079 6469 7620          If ydiv 
-00021240: 6973 206e 6f74 2061 6e20 696e 7465 6765  is not an intege
-00021250: 7220 6772 6561 7465 7220 6f72 2065 7175  r greater or equ
-00021260: 616c 2074 6f20 312e 0d0a 0d0a 2020 2020  al to 1.....    
-00021270: 2020 2020 4f74 6865 7220 5061 7261 6d65      Other Parame
-00021280: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
-00021290: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a  --------------..
-000212a0: 2020 2020 2020 2020 2a2a 6b77 6172 6773          **kwargs
-000212b0: 0d0a 2020 2020 2020 2020 2020 2020 416c  ..            Al
-000212c0: 6c20 6f74 6865 7220 7061 7261 6d65 7465  l other paramete
-000212d0: 7273 2061 7265 2070 6173 7365 6420 6f6e  rs are passed on
-000212e0: 2074 6f20 2773 3364 6c69 622e 7375 7266   to 's3dlib.surf
-000212f0: 6163 652e 5375 7266 6163 6533 4443 6f6c  ace.Surface3DCol
-00021300: 6c65 6374 696f 6e27 2e0d 0a20 2020 2020  lection'...     
-00021310: 2020 200d 0a20 2020 2020 2020 2052 6574     ..        Ret
-00021320: 7572 6e73 0d0a 2020 2020 2020 2020 2d2d  urns..        --
-00021330: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2073  -----..        s
-00021340: 7572 6661 6365 203a 2050 6c61 6e61 7253  urface : PlanarS
-00021350: 7572 6661 6365 206f 626a 6563 742e 0d0a  urface object...
-00021360: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
-00021370: 2020 2020 2020 2073 706c 6974 5369 7a65         splitSize
-00021380: 203d 204e 6f6e 650d 0a20 2020 2020 2020   = None..       
-00021390: 206d 696e 7261 6420 3d20 4e6f 6e65 0d0a   minrad = None..
-000213a0: 2020 2020 2020 2020 2320 6e6f 7465 3a20          # note: 
-000213b0: 7265 7665 7273 616c 206f 6620 6e61 6e67  reversal of nang
-000213c0: 2c20 6e72 6164 2061 7267 7375 6d65 6e74  , nrad argsument
-000213d0: 7320 636f 6d70 6172 6564 2074 6f20 6f74  s compared to ot
-000213e0: 6865 7220 696e 6865 7269 7465 6420 636c  her inherited cl
-000213f0: 6173 7320 6772 6964 206d 6574 686f 6473  ass grid methods
-00021400: 2e0d 0a20 2020 2020 2020 206e 7261 642c  ...        nrad,
-00021410: 206e 616e 6720 3d20 7964 6976 2c20 7864   nang = ydiv, xd
-00021420: 6976 0d0a 2020 2020 2020 2020 7375 7266  iv..        surf
-00021430: 6163 6520 3d20 636c 732e 5f73 7175 6172  ace = cls._squar
-00021440: 655f 6e65 7428 6e72 6164 2c20 6e61 6e67  e_net(nrad, nang
-00021450: 2c20 6261 7365 7479 7065 2c6d 696e 7261  , basetype,minra
-00021460: 642c 2073 706c 6974 5369 7a65 2c20 6e61  d, splitSize, na
-00021470: 6d65 2c20 2a2a 6b77 6172 6773 290d 0a20  me, **kwargs).. 
-00021480: 2020 2020 2020 2073 7572 6661 6365 2e5f         surface._
-00021490: 706f 7374 5072 6f63 5f73 7572 6661 6365  postProc_surface
-000214a0: 436f 6c6f 7273 2854 7275 6529 0d0a 2020  Colors(True)..  
-000214b0: 2020 2020 2020 7375 7266 6163 652e 5f72        surface._r
-000214c0: 657a 203d 2073 7572 6661 6365 2e5f 6361  ez = surface._ca
-000214d0: 6c63 5f72 657a 2820 3420 290d 0a20 2020  lc_rez( 4 )..   
-000214e0: 2020 2020 2072 6574 7572 6e20 7375 7266       return surf
-000214f0: 6163 650d 0a0d 0a20 2020 2040 636c 6173  ace....    @clas
-00021500: 736d 6574 686f 640d 0a20 2020 2064 6566  smethod..    def
-00021510: 205f 5866 6576 2863 6c73 2c72 657a 2c20   _Xfev(cls,rez, 
-00021520: 6261 7365 7479 7065 3d4e 6f6e 6529 203a  basetype=None) :
-00021530: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
-00021540: 2020 2020 2020 2043 616c 6375 6c61 7465         Calculate
-00021550: 7320 7468 6520 6e75 6d62 6572 206f 6620  s the number of 
-00021560: 6661 6365 732c 2065 6467 6573 2c20 616e  faces, edges, an
-00021570: 6420 7665 7274 6963 6573 206f 6620 6120  d vertices of a 
-00021580: 506c 616e 6172 5375 7266 6163 652e 0d0a  PlanarSurface...
-00021590: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-000215a0: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
-000215b0: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
-000215c0: 2020 7265 7a20 3a20 696e 7465 6765 720d    rez : integer.
-000215d0: 0a20 2020 2020 2020 2020 2020 204e 756d  .            Num
-000215e0: 6265 7220 6f66 2072 6563 7572 7369 7665  ber of recursive
-000215f0: 2073 7562 6469 7669 7369 6f6e 7320 6f66   subdivisions of
-00021600: 2061 2074 7269 616e 6775 6c61 7465 6420   a triangulated 
-00021610: 6261 7365 2066 6163 6573 2e0d 0a20 2020  base faces...   
-00021620: 2020 2020 200d 0a20 2020 2020 2020 2062       ..        b
-00021630: 6173 6574 7970 6520 3a20 7374 7269 6e67  asetype : string
-00021640: 0d0a 2020 2020 2020 2020 2020 2020 5374  ..            St
-00021650: 6172 7469 6e67 2073 7572 6661 6365 2067  arting surface g
-00021660: 656f 6d65 7472 6965 7320 6672 6f6d 2077  eometries from w
-00021670: 6869 6368 2074 6865 2073 7572 6661 6365  hich the surface
-00021680: 2077 6f75 6c64 2062 650d 0a20 2020 2020   would be..     
-00021690: 2020 2020 2020 2063 6f6e 7374 7275 6374         construct
-000216a0: 6564 2075 7369 6e67 2072 6563 7572 7369  ed using recursi
-000216b0: 7665 2073 7562 6469 7669 7369 6f6e 7320  ve subdivisions 
-000216c0: 6f66 2074 6865 2074 7269 616e 6775 6c61  of the triangula
-000216d0: 7220 6661 6365 732e 0d0a 2020 2020 2020  r faces...      
-000216e0: 2020 0d0a 2020 2020 2020 2020 5265 7475    ..        Retu
-000216f0: 726e 730d 0a20 2020 2020 2020 202d 2d2d  rns..        ---
-00021700: 2d2d 2d2d 0d0a 2020 2020 2020 2020 6c69  ----..        li
-00021710: 7374 3a20 7468 6520 6e75 6d62 6572 206f  st: the number o
-00021720: 6620 6661 6365 732c 2065 6467 6573 2c20  f faces, edges, 
-00021730: 616e 6420 7665 7274 6963 6573 2e0d 0a0d  and vertices....
-00021740: 0a20 2020 2020 2020 2022 2222 0d0a 0d0a  .        """....
-00021750: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00021760: 7570 6572 2829 2e5f 6665 7628 7265 7a2c  uper()._fev(rez,
-00021770: 6261 7365 7479 7065 2c63 6c73 290d 0a0d  basetype,cls)...
-00021780: 0a20 2020 2040 7374 6174 6963 6d65 7468  .    @staticmeth
-00021790: 6f64 0d0a 2020 2020 6465 6620 6d65 7368  od..    def mesh
-000217a0: 6772 6964 2858 2c59 2c5a 2c72 6576 6e6f  grid(X,Y,Z,revno
-000217b0: 726d 616c 3d46 616c 7365 2c67 7269 643d  rmal=False,grid=
-000217c0: 4661 6c73 6529 203a 0d0a 2020 2020 2020  False) :..      
-000217d0: 2020 2222 2250 6c61 6e61 7253 7572 6661    """PlanarSurfa
-000217e0: 6365 206f 626a 6563 7420 6261 7365 6420  ce object based 
-000217f0: 6f6e 2061 206d 6573 6867 7269 642e 2222  on a meshgrid.""
-00021800: 220d 0a0d 0a20 2020 2020 2020 2076 6572  "....        ver
-00021810: 7443 6f6f 7220 3d20 6e70 2e72 6573 6861  tCoor = np.resha
-00021820: 7065 286e 702e 7374 6163 6b28 2858 2c59  pe(np.stack((X,Y
-00021830: 2c5a 292c 2061 7869 733d 3220 292c 2028  ,Z), axis=2 ), (
-00021840: 2d31 2c33 2920 290d 0a20 2020 2020 2020  -1,3) )..       
-00021850: 206c 656e 592c 206c 656e 5820 3d20 5a2e   lenY, lenX = Z.
-00021860: 7368 6170 650d 0a20 2020 2020 2020 206d  shape..        m
-00021870: 7472 203d 206e 702e 7265 7368 6170 6528  tr = np.reshape(
-00021880: 206e 702e 6172 616e 6765 286c 656e 582a   np.arange(lenX*
-00021890: 6c65 6e59 2920 202c 2028 6c65 6e59 2c6c  lenY)  , (lenY,l
-000218a0: 656e 5829 290d 0a20 2020 2020 2020 2041  enX))..        A
-000218b0: 203d 206d 7472 5b3a 2c30 3a6c 656e 582d   = mtr[:,0:lenX-
-000218c0: 315d 5b30 3a6c 656e 592d 312c 3a5d 2e66  1][0:lenY-1,:].f
-000218d0: 6c61 7474 656e 2829 0d0a 2020 2020 2020  latten()..      
-000218e0: 2020 4220 3d20 4120 2b20 310d 0a20 2020    B = A + 1..   
-000218f0: 2020 2020 2043 203d 2041 202b 206c 656e       C = A + len
-00021900: 5820 2b31 0d0a 2020 2020 2020 2020 4420  X +1..        D 
-00021910: 3d20 4120 2b20 6c65 6e58 0d0a 2020 2020  = A + lenX..    
-00021920: 2020 2020 6966 2072 6576 6e6f 726d 616c      if revnormal
-00021930: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
-00021940: 7420 3d20 420d 0a20 2020 2020 2020 2020  t = B..         
-00021950: 2020 2042 203d 2044 0d0a 2020 2020 2020     B = D..      
-00021960: 2020 2020 2020 4420 3d20 740d 0a20 2020        D = t..   
-00021970: 2020 2020 2066 6163 6549 6e64 6963 6573       faceIndices
-00021980: 203d 206e 702e 7374 6163 6b28 2028 412c   = np.stack( (A,
-00021990: 422c 432c 4429 2029 2e54 0d0a 0d0a 2020  B,C,D) ).T....  
-000219a0: 2020 2020 2020 6966 2067 7269 6420 3a20        if grid : 
-000219b0: 6f62 6a20 3d20 506c 616e 6172 5375 7266  obj = PlanarSurf
-000219c0: 6163 6528 2062 6173 6574 7970 653d 2773  ace( basetype='s
-000219d0: 7175 2729 0d0a 2020 2020 2020 2020 656c  qu')..        el
-000219e0: 7365 203a 2020 2020 6f62 6a20 3d20 506c  se :    obj = Pl
-000219f0: 616e 6172 5375 7266 6163 6528 2029 0d0a  anarSurface( )..
-00021a00: 2020 2020 2020 2020 6f62 6a2e 7665 7274          obj.vert
-00021a10: 6578 436f 6f72 203d 2076 6572 7443 6f6f  exCoor = vertCoo
-00021a20: 720d 0a20 2020 2020 2020 206f 626a 2e66  r..        obj.f
-00021a30: 7649 6e64 6963 6573 203d 2066 6163 6549  vIndices = faceI
-00021a40: 6e64 6963 6573 0d0a 2020 2020 2020 2020  ndices..        
-00021a50: 6f62 6a2e 5f6e 6f72 6d61 6c5f 7363 616c  obj._normal_scal
-00021a60: 6520 3d20 5f6e 6f72 6d4c 656e 6774 6828  e = _normLength(
-00021a70: 206c 656e 2866 6163 6549 6e64 6963 6573   len(faceIndices
-00021a80: 292c 2030 2c20 302c 2034 2029 0d0a 2020  ), 0, 0, 4 )..  
-00021a90: 2020 2020 2020 6f62 6a2e 5f73 6574 5f67        obj._set_g
-00021aa0: 656f 6d65 7472 6963 5f62 6f75 6e64 7328  eometric_bounds(
-00021ab0: 290d 0a20 2020 2020 2020 206f 626a 2e5f  )..        obj._
-00021ac0: 7375 7266 6163 6553 6861 7065 4368 616e  surfaceShapeChan
-00021ad0: 6765 6420 3d20 5472 7565 2020 2020 2020  ged = True      
-00021ae0: 2020 0d0a 0d0a 2020 2020 2020 2020 7620    ....        v 
-00021af0: 3d20 6f62 6a2e 7665 7274 6578 436f 6f72  = obj.vertexCoor
-00021b00: 0d0a 2020 2020 2020 2020 6676 6920 3d20  ..        fvi = 
-00021b10: 6f62 6a2e 6676 496e 6469 6365 730d 0a0d  obj.fvIndices...
-00021b20: 0a20 2020 2020 2020 2069 6620 6772 6964  .        if grid
-00021b30: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
-00021b40: 6f62 6a2e 7666 496e 6469 6365 734c 6973  obj.vfIndicesLis
-00021b50: 7420 3d20 6f62 6a2e 5f76 6572 7465 7843  t = obj._vertexC
-00021b60: 6f6d 6d6f 6e46 6163 6549 6e64 6963 6573  ommonFaceIndices
-00021b70: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
-00021b80: 6564 6765 496e 6469 6365 7320 3d20 6f62  edgeIndices = ob
-00021b90: 6a2e 5f67 6574 5f65 6467 6573 5f66 726f  j._get_edges_fro
-00021ba0: 6d5f 6661 6365 7328 6f62 6a2e 6676 496e  m_faces(obj.fvIn
-00021bb0: 6469 6365 7329 0d0a 2020 2020 2020 2020  dices)..        
-00021bc0: 2020 2020 6f62 6a2e 6576 496e 6469 6365      obj.evIndice
-00021bd0: 7320 3d20 6e70 2e61 7272 6179 2865 6467  s = np.array(edg
-00021be0: 6549 6e64 6963 6573 290d 0a20 2020 2020  eIndices)..     
-00021bf0: 2020 2020 2020 206f 626a 2e65 6649 6e64         obj.efInd
-00021c00: 6963 6573 4c69 7374 203d 206f 626a 2e5f  icesList = obj._
-00021c10: 6564 6765 436f 6d6d 6f6e 4661 6365 496e  edgeCommonFaceIn
-00021c20: 6469 6365 7328 290d 0a0d 0a20 2020 2020  dices()....     
-00021c30: 2020 206f 626a 2e73 6574 5f76 6572 7473     obj.set_verts
-00021c40: 2876 5b66 7669 5d29 0d0a 0d0a 2020 2020  (v[fvi])....    
-00021c50: 2020 2020 6966 206e 6f74 2067 7269 6420      if not grid 
-00021c60: 3a20 6f62 6a2e 7472 6961 6e67 756c 6174  : obj.triangulat
-00021c70: 6528 290d 0a0d 0a20 2020 2020 2020 2072  e()....        r
-00021c80: 6574 7572 6e20 6f62 6a0d 0a0d 0a20 2020  eturn obj....   
-00021c90: 2064 6566 205f 5f69 6e69 745f 5f28 7365   def __init__(se
-00021ca0: 6c66 2c20 7265 7a3d 302c 2062 6173 6574  lf, rez=0, baset
-00021cb0: 7970 653d 4e6f 6e65 2c20 6e61 6d65 3d4e  ype=None, name=N
-00021cc0: 6f6e 652c 202a 2a6b 7761 7267 7329 3a0d  one, **kwargs):.
-00021cd0: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
-00021ce0: 2020 2020 2020 4372 6561 7465 2066 6c61        Create fla
-00021cf0: 7420 7371 7561 7265 2073 7572 6661 6365  t square surface
-00021d00: 206f 6620 3220 7820 3220 756e 6974 732e   of 2 x 2 units.
-00021d10: 0d0a 0d0a 2020 2020 2020 2020 5061 7261  ....        Para
-00021d20: 6d65 7465 7273 0d0a 2020 2020 2020 2020  meters..        
-00021d30: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
-00021d40: 2020 2020 7265 7a20 3a20 696e 7465 6765      rez : intege
-00021d50: 722c 206f 7074 696f 6e61 6c2c 2064 6566  r, optional, def
-00021d60: 6175 6c74 3a20 300d 0a20 2020 2020 2020  ault: 0..       
-00021d70: 2020 2020 204e 756d 6265 7220 6f66 2072       Number of r
-00021d80: 6563 7572 7369 7665 2073 7562 6469 7669  ecursive subdivi
-00021d90: 7369 6f6e 7320 6f66 2074 6865 2074 7269  sions of the tri
-00021da0: 616e 6775 6c61 7465 6420 6261 7365 2066  angulated base f
-00021db0: 6163 6573 2e0d 0a20 2020 2020 2020 2020  aces...         
-00021dc0: 2020 2052 657a 2076 616c 7565 7320 7261     Rez values ra
-00021dd0: 6e67 6520 6672 6f6d 2030 2074 6f20 372e  nge from 0 to 7.
-00021de0: 0d0a 2020 2020 2020 2020 2020 2020 0d0a  ..            ..
-00021df0: 2020 2020 2020 2020 6261 7365 7479 7065          basetype
-00021e00: 203a 207b 2771 7561 6427 2c27 6f63 7431   : {'quad','oct1
-00021e10: 272c 276f 6374 3227 2c27 7371 7527 7d2c  ','oct2','squ'},
-00021e20: 206f 7074 696f 6e61 6c2c 2064 6566 6175   optional, defau
-00021e30: 6c74 3a20 2771 7561 6427 0d0a 2020 2020  lt: 'quad'..    
-00021e40: 2020 2020 2020 2020 5374 6172 7469 6e67          Starting
-00021e50: 2073 7572 6661 6365 2067 656f 6d65 7472   surface geometr
-00021e60: 6965 7320 6672 6f6d 2077 6869 6368 2074  ies from which t
-00021e70: 6865 2073 7572 6661 6365 2069 730d 0a20  he surface is.. 
-00021e80: 2020 2020 2020 2020 2020 2063 6f6e 7374             const
-00021e90: 7275 6374 6564 2075 7369 6e67 2072 6563  ructed using rec
-00021ea0: 7572 7369 7665 2073 7562 6469 7669 7369  ursive subdivisi
-00021eb0: 6f6e 7320 6f66 2074 6865 2066 6163 6573  ons of the faces
-00021ec0: 2e0d 0a0d 0a20 2020 2020 2020 206e 616d  .....        nam
-00021ed0: 6520 3a20 7374 7269 6e67 2c20 6f70 7469  e : string, opti
-00021ee0: 6f6e 616c 2c20 6465 6661 756c 743a 204e  onal, default: N
-00021ef0: 6f6e 652e 0d0a 2020 2020 2020 2020 2020  one...          
-00021f00: 2020 4465 7363 7269 7074 6976 6520 6964    Descriptive id
-00021f10: 656e 7469 6669 6572 2066 6f72 2074 6865  entifier for the
-00021f20: 2067 656f 6d65 7472 792e 0d0a 0d0a 2020   geometry.....  
-00021f30: 2020 2020 2020 5261 6973 6573 0d0a 2020        Raises..  
-00021f40: 2020 2020 2020 2d2d 2d2d 2d2d 0d0a 2020        ------..  
-00021f50: 2020 2020 2020 5661 6c75 6545 7272 6f72        ValueError
-00021f60: 0d0a 2020 2020 2020 2020 2020 2020 4966  ..            If
-00021f70: 2072 657a 2069 7320 6e6f 7420 616e 2069   rez is not an i
-00021f80: 6e74 6567 6572 2069 6e20 7261 6e67 6520  nteger in range 
-00021f90: 3020 746f 2037 2e0d 0a20 2020 2020 2020  0 to 7...       
-00021fa0: 2020 2020 2049 6620 6261 7365 7479 7065       If basetype
-00021fb0: 2069 7320 6e6f 7420 7265 636f 676e 697a   is not recogniz
-00021fc0: 6564 2066 6f72 2074 6869 7320 7375 7266  ed for this surf
-00021fd0: 6163 6520 636f 6e73 7472 7563 746f 722e  ace constructor.
-00021fe0: 0d0a 0d0a 2020 2020 2020 2020 4f74 6865  ....        Othe
-00021ff0: 7220 5061 7261 6d65 7465 7273 0d0a 2020  r Parameters..  
-00022000: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00022010: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
-00022020: 2a2a 6b77 6172 6773 0d0a 2020 2020 2020  **kwargs..      
-00022030: 2020 2020 2020 416c 6c20 6f74 6865 7220        All other 
-00022040: 7061 7261 6d65 7465 7273 2061 7265 2070  parameters are p
-00022050: 6173 7365 6420 6f6e 2074 6f20 2773 3364  assed on to 's3d
-00022060: 6c69 622e 7375 7266 6163 652e 5375 7266  lib.surface.Surf
-00022070: 6163 6533 4443 6f6c 6c65 6374 696f 6e27  ace3DCollection'
-00022080: 2e0d 0a0d 0a20 2020 2020 2020 2022 2222  .....        """
-00022090: 0d0a 0d0a 2020 2020 2020 2020 6966 206e  ....        if n
-000220a0: 6f74 2069 7369 6e73 7461 6e63 6528 7265  ot isinstance(re
-000220b0: 7a2c 2069 6e74 2920 3a0d 0a20 2020 2020  z, int) :..     
-000220c0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-000220d0: 7565 4572 726f 7228 2749 6e63 6f72 7265  ueError('Incorre
-000220e0: 6374 2072 657a 2074 7970 652c 206d 7573  ct rez type, mus
-000220f0: 7420 6261 206f 6620 7479 7065 2069 6e74  t ba of type int
-00022100: 2729 0d0a 2020 2020 2020 2020 6966 2028  ')..        if (
-00022110: 7265 7a3c 3029 206f 7220 2872 657a 3e5f  rez<0) or (rez>_
-00022120: 4d41 5852 455a 2920 3a0d 0a20 2020 2020  MAXREZ) :..     
-00022130: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-00022140: 7565 4572 726f 7228 2749 6e63 6f72 7265  ueError('Incorre
-00022150: 7374 2072 657a 206f 6620 7b7d 2c20 6d75  st rez of {}, mu
-00022160: 7374 2062 6520 616e 2069 6e74 2c20 3020  st be an int, 0 
-00022170: 3c3d 2072 657a 203c 3d20 7b7d 272e 666f  <= rez <= {}'.fo
-00022180: 726d 6174 2872 657a 2c5f 4d41 5852 455a  rmat(rez,_MAXREZ
-00022190: 2929 0d0a 2020 2020 2020 2020 6966 2062  ))..        if b
-000221a0: 6173 6574 7970 6520 6973 204e 6f6e 6520  asetype is None 
-000221b0: 3a20 6261 7365 7479 7065 203d 2073 656c  : basetype = sel
-000221c0: 662e 5f64 6566 6175 6c74 5f62 6173 650d  f._default_base.
-000221d0: 0a20 2020 2020 2020 2069 6620 6261 7365  .        if base
-000221e0: 7479 7065 206e 6f74 2069 6e20 7365 6c66  type not in self
-000221f0: 2e5f 6261 7365 5f73 7572 6661 6365 7320  ._base_surfaces 
-00022200: 3a0d 0a20 2020 2020 2020 2020 2020 2072  :..            r
-00022210: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-00022220: 2742 6173 6574 7970 6520 7b7d 2069 7320  'Basetype {} is 
-00022230: 6e6f 7420 7265 636f 676e 697a 6564 2e20  not recognized. 
-00022240: 506f 7373 6962 6c65 2076 616c 7565 7320  Possible values 
-00022250: 6172 653a 207b 7d27 2e66 6f72 6d61 7428  are: {}'.format(
-00022260: 6261 7365 7479 7065 2c6c 6973 7428 7365  basetype,list(se
-00022270: 6c66 2e5f 6261 7365 5f73 7572 6661 6365  lf._base_surface
-00022280: 7329 2929 0d0a 2020 2020 2020 2020 6261  s)))..        ba
-00022290: 7365 5375 7266 4f62 6a20 3d20 7365 6c66  seSurfObj = self
-000222a0: 2e5f 6261 7365 5f73 7572 6661 6365 735b  ._base_surfaces[
-000222b0: 6261 7365 7479 7065 5d0d 0a20 2020 2020  basetype]..     
-000222c0: 2020 2062 6173 6556 636f 6f72 203d 2062     baseVcoor = b
-000222d0: 6173 6553 7572 664f 626a 5b27 6261 7365  aseSurfObj['base
-000222e0: 5665 7274 6963 6573 436f 6f72 275d 0d0a  VerticesCoor']..
-000222f0: 2020 2020 2020 2020 6261 7365 4661 6365          baseFace
-00022300: 5665 7274 6578 496e 6469 6365 7320 3d62  VertexIndices =b
-00022310: 6173 6553 7572 664f 626a 5b27 6261 7365  aseSurfObj['base
-00022320: 4661 6365 496e 6469 6365 7327 5d0d 0a20  FaceIndices'].. 
-00022330: 2020 2020 2020 2069 6620 6261 7365 7479         if basety
-00022340: 7065 2069 7320 2773 7175 2720 3a0d 0a20  pe is 'squ' :.. 
-00022350: 2020 2020 2020 2020 2020 2069 6e64 6578             index
-00022360: 4f62 6a2c 7665 7274 6578 436f 6f72 203d  Obj,vertexCoor =
-00022370: 2073 656c 662e 7265 6374 616e 6775 6c61   self.rectangula
-00022380: 7465 4261 7365 2872 657a 2c62 6173 6556  teBase(rez,baseV
-00022390: 636f 6f72 2c62 6173 6546 6163 6556 6572  coor,baseFaceVer
-000223a0: 7465 7849 6e64 6963 6573 2c20 7365 6c66  texIndices, self
-000223b0: 2e5f 6d69 6456 6563 746f 7246 756e 290d  ._midVectorFun).
-000223c0: 0a20 2020 2020 2020 2065 6c73 6520 3a20  .        else : 
-000223d0: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
-000223e0: 2069 6e64 6578 4f62 6a2c 7665 7274 6578   indexObj,vertex
-000223f0: 436f 6f72 203d 2073 656c 662e 7472 6961  Coor = self.tria
-00022400: 6e67 756c 6174 6542 6173 6528 7265 7a2c  ngulateBase(rez,
-00022410: 6261 7365 5663 6f6f 722c 6261 7365 4661  baseVcoor,baseFa
-00022420: 6365 5665 7274 6578 496e 6469 6365 732c  ceVertexIndices,
-00022430: 2073 656c 662e 5f6d 6964 5665 6374 6f72   self._midVector
-00022440: 4675 6e29 0d0a 2020 2020 2020 2020 6661  Fun)..        fa
-00022450: 6365 496e 6469 6365 7320 3d20 696e 6465  ceIndices = inde
-00022460: 784f 626a 5b27 6661 6365 275d 0d0a 0d0a  xObj['face']....
-00022470: 2020 2020 2020 2020 7375 7065 7228 292e          super().
-00022480: 5f5f 696e 6974 5f5f 2876 6572 7465 7843  __init__(vertexC
-00022490: 6f6f 722c 2066 6163 6549 6e64 6963 6573  oor, faceIndices
-000224a0: 2c20 6e61 6d65 2c20 2a2a 6b77 6172 6773  , name, **kwargs
-000224b0: 290d 0a0d 0a20 2020 2020 2020 2073 656c  )....        sel
-000224c0: 662e 636f 6f72 5479 7065 203d 205f 434f  f.coorType = _CO
-000224d0: 4f52 5359 535b 2258 595a 225d 0d0a 2020  ORSYS["XYZ"]..  
-000224e0: 2020 2020 2020 7365 6c66 2e5f 6e6f 726d        self._norm
-000224f0: 616c 5f73 6361 6c65 203d 205f 6e6f 726d  al_scale = _norm
-00022500: 4c65 6e67 7468 2820 6c65 6e28 6661 6365  Length( len(face
-00022510: 496e 6469 6365 7329 2c20 302c 2030 2c20  Indices), 0, 0, 
-00022520: 3420 290d 0a20 2020 2020 2020 2073 656c  4 )..        sel
-00022530: 662e 5f72 657a 203d 2072 657a 0d0a 2020  f._rez = rez..  
-00022540: 2020 2020 2020 7365 6c66 2e5f 6261 7365        self._base
-00022550: 7479 7065 203d 2062 6173 6574 7970 650d  type = basetype.
-00022560: 0a20 2020 2020 2020 2072 6574 7572 6e0d  .        return.
-00022570: 0a0d 0a20 2020 2064 6566 2073 6361 6c65  ...    def scale
-00022580: 5f64 6174 6166 7261 6d65 2873 656c 662c  _dataframe(self,
-00022590: 582c 592c 5a29 203a 0d0a 2020 2020 2020  X,Y,Z) :..      
-000225a0: 2020 2222 220d 0a20 2020 2020 2020 204c    """..        L
-000225b0: 696e 6561 7220 7363 616c 6520 616e 6420  inear scale and 
-000225c0: 7472 616e 736c 6174 6520 7468 6520 7375  translate the su
-000225d0: 7266 6163 652e 0d0a 0d0a 2020 2020 2020  rface.....      
-000225e0: 2020 5573 6564 2066 6f72 2073 6361 6c69    Used for scali
-000225f0: 6e67 2061 2073 7572 6661 6365 2067 656f  ng a surface geo
-00022600: 6d65 7472 7920 6261 7365 6420 6f6e 2061  metry based on a
-00022610: 2064 6174 6167 7269 642e 0d0a 0d0a 2020   datagrid.....  
-00022620: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
-00022630: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-00022640: 2d2d 2d2d 0d0a 2020 2020 2020 2020 582c  ----..        X,
-00022650: 2059 2c20 5a20 3a20 3264 2061 7272 6179   Y, Z : 2d array
-00022660: 730d 0a20 2020 2020 2020 2020 2020 204d  s..            M
-00022670: 696e 696d 756d 2061 6e64 206d 6178 696d  inimum and maxim
-00022680: 756d 2076 616c 7565 7320 6f66 2074 6865  um values of the
-00022690: 2061 7272 6179 7320 6172 6520 7573 6564   arrays are used
-000226a0: 2074 6f20 7363 616c 650d 0a20 2020 2020   to scale..     
-000226b0: 2020 2020 2020 2061 6e64 2074 7261 6e73         and trans
-000226c0: 6c61 7465 2074 6865 2073 7572 6661 6365  late the surface
-000226d0: 2066 726f 6d20 616e 2069 6e74 6961 6c20   from an intial 
-000226e0: 646f 6d61 696e 206f 660d 0a20 2020 2020  domain of..     
-000226f0: 2020 2020 2020 205b 2028 2d31 2c31 292c         [ (-1,1),
-00022700: 2028 2d31 2c31 292c 2028 302c 3129 205d   (-1,1), (0,1) ]
-00022710: 0d0a 0d0a 2020 2020 2020 2020 5265 7475  ....        Retu
-00022720: 726e 730d 0a20 2020 2020 2020 202d 2d2d  rns..        ---
-00022730: 2d2d 2d2d 0d0a 2020 2020 2020 2020 7365  ----..        se
-00022740: 6c66 203a 2050 6c61 6e61 7253 7572 6661  lf : PlanarSurfa
-00022750: 6365 206f 626a 6563 740d 0a0d 0a20 2020  ce object....   
-00022760: 2020 2020 2022 2222 0d0a 0d0a 2020 2020       """....    
-00022770: 2020 2020 7265 7475 726e 205f 7363 616c      return _scal
-00022780: 655f 6461 7461 6672 616d 6528 7365 6c66  e_dataframe(self
-00022790: 2c58 2c59 2c5a 290d 0a0d 0a20 2020 2064  ,X,Y,Z)....    d
-000227a0: 6566 2064 6f6d 6169 6e28 7365 6c66 2c20  ef domain(self, 
-000227b0: 786c 696d 3d4e 6f6e 652c 2079 6c69 6d3d  xlim=None, ylim=
-000227c0: 4e6f 6e65 2c20 7a63 6f6f 723d 4e6f 6e65  None, zcoor=None
-000227d0: 2920 3a0d 0a20 2020 2020 2020 2022 2222  ) :..        """
-000227e0: 0d0a 2020 2020 2020 2020 5365 7420 7468  ..        Set th
-000227f0: 6520 646f 6d61 696e 206f 6620 7468 6520  e domain of the 
-00022800: 706c 616e 6172 2073 7572 6661 6365 2e0d  planar surface..
-00022810: 0a0d 0a20 2020 2020 2020 2055 7365 6420  ...        Used 
-00022820: 666f 7220 7365 7474 696e 6720 7468 6520  for setting the 
-00022830: 6c69 6d69 7473 206f 6620 7468 6520 6261  limits of the ba
-00022840: 7365 2070 6c61 6e65 2e0d 0a0d 0a20 2020  se plane.....   
-00022850: 2020 2020 2050 6172 616d 6574 6572 730d       Parameters.
-00022860: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00022870: 2d2d 2d0d 0a20 2020 2020 2020 2078 6c69  ---..        xli
-00022880: 6d2c 2079 6c69 6d20 3a20 3264 2061 7272  m, ylim : 2d arr
-00022890: 6179 730d 0a20 2020 2020 2020 2020 2020  ays..           
-000228a0: 204d 696e 696d 756d 2061 6e64 206d 6178   Minimum and max
-000228b0: 696d 756d 2076 616c 7565 7320 6f66 2074  imum values of t
-000228c0: 6865 2061 7272 6179 7320 6172 6520 7573  he arrays are us
-000228d0: 6564 2074 6f20 7363 616c 650d 0a20 2020  ed to scale..   
-000228e0: 2020 2020 2020 2020 2061 6e64 2074 7261           and tra
-000228f0: 6e73 6c61 7465 2074 6865 2073 7572 6661  nslate the surfa
-00022900: 6365 2066 726f 6d20 616e 2069 6e74 6961  ce from an intia
-00022910: 6c20 646f 6d61 696e 7320 6f66 0d0a 2020  l domains of..  
-00022920: 2020 2020 2020 2020 2020 5b20 2d31 2c20            [ -1, 
-00022930: 3120 5d0d 0a20 2020 2020 2020 2020 2020  1 ]..           
-00022940: 2049 6620 7365 7420 746f 204e 6f6e 652c   If set to None,
-00022950: 2074 6865 2064 6f6d 6169 6e73 2061 7265   the domains are
-00022960: 2075 6e63 6861 6e67 6564 2e0d 0a0d 0a20   unchanged..... 
-00022970: 2020 2020 2020 207a 636f 6f72 3a20 6e75         zcoor: nu
-00022980: 6d62 6572 2c20 6465 6661 756c 7420 3a20  mber, default : 
-00022990: 300d 0a20 2020 2020 2020 2020 2020 205a  0..            Z
-000229a0: 206f 6666 7365 7420 6f66 2074 6865 2070   offset of the p
-000229b0: 6c61 6e65 2e0d 0a20 2020 2020 2020 2020  lane...         
-000229c0: 2020 2049 6620 7365 7420 746f 204e 6f6e     If set to Non
-000229d0: 652c 2074 6865 205a 206f 6666 7365 7420  e, the Z offset 
-000229e0: 6973 2075 6e63 6861 6e67 6564 2e0d 0a0d  is unchanged....
-000229f0: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-00022a00: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-00022a10: 2d0d 0a20 2020 2020 2020 2073 656c 6620  -..        self 
-00022a20: 3a20 506c 616e 6172 5375 7266 6163 6520  : PlanarSurface 
-00022a30: 6f62 6a65 6374 0d0a 0d0a 0d0a 2020 2020  object......    
-00022a40: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
-00022a50: 2064 6566 2073 6574 446f 6d61 696e 2878   def setDomain(x
-00022a60: 797a 2c20 6d78 2c62 782c 6d79 2c62 792c  yz, mx,bx,my,by,
-00022a70: 6d7a 2920 3a0d 0a20 2020 2020 2020 2020  mz) :..         
-00022a80: 2020 2078 2c79 2c7a 203d 2078 797a 0d0a     x,y,z = xyz..
-00022a90: 2020 2020 2020 2020 2020 2020 5820 3d20              X = 
-00022aa0: 6d78 2a78 202b 2062 780d 0a20 2020 2020  mx*x + bx..     
-00022ab0: 2020 2020 2020 2059 203d 206d 792a 7920         Y = my*y 
-00022ac0: 2b20 6279 0d0a 2020 2020 2020 2020 2020  + by..          
-00022ad0: 2020 5a20 3d20 7a20 6966 206d 7a20 6973    Z = z if mz is
-00022ae0: 204e 6f6e 6520 656c 7365 206e 702e 6675   None else np.fu
-00022af0: 6c6c 286c 656e 287a 292c 6d7a 290d 0a20  ll(len(z),mz).. 
-00022b00: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00022b10: 6e20 582c 592c 5a20 2020 2020 2020 0d0a  n X,Y,Z       ..
-00022b20: 2020 2020 2020 2020 6465 6620 6765 7443          def getC
-00022b30: 6f6e 7428 206c 696d 7320 2920 3a0d 0a20  ont( lims ) :.. 
-00022b40: 2020 2020 2020 2020 2020 206d 2c20 6220             m, b 
-00022b50: 3d20 312e 302c 2030 2e30 0d0a 2020 2020  = 1.0, 0.0..    
-00022b60: 2020 2020 2020 2020 6966 206c 696d 7320          if lims 
-00022b70: 6973 206e 6f74 204e 6f6e 6520 3a0d 0a20  is not None :.. 
-00022b80: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00022b90: 2061 6c6c 6f77 2073 696e 676c 6520 626e   allow single bn
-00022ba0: 6472 7920 746f 2062 6520 696e 7075 7420  dry to be input 
-00022bb0: 6173 2061 2066 6c6f 6174 0d0a 2020 2020  as a float..    
-00022bc0: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-00022bd0: 7369 6e73 7461 6e63 6528 6c69 6d73 2c20  sinstance(lims, 
-00022be0: 2869 6e74 2c66 6c6f 6174 2929 203a 206c  (int,float)) : l
-00022bf0: 696d 7320 3d20 5b2d 6c69 6d73 2c6c 696d  ims = [-lims,lim
-00022c00: 735d 0d0a 2020 2020 2020 2020 2020 2020  s]..            
-00022c10: 2020 2020 6d2c 2062 203d 2030 2e35 2a28      m, b = 0.5*(
-00022c20: 6c69 6d73 5b31 5d2d 6c69 6d73 5b30 5d29  lims[1]-lims[0])
-00022c30: 202c 2030 2e35 2a28 6c69 6d73 5b31 5d2b   , 0.5*(lims[1]+
-00022c40: 6c69 6d73 5b30 5d29 0d0a 2020 2020 2020  lims[0])..      
-00022c50: 2020 2020 2020 7265 7475 726e 206d 2c20        return m, 
-00022c60: 620d 0a20 2020 2020 2020 206d 782c 2062  b..        mx, b
-00022c70: 7820 3d20 6765 7443 6f6e 7428 786c 696d  x = getCont(xlim
-00022c80: 290d 0a20 2020 2020 2020 206d 792c 2062  )..        my, b
-00022c90: 7920 3d20 6765 7443 6f6e 7428 796c 696d  y = getCont(ylim
-00022ca0: 290d 0a20 2020 2020 2020 2073 656c 662e  )..        self.
-00022cb0: 6d61 705f 6765 6f6d 5f66 726f 6d5f 6f70  map_geom_from_op
-00022cc0: 286c 616d 6264 6120 4120 3a20 7365 7444  (lambda A : setD
-00022cd0: 6f6d 6169 6e28 412c 206d 782c 6278 2c6d  omain(A, mx,bx,m
-00022ce0: 792c 6279 2c7a 636f 6f72 2929 0d0a 2020  y,by,zcoor))..  
-00022cf0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00022d00: 660d 0a0d 0a63 6c61 7373 2050 6f6c 6172  f....class Polar
-00022d10: 5375 7266 6163 6528 5375 7266 6163 6533  Surface(Surface3
-00022d20: 4443 6f6c 6c65 6374 696f 6e29 203a 0d0a  DCollection) :..
-00022d30: 2020 2020 2222 220d 0a20 2020 2046 6c61      """..    Fla
-00022d40: 7420 6469 736b 2033 4420 7375 7266 6163  t disk 3D surfac
-00022d50: 6520 696e 2070 6f6c 6172 2063 6f6f 7264  e in polar coord
-00022d60: 696e 6174 6573 2e0d 0a0d 0a20 2020 204d  inates.....    M
-00022d70: 6574 686f 6473 2061 7265 2069 6e68 6572  ethods are inher
-00022d80: 6974 6564 2066 726f 6d20 7468 6520 5375  ited from the Su
-00022d90: 7266 6163 6533 4443 6f6c 6c65 6374 696f  rface3DCollectio
-00022da0: 6e2e 0d0a 2020 2020 506f 6c61 7220 7375  n...    Polar su
-00022db0: 7266 6163 6520 6765 6f6d 6574 7269 6573  rface geometries
-00022dc0: 2061 7265 2063 7265 6174 6564 2069 6e20   are created in 
-00022dd0: 7468 6973 2073 7562 636c 6173 732e 0d0a  this subclass...
-00022de0: 0d0a 2020 2020 2222 220d 0a0d 0a20 2020  ..    """....   
-00022df0: 2040 7374 6174 6963 6d65 7468 6f64 0d0a   @staticmethod..
-00022e00: 2020 2020 6465 6620 7261 6e64 2872 657a      def rand(rez
-00022e10: 3d30 2c73 6565 643d 4e6f 6e65 2c6e 616d  =0,seed=None,nam
-00022e20: 653d 4e6f 6e65 2c6b 696e 643d 4e6f 6e65  e=None,kind=None
-00022e30: 2c2a 2a6b 6172 6773 2920 3a0d 0a20 2020  ,**kargs) :..   
-00022e40: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
-00022e50: 2020 506f 6c61 7253 7572 6661 6365 2077    PolarSurface w
-00022e60: 6974 6820 7261 6e64 6f6d 2074 7269 616e  ith random trian
-00022e70: 6775 6c61 7220 6661 6365 732e 0d0a 0d0a  gular faces.....
-00022e80: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
-00022e90: 7273 0d0a 2020 2020 2020 2020 2d2d 2d2d  rs..        ----
-00022ea0: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
-00022eb0: 7265 7a20 3a20 6e75 6d62 6572 2c20 6f70  rez : number, op
-00022ec0: 7469 6f6e 616c 2c20 6465 6661 756c 743a  tional, default:
-00022ed0: 2030 0d0a 2020 2020 2020 2020 2020 2020   0..            
-00022ee0: 4e75 6d62 6572 206f 6620 2772 6563 7572  Number of 'recur
-00022ef0: 7369 7665 2720 7375 6264 6976 6973 696f  sive' subdivisio
-00022f00: 6e73 206f 6620 7468 6520 7472 6961 6e67  ns of the triang
-00022f10: 756c 6174 6564 2062 6173 6520 6661 6365  ulated base face
-00022f20: 732e 0d0a 2020 2020 2020 2020 2020 2020  s...            
-00022f30: 5265 7a20 7661 6c75 6573 2072 616e 6765  Rez values range
-00022f40: 2066 726f 6d20 3020 746f 2037 2e0d 0a0d   from 0 to 7....
-00022f50: 0a20 2020 2020 2020 2073 6565 6420 3a20  .        seed : 
-00022f60: 696e 7465 6765 722c 206f 7074 696f 6e61  integer, optiona
-00022f70: 6c2c 2064 6566 6175 6c74 3a20 4e6f 6e65  l, default: None
-00022f80: 0d0a 2020 2020 2020 2020 2020 2020 416e  ..            An
-00022f90: 2069 6e69 7469 616c 697a 6174 696f 6e20   initialization 
-00022fa0: 7365 6564 2066 6f72 2072 616e 646f 6d20  seed for random 
-00022fb0: 6765 6e65 7261 7469 6f6e 2e0d 0a0d 0a20  generation..... 
-00022fc0: 2020 2020 2020 206e 616d 6520 3a20 7374         name : st
-00022fd0: 7269 6e67 2c20 6f70 7469 6f6e 616c 2c20  ring, optional, 
-00022fe0: 6465 6661 756c 743a 204e 6f6e 652e 0d0a  default: None...
-00022ff0: 2020 2020 2020 2020 2020 2020 4465 7363              Desc
-00023000: 7269 7074 6976 6520 6964 656e 7469 6669  riptive identifi
-00023010: 6572 2066 6f72 2074 6865 2067 656f 6d65  er for the geome
-00023020: 7472 792e 0d0a 0d0a 2020 2020 2020 2020  try.....        
-00023030: 6b69 6e64 203a 2073 7472 696e 672c 206f  kind : string, o
-00023040: 7074 696f 6e61 6c2c 2064 6566 6175 6c74  ptional, default
-00023050: 3a20 4e6f 6e65 0d0a 2020 2020 2020 2020  : None..        
-00023060: 2020 2020 2872 6573 6572 7665 642c 206e      (reserved, n
-00023070: 6f74 2069 6d70 6c65 6d65 6e74 6564 2920  ot implemented) 
-00023080: 0d0a 0d0a 2020 2020 2020 2020 5261 6973  ....        Rais
-00023090: 6573 0d0a 2020 2020 2020 2020 2d2d 2d2d  es..        ----
-000230a0: 2d2d 0d0a 2020 2020 2020 2020 5661 6c75  --..        Valu
-000230b0: 6545 7272 6f72 0d0a 2020 2020 2020 2020  eError..        
-000230c0: 2020 2020 4966 2072 657a 2069 7320 6e6f      If rez is no
-000230d0: 7420 616e 2069 6e74 6567 6572 2069 6e20  t an integer in 
-000230e0: 7261 6e67 6520 3020 746f 2037 2e0d 0a20  range 0 to 7... 
-000230f0: 2020 2020 2020 2020 2020 2049 6620 6261             If ba
-00023100: 7365 7479 7065 2069 7320 6e6f 7420 7265  setype is not re
-00023110: 636f 676e 697a 6564 2066 6f72 2074 6869  cognized for thi
-00023120: 7320 7375 7266 6163 6520 636f 6e73 7472  s surface constr
-00023130: 7563 746f 722e 0d0a 0d0a 2020 2020 2020  uctor.....      
-00023140: 2020 4f74 6865 7220 5061 7261 6d65 7465    Other Paramete
-00023150: 7273 0d0a 2020 2020 2020 2020 2d2d 2d2d  rs..        ----
-00023160: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020  ------------..  
-00023170: 2020 2020 2020 2a2a 6b77 6172 6773 0d0a        **kwargs..
-00023180: 2020 2020 2020 2020 2020 2020 416c 6c20              All 
-00023190: 6f74 6865 7220 7061 7261 6d65 7465 7273  other parameters
-000231a0: 2061 7265 2070 6173 7365 6420 6f6e 2074   are passed on t
-000231b0: 6f20 2773 3364 6c69 622e 7375 7266 6163  o 's3dlib.surfac
-000231c0: 652e 5375 7266 6163 6533 4443 6f6c 6c65  e.Surface3DColle
-000231d0: 6374 696f 6e27 2e0d 0a20 2020 2020 2020  ction'...       
-000231e0: 200d 0a20 2020 2020 2020 2052 6574 7572   ..        Retur
-000231f0: 6e73 0d0a 2020 2020 2020 2020 2d2d 2d2d  ns..        ----
-00023200: 2d2d 2d0d 0a20 2020 2020 2020 2073 7572  ---..        sur
-00023210: 6661 6365 203a 2050 6f6c 6172 5375 7266  face : PolarSurf
-00023220: 6163 6520 6f62 6a65 6374 2e0d 0a0d 0a20  ace object..... 
-00023230: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
-00023240: 2020 2020 232e 2e2e 2e2e 2e2e 2e2e 2e2e      #...........
-00023250: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00023260: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00023270: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 0d0a  ................
-00023280: 2020 2020 2020 2020 6465 6620 7261 6e64          def rand
-00023290: 6f6d 5f6c 696e 4469 7374 2873 697a 6529  om_linDist(size)
-000232a0: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
-000232b0: 6e4c 6f6f 702c 6e43 6f6e 7472 6f6c 2c73  nLoop,nControl,s
-000232c0: 616d 706c 6573 203d 2030 2c20 3130 2a2a  amples = 0, 10**
-000232d0: 362c 205b 5d0d 0a20 2020 2020 2020 2020  6, []..         
-000232e0: 2020 2077 6869 6c65 206c 656e 2873 616d     while len(sam
-000232f0: 706c 6573 293c 7369 7a65 2061 6e64 206e  ples)<size and n
-00023300: 4c6f 6f70 3c6e 436f 6e74 726f 6c3a 0d0a  Loop<nControl:..
-00023310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023320: 783d 6e70 2e72 616e 646f 6d2e 7261 6e64  x=np.random.rand
-00023330: 6f6d 5f73 616d 706c 6528 290d 0a20 2020  om_sample()..   
-00023340: 2020 2020 2020 2020 2020 2020 2070 726f               pro
-00023350: 623d 782f 320d 0a20 2020 2020 2020 2020  b=x/2..         
-00023360: 2020 2020 2020 2061 7373 6572 7420 7072         assert pr
-00023370: 6f62 3e3d 3020 616e 6420 7072 6f62 3c3d  ob>=0 and prob<=
-00023380: 310d 0a20 2020 2020 2020 2020 2020 2020  1..             
-00023390: 2020 2069 6620 6e70 2e72 616e 646f 6d2e     if np.random.
-000233a0: 7261 6e64 6f6d 5f73 616d 706c 6528 2920  random_sample() 
-000233b0: 3c3d 7072 6f62 3a20 7361 6d70 6c65 7320  <=prob: samples 
-000233c0: 2b3d 205b 785d 0d0a 2020 2020 2020 2020  += [x]..        
-000233d0: 2020 2020 2020 2020 6e4c 6f6f 702b 3d31          nLoop+=1
-000233e0: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
-000233f0: 7475 726e 206e 702e 6172 7261 7928 7361  turn np.array(sa
-00023400: 6d70 6c65 7329 0d0a 2020 2020 2020 2020  mples)..        
-00023410: 232e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  #...............
-00023420: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00023430: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00023440: 2e2e 2e2e 2e2e 2e2e 2e2e 0d0a 0d0a 2020  ..............  
-00023450: 2020 2020 2020 6966 206e 6f74 2069 7369        if not isi
-00023460: 6e73 7461 6e63 6528 7265 7a2c 2028 696e  nstance(rez, (in
-00023470: 742c 666c 6f61 7429 2920 3a0d 0a20 2020  t,float)) :..   
-00023480: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-00023490: 616c 7565 4572 726f 7228 2749 6e63 6f72  alueError('Incor
-000234a0: 7265 6374 2072 657a 2074 7970 652c 206d  rect rez type, m
-000234b0: 7573 7420 6265 2061 206e 756d 6265 722e  ust be a number.
-000234c0: 2729 0d0a 2020 2020 2020 2020 6966 2028  ')..        if (
-000234d0: 7265 7a3c 3029 206f 7220 2872 657a 3e5f  rez<0) or (rez>_
-000234e0: 4d41 5852 455a 2920 3a0d 0a20 2020 2020  MAXREZ) :..     
-000234f0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-00023500: 7565 4572 726f 7228 2749 6e63 6f72 7265  ueError('Incorre
-00023510: 7374 2072 657a 206f 6620 7b7d 2c20 6d75  st rez of {}, mu
-00023520: 7374 2062 6520 6120 6e75 6d62 6572 2c20  st be a number, 
-00023530: 3020 3c3d 2072 657a 203c 3d20 7b7d 272e  0 <= rez <= {}'.
-00023540: 666f 726d 6174 2872 657a 2c5f 4d41 5852  format(rez,_MAXR
-00023550: 455a 2929 0d0a 0d0a 2020 2020 2020 2020  EZ))....        
-00023560: 6966 2073 6565 6420 6973 206e 6f74 204e  if seed is not N
-00023570: 6f6e 6520 3a0d 0a20 2020 2020 2020 2020  one :..         
-00023580: 2020 2069 6620 6e6f 7420 6973 696e 7374     if not isinst
-00023590: 616e 6365 2873 6565 642c 2069 6e74 2920  ance(seed, int) 
-000235a0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-000235b0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-000235c0: 726f 7228 2749 6e63 6f72 7265 6374 2073  ror('Incorrect s
-000235d0: 6565 6420 7479 7065 2c20 6d75 7374 2062  eed type, must b
-000235e0: 6120 6f66 2074 7970 6520 696e 7427 2920  a of type int') 
-000235f0: 0d0a 2020 2020 2020 2020 2020 2020 6e70  ..            np
-00023600: 2e72 616e 646f 6d2e 7365 6564 2873 6565  .random.seed(see
-00023610: 6429 0d0a 0d0a 2020 2020 2020 2020 4e20  d)....        N 
-00023620: 3d20 696e 7428 2036 2a28 342a 2a72 657a  = int( 6*(4**rez
-00023630: 292f 3220 2b20 332a 2832 2a2a 7265 7a29  )/2 + 3*(2**rez)
-00023640: 202b 2031 2029 0d0a 2020 2020 2020 2020   + 1 )..        
-00023650: 7220 3d20 7261 6e64 6f6d 5f6c 696e 4469  r = random_linDi
-00023660: 7374 2820 4e20 290d 0a20 2020 2020 2020  st( N )..       
-00023670: 2074 203d 2032 2a6e 702e 7069 2a6e 702e   t = 2*np.pi*np.
-00023680: 7261 6e64 6f6d 2e72 616e 6428 204e 2029  random.rand( N )
-00023690: 0d0a 2020 2020 2020 2020 7a20 3d20 6e70  ..        z = np
-000236a0: 2e7a 6572 6f73 2820 4e20 290d 0a20 2020  .zeros( N )..   
-000236b0: 2020 2020 2064 6174 6120 3d20 506f 6c61       data = Pola
-000236c0: 7253 7572 6661 6365 2e63 6f6f 725f 636f  rSurface.coor_co
-000236d0: 6e76 6572 7428 5b72 2c74 2c7a 5d2c 5472  nvert([r,t,z],Tr
-000236e0: 7565 292e 540d 0a20 2020 2020 2020 2072  ue).T..        r
-000236f0: 7464 6174 6120 3d20 6461 7461 5b3a 2c3a  tdata = data[:,:
-00023700: 325d 0d0a 2020 2020 2020 2020 7465 7373  2]..        tess
-00023710: 203d 2073 7061 7469 616c 2e44 656c 6175   = spatial.Delau
-00023720: 6e61 7928 7274 6461 7461 290d 0a0d 0a20  nay(rtdata).... 
-00023730: 2020 2020 2020 2073 7572 6661 6365 203d         surface =
-00023740: 2050 6f6c 6172 5375 7266 6163 6528 6e61   PolarSurface(na
-00023750: 6d65 3d6e 616d 652c 2a2a 6b61 7267 7329  me=name,**kargs)
-00023760: 2020 2320 7365 7420 746f 2074 6865 2063    # set to the c
-00023770: 6c61 7373 2064 6566 6175 6c74 206f 626a  lass default obj
-00023780: 6563 740d 0a20 2020 2020 2020 2023 2072  ect..        # r
-00023790: 6573 6574 2076 6572 7473 2c20 6661 6365  eset verts, face
-000237a0: 496e 6469 6365 7320 616e 6420 6564 6765  Indices and edge
-000237b0: 7320 2872 6574 6169 6e20 636c 6173 7320  s (retain class 
-000237c0: 636f 6f72 6469 6e61 7465 2073 7973 7465  coordinate syste
-000237d0: 6d29 2e0d 0a20 2020 2020 2020 2076 6572  m)...        ver
-000237e0: 7473 203d 206e 702e 7a65 726f 7328 2028  ts = np.zeros( (
-000237f0: 4e2c 3329 290d 0a20 2020 2020 2020 2076  N,3))..        v
-00023800: 6572 7473 5b3a 2c3a 325d 203d 2074 6573  erts[:,:2] = tes
-00023810: 732e 706f 696e 7473 0d0a 2020 2020 2020  s.points..      
-00023820: 2020 6661 6365 496e 6469 6365 7320 3d20    faceIndices = 
-00023830: 7465 7373 2e73 696d 706c 6963 6573 0d0a  tess.simplices..
-00023840: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00023850: 2020 7375 7266 6163 652e 7665 7274 6578    surface.vertex
-00023860: 436f 6f72 203d 2076 6572 7473 0d0a 2020  Coor = verts..  
-00023870: 2020 2020 2020 7375 7266 6163 652e 6676        surface.fv
-00023880: 496e 6469 6365 7320 3d20 6661 6365 496e  Indices = faceIn
-00023890: 6469 6365 730d 0a20 2020 2020 2020 2073  dices..        s
-000238a0: 7572 6661 6365 2e65 7649 6e64 6963 6573  urface.evIndices
-000238b0: 203d 2073 7572 6661 6365 2e5f 6765 745f   = surface._get_
-000238c0: 6564 6765 735f 6672 6f6d 5f66 6163 6573  edges_from_faces
-000238d0: 2866 6163 6549 6e64 6963 6573 290d 0a20  (faceIndices).. 
-000238e0: 2020 2020 2020 2073 7572 6661 6365 2e76         surface.v
-000238f0: 6649 6e64 6963 6573 4c69 7374 203d 2073  fIndicesList = s
-00023900: 7572 6661 6365 2e5f 7665 7274 6578 436f  urface._vertexCo
-00023910: 6d6d 6f6e 4661 6365 496e 6469 6365 7328  mmonFaceIndices(
-00023920: 290d 0a20 2020 2020 2020 2073 7572 6661  )..        surfa
-00023930: 6365 2e65 6649 6e64 6963 6573 4c69 7374  ce.efIndicesList
-00023940: 203d 2073 7572 6661 6365 2e5f 6564 6765   = surface._edge
-00023950: 436f 6d6d 6f6e 4661 6365 496e 6469 6365  CommonFaceIndice
-00023960: 7328 290d 0a20 2020 2020 2020 2073 7572  s()..        sur
-00023970: 6661 6365 2e73 6574 5f76 6572 7473 2820  face.set_verts( 
-00023980: 7665 7274 735b 6661 6365 496e 6469 6365  verts[faceIndice
-00023990: 735d 2029 0d0a 2020 2020 2020 2020 7375  s] )..        su
-000239a0: 7266 6163 652e 5f73 6574 5f67 656f 6d65  rface._set_geome
-000239b0: 7472 6963 5f62 6f75 6e64 7328 290d 0a20  tric_bounds().. 
-000239c0: 2020 2020 2020 2073 7572 6661 6365 2e5f         surface._
-000239d0: 7265 7a20 3d20 7374 7228 7265 7a29 2069  rez = str(rez) i
-000239e0: 6620 6973 696e 7374 616e 6365 2872 657a  f isinstance(rez
-000239f0: 2c69 6e74 2920 656c 7365 2027 7b3a 2e31  ,int) else '{:.1
-00023a00: 667d 272e 666f 726d 6174 2872 657a 290d  f}'.format(rez).
-00023a10: 0a20 2020 2020 2020 2073 7572 6661 6365  .        surface
-00023a20: 2e5f 6261 7365 7479 7065 203d 2027 7261  ._basetype = 'ra
-00023a30: 6e64 5f27 2b73 7472 2873 6565 6429 0d0a  nd_'+str(seed)..
-00023a40: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00023a50: 7572 6661 6365 0d0a 0d0a 2020 2020 4073  urface....    @s
-00023a60: 7461 7469 636d 6574 686f 640d 0a20 2020  taticmethod..   
-00023a70: 2064 6566 205f 6765 745f 706f 6c61 725f   def _get_polar_
-00023a80: 7375 7266 6163 6573 5f64 6963 7469 6f6e  surfaces_diction
-00023a90: 6172 7928 2920 3a0d 0a20 2020 2020 2020  ary() :..       
-00023aa0: 2022 2222 436f 6e73 7472 7563 7473 2074   """Constructs t
-00023ab0: 6865 2064 6963 7469 6f6e 6172 7920 6f66  he dictionary of
-00023ac0: 2062 6173 6520 706f 6c61 7220 7375 7266   base polar surf
-00023ad0: 6163 6520 6765 6f6d 6574 7269 6573 2e22  ace geometries."
-00023ae0: 2222 0d0a 0d0a 2020 2020 2020 2020 7375  ""....        su
-00023af0: 7266 6163 6573 4469 6374 696f 6e61 7279  rfacesDictionary
-00023b00: 203d 207b 7d0d 0a20 2020 2020 2020 2073   = {}..        s
-00023b10: 6f66 6620 3d20 302e 3030 3031 0d0a 2020  off = 0.0001..  
-00023b20: 2020 2020 2020 7830 203d 2030 2e35 0d0a        x0 = 0.5..
-00023b30: 2020 2020 2020 2020 7930 203d 206e 702e          y0 = np.
-00023b40: 7371 7274 2833 292f 320d 0a20 2020 200d  sqrt(3)/2..    .
-00023b50: 0a20 2020 2020 2020 2062 6173 6556 6572  .        baseVer
-00023b60: 7420 3d20 5b20 5b30 2c30 2c30 5d2c 0d0a  t = [ [0,0,0],..
-00023b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023b80: 2020 2020 205b 312c 302c 305d 2c20 205b       [1,0,0],  [
-00023b90: 7830 2c79 302c 305d 2c20 2020 5b2d 7830  x0,y0,0],   [-x0
-00023ba0: 2c79 302c 305d 2c0d 0a20 2020 2020 2020  ,y0,0],..       
-00023bb0: 2020 2020 2020 2020 2020 2020 2020 5b2d                [-
-00023bc0: 312c 302c 305d 2c20 5b2d 7830 2c2d 7930  1,0,0], [-x0,-y0
-00023bd0: 2c30 5d2c 205b 7830 2c2d 7930 2c30 5d20  ,0], [x0,-y0,0] 
-00023be0: 5d0d 0a0d 0a20 2020 2020 2020 2071 5665  ]....        qVe
-00023bf0: 7274 203d 205b 205b 302c 302c 305d 2c0d  rt = [ [0,0,0],.
-00023c00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00023c10: 2020 205b 312c 302c 305d 2c20 5b30 2c31     [1,0,0], [0,1
-00023c20: 2c30 5d2c 205b 2d31 2c30 2c30 5d2c 205b  ,0], [-1,0,0], [
-00023c30: 302c 2d31 2c30 5d20 5d0d 0a0d 0a20 2020  0,-1,0] ]....   
-00023c40: 2020 2020 2078 3053 2c20 7930 5320 3d20       x0S, y0S = 
-00023c50: 736f 6666 2a79 302c 2073 6f66 662a 7830  soff*y0, soff*x0
-00023c60: 0d0a 0d0a 2020 2020 2020 2020 6261 7365  ....        base
-00023c70: 5665 7274 5320 3d20 5b20 5b31 2c2d 7930  VertS = [ [1,-y0
-00023c80: 532c 305d 2c20 5b31 2c20 7930 532c 305d  S,0], [1, y0S,0]
-00023c90: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00023ca0: 2020 2020 2020 2020 205b 7830 2c79 302c           [x0,y0,
-00023cb0: 305d 2c20 5b2d 7830 2c79 302c 305d 2c20  0], [-x0,y0,0], 
-00023cc0: 5b2d 312c 302c 305d 2c20 0d0a 2020 2020  [-1,0,0], ..    
-00023cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023ce0: 2020 5b2d 7830 2c2d 7930 2c30 5d2c 205b    [-x0,-y0,0], [
-00023cf0: 7830 2c2d 7930 2c30 5d2c 205b 2078 3053  x0,-y0,0], [ x0S
-00023d00: 2c20 2079 3053 2c30 5d2c 0d0a 2020 2020  ,  y0S,0],..    
-00023d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023d20: 2020 5b20 2020 302c 2073 6f66 662c 305d    [   0, soff,0]
-00023d30: 2c20 5b2d 7830 532c 2020 7930 532c 305d  , [-x0S,  y0S,0]
-00023d40: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00023d50: 2020 2020 2020 2020 205b 2d78 3053 2c20           [-x0S, 
-00023d60: 2d79 3053 2c30 5d2c 205b 2020 2030 2c2d  -y0S,0], [   0,-
-00023d70: 736f 6666 2c30 5d2c 205b 2078 3053 2c20  soff,0], [ x0S, 
-00023d80: 2d79 3053 2c30 5d20 5d0d 0a0d 0a20 2020  -y0S,0] ]....   
-00023d90: 2020 2020 2071 5665 7274 5320 3d20 5b20       qVertS = [ 
-00023da0: 5b31 2c2d 736f 6666 2c30 5d2c 0d0a 2020  [1,-soff,0],..  
-00023db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023dc0: 205b 312c 2073 6f66 662c 305d 2c20 5b30   [1, soff,0], [0
-00023dd0: 2c31 2c30 5d2c 205b 2d31 2c30 2c30 5d2c  ,1,0], [-1,0,0],
-00023de0: 205b 302c 2d31 2c30 5d2c 0d0a 2020 2020   [0,-1,0],..    
-00023df0: 2020 2020 2020 2020 2020 2020 2020 205b                 [
-00023e00: 2073 6f66 662c 2073 6f66 662c 305d 2c20   soff, soff,0], 
-00023e10: 5b2d 736f 6666 202c 736f 6666 2c30 5d2c  [-soff ,soff,0],
-00023e20: 205b 2d73 6f66 662c 2d73 6f66 662c 305d   [-soff,-soff,0]
-00023e30: 2c20 5b73 6f66 662c 2d73 6f66 662c 305d  , [soff,-soff,0]
-00023e40: 205d 0d0a 2020 2020 2020 2020 0d0a 2020   ]..        ..  
-00023e50: 2020 2020 2020 6261 7365 4661 6365 733d        baseFaces=
-00023e60: 285b 302c 312c 325d 2c5b 302c 322c 335d  ([0,1,2],[0,2,3]
-00023e70: 2c5b 302c 332c 345d 2c5b 302c 342c 355d  ,[0,3,4],[0,4,5]
-00023e80: 2c5b 302c 352c 365d 2c5b 302c 362c 315d  ,[0,5,6],[0,6,1]
-00023e90: 290d 0a20 2020 2020 2020 2071 7561 6446  )..        quadF
-00023ea0: 6163 6573 3d28 5b30 2c31 2c32 5d2c 5b30  aces=([0,1,2],[0
-00023eb0: 2c32 2c33 5d2c 5b30 2c33 2c34 5d2c 5b30  ,2,3],[0,3,4],[0
-00023ec0: 2c34 2c31 5d29 0d0a 0d0a 2020 2020 2020  ,4,1])....      
-00023ed0: 2020 6261 7365 4661 6365 7353 3d28 205b    baseFacesS=( [
-00023ee0: 372c 312c 325d 2c20 5b38 2c32 2c33 5d2c  7,1,2], [8,2,3],
-00023ef0: 205b 392c 332c 345d 2c20 205b 3130 2c34   [9,3,4],  [10,4
-00023f00: 2c35 5d2c 2020 5b31 312c 352c 365d 2c20  ,5],  [11,5,6], 
-00023f10: 5b31 322c 362c 305d 2c0d 0a20 2020 2020  [12,6,0],..     
-00023f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023f30: 5b32 2c38 2c37 5d2c 205b 332c 392c 385d  [2,8,7], [3,9,8]
-00023f40: 2c20 5b34 2c31 302c 395d 2c20 5b35 2c31  , [4,10,9], [5,1
-00023f50: 312c 3130 5d2c 205b 362c 3132 2c31 315d  1,10], [6,12,11]
-00023f60: 2029 0d0a 0d0a 2020 2020 2020 2020 7175   )....        qu
-00023f70: 6164 4661 6365 7353 3d28 205b 352c 312c  adFacesS=( [5,1,
-00023f80: 325d 2c5b 362c 322c 335d 2c5b 372c 332c  2],[6,2,3],[7,3,
-00023f90: 345d 2c5b 382c 342c 305d 2c0d 0a20 2020  4],[8,4,0],..   
-00023fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023fb0: 205b 322c 362c 355d 2c5b 332c 372c 365d   [2,6,5],[3,7,6]
-00023fc0: 2c5b 342c 382c 375d 2029 0d0a 0d0a 2020  ,[4,8,7] )....  
-00023fd0: 2020 2020 2020 4673 203d 206c 656e 2871        Fs = len(q
-00023fe0: 7561 6446 6163 6573 290d 0a20 2020 2020  uadFaces)..     
-00023ff0: 2020 2046 6820 3d20 6c65 6e28 6261 7365     Fh = len(base
-00024000: 4661 6365 7329 0d0a 2020 2020 2020 2020  Faces)..        
-00024010: 4673 5320 3d20 6c65 6e28 7175 6164 4661  FsS = len(quadFa
-00024020: 6365 7353 290d 0a20 2020 2020 2020 2046  cesS)..        F
-00024030: 6853 203d 206c 656e 2862 6173 6546 6163  hS = len(baseFac
-00024040: 6573 5329 0d0a 2020 2020 2020 2020 7371  esS)..        sq
-00024050: 7561 7265 203d 2020 7b20 2762 6173 6546  uare =  { 'baseF
-00024060: 6163 6549 6e64 6963 6573 2720 3a20 7175  aceIndices' : qu
-00024070: 6164 4661 6365 7320 2c20 2762 6173 6556  adFaces , 'baseV
-00024080: 6572 7469 6365 7343 6f6f 7227 203a 2071  erticesCoor' : q
-00024090: 5665 7274 2c20 2766 6576 5061 7261 6d27  Vert, 'fevParam'
-000240a0: 203a 205b 4673 2c32 2c31 5d20 7d0d 0a20   : [Fs,2,1] }.. 
-000240b0: 2020 2020 2020 2068 6578 6167 203d 2020         hexag =  
-000240c0: 7b20 2762 6173 6546 6163 6549 6e64 6963  { 'baseFaceIndic
-000240d0: 6573 2720 3a20 6261 7365 4661 6365 7320  es' : baseFaces 
-000240e0: 2c20 2762 6173 6556 6572 7469 6365 7343  , 'baseVerticesC
-000240f0: 6f6f 7227 203a 2062 6173 6556 6572 742c  oor' : baseVert,
-00024100: 2027 6665 7650 6172 616d 2720 3a20 5b46   'fevParam' : [F
-00024110: 682c 332c 315d 207d 0d0a 2020 2020 2020  h,3,1] }..      
-00024120: 2020 7371 7561 7265 5320 3d20 207b 2027    squareS =  { '
-00024130: 6261 7365 4661 6365 496e 6469 6365 7327  baseFaceIndices'
-00024140: 203a 2071 7561 6446 6163 6573 5320 2c20   : quadFacesS , 
-00024150: 2762 6173 6556 6572 7469 6365 7343 6f6f  'baseVerticesCoo
-00024160: 7227 203a 2071 5665 7274 532c 2027 6665  r' : qVertS, 'fe
-00024170: 7650 6172 616d 2720 3a20 5b46 7353 2c34  vParam' : [FsS,4
-00024180: 2e35 2c31 5d20 7d0d 0a20 2020 2020 2020  .5,1] }..       
-00024190: 2068 6578 6167 5320 3d20 207b 2027 6261   hexagS =  { 'ba
-000241a0: 7365 4661 6365 496e 6469 6365 7327 203a  seFaceIndices' :
-000241b0: 2062 6173 6546 6163 6573 5320 2c20 2762   baseFacesS , 'b
-000241c0: 6173 6556 6572 7469 6365 7343 6f6f 7227  aseVerticesCoor'
-000241d0: 203a 2062 6173 6556 6572 7453 2c20 2766   : baseVertS, 'f
-000241e0: 6576 5061 7261 6d27 203a 205b 4668 532c  evParam' : [FhS,
-000241f0: 362e 352c 315d 207d 0d0a 2020 2020 200d  6.5,1] }..     .
-00024200: 0a20 2020 2020 2020 2073 7572 6661 6365  .        surface
-00024210: 7344 6963 7469 6f6e 6172 795b 2773 7175  sDictionary['squ
-00024220: 275d 203d 2073 7175 6172 650d 0a20 2020  '] = square..   
-00024230: 2020 2020 2073 7572 6661 6365 7344 6963       surfacesDic
-00024240: 7469 6f6e 6172 795b 2768 6578 275d 203d  tionary['hex'] =
-00024250: 2068 6578 6167 0d0a 2020 2020 2020 2020   hexag..        
-00024260: 7375 7266 6163 6573 4469 6374 696f 6e61  surfacesDictiona
-00024270: 7279 5b27 7371 755f 7327 5d20 3d20 7371  ry['squ_s'] = sq
-00024280: 7561 7265 530d 0a20 2020 2020 2020 2073  uareS..        s
-00024290: 7572 6661 6365 7344 6963 7469 6f6e 6172  urfacesDictionar
-000242a0: 795b 2768 6578 5f73 275d 203d 2068 6578  y['hex_s'] = hex
-000242b0: 6167 530d 0a20 2020 2020 2020 2023 202e  agS..        # .
-000242c0: 2e2e 2027 7370 6563 6961 6c20 6361 7365  .. 'special case
-000242d0: 2720 6f6e 6c79 2066 6f72 2066 6576 206d  ' only for fev m
-000242e0: 6574 686f 6420 666f 7220 706f 6c61 7220  ethod for polar 
-000242f0: 7375 7266 6163 6573 2e0d 0a20 2020 2020  surfaces...     
-00024300: 2020 2073 7572 6661 6365 7344 6963 7469     surfacesDicti
-00024310: 6f6e 6172 795b 2773 7175 5f63 275d 203d  onary['squ_c'] =
-00024320: 207b 2027 6665 7650 6172 616d 2720 3a20   { 'fevParam' : 
-00024330: 5b31 362c 352c 315d 207d 0d0a 2020 2020  [16,5,1] }..    
-00024340: 2020 2020 7375 7266 6163 6573 4469 6374      surfacesDict
-00024350: 696f 6e61 7279 5b27 6865 785f 6327 5d20  ionary['hex_c'] 
-00024360: 3d20 7b20 2766 6576 5061 7261 6d27 203a  = { 'fevParam' :
-00024370: 205b 3132 2c34 2c31 5d20 7d0d 0a0d 0a20   [12,4,1] }.... 
-00024380: 2020 2020 2020 2072 6574 7572 6e20 7375         return su
-00024390: 7266 6163 6573 4469 6374 696f 6e61 7279  rfacesDictionary
-000243a0: 0d0a 0d0a 2020 2020 4073 7461 7469 636d  ....    @staticm
-000243b0: 6574 686f 640d 0a20 2020 2064 6566 205f  ethod..    def _
-000243c0: 6d69 6456 6563 746f 7246 756e 2876 6563  midVectorFun(vec
-000243d0: 7441 2c20 7665 6374 4229 203a 0d0a 2020  tA, vectB) :..  
-000243e0: 2020 2020 2020 2222 224d 6964 2d70 6f69        """Mid-poi
-000243f0: 6e74 2061 7420 7468 6520 6d69 6420 7261  nt at the mid ra
-00024400: 6469 616c 2070 6f73 6974 696f 6e20 6265  dial position be
-00024410: 7477 6565 6e20 7477 6f20 706f 696e 7473  tween two points
-00024420: 2069 6e20 6120 706c 616e 652e 2222 220d   in a plane.""".
-00024430: 0a20 2020 2020 2020 206d 6964 203d 206e  .        mid = n
-00024440: 702e 6164 6428 7665 6374 412c 7665 6374  p.add(vectA,vect
-00024450: 4229 0d0a 2020 2020 2020 2020 6d69 6420  B)..        mid 
-00024460: 3d20 6e70 2e6d 756c 7469 706c 7928 302e  = np.multiply(0.
-00024470: 352c 6d69 6429 0d0a 2020 2020 2020 2020  5,mid)..        
-00024480: 6120 3d20 286e 702e 6c69 6e61 6c67 2e6e  a = (np.linalg.n
-00024490: 6f72 6d28 7665 6374 4129 2b6e 702e 6c69  orm(vectA)+np.li
-000244a0: 6e61 6c67 2e6e 6f72 6d28 7665 6374 4229  nalg.norm(vectB)
-000244b0: 292f 320d 0a20 2020 2020 2020 2062 203d  )/2..        b =
-000244c0: 206e 702e 6c69 6e61 6c67 2e6e 6f72 6d28   np.linalg.norm(
-000244d0: 6d69 6429 0d0a 2020 2020 2020 2020 6d69  mid)..        mi
-000244e0: 6420 3d20 6e70 2e6d 756c 7469 706c 7928  d = np.multiply(
-000244f0: 6d69 642c 612f 6229 0d0a 2020 2020 2020  mid,a/b)..      
-00024500: 2020 7265 7475 726e 206d 6964 0d0a 0d0a    return mid....
-00024510: 2020 2020 4073 7461 7469 636d 6574 686f      @staticmetho
-00024520: 640d 0a20 2020 2064 6566 205f 6d61 7033  d..    def _map3
-00024530: 4474 6f32 4473 7175 6172 6528 7879 7a29  Dto2Dsquare(xyz)
-00024540: 203a 0d0a 2020 2020 2020 2020 2222 224f   :..        """O
-00024550: 7665 7272 6964 6520 6d61 7020 7375 7266  verride map surf
-00024560: 6163 6520 746f 2072 6563 7461 6775 6c61  ace to rectagula
-00024570: 7220 756e 6974 2063 6f6f 7264 696e 6174  r unit coordinat
-00024580: 6573 2028 302c 3129 2e22 2222 0d0a 2020  es (0,1)."""..  
-00024590: 2020 2020 2020 782c 792c 7a20 3d20 7879        x,y,z = xy
-000245a0: 7a0d 0a20 2020 2020 2020 2074 6865 7461  z..        theta
-000245b0: 203d 206e 702e 6172 6374 616e 3228 792c   = np.arctan2(y,
-000245c0: 7829 0d0a 2020 2020 2020 2020 7468 6574  x)..        thet
-000245d0: 6120 3d20 6e70 2e77 6865 7265 2820 7468  a = np.where( th
-000245e0: 6574 613c 302c 2032 2e30 2a6e 702e 7069  eta<0, 2.0*np.pi
-000245f0: 202b 2074 6865 7461 202c 7468 6574 6129   + theta ,theta)
-00024600: 0d0a 2020 2020 2020 2020 6120 3d20 7468  ..        a = th
-00024610: 6574 612f 2832 2a6e 702e 7069 290d 0a20  eta/(2*np.pi).. 
-00024620: 2020 2020 2020 2072 203d 206e 702e 7371         r = np.sq
-00024630: 7274 2878 2a78 2b79 2a79 290d 0a20 2020  rt(x*x+y*y)..   
-00024640: 2020 2020 2062 203d 2031 2d72 0d0a 2020       b = 1-r..  
-00024650: 2020 2020 2020 6120 3d20 6e70 2e63 6c69        a = np.cli
-00024660: 7028 612c 302e 302c 312e 3029 200d 0a20  p(a,0.0,1.0) .. 
-00024670: 2020 2020 2020 2062 203d 206e 702e 636c         b = np.cl
-00024680: 6970 2862 2c30 2e30 2c31 2e30 2920 0d0a  ip(b,0.0,1.0) ..
-00024690: 2020 2020 2020 2020 7265 7475 726e 205b          return [
-000246a0: 612c 625d 0d0a 0d0a 2020 2020 4073 7461  a,b]....    @sta
-000246b0: 7469 636d 6574 686f 640d 0a20 2020 2064  ticmethod..    d
-000246c0: 6566 2063 6f6f 725f 636f 6e76 6572 7428  ef coor_convert(
-000246d0: 7879 7a2c 2074 6f63 6172 743d 4661 6c73  xyz, tocart=Fals
-000246e0: 6529 203a 0d0a 2020 2020 2020 2020 2222  e) :..        ""
-000246f0: 220d 0a20 2020 2020 2020 204f 7665 7272  "..        Overr
-00024700: 6964 6520 636f 6f72 6469 6e61 7465 2074  ide coordinate t
-00024710: 7261 6e73 666f 726d 6174 696f 6e2e 0d0a  ransformation...
-00024720: 0d0a 2020 2020 2020 2020 5472 616e 666f  ..        Tranfo
-00024730: 726d 6174 696f 6e20 6265 7477 6565 6e20  rmation between 
-00024740: 706f 6c61 7220 616e 6420 4361 7274 6573  polar and Cartes
-00024750: 6961 6e20 636f 6f72 6469 6e61 7465 732e  ian coordinates.
-00024760: 0d0a 2020 2020 2020 2020 5468 6520 616e  ..        The an
-00024770: 6775 6c61 7220 636f 6f72 6469 6e61 7465  gular coordinate
-00024780: 2069 7320 696e 2072 6164 6961 6e73 2077   is in radians w
-00024790: 6974 6820 646f 6d61 696e 2030 2074 6f20  ith domain 0 to 
-000247a0: 3270 692e 0d0a 0d0a 2020 2020 2020 2020  2pi.....        
-000247b0: 5061 7261 6d65 7465 7273 0d0a 2020 2020  Parameters..    
-000247c0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a      ----------..
-000247d0: 2020 2020 2020 2020 7879 7a20 3a20 3378          xyz : 3x
-000247e0: 4e20 6172 7261 790d 0a20 2020 2020 2020  N array..       
-000247f0: 2020 2020 204e 206e 756d 6265 7220 6f66       N number of
-00024800: 2076 6563 746f 7273 2069 6e20 6569 7468   vectors in eith
-00024810: 6572 2070 6f6c 6172 206f 7220 6361 7274  er polar or cart
-00024820: 6573 6961 6e20 636f 6f72 6469 6e61 7465  esian coordinate
-00024830: 732c 0d0a 2020 2020 2020 2020 2020 2020  s,..            
-00024840: 696e 636c 7564 696e 6720 7468 6520 7a20  including the z 
-00024850: 636f 6f72 6469 6e61 7465 2820 7768 6963  coordinate( whic
-00024860: 6820 7265 6d61 696e 7320 756e 6368 616e  h remains unchan
-00024870: 6765 6429 2e0d 0a0d 0a20 2020 2020 2020  ged).....       
-00024880: 2074 6f63 6172 7420 3a20 7b20 5472 7565   tocart : { True
-00024890: 2c20 4661 6c73 6520 7d2c 2064 6566 6175  , False }, defau
-000248a0: 6c74 3a20 4661 6c73 650d 0a20 2020 2020  lt: False..     
-000248b0: 2020 2020 2020 2049 6620 5472 7565 2c20         If True, 
-000248c0: 696e 7075 7420 6973 2070 6f6c 6172 2061  input is polar a
-000248d0: 6e64 206f 7574 7075 7420 6973 2063 6172  nd output is car
-000248e0: 7465 7369 616e 2e0d 0a20 2020 2020 2020  tesian...       
-000248f0: 2020 2020 2049 6620 4661 6c73 652c 2069       If False, i
-00024900: 6e70 7574 2069 7320 6361 7274 6573 6961  nput is cartesia
-00024910: 6e20 616e 6420 6f75 7470 7574 2069 7320  n and output is 
-00024920: 706f 6c61 722e 0d0a 0d0a 2020 2020 2020  polar.....      
-00024930: 2020 5265 7475 726e 730d 0a20 2020 2020    Returns..     
-00024940: 2020 202d 2d2d 2d2d 2d2d 0d0a 2020 2020     -------..    
-00024950: 2020 2020 6c69 7374 3a20 3378 4e20 6172      list: 3xN ar
-00024960: 7261 790d 0a20 2020 2020 2020 2020 2020  ray..           
-00024970: 2054 7261 6e73 666f 726d 6564 2063 6f6f   Transformed coo
-00024980: 7264 696e 6174 6573 2e20 0d0a 0d0a 2020  rdinates. ....  
-00024990: 2020 2020 2020 2222 220d 0a0d 0a20 2020        """....   
-000249a0: 2020 2020 2069 6620 746f 6361 7274 203a       if tocart :
-000249b0: 0d0a 2020 2020 2020 2020 2020 2020 722c  ..            r,
-000249c0: 2074 6865 7461 2c20 7a20 3d20 7879 7a0d   theta, z = xyz.
-000249d0: 0a20 2020 2020 2020 2020 2020 2078 203d  .            x =
-000249e0: 2072 202a 206e 702e 636f 7328 7468 6574   r * np.cos(thet
-000249f0: 6129 0d0a 2020 2020 2020 2020 2020 2020  a)..            
-00024a00: 7920 3d20 7220 2a20 6e70 2e73 696e 2874  y = r * np.sin(t
-00024a10: 6865 7461 290d 0a20 2020 2020 2020 2020  heta)..         
-00024a20: 2020 2061 6263 203d 205b 782c 792c 7a5d     abc = [x,y,z]
-00024a30: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
-00024a40: 0a20 2020 2020 2020 2020 2020 2078 2c79  .            x,y
-00024a50: 2c7a 203d 2078 797a 0d0a 2020 2020 2020  ,z = xyz..      
-00024a60: 2020 2020 2020 5220 3d20 6e70 2e73 7172        R = np.sqr
-00024a70: 7428 2078 2a78 202b 2079 2a79 2029 0d0a  t( x*x + y*y )..
-00024a80: 2020 2020 2020 2020 2020 2020 7468 6574              thet
-00024a90: 6120 3d20 6e70 2e61 7263 7461 6e32 2879  a = np.arctan2(y
-00024aa0: 2c78 290d 0a20 2020 2020 2020 2020 2020  ,x)..           
-00024ab0: 2074 6865 7461 203d 206e 702e 7768 6572   theta = np.wher
-00024ac0: 6528 7468 6574 613c 302c 7468 6574 612b  e(theta<0,theta+
-00024ad0: 322a 6e70 2e70 692c 7468 6574 6129 0d0a  2*np.pi,theta)..
-00024ae0: 2020 2020 2020 2020 2020 2020 6162 6320              abc 
-00024af0: 3d20 5b52 2c74 6865 7461 2c7a 5d0d 0a20  = [R,theta,z].. 
-00024b00: 2020 2020 2020 2061 6263 203d 206e 702e         abc = np.
-00024b10: 6172 7261 7928 6162 6329 0d0a 2020 2020  array(abc)..    
-00024b20: 2020 2020 7265 7475 726e 2061 6263 0d0a      return abc..
-00024b30: 0d0a 2020 2020 5f62 6173 655f 7375 7266  ..    _base_surf
-00024b40: 6163 6573 203d 205f 6765 745f 706f 6c61  aces = _get_pola
-00024b50: 725f 7375 7266 6163 6573 5f64 6963 7469  r_surfaces_dicti
-00024b60: 6f6e 6172 792e 5f5f 6675 6e63 5f5f 2829  onary.__func__()
-00024b70: 0d0a 2020 2020 5f64 6566 6175 6c74 5f62  ..    _default_b
-00024b80: 6173 6520 3d20 2768 6578 2720 2023 2064  ase = 'hex'  # d
-00024b90: 6566 6175 6c74 2061 7373 6967 6e6d 656e  efault assignmen
-00024ba0: 7420 6973 2069 6e64 6963 6174 6564 2069  t is indicated i
-00024bb0: 6e20 5f5f 696e 6974 2044 6f63 7374 7269  n __init Docstri
-00024bc0: 6e67 2e0d 0a20 2020 205f 6765 6f6d 5479  ng...    _geomTy
-00024bd0: 7065 203d 205f 434f 4f52 5359 535b 2750  pe = _COORSYS['P
-00024be0: 4f4c 4152 275d 0d0a 0d0a 2020 2020 4063  OLAR']....    @c
-00024bf0: 6c61 7373 6d65 7468 6f64 0d0a 2020 2020  lassmethod..    
-00024c00: 6465 6620 5f75 7677 5f74 6f5f 7879 7a28  def _uvw_to_xyz(
-00024c10: 2063 6c73 2c75 7677 2c20 7274 7a29 203a   cls,uvw, rtz) :
-00024c20: 2020 0d0a 2020 2020 2020 2020 2222 224f    ..        """O
-00024c30: 7665 7272 6964 6520 726f 7461 7469 6f6e  verride rotation
-00024c40: 616c 2074 7261 6e73 666f 726d 6174 696f  al transformatio
-00024c50: 6e20 6174 2061 2070 6f6c 6172 2063 6f6f  n at a polar coo
-00024c60: 7264 696e 6174 652e 2222 220d 0a20 2020  rdinate."""..   
-00024c70: 2020 2020 2072 6574 7572 6e20 7375 7065       return supe
-00024c80: 7228 292e 5f64 6973 705f 746f 5f78 797a  r()._disp_to_xyz
-00024c90: 2820 7576 772c 2072 747a 5b31 5d20 290d  ( uvw, rtz[1] ).
-00024ca0: 0a0d 0a20 2020 2040 636c 6173 736d 6574  ...    @classmet
-00024cb0: 686f 640d 0a20 2020 2064 6566 2067 7269  hod..    def gri
-00024cc0: 6428 636c 732c 6e72 6164 2c20 6e61 6e67  d(cls,nrad, nang
-00024cd0: 2c20 6261 7365 7479 7065 3d27 6427 2c20  , basetype='d', 
-00024ce0: 6d69 6e72 6164 3d4e 6f6e 652c 206e 616d  minrad=None, nam
-00024cf0: 653d 4e6f 6e65 2c20 2a2a 6b77 6172 6773  e=None, **kwargs
-00024d00: 2920 3a0d 0a20 2020 2020 2020 2022 2222  ) :..        """
-00024d10: 0d0a 2020 2020 2020 2020 506f 6c61 7253  ..        PolarS
-00024d20: 7572 6661 6365 2077 6974 6820 6178 6961  urface with axia
-00024d30: 6c20 616e 6420 7261 6469 616c 2066 6163  l and radial fac
-00024d40: 6573 2e0d 0a0d 0a20 2020 2020 2020 2050  es.....        P
-00024d50: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
-00024d60: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
-00024d70: 2020 2020 2020 206e 7261 6420 3a20 696e         nrad : in
-00024d80: 7465 6765 722c 2072 6571 7569 7265 642e  teger, required.
-00024d90: 0d0a 2020 2020 2020 2020 2020 2020 4e75  ..            Nu
-00024da0: 6d62 6572 206f 6620 7261 6469 616c 2073  mber of radial s
-00024db0: 7562 6469 7669 7369 6f6e 732e 2020 4d69  ubdivisions.  Mi
-00024dc0: 6e69 6d75 6d20 7661 6c75 6520 6973 2031  nimum value is 1
-00024dd0: 0d0a 0d0a 2020 2020 2020 2020 6e61 6e67  ....        nang
-00024de0: 203a 2069 6e74 6567 6572 2c20 7265 7175   : integer, requ
-00024df0: 6972 6564 2e0d 0a20 2020 2020 2020 2020  ired...         
-00024e00: 2020 204e 756d 6265 7220 6f66 2061 6e67     Number of ang
-00024e10: 756c 6172 2073 7562 6469 7669 7369 6f6e  ular subdivision
-00024e20: 732e 204d 696e 696d 756d 2076 616c 7565  s. Minimum value
-00024e30: 2069 7320 332e 0d0a 0d0a 2020 2020 2020   is 3.....      
-00024e40: 2020 6261 7365 7479 7065 203a 207b 2764    basetype : {'d
-00024e50: 272c 2773 272c 2771 272c 2777 272c 2772  ','s','q','w','r
-00024e60: 272c 2778 277d 2c20 6f70 7469 6f6e 616c  ','x'}, optional
-00024e70: 2c20 6465 6661 756c 743a 2027 6427 0d0a  , default: 'd'..
-00024e80: 2020 2020 2020 2020 2020 2020 5374 6172              Star
-00024e90: 7469 6e67 2073 7572 6661 6365 2067 656f  ting surface geo
-00024ea0: 6d65 7472 6965 7320 6672 6f6d 2077 6869  metries from whi
-00024eb0: 6368 2074 6865 2073 7572 6661 6365 2069  ch the surface i
-00024ec0: 730d 0a20 2020 2020 2020 2020 2020 2063  s..            c
-00024ed0: 6f6e 7374 7275 6374 6564 2069 6e64 6963  onstructed indic
-00024ee0: 6174 696e 6720 6661 6365 2073 6861 7065  ating face shape
-00024ef0: 2061 6e64 2069 6620 7370 6c69 742e 0d0a   and if split...
-00024f00: 0d0a 2020 2020 2020 2020 6d69 6e72 6164  ..        minrad
-00024f10: 203a 2073 6361 6c61 722c 206f 7074 696f   : scalar, optio
-00024f20: 6e61 6c2c 2064 6566 6175 6c74 3a20 302e  nal, default: 0.
-00024f30: 3031 0d0a 2020 2020 2020 2020 2020 2020  01..            
-00024f40: 5468 6520 6d69 6e69 6d75 6d20 6469 7374  The minimum dist
-00024f50: 616e 6365 2066 726f 6d20 7468 6520 7a2d  ance from the z-
-00024f60: 6178 6973 206f 6620 616e 7920 7665 7274  axis of any vert
-00024f70: 6578 2063 6f6f 7264 696e 6174 652e 0d0a  ex coordinate...
-00024f80: 2020 2020 2020 2020 2020 2020 5573 6520              Use 
-00024f90: 6973 2064 6570 656e 6465 6e74 206f 6e20  is dependent on 
-00024fa0: 6261 7365 7479 7065 2e0d 0a0d 0a20 2020  basetype.....   
-00024fb0: 2020 2020 206e 616d 6520 3a20 7374 7269       name : stri
-00024fc0: 6e67 2c20 6f70 7469 6f6e 616c 2c20 6465  ng, optional, de
-00024fd0: 6661 756c 743a 204e 6f6e 652e 0d0a 2020  fault: None...  
-00024fe0: 2020 2020 2020 2020 2020 4465 7363 7269            Descri
-00024ff0: 7074 6976 6520 6964 656e 7469 6669 6572  ptive identifier
-00025000: 2e0d 0a0d 0a20 2020 2020 2020 2052 6169  .....        Rai
-00025010: 7365 730d 0a20 2020 2020 2020 202d 2d2d  ses..        ---
-00025020: 2d2d 2d0d 0a20 2020 2020 2020 2056 616c  ---..        Val
-00025030: 7565 4572 726f 720d 0a20 2020 2020 2020  ueError..       
-00025040: 2020 2020 2049 6620 6e72 6164 2069 7320       If nrad is 
-00025050: 6e6f 7420 616e 2069 6e74 6567 6572 2067  not an integer g
-00025060: 7265 6174 6572 206f 7220 6571 7561 6c20  reater or equal 
-00025070: 746f 2031 2e0d 0a20 2020 2020 2020 2020  to 1...         
-00025080: 2020 2049 6620 6e61 6e67 2069 7320 6e6f     If nang is no
-00025090: 7420 616e 2069 6e74 6567 6572 2067 7265  t an integer gre
-000250a0: 6174 6572 206f 7220 6571 7561 6c20 746f  ater or equal to
-000250b0: 2033 2e0d 0a0d 0a20 2020 2020 2020 204f   3.....        O
-000250c0: 7468 6572 2050 6172 616d 6574 6572 730d  ther Parameters.
-000250d0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-000250e0: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
-000250f0: 2020 202a 2a6b 7761 7267 730d 0a20 2020     **kwargs..   
-00025100: 2020 2020 2020 2020 2041 6c6c 206f 7468           All oth
-00025110: 6572 2070 6172 616d 6574 6572 7320 6172  er parameters ar
-00025120: 6520 7061 7373 6564 206f 6e20 746f 2027  e passed on to '
-00025130: 7333 646c 6962 2e73 7572 6661 6365 2e53  s3dlib.surface.S
-00025140: 7572 6661 6365 3344 436f 6c6c 6563 7469  urface3DCollecti
-00025150: 6f6e 272e 0d0a 2020 2020 2020 2020 0d0a  on'...        ..
-00025160: 2020 2020 2020 2020 5265 7475 726e 730d          Returns.
-00025170: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00025180: 0d0a 2020 2020 2020 2020 7375 7266 6163  ..        surfac
-00025190: 6520 3a20 506f 6c61 7253 7572 6661 6365  e : PolarSurface
-000251a0: 206f 626a 6563 742e 0d0a 0d0a 2020 2020   object.....    
-000251b0: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
-000251c0: 204e 6661 6365 7320 3d20 7b20 2764 273a   Nfaces = { 'd':
-000251d0: 2033 2c20 2773 273a 2033 2c20 2771 273a   3, 's': 3, 'q':
-000251e0: 362c 2027 7727 3a36 2c20 2772 273a 332c  6, 'w':6, 'r':3,
-000251f0: 2027 7827 3a33 2020 7d20 2023 2031 2c33   'x':3  }  # 1,3
-00025200: 0d0a 2020 2020 2020 2020 7370 6c69 7453  ..        splitS
-00025210: 697a 6520 3d20 4e6f 6e65 0d0a 2020 2020  ize = None..    
-00025220: 2020 2020 7375 7266 6163 6520 3d20 636c      surface = cl
-00025230: 732e 5f73 7175 6172 655f 6e65 7428 6e72  s._square_net(nr
-00025240: 6164 2c20 6e61 6e67 2c20 6261 7365 7479  ad, nang, basety
-00025250: 7065 2c6d 696e 7261 642c 2073 706c 6974  pe,minrad, split
-00025260: 5369 7a65 2c20 6e61 6d65 2c20 2a2a 6b77  Size, name, **kw
-00025270: 6172 6773 290d 0a20 2020 2020 2020 2073  args)..        s
-00025280: 7572 6661 6365 2e5f 706f 7374 5072 6f63  urface._postProc
-00025290: 5f73 7572 6661 6365 436f 6c6f 7273 2854  _surfaceColors(T
-000252a0: 7275 6529 0d0a 2020 2020 2020 2020 7375  rue)..        su
-000252b0: 7266 6163 652e 5f72 657a 203d 2073 7572  rface._rez = sur
-000252c0: 6661 6365 2e5f 6361 6c63 5f72 657a 2820  face._calc_rez( 
-000252d0: 3620 290d 0a20 2020 2020 2020 2072 6574  6 )..        ret
-000252e0: 7572 6e20 7375 7266 6163 650d 0a0d 0a20  urn surface.... 
-000252f0: 2020 2040 636c 6173 736d 6574 686f 640d     @classmethod.
-00025300: 0a20 2020 2064 6566 205f 5866 6576 2863  .    def _Xfev(c
-00025310: 6c73 2c72 657a 2c20 6261 7365 7479 7065  ls,rez, basetype
-00025320: 3d4e 6f6e 652c 206d 696e 7261 643d 4e6f  =None, minrad=No
-00025330: 6e65 2920 3a0d 0a20 2020 2020 2020 2022  ne) :..        "
-00025340: 2222 0d0a 2020 2020 2020 2020 4361 6c63  ""..        Calc
-00025350: 756c 6174 6573 206e 756d 6265 7220 6f66  ulates number of
-00025360: 2066 6163 6573 2c20 6564 6765 732c 2061   faces, edges, a
-00025370: 6e64 2076 6572 7469 6365 7320 6f66 2061  nd vertices of a
-00025380: 2050 6f6c 6172 5375 7266 6163 652e 0d0a   PolarSurface...
-00025390: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-000253a0: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
-000253b0: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
-000253c0: 2020 7265 7a20 3a20 696e 7465 6765 720d    rez : integer.
-000253d0: 0a20 2020 2020 2020 2020 2020 204e 756d  .            Num
-000253e0: 6265 7220 6f66 2072 6563 7572 7369 7665  ber of recursive
-000253f0: 2073 7562 6469 7669 7369 6f6e 7320 6f66   subdivisions of
-00025400: 2061 2074 7269 616e 6775 6c61 7465 6420   a triangulated 
-00025410: 6261 7365 2066 6163 6573 2e0d 0a20 2020  base faces...   
-00025420: 2020 2020 200d 0a20 2020 2020 2020 2062       ..        b
-00025430: 6173 6574 7970 6520 3a20 7374 7269 6e67  asetype : string
-00025440: 0d0a 2020 2020 2020 2020 2020 2020 5374  ..            St
-00025450: 6172 7469 6e67 2073 7572 6661 6365 2067  arting surface g
-00025460: 656f 6d65 7472 6965 7320 6672 6f6d 2077  eometries from w
-00025470: 6869 6368 2074 6865 2073 7572 6661 6365  hich the surface
-00025480: 2077 6f75 6c64 2062 650d 0a20 2020 2020   would be..     
-00025490: 2020 2020 2020 2063 6f6e 7374 7275 6374         construct
-000254a0: 6564 2075 7369 6e67 2072 6563 7572 7369  ed using recursi
-000254b0: 7665 2073 7562 6469 7669 7369 6f6e 7320  ve subdivisions 
-000254c0: 6f66 2074 6865 2074 7269 616e 6775 6c61  of the triangula
-000254d0: 7220 6661 6365 732e 0d0a 2020 2020 2020  r faces...      
-000254e0: 2020 0d0a 2020 2020 2020 2020 5265 7475    ..        Retu
-000254f0: 726e 730d 0a20 2020 2020 2020 202d 2d2d  rns..        ---
-00025500: 2d2d 2d2d 0d0a 2020 2020 2020 2020 6c69  ----..        li
-00025510: 7374 3a20 7468 6520 6e75 6d62 6572 206f  st: the number o
-00025520: 6620 6661 6365 732c 2065 6467 6573 2c20  f faces, edges, 
-00025530: 616e 6420 7665 7274 6963 6573 2e0d 0a20  and vertices... 
-00025540: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00025550: 2022 2222 0d0a 2020 2020 2020 2020 6966   """..        if
-00025560: 2069 7369 6e73 7461 6e63 6528 7265 7a2c   isinstance(rez,
-00025570: 286c 6973 742c 7475 706c 6529 2920 3a20  (list,tuple)) : 
-00025580: 2320 6368 6563 6b20 666f 7220 6469 736b  # check for disk
-00025590: 2e2e 2e0d 0a20 2020 2020 2020 2020 2020  .....           
-000255a0: 206e 7261 6420 3d20 7265 7a5b 305d 0d0a   nrad = rez[0]..
-000255b0: 2020 2020 2020 2020 2020 2020 6e61 6e67              nang
-000255c0: 203d 2072 657a 5b31 5d0d 0a20 2020 2020   = rez[1]..     
-000255d0: 2020 2020 2020 2023 206f 6e6c 7920 6368         # only ch
-000255e0: 6563 6b20 6973 2065 6e64 696e 6720 696e  eck is ending in
-000255f0: 2073 0d0a 2020 2020 2020 2020 2020 2020   s..            
-00025600: 6973 5370 6c69 7420 3d20 6261 7365 7479  isSplit = basety
-00025610: 7065 5b20 6c65 6e28 6261 7365 7479 7065  pe[ len(basetype
-00025620: 292d 315d 2069 7320 2773 270d 0a20 2020  )-1] is 's'..   
-00025630: 2020 2020 2020 2020 2069 6620 6d69 6e72           if minr
-00025640: 6164 2069 7320 4e6f 6e65 203a 0d0a 2020  ad is None :..  
-00025650: 2020 2020 2020 2020 2020 2020 2020 6620                f 
-00025660: 3d20 322a 6e72 6164 2a6e 616e 6720 2d20  = 2*nrad*nang - 
-00025670: 6e61 6e67 0d0a 2020 2020 2020 2020 2020  nang..          
-00025680: 2020 2020 2020 6520 3d20 332a 6e72 6164        e = 3*nrad
-00025690: 2a6e 616e 6720 2d20 6e61 6e67 0d0a 2020  *nang - nang..  
-000256a0: 2020 2020 2020 2020 2020 2020 2020 7620                v 
-000256b0: 3d20 6e72 6164 2a6e 616e 6720 2b20 310d  = nrad*nang + 1.
-000256c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000256d0: 2069 6620 6973 5370 6c69 7420 3a0d 0a20   if isSplit :.. 
-000256e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000256f0: 2020 2065 202b 3d20 6e72 6164 0d0a 2020     e += nrad..  
-00025700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025710: 2020 7620 2b3d 206e 7261 640d 0a20 2020    v += nrad..   
-00025720: 2020 2020 2020 2020 2065 6c73 6520 3a20           else : 
-00025730: 2023 2061 6e79 2076 616c 7565 2077 696c   # any value wil
-00025740: 6c20 7472 6967 6765 7220 7468 6973 2063  l trigger this c
-00025750: 6f6e 6469 7469 6f6e 2e0d 0a20 2020 2020  ondition...     
-00025760: 2020 2020 2020 2020 2020 2066 203d 2032             f = 2
-00025770: 2a6e 7261 642a 6e61 6e67 0d0a 2020 2020  *nrad*nang..    
-00025780: 2020 2020 2020 2020 2020 2020 6520 3d20              e = 
-00025790: 332a 6e72 6164 2a6e 616e 6720 2b20 6e61  3*nrad*nang + na
-000257a0: 6e67 0d0a 2020 2020 2020 2020 2020 2020  ng..            
-000257b0: 2020 2020 7620 3d20 286e 7261 642b 3129      v = (nrad+1)
-000257c0: 2a6e 616e 670d 0a20 2020 2020 2020 2020  *nang..         
-000257d0: 2020 2020 2020 2069 6620 6973 5370 6c69         if isSpli
-000257e0: 7420 3a0d 0a20 2020 2020 2020 2020 2020  t :..           
-000257f0: 2020 2020 2020 2020 2065 202b 3d20 6e72           e += nr
-00025800: 6164 2020 2020 0d0a 2020 2020 2020 2020  ad    ..        
-00025810: 2020 2020 2020 2020 2020 2020 7620 2b3d              v +=
-00025820: 206e 7261 6420 2b20 3120 2020 200d 0a20   nrad + 1    .. 
-00025830: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00025840: 6e20 5b66 2c65 2c76 5d0d 0a0d 0a20 2020  n [f,e,v]....   
-00025850: 2020 2020 2072 6574 7572 6e20 7375 7065       return supe
-00025860: 7228 292e 5f66 6576 2872 657a 2c62 6173  r()._fev(rez,bas
-00025870: 6574 7970 652c 636c 7329 0d0a 0d0a 2020  etype,cls)....  
-00025880: 2020 4073 7461 7469 636d 6574 686f 640d    @staticmethod.
-00025890: 0a20 2020 2064 6566 205f 666c 6174 5f73  .    def _flat_s
-000258a0: 706c 6974 5f63 7963 6c69 6e64 6572 2872  plit_cyclinder(r
-000258b0: 657a 2c62 6173 6574 7970 652c 6d69 6e72  ez,basetype,minr
-000258c0: 6164 2c20 2a2a 6b77 6172 6773 2920 3a0d  ad, **kwargs) :.
-000258d0: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
-000258e0: 2020 2020 2020 5472 616e 7366 6f72 6d20        Transform 
-000258f0: 6379 6c69 6e64 7269 6361 6c20 6261 7365  cylindrical base
-00025900: 2073 7572 6661 6365 2074 6f20 706f 6c61   surface to pola
-00025910: 7220 636f 6f72 6469 6e61 7465 732e 200d  r coordinates. .
-00025920: 0a0d 0a20 2020 2020 2020 206e 6f74 6520  ...        note 
-00025930: 3a20 2054 6869 7320 6d65 7468 6f64 2070  :  This method p
-00025940: 726f 7669 6465 7320 616e 2061 6c74 6572  rovides an alter
-00025950: 6e61 7469 7665 2074 6f20 7468 6520 0d0a  native to the ..
-00025960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025970: 706f 6c65 7220 6261 7365 7479 7065 7320  poler basetypes 
-00025980: 6f66 2027 6865 785f 7327 2061 6e64 2027  of 'hex_s' and '
-00025990: 7371 755f 7327 2e0d 0a20 2020 2020 2020  squ_s'...       
-000259a0: 2020 2020 2020 2020 2054 6865 2067 7269           The gri
-000259b0: 6473 2063 6f6e 7374 7275 6374 6564 2068  ds constructed h
-000259c0: 6572 6520 6d61 7920 7072 6f76 6964 6520  ere may provide 
-000259d0: 736d 6f6f 7468 6572 0d0a 2020 2020 2020  smoother..      
-000259e0: 2020 2020 2020 2020 2020 6765 6f6d 6574            geomet
-000259f0: 7269 6573 2064 6570 656e 6469 6e67 206f  ries depending o
-00025a00: 6e20 7468 6520 6d61 7070 696e 6720 6675  n the mapping fu
-00025a10: 6e63 7469 6f6e 732e 0d0a 2020 2020 2020  nctions...      
-00025a20: 2020 2222 220d 0a0d 0a20 2020 2020 2020    """....       
-00025a30: 2023 202e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e   # .............
-00025a40: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00025a50: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00025a60: 2e2e 2e2e 0d0a 2020 2020 2020 2020 6465  ......        de
-00025a70: 6620 6379 6c32 706f 6c28 7274 7a29 3a0d  f cyl2pol(rtz):.
-00025a80: 0a20 2020 2020 2020 2020 2020 2072 2c74  .            r,t
-00025a90: 2c7a 203d 2072 747a 0d0a 2020 2020 2020  ,z = rtz..      
-00025aa0: 2020 2020 2020 6220 3d20 2831 2e30 2b6d        b = (1.0+m
-00025ab0: 696e 7261 6429 2f32 2e30 0d0a 2020 2020  inrad)/2.0..    
-00025ac0: 2020 2020 2020 2020 6d20 3d20 2d28 312e          m = -(1.
-00025ad0: 302d 6d69 6e72 6164 292f 322e 300d 0a20  0-minrad)/2.0.. 
-00025ae0: 2020 2020 2020 2020 2020 2052 203d 206d             R = m
-00025af0: 2a7a 202b 2062 0d0a 2020 2020 2020 2020  *z + b..        
-00025b00: 2020 2020 5a20 3d20 302a 7a0d 0a20 2020      Z = 0*z..   
-00025b10: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00025b20: 522c 742c 5a0d 0a20 2020 2020 2020 2023  R,t,Z..        #
-00025b30: 202e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e   ...............
-00025b40: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00025b50: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00025b60: 2e2e 0d0a 2020 2020 2020 2020 6966 2062  ....        if b
-00025b70: 6173 6574 7970 6520 6973 2027 7371 755f  asetype is 'squ_
-00025b80: 6327 203a 2063 796c 6261 7365 203d 2027  c' : cylbase = '
-00025b90: 7371 755f 7327 200d 0a20 2020 2020 2020  squ_s' ..       
-00025ba0: 2069 6620 6261 7365 7479 7065 2069 7320   if basetype is 
-00025bb0: 2768 6578 5f63 2720 3a20 6379 6c62 6173  'hex_c' : cylbas
-00025bc0: 6520 3d20 2774 7269 5f73 270d 0a20 2020  e = 'tri_s'..   
-00025bd0: 2020 2020 2063 796c 5f6f 626a 203d 2043       cyl_obj = C
-00025be0: 796c 696e 6472 6963 616c 5375 7266 6163  ylindricalSurfac
-00025bf0: 6528 7265 7a2c 6379 6c62 6173 652c 202a  e(rez,cylbase, *
-00025c00: 2a6b 7761 7267 7329 2e6d 6170 5f67 656f  *kwargs).map_geo
-00025c10: 6d5f 6672 6f6d 5f6f 7028 6379 6c32 706f  m_from_op(cyl2po
-00025c20: 6c29 0d0a 2020 2020 2020 2020 6261 7365  l)..        base
-00025c30: 4661 6365 5665 7274 6578 496e 6469 6365  FaceVertexIndice
-00025c40: 7320 3d20 6379 6c5f 6f62 6a2e 5f62 6173  s = cyl_obj._bas
-00025c50: 655f 7375 7266 6163 6573 5b63 796c 6261  e_surfaces[cylba
-00025c60: 7365 5d20 5b27 6261 7365 4661 6365 496e  se] ['baseFaceIn
-00025c70: 6469 6365 7327 5d20 2020 200d 0a20 2020  dices']    ..   
-00025c80: 2020 2020 2066 7649 6e64 6963 6573 203d       fvIndices =
-00025c90: 2063 796c 5f6f 626a 2e66 7649 6e64 6963   cyl_obj.fvIndic
-00025ca0: 6573 0d0a 2020 2020 2020 2020 7665 7274  es..        vert
-00025cb0: 6578 436f 6f72 203d 2063 796c 5f6f 626a  exCoor = cyl_obj
-00025cc0: 2e76 6572 7465 7843 6f6f 720d 0a20 2020  .vertexCoor..   
-00025cd0: 2020 2020 2065 7649 6e64 6963 6573 203d       evIndices =
-00025ce0: 2063 796c 5f6f 626a 2e65 7649 6e64 6963   cyl_obj.evIndic
-00025cf0: 6573 0d0a 2020 2020 2020 2020 7265 7475  es..        retu
-00025d00: 726e 2076 6572 7465 7843 6f6f 722c 2066  rn vertexCoor, f
-00025d10: 7649 6e64 6963 6573 2c20 6576 496e 6469  vIndices, evIndi
-00025d20: 6365 732c 2062 6173 6546 6163 6556 6572  ces, baseFaceVer
-00025d30: 7465 7849 6e64 6963 6573 2c0d 0a0d 0a20  texIndices,.... 
-00025d40: 2020 2064 6566 205f 5f69 6e69 745f 5f28     def __init__(
-00025d50: 7365 6c66 2c20 7265 7a3d 302c 2062 6173  self, rez=0, bas
-00025d60: 6574 7970 653d 4e6f 6e65 2c20 6d69 6e72  etype=None, minr
-00025d70: 6164 3d4e 6f6e 652c 206e 616d 653d 4e6f  ad=None, name=No
-00025d80: 6e65 2c20 2a2a 6b77 6172 6773 293a 0d0a  ne, **kwargs):..
-00025d90: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
-00025da0: 2020 2020 2043 7265 6174 6520 666c 6174       Create flat
-00025db0: 2064 6973 6b20 7375 7266 6163 6520 6f66   disk surface of
-00025dc0: 2075 6e69 7420 7261 6469 7573 2e0d 0a0d   unit radius....
-00025dd0: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-00025de0: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
-00025df0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-00025e00: 2072 657a 203a 2069 6e74 6567 6572 2c20   rez : integer, 
-00025e10: 6f70 7469 6f6e 616c 2c20 6465 6661 756c  optional, defaul
-00025e20: 743a 2030 0d0a 2020 2020 2020 2020 2020  t: 0..          
-00025e30: 2020 4e75 6d62 6572 206f 6620 7265 6375    Number of recu
-00025e40: 7273 6976 6520 7375 6264 6976 6973 696f  rsive subdivisio
-00025e50: 6e73 206f 6620 7468 6520 7472 6961 6e67  ns of the triang
-00025e60: 756c 6174 6564 2062 6173 6520 6661 6365  ulated base face
-00025e70: 732e 0d0a 2020 2020 2020 2020 2020 2020  s...            
-00025e80: 5265 7a20 7661 6c75 6573 2072 616e 6765  Rez values range
-00025e90: 2066 726f 6d20 3020 746f 2037 2e0d 0a20   from 0 to 7... 
-00025ea0: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
-00025eb0: 2020 2020 2062 6173 6574 7970 6520 3a20       basetype : 
-00025ec0: 7b27 7371 7527 2c27 6865 7827 2c27 7371  {'squ','hex','sq
-00025ed0: 755f 7327 2c27 6865 785f 7327 2c27 7371  u_s','hex_s','sq
-00025ee0: 755f 6327 2c27 6865 785f 6327 7d2c 206f  u_c','hex_c'}, o
-00025ef0: 7074 696f 6e61 6c2c 2064 6566 6175 6c74  ptional, default
-00025f00: 3a20 2768 6578 270d 0a20 2020 2020 2020  : 'hex'..       
-00025f10: 2020 2020 2053 7461 7274 696e 6720 7375       Starting su
-00025f20: 7266 6163 6520 6765 6f6d 6574 7269 6573  rface geometries
-00025f30: 2066 726f 6d20 7768 6963 6820 7468 6520   from which the 
-00025f40: 7375 7266 6163 6520 6973 0d0a 2020 2020  surface is..    
-00025f50: 2020 2020 2020 2020 636f 6e73 7472 7563          construc
-00025f60: 7465 6420 7573 696e 6720 7265 6375 7273  ted using recurs
-00025f70: 6976 6520 7375 6264 6976 6973 696f 6e73  ive subdivisions
-00025f80: 206f 6620 7468 6520 7472 6961 6e67 756c   of the triangul
-00025f90: 6172 2066 6163 6573 2e0d 0a0d 0a20 2020  ar faces.....   
-00025fa0: 2020 2020 206d 696e 7261 6420 3a20 7363       minrad : sc
-00025fb0: 616c 6172 2c20 6f70 7469 6f6e 616c 2c20  alar, optional, 
-00025fc0: 6465 6661 756c 743a 2030 2e30 310d 0a20  default: 0.01.. 
-00025fd0: 2020 2020 2020 2020 2020 2046 6f72 2062             For b
-00025fe0: 6173 6574 7970 6573 2027 7371 755f 6327  asetypes 'squ_c'
-00025ff0: 2061 6e64 2027 6865 785f 632c 2074 6865   and 'hex_c, the
-00026000: 206d 696e 696d 756d 0d0a 2020 2020 2020   minimum..      
-00026010: 2020 2020 2020 6469 7374 616e 6365 2066        distance f
-00026020: 726f 6d20 7468 6520 7a2d 6178 6973 206f  rom the z-axis o
-00026030: 6620 616e 7920 7665 7274 6578 2063 6f6f  f any vertex coo
-00026040: 7264 696e 6174 652e 0d0a 0d0a 2020 2020  rdinate.....    
-00026050: 2020 2020 6e61 6d65 203a 2073 7472 696e      name : strin
-00026060: 672c 206f 7074 696f 6e61 6c2c 2064 6566  g, optional, def
-00026070: 6175 6c74 3a20 4e6f 6e65 2e0d 0a20 2020  ault: None...   
-00026080: 2020 2020 2020 2020 2044 6573 6372 6970           Descrip
-00026090: 7469 7665 2069 6465 6e74 6966 6965 7220  tive identifier 
-000260a0: 666f 7220 7468 6520 6765 6f6d 6574 7279  for the geometry
-000260b0: 2e0d 0a0d 0a20 2020 2020 2020 2052 6169  .....        Rai
-000260c0: 7365 730d 0a20 2020 2020 2020 202d 2d2d  ses..        ---
-000260d0: 2d2d 2d0d 0a20 2020 2020 2020 2056 616c  ---..        Val
-000260e0: 7565 4572 726f 720d 0a20 2020 2020 2020  ueError..       
-000260f0: 2020 2020 2049 6620 7265 7a20 6973 206e       If rez is n
-00026100: 6f74 2061 6e20 696e 7465 6765 7220 696e  ot an integer in
-00026110: 2072 616e 6765 2030 2074 6f20 372e 0d0a   range 0 to 7...
-00026120: 2020 2020 2020 2020 2020 2020 4966 2062              If b
-00026130: 6173 6574 7970 6520 6973 206e 6f74 2072  asetype is not r
-00026140: 6563 6f67 6e69 7a65 6420 666f 7220 7468  ecognized for th
-00026150: 6973 2073 7572 6661 6365 2063 6f6e 7374  is surface const
-00026160: 7275 6374 6f72 2e0d 0a0d 0a20 2020 2020  ructor.....     
-00026170: 2020 204f 7468 6572 2050 6172 616d 6574     Other Paramet
-00026180: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
-00026190: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20  -------------.. 
-000261a0: 2020 2020 2020 202a 2a6b 7761 7267 730d         **kwargs.
-000261b0: 0a20 2020 2020 2020 2020 2020 2041 6c6c  .            All
-000261c0: 206f 7468 6572 2070 6172 616d 6574 6572   other parameter
-000261d0: 7320 6172 6520 7061 7373 6564 206f 6e20  s are passed on 
-000261e0: 746f 2027 7333 646c 6962 2e73 7572 6661  to 's3dlib.surfa
-000261f0: 6365 2e53 7572 6661 6365 3344 436f 6c6c  ce.Surface3DColl
-00026200: 6563 7469 6f6e 272e 0d0a 0d0a 2020 2020  ection'.....    
-00026210: 2020 2020 2222 220d 0a0d 0a20 2020 2020      """....     
-00026220: 2020 2069 6620 6d69 6e72 6164 2069 7320     if minrad is 
-00026230: 4e6f 6e65 203a 206d 696e 7261 6420 3d20  None : minrad = 
-00026240: 5f4d 494e 5241 440d 0a20 2020 2020 2020  _MINRAD..       
-00026250: 2069 6620 6e6f 7420 6973 696e 7374 616e   if not isinstan
-00026260: 6365 2872 657a 2c20 696e 7429 203a 0d0a  ce(rez, int) :..
-00026270: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00026280: 6520 5661 6c75 6545 7272 6f72 2827 496e  e ValueError('In
-00026290: 636f 7272 6563 7420 7265 7a20 7479 7065  correct rez type
-000262a0: 2c20 6d75 7374 2062 6120 6f66 2074 7970  , must ba of typ
-000262b0: 6520 696e 7427 290d 0a20 2020 2020 2020  e int')..       
-000262c0: 2069 6620 2872 657a 3c30 2920 6f72 2028   if (rez<0) or (
-000262d0: 7265 7a3e 5f4d 4158 5245 5a29 203a 0d0a  rez>_MAXREZ) :..
-000262e0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-000262f0: 6520 5661 6c75 6545 7272 6f72 2827 496e  e ValueError('In
-00026300: 636f 7272 6573 7420 7265 7a20 6f66 207b  correst rez of {
-00026310: 7d2c 206d 7573 7420 6265 2061 6e20 696e  }, must be an in
-00026320: 742c 2030 203c 3d20 7265 7a20 3c3d 207b  t, 0 <= rez <= {
-00026330: 7d27 2e66 6f72 6d61 7428 7265 7a2c 5f4d  }'.format(rez,_M
-00026340: 4158 5245 5a29 290d 0a20 2020 2020 2020  AXREZ))..       
-00026350: 2069 6620 6261 7365 7479 7065 2069 7320   if basetype is 
-00026360: 4e6f 6e65 203a 2062 6173 6574 7970 6520  None : basetype 
-00026370: 3d20 7365 6c66 2e5f 6465 6661 756c 745f  = self._default_
-00026380: 6261 7365 0d0a 2020 2020 2020 2020 2320  base..        # 
-00026390: 2e2e 2e20 6368 6563 6b20 666f 7220 2773  ... check for 's
-000263a0: 7065 6369 616c 2063 6173 6527 2028 7567  pecial case' (ug
-000263b0: 6c79 2063 6f64 6520 6275 7420 6e65 6564  ly code but need
-000263c0: 6564 290d 0a20 2020 2020 2020 2069 6620  ed)..        if 
-000263d0: 6261 7365 7479 7065 2069 7320 2773 7175  basetype is 'squ
-000263e0: 5f63 2720 6f72 2062 6173 6574 7970 6520  _c' or basetype 
-000263f0: 6973 2027 6865 785f 6327 203a 0d0a 2020  is 'hex_c' :..  
-00026400: 2020 2020 2020 2020 2020 7665 7274 6578            vertex
-00026410: 436f 6f72 2c20 6661 6365 496e 6469 6365  Coor, faceIndice
-00026420: 732c 2065 6467 6549 6e64 6963 6573 2c20  s, edgeIndices, 
-00026430: 6266 7669 203d 2073 656c 662e 5f66 6c61  bfvi = self._fla
-00026440: 745f 7370 6c69 745f 6379 636c 696e 6465  t_split_cyclinde
-00026450: 7228 7265 7a2c 6261 7365 7479 7065 2c6d  r(rez,basetype,m
-00026460: 696e 7261 642c 202a 2a6b 7761 7267 7329  inrad, **kwargs)
-00026470: 0d0a 2020 2020 2020 2020 2020 2020 6261  ..            ba
-00026480: 7365 4661 6365 5665 7274 6578 496e 6469  seFaceVertexIndi
-00026490: 6365 7320 3d20 6266 7669 0d0a 2020 2020  ces = bfvi..    
-000264a0: 2020 2020 656c 7365 203a 0d0a 2020 2020      else :..    
-000264b0: 2020 2020 2020 2020 6966 2062 6173 6574          if baset
-000264c0: 7970 6520 6e6f 7420 696e 2073 656c 662e  ype not in self.
-000264d0: 5f62 6173 655f 7375 7266 6163 6573 203a  _base_surfaces :
-000264e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000264f0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-00026500: 6f72 2827 4261 7365 7479 7065 207b 7d20  or('Basetype {} 
-00026510: 6973 206e 6f74 2072 6563 6f67 6e69 7a65  is not recognize
-00026520: 642e 2050 6f73 7369 626c 6520 7661 6c75  d. Possible valu
-00026530: 6573 2061 7265 3a20 7b7d 272e 666f 726d  es are: {}'.form
-00026540: 6174 2862 6173 6574 7970 652c 6c69 7374  at(basetype,list
-00026550: 2873 656c 662e 5f62 6173 655f 7375 7266  (self._base_surf
-00026560: 6163 6573 2929 290d 0a20 2020 2020 2020  aces)))..       
-00026570: 2020 2020 2062 6173 6553 7572 664f 626a       baseSurfObj
-00026580: 203d 2073 656c 662e 5f62 6173 655f 7375   = self._base_su
-00026590: 7266 6163 6573 5b62 6173 6574 7970 655d  rfaces[basetype]
-000265a0: 0d0a 2020 2020 2020 2020 2020 2020 6261  ..            ba
-000265b0: 7365 5663 6f6f 7220 3d20 6261 7365 5375  seVcoor = baseSu
-000265c0: 7266 4f62 6a5b 2762 6173 6556 6572 7469  rfObj['baseVerti
-000265d0: 6365 7343 6f6f 7227 5d0d 0a20 2020 2020  cesCoor']..     
-000265e0: 2020 2020 2020 2062 6173 6546 6163 6556         baseFaceV
-000265f0: 6572 7465 7849 6e64 6963 6573 203d 6261  ertexIndices =ba
-00026600: 7365 5375 7266 4f62 6a5b 2762 6173 6546  seSurfObj['baseF
-00026610: 6163 6549 6e64 6963 6573 275d 0d0a 2020  aceIndices']..  
-00026620: 2020 2020 2020 2020 2020 696e 6465 784f            indexO
-00026630: 626a 2c76 6572 7465 7843 6f6f 7220 3d20  bj,vertexCoor = 
-00026640: 7365 6c66 2e74 7269 616e 6775 6c61 7465  self.triangulate
-00026650: 4261 7365 2872 657a 2c62 6173 6556 636f  Base(rez,baseVco
-00026660: 6f72 2c62 6173 6546 6163 6556 6572 7465  or,baseFaceVerte
-00026670: 7849 6e64 6963 6573 2c20 7365 6c66 2e5f  xIndices, self._
-00026680: 6d69 6456 6563 746f 7246 756e 290d 0a20  midVectorFun).. 
-00026690: 2020 2020 2020 2020 2020 2066 6163 6549             faceI
-000266a0: 6e64 6963 6573 203d 2069 6e64 6578 4f62  ndices = indexOb
-000266b0: 6a5b 2766 6163 6527 5d0d 0a20 2020 2020  j['face']..     
-000266c0: 2020 2020 2020 2065 6467 6549 6e64 6963         edgeIndic
-000266d0: 6573 203d 2069 6e64 6578 4f62 6a5b 2765  es = indexObj['e
-000266e0: 6467 6527 5d0d 0a0d 0a20 2020 2020 2020  dge']....       
-000266f0: 2073 7570 6572 2829 2e5f 5f69 6e69 745f   super().__init_
-00026700: 5f28 7665 7274 6578 436f 6f72 2c20 6661  _(vertexCoor, fa
-00026710: 6365 496e 6469 6365 732c 206e 616d 652c  ceIndices, name,
-00026720: 202a 2a6b 7761 7267 7329 0d0a 0d0a 2020   **kwargs)....  
-00026730: 2020 2020 2020 7365 6c66 2e63 6f6f 7254        self.coorT
-00026740: 7970 6520 3d20 5f43 4f4f 5253 5953 5b22  ype = _COORSYS["
-00026750: 504f 4c41 5222 5d0d 0a20 2020 2020 2020  POLAR"]..       
-00026760: 2073 656c 662e 5f6e 6f72 6d61 6c5f 7363   self._normal_sc
-00026770: 616c 6520 3d20 5f6e 6f72 6d4c 656e 6774  ale = _normLengt
-00026780: 6828 206c 656e 2866 6163 6549 6e64 6963  h( len(faceIndic
-00026790: 6573 292c 2031 2e32 2c20 312e 3535 2c20  es), 1.2, 1.55, 
-000267a0: 6e70 2e70 6920 290d 0a20 2020 2020 2020  np.pi )..       
-000267b0: 2073 656c 662e 5f72 657a 203d 2072 657a   self._rez = rez
-000267c0: 0d0a 2020 2020 2020 2020 7365 6c66 2e5f  ..        self._
-000267d0: 6261 7365 7479 7065 203d 2062 6173 6574  basetype = baset
-000267e0: 7970 650d 0a20 2020 2020 2020 2072 6574  ype..        ret
-000267f0: 7572 6e0d 0a0d 0a20 2020 2064 6566 2064  urn....    def d
-00026800: 6f6d 6169 6e28 7365 6c66 2c20 7261 6469  omain(self, radi
-00026810: 7573 3d4e 6f6e 652c 207a 636f 6f72 3d4e  us=None, zcoor=N
-00026820: 6f6e 6529 203a 0d0a 2020 2020 2020 2020  one) :..        
-00026830: 2222 220d 0a20 2020 2020 2020 2053 6574  """..        Set
-00026840: 2074 6865 2064 6f6d 6169 6e20 6f66 2074   the domain of t
-00026850: 6865 2070 6f6c 6172 2073 7572 6661 6365  he polar surface
-00026860: 2e0d 0a0d 0a20 2020 2020 2020 2055 7365  .....        Use
-00026870: 6420 666f 7220 7365 7474 696e 6720 7468  d for setting th
-00026880: 6520 6c69 6d69 7473 206f 6620 7468 6520  e limits of the 
-00026890: 6261 7365 2070 6f6c 6172 2070 6c61 6e65  base polar plane
-000268a0: 2e0d 0a0d 0a20 2020 2020 2020 2050 6172  .....        Par
-000268b0: 616d 6574 6572 730d 0a20 2020 2020 2020  ameters..       
-000268c0: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
-000268d0: 2020 2020 2020 7261 6469 7573 3a20 6e75        radius: nu
-000268e0: 6d62 6572 2c20 6465 6661 756c 7420 3a20  mber, default : 
-000268f0: 310d 0a20 2020 2020 2020 2020 2020 2052  1..            R
-00026900: 6164 6975 7320 6f66 2074 6865 2070 6f6c  adius of the pol
-00026910: 6172 2073 7572 6661 6365 2e0d 0a20 2020  ar surface...   
-00026920: 2020 2020 2020 2020 2049 6620 7365 7420           If set 
-00026930: 746f 204e 6f6e 652c 2074 6865 2072 6164  to None, the rad
-00026940: 6975 7320 6973 2075 6e63 6861 6e67 6564  ius is unchanged
-00026950: 2e0d 0a0d 0a20 2020 2020 2020 207a 636f  .....        zco
-00026960: 6f72 3a20 6e75 6d62 6572 2c20 6465 6661  or: number, defa
-00026970: 756c 7420 3a20 300d 0a20 2020 2020 2020  ult : 0..       
-00026980: 2020 2020 205a 206f 6666 7365 7420 6f66       Z offset of
-00026990: 2074 6865 2070 6f6c 6172 2070 6c61 6e65   the polar plane
-000269a0: 2e0d 0a20 2020 2020 2020 2020 2020 2049  ...            I
-000269b0: 6620 7365 7420 746f 204e 6f6e 652c 2074  f set to None, t
-000269c0: 6865 205a 206f 6666 7365 7420 6973 2075  he Z offset is u
-000269d0: 6e63 6861 6e67 6564 2e0d 0a20 2020 2020  nchanged...     
-000269e0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-000269f0: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
-00026a00: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
-00026a10: 2020 2073 656c 6620 3a20 506f 6c61 7253     self : PolarS
-00026a20: 7572 6661 6365 206f 626a 6563 740d 0a0d  urface object...
-00026a30: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
-00026a40: 2020 2020 2020 6465 6620 7365 7444 6f6d        def setDom
-00026a50: 6169 6e28 7274 7a2c 206d 722c 206d 7a29  ain(rtz, mr, mz)
-00026a60: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
-00026a70: 722c 742c 7a20 3d20 7274 7a0d 0a20 2020  r,t,z = rtz..   
-00026a80: 2020 2020 2020 2020 2052 203d 206d 722a           R = mr*
-00026a90: 720d 0a20 2020 2020 2020 2020 2020 205a  r..            Z
-00026aa0: 203d 207a 2069 6620 6d7a 2069 7320 4e6f   = z if mz is No
-00026ab0: 6e65 2065 6c73 6520 6e70 2e66 756c 6c28  ne else np.full(
-00026ac0: 6c65 6e28 7a29 2c6d 7a29 0d0a 2020 2020  len(z),mz)..    
-00026ad0: 2020 2020 2020 2020 7265 7475 726e 2052          return R
-00026ae0: 2c74 2c5a 2020 2020 2020 200d 0a20 2020  ,t,Z       ..   
-00026af0: 2020 2020 2064 6566 2067 6574 436f 6e74       def getCont
-00026b00: 286c 696d 7329 203a 0d0a 2020 2020 2020  (lims) :..      
-00026b10: 2020 2020 2020 6d20 3d20 312e 300d 0a20        m = 1.0.. 
-00026b20: 2020 2020 2020 2020 2020 2069 6620 6c69             if li
-00026b30: 6d73 2069 7320 6e6f 7420 4e6f 6e65 203a  ms is not None :
-00026b40: 206d 203d 206c 696d 730d 0a20 2020 2020   m = lims..     
-00026b50: 2020 2020 2020 2072 6574 7572 6e20 6d0d         return m.
-00026b60: 0a20 2020 2020 2020 206d 7220 3d20 6765  .        mr = ge
-00026b70: 7443 6f6e 7428 7261 6469 7573 290d 0a20  tCont(radius).. 
-00026b80: 2020 2020 2020 2073 656c 662e 6d61 705f         self.map_
-00026b90: 6765 6f6d 5f66 726f 6d5f 6f70 286c 616d  geom_from_op(lam
-00026ba0: 6264 6120 4120 3a20 7365 7444 6f6d 6169  bda A : setDomai
-00026bb0: 6e28 412c 206d 722c 7a63 6f6f 7220 2929  n(A, mr,zcoor ))
-00026bc0: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00026bd0: 2073 656c 660d 0a0d 0a63 6c61 7373 2043   self....class C
-00026be0: 796c 696e 6472 6963 616c 5375 7266 6163  ylindricalSurfac
-00026bf0: 6528 5375 7266 6163 6533 4443 6f6c 6c65  e(Surface3DColle
-00026c00: 6374 696f 6e29 203a 0d0a 2020 2020 2222  ction) :..    ""
-00026c10: 220d 0a20 2020 2043 796c 696e 6472 6963  "..    Cylindric
-00026c20: 616c 2033 4420 7375 7266 6163 6520 696e  al 3D surface in
-00026c30: 2063 796c 696e 6472 6963 616c 2063 6f6f   cylindrical coo
-00026c40: 7264 696e 6174 6573 2e0d 0a0d 0a20 2020  rdinates.....   
-00026c50: 204d 6574 686f 6473 2061 7265 2069 6e68   Methods are inh
-00026c60: 6572 6974 6564 2066 726f 6d20 7468 6520  erited from the 
-00026c70: 5375 7266 6163 6533 4443 6f6c 6c65 6374  Surface3DCollect
-00026c80: 696f 6e2e 0d0a 2020 2020 4379 6c69 6e64  ion...    Cylind
-00026c90: 7269 6361 6c20 7375 7266 6163 6520 6765  rical surface ge
-00026ca0: 6f6d 6574 7269 6573 2061 7265 2063 7265  ometries are cre
-00026cb0: 6174 6564 2069 6e20 7468 6973 2073 7562  ated in this sub
-00026cc0: 636c 6173 732e 0d0a 0d0a 2020 2020 2222  class.....    ""
-00026cd0: 220d 0a0d 0a20 2020 2040 7374 6174 6963  "....    @static
-00026ce0: 6d65 7468 6f64 0d0a 2020 2020 6465 6620  method..    def 
-00026cf0: 7261 6e64 2872 657a 3d30 2c73 6565 643d  rand(rez=0,seed=
-00026d00: 4e6f 6e65 2c6e 616d 653d 4e6f 6e65 2c6b  None,name=None,k
-00026d10: 696e 643d 4e6f 6e65 2c2a 2a6b 6172 6773  ind=None,**kargs
-00026d20: 2920 3a0d 0a20 2020 2020 2020 2022 2222  ) :..        """
-00026d30: 2872 6573 6572 7665 642c 206e 6f74 2069  (reserved, not i
-00026d40: 6d70 6c65 6d65 6e74 6564 2922 2222 0d0a  mplemented)"""..
-00026d50: 2020 2020 2020 2020 7375 7266 6163 6520          surface 
-00026d60: 3d20 4379 6c69 6e64 7269 6361 6c53 7572  = CylindricalSur
-00026d70: 6661 6365 2872 657a 2c6e 616d 653d 6e61  face(rez,name=na
-00026d80: 6d65 2c2a 2a6b 6172 6773 290d 0a20 2020  me,**kargs)..   
-00026d90: 2020 2020 2077 6172 6e69 6e67 732e 7761       warnings.wa
-00026da0: 726e 2827 4465 6661 756c 7420 4379 6c69  rn('Default Cyli
-00026db0: 6e64 7269 6361 6c53 7572 6661 6365 206f  ndricalSurface o
-00026dc0: 626a 6563 742c 206e 6f74 2072 616e 642c  bject, not rand,
-00026dd0: 2072 6574 7572 6e65 6427 290d 0a20 2020   returned')..   
-00026de0: 2020 2020 2072 6574 7572 6e20 7375 7266       return surf
-00026df0: 6163 650d 0a0d 0a20 2020 2040 7374 6174  ace....    @stat
-00026e00: 6963 6d65 7468 6f64 0d0a 2020 2020 6465  icmethod..    de
-00026e10: 6620 5f67 6574 5f63 796c 696e 6472 6963  f _get_cylindric
-00026e20: 616c 5f73 7572 6661 6365 735f 6469 6374  al_surfaces_dict
-00026e30: 696f 6e61 7279 2829 203a 0d0a 2020 2020  ionary() :..    
-00026e40: 2020 2020 2222 2243 6f6e 7374 7275 6374      """Construct
-00026e50: 7320 7468 6520 6469 6374 696f 6e61 7279  s the dictionary
-00026e60: 206f 6620 6261 7365 2063 796c 696e 6472   of base cylindr
-00026e70: 6963 616c 2073 7572 6661 6365 2067 656f  ical surface geo
-00026e80: 6d65 7472 6965 732e 2022 2222 0d0a 0d0a  metries. """....
-00026e90: 2020 2020 2020 2020 7375 7266 6163 6573          surfaces
-00026ea0: 4469 6374 696f 6e61 7279 203d 207b 7d0d  Dictionary = {}.
-00026eb0: 0a20 2020 2020 2020 2064 6566 2063 6f6e  .        def con
-00026ec0: 7374 7275 6374 5f74 7269 6379 6c69 6e64  struct_tricylind
-00026ed0: 6572 2829 203a 0d0a 2020 2020 2020 2020  er() :..        
-00026ee0: 2020 2020 7930 203d 206e 702e 7371 7274      y0 = np.sqrt
-00026ef0: 2833 2e30 292f 322e 300d 0a20 2020 2020  (3.0)/2.0..     
-00026f00: 2020 2020 2020 2078 3020 3d20 302e 350d         x0 = 0.5.
-00026f10: 0a0d 0a20 2020 2020 2020 2020 2020 2062  ...            b
-00026f20: 6173 6556 6572 7420 3d20 5b20 5b31 2c30  aseVert = [ [1,0
-00026f30: 2c30 5d2c 2020 205b 2d78 302c 2d79 302c  ,0],   [-x0,-y0,
-00026f40: 305d 2c20 5b2d 7830 2c79 302c 305d 2c0d  0], [-x0,y0,0],.
-00026f50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00026f60: 2020 2020 2020 2020 2020 5b2d 312c 302c            [-1,0,
-00026f70: 315d 2c20 205b 7830 2c2d 7930 2c31 5d2c  1],  [x0,-y0,1],
-00026f80: 2020 5b78 302c 7930 2c31 5d2c 0d0a 2020    [x0,y0,1],..  
-00026f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026fa0: 2020 2020 2020 205b 2d31 2c30 2c2d 315d         [-1,0,-1]
-00026fb0: 2c20 5b78 302c 2d79 302c 2d31 5d2c 205b  , [x0,-y0,-1], [
-00026fc0: 7830 2c79 302c 2d31 5d20 5d0d 0a0d 0a20  x0,y0,-1] ].... 
-00026fd0: 2020 2020 2020 2020 2020 2062 6173 6546             baseF
-00026fe0: 6163 6573 3d28 200d 0a20 2020 2020 2020  aces=( ..       
-00026ff0: 2020 2020 2020 2020 205b 302c 322c 355d           [0,2,5]
-00027000: 2c5b 322c 312c 335d 2c5b 312c 302c 345d  ,[2,1,3],[1,0,4]
-00027010: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00027020: 2020 205b 302c 352c 345d 2c5b 322c 332c     [0,5,4],[2,3,
-00027030: 355d 2c5b 312c 342c 335d 2c20 0d0a 2020  5],[1,4,3], ..  
-00027040: 2020 2020 2020 2020 2020 2020 2020 5b30                [0
-00027050: 2c38 2c32 5d2c 5b32 2c36 2c31 5d2c 5b31  ,8,2],[2,6,1],[1
-00027060: 2c37 2c30 5d2c 0d0a 2020 2020 2020 2020  ,7,0],..        
-00027070: 2020 2020 2020 2020 5b30 2c37 2c38 5d2c          [0,7,8],
-00027080: 5b32 2c38 2c36 5d2c 5b31 2c36 2c37 5d29  [2,8,6],[1,6,7])
-00027090: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-000270a0: 466f 203d 206c 656e 2862 6173 6546 6163  Fo = len(baseFac
-000270b0: 6573 290d 0a20 2020 2020 2020 2020 2020  es)..           
-000270c0: 2072 6574 7572 6e20 7b20 2762 6173 6546   return { 'baseF
-000270d0: 6163 6549 6e64 6963 6573 2720 3a20 6261  aceIndices' : ba
-000270e0: 7365 4661 6365 7320 2c20 2762 6173 6556  seFaces , 'baseV
-000270f0: 6572 7469 6365 7343 6f6f 7227 203a 2062  erticesCoor' : b
-00027100: 6173 6556 6572 742c 2027 6665 7650 6172  aseVert, 'fevPar
-00027110: 616d 2720 3a20 5b46 6f2c 332c 305d 207d  am' : [Fo,3,0] }
-00027120: 0d0a 0d0a 2020 2020 2020 2020 6465 6620  ....        def 
-00027130: 636f 6e73 7472 7563 745f 7472 6963 796c  construct_tricyl
-00027140: 696e 6465 725f 7628 2920 3a0d 0a20 2020  inder_v() :..   
-00027150: 2020 2020 2020 2020 2076 6669 5f64 203d           vfi_d =
-00027160: 2063 6f6e 7374 7275 6374 5f74 7269 6379   construct_tricy
-00027170: 6c69 6e64 6572 2829 0d0a 2020 2020 2020  linder()..      
-00027180: 2020 2020 2020 6261 7365 5665 7274 203d        baseVert =
-00027190: 2020 7666 695f 645b 2762 6173 6556 6572    vfi_d['baseVer
-000271a0: 7469 6365 7343 6f6f 7227 5d0d 0a20 2020  ticesCoor']..   
-000271b0: 2020 2020 2020 2020 2062 6173 6546 6163           baseFac
-000271c0: 6573 203d 2076 6669 5f64 5b27 6261 7365  es = vfi_d['base
-000271d0: 4661 6365 496e 6469 6365 7327 5d0d 0a20  FaceIndices'].. 
-000271e0: 2020 2020 2020 2020 2020 2062 6173 6556             baseV
-000271f0: 6572 7420 3d20 6261 7365 5665 7274 202b  ert = baseVert +
-00027200: 205b 5b30 2c30 2c31 5d2c 5b30 2c30 2c2d   [[0,0,1],[0,0,-
-00027210: 315d 5d0d 0a20 2020 2020 2020 2020 2020  1]]..           
-00027220: 2062 6173 6546 6163 6573 203d 206c 6973   baseFaces = lis
-00027230: 7428 6261 7365 4661 6365 7329 0d0a 2020  t(baseFaces)..  
-00027240: 2020 2020 2020 2020 2020 6164 6446 6163            addFac
-00027250: 6573 203d 205b 200d 0a20 2020 2020 2020  es = [ ..       
-00027260: 2020 2020 2020 2020 205b 332c 342c 395d           [3,4,9]
-00027270: 2c5b 342c 352c 395d 2c5b 352c 332c 395d  ,[4,5,9],[5,3,9]
-00027280: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00027290: 2020 205b 362c 382c 3130 5d2c 5b38 2c37     [6,8,10],[8,7
-000272a0: 2c31 305d 2c5b 372c 362c 3130 5d20 5d0d  ,10],[7,6,10] ].
-000272b0: 0a20 2020 2020 2020 2020 2020 2062 6173  .            bas
-000272c0: 6546 6163 6573 203d 2062 6173 6546 6163  eFaces = baseFac
-000272d0: 6573 202b 2061 6464 4661 6365 730d 0a20  es + addFaces.. 
-000272e0: 2020 2020 2020 2020 2020 2046 6f20 3d20             Fo = 
-000272f0: 6c65 6e28 6261 7365 4661 6365 7329 0d0a  len(baseFaces)..
-00027300: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00027310: 726e 207b 2027 6261 7365 4661 6365 496e  rn { 'baseFaceIn
-00027320: 6469 6365 7327 203a 2062 6173 6546 6163  dices' : baseFac
-00027330: 6573 202c 2027 6261 7365 5665 7274 6963  es , 'baseVertic
-00027340: 6573 436f 6f72 2720 3a20 6261 7365 5665  esCoor' : baseVe
-00027350: 7274 2c20 2766 6576 5061 7261 6d27 203a  rt, 'fevParam' :
-00027360: 205b 466f 2c30 2c32 5d20 7d0d 0a20 2020   [Fo,0,2] }..   
-00027370: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-00027380: 2020 2064 6566 2063 6f6e 7374 7275 6374     def construct
-00027390: 5f74 7269 3263 796c 696e 6465 7228 2920  _tri2cylinder() 
-000273a0: 3a0d 0a20 2020 2020 2020 2020 2020 2079  :..            y
-000273b0: 3020 3d20 6e70 2e73 7172 7428 332e 3029  0 = np.sqrt(3.0)
-000273c0: 2f32 2e30 0d0a 2020 2020 2020 2020 2020  /2.0..          
-000273d0: 2020 7830 203d 2030 2e35 200d 0a0d 0a20    x0 = 0.5 .... 
-000273e0: 2020 2020 2020 2020 2020 2062 6173 6556             baseV
-000273f0: 6572 7420 3d20 5b20 5b2d 312c 302c 305d  ert = [ [-1,0,0]
-00027400: 2c20 5b78 302c 2d79 302c 305d 2c20 2020  , [x0,-y0,0],   
-00027410: 5b78 302c 7930 2c30 5d2c 0d0a 2020 2020  [x0,y0,0],..    
-00027420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027430: 2020 2020 205b 312c 302c 315d 2c20 205b       [1,0,1],  [
-00027440: 2d78 302c 2d79 302c 315d 2c20 205b 2d78  -x0,-y0,1],  [-x
-00027450: 302c 7930 2c31 5d2c 0d0a 2020 2020 2020  0,y0,1],..      
-00027460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027470: 2020 205b 312c 302c 2d31 5d2c 205b 2d78     [1,0,-1], [-x
-00027480: 302c 2d79 302c 2d31 5d2c 205b 2d78 302c  0,-y0,-1], [-x0,
-00027490: 7930 2c2d 315d 205d 0d0a 0d0a 2020 2020  y0,-1] ]....    
-000274a0: 2020 2020 2020 2020 6261 7365 4661 6365          baseFace
-000274b0: 733d 2820 0d0a 2020 2020 2020 2020 2020  s=( ..          
-000274c0: 2020 2020 2020 5b30 2c34 2c35 5d2c 5b31        [0,4,5],[1
-000274d0: 2c33 2c34 5d2c 5b32 2c35 2c33 5d2c 0d0a  ,3,4],[2,5,3],..
-000274e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000274f0: 5b30 2c38 2c37 5d2c 5b31 2c37 2c36 5d2c  [0,8,7],[1,7,6],
-00027500: 5b32 2c36 2c38 5d2c 0d0a 2020 2020 2020  [2,6,8],..      
-00027510: 2020 2020 2020 2020 2020 5b30 2c37 2c34            [0,7,4
-00027520: 5d2c 5b31 2c36 2c33 5d2c 5b32 2c38 2c35  ],[1,6,3],[2,8,5
-00027530: 5d2c 0d0a 2020 2020 2020 2020 2020 2020  ],..            
-00027540: 2020 2020 5b30 2c35 2c38 5d2c 5b31 2c34      [0,5,8],[1,4
-00027550: 2c37 5d2c 5b32 2c33 2c36 5d29 0d0a 0d0a  ,7],[2,3,6])....
-00027560: 2020 2020 2020 2020 2020 2020 466f 203d              Fo =
-00027570: 206c 656e 2862 6173 6546 6163 6573 290d   len(baseFaces).
-00027580: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00027590: 7572 6e20 7b20 2762 6173 6546 6163 6549  urn { 'baseFaceI
-000275a0: 6e64 6963 6573 2720 3a20 6261 7365 4661  ndices' : baseFa
-000275b0: 6365 7320 2c20 2762 6173 6556 6572 7469  ces , 'baseVerti
-000275c0: 6365 7343 6f6f 7227 203a 2062 6173 6556  cesCoor' : baseV
-000275d0: 6572 742c 2027 6665 7650 6172 616d 2720  ert, 'fevParam' 
-000275e0: 3a20 5b46 6f2c 332c 305d 207d 0d0a 0d0a  : [Fo,3,0] }....
-000275f0: 2020 2020 2020 2020 6465 6620 636f 6e73          def cons
-00027600: 7472 7563 745f 7472 6932 6379 6c69 6e64  truct_tri2cylind
-00027610: 6572 5f76 2829 203a 0d0a 2020 2020 2020  er_v() :..      
-00027620: 2020 2020 2020 7666 695f 6420 3d20 636f        vfi_d = co
-00027630: 6e73 7472 7563 745f 7472 6932 6379 6c69  nstruct_tri2cyli
-00027640: 6e64 6572 2829 0d0a 2020 2020 2020 2020  nder()..        
-00027650: 2020 2020 6261 7365 5665 7274 203d 2020      baseVert =  
-00027660: 7666 695f 645b 2762 6173 6556 6572 7469  vfi_d['baseVerti
-00027670: 6365 7343 6f6f 7227 5d0d 0a20 2020 2020  cesCoor']..     
-00027680: 2020 2020 2020 2062 6173 6546 6163 6573         baseFaces
-00027690: 203d 2076 6669 5f64 5b27 6261 7365 4661   = vfi_d['baseFa
-000276a0: 6365 496e 6469 6365 7327 5d0d 0a20 2020  ceIndices']..   
-000276b0: 2020 2020 2020 2020 2062 6173 6556 6572           baseVer
-000276c0: 7420 3d20 6261 7365 5665 7274 202b 205b  t = baseVert + [
-000276d0: 5b30 2c30 2c31 5d2c 5b30 2c30 2c2d 315d  [0,0,1],[0,0,-1]
-000276e0: 5d0d 0a20 2020 2020 2020 2020 2020 2062  ]..            b
-000276f0: 6173 6546 6163 6573 203d 206c 6973 7428  aseFaces = list(
-00027700: 6261 7365 4661 6365 7329 0d0a 2020 2020  baseFaces)..    
-00027710: 2020 2020 2020 2020 6164 6446 6163 6573          addFaces
-00027720: 203d 205b 200d 0a20 2020 2020 2020 2020   = [ ..         
-00027730: 2020 2020 2020 205b 332c 392c 345d 2c5b         [3,9,4],[
-00027740: 342c 392c 355d 2c5b 352c 392c 335d 2c0d  4,9,5],[5,9,3],.
-00027750: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00027760: 205b 362c 3130 2c38 5d2c 5b37 2c31 302c   [6,10,8],[7,10,
-00027770: 365d 2c5b 382c 3130 2c37 5d20 5d0d 0a20  6],[8,10,7] ].. 
-00027780: 2020 2020 2020 2020 2020 2062 6173 6546             baseF
-00027790: 6163 6573 203d 2062 6173 6546 6163 6573  aces = baseFaces
-000277a0: 202b 2061 6464 4661 6365 730d 0a20 2020   + addFaces..   
-000277b0: 2020 2020 2020 2020 2046 6f20 3d20 6c65           Fo = le
-000277c0: 6e28 6261 7365 4661 6365 7329 0d0a 2020  n(baseFaces)..  
-000277d0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-000277e0: 207b 2027 6261 7365 4661 6365 496e 6469   { 'baseFaceIndi
-000277f0: 6365 7327 203a 2062 6173 6546 6163 6573  ces' : baseFaces
-00027800: 202c 2027 6261 7365 5665 7274 6963 6573   , 'baseVertices
-00027810: 436f 6f72 2720 3a20 6261 7365 5665 7274  Coor' : baseVert
-00027820: 2c20 2766 6576 5061 7261 6d27 203a 205b  , 'fevParam' : [
-00027830: 466f 2c30 2c32 5d20 7d0d 0a0d 0a20 2020  Fo,0,2] }....   
-00027840: 2020 2020 2064 6566 2063 6f6e 7374 7275       def constru
-00027850: 6374 5f74 7269 3263 796c 696e 6465 725f  ct_tri2cylinder_
-00027860: 736c 6963 6564 2829 203a 0d0a 2020 2020  sliced() :..    
-00027870: 2020 2020 2020 2020 7930 203d 206e 702e          y0 = np.
-00027880: 7371 7274 2833 2e30 292f 322e 300d 0a20  sqrt(3.0)/2.0.. 
-00027890: 2020 2020 2020 2020 2020 2078 3020 3d20             x0 = 
-000278a0: 302e 3520 2020 0d0a 2020 2020 2020 2020  0.5   ..        
-000278b0: 2020 2020 796f 6620 3d20 302e 3030 3031      yof = 0.0001
-000278c0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-000278d0: 6261 7365 5665 7274 203d 205b 205b 2d31  baseVert = [ [-1
-000278e0: 2c30 2c30 5d2c 2020 205b 7830 2c2d 7930  ,0,0],   [x0,-y0
-000278f0: 2c30 5d2c 2020 205b 7830 2c79 302c 305d  ,0],   [x0,y0,0]
-00027900: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00027910: 2020 2020 2020 2020 2020 2020 5b31 2c79              [1,y
-00027920: 6f66 2c31 5d2c 2020 5b2d 7830 2c2d 7930  of,1],  [-x0,-y0
-00027930: 2c31 5d2c 2020 5b2d 7830 2c79 302c 315d  ,1],  [-x0,y0,1]
-00027940: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00027950: 2020 2020 2020 2020 2020 2020 5b31 2c79              [1,y
-00027960: 6f66 2c2d 315d 2c20 5b2d 7830 2c2d 7930  of,-1], [-x0,-y0
-00027970: 2c2d 315d 2c20 5b2d 7830 2c79 302c 2d31  ,-1], [-x0,y0,-1
-00027980: 5d2c 0d0a 2020 2020 2020 2020 2020 2020  ],..            
-00027990: 2020 2020 2020 2020 2020 2020 205b 312c               [1,
-000279a0: 2d79 6f66 2c31 5d2c 205b 312c 2d79 6f66  -yof,1], [1,-yof
-000279b0: 2c2d 315d 205d 0d0a 0d0a 2020 2020 2020  ,-1] ]....      
-000279c0: 2020 2020 2020 6261 7365 4661 6365 733d        baseFaces=
-000279d0: 2820 0d0a 2020 2020 2020 2020 2020 2020  ( ..            
-000279e0: 2020 2020 5b30 2c34 2c35 5d2c 5b31 2c39      [0,4,5],[1,9
-000279f0: 2c34 5d2c 5b32 2c35 2c33 5d2c 0d0a 2020  ,4],[2,5,3],..  
-00027a00: 2020 2020 2020 2020 2020 2020 2020 5b30                [0
-00027a10: 2c38 2c37 5d2c 5b31 2c37 2c31 305d 2c5b  ,8,7],[1,7,10],[
-00027a20: 322c 362c 385d 2c0d 0a20 2020 2020 2020  2,6,8],..       
-00027a30: 2020 2020 2020 2020 205b 302c 372c 345d           [0,7,4]
-00027a40: 2c5b 312c 3130 2c39 5d2c 5b32 2c38 2c35  ,[1,10,9],[2,8,5
-00027a50: 5d2c 0d0a 0d0a 2020 2020 2020 2020 2020  ],....          
-00027a60: 2020 2020 2020 5b30 2c35 2c38 5d2c 5b31        [0,5,8],[1
-00027a70: 2c34 2c37 5d2c 5b32 2c33 2c36 5d29 0d0a  ,4,7],[2,3,6])..
-00027a80: 0d0a 2020 2020 2020 2020 2020 2020 466f  ..            Fo
-00027a90: 203d 206c 656e 2862 6173 6546 6163 6573   = len(baseFaces
-00027aa0: 290d 0a20 2020 2020 2020 2020 2020 2072  )..            r
-00027ab0: 6574 7572 6e20 7b20 2762 6173 6546 6163  eturn { 'baseFac
-00027ac0: 6549 6e64 6963 6573 2720 3a20 6261 7365  eIndices' : base
-00027ad0: 4661 6365 7320 2c20 2762 6173 6556 6572  Faces , 'baseVer
-00027ae0: 7469 6365 7343 6f6f 7227 203a 2062 6173  ticesCoor' : bas
-00027af0: 6556 6572 742c 2027 6665 7650 6172 616d  eVert, 'fevParam
-00027b00: 2720 3a20 5b46 6f2c 342c 315d 207d 0d0a  ' : [Fo,4,1] }..
-00027b10: 0d0a 2020 2020 2020 2020 6465 6620 636f  ..        def co
-00027b20: 6e73 7472 7563 745f 7472 6932 6379 6c69  nstruct_tri2cyli
-00027b30: 6e64 6572 5f73 6c69 6365 645f 7628 2920  nder_sliced_v() 
-00027b40: 3a0d 0a20 2020 2020 2020 2020 2020 2076  :..            v
-00027b50: 6669 5f64 203d 2063 6f6e 7374 7275 6374  fi_d = construct
-00027b60: 5f74 7269 3263 796c 696e 6465 725f 736c  _tri2cylinder_sl
-00027b70: 6963 6564 2829 0d0a 2020 2020 2020 2020  iced()..        
-00027b80: 2020 2020 6261 7365 5665 7274 203d 2020      baseVert =  
-00027b90: 7666 695f 645b 2762 6173 6556 6572 7469  vfi_d['baseVerti
-00027ba0: 6365 7343 6f6f 7227 5d0d 0a20 2020 2020  cesCoor']..     
-00027bb0: 2020 2020 2020 2062 6173 6546 6163 6573         baseFaces
-00027bc0: 203d 2076 6669 5f64 5b27 6261 7365 4661   = vfi_d['baseFa
-00027bd0: 6365 496e 6469 6365 7327 5d0d 0a20 2020  ceIndices']..   
-00027be0: 2020 2020 2020 2020 2062 6173 6556 6572           baseVer
-00027bf0: 7420 3d20 6261 7365 5665 7274 202b 205b  t = baseVert + [
-00027c00: 5b30 2c30 2c31 5d2c 5b30 2c30 2c2d 315d  [0,0,1],[0,0,-1]
-00027c10: 5d0d 0a20 2020 2020 2020 2020 2020 2062  ]..            b
-00027c20: 6173 6546 6163 6573 203d 206c 6973 7428  aseFaces = list(
-00027c30: 6261 7365 4661 6365 7329 0d0a 2020 2020  baseFaces)..    
-00027c40: 2020 2020 2020 2020 6164 6446 6163 6573          addFaces
-00027c50: 203d 205b 200d 0a20 2020 2020 2020 2020   = [ ..         
-00027c60: 2020 2020 2020 205b 332c 352c 3131 5d2c         [3,5,11],
-00027c70: 5b35 2c34 2c31 315d 2c5b 342c 392c 3131  [5,4,11],[4,9,11
-00027c80: 5d2c 200d 0a20 2020 2020 2020 2020 2020  ], ..           
-00027c90: 2020 2020 205b 382c 362c 3132 5d2c 5b37       [8,6,12],[7
-00027ca0: 2c38 2c31 325d 2c5b 3130 2c37 2c31 325d  ,8,12],[10,7,12]
-00027cb0: 205d 0d0a 2020 2020 2020 2020 2020 2020   ]..            
-00027cc0: 6261 7365 4661 6365 7320 3d20 6261 7365  baseFaces = base
-00027cd0: 4661 6365 7320 2b20 6164 6446 6163 6573  Faces + addFaces
-00027ce0: 0d0a 2020 2020 2020 2020 2020 2020 466f  ..            Fo
-00027cf0: 203d 206c 656e 2862 6173 6546 6163 6573   = len(baseFaces
-00027d00: 290d 0a20 2020 2020 2020 2020 2020 2072  )..            r
-00027d10: 6574 7572 6e20 7b20 2762 6173 6546 6163  eturn { 'baseFac
-00027d20: 6549 6e64 6963 6573 2720 3a20 6261 7365  eIndices' : base
-00027d30: 4661 6365 7320 2c20 2762 6173 6556 6572  Faces , 'baseVer
-00027d40: 7469 6365 7343 6f6f 7227 203a 2062 6173  ticesCoor' : bas
-00027d50: 6556 6572 742c 2027 6665 7650 6172 616d  eVert, 'fevParam
-00027d60: 2720 3a20 5b46 6f2c 302c 325d 207d 0d0a  ' : [Fo,0,2] }..
-00027d70: 0d0a 2020 2020 2020 2020 6465 6620 636f  ..        def co
-00027d80: 6e73 7472 7563 745f 7175 6164 6379 6c69  nstruct_quadcyli
-00027d90: 6e64 6572 2829 203a 0d0a 2020 2020 2020  nder() :..      
-00027da0: 2020 2020 2020 7879 3020 3d20 312e 302f        xy0 = 1.0/
-00027db0: 6e70 2e73 7172 7428 322e 3029 0d0a 0d0a  np.sqrt(2.0)....
-00027dc0: 2020 2020 2020 2020 2020 2020 6261 7365              base
-00027dd0: 5665 7274 203d 205b 205b 312c 302c 305d  Vert = [ [1,0,0]
-00027de0: 2c20 2020 2020 205b 302c 2d31 2c30 5d2c  ,      [0,-1,0],
-00027df0: 2020 2020 2020 5b2d 312c 302c 305d 2c20        [-1,0,0], 
-00027e00: 2020 2020 2020 5b30 2c31 2c30 5d2c 0d0a        [0,1,0],..
-00027e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027e20: 2020 2020 2020 2020 205b 7879 302c 7879           [xy0,xy
-00027e30: 302c 315d 2c20 205b 2d78 7930 2c78 7930  0,1],  [-xy0,xy0
-00027e40: 2c31 5d2c 2020 5b2d 7879 302c 2d78 7930  ,1],  [-xy0,-xy0
-00027e50: 2c31 5d2c 2020 5b78 7930 2c2d 7879 302c  ,1],  [xy0,-xy0,
-00027e60: 315d 2c0d 0a20 2020 2020 2020 2020 2020  1],..           
-00027e70: 2020 2020 2020 2020 2020 2020 2020 5b78                [x
-00027e80: 7930 2c78 7930 2c2d 315d 2c20 5b2d 7879  y0,xy0,-1], [-xy
-00027e90: 302c 7879 302c 2d31 5d2c 205b 2d78 7930  0,xy0,-1], [-xy0
-00027ea0: 2c2d 7879 302c 2d31 5d2c 205b 7879 302c  ,-xy0,-1], [xy0,
-00027eb0: 2d78 7930 2c2d 315d 205d 0d0a 0d0a 2020  -xy0,-1] ]....  
-00027ec0: 2020 2020 2020 2020 2020 6261 7365 4661            baseFa
-00027ed0: 6365 733d 2820 0d0a 2020 2020 2020 2020  ces=( ..        
-00027ee0: 2020 2020 2020 2020 5b31 2c30 2c37 5d2c          [1,0,7],
-00027ef0: 5b32 2c31 2c36 5d2c 5b33 2c32 2c35 5d2c  [2,1,6],[3,2,5],
-00027f00: 5b30 2c33 2c34 5d2c 0d0a 2020 2020 2020  [0,3,4],..      
-00027f10: 2020 2020 2020 2020 2020 5b34 2c33 2c35            [4,3,5
-00027f20: 5d2c 5b35 2c32 2c36 5d2c 5b36 2c31 2c37  ],[5,2,6],[6,1,7
-00027f30: 5d2c 5b37 2c30 2c34 5d2c 0d0a 2020 2020  ],[7,0,4],..    
-00027f40: 2020 2020 2020 2020 2020 2020 5b30 2c38              [0,8
-00027f50: 2c33 5d2c 5b33 2c39 2c32 5d2c 5b32 2c31  ,3],[3,9,2],[2,1
-00027f60: 302c 315d 2c5b 312c 3131 2c30 5d2c 0d0a  0,1],[1,11,0],..
-00027f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027f80: 5b30 2c31 312c 385d 2c5b 332c 382c 395d  [0,11,8],[3,8,9]
-00027f90: 2c5b 322c 392c 3130 5d2c 5b31 2c31 302c  ,[2,9,10],[1,10,
-00027fa0: 3131 5d20 290d 0a0d 0a20 2020 2020 2020  11] )....       
-00027fb0: 2020 2020 2046 6f20 3d20 6c65 6e28 6261       Fo = len(ba
-00027fc0: 7365 4661 6365 7329 0d0a 2020 2020 2020  seFaces)..      
-00027fd0: 2020 2020 2020 7265 7475 726e 207b 2027        return { '
-00027fe0: 6261 7365 4661 6365 496e 6469 6365 7327  baseFaceIndices'
-00027ff0: 203a 2062 6173 6546 6163 6573 202c 2027   : baseFaces , '
-00028000: 6261 7365 5665 7274 6963 6573 436f 6f72  baseVerticesCoor
-00028010: 2720 3a20 6261 7365 5665 7274 2c20 2766  ' : baseVert, 'f
-00028020: 6576 5061 7261 6d27 203a 205b 466f 2c34  evParam' : [Fo,4
-00028030: 2c30 5d20 7d0d 0a0d 0a20 2020 2020 2020  ,0] }....       
-00028040: 2064 6566 2063 6f6e 7374 7275 6374 5f71   def construct_q
-00028050: 7561 6463 796c 696e 6465 725f 7628 2920  uadcylinder_v() 
-00028060: 3a0d 0a20 2020 2020 2020 2020 2020 2076  :..            v
-00028070: 6669 5f64 203d 2063 6f6e 7374 7275 6374  fi_d = construct
-00028080: 5f71 7561 6463 796c 696e 6465 7228 290d  _quadcylinder().
-00028090: 0a20 2020 2020 2020 2020 2020 2062 6173  .            bas
-000280a0: 6556 6572 7420 3d20 2076 6669 5f64 5b27  eVert =  vfi_d['
-000280b0: 6261 7365 5665 7274 6963 6573 436f 6f72  baseVerticesCoor
-000280c0: 275d 0d0a 2020 2020 2020 2020 2020 2020  ']..            
-000280d0: 6261 7365 4661 6365 7320 3d20 7666 695f  baseFaces = vfi_
-000280e0: 645b 2762 6173 6546 6163 6549 6e64 6963  d['baseFaceIndic
-000280f0: 6573 275d 0d0a 2020 2020 2020 2020 2020  es']..          
-00028100: 2020 6261 7365 5665 7274 203d 2062 6173    baseVert = bas
-00028110: 6556 6572 7420 2b20 5b5b 302c 302c 315d  eVert + [[0,0,1]
-00028120: 2c5b 302c 302c 2d31 5d5d 0d0a 2020 2020  ,[0,0,-1]]..    
-00028130: 2020 2020 2020 2020 6261 7365 4661 6365          baseFace
-00028140: 7320 3d20 6c69 7374 2862 6173 6546 6163  s = list(baseFac
-00028150: 6573 290d 0a20 2020 2020 2020 2020 2020  es)..           
-00028160: 2061 6464 4661 6365 7320 3d20 5b20 0d0a   addFaces = [ ..
-00028170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028180: 5b34 2c35 2c31 325d 2c5b 352c 362c 3132  [4,5,12],[5,6,12
-00028190: 5d2c 5b36 2c37 2c31 325d 2c5b 372c 342c  ],[6,7,12],[7,4,
-000281a0: 3132 5d2c 0d0a 2020 2020 2020 2020 2020  12],..          
-000281b0: 2020 2020 2020 5b39 2c38 2c31 335d 2c5b        [9,8,13],[
-000281c0: 3130 2c39 2c31 335d 2c5b 3131 2c31 302c  10,9,13],[11,10,
-000281d0: 3133 5d2c 5b38 2c31 312c 3133 5d20 5d0d  13],[8,11,13] ].
-000281e0: 0a20 2020 2020 2020 2020 2020 2062 6173  .            bas
-000281f0: 6546 6163 6573 203d 2062 6173 6546 6163  eFaces = baseFac
-00028200: 6573 202b 2061 6464 4661 6365 730d 0a20  es + addFaces.. 
-00028210: 2020 2020 2020 2020 2020 2046 6f20 3d20             Fo = 
-00028220: 6c65 6e28 6261 7365 4661 6365 7329 0d0a  len(baseFaces)..
-00028230: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00028240: 726e 207b 2027 6261 7365 4661 6365 496e  rn { 'baseFaceIn
-00028250: 6469 6365 7327 203a 2062 6173 6546 6163  dices' : baseFac
-00028260: 6573 202c 2027 6261 7365 5665 7274 6963  es , 'baseVertic
-00028270: 6573 436f 6f72 2720 3a20 6261 7365 5665  esCoor' : baseVe
-00028280: 7274 2c20 2766 6576 5061 7261 6d27 203a  rt, 'fevParam' :
-00028290: 205b 466f 2c30 2c32 5d20 7d0d 0a0d 0a20   [Fo,0,2] }.... 
-000282a0: 2020 2020 2020 2064 6566 2063 6f6e 7374         def const
-000282b0: 7275 6374 5f71 7561 6432 6379 6c69 6e64  ruct_quad2cylind
-000282c0: 6572 2829 203a 0d0a 2020 2020 2020 2020  er() :..        
-000282d0: 2020 2020 7879 3020 3d20 312e 302f 6e70      xy0 = 1.0/np
-000282e0: 2e73 7172 7428 322e 3029 0d0a 0d0a 2020  .sqrt(2.0)....  
-000282f0: 2020 2020 2020 2020 2020 6261 7365 5665            baseVe
-00028300: 7274 203d 205b 205b 7879 302c 7879 302c  rt = [ [xy0,xy0,
-00028310: 305d 2c20 5b2d 7879 302c 7879 302c 305d  0], [-xy0,xy0,0]
-00028320: 2c20 5b2d 7879 302c 2d78 7930 2c30 5d2c  , [-xy0,-xy0,0],
-00028330: 205b 7879 302c 2d78 7930 2c30 5d2c 0d0a   [xy0,-xy0,0],..
-00028340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028350: 2020 2020 2020 2020 205b 312c 302c 315d           [1,0,1]
-00028360: 2c20 2020 2020 5b30 2c2d 312c 315d 2c20  ,     [0,-1,1], 
-00028370: 2020 2020 5b2d 312c 302c 315d 2c20 2020      [-1,0,1],   
-00028380: 2020 205b 302c 312c 315d 2c0d 0a20 2020     [0,1,1],..   
-00028390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000283a0: 2020 2020 2020 5b31 2c30 2c2d 315d 2c20        [1,0,-1], 
-000283b0: 2020 205b 302c 2d31 2c2d 315d 2c20 2020     [0,-1,-1],   
-000283c0: 205b 2d31 2c30 2c2d 315d 2c20 2020 2020   [-1,0,-1],     
-000283d0: 5b30 2c31 2c2d 315d 205d 0d0a 0d0a 2020  [0,1,-1] ]....  
-000283e0: 2020 2020 2020 2020 2020 6261 7365 4661            baseFa
-000283f0: 6365 733d 2820 0d0a 2020 2020 2020 2020  ces=( ..        
-00028400: 2020 2020 2020 2020 5b30 2c37 2c34 5d2c          [0,7,4],
-00028410: 5b31 2c36 2c37 5d2c 5b32 2c35 2c36 5d2c  [1,6,7],[2,5,6],
-00028420: 5b33 2c34 2c35 5d2c 0d0a 2020 2020 2020  [3,4,5],..      
-00028430: 2020 2020 2020 2020 2020 5b30 2c38 2c31            [0,8,1
-00028440: 315d 2c5b 312c 3131 2c31 305d 2c5b 322c  1],[1,11,10],[2,
-00028450: 3130 2c39 5d2c 5b33 2c39 2c38 5d2c 0d0a  10,9],[3,9,8],..
-00028460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028470: 5b30 2c34 2c38 5d2c 5b31 2c37 2c31 315d  [0,4,8],[1,7,11]
-00028480: 2c5b 322c 362c 3130 5d2c 5b33 2c35 2c39  ,[2,6,10],[3,5,9
-00028490: 5d2c 0d0a 2020 2020 2020 2020 2020 2020  ],..            
-000284a0: 2020 2020 5b30 2c31 312c 375d 2c5b 312c      [0,11,7],[1,
-000284b0: 3130 2c36 5d2c 5b32 2c39 2c35 5d2c 5b33  10,6],[2,9,5],[3
-000284c0: 2c38 2c34 5d20 290d 0a0d 0a20 2020 2020  ,8,4] )....     
-000284d0: 2020 2020 2020 2046 6f20 3d20 6c65 6e28         Fo = len(
-000284e0: 6261 7365 4661 6365 7329 0d0a 2020 2020  baseFaces)..    
-000284f0: 2020 2020 2020 2020 7265 7475 726e 207b          return {
-00028500: 2027 6261 7365 4661 6365 496e 6469 6365   'baseFaceIndice
-00028510: 7327 203a 2062 6173 6546 6163 6573 202c  s' : baseFaces ,
-00028520: 2027 6261 7365 5665 7274 6963 6573 436f   'baseVerticesCo
-00028530: 6f72 2720 3a20 6261 7365 5665 7274 2c20  or' : baseVert, 
-00028540: 2766 6576 5061 7261 6d27 203a 205b 466f  'fevParam' : [Fo
-00028550: 2c34 2c30 5d20 7d0d 0a0d 0a20 2020 2020  ,4,0] }....     
-00028560: 2020 2064 6566 2063 6f6e 7374 7275 6374     def construct
-00028570: 5f71 7561 6432 6379 6c69 6e64 6572 5f76  _quad2cylinder_v
-00028580: 2829 203a 0d0a 2020 2020 2020 2020 2020  () :..          
-00028590: 2020 7666 695f 6420 3d20 636f 6e73 7472    vfi_d = constr
-000285a0: 7563 745f 7175 6164 3263 796c 696e 6465  uct_quad2cylinde
-000285b0: 7228 290d 0a20 2020 2020 2020 2020 2020  r()..           
-000285c0: 2062 6173 6556 6572 7420 3d20 2076 6669   baseVert =  vfi
-000285d0: 5f64 5b27 6261 7365 5665 7274 6963 6573  _d['baseVertices
-000285e0: 436f 6f72 275d 0d0a 2020 2020 2020 2020  Coor']..        
-000285f0: 2020 2020 6261 7365 4661 6365 7320 3d20      baseFaces = 
-00028600: 7666 695f 645b 2762 6173 6546 6163 6549  vfi_d['baseFaceI
-00028610: 6e64 6963 6573 275d 0d0a 2020 2020 2020  ndices']..      
-00028620: 2020 2020 2020 6261 7365 5665 7274 203d        baseVert =
-00028630: 2062 6173 6556 6572 7420 2b20 5b5b 302c   baseVert + [[0,
-00028640: 302c 315d 2c5b 302c 302c 2d31 5d5d 0d0a  0,1],[0,0,-1]]..
-00028650: 2020 2020 2020 2020 2020 2020 6261 7365              base
-00028660: 4661 6365 7320 3d20 6c69 7374 2862 6173  Faces = list(bas
-00028670: 6546 6163 6573 290d 0a20 2020 2020 2020  eFaces)..       
-00028680: 2020 2020 2061 6464 4661 6365 7320 3d20       addFaces = 
-00028690: 5b20 0d0a 2020 2020 2020 2020 2020 2020  [ ..            
-000286a0: 2020 2020 5b35 2c34 2c31 325d 2c5b 362c      [5,4,12],[6,
-000286b0: 352c 3132 5d2c 5b37 2c36 2c31 325d 2c5b  5,12],[7,6,12],[
-000286c0: 342c 372c 3132 5d2c 0d0a 2020 2020 2020  4,7,12],..      
-000286d0: 2020 2020 2020 2020 2020 5b38 2c39 2c31            [8,9,1
-000286e0: 335d 2c5b 392c 3130 2c31 335d 2c5b 3130  3],[9,10,13],[10
-000286f0: 2c31 312c 3133 5d2c 5b31 312c 382c 3133  ,11,13],[11,8,13
-00028700: 5d20 5d0d 0a20 2020 2020 2020 2020 2020  ] ]..           
-00028710: 2062 6173 6546 6163 6573 203d 2062 6173   baseFaces = bas
-00028720: 6546 6163 6573 202b 2061 6464 4661 6365  eFaces + addFace
-00028730: 730d 0a20 2020 2020 2020 2020 2020 2046  s..            F
-00028740: 6f20 3d20 6c65 6e28 6261 7365 4661 6365  o = len(baseFace
-00028750: 7329 0d0a 2020 2020 2020 2020 2020 2020  s)..            
-00028760: 7265 7475 726e 207b 2027 6261 7365 4661  return { 'baseFa
-00028770: 6365 496e 6469 6365 7327 203a 2062 6173  ceIndices' : bas
-00028780: 6546 6163 6573 202c 2027 6261 7365 5665  eFaces , 'baseVe
-00028790: 7274 6963 6573 436f 6f72 2720 3a20 6261  rticesCoor' : ba
-000287a0: 7365 5665 7274 2c20 2766 6576 5061 7261  seVert, 'fevPara
-000287b0: 6d27 203a 205b 466f 2c30 2c32 5d20 7d0d  m' : [Fo,0,2] }.
-000287c0: 0a0d 0a20 2020 2020 2020 2064 6566 2063  ...        def c
-000287d0: 6f6e 7374 7275 6374 5f71 7561 6432 6379  onstruct_quad2cy
-000287e0: 6c69 6e64 6572 5f73 6c69 6365 6428 2920  linder_sliced() 
-000287f0: 3a0d 0a20 2020 2020 2020 2020 2020 2078  :..            x
-00028800: 7930 203d 2031 2e30 2f6e 702e 7371 7274  y0 = 1.0/np.sqrt
-00028810: 2832 2e30 290d 0a20 2020 2020 2020 2020  (2.0)..         
-00028820: 2020 2079 6f66 203d 2030 2e30 3030 310d     yof = 0.0001.
-00028830: 0a0d 0a20 2020 2020 2020 2020 2020 2062  ...            b
-00028840: 6173 6556 6572 7420 3d20 5b20 5b78 7930  aseVert = [ [xy0
-00028850: 2c78 7930 2c30 5d2c 205b 2d78 7930 2c78  ,xy0,0], [-xy0,x
-00028860: 7930 2c30 5d2c 205b 2d78 7930 2c2d 7879  y0,0], [-xy0,-xy
-00028870: 302c 305d 2c20 5b78 7930 2c2d 7879 302c  0,0], [xy0,-xy0,
-00028880: 305d 2c0d 0a20 2020 2020 2020 2020 2020  0],..           
-00028890: 2020 2020 2020 2020 2020 2020 2020 5b31                [1
-000288a0: 2c79 6f66 2c31 5d2c 2020 205b 302c 2d31  ,yof,1],   [0,-1
-000288b0: 2c31 5d2c 2020 2020 205b 2d31 2c30 2c31  ,1],     [-1,0,1
-000288c0: 5d2c 2020 2020 2020 205b 302c 312c 315d  ],       [0,1,1]
-000288d0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-000288e0: 2020 2020 2020 2020 2020 2020 5b31 2c79              [1,y
-000288f0: 6f66 2c2d 315d 2c20 205b 302c 2d31 2c2d  of,-1],  [0,-1,-
-00028900: 315d 2c20 2020 205b 2d31 2c30 2c2d 315d  1],    [-1,0,-1]
-00028910: 2c20 2020 2020 205b 302c 312c 2d31 5d2c  ,      [0,1,-1],
-00028920: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00028930: 2020 2020 2020 2020 2020 205b 312c 2d79             [1,-y
-00028940: 6f66 2c31 5d2c 2020 5b31 2c2d 796f 662c  of,1],  [1,-yof,
-00028950: 2d31 5d20 5d0d 0a0d 0a20 2020 2020 2020  -1] ]....       
-00028960: 2020 2020 2062 6173 6546 6163 6573 3d28       baseFaces=(
-00028970: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-00028980: 2020 205b 302c 372c 345d 2c5b 312c 362c     [0,7,4],[1,6,
-00028990: 375d 2c5b 322c 352c 365d 2c5b 332c 3132  7],[2,5,6],[3,12
-000289a0: 2c35 5d2c 0d0a 2020 2020 2020 2020 2020  ,5],..          
-000289b0: 2020 2020 2020 5b30 2c38 2c31 315d 2c5b        [0,8,11],[
-000289c0: 312c 3131 2c31 305d 2c5b 322c 3130 2c39  1,11,10],[2,10,9
-000289d0: 5d2c 5b33 2c39 2c31 335d 2c0d 0a20 2020  ],[3,9,13],..   
-000289e0: 2020 2020 2020 2020 2020 2020 205b 302c               [0,
-000289f0: 342c 385d 2c5b 312c 372c 3131 5d2c 5b32  4,8],[1,7,11],[2
-00028a00: 2c36 2c31 305d 2c5b 332c 352c 395d 2c0d  ,6,10],[3,5,9],.
-00028a10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00028a20: 205b 302c 3131 2c37 5d2c 5b31 2c31 302c   [0,11,7],[1,10,
-00028a30: 365d 2c5b 322c 392c 355d 2c5b 332c 3133  6],[2,9,5],[3,13
-00028a40: 2c31 325d 2029 0d0a 0d0a 2020 2020 2020  ,12] )....      
-00028a50: 2020 2020 2020 466f 203d 206c 656e 2862        Fo = len(b
-00028a60: 6173 6546 6163 6573 290d 0a20 2020 2020  aseFaces)..     
-00028a70: 2020 2020 2020 2072 6574 7572 6e20 7b20         return { 
-00028a80: 2762 6173 6546 6163 6549 6e64 6963 6573  'baseFaceIndices
-00028a90: 2720 3a20 6261 7365 4661 6365 7320 2c20  ' : baseFaces , 
-00028aa0: 2762 6173 6556 6572 7469 6365 7343 6f6f  'baseVerticesCoo
-00028ab0: 7227 203a 2062 6173 6556 6572 742c 2027  r' : baseVert, '
-00028ac0: 6665 7650 6172 616d 2720 3a20 5b46 6f2c  fevParam' : [Fo,
-00028ad0: 352c 315d 207d 0d0a 0d0a 2020 2020 2020  5,1] }....      
-00028ae0: 2020 6465 6620 636f 6e73 7472 7563 745f    def construct_
-00028af0: 7175 6164 3263 796c 696e 6465 725f 736c  quad2cylinder_sl
-00028b00: 6963 6564 5f76 2829 203a 0d0a 2020 2020  iced_v() :..    
-00028b10: 2020 2020 2020 2020 7666 695f 6420 3d20          vfi_d = 
-00028b20: 636f 6e73 7472 7563 745f 7175 6164 3263  construct_quad2c
-00028b30: 796c 696e 6465 725f 736c 6963 6564 2829  ylinder_sliced()
-00028b40: 0d0a 2020 2020 2020 2020 2020 2020 6261  ..            ba
-00028b50: 7365 5665 7274 203d 2020 7666 695f 645b  seVert =  vfi_d[
-00028b60: 2762 6173 6556 6572 7469 6365 7343 6f6f  'baseVerticesCoo
-00028b70: 7227 5d0d 0a20 2020 2020 2020 2020 2020  r']..           
-00028b80: 2062 6173 6546 6163 6573 203d 2076 6669   baseFaces = vfi
-00028b90: 5f64 5b27 6261 7365 4661 6365 496e 6469  _d['baseFaceIndi
-00028ba0: 6365 7327 5d0d 0a20 2020 2020 2020 2020  ces']..         
-00028bb0: 2020 2062 6173 6556 6572 7420 3d20 6261     baseVert = ba
-00028bc0: 7365 5665 7274 202b 205b 5b30 2c30 2c31  seVert + [[0,0,1
-00028bd0: 5d2c 5b30 2c30 2c2d 315d 5d0d 0a20 2020  ],[0,0,-1]]..   
-00028be0: 2020 2020 2020 2020 2062 6173 6546 6163           baseFac
-00028bf0: 6573 203d 206c 6973 7428 6261 7365 4661  es = list(baseFa
-00028c00: 6365 7329 0d0a 2020 2020 2020 2020 2020  ces)..          
-00028c10: 2020 6164 6446 6163 6573 203d 205b 200d    addFaces = [ .
-00028c20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00028c30: 205b 342c 372c 3134 5d2c 5b37 2c36 2c31   [4,7,14],[7,6,1
-00028c40: 345d 2c5b 362c 352c 3134 5d2c 5b35 2c31  4],[6,5,14],[5,1
-00028c50: 322c 3134 5d2c 0d0a 2020 2020 2020 2020  2,14],..        
-00028c60: 2020 2020 2020 2020 5b31 312c 382c 3135          [11,8,15
-00028c70: 5d2c 5b31 302c 3131 2c31 355d 2c5b 392c  ],[10,11,15],[9,
-00028c80: 3130 2c31 355d 2c5b 3133 2c39 2c31 355d  10,15],[13,9,15]
-00028c90: 205d 0d0a 2020 2020 2020 2020 2020 2020   ]..            
-00028ca0: 6261 7365 4661 6365 7320 3d20 6261 7365  baseFaces = base
-00028cb0: 4661 6365 7320 2b20 6164 6446 6163 6573  Faces + addFaces
-00028cc0: 0d0a 2020 2020 2020 2020 2020 2020 466f  ..            Fo
-00028cd0: 203d 206c 656e 2862 6173 6546 6163 6573   = len(baseFaces
-00028ce0: 290d 0a20 2020 2020 2020 2020 2020 2072  )..            r
-00028cf0: 6574 7572 6e20 7b20 2762 6173 6546 6163  eturn { 'baseFac
-00028d00: 6549 6e64 6963 6573 2720 3a20 6261 7365  eIndices' : base
-00028d10: 4661 6365 7320 2c20 2762 6173 6556 6572  Faces , 'baseVer
-00028d20: 7469 6365 7343 6f6f 7227 203a 2062 6173  ticesCoor' : bas
-00028d30: 6556 6572 742c 2027 6665 7650 6172 616d  eVert, 'fevParam
-00028d40: 2720 3a20 5b46 6f2c 302c 325d 207d 0d0a  ' : [Fo,0,2] }..
-00028d50: 0d0a 2020 2020 2020 2020 7375 7266 6163  ..        surfac
-00028d60: 6573 4469 6374 696f 6e61 7279 5b27 7472  esDictionary['tr
-00028d70: 6927 5d20 3d20 636f 6e73 7472 7563 745f  i'] = construct_
-00028d80: 7472 6963 796c 696e 6465 7228 290d 0a20  tricylinder().. 
-00028d90: 2020 2020 2020 2073 7572 6661 6365 7344         surfacesD
-00028da0: 6963 7469 6f6e 6172 795b 2773 7175 275d  ictionary['squ']
-00028db0: 203d 2063 6f6e 7374 7275 6374 5f71 7561   = construct_qua
-00028dc0: 6463 796c 696e 6465 7228 290d 0a20 2020  dcylinder()..   
-00028dd0: 2020 2020 2073 7572 6661 6365 7344 6963       surfacesDic
-00028de0: 7469 6f6e 6172 795b 2774 7269 3227 5d20  tionary['tri2'] 
-00028df0: 3d20 636f 6e73 7472 7563 745f 7472 6932  = construct_tri2
-00028e00: 6379 6c69 6e64 6572 2829 0d0a 2020 2020  cylinder()..    
-00028e10: 2020 2020 7375 7266 6163 6573 4469 6374      surfacesDict
-00028e20: 696f 6e61 7279 5b27 7371 7532 275d 203d  ionary['squ2'] =
-00028e30: 2063 6f6e 7374 7275 6374 5f71 7561 6432   construct_quad2
-00028e40: 6379 6c69 6e64 6572 2829 0d0a 2020 2020  cylinder()..    
-00028e50: 2020 2020 7375 7266 6163 6573 4469 6374      surfacesDict
-00028e60: 696f 6e61 7279 5b27 7472 695f 7327 5d20  ionary['tri_s'] 
-00028e70: 3d20 636f 6e73 7472 7563 745f 7472 6932  = construct_tri2
-00028e80: 6379 6c69 6e64 6572 5f73 6c69 6365 6428  cylinder_sliced(
-00028e90: 290d 0a20 2020 2020 2020 2073 7572 6661  )..        surfa
-00028ea0: 6365 7344 6963 7469 6f6e 6172 795b 2773  cesDictionary['s
-00028eb0: 7175 5f73 275d 203d 2063 6f6e 7374 7275  qu_s'] = constru
-00028ec0: 6374 5f71 7561 6432 6379 6c69 6e64 6572  ct_quad2cylinder
-00028ed0: 5f73 6c69 6365 6428 290d 0a0d 0a20 2020  _sliced()....   
-00028ee0: 2020 2020 2073 7572 6661 6365 7344 6963       surfacesDic
-00028ef0: 7469 6f6e 6172 795b 2774 7269 5f76 275d  tionary['tri_v']
-00028f00: 203d 2063 6f6e 7374 7275 6374 5f74 7269   = construct_tri
-00028f10: 6379 6c69 6e64 6572 5f76 2829 0d0a 2020  cylinder_v()..  
-00028f20: 2020 2020 2020 7375 7266 6163 6573 4469        surfacesDi
-00028f30: 6374 696f 6e61 7279 5b27 7371 755f 7627  ctionary['squ_v'
-00028f40: 5d20 3d20 636f 6e73 7472 7563 745f 7175  ] = construct_qu
-00028f50: 6164 6379 6c69 6e64 6572 5f76 2829 0d0a  adcylinder_v()..
-00028f60: 2020 2020 2020 2020 7375 7266 6163 6573          surfaces
-00028f70: 4469 6374 696f 6e61 7279 5b27 7472 6932  Dictionary['tri2
-00028f80: 5f76 275d 203d 2063 6f6e 7374 7275 6374  _v'] = construct
-00028f90: 5f74 7269 3263 796c 696e 6465 725f 7628  _tri2cylinder_v(
-00028fa0: 290d 0a20 2020 2020 2020 2073 7572 6661  )..        surfa
-00028fb0: 6365 7344 6963 7469 6f6e 6172 795b 2773  cesDictionary['s
-00028fc0: 7175 325f 7627 5d20 3d20 636f 6e73 7472  qu2_v'] = constr
-00028fd0: 7563 745f 7175 6164 3263 796c 696e 6465  uct_quad2cylinde
-00028fe0: 725f 7628 290d 0a20 2020 2020 2020 2073  r_v()..        s
-00028ff0: 7572 6661 6365 7344 6963 7469 6f6e 6172  urfacesDictionar
-00029000: 795b 2774 7269 5f73 7627 5d20 3d20 636f  y['tri_sv'] = co
-00029010: 6e73 7472 7563 745f 7472 6932 6379 6c69  nstruct_tri2cyli
-00029020: 6e64 6572 5f73 6c69 6365 645f 7628 290d  nder_sliced_v().
-00029030: 0a20 2020 2020 2020 2073 7572 6661 6365  .        surface
-00029040: 7344 6963 7469 6f6e 6172 795b 2773 7175  sDictionary['squ
-00029050: 5f73 7627 5d20 3d20 636f 6e73 7472 7563  _sv'] = construc
-00029060: 745f 7175 6164 3263 796c 696e 6465 725f  t_quad2cylinder_
-00029070: 736c 6963 6564 5f76 2829 0d0a 2020 2020  sliced_v()..    
-00029080: 2020 2020 7265 7475 726e 2073 7572 6661      return surfa
-00029090: 6365 7344 6963 7469 6f6e 6172 790d 0a20  cesDictionary.. 
-000290a0: 2020 200d 0a20 2020 2040 7374 6174 6963     ..    @static
-000290b0: 6d65 7468 6f64 0d0a 2020 2020 6465 6620  method..    def 
-000290c0: 5f6d 6964 5665 6374 6f72 4675 6e28 7665  _midVectorFun(ve
-000290d0: 6374 412c 2076 6563 7442 2920 3a20 200d  ctA, vectB) :  .
-000290e0: 0a20 2020 2020 2020 2022 2222 4d69 642d  .        """Mid-
-000290f0: 706f 696e 7420 6265 7477 6565 6e20 7477  point between tw
-00029100: 6f20 706f 696e 7473 206f 6e20 6120 756e  o points on a un
-00029110: 6974 2063 796c 696e 6465 722e 2222 220d  it cylinder.""".
-00029120: 0a20 2020 2020 2020 206d 6964 203d 206e  .        mid = n
-00029130: 702e 6164 6428 7665 6374 412c 7665 6374  p.add(vectA,vect
-00029140: 4229 0d0a 2020 2020 2020 2020 6d69 6420  B)..        mid 
-00029150: 3d20 6e70 2e6d 756c 7469 706c 7928 302e  = np.multiply(0.
-00029160: 352c 6d69 6429 0d0a 2020 2020 2020 2020  5,mid)..        
-00029170: 7a20 3d20 6e70 2e64 6f74 286d 6964 2c5b  z = np.dot(mid,[
-00029180: 302c 302c 315d 290d 0a20 2020 2020 2020  0,0,1])..       
-00029190: 2076 203d 206e 702e 7375 6274 7261 6374   v = np.subtract
-000291a0: 286d 6964 2c5b 302c 302c 7a5d 290d 0a20  (mid,[0,0,z]).. 
-000291b0: 2020 2020 2020 2078 7920 3d20 2076 2f6e         xy =  v/n
-000291c0: 702e 6c69 6e61 6c67 2e6e 6f72 6d28 7629  p.linalg.norm(v)
-000291d0: 0d0a 2020 2020 2020 2020 2320 7879 2069  ..        # xy i
-000291e0: 7320 756e 6974 2076 6563 746f 7220 6174  s unit vector at
-000291f0: 2063 796c 696e 6465 7220 7261 6469 7573   cylinder radius
-00029200: 2c20 6275 740d 0a20 2020 2020 2020 2023  , but..        #
-00029210: 2069 7320 6176 6572 6167 6520 6f66 2072   is average of r
-00029220: 6164 6975 7320 666f 7220 746f 7020 2620  adius for top & 
-00029230: 626f 7474 6f6d 2066 6163 6573 2e0d 0a20  bottom faces... 
-00029240: 2020 2020 2020 207a 4120 3d20 6e70 2e64         zA = np.d
-00029250: 6f74 2876 6563 7441 2c5b 302c 302c 315d  ot(vectA,[0,0,1]
-00029260: 290d 0a20 2020 2020 2020 2076 4120 3d20  )..        vA = 
-00029270: 6e70 2e73 7562 7472 6163 7428 7665 6374  np.subtract(vect
-00029280: 412c 5b30 2c30 2c7a 415d 290d 0a20 2020  A,[0,0,zA])..   
-00029290: 2020 2020 207a 4220 3d20 6e70 2e64 6f74       zB = np.dot
-000292a0: 2876 6563 7442 2c5b 302c 302c 315d 290d  (vectB,[0,0,1]).
-000292b0: 0a20 2020 2020 2020 2076 4220 3d20 6e70  .        vB = np
-000292c0: 2e73 7562 7472 6163 7428 7665 6374 422c  .subtract(vectB,
-000292d0: 5b30 2c30 2c7a 425d 290d 0a20 2020 2020  [0,0,zB])..     
-000292e0: 2020 2061 203d 2028 206e 702e 6c69 6e61     a = ( np.lina
-000292f0: 6c67 2e6e 6f72 6d28 7641 2920 2b20 6e70  lg.norm(vA) + np
-00029300: 2e6c 696e 616c 672e 6e6f 726d 2876 4229  .linalg.norm(vB)
-00029310: 2029 2f32 2e30 0d0a 2020 2020 2020 2020   )/2.0..        
-00029320: 7879 203d 2020 612a 7879 0d0a 2020 2020  xy =  a*xy..    
-00029330: 2020 2020 7265 7475 726e 206e 702e 6164      return np.ad
-00029340: 6428 7879 2c5b 302c 302c 7a5d 290d 0a0d  d(xy,[0,0,z])...
-00029350: 0a20 2020 2040 7374 6174 6963 6d65 7468  .    @staticmeth
-00029360: 6f64 0d0a 2020 2020 6465 6620 5f6d 6170  od..    def _map
-00029370: 3344 746f 3244 7371 7561 7265 2878 797a  3Dto2Dsquare(xyz
-00029380: 2920 3a0d 0a20 2020 2020 2020 2022 2222  ) :..        """
-00029390: 4f76 6572 7269 6465 206d 6170 2073 7572  Override map sur
-000293a0: 6661 6365 2074 6f20 7265 6374 6167 756c  face to rectagul
-000293b0: 6172 2075 6e69 7420 636f 6f72 6469 6e61  ar unit coordina
-000293c0: 7465 7320 2830 2c31 292e 2222 220d 0a20  tes (0,1).""".. 
-000293d0: 2020 2020 2020 2078 2c79 2c7a 203d 2078         x,y,z = x
-000293e0: 797a 0d0a 2020 2020 2020 2020 7468 6574  yz..        thet
-000293f0: 6120 3d20 6e70 2e61 7263 7461 6e32 2879  a = np.arctan2(y
-00029400: 2c78 290d 0a20 2020 2020 2020 2074 6865  ,x)..        the
-00029410: 7461 203d 206e 702e 7768 6572 6528 2074  ta = np.where( t
-00029420: 6865 7461 3c30 2c20 322e 302a 6e70 2e70  heta<0, 2.0*np.p
-00029430: 6920 2b20 7468 6574 6120 2c74 6865 7461  i + theta ,theta
-00029440: 290d 0a20 2020 2020 2020 2061 203d 2074  )..        a = t
-00029450: 6865 7461 2f28 322a 6e70 2e70 6929 0d0a  heta/(2*np.pi)..
-00029460: 2020 2020 2020 2020 6220 3d20 207a 2f32          b =  z/2
-00029470: 202b 2030 2e35 200d 0a20 2020 2020 2020   + 0.5 ..       
-00029480: 2061 203d 206e 702e 636c 6970 2861 2c30   a = np.clip(a,0
-00029490: 2e30 2c31 2e30 2920 0d0a 2020 2020 2020  .0,1.0) ..      
-000294a0: 2020 6220 3d20 6e70 2e63 6c69 7028 622c    b = np.clip(b,
-000294b0: 302e 302c 312e 3029 200d 0a20 2020 2020  0.0,1.0) ..     
-000294c0: 2020 2072 6574 7572 6e20 5b61 2c62 5d0d     return [a,b].
-000294d0: 0a0d 0a20 2020 2040 7374 6174 6963 6d65  ...    @staticme
-000294e0: 7468 6f64 0d0a 2020 2020 6465 6620 636f  thod..    def co
-000294f0: 6f72 5f63 6f6e 7665 7274 2878 797a 2c20  or_convert(xyz, 
-00029500: 746f 6361 7274 3d46 616c 7365 2920 3a0d  tocart=False) :.
-00029510: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
-00029520: 2020 2020 2020 4f76 6572 7269 6465 2063        Override c
-00029530: 6f6f 7264 696e 6174 6520 7472 616e 7366  oordinate transf
-00029540: 6f72 6d61 7469 6f6e 2e0d 0a0d 0a20 2020  ormation.....   
-00029550: 2020 2020 2054 7261 6e73 666f 726d 6174       Transformat
-00029560: 696f 6e20 6265 7477 6565 6e20 6379 6c69  ion between cyli
-00029570: 6e64 7269 6361 6c20 616e 6420 4361 7274  ndrical and Cart
-00029580: 6573 6961 6e20 636f 6f72 6469 6e61 7465  esian coordinate
-00029590: 732e 0d0a 2020 2020 2020 2020 5468 6520  s...        The 
-000295a0: 616e 6775 6c61 7220 636f 6f72 6469 6e61  angular coordina
-000295b0: 7465 2069 7320 696e 2072 6164 6961 6e73  te is in radians
-000295c0: 2077 6974 6820 646f 6d61 696e 2030 2074   with domain 0 t
-000295d0: 6f20 3270 692e 0d0a 0d0a 2020 2020 2020  o 2pi.....      
-000295e0: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
-000295f0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00029600: 0d0a 2020 2020 2020 2020 7879 7a20 3a20  ..        xyz : 
-00029610: 3378 4e0d 0a20 2020 2020 2020 2020 2020  3xN..           
-00029620: 204e 206e 756d 6265 7220 6f66 2076 6563   N number of vec
-00029630: 746f 7273 2069 6e20 6569 7468 6572 2063  tors in either c
-00029640: 796c 696e 6472 6963 616c 206f 7220 6361  ylindrical or ca
-00029650: 7274 6573 6961 6e20 636f 6f72 6469 6e61  rtesian coordina
-00029660: 7465 732c 0d0a 2020 2020 2020 2020 2020  tes,..          
-00029670: 2020 696e 636c 7564 696e 6720 7468 6520    including the 
-00029680: 7a20 636f 6f72 6469 6e61 7465 2820 7768  z coordinate( wh
-00029690: 6963 6820 7265 6d61 696e 7320 756e 6368  ich remains unch
-000296a0: 616e 6765 6429 2e0d 0a0d 0a20 2020 2020  anged).....     
-000296b0: 2020 2074 6f63 6172 7420 3a20 7b20 5472     tocart : { Tr
-000296c0: 7565 2c20 4661 6c73 6520 7d2c 2064 6566  ue, False }, def
-000296d0: 6175 6c74 3a20 4661 6c73 650d 0a20 2020  ault: False..   
-000296e0: 2020 2020 2020 2020 2049 6620 5472 7565           If True
-000296f0: 2c20 696e 7075 7420 6973 2063 796c 696e  , input is cylin
-00029700: 6472 6963 616c 2061 6e64 206f 7574 7075  drical and outpu
-00029710: 7420 6973 2063 6172 7465 7369 616e 2e0d  t is cartesian..
-00029720: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
-00029730: 4661 6c73 652c 2069 6e70 7574 2069 7320  False, input is 
-00029740: 6361 7274 6573 6961 6e20 616e 6420 6f75  cartesian and ou
-00029750: 7470 7574 2069 7320 6379 6c69 6e64 7269  tput is cylindri
-00029760: 6361 6c2e 0d0a 0d0a 2020 2020 2020 2020  cal.....        
-00029770: 5265 7475 726e 730d 0a20 2020 2020 2020  Returns..       
-00029780: 202d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020   -------..      
-00029790: 2020 6c69 7374 3a20 3378 4e20 6172 7261    list: 3xN arra
-000297a0: 790d 0a20 2020 2020 2020 2020 2020 2054  y..            T
-000297b0: 7261 6e73 666f 726d 6564 2063 6f6f 7264  ransformed coord
-000297c0: 696e 6174 6573 2e20 0d0a 0d0a 2020 2020  inates. ....    
-000297d0: 2020 2020 2222 220d 0a0d 0a20 2020 2020      """....     
-000297e0: 2020 2069 6620 746f 6361 7274 203a 0d0a     if tocart :..
-000297f0: 2020 2020 2020 2020 2020 2020 722c 2074              r, t
-00029800: 6865 7461 2c20 7a20 3d20 7879 7a0d 0a20  heta, z = xyz.. 
-00029810: 2020 2020 2020 2020 2020 2078 203d 2072             x = r
-00029820: 202a 206e 702e 636f 7328 7468 6574 6129   * np.cos(theta)
-00029830: 0d0a 2020 2020 2020 2020 2020 2020 7920  ..            y 
-00029840: 3d20 7220 2a20 6e70 2e73 696e 2874 6865  = r * np.sin(the
-00029850: 7461 290d 0a20 2020 2020 2020 2020 2020  ta)..           
-00029860: 2061 6263 203d 205b 782c 792c 7a5d 0d0a   abc = [x,y,z]..
-00029870: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-00029880: 2020 2020 2020 2020 2020 2078 2c79 2c7a             x,y,z
-00029890: 203d 2078 797a 0d0a 2020 2020 2020 2020   = xyz..        
-000298a0: 2020 2020 5220 3d20 6e70 2e73 7172 7428      R = np.sqrt(
-000298b0: 2078 2a78 202b 2079 2a79 2029 0d0a 2020   x*x + y*y )..  
-000298c0: 2020 2020 2020 2020 2020 7468 6574 6120            theta 
-000298d0: 3d20 6e70 2e61 7263 7461 6e32 2879 2c78  = np.arctan2(y,x
-000298e0: 290d 0a20 2020 2020 2020 2020 2020 2074  )..            t
-000298f0: 6865 7461 203d 206e 702e 7768 6572 6528  heta = np.where(
-00029900: 7468 6574 613c 302c 7468 6574 612b 322a  theta<0,theta+2*
-00029910: 6e70 2e70 692c 7468 6574 6129 0d0a 2020  np.pi,theta)..  
-00029920: 2020 2020 2020 2020 2020 6162 6320 3d20            abc = 
-00029930: 5b52 2c74 6865 7461 2c7a 5d0d 0a20 2020  [R,theta,z]..   
-00029940: 2020 2020 2061 6263 203d 206e 702e 6172       abc = np.ar
-00029950: 7261 7928 6162 6329 0d0a 2020 2020 2020  ray(abc)..      
-00029960: 2020 7265 7475 726e 2061 6263 0d0a 0d0a    return abc....
-00029970: 2020 2020 5f62 6173 655f 7375 7266 6163      _base_surfac
-00029980: 6573 203d 205f 6765 745f 6379 6c69 6e64  es = _get_cylind
-00029990: 7269 6361 6c5f 7375 7266 6163 6573 5f64  rical_surfaces_d
-000299a0: 6963 7469 6f6e 6172 792e 5f5f 6675 6e63  ictionary.__func
-000299b0: 5f5f 2829 0d0a 2020 2020 5f64 6566 6175  __()..    _defau
-000299c0: 6c74 5f62 6173 6520 3d20 2774 7269 2720  lt_base = 'tri' 
-000299d0: 2023 2064 6566 6175 6c74 2061 7373 6967   # default assig
-000299e0: 6e6d 656e 7420 6973 2069 6e64 6963 6174  nment is indicat
-000299f0: 6564 2069 6e20 5f5f 696e 6974 2044 6f63  ed in __init Doc
-00029a00: 7374 7269 6e67 2e0d 0a20 2020 205f 6765  string...    _ge
-00029a10: 6f6d 5479 7065 203d 205f 434f 4f52 5359  omType = _COORSY
-00029a20: 535b 2743 594c 494e 4452 4943 414c 275d  S['CYLINDRICAL']
-00029a30: 0d0a 0d0a 2020 2020 4063 6c61 7373 6d65  ....    @classme
-00029a40: 7468 6f64 0d0a 2020 2020 6465 6620 5f63  thod..    def _c
-00029a50: 796c 5f76 6f6c 5f73 7175 6172 655f 6e65  yl_vol_square_ne
-00029a60: 7428 636c 732c 206e 756d 5a2c 206e 756d  t(cls, numZ, num
-00029a70: 552c 2062 6173 6574 7970 652c 6d69 6e52  U, basetype,minR
-00029a80: 6164 2c20 7370 6c69 7453 697a 652c 206e  ad, splitSize, n
-00029a90: 756d 522c 206e 616d 653d 4e6f 6e65 2c20  umR, name=None, 
-00029aa0: 2a2a 6b77 6172 6773 2920 3a0d 0a20 2020  **kwargs) :..   
-00029ab0: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
-00029ac0: 2020 6d65 7468 6f64 206f 6e6c 7920 6361    method only ca
-00029ad0: 6c6c 6564 2062 7920 7468 6520 4379 6c69  lled by the Cyli
-00029ae0: 6e64 6572 5375 7266 6163 6520 636c 6173  nderSurface clas
-00029af0: 736d 6574 686f 6420 6772 6964 204f 4e4c  smethod grid ONL
-00029b00: 5920 666f 7220 766f 6c75 6d65 2063 796c  Y for volume cyl
-00029b10: 696e 6465 7220 6f62 6a65 6374 732e 0d0a  inder objects...
-00029b20: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
-00029b30: 2020 2020 2023 2044 6576 4e6f 7465 3a20       # DevNote: 
-00029b40: 2074 6869 7320 6d65 7468 6f64 2075 7365   this method use
-00029b50: 7320 7468 6520 7361 6d65 2061 6c67 6f72  s the same algor
-00029b60: 6974 686d 2061 7320 7468 6520 6261 7365  ithm as the base
-00029b70: 2063 6c61 7373 205f 7371 7561 7265 5f6e   class _square_n
-00029b80: 6574 2063 6c61 7373 6d65 7468 6f64 2e0d  et classmethod..
-00029b90: 0a20 2020 2020 2020 2023 2020 2020 2020  .        #      
-00029ba0: 2020 2020 2054 6869 7320 7761 7320 646f       This was do
-00029bb0: 6e65 2074 6f20 7369 6d70 6c69 6679 2074  ne to simplify t
-00029bc0: 6865 2063 6f64 6520 666f 7220 7468 6973  he code for this
-00029bd0: 2073 7065 6369 616c 2063 6173 6520 7261   special case ra
-00029be0: 7468 6572 2074 6861 6e0d 0a20 2020 2020  ther than..     
-00029bf0: 2020 2023 2020 2020 2020 2020 2020 2061     #           a
-00029c00: 6464 2061 6464 6974 696f 6e61 6c20 2763  dd additional 'c
-00029c10: 6f6e 766f 6c75 7465 6427 206c 6f67 6963  onvoluted' logic
-00029c20: 2074 6f20 7468 6520 5f73 7175 6172 655f   to the _square_
-00029c30: 6e65 7420 6d65 7468 6f64 2e20 200d 0a20  net method.  .. 
-00029c40: 2020 2020 2020 2023 2020 2020 2020 2020         #        
-00029c50: 2020 2046 6f72 2074 6869 7320 6361 7365     For this case
-00029c60: 2c20 7468 6520 616c 676f 7269 7468 6d20  , the algorithm 
-00029c70: 636f 6d62 696e 6573 206f 6e65 2063 796c  combines one cyl
-00029c80: 696e 6472 6963 616c 2061 6e64 2074 776f  indrical and two
-00029c90: 2070 6f6c 6172 2067 7269 6473 2e0d 0a0d   polar grids....
-00029ca0: 0a20 2020 2020 2020 2023 204e 6f74 653a  .        # Note:
-00029cb0: 206e 756d 5820 616e 6420 6e75 6d5f 5820   numX and num_X 
-00029cc0: 6172 6520 7468 6520 6e75 6d62 6572 206f  are the number o
-00029cd0: 6620 6469 7669 7369 6f6e 7320 616e 6420  f divisions and 
-00029ce0: 7468 6520 6e75 6d62 6572 206f 6620 636f  the number of co
-00029cf0: 6f72 2070 6f73 6974 696f 6e73 2e0d 0a20  or positions... 
-00029d00: 2020 2020 2020 2069 6620 6e75 6d52 2069         if numR i
-00029d10: 7320 4e6f 6e65 203a 2020 6e75 6d52 203d  s None :  numR =
-00029d20: 2069 6e74 2828 6e75 6d5a 2b31 292f 3229   int((numZ+1)/2)
-00029d30: 0d0a 2020 2020 2020 2020 6966 2062 6173  ..        if bas
-00029d40: 6574 7970 6520 6973 204e 6f6e 6520 3a20  etype is None : 
-00029d50: 6261 7365 7479 7065 203d 2027 6427 0d0a  basetype = 'd'..
-00029d60: 2020 2020 2020 2020 6966 206d 696e 5261          if minRa
-00029d70: 6420 6973 204e 6f6e 6520 3a20 6d69 6e52  d is None : minR
-00029d80: 6164 203d 205f 4d49 4e52 4144 0d0a 2020  ad = _MINRAD..  
-00029d90: 2020 2020 2020 6966 2073 706c 6974 5369        if splitSi
-00029da0: 7a65 2069 7320 4e6f 6e65 203a 2073 706c  ze is None : spl
-00029db0: 6974 5369 7a65 203d 205f 5350 4c49 5453  itSize = _SPLITS
-00029dc0: 495a 450d 0a20 2020 2020 2020 200d 0a20  IZE..        .. 
-00029dd0: 2020 2020 2020 2062 6173 6574 7970 6520         basetype 
-00029de0: 3d20 6261 7365 7479 7065 2e6c 6f77 6572  = basetype.lower
-00029df0: 2829 0d0a 2020 2020 2020 2020 6261 7365  ()..        base
-00029e00: 6c69 7374 203d 205b 2764 272c 2773 272c  list = ['d','s',
-00029e10: 2771 272c 2777 272c 2772 272c 2778 275d  'q','w','r','x']
-00029e20: 0d0a 2020 2020 2020 2020 6966 2062 6173  ..        if bas
-00029e30: 6574 7970 6520 6e6f 7420 696e 2062 6173  etype not in bas
-00029e40: 656c 6973 7420 3a0d 0a20 2020 2020 2020  elist :..       
-00029e50: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-00029e60: 4572 726f 7228 2247 7269 6420 6261 7365  Error("Grid base
-00029e70: 7479 7065 2027 7b7d 2720 6973 206e 6f74  type '{}' is not
-00029e80: 2072 6563 6f67 6e69 7a65 642e 2050 6f73   recognized. Pos
-00029e90: 7369 626c 6520 7661 6c75 6573 2061 7265  sible values are
-00029ea0: 3a20 7b7d 2e22 2e66 6f72 6d61 7428 6261  : {}.".format(ba
-00029eb0: 7365 7479 7065 2c6c 6973 7428 6261 7365  setype,list(base
-00029ec0: 6c69 7374 2929 290d 0a0d 0a20 2020 2020  list)))....     
-00029ed0: 2020 2069 7353 706c 6974 203d 2028 6261     isSplit = (ba
-00029ee0: 7365 7479 7065 203d 3d20 2773 2729 206f  setype == 's') o
-00029ef0: 7220 2862 6173 6574 7970 6520 3d3d 2027  r (basetype == '
-00029f00: 7727 2920 6f72 2028 6261 7365 7479 7065  w') or (basetype
-00029f10: 203d 3d20 2778 2729 0d0a 2020 2020 2020   == 'x')..      
-00029f20: 2020 6e65 6564 7354 7269 6167 203d 206e    needsTriag = n
-00029f30: 6f74 2028 2028 6261 7365 7479 7065 203d  ot ( (basetype =
-00029f40: 3d20 2772 2729 206f 7220 2862 6173 6574  = 'r') or (baset
-00029f50: 7970 6520 3d3d 2027 7827 2920 2029 0d0a  ype == 'x')  )..
-00029f60: 2020 2020 2020 2020 6861 7343 656e 7465          hasCente
-00029f70: 7220 3d20 2862 6173 6574 7970 6520 3d3d  r = (basetype ==
-00029f80: 2027 6427 2920 6f72 2028 6261 7365 7479   'd') or (basety
-00029f90: 7065 203d 3d20 2773 2729 0d0a 0d0a 2020  pe == 's')....  
-00029fa0: 2020 2020 2020 2320 5420 616e 676c 6520        # T angle 
-00029fb0: 7261 6e67 6573 2020 202e 2e2e 2e2e 0d0a  ranges   .......
-00029fc0: 2020 2020 2020 2020 6e75 6d5f 5520 3d20          num_U = 
-00029fd0: 6e75 6d55 2b31 2069 6620 6973 5370 6c69  numU+1 if isSpli
-00029fe0: 7420 656c 7365 206e 756d 550d 0a20 2020  t else numU..   
-00029ff0: 2020 2020 206d 696e 5f55 203d 2030 2e30       min_U = 0.0
-0002a000: 0d0a 2020 2020 2020 2020 6d61 785f 5520  ..        max_U 
-0002a010: 3d20 2831 2d31 2f6e 756d 5f55 292a 322a  = (1-1/num_U)*2*
-0002a020: 6e70 2e70 690d 0a20 2020 2020 2020 2069  np.pi..        i
-0002a030: 6620 6973 5370 6c69 7420 3a20 6d61 785f  f isSplit : max_
-0002a040: 5520 3d20 2832 2d73 706c 6974 5369 7a65  U = (2-splitSize
-0002a050: 292a 6e70 2e70 690d 0a20 2020 2020 2020  )*np.pi..       
-0002a060: 2063 6f6f 725f 5520 3d20 6e70 2e6c 696e   coor_U = np.lin
-0002a070: 7370 6163 6528 6d69 6e5f 552c 6d61 785f  space(min_U,max_
-0002a080: 552c 6e75 6d5f 5529 0d0a 0d0a 2020 2020  U,num_U)....    
-0002a090: 2020 2020 2320 5220 6469 736b 2072 616e      # R disk ran
-0002a0a0: 6765 7320 2e2e 2e2e 2e2e 2e2e 0d0a 2020  ges ..........  
-0002a0b0: 2020 2020 2020 6966 2068 6173 4365 6e74        if hasCent
-0002a0c0: 6572 203a 0d0a 2020 2020 2020 2020 2020  er :..          
-0002a0d0: 2020 6e75 6d5f 522c 696e 6e5f 5220 3d20    num_R,inn_R = 
-0002a0e0: 6e75 6d52 2d31 2c20 312e 302f 6e75 6d52  numR-1, 1.0/numR
-0002a0f0: 0d0a 2020 2020 2020 2020 2020 2020 6f75  ..            ou
-0002a100: 745f 5220 3d20 312e 302d 2831 2e30 2f6e  t_R = 1.0-(1.0/n
-0002a110: 756d 5229 0d0a 2020 2020 2020 2020 656c  umR)..        el
-0002a120: 7365 203a 0d0a 2020 2020 2020 2020 2020  se :..          
-0002a130: 2020 6e75 6d5f 522c 696e 6e5f 5220 3d20    num_R,inn_R = 
-0002a140: 6e75 6d52 2c20 2020 6d69 6e52 6164 0d0a  numR,   minRad..
-0002a150: 2020 2020 2020 2020 2020 2020 6f75 745f              out_
-0002a160: 5220 3d20 312e 302d 2831 2e30 2f6e 756d  R = 1.0-(1.0/num
-0002a170: 5229 202b 206d 696e 5261 642f 6e75 6d52  R) + minRad/numR
-0002a180: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-0002a190: 2020 2020 636f 6f72 5f52 5f62 6f74 203d      coor_R_bot =
-0002a1a0: 206e 702e 6c69 6e73 7061 6365 2869 6e6e   np.linspace(inn
-0002a1b0: 5f52 2c6f 7574 5f52 2c20 6e75 6d5f 5229  _R,out_R, num_R)
-0002a1c0: 0d0a 2020 2020 2020 2020 636f 6f72 5f52  ..        coor_R
-0002a1d0: 5f6d 6964 203d 206e 702e 6675 6c6c 286e  _mid = np.full(n
-0002a1e0: 756d 5a2b 312c 312e 3029 0d0a 2020 2020  umZ+1,1.0)..    
-0002a1f0: 2020 2020 636f 6f72 5f52 5f74 6f70 203d      coor_R_top =
-0002a200: 206e 702e 6c69 6e73 7061 6365 286f 7574   np.linspace(out
-0002a210: 5f52 2c69 6e6e 5f52 2c20 6e75 6d5f 5229  _R,inn_R, num_R)
-0002a220: 0d0a 2020 2020 2020 2020 6e75 6d5f 5a20  ..        num_Z 
-0002a230: 3d20 6e75 6d5a 2b31 0d0a 2020 2020 2020  = numZ+1..      
-0002a240: 2020 636f 6f72 5f5a 5f62 6f74 203d 206e    coor_Z_bot = n
-0002a250: 702e 6675 6c6c 286e 756d 5f52 2c2d 312e  p.full(num_R,-1.
-0002a260: 3029 0d0a 2020 2020 2020 2020 636f 6f72  0)..        coor
-0002a270: 5f5a 5f6d 6964 203d 206e 702e 6c69 6e73  _Z_mid = np.lins
-0002a280: 7061 6365 282d 312e 302c 312e 302c 6e75  pace(-1.0,1.0,nu
-0002a290: 6d5f 5a29 0d0a 2020 2020 2020 2020 636f  m_Z)..        co
-0002a2a0: 6f72 5f5a 5f74 6f70 203d 206e 702e 6675  or_Z_top = np.fu
-0002a2b0: 6c6c 286e 756d 5f52 2c20 312e 3029 0d0a  ll(num_R, 1.0)..
-0002a2c0: 0d0a 2020 2020 2020 2020 636f 6f72 5f52  ..        coor_R
-0002a2d0: 203d 206e 702e 636f 6e63 6174 656e 6174   = np.concatenat
-0002a2e0: 6528 2028 636f 6f72 5f52 5f62 6f74 2c63  e( (coor_R_bot,c
-0002a2f0: 6f6f 725f 525f 6d69 642c 636f 6f72 5f52  oor_R_mid,coor_R
-0002a300: 5f74 6f70 292c 6178 6973 3d30 290d 0a20  _top),axis=0).. 
-0002a310: 2020 2020 2020 2063 6f6f 725f 5a20 3d20         coor_Z = 
-0002a320: 6e70 2e63 6f6e 6361 7465 6e61 7465 2820  np.concatenate( 
-0002a330: 2863 6f6f 725f 5a5f 626f 742c 636f 6f72  (coor_Z_bot,coor
-0002a340: 5f5a 5f6d 6964 2c63 6f6f 725f 5a5f 746f  _Z_mid,coor_Z_to
-0002a350: 7029 2c61 7869 733d 3029 0d0a 2020 2020  p),axis=0)..    
-0002a360: 2020 2020 0d0a 2020 2020 2020 2020 6e75      ..        nu
-0002a370: 6d56 203d 2032 2a6e 756d 5220 2b20 6e75  mV = 2*numR + nu
-0002a380: 6d5a 0d0a 2020 2020 2020 2020 6e75 6d5f  mZ..        num_
-0002a390: 5620 3d20 322a 6e75 6d5f 5220 2b20 6e75  V = 2*num_R + nu
-0002a3a0: 6d5f 5a0d 0a20 2020 2020 2020 2074 6f74  m_Z..        tot
-0002a3b0: 5665 7274 7320 3d20 6e75 6d5f 552a 6e75  Verts = num_U*nu
-0002a3c0: 6d5f 560d 0a0d 0a20 2020 2020 2020 2055  m_V....        U
-0002a3d0: 5f63 6f6f 7220 3d20 6e70 2e74 696c 6528  _coor = np.tile(
-0002a3e0: 636f 6f72 5f55 2c6e 756d 5f56 290d 0a20  coor_U,num_V).. 
-0002a3f0: 2020 2020 2020 2052 5f63 6f6f 7220 3d20         R_coor = 
-0002a400: 6e70 2e74 696c 6528 636f 6f72 5f52 2c28  np.tile(coor_R,(
-0002a410: 6e75 6d5f 552c 3129 290d 0a20 2020 2020  num_U,1))..     
-0002a420: 2020 2052 5f63 6f6f 7220 3d20 6e70 2e72     R_coor = np.r
-0002a430: 6176 656c 2852 5f63 6f6f 722c 6f72 6465  avel(R_coor,orde
-0002a440: 723d 2746 2729 0d0a 2020 2020 2020 2020  r='F')..        
-0002a450: 5a5f 636f 6f72 203d 206e 702e 7469 6c65  Z_coor = np.tile
-0002a460: 2863 6f6f 725f 5a2c 286e 756d 5f55 2c31  (coor_Z,(num_U,1
-0002a470: 2929 0d0a 2020 2020 2020 2020 5a5f 636f  ))..        Z_co
-0002a480: 6f72 203d 206e 702e 7261 7665 6c28 5a5f  or = np.ravel(Z_
-0002a490: 636f 6f72 2c6f 7264 6572 3d27 4627 290d  coor,order='F').
-0002a4a0: 0a0d 0a20 2020 2020 2020 2061 6263 203d  ...        abc =
-0002a4b0: 206e 702e 6172 7261 7928 5b52 5f63 6f6f   np.array([R_coo
-0002a4c0: 722c 555f 636f 6f72 2c5a 5f63 6f6f 725d  r,U_coor,Z_coor]
-0002a4d0: 290d 0a20 2020 2020 2020 2078 797a 203d  )..        xyz =
-0002a4e0: 2043 796c 696e 6472 6963 616c 5375 7266   CylindricalSurf
-0002a4f0: 6163 652e 636f 6f72 5f63 6f6e 7665 7274  ace.coor_convert
-0002a500: 2861 6263 2c54 7275 6529 0d0a 2020 2020  (abc,True)..    
-0002a510: 2020 2020 7665 7274 7320 3d20 6e70 2e61      verts = np.a
-0002a520: 7272 6179 2878 797a 292e 540d 0a20 2020  rray(xyz).T..   
-0002a530: 2020 2020 206e 756d 5674 203d 206e 756d       numVt = num
-0002a540: 5f56 2d31 2069 6620 6861 7343 656e 7465  _V-1 if hasCente
-0002a550: 7220 656c 7365 206e 756d 560d 0a20 2020  r else numV..   
-0002a560: 2020 2020 2066 6163 6549 6e64 6963 6573       faceIndices
-0002a570: 203d 2063 6c73 2e5f 6772 6964 5f66 6163   = cls._grid_fac
-0002a580: 655f 696e 6469 6365 7328 6e75 6d55 2c6e  e_indices(numU,n
-0002a590: 756d 5674 2c69 7353 706c 6974 2c6e 6565  umVt,isSplit,nee
-0002a5a0: 6473 5472 6961 6729 0d0a 0d0a 2020 2020  dsTriag)....    
-0002a5b0: 2020 2020 6966 2068 6173 4365 6e74 6572      if hasCenter
-0002a5c0: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
-0002a5d0: 2320 6164 6420 746f 7020 7472 6961 6e67  # add top triang
-0002a5e0: 756c 6172 2066 6163 6573 202e 2e2e 0d0a  ular faces .....
-0002a5f0: 2020 2020 2020 2020 2020 2020 746f 7056              topV
-0002a600: 6572 7420 3d20 6e70 2e61 7272 6179 285b  ert = np.array([
-0002a610: 5b30 2e30 2c30 2e30 2c31 5d5d 290d 0a20  [0.0,0.0,1]]).. 
-0002a620: 2020 2020 2020 2020 2020 2074 6f70 496e             topIn
-0002a630: 6465 7820 3d20 746f 7456 6572 7473 0d0a  dex = totVerts..
-0002a640: 2020 2020 2020 2020 2020 2020 7374 6172              star
-0002a650: 7449 6e64 6578 203d 2074 6f70 496e 6465  tIndex = topInde
-0002a660: 7820 2d20 6e75 6d5f 550d 0a20 2020 2020  x - num_U..     
-0002a670: 2020 2020 2020 2065 6e64 496e 6465 7820         endIndex 
-0002a680: 3d20 746f 7049 6e64 6578 2d32 2069 6620  = topIndex-2 if 
-0002a690: 6973 5370 6c69 7420 656c 7365 2074 6f70  isSplit else top
-0002a6a0: 496e 6465 782d 310d 0a20 2020 2020 2020  Index-1..       
-0002a6b0: 2020 2020 2061 203d 206e 702e 6c69 6e73       a = np.lins
-0002a6c0: 7061 6365 2873 7461 7274 496e 6465 782c  pace(startIndex,
-0002a6d0: 656e 6449 6e64 6578 2c6e 756d 552c 6474  endIndex,numU,dt
-0002a6e0: 7970 653d 696e 7429 0d0a 2020 2020 2020  ype=int)..      
-0002a6f0: 2020 2020 2020 6220 3d20 612b 3120 6966        b = a+1 if
-0002a700: 2069 7353 706c 6974 2065 6c73 6520 6e70   isSplit else np
-0002a710: 2e61 7070 656e 6428 2061 5b31 3a5d 2c20  .append( a[1:], 
-0002a720: 5b73 7461 7274 496e 6465 785d 2029 0d0a  [startIndex] )..
-0002a730: 2020 2020 2020 2020 2020 2020 6320 3d20              c = 
-0002a740: 6e70 2e66 756c 6c28 6e75 6d55 2c74 6f70  np.full(numU,top
-0002a750: 496e 6465 7829 0d0a 2020 2020 2020 2020  Index)..        
-0002a760: 2020 2020 6162 6320 3d20 6e70 2e61 7272      abc = np.arr
-0002a770: 6179 285b 612c 622c 635d 292e 540d 0a20  ay([a,b,c]).T.. 
-0002a780: 2020 2020 2020 2020 2020 2076 6572 7473             verts
-0002a790: 203d 206e 702e 6170 7065 6e64 2876 6572   = np.append(ver
-0002a7a0: 7473 2c74 6f70 5665 7274 2c20 6178 6973  ts,topVert, axis
-0002a7b0: 3d30 290d 0a20 2020 2020 2020 2020 2020  =0)..           
-0002a7c0: 2066 6163 6549 6e64 6963 6573 203d 206e   faceIndices = n
-0002a7d0: 702e 6170 7065 6e64 2866 6163 6549 6e64  p.append(faceInd
-0002a7e0: 6963 6573 2c61 6263 2c20 6178 6973 3d30  ices,abc, axis=0
-0002a7f0: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
-0002a800: 2023 2061 6464 2062 6f74 746f 6d20 7472   # add bottom tr
-0002a810: 6961 6e67 756c 6172 2066 6163 6573 7320  iangular facess 
-0002a820: 2e2e 2e0d 0a20 2020 2020 2020 2020 2020  .....           
-0002a830: 2062 746d 5665 7274 203d 206e 702e 6172   btmVert = np.ar
-0002a840: 7261 7928 5b5b 302e 302c 302e 302c 2d31  ray([[0.0,0.0,-1
-0002a850: 5d5d 290d 0a20 2020 2020 2020 2020 2020  ]])..           
-0002a860: 2062 746d 496e 6465 7820 3d20 746f 7456   btmIndex = totV
-0002a870: 6572 7473 2b31 0d0a 2020 2020 2020 2020  erts+1..        
-0002a880: 2020 2020 7374 6172 7449 6e64 6578 2c65      startIndex,e
-0002a890: 6e64 496e 6465 7820 3d20 302c 6e75 6d55  ndIndex = 0,numU
-0002a8a0: 2d31 0d0a 2020 2020 2020 2020 2020 2020  -1..            
-0002a8b0: 6120 3d20 6e70 2e6c 696e 7370 6163 6528  a = np.linspace(
-0002a8c0: 7374 6172 7449 6e64 6578 2c65 6e64 496e  startIndex,endIn
-0002a8d0: 6465 782c 6e75 6d55 2c64 7479 7065 3d69  dex,numU,dtype=i
-0002a8e0: 6e74 290d 0a20 2020 2020 2020 2020 2020  nt)..           
-0002a8f0: 2062 203d 2061 2b31 2069 6620 6973 5370   b = a+1 if isSp
-0002a900: 6c69 7420 656c 7365 206e 702e 6170 7065  lit else np.appe
-0002a910: 6e64 2820 615b 313a 5d2c 205b 7374 6172  nd( a[1:], [star
-0002a920: 7449 6e64 6578 5d20 290d 0a20 2020 2020  tIndex] )..     
-0002a930: 2020 2020 2020 2063 203d 206e 702e 6675         c = np.fu
-0002a940: 6c6c 286e 756d 552c 6274 6d49 6e64 6578  ll(numU,btmIndex
-0002a950: 290d 0a20 2020 2020 2020 2020 2020 2062  )..            b
-0002a960: 6163 203d 206e 702e 6172 7261 7928 5b62  ac = np.array([b
-0002a970: 2c61 2c63 5d29 2e54 2020 2320 6261 6320  ,a,c]).T  # bac 
-0002a980: 696e 7374 6561 6420 666f 7220 6162 6320  instead for abc 
-0002a990: 666f 7220 6f75 7477 6172 6420 6e6f 726d  for outward norm
-0002a9a0: 616c 732e 0d0a 2020 2020 2020 2020 2020  als...          
-0002a9b0: 2020 7665 7274 7320 3d20 6e70 2e61 7070    verts = np.app
-0002a9c0: 656e 6428 7665 7274 732c 6274 6d56 6572  end(verts,btmVer
-0002a9d0: 742c 2061 7869 733d 3029 0d0a 2020 2020  t, axis=0)..    
-0002a9e0: 2020 2020 2020 2020 6661 6365 496e 6469          faceIndi
-0002a9f0: 6365 7320 3d20 6e70 2e61 7070 656e 6428  ces = np.append(
-0002aa00: 6661 6365 496e 6469 6365 732c 6261 632c  faceIndices,bac,
-0002aa10: 2061 7869 733d 3029 0d0a 0d0a 2020 2020   axis=0)....    
-0002aa20: 2020 2020 7375 7266 6163 6520 3d20 636c      surface = cl
-0002aa30: 7328 2a2a 6b77 6172 6773 2920 2023 2073  s(**kwargs)  # s
-0002aa40: 6574 2074 6f20 7468 6520 636c 6173 7320  et to the class 
-0002aa50: 6465 6661 756c 7420 6f62 6a65 6374 0d0a  default object..
-0002aa60: 2020 2020 2020 2020 2320 7265 7365 7420          # reset 
-0002aa70: 7665 7274 732c 2066 6163 6549 6e64 6963  verts, faceIndic
-0002aa80: 6573 2061 6e64 2065 6467 6573 2028 7265  es and edges (re
-0002aa90: 7461 696e 2063 6c61 7373 2063 6f6f 7264  tain class coord
-0002aaa0: 696e 6174 6520 7379 7374 656d 292e 0d0a  inate system)...
-0002aab0: 2020 2020 2020 2020 7375 7266 6163 652e          surface.
-0002aac0: 7665 7274 6578 436f 6f72 203d 2076 6572  vertexCoor = ver
-0002aad0: 7473 0d0a 2020 2020 2020 2020 7375 7266  ts..        surf
-0002aae0: 6163 652e 6676 496e 6469 6365 7320 3d20  ace.fvIndices = 
-0002aaf0: 6661 6365 496e 6469 6365 730d 0a20 2020  faceIndices..   
-0002ab00: 2020 2020 2073 7572 6661 6365 2e65 7649       surface.evI
-0002ab10: 6e64 6963 6573 203d 2073 7572 6661 6365  ndices = surface
-0002ab20: 2e5f 6765 745f 6564 6765 735f 6672 6f6d  ._get_edges_from
-0002ab30: 5f66 6163 6573 2866 6163 6549 6e64 6963  _faces(faceIndic
-0002ab40: 6573 290d 0a20 2020 2020 2020 2073 7572  es)..        sur
-0002ab50: 6661 6365 2e76 6649 6e64 6963 6573 4c69  face.vfIndicesLi
-0002ab60: 7374 203d 2073 7572 6661 6365 2e5f 7665  st = surface._ve
-0002ab70: 7274 6578 436f 6d6d 6f6e 4661 6365 496e  rtexCommonFaceIn
-0002ab80: 6469 6365 7328 290d 0a20 2020 2020 2020  dices()..       
-0002ab90: 2073 7572 6661 6365 2e65 6649 6e64 6963   surface.efIndic
-0002aba0: 6573 4c69 7374 203d 2073 7572 6661 6365  esList = surface
-0002abb0: 2e5f 6564 6765 436f 6d6d 6f6e 4661 6365  ._edgeCommonFace
-0002abc0: 496e 6469 6365 7328 290d 0a20 2020 2020  Indices()..     
-0002abd0: 2020 2073 7572 6661 6365 2e73 6574 5f76     surface.set_v
-0002abe0: 6572 7473 2820 7665 7274 735b 6661 6365  erts( verts[face
-0002abf0: 496e 6469 6365 735d 2029 0d0a 2020 2020  Indices] )..    
-0002ac00: 2020 2020 7375 7266 6163 652e 5f73 6574      surface._set
-0002ac10: 5f67 656f 6d65 7472 6963 5f62 6f75 6e64  _geometric_bound
-0002ac20: 7328 290d 0a20 2020 2020 2020 2073 7572  s()..        sur
-0002ac30: 6661 6365 2e6e 616d 6520 3d20 6e61 6d65  face.name = name
-0002ac40: 0d0a 2020 2020 2020 2020 7375 7266 6163  ..        surfac
-0002ac50: 652e 5f62 6173 6574 7970 6520 3d20 2767  e._basetype = 'g
-0002ac60: 7269 645f 272b 6261 7365 7479 7065 2b27  rid_'+basetype+'
-0002ac70: 7627 0d0a 2020 2020 2020 2020 7265 7475  v'..        retu
-0002ac80: 726e 2073 7572 6661 6365 0d0a 0d0a 2020  rn surface....  
-0002ac90: 2020 4063 6c61 7373 6d65 7468 6f64 0d0a    @classmethod..
-0002aca0: 2020 2020 6465 6620 5f75 7677 5f74 6f5f      def _uvw_to_
-0002acb0: 7879 7a28 636c 732c 2075 7677 2c20 7274  xyz(cls, uvw, rt
-0002acc0: 7a29 203a 0d0a 2020 2020 2020 2020 2222  z) :..        ""
-0002acd0: 224f 7665 7272 6964 6520 726f 7461 7469  "Override rotati
-0002ace0: 6f6e 616c 2074 7261 6e66 6f72 6d61 7469  onal tranformati
-0002acf0: 6f6e 2061 7420 6120 6379 6c69 6e64 7269  on at a cylindri
-0002ad00: 6361 6c20 636f 6f72 6469 6e61 7465 2e22  cal coordinate."
-0002ad10: 2222 200d 0a20 2020 2020 2020 2072 6574  "" ..        ret
-0002ad20: 7572 6e20 7375 7065 7228 292e 5f64 6973  urn super()._dis
-0002ad30: 705f 746f 5f78 797a 2820 7576 772c 2072  p_to_xyz( uvw, r
-0002ad40: 747a 5b31 5d2c 204e 6f6e 6520 290d 0a0d  tz[1], None )...
-0002ad50: 0a20 2020 2040 636c 6173 736d 6574 686f  .    @classmetho
-0002ad60: 640d 0a20 2020 2064 6566 2067 7269 6428  d..    def grid(
-0002ad70: 636c 732c 206e 7665 7220 2c6e 616e 672c  cls, nver ,nang,
-0002ad80: 2062 6173 6574 7970 653d 2764 272c 6d69   basetype='d',mi
-0002ad90: 6e72 6164 3d4e 6f6e 652c 206e 756d 523d  nrad=None, numR=
-0002ada0: 4e6f 6e65 2c20 6e61 6d65 3d4e 6f6e 652c  None, name=None,
-0002adb0: 202a 2a6b 7761 7267 7329 203a 0d0a 2020   **kwargs) :..  
-0002adc0: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
-0002add0: 2020 2043 796c 696e 6472 6963 616c 5375     CylindricalSu
-0002ade0: 7266 6163 6520 7769 7468 2061 7869 616c  rface with axial
-0002adf0: 2061 6e64 2076 6572 7469 6361 6c20 6661   and vertical fa
-0002ae00: 6365 732e 0d0a 0d0a 2020 2020 2020 2020  ces.....        
-0002ae10: 5061 7261 6d65 7465 7273 0d0a 2020 2020  Parameters..    
-0002ae20: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a      ----------..
-0002ae30: 2020 2020 2020 2020 6e76 6572 203a 2069          nver : i
-0002ae40: 6e74 6567 6572 2c20 7265 7175 6972 6564  nteger, required
-0002ae50: 2e0d 0a20 2020 2020 2020 2020 2020 204e  ...            N
-0002ae60: 756d 6265 7220 6f66 2076 6572 7469 6361  umber of vertica
-0002ae70: 6c20 7375 6264 6976 6973 696f 6e73 2e20  l subdivisions. 
-0002ae80: 204d 696e 696d 756d 2076 616c 7565 2069   Minimum value i
-0002ae90: 7320 310d 0a0d 0a20 2020 2020 2020 206e  s 1....        n
-0002aea0: 616e 6720 3a20 696e 7465 6765 722c 2072  ang : integer, r
-0002aeb0: 6571 7569 7265 642e 0d0a 2020 2020 2020  equired...      
-0002aec0: 2020 2020 2020 4e75 6d62 6572 206f 6620        Number of 
-0002aed0: 616e 6775 6c61 7220 7375 6264 6976 6973  angular subdivis
-0002aee0: 696f 6e73 2e20 4d69 6e69 6d75 6d20 7661  ions. Minimum va
-0002aef0: 6c75 6520 6973 2033 2e0d 0a20 2020 2020  lue is 3...     
-0002af00: 2020 200d 0a20 2020 2020 2020 2062 6173     ..        bas
-0002af10: 6574 7970 6520 3a20 7b27 6427 2c27 7127  etype : {'d','q'
-0002af20: 2c27 7227 2c27 7327 2c27 7727 2c27 7827  ,'r','s','w','x'
-0002af30: 2c20 2764 7627 2c27 7176 272c 2772 7627  , 'dv','qv','rv'
-0002af40: 2c27 7376 272c 2777 7627 2c27 7876 277d  ,'sv','wv','xv'}
-0002af50: 2c20 6f70 7469 6f6e 616c 2c20 6465 6661  , optional, defa
-0002af60: 756c 743a 2027 6427 0d0a 2020 2020 2020  ult: 'd'..      
-0002af70: 2020 2020 2020 5374 6172 7469 6e67 2073        Starting s
-0002af80: 7572 6661 6365 2067 656f 6d65 7472 6965  urface geometrie
-0002af90: 7320 6672 6f6d 2077 6869 6368 2074 6865  s from which the
-0002afa0: 2073 7572 6661 6365 2069 730d 0a20 2020   surface is..   
-0002afb0: 2020 2020 2020 2020 2063 6f6e 7374 7275           constru
-0002afc0: 6374 6564 2069 6e64 6963 6174 696e 6720  cted indicating 
-0002afd0: 6661 6365 2073 6861 7065 2061 6e64 2069  face shape and i
-0002afe0: 6620 7370 6c69 742e 0d0a 0d0a 2020 2020  f split.....    
-0002aff0: 2020 2020 6d69 6e72 6164 203a 2073 6361      minrad : sca
-0002b000: 6c61 722c 206f 7074 696f 6e61 6c2c 2064  lar, optional, d
-0002b010: 6566 6175 6c74 3a20 302e 3031 0d0a 2020  efault: 0.01..  
-0002b020: 2020 2020 2020 2020 2020 5468 6520 6d69            The mi
-0002b030: 6e69 6d75 6d20 6469 7374 616e 6365 2066  nimum distance f
-0002b040: 726f 6d20 7468 6520 7a2d 6178 6973 206f  rom the z-axis o
-0002b050: 6620 616e 7920 7665 7274 6578 2063 6f6f  f any vertex coo
-0002b060: 7264 696e 6174 652e 0d0a 2020 2020 2020  rdinate...      
-0002b070: 2020 2020 2020 5573 6520 6973 2064 6570        Use is dep
-0002b080: 656e 6465 6e74 206f 6e20 6261 7365 7479  endent on basety
-0002b090: 7065 2e0d 0a0d 0a20 2020 2020 2020 206e  pe.....        n
-0002b0a0: 756d 5220 3a20 696e 7465 6765 722c 206f  umR : integer, o
-0002b0b0: 7074 696f 6e61 6c2c 2064 6566 6175 6c74  ptional, default
-0002b0c0: 3a20 4e6f 6e65 0d0a 2020 2020 2020 2020  : None..        
-0002b0d0: 2020 2020 4f6e 6c79 2061 7070 6c69 6361      Only applica
-0002b0e0: 626c 6520 666f 7220 766f 6c75 6d65 2063  ble for volume c
-0002b0f0: 796c 696e 6465 7220 6765 6f6d 6574 7269  ylinder geometri
-0002b100: 6573 2e0d 0a20 2020 2020 2020 2020 2020  es...           
-0002b110: 204e 756d 6265 7220 6f66 2072 6164 6961   Number of radia
-0002b120: 6c20 7375 6264 6976 6973 696f 6e73 2066  l subdivisions f
-0002b130: 6f72 2076 6f6c 756d 6520 6379 6c69 6e64  or volume cylind
-0002b140: 6572 732e 0d0a 2020 2020 2020 2020 2020  ers...          
-0002b150: 2020 5768 656e 204e 6f6e 652c 2064 6566    When None, def
-0002b160: 6175 6c74 2069 7320 6861 6c66 2074 6865  ault is half the
-0002b170: 206e 756d 6265 7220 6f66 2076 6572 7469   number of verti
-0002b180: 6361 6c20 7375 6264 6976 6973 696f 6e73  cal subdivisions
-0002b190: 2e0d 0a0d 0a20 2020 2020 2020 206e 616d  .....        nam
-0002b1a0: 6520 3a20 7374 7269 6e67 2c20 6f70 7469  e : string, opti
-0002b1b0: 6f6e 616c 2c20 6465 6661 756c 743a 204e  onal, default: N
-0002b1c0: 6f6e 652e 0d0a 2020 2020 2020 2020 2020  one...          
-0002b1d0: 2020 4465 7363 7269 7074 6976 6520 6964    Descriptive id
-0002b1e0: 656e 7469 6669 6572 2e0d 0a0d 0a20 2020  entifier.....   
-0002b1f0: 2020 2020 2052 6169 7365 730d 0a20 2020       Raises..   
-0002b200: 2020 2020 202d 2d2d 2d2d 2d0d 0a20 2020       ------..   
-0002b210: 2020 2020 2056 616c 7565 4572 726f 720d       ValueError.
-0002b220: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
-0002b230: 6e76 6572 2069 7320 6e6f 7420 616e 2069  nver is not an i
-0002b240: 6e74 6567 6572 2067 7265 6174 6572 206f  nteger greater o
-0002b250: 7220 6571 7561 6c20 746f 2031 2e0d 0a20  r equal to 1... 
-0002b260: 2020 2020 2020 2020 2020 2049 6620 6e61             If na
-0002b270: 6e67 2069 7320 6e6f 7420 616e 2069 6e74  ng is not an int
-0002b280: 6567 6572 2067 7265 6174 6572 206f 7220  eger greater or 
-0002b290: 6571 7561 6c20 746f 2033 2e0d 0a0d 0a20  equal to 3..... 
-0002b2a0: 2020 2020 2020 204f 7468 6572 2050 6172         Other Par
-0002b2b0: 616d 6574 6572 730d 0a20 2020 2020 2020  ameters..       
-0002b2c0: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
-0002b2d0: 2d0d 0a20 2020 2020 2020 202a 2a6b 7761  -..        **kwa
-0002b2e0: 7267 730d 0a20 2020 2020 2020 2020 2020  rgs..           
-0002b2f0: 2041 6c6c 206f 7468 6572 2070 6172 616d   All other param
-0002b300: 6574 6572 7320 6172 6520 7061 7373 6564  eters are passed
-0002b310: 206f 6e20 746f 2027 7333 646c 6962 2e73   on to 's3dlib.s
-0002b320: 7572 6661 6365 2e53 7572 6661 6365 3344  urface.Surface3D
-0002b330: 436f 6c6c 6563 7469 6f6e 272e 0d0a 2020  Collection'...  
-0002b340: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-0002b350: 5265 7475 726e 730d 0a20 2020 2020 2020  Returns..       
-0002b360: 202d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020   -------..      
-0002b370: 2020 7375 7266 6163 6520 3a20 4379 6c69    surface : Cyli
-0002b380: 6e64 7269 6361 6c53 7572 6661 6365 206f  ndricalSurface o
-0002b390: 626a 6563 742e 0d0a 0d0a 2020 2020 2020  bject.....      
-0002b3a0: 2020 2222 220d 0a20 2020 2020 2020 204e    """..        N
-0002b3b0: 6661 6365 7320 3d20 7b20 2764 273a 2036  faces = { 'd': 6
-0002b3c0: 2c20 2020 2773 273a 2036 2c20 2020 2771  ,   's': 6,   'q
-0002b3d0: 273a 362c 2020 2027 7727 3a36 2c20 2020  ':6,   'w':6,   
-0002b3e0: 2772 273a 332c 2020 2778 273a 332c 0d0a  'r':3,  'x':3,..
-0002b3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b400: 2020 2027 6476 273a 2031 322c 2027 7376     'dv': 12, 'sv
-0002b410: 273a 2031 322c 2027 7176 273a 3138 2c20  ': 12, 'qv':18, 
-0002b420: 2777 7627 3a31 382c 2027 7276 273a 392c  'wv':18, 'rv':9,
-0002b430: 2027 7876 273a 3920 207d 2020 2320 312c   'xv':9  }  # 1,
-0002b440: 330d 0a20 2020 2020 2020 2073 706c 6974  3..        split
-0002b450: 5369 7a65 203d 204e 6f6e 6520 2023 2046  Size = None  # F
-0002b460: 7574 4465 763a 2063 7572 7265 6e74 6c79  utDev: currently
-0002b470: 2c20 6e6f 7420 7573 6572 2061 6363 6573  , not user acces
-0002b480: 7361 626c 652e 0d0a 2020 2020 2020 2020  sable...        
-0002b490: 6466 744e 6661 6365 7320 3d20 3132 0d0a  dftNfaces = 12..
-0002b4a0: 0d0a 2020 2020 2020 2020 6261 7365 7479  ..        basety
-0002b4b0: 7065 203d 2062 6173 6574 7970 652e 6c6f  pe = basetype.lo
-0002b4c0: 7765 7228 290d 0a20 2020 2020 2020 2069  wer()..        i
-0002b4d0: 6620 6261 7365 7479 7065 2e65 6e64 7377  f basetype.endsw
-0002b4e0: 6974 6828 2776 2729 203a 0d0a 2020 2020  ith('v') :..    
-0002b4f0: 2020 2020 2020 2020 6466 744e 6661 6365          dftNface
-0002b500: 7320 3d20 3138 0d0a 2020 2020 2020 2020  s = 18..        
-0002b510: 2020 2020 7375 6274 7970 6520 3d20 6261      subtype = ba
-0002b520: 7365 7479 7065 5b30 5d0d 0a20 2020 2020  setype[0]..     
-0002b530: 2020 2020 2020 2073 7572 6661 6365 203d         surface =
-0002b540: 2043 796c 696e 6472 6963 616c 5375 7266   CylindricalSurf
-0002b550: 6163 652e 5f63 796c 5f76 6f6c 5f73 7175  ace._cyl_vol_squ
-0002b560: 6172 655f 6e65 7428 206e 7665 7220 2c6e  are_net( nver ,n
-0002b570: 616e 672c 2073 7562 7479 7065 2c20 6d69  ang, subtype, mi
-0002b580: 6e72 6164 2c20 7370 6c69 7453 697a 652c  nrad, splitSize,
-0002b590: 206e 756d 522c 206e 616d 652c 202a 2a6b   numR, name, **k
-0002b5a0: 7761 7267 7329 0d0a 2020 2020 2020 2020  wargs)..        
-0002b5b0: 656c 7365 203a 200d 0a20 2020 2020 2020  else : ..       
-0002b5c0: 2020 2020 2073 7572 6661 6365 203d 2063       surface = c
-0002b5d0: 6c73 2e5f 7371 7561 7265 5f6e 6574 286e  ls._square_net(n
-0002b5e0: 7665 7220 2c6e 616e 672c 6261 7365 7479  ver ,nang,basety
-0002b5f0: 7065 2c6d 696e 7261 642c 7370 6c69 7453  pe,minrad,splitS
-0002b600: 697a 652c 206e 616d 652c 202a 2a6b 7761  ize, name, **kwa
-0002b610: 7267 7329 0d0a 2020 2020 2020 2020 7375  rgs)..        su
-0002b620: 7266 6163 652e 5f70 6f73 7450 726f 635f  rface._postProc_
-0002b630: 7375 7266 6163 6543 6f6c 6f72 7328 5472  surfaceColors(Tr
-0002b640: 7565 290d 0a20 2020 2020 2020 2073 7572  ue)..        sur
-0002b650: 6661 6365 2e5f 7265 7a20 3d20 7375 7266  face._rez = surf
-0002b660: 6163 652e 5f63 616c 635f 7265 7a28 2064  ace._calc_rez( d
-0002b670: 6674 4e66 6163 6573 2029 0d0a 2020 2020  ftNfaces )..    
-0002b680: 2020 2020 7265 7475 726e 2073 7572 6661      return surfa
-0002b690: 6365 2020 2020 2020 200d 0a0d 0a20 2020  ce       ....   
-0002b6a0: 2040 636c 6173 736d 6574 686f 640d 0a20   @classmethod.. 
-0002b6b0: 2020 2064 6566 205f 5866 6576 2863 6c73     def _Xfev(cls
-0002b6c0: 2c72 657a 2c20 6261 7365 7479 7065 3d4e  ,rez, basetype=N
-0002b6d0: 6f6e 652c 206d 696e 7261 643d 4e6f 6e65  one, minrad=None
-0002b6e0: 2920 3a0d 0a20 2020 2020 2020 2022 2222  ) :..        """
-0002b6f0: 0d0a 2020 2020 2020 2020 4361 6c63 756c  ..        Calcul
-0002b700: 6174 6573 206e 756d 6265 7220 6f66 2066  ates number of f
-0002b710: 6163 6573 2c20 6564 6765 732c 2061 6e64  aces, edges, and
-0002b720: 2076 6572 7469 6365 7320 6f66 2061 2043   vertices of a C
-0002b730: 796c 696e 6472 6963 616c 5375 7266 6163  ylindricalSurfac
-0002b740: 652e 0d0a 0d0a 2020 2020 2020 2020 5061  e.....        Pa
-0002b750: 7261 6d65 7465 7273 0d0a 2020 2020 2020  rameters..      
-0002b760: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
-0002b770: 2020 2020 2020 7265 7a20 3a20 696e 7465        rez : inte
-0002b780: 6765 720d 0a20 2020 2020 2020 2020 2020  ger..           
-0002b790: 204e 756d 6265 7220 6f66 2072 6563 7572   Number of recur
-0002b7a0: 7369 7665 2073 7562 6469 7669 7369 6f6e  sive subdivision
-0002b7b0: 7320 6f66 2061 2074 7269 616e 6775 6c61  s of a triangula
-0002b7c0: 7465 6420 6261 7365 2066 6163 6573 2e0d  ted base faces..
-0002b7d0: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
-0002b7e0: 2020 2062 6173 6574 7970 6520 3a20 7374     basetype : st
-0002b7f0: 7269 6e67 0d0a 2020 2020 2020 2020 2020  ring..          
-0002b800: 2020 5374 6172 7469 6e67 2073 7572 6661    Starting surfa
-0002b810: 6365 2067 656f 6d65 7472 6965 7320 6672  ce geometries fr
-0002b820: 6f6d 2077 6869 6368 2074 6865 2073 7572  om which the sur
-0002b830: 6661 6365 2077 6f75 6c64 2062 650d 0a20  face would be.. 
-0002b840: 2020 2020 2020 2020 2020 2063 6f6e 7374             const
-0002b850: 7275 6374 6564 2075 7369 6e67 2072 6563  ructed using rec
-0002b860: 7572 7369 7665 2073 7562 6469 7669 7369  ursive subdivisi
-0002b870: 6f6e 7320 6f66 2074 6865 2074 7269 616e  ons of the trian
-0002b880: 6775 6c61 7220 6661 6365 732e 0d0a 2020  gular faces...  
-0002b890: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-0002b8a0: 5265 7475 726e 730d 0a20 2020 2020 2020  Returns..       
-0002b8b0: 202d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020   -------..      
-0002b8c0: 2020 6c69 7374 3a20 7468 6520 6e75 6d62    list: the numb
-0002b8d0: 6572 206f 6620 6661 6365 732c 2065 6467  er of faces, edg
-0002b8e0: 6573 2c20 616e 6420 7665 7274 6963 6573  es, and vertices
-0002b8f0: 2e0d 0a0d 0a20 2020 2020 2020 2022 2222  .....        """
-0002b900: 0d0a 2020 2020 2020 2020 6966 2069 7369  ..        if isi
-0002b910: 6e73 7461 6e63 6528 7265 7a2c 286c 6973  nstance(rez,(lis
-0002b920: 742c 7475 706c 6529 2920 3a20 2320 6368  t,tuple)) : # ch
-0002b930: 6563 6b20 666f 7220 7269 6e67 2e2e 2e0d  eck for ring....
-0002b940: 0a20 2020 2020 2020 2020 2020 206e 7665  .            nve
-0002b950: 7220 3d20 7265 7a5b 305d 0d0a 2020 2020  r = rez[0]..    
-0002b960: 2020 2020 2020 2020 6e61 6e67 203d 2072          nang = r
-0002b970: 657a 5b31 5d0d 0a20 2020 2020 2020 2020  ez[1]..         
-0002b980: 2020 2023 206f 6e6c 7920 6368 6563 6b20     # only check 
-0002b990: 6973 2065 6e64 696e 6720 696e 2073 0d0a  is ending in s..
-0002b9a0: 2020 2020 2020 2020 2020 2020 6973 5370              isSp
-0002b9b0: 6c69 7420 3d20 6261 7365 7479 7065 5b20  lit = basetype[ 
-0002b9c0: 6c65 6e28 6261 7365 7479 7065 292d 315d  len(basetype)-1]
-0002b9d0: 2069 7320 2773 270d 0a20 2020 2020 2020   is 's'..       
-0002b9e0: 2020 2020 2066 203d 2032 2a6e 7665 722a       f = 2*nver*
-0002b9f0: 6e61 6e67 0d0a 2020 2020 2020 2020 2020  nang..          
-0002ba00: 2020 6520 3d20 332a 6e76 6572 2a6e 616e    e = 3*nver*nan
-0002ba10: 6720 2b20 6e61 6e67 0d0a 2020 2020 2020  g + nang..      
-0002ba20: 2020 2020 2020 7620 3d20 286e 7665 7220        v = (nver 
-0002ba30: 2b20 3129 2a6e 616e 670d 0a20 2020 2020  + 1)*nang..     
-0002ba40: 2020 2020 2020 2069 6620 6973 5370 6c69         if isSpli
-0002ba50: 7420 3a0d 0a20 2020 2020 2020 2020 2020  t :..           
-0002ba60: 2020 2020 2065 202b 3d20 6e76 6572 0d0a       e += nver..
-0002ba70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ba80: 7620 2b3d 206e 7665 7220 2b20 310d 0a20  v += nver + 1.. 
-0002ba90: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0002baa0: 6e20 5b66 2c65 2c76 5d20 2020 2020 2020  n [f,e,v]       
-0002bab0: 2020 2020 0d0a 0d0a 2020 2020 2020 2020      ....        
-0002bac0: 7265 7475 726e 2073 7570 6572 2829 2e5f  return super()._
-0002bad0: 6665 7628 7265 7a2c 6261 7365 7479 7065  fev(rez,basetype
-0002bae0: 2c63 6c73 290d 0a20 2020 2020 2020 2020  ,cls)..         
-0002baf0: 2020 2020 2020 0d0a 2020 2020 6465 6620        ..    def 
-0002bb00: 5f5f 696e 6974 5f5f 2873 656c 662c 2072  __init__(self, r
-0002bb10: 657a 3d30 2c20 6261 7365 7479 7065 3d4e  ez=0, basetype=N
-0002bb20: 6f6e 652c 206e 616d 653d 4e6f 6e65 2c20  one, name=None, 
-0002bb30: 2a2a 6b77 6172 6773 293a 0d0a 2020 2020  **kwargs):..    
-0002bb40: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
-0002bb50: 2043 7265 6174 6520 6379 6c69 6e64 7269   Create cylindri
-0002bb60: 6361 6c20 7375 7266 6163 6520 6f66 2075  cal surface of u
-0002bb70: 6e69 7420 7261 6469 7573 2061 6e64 206c  nit radius and l
-0002bb80: 656e 6774 6820 322e 0d0a 0d0a 2020 2020  ength 2.....    
-0002bb90: 2020 2020 5061 7261 6d65 7465 7273 0d0a      Parameters..
-0002bba0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-0002bbb0: 2d2d 0d0a 2020 2020 2020 2020 7265 7a20  --..        rez 
-0002bbc0: 3a20 696e 7465 6765 722c 206f 7074 696f  : integer, optio
-0002bbd0: 6e61 6c2c 2064 6566 6175 6c74 3a20 300d  nal, default: 0.
-0002bbe0: 0a20 2020 2020 2020 2020 2020 204e 756d  .            Num
-0002bbf0: 6265 7220 6f66 2072 6563 7572 7369 7665  ber of recursive
-0002bc00: 2073 7562 6469 7669 7369 6f6e 7320 6f66   subdivisions of
-0002bc10: 2074 6865 2074 7269 616e 6775 6c61 7465   the triangulate
-0002bc20: 6420 6261 7365 2066 6163 6573 2e0d 0a20  d base faces... 
-0002bc30: 2020 2020 2020 2020 2020 2052 657a 2076             Rez v
-0002bc40: 616c 7565 7320 7261 6e67 6520 6672 6f6d  alues range from
-0002bc50: 2030 2074 6f20 372e 0d0a 2020 2020 2020   0 to 7...      
-0002bc60: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-0002bc70: 6261 7365 7479 7065 203a 207b 2774 7269  basetype : {'tri
-0002bc80: 272c 2773 7175 272c 2774 7269 3227 2c27  ','squ','tri2','
-0002bc90: 7371 7532 272c 2774 7269 5f73 272c 2773  squ2','tri_s','s
-0002bca0: 7175 5f73 272c 2027 7472 695f 7627 2c27  qu_s', 'tri_v','
-0002bcb0: 7371 755f 7627 2c27 7472 6932 5f76 272c  squ_v','tri2_v',
-0002bcc0: 2773 7175 325f 7627 2c27 7472 695f 7376  'squ2_v','tri_sv
-0002bcd0: 272c 2773 7175 5f73 7627 7d2c 206f 7074  ','squ_sv'}, opt
-0002bce0: 696f 6e61 6c2c 2064 6566 6175 6c74 3a20  ional, default: 
-0002bcf0: 2774 7269 270d 0a20 2020 2020 2020 2020  'tri'..         
-0002bd00: 2020 2053 7461 7274 696e 6720 7375 7266     Starting surf
-0002bd10: 6163 6520 6765 6f6d 6574 7269 6573 2066  ace geometries f
-0002bd20: 726f 6d20 7768 6963 6820 7468 6520 7375  rom which the su
-0002bd30: 7266 6163 6520 6973 0d0a 2020 2020 2020  rface is..      
-0002bd40: 2020 2020 2020 636f 6e73 7472 7563 7465        constructe
-0002bd50: 6420 7573 696e 6720 7265 6375 7273 6976  d using recursiv
-0002bd60: 6520 7375 6264 6976 6973 696f 6e73 206f  e subdivisions o
-0002bd70: 6620 7468 6520 7472 6961 6e67 756c 6172  f the triangular
-0002bd80: 2066 6163 6573 2e0d 0a0d 0a20 2020 2020   faces.....     
-0002bd90: 2020 206e 616d 6520 3a20 7374 7269 6e67     name : string
-0002bda0: 2c20 6f70 7469 6f6e 616c 2c20 6465 6661  , optional, defa
-0002bdb0: 756c 743a 204e 6f6e 652e 0d0a 2020 2020  ult: None...    
-0002bdc0: 2020 2020 2020 2020 4465 7363 7269 7074          Descript
-0002bdd0: 6976 6520 6964 656e 7469 6669 6572 2066  ive identifier f
-0002bde0: 6f72 2074 6865 2067 656f 6d65 7472 792e  or the geometry.
-0002bdf0: 0d0a 0d0a 2020 2020 2020 2020 5261 6973  ....        Rais
-0002be00: 6573 0d0a 2020 2020 2020 2020 2d2d 2d2d  es..        ----
-0002be10: 2d2d 0d0a 2020 2020 2020 2020 5661 6c75  --..        Valu
-0002be20: 6545 7272 6f72 0d0a 2020 2020 2020 2020  eError..        
-0002be30: 2020 2020 4966 2072 657a 2069 7320 6e6f      If rez is no
-0002be40: 7420 616e 2069 6e74 6567 6572 2069 6e20  t an integer in 
-0002be50: 7261 6e67 6520 3020 746f 2037 2e0d 0a20  range 0 to 7... 
-0002be60: 2020 2020 2020 2020 2020 2049 6620 6261             If ba
-0002be70: 7365 7479 7065 2069 7320 6e6f 7420 7265  setype is not re
-0002be80: 636f 676e 697a 6564 2066 6f72 2074 6869  cognized for thi
-0002be90: 7320 7375 7266 6163 6520 636f 6e73 7472  s surface constr
-0002bea0: 7563 746f 722e 0d0a 0d0a 2020 2020 2020  uctor.....      
-0002beb0: 2020 4f74 6865 7220 5061 7261 6d65 7465    Other Paramete
-0002bec0: 7273 0d0a 2020 2020 2020 2020 2d2d 2d2d  rs..        ----
-0002bed0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020  ------------..  
-0002bee0: 2020 2020 2020 2a2a 6b77 6172 6773 0d0a        **kwargs..
-0002bef0: 2020 2020 2020 2020 2020 2020 416c 6c20              All 
-0002bf00: 6f74 6865 7220 7061 7261 6d65 7465 7273  other parameters
-0002bf10: 2061 7265 2070 6173 7365 6420 6f6e 2074   are passed on t
-0002bf20: 6f20 2773 3364 6c69 622e 7375 7266 6163  o 's3dlib.surfac
-0002bf30: 652e 5375 7266 6163 6533 4443 6f6c 6c65  e.Surface3DColle
-0002bf40: 6374 696f 6e27 2e0d 0a20 2020 2020 2020  ction'...       
-0002bf50: 200d 0a20 2020 2020 2020 2022 2222 0d0a   ..        """..
-0002bf60: 0d0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
-0002bf70: 2069 7369 6e73 7461 6e63 6528 7265 7a2c   isinstance(rez,
-0002bf80: 2069 6e74 2920 3a0d 0a20 2020 2020 2020   int) :..       
-0002bf90: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-0002bfa0: 4572 726f 7228 2749 6e63 6f72 7265 6374  Error('Incorrect
-0002bfb0: 2072 657a 2074 7970 652c 206d 7573 7420   rez type, must 
-0002bfc0: 6261 206f 6620 7479 7065 2069 6e74 2729  ba of type int')
-0002bfd0: 0d0a 2020 2020 2020 2020 6966 2028 7265  ..        if (re
-0002bfe0: 7a3c 3029 206f 7220 2872 657a 3e5f 4d41  z<0) or (rez>_MA
-0002bff0: 5852 455a 2920 3a0d 0a20 2020 2020 2020  XREZ) :..       
-0002c000: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-0002c010: 4572 726f 7228 2749 6e63 6f72 7265 7374  Error('Incorrest
-0002c020: 2072 657a 206f 6620 7b7d 2c20 6d75 7374   rez of {}, must
-0002c030: 2062 6520 616e 2069 6e74 2c20 3020 3c3d   be an int, 0 <=
-0002c040: 2072 657a 203c 3d20 7b7d 272e 666f 726d   rez <= {}'.form
-0002c050: 6174 2872 657a 2c5f 4d41 5852 455a 2929  at(rez,_MAXREZ))
-0002c060: 0d0a 2020 2020 2020 2020 6966 2062 6173  ..        if bas
-0002c070: 6574 7970 6520 6973 204e 6f6e 6520 3a20  etype is None : 
-0002c080: 6261 7365 7479 7065 203d 2073 656c 662e  basetype = self.
-0002c090: 5f64 6566 6175 6c74 5f62 6173 650d 0a20  _default_base.. 
-0002c0a0: 2020 2020 2020 2069 6620 6261 7365 7479         if basety
-0002c0b0: 7065 206e 6f74 2069 6e20 7365 6c66 2e5f  pe not in self._
-0002c0c0: 6261 7365 5f73 7572 6661 6365 7320 3a0d  base_surfaces :.
-0002c0d0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-0002c0e0: 7365 2056 616c 7565 4572 726f 7228 2742  se ValueError('B
-0002c0f0: 6173 6574 7970 6520 7b7d 2069 7320 6e6f  asetype {} is no
-0002c100: 7420 7265 636f 676e 697a 6564 2e20 506f  t recognized. Po
-0002c110: 7373 6962 6c65 2076 616c 7565 7320 6172  ssible values ar
-0002c120: 653a 207b 7d27 2e66 6f72 6d61 7428 6261  e: {}'.format(ba
-0002c130: 7365 7479 7065 2c6c 6973 7428 7365 6c66  setype,list(self
-0002c140: 2e5f 6261 7365 5f73 7572 6661 6365 7329  ._base_surfaces)
-0002c150: 2929 0d0a 2020 2020 2020 2020 6261 7365  ))..        base
-0002c160: 5375 7266 4f62 6a20 3d20 7365 6c66 2e5f  SurfObj = self._
-0002c170: 6261 7365 5f73 7572 6661 6365 735b 6261  base_surfaces[ba
-0002c180: 7365 7479 7065 5d0d 0a20 2020 2020 2020  setype]..       
-0002c190: 2062 6173 6556 636f 6f72 203d 2062 6173   baseVcoor = bas
-0002c1a0: 6553 7572 664f 626a 5b27 6261 7365 5665  eSurfObj['baseVe
-0002c1b0: 7274 6963 6573 436f 6f72 275d 0d0a 2020  rticesCoor']..  
-0002c1c0: 2020 2020 2020 6261 7365 4661 6365 5665        baseFaceVe
-0002c1d0: 7274 6578 496e 6469 6365 7320 3d62 6173  rtexIndices =bas
-0002c1e0: 6553 7572 664f 626a 5b27 6261 7365 4661  eSurfObj['baseFa
-0002c1f0: 6365 496e 6469 6365 7327 5d0d 0a20 2020  ceIndices']..   
-0002c200: 2020 2020 2069 6e64 6578 4f62 6a2c 7665       indexObj,ve
-0002c210: 7274 6578 436f 6f72 203d 2073 656c 662e  rtexCoor = self.
-0002c220: 7472 6961 6e67 756c 6174 6542 6173 6528  triangulateBase(
-0002c230: 7265 7a2c 6261 7365 5663 6f6f 722c 6261  rez,baseVcoor,ba
-0002c240: 7365 4661 6365 5665 7274 6578 496e 6469  seFaceVertexIndi
-0002c250: 6365 732c 2073 656c 662e 5f6d 6964 5665  ces, self._midVe
-0002c260: 6374 6f72 4675 6e29 0d0a 2020 2020 2020  ctorFun)..      
-0002c270: 2020 6661 6365 496e 6469 6365 7320 3d20    faceIndices = 
-0002c280: 696e 6465 784f 626a 5b27 6661 6365 275d  indexObj['face']
-0002c290: 0d0a 0d0a 2020 2020 2020 2020 7375 7065  ....        supe
-0002c2a0: 7228 292e 5f5f 696e 6974 5f5f 2876 6572  r().__init__(ver
-0002c2b0: 7465 7843 6f6f 722c 2066 6163 6549 6e64  texCoor, faceInd
-0002c2c0: 6963 6573 2c20 6e61 6d65 2c20 2a2a 6b77  ices, name, **kw
-0002c2d0: 6172 6773 290d 0a0d 0a20 2020 2020 2020  args)....       
-0002c2e0: 2073 656c 662e 636f 6f72 5479 7065 203d   self.coorType =
-0002c2f0: 205f 434f 4f52 5359 535b 2243 594c 494e   _COORSYS["CYLIN
-0002c300: 4452 4943 414c 225d 0d0a 2020 2020 2020  DRICAL"]..      
-0002c310: 2020 7365 6c66 2e5f 6e6f 726d 616c 5f73    self._normal_s
-0002c320: 6361 6c65 203d 2020 5f6e 6f72 6d4c 656e  cale =  _normLen
-0002c330: 6774 6828 206c 656e 2866 6163 6549 6e64  gth( len(faceInd
-0002c340: 6963 6573 292c 2031 2e31 342c 2031 2e33  ices), 1.14, 1.3
-0002c350: 3129 0d0a 2020 2020 2020 2020 7365 6c66  1)..        self
-0002c360: 2e5f 7265 7a20 3d20 7265 7a0d 0a20 2020  ._rez = rez..   
-0002c370: 2020 2020 2073 656c 662e 5f62 6173 6574       self._baset
-0002c380: 7970 6520 3d20 6261 7365 7479 7065 0d0a  ype = basetype..
-0002c390: 2020 2020 2020 2020 7365 6c66 2e64 6973          self.dis
-0002c3a0: 705f 5665 6374 6f72 203d 206e 702e 6172  p_Vector = np.ar
-0002c3b0: 7261 7928 205b 312c 312c 305d 2029 0d0a  ray( [1,1,0] )..
-0002c3c0: 2020 2020 2020 2020 7265 7475 726e 204e          return N
-0002c3d0: 6f6e 650d 0a0d 0a20 2020 2064 6566 2064  one....    def d
-0002c3e0: 6f6d 6169 6e28 7365 6c66 2c20 7261 6469  omain(self, radi
-0002c3f0: 7573 3d4e 6f6e 652c 207a 6c69 6d3d 4e6f  us=None, zlim=No
-0002c400: 6e65 2920 3a0d 0a20 2020 2020 2020 2022  ne) :..        "
-0002c410: 2222 0d0a 2020 2020 2020 2020 5365 7420  ""..        Set 
-0002c420: 7468 6520 646f 6d61 696e 206f 6620 7468  the domain of th
-0002c430: 6520 6379 6c69 6e64 7269 6361 6c20 7375  e cylindrical su
-0002c440: 7266 6163 652e 0d0a 0d0a 2020 2020 2020  rface.....      
-0002c450: 2020 5573 6564 2066 6f72 2073 6574 7469    Used for setti
-0002c460: 6e67 2074 6865 206c 696d 6974 7320 6f66  ng the limits of
-0002c470: 2074 6865 2062 6173 6520 6379 6c69 6e64   the base cylind
-0002c480: 6572 2e0d 0a0d 0a20 2020 2020 2020 2050  er.....        P
-0002c490: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
-0002c4a0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
-0002c4b0: 2020 2020 2020 2072 6164 6975 733a 206e         radius: n
-0002c4c0: 756d 6265 722c 2064 6566 6175 6c74 203a  umber, default :
-0002c4d0: 2031 0d0a 2020 2020 2020 2020 2020 2020   1..            
-0002c4e0: 5261 6469 7573 206f 6620 7468 6520 6379  Radius of the cy
-0002c4f0: 6c69 6e64 7269 6361 6c20 7375 7266 6163  lindrical surfac
-0002c500: 652e 0d0a 2020 2020 2020 2020 2020 2020  e...            
-0002c510: 4966 2073 6574 2074 6f20 4e6f 6e65 2c20  If set to None, 
-0002c520: 7468 6520 646f 6d61 696e 2069 7320 756e  the domain is un
-0002c530: 6368 616e 6765 642e 0d0a 0d0a 2020 2020  changed.....    
-0002c540: 2020 2020 7a6c 696d 203a 2032 6420 6172      zlim : 2d ar
-0002c550: 7261 790d 0a20 2020 2020 2020 2020 2020  ray..           
-0002c560: 204d 696e 696d 756d 2061 6e64 206d 6178   Minimum and max
-0002c570: 696d 756d 2076 616c 7565 7320 6f66 2074  imum values of t
-0002c580: 6865 2061 7272 6179 7320 6172 6520 7573  he arrays are us
-0002c590: 6564 2074 6f20 7363 616c 650d 0a20 2020  ed to scale..   
-0002c5a0: 2020 2020 2020 2020 2061 6e64 2074 7261           and tra
-0002c5b0: 6e73 6c61 7465 2074 6865 2073 7572 6661  nslate the surfa
-0002c5c0: 6365 2066 726f 6d20 616e 2069 6e74 6961  ce from an intia
-0002c5d0: 6c20 646f 6d61 696e 206f 660d 0a20 2020  l domain of..   
-0002c5e0: 2020 2020 2020 2020 205b 202d 312c 2031           [ -1, 1
-0002c5f0: 205d 0d0a 2020 2020 2020 2020 2020 2020   ]..            
-0002c600: 4966 2073 6574 2074 6f20 4e6f 6e65 2c20  If set to None, 
-0002c610: 7468 6520 5a2d 646f 6d61 696e 2069 7320  the Z-domain is 
-0002c620: 756e 6368 616e 6765 642e 0d0a 0d0a 2020  unchanged.....  
-0002c630: 2020 2020 2020 5265 7475 726e 730d 0a20        Returns.. 
-0002c640: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0d0a         -------..
-0002c650: 2020 2020 2020 2020 7365 6c66 203a 2043          self : C
-0002c660: 796c 696e 6472 6963 616c 5375 7266 6163  ylindricalSurfac
-0002c670: 6520 6f62 6a65 6374 0d0a 0d0a 2020 2020  e object....    
-0002c680: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
-0002c690: 2064 6566 2073 6574 446f 6d61 696e 2872   def setDomain(r
-0002c6a0: 747a 2c20 6d72 2c20 6d7a 2c62 7a29 203a  tz, mr, mz,bz) :
-0002c6b0: 0d0a 2020 2020 2020 2020 2020 2020 722c  ..            r,
-0002c6c0: 742c 7a20 3d20 7274 7a0d 0a20 2020 2020  t,z = rtz..     
-0002c6d0: 2020 2020 2020 2052 203d 206d 722a 720d         R = mr*r.
-0002c6e0: 0a20 2020 2020 2020 2020 2020 205a 203d  .            Z =
-0002c6f0: 206d 7a2a 7a20 2b20 627a 0d0a 2020 2020   mz*z + bz..    
-0002c700: 2020 2020 2020 2020 7265 7475 726e 2052          return R
-0002c710: 2c74 2c5a 2020 2020 2020 200d 0a20 2020  ,t,Z       ..   
-0002c720: 2020 2020 2064 6566 2067 6574 436f 6e74       def getCont
-0002c730: 5f72 286c 696d 7329 203a 0d0a 2020 2020  _r(lims) :..    
-0002c740: 2020 2020 2020 2020 6d20 3d20 312e 300d          m = 1.0.
-0002c750: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0002c760: 6c69 6d73 2069 7320 6e6f 7420 4e6f 6e65  lims is not None
-0002c770: 203a 206d 203d 206c 696d 730d 0a20 2020   : m = lims..   
-0002c780: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0002c790: 6d0d 0a20 2020 2020 2020 2064 6566 2067  m..        def g
-0002c7a0: 6574 436f 6e74 2820 6c69 6d73 2029 203a  etCont( lims ) :
-0002c7b0: 0d0a 2020 2020 2020 2020 2020 2020 6d2c  ..            m,
-0002c7c0: 2062 203d 2031 2e30 2c20 302e 300d 0a20   b = 1.0, 0.0.. 
-0002c7d0: 2020 2020 2020 2020 2020 2069 6620 6c69             if li
-0002c7e0: 6d73 2069 7320 6e6f 7420 4e6f 6e65 203a  ms is not None :
-0002c7f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0002c800: 2020 2320 616c 6c6f 7720 7369 6e67 6c65    # allow single
-0002c810: 2062 6e64 7279 2074 6f20 6265 2069 6e70   bndry to be inp
-0002c820: 7574 2061 7320 6120 666c 6f61 740d 0a20  ut as a float.. 
-0002c830: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0002c840: 6620 6973 696e 7374 616e 6365 286c 696d  f isinstance(lim
-0002c850: 732c 2028 696e 742c 666c 6f61 7429 2920  s, (int,float)) 
-0002c860: 3a20 6c69 6d73 203d 205b 2d6c 696d 732c  : lims = [-lims,
-0002c870: 6c69 6d73 5d0d 0a20 2020 2020 2020 2020  lims]..         
-0002c880: 2020 2020 2020 206d 2c20 6220 3d20 302e         m, b = 0.
-0002c890: 352a 286c 696d 735b 315d 2d6c 696d 735b  5*(lims[1]-lims[
-0002c8a0: 305d 2920 2c20 302e 352a 286c 696d 735b  0]) , 0.5*(lims[
-0002c8b0: 315d 2b6c 696d 735b 305d 290d 0a20 2020  1]+lims[0])..   
-0002c8c0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0002c8d0: 6d2c 2062 0d0a 2020 2020 2020 2020 6d72  m, b..        mr
-0002c8e0: 203d 2067 6574 436f 6e74 5f72 2872 6164   = getCont_r(rad
-0002c8f0: 6975 7329 0d0a 2020 2020 2020 2020 6d7a  ius)..        mz
-0002c900: 2c20 627a 203d 2067 6574 436f 6e74 287a  , bz = getCont(z
-0002c910: 6c69 6d29 0d0a 2020 2020 2020 2020 7365  lim)..        se
-0002c920: 6c66 2e6d 6170 5f67 656f 6d5f 6672 6f6d  lf.map_geom_from
-0002c930: 5f6f 7028 6c61 6d62 6461 2041 203a 2073  _op(lambda A : s
-0002c940: 6574 446f 6d61 696e 2841 2c20 6d72 2c20  etDomain(A, mr, 
-0002c950: 6d7a 2c62 7a29 290d 0a20 2020 2020 2020  mz,bz))..       
-0002c960: 2072 6574 7572 6e20 7365 6c66 0d0a 0d0a   return self....
-0002c970: 636c 6173 7320 5370 6865 7269 6361 6c53  class SphericalS
-0002c980: 7572 6661 6365 2853 7572 6661 6365 3344  urface(Surface3D
-0002c990: 436f 6c6c 6563 7469 6f6e 2920 3a0d 0a20  Collection) :.. 
-0002c9a0: 2020 2022 2222 0d0a 2020 2020 5370 6865     """..    Sphe
-0002c9b0: 7269 6361 6c20 3344 2073 7572 6661 6365  rical 3D surface
-0002c9c0: 2069 6e20 7370 6865 7269 6361 6c20 636f   in spherical co
-0002c9d0: 6f72 6469 6e61 7465 732e 0d0a 0d0a 2020  ordinates.....  
-0002c9e0: 2020 4d65 7468 6f64 7320 6172 6520 696e    Methods are in
-0002c9f0: 6865 7269 7465 6420 6672 6f6d 2074 6865  herited from the
-0002ca00: 2053 7572 6661 6365 3344 436f 6c6c 6563   Surface3DCollec
-0002ca10: 7469 6f6e 2e0d 0a20 2020 2053 7068 6572  tion...    Spher
-0002ca20: 6963 616c 2073 7572 6661 6365 2067 656f  ical surface geo
-0002ca30: 6d65 7472 6965 7320 6172 6520 6372 6561  metries are crea
-0002ca40: 7465 6420 696e 2074 6869 7320 7375 6263  ted in this subc
-0002ca50: 6c61 7373 2e0d 0a0d 0a20 2020 2022 2222  lass.....    """
-0002ca60: 0d0a 0d0a 2020 2020 4073 7461 7469 636d  ....    @staticm
-0002ca70: 6574 686f 640d 0a20 2020 2064 6566 2072  ethod..    def r
-0002ca80: 616e 6428 7265 7a3d 302c 7365 6564 3d4e  and(rez=0,seed=N
-0002ca90: 6f6e 652c 6e61 6d65 3d4e 6f6e 652c 6b69  one,name=None,ki
-0002caa0: 6e64 3d4e 6f6e 652c 2a2a 6b61 7267 7329  nd=None,**kargs)
-0002cab0: 203a 0d0a 2020 2020 2020 2020 2222 220d   :..        """.
-0002cac0: 0a20 2020 2020 2020 2053 7068 6572 6963  .        Spheric
-0002cad0: 616c 5375 7266 6163 6520 7769 7468 2072  alSurface with r
-0002cae0: 616e 646f 6d20 7472 6961 6e67 756c 6172  andom triangular
-0002caf0: 2066 6163 6573 2e0d 0a0d 0a20 2020 2020   faces.....     
-0002cb00: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
-0002cb10: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-0002cb20: 2d0d 0a20 2020 2020 2020 2072 657a 203a  -..        rez :
-0002cb30: 206e 756d 6265 722c 206f 7074 696f 6e61   number, optiona
-0002cb40: 6c2c 2064 6566 6175 6c74 3a20 300d 0a20  l, default: 0.. 
-0002cb50: 2020 2020 2020 2020 2020 204e 756d 6265             Numbe
-0002cb60: 7220 6f66 2027 7265 6375 7273 6976 6527  r of 'recursive'
-0002cb70: 2073 7562 6469 7669 7369 6f6e 7320 6f66   subdivisions of
-0002cb80: 2074 6865 2074 7269 616e 6775 6c61 7465   the triangulate
-0002cb90: 6420 6261 7365 2066 6163 6573 2e0d 0a20  d base faces... 
-0002cba0: 2020 2020 2020 2020 2020 2052 657a 2076             Rez v
-0002cbb0: 616c 7565 7320 7261 6e67 6520 6672 6f6d  alues range from
-0002cbc0: 2030 2074 6f20 372e 0d0a 0d0a 2020 2020   0 to 7.....    
-0002cbd0: 2020 2020 7365 6564 203a 2069 6e74 6567      seed : integ
-0002cbe0: 6572 2c20 6f70 7469 6f6e 616c 2c20 6465  er, optional, de
-0002cbf0: 6661 756c 743a 204e 6f6e 650d 0a20 2020  fault: None..   
-0002cc00: 2020 2020 2020 2020 2041 6e20 696e 6974           An init
-0002cc10: 6961 6c69 7a61 7469 6f6e 2073 6565 6420  ialization seed 
-0002cc20: 666f 7220 7261 6e64 6f6d 2067 656e 6572  for random gener
-0002cc30: 6174 696f 6e2e 0d0a 0d0a 2020 2020 2020  ation.....      
-0002cc40: 2020 6e61 6d65 203a 2073 7472 696e 672c    name : string,
-0002cc50: 206f 7074 696f 6e61 6c2c 2064 6566 6175   optional, defau
-0002cc60: 6c74 3a20 4e6f 6e65 2e0d 0a20 2020 2020  lt: None...     
-0002cc70: 2020 2020 2020 2044 6573 6372 6970 7469         Descripti
-0002cc80: 7665 2069 6465 6e74 6966 6965 7220 666f  ve identifier fo
-0002cc90: 7220 7468 6520 6765 6f6d 6574 7279 2e0d  r the geometry..
-0002cca0: 0a0d 0a20 2020 2020 2020 206b 696e 6420  ...        kind 
-0002ccb0: 3a20 7374 7269 6e67 2c20 6f70 7469 6f6e  : string, option
-0002ccc0: 616c 2c20 6465 6661 756c 743a 204e 6f6e  al, default: Non
-0002ccd0: 650d 0a20 2020 2020 2020 2020 2020 2028  e..            (
-0002cce0: 7265 7365 7276 6564 2c20 6e6f 7420 696d  reserved, not im
-0002ccf0: 706c 656d 656e 7465 6429 200d 0a0d 0a20  plemented) .... 
-0002cd00: 2020 2020 2020 2052 6169 7365 730d 0a20         Raises.. 
-0002cd10: 2020 2020 2020 202d 2d2d 2d2d 2d0d 0a20         ------.. 
-0002cd20: 2020 2020 2020 2056 616c 7565 4572 726f         ValueErro
-0002cd30: 720d 0a20 2020 2020 2020 2020 2020 2049  r..            I
-0002cd40: 6620 7265 7a20 6973 206e 6f74 2061 6e20  f rez is not an 
-0002cd50: 696e 7465 6765 7220 696e 2072 616e 6765  integer in range
-0002cd60: 2030 2074 6f20 372e 0d0a 2020 2020 2020   0 to 7...      
-0002cd70: 2020 2020 2020 4966 2062 6173 6574 7970        If basetyp
-0002cd80: 6520 6973 206e 6f74 2072 6563 6f67 6e69  e is not recogni
-0002cd90: 7a65 6420 666f 7220 7468 6973 2073 7572  zed for this sur
-0002cda0: 6661 6365 2063 6f6e 7374 7275 6374 6f72  face constructor
-0002cdb0: 2e0d 0a0d 0a20 2020 2020 2020 204f 7468  .....        Oth
-0002cdc0: 6572 2050 6172 616d 6574 6572 730d 0a20  er Parameters.. 
-0002cdd0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-0002cde0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-0002cdf0: 202a 2a6b 7761 7267 730d 0a20 2020 2020   **kwargs..     
-0002ce00: 2020 2020 2020 2041 6c6c 206f 7468 6572         All other
-0002ce10: 2070 6172 616d 6574 6572 7320 6172 6520   parameters are 
-0002ce20: 7061 7373 6564 206f 6e20 746f 2027 7333  passed on to 's3
-0002ce30: 646c 6962 2e73 7572 6661 6365 2e53 7572  dlib.surface.Sur
-0002ce40: 6661 6365 3344 436f 6c6c 6563 7469 6f6e  face3DCollection
-0002ce50: 272e 0d0a 2020 2020 2020 2020 0d0a 2020  '...        ..  
-0002ce60: 2020 2020 2020 5265 7475 726e 730d 0a20        Returns.. 
-0002ce70: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0d0a         -------..
-0002ce80: 2020 2020 2020 2020 7375 7266 6163 6520          surface 
-0002ce90: 3a20 5370 6865 7269 6361 6c53 7572 6661  : SphericalSurfa
-0002cea0: 6365 206f 626a 6563 742e 0d0a 0d0a 2020  ce object.....  
-0002ceb0: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
-0002cec0: 2020 2023 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e     #............
-0002ced0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0002cee0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0002cef0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e0d 0a20  ............... 
-0002cf00: 2020 2020 2020 2064 6566 2072 616e 646f         def rando
-0002cf10: 6d5f 7369 6e44 6973 7428 7369 7a65 2920  m_sinDist(size) 
-0002cf20: 3a0d 0a20 2020 2020 2020 2020 2020 206e  :..            n
-0002cf30: 4c6f 6f70 2c6e 436f 6e74 726f 6c2c 7361  Loop,nControl,sa
-0002cf40: 6d70 6c65 7320 3d20 302c 2031 302a 2a36  mples = 0, 10**6
-0002cf50: 2c20 5b5d 0d0a 2020 2020 2020 2020 2020  , []..          
-0002cf60: 2020 7768 696c 6520 6c65 6e28 7361 6d70    while len(samp
-0002cf70: 6c65 7329 3c73 697a 6520 616e 6420 6e4c  les)<size and nL
-0002cf80: 6f6f 703c 6e43 6f6e 7472 6f6c 3a0d 0a20  oop<nControl:.. 
-0002cf90: 2020 2020 2020 2020 2020 2020 2020 2078                 x
-0002cfa0: 3d6e 702e 7261 6e64 6f6d 2e72 616e 646f  =np.random.rando
-0002cfb0: 6d5f 7361 6d70 6c65 2829 0d0a 2020 2020  m_sample()..    
-0002cfc0: 2020 2020 2020 2020 2020 2020 7072 6f62              prob
-0002cfd0: 3d6e 702e 7369 6e28 782a 6e70 2e70 6929  =np.sin(x*np.pi)
-0002cfe0: 2f32 0d0a 2020 2020 2020 2020 2020 2020  /2..            
-0002cff0: 2020 2020 6173 7365 7274 2070 726f 623e      assert prob>
-0002d000: 3d30 2061 6e64 2070 726f 623c 3d31 0d0a  =0 and prob<=1..
-0002d010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d020: 6966 206e 702e 7261 6e64 6f6d 2e72 616e  if np.random.ran
-0002d030: 646f 6d5f 7361 6d70 6c65 2829 203c 3d70  dom_sample() <=p
-0002d040: 726f 623a 2073 616d 706c 6573 202b 3d20  rob: samples += 
-0002d050: 5b78 5d0d 0a20 2020 2020 2020 2020 2020  [x]..           
-0002d060: 2020 2020 206e 4c6f 6f70 2b3d 310d 0a20       nLoop+=1.. 
-0002d070: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0002d080: 6e20 6e70 2e61 7272 6179 2873 616d 706c  n np.array(sampl
-0002d090: 6573 290d 0a20 2020 2020 2020 2023 2e2e  es)..        #..
-0002d0a0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0002d0b0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0002d0c0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0002d0d0: 2e2e 2e2e 2e2e 2e0d 0a0d 0a20 2020 2020  ...........     
-0002d0e0: 2020 2069 6620 6e6f 7420 6973 696e 7374     if not isinst
-0002d0f0: 616e 6365 2872 657a 2c20 2869 6e74 2c20  ance(rez, (int, 
-0002d100: 666c 6f61 7429 2920 3a0d 0a20 2020 2020  float)) :..     
-0002d110: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-0002d120: 7565 4572 726f 7228 2749 6e63 6f72 7265  ueError('Incorre
-0002d130: 6374 2072 657a 2074 7970 652c 206d 7573  ct rez type, mus
-0002d140: 7420 6265 2061 206e 756d 6265 722e 2729  t be a number.')
-0002d150: 0d0a 2020 2020 2020 2020 6966 2028 7265  ..        if (re
-0002d160: 7a3c 3029 206f 7220 2872 657a 3e5f 4d41  z<0) or (rez>_MA
-0002d170: 5852 455a 2920 3a0d 0a20 2020 2020 2020  XREZ) :..       
-0002d180: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-0002d190: 4572 726f 7228 2749 6e63 6f72 7265 7374  Error('Incorrest
-0002d1a0: 2072 657a 206f 6620 7b7d 2c20 6d75 7374   rez of {}, must
-0002d1b0: 2062 6520 6120 6e75 6d62 6572 2c20 3020   be a number, 0 
-0002d1c0: 3c3d 2072 657a 203c 3d20 7b7d 272e 666f  <= rez <= {}'.fo
-0002d1d0: 726d 6174 2872 657a 2c5f 4d41 5852 455a  rmat(rez,_MAXREZ
-0002d1e0: 2929 0d0a 0d0a 2020 2020 2020 2020 6966  ))....        if
-0002d1f0: 2073 6565 6420 6973 206e 6f74 204e 6f6e   seed is not Non
-0002d200: 6520 3a0d 0a20 2020 2020 2020 2020 2020  e :..           
-0002d210: 2069 6620 6e6f 7420 6973 696e 7374 616e   if not isinstan
-0002d220: 6365 2873 6565 642c 2069 6e74 2920 3a0d  ce(seed, int) :.
-0002d230: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002d240: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-0002d250: 7228 2749 6e63 6f72 7265 6374 2073 6565  r('Incorrect see
-0002d260: 6420 7479 7065 2c20 6d75 7374 2062 6120  d type, must ba 
-0002d270: 6f66 2074 7970 6520 696e 7427 2920 0d0a  of type int') ..
-0002d280: 2020 2020 2020 2020 2020 2020 6e70 2e72              np.r
-0002d290: 616e 646f 6d2e 7365 6564 2873 6565 6429  andom.seed(seed)
-0002d2a0: 0d0a 0d0a 2020 2020 2020 2020 4e20 3d20  ....        N = 
-0002d2b0: 696e 7428 3230 2a28 342a 2a72 657a 292f  int(20*(4**rez)/
-0002d2c0: 3220 2b20 3229 0d0a 2020 2020 2020 2020  2 + 2)..        
-0002d2d0: 7220 3d20 6e70 2e6f 6e65 7328 204e 2029  r = np.ones( N )
-0002d2e0: 0d0a 2020 2020 2020 2020 7420 3d20 322a  ..        t = 2*
-0002d2f0: 6e70 2e70 692a 6e70 2e72 616e 646f 6d2e  np.pi*np.random.
-0002d300: 7261 6e64 2820 4e20 290d 0a20 2020 2020  rand( N )..     
-0002d310: 2020 2070 203d 206e 702e 7069 2a72 616e     p = np.pi*ran
-0002d320: 646f 6d5f 7369 6e44 6973 7428 204e 2029  dom_sinDist( N )
-0002d330: 0d0a 2020 2020 2020 2020 6461 7461 203d  ..        data =
-0002d340: 2053 7068 6572 6963 616c 5375 7266 6163   SphericalSurfac
-0002d350: 652e 636f 6f72 5f63 6f6e 7665 7274 285b  e.coor_convert([
-0002d360: 722c 742c 705d 2c54 7275 6529 2e54 0d0a  r,t,p],True).T..
-0002d370: 2020 2020 2020 2020 6875 6c6c 7375 7266          hullsurf
-0002d380: 203d 2053 7572 6661 6365 3344 436f 6c6c   = Surface3DColl
-0002d390: 6563 7469 6f6e 2e63 6875 6c6c 2864 6174  ection.chull(dat
-0002d3a0: 6129 0d0a 0d0a 2020 2020 2020 2020 7375  a)....        su
-0002d3b0: 7266 6163 6520 3d20 5370 6865 7269 6361  rface = Spherica
-0002d3c0: 6c53 7572 6661 6365 286e 616d 653d 6e61  lSurface(name=na
-0002d3d0: 6d65 2c2a 2a6b 6172 6773 2920 2023 2073  me,**kargs)  # s
-0002d3e0: 6574 2074 6f20 7468 6520 636c 6173 7320  et to the class 
-0002d3f0: 6465 6661 756c 7420 6f62 6a65 6374 0d0a  default object..
-0002d400: 2020 2020 2020 2020 2320 7265 7365 7420          # reset 
-0002d410: 7665 7274 732c 2066 6163 6549 6e64 6963  verts, faceIndic
-0002d420: 6573 2061 6e64 2065 6467 6573 2028 7265  es and edges (re
-0002d430: 7461 696e 2063 6c61 7373 2063 6f6f 7264  tain class coord
-0002d440: 696e 6174 6520 7379 7374 656d 292e 0d0a  inate system)...
-0002d450: 2020 2020 2020 2020 7665 7274 7320 3d20          verts = 
-0002d460: 6875 6c6c 7375 7266 2e76 6572 7465 7843  hullsurf.vertexC
-0002d470: 6f6f 720d 0a20 2020 2020 2020 2066 6163  oor..        fac
-0002d480: 6549 6e64 6963 6573 203d 2068 756c 6c73  eIndices = hulls
-0002d490: 7572 662e 6676 496e 6469 6365 730d 0a0d  urf.fvIndices...
-0002d4a0: 0a20 2020 2020 2020 2073 7572 6661 6365  .        surface
-0002d4b0: 2e76 6572 7465 7843 6f6f 7220 3d20 7665  .vertexCoor = ve
-0002d4c0: 7274 730d 0a20 2020 2020 2020 2073 7572  rts..        sur
-0002d4d0: 6661 6365 2e66 7649 6e64 6963 6573 203d  face.fvIndices =
-0002d4e0: 2066 6163 6549 6e64 6963 6573 0d0a 2020   faceIndices..  
-0002d4f0: 2020 2020 2020 7375 7266 6163 652e 6576        surface.ev
-0002d500: 496e 6469 6365 7320 3d20 7375 7266 6163  Indices = surfac
-0002d510: 652e 5f67 6574 5f65 6467 6573 5f66 726f  e._get_edges_fro
-0002d520: 6d5f 6661 6365 7328 6661 6365 496e 6469  m_faces(faceIndi
-0002d530: 6365 7329 0d0a 2020 2020 2020 2020 7375  ces)..        su
-0002d540: 7266 6163 652e 7666 496e 6469 6365 734c  rface.vfIndicesL
-0002d550: 6973 7420 3d20 7375 7266 6163 652e 5f76  ist = surface._v
-0002d560: 6572 7465 7843 6f6d 6d6f 6e46 6163 6549  ertexCommonFaceI
-0002d570: 6e64 6963 6573 2829 0d0a 2020 2020 2020  ndices()..      
-0002d580: 2020 7375 7266 6163 652e 6566 496e 6469    surface.efIndi
-0002d590: 6365 734c 6973 7420 3d20 7375 7266 6163  cesList = surfac
-0002d5a0: 652e 5f65 6467 6543 6f6d 6d6f 6e46 6163  e._edgeCommonFac
-0002d5b0: 6549 6e64 6963 6573 2829 0d0a 2020 2020  eIndices()..    
-0002d5c0: 2020 2020 7375 7266 6163 652e 7365 745f      surface.set_
-0002d5d0: 7665 7274 7328 2076 6572 7473 5b66 6163  verts( verts[fac
-0002d5e0: 6549 6e64 6963 6573 5d20 290d 0a20 2020  eIndices] )..   
-0002d5f0: 2020 2020 2073 7572 6661 6365 2e5f 7365       surface._se
-0002d600: 745f 6765 6f6d 6574 7269 635f 626f 756e  t_geometric_boun
-0002d610: 6473 2829 0d0a 2020 2020 2020 2020 7375  ds()..        su
-0002d620: 7266 6163 652e 5f72 657a 203d 2073 7472  rface._rez = str
-0002d630: 2872 657a 2920 6966 2069 7369 6e73 7461  (rez) if isinsta
-0002d640: 6e63 6528 7265 7a2c 696e 7429 2065 6c73  nce(rez,int) els
-0002d650: 6520 277b 3a2e 3166 7d27 2e66 6f72 6d61  e '{:.1f}'.forma
-0002d660: 7428 7265 7a29 0d0a 2020 2020 2020 2020  t(rez)..        
-0002d670: 7375 7266 6163 652e 5f62 6173 6574 7970  surface._basetyp
-0002d680: 6520 3d20 2772 616e 645f 272b 7374 7228  e = 'rand_'+str(
-0002d690: 7365 6564 290d 0a20 2020 2020 2020 2072  seed)..        r
-0002d6a0: 6574 7572 6e20 7375 7266 6163 650d 0a0d  eturn surface...
-0002d6b0: 0a20 2020 2040 7374 6174 6963 6d65 7468  .    @staticmeth
-0002d6c0: 6f64 0d0a 2020 2020 6465 6620 706c 6174  od..    def plat
-0002d6d0: 6f6e 6963 2872 657a 3d30 2c62 6173 6574  onic(rez=0,baset
-0002d6e0: 7970 653d 4e6f 6e65 2c6e 616d 653d 4e6f  ype=None,name=No
-0002d6f0: 6e65 2c20 2a2a 6b77 6172 6773 2920 3a0d  ne, **kwargs) :.
-0002d700: 0a20 2020 2020 2020 2022 2222 506c 6174  .        """Plat
-0002d710: 6f6e 6963 2053 6f6c 6964 2073 7572 6661  onic Solid surfa
-0002d720: 6365 732e 2222 220d 0a20 2020 2020 2020  ces."""..       
-0002d730: 2023 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e   #..............
-0002d740: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0002d750: 2e2e 2e2e 2e2e 2e0d 0a20 2020 2020 2020  .........       
-0002d760: 2064 6566 2066 6576 5f63 7562 655f 6128   def fev_cube_a(
-0002d770: 2920 3a0d 0a20 2020 2020 2020 2020 2020  ) :..           
-0002d780: 2076 203d 205b 205b 2d31 2c2d 312c 2d31   v = [ [-1,-1,-1
-0002d790: 5d2c 5b2d 312c 2031 2c2d 315d 2c5b 2031  ],[-1, 1,-1],[ 1
-0002d7a0: 2c20 312c 2d31 5d2c 5b20 312c 2d31 2c2d  , 1,-1],[ 1,-1,-
-0002d7b0: 315d 2c0d 0a20 2020 2020 2020 2020 2020  1],..           
-0002d7c0: 2020 2020 2020 205b 2d31 2c2d 312c 2031         [-1,-1, 1
-0002d7d0: 5d2c 5b2d 312c 2031 2c20 315d 2c5b 2031  ],[-1, 1, 1],[ 1
-0002d7e0: 2c20 312c 2031 5d2c 5b20 312c 2d31 2c20  , 1, 1],[ 1,-1, 
-0002d7f0: 315d 205d 0d0a 2020 2020 2020 2020 2020  1] ]..          
-0002d800: 2020 6620 3d20 5b20 5b30 2c31 2c32 2c33    f = [ [0,1,2,3
-0002d810: 5d2c 5b34 2c37 2c36 2c35 5d2c 5b30 2c33  ],[4,7,6,5],[0,3
-0002d820: 2c37 2c34 5d2c 5b33 2c32 2c36 2c37 5d2c  ,7,4],[3,2,6,7],
-0002d830: 5b32 2c31 2c35 2c36 5d2c 5b31 2c30 2c34  [2,1,5,6],[1,0,4
-0002d840: 2c35 5d5d 0d0a 2020 2020 2020 2020 2020  ,5]]..          
-0002d850: 2020 6520 3d20 5b20 5b33 2c32 5d2c 5b32    e = [ [3,2],[2
-0002d860: 2c31 5d2c 5b31 2c30 5d2c 5b30 2c33 5d2c  ,1],[1,0],[0,3],
-0002d870: 205b 372c 365d 2c5b 362c 355d 2c5b 352c   [7,6],[6,5],[5,
-0002d880: 345d 2c5b 342c 375d 2c20 5b30 2c34 5d2c  4],[4,7], [0,4],
-0002d890: 5b33 2c37 5d2c 5b32 2c36 5d2c 5b31 2c35  [3,7],[2,6],[1,5
-0002d8a0: 5d5d 0d0a 2020 2020 2020 2020 2020 2020  ]]..            
-0002d8b0: 7265 7475 726e 206e 702e 6172 7261 7928  return np.array(
-0002d8c0: 7629 2c6e 702e 6172 7261 7928 6629 2c6e  v),np.array(f),n
-0002d8d0: 702e 6172 7261 7928 6529 0d0a 2020 2020  p.array(e)..    
-0002d8e0: 2020 2020 6465 6620 5f70 7265 5472 6961      def _preTria
-0002d8f0: 6e67 756c 6174 6544 6f64 6f63 2876 2c66  ngulateDodoc(v,f
-0002d900: 2c65 2c66 6329 203a 0d0a 2020 2020 2020  ,e,fc) :..      
-0002d910: 2020 2020 2020 2320 2873 7065 6369 616c        # (special
-0002d920: 2043 6173 6529 0d0a 2020 2020 2020 2020   Case)..        
-0002d930: 2020 2020 2320 4f6e 6c79 2075 7365 6420      # Only used 
-0002d940: 666f 7220 7265 7a3d 3120 6f66 2061 2070  for rez=1 of a p
-0002d950: 6c61 746f 6e69 6320 646f 6465 6361 6865  latonic dodecahe
-0002d960: 6472 6f6e 2e20 4561 6368 2070 656e 7461  dron. Each penta
-0002d970: 676f 6e0d 0a20 2020 2020 2020 2020 2020  gon..           
-0002d980: 2023 2069 7320 6272 6f6b 656e 2069 6e74   # is broken int
-0002d990: 6f20 3520 6973 6f63 656c 6573 2074 7269  o 5 isoceles tri
-0002d9a0: 616e 676c 6573 2066 726f 6d20 6120 6365  angles from a ce
-0002d9b0: 6e74 6572 6564 2076 6572 7465 782e 0d0a  ntered vertex...
-0002d9c0: 2020 2020 2020 2020 2020 2020 7375 6246              subF
-0002d9d0: 6163 6549 6e64 6963 6573 2c73 7562 4564  aceIndices,subEd
-0002d9e0: 6765 496e 6469 6365 7320 3d20 5b5d 2c5b  geIndices = [],[
-0002d9f0: 5d0d 0a20 2020 2020 2020 2020 2020 206e  ]..            n
-0002da00: 6577 436f 6f72 732c 6e65 7743 6f6c 6f72  ewCoors,newColor
-0002da10: 203d 205b 5d2c 5b5d 0d0a 2020 2020 2020   = [],[]..      
-0002da20: 2020 2020 2020 6e76 496e 7820 3d20 6c65        nvInx = le
-0002da30: 6e28 7629 0d0a 2020 2020 2020 2020 2020  n(v)..          
-0002da40: 2020 666f 7220 692c 2066 6163 6520 696e    for i, face in
-0002da50: 2065 6e75 6d65 7261 7465 2866 2920 3a0d   enumerate(f) :.
-0002da60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002da70: 2066 6f72 206e 3020 696e 2072 616e 6765   for n0 in range
-0002da80: 2835 2920 3a0d 0a20 2020 2020 2020 2020  (5) :..         
-0002da90: 2020 2020 2020 2020 2020 206e 3120 3d20             n1 = 
-0002daa0: 286e 302b 3129 2535 0d0a 2020 2020 2020  (n0+1)%5..      
-0002dab0: 2020 2020 2020 2020 2020 2020 2020 7375                su
-0002dac0: 6246 6163 6549 6e64 6963 6573 2e61 7070  bFaceIndices.app
-0002dad0: 656e 6428 205b 6661 6365 5b6e 305d 2c66  end( [face[n0],f
-0002dae0: 6163 655b 6e31 5d2c 6e76 496e 782b 695d  ace[n1],nvInx+i]
-0002daf0: 2029 0d0a 2020 2020 2020 2020 2020 2020   )..            
-0002db00: 2020 2020 2020 2020 7375 6245 6467 6549          subEdgeI
-0002db10: 6e64 6963 6573 2e61 7070 656e 6428 205b  ndices.append( [
-0002db20: 6661 6365 5b6e 305d 2c6e 7649 6e78 2b69  face[n0],nvInx+i
-0002db30: 5d20 290d 0a20 2020 2020 2020 2020 2020  ] )..           
-0002db40: 2020 2020 206e 6577 436f 6f72 732e 6170       newCoors.ap
-0002db50: 7065 6e64 2820 6e70 2e73 756d 2876 5b66  pend( np.sum(v[f
-0002db60: 6163 655d 2c20 6178 6973 3d30 292f 3520  ace], axis=0)/5 
-0002db70: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0002db80: 2020 206e 6577 436f 6c6f 7220 2b3d 205b     newColor += [
-0002db90: 6663 5b69 5d5d 2a35 0d0a 2020 2020 2020  fc[i]]*5..      
-0002dba0: 2020 2020 2020 6e65 7776 6572 7473 203d        newverts =
-0002dbb0: 206e 702e 6170 7065 6e64 2876 2c6e 6577   np.append(v,new
-0002dbc0: 436f 6f72 732c 6178 6973 3d30 2920 0d0a  Coors,axis=0) ..
-0002dbd0: 2020 2020 2020 2020 2020 2020 6e65 7766              newf
-0002dbe0: 7649 6e78 203d 206e 702e 6172 7261 7928  vInx = np.array(
-0002dbf0: 7375 6246 6163 6549 6e64 6963 6573 2920  subFaceIndices) 
-0002dc00: 0d0a 2020 2020 2020 2020 2020 2020 6e65  ..            ne
-0002dc10: 7745 7649 6e78 203d 206e 702e 6170 7065  wEvInx = np.appe
-0002dc20: 6e64 2865 2c73 7562 4564 6765 496e 6469  nd(e,subEdgeIndi
-0002dc30: 6365 732c 6178 6973 3d30 2920 0d0a 2020  ces,axis=0) ..  
-0002dc40: 2020 2020 2020 2020 2020 6e65 7743 6f6c            newCol
-0002dc50: 6f72 203d 206e 702e 6172 7261 7928 6e65  or = np.array(ne
-0002dc60: 7743 6f6c 6f72 290d 0a20 2020 2020 2020  wColor)..       
-0002dc70: 2020 2020 2072 6574 7572 6e20 6e65 7776       return newv
-0002dc80: 6572 7473 2c6e 6577 6676 496e 782c 6e65  erts,newfvInx,ne
-0002dc90: 7745 7649 6e78 2c6e 6577 436f 6c6f 720d  wEvInx,newColor.
-0002dca0: 0a20 2020 2020 2020 2023 2e2e 2e2e 2e2e  .        #......
-0002dcb0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0002dcc0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e0d  ................
-0002dcd0: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
-0002dce0: 6973 696e 7374 616e 6365 2872 657a 2c20  isinstance(rez, 
-0002dcf0: 696e 7429 203a 0d0a 2020 2020 2020 2020  int) :..        
-0002dd00: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-0002dd10: 7272 6f72 2827 496e 636f 7272 6563 7420  rror('Incorrect 
-0002dd20: 7265 7a20 7479 7065 2c20 6d75 7374 2062  rez type, must b
-0002dd30: 6120 6f66 2074 7970 6520 696e 7427 290d  a of type int').
-0002dd40: 0a20 2020 2020 2020 2069 6620 2872 657a  .        if (rez
-0002dd50: 3c30 2920 6f72 2028 7265 7a3e 5f4d 4158  <0) or (rez>_MAX
-0002dd60: 5245 5a29 203a 0d0a 2020 2020 2020 2020  REZ) :..        
-0002dd70: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-0002dd80: 7272 6f72 2827 496e 636f 7272 6573 7420  rror('Incorrest 
-0002dd90: 7265 7a20 6f66 207b 7d2c 206d 7573 7420  rez of {}, must 
-0002dda0: 6265 2061 6e20 696e 742c 2030 203c 3d20  be an int, 0 <= 
-0002ddb0: 7265 7a20 3c3d 207b 7d27 2e66 6f72 6d61  rez <= {}'.forma
-0002ddc0: 7428 7265 7a2c 5f4d 4158 5245 5a29 290d  t(rez,_MAXREZ)).
-0002ddd0: 0a20 2020 2020 2020 2069 6620 6261 7365  .        if base
-0002dde0: 7479 7065 2069 7320 4e6f 6e65 203a 2062  type is None : b
-0002ddf0: 6173 6574 7970 6520 3d20 5370 6865 7269  asetype = Spheri
-0002de00: 6361 6c53 7572 6661 6365 2e5f 6465 6661  calSurface._defa
-0002de10: 756c 745f 6261 7365 0d0a 0d0a 2020 2020  ult_base....    
-0002de20: 2020 2020 6261 7365 4469 6374 203d 207b      baseDict = {
-0002de30: 2027 7465 7472 6127 3a22 7465 7472 6168   'tetra':"tetrah
-0002de40: 6564 726f 6e22 2c27 6f63 7461 273a 226f  edron",'octa':"o
-0002de50: 6374 6168 6564 726f 6e22 2c0d 0a20 2020  ctahedron",..   
-0002de60: 2020 2020 2020 2020 2027 6963 6f73 6127           'icosa'
-0002de70: 3a22 6963 6f73 6168 6564 726f 6e22 2c27  :"icosahedron",'
-0002de80: 6375 6265 273a 2263 7562 6522 2c27 646f  cube':"cube",'do
-0002de90: 6465 6361 273a 2264 6f64 6563 6168 6564  deca':"dodecahed
-0002dea0: 726f 6e22 2c0d 0a20 2020 2020 2020 2020  ron",..         
-0002deb0: 2020 2027 6375 6265 5f61 273a 2263 7562     'cube_a':"cub
-0002dec0: 655f 616c 6967 6e22 2020 7d0d 0a20 2020  e_align"  }..   
-0002ded0: 2020 2020 2062 6173 6543 6865 636b 203d       baseCheck =
-0002dee0: 2062 6173 6544 6963 742e 6b65 7973 2829   baseDict.keys()
-0002def0: 0d0a 0d0a 2020 2020 2020 2020 6966 2062  ....        if b
-0002df00: 6173 6574 7970 6520 6e6f 7420 696e 2062  asetype not in b
-0002df10: 6173 6543 6865 636b 203a 0d0a 2020 2020  aseCheck :..    
-0002df20: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-0002df30: 6c75 6545 7272 6f72 2827 4261 7365 7479  lueError('Basety
-0002df40: 7065 207b 7d20 6973 206e 6f74 2072 6563  pe {} is not rec
-0002df50: 6f67 6e69 7a65 642e 2050 6f73 7369 626c  ognized. Possibl
-0002df60: 6520 7661 6c75 6573 2061 7265 3a20 7b7d  e values are: {}
-0002df70: 272e 666f 726d 6174 2862 6173 6574 7970  '.format(basetyp
-0002df80: 652c 6261 7365 4368 6563 6b29 2029 0d0a  e,baseCheck) )..
-0002df90: 0d0a 2020 2020 2020 2020 6966 2062 6173  ..        if bas
-0002dfa0: 6574 7970 6520 6973 2027 6375 6265 5f61  etype is 'cube_a
-0002dfb0: 2720 3a0d 0a20 2020 2020 2020 2020 2020  ' :..           
-0002dfc0: 2073 7572 6661 6365 203d 2053 7068 6572   surface = Spher
-0002dfd0: 6963 616c 5375 7266 6163 6528 6261 7365  icalSurface(base
-0002dfe0: 7479 7065 3d27 6375 6265 272c 6e61 6d65  type='cube',name
-0002dff0: 3d6e 616d 652c 202a 2a6b 7761 7267 7329  =name, **kwargs)
-0002e000: 0d0a 2020 2020 2020 2020 656c 7365 203a  ..        else :
-0002e010: 2020 2020 0d0a 2020 2020 2020 2020 2020      ..          
-0002e020: 2020 7375 7266 6163 6520 3d20 5370 6865    surface = Sphe
-0002e030: 7269 6361 6c53 7572 6661 6365 2862 6173  ricalSurface(bas
-0002e040: 6574 7970 653d 6261 7365 7479 7065 2c6e  etype=basetype,n
-0002e050: 616d 653d 6e61 6d65 2c20 2a2a 6b77 6172  ame=name, **kwar
-0002e060: 6773 290d 0a0d 0a20 2020 2020 2020 2073  gs)....        s
-0002e070: 7572 6661 6365 2e5f 7265 7a20 3d20 7265  urface._rez = re
-0002e080: 7a0d 0a0d 0a20 2020 2020 2020 2069 6620  z....        if 
-0002e090: 6261 7365 7479 7065 2069 7320 2763 7562  basetype is 'cub
-0002e0a0: 655f 6127 203a 0d0a 2020 2020 2020 2020  e_a' :..        
-0002e0b0: 2020 2020 762c 662c 6520 3d20 6665 765f      v,f,e = fev_
-0002e0c0: 6375 6265 5f61 2829 0d0a 2020 2020 2020  cube_a()..      
-0002e0d0: 2020 2020 2020 7375 7266 6163 652e 7665        surface.ve
-0002e0e0: 7274 6578 436f 6f72 203d 2076 0d0a 2020  rtexCoor = v..  
-0002e0f0: 2020 2020 2020 2020 2020 7375 7266 6163            surfac
-0002e100: 652e 6676 496e 6469 6365 7320 3d20 660d  e.fvIndices = f.
-0002e110: 0a20 2020 2020 2020 2020 2020 2073 7572  .            sur
-0002e120: 6661 6365 2e65 7649 6e64 6963 6573 203d  face.evIndices =
-0002e130: 2065 0d0a 2020 2020 2020 2020 2020 2020   e..            
-0002e140: 7375 7266 6163 652e 7666 496e 6469 6365  surface.vfIndice
-0002e150: 734c 6973 7420 3d20 7375 7266 6163 652e  sList = surface.
-0002e160: 5f76 6572 7465 7843 6f6d 6d6f 6e46 6163  _vertexCommonFac
-0002e170: 6549 6e64 6963 6573 2829 0d0a 2020 2020  eIndices()..    
-0002e180: 2020 2020 2020 2020 7375 7266 6163 652e          surface.
-0002e190: 6566 496e 6469 6365 734c 6973 7420 3d20  efIndicesList = 
-0002e1a0: 7375 7266 6163 652e 5f65 6467 6543 6f6d  surface._edgeCom
-0002e1b0: 6d6f 6e46 6163 6549 6e64 6963 6573 2829  monFaceIndices()
-0002e1c0: 0d0a 2020 2020 2020 2020 2020 2020 7375  ..            su
-0002e1d0: 7266 6163 652e 7365 745f 7665 7274 7328  rface.set_verts(
-0002e1e0: 2076 5b66 5d20 290d 0a20 2020 2020 2020   v[f] )..       
-0002e1f0: 2069 6620 6261 7365 7479 7065 2069 7320   if basetype is 
-0002e200: 2763 7562 6527 203a 0d0a 2020 2020 2020  'cube' :..      
-0002e210: 2020 2020 2020 762c 662c 6520 3d20 5370        v,f,e = Sp
-0002e220: 6865 7269 6361 6c53 7572 6661 6365 2e67  hericalSurface.g
-0002e230: 6574 5f63 7562 6528 290d 0a20 2020 2020  et_cube()..     
-0002e240: 2020 2020 2020 2073 7572 6661 6365 2e76         surface.v
-0002e250: 6572 7465 7843 6f6f 7220 3d20 760d 0a20  ertexCoor = v.. 
-0002e260: 2020 2020 2020 2020 2020 2073 7572 6661             surfa
-0002e270: 6365 2e66 7649 6e64 6963 6573 203d 2066  ce.fvIndices = f
-0002e280: 0d0a 2020 2020 2020 2020 2020 2020 7375  ..            su
-0002e290: 7266 6163 652e 6576 496e 6469 6365 7320  rface.evIndices 
-0002e2a0: 3d20 650d 0a20 2020 2020 2020 2020 2020  = e..           
-0002e2b0: 2073 7572 6661 6365 2e76 6649 6e64 6963   surface.vfIndic
-0002e2c0: 6573 4c69 7374 203d 2073 7572 6661 6365  esList = surface
-0002e2d0: 2e5f 7665 7274 6578 436f 6d6d 6f6e 4661  ._vertexCommonFa
-0002e2e0: 6365 496e 6469 6365 7328 290d 0a20 2020  ceIndices()..   
-0002e2f0: 2020 2020 2020 2020 2073 7572 6661 6365           surface
-0002e300: 2e65 6649 6e64 6963 6573 4c69 7374 203d  .efIndicesList =
-0002e310: 2073 7572 6661 6365 2e5f 6564 6765 436f   surface._edgeCo
-0002e320: 6d6d 6f6e 4661 6365 496e 6469 6365 7328  mmonFaceIndices(
-0002e330: 290d 0a20 2020 2020 2020 2020 2020 2073  )..            s
-0002e340: 7572 6661 6365 2e73 6574 5f76 6572 7473  urface.set_verts
-0002e350: 2820 765b 665d 2029 0d0a 2020 2020 2020  ( v[f] )..      
-0002e360: 2020 6966 2062 6173 6574 7970 6520 6973    if basetype is
-0002e370: 2027 646f 6465 6361 2720 3a0d 0a20 2020   'dodeca' :..   
-0002e380: 2020 2020 2020 2020 2076 2c66 2c65 203d           v,f,e =
-0002e390: 2053 7068 6572 6963 616c 5375 7266 6163   SphericalSurfac
-0002e3a0: 652e 6765 745f 646f 6465 6361 6865 6472  e.get_dodecahedr
-0002e3b0: 6f6e 2829 0d0a 2020 2020 2020 2020 2020  on()..          
-0002e3c0: 2020 6966 2072 657a 3e30 203a 0d0a 2020    if rez>0 :..  
-0002e3d0: 2020 2020 2020 2020 2020 2020 2020 6663                fc
-0002e3e0: 203d 2073 7572 6661 6365 2e5f 6661 6365   = surface._face
-0002e3f0: 636f 6c6f 7273 0d0a 2020 2020 2020 2020  colors..        
-0002e400: 2020 2020 2020 2020 762c 662c 652c 6663          v,f,e,fc
-0002e410: 203d 205f 7072 6554 7269 616e 6775 6c61   = _preTriangula
-0002e420: 7465 446f 646f 6328 762c 662c 652c 6663  teDodoc(v,f,e,fc
-0002e430: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0002e440: 2020 2073 7572 6661 6365 2e73 6574 5f66     surface.set_f
-0002e450: 6163 6563 6f6c 6f72 2866 6329 0d0a 2020  acecolor(fc)..  
-0002e460: 2020 2020 2020 2020 2020 2020 2020 7265                re
-0002e470: 7a20 2d3d 2031 0d0a 2020 2020 2020 2020  z -= 1..        
-0002e480: 2020 2020 7375 7266 6163 652e 7665 7274      surface.vert
-0002e490: 6578 436f 6f72 203d 2076 0d0a 2020 2020  exCoor = v..    
-0002e4a0: 2020 2020 2020 2020 7375 7266 6163 652e          surface.
-0002e4b0: 6676 496e 6469 6365 7320 3d20 660d 0a20  fvIndices = f.. 
-0002e4c0: 2020 2020 2020 2020 2020 2073 7572 6661             surfa
-0002e4d0: 6365 2e65 7649 6e64 6963 6573 203d 2065  ce.evIndices = e
-0002e4e0: 0d0a 2020 2020 2020 2020 2020 2020 7375  ..            su
-0002e4f0: 7266 6163 652e 7666 496e 6469 6365 734c  rface.vfIndicesL
-0002e500: 6973 7420 3d20 7375 7266 6163 652e 5f76  ist = surface._v
-0002e510: 6572 7465 7843 6f6d 6d6f 6e46 6163 6549  ertexCommonFaceI
-0002e520: 6e64 6963 6573 2829 0d0a 2020 2020 2020  ndices()..      
-0002e530: 2020 2020 2020 7375 7266 6163 652e 6566        surface.ef
-0002e540: 496e 6469 6365 734c 6973 7420 3d20 7375  IndicesList = su
-0002e550: 7266 6163 652e 5f65 6467 6543 6f6d 6d6f  rface._edgeCommo
-0002e560: 6e46 6163 6549 6e64 6963 6573 2829 0d0a  nFaceIndices()..
-0002e570: 2020 2020 2020 2020 2020 2020 7375 7266              surf
-0002e580: 6163 652e 7365 745f 7665 7274 7328 2076  ace.set_verts( v
-0002e590: 5b66 5d20 290d 0a20 2020 2020 2020 2073  [f] )..        s
-0002e5a0: 7572 6661 6365 2e5f 706f 7374 5072 6f63  urface._postProc
-0002e5b0: 5f73 7572 6661 6365 436f 6c6f 7273 2854  _surfaceColors(T
-0002e5c0: 7275 6529 0d0a 2020 2020 2020 2020 6966  rue)..        if
-0002e5d0: 2072 657a 203e 2030 203a 0d0a 2020 2020   rez > 0 :..    
-0002e5e0: 2020 2020 2020 2020 7375 7266 6163 652e          surface.
-0002e5f0: 7472 6961 6e67 756c 6174 6528 7265 7a29  triangulate(rez)
-0002e600: 0d0a 2020 2020 2020 0d0a 2020 2020 2020  ..      ..      
-0002e610: 2020 7375 7266 6163 652e 5f73 6574 5f67    surface._set_g
-0002e620: 656f 6d65 7472 6963 5f62 6f75 6e64 7328  eometric_bounds(
-0002e630: 290d 0a20 2020 2020 2020 2073 7572 6661  )..        surfa
-0002e640: 6365 2e5f 6261 7365 7479 7065 203d 2062  ce._basetype = b
-0002e650: 6173 6574 7970 6520 2b20 272a 2720 2020  asetype + '*'   
-0002e660: 0d0a 2020 2020 2020 2020 7375 7266 6163  ..        surfac
-0002e670: 652e 6e61 6d65 203d 2062 6173 6544 6963  e.name = baseDic
-0002e680: 745b 6261 7365 7479 7065 5d20 6966 206e  t[basetype] if n
-0002e690: 616d 6520 6973 204e 6f6e 6520 656c 7365  ame is None else
-0002e6a0: 204e 6f6e 650d 0a20 2020 2020 2020 2072   None..        r
-0002e6b0: 6574 7572 6e20 7375 7266 6163 650d 0a0d  eturn surface...
-0002e6c0: 0a20 2020 2040 7374 6174 6963 6d65 7468  .    @staticmeth
-0002e6d0: 6f64 0d0a 2020 2020 6465 6620 6765 745f  od..    def get_
-0002e6e0: 646f 6465 6361 6865 6472 6f6e 2829 203a  dodecahedron() :
-0002e6f0: 0d0a 2020 2020 2020 2020 2222 224e 756d  ..        """Num
-0002e700: 7079 2061 7272 6179 7320 6f66 2064 6f64  py arrays of dod
-0002e710: 6563 6168 6564 726f 6e20 7665 7274 6963  ecahedron vertic
-0002e720: 6573 2028 3230 2c33 2920 616e 6420 6661  es (20,3) and fa
-0002e730: 6365 2076 6572 7465 7820 696e 6469 6365  ce vertex indice
-0002e740: 7320 2831 322c 3529 0d0a 2020 2020 2020  s (12,5)..      
-0002e750: 2020 2020 2061 6e64 2065 6467 6520 7665       and edge ve
-0002e760: 7274 6578 2069 6e64 6963 6573 2028 3330  rtex indices (30
-0002e770: 2c32 290d 0a20 2020 2020 2020 2022 2222  ,2)..        """
-0002e780: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-0002e790: 2076 2c66 2c65 203d 2053 7068 6572 6963   v,f,e = Spheric
-0002e7a0: 616c 5375 7266 6163 652e 5f67 6574 5f70  alSurface._get_p
-0002e7b0: 6c61 746f 6e69 635f 736f 6c69 6473 5f64  latonic_solids_d
-0002e7c0: 6963 7469 6f6e 6172 7928 2764 6f64 6563  ictionary('dodec
-0002e7d0: 6127 290d 0a20 2020 2020 2020 2072 6574  a')..        ret
-0002e7e0: 7572 6e20 6e70 2e61 7272 6179 2876 292c  urn np.array(v),
-0002e7f0: 206e 702e 6172 7261 7928 6629 2c20 6e70   np.array(f), np
-0002e800: 2e61 7272 6179 2865 290d 0a0d 0a20 2020  .array(e)....   
-0002e810: 2040 7374 6174 6963 6d65 7468 6f64 0d0a   @staticmethod..
-0002e820: 2020 2020 6465 6620 6765 745f 6375 6265      def get_cube
-0002e830: 2829 203a 0d0a 2020 2020 2020 2020 2222  () :..        ""
-0002e840: 224e 756d 7079 2061 7272 6179 7320 6f66  "Numpy arrays of
-0002e850: 2063 7562 6520 7665 7274 6963 6573 2028   cube vertices (
-0002e860: 382c 3329 2061 6e64 2066 6163 6520 7665  8,3) and face ve
-0002e870: 7274 6578 2069 6e64 6963 6573 2036 2c35  rtex indices 6,5
-0002e880: 290d 0a20 2020 2020 2020 2020 2020 616e  )..           an
-0002e890: 6420 6564 6765 2076 6572 7465 7820 696e  d edge vertex in
-0002e8a0: 6469 6365 7320 2831 322c 3229 0d0a 2020  dices (12,2)..  
-0002e8b0: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
-0002e8c0: 2020 2076 2c66 2c65 203d 2053 7068 6572     v,f,e = Spher
-0002e8d0: 6963 616c 5375 7266 6163 652e 5f67 6574  icalSurface._get
-0002e8e0: 5f70 6c61 746f 6e69 635f 736f 6c69 6473  _platonic_solids
-0002e8f0: 5f64 6963 7469 6f6e 6172 7928 2763 7562  _dictionary('cub
-0002e900: 6527 290d 0a20 2020 2020 2020 2072 6574  e')..        ret
-0002e910: 7572 6e20 6e70 2e61 7272 6179 2876 292c  urn np.array(v),
-0002e920: 206e 702e 6172 7261 7928 6629 2c20 6e70   np.array(f), np
-0002e930: 2e61 7272 6179 2865 290d 0a0d 0a20 2020  .array(e)....   
-0002e940: 2040 7374 6174 6963 6d65 7468 6f64 0d0a   @staticmethod..
-0002e950: 2020 2020 6465 6620 5f67 6574 5f70 6c61      def _get_pla
-0002e960: 746f 6e69 635f 736f 6c69 6473 5f64 6963  tonic_solids_dic
-0002e970: 7469 6f6e 6172 7928 6765 7441 7272 6179  tionary(getArray
-0002e980: 7320 3d20 4e6f 6e65 2920 3a0d 0a20 2020  s = None) :..   
-0002e990: 2020 2020 2022 2222 436f 6e73 7472 7563       """Construc
-0002e9a0: 7473 2074 6865 2064 6963 7469 6f6e 6172  ts the dictionar
-0002e9b0: 7920 6f66 2062 6173 6520 7370 6865 7269  y of base spheri
-0002e9c0: 6361 6c20 7375 7266 6163 6520 6765 6f6d  cal surface geom
-0002e9d0: 6574 7269 6573 2e22 2222 0d0a 2020 2020  etries."""..    
-0002e9e0: 2020 2020 2320 2e2e 2e2e 2e2e 2e2e 2e2e      # ..........
-0002e9f0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0002ea00: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0002ea10: 2e2e 2e2e 2e2e 2e2e 2e2e 0d0a 2020 2020  ............    
-0002ea20: 2020 2020 6465 6620 6765 745f 6375 6265      def get_cube
-0002ea30: 2829 203a 0d0a 2020 2020 2020 2020 2020  () :..          
-0002ea40: 2020 7a65 7461 203d 2031 2f33 0d0a 2020    zeta = 1/3..  
-0002ea50: 2020 2020 2020 2020 2020 7830 203d 206e            x0 = n
-0002ea60: 702e 7371 7274 2832 292f 330d 0a20 2020  p.sqrt(2)/3..   
-0002ea70: 2020 2020 2020 2020 2079 3020 3d20 7830           y0 = x0
-0002ea80: 2a6e 702e 7371 7274 2833 290d 0a20 2020  *np.sqrt(3)..   
-0002ea90: 2020 2020 2020 2020 2063 6869 203d 2032           chi = 2
-0002eaa0: 2a78 300d 0a20 2020 2020 2020 200d 0a20  *x0..        .. 
-0002eab0: 2020 2020 2020 2020 2020 2063 7562 6542             cubeB
-0002eac0: 6173 6556 6572 7420 3d20 5b20 5b30 2c30  aseVert = [ [0,0
-0002ead0: 2c31 5d2c 0d0a 2020 2020 2020 2020 2020  ,1],..          
-0002eae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002eaf0: 2020 205b 6368 692c 302c 7a65 7461 5d2c     [chi,0,zeta],
-0002eb00: 2020 205b 2d78 302c 7930 2c7a 6574 615d     [-x0,y0,zeta]
-0002eb10: 2c20 205b 2d78 302c 2d79 302c 7a65 7461  ,  [-x0,-y0,zeta
-0002eb20: 5d2c 0d0a 2020 2020 2020 2020 2020 2020  ],..            
-0002eb30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002eb40: 205b 2d63 6869 2c30 2c2d 7a65 7461 5d2c   [-chi,0,-zeta],
-0002eb50: 205b 7830 2c2d 7930 2c2d 7a65 7461 5d2c   [x0,-y0,-zeta],
-0002eb60: 205b 7830 2c79 302c 2d7a 6574 615d 2c0d   [x0,y0,-zeta],.
-0002eb70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002eb80: 2020 2020 2020 2020 2020 2020 2020 5b30                [0
-0002eb90: 2c30 2c2d 315d 205d 0d0a 0d0a 2020 2020  ,0,-1] ]....    
-0002eba0: 2020 2020 2020 2020 6375 6265 4261 7365          cubeBase
-0002ebb0: 4661 6365 733d 5b20 0d0a 2020 2020 2020  Faces=[ ..      
-0002ebc0: 2020 2020 2020 2020 2020 5b30 2c31 2c36            [0,1,6
-0002ebd0: 2c32 5d2c 5b30 2c32 2c34 2c33 5d2c 5b30  ,2],[0,2,4,3],[0
-0002ebe0: 2c33 2c35 2c31 5d2c 0d0a 2020 2020 2020  ,3,5,1],..      
-0002ebf0: 2020 2020 2020 2020 2020 5b37 2c36 2c31            [7,6,1
-0002ec00: 2c35 5d2c 5b37 2c34 2c32 2c36 5d2c 5b37  ,5],[7,4,2,6],[7
-0002ec10: 2c35 2c33 2c34 5d20 5d0d 0a20 2020 2020  ,5,3,4] ]..     
-0002ec20: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-0002ec30: 2020 2020 2063 7562 6542 6173 6545 6467       cubeBaseEdg
-0002ec40: 6573 203d 205b 205b 302c 315d 2c20 5b30  es = [ [0,1], [0
-0002ec50: 2c32 5d2c 205b 302c 335d 2c20 5b37 2c34  ,2], [0,3], [7,4
-0002ec60: 5d2c 205b 372c 355d 2c20 5b37 2c36 5d2c  ], [7,5], [7,6],
-0002ec70: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0002ec80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ec90: 5b31 2c36 5d2c 205b 362c 325d 2c20 5b32  [1,6], [6,2], [2
-0002eca0: 2c34 5d2c 205b 342c 335d 2c20 5b33 2c35  ,4], [4,3], [3,5
-0002ecb0: 5d2c 205b 352c 315d 205d 0d0a 0d0a 2020  ], [5,1] ]....  
-0002ecc0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0002ecd0: 2063 7562 6542 6173 6556 6572 742c 2063   cubeBaseVert, c
-0002ece0: 7562 6542 6173 6546 6163 6573 2c20 6375  ubeBaseFaces, cu
-0002ecf0: 6265 4261 7365 4564 6765 7320 0d0a 2020  beBaseEdges ..  
-0002ed00: 2020 2020 2020 6465 6620 6765 745f 646f        def get_do
-0002ed10: 6465 6361 6865 6472 6f6e 2829 203a 0d0a  decahedron() :..
-0002ed20: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
-0002ed30: 2020 2020 2020 2020 2020 7a65 7461 203d            zeta =
-0002ed40: 2031 2f33 0d0a 2020 2020 2020 2020 2020   1/3..          
-0002ed50: 2020 6b73 6920 3d20 6e70 2e73 7172 7428    ksi = np.sqrt(
-0002ed60: 3529 2f33 0d0a 2020 2020 2020 2020 2020  5)/3..          
-0002ed70: 2020 6c61 6d5f 7371 7520 3d20 382f 390d    lam_squ = 8/9.
-0002ed80: 0a20 2020 2020 2020 2020 2020 2068 4564  .            hEd
-0002ed90: 6765 5f73 7175 203d 2028 312d 6b73 6929  ge_squ = (1-ksi)
-0002eda0: 2f32 0d0a 0d0a 2020 2020 2020 2020 2020  /2....          
-0002edb0: 2020 4178 203d 2032 2f33 0d0a 2020 2020    Ax = 2/3..    
-0002edc0: 2020 2020 2020 2020 4170 7820 3d20 312f          Apx = 1/
-0002edd0: 330d 0a20 2020 2020 2020 2020 2020 2042  3..            B
-0002ede0: 7820 3d20 6e70 2e73 7172 7428 6c61 6d5f  x = np.sqrt(lam_
-0002edf0: 7371 752d 6845 6467 655f 7371 7529 0d0a  squ-hEdge_squ)..
-0002ee00: 2020 2020 2020 2020 2020 2020 4378 203d              Cx =
-0002ee10: 206b 7369 200d 0a20 2020 2020 2020 2020   ksi ..         
-0002ee20: 2020 2044 7820 3d20 312d 4278 0d0a 2020     Dx = 1-Bx..  
-0002ee30: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-0002ee40: 2020 2020 2020 2020 4170 7920 3d20 6e70          Apy = np
-0002ee50: 2e73 7172 7428 3329 2f33 0d0a 2020 2020  .sqrt(3)/3..    
-0002ee60: 2020 2020 2020 2020 4279 203d 206e 702e          By = np.
-0002ee70: 7371 7274 2868 4564 6765 5f73 7175 290d  sqrt(hEdge_squ).
-0002ee80: 0a20 2020 2020 2020 2020 2020 2043 7920  .            Cy 
-0002ee90: 3d20 4170 790d 0a20 2020 2020 2020 2020  = Apy..         
-0002eea0: 2020 2044 7920 3d20 4279 202b 2043 790d     Dy = By + Cy.
-0002eeb0: 0a0d 0a20 2020 2020 2020 2020 2020 2023  ...            #
-0002eec0: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
-0002eed0: 2d2d 2d2d 2d2d 2d2d 0d0a 0d0a 2020 2020  --------....    
-0002eee0: 2020 2020 2020 2020 646f 6354 6f70 203d          docTop =
-0002eef0: 205b 205b 302c 302c 315d 2c0d 0a20 2020   [ [0,0,1],..   
-0002ef00: 2020 2020 2020 2020 2020 2020 205b 4178               [Ax
-0002ef10: 2c20 302c 206b 7369 5d2c 205b 2d41 7078  , 0, ksi], [-Apx
-0002ef20: 2c20 4170 792c 206b 7369 5d2c 205b 2d41  , Apy, ksi], [-A
-0002ef30: 7078 2c20 2d41 7079 2c20 6b73 695d 2c0d  px, -Apy, ksi],.
-0002ef40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002ef50: 205b 4378 2c20 4379 2c20 7a65 7461 5d2c   [Cx, Cy, zeta],
-0002ef60: 205b 4478 2c20 4479 2c20 7a65 7461 5d2c   [Dx, Dy, zeta],
-0002ef70: 205b 2d42 782c 2042 792c 207a 6574 615d   [-Bx, By, zeta]
-0002ef80: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-0002ef90: 2020 205b 2d42 782c 202d 4279 2c20 7a65     [-Bx, -By, ze
-0002efa0: 7461 5d2c 205b 4478 2c20 2d44 792c 207a  ta], [Dx, -Dy, z
-0002efb0: 6574 615d 2c20 5b43 782c 202d 4379 2c20  eta], [Cx, -Cy, 
-0002efc0: 7a65 7461 5d0d 0a20 2020 2020 2020 2020  zeta]..         
-0002efd0: 2020 2020 2020 205d 0d0a 2020 2020 2020         ]..      
-0002efe0: 2020 2020 2020 646f 6342 6f74 746f 6d20        docBottom 
-0002eff0: 3d20 5b5d 0d0a 2020 2020 2020 2020 2020  = []..          
-0002f000: 2020 666f 7220 7665 7220 696e 2064 6f63    for ver in doc
-0002f010: 546f 7020 3a20 646f 6342 6f74 746f 6d2e  Top : docBottom.
-0002f020: 6170 7065 6e64 2820 6e70 2e6d 756c 7469  append( np.multi
-0002f030: 706c 7928 7665 722c 5b2d 312c 312c 2d31  ply(ver,[-1,1,-1
-0002f040: 5d29 2e74 6f6c 6973 7428 2920 290d 0a20  ]).tolist() ).. 
-0002f050: 2020 2020 2020 2020 2020 2064 6f63 6261             docba
-0002f060: 7365 5665 7274 203d 206e 702e 636f 6e63  seVert = np.conc
-0002f070: 6174 656e 6174 6528 2864 6f63 546f 702c  atenate((docTop,
-0002f080: 646f 6342 6f74 746f 6d29 292e 746f 6c69  docBottom)).toli
-0002f090: 7374 2829 0d0a 0d0a 2020 2020 2020 2020  st()....        
-0002f0a0: 2020 2020 646f 6362 6173 6546 6163 6573      docbaseFaces
-0002f0b0: 203d 205b 0d0a 2020 2020 2020 2020 2020   = [..          
-0002f0c0: 2020 2020 2020 5b30 2c31 2c34 2c35 2c32        [0,1,4,5,2
-0002f0d0: 5d2c 205b 302c 322c 362c 372c 335d 202c  ], [0,2,6,7,3] ,
-0002f0e0: 205b 302c 332c 382c 392c 315d 2c0d 0a20   [0,3,8,9,1],.. 
-0002f0f0: 2020 2020 2020 2020 2020 2020 2020 205b                 [
-0002f100: 312c 392c 3137 2c31 362c 345d 2c20 5b32  1,9,17,16,4], [2
-0002f110: 2c35 2c31 352c 3134 2c36 5d2c 205b 332c  ,5,15,14,6], [3,
-0002f120: 372c 3139 2c31 382c 385d 2c0d 0a20 2020  7,19,18,8],..   
-0002f130: 2020 2020 2020 2020 2020 2020 205b 3130               [10
-0002f140: 2c31 322c 3136 2c31 372c 3133 5d2c 205b  ,12,16,17,13], [
-0002f150: 3130 2c31 312c 3134 2c31 352c 3132 5d2c  10,11,14,15,12],
-0002f160: 205b 3130 2c31 332c 3138 2c31 392c 3131   [10,13,18,19,11
-0002f170: 5d2c 0d0a 2020 2020 2020 2020 2020 2020  ],..            
-0002f180: 2020 2020 5b31 312c 3139 2c37 2c36 2c31      [11,19,7,6,1
-0002f190: 345d 2c5b 3133 2c31 372c 392c 382c 3138  4],[13,17,9,8,18
-0002f1a0: 5d2c 5b31 322c 3135 2c35 2c34 2c31 365d  ],[12,15,5,4,16]
-0002f1b0: 0d0a 2020 2020 2020 2020 2020 2020 5d0d  ..            ].
-0002f1c0: 0a0d 0a20 2020 2020 2020 2020 2020 2064  ...            d
-0002f1d0: 6f63 6261 7365 4564 6765 7320 3d20 5b0d  ocbaseEdges = [.
-0002f1e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002f1f0: 205b 2030 2c20 315d 2c20 5b20 302c 2032   [ 0, 1], [ 0, 2
-0002f200: 5d2c 205b 2030 2c20 335d 2c20 5b20 342c  ], [ 0, 3], [ 4,
-0002f210: 2035 5d2c 205b 2036 2c20 375d 2c20 5b20   5], [ 6, 7], [ 
-0002f220: 382c 2039 5d2c 200d 0a20 2020 2020 2020  8, 9], ..       
-0002f230: 2020 2020 2020 2020 205b 2031 2c20 395d           [ 1, 9]
-0002f240: 2c20 5b20 312c 2034 5d2c 205b 2032 2c20  , [ 1, 4], [ 2, 
-0002f250: 355d 2c20 5b20 322c 2036 5d2c 205b 2033  5], [ 2, 6], [ 3
-0002f260: 2c20 375d 2c20 5b20 332c 2038 5d2c 0d0a  , 7], [ 3, 8],..
-0002f270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f280: 5b31 302c 3131 5d2c 205b 3130 2c31 325d  [10,11], [10,12]
-0002f290: 2c20 5b31 302c 3133 5d2c 205b 3134 2c31  , [10,13], [14,1
-0002f2a0: 355d 2c20 5b31 362c 3137 5d2c 205b 3138  5], [16,17], [18
-0002f2b0: 2c31 395d 2c20 0d0a 2020 2020 2020 2020  ,19], ..        
-0002f2c0: 2020 2020 2020 2020 5b31 312c 3139 5d2c          [11,19],
-0002f2d0: 205b 3131 2c31 345d 2c20 5b31 322c 3135   [11,14], [12,15
-0002f2e0: 5d2c 205b 3132 2c31 365d 2c20 5b31 332c  ], [12,16], [13,
-0002f2f0: 3137 5d2c 205b 3133 2c31 385d 2c0d 0a20  17], [13,18],.. 
-0002f300: 2020 2020 2020 2020 2020 2020 2020 205b                 [
-0002f310: 2036 2c31 345d 2c20 5b20 342c 3136 5d2c   6,14], [ 4,16],
-0002f320: 205b 2038 2c31 385d 2c20 5b20 352c 3135   [ 8,18], [ 5,15
-0002f330: 5d2c 205b 2039 2c31 375d 2c20 5b20 372c  ], [ 9,17], [ 7,
-0002f340: 3139 5d20 200d 0a20 2020 2020 2020 2020  19]  ..         
-0002f350: 2020 205d 0d0a 0d0a 2020 2020 2020 2020     ]....        
-0002f360: 2020 2020 7265 7475 726e 2064 6f63 6261      return docba
-0002f370: 7365 5665 7274 2c20 646f 6362 6173 6546  seVert, docbaseF
-0002f380: 6163 6573 2c20 646f 6362 6173 6545 6467  aces, docbaseEdg
-0002f390: 6573 0d0a 2020 2020 2020 2020 6465 6620  es..        def 
-0002f3a0: 636f 6e73 7472 7563 745f 7465 7472 6168  construct_tetrah
-0002f3b0: 6564 726f 6e28 2920 3a0d 0a20 2020 2020  edron() :..     
-0002f3c0: 2020 2020 2020 2063 5371 7220 3d20 286e         cSqr = (n
-0002f3d0: 702e 7461 6e28 6e70 2e70 692f 3329 292a  p.tan(np.pi/3))*
-0002f3e0: 286e 702e 7461 6e28 6e70 2e70 692f 3329  (np.tan(np.pi/3)
-0002f3f0: 290d 0a20 2020 2020 2020 2020 2020 207a  )..            z
-0002f400: 6574 6120 3d20 2863 5371 722d 3129 2f28  eta = (cSqr-1)/(
-0002f410: 322a 6353 7172 290d 0a20 2020 2020 2020  2*cSqr)..       
-0002f420: 2020 2020 2063 6869 203d 206e 702e 7371       chi = np.sq
-0002f430: 7274 2833 2a63 5371 722d 3129 2a6e 702e  rt(3*cSqr-1)*np.
-0002f440: 7371 7274 2863 5371 722b 3129 2f28 322a  sqrt(cSqr+1)/(2*
-0002f450: 6353 7172 290d 0a20 2020 2020 2020 2020  cSqr)..         
-0002f460: 2020 2078 3020 3d20 6368 692a 6e70 2e63     x0 = chi*np.c
-0002f470: 6f73 286e 702e 7069 2f33 290d 0a20 2020  os(np.pi/3)..   
-0002f480: 2020 2020 2020 2020 2079 3020 3d20 6368           y0 = ch
-0002f490: 692a 6e70 2e73 696e 286e 702e 7069 2f33  i*np.sin(np.pi/3
-0002f4a0: 290d 0a20 2020 2020 2020 200d 0a20 2020  )..        ..   
-0002f4b0: 2020 2020 2020 2020 2062 6173 6556 6572           baseVer
-0002f4c0: 7420 3d20 5b20 5b30 2c30 2c31 5d2c 0d0a  t = [ [0,0,1],..
-0002f4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f4e0: 2020 2020 2020 2020 205b 6368 692c 302c           [chi,0,
-0002f4f0: 2d7a 6574 615d 2c20 5b2d 7830 2c79 302c  -zeta], [-x0,y0,
-0002f500: 2d7a 6574 615d 2c20 5b2d 7830 2c2d 7930  -zeta], [-x0,-y0
-0002f510: 2c2d 7a65 7461 5d20 5d0d 0a0d 0a20 2020  ,-zeta] ]....   
-0002f520: 2020 2020 2020 2020 2062 6173 6546 6163           baseFac
-0002f530: 6573 3d28 5b30 2c31 2c32 5d2c 5b30 2c32  es=([0,1,2],[0,2
-0002f540: 2c33 5d2c 5b30 2c33 2c31 5d2c 5b31 2c33  ,3],[0,3,1],[1,3
-0002f550: 2c32 5d29 0d0a 0d0a 2020 2020 2020 2020  ,2])....        
-0002f560: 2020 2020 466f 203d 206c 656e 2862 6173      Fo = len(bas
-0002f570: 6546 6163 6573 290d 0a20 2020 2020 2020  eFaces)..       
-0002f580: 2020 2020 2072 6574 7572 6e20 7b20 2762       return { 'b
-0002f590: 6173 6546 6163 6549 6e64 6963 6573 2720  aseFaceIndices' 
-0002f5a0: 3a20 6261 7365 4661 6365 7320 2c20 2762  : baseFaces , 'b
-0002f5b0: 6173 6556 6572 7469 6365 7343 6f6f 7227  aseVerticesCoor'
-0002f5c0: 203a 2062 6173 6556 6572 742c 2027 6665   : baseVert, 'fe
-0002f5d0: 7650 6172 616d 2720 3a20 5b46 6f2c 302c  vParam' : [Fo,0,
-0002f5e0: 325d 207d 0d0a 2020 2020 2020 2020 6465  2] }..        de
-0002f5f0: 6620 636f 6e73 7472 7563 745f 6375 6265  f construct_cube
-0002f600: 2829 203a 0d0a 2020 2020 2020 2020 2020  () :..          
-0002f610: 2020 6375 6265 4261 7365 5665 7274 2c20    cubeBaseVert, 
-0002f620: 6375 6265 4261 7365 4661 6365 732c 2063  cubeBaseFaces, c
-0002f630: 7562 6542 6173 6545 6467 6573 203d 2067  ubeBaseEdges = g
-0002f640: 6574 5f63 7562 6528 290d 0a20 2020 2020  et_cube()..     
-0002f650: 2020 2020 2020 2062 6173 6546 6163 6573         baseFaces
-0002f660: 203d 205b 5d0d 0a20 2020 2020 2020 2020   = []..         
-0002f670: 2020 2062 6173 6556 6572 7420 3d20 6375     baseVert = cu
-0002f680: 6265 4261 7365 5665 7274 2e63 6f70 7928  beBaseVert.copy(
-0002f690: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
-0002f6a0: 2066 6f72 2066 6163 6520 696e 2063 7562   for face in cub
-0002f6b0: 6542 6173 6546 6163 6573 203a 0d0a 2020  eBaseFaces :..  
-0002f6c0: 2020 2020 2020 2020 2020 2020 2020 7663                vc
-0002f6d0: 5375 6d20 3d20 5b30 2c30 2c30 5d0d 0a20  Sum = [0,0,0].. 
-0002f6e0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-0002f6f0: 2067 6574 2073 7175 6172 6520 6661 6365   get square face
-0002f700: 2063 656e 7465 720d 0a20 2020 2020 2020   center..       
-0002f710: 2020 2020 2020 2020 2066 6f72 2076 4920           for vI 
-0002f720: 696e 2066 6163 6520 3a20 7663 5375 6d20  in face : vcSum 
-0002f730: 3d20 6e70 2e61 6464 2876 6353 756d 2c63  = np.add(vcSum,c
-0002f740: 7562 6542 6173 6556 6572 745b 7649 5d29  ubeBaseVert[vI])
-0002f750: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0002f760: 2020 7663 5375 6d20 3d20 6e70 2e64 6976    vcSum = np.div
-0002f770: 6964 6528 7663 5375 6d2c 3429 0d0a 2020  ide(vcSum,4)..  
-0002f780: 2020 2020 2020 2020 2020 2020 2020 7663                vc
-0002f790: 4365 6e74 6572 203d 2076 6353 756d 2f6e  Center = vcSum/n
-0002f7a0: 702e 6c69 6e61 6c67 2e6e 6f72 6d28 7663  p.linalg.norm(vc
-0002f7b0: 5375 6d29 0d0a 2020 2020 2020 2020 2020  Sum)..          
-0002f7c0: 2020 2020 2020 7649 6e64 6578 203d 206c        vIndex = l
-0002f7d0: 656e 2862 6173 6556 6572 7429 0d0a 2020  en(baseVert)..  
-0002f7e0: 2020 2020 2020 2020 2020 2020 2020 6261                ba
-0002f7f0: 7365 5665 7274 2e61 7070 656e 6428 7663  seVert.append(vc
-0002f800: 4365 6e74 6572 290d 0a20 2020 2020 2020  Center)..       
-0002f810: 2020 2020 2020 2020 2023 2073 7562 6469           # subdi
-0002f820: 7669 6465 2063 7562 6520 6661 6365 2069  vide cube face i
-0002f830: 6e74 6f20 3420 7472 6961 6e67 6c65 730d  nto 4 triangles.
-0002f840: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002f850: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
-0002f860: 302c 3429 203a 0d0a 2020 2020 2020 2020  0,4) :..        
-0002f870: 2020 2020 2020 2020 2020 2020 6e65 7746              newF
-0002f880: 6163 6520 3d20 5b5d 0d0a 2020 2020 2020  ace = []..      
-0002f890: 2020 2020 2020 2020 2020 2020 2020 6e65                ne
-0002f8a0: 7746 6163 652e 6170 7065 6e64 2876 496e  wFace.append(vIn
-0002f8b0: 6465 7829 0d0a 2020 2020 2020 2020 2020  dex)..          
-0002f8c0: 2020 2020 2020 2020 2020 6e65 7746 6163            newFac
-0002f8d0: 652e 6170 7065 6e64 2866 6163 655b 695d  e.append(face[i]
-0002f8e0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0002f8f0: 2020 2020 2020 206e 6577 4661 6365 2e61         newFace.a
-0002f900: 7070 656e 6428 6661 6365 5b20 2869 2b31  ppend(face[ (i+1
-0002f910: 2925 345d 290d 0a20 2020 2020 2020 2020  )%4])..         
-0002f920: 2020 2020 2020 2020 2020 2062 6173 6546             baseF
-0002f930: 6163 6573 2e61 7070 656e 6428 6e65 7746  aces.append(newF
-0002f940: 6163 6529 0d0a 0d0a 2020 2020 2020 2020  ace)....        
-0002f950: 2020 2020 466f 203d 206c 656e 2862 6173      Fo = len(bas
-0002f960: 6546 6163 6573 290d 0a20 2020 2020 2020  eFaces)..       
-0002f970: 2020 2020 2072 6574 7572 6e20 7b20 2762       return { 'b
-0002f980: 6173 6546 6163 6549 6e64 6963 6573 2720  aseFaceIndices' 
-0002f990: 3a20 6261 7365 4661 6365 7320 2c20 2762  : baseFaces , 'b
-0002f9a0: 6173 6556 6572 7469 6365 7343 6f6f 7227  aseVerticesCoor'
-0002f9b0: 203a 2062 6173 6556 6572 742c 2027 6665   : baseVert, 'fe
-0002f9c0: 7650 6172 616d 2720 3a20 5b46 6f2c 302c  vParam' : [Fo,0,
-0002f9d0: 325d 207d 0d0a 2020 2020 2020 2020 6465  2] }..        de
-0002f9e0: 6620 636f 6e73 7472 7563 745f 6375 6265  f construct_cube
-0002f9f0: 5328 2920 3a0d 0a20 2020 2020 2020 2020  S() :..         
-0002fa00: 2020 207a 6574 6120 3d20 312f 330d 0a20     zeta = 1/3.. 
-0002fa10: 2020 2020 2020 2020 2020 2078 3020 3d20             x0 = 
-0002fa20: 6e70 2e73 7172 7428 3229 2f33 0d0a 2020  np.sqrt(2)/3..  
-0002fa30: 2020 2020 2020 2020 2020 7930 203d 2078            y0 = x
-0002fa40: 302a 6e70 2e73 7172 7428 3329 0d0a 2020  0*np.sqrt(3)..  
-0002fa50: 2020 2020 2020 2020 2020 6368 6920 3d20            chi = 
-0002fa60: 322a 7830 0d0a 0d0a 2020 2020 2020 2020  2*x0....        
-0002fa70: 2020 2020 736f 6666 203d 2030 2e30 310d      soff = 0.01.
-0002fa80: 0a20 2020 2020 2020 2020 2020 2078 3053  .            x0S
-0002fa90: 2c20 7930 5320 3d20 736f 6666 2f32 2c20  , y0S = soff/2, 
-0002faa0: 736f 6666 2a6e 702e 7371 7274 2833 2e30  soff*np.sqrt(3.0
-0002fab0: 292f 322e 300d 0a20 2020 2020 2020 2020  )/2.0..         
-0002fac0: 2020 2077 203d 2079 3053 2f32 2e0d 0a0d     w = y0S/2....
-0002fad0: 0a20 2020 2020 2020 2020 2020 2063 7562  .            cub
-0002fae0: 6542 6173 6556 6572 7420 3d20 5b20 5b63  eBaseVert = [ [c
-0002faf0: 6869 2c2d 772c 7a65 7461 5d2c 205b 6368  hi,-w,zeta], [ch
-0002fb00: 692c 2077 2c7a 6574 615d 2c0d 0a20 2020  i, w,zeta],..   
-0002fb10: 2020 2020 2020 2020 2020 2020 205b 2d78               [-x
-0002fb20: 302c 7930 2c7a 6574 615d 2c20 2020 5b2d  0,y0,zeta],   [-
-0002fb30: 7830 2c2d 7930 2c7a 6574 615d 2c20 205b  x0,-y0,zeta],  [
-0002fb40: 2d63 6869 2c30 2c2d 7a65 7461 5d2c 2020  -chi,0,-zeta],  
-0002fb50: 5b78 302c 2d79 302c 2d7a 6574 615d 2c20  [x0,-y0,-zeta], 
-0002fb60: 2020 5b78 302c 7930 2c2d 7a65 7461 5d2c    [x0,y0,-zeta],
-0002fb70: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0002fb80: 2020 5b20 736f 6666 2c20 2020 772c 2031    [ soff,   w, 1
-0002fb90: 5d2c 205b 2020 7830 532c 2079 3053 2c20  ], [  x0S, y0S, 
-0002fba0: 315d 2c20 5b20 2d78 3053 2c20 7930 532c  1], [ -x0S, y0S,
-0002fbb0: 2031 5d2c 205b 202d 736f 6666 2c20 2020   1], [ -soff,   
-0002fbc0: 302c 2031 5d2c 205b 202d 7830 532c 2d79  0, 1], [ -x0S,-y
-0002fbd0: 3053 2c20 315d 2c0d 0a20 2020 2020 2020  0S, 1],..       
-0002fbe0: 2020 2020 2020 2020 205b 2020 7830 532c           [  x0S,
-0002fbf0: 2d79 3053 2c20 315d 2c20 5b20 736f 6666  -y0S, 1], [ soff
-0002fc00: 2c20 202d 772c 2031 5d2c 0d0a 2020 2020  ,  -w, 1],..    
-0002fc10: 2020 2020 2020 2020 2020 2020 5b20 736f              [ so
-0002fc20: 6666 2c20 2020 772c 2d31 5d2c 205b 2020  ff,   w,-1], [  
-0002fc30: 7830 532c 2079 3053 2c2d 315d 2c20 5b20  x0S, y0S,-1], [ 
-0002fc40: 2d78 3053 2c20 7930 532c 2d31 5d2c 205b  -x0S, y0S,-1], [
-0002fc50: 202d 736f 6666 2c20 2020 302c 2d31 5d2c   -soff,   0,-1],
-0002fc60: 205b 202d 7830 532c 2d79 3053 2c2d 315d   [ -x0S,-y0S,-1]
-0002fc70: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-0002fc80: 2020 205b 2020 7830 532c 2d79 3053 2c2d     [  x0S,-y0S,-
-0002fc90: 315d 2c20 5b20 736f 6666 2c20 202d 772c  1], [ soff,  -w,
-0002fca0: 2d31 5d20 5d0d 0a0d 0a20 2020 2020 2020  -1] ]....       
-0002fcb0: 2020 2020 2063 7562 6542 6173 6546 6163       cubeBaseFac
-0002fcc0: 6573 3d28 200d 0a20 2020 2020 2020 2020  es=( ..         
-0002fcd0: 2020 2020 2020 205b 2037 2c20 312c 2036         [ 7, 1, 6
-0002fce0: 2c20 385d 2c20 5b20 382c 2036 2c20 322c  , 8], [ 8, 6, 2,
-0002fcf0: 2039 5d2c 205b 2039 2c20 322c 2034 2c31   9], [ 9, 2, 4,1
-0002fd00: 305d 2c20 5b31 302c 2034 2c20 332c 3131  0], [10, 4, 3,11
-0002fd10: 5d2c 205b 3131 2c20 332c 2035 2c31 325d  ], [11, 3, 5,12]
-0002fd20: 2c20 5b31 322c 2035 2c20 302c 3133 5d2c  , [12, 5, 0,13],
-0002fd30: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-0002fd40: 2020 205b 3134 2c31 352c 2036 2c20 315d     [14,15, 6, 1]
-0002fd50: 2c20 5b31 352c 3136 2c20 322c 2036 5d2c  , [15,16, 2, 6],
-0002fd60: 205b 3136 2c31 372c 2034 2c20 325d 2c20   [16,17, 4, 2], 
-0002fd70: 5b31 372c 3138 2c20 332c 2034 5d2c 205b  [17,18, 3, 4], [
-0002fd80: 3138 2c31 392c 2035 2c20 335d 2c20 5b31  18,19, 5, 3], [1
-0002fd90: 392c 3230 2c20 302c 2035 5d20 290d 0a20  9,20, 0, 5] ).. 
-0002fda0: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
-0002fdb0: 2020 2020 2020 2020 2062 6173 6546 6163           baseFac
-0002fdc0: 6573 203d 205b 5d0d 0a20 2020 2020 2020  es = []..       
-0002fdd0: 2020 2020 2062 6173 6556 6572 7420 3d20       baseVert = 
-0002fde0: 6375 6265 4261 7365 5665 7274 2e63 6f70  cubeBaseVert.cop
-0002fdf0: 7928 290d 0a0d 0a20 2020 2020 2020 2020  y()....         
-0002fe00: 2020 2066 6f72 2066 6163 6520 696e 2063     for face in c
-0002fe10: 7562 6542 6173 6546 6163 6573 203a 0d0a  ubeBaseFaces :..
-0002fe20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fe30: 7663 5375 6d20 3d20 5b30 2c30 2c30 5d0d  vcSum = [0,0,0].
-0002fe40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002fe50: 2023 2067 6574 2073 7175 6172 6520 6661   # get square fa
-0002fe60: 6365 2063 656e 7465 720d 0a20 2020 2020  ce center..     
-0002fe70: 2020 2020 2020 2020 2020 2066 6f72 2076             for v
-0002fe80: 4920 696e 2066 6163 6520 3a20 7663 5375  I in face : vcSu
-0002fe90: 6d20 3d20 6e70 2e61 6464 2876 6353 756d  m = np.add(vcSum
-0002fea0: 2c63 7562 6542 6173 6556 6572 745b 7649  ,cubeBaseVert[vI
-0002feb0: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
-0002fec0: 2020 2020 7663 5375 6d20 3d20 6e70 2e64      vcSum = np.d
-0002fed0: 6976 6964 6528 7663 5375 6d2c 3429 0d0a  ivide(vcSum,4)..
-0002fee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fef0: 7663 4365 6e74 6572 203d 2076 6353 756d  vcCenter = vcSum
-0002ff00: 2f6e 702e 6c69 6e61 6c67 2e6e 6f72 6d28  /np.linalg.norm(
-0002ff10: 7663 5375 6d29 0d0a 2020 2020 2020 2020  vcSum)..        
-0002ff20: 2020 2020 2020 2020 7649 6e64 6578 203d          vIndex =
-0002ff30: 206c 656e 2862 6173 6556 6572 7429 0d0a   len(baseVert)..
-0002ff40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ff50: 6261 7365 5665 7274 2e61 7070 656e 6428  baseVert.append(
-0002ff60: 7663 4365 6e74 6572 290d 0a20 2020 2020  vcCenter)..     
-0002ff70: 2020 2020 2020 2020 2020 2023 2073 7562             # sub
-0002ff80: 6469 7669 6465 2063 7562 6520 6661 6365  divide cube face
-0002ff90: 2069 6e74 6f20 3420 7472 6961 6e67 6c65   into 4 triangle
-0002ffa0: 730d 0a20 2020 2020 2020 2020 2020 2020  s..             
-0002ffb0: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
-0002ffc0: 6528 302c 3429 203a 0d0a 2020 2020 2020  e(0,4) :..      
-0002ffd0: 2020 2020 2020 2020 2020 2020 2020 6e65                ne
-0002ffe0: 7746 6163 6520 3d20 5b5d 0d0a 2020 2020  wFace = []..    
-0002fff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030000: 6e65 7746 6163 652e 6170 7065 6e64 2876  newFace.append(v
-00030010: 496e 6465 7829 0d0a 2020 2020 2020 2020  Index)..        
-00030020: 2020 2020 2020 2020 2020 2020 6e65 7746              newF
-00030030: 6163 652e 6170 7065 6e64 2866 6163 655b  ace.append(face[
-00030040: 695d 290d 0a20 2020 2020 2020 2020 2020  i])..           
-00030050: 2020 2020 2020 2020 206e 6577 4661 6365           newFace
-00030060: 2e61 7070 656e 6428 6661 6365 5b20 2869  .append(face[ (i
-00030070: 2b31 2925 345d 290d 0a20 2020 2020 2020  +1)%4])..       
-00030080: 2020 2020 2020 2020 2020 2020 2062 6173               bas
-00030090: 6546 6163 6573 2e61 7070 656e 6428 6e65  eFaces.append(ne
-000300a0: 7746 6163 6529 0d0a 0d0a 2020 2020 2020  wFace)....      
-000300b0: 2020 2020 2020 466f 203d 206c 656e 2862        Fo = len(b
-000300c0: 6173 6546 6163 6573 290d 0a20 2020 2020  aseFaces)..     
-000300d0: 2020 2020 2020 2072 6574 7572 6e20 7b20         return { 
-000300e0: 2762 6173 6546 6163 6549 6e64 6963 6573  'baseFaceIndices
-000300f0: 2720 3a20 6261 7365 4661 6365 7320 2c20  ' : baseFaces , 
-00030100: 2762 6173 6556 6572 7469 6365 7343 6f6f  'baseVerticesCoo
-00030110: 7227 203a 2062 6173 6556 6572 742c 2027  r' : baseVert, '
-00030120: 6665 7650 6172 616d 2720 3a20 5b46 6f2c  fevParam' : [Fo,
-00030130: 382c 315d 207d 0d0a 2020 2020 2020 2020  8,1] }..        
-00030140: 6465 6620 636f 6e73 7472 7563 745f 6f63  def construct_oc
-00030150: 7461 6865 6472 6f6e 2829 3a0d 0a20 2020  tahedron():..   
-00030160: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-00030170: 2020 2020 2020 2062 6173 6556 6572 7420         baseVert 
-00030180: 3d20 5b20 5b30 2c30 2c31 5d2c 0d0a 2020  = [ [0,0,1],..  
-00030190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000301a0: 2020 2020 2020 205b 312c 302c 305d 2c20         [1,0,0], 
-000301b0: 5b30 2c31 2c30 5d2c 205b 2d31 2c30 2c30  [0,1,0], [-1,0,0
-000301c0: 5d2c 205b 302c 2d31 2c30 5d2c 0d0a 2020  ], [0,-1,0],..  
-000301d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000301e0: 2020 2020 2020 205b 302c 302c 2d31 5d20         [0,0,-1] 
-000301f0: 5d0d 0a0d 0a20 2020 2020 2020 2020 2020  ]....           
-00030200: 2062 6173 6546 6163 6573 3d28 5b30 2c31   baseFaces=([0,1
-00030210: 2c32 5d2c 5b30 2c32 2c33 5d2c 5b30 2c33  ,2],[0,2,3],[0,3
-00030220: 2c34 5d2c 5b30 2c34 2c31 5d2c 0d0a 2020  ,4],[0,4,1],..  
-00030230: 2020 2020 2020 2020 2020 2020 2020 5b35                [5
-00030240: 2c32 2c31 5d2c 5b35 2c33 2c32 5d2c 5b35  ,2,1],[5,3,2],[5
-00030250: 2c34 2c33 5d2c 5b35 2c31 2c34 5d29 0d0a  ,4,3],[5,1,4])..
-00030260: 0d0a 2020 2020 2020 2020 2020 2020 466f  ..            Fo
-00030270: 203d 206c 656e 2862 6173 6546 6163 6573   = len(baseFaces
-00030280: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
-00030290: 2072 6574 7572 6e20 7b20 2762 6173 6546   return { 'baseF
-000302a0: 6163 6549 6e64 6963 6573 2720 3a20 6261  aceIndices' : ba
-000302b0: 7365 4661 6365 7320 2c20 2762 6173 6556  seFaces , 'baseV
-000302c0: 6572 7469 6365 7343 6f6f 7227 203a 2062  erticesCoor' : b
-000302d0: 6173 6556 6572 742c 2027 6665 7650 6172  aseVert, 'fevPar
-000302e0: 616d 2720 3a20 5b46 6f2c 302c 325d 207d  am' : [Fo,0,2] }
-000302f0: 0d0a 2020 2020 2020 2020 6465 6620 636f  ..        def co
-00030300: 6e73 7472 7563 745f 6f63 7461 6865 6472  nstruct_octahedr
-00030310: 6f6e 5328 293a 0d0a 2020 2020 2020 2020  onS():..        
-00030320: 2020 2020 736f 6666 203d 2030 2e30 310d      soff = 0.01.
-00030330: 0a0d 0a20 2020 2020 2020 2020 2020 2062  ...            b
-00030340: 6173 6556 6572 7453 203d 205b 5d0d 0a20  aseVertS = [].. 
-00030350: 2020 2020 2020 2020 2020 2078 3053 2c20             x0S, 
-00030360: 7930 5320 3d20 736f 6666 2f6e 702e 7371  y0S = soff/np.sq
-00030370: 7274 2832 2e30 292c 2073 6f66 662f 6e70  rt(2.0), soff/np
-00030380: 2e73 7172 7428 322e 3029 0d0a 0d0a 2020  .sqrt(2.0)....  
-00030390: 2020 2020 2020 2020 2020 6261 7365 5665            baseVe
-000303a0: 7274 5320 3d20 5b20 5b31 2c2d 7930 532c  rtS = [ [1,-y0S,
-000303b0: 305d 2c0d 0a20 2020 2020 2020 2020 2020  0],..           
-000303c0: 2020 2020 2020 2020 2020 2020 2020 205b                 [
-000303d0: 312c 2079 3053 2c30 5d2c 2020 2020 2020  1, y0S,0],      
-000303e0: 205b 302c 312c 305d 2c20 2020 2020 2020   [0,1,0],       
-000303f0: 205b 2d31 2c30 2c30 5d2c 2020 2020 2020   [-1,0,0],      
-00030400: 2020 5b30 2c2d 312c 305d 2c0d 0a20 2020    [0,-1,0],..   
-00030410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030420: 2020 2020 2020 205b 2078 3053 2c20 2079         [ x0S,  y
-00030430: 3053 2c20 315d 2c20 5b2d 7830 532c 2020  0S, 1], [-x0S,  
-00030440: 7930 532c 2031 5d2c 205b 2d78 3053 2c20  y0S, 1], [-x0S, 
-00030450: 2d79 3053 2c20 315d 2c20 5b20 7830 532c  -y0S, 1], [ x0S,
-00030460: 202d 7930 532c 2031 5d2c 0d0a 2020 2020   -y0S, 1],..    
-00030470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030480: 2020 2020 2020 5b20 7830 532c 2020 7930        [ x0S,  y0
-00030490: 532c 2d31 5d2c 205b 2d78 3053 2c20 2079  S,-1], [-x0S,  y
-000304a0: 3053 2c2d 315d 2c20 5b2d 7830 532c 202d  0S,-1], [-x0S, -
-000304b0: 7930 532c 2d31 5d2c 205b 2078 3053 2c20  y0S,-1], [ x0S, 
-000304c0: 2d79 3053 2c2d 315d 205d 0d0a 0d0a 2020  -y0S,-1] ]....  
-000304d0: 2020 2020 2020 2020 2020 6261 7365 4661            baseFa
-000304e0: 6365 7353 3d28 205b 352c 312c 325d 2c20  cesS=( [5,1,2], 
-000304f0: 5b36 2c32 2c33 5d2c 205b 372c 332c 345d  [6,2,3], [7,3,4]
-00030500: 2c20 5b38 2c34 2c30 5d2c 0d0a 2020 2020  , [8,4,0],..    
-00030510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030520: 2020 2020 205b 322c 362c 355d 2c20 5b33       [2,6,5], [3
-00030530: 2c37 2c36 5d2c 205b 342c 382c 375d 2c0d  ,7,6], [4,8,7],.
-00030540: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00030550: 2020 2020 2020 2020 2020 5b39 2c32 2c31            [9,2,1
-00030560: 5d2c 205b 3130 2c33 2c32 5d2c 205b 3131  ], [10,3,2], [11
-00030570: 2c34 2c33 5d2c 205b 3132 2c30 2c34 5d2c  ,4,3], [12,0,4],
-00030580: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00030590: 2020 2020 2020 2020 2020 205b 322c 392c             [2,9,
-000305a0: 3130 5d2c 205b 332c 3130 2c31 315d 2c20  10], [3,10,11], 
-000305b0: 5b34 2c31 312c 3132 5d20 290d 0a0d 0a20  [4,11,12] ).... 
-000305c0: 2020 2020 2020 2020 2020 2046 6f53 203d             FoS =
-000305d0: 206c 656e 2862 6173 6546 6163 6573 5329   len(baseFacesS)
-000305e0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-000305f0: 7265 7475 726e 207b 2027 6261 7365 4661  return { 'baseFa
-00030600: 6365 496e 6469 6365 7327 203a 2062 6173  ceIndices' : bas
-00030610: 6546 6163 6573 5320 2c20 2762 6173 6556  eFacesS , 'baseV
-00030620: 6572 7469 6365 7343 6f6f 7227 203a 2062  erticesCoor' : b
-00030630: 6173 6556 6572 7453 2c20 2766 6576 5061  aseVertS, 'fevPa
-00030640: 7261 6d27 203a 205b 466f 532c 352c 315d  ram' : [FoS,5,1]
-00030650: 207d 0d0a 2020 2020 2020 2020 6465 6620   }..        def 
-00030660: 636f 6e73 7472 7563 745f 646f 6465 6361  construct_dodeca
-00030670: 6865 6472 6f6e 2829 203a 0d0a 2020 2020  hedron() :..    
-00030680: 2020 2020 2020 2020 646f 6362 6173 6556          docbaseV
-00030690: 6572 742c 2064 6f63 6261 7365 4661 6365  ert, docbaseFace
-000306a0: 732c 2064 6f63 6261 7365 4564 6765 7320  s, docbaseEdges 
-000306b0: 3d20 6765 745f 646f 6465 6361 6865 6472  = get_dodecahedr
-000306c0: 6f6e 2829 0d0a 2020 2020 2020 2020 2020  on()..          
-000306d0: 2020 6261 7365 4661 6365 7320 3d20 5b5d    baseFaces = []
-000306e0: 0d0a 2020 2020 2020 2020 2020 2020 6261  ..            ba
-000306f0: 7365 5665 7274 203d 2064 6f63 6261 7365  seVert = docbase
-00030700: 5665 7274 2e63 6f70 7928 290d 0a20 2020  Vert.copy()..   
-00030710: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-00030720: 2020 2020 2020 2066 6f72 2066 6163 6520         for face 
-00030730: 696e 2064 6f63 6261 7365 4661 6365 7320  in docbaseFaces 
-00030740: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00030750: 2020 2076 6353 756d 203d 205b 302c 302c     vcSum = [0,0,
-00030760: 305d 0d0a 2020 2020 2020 2020 2020 2020  0]..            
-00030770: 2020 2020 2320 6765 7420 7065 6e74 6167      # get pentag
-00030780: 6f6e 2066 6163 6520 6365 6e74 6572 0d0a  on face center..
-00030790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000307a0: 666f 7220 7649 2069 6e20 6661 6365 203a  for vI in face :
-000307b0: 2076 6353 756d 203d 206e 702e 6164 6428   vcSum = np.add(
-000307c0: 7663 5375 6d2c 646f 6362 6173 6556 6572  vcSum,docbaseVer
-000307d0: 745b 7649 5d29 0d0a 2020 2020 2020 2020  t[vI])..        
-000307e0: 2020 2020 2020 2020 7663 5375 6d20 3d20          vcSum = 
-000307f0: 6e70 2e64 6976 6964 6528 7663 5375 6d2c  np.divide(vcSum,
-00030800: 3429 0d0a 2020 2020 2020 2020 2020 2020  4)..            
-00030810: 2020 2020 7663 4365 6e74 6572 203d 2076      vcCenter = v
-00030820: 6353 756d 2f6e 702e 6c69 6e61 6c67 2e6e  cSum/np.linalg.n
-00030830: 6f72 6d28 7663 5375 6d29 0d0a 2020 2020  orm(vcSum)..    
-00030840: 2020 2020 2020 2020 2020 2020 7649 6e64              vInd
-00030850: 6578 203d 206c 656e 2862 6173 6556 6572  ex = len(baseVer
-00030860: 7429 0d0a 2020 2020 2020 2020 2020 2020  t)..            
-00030870: 2020 2020 6261 7365 5665 7274 2e61 7070      baseVert.app
-00030880: 656e 6428 7663 4365 6e74 6572 290d 0a20  end(vcCenter).. 
-00030890: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-000308a0: 2073 7562 6469 7669 6465 2070 656e 7461   subdivide penta
-000308b0: 676f 6e20 6661 6365 2069 6e74 6f20 3520  gon face into 5 
-000308c0: 7472 6961 6e67 6c65 730d 0a20 2020 2020  triangles..     
-000308d0: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
-000308e0: 2069 6e20 7261 6e67 6528 302c 3529 203a   in range(0,5) :
-000308f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00030900: 2020 2020 2020 6e65 7746 6163 6520 3d20        newFace = 
-00030910: 5b5d 0d0a 2020 2020 2020 2020 2020 2020  []..            
-00030920: 2020 2020 2020 2020 6e65 7746 6163 652e          newFace.
-00030930: 6170 7065 6e64 2876 496e 6465 7829 0d0a  append(vIndex)..
-00030940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030950: 2020 2020 6e65 7746 6163 652e 6170 7065      newFace.appe
-00030960: 6e64 2866 6163 655b 695d 290d 0a20 2020  nd(face[i])..   
-00030970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030980: 206e 6577 4661 6365 2e61 7070 656e 6428   newFace.append(
-00030990: 6661 6365 5b20 2869 2b31 2925 355d 290d  face[ (i+1)%5]).
-000309a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000309b0: 2020 2020 2062 6173 6546 6163 6573 2e61       baseFaces.a
-000309c0: 7070 656e 6428 6e65 7746 6163 6529 0d0a  ppend(newFace)..
-000309d0: 0d0a 2020 2020 2020 2020 2020 2020 466f  ..            Fo
-000309e0: 203d 206c 656e 2862 6173 6546 6163 6573   = len(baseFaces
-000309f0: 290d 0a20 2020 2020 2020 2020 2020 2072  )..            r
-00030a00: 6574 7572 6e20 7b20 2762 6173 6546 6163  eturn { 'baseFac
-00030a10: 6549 6e64 6963 6573 2720 3a20 6261 7365  eIndices' : base
-00030a20: 4661 6365 7320 2c20 2762 6173 6556 6572  Faces , 'baseVer
-00030a30: 7469 6365 7343 6f6f 7227 203a 2062 6173  ticesCoor' : bas
-00030a40: 6556 6572 742c 2027 6665 7650 6172 616d  eVert, 'fevParam
-00030a50: 2720 3a20 5b46 6f2c 302c 325d 207d 0d0a  ' : [Fo,0,2] }..
-00030a60: 2020 2020 2020 2020 6465 6620 636f 6e73          def cons
-00030a70: 7472 7563 745f 6963 6f73 6168 6564 726f  truct_icosahedro
-00030a80: 6e28 293a 0d0a 2020 2020 2020 2020 2020  n():..          
-00030a90: 2020 6353 7172 203d 2028 6e70 2e74 616e    cSqr = (np.tan
-00030aa0: 286e 702e 7069 2f35 2929 2a28 6e70 2e74  (np.pi/5))*(np.t
-00030ab0: 616e 286e 702e 7069 2f35 2929 0d0a 2020  an(np.pi/5))..  
-00030ac0: 2020 2020 2020 2020 2020 7a65 7461 203d            zeta =
-00030ad0: 2028 312d 6353 7172 292f 2832 2a63 5371   (1-cSqr)/(2*cSq
-00030ae0: 7229 0d0a 2020 2020 2020 2020 2020 2020  r)..            
-00030af0: 6368 6920 3d20 6e70 2e73 7172 7428 332a  chi = np.sqrt(3*
-00030b00: 6353 7172 2d31 292a 6e70 2e73 7172 7428  cSqr-1)*np.sqrt(
-00030b10: 6353 7172 2b31 292f 2832 2a63 5371 7229  cSqr+1)/(2*cSqr)
-00030b20: 0d0a 2020 2020 2020 2020 2020 2020 7468  ..            th
-00030b30: 6574 6149 6e63 203d 2032 2a6e 702e 7069  etaInc = 2*np.pi
-00030b40: 2f35 0d0a 2020 2020 2020 2020 2020 2020  /5..            
-00030b50: 7468 6574 614f 6666 203d 2074 6865 7461  thetaOff = theta
-00030b60: 496e 632f 320d 0a0d 0a20 2020 2020 2020  Inc/2....       
-00030b70: 2020 2020 2062 6173 6556 6572 7420 3d20       baseVert = 
-00030b80: 5b5d 0d0a 2020 2020 2020 2020 2020 2020  []..            
-00030b90: 6261 7365 5665 7274 2e61 7070 656e 6428  baseVert.append(
-00030ba0: 5b30 2c30 2c31 5d29 0d0a 2020 2020 2020  [0,0,1])..      
-00030bb0: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
-00030bc0: 616e 6765 2830 2c35 2920 3a0d 0a20 2020  ange(0,5) :..   
-00030bd0: 2020 2020 2020 2020 2020 2020 2074 6865               the
-00030be0: 7461 203d 2069 2a74 6865 7461 496e 630d  ta = i*thetaInc.
-00030bf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00030c00: 2062 6173 6556 6572 742e 6170 7065 6e64   baseVert.append
-00030c10: 2820 5b20 6368 692a 6e70 2e63 6f73 2874  ( [ chi*np.cos(t
-00030c20: 6865 7461 292c 2063 6869 2a6e 702e 7369  heta), chi*np.si
-00030c30: 6e28 7468 6574 6129 2c20 7a65 7461 5d20  n(theta), zeta] 
-00030c40: 290d 0a20 2020 2020 2020 2020 2020 2066  )..            f
-00030c50: 6f72 2069 2069 6e20 7261 6e67 6528 302c  or i in range(0,
-00030c60: 3529 203a 0d0a 2020 2020 2020 2020 2020  5) :..          
-00030c70: 2020 2020 2020 7468 6574 6120 3d20 7468        theta = th
-00030c80: 6574 614f 6666 2b69 2a74 6865 7461 496e  etaOff+i*thetaIn
-00030c90: 630d 0a20 2020 2020 2020 2020 2020 2020  c..             
-00030ca0: 2020 2062 6173 6556 6572 742e 6170 7065     baseVert.appe
-00030cb0: 6e64 2820 5b20 6368 692a 6e70 2e63 6f73  nd( [ chi*np.cos
-00030cc0: 2874 6865 7461 292c 2063 6869 2a6e 702e  (theta), chi*np.
-00030cd0: 7369 6e28 7468 6574 6129 2c20 2d7a 6574  sin(theta), -zet
-00030ce0: 615d 2029 0d0a 2020 2020 2020 2020 2020  a] )..          
-00030cf0: 2020 6261 7365 5665 7274 2e61 7070 656e    baseVert.appen
-00030d00: 6428 5b30 2c30 2c2d 315d 290d 0a0d 0a20  d([0,0,-1]).... 
-00030d10: 2020 2020 2020 2020 2020 2062 6173 6546             baseF
-00030d20: 6163 6573 3d28 5b30 2c31 2c32 5d2c 5b30  aces=([0,1,2],[0
-00030d30: 2c32 2c33 5d2c 5b30 2c33 2c34 5d2c 5b30  ,2,3],[0,3,4],[0
-00030d40: 2c34 2c35 5d2c 5b30 2c35 2c31 5d2c 0d0a  ,4,5],[0,5,1],..
-00030d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030d60: 5b36 2c32 2c31 5d2c 5b37 2c33 2c32 5d2c  [6,2,1],[7,3,2],
-00030d70: 5b38 2c34 2c33 5d2c 5b39 2c35 2c34 5d2c  [8,4,3],[9,5,4],
-00030d80: 5b31 302c 312c 355d 2c0d 0a20 2020 2020  [10,1,5],..     
-00030d90: 2020 2020 2020 2020 2020 205b 322c 362c             [2,6,
-00030da0: 375d 2c5b 332c 372c 385d 2c5b 342c 382c  7],[3,7,8],[4,8,
-00030db0: 395d 2c5b 352c 392c 3130 5d2c 5b31 2c31  9],[5,9,10],[1,1
-00030dc0: 302c 365d 2c0d 0a20 2020 2020 2020 2020  0,6],..         
-00030dd0: 2020 2020 2020 205b 3131 2c37 2c36 5d2c         [11,7,6],
-00030de0: 5b31 312c 382c 375d 2c5b 3131 2c39 2c38  [11,8,7],[11,9,8
-00030df0: 5d2c 5b31 312c 3130 2c39 5d2c 5b31 312c  ],[11,10,9],[11,
-00030e00: 362c 3130 5d29 0d0a 0d0a 2020 2020 2020  6,10])....      
-00030e10: 2020 2020 2020 466f 203d 206c 656e 2862        Fo = len(b
-00030e20: 6173 6546 6163 6573 290d 0a20 2020 2020  aseFaces)..     
-00030e30: 2020 2020 2020 2072 6574 7572 6e20 7b20         return { 
-00030e40: 2762 6173 6546 6163 6549 6e64 6963 6573  'baseFaceIndices
-00030e50: 2720 3a20 6261 7365 4661 6365 7320 2c20  ' : baseFaces , 
-00030e60: 2762 6173 6556 6572 7469 6365 7343 6f6f  'baseVerticesCoo
-00030e70: 7227 203a 2062 6173 6556 6572 742c 2027  r' : baseVert, '
-00030e80: 6665 7650 6172 616d 2720 3a20 5b46 6f2c  fevParam' : [Fo,
-00030e90: 302c 325d 207d 0d0a 2020 2020 2020 2020  0,2] }..        
-00030ea0: 2320 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  # ..............
-00030eb0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00030ec0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00030ed0: 2e2e 2e2e 2e2e 0d0a 2020 2020 2020 2020  ........        
-00030ee0: 6966 2067 6574 4172 7261 7973 2069 7320  if getArrays is 
-00030ef0: 2763 7562 6527 203a 2072 6574 7572 6e20  'cube' : return 
-00030f00: 6765 745f 6375 6265 2829 0d0a 2020 2020  get_cube()..    
-00030f10: 2020 2020 6966 2067 6574 4172 7261 7973      if getArrays
-00030f20: 2069 7320 2764 6f64 6563 6127 203a 2072   is 'dodeca' : r
-00030f30: 6574 7572 6e20 6765 745f 646f 6465 6361  eturn get_dodeca
-00030f40: 6865 6472 6f6e 2829 0d0a 0d0a 2020 2020  hedron()....    
-00030f50: 2020 2020 7375 7266 6163 6573 4469 6374      surfacesDict
-00030f60: 696f 6e61 7279 203d 207b 7d0d 0a20 2020  ionary = {}..   
-00030f70: 2020 2020 2073 7572 6661 6365 7344 6963       surfacesDic
-00030f80: 7469 6f6e 6172 795b 2774 6574 7261 275d  tionary['tetra']
-00030f90: 2020 3d20 636f 6e73 7472 7563 745f 7465    = construct_te
-00030fa0: 7472 6168 6564 726f 6e28 290d 0a20 2020  trahedron()..   
-00030fb0: 2020 2020 2073 7572 6661 6365 7344 6963       surfacesDic
-00030fc0: 7469 6f6e 6172 795b 2763 7562 6527 5d20  tionary['cube'] 
-00030fd0: 2020 3d20 636f 6e73 7472 7563 745f 6375    = construct_cu
-00030fe0: 6265 2829 0d0a 2020 2020 2020 2020 7375  be()..        su
-00030ff0: 7266 6163 6573 4469 6374 696f 6e61 7279  rfacesDictionary
-00031000: 5b27 6375 6265 5f73 275d 203d 2063 6f6e  ['cube_s'] = con
-00031010: 7374 7275 6374 5f63 7562 6553 2829 0d0a  struct_cubeS()..
-00031020: 2020 2020 2020 2020 7375 7266 6163 6573          surfaces
-00031030: 4469 6374 696f 6e61 7279 5b27 6f63 7461  Dictionary['octa
-00031040: 275d 2020 203d 2063 6f6e 7374 7275 6374  ']   = construct
-00031050: 5f6f 6374 6168 6564 726f 6e28 290d 0a20  _octahedron().. 
-00031060: 2020 2020 2020 2073 7572 6661 6365 7344         surfacesD
-00031070: 6963 7469 6f6e 6172 795b 276f 6374 615f  ictionary['octa_
-00031080: 7327 5d20 3d20 636f 6e73 7472 7563 745f  s'] = construct_
-00031090: 6f63 7461 6865 6472 6f6e 5328 290d 0a20  octahedronS().. 
-000310a0: 2020 2020 2020 2073 7572 6661 6365 7344         surfacesD
-000310b0: 6963 7469 6f6e 6172 795b 2764 6f64 6563  ictionary['dodec
-000310c0: 6127 5d20 3d20 636f 6e73 7472 7563 745f  a'] = construct_
-000310d0: 646f 6465 6361 6865 6472 6f6e 2829 0d0a  dodecahedron()..
-000310e0: 2020 2020 2020 2020 7375 7266 6163 6573          surfaces
-000310f0: 4469 6374 696f 6e61 7279 5b27 6963 6f73  Dictionary['icos
-00031100: 6127 5d20 203d 2063 6f6e 7374 7275 6374  a']  = construct
-00031110: 5f69 636f 7361 6865 6472 6f6e 2829 0d0a  _icosahedron()..
-00031120: 2020 2020 2020 2020 2320 2e2e 2e20 2773          # ... 's
-00031130: 7065 6369 616c 2063 6173 6527 206f 6e6c  pecial case' onl
-00031140: 7920 666f 7220 6665 7620 6d65 7468 6f64  y for fev method
-00031150: 2066 6f72 2073 7068 6572 6963 616c 2073   for spherical s
-00031160: 7572 6661 6365 732e 0d0a 2020 2020 2020  urfaces...      
-00031170: 2020 7375 7266 6163 6573 4469 6374 696f    surfacesDictio
-00031180: 6e61 7279 5b27 6f63 7461 5f63 275d 203d  nary['octa_c'] =
-00031190: 207b 2027 6665 7650 6172 616d 2720 3a20   { 'fevParam' : 
-000311a0: 5b31 362c 352c 315d 207d 0d0a 2020 2020  [16,5,1] }..    
-000311b0: 2020 2020 7375 7266 6163 6573 4469 6374      surfacesDict
-000311c0: 696f 6e61 7279 5b27 6375 6265 5f63 275d  ionary['cube_c']
-000311d0: 203d 207b 2027 6665 7650 6172 616d 2720   = { 'fevParam' 
-000311e0: 3a20 5b31 322c 342c 315d 207d 0d0a 2020  : [12,4,1] }..  
-000311f0: 2020 2020 2020 2320 2e2e 2e20 2773 7065        # ... 'spe
-00031200: 6369 616c 2063 6173 6527 206f 6e6c 7920  cial case' only 
-00031210: 666f 7220 6665 7620 6d65 7468 6f64 2066  for fev method f
-00031220: 6f72 2070 6c61 746f 6e69 6320 7375 7266  or platonic surf
-00031230: 6163 6573 2e0d 0a20 2020 2020 2020 2073  aces...        s
-00031240: 7572 6661 6365 7344 6963 7469 6f6e 6172  urfacesDictionar
-00031250: 795b 2763 7562 655f 6127 5d20 3d20 7b20  y['cube_a'] = { 
-00031260: 2766 6576 5061 7261 6d27 203a 205b 3132  'fevParam' : [12
-00031270: 2c30 2c32 5d20 7d0d 0a20 2020 2020 2020  ,0,2] }..       
-00031280: 2073 7572 6661 6365 7344 6963 7469 6f6e   surfacesDiction
-00031290: 6172 795b 2763 7562 652a 275d 203d 207b  ary['cube*'] = {
-000312a0: 2027 6665 7650 6172 616d 2720 3a20 5b31   'fevParam' : [1
-000312b0: 322c 302c 325d 207d 0d0a 2020 2020 2020  2,0,2] }..      
-000312c0: 2020 7375 7266 6163 6573 4469 6374 696f    surfacesDictio
-000312d0: 6e61 7279 5b27 646f 6465 6361 2a27 5d20  nary['dodeca*'] 
-000312e0: 3d20 7b20 2766 6576 5061 7261 6d27 203a  = { 'fevParam' :
-000312f0: 205b 3336 2c30 2c32 5d20 7d0d 0a0d 0a20   [36,0,2] }.... 
-00031300: 2020 2020 2020 2072 6574 7572 6e20 7375         return su
-00031310: 7266 6163 6573 4469 6374 696f 6e61 7279  rfacesDictionary
-00031320: 0d0a 0d0a 2020 2020 4073 7461 7469 636d  ....    @staticm
-00031330: 6574 686f 640d 0a20 2020 2064 6566 205f  ethod..    def _
-00031340: 6d69 6456 6563 746f 7246 756e 2876 6563  midVectorFun(vec
-00031350: 7441 2c20 7665 6374 4229 203a 0d0a 2020  tA, vectB) :..  
-00031360: 2020 2020 2020 2222 224d 6964 2d70 6f69        """Mid-poi
-00031370: 6e74 2062 6574 7765 656e 2074 776f 2070  nt between two p
-00031380: 6f69 6e74 7320 6f6e 2061 2075 6e69 7420  oints on a unit 
-00031390: 7370 6865 7265 2e22 2222 0d0a 2020 2020  sphere."""..    
-000313a0: 2020 2020 6d69 6420 3d20 6e70 2e61 6464      mid = np.add
-000313b0: 2876 6563 7441 2c76 6563 7442 290d 0a20  (vectA,vectB).. 
-000313c0: 2020 2020 2020 2072 6574 7572 6e20 6d69         return mi
-000313d0: 642f 6e70 2e6c 696e 616c 672e 6e6f 726d  d/np.linalg.norm
-000313e0: 286d 6964 290d 0a20 2020 200d 0a20 2020  (mid)..    ..   
-000313f0: 2040 7374 6174 6963 6d65 7468 6f64 0d0a   @staticmethod..
-00031400: 2020 2020 6465 6620 5f6d 6170 3344 746f      def _map3Dto
-00031410: 3244 7371 7561 7265 2878 797a 2920 3a0d  2Dsquare(xyz) :.
-00031420: 0a20 2020 2020 2020 2022 2222 4f76 6572  .        """Over
-00031430: 7269 6465 206d 6170 2073 7572 6661 6365  ride map surface
-00031440: 2074 6f20 7265 6374 6167 756c 6172 2075   to rectagular u
-00031450: 6e69 7420 636f 6f72 6469 6e61 7465 7320  nit coordinates 
-00031460: 2830 2c31 292e 2222 220d 0a20 2020 2020  (0,1)."""..     
-00031470: 2020 2078 2c79 2c7a 203d 2078 797a 0d0a     x,y,z = xyz..
-00031480: 2020 2020 2020 2020 7420 3d20 6e70 2e61          t = np.a
-00031490: 7263 7461 6e32 2879 2c78 290d 0a20 2020  rctan2(y,x)..   
-000314a0: 2020 2020 2074 6865 7461 203d 206e 702e       theta = np.
-000314b0: 7768 6572 6528 2074 3c30 2c20 322e 302a  where( t<0, 2.0*
-000314c0: 6e70 2e70 6920 2b20 7420 2c74 290d 0a20  np.pi + t ,t).. 
-000314d0: 2020 2020 2020 2070 6869 203d 206e 702e         phi = np.
-000314e0: 6172 6373 696e 287a 290d 0a20 2020 2020  arcsin(z)..     
-000314f0: 2020 2061 203d 2074 6865 7461 2f28 322a     a = theta/(2*
-00031500: 6e70 2e70 6929 0d0a 2020 2020 2020 2020  np.pi)..        
-00031510: 6220 3d20 2070 6869 2f6e 702e 7069 202b  b =  phi/np.pi +
-00031520: 2030 2e35 0d0a 2020 2020 2020 2020 6120   0.5..        a 
-00031530: 3d20 6e70 2e63 6c69 7028 612c 302e 302c  = np.clip(a,0.0,
-00031540: 312e 3029 200d 0a20 2020 2020 2020 2062  1.0) ..        b
-00031550: 203d 206e 702e 636c 6970 2862 2c30 2e30   = np.clip(b,0.0
-00031560: 2c31 2e30 2920 0d0a 2020 2020 2020 2020  ,1.0) ..        
-00031570: 7265 7475 726e 205b 612c 625d 0d0a 0d0a  return [a,b]....
-00031580: 2020 2020 4073 7461 7469 636d 6574 686f      @staticmetho
-00031590: 640d 0a20 2020 2064 6566 2063 6f6f 725f  d..    def coor_
-000315a0: 636f 6e76 6572 7428 7879 7a2c 2074 6f63  convert(xyz, toc
-000315b0: 6172 743d 4661 6c73 6529 203a 0d0a 2020  art=False) :..  
-000315c0: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
-000315d0: 2020 204f 7665 7272 6964 6520 636f 6f72     Override coor
-000315e0: 6469 6e61 7465 2074 7261 6e73 666f 726d  dinate transform
-000315f0: 6174 696f 6e2e 0d0a 0d0a 2020 2020 2020  ation.....      
-00031600: 2020 5472 616e 7366 6f72 6d61 7469 6f6e    Transformation
-00031610: 2062 6574 7765 656e 2073 7068 6572 6963   between spheric
-00031620: 616c 2061 6e64 2043 6172 7465 7369 616e  al and Cartesian
-00031630: 2063 6f6f 7264 696e 6174 6573 2e0d 0a20   coordinates... 
-00031640: 2020 2020 2020 2054 6865 2061 7a69 6d75         The azimu
-00031650: 7468 616c 2063 6f6f 7264 696e 6174 6520  thal coordinate 
-00031660: 6973 2069 6e20 7261 6469 616e 7320 7769  is in radians wi
-00031670: 7468 2064 6f6d 6169 6e20 3020 746f 2032  th domain 0 to 2
-00031680: 7069 2e0d 0a20 2020 2020 2020 2054 6865  pi...        The
-00031690: 2070 6f6c 6172 2061 6e67 6c65 2069 7320   polar angle is 
-000316a0: 696e 2072 6164 6961 6e73 2077 6974 6820  in radians with 
-000316b0: 646f 6d61 696e 2030 2074 6f20 7069 2e0d  domain 0 to pi..
-000316c0: 0a0d 0a20 2020 2020 2020 2050 6172 616d  ...        Param
-000316d0: 6574 6572 730d 0a20 2020 2020 2020 202d  eters..        -
-000316e0: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
-000316f0: 2020 2078 797a 203a 2033 784e 2061 7272     xyz : 3xN arr
-00031700: 6179 0d0a 2020 2020 2020 2020 2020 2020  ay..            
-00031710: 4e20 6e75 6d62 6572 206f 6620 7665 6374  N number of vect
-00031720: 6f72 7320 696e 2065 6974 6865 7220 7370  ors in either sp
-00031730: 6865 7269 6361 6c20 6f72 2063 6172 7465  herical or carte
-00031740: 7369 616e 2063 6f6f 7264 696e 6174 6573  sian coordinates
-00031750: 2c0d 0a0d 0a20 2020 2020 2020 2074 6f63  ,....        toc
-00031760: 6172 7420 3a20 7b20 5472 7565 2c20 4661  art : { True, Fa
-00031770: 6c73 6520 7d2c 2064 6566 6175 6c74 3a20  lse }, default: 
-00031780: 4661 6c73 650d 0a20 2020 2020 2020 2020  False..         
-00031790: 2020 2049 6620 5472 7565 2c20 696e 7075     If True, inpu
-000317a0: 7420 6973 2073 7068 6572 6963 616c 2061  t is spherical a
-000317b0: 6e64 206f 7574 7075 7420 6973 2063 6172  nd output is car
-000317c0: 7465 7369 616e 2e0d 0a20 2020 2020 2020  tesian...       
-000317d0: 2020 2020 2049 6620 4661 6c73 652c 2069       If False, i
-000317e0: 6e70 7574 2069 7320 6361 7274 6573 6961  nput is cartesia
-000317f0: 6e20 616e 6420 6f75 7470 7574 2069 7320  n and output is 
-00031800: 7370 6865 7269 6361 6c2e 0d0a 0d0a 2020  spherical.....  
-00031810: 2020 2020 2020 5265 7475 726e 730d 0a20        Returns.. 
-00031820: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0d0a         -------..
-00031830: 2020 2020 2020 2020 6c69 7374 3a20 3378          list: 3x
-00031840: 4e20 6172 7261 790d 0a20 2020 2020 2020  N array..       
-00031850: 2020 2020 2054 7261 6e73 666f 726d 6564       Transformed
-00031860: 2063 6f6f 7264 696e 6174 6573 2e20 0d0a   coordinates. ..
-00031870: 0d0a 2020 2020 2020 2020 2222 220d 0a0d  ..        """...
-00031880: 0a20 2020 2020 2020 2069 6620 746f 6361  .        if toca
-00031890: 7274 203a 0d0a 2020 2020 2020 2020 2020  rt :..          
-000318a0: 2020 722c 2074 6865 7461 2c20 7068 6920    r, theta, phi 
-000318b0: 3d20 7879 7a0d 0a20 2020 2020 2020 2020  = xyz..         
-000318c0: 2020 2078 203d 2072 2a6e 702e 7369 6e28     x = r*np.sin(
-000318d0: 7068 6929 2a6e 702e 636f 7328 7468 6574  phi)*np.cos(thet
-000318e0: 6129 0d0a 2020 2020 2020 2020 2020 2020  a)..            
-000318f0: 7920 3d20 722a 6e70 2e73 696e 2870 6869  y = r*np.sin(phi
-00031900: 292a 6e70 2e73 696e 2874 6865 7461 290d  )*np.sin(theta).
-00031910: 0a20 2020 2020 2020 2020 2020 207a 203d  .            z =
-00031920: 2072 2a6e 702e 636f 7328 7068 6929 0d0a   r*np.cos(phi)..
-00031930: 2020 2020 2020 2020 2020 2020 6162 6320              abc 
-00031940: 3d20 5b78 2c79 2c7a 5d0d 0a20 2020 2020  = [x,y,z]..     
-00031950: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-00031960: 2020 2020 2020 782c 792c 7a20 3d20 7879        x,y,z = xy
-00031970: 7a0d 0a20 2020 2020 2020 2020 2020 2052  z..            R
-00031980: 203d 206e 702e 7371 7274 2820 782a 7820   = np.sqrt( x*x 
-00031990: 2b20 792a 7920 2b20 7a2a 7a20 290d 0a20  + y*y + z*z ).. 
-000319a0: 2020 2020 2020 2020 2020 2070 6869 203d             phi =
-000319b0: 206e 702e 6e61 6e5f 746f 5f6e 756d 286e   np.nan_to_num(n
-000319c0: 702e 6172 6363 6f73 287a 2f52 2929 0d0a  p.arccos(z/R))..
-000319d0: 2020 2020 2020 2020 2020 2020 7468 6574              thet
-000319e0: 6120 3d20 6e70 2e61 7263 7461 6e32 2879  a = np.arctan2(y
-000319f0: 2c78 290d 0a20 2020 2020 2020 2020 2020  ,x)..           
-00031a00: 2074 6865 7461 203d 206e 702e 7768 6572   theta = np.wher
-00031a10: 6528 7468 6574 613c 302c 7468 6574 612b  e(theta<0,theta+
-00031a20: 322a 6e70 2e70 692c 7468 6574 6129 0d0a  2*np.pi,theta)..
-00031a30: 2020 2020 2020 2020 2020 2020 6162 6320              abc 
-00031a40: 3d20 5b52 2c74 6865 7461 2c70 6869 5d0d  = [R,theta,phi].
-00031a50: 0a20 2020 2020 2020 2061 6263 203d 206e  .        abc = n
-00031a60: 702e 6172 7261 7928 6162 6329 0d0a 2020  p.array(abc)..  
-00031a70: 2020 2020 2020 7265 7475 726e 2061 6263        return abc
-00031a80: 0d0a 0d0a 2020 2020 5f62 6173 655f 7375  ....    _base_su
-00031a90: 7266 6163 6573 203d 205f 6765 745f 706c  rfaces = _get_pl
-00031aa0: 6174 6f6e 6963 5f73 6f6c 6964 735f 6469  atonic_solids_di
-00031ab0: 6374 696f 6e61 7279 2e5f 5f66 756e 635f  ctionary.__func_
-00031ac0: 5f28 290d 0a20 2020 205f 6465 6661 756c  _()..    _defaul
-00031ad0: 745f 6261 7365 203d 2027 6963 6f73 6127  t_base = 'icosa'
-00031ae0: 2020 2320 6465 6661 756c 7420 6173 7369    # default assi
-00031af0: 676e 6d65 6e74 2069 7320 696e 6469 6361  gnment is indica
-00031b00: 7465 6420 696e 205f 5f69 6e69 7420 446f  ted in __init Do
-00031b10: 6373 7472 696e 672e 0d0a 2020 2020 5f67  cstring...    _g
-00031b20: 656f 6d54 7970 6520 3d20 5f43 4f4f 5253  eomType = _COORS
-00031b30: 5953 5b27 5350 4845 5249 4341 4c27 5d0d  YS['SPHERICAL'].
-00031b40: 0a0d 0a20 2020 2040 636c 6173 736d 6574  ...    @classmet
-00031b50: 686f 640d 0a20 2020 2064 6566 205f 7576  hod..    def _uv
-00031b60: 775f 746f 5f78 797a 2863 6c73 2c20 7576  w_to_xyz(cls, uv
-00031b70: 772c 2072 7470 2920 3a0d 0a20 2020 2020  w, rtp) :..     
-00031b80: 2020 2022 2222 4f76 6572 7269 6465 2072     """Override r
-00031b90: 6f74 6174 696f 6e61 6c20 7472 616e 7366  otational transf
-00031ba0: 6f72 6d61 7469 6f6e 2061 7420 6120 7370  ormation at a sp
-00031bb0: 6865 7269 6361 6c20 636f 6f72 6469 6e61  herical coordina
-00031bc0: 7465 2e22 2222 200d 0a20 2020 2020 2020  te.""" ..       
-00031bd0: 2072 6574 7572 6e20 7375 7065 7228 292e   return super().
-00031be0: 5f64 6973 705f 746f 5f78 797a 2820 7576  _disp_to_xyz( uv
-00031bf0: 772c 2072 7470 5b31 5d2c 2072 7470 5b32  w, rtp[1], rtp[2
-00031c00: 5d20 290d 0a0d 0a20 2020 2040 636c 6173  ] )....    @clas
-00031c10: 736d 6574 686f 640d 0a20 2020 2064 6566  smethod..    def
-00031c20: 2067 7269 6428 636c 732c 6e6c 6174 2c20   grid(cls,nlat, 
-00031c30: 6e6c 6e67 2c20 6261 7365 7479 7065 3d27  nlng, basetype='
-00031c40: 6427 2c20 6d69 6e72 6164 3d4e 6f6e 652c  d', minrad=None,
-00031c50: 206e 616d 653d 4e6f 6e65 2c20 2a2a 6b77   name=None, **kw
-00031c60: 6172 6773 2920 3a0d 0a20 2020 2020 2020  args) :..       
-00031c70: 2022 2222 0d0a 2020 2020 2020 2020 5370   """..        Sp
-00031c80: 6865 7269 6361 6c53 7572 6661 6365 2077  hericalSurface w
-00031c90: 6974 6820 6c61 7469 7475 6465 2061 6e64  ith latitude and
-00031ca0: 206c 6f6e 6769 7475 6465 2066 6163 6573   longitude faces
-00031cb0: 2e0d 0a0d 0a20 2020 2020 2020 2050 6172  .....        Par
-00031cc0: 616d 6574 6572 730d 0a20 2020 2020 2020  ameters..       
-00031cd0: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
-00031ce0: 2020 2020 206e 6c61 7420 3a20 696e 7465       nlat : inte
-00031cf0: 6765 722c 2072 6571 7569 7265 642e 0d0a  ger, required...
-00031d00: 2020 2020 2020 2020 2020 2020 4e75 6d62              Numb
-00031d10: 6572 206f 6620 6c61 7469 7475 6465 2073  er of latitude s
-00031d20: 7562 6469 7669 7369 6f6e 732e 2020 4d69  ubdivisions.  Mi
-00031d30: 6e69 6d75 6d20 7661 6c75 6520 6973 2032  nimum value is 2
-00031d40: 0d0a 0d0a 2020 2020 2020 2020 6e6c 6e67  ....        nlng
-00031d50: 203a 2069 6e74 6567 6572 2c20 7265 7175   : integer, requ
-00031d60: 6972 6564 2e0d 0a20 2020 2020 2020 2020  ired...         
-00031d70: 2020 204e 756d 6265 7220 6f66 206c 6f6e     Number of lon
-00031d80: 6769 7475 6465 2073 7562 6469 7669 7369  gitude subdivisi
-00031d90: 6f6e 732e 204d 696e 696d 756d 2076 616c  ons. Minimum val
-00031da0: 7565 2069 7320 332e 0d0a 0d0a 2020 2020  ue is 3.....    
-00031db0: 2020 2020 6261 7365 7479 7065 203a 207b      basetype : {
-00031dc0: 2764 272c 2773 272c 2771 272c 2777 272c  'd','s','q','w',
-00031dd0: 2772 272c 2778 277d 2c20 6f70 7469 6f6e  'r','x'}, option
-00031de0: 616c 2c20 6465 6661 756c 743a 2027 6427  al, default: 'd'
-00031df0: 0d0a 2020 2020 2020 2020 2020 2020 5374  ..            St
-00031e00: 6172 7469 6e67 2073 7572 6661 6365 2067  arting surface g
-00031e10: 656f 6d65 7472 6965 7320 6672 6f6d 2077  eometries from w
-00031e20: 6869 6368 2074 6865 2073 7572 6661 6365  hich the surface
-00031e30: 2069 730d 0a20 2020 2020 2020 2020 2020   is..           
-00031e40: 2063 6f6e 7374 7275 6374 6564 2069 6e64   constructed ind
-00031e50: 6963 6174 696e 6720 6661 6365 2073 6861  icating face sha
-00031e60: 7065 2061 6e64 2069 6620 7370 6c69 742e  pe and if split.
-00031e70: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-00031e80: 2020 2020 6d69 6e72 6164 203a 2073 6361      minrad : sca
-00031e90: 6c61 722c 206f 7074 696f 6e61 6c2c 2064  lar, optional, d
-00031ea0: 6566 6175 6c74 3a20 302e 3031 0d0a 2020  efault: 0.01..  
-00031eb0: 2020 2020 2020 2020 2020 5468 6520 6d69            The mi
-00031ec0: 6e69 6d75 6d20 6469 7374 616e 6365 2066  nimum distance f
-00031ed0: 726f 6d20 7468 6520 7a2d 6178 6973 206f  rom the z-axis o
-00031ee0: 6620 616e 7920 7665 7274 6578 2063 6f6f  f any vertex coo
-00031ef0: 7264 696e 6174 652e 0d0a 2020 2020 2020  rdinate...      
-00031f00: 2020 2020 2020 5573 6520 6973 2064 6570        Use is dep
-00031f10: 656e 6465 6e74 206f 6e20 6261 7365 7479  endent on basety
-00031f20: 7065 2e0d 0a0d 0a20 2020 2020 2020 206e  pe.....        n
-00031f30: 616d 6520 3a20 7374 7269 6e67 2c20 6f70  ame : string, op
-00031f40: 7469 6f6e 616c 2c20 6465 6661 756c 743a  tional, default:
-00031f50: 204e 6f6e 652e 0d0a 2020 2020 2020 2020   None...        
-00031f60: 2020 2020 4465 7363 7269 7074 6976 6520      Descriptive 
-00031f70: 6964 656e 7469 6669 6572 2e0d 0a0d 0a20  identifier..... 
-00031f80: 2020 2020 2020 2052 6169 7365 730d 0a20         Raises.. 
-00031f90: 2020 2020 2020 202d 2d2d 2d2d 2d0d 0a20         ------.. 
-00031fa0: 2020 2020 2020 2056 616c 7565 4572 726f         ValueErro
-00031fb0: 720d 0a20 2020 2020 2020 2020 2020 2049  r..            I
-00031fc0: 6620 6e6c 6174 2069 7320 6e6f 7420 616e  f nlat is not an
-00031fd0: 2069 6e74 6567 6572 2067 7265 6174 6572   integer greater
-00031fe0: 206f 7220 6571 7561 6c20 746f 2032 2e0d   or equal to 2..
-00031ff0: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
-00032000: 6e6c 6e67 2069 7320 6e6f 7420 616e 2069  nlng is not an i
-00032010: 6e74 6567 6572 2067 7265 6174 6572 206f  nteger greater o
-00032020: 7220 6571 7561 6c20 746f 2033 2e0d 0a0d  r equal to 3....
-00032030: 0a20 2020 2020 2020 204f 7468 6572 2050  .        Other P
-00032040: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
-00032050: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
-00032060: 2d2d 2d0d 0a20 2020 2020 2020 202a 2a6b  ---..        **k
-00032070: 7761 7267 730d 0a20 2020 2020 2020 2020  wargs..         
-00032080: 2020 2041 6c6c 206f 7468 6572 2070 6172     All other par
-00032090: 616d 6574 6572 7320 6172 6520 7061 7373  ameters are pass
-000320a0: 6564 206f 6e20 746f 2027 7333 646c 6962  ed on to 's3dlib
-000320b0: 2e73 7572 6661 6365 2e53 7572 6661 6365  .surface.Surface
-000320c0: 3344 436f 6c6c 6563 7469 6f6e 272e 0d0a  3DCollection'...
-000320d0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-000320e0: 2020 5265 7475 726e 730d 0a20 2020 2020    Returns..     
-000320f0: 2020 202d 2d2d 2d2d 2d2d 0d0a 2020 2020     -------..    
-00032100: 2020 2020 7375 7266 6163 6520 3a20 5370      surface : Sp
-00032110: 6865 7269 6361 6c53 7572 6661 6365 206f  hericalSurface o
-00032120: 626a 6563 742e 0d0a 0d0a 2020 2020 2020  bject.....      
-00032130: 2020 2222 220d 0a20 2020 2020 2020 204e    """..        N
-00032140: 6661 6365 7320 3d20 7b20 2764 273a 2036  faces = { 'd': 6
-00032150: 2c20 2773 273a 2036 2c20 2771 273a 3132  , 's': 6, 'q':12
-00032160: 2c20 2777 273a 3132 2c20 2772 273a 362c  , 'w':12, 'r':6,
-00032170: 2027 7827 3a36 2020 7d20 2023 2032 2c33   'x':6  }  # 2,3
-00032180: 0d0a 2020 2020 2020 2020 7370 6c69 7453  ..        splitS
-00032190: 697a 6520 3d20 4e6f 6e65 0d0a 2020 2020  ize = None..    
-000321a0: 2020 2020 6e72 6164 2c20 6e61 6e67 203d      nrad, nang =
-000321b0: 206e 6c61 742c 206e 6c6e 670d 0a20 2020   nlat, nlng..   
-000321c0: 2020 2020 2073 7572 6661 6365 203d 2063       surface = c
-000321d0: 6c73 2e5f 7371 7561 7265 5f6e 6574 286e  ls._square_net(n
-000321e0: 7261 642c 206e 616e 672c 2062 6173 6574  rad, nang, baset
-000321f0: 7970 652c 6d69 6e72 6164 2c20 7370 6c69  ype,minrad, spli
-00032200: 7453 697a 652c 206e 616d 652c 202a 2a6b  tSize, name, **k
-00032210: 7761 7267 7329 0d0a 2020 2020 2020 2020  wargs)..        
-00032220: 7375 7266 6163 652e 5f70 6f73 7450 726f  surface._postPro
-00032230: 635f 7375 7266 6163 6543 6f6c 6f72 7328  c_surfaceColors(
-00032240: 5472 7565 290d 0a20 2020 2020 2020 2073  True)..        s
-00032250: 7572 6661 6365 2e5f 7265 7a20 3d20 7375  urface._rez = su
-00032260: 7266 6163 652e 5f63 616c 635f 7265 7a28  rface._calc_rez(
-00032270: 2032 3020 290d 0a20 2020 2020 2020 2072   20 )..        r
-00032280: 6574 7572 6e20 7375 7266 6163 650d 0a0d  eturn surface...
-00032290: 0a20 2020 2040 636c 6173 736d 6574 686f  .    @classmetho
-000322a0: 640d 0a20 2020 2064 6566 205f 5866 6576  d..    def _Xfev
-000322b0: 2863 6c73 2c20 7265 7a2c 2062 6173 6574  (cls, rez, baset
-000322c0: 7970 653d 4e6f 6e65 2c20 6d69 6e72 6164  ype=None, minrad
-000322d0: 3d4e 6f6e 6529 203a 0d0a 2020 2020 2020  =None) :..      
-000322e0: 2020 2222 220d 0a20 2020 2020 2020 2043    """..        C
-000322f0: 616c 6375 6c61 7465 7320 6e75 6d62 6572  alculates number
-00032300: 206f 6620 6661 6365 732c 2065 6467 6573   of faces, edges
-00032310: 2c20 616e 6420 7665 7274 6963 6573 206f  , and vertices o
-00032320: 6620 6120 5370 6865 7269 6361 6c53 7572  f a SphericalSur
-00032330: 6661 6365 2e0d 0a0d 0a20 2020 2020 2020  face.....       
-00032340: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
-00032350: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
-00032360: 0a20 2020 2020 2020 2072 657a 203a 2069  .        rez : i
-00032370: 6e74 6567 6572 0d0a 2020 2020 2020 2020  nteger..        
-00032380: 2020 2020 4e75 6d62 6572 206f 6620 7265      Number of re
-00032390: 6375 7273 6976 6520 7375 6264 6976 6973  cursive subdivis
-000323a0: 696f 6e73 206f 6620 6120 7472 6961 6e67  ions of a triang
-000323b0: 756c 6174 6564 2062 6173 6520 6661 6365  ulated base face
-000323c0: 732e 0d0a 2020 2020 2020 2020 0d0a 2020  s...        ..  
-000323d0: 2020 2020 2020 6261 7365 7479 7065 203a        basetype :
-000323e0: 2073 7472 696e 670d 0a20 2020 2020 2020   string..       
-000323f0: 2020 2020 2053 7461 7274 696e 6720 7375       Starting su
-00032400: 7266 6163 6520 6765 6f6d 6574 7269 6573  rface geometries
-00032410: 2066 726f 6d20 7768 6963 6820 7468 6520   from which the 
-00032420: 7375 7266 6163 6520 776f 756c 6420 6265  surface would be
-00032430: 0d0a 2020 2020 2020 2020 2020 2020 636f  ..            co
-00032440: 6e73 7472 7563 7465 6420 7573 696e 6720  nstructed using 
-00032450: 7265 6375 7273 6976 6520 7375 6264 6976  recursive subdiv
-00032460: 6973 696f 6e73 206f 6620 7468 6520 7472  isions of the tr
-00032470: 6961 6e67 756c 6172 2066 6163 6573 2e0d  iangular faces..
-00032480: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
-00032490: 2020 2052 6574 7572 6e73 0d0a 2020 2020     Returns..    
-000324a0: 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020      -------..   
-000324b0: 2020 2020 206c 6973 743a 2074 6865 206e       list: the n
-000324c0: 756d 6265 7220 6f66 2066 6163 6573 2c20  umber of faces, 
-000324d0: 6564 6765 732c 2061 6e64 2076 6572 7469  edges, and verti
-000324e0: 6365 732e 0d0a 0d0a 2020 2020 2020 2020  ces.....        
-000324f0: 2222 220d 0a20 2020 2020 2020 2069 6620  """..        if 
-00032500: 6973 696e 7374 616e 6365 2872 657a 2c28  isinstance(rez,(
-00032510: 6c69 7374 2c74 7570 6c65 2929 203a 2023  list,tuple)) : #
-00032520: 2063 6865 636b 2066 6f72 2067 6c6f 6265   check for globe
-00032530: 2e2e 2e0d 0a20 2020 2020 2020 2020 2020  .....           
-00032540: 206e 6c61 7420 3d20 7265 7a5b 305d 0d0a   nlat = rez[0]..
-00032550: 2020 2020 2020 2020 2020 2020 6e6c 6e67              nlng
-00032560: 203d 2072 657a 5b31 5d0d 0a20 2020 2020   = rez[1]..     
-00032570: 2020 2020 2020 2023 206f 6e6c 7920 6368         # only ch
-00032580: 6563 6b20 6973 2065 6e64 696e 6720 696e  eck is ending in
-00032590: 2073 0d0a 2020 2020 2020 2020 2020 2020   s..            
-000325a0: 6973 5370 6c69 7420 3d20 6261 7365 7479  isSplit = basety
-000325b0: 7065 5b20 6c65 6e28 6261 7365 7479 7065  pe[ len(basetype
-000325c0: 292d 315d 2069 7320 2773 270d 0a20 2020  )-1] is 's'..   
-000325d0: 2020 2020 2020 2020 2069 6620 6d69 6e72           if minr
-000325e0: 6164 2069 7320 4e6f 6e65 203a 0d0a 2020  ad is None :..  
-000325f0: 2020 2020 2020 2020 2020 2020 2020 6620                f 
-00032600: 3d20 322a 6e6c 6174 2a6e 6c6e 6720 2d20  = 2*nlat*nlng - 
-00032610: 322a 6e6c 6e67 0d0a 2020 2020 2020 2020  2*nlng..        
-00032620: 2020 2020 2020 2020 6520 3d20 332a 6e6c          e = 3*nl
-00032630: 6174 2a6e 6c6e 6720 2d20 332a 6e6c 6e67  at*nlng - 3*nlng
-00032640: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00032650: 2020 7620 3d20 6e6c 6174 2a6e 6c6e 6720    v = nlat*nlng 
-00032660: 2d20 6e6c 6e67 202b 2032 0d0a 2020 2020  - nlng + 2..    
-00032670: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-00032680: 7353 706c 6974 203a 0d0a 2020 2020 2020  sSplit :..      
-00032690: 2020 2020 2020 2020 2020 2020 2020 6520                e 
-000326a0: 2b3d 206e 6c61 740d 0a20 2020 2020 2020  += nlat..       
-000326b0: 2020 2020 2020 2020 2020 2020 2076 202b               v +
-000326c0: 3d20 6e6c 6174 202d 2031 0d0a 2020 2020  = nlat - 1..    
-000326d0: 2020 2020 2020 2020 656c 7365 203a 2020          else :  
-000326e0: 2320 616e 7920 7661 6c75 6520 7769 6c6c  # any value will
-000326f0: 2074 7269 6767 6572 2074 6869 7320 636f   trigger this co
-00032700: 6e64 6974 696f 6e2e 0d0a 2020 2020 2020  ndition...      
-00032710: 2020 2020 2020 2020 2020 6620 3d20 322a            f = 2*
-00032720: 6e6c 6174 2a6e 6c6e 670d 0a20 2020 2020  nlat*nlng..     
-00032730: 2020 2020 2020 2020 2020 2065 203d 2033             e = 3
-00032740: 2a6e 6c61 742a 6e6c 6e67 202b 206e 6c6e  *nlat*nlng + nln
-00032750: 670d 0a20 2020 2020 2020 2020 2020 2020  g..             
-00032760: 2020 2076 203d 206e 6c61 742a 6e6c 6e67     v = nlat*nlng
-00032770: 202b 206e 6c6e 670d 0a20 2020 2020 2020   + nlng..       
-00032780: 2020 2020 2020 2020 2069 6620 6973 5370           if isSp
-00032790: 6c69 7420 3a0d 0a20 2020 2020 2020 2020  lit :..         
-000327a0: 2020 2020 2020 2020 2020 2065 202b 3d20             e += 
-000327b0: 6e6c 6174 2020 2020 0d0a 2020 2020 2020  nlat    ..      
-000327c0: 2020 2020 2020 2020 2020 2020 2020 7620                v 
-000327d0: 2b3d 206e 6c61 7420 2b20 3120 2020 200d  += nlat + 1    .
-000327e0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-000327f0: 7572 6e20 5b66 2c65 2c76 5d0d 0a0d 0a20  urn [f,e,v].... 
-00032800: 2020 2020 2020 2072 6574 7572 6e20 7375         return su
-00032810: 7065 7228 292e 5f66 6576 2872 657a 2c62  per()._fev(rez,b
-00032820: 6173 6574 7970 652c 636c 7329 0d0a 0d0a  asetype,cls)....
-00032830: 2020 2020 4073 7461 7469 636d 6574 686f      @staticmetho
-00032840: 640d 0a20 2020 2064 6566 205f 7370 6865  d..    def _sphe
-00032850: 7269 6361 6c5f 7370 6c69 745f 6379 6c69  rical_split_cyli
-00032860: 6e64 6572 2872 657a 2c62 6173 6574 7970  nder(rez,basetyp
-00032870: 652c 6d69 6e72 6164 2c20 2a2a 6b77 6172  e,minrad, **kwar
-00032880: 6773 2920 3a0d 0a20 2020 2020 2020 2022  gs) :..        "
-00032890: 2222 0d0a 2020 2020 2020 2020 5472 616e  ""..        Tran
-000328a0: 7366 6f72 6d20 6379 6c69 6e64 7269 6361  sform cylindrica
-000328b0: 6c20 6261 7365 2073 7572 6661 6365 2074  l base surface t
-000328c0: 6f20 7370 6865 7269 6361 6c20 636f 6f72  o spherical coor
-000328d0: 6469 6e61 7465 732e 200d 0a0d 0a20 2020  dinates. ....   
-000328e0: 2020 2020 206e 6f74 6520 3a20 2054 6869       note :  Thi
-000328f0: 7320 6d65 7468 6f64 2070 726f 7669 6465  s method provide
-00032900: 7320 616e 2061 6c74 6572 6e61 7469 7665  s an alternative
-00032910: 2074 6f20 7468 6520 0d0a 2020 2020 2020   to the ..      
-00032920: 2020 2020 2020 2020 2020 7370 6865 7269            spheri
-00032930: 6361 6c20 6261 7365 7479 7065 7320 6f66  cal basetypes of
-00032940: 2027 6865 785f 7327 2061 6e64 2027 7371   'hex_s' and 'sq
-00032950: 7561 7265 5f73 272e 0d0a 2020 2020 2020  uare_s'...      
-00032960: 2020 2020 2020 2020 2020 5468 6520 6772            The gr
-00032970: 6964 7320 636f 6e73 7472 7563 7465 6420  ids constructed 
-00032980: 6865 7265 206d 6179 2070 726f 7669 6465  here may provide
-00032990: 2073 6d6f 6f74 6865 720d 0a20 2020 2020   smoother..     
-000329a0: 2020 2020 2020 2020 2020 2067 656f 6d65             geome
-000329b0: 7472 6965 7320 6465 7065 6e64 696e 6720  tries depending 
-000329c0: 6f6e 2074 6865 206d 6170 7069 6e67 2066  on the mapping f
-000329d0: 756e 6374 696f 6e73 2e0d 0a20 2020 2020  unctions...     
-000329e0: 2020 2022 2222 0d0a 0d0a 2020 2020 2020     """....      
-000329f0: 2020 2320 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e    # ............
-00032a00: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00032a10: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00032a20: 2e2e 2e2e 2e0d 0a20 2020 2020 2020 2064  .......        d
-00032a30: 6566 2063 796c 3273 7068 2872 747a 293a  ef cyl2sph(rtz):
-00032a40: 0d0a 2020 2020 2020 2020 2020 2020 722c  ..            r,
-00032a50: 742c 7a20 3d20 7274 7a0d 0a20 2020 2020  t,z = rtz..     
-00032a60: 2020 2020 2020 206d 696e 7068 6920 3d20         minphi = 
-00032a70: 6e70 2e61 7263 636f 7328 6d69 6e72 6164  np.arccos(minrad
-00032a80: 290d 0a20 2020 2020 2020 2020 2020 2070  )..            p
-00032a90: 6869 203d 207a 2a6d 696e 7068 690d 0a20  hi = z*minphi.. 
-00032aa0: 2020 2020 2020 2020 2020 205a 203d 206e             Z = n
-00032ab0: 702e 7369 6e28 7068 6929 0d0a 2020 2020  p.sin(phi)..    
-00032ac0: 2020 2020 2020 2020 5220 3d20 6e70 2e63          R = np.c
-00032ad0: 6f73 2870 6869 290d 0a20 2020 2020 2020  os(phi)..       
-00032ae0: 2020 2020 2072 6574 7572 6e20 522c 742c       return R,t,
-00032af0: 5a0d 0a20 2020 2020 2020 2023 202e 2e2e  Z..        # ...
-00032b00: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00032b10: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00032b20: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 0d0a  ................
-00032b30: 2020 2020 2020 2020 6966 2062 6173 6574          if baset
-00032b40: 7970 6520 6973 2027 6f63 7461 5f63 2720  ype is 'octa_c' 
-00032b50: 3a20 6379 6c62 6173 6520 3d20 2773 7175  : cylbase = 'squ
-00032b60: 5f73 2720 0d0a 2020 2020 2020 2020 6966  _s' ..        if
-00032b70: 2062 6173 6574 7970 6520 6973 2027 6375   basetype is 'cu
-00032b80: 6265 5f63 2720 3a20 2020 2063 796c 6261  be_c' :    cylba
-00032b90: 7365 203d 2027 7472 695f 7327 0d0a 2020  se = 'tri_s'..  
-00032ba0: 2020 2020 2020 6379 6c5f 6f62 6a20 3d20        cyl_obj = 
-00032bb0: 4379 6c69 6e64 7269 6361 6c53 7572 6661  CylindricalSurfa
-00032bc0: 6365 2872 657a 2c63 796c 6261 7365 2c20  ce(rez,cylbase, 
-00032bd0: 2a2a 6b77 6172 6773 292e 6d61 705f 6765  **kwargs).map_ge
-00032be0: 6f6d 5f66 726f 6d5f 6f70 2863 796c 3273  om_from_op(cyl2s
-00032bf0: 7068 290d 0a20 2020 2020 2020 2062 6173  ph)..        bas
-00032c00: 6546 6163 6556 6572 7465 7849 6e64 6963  eFaceVertexIndic
-00032c10: 6573 203d 2063 796c 5f6f 626a 2e5f 6261  es = cyl_obj._ba
-00032c20: 7365 5f73 7572 6661 6365 735b 6379 6c62  se_surfaces[cylb
-00032c30: 6173 655d 205b 2762 6173 6546 6163 6549  ase] ['baseFaceI
-00032c40: 6e64 6963 6573 275d 2020 2020 0d0a 2020  ndices']    ..  
-00032c50: 2020 2020 2020 6676 496e 6469 6365 7320        fvIndices 
-00032c60: 3d20 6379 6c5f 6f62 6a2e 6676 496e 6469  = cyl_obj.fvIndi
-00032c70: 6365 730d 0a20 2020 2020 2020 2076 6572  ces..        ver
-00032c80: 7465 7843 6f6f 7220 3d20 6379 6c5f 6f62  texCoor = cyl_ob
-00032c90: 6a2e 7665 7274 6578 436f 6f72 0d0a 2020  j.vertexCoor..  
-00032ca0: 2020 2020 2020 6576 496e 6469 6365 7320        evIndices 
-00032cb0: 3d20 6379 6c5f 6f62 6a2e 6576 496e 6469  = cyl_obj.evIndi
-00032cc0: 6365 730d 0a20 2020 2020 2020 2072 6574  ces..        ret
-00032cd0: 7572 6e20 7665 7274 6578 436f 6f72 2c20  urn vertexCoor, 
-00032ce0: 6676 496e 6469 6365 732c 2065 7649 6e64  fvIndices, evInd
-00032cf0: 6963 6573 2c20 6261 7365 4661 6365 5665  ices, baseFaceVe
-00032d00: 7274 6578 496e 6469 6365 732c 0d0a 0d0a  rtexIndices,....
-00032d10: 2020 2020 6465 6620 5f5f 696e 6974 5f5f      def __init__
-00032d20: 2873 656c 662c 2072 657a 3d30 2c20 6261  (self, rez=0, ba
-00032d30: 7365 7479 7065 3d4e 6f6e 652c 206d 696e  setype=None, min
-00032d40: 7261 643d 4e6f 6e65 2c20 6e61 6d65 3d4e  rad=None, name=N
-00032d50: 6f6e 652c 202a 2a6b 7761 7267 7329 3a0d  one, **kwargs):.
-00032d60: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
-00032d70: 2020 2020 2020 4372 6561 7465 2073 7068        Create sph
-00032d80: 6572 6963 616c 2073 7572 6661 6365 206f  erical surface o
-00032d90: 6620 756e 6974 2072 6164 6975 732e 0d0a  f unit radius...
-00032da0: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-00032db0: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
-00032dc0: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
-00032dd0: 2020 7265 7a20 3a20 696e 7465 6765 722c    rez : integer,
-00032de0: 206f 7074 696f 6e61 6c2c 2064 6566 6175   optional, defau
-00032df0: 6c74 3a20 300d 0a20 2020 2020 2020 2020  lt: 0..         
-00032e00: 2020 204e 756d 6265 7220 6f66 2072 6563     Number of rec
-00032e10: 7572 7369 7665 2073 7562 6469 7669 7369  ursive subdivisi
-00032e20: 6f6e 7320 6f66 2074 6865 2074 7269 616e  ons of the trian
-00032e30: 6775 6c61 7465 6420 6261 7365 2066 6163  gulated base fac
-00032e40: 6573 2e0d 0a20 2020 2020 2020 2020 2020  es...           
-00032e50: 2052 657a 2076 616c 7565 7320 7261 6e67   Rez values rang
-00032e60: 6520 6672 6f6d 2030 2074 6f20 372e 0d0a  e from 0 to 7...
-00032e70: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
-00032e80: 2020 2020 2020 6261 7365 7479 7065 203a        basetype :
-00032e90: 207b 2774 6574 7261 272c 276f 6374 6127   {'tetra','octa'
-00032ea0: 2c27 6963 6f73 6127 2c27 6375 6265 272c  ,'icosa','cube',
-00032eb0: 2764 6f64 6563 6127 2c20 5c0d 0a20 2020  'dodeca', \..   
-00032ec0: 2020 2020 2020 2020 2027 6f63 7461 5f73           'octa_s
-00032ed0: 272c 2763 7562 655f 7327 2c27 6f63 7461  ','cube_s','octa
-00032ee0: 5f63 272c 2763 7562 655f 6327 7d2c 206f  _c','cube_c'}, o
-00032ef0: 7074 696f 6e61 6c2c 2064 6566 6175 6c74  ptional, default
-00032f00: 3a20 2769 636f 7361 270d 0a20 2020 2020  : 'icosa'..     
-00032f10: 2020 2020 2020 2053 7461 7274 696e 6720         Starting 
-00032f20: 7375 7266 6163 6520 6765 6f6d 6574 7269  surface geometri
-00032f30: 6573 2066 726f 6d20 7768 6963 6820 7468  es from which th
-00032f40: 6520 7375 7266 6163 6520 6973 0d0a 2020  e surface is..  
-00032f50: 2020 2020 2020 2020 2020 636f 6e73 7472            constr
-00032f60: 7563 7465 6420 7573 696e 6720 7265 6375  ucted using recu
-00032f70: 7273 6976 6520 7375 6264 6976 6973 696f  rsive subdivisio
-00032f80: 6e73 206f 6620 7468 6520 7472 6961 6e67  ns of the triang
-00032f90: 756c 6172 2066 6163 6573 2e0d 0a20 2020  ular faces...   
-00032fa0: 2020 2020 2020 2020 2041 6c6c 2062 6173           All bas
-00032fb0: 6574 7970 6573 2061 7265 2062 6173 6564  etypes are based
-00032fc0: 206f 6e20 7468 6520 6669 7665 2070 6c61   on the five pla
-00032fd0: 746f 6e69 6320 736f 6c69 6473 2e0d 0a0d  tonic solids....
-00032fe0: 0a20 2020 2020 2020 206d 696e 7261 6420  .        minrad 
-00032ff0: 3a20 7363 616c 6172 2c20 6f70 7469 6f6e  : scalar, option
-00033000: 616c 2c20 6465 6661 756c 743a 2030 2e30  al, default: 0.0
-00033010: 310d 0a20 2020 2020 2020 2020 2020 2046  1..            F
-00033020: 6f72 2062 6173 6574 7970 6573 2027 6f63  or basetypes 'oc
-00033030: 7461 5f63 2720 616e 6420 2763 7562 655f  ta_c' and 'cube_
-00033040: 632c 2074 6865 206d 696e 696d 756d 0d0a  c, the minimum..
-00033050: 2020 2020 2020 2020 2020 2020 6469 7374              dist
-00033060: 616e 6365 2066 726f 6d20 7468 6520 7a2d  ance from the z-
-00033070: 6178 6973 206f 6620 616e 7920 7665 7274  axis of any vert
-00033080: 6578 2063 6f6f 7264 696e 6174 652e 0d0a  ex coordinate...
-00033090: 0d0a 2020 2020 2020 2020 6e61 6d65 203a  ..        name :
-000330a0: 2073 7472 696e 672c 206f 7074 696f 6e61   string, optiona
-000330b0: 6c2c 2064 6566 6175 6c74 3a20 4e6f 6e65  l, default: None
-000330c0: 2e0d 0a20 2020 2020 2020 2020 2020 2044  ...            D
-000330d0: 6573 6372 6970 7469 7665 2069 6465 6e74  escriptive ident
-000330e0: 6966 6965 7220 666f 7220 7468 6520 6765  ifier for the ge
-000330f0: 6f6d 6574 7279 2e0d 0a0d 0a20 2020 2020  ometry.....     
-00033100: 2020 2052 6169 7365 730d 0a20 2020 2020     Raises..     
-00033110: 2020 202d 2d2d 2d2d 2d0d 0a20 2020 2020     ------..     
-00033120: 2020 2056 616c 7565 4572 726f 720d 0a20     ValueError.. 
-00033130: 2020 2020 2020 2020 2020 2049 6620 7265             If re
-00033140: 7a20 6973 206e 6f74 2061 6e20 696e 7465  z is not an inte
-00033150: 6765 7220 696e 2072 616e 6765 2030 2074  ger in range 0 t
-00033160: 6f20 372e 0d0a 2020 2020 2020 2020 2020  o 7...          
-00033170: 2020 4966 2062 6173 6574 7970 6520 6973    If basetype is
-00033180: 206e 6f74 2072 6563 6f67 6e69 7a65 6420   not recognized 
-00033190: 666f 7220 7468 6973 2073 7572 6661 6365  for this surface
-000331a0: 2063 6f6e 7374 7275 6374 6f72 2e0d 0a0d   constructor....
-000331b0: 0a20 2020 2020 2020 204f 7468 6572 2050  .        Other P
-000331c0: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
-000331d0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
-000331e0: 2d2d 2d0d 0a20 2020 2020 2020 202a 2a6b  ---..        **k
-000331f0: 7761 7267 730d 0a20 2020 2020 2020 2020  wargs..         
-00033200: 2020 2041 6c6c 206f 7468 6572 2070 6172     All other par
-00033210: 616d 6574 6572 7320 6172 6520 7061 7373  ameters are pass
-00033220: 6564 206f 6e20 746f 2027 7333 646c 6962  ed on to 's3dlib
-00033230: 2e73 7572 6661 6365 2e53 7572 6661 6365  .surface.Surface
-00033240: 3344 436f 6c6c 6563 7469 6f6e 272e 0d0a  3DCollection'...
-00033250: 0d0a 2020 2020 2020 2020 2222 220d 0a0d  ..        """...
-00033260: 0a20 2020 2020 2020 2069 6620 6d69 6e72  .        if minr
-00033270: 6164 2069 7320 4e6f 6e65 203a 206d 696e  ad is None : min
-00033280: 7261 6420 3d20 5f4d 494e 5241 440d 0a20  rad = _MINRAD.. 
-00033290: 2020 2020 2020 2069 6620 6e6f 7420 6973         if not is
-000332a0: 696e 7374 616e 6365 2872 657a 2c20 696e  instance(rez, in
-000332b0: 7429 203a 0d0a 2020 2020 2020 2020 2020  t) :..          
-000332c0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-000332d0: 6f72 2827 496e 636f 7272 6563 7420 7265  or('Incorrect re
-000332e0: 7a20 7479 7065 2c20 6d75 7374 2062 6120  z type, must ba 
-000332f0: 6f66 2074 7970 6520 696e 7427 290d 0a20  of type int').. 
-00033300: 2020 2020 2020 2069 6620 2872 657a 3c30         if (rez<0
-00033310: 2920 6f72 2028 7265 7a3e 5f4d 4158 5245  ) or (rez>_MAXRE
-00033320: 5a29 203a 0d0a 2020 2020 2020 2020 2020  Z) :..          
-00033330: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-00033340: 6f72 2827 496e 636f 7272 6573 7420 7265  or('Incorrest re
-00033350: 7a20 6f66 207b 7d2c 206d 7573 7420 6265  z of {}, must be
-00033360: 2061 6e20 696e 742c 2030 203c 3d20 7265   an int, 0 <= re
-00033370: 7a20 3c3d 207b 7d27 2e66 6f72 6d61 7428  z <= {}'.format(
-00033380: 7265 7a2c 5f4d 4158 5245 5a29 290d 0a20  rez,_MAXREZ)).. 
-00033390: 2020 2020 2020 2069 6620 6261 7365 7479         if basety
-000333a0: 7065 2069 7320 4e6f 6e65 203a 2062 6173  pe is None : bas
-000333b0: 6574 7970 6520 3d20 7365 6c66 2e5f 6465  etype = self._de
-000333c0: 6661 756c 745f 6261 7365 0d0a 2020 2020  fault_base..    
-000333d0: 2020 2020 2320 2e2e 2e20 6368 6563 6b20      # ... check 
-000333e0: 666f 7220 2773 7065 6369 616c 2063 6173  for 'special cas
-000333f0: 6527 2028 7567 6c79 2063 6f64 6520 6275  e' (ugly code bu
-00033400: 7420 6e65 6564 6564 2c20 4d52 4f49 290d  t needed, MROI).
-00033410: 0a20 2020 2020 2020 2069 6620 6261 7365  .        if base
-00033420: 7479 7065 2069 7320 276f 6374 615f 6327  type is 'octa_c'
-00033430: 206f 7220 6261 7365 7479 7065 2069 7320   or basetype is 
-00033440: 2763 7562 655f 6327 203a 0d0a 2020 2020  'cube_c' :..    
-00033450: 2020 2020 2020 2020 7665 7274 6578 436f          vertexCo
-00033460: 6f72 2c20 6661 6365 496e 6469 6365 732c  or, faceIndices,
-00033470: 2065 6467 6549 6e64 6963 6573 2c20 6266   edgeIndices, bf
-00033480: 7669 203d 2073 656c 662e 5f73 7068 6572  vi = self._spher
-00033490: 6963 616c 5f73 706c 6974 5f63 796c 696e  ical_split_cylin
-000334a0: 6465 7228 7265 7a2c 6261 7365 7479 7065  der(rez,basetype
-000334b0: 2c6d 696e 7261 642c 202a 2a6b 7761 7267  ,minrad, **kwarg
-000334c0: 7329 0d0a 2020 2020 2020 2020 2020 2020  s)..            
-000334d0: 6261 7365 4661 6365 5665 7274 6578 496e  baseFaceVertexIn
-000334e0: 6469 6365 7320 3d20 6266 7669 0d0a 2020  dices = bfvi..  
-000334f0: 2020 2020 2020 656c 7365 203a 0d0a 2020        else :..  
-00033500: 2020 2020 2020 2020 2020 6966 2062 6173            if bas
-00033510: 6574 7970 6520 6e6f 7420 696e 2073 656c  etype not in sel
-00033520: 662e 5f62 6173 655f 7375 7266 6163 6573  f._base_surfaces
-00033530: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
-00033540: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-00033550: 7272 6f72 2827 4261 7365 7479 7065 207b  rror('Basetype {
-00033560: 7d20 6973 206e 6f74 2072 6563 6f67 6e69  } is not recogni
-00033570: 7a65 642e 2050 6f73 7369 626c 6520 7661  zed. Possible va
-00033580: 6c75 6573 2061 7265 3a20 7b7d 272e 666f  lues are: {}'.fo
-00033590: 726d 6174 2862 6173 6574 7970 652c 6c69  rmat(basetype,li
-000335a0: 7374 2873 656c 662e 5f62 6173 655f 7375  st(self._base_su
-000335b0: 7266 6163 6573 2929 290d 0a20 2020 2020  rfaces)))..     
-000335c0: 2020 2020 2020 2062 6173 6553 7572 664f         baseSurfO
-000335d0: 626a 203d 2073 656c 662e 5f62 6173 655f  bj = self._base_
-000335e0: 7375 7266 6163 6573 5b62 6173 6574 7970  surfaces[basetyp
-000335f0: 655d 0d0a 2020 2020 2020 2020 2020 2020  e]..            
-00033600: 6261 7365 5663 6f6f 7220 3d20 6261 7365  baseVcoor = base
-00033610: 5375 7266 4f62 6a5b 2762 6173 6556 6572  SurfObj['baseVer
-00033620: 7469 6365 7343 6f6f 7227 5d0d 0a20 2020  ticesCoor']..   
-00033630: 2020 2020 2020 2020 2062 6173 6546 6163           baseFac
-00033640: 6556 6572 7465 7849 6e64 6963 6573 203d  eVertexIndices =
-00033650: 6261 7365 5375 7266 4f62 6a5b 2762 6173  baseSurfObj['bas
-00033660: 6546 6163 6549 6e64 6963 6573 275d 0d0a  eFaceIndices']..
-00033670: 2020 2020 2020 2020 2020 2020 696e 6465              inde
-00033680: 784f 626a 2c76 6572 7465 7843 6f6f 7220  xObj,vertexCoor 
-00033690: 3d20 7365 6c66 2e74 7269 616e 6775 6c61  = self.triangula
-000336a0: 7465 4261 7365 2872 657a 2c62 6173 6556  teBase(rez,baseV
-000336b0: 636f 6f72 2c62 6173 6546 6163 6556 6572  coor,baseFaceVer
-000336c0: 7465 7849 6e64 6963 6573 2c20 7365 6c66  texIndices, self
-000336d0: 2e5f 6d69 6456 6563 746f 7246 756e 290d  ._midVectorFun).
-000336e0: 0a20 2020 2020 2020 2020 2020 2066 6163  .            fac
-000336f0: 6549 6e64 6963 6573 203d 2069 6e64 6578  eIndices = index
-00033700: 4f62 6a5b 2766 6163 6527 5d0d 0a20 2020  Obj['face']..   
-00033710: 2020 2020 2020 2020 2065 6467 6549 6e64           edgeInd
-00033720: 6963 6573 203d 2069 6e64 6578 4f62 6a5b  ices = indexObj[
-00033730: 2765 6467 6527 5d0d 0a20 2020 2020 2020  'edge']..       
-00033740: 200d 0a20 2020 2020 2020 2073 7570 6572   ..        super
-00033750: 2829 2e5f 5f69 6e69 745f 5f28 7665 7274  ().__init__(vert
-00033760: 6578 436f 6f72 2c20 6661 6365 496e 6469  exCoor, faceIndi
-00033770: 6365 732c 206e 616d 652c 202a 2a6b 7761  ces, name, **kwa
-00033780: 7267 7329 0d0a 0d0a 2020 2020 2020 2020  rgs)....        
-00033790: 7365 6c66 2e63 6f6f 7254 7970 6520 3d20  self.coorType = 
-000337a0: 5f43 4f4f 5253 5953 5b22 5350 4845 5249  _COORSYS["SPHERI
-000337b0: 4341 4c22 5d0d 0a20 2020 2020 2020 2073  CAL"]..        s
-000337c0: 656c 662e 5f6e 6f72 6d61 6c5f 7363 616c  elf._normal_scal
-000337d0: 6520 3d20 5f6e 6f72 6d4c 656e 6774 6828  e = _normLength(
-000337e0: 206c 656e 2866 6163 6549 6e64 6963 6573   len(faceIndices
-000337f0: 292c 2030 2e36 312c 2031 2e35 3229 0d0a  ), 0.61, 1.52)..
-00033800: 2020 2020 2020 2020 7365 6c66 2e5f 7265          self._re
-00033810: 7a20 3d20 7265 7a0d 0a20 2020 2020 2020  z = rez..       
-00033820: 2073 656c 662e 5f62 6173 6574 7970 6520   self._basetype 
-00033830: 3d20 6261 7365 7479 7065 0d0a 2020 2020  = basetype..    
-00033840: 2020 2020 7365 6c66 2e64 6973 705f 5665      self.disp_Ve
-00033850: 6374 6f72 203d 206e 702e 6172 7261 7928  ctor = np.array(
-00033860: 205b 312c 312c 315d 2029 0d0a 2020 2020   [1,1,1] )..    
-00033870: 2020 2020 7265 7475 726e 204e 6f6e 650d      return None.
-00033880: 0a20 2020 200d 0a20 2020 2064 6566 2064  .    ..    def d
-00033890: 6f6d 6169 6e28 7365 6c66 2c20 7261 6469  omain(self, radi
-000338a0: 7573 3d4e 6f6e 6529 203a 0d0a 2020 2020  us=None) :..    
-000338b0: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
-000338c0: 2053 6574 2074 6865 2064 6f6d 6169 6e20   Set the domain 
-000338d0: 6f66 2074 6865 2073 7068 6572 6963 616c  of the spherical
-000338e0: 2073 7572 6661 6365 2e0d 0a0d 0a20 2020   surface.....   
-000338f0: 2020 2020 2055 7365 6420 666f 7220 7365       Used for se
-00033900: 7474 696e 6720 7468 6520 7261 6469 7573  tting the radius
-00033910: 206f 6620 7468 6520 6261 7365 2073 7068   of the base sph
-00033920: 6572 652e 0d0a 0d0a 2020 2020 2020 2020  ere.....        
-00033930: 5061 7261 6d65 7465 7273 0d0a 2020 2020  Parameters..    
-00033940: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a      ----------..
-00033950: 2020 2020 2020 2020 7261 6469 7573 3a20          radius: 
-00033960: 6e75 6d62 6572 2c20 6465 6661 756c 7420  number, default 
-00033970: 3a20 310d 0a20 2020 2020 2020 2020 2020  : 1..           
-00033980: 2052 6164 6975 7320 6f66 2074 6865 2073   Radius of the s
-00033990: 7068 6572 6963 616c 2073 7572 6661 6365  pherical surface
-000339a0: 2e0d 0a20 2020 2020 2020 2020 2020 2049  ...            I
-000339b0: 6620 7365 7420 746f 204e 6f6e 652c 2074  f set to None, t
-000339c0: 6865 2072 6164 6975 7320 6973 2075 6e63  he radius is unc
-000339d0: 6861 6e67 6564 2e0d 0a0d 0a20 2020 2020  hanged.....     
-000339e0: 2020 2052 6574 7572 6e73 0d0a 2020 2020     Returns..    
-000339f0: 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020      -------..   
-00033a00: 2020 2020 2073 656c 6620 3a20 5370 6865       self : Sphe
-00033a10: 7269 6361 6c53 7572 6661 6365 206f 626a  ricalSurface obj
-00033a20: 6563 740d 0a0d 0a20 2020 2020 2020 2022  ect....        "
-00033a30: 2222 0d0a 2020 2020 2020 2020 6465 6620  ""..        def 
-00033a40: 7365 7444 6f6d 6169 6e28 7274 702c 206d  setDomain(rtp, m
-00033a50: 7220 2920 3a0d 0a20 2020 2020 2020 2020  r ) :..         
-00033a60: 2020 2072 2c74 2c70 203d 2072 7470 0d0a     r,t,p = rtp..
-00033a70: 2020 2020 2020 2020 2020 2020 5220 3d20              R = 
-00033a80: 6d72 2a72 0d0a 2020 2020 2020 2020 2020  mr*r..          
-00033a90: 2020 7265 7475 726e 2052 2c74 2c70 2020    return R,t,p  
-00033aa0: 2020 2020 200d 0a20 2020 2020 2020 2064       ..        d
-00033ab0: 6566 2067 6574 436f 6e74 286c 696d 7329  ef getCont(lims)
-00033ac0: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
-00033ad0: 6d20 3d20 312e 300d 0a20 2020 2020 2020  m = 1.0..       
-00033ae0: 2020 2020 2069 6620 6c69 6d73 2069 7320       if lims is 
-00033af0: 6e6f 7420 4e6f 6e65 203a 206d 203d 206c  not None : m = l
-00033b00: 696d 730d 0a20 2020 2020 2020 2020 2020  ims..           
-00033b10: 2072 6574 7572 6e20 6d0d 0a20 2020 2020   return m..     
-00033b20: 2020 206d 7220 3d20 6765 7443 6f6e 7428     mr = getCont(
-00033b30: 7261 6469 7573 290d 0a20 2020 2020 2020  radius)..       
-00033b40: 2073 656c 662e 6d61 705f 6765 6f6d 5f66   self.map_geom_f
-00033b50: 726f 6d5f 6f70 286c 616d 6264 6120 4120  rom_op(lambda A 
-00033b60: 3a20 7365 7444 6f6d 6169 6e28 412c 206d  : setDomain(A, m
-00033b70: 7220 2929 0d0a 2020 2020 2020 2020 7265  r ))..        re
-00033b80: 7475 726e 2073 656c 660d 0a0d 0a0d 0a0d  turn self.......
-00033b90: 0a63 6c61 7373 2056 6563 746f 7233 4443  .class Vector3DC
-00033ba0: 6f6c 6c65 6374 696f 6e28 4c69 6e65 3344  ollection(Line3D
-00033bb0: 436f 6c6c 6563 7469 6f6e 2920 3a0d 0a20  Collection) :.. 
-00033bc0: 2020 2022 2222 0d0a 2020 2020 436f 6c6c     """..    Coll
-00033bd0: 6563 7469 6f6e 206f 6620 3344 2076 6563  ection of 3D vec
-00033be0: 746f 7273 2072 6570 7265 7365 6e74 6564  tors represented
-00033bf0: 2061 7320 6172 726f 7773 2e0d 0a0d 0a20   as arrows..... 
-00033c00: 2020 2022 2222 0d0a 0d0a 2020 2020 2320     """....    # 
-00033c10: 4675 7444 6576 3a20 6164 6469 7469 6f6e  FutDev: addition
-00033c20: 616c 206d 6574 686f 6473 2074 6f20 6164  al methods to ad
-00033c30: 6420 6675 6e63 7469 6f6e 616c 6974 792e  d functionality.
-00033c40: 0d0a 0d0a 2020 2020 6465 6620 5f5f 696e  ....    def __in
-00033c50: 6974 5f5f 2873 656c 662c 206c 6f63 6174  it__(self, locat
-00033c60: 696f 6e2c 2076 6563 7420 2c20 616c 723d  ion, vect , alr=
-00033c70: 4e6f 6e65 2c20 6e61 6d65 3d4e 6f6e 652c  None, name=None,
-00033c80: 202a 2a6b 7761 7267 7329 203a 0d0a 2020   **kwargs) :..  
-00033c90: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
-00033ca0: 2020 2043 7265 6174 6520 6120 636f 6c6c     Create a coll
-00033cb0: 6563 7469 6f6e 206f 6620 3344 2076 6563  ection of 3D vec
-00033cc0: 746f 7273 2e0d 0a0d 0a20 2020 2020 2020  tors.....       
-00033cd0: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
-00033ce0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
-00033cf0: 0a20 2020 2020 2020 206c 6f63 6174 696f  .        locatio
-00033d00: 6e20 3a20 4e20 7820 3320 666c 6f61 7420  n : N x 3 float 
-00033d10: 6172 7261 790d 0a20 2020 2020 2020 2020  array..         
-00033d20: 2020 2043 6172 7465 7369 616e 2063 6f6f     Cartesian coo
-00033d30: 7264 696e 6174 6520 6c6f 6361 7469 6f6e  rdinate location
-00033d40: 2028 7461 696c 7329 2066 6f72 204e 206e   (tails) for N n
-00033d50: 756d 6265 7220 6f66 2076 6563 746f 7273  umber of vectors
-00033d60: 2e0d 0a0d 0a20 2020 2020 2020 2076 6563  .....        vec
-00033d70: 7420 3a20 4e20 7820 3320 666c 6f61 7420  t : N x 3 float 
-00033d80: 6172 7261 790d 0a20 2020 2020 2020 2020  array..         
-00033d90: 2020 204e 206e 756d 6265 7220 6f66 2076     N number of v
-00033da0: 6563 746f 7273 2069 6e20 4361 7274 6573  ectors in Cartes
-00033db0: 6961 6e20 636f 6f72 6469 6e61 7465 732e  ian coordinates.
-00033dc0: 0d0a 0d0a 2020 2020 2020 2020 616c 7220  ....        alr 
-00033dd0: 3a20 7363 616c 6172 2c20 6f70 7469 6f6e  : scalar, option
-00033de0: 616c 2c20 6465 6661 756c 743a 2030 2e32  al, default: 0.2
-00033df0: 350d 0a20 2020 2020 2020 2020 2020 2041  5..            A
-00033e00: 7869 7320 6c65 6e67 7468 2072 6174 696f  xis length ratio
-00033e10: 2c20 6865 6164 2073 697a 6520 746f 2076  , head size to v
-00033e20: 6563 746f 7220 6d61 676e 6974 7564 652e  ector magnitude.
-00033e30: 0d0a 0d0a 2020 2020 2020 2020 6e61 6d65  ....        name
-00033e40: 203a 2073 7472 696e 6720 6964 656e 7469   : string identi
-00033e50: 6669 6572 0d0a 0d0a 2020 2020 2020 2020  fier....        
-00033e60: 4f74 6865 7220 5061 7261 6d65 7465 7273  Other Parameters
-00033e70: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-00033e80: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
-00033e90: 2020 2020 2a2a 6b77 6172 6773 0d0a 2020      **kwargs..  
-00033ea0: 2020 2020 2020 2020 2020 416c 6c20 6f74            All ot
-00033eb0: 6865 7220 7061 7261 6d65 7465 7273 2061  her parameters a
-00033ec0: 7265 2070 6173 7365 6420 6f6e 2074 6f20  re passed on to 
-00033ed0: 6d70 6c5f 746f 6f6c 6b69 7473 2e6d 706c  mpl_toolkits.mpl
-00033ee0: 6f74 3364 2e61 7274 3364 2e4c 696e 6533  ot3d.art3d.Line3
-00033ef0: 4443 6f6c 6c65 6374 696f 6e2e 0d0a 2020  DCollection...  
-00033f00: 2020 2020 2020 2020 2020 5661 6c69 6420            Valid 
-00033f10: 6b65 7977 6f72 6473 2069 6e63 6c75 6465  keywords include
-00033f20: 3a20 636f 6c6f 7273 2c20 6c69 6e65 7769  : colors, linewi
-00033f30: 6474 6873 2e0d 0a20 2020 2020 2020 200d  dths...        .
-00033f40: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
-00033f50: 2020 2020 2020 2320 6e6f 7465 3a20 7365        # note: se
-00033f60: 6c66 2063 6f6f 7220 7479 7065 7320 7072  lf coor types pr
-00033f70: 696d 6172 6961 6c6c 7920 7573 6564 2066  imarially used f
-00033f80: 6f72 2065 7870 6f72 7420 696e 666f 2e0d  or export info..
-00033f90: 0a0d 0a20 2020 2020 2020 2073 656c 662e  ...        self.
-00033fa0: 636f 6f72 5479 7065 203d 205f 434f 4f52  coorType = _COOR
-00033fb0: 5359 535b 2258 595a 225d 0d0a 2020 2020  SYS["XYZ"]..    
-00033fc0: 2020 2020 7365 6c66 2e75 7677 4f72 6965      self.uvwOrie
-00033fd0: 6e74 6174 696f 6e54 7970 6520 3d20 5f43  ntationType = _C
-00033fe0: 4f4f 5253 5953 5b22 5859 5a22 5d0d 0a0d  OORSYS["XYZ"]...
-00033ff0: 0a20 2020 2020 2020 2069 6620 616c 7220  .        if alr 
-00034000: 6973 204e 6f6e 6520 3a20 616c 7220 3d20  is None : alr = 
-00034010: 5f44 4654 5f41 4c52 0d0a 2020 2020 2020  _DFT_ALR..      
-00034020: 2020 7365 6c66 2e5f 616c 7220 3d20 616c    self._alr = al
-00034030: 720d 0a0d 0a20 2020 2020 2020 2073 656c  r....        sel
-00034040: 662e 6261 7365 4c6f 6361 7469 6f6e 203d  f.baseLocation =
-00034050: 206e 702e 6172 7261 7928 6c6f 6361 7469   np.array(locati
-00034060: 6f6e 2c20 6474 7970 653d 666c 6f61 7429  on, dtype=float)
-00034070: 0d0a 2020 2020 2020 2020 7365 6c66 2e62  ..        self.b
-00034080: 6173 6556 6563 7420 3d20 6e70 2e61 7272  aseVect = np.arr
-00034090: 6179 2876 6563 742c 2064 7479 7065 3d66  ay(vect, dtype=f
-000340a0: 6c6f 6174 290d 0a0d 0a20 2020 2020 2020  loat)....       
-000340b0: 206c 696e 6573 2c58 595a 2c55 5657 203d   lines,XYZ,UVW =
-000340c0: 2073 656c 662e 5f71 7569 7665 724c 696e   self._quiverLin
-000340d0: 6573 286c 6f63 6174 696f 6e2c 7665 6374  es(location,vect
-000340e0: 2c61 6c72 290d 0a20 2020 2020 2020 2023  ,alr)..        #
-000340f0: 206e 6f74 653a 205f 7175 6976 6572 4c69   note: _quiverLi
-00034100: 6e65 7320 6d61 7920 7265 6d6f 7665 207a  nes may remove z
-00034110: 6572 6f20 6c65 6e67 7468 2076 6563 740d  ero length vect.
-00034120: 0a20 2020 2020 2020 2073 656c 662e 6c6f  .        self.lo
-00034130: 6361 7469 6f6e 203d 2058 595a 0d0a 2020  cation = XYZ..  
-00034140: 2020 2020 2020 7365 6c66 2e76 6563 7420        self.vect 
-00034150: 3d20 5556 570d 0a0d 0a20 2020 2020 2020  = UVW....       
-00034160: 2069 6620 2763 6f6c 6f72 2720 696e 206b   if 'color' in k
-00034170: 7761 7267 7320 3a0d 0a20 2020 2020 2020  wargs :..       
-00034180: 2020 2020 2074 7279 3a0d 0a20 2020 2020       try:..     
-00034190: 2020 2020 2020 2020 2020 2074 6573 7420             test 
-000341a0: 3d20 636f 6c6f 7273 2e74 6f5f 7267 6261  = colors.to_rgba
-000341b0: 2820 6b77 6172 6773 5b27 636f 6c6f 7227  ( kwargs['color'
-000341c0: 5d20 290d 0a20 2020 2020 2020 2020 2020  ] )..           
-000341d0: 2065 7863 6570 743a 0d0a 2020 2020 2020   except:..      
-000341e0: 2020 2020 2020 2020 2020 6465 6c20 6b77            del kw
-000341f0: 6172 6773 5b27 636f 6c6f 7227 5d0d 0a20  args['color'].. 
-00034200: 2020 2020 2020 2020 2020 2020 2020 2077                 w
-00034210: 6172 6e69 6e67 732e 7761 726e 2822 4f6e  arnings.warn("On
-00034220: 6c79 2061 2053 494e 474c 4520 636f 6c6f  ly a SINGLE colo
-00034230: 7220 7661 6c75 6520 6d61 7920 6265 2075  r value may be u
-00034240: 7365 6420 666f 7220 7665 6374 6f72 2069  sed for vector i
-00034250: 6e73 7461 6e74 6961 7469 6f6e 2229 0d0a  nstantiation")..
-00034260: 0d0a 2020 2020 2020 2020 7375 7065 7228  ..        super(
-00034270: 292e 5f5f 696e 6974 5f5f 286c 696e 6573  ).__init__(lines
-00034280: 2c20 2a2a 6b77 6172 6773 290d 0a20 2020  , **kwargs)..   
-00034290: 2020 2020 2023 7365 6c66 2e5f 6765 6f6d       #self._geom
-000342a0: 4e61 6d65 203d 206e 616d 6520 2020 2023  Name = name    #
-000342b0: 2052 6564 756e 616e 7420 6672 6f6d 206e   Redunant from n
-000342c0: 6578 7420 6c69 6e65 2c20 696e 7465 726e  ext line, intern
-000342d0: 616c 2074 7261 636b 696e 6720 746f 2064  al tracking to d
-000342e0: 6574 6572 6d69 6e65 2069 6620 7365 742e  etermine if set.
-000342f0: 2e2e 0d0a 2020 2020 2020 2020 7365 6c66  ....        self
-00034300: 2e6e 616d 6520 3d20 6e61 6d65 0d0a 2020  .name = name..  
-00034310: 2020 2020 2020 7365 6c66 2e76 616c 7565        self.value
-00034320: 734e 616d 6520 3d20 4e6f 6e65 0d0a 2020  sName = None..  
-00034330: 2020 2020 2020 7365 6c66 2e62 6173 6543        self.baseC
-00034340: 6f6c 6f72 203d 206e 702e 6172 7261 7928  olor = np.array(
-00034350: 7365 6c66 2e67 6574 5f63 6f6c 6f72 2829  self.get_color()
-00034360: 5b30 5d29 2e66 6c61 7474 656e 2829 2e74  [0]).flatten().t
-00034370: 6f6c 6973 7428 290d 0a0d 0a0d 0a20 2020  olist()......   
-00034380: 2020 2020 2073 656c 662e 5f62 6f75 6e64       self._bound
-00034390: 7320 3d20 7b7d 0d0a 2020 2020 2020 2020  s = {}..        
-000343a0: 5f73 6574 5f67 656f 6d42 6f75 6e64 7328  _set_geomBounds(
-000343b0: 7365 6c66 2e6c 6f63 6174 696f 6e2c 7365  self.location,se
-000343c0: 6c66 2e5f 626f 756e 6473 290d 0a20 2020  lf._bounds)..   
-000343d0: 2020 2020 2073 656c 662e 5f62 6f75 6e64       self._bound
-000343e0: 735b 2776 6c69 6d27 5d20 3d20 2020 2020  s['vlim'] =     
-000343f0: 5f44 4654 5f56 4c49 4d20 2020 2020 2020  _DFT_VLIM       
-00034400: 2020 232e 2e20 6672 6f6d 206f 7065 7261    #.. from opera
-00034410: 7469 6f6e 0d0a 2020 2020 2020 2020 7365  tion..        se
-00034420: 6c66 2e5f 626f 756e 6473 5b27 7665 7274  lf._bounds['vert
-00034430: 766c 696d 275d 203d 205f 4446 545f 5645  vlim'] = _DFT_VE
-00034440: 5254 564c 494d 2020 2020 2023 2e2e 2066  RTVLIM     #.. f
-00034450: 726f 6d20 6469 7265 6374 696f 6e20 6f72  rom direction or
-00034460: 206d 6167 6e69 7475 6465 0d0a 0d0a 2020   magnitude....  
-00034470: 2020 6465 6620 5f73 6574 5f76 6563 7443    def _set_vectC
-00034480: 6f6c 6f72 2873 656c 662c 2063 6f6c 6f72  olor(self, color
-00034490: 2920 3a0d 0a20 2020 2020 2020 200d 0a20  ) :..        .. 
-000344a0: 2020 2020 2020 2023 206e 6f74 653a 2066         # note: f
-000344b0: 6f72 2061 206c 6973 7420 6f66 2066 6f75  or a list of fou
-000344c0: 7220 636f 6c6f 7273 205b 2041 2c42 2c43  r colors [ A,B,C
-000344d0: 2c44 205d 2c20 7265 7375 6c74 2069 730d  ,D ], result is.
-000344e0: 0a20 2020 2020 2020 2023 2020 2020 2020  .        #      
-000344f0: 205b 2041 2c42 2c43 2c44 2c20 412c 412c   [ A,B,C,D, A,A,
-00034500: 2042 2c42 2c20 432c 432c 2044 2c44 205d   B,B, C,C, D,D ]
-00034510: 2e0d 0a20 2020 2020 2020 2023 2020 2020  ...        #    
-00034520: 2020 206c 696e 6520 7365 676d 656e 7420     line segment 
-00034530: 636f 6c6f 7273 2c20 7468 656e 2061 2070  colors, then a p
-00034540: 6169 7220 666f 7220 6561 6368 2061 7272  air for each arr
-00034550: 6f77 2068 6561 6420 2832 206c 696e 6573  ow head (2 lines
-00034560: 292e 0d0a 0d0a 2020 2020 2020 2020 6865  ).....        he
-00034570: 6164 203d 206e 702e 6172 616e 6765 286c  ad = np.arange(l
-00034580: 656e 2863 6f6c 6f72 2929 0d0a 2020 2020  en(color))..    
-00034590: 2020 2020 7461 696c 203d 206e 702e 7261      tail = np.ra
-000345a0: 7665 6c28 205b 205b 6865 6164 5d2c 5b68  vel( [ [head],[h
-000345b0: 6561 645d 205d 202c 206f 7264 6572 3d27  ead] ] , order='
-000345c0: 4627 290d 0a20 2020 2020 2020 2069 6e64  F')..        ind
-000345d0: 6578 203d 206e 702e 6170 7065 6e64 2868  ex = np.append(h
-000345e0: 6561 642c 7461 696c 290d 0a20 2020 2020  ead,tail)..     
-000345f0: 2020 2073 656c 662e 5f65 6467 6563 6f6c     self._edgecol
-00034600: 6f72 7320 3d20 636f 6c6f 725b 696e 6465  ors = color[inde
-00034610: 785d 0d0a 2020 2020 2020 2020 7265 7475  x]..        retu
-00034620: 726e 0d0a 0d0a 2020 2020 6465 6620 5f5f  rn....    def __
-00034630: 7374 725f 5f28 7365 6c66 2920 3a0d 0a20  str__(self) :.. 
-00034640: 2020 2020 2020 2023 206e 6f74 653a 2065         # note: e
-00034650: 6163 6820 7665 6374 6f72 2072 6570 7265  ach vector repre
-00034660: 7365 6e74 6174 696f 6e20 6973 2063 6f6d  sentation is com
-00034670: 706f 7365 6420 6f66 2033 206c 696e 6573  posed of 3 lines
-00034680: 0d0a 2020 2020 2020 2020 6e75 6d62 5665  ..        numbVe
-00034690: 6374 203d 2069 6e74 286c 656e 2873 656c  ct = int(len(sel
-000346a0: 662e 5f73 6567 6d65 6e74 7333 6429 2f33  f._segments3d)/3
-000346b0: 290d 0a20 2020 2020 2020 206e 616d 6520  )..        name 
-000346c0: 3d20 7365 6c66 2e5f 5f63 6c61 7373 5f5f  = self.__class__
-000346d0: 2e5f 5f6e 616d 655f 5f0d 0a20 2020 2020  .__name__..     
-000346e0: 2020 2076 616c 203d 206e 616d 6520 2b20     val = name + 
-000346f0: 273a 2020 7665 6374 6f72 733a 207b 7d27  ':  vectors: {}'
-00034700: 2e66 6f72 6d61 7428 6e75 6d62 5665 6374  .format(numbVect
-00034710: 290d 0a20 2020 2020 2020 2072 6574 7572  )..        retur
-00034720: 6e20 7661 6c0d 0a0d 0a20 2020 2064 6566  n val....    def
-00034730: 205f 7175 6976 6572 4c69 6e65 7328 2073   _quiverLines( s
-00034740: 656c 662c 2076 432c 2076 4e2c 2061 6c72  elf, vC, vN, alr
-00034750: 2920 3a0d 0a20 2020 2020 2020 2023 202e  ) :..        # .
-00034760: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00034770: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00034780: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00034790: 2e0d 0a20 2020 2020 2020 2064 6566 2071  ...        def q
-000347a0: 7569 7665 7228 202a 6172 6773 2c20 6c65  uiver( *args, le
-000347b0: 6e67 7468 3d31 2c20 6172 726f 775f 6c65  ngth=1, arrow_le
-000347c0: 6e67 7468 5f72 6174 696f 3d61 6c72 2c20  ngth_ratio=alr, 
-000347d0: 7069 766f 743d 2774 6169 6c27 2c20 6e6f  pivot='tail', no
-000347e0: 726d 616c 697a 653d 4661 6c73 6529 3a0d  rmalize=False):.
-000347f0: 0a20 2020 2020 2020 2020 2020 2023 2074  .            # t
-00034800: 616b 656e 2064 6972 6563 746c 7920 6672  aken directly fr
-00034810: 6f6d 206d 706c 5f74 6f6f 6c6b 6974 732e  om mpl_toolkits.
-00034820: 6d70 6c6f 7433 642e 6178 6573 3364 2073  mplot3d.axes3d s
-00034830: 6f75 7263 6520 0d0a 2020 2020 2020 2020  ource ..        
-00034840: 2020 2020 2320 616e 6420 7265 6d6f 7665      # and remove
-00034850: 6420 6178 6973 2072 6566 6572 656e 6365  d axis reference
-00034860: 2e20 2041 636b 6e6f 776c 6564 6765 6d65  .  Acknowledgeme
-00034870: 6e74 3a0d 0a20 2020 2020 2020 2020 2020  nt:..           
-00034880: 2023 2043 6f70 7972 6967 6874 2028 6329   # Copyright (c)
-00034890: 2032 3031 322d 3230 3133 204d 6174 706c   2012-2013 Matpl
-000348a0: 6f74 6c69 6220 4465 7665 6c6f 706d 656e  otlib Developmen
-000348b0: 7420 5465 616d 3b20 416c 6c20 5269 6768  t Team; All Righ
-000348c0: 7473 2052 6573 6572 7665 640d 0a20 2020  ts Reserved..   
-000348d0: 2020 2020 2020 2020 2023 202e 2e2e 2e2e           # .....
-000348e0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-000348f0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00034900: 2e2e 2e2e 2e2e 2e2e 2e2e 0d0a 2020 2020  ............    
-00034910: 2020 2020 2020 2020 6465 6620 6361 6c63          def calc
-00034920: 5f61 7272 6f77 2875 7677 2c20 616e 676c  _arrow(uvw, angl
-00034930: 653d 3135 293a 0d0a 2020 2020 2020 2020  e=15):..        
-00034940: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
-00034950: 2020 2020 2020 2020 2020 2020 2054 6f20               To 
-00034960: 6361 6c63 756c 6174 6520 7468 6520 6172  calculate the ar
-00034970: 726f 7720 6865 6164 2e20 7576 7720 7368  row head. uvw sh
-00034980: 6f75 6c64 2062 6520 6120 756e 6974 2076  ould be a unit v
-00034990: 6563 746f 722e 0d0a 2020 2020 2020 2020  ector...        
-000349a0: 2020 2020 2020 2020 5765 206e 6f72 6d61          We norma
-000349b0: 6c69 7a65 2069 7420 6865 7265 3a0d 0a20  lize it here:.. 
-000349c0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-000349d0: 2222 0d0a 2020 2020 2020 2020 2020 2020  ""..            
-000349e0: 2020 2020 2320 6765 7420 756e 6974 2064      # get unit d
-000349f0: 6972 6563 7469 6f6e 2076 6563 746f 7220  irection vector 
-00034a00: 7065 7270 656e 6469 6375 6c61 7220 746f  perpendicular to
-00034a10: 2028 752c 762c 7729 0d0a 2020 2020 2020   (u,v,w)..      
-00034a20: 2020 2020 2020 2020 2020 6e6f 726d 203d            norm =
-00034a30: 206e 702e 6c69 6e61 6c67 2e6e 6f72 6d28   np.linalg.norm(
-00034a40: 7576 775b 3a32 5d29 0d0a 2020 2020 2020  uvw[:2])..      
-00034a50: 2020 2020 2020 2020 2020 6966 206e 6f72            if nor
-00034a60: 6d20 3e20 303a 0d0a 2020 2020 2020 2020  m > 0:..        
-00034a70: 2020 2020 2020 2020 2020 2020 7820 3d20              x = 
-00034a80: 7576 775b 315d 202f 206e 6f72 6d0d 0a20  uvw[1] / norm.. 
-00034a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034aa0: 2020 2079 203d 202d 7576 775b 305d 202f     y = -uvw[0] /
-00034ab0: 206e 6f72 6d0d 0a20 2020 2020 2020 2020   norm..         
-00034ac0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-00034ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034ae0: 2020 782c 2079 203d 2030 2c20 310d 0a0d    x, y = 0, 1...
-00034af0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00034b00: 2023 2063 6f6d 7075 7465 2074 6865 2074   # compute the t
-00034b10: 776f 2061 7272 6f77 6865 6164 2064 6972  wo arrowhead dir
-00034b20: 6563 7469 6f6e 2075 6e69 7420 7665 6374  ection unit vect
-00034b30: 6f72 730d 0a20 2020 2020 2020 2020 2020  ors..           
-00034b40: 2020 2020 2072 6120 3d20 6e70 2e72 6164       ra = np.rad
-00034b50: 6961 6e73 2861 6e67 6c65 290d 0a20 2020  ians(angle)..   
-00034b60: 2020 2020 2020 2020 2020 2020 2063 203d               c =
-00034b70: 206e 702e 636f 7328 7261 290d 0a20 2020   np.cos(ra)..   
-00034b80: 2020 2020 2020 2020 2020 2020 2073 203d               s =
-00034b90: 206e 702e 7369 6e28 7261 290d 0a0d 0a20   np.sin(ra).... 
-00034ba0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00034bb0: 2063 6f6e 7374 7275 6374 2074 6865 2072   construct the r
-00034bc0: 6f74 6174 696f 6e20 6d61 7472 6963 6573  otation matrices
-00034bd0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00034be0: 2020 5270 6f73 203d 206e 702e 6172 7261    Rpos = np.arra
-00034bf0: 7928 5b5b 632b 2878 2a2a 3229 2a28 312d  y([[c+(x**2)*(1-
-00034c00: 6329 2c20 782a 792a 2831 2d63 292c 2079  c), x*y*(1-c), y
-00034c10: 2a73 5d2c 0d0a 2020 2020 2020 2020 2020  *s],..          
-00034c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034c30: 2020 2020 2020 5b79 2a78 2a28 312d 6329        [y*x*(1-c)
-00034c40: 2c20 632b 2879 2a2a 3229 2a28 312d 6329  , c+(y**2)*(1-c)
-00034c50: 2c20 2d78 2a73 5d2c 0d0a 2020 2020 2020  , -x*s],..      
-00034c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034c70: 2020 2020 2020 2020 2020 5b2d 792a 732c            [-y*s,
-00034c80: 2078 2a73 2c20 635d 5d29 0d0a 2020 2020   x*s, c]])..    
-00034c90: 2020 2020 2020 2020 2020 2020 2320 6f70              # op
-00034ca0: 706f 7369 7465 2072 6f74 6174 696f 6e20  posite rotation 
-00034cb0: 6e65 6761 7465 7320 616c 6c20 7468 6520  negates all the 
-00034cc0: 7369 6e20 7465 726d 730d 0a20 2020 2020  sin terms..     
-00034cd0: 2020 2020 2020 2020 2020 2052 6e65 6720             Rneg 
-00034ce0: 3d20 5270 6f73 2e63 6f70 7928 290d 0a20  = Rpos.copy().. 
-00034cf0: 2020 2020 2020 2020 2020 2020 2020 2052                 R
-00034d00: 6e65 675b 5b30 2c20 312c 2032 2c20 325d  neg[[0, 1, 2, 2]
-00034d10: 2c20 5b32 2c20 322c 2030 2c20 315d 5d20  , [2, 2, 0, 1]] 
-00034d20: 3d20 5c0d 0a20 2020 2020 2020 2020 2020  = \..           
-00034d30: 2020 2020 2020 2020 202d 526e 6567 5b5b           -Rneg[[
-00034d40: 302c 2031 2c20 322c 2032 5d2c 205b 322c  0, 1, 2, 2], [2,
-00034d50: 2032 2c20 302c 2031 5d5d 0d0a 0d0a 2020   2, 0, 1]]....  
-00034d60: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-00034d70: 6d75 6c74 6970 6c79 2074 6865 6d20 746f  multiply them to
-00034d80: 2067 6574 2074 6865 2072 6f74 6174 6564   get the rotated
-00034d90: 2076 6563 746f 720d 0a20 2020 2020 2020   vector..       
-00034da0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00034db0: 5270 6f73 2e64 6f74 2875 7677 292c 2052  Rpos.dot(uvw), R
-00034dc0: 6e65 672e 646f 7428 7576 7729 0d0a 2020  neg.dot(uvw)..  
-00034dd0: 2020 2020 2020 2020 2020 2320 2e2e 2e2e            # ....
-00034de0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00034df0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00034e00: 2e2e 2e2e 2e2e 2e2e 2e2e 2e0d 0a20 2020  .............   
-00034e10: 2020 2020 2020 2020 2061 7267 6920 3d20           argi = 
-00034e20: 360d 0a20 2020 2020 2020 2020 2020 2069  6..            i
-00034e30: 6620 6c65 6e28 6172 6773 2920 3c20 6172  f len(args) < ar
-00034e40: 6769 3a0d 0a20 2020 2020 2020 2020 2020  gi:..           
-00034e50: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-00034e60: 4572 726f 7228 2757 726f 6e67 206e 756d  Error('Wrong num
-00034e70: 6265 7220 6f66 2061 7267 756d 656e 7473  ber of arguments
-00034e80: 2e20 4578 7065 6374 6564 2025 6420 676f  . Expected %d go
-00034e90: 7420 2564 2720 250d 0a20 2020 2020 2020  t %d' %..       
-00034ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034eb0: 2020 2020 2020 2020 2028 6172 6769 2c20           (argi, 
-00034ec0: 6c65 6e28 6172 6773 2929 290d 0a20 2020  len(args)))..   
-00034ed0: 2020 2020 2020 2020 2069 6e70 7574 5f61           input_a
-00034ee0: 7267 7320 3d20 6172 6773 5b3a 6172 6769  rgs = args[:argi
-00034ef0: 5d0d 0a20 2020 2020 2020 2020 2020 206d  ]..            m
-00034f00: 6173 6b73 203d 205b 6b2e 6d61 736b 2066  asks = [k.mask f
-00034f10: 6f72 206b 2069 6e20 696e 7075 745f 6172  or k in input_ar
-00034f20: 6773 0d0a 2020 2020 2020 2020 2020 2020  gs..            
-00034f30: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-00034f40: 7461 6e63 6528 6b2c 206e 702e 6d61 2e4d  tance(k, np.ma.M
-00034f50: 6173 6b65 6441 7272 6179 295d 0d0a 2020  askedArray)]..  
-00034f60: 2020 2020 2020 2020 2020 6263 6173 7420            bcast 
-00034f70: 3d20 6e70 2e62 726f 6164 6361 7374 5f61  = np.broadcast_a
-00034f80: 7272 6179 7328 2a69 6e70 7574 5f61 7267  rrays(*input_arg
-00034f90: 732c 202a 6d61 736b 7329 0d0a 2020 2020  s, *masks)..    
-00034fa0: 2020 2020 2020 2020 696e 7075 745f 6172          input_ar
-00034fb0: 6773 203d 2062 6361 7374 5b3a 6172 6769  gs = bcast[:argi
-00034fc0: 5d0d 0a20 2020 2020 2020 2020 2020 206d  ]..            m
-00034fd0: 6173 6b73 203d 2062 6361 7374 5b61 7267  asks = bcast[arg
-00034fe0: 693a 5d0d 0a20 2020 2020 2020 2020 2020  i:]..           
-00034ff0: 2069 6620 6d61 736b 733a 0d0a 2020 2020   if masks:..    
-00035000: 2020 2020 2020 2020 2020 2020 6d61 736b              mask
-00035010: 203d 2072 6564 7563 6528 6e70 2e6c 6f67   = reduce(np.log
-00035020: 6963 616c 5f6f 722c 206d 6173 6b73 290d  ical_or, masks).
-00035030: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00035040: 2069 6e70 7574 5f61 7267 7320 3d20 5b6e   input_args = [n
-00035050: 702e 6d61 2e61 7272 6179 286b 2c20 6d61  p.ma.array(k, ma
-00035060: 736b 3d6d 6173 6b29 2e63 6f6d 7072 6573  sk=mask).compres
-00035070: 7365 6428 290d 0a20 2020 2020 2020 2020  sed()..         
-00035080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035090: 2020 2066 6f72 206b 2069 6e20 696e 7075     for k in inpu
-000350a0: 745f 6172 6773 5d0d 0a20 2020 2020 2020  t_args]..       
-000350b0: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-000350c0: 2020 2020 2020 2020 2020 2020 696e 7075              inpu
-000350d0: 745f 6172 6773 203d 205b 6e70 2e72 6176  t_args = [np.rav
-000350e0: 656c 286b 2920 666f 7220 6b20 696e 2069  el(k) for k in i
-000350f0: 6e70 7574 5f61 7267 735d 0d0a 0d0a 2020  nput_args]....  
-00035100: 2020 2020 2020 2020 2020 6966 2061 6e79            if any
-00035110: 286c 656e 2876 2920 3d3d 2030 2066 6f72  (len(v) == 0 for
-00035120: 2076 2069 6e20 696e 7075 745f 6172 6773   v in input_args
-00035130: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-00035140: 2020 2020 7265 7475 726e 205b 5d0d 0a20      return [].. 
-00035150: 2020 2020 2020 2020 2020 2073 6861 6674             shaft
-00035160: 5f64 7420 3d20 6e70 2e61 7272 6179 285b  _dt = np.array([
-00035170: 302c 206c 656e 6774 685d 290d 0a20 2020  0, length])..   
-00035180: 2020 2020 2020 2020 2061 7272 6f77 5f64           arrow_d
-00035190: 7420 3d20 7368 6166 745f 6474 202a 2061  t = shaft_dt * a
-000351a0: 7272 6f77 5f6c 656e 6774 685f 7261 7469  rrow_length_rati
-000351b0: 6f0d 0a20 2020 2020 2020 2020 2020 2069  o..            i
-000351c0: 6620 7069 766f 7420 3d3d 2027 7461 696c  f pivot == 'tail
-000351d0: 273a 0d0a 2020 2020 2020 2020 2020 2020  ':..            
-000351e0: 2020 2020 7368 6166 745f 6474 202d 3d20      shaft_dt -= 
-000351f0: 6c65 6e67 7468 0d0a 2020 2020 2020 2020  length..        
-00035200: 2020 2020 656c 6966 2070 6976 6f74 203d      elif pivot =
-00035210: 3d20 276d 6964 646c 6527 3a0d 0a20 2020  = 'middle':..   
-00035220: 2020 2020 2020 2020 2020 2020 2073 6861               sha
-00035230: 6674 5f64 7420 2d3d 206c 656e 6774 682f  ft_dt -= length/
-00035240: 322e 0d0a 2020 2020 2020 2020 2020 2020  2...            
-00035250: 656c 6966 2070 6976 6f74 2021 3d20 2774  elif pivot != 't
-00035260: 6970 273a 0d0a 2020 2020 2020 2020 2020  ip':..          
-00035270: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-00035280: 6545 7272 6f72 2827 496e 7661 6c69 6420  eError('Invalid 
-00035290: 7069 766f 7420 6172 6775 6d65 6e74 3a20  pivot argument: 
-000352a0: 2720 2b20 7374 7228 7069 766f 7429 290d  ' + str(pivot)).
-000352b0: 0a20 2020 2020 2020 2020 2020 2058 595a  .            XYZ
-000352c0: 203d 206e 702e 636f 6c75 6d6e 5f73 7461   = np.column_sta
-000352d0: 636b 2869 6e70 7574 5f61 7267 735b 3a33  ck(input_args[:3
-000352e0: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
-000352f0: 5556 5720 3d20 6e70 2e63 6f6c 756d 6e5f  UVW = np.column_
-00035300: 7374 6163 6b28 696e 7075 745f 6172 6773  stack(input_args
-00035310: 5b33 3a61 7267 695d 292e 6173 7479 7065  [3:argi]).astype
-00035320: 2866 6c6f 6174 290d 0a20 2020 2020 2020  (float)..       
-00035330: 2020 2020 206e 6f72 6d20 3d20 6e70 2e6c       norm = np.l
-00035340: 696e 616c 672e 6e6f 726d 2855 5657 2c20  inalg.norm(UVW, 
-00035350: 6178 6973 3d31 290d 0a20 2020 2020 2020  axis=1)..       
-00035360: 2020 2020 206d 6173 6b20 3d20 6e6f 726d       mask = norm
-00035370: 203e 2030 0d0a 2020 2020 2020 2020 2020   > 0..          
-00035380: 2020 5859 5a20 3d20 5859 5a5b 6d61 736b    XYZ = XYZ[mask
-00035390: 5d0d 0a20 2020 2020 2020 2020 2020 2069  ]..            i
-000353a0: 6620 6e6f 726d 616c 697a 653a 0d0a 2020  f normalize:..  
-000353b0: 2020 2020 2020 2020 2020 2020 2020 5556                UV
-000353c0: 5720 3d20 5556 575b 6d61 736b 5d20 2f20  W = UVW[mask] / 
-000353d0: 6e6f 726d 5b6d 6173 6b5d 2e72 6573 6861  norm[mask].resha
-000353e0: 7065 2828 2d31 2c20 3129 290d 0a20 2020  pe((-1, 1))..   
-000353f0: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
-00035400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035410: 5556 5720 3d20 5556 575b 6d61 736b 5d0d  UVW = UVW[mask].
-00035420: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00035430: 6c65 6e28 5859 5a29 203e 2030 3a0d 0a20  len(XYZ) > 0:.. 
-00035440: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00035450: 6861 6674 7320 3d20 2858 595a 202d 206e  hafts = (XYZ - n
-00035460: 702e 6d75 6c74 6970 6c79 2e6f 7574 6572  p.multiply.outer
-00035470: 2873 6861 6674 5f64 742c 2055 5657 2929  (shaft_dt, UVW))
-00035480: 2e73 7761 7061 7865 7328 302c 2031 290d  .swapaxes(0, 1).
-00035490: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000354a0: 2068 6561 645f 6469 7273 203d 206e 702e   head_dirs = np.
-000354b0: 6172 7261 7928 5b63 616c 635f 6172 726f  array([calc_arro
-000354c0: 7728 6429 2066 6f72 2064 2069 6e20 5556  w(d) for d in UV
-000354d0: 575d 290d 0a20 2020 2020 2020 2020 2020  W])..           
-000354e0: 2020 2020 2068 6561 6473 203d 2073 6861       heads = sha
-000354f0: 6674 735b 3a2c 203a 315d 202d 206e 702e  fts[:, :1] - np.
-00035500: 6d75 6c74 6970 6c79 2e6f 7574 6572 2861  multiply.outer(a
-00035510: 7272 6f77 5f64 742c 2068 6561 645f 6469  rrow_dt, head_di
-00035520: 7273 290d 0a20 2020 2020 2020 2020 2020  rs)..           
-00035530: 2020 2020 2068 6561 6473 2e73 6861 7065       heads.shape
-00035540: 203d 2028 6c65 6e28 6172 726f 775f 6474   = (len(arrow_dt
-00035550: 292c 202d 312c 2033 290d 0a20 2020 2020  ), -1, 3)..     
-00035560: 2020 2020 2020 2020 2020 2068 6561 6473             heads
-00035570: 203d 2068 6561 6473 2e73 7761 7061 7865   = heads.swapaxe
-00035580: 7328 302c 2031 290d 0a20 2020 2020 2020  s(0, 1)..       
-00035590: 2020 2020 2020 2020 206c 696e 6573 203d           lines =
-000355a0: 205b 2a73 6861 6674 732c 202a 6865 6164   [*shafts, *head
-000355b0: 735d 0d0a 2020 2020 2020 2020 2020 2020  s]..            
-000355c0: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-000355d0: 2020 2020 2020 206c 696e 6573 203d 205b         lines = [
-000355e0: 5d0d 0a20 2020 2020 2020 2020 2020 2072  ]..            r
-000355f0: 6574 7572 6e20 6c69 6e65 7320 2c20 5859  eturn lines , XY
-00035600: 5a2c 5556 5720 2020 2320 3c2d 2d2d 2061  Z,UVW   # <--- a
-00035610: 6464 6564 2072 6574 7572 6e20 6f66 2058  dded return of X
-00035620: 595a 2c55 5657 0d0a 2020 2020 2020 2020  YZ,UVW..        
-00035630: 2320 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  # ..............
-00035640: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00035650: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00035660: 2e2e 2e2e 0d0a 2020 2020 2020 2020 782c  ......        x,
-00035670: 792c 7a20 3d20 6e70 2e74 7261 6e73 706f  y,z = np.transpo
-00035680: 7365 2820 7643 2029 0d0a 2020 2020 2020  se( vC )..      
-00035690: 2020 752c 762c 7720 3d20 6e70 2e74 7261    u,v,w = np.tra
-000356a0: 6e73 706f 7365 2820 764e 2029 0d0a 2020  nspose( vN )..  
-000356b0: 2020 2020 2020 6c69 6e65 732c 2058 595a        lines, XYZ
-000356c0: 2c20 5556 5720 3d20 7175 6976 6572 2878  , UVW = quiver(x
-000356d0: 2c79 2c7a 2c75 2c76 2c77 290d 0a20 2020  ,y,z,u,v,w)..   
-000356e0: 2020 2020 2072 6574 7572 6e20 6c69 6e65       return line
-000356f0: 732c 2058 595a 2c20 5556 570d 0a0d 0a20  s, XYZ, UVW.... 
-00035700: 2020 2040 7072 6f70 6572 7479 0d0a 2020     @property..  
-00035710: 2020 6465 6620 616c 7228 7365 6c66 2920    def alr(self) 
-00035720: 3a0d 0a20 2020 2020 2020 2027 2727 4172  :..        '''Ar
-00035730: 726f 7720 6865 6164 2074 6f20 6c65 6e67  row head to leng
-00035740: 7468 2072 6174 696f 2e27 2727 0d0a 2020  th ratio.'''..  
-00035750: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00035760: 662e 5f61 6c72 0d0a 0d0a 2020 2020 4061  f._alr....    @a
-00035770: 6c72 2e73 6574 7465 720d 0a20 2020 2064  lr.setter..    d
-00035780: 6566 2061 6c72 2873 656c 662c 2076 616c  ef alr(self, val
-00035790: 2920 3a0d 0a20 2020 2020 2020 206c 6f63  ) :..        loc
-000357a0: 6174 696f 6e20 3d20 7365 6c66 2e62 6173  ation = self.bas
-000357b0: 654c 6f63 6174 696f 6e0d 0a20 2020 2020  eLocation..     
-000357c0: 2020 2076 6563 7420 3d20 7365 6c66 2e62     vect = self.b
-000357d0: 6173 6556 6563 740d 0a20 2020 2020 2020  aseVect..       
-000357e0: 2069 6620 7661 6c20 6973 204e 6f6e 6520   if val is None 
-000357f0: 3a20 7661 6c20 3d20 5f44 4654 5f41 4c52  : val = _DFT_ALR
-00035800: 0d0a 2020 2020 2020 2020 7365 6c66 2e5f  ..        self._
-00035810: 616c 7220 3d20 7661 6c0d 0a20 2020 2020  alr = val..     
-00035820: 2020 206c 696e 6573 2c58 2c59 203d 2073     lines,X,Y = s
-00035830: 656c 662e 5f71 7569 7665 724c 696e 6573  elf._quiverLines
-00035840: 286c 6f63 6174 696f 6e2c 7665 6374 2c73  (location,vect,s
-00035850: 656c 662e 5f61 6c72 290d 0a20 2020 2020  elf._alr)..     
-00035860: 2020 2073 656c 662e 7365 745f 7365 676d     self.set_segm
-00035870: 656e 7473 286c 696e 6573 290d 0a20 2020  ents(lines)..   
-00035880: 2020 2020 2072 6574 7572 6e0d 0a0d 0a20       return.... 
-00035890: 2020 2040 7072 6f70 6572 7479 0d0a 2020     @property..  
-000358a0: 2020 6465 6620 766c 696d 2873 656c 6629    def vlim(self)
-000358b0: 203a 0d0a 2020 2020 2020 2020 2727 2752   :..        '''R
-000358c0: 616e 6765 206f 6620 7661 6c75 6573 2061  ange of values a
-000358d0: 7373 6f63 6961 7465 6420 7769 7468 2063  ssociated with c
-000358e0: 6f6c 6f72 2727 270d 0a20 2020 2020 2020  olor'''..       
-000358f0: 2072 6574 7572 6e20 7365 6c66 2e5f 626f   return self._bo
-00035900: 756e 6473 5b27 766c 696d 275d 0d0a 0d0a  unds['vlim']....
-00035910: 2020 2020 4076 6c69 6d2e 7365 7474 6572      @vlim.setter
-00035920: 0d0a 2020 2020 6465 6620 766c 696d 2873  ..    def vlim(s
-00035930: 656c 662c 7661 6c29 203a 0d0a 2020 2020  elf,val) :..    
-00035940: 2020 2020 7365 6c66 2e5f 626f 756e 6473      self._bounds
-00035950: 5b27 766c 696d 275d 203d 2076 616c 0d0a  ['vlim'] = val..
-00035960: 2020 2020 2020 2020 7265 7475 726e 0d0a          return..
-00035970: 0d0a 2020 2020 4070 726f 7065 7274 790d  ..    @property.
-00035980: 0a20 2020 2064 6566 206e 616d 6528 7365  .    def name(se
-00035990: 6c66 2920 3a0d 0a20 2020 2020 2020 2027  lf) :..        '
-000359a0: 2727 4465 7363 7269 7074 6976 6520 6964  ''Descriptive id
-000359b0: 656e 7469 6669 6572 2066 6f72 2074 6865  entifier for the
-000359c0: 2076 6563 746f 7220 6765 6f6d 6574 7279   vector geometry
-000359d0: 2e27 2727 0d0a 2020 2020 2020 2020 6966  .'''..        if
-000359e0: 2073 656c 662e 5f67 656f 6d4e 616d 6520   self._geomName 
-000359f0: 6973 204e 6f6e 6520 3a20 7265 7475 726e  is None : return
-00035a00: 2027 270d 0a20 2020 2020 2020 2072 6574   ''..        ret
-00035a10: 7572 6e20 7365 6c66 2e5f 6765 6f6d 4e61  urn self._geomNa
-00035a20: 6d65 0d0a 0d0a 2020 2020 406e 616d 652e  me....    @name.
-00035a30: 7365 7474 6572 0d0a 2020 2020 6465 6620  setter..    def 
-00035a40: 6e61 6d65 2873 656c 662c 2076 616c 2920  name(self, val) 
-00035a50: 3a0d 0a20 2020 2020 2020 2073 656c 662e  :..        self.
-00035a60: 5f67 656f 6d4e 616d 6520 3d20 7661 6c0d  _geomName = val.
-00035a70: 0a20 2020 2020 2020 2073 656c 662e 7365  .        self.se
-00035a80: 745f 6c61 6265 6c28 2027 2720 6966 2076  t_label( '' if v
-00035a90: 616c 2069 7320 4e6f 6e65 2065 6c73 6520  al is None else 
-00035aa0: 7661 6c29 0d0a 2020 2020 2020 2020 7265  val)..        re
-00035ab0: 7475 726e 0d0a 0d0a 2020 2020 4070 726f  turn....    @pro
-00035ac0: 7065 7274 790d 0a20 2020 2064 6566 2063  perty..    def c
-00035ad0: 6e61 6d65 2873 656c 6629 203a 0d0a 2020  name(self) :..  
-00035ae0: 2020 2020 2020 2727 2744 6573 6372 6970        '''Descrip
-00035af0: 7469 7665 2069 6465 6e74 6966 6965 7220  tive identifier 
-00035b00: 666f 7220 7661 6c75 6573 2069 6e64 6963  for values indic
-00035b10: 6174 6564 2062 7920 636f 6c6f 722e 2727  ated by color.''
-00035b20: 270d 0a20 2020 2020 2020 2069 6620 7365  '..        if se
-00035b30: 6c66 2e76 616c 7565 734e 616d 6520 6973  lf.valuesName is
-00035b40: 204e 6f6e 6520 3a20 7265 7475 726e 2027   None : return '
-00035b50: 270d 0a20 2020 2020 2020 2072 6574 7572  '..        retur
-00035b60: 6e20 7365 6c66 2e76 616c 7565 734e 616d  n self.valuesNam
-00035b70: 650d 0a0d 0a20 2020 2040 636e 616d 652e  e....    @cname.
-00035b80: 7365 7474 6572 0d0a 2020 2020 6465 6620  setter..    def 
-00035b90: 636e 616d 6528 7365 6c66 2c20 7661 6c29  cname(self, val)
-00035ba0: 203a 0d0a 2020 2020 2020 2020 7365 6c66   :..        self
-00035bb0: 2e76 616c 7565 734e 616d 6520 3d20 7661  .valuesName = va
-00035bc0: 6c0d 0a20 2020 2020 2020 2072 6574 7572  l..        retur
-00035bd0: 6e0d 0a0d 0a20 2020 2040 7072 6f70 6572  n....    @proper
-00035be0: 7479 0d0a 2020 2020 6465 6620 626f 756e  ty..    def boun
-00035bf0: 6473 2873 656c 6629 203a 0d0a 2020 2020  ds(self) :..    
-00035c00: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
-00035c10: 2044 6963 7469 6f6e 6172 7920 6f66 2076   Dictionary of v
-00035c20: 6563 746f 7220 6765 6f6d 6574 7269 6320  ector geometric 
-00035c30: 616e 6420 7661 6c75 6520 7261 6e67 6573  and value ranges
-00035c40: 2e0d 0a20 2020 2020 2020 200d 0a20 2020  ...        ..   
-00035c50: 2020 2020 2045 6163 6820 6469 6374 696f       Each dictio
-00035c60: 6e61 7279 2076 616c 7565 2069 7320 6120  nary value is a 
-00035c70: 3220 666c 6f61 7420 6172 7261 7920 6f66  2 float array of
-00035c80: 206d 696e 696d 756d 0d0a 2020 2020 2020   minimum..      
-00035c90: 2020 616e 6420 6d61 7869 6d75 6d20 7661    and maximum va
-00035ca0: 6c75 6573 206f 6620 7468 6520 7665 6374  lues of the vect
-00035cb0: 6f72 206c 6f63 6174 696f 6e2e 2020 4b65  or location.  Ke
-00035cc0: 7973 2061 7265 3a0d 0a0d 0a20 2020 2020  ys are:....     
-00035cd0: 2020 2027 786c 696d 2720 3a20 782d 636f     'xlim' : x-co
-00035ce0: 6f72 6469 6e61 7465 0d0a 0d0a 2020 2020  ordinate....    
-00035cf0: 2020 2020 2779 6c69 6d27 203a 2079 2d63      'ylim' : y-c
-00035d00: 6f6f 7264 696e 6174 650d 0a0d 0a20 2020  oordinate....   
-00035d10: 2020 2020 2027 7a6c 696d 2720 3a20 7a2d       'zlim' : z-
-00035d20: 636f 6f72 6469 6e61 7465 0d0a 0d0a 2020  coordinate....  
-00035d30: 2020 2020 2020 2772 5f78 7927 203a 2072        'r_xy' : r
-00035d40: 6164 6961 6c20 6469 7374 616e 6365 2066  adial distance f
-00035d50: 726f 6d20 7468 6520 7a20 6178 6973 0d0a  rom the z axis..
-00035d60: 0d0a 2020 2020 2020 2020 2772 6f72 6727  ..        'rorg'
-00035d70: 203a 2072 6164 6961 6c20 6469 7374 616e   : radial distan
-00035d80: 6365 2066 726f 6d20 7468 6520 6f72 6967  ce from the orig
-00035d90: 696e 0d0a 0d0a 2020 2020 2020 2020 2776  in....        'v
-00035da0: 6c69 6d27 203a 2076 616c 7565 2066 756e  lim' : value fun
-00035db0: 6374 696f 6e61 6c20 6173 7369 676e 6d65  ctional assignme
-00035dc0: 6e74 732e 0d0a 0d0a 2020 2020 2020 2020  nts.....        
-00035dd0: 2776 6572 7476 6c69 6d3a 206d 6167 6e69  'vertvlim: magni
-00035de0: 7475 6465 0d0a 2020 2020 2020 2020 2020  tude..          
-00035df0: 2020 0d0a 2020 2020 2020 2020 5661 6c75    ..        Valu
-00035e00: 6573 2061 7265 2061 7373 6967 6e65 6420  es are assigned 
-00035e10: 6672 6f6d 2074 6865 2067 656f 6d65 7472  from the geometr
-00035e20: 7920 616e 6420 636f 6c6f 7220 6d61 7070  y and color mapp
-00035e30: 696e 6720 6d65 7468 6f64 732e 0d0a 0d0a  ing methods.....
-00035e40: 2020 2020 2020 2020 2222 220d 0a0d 0a20          """.... 
-00035e50: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00035e60: 6c66 2e5f 626f 756e 6473 0d0a 0d0a 2020  lf._bounds....  
-00035e70: 2020 6465 6620 6d61 705f 636f 6c6f 725f    def map_color_
-00035e80: 6672 6f6d 5f6f 7028 2073 656c 662c 206f  from_op( self, o
-00035e90: 7065 7261 7469 6f6e 2c20 7267 623d 5472  peration, rgb=Tr
-00035ea0: 7565 2c20 636e 616d 653d 4e6f 6e65 2029  ue, cname=None )
-00035eb0: 203a 0d0a 2020 2020 2020 2020 2222 220d   :..        """.
-00035ec0: 0a20 2020 2020 2020 2041 7373 6967 6e6d  .        Assignm
-00035ed0: 656e 7420 6f66 2076 6563 746f 7220 636f  ent of vector co
-00035ee0: 6c6f 7220 6672 6f6d 2061 2066 756e 6374  lor from a funct
-00035ef0: 696f 6e2e 0d0a 0d0a 2020 2020 2020 2020  ion.....        
-00035f00: 5665 6374 6f72 2063 6f6c 6f72 7320 6172  Vector colors ar
-00035f10: 6520 6173 7369 676e 6564 2066 726f 6d20  e assigned from 
-00035f20: 6120 6675 6e63 7469 6f6e 0d0a 2020 2020  a function..    
-00035f30: 2020 2020 6f66 2064 6972 6563 7469 6f6e      of direction
-00035f40: 2061 6e64 206c 6f63 6174 696f 6e20 636f   and location co
-00035f50: 6f72 6469 6e61 7465 732e 0d0a 0d0a 2020  ordinates.....  
-00035f60: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
-00035f70: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-00035f80: 2d2d 2d2d 0d0a 2020 2020 2020 2020 6f70  ----..        op
-00035f90: 6572 6174 696f 6e20 3a20 6675 6e63 7469  eration : functi
-00035fa0: 6f6e 206f 626a 6563 740d 0a20 2020 2020  on object..     
-00035fb0: 2020 2020 2020 2046 756e 6374 696f 6e20         Function 
-00035fc0: 7468 6174 2074 616b 6573 2074 776f 2061  that takes two a
-00035fd0: 7267 756d 656e 7473 2c20 626f 7468 0d0a  rguments, both..
-00035fe0: 2020 2020 2020 2020 2020 2020 6120 3378              a 3x
-00035ff0: 4e20 4e75 6d70 7920 6172 7261 7920 6f66  N Numpy array of
-00036000: 2078 797a 2063 6f6f 7264 696e 6174 6573   xyz coordinates
-00036010: 2e0d 0a20 2020 2020 2020 2020 2020 2054  ...            T
-00036020: 6865 2066 6972 7374 2061 6e64 2073 6563  he first and sec
-00036030: 6f6e 6420 6172 6775 6d65 6e74 7320 6172  ond arguments ar
-00036040: 6520 7468 6520 6c6f 6361 7469 6f6e 0d0a  e the location..
-00036050: 2020 2020 2020 2020 2020 2020 616e 6420              and 
-00036060: 6469 7265 6374 696f 6e2c 2072 6573 7065  direction, respe
-00036070: 6374 6976 656c 792e 0d0a 2020 2020 2020  ctively...      
-00036080: 2020 2020 2020 5468 6520 6675 6e63 7469        The functi
-00036090: 6f6e 2072 6574 7572 6e73 2061 2033 784e  on returns a 3xN
-000360a0: 2063 6f6c 6f72 2076 616c 7565 2e0d 0a0d   color value....
-000360b0: 0a20 2020 2020 2020 2072 6762 203a 2062  .        rgb : b
-000360c0: 6f6f 6c20 7b54 7275 652c 2046 616c 7365  ool {True, False
-000360d0: 7d2c 206f 7074 696f 6e61 6c2c 2064 6566  }, optional, def
-000360e0: 6175 6c74 3a20 5472 7565 0d0a 2020 2020  ault: True..    
-000360f0: 2020 2020 2020 2020 4279 2064 6566 6175          By defau
-00036100: 6c74 2c20 5247 4220 636f 6c6f 7220 7661  lt, RGB color va
-00036110: 6c75 6573 2061 7265 2072 6574 7572 6e65  lues are returne
-00036120: 6420 6279 2074 6865 0d0a 2020 2020 2020  d by the..      
-00036130: 2020 2020 2020 6f70 6572 6174 696f 6e20        operation 
-00036140: 6675 6e63 7469 6f6e 2e20 2049 6620 7365  function.  If se
-00036150: 7420 4661 6c73 652c 2074 6865 206f 7065  t False, the ope
-00036160: 7261 7469 6f6e 0d0a 2020 2020 2020 2020  ration..        
-00036170: 2020 2020 7265 7475 726e 7320 4853 5620      returns HSV 
-00036180: 636f 6c6f 7220 7661 6c75 6573 2e0d 0a0d  color values....
-00036190: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-000361a0: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-000361b0: 2d0d 0a20 2020 2020 2020 2073 656c 6620  -..        self 
-000361c0: 3a20 5665 6374 6f72 3344 436f 6c6c 6563  : Vector3DCollec
-000361d0: 7469 6f6e 206f 626a 6563 740d 0a0d 0a20  tion object.... 
-000361e0: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
-000361f0: 2020 2020 7879 7a20 3d20 6e70 2e74 7261      xyz = np.tra
-00036200: 6e73 706f 7365 2873 656c 662e 6c6f 6361  nspose(self.loca
-00036210: 7469 6f6e 290d 0a20 2020 2020 2020 2075  tion)..        u
-00036220: 7677 203d 206e 702e 7472 616e 7370 6f73  vw = np.transpos
-00036230: 6528 7365 6c66 2e76 6563 7429 0d0a 2020  e(self.vect)..  
-00036240: 2020 2020 2020 2320 2e2e 2e2e 2e0d 0a20        # ....... 
-00036250: 2020 2020 2020 2063 6f6c 6f72 7320 3d20         colors = 
-00036260: 6e70 2e61 7272 6179 286f 7065 7261 7469  np.array(operati
-00036270: 6f6e 2878 797a 2c75 7677 2929 0d0a 2020  on(xyz,uvw))..  
-00036280: 2020 2020 2020 636f 6c6f 7273 203d 206e        colors = n
-00036290: 702e 7472 616e 7370 6f73 6528 636f 6c6f  p.transpose(colo
-000362a0: 7273 290d 0a20 2020 2020 2020 2063 6f6c  rs)..        col
-000362b0: 6f72 7320 3d20 6e70 2e63 6c69 7028 636f  ors = np.clip(co
-000362c0: 6c6f 7273 2c30 2c31 290d 0a20 2020 2020  lors,0,1)..     
-000362d0: 2020 2069 6620 7267 6220 3a20 5247 4220     if rgb : RGB 
-000362e0: 3d20 636f 6c6f 7273 0d0a 2020 2020 2020  = colors..      
-000362f0: 2020 656c 7365 203a 2020 2052 4742 203d    else :   RGB =
-00036300: 2063 6d2e 636f 6c6f 7273 2e68 7376 5f74   cm.colors.hsv_t
-00036310: 6f5f 7267 6228 636f 6c6f 7273 290d 0a0d  o_rgb(colors)...
-00036320: 0a20 2020 2020 2020 2069 6620 5247 422e  .        if RGB.
-00036330: 7368 6170 655b 315d 2069 7320 3320 3a0d  shape[1] is 3 :.
-00036340: 0a20 2020 2020 2020 2020 2020 206f 6e65  .            one
-00036350: 7320 3d20 6e70 2e6f 6e65 7328 5247 422e  s = np.ones(RGB.
-00036360: 7368 6170 655b 305d 295b 3a2c 6e70 2e6e  shape[0])[:,np.n
-00036370: 6577 6178 6973 5d0d 0a20 2020 2020 2020  ewaxis]..       
-00036380: 2020 2020 2052 4742 203d 206e 702e 636f       RGB = np.co
-00036390: 6e63 6174 656e 6174 6528 2852 4742 2c6f  ncatenate((RGB,o
-000363a0: 6e65 7329 2c61 7869 733d 3129 0d0a 0d0a  nes),axis=1)....
-000363b0: 2020 2020 2020 2020 7365 6c66 2e5f 7365          self._se
-000363c0: 745f 7665 6374 436f 6c6f 7228 5247 4229  t_vectColor(RGB)
-000363d0: 0d0a 2020 2020 2020 2020 636e 616d 6520  ..        cname 
-000363e0: 3d20 5f67 6574 4675 6e63 7469 6f6e 4e61  = _getFunctionNa
-000363f0: 6d65 286f 7065 7261 7469 6f6e 2c63 6e61  me(operation,cna
-00036400: 6d65 290d 0a20 2020 2020 2020 2069 6620  me)..        if 
-00036410: 636e 616d 6520 6973 206e 6f74 204e 6f6e  cname is not Non
-00036420: 6520 3a20 7365 6c66 2e76 616c 7565 734e  e : self.valuesN
-00036430: 616d 6520 3d20 636e 616d 650d 0a20 2020  ame = cname..   
-00036440: 2020 0d0a 2020 2020 2020 2020 7265 7475    ..        retu
-00036450: 726e 2073 656c 660d 0a0d 0a20 2020 2064  rn self....    d
-00036460: 6566 206d 6170 5f63 6d61 705f 6672 6f6d  ef map_cmap_from
-00036470: 5f6f 7028 2073 656c 662c 206f 7065 7261  _op( self, opera
-00036480: 7469 6f6e 2c20 636d 6170 3d4e 6f6e 652c  tion, cmap=None,
-00036490: 2063 6e61 6d65 3d4e 6f6e 6520 2920 3a0d   cname=None ) :.
-000364a0: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
-000364b0: 2020 2020 2020 4675 6e63 7469 6f6e 616c        Functional
-000364c0: 2061 7373 6967 6e6d 656e 7420 6f66 2061   assignment of a
-000364d0: 2076 6563 746f 7220 636f 6c6f 7220 6672   vector color fr
-000364e0: 6f6d 2061 2063 6f6c 6f72 206d 6170 2e0d  om a color map..
-000364f0: 0a0d 0a20 2020 2020 2020 204c 6f63 6174  ...        Locat
-00036500: 696f 6e20 616e 6420 6469 7265 6374 696f  ion and directio
-00036510: 6e20 636f 6f72 6469 6e61 7465 7320 6172  n coordinates ar
-00036520: 6520 7573 6564 2074 6f20 6361 6c63 756c  e used to calcul
-00036530: 6174 6520 6120 7363 616c 6172 200d 0a20  ate a scalar .. 
-00036540: 2020 2020 2020 2077 6869 6368 2069 7320         which is 
-00036550: 7468 656e 2075 7365 6420 746f 2061 7373  then used to ass
-00036560: 6967 6e20 6661 6365 2063 6f6c 6f72 7320  ign face colors 
-00036570: 6672 6f6d 2061 0d0a 2020 2020 2020 2020  from a..        
-00036580: 636f 6c6f 726d 6170 2e0d 0a0d 0a20 2020  colormap.....   
-00036590: 2020 2020 2050 6172 616d 6574 6572 730d       Parameters.
-000365a0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-000365b0: 2d2d 2d0d 0a20 2020 2020 2020 206f 7065  ---..        ope
-000365c0: 7261 7469 6f6e 203a 2066 756e 6374 696f  ration : functio
-000365d0: 6e20 6f62 6a65 6374 0d0a 2020 2020 2020  n object..      
-000365e0: 2020 2020 2020 4675 6e63 7469 6f6e 2074        Function t
-000365f0: 6861 7420 7461 6b65 7320 7477 6f20 6172  hat takes two ar
-00036600: 6775 6d65 6e74 732c 2062 6f74 680d 0a20  guments, both.. 
-00036610: 2020 2020 2020 2020 2020 2061 2033 784e             a 3xN
-00036620: 204e 756d 7079 2061 7272 6179 206f 6620   Numpy array of 
-00036630: 7879 7a20 636f 6f72 6469 6e61 7465 732e  xyz coordinates.
-00036640: 0d0a 2020 2020 2020 2020 2020 2020 5468  ..            Th
-00036650: 6520 6669 7273 7420 616e 6420 7365 636f  e first and seco
-00036660: 6e64 2061 7267 756d 656e 7473 2061 7265  nd arguments are
-00036670: 2074 6865 206c 6f63 6174 696f 6e0d 0a20   the location.. 
-00036680: 2020 2020 2020 2020 2020 2061 6e64 2064             and d
-00036690: 6972 6563 7469 6f6e 2c20 7265 7370 6563  irection, respec
-000366a0: 7469 7665 6c79 2e0d 0a20 2020 2020 2020  tively...       
-000366b0: 2020 2020 2054 6865 2066 756e 6374 696f       The functio
-000366c0: 6e20 7265 7475 726e 7320 6120 4e75 6d70  n returns a Nump
-000366d0: 7920 6172 7261 7920 6f66 2073 6361 6c61  y array of scala
-000366e0: 7220 7661 6c75 6573 2e0d 0a0d 0a20 2020  r values.....   
-000366f0: 2020 2020 2063 6d61 7020 3a20 7374 7220       cmap : str 
-00036700: 6f72 2043 6f6c 6f72 6d61 702c 206f 7074  or Colormap, opt
-00036710: 696f 6e61 6c0d 0a20 2020 2020 2020 2020  ional..         
-00036720: 2020 2041 2043 6f6c 6f72 6d61 7020 696e     A Colormap in
-00036730: 7374 616e 6365 206f 7220 7265 6769 7374  stance or regist
-00036740: 6572 6564 2063 6f6c 6f72 6d61 7020 6e61  ered colormap na
-00036750: 6d65 2e0d 0a20 2020 2020 2020 2020 2020  me...           
-00036760: 2049 6620 6e6f 7420 6173 7369 676e 6564   If not assigned
-00036770: 2c20 7468 6520 7375 7266 6163 6520 436f  , the surface Co
-00036780: 6c6f 726d 6170 2069 7320 7573 6564 2e0d  lormap is used..
-00036790: 0a20 2020 2020 2020 2020 2020 2054 6865  .            The
-000367a0: 2063 6f6c 6f72 6d61 7020 6d61 7073 2074   colormap maps t
-000367b0: 6865 2066 756e 6374 696f 6e20 7265 7475  he function retu
-000367c0: 726e 2076 616c 7565 7320 746f 2063 6f6c  rn values to col
-000367d0: 6f72 732e 0d0a 2020 2020 2020 2020 0d0a  ors...        ..
-000367e0: 2020 2020 2020 2020 5265 7475 726e 730d          Returns.
-000367f0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00036800: 0d0a 2020 2020 2020 2020 7365 6c66 203a  ..        self :
-00036810: 2056 6563 746f 7233 4443 6f6c 6c65 6374   Vector3DCollect
-00036820: 696f 6e20 6f62 6a65 6374 0d0a 0d0a 2020  ion object....  
-00036830: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
-00036840: 2020 200d 0a20 2020 2020 2020 2069 6620     ..        if 
-00036850: 636d 6170 2069 7320 6e6f 7420 4e6f 6e65  cmap is not None
-00036860: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
-00036870: 6966 2069 7369 6e73 7461 6e63 6528 636d  if isinstance(cm
-00036880: 6170 2c73 7472 2920 3a20 0d0a 2020 2020  ap,str) : ..    
-00036890: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000368a0: 2e73 6574 5f63 6d61 7028 636d 2e67 6574  .set_cmap(cm.get
-000368b0: 5f63 6d61 7028 636d 6170 2929 0d0a 2020  _cmap(cmap))..  
-000368c0: 2020 2020 2020 2020 2020 656c 7365 203a            else :
-000368d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000368e0: 2020 7365 6c66 2e73 6574 5f63 6d61 7028    self.set_cmap(
-000368f0: 636d 6170 290d 0a20 2020 2020 2020 2063  cmap)..        c
-00036900: 6d5f 636f 6c6f 724d 6170 203d 2073 656c  m_colorMap = sel
-00036910: 662e 6765 745f 636d 6170 2829 0d0a 0d0a  f.get_cmap()....
-00036920: 2020 2020 2020 2020 7879 7a20 3d20 6e70          xyz = np
-00036930: 2e74 7261 6e73 706f 7365 2873 656c 662e  .transpose(self.
-00036940: 6c6f 6361 7469 6f6e 290d 0a20 2020 2020  location)..     
-00036950: 2020 2075 7677 203d 206e 702e 7472 616e     uvw = np.tran
-00036960: 7370 6f73 6528 7365 6c66 2e76 6563 7429  spose(self.vect)
-00036970: 0d0a 2020 2020 2020 2020 2320 2e2e 2e2e  ..        # ....
-00036980: 2e0d 0a20 2020 2020 2020 2076 203d 206e  ...        v = n
-00036990: 702e 6172 7261 7928 6f70 6572 6174 696f  p.array(operatio
-000369a0: 6e28 7879 7a2c 7576 7729 290d 0a20 2020  n(xyz,uvw))..   
-000369b0: 2020 2020 206e 6f72 6d20 3d20 636f 6c6f       norm = colo
-000369c0: 7273 2e4e 6f72 6d61 6c69 7a65 2876 6d69  rs.Normalize(vmi
-000369d0: 6e3d 762e 6d69 6e28 292c 766d 6178 3d76  n=v.min(),vmax=v
-000369e0: 2e6d 6178 2829 290d 0a20 2020 2020 2020  .max())..       
-000369f0: 2063 6f6c 6f72 203d 2063 6d5f 636f 6c6f   color = cm_colo
-00036a00: 724d 6170 286e 6f72 6d28 7629 290d 0a20  rMap(norm(v)).. 
-00036a10: 2020 2020 2020 2073 656c 662e 5f73 6574         self._set
-00036a20: 5f76 6563 7443 6f6c 6f72 2863 6f6c 6f72  _vectColor(color
-00036a30: 290d 0a20 2020 2020 2020 2063 6e61 6d65  )..        cname
-00036a40: 203d 205f 6765 7446 756e 6374 696f 6e4e   = _getFunctionN
-00036a50: 616d 6528 6f70 6572 6174 696f 6e2c 636e  ame(operation,cn
-00036a60: 616d 6529 0d0a 2020 2020 2020 2020 6966  ame)..        if
-00036a70: 2063 6e61 6d65 2069 7320 6e6f 7420 4e6f   cname is not No
-00036a80: 6e65 3a20 7365 6c66 2e76 616c 7565 734e  ne: self.valuesN
-00036a90: 616d 6520 3d20 636e 616d 650d 0a20 2020  ame = cname..   
-00036aa0: 2020 2020 2073 656c 662e 5f62 6f75 6e64       self._bound
-00036ab0: 735b 2776 6c69 6d27 5d20 3d20 5b20 762e  s['vlim'] = [ v.
-00036ac0: 6d69 6e28 292c 2076 2e6d 6178 2829 205d  min(), v.max() ]
-00036ad0: 0d0a 0d0a 2020 2020 2020 2020 7265 7475  ....        retu
-00036ae0: 726e 2073 656c 660d 0a0d 0a20 2020 2064  rn self....    d
-00036af0: 6566 206d 6170 5f63 6d61 705f 6672 6f6d  ef map_cmap_from
-00036b00: 5f6d 6167 6e69 7475 6465 2820 7365 6c66  _magnitude( self
-00036b10: 2c20 636d 6170 3d4e 6f6e 652c 2063 6e61  , cmap=None, cna
-00036b20: 6d65 3d4e 6f6e 6520 2920 3a0d 0a20 2020  me=None ) :..   
-00036b30: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
-00036b40: 2020 5665 6374 6f72 2063 6f6c 6f72 2061    Vector color a
-00036b50: 7373 6967 6e6d 656e 7420 7573 696e 6720  ssignment using 
-00036b60: 7665 6374 6f72 206d 6167 6e69 7475 6465  vector magnitude
-00036b70: 2e0d 0a0d 0a20 2020 2020 2020 2050 6172  .....        Par
-00036b80: 616d 6574 6572 730d 0a20 2020 2020 2020  ameters..       
-00036b90: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
-00036ba0: 2020 2020 2063 6d61 7020 3a20 7374 7220       cmap : str 
-00036bb0: 6f72 2043 6f6c 6f72 6d61 702c 206f 7074  or Colormap, opt
-00036bc0: 696f 6e61 6c2c 2064 6566 6175 6c74 3a20  ional, default: 
-00036bd0: 2776 6972 6964 6973 270d 0a20 2020 2020  'viridis'..     
-00036be0: 2020 2020 2020 2041 2043 6f6c 6f72 6d61         A Colorma
-00036bf0: 7020 696e 7374 616e 6365 206f 7220 7265  p instance or re
-00036c00: 6769 7374 6572 6564 2063 6f6c 6f72 6d61  gistered colorma
-00036c10: 7020 6e61 6d65 2e0d 0a20 2020 2020 2020  p name...       
-00036c20: 2020 2020 2049 6620 6e6f 7420 6173 7369       If not assi
-00036c30: 676e 6564 2c20 7468 6520 7375 7266 6163  gned, the surfac
-00036c40: 6520 436f 6c6f 726d 6170 2069 7320 7573  e Colormap is us
-00036c50: 6564 2e0d 0a20 2020 2020 2020 2020 2020  ed...           
-00036c60: 2054 6865 2063 6f6c 6f72 6d61 7020 6d61   The colormap ma
-00036c70: 7073 2074 6865 2064 6f74 2070 726f 6475  ps the dot produ
-00036c80: 6374 2076 616c 7565 7320 746f 2063 6f6c  ct values to col
-00036c90: 6f72 732e 0d0a 2020 2020 2020 2020 0d0a  ors...        ..
-00036ca0: 2020 2020 2020 2020 5265 7475 726e 730d          Returns.
-00036cb0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00036cc0: 0d0a 2020 2020 2020 2020 7365 6c66 203a  ..        self :
-00036cd0: 2056 6563 746f 7233 4443 6f6c 6c65 6374   Vector3DCollect
-00036ce0: 696f 6e20 6f62 6a65 6374 0d0a 0d0a 2020  ion object....  
-00036cf0: 2020 2020 2020 2222 220d 0a0d 0a20 2020        """....   
-00036d00: 2020 2020 2069 6620 636d 6170 2069 7320       if cmap is 
-00036d10: 6e6f 7420 4e6f 6e65 203a 0d0a 2020 2020  not None :..    
-00036d20: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-00036d30: 7461 6e63 6528 636d 6170 2c73 7472 2920  tance(cmap,str) 
-00036d40: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
-00036d50: 2020 2020 7365 6c66 2e73 6574 5f63 6d61      self.set_cma
-00036d60: 7028 636d 2e67 6574 5f63 6d61 7028 636d  p(cm.get_cmap(cm
-00036d70: 6170 2929 0d0a 2020 2020 2020 2020 2020  ap))..          
-00036d80: 2020 656c 7365 203a 0d0a 2020 2020 2020    else :..      
-00036d90: 2020 2020 2020 2020 2020 7365 6c66 2e73            self.s
-00036da0: 6574 5f63 6d61 7028 636d 6170 290d 0a20  et_cmap(cmap).. 
-00036db0: 2020 2020 2020 2063 6d5f 636f 6c6f 724d         cm_colorM
-00036dc0: 6170 203d 2073 656c 662e 6765 745f 636d  ap = self.get_cm
-00036dd0: 6170 2829 0d0a 0d0a 2020 2020 2020 2020  ap()....        
-00036de0: 6d61 6720 3d20 6e70 2e6c 696e 616c 672e  mag = np.linalg.
-00036df0: 6e6f 726d 2873 656c 662e 7665 6374 2c61  norm(self.vect,a
-00036e00: 7869 733d 3129 0d0a 2020 2020 2020 2020  xis=1)..        
-00036e10: 6e6f 726d 203d 2063 6f6c 6f72 732e 4e6f  norm = colors.No
-00036e20: 726d 616c 697a 6528 766d 696e 3d6d 6167  rmalize(vmin=mag
-00036e30: 2e6d 696e 2829 2c76 6d61 783d 6d61 672e  .min(),vmax=mag.
-00036e40: 6d61 7828 2929 0d0a 2020 2020 2020 2020  max())..        
-00036e50: 636f 6c6f 7220 3d20 636d 5f63 6f6c 6f72  color = cm_color
-00036e60: 4d61 7028 6e6f 726d 286d 6167 2929 0d0a  Map(norm(mag))..
-00036e70: 2020 2020 2020 2020 7365 6c66 2e5f 7365          self._se
-00036e80: 745f 7665 6374 436f 6c6f 7228 636f 6c6f  t_vectColor(colo
-00036e90: 7229 0d0a 2020 2020 2020 2020 7365 6c66  r)..        self
-00036ea0: 2e63 6e61 6d65 203d 2063 6e61 6d65 0d0a  .cname = cname..
-00036eb0: 2020 2020 2020 2020 6966 2063 6e61 6d65          if cname
-00036ec0: 2069 7320 4e6f 6e65 3a20 7365 6c66 2e63   is None: self.c
-00036ed0: 6e61 6d65 203d 2027 4d61 676e 6974 7564  name = 'Magnitud
-00036ee0: 6527 0d0a 2020 2020 2020 2020 7365 6c66  e'..        self
-00036ef0: 2e5f 626f 756e 6473 5b27 7665 7274 766c  ._bounds['vertvl
-00036f00: 696d 275d 203d 205b 206d 6167 2e6d 696e  im'] = [ mag.min
-00036f10: 2829 2c20 6d61 672e 6d61 7828 2920 5d0d  (), mag.max() ].
-00036f20: 0a0d 0a20 2020 2020 2020 2072 6574 7572  ...        retur
-00036f30: 6e20 7365 6c66 0d0a 2020 2020 0d0a 2020  n self..    ..  
-00036f40: 2020 6465 6620 6d61 705f 636d 6170 5f66    def map_cmap_f
-00036f50: 726f 6d5f 6469 7265 6374 696f 6e28 2073  rom_direction( s
-00036f60: 656c 662c 2063 6d61 703d 4e6f 6e65 2c20  elf, cmap=None, 
-00036f70: 6469 7265 6374 696f 6e3d 5b31 2c31 2c31  direction=[1,1,1
-00036f80: 5d2c 2063 6e61 6d65 3d4e 6f6e 6520 2920  ], cname=None ) 
-00036f90: 3a0d 0a20 2020 2020 2020 2022 2222 0d0a  :..        """..
-00036fa0: 2020 2020 2020 2020 5665 6374 6f72 2063          Vector c
-00036fb0: 6f6c 6f72 2061 7373 6967 6e6d 656e 7420  olor assignment 
-00036fc0: 7573 696e 6720 7665 6374 6f72 2064 6972  using vector dir
-00036fd0: 6563 7469 6f6e 2072 656c 6174 6976 6520  ection relative 
-00036fe0: 746f 2064 6972 6563 7469 6f6e 2061 7267  to direction arg
-00036ff0: 756d 656e 742e 0d0a 0d0a 2020 2020 2020  ument.....      
-00037000: 2020 5468 6520 646f 7420 7072 6f64 7563    The dot produc
-00037010: 7420 6f66 2076 6563 746f 7220 6469 7265  t of vector dire
-00037020: 6374 696f 6e20 7769 7468 2074 6865 2061  ction with the a
-00037030: 7267 756d 656e 7420 6469 7265 6374 696f  rgument directio
-00037040: 6e20 0d0a 2020 2020 2020 2020 6973 2075  n ..        is u
-00037050: 7365 6420 746f 2061 7373 6967 6e20 7665  sed to assign ve
-00037060: 6374 6f72 2063 6f6c 6f72 7320 6672 6f6d  ctor colors from
-00037070: 2061 2063 6f6c 6f72 6d61 702e 0d0a 0d0a   a colormap.....
-00037080: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
-00037090: 7273 0d0a 2020 2020 2020 2020 2d2d 2d2d  rs..        ----
-000370a0: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
-000370b0: 636d 6170 203a 2073 7472 206f 7220 436f  cmap : str or Co
-000370c0: 6c6f 726d 6170 2c20 6f70 7469 6f6e 616c  lormap, optional
-000370d0: 2c20 6465 6661 756c 743a 2027 7669 7269  , default: 'viri
-000370e0: 6469 7327 0d0a 2020 2020 2020 2020 2020  dis'..          
-000370f0: 2020 4120 436f 6c6f 726d 6170 2069 6e73    A Colormap ins
-00037100: 7461 6e63 6520 6f72 2072 6567 6973 7465  tance or registe
-00037110: 7265 6420 636f 6c6f 726d 6170 206e 616d  red colormap nam
-00037120: 652e 0d0a 2020 2020 2020 2020 2020 2020  e...            
-00037130: 4966 206e 6f74 2061 7373 6967 6e65 642c  If not assigned,
-00037140: 2074 6865 2073 7572 6661 6365 2043 6f6c   the surface Col
-00037150: 6f72 6d61 7020 6973 2075 7365 642e 0d0a  ormap is used...
-00037160: 2020 2020 2020 2020 2020 2020 5468 6520              The 
-00037170: 636f 6c6f 726d 6170 206d 6170 7320 7468  colormap maps th
-00037180: 6520 646f 7420 7072 6f64 7563 7420 7661  e dot product va
-00037190: 6c75 6573 2074 6f20 636f 6c6f 7273 2e0d  lues to colors..
-000371a0: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
-000371b0: 2020 2064 6972 6563 7469 6f6e 203a 206c     direction : l
-000371c0: 6973 7420 6f66 2073 697a 6520 332c 206f  ist of size 3, o
-000371d0: 7074 696f 6e61 6c2c 2064 6566 6175 6c74  ptional, default
-000371e0: 3a20 5b31 2c31 2c31 5d0d 0a20 2020 2020  : [1,1,1]..     
-000371f0: 2020 2020 2020 2041 2033 4420 7665 6374         A 3D vect
-00037200: 6f72 2069 6e20 7879 7a20 4361 7274 6573  or in xyz Cartes
-00037210: 6961 6e20 636f 6f72 6469 6e61 7465 7320  ian coordinates 
-00037220: 6465 7369 676e 6174 696e 670d 0a20 2020  designating..   
-00037230: 2020 2020 2020 2020 2074 6865 2072 6566           the ref
-00037240: 6572 656e 6365 2064 6972 6563 7469 6f6e  erence direction
-00037250: 2e0d 0a0d 0a20 2020 2020 2020 2072 6566  .....        ref
-00037260: 436f 6f72 203a 2073 7472 696e 672c 206f  Coor : string, o
-00037270: 7074 696f 6e61 6c2c 2064 6566 6175 6c74  ptional, default
-00037280: 3a20 2258 595a 220d 0a20 2020 2020 2020  : "XYZ"..       
-00037290: 2020 2020 2044 6972 6563 7469 6f6e 2063       Direction c
-000372a0: 6f6f 7264 696e 6174 6520 7379 7374 656d  oordinate system
-000372b0: 2066 6f72 2074 6865 2065 7661 6c75 6174   for the evaluat
-000372c0: 696f 6e2e 0d0a 2020 2020 2020 2020 2020  ion...          
-000372d0: 2020 284e 6f74 2069 6d70 6c69 6d65 6e74    (Not impliment
-000372e0: 6564 290d 0a0d 0a20 2020 2020 2020 2052  ed)....        R
-000372f0: 6574 7572 6e73 0d0a 2020 2020 2020 2020  eturns..        
-00037300: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-00037310: 2073 656c 6620 3a20 5665 6374 6f72 3344   self : Vector3D
-00037320: 436f 6c6c 6563 7469 6f6e 206f 626a 6563  Collection objec
-00037330: 740d 0a0d 0a20 2020 2020 2020 2022 2222  t....        """
-00037340: 0d0a 0d0a 2020 2020 2020 2320 4675 7444  ....      # FutD
-00037350: 6576 3a20 2061 6c6c 6f77 2069 6e70 7574  ev:  allow input
-00037360: 2064 6972 6563 7469 6f6e 2074 6f20 6265   direction to be
-00037370: 2069 6e20 6f74 6865 7220 636f 6f72 2073   in other coor s
-00037380: 7973 7465 6d73 2028 7265 6643 6f6f 7229  ystems (refCoor)
-00037390: 0d0a 2020 2020 2020 232e 2e2e 2e2e 2e2e  ..      #.......
-000373a0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-000373b0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2020  ..............  
-000373c0: 2020 0d0a 2020 2020 2020 2020 6465 6620    ..        def 
-000373d0: 6765 7443 6f6c 6f72 4d61 7028 6676 6f2c  getColorMap(fvo,
-000373e0: 636d 6170 2c20 6469 7265 6374 696f 6e29  cmap, direction)
-000373f0: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
-00037400: 756e 6974 5665 6374 6f72 203d 206c 616d  unitVector = lam
-00037410: 6264 6120 7620 3a20 6e70 2e64 6976 6964  bda v : np.divid
-00037420: 6528 2076 2c20 6e70 2e6c 696e 616c 672e  e( v, np.linalg.
-00037430: 6e6f 726d 2876 2920 290d 0a20 2020 2020  norm(v) )..     
-00037440: 2020 2020 2020 2069 6e63 6964 656e 744c         incidentL
-00037450: 6967 6874 203d 2075 6e69 7456 6563 746f  ight = unitVecto
-00037460: 7228 2064 6972 6563 7469 6f6e 2029 0d0a  r( direction )..
-00037470: 2020 2020 2020 2020 2020 2020 6420 3d20              d = 
-00037480: 6e70 2e64 6f74 2866 766f 2c69 6e63 6964  np.dot(fvo,incid
-00037490: 656e 744c 6967 6874 290d 0a20 2020 2020  entLight)..     
-000374a0: 2020 2020 2020 2076 203d 206e 702e 6164         v = np.ad
-000374b0: 6428 642c 3129 0d0a 2020 2020 2020 2020  d(d,1)..        
-000374c0: 2020 2020 7620 3d20 6e70 2e64 6976 6964      v = np.divid
-000374d0: 6528 762c 3229 0d0a 2020 2020 2020 2020  e(v,2)..        
-000374e0: 2020 2020 7620 3d20 6e70 2e61 6273 2876      v = np.abs(v
-000374f0: 290d 0a20 2020 2020 2020 2020 2020 206e  )..            n
-00037500: 6f72 6d20 3d20 636f 6c6f 7273 2e4e 6f72  orm = colors.Nor
-00037510: 6d61 6c69 7a65 2876 6d69 6e3d 762e 6d69  malize(vmin=v.mi
-00037520: 6e28 292c 766d 6178 3d76 2e6d 6178 2829  n(),vmax=v.max()
-00037530: 290d 0a20 2020 2020 2020 2020 2020 2063  )..            c
-00037540: 6f6c 6f72 4d61 7020 3d20 636d 6170 286e  olorMap = cmap(n
-00037550: 6f72 6d28 7629 290d 0a20 2020 2020 2020  orm(v))..       
-00037560: 2020 2020 2073 656c 662e 5f62 6f75 6e64       self._bound
-00037570: 735b 2776 6572 7476 6c69 6d27 5d20 3d20  s['vertvlim'] = 
-00037580: 5b20 762e 6d69 6e28 292c 2076 2e6d 6178  [ v.min(), v.max
-00037590: 2829 205d 0d0a 2020 2020 2020 2020 2020  () ]..          
-000375a0: 2020 7265 7475 726e 2063 6f6c 6f72 4d61    return colorMa
-000375b0: 700d 0a20 2020 2020 2020 2023 2e2e 2e2e  p..        #....
-000375c0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-000375d0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-000375e0: 2e0d 0a0d 0a20 2020 2020 2020 2069 6620  .....        if 
-000375f0: 636d 6170 2069 7320 6e6f 7420 4e6f 6e65  cmap is not None
-00037600: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
-00037610: 6966 2069 7369 6e73 7461 6e63 6528 636d  if isinstance(cm
-00037620: 6170 2c73 7472 2920 3a20 0d0a 2020 2020  ap,str) : ..    
-00037630: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00037640: 2e73 6574 5f63 6d61 7028 636d 2e67 6574  .set_cmap(cm.get
-00037650: 5f63 6d61 7028 636d 6170 2929 0d0a 2020  _cmap(cmap))..  
-00037660: 2020 2020 2020 2020 2020 656c 7365 203a            else :
-00037670: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00037680: 2020 7365 6c66 2e73 6574 5f63 6d61 7028    self.set_cmap(
-00037690: 636d 6170 290d 0a20 2020 2020 2020 2063  cmap)..        c
-000376a0: 6d5f 636f 6c6f 724d 6170 203d 2073 656c  m_colorMap = sel
-000376b0: 662e 6765 745f 636d 6170 2829 0d0a 0d0a  f.get_cmap()....
-000376c0: 2020 2020 2020 2020 636f 6c6f 7220 3d20          color = 
-000376d0: 6765 7443 6f6c 6f72 4d61 7028 7365 6c66  getColorMap(self
-000376e0: 2e76 6563 742c 2063 6d5f 636f 6c6f 724d  .vect, cm_colorM
-000376f0: 6170 2c20 6469 7265 6374 696f 6e29 0d0a  ap, direction)..
-00037700: 2020 2020 2020 2020 7365 6c66 2e5f 7365          self._se
-00037710: 745f 7665 6374 436f 6c6f 7228 636f 6c6f  t_vectColor(colo
-00037720: 7229 0d0a 2020 2020 2020 2020 7365 6c66  r)..        self
-00037730: 2e63 6e61 6d65 203d 2063 6e61 6d65 0d0a  .cname = cname..
-00037740: 2020 2020 2020 2020 6966 2063 6e61 6d65          if cname
-00037750: 2069 7320 4e6f 6e65 3a20 7365 6c66 2e63   is None: self.c
-00037760: 6e61 6d65 203d 2027 4469 7265 6374 696f  name = 'Directio
-00037770: 6e27 0d0a 0d0a 2020 2020 2020 2020 7265  n'....        re
-00037780: 7475 726e 2073 656c 660d 0a0d 0a0d 0a0d  turn self.......
-00037790: 0a63 6c61 7373 2043 6f6c 6f72 4c69 6e65  .class ColorLine
-000377a0: 3344 436f 6c6c 6563 7469 6f6e 284c 696e  3DCollection(Lin
-000377b0: 6533 4443 6f6c 6c65 6374 696f 6e29 203a  e3DCollection) :
-000377c0: 0d0a 2020 2020 2222 220d 0a20 2020 2042  ..    """..    B
-000377d0: 6173 6520 636c 6173 7320 666f 7220 6e6f  ase class for no
-000377e0: 6e2d 756e 6966 6f72 6d6c 7920 636f 6c6f  n-uniformly colo
-000377f0: 7265 6420 3344 206c 696e 6573 2e0d 0a0d  red 3D lines....
-00037800: 0a20 2020 2022 2222 0d0a 0d0a 2020 2020  .    """....    
-00037810: 2320 4675 7444 6576 3a20 5468 6973 2063  # FutDev: This c
-00037820: 6c61 7373 206c 6561 7665 7320 6120 6c6f  lass leaves a lo
-00037830: 7420 6f66 2072 6f6f 6d20 666f 7220 696d  t of room for im
-00037840: 7072 6f76 656d 656e 742e 0d0a 2020 2020  provement...    
-00037850: 2320 4e65 6564 2062 6574 7465 7220 7573  # Need better us
-00037860: 6520 6f66 204e 756d 7079 2061 6e64 2062  e of Numpy and b
-00037870: 6574 7465 7220 6170 7072 6f61 6368 2074  etter approach t
-00037880: 6f0d 0a20 2020 2023 2064 6966 6665 7265  o..    # differe
-00037890: 6e74 6961 7469 6e67 2062 6574 7765 656e  ntiating between
-000378a0: 2063 6f6c 6c65 6374 696f 6e73 2c20 6c69   collections, li
-000378b0: 6e65 7320 2620 7365 676d 656e 7473 0d0a  nes & segments..
-000378c0: 2020 2020 2320 746f 2061 6363 6f6d 6f64      # to accomod
-000378d0: 6174 6520 4d61 7470 6c6f 7420 7265 6e64  ate Matplot rend
-000378e0: 6572 696e 6720 616e 6420 6675 7475 7265  ering and future
-000378f0: 2065 7870 6f72 742e 204d 524f 490d 0a0d   export. MROI...
-00037900: 0a20 2020 2040 7374 6174 6963 6d65 7468  .    @staticmeth
-00037910: 6f64 0d0a 2020 2020 6465 6620 6d65 7368  od..    def mesh
-00037920: 6772 6964 2858 2c59 2c5a 2c20 6e61 6d65  grid(X,Y,Z, name
-00037930: 3d4e 6f6e 6529 203a 0d0a 2020 2020 2020  =None) :..      
-00037940: 2020 2222 2243 6f6c 6f72 4c69 6e65 3344    """ColorLine3D
-00037950: 436f 6c6c 6563 7469 6f6e 2c20 6120 7365  Collection, a se
-00037960: 7420 6f66 2078 7920 736c 6963 6520 6c69  t of xy slice li
-00037970: 6e65 7320 6261 7365 6420 6f6e 2061 206d  nes based on a m
-00037980: 6573 6867 7269 642e 2222 220d 0a0d 0a20  eshgrid.""".... 
-00037990: 2020 2020 2020 2023 204e 6565 6473 2063         # Needs c
-000379a0: 6c65 616e 7570 204d 524f 490d 0a20 2020  leanup MROI..   
-000379b0: 2020 2020 2078 5f6c 696e 6556 6572 7473       x_lineVerts
-000379c0: 5074 7320 3d20 6e70 2e61 7272 6179 2858  Pts = np.array(X
-000379d0: 295b 305d 0d0a 2020 2020 2020 2020 795f  )[0]..        y_
-000379e0: 6c69 6e65 5665 7274 7350 7473 203d 206e  lineVertsPts = n
-000379f0: 702e 6172 7261 7928 5929 5b3a 2c30 5d0d  p.array(Y)[:,0].
-00037a00: 0a20 2020 2020 2020 207a 5f6c 696e 6573  .        z_lines
-00037a10: 203d 206e 702e 6172 7261 7928 5a29 0d0a   = np.array(Z)..
-00037a20: 2020 2020 2020 2020 6e75 6d62 5f58 5f6c          numb_X_l
-00037a30: 696e 6573 203d 206c 656e 2878 5f6c 696e  ines = len(x_lin
-00037a40: 6556 6572 7473 5074 7329 0d0a 2020 2020  eVertsPts)..    
-00037a50: 2020 2020 6e75 6d62 5f59 5f6c 696e 6573      numb_Y_lines
-00037a60: 203d 206c 656e 2879 5f6c 696e 6556 6572   = len(y_lineVer
-00037a70: 7473 5074 7329 0d0a 2020 2020 2020 2020  tsPts)..        
-00037a80: 696e 6469 6365 7320 3d20 5b4e 6f6e 655d  indices = [None]
-00037a90: 2a28 206e 756d 625f 585f 6c69 6e65 7320  *( numb_X_lines 
-00037aa0: 2b20 6e75 6d62 5f59 5f6c 696e 6573 2029  + numb_Y_lines )
-00037ab0: 0d0a 2020 2020 2020 2020 696e 6465 7820  ..        index 
-00037ac0: 3d20 300d 0a0d 0a20 2020 2020 2020 2076  = 0....        v
-00037ad0: 6572 7473 203d 205b 5d0d 0a20 2020 2020  erts = []..     
-00037ae0: 2020 2023 202e 2e2e 2e2e 2e2e 2e2e 2e2e     # ...........
-00037af0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00037b00: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00037b10: 2e2e 2e2e 2e2e 2e0d 0a20 2020 2020 2020  .........       
-00037b20: 206e 756d 5665 7274 7320 3d20 6e75 6d62   numVerts = numb
-00037b30: 5f59 5f6c 696e 6573 0d0a 2020 2020 2020  _Y_lines..      
-00037b40: 2020 6c69 6e65 5665 7274 7350 7473 203d    lineVertsPts =
-00037b50: 2079 5f6c 696e 6556 6572 7473 5074 730d   y_lineVertsPts.
-00037b60: 0a20 2020 2020 2020 207a 5f58 5f6c 696e  .        z_X_lin
-00037b70: 6573 203d 207a 5f6c 696e 6573 0d0a 2020  es = z_lines..  
-00037b80: 2020 2020 2020 666f 7220 6958 2069 6e20        for iX in 
-00037b90: 7261 6e67 6528 6e75 6d62 5f58 5f6c 696e  range(numb_X_lin
-00037ba0: 6573 2920 3a0d 0a20 2020 2020 2020 2020  es) :..         
-00037bb0: 2020 2066 6f72 2069 5920 696e 2072 616e     for iY in ran
-00037bc0: 6765 286e 756d 5665 7274 7329 203a 0d0a  ge(numVerts) :..
-00037bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037be0: 7665 7274 732e 6170 7065 6e64 2820 5b20  verts.append( [ 
-00037bf0: 785f 6c69 6e65 5665 7274 7350 7473 5b69  x_lineVertsPts[i
-00037c00: 585d 202c 206c 696e 6556 6572 7473 5074  X] , lineVertsPt
-00037c10: 735b 6959 5d2c 207a 5f58 5f6c 696e 6573  s[iY], z_X_lines
-00037c20: 5b69 592c 6958 5d20 5d29 0d0a 0d0a 2020  [iY,iX] ])....  
-00037c30: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
-00037c40: 616e 6765 2830 2c6e 756d 625f 585f 6c69  ange(0,numb_X_li
-00037c50: 6e65 7329 203a 0d0a 2020 2020 2020 2020  nes) :..        
-00037c60: 2020 2020 696e 6469 6365 735b 695d 203d      indices[i] =
-00037c70: 205b 4e6f 6e65 5d2a 286e 756d 5665 7274   [None]*(numVert
-00037c80: 7329 0d0a 2020 2020 2020 2020 2020 2020  s)..            
-00037c90: 666f 7220 6a20 696e 2072 616e 6765 286e  for j in range(n
-00037ca0: 756d 5665 7274 7329 203a 0d0a 2020 2020  umVerts) :..    
-00037cb0: 2020 2020 2020 2020 2020 2020 696e 6469              indi
-00037cc0: 6365 735b 695d 5b6a 5d20 3d20 696e 6465  ces[i][j] = inde
-00037cd0: 780d 0a20 2020 2020 2020 2020 2020 2020  x..             
-00037ce0: 2020 2069 6e64 6578 202b 3d20 310d 0a20     index += 1.. 
-00037cf0: 2020 2020 2020 2023 202e 2e2e 2e2e 2e2e         # .......
-00037d00: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00037d10: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00037d20: 2e2e 2e2e 2e2e 2e2e 2e2e 2e0d 0a20 2020  .............   
-00037d30: 2020 2020 206e 756d 5665 7274 7320 3d20       numVerts = 
-00037d40: 6e75 6d62 5f58 5f6c 696e 6573 0d0a 2020  numb_X_lines..  
-00037d50: 2020 2020 2020 6c69 6e65 5665 7274 7350        lineVertsP
-00037d60: 7473 203d 2078 5f6c 696e 6556 6572 7473  ts = x_lineVerts
-00037d70: 5074 730d 0a20 2020 2020 2020 207a 5f59  Pts..        z_Y
-00037d80: 5f6c 696e 6573 203d 207a 5f6c 696e 6573  _lines = z_lines
-00037d90: 0d0a 2020 2020 2020 2020 666f 7220 6959  ..        for iY
-00037da0: 2069 6e20 7261 6e67 6528 6e75 6d62 5f59   in range(numb_Y
-00037db0: 5f6c 696e 6573 2920 3a0d 0a20 2020 2020  _lines) :..     
-00037dc0: 2020 2020 2020 2066 6f72 2069 5820 696e         for iX in
-00037dd0: 2072 616e 6765 286e 756d 5665 7274 7329   range(numVerts)
-00037de0: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
-00037df0: 2020 2020 7665 7274 732e 6170 7065 6e64      verts.append
-00037e00: 2820 5b20 206c 696e 6556 6572 7473 5074  ( [  lineVertsPt
-00037e10: 735b 6958 5d2c 2079 5f6c 696e 6556 6572  s[iX], y_lineVer
-00037e20: 7473 5074 735b 6959 5d20 2c7a 5f59 5f6c  tsPts[iY] ,z_Y_l
-00037e30: 696e 6573 5b69 592c 6958 5d20 5d29 0d0a  ines[iY,iX] ])..
-00037e40: 0d0a 2020 2020 2020 2020 666f 7220 6920  ..        for i 
-00037e50: 696e 2072 616e 6765 286e 756d 625f 585f  in range(numb_X_
-00037e60: 6c69 6e65 732c 6e75 6d62 5f58 5f6c 696e  lines,numb_X_lin
-00037e70: 6573 2b6e 756d 625f 595f 6c69 6e65 7329  es+numb_Y_lines)
-00037e80: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
-00037e90: 696e 6469 6365 735b 695d 203d 205b 4e6f  indices[i] = [No
-00037ea0: 6e65 5d2a 286e 756d 5665 7274 7329 0d0a  ne]*(numVerts)..
-00037eb0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00037ec0: 6a20 696e 2072 616e 6765 286e 756d 5665  j in range(numVe
-00037ed0: 7274 7329 203a 0d0a 2020 2020 2020 2020  rts) :..        
-00037ee0: 2020 2020 2020 2020 696e 6469 6365 735b          indices[
-00037ef0: 695d 5b6a 5d20 3d20 696e 6465 780d 0a20  i][j] = index.. 
-00037f00: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00037f10: 6e64 6578 202b 3d20 310d 0a0d 0a20 2020  ndex += 1....   
-00037f20: 2020 2020 2076 6572 7473 203d 206e 702e       verts = np.
-00037f30: 6172 7261 7928 7665 7274 7329 0d0a 0d0a  array(verts)....
-00037f40: 2020 2020 2020 2020 7265 7475 726e 2043          return C
-00037f50: 6f6c 6f72 4c69 6e65 3344 436f 6c6c 6563  olorLine3DCollec
-00037f60: 7469 6f6e 2876 6572 7473 2c69 6e64 6963  tion(verts,indic
-00037f70: 6573 2c6e 616d 653d 6e61 6d65 290d 0a0d  es,name=name)...
-00037f80: 0a20 2020 2064 6566 205f 5f69 6e69 745f  .    def __init_
-00037f90: 5f28 7365 6c66 2c20 7665 7274 6578 436f  _(self, vertexCo
-00037fa0: 6f72 2c20 7365 676d 496e 6469 6365 732c  or, segmIndices,
-00037fb0: 206e 616d 653d 4e6f 6e65 2c20 2a2a 6b77   name=None, **kw
-00037fc0: 6172 6773 2920 3a0d 0a20 2020 2020 2020  args) :..       
-00037fd0: 2022 2222 0d0a 2020 2020 2020 2020 4120   """..        A 
-00037fe0: 7365 7420 3344 206c 696e 6573 2c20 6561  set 3D lines, ea
-00037ff0: 6368 206c 696e 6520 7769 7468 2061 2076  ch line with a v
-00038000: 6172 7969 6e67 206e 756d 6265 7220 6f66  arying number of
-00038010: 2073 6571 7565 6e74 6961 6c20 7665 7274   sequential vert
-00038020: 6963 6573 2e0d 0a0d 0a20 2020 2020 2020  ices.....       
-00038030: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
-00038040: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
-00038050: 0a20 2020 2020 2020 2076 6572 7465 7843  .        vertexC
-00038060: 6f6f 7220 3a20 5620 7820 3320 666c 6f61  oor : V x 3 floa
-00038070: 7420 6172 7261 792d 6c69 6b65 200d 0a20  t array-like .. 
-00038080: 2020 2020 2020 2020 2020 2041 6e20 6172             An ar
-00038090: 7261 7920 6f66 2056 206e 756d 6265 7220  ray of V number 
-000380a0: 6f66 2078 797a 2076 6572 7465 7820 636f  of xyz vertex co
-000380b0: 6f72 6469 6e61 7465 732e 0d0a 0d0a 2020  ordinates.....  
-000380c0: 2020 2020 2020 7365 676d 496e 6469 6365        segmIndice
-000380d0: 7320 3a20 4c20 7820 4e6c 2069 6e74 206c  s : L x Nl int l
-000380e0: 6973 740d 0a20 2020 2020 2020 2020 2020  ist..           
-000380f0: 2041 6e20 6c69 7374 206f 6620 4c20 6e75   An list of L nu
-00038100: 6d62 6572 206f 6620 4e6c 206c 696e 6520  mber of Nl line 
-00038110: 7665 7274 6578 2069 6e64 6963 6573 2c20  vertex indices, 
-00038120: 7768 6572 650d 0a20 2020 2020 2020 2020  where..         
-00038130: 2020 204e 6c20 6973 2074 6865 206e 756d     Nl is the num
-00038140: 6265 7220 6f66 2076 6572 7469 6365 7320  ber of vertices 
-00038150: 666f 7220 7468 6520 4c74 6820 6c69 6e65  for the Lth line
-00038160: 2e0d 0a0d 0a20 2020 2020 2020 206e 616d  .....        nam
-00038170: 6520 3a20 7374 7269 6e67 2c20 6f70 7469  e : string, opti
-00038180: 6f6e 616c 2c20 6465 6661 756c 743a 204e  onal, default: N
-00038190: 6f6e 652e 0d0a 2020 2020 2020 2020 2020  one...          
-000381a0: 2020 4465 7363 7269 7074 6976 6520 6964    Descriptive id
-000381b0: 656e 7469 6669 6572 2e0d 0a0d 0a20 2020  entifier.....   
-000381c0: 2020 2020 204f 7468 6572 2050 6172 616d       Other Param
-000381d0: 6574 6572 730d 0a20 2020 2020 2020 202d  eters..        -
-000381e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d  ---------------.
-000381f0: 0a20 2020 2020 2020 202a 2a6b 7761 7267  .        **kwarg
-00038200: 730d 0a20 2020 2020 2020 2020 2020 2041  s..            A
-00038210: 6c6c 206f 7468 6572 2070 6172 616d 6574  ll other paramet
-00038220: 6572 7320 6172 6520 7061 7373 6564 206f  ers are passed o
-00038230: 6e20 746f 206d 706c 5f74 6f6f 6c6b 6974  n to mpl_toolkit
-00038240: 732e 6d70 6c6f 7433 642e 6172 7433 642e  s.mplot3d.art3d.
-00038250: 4c69 6e65 3344 436f 6c6c 6563 7469 6f6e  Line3DCollection
-00038260: 2e0d 0a20 2020 2020 2020 2020 2020 2056  ...            V
-00038270: 616c 6964 206b 6579 776f 7264 7320 696e  alid keywords in
-00038280: 636c 7564 653a 2063 6f6c 6f72 732c 206c  clude: colors, l
-00038290: 696e 6577 6964 7468 732e 0d0a 2020 2020  inewidths...    
-000382a0: 2020 2020 0d0a 2020 2020 2020 2020 2222      ..        ""
-000382b0: 220d 0a0d 0a20 2020 2020 2020 2073 656c  "....        sel
-000382c0: 662e 7665 7274 6578 436f 6f72 203d 206e  f.vertexCoor = n
-000382d0: 702e 6172 7261 7928 7665 7274 6578 436f  p.array(vertexCo
-000382e0: 6f72 2c64 7479 7065 3d66 6c6f 6174 290d  or,dtype=float).
-000382f0: 0a0d 0a20 2020 2020 2020 2069 6620 7365  ...        if se
-00038300: 676d 496e 6469 6365 7320 6973 204e 6f6e  gmIndices is Non
-00038310: 6520 3a0d 0a20 2020 2020 2020 2020 2020  e :..           
-00038320: 2073 656c 662e 6c69 6e65 496e 6469 6365   self.lineIndice
-00038330: 7320 3d20 5b20 5b2a 7261 6e67 6528 6c65  s = [ [*range(le
-00038340: 6e28 7665 7274 6578 436f 6f72 2929 5d20  n(vertexCoor))] 
-00038350: 5d0d 0a0d 0a20 2020 2020 2020 2020 2020  ]....           
-00038360: 206c 696e 6573 6567 7320 3d20 7365 6c66   linesegs = self
-00038370: 2e6c 696e 6549 6e64 6963 6573 0d0a 2020  .lineIndices..  
-00038380: 2020 2020 2020 2020 2020 696e 6469 6365            indice
-00038390: 7320 3d20 5b5d 0d0a 2020 2020 2020 2020  s = []..        
-000383a0: 2020 2020 666f 7220 6c69 6e65 2069 6e20      for line in 
-000383b0: 6c69 6e65 7365 6773 203a 0d0a 2020 2020  linesegs :..    
-000383c0: 2020 2020 2020 2020 2020 2020 6e75 6d53              numS
-000383d0: 6567 7320 3d20 6c65 6e28 6c69 6e65 2920  egs = len(line) 
-000383e0: 2d20 310d 0a20 2020 2020 2020 2020 2020  - 1..           
-000383f0: 2020 2020 2066 6f72 2073 6567 2069 6e20       for seg in 
-00038400: 7261 6e67 6520 286e 756d 5365 6773 2920  range (numSegs) 
-00038410: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00038420: 2020 2020 2020 2074 203d 205b 206c 696e         t = [ lin
-00038430: 655b 7365 675d 2c6c 696e 655b 7365 672b  e[seg],line[seg+
-00038440: 315d 205d 0d0a 2020 2020 2020 2020 2020  1] ]..          
-00038450: 2020 2020 2020 2020 2020 696e 6469 6365            indice
-00038460: 732e 6170 7065 6e64 2874 290d 0a20 2020  s.append(t)..   
-00038470: 2020 2020 2020 2020 2073 656c 662e 7365           self.se
-00038480: 676d 496e 6469 6365 7320 3d20 696e 6469  gmIndices = indi
-00038490: 6365 730d 0a0d 0a20 2020 2020 2020 2065  ces....        e
-000384a0: 6c73 6520 3a20 0d0a 2020 2020 2020 2020  lse : ..        
-000384b0: 2020 2020 2320 616c 6c20 696e 6469 6365      # all indice
-000384c0: 7320 6d75 7374 2062 6520 6c69 7374 732c  s must be lists,
-000384d0: 206e 6f74 206e 756d 7079 2061 7272 6179   not numpy array
-000384e0: 732e 0d0a 2020 2020 2020 2020 2020 2020  s...            
-000384f0: 7365 676d 496e 6469 6365 7320 3d20 6c69  segmIndices = li
-00038500: 7374 2873 6567 6d49 6e64 6963 6573 290d  st(segmIndices).
-00038510: 0a0d 0a20 2020 2020 2020 2020 2020 2023  ...            #
-00038520: 2073 6567 6d49 6e64 6963 6573 2077 696c   segmIndices wil
-00038530: 6c20 6265 2073 6872 6564 6465 6420 666f  l be shredded fo
-00038540: 7220 616e 7920 636f 6c6f 7220 6f70 6572  r any color oper
-00038550: 6174 696f 6e0d 0a20 2020 2020 2020 2020  ation..         
-00038560: 2020 2023 2066 6f72 6d69 6e67 206d 756c     # forming mul
-00038570: 7469 706c 6520 7369 6e67 6c65 2073 6567  tiple single seg
-00038580: 6d65 6e74 206c 696e 6573 2e0d 0a20 2020  ment lines...   
-00038590: 2020 2020 2020 2020 2073 656c 662e 7365           self.se
-000385a0: 676d 496e 6469 6365 7320 3d20 7365 676d  gmIndices = segm
-000385b0: 496e 6469 6365 732e 636f 7079 2829 0d0a  Indices.copy()..
-000385c0: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-000385d0: 6c69 6e65 496e 6469 6365 7320 6172 6520  lineIndices are 
-000385e0: 6170 7065 6e64 6564 2066 6f72 2061 6e20  appended for an 
-000385f0: 6164 6420 6f70 6572 6174 696f 6e2c 0d0a  add operation,..
-00038600: 2020 2020 2020 2020 2020 2020 2320 7768              # wh
-00038610: 6572 6520 6c69 6e65 496e 6469 6365 7320  ere lineIndices 
-00038620: 7072 6573 6572 7665 2069 6e64 6976 6964  preserve individ
-00038630: 7561 6c20 276c 696e 6573 2720 6576 656e  ual 'lines' even
-00038640: 2074 686f 7567 680d 0a20 2020 2020 2020   though..       
-00038650: 2020 2020 2023 2061 6c6c 206c 696e 6573       # all lines
-00038660: 2061 7265 2062 726f 6b65 6e20 696e 746f   are broken into
-00038670: 2073 696e 676c 6520 7365 676d 656e 7420   single segment 
-00038680: 6c69 6e65 7320 6f6d 6365 2073 6872 6564  lines omce shred
-00038690: 6465 642e 0d0a 2020 2020 2020 2020 2020  ded...          
-000386a0: 2020 7365 6c66 2e6c 696e 6549 6e64 6963    self.lineIndic
-000386b0: 6573 203d 2073 6567 6d49 6e64 6963 6573  es = segmIndices
-000386c0: 2e63 6f70 7928 290d 0a0d 0a20 2020 2020  .copy()....     
-000386d0: 2020 2073 656c 662e 6973 5368 7265 6464     self.isShredd
-000386e0: 6564 203d 2046 616c 7365 0d0a 0d0a 2020  ed = False....  
-000386f0: 2020 2020 2020 5320 3d20 7365 6c66 2e73        S = self.s
-00038700: 6567 6d49 6e64 6963 6573 0d0a 2020 2020  egmIndices..    
-00038710: 2020 2020 7620 3d20 7365 6c66 2e76 6572      v = self.ver
-00038720: 7465 7843 6f6f 720d 0a0d 0a20 2020 2020  texCoor....     
-00038730: 2020 2073 6567 6d65 6e74 7320 3d20 5b4e     segments = [N
-00038740: 6f6e 655d 2a6c 656e 2853 290d 0a20 2020  one]*len(S)..   
-00038750: 2020 2020 2066 6f72 2076 6572 6c69 7374       for verlist
-00038760: 2069 6e20 7261 6e67 6528 6c65 6e28 5329   in range(len(S)
-00038770: 2920 3a0d 0a20 2020 2020 2020 2020 2020  ) :..           
-00038780: 2076 6572 4172 7220 3d20 5b4e 6f6e 655d   verArr = [None]
-00038790: 2a6c 656e 2820 535b 7665 726c 6973 745d  *len( S[verlist]
-000387a0: 2029 0d0a 2020 2020 2020 2020 2020 2020   )..            
-000387b0: 666f 7220 7665 7249 6e78 2069 6e20 7261  for verInx in ra
-000387c0: 6e67 6528 206c 656e 2820 535b 7665 726c  nge( len( S[verl
-000387d0: 6973 745d 2029 2029 203a 0d0a 2020 2020  ist] ) ) :..    
-000387e0: 2020 2020 2020 2020 2020 2020 7665 7241              verA
-000387f0: 7272 5b76 6572 496e 785d 203d 2076 5b20  rr[verInx] = v[ 
-00038800: 535b 7665 726c 6973 745d 5b76 6572 496e  S[verlist][verIn
-00038810: 785d 205d 0d0a 2020 2020 2020 2020 2020  x] ]..          
-00038820: 2020 7365 676d 656e 7473 5b76 6572 6c69    segments[verli
-00038830: 7374 5d20 3d20 7665 7241 7272 0d0a 0d0a  st] = verArr....
-00038840: 2020 2020 2020 2020 7375 7065 7228 292e          super().
-00038850: 5f5f 696e 6974 5f5f 2873 6567 6d65 6e74  __init__(segment
-00038860: 732c 202a 2a6b 7761 7267 7329 0d0a 2020  s, **kwargs)..  
-00038870: 2020 2020 2020 2373 656c 662e 5f67 656f        #self._geo
-00038880: 6d4e 616d 6520 3d20 4e6f 6e65 2020 2020  mName = None    
-00038890: 2320 5265 6475 6e64 616e 7420 6672 6f6d  # Redundant from
-000388a0: 206e 6578 7420 6c69 6e65 2c20 696e 7465   next line, inte
-000388b0: 726e 616c 2074 7261 636b 696e 6720 746f  rnal tracking to
-000388c0: 2064 6574 6572 6d69 6e65 2069 6620 7365   determine if se
-000388d0: 742e 2e2e 0d0a 2020 2020 2020 2020 7365  t.....        se
-000388e0: 6c66 2e6e 616d 6520 3d20 6e61 6d65 0d0a  lf.name = name..
-000388f0: 2020 2020 2020 2020 7365 6c66 2e76 616c          self.val
-00038900: 7565 734e 616d 6520 3d20 4e6f 6e65 0d0a  uesName = None..
-00038910: 0d0a 2020 2020 2020 2020 2320 2e2e 2e2e  ..        # ....
-00038920: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00038930: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00038940: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00038950: 2e2e 2e2e 2e2e 2e2e 2e2e 2e0d 0a20 2020  .............   
-00038960: 2020 2020 2073 656c 662e 636f 6f72 5479       self.coorTy
-00038970: 7065 203d 205f 434f 4f52 5359 535b 2258  pe = _COORSYS["X
-00038980: 595a 225d 0d0a 2020 2020 2020 2020 7365  YZ"]..        se
-00038990: 6c66 2e62 6173 6543 6f6c 6f72 203d 206e  lf.baseColor = n
-000389a0: 702e 6172 7261 7928 7365 6c66 2e67 6574  p.array(self.get
-000389b0: 5f63 6f6c 6f72 2829 5b30 5d29 2e66 6c61  _color()[0]).fla
-000389c0: 7474 656e 2829 2e74 6f6c 6973 7428 290d  tten().tolist().
-000389d0: 0a20 2020 2020 2020 2073 656c 662e 7665  .        self.ve
-000389e0: 7274 6578 436f 6c6f 7220 3d20 6e70 2e61  rtexColor = np.a
-000389f0: 7272 6179 2820 5b20 7365 6c66 2e62 6173  rray( [ self.bas
-00038a00: 6543 6f6c 6f72 205d 2029 0d0a 2020 2020  eColor ] )..    
-00038a10: 2020 2020 2320 666f 6c6c 6f77 696e 6720      # following 
-00038a20: 6173 7369 676e 6564 2077 6865 6e20 7375  assigned when su
-00038a30: 7266 6163 6520 636f 6c6f 7220 6170 706c  rface color appl
-00038a40: 6965 6420 7573 696e 6720 616e 206f 7065  ied using an ope
-00038a50: 7261 7469 6f6e 0d0a 2020 2020 2020 2020  ration..        
-00038a60: 7365 6c66 2e76 6572 7465 7856 616c 7565  self.vertexValue
-00038a70: 7320 3d20 4e6f 6e65 0d0a 2020 2020 2020  s = None..      
-00038a80: 2020 7365 6c66 2e73 6567 5661 6c75 6573    self.segValues
-00038a90: 203d 204e 6f6e 650d 0a20 2020 2020 2020   = None..       
-00038aa0: 2023 202e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e   # .............
-00038ab0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00038ac0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00038ad0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00038ae0: 2e2e 0d0a 2020 2020 2020 2020 7365 6c66  ....        self
-00038af0: 2e73 6574 5f6a 6f69 6e73 7479 6c65 2827  .set_joinstyle('
-00038b00: 726f 756e 6427 290d 0a20 2020 2020 2020  round')..       
-00038b10: 2073 656c 662e 7365 745f 6361 7073 7479   self.set_capsty
-00038b20: 6c65 2827 726f 756e 6427 290d 0a20 2020  le('round')..   
-00038b30: 2020 2020 2073 656c 662e 7363 616c 6520       self.scale 
-00038b40: 3d20 5b31 2c31 2c31 5d20 2020 2020 2020  = [1,1,1]       
-00038b50: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00038b60: 2066 6f72 2061 7869 7320 7768 656e 2074   for axis when t
-00038b70: 7261 6e73 666f 726d 6564 2e0d 0a20 2020  ransformed...   
-00038b80: 2020 2020 2073 656c 662e 7472 616e 736c       self.transl
-00038b90: 6174 696f 6e20 3d20 5b30 2c30 2c30 5d20  ation = [0,0,0] 
-00038ba0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00038bb0: 2066 6f72 2061 7869 7320 7768 656e 2074   for axis when t
-00038bc0: 7261 6e73 666f 726d 6564 2e0d 0a20 2020  ransformed...   
-00038bd0: 2020 2020 2073 656c 662e 726f 7461 7469       self.rotati
-00038be0: 6f6e 203d 2020 6e70 2e69 6465 6e74 6974  on =  np.identit
-00038bf0: 7928 3329 2e74 6f6c 6973 7428 2920 2023  y(3).tolist()  #
-00038c00: 2066 6f72 2061 7869 7320 7768 656e 2074   for axis when t
-00038c10: 7261 6e73 666f 726d 6564 2e0d 0a20 2020  ransformed...   
-00038c20: 2020 2020 2073 656c 662e 7265 7374 6f72       self.restor
-00038c30: 6564 436c 6970 203d 204e 6f6e 650d 0a0d  edClip = None...
-00038c40: 0a20 2020 2020 2020 2073 656c 662e 7265  .        self.re
-00038c50: 7a20 3d20 4e6f 6e65 0d0a 2020 2020 2020  z = None..      
-00038c60: 2020 7365 6c66 2e5f 626f 756e 6473 203d    self._bounds =
-00038c70: 207b 7d0d 0a20 2020 2020 2020 2073 656c   {}..        sel
-00038c80: 662e 5f73 6574 5f67 656f 6d65 7472 6963  f._set_geometric
-00038c90: 5f62 6f75 6e64 7328 290d 0a20 2020 2020  _bounds()..     
-00038ca0: 2020 2073 656c 662e 5f62 6f75 6e64 735b     self._bounds[
-00038cb0: 2776 6c69 6d27 5d20 3d20 2020 2020 5f44  'vlim'] =     _D
-00038cc0: 4654 5f56 4c49 4d20 0d0a 2020 2020 2020  FT_VLIM ..      
-00038cd0: 2020 7365 6c66 2e5f 626f 756e 6473 5b27    self._bounds['
-00038ce0: 7665 7274 766c 696d 275d 203d 205f 4446  vertvlim'] = _DF
-00038cf0: 545f 5645 5254 564c 494d 0d0a 2020 2020  T_VERTVLIM..    
-00038d00: 2020 2020 7365 6c66 2e5f 706c 616e 654e      self._planeN
-00038d10: 6f72 6d61 6c20 3d20 4e6f 6e65 2020 232e  ormal = None  #.
-00038d20: 2e20 7365 7420 666f 7220 706c 616e 6172  . set for planar
-00038d30: 2063 6f6e 746f 7572 732c 2066 6f72 2046   contours, for F
-00038d40: 7574 4465 760d 0a0d 0a20 2020 2040 7374  utDev....    @st
-00038d50: 6174 6963 6d65 7468 6f64 0d0a 2020 2020  aticmethod..    
-00038d60: 6465 6620 5f6d 6964 5665 6374 6f72 4675  def _midVectorFu
-00038d70: 6e28 7665 6374 412c 2076 6563 7442 2920  n(vectA, vectB) 
-00038d80: 3a0d 0a20 2020 2020 2020 2022 2222 4d69  :..        """Mi
-00038d90: 642d 706f 696e 7420 6265 7477 6565 6e20  d-point between 
-00038da0: 7477 6f20 706f 696e 7473 2069 6e20 7468  two points in th
-00038db0: 6520 7879 2070 6c61 6e65 2e22 2222 0d0a  e xy plane."""..
-00038dc0: 2020 2020 2020 2020 6d69 6420 3d20 6e70          mid = np
-00038dd0: 2e61 6464 2876 6563 7441 2c76 6563 7442  .add(vectA,vectB
-00038de0: 290d 0a20 2020 2020 2020 206d 6964 203d  )..        mid =
-00038df0: 206e 702e 6d75 6c74 6970 6c79 2830 2e35   np.multiply(0.5
-00038e00: 2c6d 6964 290d 0a20 2020 2020 2020 2072  ,mid)..        r
-00038e10: 6574 7572 6e20 6d69 640d 0a0d 0a20 2020  eturn mid....   
-00038e20: 2040 7374 6174 6963 6d65 7468 6f64 0d0a   @staticmethod..
-00038e30: 2020 2020 6465 6620 5f65 7874 7261 6374      def _extract
-00038e40: 4c69 6e65 7328 6c69 6e65 5365 676d 656e  Lines(lineSegmen
-00038e50: 7473 2920 3a0d 0a20 2020 2020 2020 2023  ts) :..        #
-00038e60: 2045 6467 6520 6172 7261 7920 736f 7274   Edge array sort
-00038e70: 696e 6720 746f 206c 696e 6520 6172 7261  ing to line arra
-00038e80: 7973 2c20 7768 6963 6820 6d61 7920 6265  ys, which may be
-00038e90: 206c 6f6f 7073 2e20 4564 6765 2061 7272   loops. Edge arr
-00038ea0: 6179 730d 0a20 2020 2020 2020 2023 206d  ays..        # m
-00038eb0: 7573 7420 6861 7665 2074 776f 2069 6e64  ust have two ind
-00038ec0: 6963 6573 2069 6e20 636f 6e73 6973 7465  ices in consiste
-00038ed0: 6e74 206f 7264 6572 2e0d 0a20 2020 2020  nt order...     
-00038ee0: 2020 2023 2054 6869 7320 6973 2061 6e20     # This is an 
-00038ef0: 2775 6e73 6872 6564 2720 6675 6e63 7469  'unshred' functi
-00038f00: 6f6e 2e0d 0a20 2020 2020 2020 2023 202e  on...        # .
-00038f10: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00038f20: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00038f30: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00038f40: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00038f50: 2e0d 0a20 2020 2020 2020 2064 6566 2065  ...        def e
-00038f60: 7874 7261 6374 4c69 6e65 2865 6467 6544  xtractLine(edgeD
-00038f70: 6963 7429 203a 0d0a 2020 2020 2020 2020  ict) :..        
-00038f80: 2020 2020 2320 7573 6520 6120 6469 6374      # use a dict
-00038f90: 696f 6e61 7279 2074 6f20 6275 696c 6420  ionary to build 
-00038fa0: 6120 2773 6f72 742d 6f66 2720 7369 6e67  a 'sort-of' sing
-00038fb0: 6c65 206c 696e 6b65 6420 6c69 7374 0d0a  le linked list..
-00038fc0: 2020 2020 2020 2020 2020 2020 2320 6e6f              # no
-00038fd0: 7465 3a20 696e 6465 782d 6c69 7374 2077  te: index-list w
-00038fe0: 6f75 6c64 2063 6f6e 6169 6e20 6d61 6e79  ould conain many
-00038ff0: 2065 6d70 6c79 2076 616c 7565 732e 0d0a   emply values...
-00039000: 2020 2020 2020 2020 2020 2020 6564 6765              edge
-00039010: 4469 6374 5f66 6c20 3d20 6564 6765 4469  Dict_fl = edgeDi
-00039020: 6374 0d0a 2020 2020 2020 2020 2020 2020  ct..            
-00039030: 6b20 3d20 6c69 7374 2865 6467 6544 6963  k = list(edgeDic
-00039040: 742e 6b65 7973 2829 295b 305d 0d0a 2020  t.keys())[0]..  
-00039050: 2020 2020 2020 2020 2020 7620 3d20 6c69            v = li
-00039060: 7374 2865 6467 6544 6963 742e 7661 6c75  st(edgeDict.valu
-00039070: 6573 2829 295b 305d 0d0a 2020 2020 2020  es())[0]..      
-00039080: 2020 2020 2020 6c69 6e65 203d 205b 6b2c        line = [k,
-00039090: 765d 0d0a 2020 2020 2020 2020 2020 2020  v]..            
-000390a0: 6564 6765 4469 6374 5f66 6c2e 706f 7028  edgeDict_fl.pop(
-000390b0: 6b29 0d0a 0d0a 2020 2020 2020 2020 2020  k)....          
-000390c0: 2020 2320 6164 6420 7365 676d 656e 7473    # add segments
-000390d0: 2074 6f20 7468 6520 7461 696c 203a 0d0a   to the tail :..
-000390e0: 2020 2020 2020 2020 2020 2020 636f 6e74              cont
-000390f0: 696e 7565 4275 696c 6420 3d20 5472 7565  inueBuild = True
-00039100: 0d0a 2020 2020 2020 2020 2020 2020 7768  ..            wh
-00039110: 696c 6520 636f 6e74 696e 7565 4275 696c  ile continueBuil
-00039120: 6420 3a0d 0a20 2020 2020 2020 2020 2020  d :..           
-00039130: 2020 2020 2063 6f6e 7469 6e75 6542 7569       continueBui
-00039140: 6c64 203d 2046 616c 7365 0d0a 2020 2020  ld = False..    
-00039150: 2020 2020 2020 2020 2020 2020 656e 6420              end 
-00039160: 3d20 6c69 6e65 5b6c 656e 286c 696e 6529  = line[len(line)
-00039170: 2d31 5d0d 0a20 2020 2020 2020 2020 2020  -1]..           
-00039180: 2020 2020 2069 6620 656e 6420 696e 2065       if end in e
-00039190: 6467 6544 6963 745f 666c 203a 0d0a 2020  dgeDict_fl :..  
-000391a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000391b0: 2020 6c69 6e65 2e61 7070 656e 6428 6564    line.append(ed
-000391c0: 6765 4469 6374 5f66 6c5b 656e 645d 290d  geDict_fl[end]).
-000391d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000391e0: 2020 2020 2065 6467 6544 6963 745f 666c       edgeDict_fl
-000391f0: 2e70 6f70 2865 6e64 290d 0a20 2020 2020  .pop(end)..     
-00039200: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00039210: 6f6e 7469 6e75 6542 7569 6c64 203d 2054  ontinueBuild = T
-00039220: 7275 650d 0a20 2020 2020 2020 2020 2020  rue..           
-00039230: 2069 6620 6c69 6e65 5b6c 656e 286c 696e   if line[len(lin
-00039240: 6529 2d31 5d20 3d3d 206c 696e 655b 305d  e)-1] == line[0]
-00039250: 203a 200d 0a20 2020 2020 2020 2020 2020   : ..           
-00039260: 2020 2020 2072 6574 7572 6e20 6c69 6e65       return line
-00039270: 2c65 6467 6544 6963 745f 666c 0d0a 2020  ,edgeDict_fl..  
-00039280: 2020 2020 2020 2020 2020 2320 7468 656e            # then
-00039290: 206c 696e 6520 6973 206e 6f74 2061 206c   line is not a l
-000392a0: 6f6f 7020 736f 2063 6f6e 7469 6e75 652c  oop so continue,
-000392b0: 2061 6464 696e 6720 7365 676d 656e 7473   adding segments
-000392c0: 2074 6f20 6865 6164 203a 0d0a 2020 2020   to head :..    
-000392d0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-000392e0: 2020 2020 2020 6564 6765 4469 6374 5f6c        edgeDict_l
-000392f0: 6620 3d20 7b20 7661 6c75 653a 6b65 7920  f = { value:key 
-00039300: 666f 7220 6b65 792c 7661 6c75 6520 696e  for key,value in
-00039310: 2065 6467 6544 6963 745f 666c 2e69 7465   edgeDict_fl.ite
-00039320: 6d73 2829 7d0d 0a20 2020 2020 2020 2020  ms()}..         
-00039330: 2020 2063 6f6e 7469 6e75 6542 7569 6c64     continueBuild
-00039340: 203d 2054 7275 650d 0a20 2020 2020 2020   = True..       
-00039350: 2020 2020 2077 6869 6c65 2063 6f6e 7469       while conti
-00039360: 6e75 6542 7569 6c64 203a 0d0a 2020 2020  nueBuild :..    
-00039370: 2020 2020 2020 2020 2020 2020 636f 6e74              cont
-00039380: 696e 7565 4275 696c 6420 3d20 4661 6c73  inueBuild = Fals
-00039390: 650d 0a20 2020 2020 2020 2020 2020 2020  e..             
-000393a0: 2020 2073 7461 7274 203d 206c 696e 655b     start = line[
-000393b0: 305d 0d0a 2020 2020 2020 2020 2020 2020  0]..            
-000393c0: 2020 2020 6966 2073 7461 7274 2069 6e20      if start in 
-000393d0: 6564 6765 4469 6374 5f6c 6620 3a0d 0a20  edgeDict_lf :.. 
-000393e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000393f0: 2020 206c 696e 652e 696e 7365 7274 2830     line.insert(0
-00039400: 2c65 6467 6544 6963 745f 6c66 5b73 7461  ,edgeDict_lf[sta
-00039410: 7274 5d29 0d0a 2020 2020 2020 2020 2020  rt])..          
-00039420: 2020 2020 2020 2020 2020 6564 6765 4469            edgeDi
-00039430: 6374 5f6c 662e 706f 7028 7374 6172 7429  ct_lf.pop(start)
-00039440: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00039450: 2020 2020 2020 636f 6e74 696e 7565 4275        continueBu
-00039460: 696c 6420 3d20 5472 7565 0d0a 2020 2020  ild = True..    
-00039470: 2020 2020 2020 2020 6564 6765 4469 6374          edgeDict
-00039480: 5f6e 7874 203d 207b 2076 616c 7565 3a6b  _nxt = { value:k
-00039490: 6579 2066 6f72 206b 6579 2c76 616c 7565  ey for key,value
-000394a0: 2069 6e20 6564 6765 4469 6374 5f6c 662e   in edgeDict_lf.
-000394b0: 6974 656d 7328 2920 7d20 2020 2020 2020  items() }       
-000394c0: 200d 0a20 2020 2020 2020 2020 2020 2072   ..            r
-000394d0: 6574 7572 6e20 6c69 6e65 2c20 6564 6765  eturn line, edge
-000394e0: 4469 6374 5f6e 7874 0d0a 2020 2020 2020  Dict_nxt..      
-000394f0: 2020 2320 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e    # ............
-00039500: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00039510: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00039520: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00039530: 2e2e 2e2e 2e2e 0d0a 2020 2020 2020 2020  ........        
-00039540: 6564 6765 4469 6374 203d 2020 7b20 6c69  edgeDict =  { li
-00039550: 7465 6d5b 305d 3a6c 6974 656d 5b31 5d20  tem[0]:litem[1] 
-00039560: 2066 6f72 206c 6974 656d 2069 6e20 6c69   for litem in li
-00039570: 6e65 5365 676d 656e 7473 207d 0d0a 2020  neSegments }..  
-00039580: 2020 2020 2020 6c69 6e65 7320 3d20 5b5d        lines = []
-00039590: 0d0a 2020 2020 2020 2020 7768 696c 6528  ..        while(
-000395a0: 6c65 6e28 6564 6765 4469 6374 293e 3029  len(edgeDict)>0)
-000395b0: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
-000395c0: 6c69 6e65 2c65 6467 6544 6963 7420 3d20  line,edgeDict = 
-000395d0: 6578 7472 6163 744c 696e 6528 6564 6765  extractLine(edge
-000395e0: 4469 6374 290d 0a20 2020 2020 2020 2020  Dict)..         
-000395f0: 2020 206c 696e 6573 2e61 7070 656e 6428     lines.append(
-00039600: 6c69 6e65 290d 0a20 2020 2020 2020 2072  line)..        r
-00039610: 6574 7572 6e20 6c69 6e65 730d 0a0d 0a20  eturn lines.... 
-00039620: 2020 2064 6566 205f 5f61 6464 5f5f 2873     def __add__(s
-00039630: 656c 662c 206f 7468 7229 203a 0d0a 2020  elf, othr) :..  
-00039640: 2020 2020 2020 2222 2243 6f6c 6f72 4c69        """ColorLi
-00039650: 6e65 3344 436f 6c6c 6563 7469 6f6e 206f  ne3DCollection o
-00039660: 626a 6563 7420 6672 6f6d 2076 6572 7469  bject from verti
-00039670: 6365 732c 2073 6567 6d65 6e74 7320 616e  ces, segments an
-00039680: 6420 636f 6c6f 7273 206f 6620 7477 6f20  d colors of two 
-00039690: 6c69 6e65 206f 626a 6563 7473 2e20 2222  line objects. ""
-000396a0: 220d 0a0d 0a20 2020 2020 2020 2023 202e  "....        # .
-000396b0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-000396c0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-000396d0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-000396e0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-000396f0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e0d 0a20 2020  .............   
-00039700: 2020 2020 2064 6566 2067 6574 5f6c 696e       def get_lin
-00039710: 6543 6f6c 6f72 7328 2063 6f6c 6f72 732c  eColors( colors,
-00039720: 206c 696e 6573 2920 3a0d 0a20 2020 2020   lines) :..     
-00039730: 2020 2020 2020 2063 6f6c 6f72 7320 3d20         colors = 
-00039740: 6e70 2e61 7272 6179 2863 6f6c 6f72 7329  np.array(colors)
-00039750: 0d0a 2020 2020 2020 2020 2020 2020 6e6c  ..            nl
-00039760: 696e 6573 203d 206c 656e 286c 696e 6573  ines = len(lines
-00039770: 290d 0a20 2020 2020 2020 2020 2020 2069  )..            i
-00039780: 6620 6c65 6e28 636f 6c6f 7273 2920 213d  f len(colors) !=
-00039790: 206e 6c69 6e65 7320 3a0d 0a20 2020 2020   nlines :..     
-000397a0: 2020 2020 2020 2020 2020 2063 6f6c 6f72             color
-000397b0: 7320 3d20 6e70 2e74 696c 6528 636f 6c6f  s = np.tile(colo
-000397c0: 7273 2c28 6e6c 696e 6573 2c31 2929 0d0a  rs,(nlines,1))..
-000397d0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-000397e0: 726e 2063 6f6c 6f72 730d 0a20 2020 2020  rn colors..     
-000397f0: 2020 2023 202e 2e2e 2e2e 2e2e 2e2e 2e2e     # ...........
+0000cbb0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 0d0a  ................
+0000cbc0: 2020 2020 2020 2020 6465 6620 6564 6765          def edge
+0000cbd0: 735f 6672 6f6d 5f66 6163 654c 6973 7428  s_from_faceList(
+0000cbe0: 2066 7649 6e64 7820 2920 3a0d 0a20 2020   fvIndx ) :..   
+0000cbf0: 2020 2020 2020 2020 2023 204e 4f54 453a           # NOTE:
+0000cc00: 2076 6572 7920 706f 6f72 2065 7865 6375   very poor execu
+0000cc10: 7469 6f6e 2074 696d 652e 2028 7e32 206f  tion time. (~2 o
+0000cc20: 7264 6572 732d 6f66 2d6d 6167 6e69 7475  rders-of-magnitu
+0000cc30: 6465 2073 6c6f 7765 7229 0d0a 2020 2020  de slower)..    
+0000cc40: 2020 2020 2020 2020 2320 6661 6365 2069          # face i
+0000cc50: 6e64 6578 206c 6973 7420 6f66 206c 6973  ndex list of lis
+0000cc60: 7473 2063 616e 2774 2062 6520 7573 6564  ts can't be used
+0000cc70: 2061 7320 6120 4e75 6d70 7920 6172 7261   as a Numpy arra
+0000cc80: 790d 0a20 2020 2020 2020 2020 2020 2023  y..            #
+0000cc90: 2073 696e 6365 2065 6467 6520 6c69 7374   since edge list
+0000cca0: 206f 6620 6d75 6c74 692d 7479 7065 2066   of multi-type f
+0000ccb0: 6163 6573 2e0d 0a20 2020 2020 2020 2020  aces...         
+0000ccc0: 2020 2077 6172 6e69 6e67 732e 7761 726e     warnings.warn
+0000ccd0: 2827 6d75 6c74 692d 7479 7065 2070 6f6c  ('multi-type pol
+0000cce0: 7968 6564 726f 6e20 6661 6365 733a 2075  yhedron faces: u
+0000ccf0: 7365 206f 6620 6e6f 6e2d 6f70 7469 6d69  se of non-optimi
+0000cd00: 7a65 6420 6564 6765 2063 616c 632e 2729  zed edge calc.')
+0000cd10: 0d0a 2020 2020 2020 2020 2020 2020 6b65  ..            ke
+0000cd20: 794c 6973 742c 2065 6467 654c 6973 7420  yList, edgeList 
+0000cd30: 3d20 5b5d 2c5b 5d0d 0a20 2020 2020 2020  = [],[]..       
+0000cd40: 2020 2020 2073 7472 6b65 7920 3d20 6c61       strkey = la
+0000cd50: 6d62 6461 2061 2c62 203a 2073 7472 286d  mbda a,b : str(m
+0000cd60: 6178 2861 2c62 2929 202b 2027 5f27 202b  ax(a,b)) + '_' +
+0000cd70: 2073 7472 286d 696e 2861 2c62 2929 0d0a   str(min(a,b))..
+0000cd80: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+0000cd90: 6661 6365 2069 6e20 6676 496e 6478 203a  face in fvIndx :
+0000cda0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000cdb0: 2020 6e75 6d45 6467 6573 203d 206c 656e    numEdges = len
+0000cdc0: 2866 6163 6529 0d0a 2020 2020 2020 2020  (face)..        
+0000cdd0: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
+0000cde0: 2072 616e 6765 286e 756d 4564 6765 7329   range(numEdges)
+0000cdf0: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
+0000ce00: 2020 2020 2020 2020 6120 3d20 6661 6365          a = face
+0000ce10: 5b69 5d0d 0a20 2020 2020 2020 2020 2020  [i]..           
+0000ce20: 2020 2020 2020 2020 2062 203d 2066 6163           b = fac
+0000ce30: 655b 2028 692b 3129 256e 756d 4564 6765  e[ (i+1)%numEdge
+0000ce40: 735d 0d0a 2020 2020 2020 2020 2020 2020  s]..            
+0000ce50: 2020 2020 2020 2020 6b65 7920 3d20 7374          key = st
+0000ce60: 726b 6579 2861 2c62 290d 0a20 2020 2020  rkey(a,b)..     
+0000ce70: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0000ce80: 6620 6b65 7920 6e6f 7420 696e 206b 6579  f key not in key
+0000ce90: 4c69 7374 203a 200d 0a20 2020 2020 2020  List : ..       
+0000cea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ceb0: 206b 6579 4c69 7374 2e61 7070 656e 6428   keyList.append(
+0000cec0: 6b65 7929 0d0a 2020 2020 2020 2020 2020  key)..          
+0000ced0: 2020 2020 2020 2020 2020 2020 2020 6564                ed
+0000cee0: 6765 4c69 7374 2e61 7070 656e 6428 5b61  geList.append([a
+0000cef0: 2c62 5d29 0d0a 2020 2020 2020 2020 2020  ,b])..          
+0000cf00: 2020 7265 7475 726e 206e 702e 6172 7261    return np.arra
+0000cf10: 7928 6564 6765 4c69 7374 290d 0a20 2020  y(edgeList)..   
+0000cf20: 2020 2020 2023 202e 2e2e 2e2e 2e2e 2e2e       # .........
+0000cf30: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0000cf40: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0000cf50: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0000cf60: 2e2e 2e2e 0d0a 2020 2020 2020 2020 2320  ......        # 
+0000cf70: 666f 6c6c 6f77 696e 6720 6c69 6e65 206f  following line o
+0000cf80: 6e6c 7920 6e65 6564 6564 2077 6865 6e20  nly needed when 
+0000cf90: 6361 6c6c 6564 2066 6f72 206d 6978 6564  called for mixed
+0000cfa0: 2070 6f6c 7967 6f6e 2066 6163 6573 0d0a   polygon faces..
+0000cfb0: 2020 2020 2020 2020 6966 2066 7649 6e64          if fvInd
+0000cfc0: 782e 6e64 696d 203d 3d20 3120 3a20 7265  x.ndim == 1 : re
+0000cfd0: 7475 726e 2065 6467 6573 5f66 726f 6d5f  turn edges_from_
+0000cfe0: 6661 6365 4c69 7374 2866 7649 6e64 7829  faceList(fvIndx)
+0000cff0: 0d0a 0d0a 2020 2020 2020 2020 6e75 6d45  ....        numE
+0000d000: 6467 6573 203d 2066 7649 6e64 782e 7368  dges = fvIndx.sh
+0000d010: 6170 655b 315d 0d0a 2020 2020 2020 2020  ape[1]..        
+0000d020: 696e 6469 6369 6573 203d 205b 2028 692b  indicies = [ (i+
+0000d030: 3129 256e 756d 4564 6765 7320 666f 7220  1)%numEdges for 
+0000d040: 6920 696e 2072 616e 6765 286e 756d 4564  i in range(numEd
+0000d050: 6765 7329 205d 0d0a 2020 2020 2020 2020  ges) ]..        
+0000d060: 6f66 735f 6676 496e 6478 203d 2066 7649  ofs_fvIndx = fvI
+0000d070: 6e64 785b 3a2c 696e 6469 6369 6573 5d0d  ndx[:,indicies].
+0000d080: 0a20 2020 2020 2020 2073 7465 7041 203d  .        stepA =
+0000d090: 206e 702e 7374 6163 6b28 2028 6676 496e   np.stack( (fvIn
+0000d0a0: 6478 2c6f 6673 5f66 7649 6e64 7829 2c20  dx,ofs_fvIndx), 
+0000d0b0: 6178 6973 3d2d 3120 2029 0d0a 2020 2020  axis=-1  )..    
+0000d0c0: 2020 2020 7374 6570 4220 3d20 6e70 2e72      stepB = np.r
+0000d0d0: 6573 6861 7065 2820 7374 6570 412c 2028  eshape( stepA, (
+0000d0e0: 2d31 2c32 2029 2029 0d0a 2020 2020 2020  -1,2 ) )..      
+0000d0f0: 2020 7374 6570 4320 3d20 6e70 2e73 6f72    stepC = np.sor
+0000d100: 7428 7374 6570 422c 6178 6973 3d31 290d  t(stepB,axis=1).
+0000d110: 0a20 2020 2020 2020 2075 2c20 696e 6469  .        u, indi
+0000d120: 6365 7320 3d20 6e70 2e75 6e69 7175 6528  ces = np.unique(
+0000d130: 7374 6570 432c 2061 7869 733d 302c 2072  stepC, axis=0, r
+0000d140: 6574 7572 6e5f 696e 6465 783d 5472 7565  eturn_index=True
+0000d150: 290d 0a20 2020 2020 2020 2065 6467 654c  )..        edgeL
+0000d160: 6973 7420 3d20 7374 6570 435b 696e 6469  ist = stepC[indi
+0000d170: 6365 735d 0d0a 2020 2020 2020 2020 7265  ces]..        re
+0000d180: 7475 726e 2065 6467 654c 6973 740d 0a0d  turn edgeList...
+0000d190: 0a20 2020 2040 7072 6f70 6572 7479 0d0a  .    @property..
+0000d1a0: 2020 2020 6465 6620 5f64 6661 6365 636f      def _dfaceco
+0000d1b0: 6c6f 7273 2873 656c 6629 203a 0d0a 2020  lors(self) :..  
+0000d1c0: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
+0000d1d0: 2020 2044 6972 6563 7420 6163 6365 7373     Direct access
+0000d1e0: 2074 6f20 7468 6520 7072 6976 6174 6520   to the private 
+0000d1f0: 7072 6f70 6572 7479 205f 6661 6365 636f  property _faceco
+0000d200: 6c6f 722e 0d0a 0d0a 2020 2020 2020 2020  lor.....        
+0000d210: 4170 7065 6172 7320 7468 6174 2074 6865  Appears that the
+0000d220: 2073 656c 662e 6765 745f 6661 6365 636f   self.get_faceco
+0000d230: 6c6f 7228 2920 6e65 6564 7320 6120 6361  lor() needs a ca
+0000d240: 6c6c 2074 6f20 7468 650d 0a20 2020 2020  ll to the..     
+0000d250: 2020 2073 656c 662e 646f 5f33 645f 7072     self.do_3d_pr
+0000d260: 6f6a 6563 7469 6f6e 2829 2077 6869 6368  ojection() which
+0000d270: 2077 696c 6c20 2773 6f72 7420 7468 6520   will 'sort the 
+0000d280: 3244 2076 6572 7369 6f6e 2062 7920 7669  2D version by vi
+0000d290: 6577 2064 6570 7468 272e 0d0a 2020 2020  ew depth'...    
+0000d2a0: 2020 2020 666f 7220 7265 6e64 6572 2063      for render c
+0000d2b0: 6f6e 7374 7275 6374 696f 6e2e 2020 4e65  onstruction.  Ne
+0000d2c0: 6564 2074 6865 206f 7269 6769 6e61 6c20  ed the original 
+0000d2d0: 6f72 6465 7220 6f66 2063 6f6c 6f72 732e  order of colors.
+0000d2e0: 0d0a 2020 2020 2020 2020 4241 4e44 4149  ..        BANDAI
+0000d2f0: 4420 6669 783a 2075 7064 6174 6520 666f  D fix: update fo
+0000d300: 7220 765f 312e 322e 300d 0a0d 0a20 2020  r v_1.2.0....   
+0000d310: 2020 2020 2046 7574 4465 763a 2064 6566       FutDev: def
+0000d320: 696e 6520 6120 7365 7061 7261 7465 2070  ine a separate p
+0000d330: 7269 7661 7465 2070 726f 7065 7274 7920  rivate property 
+0000d340: 746f 2068 6f6c 6420 7468 6573 6520 7661  to hold these va
+0000d350: 6c75 6573 0d0a 2020 2020 2020 2020 2020  lues..          
+0000d360: 2020 2020 2020 616e 6420 6e6f 7420 7573        and not us
+0000d370: 6520 7468 6520 4d61 7470 6c6f 746c 6962  e the Matplotlib
+0000d380: 2069 6e68 6572 6974 6564 2076 616c 7565   inherited value
+0000d390: 3f0d 0a20 2020 2020 2020 2022 2222 0d0a  ?..        """..
+0000d3a0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0000d3b0: 656c 662e 5f66 6163 6563 6f6c 6f72 730d  elf._facecolors.
+0000d3c0: 0a0d 0a20 2020 2040 7072 6f70 6572 7479  ...    @property
+0000d3d0: 0d0a 2020 2020 6465 6620 5f64 6564 6765  ..    def _dedge
+0000d3e0: 636f 6c6f 7273 2873 656c 6629 203a 0d0a  colors(self) :..
+0000d3f0: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
+0000d400: 2020 2020 2044 6972 6563 7420 6163 6365       Direct acce
+0000d410: 7373 2074 6f20 7468 6520 7072 6976 6174  ss to the privat
+0000d420: 6520 7072 6f70 6572 7479 205f 6564 6765  e property _edge
+0000d430: 636f 6c6f 722e 0d0a 2020 2020 2020 2020  color...        
+0000d440: 2222 220d 0a20 2020 2020 2020 2072 6574  """..        ret
+0000d450: 7572 6e20 7365 6c66 2e5f 6564 6765 636f  urn self._edgeco
+0000d460: 6c6f 7273 0d0a 0d0a 2020 2020 4070 726f  lors....    @pro
+0000d470: 7065 7274 790d 0a20 2020 2064 6566 2076  perty..    def v
+0000d480: 6c69 6d28 7365 6c66 2920 3a0d 0a20 2020  lim(self) :..   
+0000d490: 2020 2020 2027 2727 5261 6e67 6520 6f66       '''Range of
+0000d4a0: 2076 616c 7565 7320 6173 736f 6369 6174   values associat
+0000d4b0: 6564 2077 6974 6820 636f 6c6f 7227 2727  ed with color'''
+0000d4c0: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+0000d4d0: 2073 656c 662e 5f62 6f75 6e64 735b 2776   self._bounds['v
+0000d4e0: 6c69 6d27 5d0d 0a0d 0a20 2020 2040 766c  lim']....    @vl
+0000d4f0: 696d 2e73 6574 7465 720d 0a20 2020 2064  im.setter..    d
+0000d500: 6566 2076 6c69 6d28 7365 6c66 2c76 616c  ef vlim(self,val
+0000d510: 2920 3a0d 0a20 2020 2020 2020 2073 656c  ) :..        sel
+0000d520: 662e 5f62 6f75 6e64 735b 2776 6c69 6d27  f._bounds['vlim'
+0000d530: 5d20 3d20 7661 6c0d 0a20 2020 2020 2020  ] = val..       
+0000d540: 2072 6574 7572 6e0d 0a0d 0a20 2020 2040   return....    @
+0000d550: 7072 6f70 6572 7479 0d0a 2020 2020 6465  property..    de
+0000d560: 6620 6e61 6d65 2873 656c 6629 203a 0d0a  f name(self) :..
+0000d570: 2020 2020 2020 2020 2727 2744 6573 6372          '''Descr
+0000d580: 6970 7469 7665 2069 6465 6e74 6966 6965  iptive identifie
+0000d590: 7220 666f 7220 7468 6520 7375 7266 6163  r for the surfac
+0000d5a0: 6520 6765 6f6d 6574 7279 2e27 2727 0d0a  e geometry.'''..
+0000d5b0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+0000d5c0: 5f67 656f 6d4e 616d 6520 6973 204e 6f6e  _geomName is Non
+0000d5d0: 6520 3a20 7265 7475 726e 2027 270d 0a20  e : return ''.. 
+0000d5e0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0000d5f0: 6c66 2e5f 6765 6f6d 4e61 6d65 0d0a 0d0a  lf._geomName....
+0000d600: 2020 2020 406e 616d 652e 7365 7474 6572      @name.setter
+0000d610: 0d0a 2020 2020 6465 6620 6e61 6d65 2873  ..    def name(s
+0000d620: 656c 662c 2076 616c 2920 3a0d 0a20 2020  elf, val) :..   
+0000d630: 2020 2020 2073 656c 662e 5f67 656f 6d4e       self._geomN
+0000d640: 616d 6520 3d20 7661 6c0d 0a20 2020 2020  ame = val..     
+0000d650: 2020 2073 656c 662e 7365 745f 6c61 6265     self.set_labe
+0000d660: 6c28 2027 2720 6966 2076 616c 2069 7320  l( '' if val is 
+0000d670: 4e6f 6e65 2065 6c73 6520 7661 6c20 290d  None else val ).
+0000d680: 0a20 2020 2020 2020 2072 6574 7572 6e0d  .        return.
+0000d690: 0a0d 0a20 2020 2040 7072 6f70 6572 7479  ...    @property
+0000d6a0: 0d0a 2020 2020 6465 6620 636e 616d 6528  ..    def cname(
+0000d6b0: 7365 6c66 2920 3a0d 0a20 2020 2020 2020  self) :..       
+0000d6c0: 2027 2727 4465 7363 7269 7074 6976 6520   '''Descriptive 
+0000d6d0: 6964 656e 7469 6669 6572 2066 6f72 2076  identifier for v
+0000d6e0: 616c 7565 7320 696e 6469 6361 7465 6420  alues indicated 
+0000d6f0: 6279 2063 6f6c 6f72 2e27 2727 0d0a 2020  by color.'''..  
+0000d700: 2020 2020 2020 6966 2073 656c 662e 7661        if self.va
+0000d710: 6c75 6573 4e61 6d65 2069 7320 4e6f 6e65  luesName is None
+0000d720: 203a 2072 6574 7572 6e20 2727 0d0a 2020   : return ''..  
+0000d730: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0000d740: 662e 7661 6c75 6573 4e61 6d65 0d0a 0d0a  f.valuesName....
+0000d750: 2020 2020 4063 6e61 6d65 2e73 6574 7465      @cname.sette
+0000d760: 720d 0a20 2020 2064 6566 2063 6e61 6d65  r..    def cname
+0000d770: 2873 656c 662c 2076 616c 2920 3a0d 0a20  (self, val) :.. 
+0000d780: 2020 2020 2020 2073 656c 662e 7661 6c75         self.valu
+0000d790: 6573 4e61 6d65 203d 2076 616c 0d0a 2020  esName = val..  
+0000d7a0: 2020 2020 2020 7265 7475 726e 0d0a 0d0a        return....
+0000d7b0: 2020 2020 4070 726f 7065 7274 790d 0a20      @property.. 
+0000d7c0: 2020 2064 6566 2062 6f75 6e64 7328 7365     def bounds(se
+0000d7d0: 6c66 2920 3a0d 0a20 2020 2020 2020 2022  lf) :..        "
+0000d7e0: 2222 0d0a 2020 2020 2020 2020 4469 6374  ""..        Dict
+0000d7f0: 696f 6e61 7279 206f 6620 7375 7266 6163  ionary of surfac
+0000d800: 6520 6765 6f6d 6574 7269 6320 616e 6420  e geometric and 
+0000d810: 7661 6c75 6520 7261 6e67 6573 2e0d 0a20  value ranges... 
+0000d820: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+0000d830: 2045 6163 6820 6469 6374 696f 6e61 7279   Each dictionary
+0000d840: 2076 616c 7565 2069 7320 6120 3220 666c   value is a 2 fl
+0000d850: 6f61 7420 6172 7261 7920 6f66 206d 696e  oat array of min
+0000d860: 696d 756d 0d0a 2020 2020 2020 2020 616e  imum..        an
+0000d870: 6420 6d61 7869 6d75 6d20 7661 6c75 6573  d maximum values
+0000d880: 206f 6620 7468 6520 7375 7266 6163 652e   of the surface.
+0000d890: 2020 4b65 7973 2061 7265 3a0d 0a0d 0a20    Keys are:.... 
+0000d8a0: 2020 2020 2020 2027 786c 696d 2720 3a20         'xlim' : 
+0000d8b0: 782d 636f 6f72 6469 6e61 7465 0d0a 0d0a  x-coordinate....
+0000d8c0: 2020 2020 2020 2020 2779 6c69 6d27 203a          'ylim' :
+0000d8d0: 2079 2d63 6f6f 7264 696e 6174 650d 0a0d   y-coordinate...
+0000d8e0: 0a20 2020 2020 2020 2027 7a6c 696d 2720  .        'zlim' 
+0000d8f0: 3a20 7a2d 636f 6f72 6469 6e61 7465 0d0a  : z-coordinate..
+0000d900: 0d0a 2020 2020 2020 2020 2772 5f78 7927  ..        'r_xy'
+0000d910: 203a 2072 6164 6961 6c20 6469 7374 616e   : radial distan
+0000d920: 6365 2066 726f 6d20 7468 6520 7a20 6178  ce from the z ax
+0000d930: 6973 0d0a 0d0a 2020 2020 2020 2020 2772  is....        'r
+0000d940: 6f72 6727 203a 2072 6164 6961 6c20 6469  org' : radial di
+0000d950: 7374 616e 6365 2066 726f 6d20 7468 6520  stance from the 
+0000d960: 6f72 6967 696e 0d0a 0d0a 2020 2020 2020  origin....      
+0000d970: 2020 2776 6c69 6d27 203a 2076 616c 7565    'vlim' : value
+0000d980: 2066 756e 6374 696f 6e61 6c20 6173 7369   functional assi
+0000d990: 676e 6d65 6e74 732e 0d0a 2020 2020 2020  gnments...      
+0000d9a0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+0000d9b0: 5661 6c75 6573 2061 7265 2061 7373 6967  Values are assig
+0000d9c0: 6e65 6420 6672 6f6d 2074 6865 2067 656f  ned from the geo
+0000d9d0: 6d65 7472 7920 616e 6420 636f 6c6f 7220  metry and color 
+0000d9e0: 6d61 7070 696e 6720 6d65 7468 6f64 732c  mapping methods,
+0000d9f0: 0d0a 2020 2020 2020 2020 696e 636c 7564  ..        includ
+0000da00: 696e 6720 636c 6970 7069 6e67 2e0d 0a0d  ing clipping....
+0000da10: 0a20 2020 2020 2020 2022 2222 0d0a 0d0a  .        """....
+0000da20: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0000da30: 656c 662e 5f62 6f75 6e64 730d 0a0d 0a20  elf._bounds.... 
+0000da40: 2020 2040 7072 6f70 6572 7479 0d0a 2020     @property..  
+0000da50: 2020 6465 6620 6342 6172 5f53 6361 6c61    def cBar_Scala
+0000da60: 724d 6170 7061 626c 6528 7365 6c66 2920  rMappable(self) 
+0000da70: 3a0d 0a20 2020 2020 2020 2022 2222 6d61  :..        """ma
+0000da80: 7470 6c6f 746c 6962 2e63 6d2e 5363 616c  tplotlib.cm.Scal
+0000da90: 6172 4d61 7070 6162 6c65 206f 626a 6563  arMappable objec
+0000daa0: 7420 666f 7220 7375 7266 6163 6520 7661  t for surface va
+0000dab0: 6c75 6573 2e22 2222 0d0a 2020 2020 2020  lues."""..      
+0000dac0: 2020 0d0a 2020 2020 2020 2020 766d 696e    ..        vmin
+0000dad0: 2c20 766d 6178 203d 2073 656c 662e 5f62  , vmax = self._b
+0000dae0: 6f75 6e64 735b 2776 6c69 6d27 5d0d 0a20  ounds['vlim'].. 
+0000daf0: 2020 2020 2020 206e 6f72 6d20 3d20 636f         norm = co
+0000db00: 6c6f 7273 2e4e 6f72 6d61 6c69 7a65 2876  lors.Normalize(v
+0000db10: 6d69 6e3d 766d 696e 2c76 6d61 783d 766d  min=vmin,vmax=vm
+0000db20: 6178 290d 0a20 2020 2020 2020 206f 626a  ax)..        obj
+0000db30: 4d61 7020 3d20 7365 6c66 2e67 6574 5f63  Map = self.get_c
+0000db40: 6d61 7028 290d 0a20 2020 2020 2020 2073  map()..        s
+0000db50: 6d20 3d20 636d 2e53 6361 6c61 724d 6170  m = cm.ScalarMap
+0000db60: 7061 626c 6528 636d 6170 3d6f 626a 4d61  pable(cmap=objMa
+0000db70: 702c 206e 6f72 6d3d 6e6f 726d 290d 0a20  p, norm=norm).. 
+0000db80: 2020 2020 2020 2073 6d2e 7365 745f 6172         sm.set_ar
+0000db90: 7261 7928 5b5d 290d 0a20 2020 2020 2020  ray([])..       
+0000dba0: 2072 6574 7572 6e20 736d 2020 2020 2020   return sm      
+0000dbb0: 2020 0d0a 2020 2020 0d0a 2020 2020 4070    ..    ..    @p
+0000dbc0: 726f 7065 7274 790d 0a20 2020 2064 6566  roperty..    def
+0000dbd0: 2065 6467 6573 2873 656c 6629 203a 0d0a   edges(self) :..
+0000dbe0: 2020 2020 2020 2020 2222 2243 6f6c 6f72          """Color
+0000dbf0: 4c69 6e65 3344 436f 6c6c 6563 7469 6f6e  Line3DCollection
+0000dc00: 206f 6620 7468 6520 7375 7266 6163 6520   of the surface 
+0000dc10: 6564 6765 7320 6672 6f6d 2066 6163 6563  edges from facec
+0000dc20: 6f6c 6f72 732e 2222 220d 0a20 2020 2020  olors."""..     
+0000dc30: 2020 2023 202e 2e2e 2e2e 2e2e 2e2e 2e2e     # ...........
+0000dc40: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0000dc50: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0000dc60: 2e2e 2e2e 2e2e 2e2e 2e2e 2e0d 0a20 2020  .............   
+0000dc70: 2020 2020 2064 6566 2067 6574 5f65 6467       def get_edg
+0000dc80: 655f 636f 6c6f 7228 2920 3a0d 0a20 2020  e_color() :..   
+0000dc90: 2020 2020 2020 2020 2065 6663 4c69 7374           efcList
+0000dca0: 203d 2063 6f70 792e 636f 7079 2873 656c   = copy.copy(sel
+0000dcb0: 662e 6566 496e 6469 6365 734c 6973 7429  f.efIndicesList)
+0000dcc0: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+0000dcd0: 616e 2065 6467 6520 6d61 7920 6861 7665  an edge may have
+0000dce0: 2031 206f 7220 3220 6164 6a61 6365 6e74   1 or 2 adjacent
+0000dcf0: 2066 6163 6573 2e2e 2e2e 0d0a 2020 2020   faces......    
+0000dd00: 2020 2020 2020 2020 666f 7220 692c 634c          for i,cL
+0000dd10: 6973 7420 696e 2065 6e75 6d65 7261 7465  ist in enumerate
+0000dd20: 2873 656c 662e 6566 496e 6469 6365 734c  (self.efIndicesL
+0000dd30: 6973 7429 203a 0d0a 2020 2020 2020 2020  ist) :..        
+0000dd40: 2020 2020 2020 2020 6966 206c 656e 2863          if len(c
+0000dd50: 4c69 7374 293d 3d31 203a 2065 6663 4c69  List)==1 : efcLi
+0000dd60: 7374 5b69 5d2e 6170 7065 6e64 2865 6663  st[i].append(efc
+0000dd70: 4c69 7374 5b69 5d5b 305d 290d 0a20 2020  List[i][0])..   
+0000dd80: 2020 2020 2020 2020 2065 6663 4172 7261           efcArra
+0000dd90: 7920 3d20 6e70 2e61 7272 6179 2865 6663  y = np.array(efc
+0000dda0: 4c69 7374 290d 0a20 2020 2020 2020 2020  List)..         
+0000ddb0: 2020 2073 656c 662e 5f70 6f73 7450 726f     self._postPro
+0000ddc0: 635f 7375 7266 6163 6543 6f6c 6f72 7328  c_surfaceColors(
+0000ddd0: 5472 7565 290d 0a20 2020 2020 2020 2020  True)..         
+0000dde0: 2020 2063 6f6c 6f72 4120 3d20 7365 6c66     colorA = self
+0000ddf0: 2e66 6163 6563 6f6c 6f72 735b 6566 6341  .facecolors[efcA
+0000de00: 7272 6179 2e54 5b30 5d5d 0d0a 2020 2020  rray.T[0]]..    
+0000de10: 2020 2020 2020 2020 636f 6c6f 7242 203d          colorB =
+0000de20: 2073 656c 662e 6661 6365 636f 6c6f 7273   self.facecolors
+0000de30: 5b65 6663 4172 7261 792e 545b 315d 5d0d  [efcArray.T[1]].
+0000de40: 0a20 2020 2020 2020 2020 2020 2023 2061  .            # a
+0000de50: 7665 7261 6765 206f 6620 6164 6a61 6365  verage of adjace
+0000de60: 6e74 2066 6163 6520 5247 4220 636f 6c6f  nt face RGB colo
+0000de70: 7273 0d0a 2020 2020 2020 2020 2020 2020  rs..            
+0000de80: 7265 7475 726e 2028 2063 6f6c 6f72 412b  return ( colorA+
+0000de90: 636f 6c6f 7242 292f 320d 0a20 2020 2020  colorB)/2..     
+0000dea0: 2020 2023 202e 2e2e 2e2e 2e2e 2e2e 2e2e     # ...........
+0000deb0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0000dec0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0000ded0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e0d 0a20 2020  .............   
+0000dee0: 2020 2020 2076 203d 2073 656c 662e 7665       v = self.ve
+0000def0: 7274 6578 436f 6f72 0d0a 2020 2020 2020  rtexCoor..      
+0000df00: 2020 6520 3d20 7365 6c66 2e5f 6765 745f    e = self._get_
+0000df10: 6564 6765 735f 6672 6f6d 5f66 6163 6573  edges_from_faces
+0000df20: 2873 656c 662e 6676 496e 6469 6365 7329  (self.fvIndices)
+0000df30: 2020 2320 6163 636f 756e 7473 2066 6f72    # accounts for
+0000df40: 2063 6c69 7070 696e 672e 2e2e 0d0a 2020   clipping.....  
+0000df50: 2020 2020 2020 6c63 6f6c 203d 2043 6f6c        lcol = Col
+0000df60: 6f72 4c69 6e65 3344 436f 6c6c 6563 7469  orLine3DCollecti
+0000df70: 6f6e 2876 2c65 2c27 6564 6765 7327 290d  on(v,e,'edges').
+0000df80: 0a20 2020 2020 2020 206c 636f 6c2e 5f6c  .        lcol._l
+0000df90: 6564 6765 636f 6c6f 7273 203d 2067 6574  edgecolors = get
+0000dfa0: 5f65 6467 655f 636f 6c6f 7228 2920 2023  _edge_color()  #
+0000dfb0: 2075 7064 6174 6520 666f 7220 765f 312e   update for v_1.
+0000dfc0: 322e 300d 0a20 2020 2020 2020 2072 6574  2.0..        ret
+0000dfd0: 7572 6e20 6c63 6f6c 0d0a 0d0a 2020 2020  urn lcol....    
+0000dfe0: 4070 726f 7065 7274 790d 0a20 2020 2064  @property..    d
+0000dff0: 6566 2069 6e69 7465 6467 6573 2873 656c  ef initedges(sel
+0000e000: 6629 203a 0d0a 2020 2020 2020 2020 2727  f) :..        ''
+0000e010: 2720 436f 6c6f 724c 696e 6533 4443 6f6c  ' ColorLine3DCol
+0000e020: 6c65 6374 696f 6e20 6f66 2074 6865 2069  lection of the i
+0000e030: 6e69 7469 616c 2073 7572 6661 6365 2065  nitial surface e
+0000e040: 6467 6573 2e0d 0a20 2020 2020 2020 2020  dges...         
+0000e050: 2020 204f 4e4c 5920 6176 6169 6c61 626c     ONLY availabl
+0000e060: 6520 666f 7220 7375 7266 6163 6573 2077  e for surfaces w
+0000e070: 6865 7265 2074 6865 206e 756d 6265 7220  here the number 
+0000e080: 6f66 0d0a 2020 2020 2020 2020 2020 2020  of..            
+0000e090: 6661 6365 2065 6467 6573 2064 6966 6665  face edges diffe
+0000e0a0: 7220 616d 6f6e 6720 6661 6365 732e 0d0a  r among faces...
+0000e0b0: 0d0a 2020 2020 2020 2020 2727 270d 0a0d  ..        '''...
+0000e0c0: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+0000e0d0: 2e5f 696e 6974 6564 6765 7320 6973 204e  ._initedges is N
+0000e0e0: 6f6e 6520 3a0d 0a20 2020 2020 2020 2020  one :..         
+0000e0f0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+0000e100: 726f 7228 2769 6e69 7465 6467 6573 2070  ror('initedges p
+0000e110: 726f 7065 7274 7920 6e6f 7420 6176 6169  roperty not avai
+0000e120: 6c61 626c 652c 2061 6c6c 2069 6e69 7469  lable, all initi
+0000e130: 616c 2066 6163 6573 2068 6176 6520 6571  al faces have eq
+0000e140: 7561 6c20 6e75 6d62 6572 206f 6620 6564  ual number of ed
+0000e150: 6765 7320 2875 7365 2065 6467 6573 2070  ges (use edges p
+0000e160: 726f 7065 7274 7929 2729 2020 2020 2020  roperty)')      
+0000e170: 200d 0a20 2020 2020 2020 2065 203d 2073   ..        e = s
+0000e180: 656c 662e 5f69 6e69 7465 6467 6573 0d0a  elf._initedges..
+0000e190: 2020 2020 2020 2020 7620 3d20 7365 6c66          v = self
+0000e1a0: 2e5f 696e 6974 7665 7274 730d 0a20 2020  ._initverts..   
+0000e1b0: 2020 2020 206c 636f 6c20 3d20 436f 6c6f       lcol = Colo
+0000e1c0: 724c 696e 6533 4443 6f6c 6c65 6374 696f  rLine3DCollectio
+0000e1d0: 6e28 762c 652c 2765 6467 6573 2729 0d0a  n(v,e,'edges')..
+0000e1e0: 2020 2020 2020 2020 7265 7475 726e 206c          return l
+0000e1f0: 636f 6c0d 0a0d 0a20 2020 2040 7072 6f70  col....    @prop
+0000e200: 6572 7479 0d0a 2020 2020 6465 6620 7665  erty..    def ve
+0000e210: 7274 6963 6573 2873 656c 6629 203a 0d0a  rtices(self) :..
+0000e220: 2020 2020 2020 2020 2222 2241 2033 2078          """A 3 x
+0000e230: 204e 2061 7272 6179 206f 6620 7375 7266   N array of surf
+0000e240: 6163 6520 7665 7274 6963 6573 2e22 2222  ace vertices."""
+0000e250: 0d0a 2020 2020 2020 2020 7620 3d20 7365  ..        v = se
+0000e260: 6c66 2e76 6572 7465 7843 6f6f 720d 0a20  lf.vertexCoor.. 
+0000e270: 2020 2020 2020 206d 203d 206e 702e 7472         m = np.tr
+0000e280: 616e 7370 6f73 6528 7629 0d0a 2020 2020  anspose(v)..    
+0000e290: 2020 2020 7265 7475 726e 206d 0d0a 0d0a      return m....
+0000e2a0: 2020 2020 4070 726f 7065 7274 790d 0a20      @property.. 
+0000e2b0: 2020 2064 6566 2066 6163 6563 656e 7465     def facecente
+0000e2c0: 7273 2873 656c 6629 203a 0d0a 2020 2020  rs(self) :..    
+0000e2d0: 2020 2020 2222 2241 2033 2078 204e 2061      """A 3 x N a
+0000e2e0: 7272 6179 206f 6620 7375 7266 6163 6520  rray of surface 
+0000e2f0: 6661 6365 2063 656e 7465 7220 636f 6f72  face center coor
+0000e300: 6469 6e61 7465 732e 2222 220d 0a20 2020  dinates."""..   
+0000e310: 2020 2020 2076 6572 7473 203d 2073 656c       verts = sel
+0000e320: 662e 7665 7274 6578 436f 6f72 5b20 7365  f.vertexCoor[ se
+0000e330: 6c66 2e66 7649 6e64 6963 6573 205d 0d0a  lf.fvIndices ]..
+0000e340: 2020 2020 2020 2020 6661 6365 4365 6e74          faceCent
+0000e350: 6572 436f 6f72 203d 2073 656c 662e 5f67  erCoor = self._g
+0000e360: 6574 5f66 6163 655f 6365 6e74 6572 7328  et_face_centers(
+0000e370: 7665 7274 7329 0d0a 2020 2020 2020 2020  verts)..        
+0000e380: 6d20 3d20 6e70 2e74 7261 6e73 706f 7365  m = np.transpose
+0000e390: 2866 6163 6543 656e 7465 7243 6f6f 7229  (faceCenterCoor)
+0000e3a0: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+0000e3b0: 206d 0d0a 0d0a 2020 2020 4070 726f 7065   m....    @prope
+0000e3c0: 7274 790d 0a20 2020 2064 6566 2066 6163  rty..    def fac
+0000e3d0: 6563 6f6c 6f72 7328 7365 6c66 2920 3a0d  ecolors(self) :.
+0000e3e0: 0a20 2020 2020 2020 2022 2222 4120 4e20  .        """A N 
+0000e3f0: 7820 3420 6172 7261 7920 6f66 2073 7572  x 4 array of sur
+0000e400: 6661 6365 2066 6163 6520 636f 6c6f 7273  face face colors
+0000e410: 2e22 2222 0d0a 2020 2020 2020 2020 7365  ."""..        se
+0000e420: 6c66 2e5f 706f 7374 5072 6f63 5f73 7572  lf._postProc_sur
+0000e430: 6661 6365 436f 6c6f 7273 2829 0d0a 2020  faceColors()..  
+0000e440: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0000e450: 662e 5f64 6661 6365 636f 6c6f 7273 2020  f._dfacecolors  
+0000e460: 2320 7570 6461 7465 2066 6f72 2076 5f31  # update for v_1
+0000e470: 2e32 2e30 0d0a 0d0a 2020 2020 4070 726f  .2.0....    @pro
+0000e480: 7065 7274 790d 0a20 2020 2064 6566 2073  perty..    def s
+0000e490: 7664 5f64 6963 7428 7365 6c66 2920 3a0d  vd_dict(self) :.
+0000e4a0: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
+0000e4b0: 2020 2020 2020 4120 6469 6374 696f 6e61        A dictiona
+0000e4c0: 7279 206f 6620 7265 7375 6c74 7320 6672  ry of results fr
+0000e4d0: 6f6d 2061 2053 696e 6775 6c61 7220 5661  om a Singular Va
+0000e4e0: 6c75 6520 4465 636f 6d70 6f73 6974 696f  lue Decompositio
+0000e4f0: 6e20 6f66 2074 6865 2064 6174 612e 0d0a  n of the data...
+0000e500: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+0000e510: 2020 4b65 7973 2061 7265 3a0d 0a0d 0a20    Keys are:.... 
+0000e520: 2020 2020 2020 2027 6469 7361 7272 2720         'disarr' 
+0000e530: 3a20 6172 7261 7920 6f66 204e 2066 6c6f  : array of N flo
+0000e540: 6174 732c 206e 6f72 6d61 6c69 7a65 6420  ats, normalized 
+0000e550: 746f 2074 6865 2073 7572 6661 6365 2073  to the surface s
+0000e560: 697a 652e 0d0a 2020 2020 2020 2020 0d0a  ize...        ..
+0000e570: 2020 2020 2020 2020 2773 6967 6d61 2720          'sigma' 
+0000e580: 3a20 7374 616e 6461 7264 2064 6576 6961  : standard devia
+0000e590: 7469 6f6e 0d0a 0d0a 2020 2020 2020 2020  tion....        
+0000e5a0: 2774 7261 6e73 2720 3a20 5b72 6f74 6174  'trans' : [rotat
+0000e5b0: 696f 6e20 6d61 7472 6978 2c20 7363 616c  ion matrix, scal
+0000e5c0: 696e 672c 2074 7261 6e73 6c61 7469 6f6e  ing, translation
+0000e5d0: 5d0d 0a20 2020 200d 0a20 2020 2020 2020  ]..    ..       
+0000e5e0: 2056 616c 7565 7320 6172 6520 6173 7369   Values are assi
+0000e5f0: 676e 6564 2075 7369 6e67 2074 6865 206d  gned using the m
+0000e600: 6170 5f67 656f 6d5f 6672 6f6d 5f73 7664  ap_geom_from_svd
+0000e610: 206d 6574 686f 642e 0d0a 2020 2020 2020   method...      
+0000e620: 2020 5468 6520 6469 6374 696f 6e61 7279    The dictionary
+0000e630: 2069 7320 4e6f 6e65 2069 6620 7468 6520   is None if the 
+0000e640: 6d65 7468 6f64 2068 6173 206e 6f74 2062  method has not b
+0000e650: 6565 6e20 6361 6c6c 6564 2062 7920 7468  een called by th
+0000e660: 6520 7375 7266 6163 6520 6f62 6a65 6374  e surface object
+0000e670: 2e0d 0a20 2020 2020 2020 200d 0a20 2020  ...        ..   
+0000e680: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
+0000e690: 2020 7265 7475 726e 2073 656c 662e 5f73    return self._s
+0000e6a0: 7664 5f64 6963 740d 0a0d 0a20 2020 2040  vd_dict....    @
+0000e6b0: 7072 6f70 6572 7479 0d0a 2020 2020 6465  property..    de
+0000e6c0: 6620 6172 6561 5f68 3262 2873 656c 6629  f area_h2b(self)
+0000e6d0: 203a 0d0a 2020 2020 2020 2020 2222 2220   :..        """ 
+0000e6e0: 4120 3220 7820 4e20 6172 7261 7920 6f66  A 2 x N array of
+0000e6f0: 206e 6f72 6d61 6c69 7a65 6420 4e20 6661   normalized N fa
+0000e700: 6365 2061 7265 6173 2061 6e64 2073 6861  ce areas and sha
+0000e710: 7065 732e 2222 220d 0a20 2020 2020 2020  pes."""..       
+0000e720: 2066 2c76 203d 2073 656c 662e 6676 496e   f,v = self.fvIn
+0000e730: 6469 6365 732c 2073 656c 662e 7665 7274  dices, self.vert
+0000e740: 6578 436f 6f72 0d0a 2020 2020 2020 2020  exCoor..        
+0000e750: 6966 2066 2e73 6861 7065 5b31 5d20 3d3d  if f.shape[1] ==
+0000e760: 2033 203a 2023 2074 7269 616e 6775 6c61   3 : # triangula
+0000e770: 720d 0a20 2020 2020 2020 2020 2020 2041  r..            A
+0000e780: 203d 2076 5b20 665b 3a2c 315d 205d 202d   = v[ f[:,1] ] -
+0000e790: 2076 5b20 665b 3a2c 305d 205d 0d0a 2020   v[ f[:,0] ]..  
+0000e7a0: 2020 2020 2020 2020 2020 4220 3d20 765b            B = v[
+0000e7b0: 2066 5b3a 2c32 5d20 5d20 2d20 765b 2066   f[:,2] ] - v[ f
+0000e7c0: 5b3a 2c30 5d20 5d0d 0a20 2020 2020 2020  [:,0] ]..       
+0000e7d0: 2020 2020 2043 203d 2076 5b20 665b 3a2c       C = v[ f[:,
+0000e7e0: 325d 205d 202d 2076 5b20 665b 3a2c 315d  2] ] - v[ f[:,1]
+0000e7f0: 205d 0d0a 2020 2020 2020 2020 2020 2020   ]..            
+0000e800: 6172 6561 203d 2030 2e35 2a6e 702e 6c69  area = 0.5*np.li
+0000e810: 6e61 6c67 2e6e 6f72 6d28 206e 702e 6372  nalg.norm( np.cr
+0000e820: 6f73 7328 412c 4229 2c61 7869 733d 3120  oss(A,B),axis=1 
+0000e830: 290d 0a20 2020 2020 2020 2020 2020 2061  )..            a
+0000e840: 7665 4172 6561 203d 206e 702e 6176 6572  veArea = np.aver
+0000e850: 6167 6528 6172 6561 290d 0a20 2020 2020  age(area)..     
+0000e860: 2020 2020 2020 206e 6f72 6d41 7265 6120         normArea 
+0000e870: 3d20 6172 6561 2f61 7665 4172 6561 0d0a  = area/aveArea..
+0000e880: 2020 2020 2020 2020 2020 2020 6564 6765              edge
+0000e890: 7320 3d20 6e70 2e6c 696e 616c 672e 6e6f  s = np.linalg.no
+0000e8a0: 726d 2820 6e70 2e61 7272 6179 2820 5b41  rm( np.array( [A
+0000e8b0: 2c42 2c43 5d29 2c61 7869 733d 3229 0d0a  ,B,C]),axis=2)..
+0000e8c0: 2020 2020 2020 2020 2020 2020 6d61 7873              maxs
+0000e8d0: 697a 6573 203d 206e 702e 616d 6178 2865  izes = np.amax(e
+0000e8e0: 6467 6573 2c61 7869 733d 3029 0d0a 2020  dges,axis=0)..  
+0000e8f0: 2020 2020 2020 2020 2020 6620 3d20 342a            f = 4*
+0000e900: 6e70 2e73 7172 7428 3329 2f33 2023 2065  np.sqrt(3)/3 # e
+0000e910: 7175 696c 6174 6572 616c 2074 7269 616e  quilateral trian
+0000e920: 676c 650d 0a20 2020 2020 2020 2020 2020  gle..           
+0000e930: 2073 6b65 7720 3d20 662a 6172 6561 2f28   skew = f*area/(
+0000e940: 6d61 7873 697a 6573 2a6d 6178 7369 7a65  maxsizes*maxsize
+0000e950: 7329 0d0a 2020 2020 2020 2020 656c 7365  s)..        else
+0000e960: 203a 2023 2071 7561 6472 6174 6572 616c   : # quadrateral
+0000e970: 2069 7320 7477 6f20 7472 6961 6e67 6c65   is two triangle
+0000e980: 732e 0d0a 2020 2020 2020 2020 2020 2020  s...            
+0000e990: 6230 3220 3d20 765b 2066 5b3a 2c32 5d20  b02 = v[ f[:,2] 
+0000e9a0: 5d20 2d20 765b 2066 5b3a 2c30 5d20 5d20  ] - v[ f[:,0] ] 
+0000e9b0: 0d0a 2020 2020 2020 2020 2020 2020 6231  ..            b1
+0000e9c0: 3320 3d20 765b 2066 5b3a 2c33 5d20 5d20  3 = v[ f[:,3] ] 
+0000e9d0: 2d20 765b 2066 5b3a 2c31 5d20 5d0d 0a20  - v[ f[:,1] ].. 
+0000e9e0: 2020 2020 2020 2020 2020 2062 6173 6520             base 
+0000e9f0: 3d20 6e70 2e61 7272 6179 2820 5b62 3032  = np.array( [b02
+0000ea00: 2c62 3133 5d20 290d 0a20 2020 2020 2020  ,b13] )..       
+0000ea10: 2020 2020 2064 6961 6720 3d20 6e70 2e6c       diag = np.l
+0000ea20: 696e 616c 672e 6e6f 726d 2820 6261 7365  inalg.norm( base
+0000ea30: 202c 6178 6973 3d32 290d 0a20 2020 2020   ,axis=2)..     
+0000ea40: 2020 2020 2020 2069 203d 206e 702e 7768         i = np.wh
+0000ea50: 6572 6528 6469 6167 5b30 5d3e 6469 6167  ere(diag[0]>diag
+0000ea60: 5b31 5d2c 206e 702e 7a65 726f 7328 6c65  [1], np.zeros(le
+0000ea70: 6e28 6629 2c69 6e74 292c 206e 702e 6f6e  n(f),int), np.on
+0000ea80: 6573 286c 656e 2866 292c 696e 7429 2029  es(len(f),int) )
+0000ea90: 0d0a 2020 2020 2020 2020 2020 2020 6d61  ..            ma
+0000eaa0: 7873 697a 6573 203d 2020 6469 6167 5b69  xsizes =  diag[i
+0000eab0: 2c31 5d0d 0a20 2020 2020 2020 2020 2020  ,1]..           
+0000eac0: 2041 203d 2062 3032 0d0a 2020 2020 2020   A = b02..      
+0000ead0: 2020 2020 2020 2320 746f 7020 7472 6961        # top tria
+0000eae0: 6e67 6c65 202e 2e2e 2e0d 0a20 2020 2020  ngle ......     
+0000eaf0: 2020 2020 2020 2042 203d 2076 5b20 665b         B = v[ f[
+0000eb00: 3a2c 335d 205d 202d 2076 5b20 665b 3a2c  :,3] ] - v[ f[:,
+0000eb10: 305d 205d 0d0a 2020 2020 2020 2020 2020  0] ]..          
+0000eb20: 2020 6172 6561 546f 7020 3d20 302e 352a    areaTop = 0.5*
+0000eb30: 6e70 2e6c 696e 616c 672e 6e6f 726d 2820  np.linalg.norm( 
+0000eb40: 6e70 2e63 726f 7373 2841 2c42 292c 6178  np.cross(A,B),ax
+0000eb50: 6973 3d31 2029 0d0a 2020 2020 2020 2020  is=1 )..        
+0000eb60: 2020 2020 2320 626f 7474 6f6d 2074 7269      # bottom tri
+0000eb70: 616e 676c 6520 2e2e 2e2e 0d0a 2020 2020  angle ......    
+0000eb80: 2020 2020 2020 2020 4220 3d20 765b 2066          B = v[ f
+0000eb90: 5b3a 2c31 5d20 5d20 2d20 765b 2066 5b3a  [:,1] ] - v[ f[:
+0000eba0: 2c32 5d20 5d0d 0a20 2020 2020 2020 2020  ,2] ]..         
+0000ebb0: 2020 2061 7265 6142 746d 203d 2030 2e35     areaBtm = 0.5
+0000ebc0: 2a6e 702e 6c69 6e61 6c67 2e6e 6f72 6d28  *np.linalg.norm(
+0000ebd0: 206e 702e 6372 6f73 7328 2d41 2c42 292c   np.cross(-A,B),
+0000ebe0: 6178 6973 3d31 2029 0d0a 2020 2020 2020  axis=1 )..      
+0000ebf0: 2020 2020 2020 6172 6561 203d 206e 702e        area = np.
+0000ec00: 6164 6428 2061 7265 6154 6f70 2c61 7265  add( areaTop,are
+0000ec10: 6142 746d 290d 0a20 2020 2020 2020 2020  aBtm)..         
+0000ec20: 2020 2061 7665 4172 6561 203d 206e 702e     aveArea = np.
+0000ec30: 6176 6572 6167 6528 6172 6561 290d 0a20  average(area).. 
+0000ec40: 2020 2020 2020 2020 2020 206e 6f72 6d41             normA
+0000ec50: 7265 6120 3d20 6172 6561 2f61 7665 4172  rea = area/aveAr
+0000ec60: 6561 0d0a 2020 2020 2020 2020 2020 2020  ea..            
+0000ec70: 6620 3d20 3120 2320 7371 7561 7265 0d0a  f = 1 # square..
+0000ec80: 2020 2020 2020 2020 2020 2020 736b 6577              skew
+0000ec90: 203d 2066 2a61 7265 612f 286d 6178 7369   = f*area/(maxsi
+0000eca0: 7a65 732a 6d61 7873 697a 6573 290d 0a20  zes*maxsizes).. 
+0000ecb0: 2020 2020 2020 2023 202e 2e2e 2e2e 2e2e         # .......
+0000ecc0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e0d 0a20  ............... 
+0000ecd0: 2020 2020 2020 2072 6574 7572 6e20 5b6e         return [n
+0000ece0: 6f72 6d41 7265 612c 736b 6577 5d0d 0a20  ormArea,skew].. 
+0000ecf0: 2020 200d 0a20 2020 2064 6566 2074 7269     ..    def tri
+0000ed00: 616e 6775 6c61 7465 2873 656c 662c 2072  angulate(self, r
+0000ed10: 657a 3d30 2920 3a0d 0a20 2020 2020 2020  ez=0) :..       
+0000ed20: 2022 2222 0d0a 2020 2020 2020 2020 504c   """..        PL
+0000ed30: 414e 4152 2073 7562 6469 7669 7369 6f6e  ANAR subdivision
+0000ed40: 206f 6620 6561 6368 2066 6163 6520 696e   of each face in
+0000ed50: 746f 2074 7269 616e 6775 6c61 7220 6661  to triangular fa
+0000ed60: 6365 732e 0d0a 2020 2020 2020 2020 0d0a  ces...        ..
+0000ed70: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+0000ed80: 7273 0d0a 2020 2020 2020 2020 2d2d 2d2d  rs..        ----
+0000ed90: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
+0000eda0: 7265 7a20 3a20 696e 7465 6765 722c 206f  rez : integer, o
+0000edb0: 7074 696f 6e61 6c2c 2064 6566 6175 6c74  ptional, default
+0000edc0: 3a20 300d 0a20 2020 2020 2020 2020 2020  : 0..           
+0000edd0: 204e 756d 6265 7220 6f66 2072 6563 7572   Number of recur
+0000ede0: 7369 7665 2073 7562 6469 7669 7369 6f6e  sive subdivision
+0000edf0: 7320 6f66 2074 6865 2062 6173 6520 6661  s of the base fa
+0000ee00: 6365 730d 0a20 2020 2020 2020 2020 2020  ces..           
+0000ee10: 2069 6e74 6f20 7472 6961 6e67 756c 6172   into triangular
+0000ee20: 2066 6163 6573 2c20 666f 7572 2066 6163   faces, four fac
+0000ee30: 6573 2070 6572 2072 657a 2e0d 0a20 2020  es per rez...   
+0000ee40: 2020 2020 2020 2020 2052 657a 2076 616c           Rez val
+0000ee50: 7565 7320 7261 6e67 6520 6672 6f6d 2030  ues range from 0
+0000ee60: 2074 6f20 372e 0d0a 2020 2020 2020 2020   to 7...        
+0000ee70: 2020 2020 466f 7220 7375 7266 6163 6573      For surfaces
+0000ee80: 2077 6974 6820 3420 7665 7274 6963 6573   with 4 vertices
+0000ee90: 2070 6572 2066 6163 652c 2065 6163 6820   per face, each 
+0000eea0: 6661 6365 2069 7320 6669 7273 740d 0a20  face is first.. 
+0000eeb0: 2020 2020 2020 2020 2020 2073 7562 6469             subdi
+0000eec0: 7669 6465 6420 696e 746f 2074 776f 2066  vided into two f
+0000eed0: 6163 6573 2c20 7468 656e 2072 6563 7572  aces, then recur
+0000eee0: 7369 6f6e 2070 726f 6365 6564 732e 0d0a  sion proceeds...
+0000eef0: 2020 2020 2020 2020 2020 2020 466f 7220              For 
+0000ef00: 7375 7266 6163 6573 2077 6974 6820 3520  surfaces with 5 
+0000ef10: 7665 7274 6963 6573 2070 6572 2066 6163  vertices per fac
+0000ef20: 652c 2065 6163 6820 6661 6365 2069 7320  e, each face is 
+0000ef30: 6669 7273 740d 0a20 2020 2020 2020 2020  first..         
+0000ef40: 2020 2073 7562 6469 7669 6465 6420 696e     subdivided in
+0000ef50: 746f 2074 6872 6565 2066 6163 6573 2c20  to three faces, 
+0000ef60: 7468 656e 2072 6563 7572 7369 6f6e 2070  then recursion p
+0000ef70: 726f 6365 6564 732e 0d0a 2020 2020 2020  roceeds...      
+0000ef80: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+0000ef90: 5265 7475 726e 730d 0a20 2020 2020 2020  Returns..       
+0000efa0: 202d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020   -------..      
+0000efb0: 2020 7365 6c66 203a 2073 7572 6661 6365    self : surface
+0000efc0: 206f 626a 6563 740d 0a20 2020 2020 2020   object..       
+0000efd0: 200d 0a0d 0a20 2020 2020 2020 2022 2222   ....        """
+0000efe0: 0d0a 2020 2020 2020 2020 2320 2e2e 2e2e  ..        # ....
+0000eff0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0000f000: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0000f010: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0000f020: 2e2e 2e2e 2e2e 2e2e 2e0d 0a20 2020 2020  ...........     
+0000f030: 2020 2064 6566 206d 6964 5646 756e 2876     def midVFun(v
+0000f040: 6563 7441 2c20 7665 6374 4229 203a 0d0a  ectA, vectB) :..
+0000f050: 2020 2020 2020 2020 2020 2020 6d69 6420              mid 
+0000f060: 3d20 6e70 2e61 6464 2876 6563 7441 2c76  = np.add(vectA,v
+0000f070: 6563 7442 290d 0a20 2020 2020 2020 2020  ectB)..         
+0000f080: 2020 206d 6964 203d 206e 702e 6d75 6c74     mid = np.mult
+0000f090: 6970 6c79 2830 2e35 2c6d 6964 290d 0a20  iply(0.5,mid).. 
+0000f0a0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0000f0b0: 6e20 6d69 6420 2020 2020 2020 0d0a 2020  n mid       ..  
+0000f0c0: 2020 2020 2020 2320 2e2e 2e2e 2e2e 2e2e        # ........
+0000f0d0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0000f0e0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0000f0f0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0000f100: 2e2e 2e2e 2e0d 0a20 2020 2020 2020 200d  .......        .
+0000f110: 0a20 2020 2020 2020 2073 656c 662e 5f70  .        self._p
+0000f120: 6f73 7450 726f 635f 7375 7266 6163 6543  ostProc_surfaceC
+0000f130: 6f6c 6f72 7328 5472 7565 290d 0a0d 0a0d  olors(True).....
+0000f140: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+0000f150: 2e66 7649 6e64 6963 6573 2e73 6861 7065  .fvIndices.shape
+0000f160: 5b31 5d20 3e20 3320 3a0d 0a20 2020 2020  [1] > 3 :..     
+0000f170: 2020 2020 2020 2023 2069 6620 6e65 6564         # if need
+0000f180: 6564 2c20 6272 6561 6b20 6661 6365 7320  ed, break faces 
+0000f190: 696e 746f 2074 7269 616e 676c 6573 2062  into triangles b
+0000f1a0: 6566 6f72 6520 7072 6f63 6565 6469 6e67  efore proceeding
+0000f1b0: 2e2e 2e2e 0d0a 2020 2020 2020 2020 2020  ......          
+0000f1c0: 2020 7375 6244 6976 203d 2073 656c 662e    subDiv = self.
+0000f1d0: 6676 496e 6469 6365 732e 7368 6170 655b  fvIndices.shape[
+0000f1e0: 315d 202d 2032 0d0a 2020 2020 2020 2020  1] - 2..        
+0000f1f0: 2020 2020 7365 6c66 2e66 7649 6e64 6963      self.fvIndic
+0000f200: 6573 203d 2073 656c 662e 5f74 7269 616e  es = self._trian
+0000f210: 6775 6c61 7465 5f66 6163 6549 6e64 6963  gulate_faceIndic
+0000f220: 6573 2873 656c 662e 6676 496e 6469 6365  es(self.fvIndice
+0000f230: 7329 0d0a 0d0a 2020 2020 2020 2020 2020  s)....          
+0000f240: 2020 6e65 7746 6163 6543 6f6c 6f72 7320    newFaceColors 
+0000f250: 3d20 5b5d 0d0a 2020 2020 2020 2020 2020  = []..          
+0000f260: 2020 666f 7220 6643 6f6c 6f72 2069 6e20    for fColor in 
+0000f270: 7365 6c66 2e5f 6466 6163 6563 6f6c 6f72  self._dfacecolor
+0000f280: 7320 3a20 2023 2075 7064 6174 6520 666f  s :  # update fo
+0000f290: 7220 765f 312e 322e 300d 0a20 2020 2020  r v_1.2.0..     
+0000f2a0: 2020 2020 2020 2020 2020 206e 6577 4661             newFa
+0000f2b0: 6365 436f 6c6f 7273 202b 3d20 5b66 436f  ceColors += [fCo
+0000f2c0: 6c6f 725d 2a73 7562 4469 760d 0a20 2020  lor]*subDiv..   
+0000f2d0: 2020 2020 2020 2020 2073 656c 662e 7365           self.se
+0000f2e0: 745f 6661 6365 636f 6c6f 7228 206e 702e  t_facecolor( np.
+0000f2f0: 6172 7261 7928 6e65 7746 6163 6543 6f6c  array(newFaceCol
+0000f300: 6f72 7329 2029 0d0a 0d0a 2020 2020 2020  ors) )....      
+0000f310: 2020 696e 6465 784f 626a 202c 7665 7274    indexObj ,vert
+0000f320: 6578 436f 6f72 203d 2073 656c 662e 7472  exCoor = self.tr
+0000f330: 6961 6e67 756c 6174 6542 6173 6528 7265  iangulateBase(re
+0000f340: 7a2c 6c69 7374 2873 656c 662e 7665 7274  z,list(self.vert
+0000f350: 6578 436f 6f72 292c 7365 6c66 2e66 7649  exCoor),self.fvI
+0000f360: 6e64 6963 6573 2c20 6d69 6456 4675 6e29  ndices, midVFun)
+0000f370: 0d0a 0d0a 2020 2020 2020 2020 7365 6c66  ....        self
+0000f380: 2e66 7649 6e64 6963 6573 203d 2069 6e64  .fvIndices = ind
+0000f390: 6578 4f62 6a5b 2766 6163 6527 5d0d 0a20  exObj['face'].. 
+0000f3a0: 2020 2020 2020 2073 656c 662e 7665 7274         self.vert
+0000f3b0: 6578 436f 6f72 203d 2076 6572 7465 7843  exCoor = vertexC
+0000f3c0: 6f6f 720d 0a20 2020 2020 2020 2073 656c  oor..        sel
+0000f3d0: 662e 6576 496e 6469 6365 7320 3d20 7365  f.evIndices = se
+0000f3e0: 6c66 2e5f 6765 745f 6564 6765 735f 6672  lf._get_edges_fr
+0000f3f0: 6f6d 5f66 6163 6573 2873 656c 662e 6676  om_faces(self.fv
+0000f400: 496e 6469 6365 7329 0d0a 2020 2020 2020  Indices)..      
+0000f410: 2020 7365 6c66 2e76 6649 6e64 6963 6573    self.vfIndices
+0000f420: 4c69 7374 203d 2073 656c 662e 5f76 6572  List = self._ver
+0000f430: 7465 7843 6f6d 6d6f 6e46 6163 6549 6e64  texCommonFaceInd
+0000f440: 6963 6573 2829 0d0a 2020 2020 2020 2020  ices()..        
+0000f450: 7365 6c66 2e65 6649 6e64 6963 6573 4c69  self.efIndicesLi
+0000f460: 7374 203d 2073 656c 662e 5f65 6467 6543  st = self._edgeC
+0000f470: 6f6d 6d6f 6e46 6163 6549 6e64 6963 6573  ommonFaceIndices
+0000f480: 2829 0d0a 0d0a 2020 2020 2020 2020 7620  ()....        v 
+0000f490: 3d20 7365 6c66 2e76 6572 7465 7843 6f6f  = self.vertexCoo
+0000f4a0: 720d 0a20 2020 2020 2020 2076 6572 7473  r..        verts
+0000f4b0: 203d 2076 5b73 656c 662e 6676 496e 6469   = v[self.fvIndi
+0000f4c0: 6365 735d 0d0a 2020 2020 2020 2020 7365  ces]..        se
+0000f4d0: 6c66 2e73 6574 5f76 6572 7473 2820 7665  lf.set_verts( ve
+0000f4e0: 7274 7320 290d 0a20 2020 2020 2020 2073  rts )..        s
+0000f4f0: 656c 662e 5f73 6574 5f67 656f 6d65 7472  elf._set_geometr
+0000f500: 6963 5f62 6f75 6e64 7328 290d 0a0d 0a20  ic_bounds().... 
+0000f510: 2020 2020 2020 2069 6620 7265 7a20 213d         if rez !=
+0000f520: 2030 203a 0d0a 2020 2020 2020 2020 2020   0 :..          
+0000f530: 2020 6e65 7746 6163 6543 6f6c 6f72 7320    newFaceColors 
+0000f540: 3d20 5b5d 0d0a 2020 2020 2020 2020 2020  = []..          
+0000f550: 2020 7375 6244 6976 203d 2034 2a2a 7265    subDiv = 4**re
+0000f560: 7a0d 0a20 2020 2020 2020 2020 2020 2066  z..            f
+0000f570: 6f72 2066 436f 6c6f 7220 696e 2073 656c  or fColor in sel
+0000f580: 662e 5f64 6661 6365 636f 6c6f 7273 203a  f._dfacecolors :
+0000f590: 2020 2320 7570 6461 7465 2066 6f72 2076    # update for v
+0000f5a0: 5f31 2e32 2e30 0d0a 2020 2020 2020 2020  _1.2.0..        
+0000f5b0: 2020 2020 2020 2020 6e65 7746 6163 6543          newFaceC
+0000f5c0: 6f6c 6f72 7320 2b3d 205b 6643 6f6c 6f72  olors += [fColor
+0000f5d0: 5d2a 7375 6244 6976 0d0a 2020 2020 2020  ]*subDiv..      
+0000f5e0: 2020 2020 2020 7365 6c66 2e73 6574 5f66        self.set_f
+0000f5f0: 6163 6563 6f6c 6f72 2820 6e70 2e61 7272  acecolor( np.arr
+0000f600: 6179 286e 6577 4661 6365 436f 6c6f 7273  ay(newFaceColors
+0000f610: 2920 290d 0a0d 0a20 2020 2020 2020 2072  ) )....        r
+0000f620: 6574 7572 6e20 7365 6c66 2020 2020 2020  eturn self      
+0000f630: 2020 0d0a 0d0a 2020 2020 6465 6620 6e6f    ....    def no
+0000f640: 726d 616c 697a 655f 7363 616c 6528 7365  rmalize_scale(se
+0000f650: 6c66 2920 3a0d 0a20 2020 2020 2020 2022  lf) :..        "
+0000f660: 2222 5363 616c 696e 6720 6e6f 726d 616c  ""Scaling normal
+0000f670: 697a 6174 696f 6e20 6172 7261 7920 616e  ization array an
+0000f680: 6420 7265 6369 7072 6f63 616c 2e22 2222  d reciprocal."""
+0000f690: 0d0a 2020 2020 2020 2020 626f 756e 6473  ..        bounds
+0000f6a0: 203d 2073 656c 662e 626f 756e 6473 0d0a   = self.bounds..
+0000f6b0: 2020 2020 2020 2020 7363 5820 3d20 2820          scX = ( 
+0000f6c0: 626f 756e 6473 5b27 786c 696d 275d 5b31  bounds['xlim'][1
+0000f6d0: 5d20 2d20 626f 756e 6473 5b27 786c 696d  ] - bounds['xlim
+0000f6e0: 275d 5b30 5d20 2029 0d0a 2020 2020 2020  '][0]  )..      
+0000f6f0: 2020 7363 5920 3d20 2820 626f 756e 6473    scY = ( bounds
+0000f700: 5b27 796c 696d 275d 5b31 5d20 2d20 626f  ['ylim'][1] - bo
+0000f710: 756e 6473 5b27 796c 696d 275d 5b30 5d20  unds['ylim'][0] 
+0000f720: 2029 0d0a 2020 2020 2020 2020 7363 5a20   )..        scZ 
+0000f730: 3d20 2820 626f 756e 6473 5b27 7a6c 696d  = ( bounds['zlim
+0000f740: 275d 5b31 5d20 2d20 626f 756e 6473 5b27  '][1] - bounds['
+0000f750: 7a6c 696d 275d 5b30 5d20 2029 0d0a 2020  zlim'][0]  )..  
+0000f760: 2020 2020 2020 7265 6369 7020 3d20 5b73        recip = [s
+0000f770: 6358 2c73 6359 2c73 635a 5d0d 0a20 2020  cX,scY,scZ]..   
+0000f780: 2020 2020 2073 6361 6c65 203d 206e 702e       scale = np.
+0000f790: 7265 6369 7072 6f63 616c 2872 6563 6970  reciprocal(recip
+0000f7a0: 290d 0a20 2020 2020 2020 2072 6574 7572  )..        retur
+0000f7b0: 6e20 7363 616c 652c 2072 6563 6970 0d0a  n scale, recip..
+0000f7c0: 0d0a 2020 2020 6465 6620 7665 7274 6578  ..    def vertex
+0000f7d0: 6e6f 726d 616c 7328 7365 6c66 2c20 2a2a  normals(self, **
+0000f7e0: 6b61 7267 7329 203a 0d0a 2020 2020 2020  kargs) :..      
+0000f7f0: 2020 2222 220d 0a20 2020 2020 2020 2055    """..        U
+0000f800: 6e69 7420 6469 7265 6374 696f 6e73 206f  nit directions o
+0000f810: 7220 5665 6374 6f72 3344 436f 6c6c 6563  r Vector3DCollec
+0000f820: 7469 6f6e 206f 6620 7665 7274 6578 206e  tion of vertex n
+0000f830: 6f72 6d61 6c73 2061 7420 7665 7274 6963  ormals at vertic
+0000f840: 6573 2e0d 0a0d 0a20 2020 2020 2020 2050  es.....        P
+0000f850: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
+0000f860: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
+0000f870: 2020 2020 2020 2073 6361 6c65 3a20 6e75         scale: nu
+0000f880: 6d62 6572 2c20 6f70 7469 6f6e 616c 0d0a  mber, optional..
+0000f890: 2020 2020 2020 2020 2020 2020 4966 206e              If n
+0000f8a0: 6f74 2073 7065 6374 6966 6965 642c 2073  ot spectified, s
+0000f8b0: 6361 6c65 6420 7072 6f70 6f72 7469 6f6e  caled proportion
+0000f8c0: 616c 2074 6f20 7468 6520 6d65 616e 2065  al to the mean e
+0000f8d0: 6467 650d 0a20 2020 2020 2020 2020 2020  dge..           
+0000f8e0: 206c 656e 6774 6820 6f66 2073 7572 6661   length of surfa
+0000f8f0: 6365 2062 6173 6520 6661 6365 732e 0d0a  ce base faces...
+0000f900: 0d0a 2020 2020 2020 2020 7633 643a 2062  ..        v3d: b
+0000f910: 6f6f 6c65 616e 2c20 6f70 7469 6f6e 616c  oolean, optional
+0000f920: 2c20 6465 6661 756c 743a 2054 7275 650d  , default: True.
+0000f930: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
+0000f940: 5472 7565 2c20 5665 6374 6f72 3344 436f  True, Vector3DCo
+0000f950: 6c6c 6563 7469 6f6e 2069 7320 7265 7475  llection is retu
+0000f960: 726e 6564 2c20 656c 7365 2061 204e 2078  rned, else a N x
+0000f970: 2033 2061 7272 6179 0d0a 2020 2020 2020   3 array..      
+0000f980: 2020 2020 2020 6f66 2075 6e69 7420 7665        of unit ve
+0000f990: 6374 6f72 2076 6572 7465 7820 6e6f 726d  ctor vertex norm
+0000f9a0: 616c 7320 6973 2072 6574 7572 6e65 6420  als is returned 
+0000f9b0: 6966 2046 616c 7365 2e0d 0a0d 0a20 2020  if False.....   
+0000f9c0: 2020 2020 2063 6f6c 6f72 203a 2073 7472       color : str
+0000f9d0: 206f 7220 666c 6f61 7420 6c69 7374 206f   or float list o
+0000f9e0: 6620 6c65 6e67 7468 2033 206f 7220 342e  f length 3 or 4.
+0000f9f0: 0d0a 2020 2020 2020 2020 2020 2020 5247  ..            RG
+0000fa00: 4220 6f72 2052 4742 4120 636f 6c6f 722c  B or RGBA color,
+0000fa10: 2065 6974 6865 7220 6120 4d61 7470 6c6f   either a Matplo
+0000fa20: 746c 6962 2066 6f72 6d61 7420 7374 7269  tlib format stri
+0000fa30: 6e67 206f 7220 6120 0d0a 2020 2020 2020  ng or a ..      
+0000fa40: 2020 2020 2020 6c69 7374 206f 6620 636f        list of co
+0000fa50: 6c6f 7220 7661 6c75 6573 2069 6e20 7261  lor values in ra
+0000fa60: 6e67 6520 5b30 2c31 5d2e 0d0a 2020 2020  nge [0,1]...    
+0000fa70: 2020 2020 0d0a 2020 2020 2020 2020 7769      ..        wi
+0000fa80: 6474 6820 3a20 6e75 6d62 6572 2c20 6f70  dth : number, op
+0000fa90: 7469 6f6e 616c 2c20 6465 6661 756c 743a  tional, default:
+0000faa0: 2031 0d0a 2020 2020 2020 2020 2020 2020   1..            
+0000fab0: 4c69 6e65 2077 6964 7468 206f 6620 7468  Line width of th
+0000fac0: 6520 7665 6374 6f72 2e0d 0a0d 0a20 2020  e vector.....   
+0000fad0: 2020 2020 2061 6c72 203a 2073 6361 6c61       alr : scala
+0000fae0: 722c 206f 7074 696f 6e61 6c2c 2064 6566  r, optional, def
+0000faf0: 6175 6c74 3a20 302e 3235 0d0a 2020 2020  ault: 0.25..    
+0000fb00: 2020 2020 2020 2020 4178 6973 206c 656e          Axis len
+0000fb10: 6774 6820 7261 7469 6f2c 2068 6561 6420  gth ratio, head 
+0000fb20: 7369 7a65 2074 6f20 7665 6374 6f72 206d  size to vector m
+0000fb30: 6167 6e69 7475 6465 2e0d 0a0d 0a20 2020  agnitude.....   
+0000fb40: 2020 2020 2052 6574 7572 6e73 0d0a 2020       Returns..  
+0000fb50: 2020 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20        -------.. 
+0000fb60: 2020 2020 2020 2056 6563 746f 7233 4443         Vector3DC
+0000fb70: 6f6c 6c65 6374 696f 6e20 6f62 6a65 6374  ollection object
+0000fb80: 206f 7220 6172 7261 7920 6f66 2075 6e69   or array of uni
+0000fb90: 7420 6469 7265 6374 696f 6e20 7665 6374  t direction vect
+0000fba0: 6f72 730d 0a0d 0a20 2020 2020 2020 2022  ors....        "
+0000fbb0: 2222 0d0a 0d0a 2020 2020 2020 2020 6b61  ""....        ka
+0000fbc0: 7267 4466 7420 3d20 7b20 2773 6361 6c65  rgDft = { 'scale
+0000fbd0: 273a 7365 6c66 2e5f 6e6f 726d 616c 5f73  ':self._normal_s
+0000fbe0: 6361 6c65 2c20 2776 3364 273a 5472 7565  cale, 'v3d':True
+0000fbf0: 2c20 2763 6f6c 6f72 273a 4e6f 6e65 2c20  , 'color':None, 
+0000fc00: 2777 6964 7468 273a 312c 2027 616c 7227  'width':1, 'alr'
+0000fc10: 3a5f 4446 545f 414c 5220 207d 0d0a 2020  :_DFT_ALR  }..  
+0000fc20: 2020 2020 2020 4b57 203d 204b 5770 726f        KW = KWpro
+0000fc30: 6365 7373 6f72 286b 6172 6744 6674 2c27  cessor(kargDft,'
+0000fc40: 7665 6374 6f72 6669 656c 645f 6672 6f6d  vectorfield_from
+0000fc50: 5f6f 7027 2c2a 2a6b 6172 6773 290d 0a20  _op',**kargs).. 
+0000fc60: 2020 2020 2020 2073 6361 6c65 203d 204b         scale = K
+0000fc70: 572e 6765 7456 616c 2827 7363 616c 6527  W.getVal('scale'
+0000fc80: 290d 0a20 2020 2020 2020 2069 7356 3344  )..        isV3D
+0000fc90: 203d 204b 572e 6765 7456 616c 2827 7633   = KW.getVal('v3
+0000fca0: 6427 290d 0a20 2020 2020 2020 2063 6f6c  d')..        col
+0000fcb0: 6f72 203d 204b 572e 6765 7456 616c 2827  or = KW.getVal('
+0000fcc0: 636f 6c6f 7227 290d 0a20 2020 2020 2020  color')..       
+0000fcd0: 2077 6964 7468 203d 204b 572e 6765 7456   width = KW.getV
+0000fce0: 616c 2827 7769 6474 6827 290d 0a20 2020  al('width')..   
+0000fcf0: 2020 2020 2061 6c72 203d 204b 572e 6765       alr = KW.ge
+0000fd00: 7456 616c 2827 616c 7227 290d 0a0d 0a20  tVal('alr').... 
+0000fd10: 2020 2020 2020 2076 6572 7473 203d 2073         verts = s
+0000fd20: 656c 662e 7665 7274 6578 436f 6f72 0d0a  elf.vertexCoor..
+0000fd30: 2020 2020 2020 2020 6e6f 726d 7320 3d20          norms = 
+0000fd40: 7365 6c66 2e5f 6765 745f 7665 7274 6578  self._get_vertex
+0000fd50: 5f6e 6f72 6d61 6c73 2829 0d0a 2020 2020  _normals()..    
+0000fd60: 2020 2020 6966 206e 6f74 2069 7356 3344      if not isV3D
+0000fd70: 203a 2072 6574 7572 6e20 6e6f 726d 730d   : return norms.
+0000fd80: 0a20 2020 2020 2020 206e 616d 6520 3d20  .        name = 
+0000fd90: 2776 6572 7465 785f 6e6f 726d 616c 7327  'vertex_normals'
+0000fda0: 0d0a 2020 2020 2020 2020 6c63 6f6c 203d  ..        lcol =
+0000fdb0: 2056 6563 746f 7233 4443 6f6c 6c65 6374   Vector3DCollect
+0000fdc0: 696f 6e28 7665 7274 732c 6e6f 726d 732a  ion(verts,norms*
+0000fdd0: 7363 616c 652c 616c 722c 6e61 6d65 2c63  scale,alr,name,c
+0000fde0: 6f6c 6f72 733d 636f 6c6f 722c 206c 696e  olors=color, lin
+0000fdf0: 6577 6964 7468 733d 7769 6474 6829 0d0a  ewidths=width)..
+0000fe00: 2020 2020 2020 2020 6c63 6f6c 2e63 6f6f          lcol.coo
+0000fe10: 7254 7970 6520 3d20 7365 6c66 2e63 6f6f  rType = self.coo
+0000fe20: 7254 7970 650d 0a20 2020 2020 2020 206c  rType..        l
+0000fe30: 636f 6c2e 7576 774f 7269 656e 7461 7469  col.uvwOrientati
+0000fe40: 6f6e 5479 7065 203d 205f 434f 4f52 5359  onType = _COORSY
+0000fe50: 535b 2258 595a 225d 0d0a 2020 2020 2020  S["XYZ"]..      
+0000fe60: 2020 6966 2063 6f6c 6f72 2069 7320 4e6f    if color is No
+0000fe70: 6e65 203a 206c 636f 6c2e 5f73 6574 5f76  ne : lcol._set_v
+0000fe80: 6563 7443 6f6c 6f72 2820 7365 6c66 2e76  ectColor( self.v
+0000fe90: 6572 7465 7843 6f6c 6f72 2029 0d0a 2020  ertexColor )..  
+0000fea0: 2020 2020 2020 7265 7475 726e 206c 636f        return lco
+0000feb0: 6c0d 0a0d 0a20 2020 2064 6566 2066 6163  l....    def fac
+0000fec0: 656e 6f72 6d61 6c73 2873 656c 662c 202a  enormals(self, *
+0000fed0: 2a6b 6172 6773 2920 3a0d 0a20 2020 2020  *kargs) :..     
+0000fee0: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
+0000fef0: 556e 6974 2064 6972 6563 7469 6f6e 7320  Unit directions 
+0000ff00: 6f72 2056 6563 746f 7233 4443 6f6c 6c65  or Vector3DColle
+0000ff10: 6374 696f 6e20 6f66 2066 6163 6520 6e6f  ction of face no
+0000ff20: 726d 616c 7320 6174 2066 6163 6520 6365  rmals at face ce
+0000ff30: 6e74 6572 732e 0d0a 0d0a 2020 2020 2020  nters.....      
+0000ff40: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
+0000ff50: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+0000ff60: 0d0a 2020 2020 2020 2020 7363 616c 653a  ..        scale:
+0000ff70: 206e 756d 6265 722c 206f 7074 696f 6e61   number, optiona
+0000ff80: 6c0d 0a20 2020 2020 2020 2020 2020 2049  l..            I
+0000ff90: 6620 6e6f 7420 7370 6563 7469 6669 6564  f not spectified
+0000ffa0: 2c20 7363 616c 6564 2070 726f 706f 7274  , scaled proport
+0000ffb0: 696f 6e61 6c20 746f 2074 6865 206d 6561  ional to the mea
+0000ffc0: 6e20 6564 6765 0d0a 2020 2020 2020 2020  n edge..        
+0000ffd0: 2020 2020 6c65 6e67 7468 206f 6620 7375      length of su
+0000ffe0: 7266 6163 6520 6261 7365 2066 6163 6573  rface base faces
+0000fff0: 2e0d 0a0d 0a20 2020 2020 2020 2076 3364  .....        v3d
+00010000: 3a20 626f 6f6c 6561 6e2c 206f 7074 696f  : boolean, optio
+00010010: 6e61 6c2c 2064 6566 6175 6c74 3a20 5472  nal, default: Tr
+00010020: 7565 0d0a 2020 2020 2020 2020 2020 2020  ue..            
+00010030: 4966 2054 7275 652c 2056 6563 746f 7233  If True, Vector3
+00010040: 4443 6f6c 6c65 6374 696f 6e20 6973 2072  DCollection is r
+00010050: 6574 7572 6e65 642c 2065 6c73 6520 6120  eturned, else a 
+00010060: 4e20 7820 3320 6172 7261 790d 0a20 2020  N x 3 array..   
+00010070: 2020 2020 2020 2020 206f 6620 756e 6974           of unit
+00010080: 2076 6563 746f 7220 6661 6365 206e 6f72   vector face nor
+00010090: 6d61 6c73 2069 7320 7265 7475 726e 6564  mals is returned
+000100a0: 2069 6620 4661 6c73 652e 0d0a 0d0a 2020   if False.....  
+000100b0: 2020 2020 2020 636f 6c6f 7220 3a20 7374        color : st
+000100c0: 7220 6f72 2066 6c6f 6174 206c 6973 7420  r or float list 
+000100d0: 6f66 206c 656e 6774 6820 3320 6f72 2034  of length 3 or 4
+000100e0: 2e0d 0a20 2020 2020 2020 2020 2020 2052  ...            R
+000100f0: 4742 206f 7220 5247 4241 2063 6f6c 6f72  GB or RGBA color
+00010100: 2c20 6569 7468 6572 2061 204d 6174 706c  , either a Matpl
+00010110: 6f74 6c69 6220 666f 726d 6174 2073 7472  otlib format str
+00010120: 696e 6720 6f72 2061 200d 0a20 2020 2020  ing or a ..     
+00010130: 2020 2020 2020 206c 6973 7420 6f66 2063         list of c
+00010140: 6f6c 6f72 2076 616c 7565 7320 696e 2072  olor values in r
+00010150: 616e 6765 205b 302c 315d 2e0d 0a20 2020  ange [0,1]...   
+00010160: 2020 2020 200d 0a20 2020 2020 2020 2077       ..        w
+00010170: 6964 7468 203a 206e 756d 6265 722c 206f  idth : number, o
+00010180: 7074 696f 6e61 6c2c 2064 6566 6175 6c74  ptional, default
+00010190: 3a20 310d 0a20 2020 2020 2020 2020 2020  : 1..           
+000101a0: 204c 696e 6520 7769 6474 6820 6f66 2074   Line width of t
+000101b0: 6865 2076 6563 746f 722e 0d0a 0d0a 2020  he vector.....  
+000101c0: 2020 2020 2020 616c 7220 3a20 7363 616c        alr : scal
+000101d0: 6172 2c20 6f70 7469 6f6e 616c 2c20 6465  ar, optional, de
+000101e0: 6661 756c 743a 2030 2e32 350d 0a20 2020  fault: 0.25..   
+000101f0: 2020 2020 2020 2020 2041 7869 7320 6c65           Axis le
+00010200: 6e67 7468 2072 6174 696f 2c20 6865 6164  ngth ratio, head
+00010210: 2073 697a 6520 746f 2076 6563 746f 7220   size to vector 
+00010220: 6d61 676e 6974 7564 652e 0d0a 0d0a 2020  magnitude.....  
+00010230: 2020 2020 2020 5265 7475 726e 730d 0a20        Returns.. 
+00010240: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0d0a         -------..
+00010250: 2020 2020 2020 2020 5665 6374 6f72 3344          Vector3D
+00010260: 436f 6c6c 6563 7469 6f6e 206f 626a 6563  Collection objec
+00010270: 7420 6f72 2061 7272 6179 206f 6620 756e  t or array of un
+00010280: 6974 2064 6972 6563 7469 6f6e 2076 6563  it direction vec
+00010290: 746f 7273 0d0a 0d0a 2020 2020 2020 2020  tors....        
+000102a0: 2222 220d 0a20 2020 2020 2020 2023 4e6f  """..        #No
+000102b0: 7465 3a20 6465 6661 756c 7420 636f 6c6f  te: default colo
+000102c0: 723a 4e6f 6e65 2073 6f20 7468 6174 2063  r:None so that c
+000102d0: 616e 2075 7365 2061 7320 6120 666c 6167  an use as a flag
+000102e0: 2074 6f20 7573 6520 6661 6365 2063 6f6c   to use face col
+000102f0: 6f72 7320 6966 206e 6f74 2064 6566 696e  ors if not defin
+00010300: 6564 2e20 0d0a 2020 2020 2020 2020 6b61  ed. ..        ka
+00010310: 7267 4466 7420 3d20 7b20 2773 6361 6c65  rgDft = { 'scale
+00010320: 273a 7365 6c66 2e5f 6e6f 726d 616c 5f73  ':self._normal_s
+00010330: 6361 6c65 2c20 2776 3364 273a 5472 7565  cale, 'v3d':True
+00010340: 2c20 2763 6f6c 6f72 273a 4e6f 6e65 2c20  , 'color':None, 
+00010350: 2777 6964 7468 273a 312c 2027 616c 7227  'width':1, 'alr'
+00010360: 3a5f 4446 545f 414c 5220 207d 0d0a 2020  :_DFT_ALR  }..  
+00010370: 2020 2020 2020 4b57 203d 204b 5770 726f        KW = KWpro
+00010380: 6365 7373 6f72 286b 6172 6744 6674 2c27  cessor(kargDft,'
+00010390: 7665 6374 6f72 6669 656c 645f 6672 6f6d  vectorfield_from
+000103a0: 5f6f 7027 2c2a 2a6b 6172 6773 290d 0a20  _op',**kargs).. 
+000103b0: 2020 2020 2020 2073 6361 6c65 203d 204b         scale = K
+000103c0: 572e 6765 7456 616c 2827 7363 616c 6527  W.getVal('scale'
+000103d0: 290d 0a20 2020 2020 2020 2069 7356 3344  )..        isV3D
+000103e0: 203d 204b 572e 6765 7456 616c 2827 7633   = KW.getVal('v3
+000103f0: 6427 290d 0a20 2020 2020 2020 2063 6f6c  d')..        col
+00010400: 6f72 203d 204b 572e 6765 7456 616c 2827  or = KW.getVal('
+00010410: 636f 6c6f 7227 290d 0a20 2020 2020 2020  color')..       
+00010420: 2077 6964 7468 203d 204b 572e 6765 7456   width = KW.getV
+00010430: 616c 2827 7769 6474 6827 290d 0a20 2020  al('width')..   
+00010440: 2020 2020 2061 6c72 203d 204b 572e 6765       alr = KW.ge
+00010450: 7456 616c 2827 616c 7227 290d 0a0d 0a20  tVal('alr').... 
+00010460: 2020 2020 2020 2076 6572 7473 203d 2073         verts = s
+00010470: 656c 662e 7665 7274 6578 436f 6f72 5b20  elf.vertexCoor[ 
+00010480: 7365 6c66 2e66 7649 6e64 6963 6573 205d  self.fvIndices ]
+00010490: 0d0a 2020 2020 2020 2020 6661 6365 4365  ..        faceCe
+000104a0: 6e74 6572 436f 6f72 203d 2073 656c 662e  nterCoor = self.
+000104b0: 5f67 6574 5f66 6163 655f 6365 6e74 6572  _get_face_center
+000104c0: 7328 7665 7274 7329 0d0a 2020 2020 2020  s(verts)..      
+000104d0: 2020 6661 6365 4e6f 726d 616c 436f 6f72    faceNormalCoor
+000104e0: 203d 2073 656c 662e 5f67 6574 5f66 6163   = self._get_fac
+000104f0: 655f 6e6f 726d 616c 7328 7665 7274 7329  e_normals(verts)
+00010500: 0d0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
+00010510: 2069 7356 3344 203a 2072 6574 7572 6e20   isV3D : return 
+00010520: 6661 6365 4e6f 726d 616c 436f 6f72 0d0a  faceNormalCoor..
+00010530: 2020 2020 2020 2020 6e61 6d65 203d 2027          name = '
+00010540: 6661 6365 5f6e 6f72 6d61 6c73 270d 0a20  face_normals'.. 
+00010550: 2020 2020 2020 206c 636f 6c20 3d20 5665         lcol = Ve
+00010560: 6374 6f72 3344 436f 6c6c 6563 7469 6f6e  ctor3DCollection
+00010570: 2866 6163 6543 656e 7465 7243 6f6f 722c  (faceCenterCoor,
+00010580: 6661 6365 4e6f 726d 616c 436f 6f72 2a73  faceNormalCoor*s
+00010590: 6361 6c65 2c61 6c72 2c6e 616d 652c 636f  cale,alr,name,co
+000105a0: 6c6f 7273 3d63 6f6c 6f72 2c20 6c69 6e65  lors=color, line
+000105b0: 7769 6474 6873 3d77 6964 7468 290d 0a20  widths=width).. 
+000105c0: 2020 2020 2020 2023 202d 2d2d 2031 2e31         # --- 1.1
+000105d0: 206d 6f64 202d 2d2d 2d2d 2d2d 2d2d 2d2d   mod -----------
+000105e0: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
+000105f0: 2020 206c 636f 6c2e 636f 6f72 5479 7065     lcol.coorType
+00010600: 203d 2073 656c 662e 636f 6f72 5479 7065   = self.coorType
+00010610: 0d0a 2020 2020 2020 2020 6c63 6f6c 2e75  ..        lcol.u
+00010620: 7677 4f72 6965 6e74 6174 696f 6e54 7970  vwOrientationTyp
+00010630: 6520 3d20 5f43 4f4f 5253 5953 5b22 5859  e = _COORSYS["XY
+00010640: 5a22 5d0d 0a20 2020 2020 2020 2069 6620  Z"]..        if 
+00010650: 636f 6c6f 7220 6973 204e 6f6e 6520 3a20  color is None : 
+00010660: 6c63 6f6c 2e5f 7365 745f 7665 6374 436f  lcol._set_vectCo
+00010670: 6c6f 7228 7365 6c66 2e5f 6466 6163 6563  lor(self._dfacec
+00010680: 6f6c 6f72 7329 2020 2320 7570 6461 7465  olors)  # update
+00010690: 2066 6f72 2076 5f31 2e32 2e30 0d0a 2020   for v_1.2.0..  
+000106a0: 2020 2020 2020 7265 7475 726e 206c 636f        return lco
+000106b0: 6c0d 0a0d 0a20 2020 2064 6566 2064 6973  l....    def dis
+000106c0: 7066 6965 6c64 5f66 726f 6d5f 6f70 2873  pfield_from_op(s
+000106d0: 656c 662c 206f 7065 7261 7469 6f6e 2c20  elf, operation, 
+000106e0: 2a2a 6b61 7267 7329 203a 0d0a 2020 2020  **kargs) :..    
+000106f0: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
+00010700: 2056 6563 746f 7233 4443 6f6c 6c65 6374   Vector3DCollect
+00010710: 696f 6e20 6f66 2064 6973 706c 6163 656d  ion of displacem
+00010720: 656e 7420 6f66 2076 6572 7469 6365 7320  ent of vertices 
+00010730: 746f 2061 2064 6966 6665 7265 6e74 2070  to a different p
+00010740: 6f73 6974 696f 6e2e 0d0a 0d0a 2020 2020  osition.....    
+00010750: 2020 2020 5061 7261 6d65 7465 7273 0d0a      Parameters..
+00010760: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00010770: 2d2d 0d0a 2020 2020 2020 2020 6f70 6572  --..        oper
+00010780: 6174 696f 6e20 3a20 6675 6e63 7469 6f6e  ation : function
+00010790: 206f 626a 6563 740d 0a20 2020 2020 2020   object..       
+000107a0: 2020 2020 2046 756e 6374 696f 6e20 7468       Function th
+000107b0: 6174 2074 616b 6573 206f 6e65 2063 6f6f  at takes one coo
+000107c0: 7264 696e 6174 650d 0a20 2020 2020 2020  rdinate..       
+000107d0: 2020 2020 2061 7267 756d 656e 742c 2061       argument, a
+000107e0: 2033 784e 204e 756d 7079 2061 7272 6179   3xN Numpy array
+000107f0: 2e0d 0a20 2020 2020 2020 2020 2020 2054  ...            T
+00010800: 6865 2066 756e 6374 696f 6e20 7265 7475  he function retu
+00010810: 726e 7320 6120 3378 4e20 6172 7261 7920  rns a 3xN array 
+00010820: 6f66 2076 6563 746f 7273 2e0d 0a20 2020  of vectors...   
+00010830: 2020 2020 200d 0a20 2020 2020 2020 2072       ..        r
+00010840: 6574 7572 6e78 797a 203a 2062 6f6f 6c20  eturnxyz : bool 
+00010850: 7b20 5472 7565 2c20 4661 6c73 6520 7d2c  { True, False },
+00010860: 206f 7074 696f 6e61 6c2c 2064 6566 6175   optional, defau
+00010870: 6c74 3a20 4661 6c73 650d 0a20 2020 2020  lt: False..     
+00010880: 2020 2020 2020 2042 7920 6465 6661 756c         By defaul
+00010890: 742c 206e 6174 6976 6520 636f 6f72 6469  t, native coordi
+000108a0: 6e61 7465 7320 6172 6520 7265 7475 726e  nates are return
+000108b0: 6564 2062 7920 7468 650d 0a20 2020 2020  ed by the..     
+000108c0: 2020 2020 2020 206f 7065 7261 7469 6f6e         operation
+000108d0: 2066 756e 6374 696f 6e2e 2020 4966 2073   function.  If s
+000108e0: 6574 2054 7275 652c 2074 6865 206f 7065  et True, the ope
+000108f0: 7261 7469 6f6e 0d0a 2020 2020 2020 2020  ration..        
+00010900: 2020 2020 7265 7475 726e 7320 7879 7a20      returns xyz 
+00010910: 4361 7274 6573 6961 6e20 636f 6f72 6469  Cartesian coordi
+00010920: 6e61 7465 732e 0d0a 0d0a 2020 2020 2020  nates.....      
+00010930: 2020 7573 6542 6173 6520 3a20 626f 6f6c    useBase : bool
+00010940: 207b 2054 7275 652c 2046 616c 7365 207d   { True, False }
+00010950: 2c20 6f70 7469 6f6e 616c 2c20 6465 6661  , optional, defa
+00010960: 756c 743a 2046 616c 7365 0d0a 2020 2020  ult: False..    
+00010970: 2020 2020 2020 2020 5768 656e 2073 6574          When set
+00010980: 2046 616c 7365 2c20 7665 7274 6963 6573   False, vertices
+00010990: 206f 6620 7468 6520 7375 7266 6163 652c   of the surface,
+000109a0: 2070 7269 6f72 2074 6f0d 0a20 2020 2020   prior to..     
+000109b0: 2020 2020 2020 2061 6e79 2067 656f 6d65         any geome
+000109c0: 7472 6963 206d 6170 7069 6e67 206f 7220  tric mapping or 
+000109d0: 7472 616e 7366 6f72 6d73 2c20 6172 6520  transforms, are 
+000109e0: 7061 7373 6564 2074 6f0d 0a20 2020 2020  passed to..     
+000109f0: 2020 2020 2020 2074 6865 206f 7065 7261         the opera
+00010a00: 7469 6f6e 2066 756e 6374 696f 6e2e 2020  tion function.  
+00010a10: 4f74 6865 7277 6973 652c 2077 6865 6e20  Otherwise, when 
+00010a20: 5472 7565 2c20 7468 650d 0a20 2020 2020  True, the..     
+00010a30: 2020 2020 2020 2063 7572 7265 6e74 2073         current s
+00010a40: 7572 6661 6365 2076 6572 7469 6365 7320  urface vertices 
+00010a50: 6172 6520 7061 7373 6564 2e0d 0a0d 0a20  are passed..... 
+00010a60: 2020 2020 2020 2073 6361 6c65 3a20 6e75         scale: nu
+00010a70: 6d62 6572 2c20 6f70 7469 6f6e 616c 2c20  mber, optional, 
+00010a80: 6465 6661 756c 743a 2031 2e0d 0a0d 0a20  default: 1..... 
+00010a90: 2020 2020 2020 2063 6f6c 6f72 203a 2073         color : s
+00010aa0: 7472 206f 7220 666c 6f61 7420 6c69 7374  tr or float list
+00010ab0: 206f 6620 6c65 6e67 7468 2033 206f 7220   of length 3 or 
+00010ac0: 342e 0d0a 2020 2020 2020 2020 2020 2020  4...            
+00010ad0: 5247 4220 6f72 2052 4742 4120 636f 6c6f  RGB or RGBA colo
+00010ae0: 722c 2065 6974 6865 7220 6120 4d61 7470  r, either a Matp
+00010af0: 6c6f 746c 6962 2066 6f72 6d61 7420 7374  lotlib format st
+00010b00: 7269 6e67 206f 7220 6120 0d0a 2020 2020  ring or a ..    
+00010b10: 2020 2020 2020 2020 6c69 7374 206f 6620          list of 
+00010b20: 636f 6c6f 7220 7661 6c75 6573 2069 6e20  color values in 
+00010b30: 7261 6e67 6520 5b30 2c31 5d2e 0d0a 2020  range [0,1]...  
+00010b40: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00010b50: 7769 6474 6820 3a20 6e75 6d62 6572 2c20  width : number, 
+00010b60: 6f70 7469 6f6e 616c 2c20 6465 6661 756c  optional, defaul
+00010b70: 743a 2031 0d0a 2020 2020 2020 2020 2020  t: 1..          
+00010b80: 2020 4c69 6e65 2077 6964 7468 206f 6620    Line width of 
+00010b90: 7468 6520 7665 6374 6f72 2e0d 0a0d 0a20  the vector..... 
+00010ba0: 2020 2020 2020 2061 6c72 203a 2073 6361         alr : sca
+00010bb0: 6c61 722c 206f 7074 696f 6e61 6c2c 2064  lar, optional, d
+00010bc0: 6566 6175 6c74 3a20 302e 3235 0d0a 2020  efault: 0.25..  
+00010bd0: 2020 2020 2020 2020 2020 4178 6973 206c            Axis l
+00010be0: 656e 6774 6820 7261 7469 6f2c 2068 6561  ength ratio, hea
+00010bf0: 6420 7369 7a65 2074 6f20 7665 6374 6f72  d size to vector
+00010c00: 206d 6167 6e69 7475 6465 2e0d 0a0d 0a20   magnitude..... 
+00010c10: 2020 2020 2020 2052 6574 7572 6e73 0d0a         Returns..
+00010c20: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0d          -------.
+00010c30: 0a20 2020 2020 2020 2056 6563 746f 7233  .        Vector3
+00010c40: 4443 6f6c 6c65 6374 696f 6e20 6f62 6a65  DCollection obje
+00010c50: 6374 0d0a 0d0a 2020 2020 2020 2020 2222  ct....        ""
+00010c60: 220d 0a0d 0a20 2020 2020 2020 206b 6172  "....        kar
+00010c70: 6744 6674 203d 207b 2027 7265 7475 726e  gDft = { 'return
+00010c80: 7879 7a27 3a46 616c 7365 2c20 2775 7365  xyz':False, 'use
+00010c90: 4261 7365 273a 4661 6c73 652c 200d 0a20  Base':False, .. 
+00010ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010cb0: 2020 2027 7363 616c 6527 3a31 2c20 2763     'scale':1, 'c
+00010cc0: 6f6c 6f72 273a 2762 6c61 636b 272c 2027  olor':'black', '
+00010cd0: 7769 6474 6827 3a31 2c20 2761 6c72 273a  width':1, 'alr':
+00010ce0: 5f44 4654 5f41 4c52 2020 7d0d 0a20 2020  _DFT_ALR  }..   
+00010cf0: 2020 2020 204b 5720 3d20 4b57 7072 6f63       KW = KWproc
+00010d00: 6573 736f 7228 6b61 7267 4466 742c 2764  essor(kargDft,'d
+00010d10: 6973 7066 6965 6c64 5f66 726f 6d5f 6f70  ispfield_from_op
+00010d20: 272c 2a2a 6b61 7267 7329 0d0a 2020 2020  ',**kargs)..    
+00010d30: 2020 2020 7265 7475 726e 7879 7a20 3d20      returnxyz = 
+00010d40: 4b57 2e67 6574 5661 6c28 2772 6574 7572  KW.getVal('retur
+00010d50: 6e78 797a 2729 0d0a 2020 2020 2020 2020  nxyz')..        
+00010d60: 7573 6542 6173 6520 3d20 4b57 2e67 6574  useBase = KW.get
+00010d70: 5661 6c28 2775 7365 4261 7365 2729 0d0a  Val('useBase')..
+00010d80: 2020 2020 2020 2020 7363 616c 6520 3d20          scale = 
+00010d90: 4b57 2e67 6574 5661 6c28 2773 6361 6c65  KW.getVal('scale
+00010da0: 2729 0d0a 2020 2020 2020 2020 636f 6c6f  ')..        colo
+00010db0: 7220 3d20 4b57 2e67 6574 5661 6c28 2763  r = KW.getVal('c
+00010dc0: 6f6c 6f72 2729 0d0a 2020 2020 2020 2020  olor')..        
+00010dd0: 7769 6474 6820 3d20 4b57 2e67 6574 5661  width = KW.getVa
+00010de0: 6c28 2777 6964 7468 2729 0d0a 2020 2020  l('width')..    
+00010df0: 2020 2020 616c 7220 3d20 4b57 2e67 6574      alr = KW.get
+00010e00: 5661 6c28 2761 6c72 2729 0d0a 0d0a 2020  Val('alr')....  
+00010e10: 2020 2020 2020 6966 2073 656c 662e 5f69        if self._i
+00010e20: 7343 6f6d 706f 7369 7465 5375 7266 6163  sCompositeSurfac
+00010e30: 6520 3a0d 0a20 2020 2020 2020 2020 2020  e :..           
+00010e40: 2077 6172 6e69 6e67 732e 7761 726e 2827   warnings.warn('
+00010e50: 5665 6374 6f72 206f 7065 7261 7469 6f6e  Vector operation
+00010e60: 206e 6f74 2061 7661 696c 6162 6c65 2066   not available f
+00010e70: 6f72 2063 6f6d 6269 6e65 6420 7368 6170  or combined shap
+00010e80: 6573 2e27 290d 0a20 2020 2020 2020 2020  es.')..         
+00010e90: 2020 2072 6574 7572 6e0d 0a20 2020 2020     return..     
+00010ea0: 2020 2073 7461 7274 5f63 6f6f 7220 3d20     start_coor = 
+00010eb0: 7365 6c66 2e76 6572 7465 7843 6f6f 720d  self.vertexCoor.
+00010ec0: 0a20 2020 2020 2020 2069 6620 7573 6542  .        if useB
+00010ed0: 6173 6520 3a20 7374 6172 745f 636f 6f72  ase : start_coor
+00010ee0: 203d 2073 656c 662e 6261 7365 5665 7274   = self.baseVert
+00010ef0: 6578 436f 6f72 0d0a 2020 2020 2020 2020  exCoor..        
+00010f00: 7620 3d20 7365 6c66 2e5f 7472 616e 7366  v = self._transf
+00010f10: 6f72 6d56 6563 746f 7228 7374 6172 745f  ormVector(start_
+00010f20: 636f 6f72 2c20 6f70 6572 6174 696f 6e2c  coor, operation,
+00010f30: 2072 6574 7572 6e78 797a 290d 0a20 2020   returnxyz)..   
+00010f40: 2020 2020 2064 656c 7461 203d 2076 202d       delta = v -
+00010f50: 2073 656c 662e 7665 7274 6578 436f 6f72   self.vertexCoor
+00010f60: 0d0a 2020 2020 2020 2020 6465 6c74 6120  ..        delta 
+00010f70: 3d20 7363 616c 652a 6465 6c74 610d 0a20  = scale*delta.. 
+00010f80: 2020 2020 2020 2023 202d 2d2d 2031 2e31         # --- 1.1
+00010f90: 206d 6f64 202d 2d2d 2d2d 2d2d 2d2d 2d2d   mod -----------
+00010fa0: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
+00010fb0: 2020 2076 4669 656c 6420 3d20 7365 6c66     vField = self
+00010fc0: 2e5f 6765 745f 7665 6374 6f72 6669 656c  ._get_vectorfiel
+00010fd0: 645f 4c69 6e65 3344 436f 6c6c 6563 7469  d_Line3DCollecti
+00010fe0: 6f6e 2864 656c 7461 2c20 636f 6c6f 722c  on(delta, color,
+00010ff0: 2077 6964 7468 2c20 616c 7229 0d0a 2020   width, alr)..  
+00011000: 2020 2020 2020 6966 2072 6574 7572 6e78        if returnx
+00011010: 797a 203a 2076 4669 656c 642e 7576 774f  yz : vField.uvwO
+00011020: 7269 656e 7461 7469 6f6e 5479 7065 203d  rientationType =
+00011030: 205f 434f 4f52 5359 535b 2258 595a 225d   _COORSYS["XYZ"]
+00011040: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00011050: 2076 4669 656c 640d 0a0d 0a20 2020 2064   vField....    d
+00011060: 6566 2076 6563 746f 7266 6965 6c64 5f66  ef vectorfield_f
+00011070: 726f 6d5f 6f70 2873 656c 662c 206f 7065  rom_op(self, ope
+00011080: 7261 7469 6f6e 2c20 2a2a 6b61 7267 7329  ration, **kargs)
+00011090: 203a 0d0a 2020 2020 2020 2020 2222 220d   :..        """.
+000110a0: 0a20 2020 2020 2020 2056 6563 746f 7233  .        Vector3
+000110b0: 4443 6f6c 6c65 6374 696f 6e20 6f66 2076  DCollection of v
+000110c0: 6563 746f 7273 2069 6e20 752c 762c 7720  ectors in u,v,w 
+000110d0: 636f 6f72 6469 6e61 7465 7320 6174 2073  coordinates at s
+000110e0: 7572 6661 6365 2076 6572 7469 6365 732e  urface vertices.
+000110f0: 0d0a 0d0a 2020 2020 2020 2020 5061 7261  ....        Para
+00011100: 6d65 7465 7273 0d0a 2020 2020 2020 2020  meters..        
+00011110: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
+00011120: 2020 2020 6f70 6572 6174 696f 6e20 3a20      operation : 
+00011130: 6675 6e63 7469 6f6e 206f 626a 6563 740d  function object.
+00011140: 0a20 2020 2020 2020 2020 2020 2046 756e  .            Fun
+00011150: 6374 696f 6e20 7468 6174 2074 616b 6573  ction that takes
+00011160: 206f 6e65 2063 6f6f 7264 696e 6174 650d   one coordinate.
+00011170: 0a20 2020 2020 2020 2020 2020 2061 7267  .            arg
+00011180: 756d 656e 742c 2061 2033 784e 204e 756d  ument, a 3xN Num
+00011190: 7079 2061 7272 6179 206f 6620 6e61 7469  py array of nati
+000111a0: 7665 2063 6f6f 7264 696e 6174 6573 2e0d  ve coordinates..
+000111b0: 0a20 2020 2020 2020 2020 2020 2054 6865  .            The
+000111c0: 2066 756e 6374 696f 6e20 7265 7475 726e   function return
+000111d0: 7320 6120 3378 4e20 6172 7261 7920 6f66  s a 3xN array of
+000111e0: 2076 6563 746f 7273 2e0d 0a20 2020 2020   vectors...     
+000111f0: 2020 200d 0a20 2020 2020 2020 2073 6361     ..        sca
+00011200: 6c65 3a20 6e75 6d62 6572 2c20 6f70 7469  le: number, opti
+00011210: 6f6e 616c 2c20 6465 6661 756c 743a 2031  onal, default: 1
+00011220: 2e0d 0a0d 0a20 2020 2020 2020 2063 6f6c  .....        col
+00011230: 6f72 203a 2073 7472 206f 7220 666c 6f61  or : str or floa
+00011240: 7420 6c69 7374 206f 6620 6c65 6e67 7468  t list of length
+00011250: 2033 206f 7220 342e 0d0a 2020 2020 2020   3 or 4...      
+00011260: 2020 2020 2020 5247 4220 6f72 2052 4742        RGB or RGB
+00011270: 4120 636f 6c6f 722c 2065 6974 6865 7220  A color, either 
+00011280: 6120 4d61 7470 6c6f 746c 6962 2066 6f72  a Matplotlib for
+00011290: 6d61 7420 7374 7269 6e67 206f 7220 6120  mat string or a 
+000112a0: 0d0a 2020 2020 2020 2020 2020 2020 6c69  ..            li
+000112b0: 7374 206f 6620 636f 6c6f 7220 7661 6c75  st of color valu
+000112c0: 6573 2069 6e20 7261 6e67 6520 5b30 2c31  es in range [0,1
+000112d0: 5d2e 0d0a 2020 2020 2020 2020 0d0a 2020  ]...        ..  
+000112e0: 2020 2020 2020 7769 6474 6820 3a20 6e75        width : nu
+000112f0: 6d62 6572 2c20 6f70 7469 6f6e 616c 2c20  mber, optional, 
+00011300: 6465 6661 756c 743a 2031 0d0a 2020 2020  default: 1..    
+00011310: 2020 2020 2020 2020 4c69 6e65 2077 6964          Line wid
+00011320: 7468 206f 6620 7468 6520 7665 6374 6f72  th of the vector
+00011330: 2e0d 0a0d 0a20 2020 2020 2020 2061 6c72  .....        alr
+00011340: 203a 2073 6361 6c61 722c 206f 7074 696f   : scalar, optio
+00011350: 6e61 6c2c 2064 6566 6175 6c74 3a20 302e  nal, default: 0.
+00011360: 3235 0d0a 2020 2020 2020 2020 2020 2020  25..            
+00011370: 4178 6973 206c 656e 6774 6820 7261 7469  Axis length rati
+00011380: 6f2c 2068 6561 6420 7369 7a65 2074 6f20  o, head size to 
+00011390: 7665 6374 6f72 206d 6167 6e69 7475 6465  vector magnitude
+000113a0: 2e0d 0a0d 0a20 2020 2020 2020 2052 6574  .....        Ret
+000113b0: 7572 6e73 0d0a 2020 2020 2020 2020 2d2d  urns..        --
+000113c0: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2056  -----..        V
+000113d0: 6563 746f 7233 4443 6f6c 6c65 6374 696f  ector3DCollectio
+000113e0: 6e20 6f62 6a65 6374 0d0a 0d0a 2020 2020  n object....    
+000113f0: 2020 2020 2222 220d 0a0d 0a20 2020 2020      """....     
+00011400: 2020 206b 6172 6744 6674 203d 207b 2027     kargDft = { '
+00011410: 7363 616c 6527 3a31 2c20 2763 6f6c 6f72  scale':1, 'color
+00011420: 273a 2762 6c61 636b 272c 2027 7769 6474  ':'black', 'widt
+00011430: 6827 3a31 2c20 2761 6c72 273a 5f44 4654  h':1, 'alr':_DFT
+00011440: 5f41 4c52 2020 7d0d 0a20 2020 2020 2020  _ALR  }..       
+00011450: 204b 5720 3d20 4b57 7072 6f63 6573 736f   KW = KWprocesso
+00011460: 7228 6b61 7267 4466 742c 2776 6563 746f  r(kargDft,'vecto
+00011470: 7266 6965 6c64 5f66 726f 6d5f 6f70 272c  rfield_from_op',
+00011480: 2a2a 6b61 7267 7329 0d0a 2020 2020 2020  **kargs)..      
+00011490: 2020 7363 616c 6520 3d20 4b57 2e67 6574    scale = KW.get
+000114a0: 5661 6c28 2773 6361 6c65 2729 0d0a 2020  Val('scale')..  
+000114b0: 2020 2020 2020 636f 6c6f 7220 3d20 4b57        color = KW
+000114c0: 2e67 6574 5661 6c28 2763 6f6c 6f72 2729  .getVal('color')
+000114d0: 0d0a 2020 2020 2020 2020 7769 6474 6820  ..        width 
+000114e0: 3d20 4b57 2e67 6574 5661 6c28 2777 6964  = KW.getVal('wid
+000114f0: 7468 2729 0d0a 2020 2020 2020 2020 616c  th')..        al
+00011500: 7220 3d20 4b57 2e67 6574 5661 6c28 2761  r = KW.getVal('a
+00011510: 6c72 2729 0d0a 0d0a 2020 2020 2020 2020  lr')....        
+00011520: 6966 2073 656c 662e 5f69 7343 6f6d 706f  if self._isCompo
+00011530: 7369 7465 5375 7266 6163 6520 3a0d 0a20  siteSurface :.. 
+00011540: 2020 2020 2020 2020 2020 2077 6172 6e69             warni
+00011550: 6e67 732e 7761 726e 2827 5665 6374 6f72  ngs.warn('Vector
+00011560: 206f 7065 7261 7469 6f6e 206e 6f74 2061   operation not a
+00011570: 7661 696c 6162 6c65 2066 6f72 2063 6f6d  vailable for com
+00011580: 6269 6e65 6420 7368 6170 6573 2e27 290d  bined shapes.').
+00011590: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+000115a0: 7572 6e0d 0a0d 0a20 2020 2020 2020 2078  urn....        x
+000115b0: 797a 203d 206e 702e 7472 616e 7370 6f73  yz = np.transpos
+000115c0: 6528 7365 6c66 2e76 6572 7465 7843 6f6f  e(self.vertexCoo
+000115d0: 7229 0d0a 2020 2020 2020 2020 6162 6320  r)..        abc 
+000115e0: 3d20 7365 6c66 2e63 6f6f 725f 636f 6e76  = self.coor_conv
+000115f0: 6572 7428 7879 7a29 0d0a 2020 2020 2020  ert(xyz)..      
+00011600: 2020 6162 6320 3d20 6e70 2e61 7272 6179    abc = np.array
+00011610: 2861 6263 290d 0a20 2020 2020 2020 2072  (abc)..        r
+00011620: 7374 203d 206e 702e 6172 7261 7928 6f70  st = np.array(op
+00011630: 6572 6174 696f 6e28 6162 6329 290d 0a20  eration(abc)).. 
+00011640: 2020 2020 2020 2072 7374 203d 2073 6361         rst = sca
+00011650: 6c65 2a72 7374 0d0a 2020 2020 2020 2020  le*rst..        
+00011660: 6465 6c74 6120 3d20 7365 6c66 2e5f 7576  delta = self._uv
+00011670: 775f 746f 5f78 797a 2872 7374 2c61 6263  w_to_xyz(rst,abc
+00011680: 290d 0a20 2020 2020 2020 2023 202d 2d2d  )..        # ---
+00011690: 2031 2e31 206d 6f64 202d 2d2d 2d2d 2d2d   1.1 mod -------
+000116a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20  -------------.. 
+000116b0: 2020 2020 2020 2064 656c 7461 203d 206e         delta = n
+000116c0: 702e 6172 7261 7928 6465 6c74 6129 0d0a  p.array(delta)..
+000116d0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+000116e0: 656c 662e 5f67 6574 5f76 6563 746f 7266  elf._get_vectorf
+000116f0: 6965 6c64 5f4c 696e 6533 4443 6f6c 6c65  ield_Line3DColle
+00011700: 6374 696f 6e28 6465 6c74 612c 2063 6f6c  ction(delta, col
+00011710: 6f72 2c20 7769 6474 682c 2061 6c72 290d  or, width, alr).
+00011720: 0a0d 0a20 2020 2064 6566 2076 6563 746f  ...    def vecto
+00011730: 7266 6965 6c64 5f74 6f5f 7375 7266 6163  rfield_to_surfac
+00011740: 6528 7365 6c66 2c20 7375 7266 6163 652c  e(self, surface,
+00011750: 202a 2a6b 6172 6773 2920 3a0d 0a20 2020   **kargs) :..   
+00011760: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
+00011770: 2020 5665 6374 6f72 3344 436f 6c6c 6563    Vector3DCollec
+00011780: 7469 6f6e 206f 6620 7665 6374 6f72 7320  tion of vectors 
+00011790: 6672 6f6d 2073 7572 6661 6365 2074 6f20  from surface to 
+000117a0: 7375 7266 6163 6520 7665 7274 6578 2063  surface vertex c
+000117b0: 6f6f 7264 696e 6174 6573 2e0d 0a0d 0a20  oordinates..... 
+000117c0: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+000117d0: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+000117e0: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2073  -----..        s
+000117f0: 7572 6661 6365 203a 2073 7572 6661 6365  urface : surface
+00011800: 206f 626a 6563 740d 0a20 2020 2020 2020   object..       
+00011810: 2020 2020 2053 7572 6661 6365 2074 6861       Surface tha
+00011820: 7420 6d61 7463 6865 7320 7468 6520 6361  t matches the ca
+00011830: 6c6c 696e 6720 7375 7266 6163 6520 7665  lling surface ve
+00011840: 6374 6f72 732e 0d0a 2020 2020 2020 2020  ctors...        
+00011850: 2020 2020 5368 6f75 6c64 2062 6520 7468      Should be th
+00011860: 6520 7361 6d65 2062 6173 6574 7970 6520  e same basetype 
+00011870: 616e 6420 7265 7a20 666f 7220 7375 7266  and rez for surf
+00011880: 6163 6520 7375 6263 6c61 7373 6573 2e0d  ace subclasses..
+00011890: 0a0d 0a20 2020 2020 2020 2073 6361 6c65  ...        scale
+000118a0: 3a20 6e75 6d62 6572 2c20 6f70 7469 6f6e  : number, option
+000118b0: 616c 2c20 6465 6661 756c 743a 2031 2e0d  al, default: 1..
+000118c0: 0a0d 0a20 2020 2020 2020 2063 6f6c 6f72  ...        color
+000118d0: 203a 2073 7472 206f 7220 666c 6f61 7420   : str or float 
+000118e0: 6c69 7374 206f 6620 6c65 6e67 7468 2033  list of length 3
+000118f0: 206f 7220 342e 0d0a 2020 2020 2020 2020   or 4...        
+00011900: 2020 2020 5247 4220 6f72 2052 4742 4120      RGB or RGBA 
+00011910: 636f 6c6f 722c 2065 6974 6865 7220 6120  color, either a 
+00011920: 4d61 7470 6c6f 746c 6962 2066 6f72 6d61  Matplotlib forma
+00011930: 7420 7374 7269 6e67 206f 7220 6120 0d0a  t string or a ..
+00011940: 2020 2020 2020 2020 2020 2020 6c69 7374              list
+00011950: 206f 6620 636f 6c6f 7220 7661 6c75 6573   of color values
+00011960: 2069 6e20 7261 6e67 6520 5b30 2c31 5d2e   in range [0,1].
+00011970: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+00011980: 2020 2020 7769 6474 6820 3a20 6e75 6d62      width : numb
+00011990: 6572 2c20 6f70 7469 6f6e 616c 2c20 6465  er, optional, de
+000119a0: 6661 756c 743a 2031 0d0a 2020 2020 2020  fault: 1..      
+000119b0: 2020 2020 2020 4c69 6e65 2077 6964 7468        Line width
+000119c0: 206f 6620 7468 6520 7665 6374 6f72 2e0d   of the vector..
+000119d0: 0a0d 0a20 2020 2020 2020 2061 6c72 203a  ...        alr :
+000119e0: 2073 6361 6c61 722c 206f 7074 696f 6e61   scalar, optiona
+000119f0: 6c2c 2064 6566 6175 6c74 3a20 302e 3235  l, default: 0.25
+00011a00: 0d0a 2020 2020 2020 2020 2020 2020 4178  ..            Ax
+00011a10: 6973 206c 656e 6774 6820 7261 7469 6f2c  is length ratio,
+00011a20: 2068 6561 6420 7369 7a65 2074 6f20 7665   head size to ve
+00011a30: 6374 6f72 206d 6167 6e69 7475 6465 2e0d  ctor magnitude..
+00011a40: 0a0d 0a20 2020 2020 2020 2052 6169 7365  ...        Raise
+00011a50: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+00011a60: 2d0d 0a20 2020 2020 2020 2056 616c 7565  -..        Value
+00011a70: 4572 726f 720d 0a20 2020 2020 2020 2020  Error..         
+00011a80: 2020 204d 6973 6d61 7463 6865 6420 7375     Mismatched su
+00011a90: 7266 6163 6573 2062 6173 6564 206f 6e20  rfaces based on 
+00011aa0: 7468 6520 6e75 6d62 6572 206f 6620 7665  the number of ve
+00011ab0: 7274 6963 6573 2e0d 0a0d 0a20 2020 2020  rtices.....     
+00011ac0: 2020 2052 6574 7572 6e73 0d0a 2020 2020     Returns..    
+00011ad0: 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020      -------..   
+00011ae0: 2020 2020 2056 6563 746f 7233 4443 6f6c       Vector3DCol
+00011af0: 6c65 6374 696f 6e20 6f62 6a65 6374 0d0a  lection object..
+00011b00: 0d0a 2020 2020 2020 2020 2222 220d 0a0d  ..        """...
+00011b10: 0a20 2020 2020 2020 206b 6172 6744 6674  .        kargDft
+00011b20: 203d 207b 2027 7363 616c 6527 3a31 2c20   = { 'scale':1, 
+00011b30: 2763 6f6c 6f72 273a 2762 6c61 636b 272c  'color':'black',
+00011b40: 2027 7769 6474 6827 3a31 2c20 2761 6c72   'width':1, 'alr
+00011b50: 273a 5f44 4654 5f41 4c52 2020 7d0d 0a20  ':_DFT_ALR  }.. 
+00011b60: 2020 2020 2020 204b 5720 3d20 4b57 7072         KW = KWpr
+00011b70: 6f63 6573 736f 7228 6b61 7267 4466 742c  ocessor(kargDft,
+00011b80: 2776 6563 746f 7266 6965 6c64 5f74 6f5f  'vectorfield_to_
+00011b90: 7375 7266 6163 6527 2c2a 2a6b 6172 6773  surface',**kargs
+00011ba0: 290d 0a20 2020 2020 2020 2073 6361 6c65  )..        scale
+00011bb0: 203d 204b 572e 6765 7456 616c 2827 7363   = KW.getVal('sc
+00011bc0: 616c 6527 290d 0a20 2020 2020 2020 2063  ale')..        c
+00011bd0: 6f6c 6f72 203d 204b 572e 6765 7456 616c  olor = KW.getVal
+00011be0: 2827 636f 6c6f 7227 290d 0a20 2020 2020  ('color')..     
+00011bf0: 2020 2077 6964 7468 203d 204b 572e 6765     width = KW.ge
+00011c00: 7456 616c 2827 7769 6474 6827 290d 0a20  tVal('width').. 
+00011c10: 2020 2020 2020 2061 6c72 203d 204b 572e         alr = KW.
+00011c20: 6765 7456 616c 2827 616c 7227 290d 0a0d  getVal('alr')...
+00011c30: 0a20 2020 2020 2020 2073 7572 4c65 6e2c  .        surLen,
+00011c40: 2073 656c 664c 656e 203d 206c 656e 2873   selfLen = len(s
+00011c50: 7572 6661 6365 2e76 6572 7465 7843 6f6f  urface.vertexCoo
+00011c60: 7229 202c 206c 656e 2873 656c 662e 7665  r) , len(self.ve
+00011c70: 7274 6578 436f 6f72 290d 0a20 2020 2020  rtexCoor)..     
+00011c80: 2020 2023 6966 2073 7572 4c65 6e20 6973     #if surLen is
+00011c90: 206e 6f74 2073 656c 664c 656e 203a 2020   not selfLen :  
+00011ca0: 2320 312e 3120 6572 722e 2063 6f72 7265  # 1.1 err. corre
+00011cb0: 6374 6564 0d0a 2020 2020 2020 2020 6966  cted..        if
+00011cc0: 2073 7572 4c65 6e20 213d 2073 656c 664c   surLen != selfL
+00011cd0: 656e 203a 0d0a 2020 2020 2020 2020 2020  en :..          
+00011ce0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+00011cf0: 6f72 2827 5375 7266 6163 6573 2068 6176  or('Surfaces hav
+00011d00: 6520 756e 6571 7561 6c20 6e75 6d62 6572  e unequal number
+00011d10: 206f 6620 7665 7274 6963 6573 2c20 7b7d   of vertices, {}
+00011d20: 2021 3d20 7b7d 272e 666f 726d 6174 2873   != {}'.format(s
+00011d30: 7572 4c65 6e2c 2073 656c 664c 656e 2929  urLen, selfLen))
+00011d40: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
+00011d50: 2020 2020 2020 6465 6c74 6120 3d20 2073        delta =  s
+00011d60: 7572 6661 6365 2e76 6572 7465 7843 6f6f  urface.vertexCoo
+00011d70: 7220 2d20 7365 6c66 2e76 6572 7465 7843  r - self.vertexC
+00011d80: 6f6f 720d 0a20 2020 2020 2020 2064 656c  oor..        del
+00011d90: 7461 203d 2073 6361 6c65 2a64 656c 7461  ta = scale*delta
+00011da0: 0d0a 2020 2020 2020 2020 2320 2d2d 2d20  ..        # --- 
+00011db0: 312e 3120 6d6f 6420 2d2d 2d2d 2d2d 2d2d  1.1 mod --------
+00011dc0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020  ------------..  
+00011dd0: 2020 2020 2020 7646 6965 6c64 203d 2073        vField = s
+00011de0: 656c 662e 5f67 6574 5f76 6563 746f 7266  elf._get_vectorf
+00011df0: 6965 6c64 5f4c 696e 6533 4443 6f6c 6c65  ield_Line3DColle
+00011e00: 6374 696f 6e28 6465 6c74 612c 2063 6f6c  ction(delta, col
+00011e10: 6f72 2c20 7769 6474 682c 2061 6c72 290d  or, width, alr).
+00011e20: 0a20 2020 2020 2020 2076 4669 656c 642e  .        vField.
+00011e30: 7576 774f 7269 656e 7461 7469 6f6e 5479  uvwOrientationTy
+00011e40: 7065 203d 205f 434f 4f52 5359 535b 2258  pe = _COORSYS["X
+00011e50: 595a 225d 0d0a 2020 2020 2020 2020 7265  YZ"]..        re
+00011e60: 7475 726e 2076 4669 656c 640d 0a0d 0a20  turn vField.... 
+00011e70: 2020 2064 6566 205f 6d61 705f 636f 6c6f     def _map_colo
+00011e80: 725f 6672 6f6d 5f69 6d61 6765 5f76 6572  r_from_image_ver
+00011e90: 7428 7365 6c66 2c20 696d 672c 2076 6965  t(self, img, vie
+00011ea0: 7770 6f72 7420 2920 3a0d 0a0d 0a20 2020  wport ) :....   
+00011eb0: 2020 2020 2061 2c62 2c69 6e56 6965 7770       a,b,inViewp
+00011ec0: 6f72 7420 3d20 7365 6c66 2e5f 7669 6577  ort = self._view
+00011ed0: 706f 7274 436f 6f72 2873 656c 662e 7665  portCoor(self.ve
+00011ee0: 7274 6578 436f 6f72 2c76 6965 7770 6f72  rtexCoor,viewpor
+00011ef0: 7429 0d0a 2020 2020 2020 2020 0d0a 2020  t)..        ..  
+00011f00: 2020 2020 2020 6865 6967 6874 2c20 7769        height, wi
+00011f10: 6474 6820 3d20 6e70 2e73 7562 7472 6163  dth = np.subtrac
+00011f20: 7428 696d 672e 7368 6170 655b 3a32 5d2c  t(img.shape[:2],
+00011f30: 3129 0d0a 2020 2020 2020 2020 4d5f 696e  1)..        M_in
+00011f40: 6465 7820 3d20 2820 2831 2d62 292a 6865  dex = ( (1-b)*he
+00011f50: 6967 6874 2029 2e61 7374 7970 6528 696e  ight ).astype(in
+00011f60: 7429 0d0a 2020 2020 2020 2020 4e5f 696e  t)..        N_in
+00011f70: 6465 7820 3d20 2820 612a 7769 6474 6820  dex = ( a*width 
+00011f80: 292e 6173 7479 7065 2869 6e74 290d 0a20  ).astype(int).. 
+00011f90: 2020 2020 2020 2023 2727 270d 0a0d 0a20         #'''.... 
+00011fa0: 2020 2020 2020 206f 7269 675f 636f 6c6f         orig_colo
+00011fb0: 7273 203d 2073 656c 662e 7665 7274 6578  rs = self.vertex
+00011fc0: 436f 6c6f 720d 0a0d 0a20 2020 2020 2020  Color....       
+00011fd0: 2069 6620 6c65 6e28 6f72 6967 5f63 6f6c   if len(orig_col
+00011fe0: 6f72 7329 203d 3d20 3120 3a0d 0a20 2020  ors) == 1 :..   
+00011ff0: 2020 2020 2020 2020 206f 6e65 6172 7220           onearr 
+00012000: 3d20 6e70 2e6f 6e65 7328 206c 656e 2873  = np.ones( len(s
+00012010: 656c 662e 7665 7274 6578 436f 6f72 2920  elf.vertexCoor) 
+00012020: 295b 3a2c 206e 702e 6e65 7761 7869 735d  )[:, np.newaxis]
+00012030: 0d0a 2020 2020 2020 2020 2020 2020 6f72  ..            or
+00012040: 6967 5f63 6f6c 6f72 7320 3d20 6f72 6967  ig_colors = orig
+00012050: 5f63 6f6c 6f72 732a 6f6e 6561 7272 2020  _colors*onearr  
+00012060: 2020 2020 200d 0a0d 0a20 2020 2020 2020       ....       
+00012070: 2063 6f6c 6f72 4d61 7020 3d20 5b5d 0d0a   colorMap = []..
+00012080: 2020 2020 2020 2020 6f6e 6541 6c70 203d          oneAlp =
+00012090: 206e 702e 6172 7261 7928 5b31 2e30 5d29   np.array([1.0])
+000120a0: 0d0a 2020 2020 2020 2020 6966 2076 6965  ..        if vie
+000120b0: 7770 6f72 7420 6973 204e 6f6e 6520 3a20  wport is None : 
+000120c0: 636f 6c6f 724d 6170 203d 2069 6d67 5b4d  colorMap = img[M
+000120d0: 5f69 6e64 6578 2c4e 5f69 6e64 6578 5d0d  _index,N_index].
+000120e0: 0a20 2020 2020 2020 2065 6c73 6520 3a0d  .        else :.
+000120f0: 0a20 2020 2020 2020 2020 2020 2023 2046  .            # F
+00012100: 7574 4465 763a 2075 7365 206e 756d 7079  utDev: use numpy
+00012110: 206d 6574 686f 6473 2074 6f20 6f70 7469   methods to opti
+00012120: 6d69 7a65 2065 6666 6963 6965 6e63 793f  mize efficiency?
+00012130: 0d0a 2020 2020 2020 2020 2020 2020 666f  ..            fo
+00012140: 7220 6920 696e 2072 616e 6765 2820 6c65  r i in range( le
+00012150: 6e28 6f72 6967 5f63 6f6c 6f72 7329 2029  n(orig_colors) )
+00012160: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
+00012170: 2020 2020 636f 6c6f 724d 6170 2e61 7070      colorMap.app
+00012180: 656e 6428 6f72 6967 5f63 6f6c 6f72 735b  end(orig_colors[
+00012190: 695d 290d 0a20 2020 2020 2020 2020 2020  i])..           
+000121a0: 2020 2020 2069 6620 696e 5669 6577 706f       if inViewpo
+000121b0: 7274 5b69 5d20 3a0d 0a20 2020 2020 2020  rt[i] :..       
+000121c0: 2020 2020 2020 2020 2020 2020 2074 656d               tem
+000121d0: 7020 3d20 2069 6d67 5b4d 5f69 6e64 6578  p =  img[M_index
+000121e0: 5b69 5d2c 4e5f 696e 6465 785b 695d 5d0d  [i],N_index[i]].
+000121f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00012200: 2020 2020 2023 2e2e 206e 6f74 653a 2069       #.. note: i
+00012210: 6d67 206d 6179 206f 7220 6d61 7920 6e6f  mg may or may no
+00012220: 7420 6861 7665 2061 6e20 616c 7068 6120  t have an alpha 
+00012230: 6368 616e 6e65 6c2e 2e0d 0a20 2020 2020  channel....     
+00012240: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+00012250: 656d 7032 203d 2074 656d 705b 303a 335d  emp2 = temp[0:3]
+00012260: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00012270: 2020 2020 2020 636f 6c6f 724d 6170 5b69        colorMap[i
+00012280: 5d20 3d20 6e70 2e63 6f6e 6361 7465 6e61  ] = np.concatena
+00012290: 7465 2828 7465 6d70 322c 6f6e 6541 6c70  te((temp2,oneAlp
+000122a0: 2929 2020 200d 0a0d 0a20 2020 2020 2020  ))   ....       
+000122b0: 2073 656c 662e 7665 7274 6578 436f 6c6f   self.vertexColo
+000122c0: 7220 3d20 6e70 2e61 7272 6179 2863 6f6c  r = np.array(col
+000122d0: 6f72 4d61 7029 0d0a 2020 2020 2020 2020  orMap)..        
+000122e0: 7265 7475 726e 0d0a 0d0a 2020 2020 6465  return....    de
+000122f0: 6620 6d61 705f 636f 6c6f 725f 6672 6f6d  f map_color_from
+00012300: 5f69 6d61 6765 2873 656c 662c 2066 6e61  _image(self, fna
+00012310: 6d65 2c20 7669 6577 706f 7274 3d4e 6f6e  me, viewport=Non
+00012320: 6529 203a 0d0a 2020 2020 2020 2020 2222  e) :..        ""
+00012330: 220d 0a20 2020 2020 2020 2041 7373 6967  "..        Assig
+00012340: 6e20 696d 6167 6520 636f 6c6f 7220 7661  n image color va
+00012350: 6c75 6573 2074 6f20 7375 7266 6163 6520  lues to surface 
+00012360: 6661 6365 2063 6f6c 6f72 732e 0d0a 0d0a  face colors.....
+00012370: 2020 2020 2020 2020 5468 6973 206d 6574          This met
+00012380: 686f 6420 6973 206e 6f74 2061 7661 696c  hod is not avail
+00012390: 6162 6c65 2066 6f72 2063 6f6d 706f 7369  able for composi
+000123a0: 7465 2073 7572 6661 6365 732e 0d0a 2020  te surfaces...  
+000123b0: 2020 2020 2020 5468 6520 656e 7469 7265        The entire
+000123c0: 2069 6d61 6765 2064 6f6d 6169 6e20 6973   image domain is
+000123d0: 2061 7070 6c69 6564 2074 6f20 7468 6520   applied to the 
+000123e0: 636f 6c6f 7269 6e67 206f 7065 7261 7469  coloring operati
+000123f0: 6f6e 2e0d 0a0d 0a20 2020 2020 2020 2050  on.....        P
+00012400: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
+00012410: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
+00012420: 2020 2020 2020 2066 6e61 6d65 203a 2073         fname : s
+00012430: 7472 206f 7220 6669 6c65 2d6c 696b 650d  tr or file-like.
+00012440: 0a20 2020 2020 2020 2020 2020 2054 6865  .            The
+00012450: 2069 6d61 6765 2066 696c 6520 746f 2072   image file to r
+00012460: 6561 643a 2061 2066 696c 656e 616d 652c  ead: a filename,
+00012470: 2061 2055 524c 206f 7220 6120 6669 6c65   a URL or a file
+00012480: 2d6c 696b 6520 6f62 6a65 6374 206f 7065  -like object ope
+00012490: 6e65 640d 0a20 2020 2020 2020 2020 2020  ned..           
+000124a0: 2069 6e20 7265 6164 2d62 696e 6172 7920   in read-binary 
+000124b0: 6d6f 6465 2e20 2043 7572 7265 6e74 6c79  mode.  Currently
+000124c0: 2072 6573 7472 6963 7465 6420 746f 2050   restricted to P
+000124d0: 4e47 2066 6f72 6d61 742e 0d0a 2020 2020  NG format...    
+000124e0: 2020 2020 0d0a 2020 2020 2020 2020 7669      ..        vi
+000124f0: 6577 706f 7274 203a 2034 4420 6172 7261  ewport : 4D arra
+00012500: 792d 6c69 6b65 2c20 6f70 7469 6f6e 616c  y-like, optional
+00012510: 2c20 6465 6661 756c 743a 204e 6f6e 650d  , default: None.
+00012520: 0a20 2020 2020 2020 2020 2020 2056 6965  .            Vie
+00012530: 7770 6f72 7420 6465 6669 6e65 7320 7468  wport defines th
+00012540: 6520 7375 6264 6f6d 6169 6e20 6f66 2074  e subdomain of t
+00012550: 6865 2073 7572 6661 6365 206f 6e74 6f20  he surface onto 
+00012560: 7768 6963 680d 0a20 2020 2020 2020 2020  which..         
+00012570: 2020 2074 6865 2069 6d61 6765 2069 7320     the image is 
+00012580: 6d61 7070 6564 2e20 2054 6865 2073 7562  mapped.  The sub
+00012590: 646f 6d61 696e 2069 7320 7365 7420 6279  domain is set by
+000125a0: 206e 6f72 6d61 6c69 7a65 640d 0a20 2020   normalized..   
+000125b0: 2020 2020 2020 2020 206e 6174 6976 6520           native 
+000125c0: 7375 7266 6163 6520 636f 6f72 6469 6e61  surface coordina
+000125d0: 7465 7320 696e 2061 2034 4420 6172 7261  tes in a 4D arra
+000125e0: 792e 0d0a 2020 2020 2020 2020 2020 2020  y...            
+000125f0: 5468 6520 656e 7469 7265 2073 7572 6661  The entire surfa
+00012600: 6365 2069 7320 636f 6c6f 7265 6420 666f  ce is colored fo
+00012610: 7220 7468 6520 6465 6661 756c 7420 6f66  r the default of
+00012620: 204e 6f6e 652e 0d0a 0d0a 2020 2020 2020   None.....      
+00012630: 2020 5265 7475 726e 730d 0a20 2020 2020    Returns..     
+00012640: 2020 202d 2d2d 2d2d 2d2d 0d0a 2020 2020     -------..    
+00012650: 2020 2020 7365 6c66 203a 2073 7572 6661      self : surfa
+00012660: 6365 206f 626a 6563 740d 0a0d 0a20 2020  ce object....   
+00012670: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
+00012680: 2020 0d0a 2020 2020 2020 2020 6966 2073    ..        if s
+00012690: 656c 662e 5f69 7343 6f6d 706f 7369 7465  elf._isComposite
+000126a0: 5375 7266 6163 6520 3a0d 0a20 2020 2020  Surface :..     
+000126b0: 2020 2020 2020 2077 6172 6e69 6e67 732e         warnings.
+000126c0: 7761 726e 2827 496d 6167 6520 6f70 6572  warn('Image oper
+000126d0: 6174 696f 6e20 6e6f 7420 6176 6169 6c61  ation not availa
+000126e0: 626c 6520 666f 7220 636f 6d62 696e 6564  ble for combined
+000126f0: 2073 6861 7065 732e 2729 0d0a 2020 2020   shapes.')..    
+00012700: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00012710: 656c 660d 0a20 2020 2020 2020 2069 6620  elf..        if 
+00012720: 7365 6c66 2e5f 7375 7266 6163 6553 6861  self._surfaceSha
+00012730: 7065 4368 616e 6765 6420 3a0d 0a20 2020  peChanged :..   
+00012740: 2020 2020 2020 2020 2077 6172 6e69 6e67           warning
+00012750: 732e 7761 726e 2827 496d 6167 6520 6f70  s.warn('Image op
+00012760: 6572 6174 696f 6e20 6d61 7920 6265 2061  eration may be a
+00012770: 6e6f 6d61 6c6f 7573 2061 6674 6572 2073  nomalous after s
+00012780: 6861 7065 206d 6f64 6966 6963 6174 696f  hape modificatio
+00012790: 6e2e 2729 0d0a 0d0a 2020 2020 2020 2020  n.')....        
+000127a0: 6966 2076 6965 7770 6f72 7420 6973 206e  if viewport is n
+000127b0: 6f74 204e 6f6e 6520 3a0d 0a20 2020 2020  ot None :..     
+000127c0: 2020 2020 2020 2076 6965 7770 6f72 7420         viewport 
+000127d0: 3d20 6e70 2e61 7272 6179 2876 6965 7770  = np.array(viewp
+000127e0: 6f72 7429 0d0a 2020 2020 2020 2020 2020  ort)..          
+000127f0: 2020 6966 206e 702e 616e 7928 2028 7669    if np.any( (vi
+00012800: 6577 706f 7274 3c30 2920 7c20 2876 6965  ewport<0) | (vie
+00012810: 7770 6f72 743e 3129 2029 203a 0d0a 2020  wport>1) ) :..  
+00012820: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+00012830: 6973 6520 5661 6c75 6545 7272 6f72 2827  ise ValueError('
+00012840: 7669 6577 706f 7274 206c 6973 7420 7661  viewport list va
+00012850: 6c75 6573 2c20 7b7d 2c20 6d75 7374 2062  lues, {}, must b
+00012860: 6520 6265 7477 6565 6e20 3020 616e 6420  e between 0 and 
+00012870: 3127 2e66 6f72 6d61 7428 7669 6577 706f  1'.format(viewpo
+00012880: 7274 2929 0d0a 2020 2020 2020 2020 2020  rt))..          
+00012890: 2020 6966 206c 656e 2876 6965 7770 6f72    if len(viewpor
+000128a0: 7429 2021 3d20 3420 3a0d 0a20 2020 2020  t) != 4 :..     
+000128b0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+000128c0: 2056 616c 7565 4572 726f 7228 2776 6965   ValueError('vie
+000128d0: 7770 6f72 7420 6c69 7374 206d 7573 7420  wport list must 
+000128e0: 6265 206c 656e 6774 6820 342c 2066 6f75  be length 4, fou
+000128f0: 6e64 207b 7d27 2e66 6f72 6d61 7428 6c65  nd {}'.format(le
+00012900: 6e28 7669 6577 706f 7274 2929 2920 2020  n(viewport)))   
+00012910: 2020 200d 0a20 2020 2020 2020 2076 6572     ..        ver
+00012920: 7473 203d 2073 656c 662e 7665 7274 6578  ts = self.vertex
+00012930: 436f 6f72 5b20 7365 6c66 2e66 7649 6e64  Coor[ self.fvInd
+00012940: 6963 6573 205d 0d0a 2020 2020 2020 2020  ices ]..        
+00012950: 0d0a 2020 2020 2020 2020 6661 6365 4365  ..        faceCe
+00012960: 6e74 6572 436f 6f72 203d 2073 656c 662e  nterCoor = self.
+00012970: 5f67 6574 5f66 6163 655f 6365 6e74 6572  _get_face_center
+00012980: 7328 7665 7274 7329 0d0a 2020 2020 2020  s(verts)..      
+00012990: 2020 612c 622c 696e 5669 6577 706f 7274    a,b,inViewport
+000129a0: 203d 2073 656c 662e 5f76 6965 7770 6f72   = self._viewpor
+000129b0: 7443 6f6f 7228 6661 6365 4365 6e74 6572  tCoor(faceCenter
+000129c0: 436f 6f72 2c76 6965 7770 6f72 7429 0d0a  Coor,viewport)..
+000129d0: 2020 2020 2020 2020 696d 6720 3d20 696d          img = im
+000129e0: 6167 652e 696d 7265 6164 2866 6e61 6d65  age.imread(fname
+000129f0: 290d 0a20 2020 2020 2020 200d 0a20 2020  )..        ..   
+00012a00: 2020 2020 2068 6569 6768 742c 2077 6964       height, wid
+00012a10: 7468 203d 206e 702e 7375 6274 7261 6374  th = np.subtract
+00012a20: 2869 6d67 2e73 6861 7065 5b3a 325d 2c31  (img.shape[:2],1
+00012a30: 290d 0a20 2020 2020 2020 204d 5f69 6e64  )..        M_ind
+00012a40: 6578 203d 2028 2028 312d 6229 2a68 6569  ex = ( (1-b)*hei
+00012a50: 6768 7420 292e 6173 7479 7065 2869 6e74  ght ).astype(int
+00012a60: 290d 0a20 2020 2020 2020 204e 5f69 6e64  )..        N_ind
+00012a70: 6578 203d 2028 2061 2a77 6964 7468 2029  ex = ( a*width )
+00012a80: 2e61 7374 7970 6528 696e 7429 0d0a 2020  .astype(int)..  
+00012a90: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00012aa0: 6f72 6967 5f63 6f6c 6f72 7320 3d20 7365  orig_colors = se
+00012ab0: 6c66 2e5f 6466 6163 6563 6f6c 6f72 7320  lf._dfacecolors 
+00012ac0: 2023 2075 7064 6174 6520 666f 7220 765f   # update for v_
+00012ad0: 312e 322e 300d 0a0d 0a20 2020 2020 2020  1.2.0....       
+00012ae0: 2069 6620 6c65 6e28 6f72 6967 5f63 6f6c   if len(orig_col
+00012af0: 6f72 7329 203d 3d20 3120 3a0d 0a20 2020  ors) == 1 :..   
+00012b00: 2020 2020 2020 2020 206f 6e65 6172 7220           onearr 
+00012b10: 3d20 6e70 2e6f 6e65 7328 206c 656e 2866  = np.ones( len(f
+00012b20: 6163 6543 656e 7465 7243 6f6f 7229 2029  aceCenterCoor) )
+00012b30: 5b3a 2c20 6e70 2e6e 6577 6178 6973 5d0d  [:, np.newaxis].
+00012b40: 0a20 2020 2020 2020 2020 2020 206f 7269  .            ori
+00012b50: 675f 636f 6c6f 7273 203d 206f 7269 675f  g_colors = orig_
+00012b60: 636f 6c6f 7273 2a6f 6e65 6172 7220 2020  colors*onearr   
+00012b70: 2020 2020 0d0a 0d0a 2020 2020 2020 2020      ....        
+00012b80: 636f 6c6f 724d 6170 203d 205b 5d0d 0a20  colorMap = [].. 
+00012b90: 2020 2020 2020 2069 6620 7669 6577 706f         if viewpo
+00012ba0: 7274 2069 7320 4e6f 6e65 203a 2063 6f6c  rt is None : col
+00012bb0: 6f72 4d61 7020 3d20 696d 675b 4d5f 696e  orMap = img[M_in
+00012bc0: 6465 782c 4e5f 696e 6465 785d 0d0a 2020  dex,N_index]..  
+00012bd0: 2020 2020 2020 656c 7365 203a 0d0a 2020        else :..  
+00012be0: 2020 2020 2020 2020 2020 2320 4675 7444            # FutD
+00012bf0: 6576 3a20 7573 6520 6e75 6d70 7920 6d65  ev: use numpy me
+00012c00: 7468 6f64 7320 746f 206f 7074 696d 697a  thods to optimiz
+00012c10: 6520 6566 6669 6369 656e 6379 3f0d 0a20  e efficiency?.. 
+00012c20: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
+00012c30: 2069 6e20 7261 6e67 6528 206c 656e 286f   in range( len(o
+00012c40: 7269 675f 636f 6c6f 7273 2920 2920 3a0d  rig_colors) ) :.
+00012c50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00012c60: 2063 6f6c 6f72 4d61 702e 6170 7065 6e64   colorMap.append
+00012c70: 286f 7269 675f 636f 6c6f 7273 5b69 5d29  (orig_colors[i])
+00012c80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00012c90: 2020 6966 2069 6e56 6965 7770 6f72 745b    if inViewport[
+00012ca0: 695d 203a 2063 6f6c 6f72 4d61 705b 695d  i] : colorMap[i]
+00012cb0: 203d 2069 6d67 5b4d 5f69 6e64 6578 5b69   = img[M_index[i
+00012cc0: 5d2c 4e5f 696e 6465 785b 695d 5d20 2020  ],N_index[i]]   
+00012cd0: 200d 0a20 2020 2020 2020 2073 656c 662e   ..        self.
+00012ce0: 7365 745f 636f 6c6f 7228 636f 6c6f 724d  set_color(colorM
+00012cf0: 6170 290d 0a20 2020 2020 2020 2073 656c  ap)..        sel
+00012d00: 662e 6973 5375 7266 6163 6543 6f6c 6f72  f.isSurfaceColor
+00012d10: 6564 203d 2054 7275 650d 0a20 2020 2020  ed = True..     
+00012d20: 2020 2073 656c 662e 7665 7274 6578 5661     self.vertexVa
+00012d30: 6c75 6573 203d 204e 6f6e 650d 0a20 2020  lues = None..   
+00012d40: 2020 2020 2023 203d 3d3d 3d3d 3d3d 3d3d       # =========
+00012d50: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00012d60: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00012d70: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00012d80: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d  ===============.
+00012d90: 0a20 2020 2020 2020 2073 656c 662e 5f6d  .        self._m
+00012da0: 6170 5f63 6f6c 6f72 5f66 726f 6d5f 696d  ap_color_from_im
+00012db0: 6167 655f 7665 7274 2869 6d67 2c76 6965  age_vert(img,vie
+00012dc0: 7770 6f72 7420 290d 0a20 2020 2020 2020  wport )..       
+00012dd0: 2023 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d   # =============
+00012de0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00012df0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00012e00: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00012e10: 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d 0a0d 0a20  ===========.... 
+00012e20: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00012e30: 6c66 0d0a 0d0a 2020 2020 6465 6620 5f6d  lf....    def _m
+00012e40: 6170 5f63 6f6c 6f72 5f66 726f 6d5f 6f70  ap_color_from_op
+00012e50: 5f76 6572 7428 7365 6c66 2c20 6f70 6572  _vert(self, oper
+00012e60: 6174 696f 6e2c 2072 6762 3d54 7275 6529  ation, rgb=True)
+00012e70: 203a 0d0a 2020 2020 2020 2020 7879 7a20   :..        xyz 
+00012e80: 3d20 6e70 2e74 7261 6e73 706f 7365 2873  = np.transpose(s
+00012e90: 656c 662e 7665 7274 6578 436f 6f72 290d  elf.vertexCoor).
+00012ea0: 0a20 2020 2020 2020 2061 6263 203d 2073  .        abc = s
+00012eb0: 656c 662e 636f 6f72 5f63 6f6e 7665 7274  elf.coor_convert
+00012ec0: 2878 797a 290d 0a20 2020 2020 2020 2063  (xyz)..        c
+00012ed0: 6f6c 6f72 7320 3d20 6e70 2e61 7272 6179  olors = np.array
+00012ee0: 286f 7065 7261 7469 6f6e 2861 6263 2929  (operation(abc))
+00012ef0: 0d0a 2020 2020 2020 2020 636f 6c6f 7273  ..        colors
+00012f00: 203d 206e 702e 7472 616e 7370 6f73 6528   = np.transpose(
+00012f10: 636f 6c6f 7273 290d 0a20 2020 2020 2020  colors)..       
+00012f20: 2063 6f6c 6f72 7320 3d20 6e70 2e63 6c69   colors = np.cli
+00012f30: 7028 636f 6c6f 7273 2c30 2c31 290d 0a20  p(colors,0,1).. 
+00012f40: 2020 2020 2020 2069 6620 7267 6220 3a20         if rgb : 
+00012f50: 5247 4220 3d20 636f 6c6f 7273 0d0a 2020  RGB = colors..  
+00012f60: 2020 2020 2020 656c 7365 203a 2020 2052        else :   R
+00012f70: 4742 203d 2063 6d2e 636f 6c6f 7273 2e68  GB = cm.colors.h
+00012f80: 7376 5f74 6f5f 7267 6228 636f 6c6f 7273  sv_to_rgb(colors
+00012f90: 290d 0a0d 0a20 2020 2020 2020 2069 6620  )....        if 
+00012fa0: 5247 422e 7368 6170 655b 315d 203d 3d20  RGB.shape[1] == 
+00012fb0: 3320 3a20 2023 2061 6464 2061 6c70 6861  3 :  # add alpha
+00012fc0: 2063 6861 6e6e 656c 2e0d 0a20 2020 2020   channel...     
+00012fd0: 2020 2020 2020 206f 6e65 7320 3d20 6e70         ones = np
+00012fe0: 2e61 7272 6179 2820 5b6e 702e 6f6e 6573  .array( [np.ones
+00012ff0: 2820 5247 422e 7368 6170 655b 305d 2029  ( RGB.shape[0] )
+00013000: 5d20 292e 540d 0a20 2020 2020 2020 2020  ] ).T..         
+00013010: 2020 2052 4742 203d 206e 702e 636f 6e63     RGB = np.conc
+00013020: 6174 656e 6174 6528 2028 5247 422c 206f  atenate( (RGB, o
+00013030: 6e65 7320 292c 2061 7869 733d 3120 2029  nes ), axis=1  )
+00013040: 0d0a 0d0a 2020 2020 2020 2020 7365 6c66  ....        self
+00013050: 2e76 6572 7465 7843 6f6c 6f72 203d 2052  .vertexColor = R
+00013060: 4742 200d 0a20 2020 2020 2020 2073 656c  GB ..        sel
+00013070: 662e 5f62 6f75 6e64 735b 2776 6572 7476  f._bounds['vertv
+00013080: 6c69 6d27 5d20 3d20 5f44 4654 5f56 4552  lim'] = _DFT_VER
+00013090: 5456 4c49 4d0d 0a0d 0a20 2020 2020 2020  TVLIM....       
+000130a0: 2072 6574 7572 6e20 0d0a 0d0a 2020 2020   return ....    
+000130b0: 6465 6620 6d61 705f 636f 6c6f 725f 6672  def map_color_fr
+000130c0: 6f6d 5f6f 7028 7365 6c66 2c20 6f70 6572  om_op(self, oper
+000130d0: 6174 696f 6e2c 2072 6762 3d54 7275 652c  ation, rgb=True,
+000130e0: 2063 6e61 6d65 3d4e 6f6e 6529 203a 0d0a   cname=None) :..
+000130f0: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
+00013100: 2020 2020 2041 7373 6967 6e6d 656e 7420       Assignment 
+00013110: 6f66 2066 6163 6520 636f 6c6f 7220 6672  of face color fr
+00013120: 6f6d 2061 2066 756e 6374 696f 6e2e 0d0a  om a function...
+00013130: 0d0a 2020 2020 2020 2020 4661 6365 2063  ..        Face c
+00013140: 6f6c 6f72 7320 6172 6520 6173 7369 676e  olors are assign
+00013150: 6564 2066 726f 6d20 6120 6675 6e63 7469  ed from a functi
+00013160: 6f6e 0d0a 2020 2020 2020 2020 6f66 2066  on..        of f
+00013170: 6163 6520 636f 6f72 6469 6e61 7465 732e  ace coordinates.
+00013180: 0d0a 0d0a 2020 2020 2020 2020 5061 7261  ....        Para
+00013190: 6d65 7465 7273 0d0a 2020 2020 2020 2020  meters..        
+000131a0: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
+000131b0: 2020 2020 6f70 6572 6174 696f 6e20 3a20      operation : 
+000131c0: 6675 6e63 7469 6f6e 206f 626a 6563 740d  function object.
+000131d0: 0a20 2020 2020 2020 2020 2020 2046 756e  .            Fun
+000131e0: 6374 696f 6e20 7468 6174 2074 616b 6573  ction that takes
+000131f0: 206f 6e65 2061 7267 756d 656e 742c 0d0a   one argument,..
+00013200: 2020 2020 2020 2020 2020 2020 6120 3378              a 3x
+00013210: 4e20 4e75 6d70 7920 6172 7261 7920 6f66  N Numpy array of
+00013220: 206e 6174 6976 6520 636f 6f72 6469 6e61   native coordina
+00013230: 7465 732e 0d0a 2020 2020 2020 2020 2020  tes...          
+00013240: 2020 5468 6520 6675 6e63 7469 6f6e 2072    The function r
+00013250: 6574 7572 6e73 2061 2033 784e 2063 6f6c  eturns a 3xN col
+00013260: 6f72 2076 616c 7565 2e0d 0a0d 0a20 2020  or value.....   
+00013270: 2020 2020 2072 6762 203a 2062 6f6f 6c20       rgb : bool 
+00013280: 7b54 7275 652c 2046 616c 7365 7d2c 206f  {True, False}, o
+00013290: 7074 696f 6e61 6c2c 2064 6566 6175 6c74  ptional, default
+000132a0: 3a20 5472 7565 0d0a 2020 2020 2020 2020  : True..        
+000132b0: 2020 2020 4279 2064 6566 6175 6c74 2c20      By default, 
+000132c0: 5247 4220 636f 6c6f 7220 7661 6c75 6573  RGB color values
+000132d0: 2061 7265 2072 6574 7572 6e65 6420 6279   are returned by
+000132e0: 2074 6865 0d0a 2020 2020 2020 2020 2020   the..          
+000132f0: 2020 6f70 6572 6174 696f 6e20 6675 6e63    operation func
+00013300: 7469 6f6e 2e20 2049 6620 7365 7420 4661  tion.  If set Fa
+00013310: 6c73 652c 2074 6865 206f 7065 7261 7469  lse, the operati
+00013320: 6f6e 0d0a 2020 2020 2020 2020 2020 2020  on..            
+00013330: 7265 7475 726e 7320 4853 5620 636f 6c6f  returns HSV colo
+00013340: 7220 7661 6c75 6573 2e0d 0a0d 0a20 2020  r values.....   
+00013350: 2020 2020 2063 6e61 6d65 203a 2073 7472       cname : str
+00013360: 696e 672c 206f 7074 696f 6e61 6c2c 2064  ing, optional, d
+00013370: 6566 6175 6c74 3a20 4e6f 6e65 206f 7220  efault: None or 
+00013380: 6f70 2066 756e 6374 696f 6e20 6e61 6d65  op function name
+00013390: 2e0d 0a20 2020 2020 2020 2020 2020 2044  ...            D
+000133a0: 6573 6372 6970 7469 7665 2069 6465 6e74  escriptive ident
+000133b0: 6966 6965 7220 666f 7220 7661 6c75 6573  ifier for values
+000133c0: 2069 6e64 6963 6174 6564 2062 7920 636f   indicated by co
+000133d0: 6c6f 722e 0d0a 0d0a 2020 2020 2020 2020  lor.....        
+000133e0: 5265 7475 726e 730d 0a20 2020 2020 2020  Returns..       
+000133f0: 202d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020   -------..      
+00013400: 2020 7365 6c66 203a 2073 7572 6661 6365    self : surface
+00013410: 206f 626a 6563 740d 0a0d 0a20 2020 2020   object....     
+00013420: 2020 2022 2222 0d0a 0d0a 2020 2020 2020     """....      
+00013430: 2020 7665 7274 7320 3d20 7365 6c66 2e76    verts = self.v
+00013440: 6572 7465 7843 6f6f 725b 2073 656c 662e  ertexCoor[ self.
+00013450: 6676 496e 6469 6365 7320 5d0d 0a20 2020  fvIndices ]..   
+00013460: 2020 2020 2066 6163 6543 656e 7465 7243       faceCenterC
+00013470: 6f6f 7220 3d20 7365 6c66 2e5f 6765 745f  oor = self._get_
+00013480: 6661 6365 5f63 656e 7465 7273 2876 6572  face_centers(ver
+00013490: 7473 290d 0a20 2020 2020 2020 2078 797a  ts)..        xyz
+000134a0: 203d 206e 702e 7472 616e 7370 6f73 6528   = np.transpose(
+000134b0: 6661 6365 4365 6e74 6572 436f 6f72 290d  faceCenterCoor).
+000134c0: 0a20 2020 2020 2020 2061 6263 203d 2073  .        abc = s
+000134d0: 656c 662e 636f 6f72 5f63 6f6e 7665 7274  elf.coor_convert
+000134e0: 2878 797a 290d 0a20 2020 2020 2020 2063  (xyz)..        c
+000134f0: 6f6c 6f72 7320 3d20 6e70 2e61 7272 6179  olors = np.array
+00013500: 286f 7065 7261 7469 6f6e 2861 6263 2929  (operation(abc))
+00013510: 0d0a 2020 2020 2020 2020 636f 6c6f 7273  ..        colors
+00013520: 203d 206e 702e 7472 616e 7370 6f73 6528   = np.transpose(
+00013530: 636f 6c6f 7273 290d 0a20 2020 2020 2020  colors)..       
+00013540: 2063 6f6c 6f72 7320 3d20 6e70 2e63 6c69   colors = np.cli
+00013550: 7028 636f 6c6f 7273 2c30 2c31 290d 0a20  p(colors,0,1).. 
+00013560: 2020 2020 2020 2069 6620 7267 6220 3a20         if rgb : 
+00013570: 5247 4220 3d20 636f 6c6f 7273 0d0a 2020  RGB = colors..  
+00013580: 2020 2020 2020 656c 7365 203a 2020 2052        else :   R
+00013590: 4742 203d 2063 6d2e 636f 6c6f 7273 2e68  GB = cm.colors.h
+000135a0: 7376 5f74 6f5f 7267 6228 636f 6c6f 7273  sv_to_rgb(colors
+000135b0: 290d 0a20 2020 2020 2020 2073 656c 662e  )..        self.
+000135c0: 7365 745f 636f 6c6f 7228 5247 4229 0d0a  set_color(RGB)..
+000135d0: 2020 2020 2020 2020 7365 6c66 2e69 7353          self.isS
+000135e0: 7572 6661 6365 436f 6c6f 7265 6420 3d20  urfaceColored = 
+000135f0: 5472 7565 0d0a 2020 2020 2020 2020 636e  True..        cn
+00013600: 616d 6520 3d20 5f67 6574 4675 6e63 7469  ame = _getFuncti
+00013610: 6f6e 4e61 6d65 286f 7065 7261 7469 6f6e  onName(operation
+00013620: 2c63 6e61 6d65 2920 0d0a 2020 2020 2020  ,cname) ..      
+00013630: 2020 6966 2063 6e61 6d65 2069 7320 6e6f    if cname is no
+00013640: 7420 4e6f 6e65 203a 2073 656c 662e 7661  t None : self.va
+00013650: 6c75 6573 4e61 6d65 203d 2063 6e61 6d65  luesName = cname
+00013660: 200d 0a20 2020 2020 2020 2073 656c 662e   ..        self.
+00013670: 5f62 6f75 6e64 735b 2776 6c69 6d27 5d20  _bounds['vlim'] 
+00013680: 3d20 5f44 4654 5f56 4c49 4d0d 0a0d 0a20  = _DFT_VLIM.... 
+00013690: 2020 2020 2020 2073 656c 662e 5f6d 6170         self._map
+000136a0: 5f63 6f6c 6f72 5f66 726f 6d5f 6f70 5f76  _color_from_op_v
+000136b0: 6572 7428 6f70 6572 6174 696f 6e2c 2072  ert(operation, r
+000136c0: 6762 290d 0a0d 0a20 2020 2020 2020 2072  gb)....        r
+000136d0: 6574 7572 6e20 7365 6c66 0d0a 0d0a 2020  eturn self....  
+000136e0: 2020 6465 6620 5f6d 6170 5f63 6d61 705f    def _map_cmap_
+000136f0: 6672 6f6d 5f64 6174 6167 7269 645f 7665  from_datagrid_ve
+00013700: 7274 2873 656c 662c 2064 6174 6167 7269  rt(self, datagri
+00013710: 642c 2063 6d61 703d 4e6f 6e65 2c20 7669  d, cmap=None, vi
+00013720: 6577 706f 7274 3d4e 6f6e 6529 203a 0d0a  ewport=None) :..
+00013730: 0d0a 2020 2020 2020 2020 612c 622c 696e  ..        a,b,in
+00013740: 5669 6577 706f 7274 203d 2073 656c 662e  Viewport = self.
+00013750: 5f76 6965 7770 6f72 7443 6f6f 7228 7365  _viewportCoor(se
+00013760: 6c66 2e76 6572 7465 7843 6f6f 722c 7669  lf.vertexCoor,vi
+00013770: 6577 706f 7274 2920 2020 2020 200d 0a20  ewport)      .. 
+00013780: 2020 2020 2020 2064 6174 6120 3d20 6461         data = da
+00013790: 7461 6772 6964 0d0a 2020 2020 2020 2020  tagrid..        
+000137a0: 646d 6178 203d 206e 702e 616d 6178 2864  dmax = np.amax(d
+000137b0: 6174 6167 7269 6429 0d0a 2020 2020 2020  atagrid)..      
+000137c0: 2020 646d 696e 203d 206e 702e 616d 696e    dmin = np.amin
+000137d0: 2864 6174 6167 7269 6429 0d0a 2020 2020  (datagrid)..    
+000137e0: 2020 2020 7864 203d 206e 702e 6c69 6e73      xd = np.lins
+000137f0: 7061 6365 2830 2c20 312c 2064 6174 612e  pace(0, 1, data.
+00013800: 7368 6170 655b 305d 2029 0d0a 2020 2020  shape[0] )..    
+00013810: 2020 2020 7964 203d 206e 702e 6c69 6e73      yd = np.lins
+00013820: 7061 6365 2830 2c20 312c 2064 6174 612e  pace(0, 1, data.
+00013830: 7368 6170 655b 315d 2029 0d0a 2020 2020  shape[1] )..    
+00013840: 2020 2020 6720 3d20 2069 6e74 6572 706f      g =  interpo
+00013850: 6c61 7465 2e69 6e74 6572 7032 6428 7964  late.interp2d(yd
+00013860: 2c20 7864 2c20 6461 7461 2c20 6b69 6e64  , xd, data, kind
+00013870: 3d27 6375 6269 6327 290d 0a20 2020 2020  ='cubic')..     
+00013880: 2020 2064 203d 205b 5d0d 0a20 2020 2020     d = []..     
+00013890: 2020 2023 2046 7574 4465 763a 2075 7365     # FutDev: use
+000138a0: 206e 756d 7079 206d 6574 686f 6473 2074   numpy methods t
+000138b0: 6f20 6f70 7469 6d69 7a65 2065 6666 6963  o optimize effic
+000138c0: 6965 6e63 792e 0d0a 2020 2020 2020 2020  iency...        
+000138d0: 666f 7220 6162 2069 6e20 6e70 2e74 7261  for ab in np.tra
+000138e0: 6e73 706f 7365 285b 612c 625d 2920 3a0d  nspose([a,b]) :.
+000138f0: 0a20 2020 2020 2020 2020 2020 2064 2e61  .            d.a
+00013900: 7070 656e 6428 2067 2861 625b 305d 2c61  ppend( g(ab[0],a
+00013910: 625b 315d 295b 305d 2029 2020 200d 0a20  b[1])[0] )   .. 
+00013920: 2020 2020 2020 2064 203d 206e 702e 7768         d = np.wh
+00013930: 6572 6528 696e 5669 6577 706f 7274 2c64  ere(inViewport,d
+00013940: 2c6e 702e 6675 6c6c 286c 656e 2864 292c  ,np.full(len(d),
+00013950: 646d 696e 2929 0d0a 2020 2020 2020 2020  dmin))..        
+00013960: 0d0a 2020 2020 2020 2020 6966 2063 6d61  ..        if cma
+00013970: 7020 6973 206e 6f74 204e 6f6e 6520 3a0d  p is not None :.
+00013980: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00013990: 6973 696e 7374 616e 6365 2863 6d61 702c  isinstance(cmap,
+000139a0: 7374 7229 203a 200d 0a20 2020 2020 2020  str) : ..       
+000139b0: 2020 2020 2020 2020 2073 656c 662e 7365           self.se
+000139c0: 745f 636d 6170 2863 6d2e 6765 745f 636d  t_cmap(cm.get_cm
+000139d0: 6170 2863 6d61 7029 290d 0a20 2020 2020  ap(cmap))..     
+000139e0: 2020 2020 2020 2065 6c73 6520 3a0d 0a20         else :.. 
+000139f0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00013a00: 656c 662e 7365 745f 636d 6170 2863 6d61  elf.set_cmap(cma
+00013a10: 7029 0d0a 2020 2020 2020 2020 636d 6170  p)..        cmap
+00013a20: 203d 2073 656c 662e 6765 745f 636d 6170   = self.get_cmap
+00013a30: 2829 0d0a 2020 2020 2020 2020 0d0a 2020  ()..        ..  
+00013a40: 2020 2020 2020 6f72 6967 5f63 6f6c 6f72        orig_color
+00013a50: 7320 3d20 7365 6c66 2e76 6572 7465 7843  s = self.vertexC
+00013a60: 6f6c 6f72 0d0a 0d0a 2020 2020 2020 2020  olor....        
+00013a70: 6966 206c 656e 286f 7269 675f 636f 6c6f  if len(orig_colo
+00013a80: 7273 2920 3d3d 2031 203a 0d0a 2020 2020  rs) == 1 :..    
+00013a90: 2020 2020 2020 2020 6f6e 6561 7272 203d          onearr =
+00013aa0: 206e 702e 6f6e 6573 2820 6c65 6e28 7365   np.ones( len(se
+00013ab0: 6c66 2e76 6572 7465 7843 6f6f 7229 2029  lf.vertexCoor) )
+00013ac0: 5b3a 2c20 6e70 2e6e 6577 6178 6973 5d0d  [:, np.newaxis].
+00013ad0: 0a20 2020 2020 2020 2020 2020 206f 7269  .            ori
+00013ae0: 675f 636f 6c6f 7273 203d 206f 7269 675f  g_colors = orig_
+00013af0: 636f 6c6f 7273 2a6f 6e65 6172 7220 2020  colors*onearr   
+00013b00: 2020 2020 0d0a 2020 2020 2020 2020 0d0a      ..        ..
+00013b10: 2020 2020 2020 2020 6e6f 726d 203d 2063          norm = c
+00013b20: 6f6c 6f72 732e 4e6f 726d 616c 697a 6528  olors.Normalize(
+00013b30: 646d 696e 2c64 6d61 7829 0d0a 2020 2020  dmin,dmax)..    
+00013b40: 2020 2020 7465 6d70 203d 2063 6d61 7028      temp = cmap(
+00013b50: 6e6f 726d 2864 2929 0d0a 2020 2020 2020  norm(d))..      
+00013b60: 2020 6966 2076 6965 7770 6f72 7420 6973    if viewport is
+00013b70: 204e 6f6e 6520 3a0d 0a20 2020 2020 2020   None :..       
+00013b80: 2020 2020 2063 6f6c 6f72 4d61 7020 3d20       colorMap = 
+00013b90: 7465 6d70 0d0a 2020 2020 2020 2020 656c  temp..        el
+00013ba0: 7365 203a 0d0a 2020 2020 2020 2020 2020  se :..          
+00013bb0: 2020 636f 6c6f 724d 6170 203d 206e 702e    colorMap = np.
+00013bc0: 7768 6572 6528 696e 5669 6577 706f 7274  where(inViewport
+00013bd0: 5b3a 2c20 6e70 2e6e 6577 6178 6973 5d2c  [:, np.newaxis],
+00013be0: 2074 656d 702c 206f 7269 675f 636f 6c6f   temp, orig_colo
+00013bf0: 7273 2029 0d0a 0d0a 2020 2020 2020 2020  rs )....        
+00013c00: 2320 4675 7444 6576 3a20 7365 745f 636f  # FutDev: set_co
+00013c10: 6c6f 7220 7573 6564 2069 6e73 7465 6164  lor used instead
+00013c20: 206f 6620 7365 745f 6661 6365 636f 6c6f   of set_facecolo
+00013c30: 7220 746f 2065 6c69 6d69 6e61 7465 2027  r to eliminate '
+00013c40: 6761 7073 2720 6265 7477 6565 6e20 6661  gaps' between fa
+00013c50: 6365 732c 2020 3c3c 3c3c 3c0d 0a20 2020  ces,  <<<<<..   
+00013c60: 2020 2020 2023 2068 6f77 6576 6572 2c20       # however, 
+00013c70: 7365 7420 6564 6765 636f 6c6f 7220 7265  set edgecolor re
+00013c80: 7175 6972 6564 2061 6674 6572 2069 6c6c  quired after ill
+00013c90: 756d 696e 6174 696f 6e20 6966 2065 6467  umination if edg
+00013ca0: 6573 2061 7265 2074 6f20 6265 2064 6973  es are to be dis
+00013cb0: 706c 6179 6564 2e20 2020 203c 3c3c 3c3c  played.    <<<<<
+00013cc0: 0d0a 2020 2020 2020 2020 2320 484f 5745  ..        # HOWE
+00013cd0: 5645 5220 2121 2121 2020 6966 2063 6f6c  VER !!!!  if col
+00013ce0: 6f72 4d61 7020 6861 7320 6120 616c 7068  orMap has a alph
+00013cf0: 613c 312c 2074 6865 7365 2064 6f6e 2774  a<1, these don't
+00013d00: 2072 6567 6973 7465 7220 7769 7468 2074   register with t
+00013d10: 6865 2065 6467 6573 2e20 2020 2020 2020  he edges.       
+00013d20: 3c3c 3c3c 3c0d 0a0d 0a20 2020 2020 2020  <<<<<....       
+00013d30: 2023 7365 6c66 2e76 6572 7465 7856 616c   #self.vertexVal
+00013d40: 7565 7320 3d20 6420 2020 3c3c 3c3c 204e  ues = d   <<<< N
+00013d50: 4f2e 2e20 696e 7465 7270 6f6c 6174 6564  O.. interpolated
+00013d60: 2076 616c 7565 7320 6f6e 6c79 2069 6e20   values only in 
+00013d70: 7669 6577 706f 7274 2c0d 0a20 2020 2020  viewport,..     
+00013d80: 2020 2073 656c 662e 7665 7274 6578 436f     self.vertexCo
+00013d90: 6c6f 7220 3d20 6e70 2e61 7272 6179 2863  lor = np.array(c
+00013da0: 6f6c 6f72 4d61 7029 0d0a 0d0a 2020 2020  olorMap)....    
+00013db0: 2020 2020 7265 7475 726e 0d0a 0d0a 2020      return....  
+00013dc0: 2020 6465 6620 6d61 705f 636d 6170 5f66    def map_cmap_f
+00013dd0: 726f 6d5f 6461 7461 6772 6964 2873 656c  rom_datagrid(sel
+00013de0: 662c 2064 6174 6167 7269 642c 2063 6d61  f, datagrid, cma
+00013df0: 703d 4e6f 6e65 2c20 7669 6577 706f 7274  p=None, viewport
+00013e00: 3d4e 6f6e 652c 2063 6e61 6d65 3d4e 6f6e  =None, cname=Non
+00013e10: 6529 203a 0d0a 2020 2020 2020 2020 2222  e) :..        ""
+00013e20: 220d 0a20 2020 2020 2020 2046 6163 6520  "..        Face 
+00013e30: 636f 6c6f 7220 6173 7369 676e 6d65 6e74  color assignment
+00013e40: 2075 7369 6e67 2061 2032 4420 6461 7461   using a 2D data
+00013e50: 6772 6964 2073 7572 6661 6365 2e0d 0a20  grid surface... 
+00013e60: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00013e70: 2044 6174 6167 7269 6420 7661 6c75 6573   Datagrid values
+00013e80: 2061 7265 206e 6f72 6d61 6c69 7a65 6420   are normalized 
+00013e90: 696e 2074 6865 2072 616e 6765 2030 2074  in the range 0 t
+00013ea0: 6f20 312e 0d0a 0d0a 2020 2020 2020 2020  o 1.....        
+00013eb0: 5468 6973 206d 6574 686f 6420 6973 206e  This method is n
+00013ec0: 6f74 2061 7661 696c 6162 6c65 2066 6f72  ot available for
+00013ed0: 2063 6f6d 706f 7369 7465 2073 7572 6661   composite surfa
+00013ee0: 6365 732e 0d0a 2020 2020 2020 2020 5468  ces...        Th
+00013ef0: 6520 656e 7469 7265 2064 6174 6167 7269  e entire datagri
+00013f00: 6420 646f 6d61 696e 2069 7320 6170 706c  d domain is appl
+00013f10: 6965 6420 746f 2074 6865 2067 656f 6d65  ied to the geome
+00013f20: 7472 6963 206f 7065 7261 7469 6f6e 2e0d  tric operation..
+00013f30: 0a0d 0a20 2020 2020 2020 2050 6172 616d  ...        Param
+00013f40: 6574 6572 730d 0a20 2020 2020 2020 202d  eters..        -
+00013f50: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
+00013f60: 2020 2064 6174 6167 7269 6420 3a20 3244     datagrid : 2D
+00013f70: 2066 6c6f 6174 2061 7272 6179 0d0a 0d0a   float array....
+00013f80: 2020 2020 2020 2020 636d 6170 203a 2073          cmap : s
+00013f90: 7472 206f 7220 436f 6c6f 726d 6170 2c20  tr or Colormap, 
+00013fa0: 6f70 7469 6f6e 616c 0d0a 2020 2020 2020  optional..      
+00013fb0: 2020 2020 2020 4120 436f 6c6f 726d 6170        A Colormap
+00013fc0: 2069 6e73 7461 6e63 6520 6f72 2072 6567   instance or reg
+00013fd0: 6973 7465 7265 6420 636f 6c6f 726d 6170  istered colormap
+00013fe0: 206e 616d 652e 0d0a 2020 2020 2020 2020   name...        
+00013ff0: 2020 2020 4966 206e 6f74 2061 7373 6967      If not assig
+00014000: 6e65 642c 2074 6865 2073 7572 6661 6365  ned, the surface
+00014010: 2043 6f6c 6f72 6d61 7020 6973 2075 7365   Colormap is use
+00014020: 642e 0d0a 2020 2020 2020 2020 2020 2020  d...            
+00014030: 5468 6520 636f 6c6f 726d 6170 206d 6170  The colormap map
+00014040: 7320 7468 6520 6461 7461 6772 6964 2076  s the datagrid v
+00014050: 616c 7565 7320 746f 2063 6f6c 6f72 732e  alues to colors.
+00014060: 0d0a 0d0a 2020 2020 2020 2020 7669 6577  ....        view
+00014070: 706f 7274 203a 2034 4420 6172 7261 792d  port : 4D array-
+00014080: 6c69 6b65 2c20 6f70 7469 6f6e 616c 2c20  like, optional, 
+00014090: 6465 6661 756c 743a 204e 6f6e 650d 0a20  default: None.. 
+000140a0: 2020 2020 2020 2020 2020 2056 6965 7770             Viewp
+000140b0: 6f72 7420 6465 6669 6e65 7320 7468 6520  ort defines the 
+000140c0: 7375 6264 6f6d 6169 6e20 6f66 2074 6865  subdomain of the
+000140d0: 2073 7572 6661 6365 206f 6e74 6f20 7768   surface onto wh
+000140e0: 6963 680d 0a20 2020 2020 2020 2020 2020  ich..           
+000140f0: 2074 6865 2064 6174 6167 7269 6420 6973   the datagrid is
+00014100: 206d 6170 7065 642e 2020 5468 6520 7375   mapped.  The su
+00014110: 6264 6f6d 6169 6e20 6973 2073 6574 2062  bdomain is set b
+00014120: 7920 6e6f 726d 616c 697a 6564 0d0a 2020  y normalized..  
+00014130: 2020 2020 2020 2020 2020 6e61 7469 7665            native
+00014140: 2073 7572 6661 6365 2063 6f6f 7264 696e   surface coordin
+00014150: 6174 6573 2069 6e20 6120 3444 2061 7272  ates in a 4D arr
+00014160: 6179 2e0d 0a20 2020 2020 2020 2020 2020  ay...           
+00014170: 2054 6865 2065 6e74 6972 6520 7375 7266   The entire surf
+00014180: 6163 6520 6973 2063 6f6c 6f72 6564 2066  ace is colored f
+00014190: 6f72 2074 6865 2064 6566 6175 6c74 206f  or the default o
+000141a0: 6620 4e6f 6e65 2e0d 0a0d 0a20 2020 2020  f None.....     
+000141b0: 2020 2063 6e61 6d65 203a 2073 7472 696e     cname : strin
+000141c0: 672c 206f 7074 696f 6e61 6c2c 2064 6566  g, optional, def
+000141d0: 6175 6c74 3a20 4e6f 6e65 2e0d 0a20 2020  ault: None...   
+000141e0: 2020 2020 2020 2020 2044 6573 6372 6970           Descrip
+000141f0: 7469 7665 2069 6465 6e74 6966 6965 7220  tive identifier 
+00014200: 666f 7220 7661 6c75 6573 2069 6e64 6963  for values indic
+00014210: 6174 6564 2062 7920 636f 6c6f 722e 0d0a  ated by color...
+00014220: 0d0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+00014230: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+00014240: 2d2d 0d0a 2020 2020 2020 2020 7365 6c66  --..        self
+00014250: 203a 2073 7572 6661 6365 206f 626a 6563   : surface objec
+00014260: 740d 0a0d 0a20 2020 2020 2020 2022 2222  t....        """
+00014270: 0d0a 0d0a 2020 2020 2020 2020 6966 2073  ....        if s
+00014280: 656c 662e 5f69 7343 6f6d 706f 7369 7465  elf._isComposite
+00014290: 5375 7266 6163 6520 3a0d 0a20 2020 2020  Surface :..     
+000142a0: 2020 2020 2020 2077 6172 6e69 6e67 732e         warnings.
+000142b0: 7761 726e 2827 4461 7461 6772 6964 206f  warn('Datagrid o
+000142c0: 7065 7261 7469 6f6e 206e 6f74 2061 7661  peration not ava
+000142d0: 696c 6162 6c65 2066 6f72 2063 6f6d 6269  ilable for combi
+000142e0: 6e65 6420 7368 6170 6573 2e27 290d 0a20  ned shapes.').. 
+000142f0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00014300: 6e20 7365 6c66 0d0a 2020 2020 2020 2020  n self..        
+00014310: 6966 2073 656c 662e 5f73 7572 6661 6365  if self._surface
+00014320: 5368 6170 6543 6861 6e67 6564 203a 0d0a  ShapeChanged :..
+00014330: 2020 2020 2020 2020 2020 2020 7761 726e              warn
+00014340: 696e 6773 2e77 6172 6e28 2744 6174 6167  ings.warn('Datag
+00014350: 7269 6420 6f70 6572 6174 696f 6e20 6d61  rid operation ma
+00014360: 7920 6265 2061 6e6f 6d61 6c6f 7573 2061  y be anomalous a
+00014370: 6674 6572 2073 6861 7065 206d 6f64 6966  fter shape modif
+00014380: 6963 6174 696f 6e2e 2729 0d0a 0d0a 2020  ication.')....  
+00014390: 2020 2020 2020 7665 7274 7320 3d20 7365        verts = se
+000143a0: 6c66 2e76 6572 7465 7843 6f6f 725b 2073  lf.vertexCoor[ s
+000143b0: 656c 662e 6676 496e 6469 6365 7320 5d0d  elf.fvIndices ].
+000143c0: 0a20 2020 2020 2020 2066 6163 6543 656e  .        faceCen
+000143d0: 7465 7243 6f6f 7220 3d20 7365 6c66 2e5f  terCoor = self._
+000143e0: 6765 745f 6661 6365 5f63 656e 7465 7273  get_face_centers
+000143f0: 2876 6572 7473 290d 0a20 2020 2020 2020  (verts)..       
+00014400: 2061 2c62 2c69 6e56 6965 7770 6f72 7420   a,b,inViewport 
+00014410: 3d20 7365 6c66 2e5f 7669 6577 706f 7274  = self._viewport
+00014420: 436f 6f72 2866 6163 6543 656e 7465 7243  Coor(faceCenterC
+00014430: 6f6f 722c 7669 6577 706f 7274 2920 2020  oor,viewport)   
+00014440: 2020 200d 0a20 2020 2020 2020 2064 6174     ..        dat
+00014450: 6120 3d20 6461 7461 6772 6964 0d0a 2020  a = datagrid..  
+00014460: 2020 2020 2020 646d 6178 203d 206e 702e        dmax = np.
+00014470: 616d 6178 2864 6174 6167 7269 6429 0d0a  amax(datagrid)..
+00014480: 2020 2020 2020 2020 646d 696e 203d 206e          dmin = n
+00014490: 702e 616d 696e 2864 6174 6167 7269 6429  p.amin(datagrid)
+000144a0: 0d0a 2020 2020 2020 2020 7864 203d 206e  ..        xd = n
+000144b0: 702e 6c69 6e73 7061 6365 2830 2c20 312c  p.linspace(0, 1,
+000144c0: 2064 6174 612e 7368 6170 655b 305d 2029   data.shape[0] )
+000144d0: 0d0a 2020 2020 2020 2020 7964 203d 206e  ..        yd = n
+000144e0: 702e 6c69 6e73 7061 6365 2830 2c20 312c  p.linspace(0, 1,
+000144f0: 2064 6174 612e 7368 6170 655b 315d 2029   data.shape[1] )
+00014500: 0d0a 2020 2020 2020 2020 6720 3d20 2069  ..        g =  i
+00014510: 6e74 6572 706f 6c61 7465 2e69 6e74 6572  nterpolate.inter
+00014520: 7032 6428 7964 2c20 7864 2c20 6461 7461  p2d(yd, xd, data
+00014530: 2c20 6b69 6e64 3d27 6375 6269 6327 290d  , kind='cubic').
+00014540: 0a20 2020 2020 2020 2064 203d 205b 5d0d  .        d = [].
+00014550: 0a20 2020 2020 2020 2023 2046 7574 4465  .        # FutDe
+00014560: 763a 2075 7365 206e 756d 7079 206d 6574  v: use numpy met
+00014570: 686f 6473 2074 6f20 6f70 7469 6d69 7a65  hods to optimize
+00014580: 2065 6666 6963 6965 6e63 792e 0d0a 2020   efficiency...  
+00014590: 2020 2020 2020 666f 7220 6162 2069 6e20        for ab in 
+000145a0: 6e70 2e74 7261 6e73 706f 7365 285b 612c  np.transpose([a,
+000145b0: 625d 2920 3a0d 0a20 2020 2020 2020 2020  b]) :..         
+000145c0: 2020 2064 2e61 7070 656e 6428 2067 2861     d.append( g(a
+000145d0: 625b 305d 2c61 625b 315d 295b 305d 2029  b[0],ab[1])[0] )
+000145e0: 2020 200d 0a20 2020 2020 2020 2064 203d     ..        d =
+000145f0: 206e 702e 7768 6572 6528 696e 5669 6577   np.where(inView
+00014600: 706f 7274 2c64 2c6e 702e 6675 6c6c 286c  port,d,np.full(l
+00014610: 656e 2864 292c 646d 696e 2929 0d0a 2020  en(d),dmin))..  
+00014620: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00014630: 6966 2063 6d61 7020 6973 206e 6f74 204e  if cmap is not N
+00014640: 6f6e 6520 3a0d 0a20 2020 2020 2020 2020  one :..         
+00014650: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+00014660: 2863 6d61 702c 7374 7229 203a 200d 0a20  (cmap,str) : .. 
+00014670: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00014680: 656c 662e 7365 745f 636d 6170 2863 6d2e  elf.set_cmap(cm.
+00014690: 6765 745f 636d 6170 2863 6d61 7029 290d  get_cmap(cmap)).
+000146a0: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+000146b0: 6520 3a0d 0a20 2020 2020 2020 2020 2020  e :..           
+000146c0: 2020 2020 2073 656c 662e 7365 745f 636d       self.set_cm
+000146d0: 6170 2863 6d61 7029 0d0a 2020 2020 2020  ap(cmap)..      
+000146e0: 2020 636d 6170 203d 2073 656c 662e 6765    cmap = self.ge
+000146f0: 745f 636d 6170 2829 0d0a 2020 2020 2020  t_cmap()..      
+00014700: 2020 0d0a 2020 2020 2020 2020 6f72 6967    ..        orig
+00014710: 5f63 6f6c 6f72 7320 3d20 7365 6c66 2e5f  _colors = self._
+00014720: 6466 6163 6563 6f6c 6f72 7320 2023 2075  dfacecolors  # u
+00014730: 7064 6174 6520 666f 7220 765f 312e 322e  pdate for v_1.2.
+00014740: 300d 0a0d 0a20 2020 2020 2020 2069 6620  0....        if 
+00014750: 6c65 6e28 6f72 6967 5f63 6f6c 6f72 7329  len(orig_colors)
+00014760: 203d 3d20 3120 3a0d 0a20 2020 2020 2020   == 1 :..       
+00014770: 2020 2020 206f 6e65 6172 7220 3d20 6e70       onearr = np
+00014780: 2e6f 6e65 7328 206c 656e 2866 6163 6543  .ones( len(faceC
+00014790: 656e 7465 7243 6f6f 7229 2029 5b3a 2c20  enterCoor) )[:, 
+000147a0: 6e70 2e6e 6577 6178 6973 5d0d 0a20 2020  np.newaxis]..   
+000147b0: 2020 2020 2020 2020 206f 7269 675f 636f           orig_co
+000147c0: 6c6f 7273 203d 206f 7269 675f 636f 6c6f  lors = orig_colo
+000147d0: 7273 2a6f 6e65 6172 7220 2020 2020 2020  rs*onearr       
+000147e0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+000147f0: 2020 2020 6e6f 726d 203d 2063 6f6c 6f72      norm = color
+00014800: 732e 4e6f 726d 616c 697a 6528 646d 696e  s.Normalize(dmin
+00014810: 2c64 6d61 7829 0d0a 2020 2020 2020 2020  ,dmax)..        
+00014820: 7465 6d70 203d 2063 6d61 7028 6e6f 726d  temp = cmap(norm
+00014830: 2864 2929 0d0a 2020 2020 2020 2020 6966  (d))..        if
+00014840: 2076 6965 7770 6f72 7420 6973 204e 6f6e   viewport is Non
+00014850: 6520 3a0d 0a20 2020 2020 2020 2020 2020  e :..           
+00014860: 2063 6f6c 6f72 4d61 7020 3d20 7465 6d70   colorMap = temp
+00014870: 0d0a 2020 2020 2020 2020 656c 7365 203a  ..        else :
+00014880: 0d0a 2020 2020 2020 2020 2020 2020 636f  ..            co
+00014890: 6c6f 724d 6170 203d 206e 702e 7768 6572  lorMap = np.wher
+000148a0: 6528 696e 5669 6577 706f 7274 5b3a 2c20  e(inViewport[:, 
+000148b0: 6e70 2e6e 6577 6178 6973 5d2c 2074 656d  np.newaxis], tem
+000148c0: 702c 206f 7269 675f 636f 6c6f 7273 2029  p, orig_colors )
+000148d0: 0d0a 0d0a 2020 2020 2020 2020 2320 4675  ....        # Fu
+000148e0: 7444 6576 3a20 7365 745f 636f 6c6f 7220  tDev: set_color 
+000148f0: 7573 6564 2069 6e73 7465 6164 206f 6620  used instead of 
+00014900: 7365 745f 6661 6365 636f 6c6f 7220 746f  set_facecolor to
+00014910: 2065 6c69 6d69 6e61 7465 2027 6761 7073   eliminate 'gaps
+00014920: 2720 6265 7477 6565 6e20 6661 6365 732c  ' between faces,
+00014930: 0d0a 2020 2020 2020 2020 2320 686f 7765  ..        # howe
+00014940: 7665 722c 2073 6574 2065 6467 6563 6f6c  ver, set edgecol
+00014950: 6f72 2072 6571 7569 7265 6420 6166 7465  or required afte
+00014960: 7220 696c 6c75 6d69 6e61 7469 6f6e 2069  r illumination i
+00014970: 6620 6564 6765 7320 6172 6520 746f 2062  f edges are to b
+00014980: 6520 6469 7370 6c61 7965 642e 0d0a 2020  e displayed...  
+00014990: 2020 2020 2020 2320 484f 5745 5645 5220        # HOWEVER 
+000149a0: 2121 2121 2020 6966 2063 6f6c 6f72 4d61  !!!!  if colorMa
+000149b0: 7020 6861 7320 6120 616c 7068 613c 312c  p has a alpha<1,
+000149c0: 2074 6865 7365 2064 6f6e 2774 2072 6567   these don't reg
+000149d0: 6973 7465 7220 7769 7468 2074 6865 2065  ister with the e
+000149e0: 6467 6573 2e0d 0a20 2020 2020 2020 2073  dges...        s
+000149f0: 656c 662e 7365 745f 636f 6c6f 7228 636f  elf.set_color(co
+00014a00: 6c6f 724d 6170 290d 0a20 2020 2020 2020  lorMap)..       
+00014a10: 2073 656c 662e 6973 5375 7266 6163 6543   self.isSurfaceC
+00014a20: 6f6c 6f72 6564 203d 2054 7275 650d 0a20  olored = True.. 
+00014a30: 2020 2020 2020 2073 656c 662e 5f62 6f75         self._bou
+00014a40: 6e64 735b 2776 6c69 6d27 5d20 3d20 5b20  nds['vlim'] = [ 
+00014a50: 646d 696e 2c20 646d 6178 205d 0d0a 0d0a  dmin, dmax ]....
+00014a60: 2020 2020 2020 2020 7365 6c66 2e76 616c          self.val
+00014a70: 7565 734e 616d 6520 3d20 636e 616d 650d  uesName = cname.
+00014a80: 0a20 2020 2020 2020 2023 203d 3d3d 3d3d  .        # =====
+00014a90: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00014aa0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00014ab0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00014ac0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00014ad0: 3d3d 3d0d 0a20 2020 2020 2020 2073 656c  ===..        sel
+00014ae0: 662e 5f6d 6170 5f63 6d61 705f 6672 6f6d  f._map_cmap_from
+00014af0: 5f64 6174 6167 7269 645f 7665 7274 2864  _datagrid_vert(d
+00014b00: 6174 6167 7269 642c 2063 6d61 702c 2076  atagrid, cmap, v
+00014b10: 6965 7770 6f72 7420 290d 0a20 2020 2020  iewport )..     
+00014b20: 2020 2023 203d 3d3d 3d3d 3d3d 3d3d 3d3d     # ===========
+00014b30: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00014b40: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00014b50: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00014b60: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d 0a0d  =============...
+00014b70: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00014b80: 7365 6c66 0d0a 0d0a 2020 2020 6465 6620  self....    def 
+00014b90: 5f67 6574 436f 6c6f 724d 6170 5f66 726f  _getColorMap_fro
+00014ba0: 6d4e 6f72 6d61 6c73 2873 656c 662c 6676  mNormals(self,fv
+00014bb0: 6f2c 636d 6170 2c20 6469 7265 6374 696f  o,cmap, directio
+00014bc0: 6e2c 2069 7341 6273 2920 3a0d 0a20 2020  n, isAbs) :..   
+00014bd0: 2020 2020 2022 2222 2075 7365 6420 6279       """ used by
+00014be0: 206d 6170 5f63 6d61 705f 6672 6f6d 5f6e   map_cmap_from_n
+00014bf0: 6f72 6d61 6c73 2829 2026 205f 6d61 705f  ormals() & _map_
+00014c00: 636d 6170 5f66 726f 6d5f 6e6f 726d 616c  cmap_from_normal
+00014c10: 735f 7665 7274 2829 2022 2222 0d0a 2020  s_vert() """..  
+00014c20: 2020 2020 2020 756e 6974 5665 6374 6f72        unitVector
+00014c30: 203d 206c 616d 6264 6120 7620 3a20 6e70   = lambda v : np
+00014c40: 2e64 6976 6964 6528 2076 2c20 6e70 2e6c  .divide( v, np.l
+00014c50: 696e 616c 672e 6e6f 726d 2876 2920 290d  inalg.norm(v) ).
+00014c60: 0a20 2020 2020 2020 2069 6e63 6964 656e  .        inciden
+00014c70: 744c 6967 6874 203d 2075 6e69 7456 6563  tLight = unitVec
+00014c80: 746f 7228 2064 6972 6563 7469 6f6e 2029  tor( direction )
+00014c90: 0d0a 2020 2020 2020 2020 6420 3d20 6e70  ..        d = np
+00014ca0: 2e64 6f74 2866 766f 2c69 6e63 6964 656e  .dot(fvo,inciden
+00014cb0: 744c 6967 6874 290d 0a20 2020 2020 2020  tLight)..       
+00014cc0: 2069 6620 6973 4162 7320 3a20 7620 3d20   if isAbs : v = 
+00014cd0: 3120 2d20 6e70 2e61 6273 2864 290d 0a20  1 - np.abs(d).. 
+00014ce0: 2020 2020 2020 2065 6c73 6520 3a0d 0a20         else :.. 
+00014cf0: 2020 2020 2020 2020 2020 2076 203d 2028             v = (
+00014d00: 2064 202b 2031 2029 2f32 0d0a 2020 2020   d + 1 )/2..    
+00014d10: 2020 2020 7620 3d20 6e70 2e61 6273 2876      v = np.abs(v
+00014d20: 2920 2023 2074 6f20 696e 7375 7265 2070  )  # to insure p
+00014d30: 6f73 6974 6976 6520 7661 6c75 6573 206e  ositive values n
+00014d40: 6561 7220 7a65 726f 0d0a 2020 2020 2020  ear zero..      
+00014d50: 2020 636f 6c6f 724d 6170 203d 2063 6d61    colorMap = cma
+00014d60: 7028 7629 0d0a 2020 2020 2020 2020 7265  p(v)..        re
+00014d70: 7475 726e 2063 6f6c 6f72 4d61 700d 0a0d  turn colorMap...
+00014d80: 0a20 2020 2064 6566 205f 6d61 705f 636d  .    def _map_cm
+00014d90: 6170 5f66 726f 6d5f 6e6f 726d 616c 735f  ap_from_normals_
+00014da0: 7665 7274 2873 656c 662c 2063 6d61 702c  vert(self, cmap,
+00014db0: 2064 6972 6563 7469 6f6e 2c20 6973 4162   direction, isAb
+00014dc0: 7329 203a 0d0a 2020 2020 2020 2020 766f  s) :..        vo
+00014dd0: 626a 203d 2073 656c 662e 5f67 6574 5f76  bj = self._get_v
+00014de0: 6572 7465 785f 6e6f 726d 616c 7328 290d  ertex_normals().
+00014df0: 0a20 2020 2020 2020 2063 4d61 7020 3d20  .        cMap = 
+00014e00: 7365 6c66 2e5f 6765 7443 6f6c 6f72 4d61  self._getColorMa
+00014e10: 705f 6672 6f6d 4e6f 726d 616c 7328 766f  p_fromNormals(vo
+00014e20: 626a 2c20 636d 6170 2c20 6469 7265 6374  bj, cmap, direct
+00014e30: 696f 6e2c 2069 7341 6273 290d 0a20 2020  ion, isAbs)..   
+00014e40: 2020 2020 2073 656c 662e 7665 7274 6578       self.vertex
+00014e50: 436f 6c6f 7220 3d20 6e70 2e61 7272 6179  Color = np.array
+00014e60: 2863 4d61 7029 0d0a 2020 2020 2020 2020  (cMap)..        
+00014e70: 7265 7475 726e 0d0a 0d0a 2020 2020 6465  return....    de
+00014e80: 6620 6d61 705f 636d 6170 5f66 726f 6d5f  f map_cmap_from_
+00014e90: 6e6f 726d 616c 7328 7365 6c66 2c20 636d  normals(self, cm
+00014ea0: 6170 3d4e 6f6e 652c 2064 6972 6563 7469  ap=None, directi
+00014eb0: 6f6e 3d4e 6f6e 652c 2063 6e61 6d65 3d4e  on=None, cname=N
+00014ec0: 6f6e 652c 2069 7341 6273 3d46 616c 7365  one, isAbs=False
+00014ed0: 2920 3a0d 0a20 2020 2020 2020 2022 2222  ) :..        """
+00014ee0: 0d0a 2020 2020 2020 2020 4661 6365 2063  ..        Face c
+00014ef0: 6f6c 6f72 2061 7373 6967 6e6d 656e 7420  olor assignment 
+00014f00: 7573 696e 6720 6e6f 726d 616c 7320 7265  using normals re
+00014f10: 6c61 7469 7665 2074 6f20 6120 6469 7265  lative to a dire
+00014f20: 6374 696f 6e2e 0d0a 0d0a 2020 2020 2020  ction.....      
+00014f30: 2020 5468 6520 646f 7420 7072 6f64 7563    The dot produc
+00014f40: 7420 6f66 2066 6163 6520 6e6f 726d 616c  t of face normal
+00014f50: 7320 7769 7468 2074 6865 2064 6972 6563  s with the direc
+00014f60: 7469 6f6e 200d 0a20 2020 2020 2020 2069  tion ..        i
+00014f70: 7320 7573 6564 2074 6f20 6173 7369 676e  s used to assign
+00014f80: 2066 6163 6520 636f 6c6f 7273 2066 726f   face colors fro
+00014f90: 6d20 6120 636f 6c6f 726d 6170 2e0d 0a0d  m a colormap....
+00014fa0: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+00014fb0: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
+00014fc0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
+00014fd0: 2063 6d61 7020 3a20 7374 7220 6f72 2043   cmap : str or C
+00014fe0: 6f6c 6f72 6d61 702c 206f 7074 696f 6e61  olormap, optiona
+00014ff0: 6c0d 0a20 2020 2020 2020 2020 2020 2041  l..            A
+00015000: 2043 6f6c 6f72 6d61 7020 696e 7374 616e   Colormap instan
+00015010: 6365 206f 7220 7265 6769 7374 6572 6564  ce or registered
+00015020: 2063 6f6c 6f72 6d61 7020 6e61 6d65 2e0d   colormap name..
+00015030: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
+00015040: 6e6f 7420 6173 7369 676e 6564 2c20 7468  not assigned, th
+00015050: 6520 7375 7266 6163 6520 436f 6c6f 726d  e surface Colorm
+00015060: 6170 2069 7320 7573 6564 2e0d 0a20 2020  ap is used...   
+00015070: 2020 2020 2020 2020 2054 6865 2063 6f6c           The col
+00015080: 6f72 6d61 7020 6d61 7073 2074 6865 2064  ormap maps the d
+00015090: 6f74 2070 726f 6475 6374 2076 616c 7565  ot product value
+000150a0: 7320 746f 2063 6f6c 6f72 732e 0d0a 2020  s to colors...  
+000150b0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+000150c0: 6469 7265 6374 696f 6e20 3a20 6c69 7374  direction : list
+000150d0: 206f 6620 7369 7a65 2033 2c20 6f70 7469   of size 3, opti
+000150e0: 6f6e 616c 2c20 6465 6661 756c 743a 205b  onal, default: [
+000150f0: 312c 302c 315d 0d0a 2020 2020 2020 2020  1,0,1]..        
+00015100: 2020 2020 4120 3344 2076 6563 746f 7220      A 3D vector 
+00015110: 696e 2078 797a 2043 6172 7465 7369 616e  in xyz Cartesian
+00015120: 2063 6f6f 7264 696e 6174 6573 2064 6573   coordinates des
+00015130: 6967 6e61 7469 6e67 0d0a 2020 2020 2020  ignating..      
+00015140: 2020 2020 2020 7468 6520 6469 7265 6374        the direct
+00015150: 696f 6e20 6f66 2074 6865 2069 6c6c 756d  ion of the illum
+00015160: 696e 6174 696f 6e20 736f 7572 6365 2e0d  ination source..
+00015170: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
+00015180: 6173 7369 676e 6564 2074 6865 2041 7865  assigned the Axe
+00015190: 7333 442c 2077 696c 6c20 7573 6520 7468  s3D, will use th
+000151a0: 6520 7669 6577 2064 6972 6563 7469 6f6e  e view direction
+000151b0: 2e0d 0a0d 0a20 2020 2020 2020 2063 6e61  .....        cna
+000151c0: 6d65 203a 2073 7472 696e 672c 206f 7074  me : string, opt
+000151d0: 696f 6e61 6c2c 2064 6566 6175 6c74 3a20  ional, default: 
+000151e0: 4e6f 6e65 2e0d 0a20 2020 2020 2020 2020  None...         
+000151f0: 2020 2044 6573 6372 6970 7469 7665 2069     Descriptive i
+00015200: 6465 6e74 6966 6965 7220 666f 7220 7661  dentifier for va
+00015210: 6c75 6573 2069 6e64 6963 6174 6564 2062  lues indicated b
+00015220: 7920 636f 6c6f 722e 0d0a 0d0a 2020 2020  y color.....    
+00015230: 2020 2020 6973 4162 7320 3a20 626f 6f6c      isAbs : bool
+00015240: 6561 6e2c 206f 7074 696f 6e61 6c2c 2064  ean, optional, d
+00015250: 6566 6175 6c74 3a20 4661 6c73 650d 0a20  efault: False.. 
+00015260: 2020 2020 2020 2020 2020 2049 6620 7365             If se
+00015270: 7420 5472 7565 2c20 7468 6520 6162 736f  t True, the abso
+00015280: 6c75 7465 2076 616c 7565 206f 6620 7468  lute value of th
+00015290: 6520 646f 7420 7072 6f64 7563 740d 0a20  e dot product.. 
+000152a0: 2020 2020 2020 2020 2020 2062 6574 7765             betwe
+000152b0: 656e 2066 6163 6520 6e6f 726d 616c 7320  en face normals 
+000152c0: 616e 6420 696c 6c75 6d69 6e61 7469 6f6e  and illumination
+000152d0: 2064 6972 6563 7469 6f6e 2069 730d 0a20   direction is.. 
+000152e0: 2020 2020 2020 2020 2020 2075 7365 642e             used.
+000152f0: 0d0a 0d0a 2020 2020 2020 2020 5265 7475  ....        Retu
+00015300: 726e 730d 0a20 2020 2020 2020 202d 2d2d  rns..        ---
+00015310: 2d2d 2d2d 0d0a 2020 2020 2020 2020 7365  ----..        se
+00015320: 6c66 203a 2073 7572 6661 6365 206f 626a  lf : surface obj
+00015330: 6563 740d 0a0d 0a20 2020 2020 2020 2022  ect....        "
+00015340: 2222 0d0a 2020 2020 2020 2020 6966 2064  ""..        if d
+00015350: 6972 6563 7469 6f6e 2069 7320 6e6f 7420  irection is not 
+00015360: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2020  None:..         
+00015370: 2020 2074 656d 7020 3d20 6469 7265 6374     temp = direct
+00015380: 696f 6e0d 0a20 2020 2020 2020 2020 2020  ion..           
+00015390: 2074 7279 203a 2020 2320 6368 6563 6b20   try :  # check 
+000153a0: 6966 2064 6972 6563 7469 6f6e 2068 6f6c  if direction hol
+000153b0: 6473 2074 6865 2065 6c65 762c 2061 7a69  ds the elev, azi
+000153c0: 6d20 2869 652e 2033 4420 6178 6973 290d  m (ie. 3D axis).
+000153d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000153e0: 2065 6c65 762c 617a 696d 203d 2074 656d   elev,azim = tem
+000153f0: 702e 656c 6576 2c20 7465 6d70 2e61 7a69  p.elev, temp.azi
+00015400: 6d0d 0a20 2020 2020 2020 2020 2020 2020  m..             
+00015410: 2020 2064 6972 6563 7469 6f6e 203d 2065     direction = e
+00015420: 6c65 765f 617a 696d 5f32 7665 6374 6f72  lev_azim_2vector
+00015430: 2865 6c65 762c 617a 696d 290d 0a20 2020  (elev,azim)..   
+00015440: 2020 2020 2020 2020 2065 7863 6570 7420           except 
+00015450: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00015460: 2020 2064 6972 6563 7469 6f6e 203d 2074     direction = t
+00015470: 656d 700d 0a20 2020 2020 2020 2020 2020  emp..           
+00015480: 2020 2020 2069 6620 6c65 6e28 6469 7265       if len(dire
+00015490: 6374 696f 6e29 2021 3d20 3320 3a0d 0a20  ction) != 3 :.. 
+000154a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000154b0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+000154c0: 726f 7228 2743 6d61 7020 6672 6f6d 206e  ror('Cmap from n
+000154d0: 6f72 6d61 6c73 2064 6972 6563 7469 6f6e  ormals direction
+000154e0: 206d 7573 7420 6265 2061 2061 7272 6179   must be a array
+000154f0: 206f 6620 6c65 6e67 7468 2033 2c20 6f72   of length 3, or
+00015500: 2061 204d 6174 706c 6f74 6c69 6220 4178   a Matplotlib Ax
+00015510: 6573 3344 206f 626a 6563 742e 2729 0d0a  es3D object.')..
+00015520: 2020 2020 2020 2020 656c 7365 203a 2064          else : d
+00015530: 6972 6563 7469 6f6e 203d 205f 494c 4c55  irection = _ILLU
+00015540: 4d0d 0a0d 0a20 2020 2020 2020 2069 6620  M....        if 
+00015550: 636d 6170 2069 7320 6e6f 7420 4e6f 6e65  cmap is not None
+00015560: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
+00015570: 6966 2069 7369 6e73 7461 6e63 6528 636d  if isinstance(cm
+00015580: 6170 2c73 7472 2920 3a20 0d0a 2020 2020  ap,str) : ..    
+00015590: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000155a0: 2e73 6574 5f63 6d61 7028 636d 2e67 6574  .set_cmap(cm.get
+000155b0: 5f63 6d61 7028 636d 6170 2929 0d0a 2020  _cmap(cmap))..  
+000155c0: 2020 2020 2020 2020 2020 656c 7365 203a            else :
+000155d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000155e0: 2020 7365 6c66 2e73 6574 5f63 6d61 7028    self.set_cmap(
+000155f0: 636d 6170 290d 0a20 2020 2020 2020 2063  cmap)..        c
+00015600: 6d5f 636f 6c6f 724d 6170 203d 2073 656c  m_colorMap = sel
+00015610: 662e 6765 745f 636d 6170 2829 0d0a 0d0a  f.get_cmap()....
+00015620: 2020 2020 2020 2020 7665 7274 7320 3d20          verts = 
+00015630: 7365 6c66 2e76 6572 7465 7843 6f6f 725b  self.vertexCoor[
+00015640: 2073 656c 662e 6676 496e 6469 6365 7320   self.fvIndices 
+00015650: 5d0d 0a20 2020 2020 2020 2066 766f 626a  ]..        fvobj
+00015660: 203d 2073 656c 662e 5f67 6574 5f66 6163   = self._get_fac
+00015670: 655f 6e6f 726d 616c 7328 7665 7274 7329  e_normals(verts)
+00015680: 0d0a 2020 2020 2020 2020 634d 6170 203d  ..        cMap =
+00015690: 2073 656c 662e 5f67 6574 436f 6c6f 724d   self._getColorM
+000156a0: 6170 5f66 726f 6d4e 6f72 6d61 6c73 2866  ap_fromNormals(f
+000156b0: 766f 626a 2c20 636d 5f63 6f6c 6f72 4d61  vobj, cm_colorMa
+000156c0: 702c 2064 6972 6563 7469 6f6e 2c20 6973  p, direction, is
+000156d0: 4162 7329 0d0a 2020 2020 2020 2020 7365  Abs)..        se
+000156e0: 6c66 2e73 6574 5f63 6d61 7028 636d 5f63  lf.set_cmap(cm_c
+000156f0: 6f6c 6f72 4d61 7029 0d0a 2020 2020 2020  olorMap)..      
+00015700: 2020 7365 6c66 2e73 6574 5f63 6f6c 6f72    self.set_color
+00015710: 2863 4d61 7029 0d0a 2020 2020 2020 2020  (cMap)..        
+00015720: 7365 6c66 2e69 7353 7572 6661 6365 436f  self.isSurfaceCo
+00015730: 6c6f 7265 6420 3d20 5472 7565 0d0a 2020  lored = True..  
+00015740: 2020 2020 2020 7365 6c66 2e6f 6e6c 7943        self.onlyC
+00015750: 6f6c 6f72 6564 4661 6365 7320 3d20 5472  oloredFaces = Tr
+00015760: 7565 0d0a 0d0a 2020 2020 2020 2020 7365  ue....        se
+00015770: 6c66 2e76 616c 7565 734e 616d 6520 3d20  lf.valuesName = 
+00015780: 636e 616d 650d 0a20 2020 2020 2020 2023  cname..        #
+00015790: 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d   ===============
+000157a0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000157b0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000157c0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000157d0: 3d3d 3d3d 3d3d 3d3d 3d0d 0a20 2020 2020  =========..     
+000157e0: 2020 2073 656c 662e 5f6d 6170 5f63 6d61     self._map_cma
+000157f0: 705f 6672 6f6d 5f6e 6f72 6d61 6c73 5f76  p_from_normals_v
+00015800: 6572 7428 2063 6d5f 636f 6c6f 724d 6170  ert( cm_colorMap
+00015810: 2c20 6469 7265 6374 696f 6e2c 2069 7341  , direction, isA
+00015820: 6273 2029 0d0a 2020 2020 2020 2020 2320  bs )..        # 
+00015830: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00015840: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00015850: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00015860: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00015870: 3d3d 3d3d 3d3d 3d3d 0d0a 0d0a 2020 2020  ========....    
+00015880: 2020 2020 7265 7475 726e 2073 656c 660d      return self.
+00015890: 0a0d 0a20 2020 2064 6566 205f 6d61 705f  ...    def _map_
+000158a0: 636d 6170 5f66 726f 6d5f 6f70 5f76 6572  cmap_from_op_ver
+000158b0: 7428 7365 6c66 2c20 6f70 6572 6174 696f  t(self, operatio
+000158c0: 6e2c 2063 6d61 7029 203a 0d0a 2020 2020  n, cmap) :..    
+000158d0: 2020 2020 0d0a 2020 2020 2020 2020 7879      ..        xy
+000158e0: 7a20 3d20 6e70 2e74 7261 6e73 706f 7365  z = np.transpose
+000158f0: 2873 656c 662e 7665 7274 6578 436f 6f72  (self.vertexCoor
+00015900: 290d 0a20 2020 2020 2020 2023 202e 2e2e  )..        # ...
+00015910: 2e2e 0d0a 2020 2020 2020 2020 6162 6320  ....        abc 
+00015920: 3d20 7365 6c66 2e63 6f6f 725f 636f 6e76  = self.coor_conv
+00015930: 6572 7428 7879 7a29 0d0a 2020 2020 2020  ert(xyz)..      
+00015940: 2020 7620 3d20 6e70 2e61 7272 6179 286f    v = np.array(o
+00015950: 7065 7261 7469 6f6e 2861 6263 2929 0d0a  peration(abc))..
+00015960: 2020 2020 2020 2020 7365 6c66 2e76 6572          self.ver
+00015970: 7465 7856 616c 7565 7320 3d20 760d 0a20  texValues = v.. 
+00015980: 2020 2020 2020 206e 6f72 6d20 3d20 636f         norm = co
+00015990: 6c6f 7273 2e4e 6f72 6d61 6c69 7a65 2876  lors.Normalize(v
+000159a0: 6d69 6e3d 762e 6d69 6e28 292c 766d 6178  min=v.min(),vmax
+000159b0: 3d76 2e6d 6178 2829 290d 0a20 2020 2020  =v.max())..     
+000159c0: 2020 2063 6f6c 6f72 4d61 7020 3d20 636d     colorMap = cm
+000159d0: 6170 286e 6f72 6d28 7629 290d 0a20 2020  ap(norm(v))..   
+000159e0: 2020 2020 2073 656c 662e 7665 7274 6578       self.vertex
+000159f0: 436f 6c6f 7220 3d20 636f 6c6f 724d 6170  Color = colorMap
+00015a00: 0d0a 2020 2020 2020 2020 636f 6c6f 724d  ..        colorM
+00015a10: 6170 203d 206e 702e 6172 7261 7928 636f  ap = np.array(co
+00015a20: 6c6f 724d 6170 290d 0a0d 0a20 2020 2020  lorMap)....     
+00015a30: 2020 2073 656c 662e 5f62 6f75 6e64 735b     self._bounds[
+00015a40: 2776 6572 7476 6c69 6d27 5d20 3d20 5b20  'vertvlim'] = [ 
+00015a50: 762e 6d69 6e28 292c 2076 2e6d 6178 2829  v.min(), v.max()
+00015a60: 205d 0d0a 0d0a 2020 2020 2020 2020 7265   ]....        re
+00015a70: 7475 726e 200d 0a0d 0a20 2020 2064 6566  turn ....    def
+00015a80: 206d 6170 5f63 6d61 705f 6672 6f6d 5f6f   map_cmap_from_o
+00015a90: 7028 7365 6c66 2c20 6f70 6572 6174 696f  p(self, operatio
+00015aa0: 6e3d 4e6f 6e65 2c20 636d 6170 3d4e 6f6e  n=None, cmap=Non
+00015ab0: 652c 2063 6e61 6d65 3d4e 6f6e 6529 203a  e, cname=None) :
+00015ac0: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
+00015ad0: 2020 2020 2020 2046 756e 6374 696f 6e61         Functiona
+00015ae0: 6c20 6173 7369 676e 6d65 6e74 206f 6620  l assignment of 
+00015af0: 6120 636f 6c6f 7220 6672 6f6d 2061 2063  a color from a c
+00015b00: 6f6c 6f72 206d 6170 2e0d 0a0d 0a20 2020  olor map.....   
+00015b10: 2020 2020 2046 6163 6520 636f 6f72 6469       Face coordi
+00015b20: 6e61 7465 7320 6172 6520 7573 6564 2074  nates are used t
+00015b30: 6f20 6361 6c63 756c 6174 6520 6120 7363  o calculate a sc
+00015b40: 616c 6172 200d 0a20 2020 2020 2020 2077  alar ..        w
+00015b50: 6869 6368 2069 7320 7468 656e 2075 7365  hich is then use
+00015b60: 6420 746f 2061 7373 6967 6e20 6661 6365  d to assign face
+00015b70: 2063 6f6c 6f72 7320 6672 6f6d 2061 0d0a   colors from a..
+00015b80: 2020 2020 2020 2020 636f 6c6f 726d 6170          colormap
+00015b90: 2e0d 0a0d 0a20 2020 2020 2020 2050 6172  .....        Par
+00015ba0: 616d 6574 6572 730d 0a20 2020 2020 2020  ameters..       
+00015bb0: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
+00015bc0: 2020 2020 206f 7065 7261 7469 6f6e 203a       operation :
+00015bd0: 2066 756e 6374 696f 6e20 6f62 6a65 6374   function object
+00015be0: 2c20 6465 6661 756c 7420 3a20 4e6f 6e65  , default : None
+00015bf0: 0d0a 2020 2020 2020 2020 2020 2020 4675  ..            Fu
+00015c00: 6e63 7469 6f6e 2074 6861 7420 7461 6b65  nction that take
+00015c10: 7320 6f6e 6520 6172 6775 6d65 6e74 2c0d  s one argument,.
+00015c20: 0a20 2020 2020 2020 2020 2020 2061 2033  .            a 3
+00015c30: 784e 204e 756d 7079 2061 7272 6179 206f  xN Numpy array o
+00015c40: 6620 6e61 7469 7665 2063 6f6f 7264 696e  f native coordin
+00015c50: 6174 6573 2e0d 0a20 2020 2020 2020 2020  ates...         
+00015c60: 2020 2054 6865 2066 756e 6374 696f 6e20     The function 
+00015c70: 7265 7475 726e 7320 6120 4e75 6d70 7920  returns a Numpy 
+00015c80: 6172 7261 7920 6f66 2073 6361 6c61 7220  array of scalar 
+00015c90: 7661 6c75 6573 2e0d 0a20 2020 2020 2020  values...       
+00015ca0: 2020 2020 2049 6620 6675 6e63 7469 6f6e       If function
+00015cb0: 2069 7320 4e6f 6e65 2c20 6675 6e63 7469   is None, functi
+00015cc0: 6f6e 2077 696c 6c20 6d61 7020 696e 2074  on will map in t
+00015cd0: 6865 207a 2d64 6972 6563 7469 6f6e 0d0a  he z-direction..
+00015ce0: 2020 2020 2020 2020 2020 2020 6f72 2072              or r
+00015cf0: 2d64 6972 6563 7469 6f6e 2c20 6465 7065  -direction, depe
+00015d00: 6e64 656e 7420 6f6e 2074 6865 206e 6174  ndent on the nat
+00015d10: 6976 6520 636f 6f72 6469 6e61 7465 732e  ive coordinates.
+00015d20: 0d0a 0d0a 2020 2020 2020 2020 636d 6170  ....        cmap
+00015d30: 203a 2073 7472 206f 7220 436f 6c6f 726d   : str or Colorm
+00015d40: 6170 2c20 6f70 7469 6f6e 616c 0d0a 2020  ap, optional..  
+00015d50: 2020 2020 2020 2020 2020 4120 436f 6c6f            A Colo
+00015d60: 726d 6170 2069 6e73 7461 6e63 6520 6f72  rmap instance or
+00015d70: 2072 6567 6973 7465 7265 6420 636f 6c6f   registered colo
+00015d80: 726d 6170 206e 616d 652e 0d0a 2020 2020  rmap name...    
+00015d90: 2020 2020 2020 2020 4966 206e 6f74 2061          If not a
+00015da0: 7373 6967 6e65 642c 2074 6865 2073 7572  ssigned, the sur
+00015db0: 6661 6365 2043 6f6c 6f72 6d61 7020 6973  face Colormap is
+00015dc0: 2075 7365 642e 0d0a 2020 2020 2020 2020   used...        
+00015dd0: 2020 2020 5468 6520 636f 6c6f 726d 6170      The colormap
+00015de0: 206d 6170 7320 7468 6520 6675 6e63 7469   maps the functi
+00015df0: 6f6e 2072 6574 7572 6e20 7661 6c75 6573  on return values
+00015e00: 2074 6f20 636f 6c6f 7273 2e0d 0a20 2020   to colors...   
+00015e10: 2020 2020 200d 0a20 2020 2020 2020 2063       ..        c
+00015e20: 6e61 6d65 203a 2073 7472 696e 672c 206f  name : string, o
+00015e30: 7074 696f 6e61 6c2c 2064 6566 6175 6c74  ptional, default
+00015e40: 3a20 4e6f 6e65 206f 7220 6f70 2066 756e  : None or op fun
+00015e50: 6374 696f 6e20 6e61 6d65 2e0d 0a20 2020  ction name...   
+00015e60: 2020 2020 2020 2020 2044 6573 6372 6970           Descrip
+00015e70: 7469 7665 2069 6465 6e74 6966 6965 7220  tive identifier 
+00015e80: 666f 7220 7661 6c75 6573 2069 6e64 6963  for values indic
+00015e90: 6174 6564 2062 7920 636f 6c6f 722e 0d0a  ated by color...
+00015ea0: 0d0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+00015eb0: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+00015ec0: 2d2d 0d0a 2020 2020 2020 2020 7365 6c66  --..        self
+00015ed0: 203a 2073 7572 6661 6365 206f 626a 6563   : surface objec
+00015ee0: 740d 0a0d 0a20 2020 2020 2020 2022 2222  t....        """
+00015ef0: 0d0a 0d0a 2020 2020 2020 2020 6466 7444  ....        dftD
+00015f00: 6972 4e61 6d65 203d 204e 6f6e 650d 0a20  irName = None.. 
+00015f10: 2020 2020 2020 2069 6620 6f70 6572 6174         if operat
+00015f20: 696f 6e20 6973 204e 6f6e 6520 3a0d 0a20  ion is None :.. 
+00015f30: 2020 2020 2020 2020 2020 206f 7044 6972             opDir
+00015f40: 203d 2032 0d0a 2020 2020 2020 2020 2020   = 2..          
+00015f50: 2020 6466 7444 6972 4e61 6d65 203d 2027    dftDirName = '
+00015f60: 5a2d 6469 7265 6374 696f 6e27 0d0a 2020  Z-direction'..  
+00015f70: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+00015f80: 662e 636f 6f72 5479 7065 203d 3d20 5f43  f.coorType == _C
+00015f90: 4f4f 5253 5953 5b22 5350 4845 5249 4341  OORSYS["SPHERICA
+00015fa0: 4c22 5d20 3a20 2020 6f70 4469 7220 3d20  L"] :   opDir = 
+00015fb0: 300d 0a20 2020 2020 2020 2020 2020 2069  0..            i
+00015fc0: 6620 7365 6c66 2e63 6f6f 7254 7970 6520  f self.coorType 
+00015fd0: 3d3d 205f 434f 4f52 5359 535b 2243 594c  == _COORSYS["CYL
+00015fe0: 494e 4452 4943 414c 225d 203a 206f 7044  INDRICAL"] : opD
+00015ff0: 6972 203d 2030 0d0a 2020 2020 2020 2020  ir = 0..        
+00016000: 2020 2020 6966 206f 7044 6972 203d 3d20      if opDir == 
+00016010: 3020 3a20 6466 7444 6972 4e61 6d65 203d  0 : dftDirName =
+00016020: 2027 522d 6469 7265 6374 696f 6e27 0d0a   'R-direction'..
+00016030: 2020 2020 2020 2020 2020 2020 6f70 6572              oper
+00016040: 6174 696f 6e20 3d20 6c61 6d62 6461 2063  ation = lambda c
+00016050: 203a 2063 5b6f 7044 6972 5d0d 0a0d 0a20   : c[opDir].... 
+00016060: 2020 2020 2020 2069 6620 636d 6170 2069         if cmap i
+00016070: 7320 6e6f 7420 4e6f 6e65 203a 0d0a 2020  s not None :..  
+00016080: 2020 2020 2020 2020 2020 6966 2069 7369            if isi
+00016090: 6e73 7461 6e63 6528 636d 6170 2c73 7472  nstance(cmap,str
+000160a0: 2920 3a20 0d0a 2020 2020 2020 2020 2020  ) : ..          
+000160b0: 2020 2020 2020 7365 6c66 2e73 6574 5f63        self.set_c
+000160c0: 6d61 7028 636d 2e67 6574 5f63 6d61 7028  map(cm.get_cmap(
+000160d0: 636d 6170 2929 0d0a 2020 2020 2020 2020  cmap))..        
+000160e0: 2020 2020 656c 7365 203a 0d0a 2020 2020      else :..    
+000160f0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00016100: 2e73 6574 5f63 6d61 7028 636d 6170 290d  .set_cmap(cmap).
+00016110: 0a20 2020 2020 2020 2063 6d61 7020 3d20  .        cmap = 
+00016120: 7365 6c66 2e67 6574 5f63 6d61 7028 290d  self.get_cmap().
+00016130: 0a0d 0a20 2020 2020 2020 2076 6572 7473  ...        verts
+00016140: 203d 2073 656c 662e 7665 7274 6578 436f   = self.vertexCo
+00016150: 6f72 5b20 7365 6c66 2e66 7649 6e64 6963  or[ self.fvIndic
+00016160: 6573 205d 0d0a 2020 2020 2020 2020 6661  es ]..        fa
+00016170: 6365 4365 6e74 6572 436f 6f72 203d 2073  ceCenterCoor = s
+00016180: 656c 662e 5f67 6574 5f66 6163 655f 6365  elf._get_face_ce
+00016190: 6e74 6572 7328 7665 7274 7329 0d0a 2020  nters(verts)..  
+000161a0: 2020 2020 2020 7879 7a20 3d20 6e70 2e74        xyz = np.t
+000161b0: 7261 6e73 706f 7365 2866 6163 6543 656e  ranspose(faceCen
+000161c0: 7465 7243 6f6f 7229 0d0a 2020 2020 2020  terCoor)..      
+000161d0: 2020 2320 2e2e 2e2e 2e0d 0a20 2020 2020    # .......     
+000161e0: 2020 2061 6263 203d 2073 656c 662e 636f     abc = self.co
+000161f0: 6f72 5f63 6f6e 7665 7274 2878 797a 290d  or_convert(xyz).
+00016200: 0a20 2020 2020 2020 2076 203d 206e 702e  .        v = np.
+00016210: 6172 7261 7928 6f70 6572 6174 696f 6e28  array(operation(
+00016220: 6162 6329 290d 0a20 2020 2020 2020 2073  abc))..        s
+00016230: 656c 662e 6661 6365 5661 6c75 6573 203d  elf.faceValues =
+00016240: 2076 0d0a 2020 2020 2020 2020 766d 696e   v..        vmin
+00016250: 2c20 766d 6178 203d 2076 2e6d 696e 2829  , vmax = v.min()
+00016260: 2c20 762e 6d61 7828 290d 0a20 2020 2020  , v.max()..     
+00016270: 2020 206e 6f72 6d20 3d20 636f 6c6f 7273     norm = colors
+00016280: 2e4e 6f72 6d61 6c69 7a65 2876 6d69 6e3d  .Normalize(vmin=
+00016290: 762e 6d69 6e28 292c 766d 6178 3d76 2e6d  v.min(),vmax=v.m
+000162a0: 6178 2829 290d 0a20 2020 2020 2020 200d  ax())..        .
+000162b0: 0a20 2020 2020 2020 2063 6f6c 6f72 4d61  .        colorMa
+000162c0: 7020 3d20 636d 6170 286e 6f72 6d28 7629  p = cmap(norm(v)
+000162d0: 290d 0a20 2020 2020 2020 2023 2046 7574  )..        # Fut
+000162e0: 4465 763a 2073 6574 5f63 6f6c 6f72 2075  Dev: set_color u
+000162f0: 7365 6420 696e 7374 6561 6420 6f66 2073  sed instead of s
+00016300: 6574 5f66 6163 6563 6f6c 6f72 2074 6f20  et_facecolor to 
+00016310: 656c 696d 696e 6174 6520 2767 6170 7327  eliminate 'gaps'
+00016320: 2062 6574 7765 656e 2066 6163 6573 2c0d   between faces,.
+00016330: 0a20 2020 2020 2020 2023 2068 6f77 6576  .        # howev
+00016340: 6572 2c20 7365 7420 6564 6765 636f 6c6f  er, set edgecolo
+00016350: 7220 7265 7175 6972 6564 2061 6674 6572  r required after
+00016360: 2069 6c6c 756d 696e 6174 696f 6e20 6966   illumination if
+00016370: 2065 6467 6573 2061 7265 2074 6f20 6265   edges are to be
+00016380: 2064 6973 706c 6179 6564 2e0d 0a20 2020   displayed...   
+00016390: 2020 2020 2023 2048 4f57 4556 4552 2021       # HOWEVER !
+000163a0: 2121 2120 2069 6620 636f 6c6f 724d 6170  !!!  if colorMap
+000163b0: 2068 6173 2061 2061 6c70 6861 3c31 2c20   has a alpha<1, 
+000163c0: 7468 6573 6520 646f 6e27 7420 7265 6769  these don't regi
+000163d0: 7374 6572 2077 6974 6820 7468 6520 6564  ster with the ed
+000163e0: 6765 732e 0d0a 2020 2020 2020 2020 7365  ges...        se
+000163f0: 6c66 2e73 6574 5f63 6f6c 6f72 2863 6f6c  lf.set_color(col
+00016400: 6f72 4d61 7029 0d0a 2020 2020 2020 2020  orMap)..        
+00016410: 7365 6c66 2e69 7353 7572 6661 6365 436f  self.isSurfaceCo
+00016420: 6c6f 7265 6420 3d20 5472 7565 0d0a 2020  lored = True..  
+00016430: 2020 2020 2020 7365 6c66 2e5f 626f 756e        self._boun
+00016440: 6473 5b27 766c 696d 275d 203d 205b 2076  ds['vlim'] = [ v
+00016450: 6d69 6e2c 2076 6d61 7820 5d20 0d0a 0d0a  min, vmax ] ....
+00016460: 2020 2020 2020 2020 2363 6e61 6d65 203d          #cname =
+00016470: 205f 6765 7446 756e 6374 696f 6e4e 616d   _getFunctionNam
+00016480: 6528 6f70 6572 6174 696f 6e2c 636e 616d  e(operation,cnam
+00016490: 6529 0d0a 2020 2020 2020 2020 7472 6961  e)..        tria
+000164a0: 6c4e 616d 6520 3d20 4e6f 6e65 0d0a 2020  lName = None..  
+000164b0: 2020 2020 2020 6966 2063 6e61 6d65 2069        if cname i
+000164c0: 7320 4e6f 6e65 203a 0d0a 2020 2020 2020  s None :..      
+000164d0: 2020 2020 2020 6966 2064 6674 4469 724e        if dftDirN
+000164e0: 616d 6520 6973 206e 6f74 204e 6f6e 6520  ame is not None 
+000164f0: 3a20 7472 6961 6c4e 616d 6520 3d20 6466  : trialName = df
+00016500: 7444 6972 4e61 6d65 0d0a 2020 2020 2020  tDirName..      
+00016510: 2020 2020 2020 656c 7365 203a 2020 7472        else :  tr
+00016520: 6961 6c4e 616d 6520 3d20 205f 6765 7446  ialName =  _getF
+00016530: 756e 6374 696f 6e4e 616d 6528 6f70 6572  unctionName(oper
+00016540: 6174 696f 6e2c 4e6f 6e65 290d 0a20 2020  ation,None)..   
+00016550: 2020 2020 2065 6c73 653a 2074 7269 616c       else: trial
+00016560: 4e61 6d65 203d 2063 6e61 6d65 0d0a 2020  Name = cname..  
+00016570: 2020 2020 2020 7365 6c66 2e76 616c 7565        self.value
+00016580: 734e 616d 6520 3d20 7472 6961 6c4e 616d  sName = trialNam
+00016590: 650d 0a20 2020 2020 2020 2023 203d 3d3d  e..        # ===
+000165a0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000165b0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000165c0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000165d0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000165e0: 3d3d 3d3d 3d0d 0a20 2020 2020 2020 2073  =====..        s
+000165f0: 656c 662e 5f6d 6170 5f63 6d61 705f 6672  elf._map_cmap_fr
+00016600: 6f6d 5f6f 705f 7665 7274 286f 7065 7261  om_op_vert(opera
+00016610: 7469 6f6e 2c20 636d 6170 290d 0a20 2020  tion, cmap)..   
+00016620: 2020 2020 2023 203d 3d3d 3d3d 3d3d 3d3d       # =========
+00016630: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00016640: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00016650: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00016660: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d  ===============.
+00016670: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+00016680: 2020 2072 6574 7572 6e20 7365 6c66 0d0a     return self..
+00016690: 0d0a 2020 2020 6465 6620 6d61 705f 6765  ..    def map_ge
+000166a0: 6f6d 5f66 726f 6d5f 6461 7461 6772 6964  om_from_datagrid
+000166b0: 2873 656c 662c 6461 7461 6772 6964 2c20  (self,datagrid, 
+000166c0: 7363 616c 653d 312e 302c 2076 6965 7770  scale=1.0, viewp
+000166d0: 6f72 743d 4e6f 6e65 2c20 6e61 6d65 3d4e  ort=None, name=N
+000166e0: 6f6e 6520 2920 3a0d 0a20 2020 2020 2020  one ) :..       
+000166f0: 2022 2222 0d0a 2020 2020 2020 2020 4170   """..        Ap
+00016700: 7065 6e64 2073 7572 6661 6365 2076 6572  pend surface ver
+00016710: 7469 6365 7320 7072 6f70 6f72 7469 6f6e  tices proportion
+00016720: 616c 2074 6f20 3244 2064 6174 6167 7269  al to 2D datagri
+00016730: 6420 7375 7266 6163 652e 0d0a 2020 2020  d surface...    
+00016740: 2020 2020 0d0a 2020 2020 2020 2020 4461      ..        Da
+00016750: 7461 6772 6964 2076 616c 7565 7320 6172  tagrid values ar
+00016760: 6520 6e6f 726d 616c 697a 6564 2069 6e20  e normalized in 
+00016770: 7468 6520 7261 6e67 6520 3020 746f 2031  the range 0 to 1
+00016780: 2e0d 0a0d 0a20 2020 2020 2020 2054 6869  .....        Thi
+00016790: 7320 6d65 7468 6f64 2069 7320 6e6f 7420  s method is not 
+000167a0: 6176 6169 6c61 626c 6520 666f 7220 636f  available for co
+000167b0: 6d70 6f73 6974 6520 7375 7266 6163 6573  mposite surfaces
+000167c0: 2e0d 0a20 2020 2020 2020 2054 6865 2065  ...        The e
+000167d0: 6e74 6972 6520 6461 7461 6772 6964 2064  ntire datagrid d
+000167e0: 6f6d 6169 6e20 6973 2061 7070 6c69 6564  omain is applied
+000167f0: 2074 6f20 7468 6520 6765 6f6d 6574 7269   to the geometri
+00016800: 6320 6f70 6572 6174 696f 6e2e 0d0a 0d0a  c operation.....
+00016810: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+00016820: 7273 0d0a 2020 2020 2020 2020 2d2d 2d2d  rs..        ----
+00016830: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
+00016840: 6461 7461 6772 6964 203a 2032 4420 6172  datagrid : 2D ar
+00016850: 7261 790d 0a0d 0a20 2020 2020 2020 2073  ray....        s
+00016860: 6361 6c65 203a 206e 756d 6265 722c 206f  cale : number, o
+00016870: 7074 696f 6e61 6c2c 2064 6566 6175 6c74  ptional, default
+00016880: 3a20 310d 0a0d 0a20 2020 2020 2020 2076  : 1....        v
+00016890: 6965 7770 6f72 7420 3a20 3444 2061 7272  iewport : 4D arr
+000168a0: 6179 2d6c 696b 652c 206f 7074 696f 6e61  ay-like, optiona
+000168b0: 6c2c 2064 6566 6175 6c74 3a20 4e6f 6e65  l, default: None
+000168c0: 0d0a 2020 2020 2020 2020 2020 2020 5669  ..            Vi
+000168d0: 6577 706f 7274 2064 6566 696e 6573 2074  ewport defines t
+000168e0: 6865 2073 7562 646f 6d61 696e 206f 6620  he subdomain of 
+000168f0: 7468 6520 7375 7266 6163 6520 6f6e 746f  the surface onto
+00016900: 2077 6869 6368 0d0a 2020 2020 2020 2020   which..        
+00016910: 2020 2020 7468 6520 6461 7461 6772 6964      the datagrid
+00016920: 2069 7320 6d61 7070 6564 2e20 2054 6865   is mapped.  The
+00016930: 2073 7562 646f 6d61 696e 2069 7320 7365   subdomain is se
+00016940: 7420 6279 206e 6f72 6d61 6c69 7a65 640d  t by normalized.
+00016950: 0a20 2020 2020 2020 2020 2020 206e 6174  .            nat
+00016960: 6976 6520 7375 7266 6163 6520 636f 6f72  ive surface coor
+00016970: 6469 6e61 7465 7320 696e 2061 2034 4420  dinates in a 4D 
+00016980: 6172 7261 792e 0d0a 2020 2020 2020 2020  array...        
+00016990: 2020 2020 5468 6520 656e 7469 7265 2073      The entire s
+000169a0: 7572 6661 6365 2069 7320 6765 6f6d 6574  urface is geomet
+000169b0: 7269 6361 6c6c 7920 6d61 7070 6564 2066  rically mapped f
+000169c0: 6f72 2074 6865 2064 6566 6175 6c74 206f  or the default o
+000169d0: 6620 4e6f 6e65 2e0d 0a20 2020 2020 2020  f None...       
+000169e0: 200d 0a20 2020 2020 2020 206e 616d 6520   ..        name 
+000169f0: 3a20 7374 7269 6e67 2c20 6f70 7469 6f6e  : string, option
+00016a00: 616c 2c20 6465 6661 756c 743a 204e 6f6e  al, default: Non
+00016a10: 650d 0a20 2020 2020 2020 2020 2020 2044  e..            D
+00016a20: 6573 6372 6970 7469 7665 2069 6465 6e74  escriptive ident
+00016a30: 6966 6965 7220 666f 7220 7468 6520 6765  ifier for the ge
+00016a40: 6f6d 6574 7279 2e0d 0a0d 0a20 2020 2020  ometry.....     
+00016a50: 2020 2052 6574 7572 6e73 0d0a 2020 2020     Returns..    
+00016a60: 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020      -------..   
+00016a70: 2020 2020 2073 656c 6620 3a20 7375 7266       self : surf
+00016a80: 6163 6520 6f62 6a65 6374 0d0a 0d0a 2020  ace object....  
+00016a90: 2020 2020 2020 2222 220d 0a0d 0a20 2020        """....   
+00016aa0: 2020 2020 2069 6620 7365 6c66 2e5f 6973       if self._is
+00016ab0: 436f 6d70 6f73 6974 6553 7572 6661 6365  CompositeSurface
+00016ac0: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
+00016ad0: 7761 726e 696e 6773 2e77 6172 6e28 2744  warnings.warn('D
+00016ae0: 6174 6167 7269 6420 6f70 6572 6174 696f  atagrid operatio
+00016af0: 6e20 6e6f 7420 6176 6169 6c61 626c 6520  n not available 
+00016b00: 666f 7220 636f 6d62 696e 6564 2073 6861  for combined sha
+00016b10: 7065 732e 2729 0d0a 2020 2020 2020 2020  pes.')..        
+00016b20: 2020 2020 7265 7475 726e 2073 656c 660d      return self.
+00016b30: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+00016b40: 2e5f 7375 7266 6163 6553 6861 7065 4368  ._surfaceShapeCh
+00016b50: 616e 6765 6420 3a0d 0a20 2020 2020 2020  anged :..       
+00016b60: 2020 2020 2023 7761 726e 696e 6773 2e77       #warnings.w
+00016b70: 6172 6e28 2744 6174 6167 7269 6420 6f70  arn('Datagrid op
+00016b80: 6572 6174 696f 6e20 6d61 7920 6265 2061  eration may be a
+00016b90: 6e6f 6d61 6c6f 7573 2061 6674 6572 2073  nomalous after s
+00016ba0: 6861 7065 206d 6f64 6966 6963 6174 696f  hape modificatio
+00016bb0: 6e2e 2729 0d0a 2020 2020 2020 2020 2020  n.')..          
+00016bc0: 2020 7761 726e 696e 6773 2e77 6172 6e28    warnings.warn(
+00016bd0: 2744 6174 6167 7269 6420 6f70 6572 6174  'Datagrid operat
+00016be0: 696f 6e20 6e6f 7420 6176 6169 6c61 626c  ion not availabl
+00016bf0: 6520 6166 7465 7220 7368 6170 6520 6d6f  e after shape mo
+00016c00: 6469 6669 6361 7469 6f6e 2e27 290d 0a20  dification.').. 
+00016c10: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00016c20: 6e20 7365 6c66 0d0a 0d0a 2020 2020 2020  n self....      
+00016c30: 2020 612c 622c 696e 5669 6577 706f 7274    a,b,inViewport
+00016c40: 203d 2073 656c 662e 5f76 6965 7770 6f72   = self._viewpor
+00016c50: 7443 6f6f 7228 7365 6c66 2e76 6572 7465  tCoor(self.verte
+00016c60: 7843 6f6f 722c 7669 6577 706f 7274 290d  xCoor,viewport).
+00016c70: 0a0d 0a20 2020 2020 2020 2064 6174 6120  ...        data 
+00016c80: 3d20 6461 7461 6772 6964 0d0a 2020 2020  = datagrid..    
+00016c90: 2020 2020 646d 6178 203d 206e 702e 616d      dmax = np.am
+00016ca0: 6178 2864 6174 6167 7269 6429 0d0a 2020  ax(datagrid)..  
+00016cb0: 2020 2020 2020 646d 696e 203d 206e 702e        dmin = np.
+00016cc0: 616d 696e 2864 6174 6167 7269 6429 0d0a  amin(datagrid)..
+00016cd0: 2020 2020 2020 2020 6465 6c74 6120 3d20          delta = 
+00016ce0: 646d 6178 2d64 6d69 6e0d 0a20 2020 2020  dmax-dmin..     
+00016cf0: 2020 2064 6174 6120 3d20 2864 6174 6167     data = (datag
+00016d00: 7269 6420 2d20 646d 696e 292f 6465 6c74  rid - dmin)/delt
+00016d10: 610d 0a20 2020 2020 2020 2078 6420 3d20  a..        xd = 
+00016d20: 6e70 2e6c 696e 7370 6163 6528 302c 2031  np.linspace(0, 1
+00016d30: 2c20 6461 7461 2e73 6861 7065 5b30 5d20  , data.shape[0] 
+00016d40: 290d 0a20 2020 2020 2020 2079 6420 3d20  )..        yd = 
+00016d50: 6e70 2e6c 696e 7370 6163 6528 302c 2031  np.linspace(0, 1
+00016d60: 2c20 6461 7461 2e73 6861 7065 5b31 5d20  , data.shape[1] 
+00016d70: 290d 0a20 2020 2020 2020 2067 203d 2020  )..        g =  
+00016d80: 696e 7465 7270 6f6c 6174 652e 696e 7465  interpolate.inte
+00016d90: 7270 3264 2879 642c 2078 642c 2064 6174  rp2d(yd, xd, dat
+00016da0: 612c 206b 696e 643d 2763 7562 6963 2729  a, kind='cubic')
+00016db0: 0d0a 0d0a 2020 2020 2020 2020 2320 4675  ....        # Fu
+00016dc0: 7444 6576 3a20 6f70 7469 6d69 7a65 2065  tDev: optimize e
+00016dd0: 6666 6963 6965 6e63 7920 283f 292e 0d0a  fficiency (?)...
+00016de0: 2020 2020 2020 2020 6420 3d20 5b5d 0d0a          d = []..
+00016df0: 2020 2020 2020 2020 666f 7220 6162 2069          for ab i
+00016e00: 6e20 6e70 2e74 7261 6e73 706f 7365 285b  n np.transpose([
+00016e10: 612c 625d 2920 3a0d 0a20 2020 2020 2020  a,b]) :..       
+00016e20: 2020 2020 2064 2e61 7070 656e 6428 2067       d.append( g
+00016e30: 2861 625b 305d 2c61 625b 315d 295b 305d  (ab[0],ab[1])[0]
+00016e40: 2029 0d0a 2020 2020 2020 2020 6420 3d20   )..        d = 
+00016e50: 6e70 2e77 6865 7265 2869 6e56 6965 7770  np.where(inViewp
+00016e60: 6f72 742c 642c 6e70 2e7a 6572 6f73 286c  ort,d,np.zeros(l
+00016e70: 656e 2864 2929 290d 0a20 2020 2020 2020  en(d)))..       
+00016e80: 2064 203d 2064 5b3a 2c20 6e70 2e6e 6577   d = d[:, np.new
+00016e90: 6178 6973 5d0d 0a0d 0a20 2020 2020 2020  axis]....       
+00016ea0: 2023 2046 7574 4465 763a 2027 6656 616c   # FutDev: 'fVal
+00016eb0: 2720 6f6e 6c79 2061 7070 6c69 6361 626c  ' only applicabl
+00016ec0: 6520 666f 7220 696e 6974 6961 6c20 7375  e for initial su
+00016ed0: 6263 6c61 7373 6564 0d0a 2020 2020 2020  bclassed..      
+00016ee0: 2020 2320 7375 7266 6163 6573 2074 6f20    # surfaces to 
+00016ef0: 6765 7420 7375 7266 6163 6520 6e6f 726d  get surface norm
+00016f00: 616c 7320 6174 2061 2076 6572 7465 782e  als at a vertex.
+00016f10: 0d0a 2020 2020 2020 2020 2320 4675 7475  ..        # Futu
+00016f20: 7265 2077 6f72 6b3a 2074 6f20 6d61 6b65  re work: to make
+00016f30: 2074 6869 7320 6765 6e65 7269 6320 666f   this generic fo
+00016f40: 7220 616e 7920 7375 7266 6163 652e 0d0a  r any surface...
+00016f50: 2020 2020 2020 2020 6656 616c 203d 206e          fVal = n
+00016f60: 702e 6172 7261 7928 5b30 2e2c 302e 2c31  p.array([0.,0.,1
+00016f70: 2e5d 290d 0a20 2020 2020 2020 2069 6620  .])..        if 
+00016f80: 7365 6c66 2e64 6973 705f 5665 6374 6f72  self.disp_Vector
+00016f90: 2069 7320 6e6f 7420 4e6f 6e65 203a 0d0a   is not None :..
+00016fa0: 2020 2020 2020 2020 2020 2020 6656 616c              fVal
+00016fb0: 203d 2073 656c 662e 7665 7274 6578 436f   = self.vertexCo
+00016fc0: 6f72 2a73 656c 662e 6469 7370 5f56 6563  or*self.disp_Vec
+00016fd0: 746f 720d 0a0d 0a20 2020 2020 2020 2076  tor....        v
+00016fe0: 203d 2020 7365 6c66 2e76 6572 7465 7843   =  self.vertexC
+00016ff0: 6f6f 7220 2b20 7363 616c 652a 642a 6656  oor + scale*d*fV
+00017000: 616c 0d0a 2020 2020 2020 2020 7665 7274  al..        vert
+00017010: 7320 3d20 765b 7365 6c66 2e66 7649 6e64  s = v[self.fvInd
+00017020: 6963 6573 5d0d 0a20 2020 2020 2020 2073  ices]..        s
+00017030: 656c 662e 7665 7274 6578 436f 6f72 203d  elf.vertexCoor =
+00017040: 2076 0d0a 2020 2020 2020 2020 7365 6c66   v..        self
+00017050: 2e5f 7365 745f 6765 6f6d 6574 7269 635f  ._set_geometric_
+00017060: 626f 756e 6473 2829 0d0a 2020 2020 2020  bounds()..      
+00017070: 2020 7365 6c66 2e73 6574 5f76 6572 7473    self.set_verts
+00017080: 2820 7665 7274 7320 290d 0a20 2020 2020  ( verts )..     
+00017090: 2020 2073 656c 662e 5f73 7572 6661 6365     self._surface
+000170a0: 5368 6170 6543 6861 6e67 6564 203d 2054  ShapeChanged = T
+000170b0: 7275 650d 0a20 2020 2020 2020 2069 6620  rue..        if 
+000170c0: 6e61 6d65 2069 7320 6e6f 7420 4e6f 6e65  name is not None
+000170d0: 3a20 7365 6c66 2e5f 6765 6f6d 4e61 6d65  : self._geomName
+000170e0: 203d 206e 616d 650d 0a20 2020 2020 2020   = name..       
+000170f0: 2072 6574 7572 6e20 7365 6c66 0d0a 0d0a   return self....
+00017100: 2020 2020 6465 6620 6d61 705f 6765 6f6d      def map_geom
+00017110: 5f66 726f 6d5f 696d 6167 6528 7365 6c66  _from_image(self
+00017120: 2c20 666e 616d 652c 2073 6361 6c65 3d31  , fname, scale=1
+00017130: 2e30 2c20 7669 6577 706f 7274 3d4e 6f6e  .0, viewport=Non
+00017140: 652c 2063 7265 663d 2776 272c 2068 7a65  e, cref='v', hze
+00017150: 726f 3d30 2c20 6e61 6d65 3d4e 6f6e 6520  ro=0, name=None 
+00017160: 2920 3a0d 0a20 2020 2020 2020 2022 2222  ) :..        """
+00017170: 0d0a 2020 2020 2020 2020 4170 7065 6e64  ..        Append
+00017180: 2073 7572 6661 6365 2076 6572 7469 6365   surface vertice
+00017190: 7320 7072 6f70 6f72 7469 6f6e 616c 2074  s proportional t
+000171a0: 6f20 696d 6167 6520 636f 6c6f 7220 636f  o image color co
+000171b0: 6d70 6f6e 656e 7420 7661 6c75 6573 2e0d  mponent values..
+000171c0: 0a0d 0a20 2020 2020 2020 2046 6f72 2070  ...        For p
+000171d0: 6c61 6e61 7220 616e 6420 706f 6c61 7220  lanar and polar 
+000171e0: 636f 6f72 6469 6e61 7465 732c 2074 6865  coordinates, the
+000171f0: 207a 2d63 6f6f 7264 696e 6174 6520 6973   z-coordinate is
+00017200: 2061 7070 656e 6465 642e 0d0a 2020 2020   appended...    
+00017210: 2020 2020 466f 7220 6379 6c69 6e64 7269      For cylindri
+00017220: 6361 6c20 616e 6420 7370 6865 7269 6361  cal and spherica
+00017230: 6c20 636f 6f72 6469 6e61 7465 732c 2074  l coordinates, t
+00017240: 6865 2072 2d63 6f6f 7264 696e 6174 6520  he r-coordinate 
+00017250: 6973 2061 7070 656e 6465 642e 0d0a 0d0a  is appended.....
+00017260: 2020 2020 2020 2020 5468 6973 206d 6574          This met
+00017270: 686f 6420 6973 206e 6f74 2061 7661 696c  hod is not avail
+00017280: 6162 6c65 2066 6f72 2063 6f6d 706f 7369  able for composi
+00017290: 7465 2073 7572 6661 6365 732e 0d0a 2020  te surfaces...  
+000172a0: 2020 2020 2020 5468 6520 656e 7469 7265        The entire
+000172b0: 2069 6d61 6765 2064 6f6d 6169 6e20 6973   image domain is
+000172c0: 2061 7070 6c69 6564 2074 6f20 7468 6520   applied to the 
+000172d0: 6765 6f6d 6574 7269 6320 6f70 6572 6174  geometric operat
+000172e0: 696f 6e2e 0d0a 0d0a 2020 2020 2020 2020  ion.....        
+000172f0: 5061 7261 6d65 7465 7273 0d0a 2020 2020  Parameters..    
+00017300: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a      ----------..
+00017310: 2020 2020 2020 2020 666e 616d 6520 3a20          fname : 
+00017320: 7374 7220 6f72 2066 696c 652d 6c69 6b65  str or file-like
+00017330: 0d0a 2020 2020 2020 2020 2020 2020 5468  ..            Th
+00017340: 6520 696d 6167 6520 6669 6c65 2074 6f20  e image file to 
+00017350: 7265 6164 3a20 6120 6669 6c65 6e61 6d65  read: a filename
+00017360: 2c20 6120 5552 4c20 6f72 2061 2066 696c  , a URL or a fil
+00017370: 652d 6c69 6b65 206f 626a 6563 7420 6f70  e-like object op
+00017380: 656e 6564 0d0a 2020 2020 2020 2020 2020  ened..          
+00017390: 2020 696e 2072 6561 642d 6269 6e61 7279    in read-binary
+000173a0: 206d 6f64 652e 2020 4375 7272 656e 746c   mode.  Currentl
+000173b0: 7920 7265 7374 7269 6374 6564 2074 6f20  y restricted to 
+000173c0: 504e 4720 666f 726d 6174 2e0d 0a0d 0a20  PNG format..... 
+000173d0: 2020 2020 2020 2073 6361 6c65 203a 206e         scale : n
+000173e0: 756d 6265 720d 0a0d 0a20 2020 2020 2020  umber....       
+000173f0: 2063 7265 6620 3a20 7b27 7227 2c27 6727   cref : {'r','g'
+00017400: 2c27 6227 2c27 6827 2c27 7327 2c27 7627  ,'b','h','s','v'
+00017410: 7d2c 206f 7074 696f 6e61 6c2c 2064 6566  }, optional, def
+00017420: 6175 6c74 3a20 2776 270d 0a20 2020 2020  ault: 'v'..     
+00017430: 2020 2020 2020 2053 6574 7320 7768 6963         Sets whic
+00017440: 6820 636f 6c6f 7220 7475 706c 6520 7661  h color tuple va
+00017450: 6c75 6520 746f 2075 7365 2066 6f72 2067  lue to use for g
+00017460: 656f 6d65 7472 7920 6d61 7070 696e 672e  eometry mapping.
+00017470: 0d0a 2020 2020 2020 2020 2020 2020 4e6f  ..            No
+00017480: 7465 3a20 6f6e 6c79 2074 6865 2066 6972  te: only the fir
+00017490: 7374 2063 6861 7261 6374 6572 206f 6620  st character of 
+000174a0: 7468 6520 7374 7269 6e67 2069 7320 6576  the string is ev
+000174b0: 616c 7561 7465 642e 0d0a 0d0a 2020 2020  aluated.....    
+000174c0: 2020 2020 687a 6572 6f20 3a20 6e75 6d62      hzero : numb
+000174d0: 6572 206f 7220 4e6f 6e65 2c20 6f70 7469  er or None, opti
+000174e0: 6f6e 616c 2c20 6465 6661 756c 743a 2030  onal, default: 0
+000174f0: 0d0a 2020 2020 2020 2020 2020 2020 4172  ..            Ar
+00017500: 6775 6d65 6e74 2069 7320 7573 6564 2069  gument is used i
+00017510: 6620 6372 6566 2069 7320 7365 7420 746f  f cref is set to
+00017520: 2027 6827 2e0d 0a20 2020 2020 2020 2020   'h'...         
+00017530: 2020 2054 6865 2068 7a65 726f 206d 6167     The hzero mag
+00017540: 6e69 7475 6465 2069 6e64 6963 6174 6573  nitude indicates
+00017550: 2074 6865 2048 7565 2076 616c 7565 2066   the Hue value f
+00017560: 6f72 2061 207a 6572 6f20 636f 6f72 6469  or a zero coordi
+00017570: 6e61 7465 0d0a 2020 2020 2020 2020 2020  nate..          
+00017580: 2020 6469 706c 6163 656d 656e 742e 2054    diplacement. T
+00017590: 6865 2068 7a65 726f 2073 6967 6e20 2870  he hzero sign (p
+000175a0: 6f73 6974 6976 6520 6f72 206e 6567 6174  ositive or negat
+000175b0: 6976 6529 2c0d 0a20 2020 2020 2020 2020  ive),..         
+000175c0: 2020 2069 6e64 6963 6174 6573 2074 6865     indicates the
+000175d0: 2064 6972 6563 7469 6f6e 206f 6620 696e   direction of in
+000175e0: 6372 6561 7369 6e67 2076 616c 7565 2069  creasing value i
+000175f0: 6e20 7468 650d 0a20 2020 2020 2020 2020  n the..         
+00017600: 2020 2061 7070 656e 6465 6420 636f 6f72     appended coor
+00017610: 6469 6e61 7465 2077 6974 6820 6875 6520  dinate with hue 
+00017620: 7661 6c75 652e 2020 5261 6e67 6520 6f66  value.  Range of
+00017630: 2068 7a65 726f 2069 7320 5b2d 312c 315d   hzero is [-1,1]
+00017640: 2e0d 0a0d 0a20 2020 2020 2020 2076 6965  .....        vie
+00017650: 7770 6f72 7420 3a20 3444 2061 7272 6179  wport : 4D array
+00017660: 2d6c 696b 652c 206f 7074 696f 6e61 6c2c  -like, optional,
+00017670: 2064 6566 6175 6c74 3a20 4e6f 6e65 0d0a   default: None..
+00017680: 2020 2020 2020 2020 2020 2020 5669 6577              View
+00017690: 706f 7274 2064 6566 696e 6573 2074 6865  port defines the
+000176a0: 2073 7562 646f 6d61 696e 206f 6620 7468   subdomain of th
+000176b0: 6520 7375 7266 6163 6520 6f6e 746f 2077  e surface onto w
+000176c0: 6869 6368 0d0a 2020 2020 2020 2020 2020  hich..          
+000176d0: 2020 7468 6520 696d 6167 6520 6973 206d    the image is m
+000176e0: 6170 7065 642e 2020 5468 6520 7375 6264  apped.  The subd
+000176f0: 6f6d 6169 6e20 6973 2073 6574 2062 7920  omain is set by 
+00017700: 6e6f 726d 616c 697a 6564 0d0a 2020 2020  normalized..    
+00017710: 2020 2020 2020 2020 6e61 7469 7665 2073          native s
+00017720: 7572 6661 6365 2063 6f6f 7264 696e 6174  urface coordinat
+00017730: 6573 2069 6e20 6120 3444 2061 7272 6179  es in a 4D array
+00017740: 2e0d 0a20 2020 2020 2020 2020 2020 2054  ...            T
+00017750: 6865 2065 6e74 6972 6520 7375 7266 6163  he entire surfac
+00017760: 6520 6973 2067 656f 6d65 7472 6963 616c  e is geometrical
+00017770: 6c79 206d 6170 7065 6420 666f 7220 7468  ly mapped for th
+00017780: 6520 6465 6661 756c 7420 6f66 204e 6f6e  e default of Non
+00017790: 652e 0d0a 0d0a 2020 2020 2020 2020 6e61  e.....        na
+000177a0: 6d65 203a 2073 7472 696e 672c 206f 7074  me : string, opt
+000177b0: 696f 6e61 6c2c 2064 6566 6175 6c74 3a20  ional, default: 
+000177c0: 4e6f 6e65 0d0a 2020 2020 2020 2020 2020  None..          
+000177d0: 2020 4465 7363 7269 7074 6976 6520 6964    Descriptive id
+000177e0: 656e 7469 6669 6572 2066 6f72 2074 6865  entifier for the
+000177f0: 2067 656f 6d65 7472 792e 0d0a 0d0a 2020   geometry.....  
+00017800: 2020 2020 2020 5265 7475 726e 730d 0a20        Returns.. 
+00017810: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0d0a         -------..
+00017820: 2020 2020 2020 2020 7365 6c66 203a 2073          self : s
+00017830: 7572 6661 6365 206f 626a 6563 740d 0a0d  urface object...
+00017840: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
+00017850: 2020 2020 2020 2320 2e2e 2e2e 2e2e 2e2e        # ........
+00017860: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00017870: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00017880: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00017890: 2e2e 2e2e 2e2e 0d0a 2020 2020 2020 2020  ........        
+000178a0: 6465 6620 6765 7449 6e64 6578 2863 7265  def getIndex(cre
+000178b0: 6629 203a 0d0a 2020 2020 2020 2020 2020  f) :..          
+000178c0: 2020 6372 6566 203d 2063 7265 665b 305d    cref = cref[0]
+000178d0: 2e6c 6f77 6572 2829 0d0a 2020 2020 2020  .lower()..      
+000178e0: 2020 2020 2020 7661 6c49 6e64 6578 203d        valIndex =
+000178f0: 2027 7267 6268 7376 272e 6669 6e64 2863   'rgbhsv'.find(c
+00017900: 7265 6629 0d0a 2020 2020 2020 2020 2020  ref)..          
+00017910: 2020 6966 2076 616c 496e 6465 7820 3c20    if valIndex < 
+00017920: 3020 3a0d 0a20 2020 2020 2020 2020 2020  0 :..           
+00017930: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+00017940: 4572 726f 7228 2749 6e76 616c 6964 2063  Error('Invalid c
+00017950: 7265 6620 6172 6775 6d65 6e74 3a20 2720  ref argument: ' 
+00017960: 2b20 7374 7228 6372 6566 2929 0d0a 2020  + str(cref))..  
+00017970: 2020 2020 2020 2020 2020 6973 4853 5620            isHSV 
+00017980: 3d20 4661 6c73 650d 0a20 2020 2020 2020  = False..       
+00017990: 2020 2020 2069 6620 7661 6c49 6e64 6578       if valIndex
+000179a0: 203e 2032 203a 0d0a 2020 2020 2020 2020   > 2 :..        
+000179b0: 2020 2020 2020 2020 7661 6c49 6e64 6578          valIndex
+000179c0: 202d 3d20 330d 0a20 2020 2020 2020 2020   -= 3..         
+000179d0: 2020 2020 2020 2069 7348 5356 203d 2054         isHSV = T
+000179e0: 7275 650d 0a20 2020 2020 2020 2020 2020  rue..           
+000179f0: 2072 6574 7572 6e20 7661 6c49 6e64 6578   return valIndex
+00017a00: 2c20 6973 4853 560d 0a20 2020 2020 2020  , isHSV..       
+00017a10: 2023 202e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e   # .............
+00017a20: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00017a30: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00017a40: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00017a50: 2e0d 0a20 2020 2020 2020 2069 6620 7365  ...        if se
+00017a60: 6c66 2e5f 6973 436f 6d70 6f73 6974 6553  lf._isCompositeS
+00017a70: 7572 6661 6365 203a 0d0a 2020 2020 2020  urface :..      
+00017a80: 2020 2020 2020 7761 726e 696e 6773 2e77        warnings.w
+00017a90: 6172 6e28 2749 6d61 6765 206f 7065 7261  arn('Image opera
+00017aa0: 7469 6f6e 206e 6f74 2061 7661 696c 6162  tion not availab
+00017ab0: 6c65 2066 6f72 2063 6f6d 6269 6e65 6420  le for combined 
+00017ac0: 7368 6170 6573 2e27 290d 0a20 2020 2020  shapes.')..     
+00017ad0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00017ae0: 6c66 0d0a 2020 2020 2020 2020 6966 2073  lf..        if s
+00017af0: 656c 662e 5f73 7572 6661 6365 5368 6170  elf._surfaceShap
+00017b00: 6543 6861 6e67 6564 203a 0d0a 2020 2020  eChanged :..    
+00017b10: 2020 2020 2020 2020 7761 726e 696e 6773          warnings
+00017b20: 2e77 6172 6e28 2749 6d61 6765 206f 7065  .warn('Image ope
+00017b30: 7261 7469 6f6e 206d 6179 2062 6520 616e  ration may be an
+00017b40: 6f6d 616c 6f75 7320 6166 7465 7220 7368  omalous after sh
+00017b50: 6170 6520 6d6f 6469 6669 6361 7469 6f6e  ape modification
+00017b60: 2e27 290d 0a20 2020 2020 2020 200d 0a20  .')..        .. 
+00017b70: 2020 2020 2020 2069 6620 2868 7a65 726f         if (hzero
+00017b80: 3c2d 3129 206f 7220 2868 7a65 726f 3e31  <-1) or (hzero>1
+00017b90: 2920 3a0d 0a20 2020 2020 2020 2020 2020  ) :..           
+00017ba0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+00017bb0: 7228 2768 7a65 726f 206d 7573 7420 6265  r('hzero must be
+00017bc0: 2062 6574 7765 656e 202d 3120 616e 6420   between -1 and 
+00017bd0: 312c 2066 6f75 6e64 207b 7d27 2e66 6f72  1, found {}'.for
+00017be0: 6d61 7428 687a 6572 6f29 290d 0a20 2020  mat(hzero))..   
+00017bf0: 2020 2020 2068 6f20 3d20 2831 2e30 202d       ho = (1.0 -
+00017c00: 687a 6572 6f29 0d0a 2020 2020 2020 2020  hzero)..        
+00017c10: 6873 676e 203d 206e 702e 7369 676e 2868  hsgn = np.sign(h
+00017c20: 7a65 726f 290d 0a20 2020 2020 2020 2068  zero)..        h
+00017c30: 5f72 6566 203d 206c 616d 6264 6120 6820  _ref = lambda h 
+00017c40: 3a20 6e70 2e6d 6f64 2820 686f 202b 2068  : np.mod( ho + h
+00017c50: 7367 6e2a 6820 2c20 312e 3029 0d0a 2020  sgn*h , 1.0)..  
+00017c60: 2020 2020 2020 2320 2e2e 2e2e 2e2e 2e2e        # ........
+00017c70: 2e2e 2e2e 2e2e 2e2e 2e2e 2e0d 0a20 2020  .............   
+00017c80: 2020 2020 2061 2c62 2c69 6e56 6965 7770       a,b,inViewp
+00017c90: 6f72 7420 3d20 7365 6c66 2e5f 7669 6577  ort = self._view
+00017ca0: 706f 7274 436f 6f72 2873 656c 662e 7665  portCoor(self.ve
+00017cb0: 7274 6578 436f 6f72 2c76 6965 7770 6f72  rtexCoor,viewpor
+00017cc0: 7429 0d0a 2020 2020 2020 2020 696d 6720  t)..        img 
+00017cd0: 3d20 696d 6167 652e 696d 7265 6164 2866  = image.imread(f
+00017ce0: 6e61 6d65 290d 0a20 2020 2020 2020 2068  name)..        h
+00017cf0: 6569 6768 742c 2077 6964 7468 203d 206e  eight, width = n
+00017d00: 702e 7375 6274 7261 6374 2869 6d67 2e73  p.subtract(img.s
+00017d10: 6861 7065 5b3a 325d 2c31 290d 0a20 2020  hape[:2],1)..   
+00017d20: 2020 2020 2078 5f69 6e64 6578 203d 2028       x_index = (
+00017d30: 2028 312d 6229 2a68 6569 6768 7420 292e   (1-b)*height ).
+00017d40: 6173 7479 7065 2869 6e74 290d 0a20 2020  astype(int)..   
+00017d50: 2020 2020 2079 5f69 6e64 6578 203d 2028       y_index = (
+00017d60: 2061 2a77 6964 7468 2029 2e61 7374 7970   a*width ).astyp
+00017d70: 6528 696e 7429 0d0a 0d0a 2020 2020 2020  e(int)....      
+00017d80: 2020 7661 6c49 6e64 6578 2c20 6973 4853    valIndex, isHS
+00017d90: 5620 3d20 6765 7449 6e64 6578 2863 7265  V = getIndex(cre
+00017da0: 6629 0d0a 2020 2020 2020 2020 7267 6263  f)..        rgbc
+00017db0: 6f6c 6f72 203d 2069 6d67 5b78 5f69 6e64  olor = img[x_ind
+00017dc0: 6578 2c79 5f69 6e64 6578 5d0d 0a20 2020  ex,y_index]..   
+00017dd0: 2020 2020 2069 6620 6973 4853 5620 3a0d       if isHSV :.
+00017de0: 0a20 2020 2020 2020 2020 2020 2068 7376  .            hsv
+00017df0: 636f 6c6f 7220 3d20 636f 6c6f 7273 2e72  color = colors.r
+00017e00: 6762 5f74 6f5f 6873 7628 7267 6263 6f6c  gb_to_hsv(rgbcol
+00017e10: 6f72 290d 0a20 2020 2020 2020 2020 2020  or)..           
+00017e20: 2068 7376 636f 6c6f 7220 3d20 6e70 2e74   hsvcolor = np.t
+00017e30: 7261 6e73 706f 7365 2868 7376 636f 6c6f  ranspose(hsvcolo
+00017e40: 7229 0d0a 2020 2020 2020 2020 2020 2020  r)..            
+00017e50: 6966 2076 616c 496e 6465 783d 3d30 203a  if valIndex==0 :
+00017e60: 2064 3d20 685f 7265 6628 6873 7663 6f6c   d= h_ref(hsvcol
+00017e70: 6f72 5b30 5d29 0d0a 2020 2020 2020 2020  or[0])..        
+00017e80: 2020 2020 656c 7365 203a 2020 2020 2020      else :      
+00017e90: 2020 2020 2064 203d 2068 7376 636f 6c6f       d = hsvcolo
+00017ea0: 725b 7661 6c49 6e64 6578 5d0d 0a20 2020  r[valIndex]..   
+00017eb0: 2020 2020 2065 6c73 6520 3a0d 0a20 2020       else :..   
+00017ec0: 2020 2020 2020 2020 2072 6762 636f 6c6f           rgbcolo
+00017ed0: 7220 3d20 6e70 2e74 7261 6e73 706f 7365  r = np.transpose
+00017ee0: 2872 6762 636f 6c6f 7229 0d0a 2020 2020  (rgbcolor)..    
+00017ef0: 2020 2020 2020 2020 6420 3d20 7267 6263          d = rgbc
+00017f00: 6f6c 6f72 5b76 616c 496e 6465 785d 0d0a  olor[valIndex]..
+00017f10: 0d0a 2020 2020 2020 2020 6420 3d20 6e70  ..        d = np
+00017f20: 2e77 6865 7265 2869 6e56 6965 7770 6f72  .where(inViewpor
+00017f30: 742c 642c 6e70 2e7a 6572 6f73 286c 656e  t,d,np.zeros(len
+00017f40: 2864 2929 290d 0a20 2020 2020 2020 2064  (d)))..        d
+00017f50: 203d 2064 5b3a 2c20 6e70 2e6e 6577 6178   = d[:, np.newax
+00017f60: 6973 5d0d 0a20 2020 2020 2020 200d 0a20  is]..        .. 
+00017f70: 2020 2020 2020 2023 2046 7574 4465 763a         # FutDev:
+00017f80: 2027 6656 616c 2720 6f6e 6c79 2061 7070   'fVal' only app
+00017f90: 6c69 6361 626c 6520 666f 7220 696e 6974  licable for init
+00017fa0: 6961 6c20 7375 6263 6c61 7373 6564 2073  ial subclassed s
+00017fb0: 7572 6661 6365 730d 0a20 2020 2020 2020  urfaces..       
+00017fc0: 2023 2073 7572 6661 6365 7320 746f 2067   # surfaces to g
+00017fd0: 6574 2073 7572 6661 6365 206e 6f72 6d61  et surface norma
+00017fe0: 6c73 2061 7420 6120 7665 7274 6578 2e0d  ls at a vertex..
+00017ff0: 0a20 2020 2020 2020 2023 2046 7574 7572  .        # Futur
+00018000: 6520 776f 726b 3a20 746f 206d 616b 6520  e work: to make 
+00018010: 7468 6973 2067 656e 6572 6963 2066 6f72  this generic for
+00018020: 2061 6e79 2073 7572 6661 6365 2e0d 0a20   any surface... 
+00018030: 2020 2020 2020 2066 5661 6c20 3d20 6e70         fVal = np
+00018040: 2e61 7272 6179 285b 302e 2c30 2e2c 312e  .array([0.,0.,1.
+00018050: 5d29 0d0a 2020 2020 2020 2020 6966 2073  ])..        if s
+00018060: 656c 662e 6469 7370 5f56 6563 746f 7220  elf.disp_Vector 
+00018070: 6973 206e 6f74 204e 6f6e 6520 3a0d 0a20  is not None :.. 
+00018080: 2020 2020 2020 2020 2020 2066 5661 6c20             fVal 
+00018090: 3d20 7365 6c66 2e76 6572 7465 7843 6f6f  = self.vertexCoo
+000180a0: 722a 7365 6c66 2e64 6973 705f 5665 6374  r*self.disp_Vect
+000180b0: 6f72 0d0a 0d0a 2020 2020 2020 2020 7620  or....        v 
+000180c0: 3d20 2073 656c 662e 7665 7274 6578 436f  =  self.vertexCo
+000180d0: 6f72 202b 2073 6361 6c65 2a64 2a66 5661  or + scale*d*fVa
+000180e0: 6c0d 0a20 2020 2020 2020 2076 6572 7473  l..        verts
+000180f0: 203d 2076 5b73 656c 662e 6676 496e 6469   = v[self.fvIndi
+00018100: 6365 735d 0d0a 2020 2020 2020 2020 7365  ces]..        se
+00018110: 6c66 2e76 6572 7465 7843 6f6f 7220 3d20  lf.vertexCoor = 
+00018120: 760d 0a20 2020 2020 2020 2073 656c 662e  v..        self.
+00018130: 5f73 6574 5f67 656f 6d65 7472 6963 5f62  _set_geometric_b
+00018140: 6f75 6e64 7328 290d 0a20 2020 2020 2020  ounds()..       
+00018150: 2073 656c 662e 7365 745f 7665 7274 7328   self.set_verts(
+00018160: 2076 6572 7473 2029 0d0a 2020 2020 2020   verts )..      
+00018170: 2020 7365 6c66 2e5f 7375 7266 6163 6553    self._surfaceS
+00018180: 6861 7065 4368 616e 6765 6420 3d20 5472  hapeChanged = Tr
+00018190: 7565 0d0a 2020 2020 2020 2020 6966 206e  ue..        if n
+000181a0: 616d 6520 6973 206e 6f74 204e 6f6e 653a  ame is not None:
+000181b0: 2073 656c 662e 5f67 656f 6d4e 616d 6520   self._geomName 
+000181c0: 3d20 6e61 6d65 0d0a 2020 2020 2020 2020  = name..        
+000181d0: 7265 7475 726e 2073 656c 660d 0a20 2020  return self..   
+000181e0: 200d 0a20 2020 2064 6566 206d 6170 5f67   ..    def map_g
+000181f0: 656f 6d5f 6672 6f6d 5f6f 7028 7365 6c66  eom_from_op(self
+00018200: 2c20 6f70 6572 6174 696f 6e2c 2072 6574  , operation, ret
+00018210: 7572 6e78 797a 3d46 616c 7365 2c20 6e61  urnxyz=False, na
+00018220: 6d65 3d4e 6f6e 6529 203a 0d0a 2020 2020  me=None) :..    
+00018230: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
+00018240: 2046 756e 6374 696f 6e61 6c20 7472 616e   Functional tran
+00018250: 7366 6f72 6d61 7469 6f6e 206f 6620 7375  sformation of su
+00018260: 7266 6163 6520 7665 7274 6578 2063 6f6f  rface vertex coo
+00018270: 7264 696e 6174 6573 2e0d 0a0d 0a20 2020  rdinates.....   
+00018280: 2020 2020 2054 6869 7320 6d65 7468 6f64       This method
+00018290: 2069 7320 6e6f 7420 6176 6169 6c61 626c   is not availabl
+000182a0: 6520 666f 7220 636f 6d70 6f73 6974 6520  e for composite 
+000182b0: 7375 7266 6163 6573 2e0d 0a0d 0a20 2020  surfaces.....   
+000182c0: 2020 2020 2050 6172 616d 6574 6572 730d       Parameters.
+000182d0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+000182e0: 2d2d 2d0d 0a20 2020 2020 2020 206f 7065  ---..        ope
+000182f0: 7261 7469 6f6e 203a 2066 756e 6374 696f  ration : functio
+00018300: 6e20 6f62 6a65 6374 0d0a 2020 2020 2020  n object..      
+00018310: 2020 2020 2020 436f 6f72 6469 6e61 7465        Coordinate
+00018320: 206d 6170 7069 6e67 2066 756e 6374 696f   mapping functio
+00018330: 6e20 7468 6174 2074 616b 6573 206f 6e65  n that takes one
+00018340: 0d0a 2020 2020 2020 2020 2020 2020 6172  ..            ar
+00018350: 6775 6d65 6e74 2c20 6120 3378 4e20 4e75  gument, a 3xN Nu
+00018360: 6d70 7920 6172 7261 7920 6f66 206e 6174  mpy array of nat
+00018370: 6976 6520 636f 6f72 6469 6e61 7465 732e  ive coordinates.
+00018380: 0d0a 2020 2020 2020 2020 2020 2020 5468  ..            Th
+00018390: 6520 6675 6e63 7469 6f6e 2072 6574 7572  e function retur
+000183a0: 6e73 2061 2033 784e 2061 7272 6179 206f  ns a 3xN array o
+000183b0: 6620 636f 6f72 6469 6e61 7465 732e 0d0a  f coordinates...
+000183c0: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+000183d0: 7879 7a20 3a20 626f 6f6c 207b 2054 7275  xyz : bool { Tru
+000183e0: 652c 2046 616c 7365 207d 2c20 6f70 7469  e, False }, opti
+000183f0: 6f6e 616c 2c20 6465 6661 756c 743a 2046  onal, default: F
+00018400: 616c 7365 0d0a 2020 2020 2020 2020 2020  alse..          
+00018410: 2020 4279 2064 6566 6175 6c74 2c20 6e61    By default, na
+00018420: 7469 7665 2063 6f6f 7264 696e 6174 6573  tive coordinates
+00018430: 2061 7265 2072 6574 7572 6e65 6420 6279   are returned by
+00018440: 2074 6865 0d0a 2020 2020 2020 2020 2020   the..          
+00018450: 2020 6f70 6572 6174 696f 6e20 6675 6e63    operation func
+00018460: 7469 6f6e 2e20 2049 6620 7365 7420 5472  tion.  If set Tr
+00018470: 7565 2c20 7468 6520 6f70 6572 6174 696f  ue, the operatio
+00018480: 6e0d 0a20 2020 2020 2020 2020 2020 2072  n..            r
+00018490: 6574 7572 6e73 2078 797a 2043 6172 7465  eturns xyz Carte
+000184a0: 7369 616e 2063 6f6f 7264 696e 6174 6573  sian coordinates
+000184b0: 2e0d 0a0d 0a20 2020 2020 2020 206e 616d  .....        nam
+000184c0: 6520 3a20 7374 7269 6e67 2c20 6f70 7469  e : string, opti
+000184d0: 6f6e 616c 2c20 6465 6661 756c 743a 204e  onal, default: N
+000184e0: 6f6e 6520 6f72 206f 7020 6675 6e63 7469  one or op functi
+000184f0: 6f6e 206e 616d 652e 0d0a 2020 2020 2020  on name...      
+00018500: 2020 2020 2020 4465 7363 7269 7074 6976        Descriptiv
+00018510: 6520 6964 656e 7469 6669 6572 2066 6f72  e identifier for
+00018520: 2074 6865 2067 656f 6d65 7472 792e 0d0a   the geometry...
+00018530: 0d0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+00018540: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+00018550: 2d2d 0d0a 2020 2020 2020 2020 7365 6c66  --..        self
+00018560: 203a 2073 7572 6661 6365 206f 626a 6563   : surface objec
+00018570: 740d 0a0d 0a20 2020 2020 2020 2022 2222  t....        """
+00018580: 0d0a 0d0a 2020 2020 2020 2020 7265 7475  ....        retu
+00018590: 726e 2073 656c 662e 5f6d 6170 5f67 656f  rn self._map_geo
+000185a0: 6d5f 6672 6f6d 5f6f 7028 206f 7065 7261  m_from_op( opera
+000185b0: 7469 6f6e 2c20 7265 7475 726e 7879 7a2c  tion, returnxyz,
+000185c0: 206e 616d 652c 2063 6865 636b 3d54 7275   name, check=Tru
+000185d0: 6529 0d0a 0d0a 2020 2020 6465 6620 5f6d  e)....    def _m
+000185e0: 6170 5f67 656f 6d5f 6672 6f6d 5f6f 7028  ap_geom_from_op(
+000185f0: 7365 6c66 2c20 6f70 6572 6174 696f 6e2c  self, operation,
+00018600: 2072 6574 7572 6e78 797a 2c20 6e61 6d65   returnxyz, name
+00018610: 2c20 6368 6563 6b29 203a 0d0a 2020 2020  , check) :..    
+00018620: 2020 2020 0d0a 2020 2020 2020 2020 2320      ..        # 
+00018630: 7573 6564 2062 7920 646f 6d61 696e 2077  used by domain w
+00018640: 6974 6820 6368 6563 6b3d 4661 6c73 6520  ith check=False 
+00018650: 746f 2061 6c6c 6f77 2063 6f6d 706f 7369  to allow composi
+00018660: 7465 7320 7363 616c 696e 672e 0d0a 2020  tes scaling...  
+00018670: 2020 2020 2020 2320 6f74 6865 7277 6973        # otherwis
+00018680: 652c 206e 6f74 2061 6c6c 6f77 6564 2062  e, not allowed b
+00018690: 7920 6d61 705f 6765 6f6d 5f66 726f 6d5f  y map_geom_from_
+000186a0: 6f70 206d 6574 686f 642e 0d0a 0d0a 2020  op method.....  
+000186b0: 2020 2020 2020 6966 2073 656c 662e 5f69        if self._i
+000186c0: 7343 6f6d 706f 7369 7465 5375 7266 6163  sCompositeSurfac
+000186d0: 6520 616e 6420 6368 6563 6b20 3a0d 0a20  e and check :.. 
+000186e0: 2020 2020 2020 2020 2020 2077 6172 6e69             warni
+000186f0: 6e67 732e 7761 726e 2827 4d61 7020 6f70  ngs.warn('Map op
+00018700: 6572 6174 696f 6e20 4d55 5354 2075 7365  eration MUST use
+00018710: 2078 797a 2063 6f6f 7264 696e 6174 6573   xyz coordinates
+00018720: 2066 6f72 2063 6f6d 6269 6e65 6420 7368   for combined sh
+00018730: 6170 6573 2e27 290d 0a20 2020 2020 2020  apes.')..       
+00018740: 2020 2020 2023 7761 726e 696e 6773 2e77       #warnings.w
+00018750: 6172 6e28 274d 6170 206f 7065 7261 7469  arn('Map operati
+00018760: 6f6e 206e 6f74 2061 7661 696c 6162 6c65  on not available
+00018770: 2066 6f72 2063 6f6d 6269 6e65 6420 7368   for combined sh
+00018780: 6170 6573 2e27 290d 0a20 2020 2020 2020  apes.')..       
+00018790: 2020 2020 2023 7265 7475 726e 2073 656c       #return sel
+000187a0: 660d 0a20 2020 2020 2020 2076 203d 2073  f..        v = s
+000187b0: 656c 662e 5f74 7261 6e73 666f 726d 5665  elf._transformVe
+000187c0: 6374 6f72 2873 656c 662e 7665 7274 6578  ctor(self.vertex
+000187d0: 436f 6f72 2c20 6f70 6572 6174 696f 6e2c  Coor, operation,
+000187e0: 2072 6574 7572 6e78 797a 290d 0a20 2020   returnxyz)..   
+000187f0: 2020 2020 2076 6572 7473 203d 2076 5b73       verts = v[s
+00018800: 656c 662e 6676 496e 6469 6365 735d 0d0a  elf.fvIndices]..
+00018810: 2020 2020 2020 2020 7365 6c66 2e76 6572          self.ver
+00018820: 7465 7843 6f6f 7220 3d20 760d 0a20 2020  texCoor = v..   
+00018830: 2020 2020 2073 656c 662e 5f73 6574 5f67       self._set_g
+00018840: 656f 6d65 7472 6963 5f62 6f75 6e64 7328  eometric_bounds(
+00018850: 290d 0a20 2020 2020 2020 2073 656c 662e  )..        self.
+00018860: 7365 745f 7665 7274 7328 2076 6572 7473  set_verts( verts
+00018870: 2029 0d0a 2020 2020 2020 2020 7365 6c66   )..        self
+00018880: 2e5f 7375 7266 6163 6553 6861 7065 4368  ._surfaceShapeCh
+00018890: 616e 6765 6420 3d20 5472 7565 0d0a 2020  anged = True..  
+000188a0: 2020 2020 2020 6966 206e 616d 6520 6973        if name is
+000188b0: 204e 6f6e 6520 3a20 6e61 6d65 203d 2073   None : name = s
+000188c0: 656c 662e 5f67 656f 6d4e 616d 650d 0a20  elf._geomName.. 
+000188d0: 2020 2020 2020 206e 616d 6520 3d20 5f67         name = _g
+000188e0: 6574 4675 6e63 7469 6f6e 4e61 6d65 286f  etFunctionName(o
+000188f0: 7065 7261 7469 6f6e 2c6e 616d 6529 0d0a  peration,name)..
+00018900: 2020 2020 2020 2020 6966 206e 616d 6520          if name 
+00018910: 6973 206e 6f74 204e 6f6e 653a 2073 656c  is not None: sel
+00018920: 662e 5f67 656f 6d4e 616d 6520 3d20 6e61  f._geomName = na
+00018930: 6d65 0d0a 2020 2020 2020 2020 7265 7475  me..        retu
+00018940: 726e 2073 656c 660d 0a20 2020 200d 0a20  rn self..    .. 
+00018950: 2020 2064 6566 2063 6c69 7028 7365 6c66     def clip(self
+00018960: 2c20 6f70 6572 6174 696f 6e2c 2075 7365  , operation, use
+00018970: 7879 7a3d 4661 6c73 6529 203a 0d0a 2020  xyz=False) :..  
+00018980: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
+00018990: 2020 2052 656d 6f76 6520 6661 6365 7320     Remove faces 
+000189a0: 6672 6f6d 2074 6865 2073 7572 6661 6365  from the surface
+000189b0: 2062 6173 6564 206f 6e20 706f 7369 7469   based on positi
+000189c0: 6f6e 2e0d 0a0d 0a20 2020 2020 2020 2050  on.....        P
+000189d0: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
+000189e0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
+000189f0: 2020 2020 2020 206f 7065 7261 7469 6f6e         operation
+00018a00: 203a 2066 756e 6374 696f 6e20 6f62 6a65   : function obje
+00018a10: 6374 0d0a 2020 2020 2020 2020 2020 2020  ct..            
+00018a20: 4675 6e63 7469 6f6e 2074 6861 7420 7461  Function that ta
+00018a30: 6b65 7320 6f6e 6520 6172 6775 6d65 6e74  kes one argument
+00018a40: 2c20 6120 3378 4e20 4e75 6d70 7920 6172  , a 3xN Numpy ar
+00018a50: 7261 7920 6f66 2063 6f6f 7264 696e 6174  ray of coordinat
+00018a60: 6573 2e0d 0a20 2020 2020 2020 2020 2020  es...           
+00018a70: 2054 6865 2066 756e 6374 696f 6e20 7265   The function re
+00018a80: 7475 726e 7320 6120 626f 6f6c 207b 2054  turns a bool { T
+00018a90: 7275 652c 2046 616c 7365 207d 2069 6e64  rue, False } ind
+00018aa0: 6963 6174 696e 6720 6966 0d0a 2020 2020  icating if..    
+00018ab0: 2020 2020 2020 2020 7468 6520 6661 6365          the face
+00018ac0: 2c20 6174 2074 6865 2066 6163 6520 6365  , at the face ce
+00018ad0: 6e74 6572 6564 2063 6f6f 7264 696e 6174  ntered coordinat
+00018ae0: 652c 2069 7320 746f 2062 6520 0d0a 2020  e, is to be ..  
+00018af0: 2020 2020 2020 2020 2020 7265 7461 696e            retain
+00018b00: 6564 2028 5472 7565 292c 206f 7468 6572  ed (True), other
+00018b10: 7769 7365 2c20 7468 6520 6661 6365 2069  wise, the face i
+00018b20: 7320 7265 6d6f 7665 6420 6672 6f6d 2074  s removed from t
+00018b30: 6865 0d0a 2020 2020 2020 2020 2020 2020  he..            
+00018b40: 7375 7266 6163 6520 2846 616c 7365 292e  surface (False).
+00018b50: 0d0a 0d0a 2020 2020 2020 2020 7573 6578  ....        usex
+00018b60: 797a 203a 2062 6f6f 6c20 7b20 5472 7565  yz : bool { True
+00018b70: 2c20 4661 6c73 6520 7d2c 2064 6566 6175  , False }, defau
+00018b80: 6c74 3a20 4661 6c73 650d 0a20 2020 2020  lt: False..     
+00018b90: 2020 2020 2020 2049 6620 5472 7565 2c20         If True, 
+00018ba0: 6661 6365 2063 656e 7465 7273 2061 7265  face centers are
+00018bb0: 2070 6173 7365 6420 746f 2074 6865 206f   passed to the o
+00018bc0: 7065 7261 7469 6f6e 2066 756e 6374 696f  peration functio
+00018bd0: 6e0d 0a20 2020 2020 2020 2020 2020 2069  n..            i
+00018be0: 6e20 7879 7a20 636f 6f72 6469 6e61 7465  n xyz coordinate
+00018bf0: 732e 2020 4966 2046 616c 7365 2c20 6661  s.  If False, fa
+00018c00: 6365 2063 656e 7465 7273 2061 7265 2070  ce centers are p
+00018c10: 6173 7365 640d 0a20 2020 2020 2020 2020  assed..         
+00018c20: 2020 2069 6e20 6e61 7469 7665 2063 6f6f     in native coo
+00018c30: 7264 696e 6174 6573 2e0d 0a0d 0a20 2020  rdinates.....   
+00018c40: 2020 2020 2052 6574 7572 6e73 0d0a 2020       Returns..  
+00018c50: 2020 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20        -------.. 
+00018c60: 2020 2020 2020 2073 656c 6620 3a20 7375         self : su
+00018c70: 7266 6163 6520 6f62 6a65 6374 0d0a 0d0a  rface object....
+00018c80: 2020 2020 2020 2020 2222 220d 0a0d 0a20          """.... 
+00018c90: 2020 2020 2020 2023 2043 6c69 7020 6f70         # Clip op
+00018ca0: 6572 6174 696f 6e20 4d55 5354 2075 7365  eration MUST use
+00018cb0: 2078 797a 2063 6f6f 7264 696e 6174 6573   xyz coordinates
+00018cc0: 2066 6f72 2063 6f6d 6269 6e65 6420 7368   for combined sh
+00018cd0: 6170 6573 2e0d 0a20 2020 2020 2020 2023  apes...        #
+00018ce0: 2073 696e 6365 206e 6174 6976 6520 636f   since native co
+00018cf0: 6f72 6469 6e61 7465 206d 6179 2062 6520  ordinate may be 
+00018d00: 756e 6465 6669 6e65 642e 0d0a 2020 2020  undefined...    
+00018d10: 2020 2020 6966 2073 656c 662e 5f69 7343      if self._isC
+00018d20: 6f6d 706f 7369 7465 5375 7266 6163 6520  ompositeSurface 
+00018d30: 3a20 7573 6578 797a 203d 2054 7275 650d  : usexyz = True.
+00018d40: 0a0d 0a20 2020 2020 2020 2076 6572 7473  ...        verts
+00018d50: 203d 2073 656c 662e 7665 7274 6578 436f   = self.vertexCo
+00018d60: 6f72 5b20 7365 6c66 2e66 7649 6e64 6963  or[ self.fvIndic
+00018d70: 6573 205d 0d0a 2020 2020 2020 2020 6661  es ]..        fa
+00018d80: 6365 4365 6e74 6572 436f 6f72 203d 2073  ceCenterCoor = s
+00018d90: 656c 662e 5f67 6574 5f66 6163 655f 6365  elf._get_face_ce
+00018da0: 6e74 6572 7328 7665 7274 7329 0d0a 0d0a  nters(verts)....
+00018db0: 2020 2020 2020 2020 7365 6c66 2e5f 706f          self._po
+00018dc0: 7374 5072 6f63 5f73 7572 6661 6365 436f  stProc_surfaceCo
+00018dd0: 6c6f 7273 2829 0d0a 2020 2020 2020 2020  lors()..        
+00018de0: 6f72 6967 5f63 6f6c 6f72 7320 3d20 7365  orig_colors = se
+00018df0: 6c66 2e5f 6466 6163 6563 6f6c 6f72 7320  lf._dfacecolors 
+00018e00: 2023 2075 7064 6174 6520 666f 7220 765f   # update for v_
+00018e10: 312e 322e 300d 0a0d 0a20 2020 2020 2020  1.2.0....       
+00018e20: 2078 797a 203d 206e 702e 7472 616e 7370   xyz = np.transp
+00018e30: 6f73 6528 6661 6365 4365 6e74 6572 436f  ose(faceCenterCo
+00018e40: 6f72 290d 0a20 2020 2020 2020 2069 6620  or)..        if 
+00018e50: 7573 6578 797a 2069 7320 4661 6c73 6520  usexyz is False 
+00018e60: 3a20 2078 797a 203d 2073 656c 662e 636f  :  xyz = self.co
+00018e70: 6f72 5f63 6f6e 7665 7274 2878 797a 290d  or_convert(xyz).
+00018e80: 0a20 2020 2020 2020 2061 6263 203d 2078  .        abc = x
+00018e90: 797a 0d0a 2020 2020 2020 2020 7368 6f75  yz..        shou
+00018ea0: 6c64 4b65 6570 203d 206e 702e 6172 7261  ldKeep = np.arra
+00018eb0: 7928 6f70 6572 6174 696f 6e28 6162 6329  y(operation(abc)
+00018ec0: 290d 0a20 2020 2020 2020 2069 6620 6e70  )..        if np
+00018ed0: 2e61 6e79 2873 686f 756c 644b 6565 7029  .any(shouldKeep)
+00018ee0: 2069 7320 4e6f 6e65 203a 0d0a 2020 2020   is None :..    
+00018ef0: 2020 2020 2020 2020 7761 726e 696e 6773          warnings
+00018f00: 2e77 6172 6e28 2757 4152 4e49 4e47 3a20  .warn('WARNING: 
+00018f10: 436c 6970 7069 6e67 2072 6573 756c 7465  Clipping resulte
+00018f20: 6420 696e 206e 6f20 6661 6365 7320 666f  d in no faces fo
+00018f30: 756e 642c 2073 7572 6661 6365 2072 6574  und, surface ret
+00018f40: 7572 6e20 756e 636c 6970 7065 642e 2729  urn unclipped.')
+00018f50: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
+00018f60: 7475 726e 2073 656c 660d 0a0d 0a20 2020  turn self....   
+00018f70: 2020 2020 2066 7669 203d 2073 656c 662e       fvi = self.
+00018f80: 6676 496e 6469 6365 735b 7368 6f75 6c64  fvIndices[should
+00018f90: 4b65 6570 5d0d 0a20 2020 2020 2020 2066  Keep]..        f
+00018fa0: 636f 6c20 3d20 6f72 6967 5f63 6f6c 6f72  col = orig_color
+00018fb0: 735b 7368 6f75 6c64 4b65 6570 5d0d 0a0d  s[shouldKeep]...
+00018fc0: 0a20 2020 2020 2020 2023 2074 6869 7320  .        # this 
+00018fd0: 7065 726d 6974 7320 6d75 6c74 6970 6c65  permits multiple
+00018fe0: 2063 6c69 7073 2077 6974 686f 7574 2063   clips without c
+00018ff0: 6861 6e67 696e 6720 6f72 6967 696e 616c  hanging original
+00019000: 2c20 736f 2072 6573 746f 7265 2069 7320  , so restore is 
+00019010: 6176 6169 6c61 626c 652e 0d0a 2020 2020  available...    
+00019020: 2020 2020 6966 2073 656c 662e 7265 7374      if self.rest
+00019030: 6f72 6564 436c 6970 2069 7320 4e6f 6e65  oredClip is None
+00019040: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
+00019050: 7365 6c66 2e72 6573 746f 7265 6443 6c69  self.restoredCli
+00019060: 7020 3d20 7b20 2766 6163 6573 2720 3a20  p = { 'faces' : 
+00019070: 7365 6c66 2e66 7649 6e64 6963 6573 2c20  self.fvIndices, 
+00019080: 2763 6f6c 6f72 7327 203a 206f 7269 675f  'colors' : orig_
+00019090: 636f 6c6f 7273 207d 0d0a 0d0a 2020 2020  colors }....    
+000190a0: 2020 2020 6676 6920 3d20 6e70 2e61 7272      fvi = np.arr
+000190b0: 6179 2866 7669 290d 0a20 2020 2020 2020  ay(fvi)..       
+000190c0: 2073 656c 662e 6676 496e 6469 6365 7320   self.fvIndices 
+000190d0: 3d20 6676 690d 0a20 2020 2020 2020 2073  = fvi..        s
+000190e0: 656c 662e 7365 745f 636f 6c6f 7228 6663  elf.set_color(fc
+000190f0: 6f6c 2920 2020 2020 2020 200d 0a20 2020  ol)        ..   
+00019100: 2020 2020 2076 203d 2073 656c 662e 7665       v = self.ve
+00019110: 7274 6578 436f 6f72 0d0a 2020 2020 2020  rtexCoor..      
+00019120: 2020 7666 7669 203d 2076 5b66 7669 5d0d    vfvi = v[fvi].
+00019130: 0a20 2020 2020 2020 2073 656c 662e 7365  .        self.se
+00019140: 745f 7665 7274 7328 2076 6676 6920 290d  t_verts( vfvi ).
+00019150: 0a0d 0a20 2020 2020 2020 2063 6c69 7056  ...        clipV
+00019160: 6572 7473 2020 3d20 6e70 2e72 6573 6861  erts  = np.resha
+00019170: 7065 2876 6676 692c 282d 312c 3329 290d  pe(vfvi,(-1,3)).
+00019180: 0a20 2020 2020 2020 205f 7365 745f 6765  .        _set_ge
+00019190: 6f6d 426f 756e 6473 2820 636c 6970 5665  omBounds( clipVe
+000191a0: 7274 732c 7365 6c66 2e62 6f75 6e64 7320  rts,self.bounds 
+000191b0: 290d 0a20 2020 2020 2020 2073 656c 662e  )..        self.
+000191c0: 5f73 6574 5f69 6e64 6578 5f72 656c 6174  _set_index_relat
+000191d0: 696f 6e73 2829 0d0a 2020 2020 2020 2020  ions()..        
+000191e0: 7265 7475 726e 2073 656c 660d 0a0d 0a20  return self.... 
+000191f0: 2020 2064 6566 2063 6c69 705f 616c 7068     def clip_alph
+00019200: 6128 7365 6c66 2c61 6c70 6861 4375 742c  a(self,alphaCut,
+00019210: 7573 6576 616c 3d46 616c 7365 2920 3a0d  useval=False) :.
+00019220: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
+00019230: 2020 2020 2020 5265 6d6f 7665 2066 6163        Remove fac
+00019240: 6573 2066 726f 6d20 7468 6520 7375 7266  es from the surf
+00019250: 6163 6520 6261 7365 6420 6f6e 2061 6c70  ace based on alp
+00019260: 6861 2074 7261 6e73 7061 7265 6e63 792e  ha transparency.
+00019270: 0d0a 0d0a 2020 2020 2020 2020 5061 7261  ....        Para
+00019280: 6d65 7465 7273 0d0a 2020 2020 2020 2020  meters..        
+00019290: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
+000192a0: 2020 2020 616c 7068 6143 7574 203a 2073      alphaCut : s
+000192b0: 6361 6c61 720d 0a20 2020 2020 2020 2020  calar..         
+000192c0: 2020 2049 6620 7468 6520 6661 6365 2063     If the face c
+000192d0: 6f6c 6f72 2061 6c70 6861 2069 7320 6772  olor alpha is gr
+000192e0: 6561 7465 7220 7468 616e 2061 6c70 6861  eater than alpha
+000192f0: 4375 742c 2074 6865 2066 6163 6520 6973  Cut, the face is
+00019300: 200d 0a20 2020 2020 2020 2020 2020 2072   ..            r
+00019310: 6574 6169 6e65 642c 206f 7468 6572 7769  etained, otherwi
+00019320: 7365 2c20 7468 6520 6661 6365 2069 7320  se, the face is 
+00019330: 7265 6d6f 7665 6420 6672 6f6d 2074 6865  removed from the
+00019340: 2073 7572 6661 6365 2e0d 0a0d 0a20 2020   surface.....   
+00019350: 2020 2020 2075 7365 7661 6c20 3a20 626f       useval : bo
+00019360: 6f6c 207b 2054 7275 652c 2046 616c 7365  ol { True, False
+00019370: 207d 2c20 6465 6661 756c 743a 2046 616c   }, default: Fal
+00019380: 7365 0d0a 2020 2020 2020 2020 2020 2020  se..            
+00019390: 4966 2054 7275 652c 2063 6c69 7070 696e  If True, clippin
+000193a0: 6720 6261 7365 6420 6f6e 2063 6f6c 6f72  g based on color
+000193b0: 2048 5356 2076 616c 7565 2e20 204f 7468   HSV value.  Oth
+000193c0: 6572 7769 7365 2c0d 0a20 2020 2020 2020  erwise,..       
+000193d0: 2020 2020 2063 6c69 7070 696e 6720 6973       clipping is
+000193e0: 2062 6173 6564 206f 6e20 7468 6520 636f   based on the co
+000193f0: 6c6f 7220 616c 7068 6120 7661 6c75 652e  lor alpha value.
+00019400: 0d0a 0d0a 2020 2020 2020 2020 5265 7475  ....        Retu
+00019410: 726e 730d 0a20 2020 2020 2020 202d 2d2d  rns..        ---
+00019420: 2d2d 2d2d 0d0a 2020 2020 2020 2020 7365  ----..        se
+00019430: 6c66 203a 2073 7572 6661 6365 206f 626a  lf : surface obj
+00019440: 6563 740d 0a0d 0a20 2020 2020 2020 2022  ect....        "
+00019450: 2222 0d0a 2020 2020 2020 2020 7365 6c66  ""..        self
+00019460: 2e5f 706f 7374 5072 6f63 5f73 7572 6661  ._postProc_surfa
+00019470: 6365 436f 6c6f 7273 2829 0d0a 2020 2020  ceColors()..    
+00019480: 2020 2020 6f72 6967 5f63 6f6c 6f72 7320      orig_colors 
+00019490: 3d20 7365 6c66 2e5f 6466 6163 6563 6f6c  = self._dfacecol
+000194a0: 6f72 7320 2023 2075 7064 6174 6520 666f  ors  # update fo
+000194b0: 7220 765f 312e 322e 300d 0a0d 0a20 2020  r v_1.2.0....   
+000194c0: 2020 2020 2069 6620 7573 6576 616c 203a       if useval :
+000194d0: 0d0a 2020 2020 2020 2020 2020 2020 6f72  ..            or
+000194e0: 6967 5f68 7376 203d 2063 6f6c 6f72 732e  ig_hsv = colors.
+000194f0: 7267 625f 746f 5f68 7376 286f 7269 675f  rgb_to_hsv(orig_
+00019500: 636f 6c6f 7273 5b3a 2c3a 335d 290d 0a20  colors[:,:3]).. 
+00019510: 2020 2020 2020 2020 2020 2061 6c70 6861             alpha
+00019520: 7320 3d20 6e70 2e72 6176 656c 2820 6f72  s = np.ravel( or
+00019530: 6967 5f68 7376 5b3a 2c32 3a33 5d20 290d  ig_hsv[:,2:3] ).
+00019540: 0a20 2020 2020 2020 2065 6c73 6520 3a0d  .        else :.
+00019550: 0a20 2020 2020 2020 2020 2020 2061 6c70  .            alp
+00019560: 6861 7320 3d20 6e70 2e72 6176 656c 2820  has = np.ravel( 
+00019570: 6f72 6967 5f63 6f6c 6f72 735b 3a2c 333a  orig_colors[:,3:
+00019580: 345d 2029 0d0a 2020 2020 2020 2020 6375  4] )..        cu
+00019590: 7473 203d 206e 702e 6675 6c6c 286c 656e  ts = np.full(len
+000195a0: 2861 6c70 6861 7329 2c61 6c70 6861 4375  (alphas),alphaCu
+000195b0: 7429 0d0a 2020 2020 2020 2020 7368 6f75  t)..        shou
+000195c0: 6c64 4b65 6570 203d 2061 6c70 6861 733e  ldKeep = alphas>
+000195d0: 6375 7473 0d0a 0d0a 2020 2020 2020 2020  cuts....        
+000195e0: 6966 206e 702e 616e 7928 7368 6f75 6c64  if np.any(should
+000195f0: 4b65 6570 2920 6973 204e 6f6e 6520 3a0d  Keep) is None :.
+00019600: 0a20 2020 2020 2020 2020 2020 2077 6172  .            war
+00019610: 6e69 6e67 732e 7761 726e 2827 5741 524e  nings.warn('WARN
+00019620: 494e 473a 2041 6c70 6861 2063 6c69 7070  ING: Alpha clipp
+00019630: 696e 6720 7265 7375 6c74 6564 2069 6e20  ing resulted in 
+00019640: 6e6f 2066 6163 6573 2066 6f75 6e64 2c20  no faces found, 
+00019650: 7375 7266 6163 6520 7265 7475 726e 2075  surface return u
+00019660: 6e63 6c69 7070 6564 2e27 290d 0a20 2020  nclipped.')..   
+00019670: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00019680: 7365 6c66 0d0a 2020 2020 2020 2020 6676  self..        fv
+00019690: 6920 3d20 7365 6c66 2e66 7649 6e64 6963  i = self.fvIndic
+000196a0: 6573 5b73 686f 756c 644b 6565 705d 0d0a  es[shouldKeep]..
+000196b0: 2020 2020 2020 2020 6663 6f6c 203d 206f          fcol = o
+000196c0: 7269 675f 636f 6c6f 7273 5b73 686f 756c  rig_colors[shoul
+000196d0: 644b 6565 705d 0d0a 0d0a 2020 2020 2020  dKeep]....      
+000196e0: 2020 2320 7468 6973 2070 6572 6d69 7473    # this permits
+000196f0: 206d 756c 7469 706c 6520 636c 6970 7320   multiple clips 
+00019700: 7769 7468 6f75 7420 6368 616e 6769 6e67  without changing
+00019710: 206f 7269 6769 6e61 6c2c 2073 6f20 7265   original, so re
+00019720: 7374 6f72 6520 6973 2061 7661 696c 6162  store is availab
+00019730: 6c65 2e0d 0a20 2020 2020 2020 2069 6620  le...        if 
+00019740: 7365 6c66 2e72 6573 746f 7265 6443 6c69  self.restoredCli
+00019750: 7020 6973 204e 6f6e 6520 3a0d 0a20 2020  p is None :..   
+00019760: 2020 2020 2020 2020 2073 656c 662e 7265           self.re
+00019770: 7374 6f72 6564 436c 6970 203d 207b 2027  storedClip = { '
+00019780: 6661 6365 7327 203a 2073 656c 662e 6676  faces' : self.fv
+00019790: 496e 6469 6365 732c 2027 636f 6c6f 7273  Indices, 'colors
+000197a0: 2720 3a20 6f72 6967 5f63 6f6c 6f72 7320  ' : orig_colors 
+000197b0: 7d0d 0a0d 0a20 2020 2020 2020 2066 7669  }....        fvi
+000197c0: 203d 206e 702e 6172 7261 7928 6676 6929   = np.array(fvi)
+000197d0: 0d0a 2020 2020 2020 2020 7365 6c66 2e66  ..        self.f
+000197e0: 7649 6e64 6963 6573 203d 2066 7669 0d0a  vIndices = fvi..
+000197f0: 2020 2020 2020 2020 7365 6c66 2e73 6574          self.set
+00019800: 5f63 6f6c 6f72 2866 636f 6c29 2020 2020  _color(fcol)    
+00019810: 2020 2020 0d0a 2020 2020 2020 2020 7620      ..        v 
+00019820: 3d20 7365 6c66 2e76 6572 7465 7843 6f6f  = self.vertexCoo
+00019830: 720d 0a20 2020 2020 2020 2076 6676 6920  r..        vfvi 
+00019840: 3d20 765b 6676 695d 0d0a 2020 2020 2020  = v[fvi]..      
+00019850: 2020 7365 6c66 2e73 6574 5f76 6572 7473    self.set_verts
+00019860: 2820 7666 7669 2029 0d0a 0d0a 2020 2020  ( vfvi )....    
+00019870: 2020 2020 636c 6970 5665 7274 7320 203d      clipVerts  =
+00019880: 206e 702e 7265 7368 6170 6528 7666 7669   np.reshape(vfvi
+00019890: 2c28 2d31 2c33 2929 0d0a 2020 2020 2020  ,(-1,3))..      
+000198a0: 2020 5f73 6574 5f67 656f 6d42 6f75 6e64    _set_geomBound
+000198b0: 7328 2063 6c69 7056 6572 7473 2c73 656c  s( clipVerts,sel
+000198c0: 662e 626f 756e 6473 2029 0d0a 2020 2020  f.bounds )..    
+000198d0: 2020 2020 7365 6c66 2e5f 7365 745f 696e      self._set_in
+000198e0: 6465 785f 7265 6c61 7469 6f6e 7328 290d  dex_relations().
+000198f0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00019900: 7365 6c66 0d0a 0d0a 2020 2020 6465 6620  self....    def 
+00019910: 636c 6970 5f70 6c61 6e65 2873 656c 662c  clip_plane(self,
+00019920: 6469 7374 2c2a 2a6b 6172 6773 2920 3a0d  dist,**kargs) :.
+00019930: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
+00019940: 2020 2020 2020 5265 6d6f 7665 2066 6163        Remove fac
+00019950: 6573 2066 726f 6d20 7468 6520 7375 7266  es from the surf
+00019960: 6163 6520 6261 7365 6420 6f6e 2061 2063  ace based on a c
+00019970: 6c69 7020 7375 7266 6163 652e 0d0a 0d0a  lip surface.....
+00019980: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+00019990: 7273 0d0a 2020 2020 2020 2020 2d2d 2d2d  rs..        ----
+000199a0: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
+000199b0: 6469 7374 203a 2066 6c6f 6174 0d0a 2020  dist : float..  
+000199c0: 2020 2020 2020 2020 2020 4469 7374 616e            Distan
+000199d0: 6365 2066 726f 6d20 7468 6520 6f72 6967  ce from the orig
+000199e0: 696e 2074 6f20 7468 6520 636c 6970 2073  in to the clip s
+000199f0: 7572 6661 6365 2c0d 0a20 2020 2020 2020  urface,..       
+00019a00: 2020 2020 2061 6c6f 6e67 2074 6865 2064       along the d
+00019a10: 6972 6563 7469 6f6e 2076 6563 746f 722e  irection vector.
+00019a20: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+00019a30: 2020 2020 6469 7265 6374 696f 6e20 3a20      direction : 
+00019a40: 6172 7261 792d 6c69 6b65 2c20 6f70 7469  array-like, opti
+00019a50: 6f6e 616c 2c20 6465 6661 756c 743a 205b  onal, default: [
+00019a60: 302c 302c 315d 0d0a 2020 2020 2020 2020  0,0,1]..        
+00019a70: 2020 2020 4120 7879 7a20 7665 6374 6f72      A xyz vector
+00019a80: 206e 6f72 6d61 6c20 746f 2074 6865 2069   normal to the i
+00019a90: 6e74 6572 7365 6374 696f 6e20 706c 616e  ntersection plan
+00019aa0: 650d 0a20 2020 2020 2020 2020 2020 2066  e..            f
+00019ab0: 6f72 2061 2070 6c61 6e61 7220 636c 6970  or a planar clip
+00019ac0: 2073 7572 6661 6365 206f 7220 6178 6961   surface or axia
+00019ad0: 6c20 6469 7265 6374 696f 6e20 6f66 0d0a  l direction of..
+00019ae0: 2020 2020 2020 2020 2020 2020 6120 6379              a cy
+00019af0: 6c69 6e64 6572 2066 6f72 2061 2063 796c  linder for a cyl
+00019b00: 696e 6472 6963 616c 2063 6c69 7020 7375  indrical clip su
+00019b10: 7266 6163 652e 0d0a 0d0a 2020 2020 2020  rface.....      
+00019b20: 2020 636f 6f72 203a 2069 6e74 6567 6572    coor : integer
+00019b30: 206f 7220 7374 7269 6e67 2069 6e64 6963   or string indic
+00019b40: 6174 696e 6720 7468 6520 7479 7065 206f  ating the type o
+00019b50: 6620 636c 6970 2073 7572 6661 6365 3a0d  f clip surface:.
+00019b60: 0a20 2020 2020 2020 2020 2020 2030 2c20  .            0, 
+00019b70: 702c 2050 2c20 7879 7a2c 706c 616e 6172  p, P, xyz,planar
+00019b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019b90: 202d 2070 6c61 6e61 7220 2864 6566 6175   - planar (defau
+00019ba0: 6c74 290d 0a20 2020 2020 2020 2020 2020  lt)..           
+00019bb0: 2031 2c20 632c 2043 2c20 6379 6c69 6e64   1, c, C, cylind
+00019bc0: 6572 2c70 706c 6172 2c63 796c 696e 6472  er,pplar,cylindr
+00019bd0: 6963 616c 202d 2063 796c 696e 6465 720d  ical - cylinder.
+00019be0: 0a20 2020 2020 2020 2020 2020 2032 2c20  .            2, 
+00019bf0: 732c 2053 2c20 7370 6865 7265 2c73 7068  s, S, sphere,sph
+00019c00: 6572 6963 616c 2020 2020 2020 2020 2020  erical          
+00019c10: 202d 2073 7068 6572 650d 0a20 2020 2020   - sphere..     
+00019c20: 2020 2020 2020 2033 2c20 782c 2058 2020         3, x, X  
+00019c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019c40: 2020 2020 2020 2020 2020 202d 2079 2d7a             - y-z
+00019c50: 2070 6c61 6e65 0d0a 2020 2020 2020 2020   plane..        
+00019c60: 2020 2020 342c 2079 2c20 5920 2020 2020      4, y, Y     
+00019c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019c80: 2020 2020 2020 2020 2d20 782d 7a20 706c          - x-z pl
+00019c90: 616e 650d 0a20 2020 2020 2020 2020 2020  ane..           
+00019ca0: 2035 2c20 7a2c 205a 2020 2020 2020 2020   5, z, Z        
+00019cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019cc0: 2020 2020 202d 2078 2d79 2070 6c61 6e65       - x-y plane
+00019cd0: 0d0a 0d0a 2020 2020 2020 2020 5265 7475  ....        Retu
+00019ce0: 726e 730d 0a20 2020 2020 2020 202d 2d2d  rns..        ---
+00019cf0: 2d2d 2d2d 0d0a 2020 2020 2020 2020 7365  ----..        se
+00019d00: 6c66 203a 2073 7572 6661 6365 206f 626a  lf : surface obj
+00019d10: 6563 740d 0a0d 0a20 2020 2020 2020 2022  ect....        "
+00019d20: 2222 0d0a 2020 2020 2020 2020 2320 2e2e  ""..        # ..
+00019d30: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00019d40: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00019d50: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00019d60: 2e2e 2e2e 2e2e 2e2e 2e0d 0a20 2020 2020  ...........     
+00019d70: 2020 2064 6566 2063 6c69 705f 6f70 2878     def clip_op(x
+00019d80: 797a 2c64 6973 742c 636f 6f72 2c64 6972  yz,dist,coor,dir
+00019d90: 6563 7469 6f6e 2920 3a0d 0a20 2020 2020  ection) :..     
+00019da0: 2020 2020 2020 2061 6263 203d 206e 702e         abc = np.
+00019db0: 7472 616e 7370 6f73 6528 7879 7a29 0d0a  transpose(xyz)..
+00019dc0: 2020 2020 2020 2020 2020 2020 646f 7470              dotp
+00019dd0: 726f 6420 3d20 5f63 6f6f 725f 646f 7470  rod = _coor_dotp
+00019de0: 726f 6428 6469 7265 6374 696f 6e2c 636f  rod(direction,co
+00019df0: 6f72 2c61 6263 290d 0a20 2020 2020 2020  or,abc)..       
+00019e00: 2020 2020 2069 6620 636f 6f72 203e 2030       if coor > 0
+00019e10: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
+00019e20: 2020 2020 6966 2064 6973 7420 3c20 3020      if dist < 0 
+00019e30: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00019e40: 2020 2020 2020 2073 686f 756c 6463 6c69         shouldcli
+00019e50: 7020 3d20 6e70 2e67 7265 6174 6572 2864  p = np.greater(d
+00019e60: 6f74 7072 6f64 2c6e 702e 6675 6c6c 286c  otprod,np.full(l
+00019e70: 656e 2864 6f74 7072 6f64 292c 2d64 6973  en(dotprod),-dis
+00019e80: 7429 290d 0a20 2020 2020 2020 2020 2020  t))..           
+00019e90: 2020 2020 2065 6c73 6520 3a0d 0a20 2020       else :..   
+00019ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019eb0: 2073 686f 756c 6463 6c69 7020 3d20 6e70   shouldclip = np
+00019ec0: 2e6c 6573 7328 646f 7470 726f 642c 6e70  .less(dotprod,np
+00019ed0: 2e66 756c 6c28 6c65 6e28 646f 7470 726f  .full(len(dotpro
+00019ee0: 6429 2c64 6973 7429 290d 0a20 2020 2020  d),dist))..     
+00019ef0: 2020 2020 2020 2065 6c73 6520 3a20 2020         else :   
+00019f00: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+00019f10: 2020 2073 686f 756c 6463 6c69 7020 3d20     shouldclip = 
+00019f20: 6e70 2e6c 6573 7328 646f 7470 726f 642c  np.less(dotprod,
+00019f30: 6e70 2e66 756c 6c28 6c65 6e28 646f 7470  np.full(len(dotp
+00019f40: 726f 6429 2c64 6973 7429 290d 0a20 2020  rod),dist))..   
+00019f50: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00019f60: 7368 6f75 6c64 636c 6970 0d0a 2020 2020  shouldclip..    
+00019f70: 2020 2020 2320 2e2e 2e2e 2e2e 2e2e 2e2e      # ..........
+00019f80: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00019f90: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00019fa0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00019fb0: 2e0d 0a20 2020 2020 2020 2064 6972 4466  ...        dirDf
+00019fc0: 7420 3d20 7b20 2764 6972 6563 7469 6f6e  t = { 'direction
+00019fd0: 273a 205b 302c 302c 312e 305d 207d 0d0a  ': [0,0,1.0] }..
+00019fe0: 2020 2020 2020 2020 6b61 7267 4466 7420          kargDft 
+00019ff0: 3d20 7b20 2a2a 5f43 4f4f 525f 4b57 4152  = { **_COOR_KWAR
+0001a000: 4753 2c20 2a2a 6469 7244 6674 207d 0d0a  GS, **dirDft }..
+0001a010: 2020 2020 2020 2020 4b57 203d 204b 5770          KW = KWp
+0001a020: 726f 6365 7373 6f72 2820 6b61 7267 4466  rocessor( kargDf
+0001a030: 742c 2027 636c 6970 5f70 6c61 6e65 272c  t, 'clip_plane',
+0001a040: 202a 2a6b 6172 6773 290d 0a20 2020 2020   **kargs)..     
+0001a050: 2020 2063 6f6f 7220 3d20 4b57 2e67 6574     coor = KW.get
+0001a060: 5661 6c28 2763 6f6f 7227 290d 0a20 2020  Val('coor')..   
+0001a070: 2020 2020 2064 6972 6563 7469 6f6e 203d       direction =
+0001a080: 204b 572e 6765 7456 616c 2827 6469 7265   KW.getVal('dire
+0001a090: 6374 696f 6e27 290d 0a0d 0a20 2020 2020  ction')....     
+0001a0a0: 2020 2069 6620 636f 6f72 3d3d 3320 3a20     if coor==3 : 
+0001a0b0: 636f 6f72 2c20 6469 7265 6374 696f 6e20  coor, direction 
+0001a0c0: 3d20 302c 205b 2031 2c30 2c30 205d 0d0a  = 0, [ 1,0,0 ]..
+0001a0d0: 2020 2020 2020 2020 6966 2063 6f6f 723d          if coor=
+0001a0e0: 3d34 203a 2063 6f6f 722c 2064 6972 6563  =4 : coor, direc
+0001a0f0: 7469 6f6e 203d 2030 2c20 5b20 302c 312c  tion = 0, [ 0,1,
+0001a100: 3020 5d0d 0a20 2020 2020 2020 2069 6620  0 ]..        if 
+0001a110: 636f 6f72 3d3d 3520 3a20 636f 6f72 2c20  coor==5 : coor, 
+0001a120: 6469 7265 6374 696f 6e20 3d20 302c 205b  direction = 0, [
+0001a130: 2030 2c30 2c31 205d 0d0a 0d0a 2020 2020   0,0,1 ]....    
+0001a140: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0001a150: 636c 6970 2820 6c61 6d62 6461 2078 797a  clip( lambda xyz
+0001a160: 203a 2063 6c69 705f 6f70 2878 797a 2c64   : clip_op(xyz,d
+0001a170: 6973 742c 636f 6f72 2c64 6972 6563 7469  ist,coor,directi
+0001a180: 6f6e 292c 5472 7565 290d 0a0d 0a20 2020  on),True)....   
+0001a190: 2064 6566 2063 6c69 705f 6e6f 726d 616c   def clip_normal
+0001a1a0: 7328 7365 6c66 2c64 6972 6563 7469 6f6e  s(self,direction
+0001a1b0: 3d4e 6f6e 6529 203a 0d0a 2020 2020 2020  =None) :..      
+0001a1c0: 2020 2222 2220 0d0a 2020 2020 2020 2020    """ ..        
+0001a1d0: 5265 6d6f 7665 2066 6163 6573 2066 726f  Remove faces fro
+0001a1e0: 6d20 7468 6520 7375 7266 6163 6520 6261  m the surface ba
+0001a1f0: 7365 6420 6f6e 2061 2064 6972 6563 7469  sed on a directi
+0001a200: 6f6e 2072 656c 6174 6976 6520 746f 2066  on relative to f
+0001a210: 6163 6520 6e6f 726d 616c 732e 0d0a 0d0a  ace normals.....
+0001a220: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+0001a230: 7273 0d0a 2020 2020 2020 2020 2d2d 2d2d  rs..        ----
+0001a240: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
+0001a250: 6469 7265 6374 696f 6e20 3a20 6172 7261  direction : arra
+0001a260: 792d 6c69 6b65 206f 7220 3344 6178 6973  y-like or 3Daxis
+0001a270: 2c20 6f70 7469 6f6e 616c 2c20 6465 6661  , optional, defa
+0001a280: 756c 743a 2028 3330 2c2d 3630 290d 0a20  ult: (30,-60).. 
+0001a290: 2020 2020 2020 2020 2020 2054 6865 2076             The v
+0001a2a0: 6563 746f 7220 6469 7265 6374 696f 6e20  ector direction 
+0001a2b0: 666f 7220 7669 6577 696e 6720 2865 6c65  for viewing (ele
+0001a2c0: 762c 617a 696d 2920 6f72 2033 4461 7869  v,azim) or 3Daxi
+0001a2d0: 732e 200d 0a0d 0a20 2020 2020 2020 2052  s. ....        R
+0001a2e0: 6574 7572 6e73 0d0a 2020 2020 2020 2020  eturns..        
+0001a2f0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
+0001a300: 2073 656c 6620 3a20 7375 7266 6163 6520   self : surface 
+0001a310: 6f62 6a65 6374 0d0a 0d0a 2020 2020 2020  object....      
+0001a320: 2020 2222 220d 0a0d 0a20 2020 2020 2020    """....       
+0001a330: 2069 6620 6469 7265 6374 696f 6e20 6973   if direction is
+0001a340: 206e 6f74 204e 6f6e 653a 0d0a 2020 2020   not None:..    
+0001a350: 2020 2020 2020 2020 7465 6d70 203d 2064          temp = d
+0001a360: 6972 6563 7469 6f6e 0d0a 2020 2020 2020  irection..      
+0001a370: 2020 2020 2020 7472 7920 3a20 2023 2063        try :  # c
+0001a380: 6865 636b 2069 6620 6469 7265 6374 696f  heck if directio
+0001a390: 6e20 686f 6c64 7320 7468 6520 656c 6576  n holds the elev
+0001a3a0: 2c20 617a 696d 2028 6965 2e20 3344 2061  , azim (ie. 3D a
+0001a3b0: 7869 7329 0d0a 2020 2020 2020 2020 2020  xis)..          
+0001a3c0: 2020 2020 2020 656c 6576 2c61 7a69 6d20        elev,azim 
+0001a3d0: 3d20 7465 6d70 2e65 6c65 762c 2074 656d  = temp.elev, tem
+0001a3e0: 702e 617a 696d 0d0a 2020 2020 2020 2020  p.azim..        
+0001a3f0: 2020 2020 2020 2020 6469 7265 6374 696f          directio
+0001a400: 6e20 3d20 6e70 2e61 7272 6179 2820 656c  n = np.array( el
+0001a410: 6576 5f61 7a69 6d5f 3276 6563 746f 7228  ev_azim_2vector(
+0001a420: 656c 6576 2c61 7a69 6d29 2029 0d0a 2020  elev,azim) )..  
+0001a430: 2020 2020 2020 2020 2020 6578 6365 7074            except
+0001a440: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
+0001a450: 2020 2020 6469 7265 6374 696f 6e20 3d20      direction = 
+0001a460: 7465 6d70 0d0a 2020 2020 2020 2020 2020  temp..          
+0001a470: 2020 2020 2020 6966 206c 656e 2864 6972        if len(dir
+0001a480: 6563 7469 6f6e 2920 213d 2033 203a 0d0a  ection) != 3 :..
+0001a490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a4a0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+0001a4b0: 7272 6f72 2827 436c 6970 2066 726f 6d20  rror('Clip from 
+0001a4c0: 6e6f 726d 616c 7320 6469 7265 6374 696f  normals directio
+0001a4d0: 6e20 6d75 7374 2062 6520 6120 6172 7261  n must be a arra
+0001a4e0: 7920 6f66 206c 656e 6774 6820 332c 206f  y of length 3, o
+0001a4f0: 7220 6120 4d61 7470 6c6f 746c 6962 2041  r a Matplotlib A
+0001a500: 7865 7333 4420 6f62 6a65 6374 2e27 290d  xes3D object.').
+0001a510: 0a20 2020 2020 2020 2065 6c73 6520 3a20  .        else : 
+0001a520: 6469 7265 6374 696f 6e20 3d20 6e70 2e61  direction = np.a
+0001a530: 7272 6179 2820 656c 6576 5f61 7a69 6d5f  rray( elev_azim_
+0001a540: 3276 6563 746f 7228 202a 5f44 4654 5f56  2vector( *_DFT_V
+0001a550: 4945 5720 2920 290d 0a0d 0a20 2020 2020  IEW ) )....     
+0001a560: 2020 2076 6572 7473 203d 2073 656c 662e     verts = self.
+0001a570: 7665 7274 6578 436f 6f72 5b20 7365 6c66  vertexCoor[ self
+0001a580: 2e66 7649 6e64 6963 6573 205d 0d0a 2020  .fvIndices ]..  
+0001a590: 2020 2020 2020 6661 6365 4e6f 726d 616c        faceNormal
+0001a5a0: 436f 6f72 203d 2073 656c 662e 5f67 6574  Coor = self._get
+0001a5b0: 5f66 6163 655f 6e6f 726d 616c 7328 7665  _face_normals(ve
+0001a5c0: 7274 7329 0d0a 0d0a 2020 2020 2020 2020  rts)....        
+0001a5d0: 7365 6c66 2e5f 706f 7374 5072 6f63 5f73  self._postProc_s
+0001a5e0: 7572 6661 6365 436f 6c6f 7273 2829 0d0a  urfaceColors()..
+0001a5f0: 2020 2020 2020 2020 6f72 6967 5f63 6f6c          orig_col
+0001a600: 6f72 7320 3d20 7365 6c66 2e5f 6466 6163  ors = self._dfac
+0001a610: 6563 6f6c 6f72 7320 2023 2075 7064 6174  ecolors  # updat
+0001a620: 6520 666f 7220 765f 312e 322e 300d 0a0d  e for v_1.2.0...
+0001a630: 0a20 2020 2020 2020 2073 686f 756c 644b  .        shouldK
+0001a640: 6565 7020 3d20 6e70 2e64 6f74 2866 6163  eep = np.dot(fac
+0001a650: 654e 6f72 6d61 6c43 6f6f 722c 6469 7265  eNormalCoor,dire
+0001a660: 6374 696f 6e29 203e 2030 2e30 0d0a 0d0a  ction) > 0.0....
+0001a670: 2020 2020 2020 2020 6966 206e 702e 616e          if np.an
+0001a680: 7928 7368 6f75 6c64 4b65 6570 2920 6973  y(shouldKeep) is
+0001a690: 204e 6f6e 6520 3a0d 0a20 2020 2020 2020   None :..       
+0001a6a0: 2020 2020 2077 6172 6e69 6e67 732e 7761       warnings.wa
+0001a6b0: 726e 2827 5741 524e 494e 473a 204e 6f72  rn('WARNING: Nor
+0001a6c0: 6d61 6c20 636c 6970 7069 6e67 2072 6573  mal clipping res
+0001a6d0: 756c 7465 6420 696e 206e 6f20 6661 6365  ulted in no face
+0001a6e0: 7320 666f 756e 642c 2073 7572 6661 6365  s found, surface
+0001a6f0: 2072 6574 7572 6e20 756e 636c 6970 7065   return unclippe
+0001a700: 642e 2729 0d0a 2020 2020 2020 2020 2020  d.')..          
+0001a710: 2020 7265 7475 726e 2073 656c 660d 0a20    return self.. 
+0001a720: 2020 2020 2020 2066 7669 203d 2073 656c         fvi = sel
+0001a730: 662e 6676 496e 6469 6365 735b 7368 6f75  f.fvIndices[shou
+0001a740: 6c64 4b65 6570 5d0d 0a20 2020 2020 2020  ldKeep]..       
+0001a750: 2066 636f 6c20 3d20 6f72 6967 5f63 6f6c   fcol = orig_col
+0001a760: 6f72 735b 7368 6f75 6c64 4b65 6570 5d0d  ors[shouldKeep].
+0001a770: 0a0d 0a20 2020 2020 2020 2023 2074 6869  ...        # thi
+0001a780: 7320 7065 726d 6974 7320 6d75 6c74 6970  s permits multip
+0001a790: 6c65 2063 6c69 7073 2077 6974 686f 7574  le clips without
+0001a7a0: 2063 6861 6e67 696e 6720 6f72 6967 696e   changing origin
+0001a7b0: 616c 2c20 736f 2072 6573 746f 7265 2069  al, so restore i
+0001a7c0: 7320 6176 6169 6c61 626c 652e 0d0a 2020  s available...  
+0001a7d0: 2020 2020 2020 6966 2073 656c 662e 7265        if self.re
+0001a7e0: 7374 6f72 6564 436c 6970 2069 7320 4e6f  storedClip is No
+0001a7f0: 6e65 203a 0d0a 2020 2020 2020 2020 2020  ne :..          
+0001a800: 2020 7365 6c66 2e72 6573 746f 7265 6443    self.restoredC
+0001a810: 6c69 7020 3d20 7b20 2766 6163 6573 2720  lip = { 'faces' 
+0001a820: 3a20 7365 6c66 2e66 7649 6e64 6963 6573  : self.fvIndices
+0001a830: 2c20 2763 6f6c 6f72 7327 203a 206f 7269  , 'colors' : ori
+0001a840: 675f 636f 6c6f 7273 207d 0d0a 0d0a 2020  g_colors }....  
+0001a850: 2020 2020 2020 6676 6920 3d20 6e70 2e61        fvi = np.a
+0001a860: 7272 6179 2866 7669 290d 0a20 2020 2020  rray(fvi)..     
+0001a870: 2020 2073 656c 662e 6676 496e 6469 6365     self.fvIndice
+0001a880: 7320 3d20 6676 690d 0a20 2020 2020 2020  s = fvi..       
+0001a890: 2073 656c 662e 7365 745f 636f 6c6f 7228   self.set_color(
+0001a8a0: 6663 6f6c 2920 2020 2020 2020 200d 0a20  fcol)        .. 
+0001a8b0: 2020 2020 2020 2076 203d 2073 656c 662e         v = self.
+0001a8c0: 7665 7274 6578 436f 6f72 0d0a 2020 2020  vertexCoor..    
+0001a8d0: 2020 2020 7666 7669 203d 2076 5b66 7669      vfvi = v[fvi
+0001a8e0: 5d0d 0a20 2020 2020 2020 2073 656c 662e  ]..        self.
+0001a8f0: 7365 745f 7665 7274 7328 2076 6676 6920  set_verts( vfvi 
+0001a900: 290d 0a0d 0a20 2020 2020 2020 2063 6c69  )....        cli
+0001a910: 7056 6572 7473 2020 3d20 6e70 2e72 6573  pVerts  = np.res
+0001a920: 6861 7065 2876 6676 692c 282d 312c 3329  hape(vfvi,(-1,3)
+0001a930: 290d 0a20 2020 2020 2020 205f 7365 745f  )..        _set_
+0001a940: 6765 6f6d 426f 756e 6473 2820 636c 6970  geomBounds( clip
+0001a950: 5665 7274 732c 7365 6c66 2e62 6f75 6e64  Verts,self.bound
+0001a960: 7320 290d 0a20 2020 2020 2020 2073 656c  s )..        sel
+0001a970: 662e 5f73 6574 5f69 6e64 6578 5f72 656c  f._set_index_rel
+0001a980: 6174 696f 6e73 2829 0d0a 2020 2020 2020  ations()..      
+0001a990: 2020 7265 7475 726e 2073 656c 660d 0a0d    return self...
+0001a9a0: 0a20 2020 2064 6566 205f 7265 7374 6f72  .    def _restor
+0001a9b0: 655f 6672 6f6d 5f63 6c69 7028 7365 6c66  e_from_clip(self
+0001a9c0: 2920 3a0d 0a20 2020 2020 2020 2022 2222  ) :..        """
+0001a9d0: 0d0a 2020 2020 2020 2020 5265 7365 7420  ..        Reset 
+0001a9e0: 6661 6365 2061 6e64 2063 6f6c 6f72 7320  face and colors 
+0001a9f0: 7072 696f 7220 746f 2061 6e79 2063 6c69  prior to any cli
+0001aa00: 7020 6f70 6572 6174 696f 6e2e 0d0a 2020  p operation...  
+0001aa10: 2020 2020 2020 2869 6e20 6465 7665 6c6f        (in develo
+0001aa20: 706d 656e 7429 0d0a 2020 2020 2020 2020  pment)..        
+0001aa30: 2222 220d 0a20 2020 2020 2020 200d 0a20  """..        .. 
+0001aa40: 2020 2020 2020 2023 2046 7574 4465 763a         # FutDev:
+0001aa50: 2074 6869 7320 6d65 7468 6f64 206e 6565   this method nee
+0001aa60: 6473 2074 686f 726f 7567 6820 7465 7374  ds thorough test
+0001aa70: 696e 672e 0d0a 2020 2020 2020 2020 2320  ing...        # 
+0001aa80: 7072 6f62 6162 6c79 2064 6f65 736e 2774  probably doesn't
+0001aa90: 2077 6f72 6b20 6173 2069 732e 0d0a 2020   work as is...  
+0001aaa0: 2020 2020 2020 6966 2073 656c 662e 7265        if self.re
+0001aab0: 7374 6f72 6564 436c 6970 2069 7320 4e6f  storedClip is No
+0001aac0: 6e65 203a 0d0a 2020 2020 2020 2020 2020  ne :..          
+0001aad0: 2020 7761 726e 696e 6773 2e77 6172 6e28    warnings.warn(
+0001aae0: 2754 6865 7265 2069 7320 6e6f 2063 6c69  'There is no cli
+0001aaf0: 7070 6564 2073 7572 6661 6365 2074 6f20  pped surface to 
+0001ab00: 7265 7374 6f72 652e 2729 0d0a 2020 2020  restore.')..    
+0001ab10: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0001ab20: 656c 660d 0a20 2020 2020 2020 2066 7669  elf..        fvi
+0001ab30: 203d 2073 656c 662e 7265 7374 6f72 6564   = self.restored
+0001ab40: 436c 6970 5b27 6661 6365 7327 5d0d 0a20  Clip['faces'].. 
+0001ab50: 2020 2020 2020 2066 636f 6c20 3d20 7365         fcol = se
+0001ab60: 6c66 2e72 6573 746f 7265 6443 6c69 705b  lf.restoredClip[
+0001ab70: 2763 6f6c 6f72 7327 5d0d 0a20 2020 2020  'colors']..     
+0001ab80: 2020 2073 656c 662e 7265 7374 6f72 6564     self.restored
+0001ab90: 436c 6970 203d 204e 6f6e 650d 0a20 2020  Clip = None..   
+0001aba0: 2020 2020 2073 656c 662e 6676 496e 6469       self.fvIndi
+0001abb0: 6365 7320 3d20 6676 690d 0a20 2020 2020  ces = fvi..     
+0001abc0: 2020 2073 656c 662e 7365 745f 636f 6c6f     self.set_colo
+0001abd0: 7228 6663 6f6c 2920 2020 2020 2020 200d  r(fcol)        .
+0001abe0: 0a20 2020 2020 2020 2076 203d 2073 656c  .        v = sel
+0001abf0: 662e 7665 7274 6578 436f 6f72 0d0a 2020  f.vertexCoor..  
+0001ac00: 2020 2020 2020 7365 6c66 2e73 6574 5f76        self.set_v
+0001ac10: 6572 7473 2876 5b20 6e70 2e61 7272 6179  erts(v[ np.array
+0001ac20: 2866 7669 2920 5d29 0d0a 2020 2020 2020  (fvi) ])..      
+0001ac30: 2020 7365 6c66 2e5f 7365 745f 6765 6f6d    self._set_geom
+0001ac40: 6574 7269 635f 626f 756e 6473 2829 2023  etric_bounds() #
+0001ac50: 2072 6573 6574 2074 6f20 6f72 6967 696e   reset to origin
+0001ac60: 616c 2062 6f75 6e64 732e 2e2e 0d0a 2020  al bounds.....  
+0001ac70: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0001ac80: 660d 0a0d 0a20 2020 2064 6566 2073 6574  f....    def set
+0001ac90: 5f73 7572 6661 6365 5f61 6c70 6861 2873  _surface_alpha(s
+0001aca0: 656c 662c 2061 6c70 6861 2c20 636f 6e73  elf, alpha, cons
+0001acb0: 7461 6e74 3d46 616c 7365 2c20 6164 6a75  tant=False, adju
+0001acc0: 7374 6c77 3d54 7275 6529 203a 0d0a 2020  stlw=True) :..  
+0001acd0: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
+0001ace0: 2020 2041 646a 7573 7420 7468 6520 6661     Adjust the fa
+0001acf0: 6365 2063 6f6c 6f72 2061 6c70 6861 2076  ce color alpha v
+0001ad00: 616c 7565 7320 616e 6420 6c69 6e65 7769  alues and linewi
+0001ad10: 6474 6820 6f66 2074 6865 2073 7572 6661  dth of the surfa
+0001ad20: 6365 2e0d 0a0d 0a20 2020 2020 2020 2050  ce.....        P
+0001ad30: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
+0001ad40: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
+0001ad50: 2020 2020 2020 2061 6c70 6861 203a 2073         alpha : s
+0001ad60: 6361 6c61 720d 0a20 2020 2020 2020 2020  calar..         
+0001ad70: 2020 2020 2041 6c70 6861 2069 7320 696e       Alpha is in
+0001ad80: 2074 6865 2072 616e 6765 2030 2074 6f20   the range 0 to 
+0001ad90: 312e 0d0a 0d0a 2020 2020 2020 2020 636f  1.....        co
+0001ada0: 6e73 7461 6e74 203a 2062 6f6f 6c20 7b20  nstant : bool { 
+0001adb0: 5472 7565 2c20 4661 6c73 6520 7d2c 206f  True, False }, o
+0001adc0: 7074 696f 6e61 6c2c 2046 616c 7365 0d0a  ptional, False..
+0001add0: 2020 2020 2020 2020 2020 2020 4966 2046              If F
+0001ade0: 616c 7365 2c20 6661 6365 2063 6f6c 6f72  alse, face color
+0001adf0: 2076 616c 7565 7320 6172 6520 6d75 6c74   values are mult
+0001ae00: 6970 6c69 6564 2062 790d 0a20 2020 2020  iplied by..     
+0001ae10: 2020 2020 2020 2061 6c70 6861 2e20 2049         alpha.  I
+0001ae20: 6620 5472 7565 2c20 616c 6c20 6661 6365  f True, all face
+0001ae30: 2063 6f6c 6f72 7320 616c 7068 6120 6368   colors alpha ch
+0001ae40: 616e 6e65 6c73 0d0a 2020 2020 2020 2020  annels..        
+0001ae50: 2020 2020 6172 6520 6173 7369 676e 6564      are assigned
+0001ae60: 2074 6f20 616c 7068 612e 0d0a 0d0a 2020   to alpha.....  
+0001ae70: 2020 2020 2020 6164 6a75 7374 6c77 203a        adjustlw :
+0001ae80: 2062 6f6f 6c20 7b20 5472 7565 2c20 4661   bool { True, Fa
+0001ae90: 6c73 6520 7d2c 206f 7074 696f 6e61 6c2c  lse }, optional,
+0001aea0: 2054 7275 650d 0a20 2020 2020 2020 2020   True..         
+0001aeb0: 2020 2049 6620 5472 7565 2c20 7468 6520     If True, the 
+0001aec0: 7375 7266 6163 6520 6c69 6e65 7769 6474  surface linewidt
+0001aed0: 6820 7769 6c6c 2062 6520 7365 740d 0a20  h will be set.. 
+0001aee0: 2020 2020 2020 2020 2020 2074 6f20 6d61             to ma
+0001aef0: 6b65 2074 6865 2065 6467 6573 2076 6973  ke the edges vis
+0001af00: 7561 6c6c 7920 7472 616e 7370 6172 656e  ually transparen
+0001af10: 7420 7769 7468 0d0a 2020 2020 2020 2020  t with..        
+0001af20: 2020 2020 7468 6520 6661 6365 7320 666f      the faces fo
+0001af30: 7220 4d61 7470 6c6f 746c 6962 2072 656e  r Matplotlib ren
+0001af40: 6465 7269 6e67 2e0d 0a20 2020 2020 2020  dering...       
+0001af50: 2020 2020 200d 0a20 2020 2020 2020 2052       ..        R
+0001af60: 6574 7572 6e73 0d0a 2020 2020 2020 2020  eturns..        
+0001af70: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
+0001af80: 2073 656c 6620 3a20 7375 7266 6163 6520   self : surface 
+0001af90: 6f62 6a65 6374 0d0a 0d0a 2020 2020 2020  object....      
+0001afa0: 2020 2222 220d 0a0d 0a20 2020 2020 2020    """....       
+0001afb0: 2069 6620 2861 6c70 6861 3c30 2e30 2920   if (alpha<0.0) 
+0001afc0: 6f72 2028 616c 7068 613e 312e 3029 203a  or (alpha>1.0) :
+0001afd0: 0d0a 2020 2020 2020 2020 2020 2020 7261  ..            ra
+0001afe0: 6973 6520 5661 6c75 6545 7272 6f72 2827  ise ValueError('
+0001aff0: 7375 7266 6163 6520 616c 7068 6120 6d75  surface alpha mu
+0001b000: 7374 2062 6520 6265 7477 6565 6e20 3020  st be between 0 
+0001b010: 616e 6420 312c 2066 6f75 6e64 207b 7d27  and 1, found {}'
+0001b020: 2e66 6f72 6d61 7428 616c 7068 6129 290d  .format(alpha)).
+0001b030: 0a0d 0a20 2020 2020 2020 2073 656c 662e  ...        self.
+0001b040: 5f70 6f73 7450 726f 635f 7375 7266 6163  _postProc_surfac
+0001b050: 6543 6f6c 6f72 7328 290d 0a20 2020 2020  eColors()..     
+0001b060: 2020 206f 7269 675f 636f 6c6f 7273 203d     orig_colors =
+0001b070: 2073 656c 662e 5f64 6661 6365 636f 6c6f   self._dfacecolo
+0001b080: 7273 2020 2320 7570 6461 7465 2066 6f72  rs  # update for
+0001b090: 2076 5f31 2e32 2e30 0d0a 2020 2020 2020   v_1.2.0..      
+0001b0a0: 2020 6966 2063 6f6e 7374 616e 7420 3a0d    if constant :.
+0001b0b0: 0a20 2020 2020 2020 2020 2020 206e 702e  .            np.
+0001b0c0: 7075 745f 616c 6f6e 675f 6178 6973 286f  put_along_axis(o
+0001b0d0: 7269 675f 636f 6c6f 7273 2c20 6e70 2e61  rig_colors, np.a
+0001b0e0: 7272 6179 285b 5b33 5d5d 292c 2061 6c70  rray([[3]]), alp
+0001b0f0: 6861 2c20 6178 6973 3d31 290d 0a20 2020  ha, axis=1)..   
+0001b100: 2020 2020 2020 2020 2063 6f6c 6f72 4d61           colorMa
+0001b110: 7020 3d20 6f72 6967 5f63 6f6c 6f72 730d  p = orig_colors.
+0001b120: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
+0001b130: 2020 2020 2020 2020 2020 2020 636f 6c6f              colo
+0001b140: 724d 6170 203d 206e 702e 6d75 6c74 6970  rMap = np.multip
+0001b150: 6c79 286f 7269 675f 636f 6c6f 7273 2c6e  ly(orig_colors,n
+0001b160: 702e 6172 7261 7928 5b31 2e30 2c31 2e30  p.array([1.0,1.0
+0001b170: 2c31 2e30 2c61 6c70 6861 5d29 290d 0a20  ,1.0,alpha])).. 
+0001b180: 2020 2020 2020 2073 656c 662e 7365 745f         self.set_
+0001b190: 636f 6c6f 7228 636f 6c6f 724d 6170 2920  color(colorMap) 
+0001b1a0: 2020 2020 200d 0a20 2020 2020 2020 2069       ..        i
+0001b1b0: 6620 6164 6a75 7374 6c77 203a 200d 0a20  f adjustlw : .. 
+0001b1c0: 2020 2020 2020 2020 2020 2023 2068 6575             # heu
+0001b1d0: 7269 7374 6963 2061 7070 726f 6163 6820  ristic approach 
+0001b1e0: 746f 2068 6964 696e 6720 6661 6365 2065  to hiding face e
+0001b1f0: 6467 6573 2e20 2042 414e 4441 4944 0d0a  dges.  BANDAID..
+0001b200: 2020 2020 2020 2020 2020 2020 6c77 203d              lw =
+0001b210: 2020 302e 3030 3633 2a6e 702e 6578 7028    0.0063*np.exp(
+0001b220: 342e 322a 616c 7068 6129 0d0a 2020 2020  4.2*alpha)..    
+0001b230: 2020 2020 2020 2020 7365 6c66 2e73 6574          self.set
+0001b240: 5f6c 696e 6577 6964 7468 286c 7729 0d0a  _linewidth(lw)..
+0001b250: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0001b260: 656c 6620 2020 0d0a 2020 200d 0a20 2020  elf   ..   ..   
+0001b270: 2064 6566 2073 6861 6465 2873 656c 662c   def shade(self,
+0001b280: 2064 6570 7468 3d30 2c20 6469 7265 6374   depth=0, direct
+0001b290: 696f 6e3d 4e6f 6e65 2c20 636f 6e74 7261  ion=None, contra
+0001b2a0: 7374 3d4e 6f6e 652c 2069 7341 6273 3d46  st=None, isAbs=F
+0001b2b0: 616c 7365 2c20 6178 3d4e 6f6e 652c 2072  alse, ax=None, r
+0001b2c0: 7669 6577 3d46 616c 7365 2920 3a0d 0a20  view=False) :.. 
+0001b2d0: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
+0001b2e0: 2020 2020 5265 6475 6365 2073 7572 6661      Reduce surfa
+0001b2f0: 6365 2048 5356 2063 6f6c 6f72 2056 616c  ce HSV color Val
+0001b300: 7565 2062 6173 6564 206f 6e20 6661 6365  ue based on face
+0001b310: 206e 6f72 6d61 6c73 2e0d 0a20 2020 2020   normals...     
+0001b320: 2020 200d 0a20 2020 2020 2020 2054 6865     ..        The
+0001b330: 2064 6f74 2070 726f 6475 6374 206f 6620   dot product of 
+0001b340: 6661 6365 206e 6f72 6d61 6c73 2077 6974  face normals wit
+0001b350: 6820 7468 6520 696c 6c75 6d69 6e61 7469  h the illuminati
+0001b360: 6f6e 2064 6972 6563 7469 6f6e 200d 0a20  on direction .. 
+0001b370: 2020 2020 2020 2069 7320 7573 6564 2074         is used t
+0001b380: 6f20 6164 6a75 7374 2066 6163 6520 4853  o adjust face HS
+0001b390: 5620 636f 6c6f 7220 7661 6c75 652e 0d0a  V color value...
+0001b3a0: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
+0001b3b0: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
+0001b3c0: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
+0001b3d0: 2020 6465 7074 6820 3a20 7363 616c 6172    depth : scalar
+0001b3e0: 2c20 6f70 7469 6f6e 616c 2c20 6465 6661  , optional, defa
+0001b3f0: 756c 743a 2030 0d0a 2020 2020 2020 2020  ult: 0..        
+0001b400: 2020 2020 4d69 6e69 6d75 6d20 636f 6c6f      Minimum colo
+0001b410: 7220 7661 6c75 6520 6f66 2073 6861 6465  r value of shade
+0001b420: 6420 7375 7266 6163 6520 6661 6365 732e  d surface faces.
+0001b430: 0d0a 2020 2020 2020 2020 2020 2020 4465  ..            De
+0001b440: 7074 6820 7661 6c75 6520 7261 6e67 6573  pth value ranges
+0001b450: 2066 726f 6d20 3020 746f 2031 2e0d 0a0d   from 0 to 1....
+0001b460: 0a20 2020 2020 2020 2064 6972 6563 7469  .        directi
+0001b470: 6f6e 203a 2061 7272 6179 2d6c 696b 652c  on : array-like,
+0001b480: 206f 7074 696f 6e61 6c2c 2064 6566 6175   optional, defau
+0001b490: 6c74 3a20 2831 2c30 2c31 290d 0a20 2020  lt: (1,0,1)..   
+0001b4a0: 2020 2020 2020 2020 2041 2078 797a 2076           A xyz v
+0001b4b0: 6563 746f 7220 706f 696e 7469 6e67 2074  ector pointing t
+0001b4c0: 6f20 7468 6520 696c 6c75 6d69 6e61 7469  o the illuminati
+0001b4d0: 6f6e 2073 6f75 7263 652e 200d 0a0d 0a20  on source. .... 
+0001b4e0: 2020 2020 2020 2063 6f6e 7472 6173 7420         contrast 
+0001b4f0: 3a20 7363 616c 6172 2c20 6f70 7469 6f6e  : scalar, option
+0001b500: 616c 2c20 6465 6661 756c 743a 2031 0d0a  al, default: 1..
+0001b510: 2020 2020 2020 2020 2020 2020 5368 6164              Shad
+0001b520: 696e 6720 636f 6e74 7261 7374 2061 646a  ing contrast adj
+0001b530: 7573 746d 656e 7420 6672 6f6d 206c 6f77  ustment from low
+0001b540: 2074 6f20 6869 6768 2077 6974 6820 6120   to high with a 
+0001b550: 7661 6c75 650d 0a20 2020 2020 2020 2020  value..         
+0001b560: 2020 206f 6620 3120 666f 7220 6c69 6e65     of 1 for line
+0001b570: 6172 2076 6172 6961 7469 6f6e 7320 7769  ar variations wi
+0001b580: 7468 2074 6865 206e 6f72 6d61 6c20 6469  th the normal di
+0001b590: 7265 6374 696f 6e2e 0d0a 2020 2020 2020  rection...      
+0001b5a0: 2020 2020 2020 436f 6e74 7261 7374 2076        Contrast v
+0001b5b0: 616c 7565 2072 616e 6765 7320 6672 6f6d  alue ranges from
+0001b5c0: 2030 2e31 2074 6f20 332e 2020 2020 200d   0.1 to 3.     .
+0001b5d0: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+0001b5e0: 2020 2069 7341 6273 203a 2062 6f6f 6c2c     isAbs : bool,
+0001b5f0: 206f 7074 696f 6e61 6c2c 2064 6566 6175   optional, defau
+0001b600: 6c74 3a20 4661 6c73 650d 0a20 2020 2020  lt: False..     
+0001b610: 2020 2020 2020 2049 6620 5472 7565 2c20         If True, 
+0001b620: 7468 6520 6162 736f 6c75 7465 2076 616c  the absolute val
+0001b630: 7565 206f 6620 7468 6520 646f 7420 7072  ue of the dot pr
+0001b640: 6f64 7563 7420 6973 0d0a 2020 2020 2020  oduct is..      
+0001b650: 2020 2020 2020 6973 2075 7365 6420 746f        is used to
+0001b660: 2064 6574 6572 6d69 6e65 2063 6f6c 6f72   determine color
+0001b670: 2076 616c 7565 2e0d 0a0d 0a20 2020 2020   value.....     
+0001b680: 2020 2061 7820 3a20 4d61 7470 6c6f 746c     ax : Matplotl
+0001b690: 6962 2033 4420 6178 6573 2e0d 0a0d 0a20  ib 3D axes..... 
+0001b6a0: 2020 2020 2020 2072 7669 6577 203a 2062         rview : b
+0001b6b0: 6f6f 6c65 616e 2c20 6465 6661 756c 743a  oolean, default:
+0001b6c0: 2046 616c 7365 0d0a 2020 2020 2020 2020   False..        
+0001b6d0: 2020 2020 4966 2054 7275 652c 2064 6972      If True, dir
+0001b6e0: 6563 7469 6f6e 2069 7320 7265 6c61 7469  ection is relati
+0001b6f0: 7665 2074 6f20 7468 6520 7669 6577 2c0d  ve to the view,.
+0001b700: 0a20 2020 2020 2020 2020 2020 2020 6f74  .             ot
+0001b710: 6865 7277 6973 652c 2072 656c 6174 6976  herwise, relativ
+0001b720: 6520 746f 2074 6865 2061 7865 732e 0d0a  e to the axes...
+0001b730: 0d0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+0001b740: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+0001b750: 2d2d 0d0a 2020 2020 2020 2020 7365 6c66  --..        self
+0001b760: 203a 2073 7572 6661 6365 206f 626a 6563   : surface objec
+0001b770: 740d 0a0d 0a20 2020 2020 2020 2022 2222  t....        """
+0001b780: 0d0a 0d0a 2020 2020 2020 2020 6966 2064  ....        if d
+0001b790: 6972 6563 7469 6f6e 2069 7320 4e6f 6e65  irection is None
+0001b7a0: 203a 2064 6972 6563 7469 6f6e 203d 205f   : direction = _
+0001b7b0: 494c 4c55 4d0d 0a20 2020 2020 2020 2076  ILLUM..        v
+0001b7c0: 6965 7764 6972 2c61 7573 6620 3d20 4e6f  iewdir,ausf = No
+0001b7d0: 6e65 2c4e 6f6e 650d 0a20 2020 2020 2020  ne,None..       
+0001b7e0: 2069 6620 6178 2069 7320 6e6f 7420 4e6f   if ax is not No
+0001b7f0: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
+0001b800: 2061 7573 6620 3d20 5f61 7869 7355 5346   ausf = _axisUSF
+0001b810: 2861 7829 0d0a 2020 2020 2020 2020 2020  (ax)..          
+0001b820: 2020 7669 6577 6469 7220 3d20 656c 6576    viewdir = elev
+0001b830: 5f61 7a69 6d5f 3276 6563 746f 7228 6178  _azim_2vector(ax
+0001b840: 2e65 6c65 762c 6178 2e61 7a69 6d29 0d0a  .elev,ax.azim)..
+0001b850: 2020 2020 2020 2020 2020 2020 6966 2072              if r
+0001b860: 7669 6577 203a 2064 6972 6563 7469 6f6e  view : direction
+0001b870: 203d 2072 7476 2864 6972 6563 7469 6f6e   = rtv(direction
+0001b880: 2c61 782e 656c 6576 2c61 782e 617a 696d  ,ax.elev,ax.azim
+0001b890: 290d 0a0d 0a20 2020 2020 2020 2069 6620  )....        if 
+0001b8a0: 6e70 2e61 6e79 2820 2864 6570 7468 3c30  np.any( (depth<0
+0001b8b0: 2920 7c20 2864 6570 7468 3e31 2920 2920  ) | (depth>1) ) 
+0001b8c0: 3a0d 0a20 2020 2020 2020 2020 2020 2072  :..            r
+0001b8d0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+0001b8e0: 2764 6570 7468 2076 616c 7565 732c 207b  'depth values, {
+0001b8f0: 7d2c 206d 7573 7420 6265 2062 6574 7765  }, must be betwe
+0001b900: 656e 2030 2061 6e64 2031 272e 666f 726d  en 0 and 1'.form
+0001b910: 6174 2864 6570 7468 2929 0d0a 2020 2020  at(depth))..    
+0001b920: 2020 2020 6966 2063 6f6e 7472 6173 7420      if contrast 
+0001b930: 6973 206e 6f74 204e 6f6e 653a 0d0a 2020  is not None:..  
+0001b940: 2020 2020 2020 2020 2020 6966 2028 636f            if (co
+0001b950: 6e74 7261 7374 3c30 2e31 206f 7220 636f  ntrast<0.1 or co
+0001b960: 6e74 7261 7374 3e33 2920 3a0d 0a20 2020  ntrast>3) :..   
+0001b970: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+0001b980: 7365 2056 616c 7565 4572 726f 7228 2763  se ValueError('c
+0001b990: 6f6e 7472 6173 7420 6d75 7374 2062 6520  ontrast must be 
+0001b9a0: 6265 7477 6565 6e20 302e 3120 616e 6420  between 0.1 and 
+0001b9b0: 332e 202c 2066 6f75 6e64 207b 7d27 2e66  3. , found {}'.f
+0001b9c0: 6f72 6d61 7428 636f 6e74 7261 7374 2929  ormat(contrast))
+0001b9d0: 0d0a 2020 2020 0d0a 2020 2020 2020 2020  ..    ..        
+0001b9e0: 7665 7274 7320 3d20 7365 6c66 2e76 6572  verts = self.ver
+0001b9f0: 7465 7843 6f6f 725b 206e 702e 6172 7261  texCoor[ np.arra
+0001ba00: 7928 7365 6c66 2e66 7649 6e64 6963 6573  y(self.fvIndices
+0001ba10: 2920 5d0d 0a20 2020 2020 2020 206e 6f72  ) ]..        nor
+0001ba20: 6d73 203d 2073 656c 662e 5f67 6574 5f66  ms = self._get_f
+0001ba30: 6163 655f 6e6f 726d 616c 7328 7665 7274  ace_normals(vert
+0001ba40: 732c 6175 7366 290d 0a20 2020 2020 2020  s,ausf)..       
+0001ba50: 2075 6e69 7444 6972 6563 7469 6f6e 203d   unitDirection =
+0001ba60: 206e 702e 6469 7669 6465 2820 6469 7265   np.divide( dire
+0001ba70: 6374 696f 6e2c 206e 702e 6c69 6e61 6c67  ction, np.linalg
+0001ba80: 2e6e 6f72 6d28 6469 7265 6374 696f 6e29  .norm(direction)
+0001ba90: 2029 0d0a 2020 2020 2020 2020 6470 726f   )..        dpro
+0001baa0: 6420 3d20 6e70 2e64 6f74 2820 6e6f 726d  d = np.dot( norm
+0001bab0: 732c 2075 6e69 7444 6972 6563 7469 6f6e  s, unitDirection
+0001bac0: 2029 0d0a 0d0a 2020 2020 2020 2020 6966   )....        if
+0001bad0: 2076 6965 7764 6972 2069 7320 6e6f 7420   viewdir is not 
+0001bae0: 4e6f 6e65 203a 0d0a 2020 2020 2020 2020  None :..        
+0001baf0: 2020 2020 7664 6f74 203d 206e 702e 646f      vdot = np.do
+0001bb00: 7428 6e6f 726d 732c 7669 6577 6469 7229  t(norms,viewdir)
+0001bb10: 0d0a 2020 2020 2020 2020 2020 2020 6470  ..            dp
+0001bb20: 726f 6420 3d20 6e70 2e77 6865 7265 286e  rod = np.where(n
+0001bb30: 702e 6c65 7373 2876 646f 742c 5b30 2e30  p.less(vdot,[0.0
+0001bb40: 5d29 2c2d 6470 726f 642c 6470 726f 6429  ]),-dprod,dprod)
+0001bb50: 0d0a 0d0a 2020 2020 2020 2020 2320 303c  ....        # 0<
+0001bb60: 643c 312c 2068 6575 7269 7374 6963 2066  d<1, heuristic f
+0001bb70: 756e 6374 696f 6e20 666f 7220 0d0a 2020  unction for ..  
+0001bb80: 2020 2020 2020 2320 6e6f 726d 616c 697a        # normaliz
+0001bb90: 6564 2064 6f6d 6169 6e20 6f66 2065 6666  ed domain of eff
+0001bba0: 6563 7469 7665 2064 6f74 2070 726f 6475  ective dot produ
+0001bbb0: 6374 2c20 643d 6628 6470 726f 6429 0d0a  ct, d=f(dprod)..
+0001bbc0: 2020 2020 2020 2020 6966 2069 7341 6273          if isAbs
+0001bbd0: 203a 2064 203d 2031 202d 206e 702e 6162   : d = 1 - np.ab
+0001bbe0: 7328 6470 726f 6429 0d0a 2020 2020 2020  s(dprod)..      
+0001bbf0: 2020 656c 7365 203a 0d0a 2020 2020 2020    else :..      
+0001bc00: 2020 2020 2020 6420 3d20 2820 6470 726f        d = ( dpro
+0001bc10: 6420 2b20 3120 292f 320d 0a20 2020 2020  d + 1 )/2..     
+0001bc20: 2020 2064 203d 206e 702e 6162 7328 6429     d = np.abs(d)
+0001bc30: 2020 2320 746f 2069 6e73 7572 6520 706f    # to insure po
+0001bc40: 7369 7469 7665 2076 616c 7565 7320 6e65  sitive values ne
+0001bc50: 6172 207a 6572 6f0d 0a0d 0a20 2020 2020  ar zero....     
+0001bc60: 2020 2069 6620 636f 6e74 7261 7374 2069     if contrast i
+0001bc70: 7320 6e6f 7420 4e6f 6e65 203a 0d0a 2020  s not None :..  
+0001bc80: 2020 2020 2020 2020 2020 6420 3d20 2030            d =  0
+0001bc90: 2e35 2a28 2031 202b 206e 702e 7369 676e  .5*( 1 + np.sign
+0001bca0: 2864 7072 6f64 292a 6e70 2e70 6f77 6572  (dprod)*np.power
+0001bcb0: 2820 6e70 2e61 6273 2864 7072 6f64 2920  ( np.abs(dprod) 
+0001bcc0: 2c20 312f 636f 6e74 7261 7374 2920 2920  , 1/contrast) ) 
+0001bcd0: 2020 2020 200d 0a20 2020 2020 2020 200d       ..        .
+0001bce0: 0a20 2020 2020 2020 2023 2065 7874 7261  .        # extra
+0001bcf0: 6374 2048 5356 2c20 6c65 6176 696e 6720  ct HSV, leaving 
+0001bd00: 616c 7068 6120 756e 6368 616e 6765 642e  alpha unchanged.
+0001bd10: 0d0a 2020 2020 2020 2020 7365 6c66 2e5f  ..        self._
+0001bd20: 706f 7374 5072 6f63 5f73 7572 6661 6365  postProc_surface
+0001bd30: 436f 6c6f 7273 2829 0d0a 2020 2020 2020  Colors()..      
+0001bd40: 2020 6f72 6967 5f63 6f6c 6f72 7320 3d20    orig_colors = 
+0001bd50: 7365 6c66 2e5f 6466 6163 6563 6f6c 6f72  self._dfacecolor
+0001bd60: 7320 2023 2075 7064 6174 6520 666f 7220  s  # update for 
+0001bd70: 765f 312e 322e 300d 0a20 2020 2020 2020  v_1.2.0..       
+0001bd80: 2061 6c70 6861 7320 3d20 6f72 6967 5f63   alphas = orig_c
+0001bd90: 6f6c 6f72 735b 3a2c 333a 345d 0d0a 2020  olors[:,3:4]..  
+0001bda0: 2020 2020 2020 6663 5f6c 6573 735f 616c        fc_less_al
+0001bdb0: 7068 6120 3d20 6f72 6967 5f63 6f6c 6f72  pha = orig_color
+0001bdc0: 735b 3a2c 3a33 5d0d 0a20 2020 2020 2020  s[:,:3]..       
+0001bdd0: 2068 7376 5f76 616c 7320 3d20 636d 2e63   hsv_vals = cm.c
+0001bde0: 6f6c 6f72 732e 7267 625f 746f 5f68 7376  olors.rgb_to_hsv
+0001bdf0: 2866 635f 6c65 7373 5f61 6c70 6861 290d  (fc_less_alpha).
+0001be00: 0a0d 0a20 2020 2020 2020 2023 2061 646a  ...        # adj
+0001be10: 7573 7420 636f 6c6f 7220 7661 6c75 6520  ust color value 
+0001be20: 7769 7468 206d 756c 7469 706c 6965 722e  with multiplier.
+0001be30: 0d0a 2020 2020 2020 2020 6376 6d20 3d20  ..        cvm = 
+0001be40: 2828 312d 6465 7074 6829 2a64 202b 2064  ((1-depth)*d + d
+0001be50: 6570 7468 2a6e 702e 6f6e 6573 286c 656e  epth*np.ones(len
+0001be60: 2864 2929 295b 3a2c 206e 702e 6e65 7761  (d)))[:, np.newa
+0001be70: 7869 735d 0d0a 2020 2020 2020 2020 6873  xis]..        hs
+0001be80: 765f 7661 6c73 5b3a 2c32 5d20 3d20 2863  v_vals[:,2] = (c
+0001be90: 766d 2a68 7376 5f76 616c 735b 3a2c 323a  vm*hsv_vals[:,2:
+0001bea0: 335d 295b 3a2c 305d 0d0a 2020 2020 2020  3])[:,0]..      
+0001beb0: 2020 7267 625f 7661 6c73 203d 2020 636d    rgb_vals =  cm
+0001bec0: 2e63 6f6c 6f72 732e 6873 765f 746f 5f72  .colors.hsv_to_r
+0001bed0: 6762 2868 7376 5f76 616c 7329 0d0a 2020  gb(hsv_vals)..  
+0001bee0: 2020 2020 2020 7368 6164 655f 636f 6c6f        shade_colo
+0001bef0: 7273 203d 206e 702e 636f 6e63 6174 656e  rs = np.concaten
+0001bf00: 6174 6528 2872 6762 5f76 616c 732c 2061  ate((rgb_vals, a
+0001bf10: 6c70 6861 7329 2c20 6178 6973 3d31 290d  lphas), axis=1).
+0001bf20: 0a20 2020 2020 2020 2073 656c 662e 7365  .        self.se
+0001bf30: 745f 636f 6c6f 7228 7368 6164 655f 636f  t_color(shade_co
+0001bf40: 6c6f 7273 2920 2023 204e 4f54 453a 2074  lors)  # NOTE: t
+0001bf50: 6869 7320 7769 6c6c 2061 6c73 6f20 7365  his will also se
+0001bf60: 7420 6170 7072 6f70 7269 6174 6520 6564  t appropriate ed
+0001bf70: 6765 2063 6f6c 6f72 732e 0d0a 2020 2020  ge colors...    
+0001bf80: 2020 2020 7265 7475 726e 2073 656c 660d      return self.
+0001bf90: 0a0d 0a20 2020 2064 6566 2068 696c 6974  ...    def hilit
+0001bfa0: 6528 7365 6c66 2c20 6865 6967 6874 3d31  e(self, height=1
+0001bfb0: 2c20 6469 7265 6374 696f 6e3d 4e6f 6e65  , direction=None
+0001bfc0: 2c20 666f 6375 733d 4e6f 6e65 2c20 6178  , focus=None, ax
+0001bfd0: 3d4e 6f6e 652c 2072 7669 6577 3d46 616c  =None, rview=Fal
+0001bfe0: 7365 2920 3a0d 0a20 2020 2020 2020 2022  se) :..        "
+0001bff0: 2222 0d0a 2020 2020 2020 2020 496e 6372  ""..        Incr
+0001c000: 6561 7365 2073 7572 6661 6365 2048 5356  ease surface HSV
+0001c010: 2063 6f6c 6f72 2056 616c 7565 2061 6e64   color Value and
+0001c020: 2072 6564 7563 6520 5361 7475 7261 7469   reduce Saturati
+0001c030: 6f6e 2c20 6261 7365 6420 6f6e 2066 6163  on, based on fac
+0001c040: 6520 6e6f 726d 616c 732e 0d0a 0d0a 2020  e normals.....  
+0001c050: 2020 2020 2020 5468 6520 646f 7420 7072        The dot pr
+0001c060: 6f64 7563 7420 6f66 2066 6163 6520 6e6f  oduct of face no
+0001c070: 726d 616c 7320 7769 7468 2074 6865 2069  rmals with the i
+0001c080: 6c6c 756d 696e 6174 696f 6e20 6469 7265  llumination dire
+0001c090: 6374 696f 6e20 0d0a 2020 2020 2020 2020  ction ..        
+0001c0a0: 6973 2075 7365 6420 746f 2061 646a 7573  is used to adjus
+0001c0b0: 7420 6661 6365 2048 5356 2063 6f6c 6f72  t face HSV color
+0001c0c0: 2076 616c 7565 2061 6e64 2073 6174 7572   value and satur
+0001c0d0: 6174 696f 6e2e 0d0a 2020 2020 2020 2020  ation...        
+0001c0e0: 4661 6365 7320 6861 7669 6e67 206e 6f72  Faces having nor
+0001c0f0: 6d61 6c73 2077 6974 6820 6120 6e65 6761  mals with a nega
+0001c100: 7469 7665 2063 6f6d 706f 6e65 6e74 2069  tive component i
+0001c110: 6e20 7468 6520 6469 7265 6374 696f 6e20  n the direction 
+0001c120: 6f66 0d0a 2020 2020 2020 2020 696c 6c75  of..        illu
+0001c130: 6d69 6e61 7469 6f6e 2061 7265 206e 6f74  mination are not
+0001c140: 2061 6666 6563 7465 642e 2054 6865 2072   affected. The r
+0001c150: 6564 7563 7469 6f6e 206f 6620 636f 6c6f  eduction of colo
+0001c160: 7220 7361 7475 7261 7469 6f6e 2069 730d  r saturation is.
+0001c170: 0a20 2020 2020 2020 2070 726f 706f 7274  .        proport
+0001c180: 696f 6e61 6c20 746f 2074 6865 2069 6e63  ional to the inc
+0001c190: 7265 6173 6520 696e 2063 6f6c 6f72 2076  rease in color v
+0001c1a0: 616c 7565 2e0d 0a0d 0a20 2020 2020 2020  alue.....       
+0001c1b0: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
+0001c1c0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
+0001c1d0: 0a20 2020 2020 2020 2068 6569 6768 7420  .        height 
+0001c1e0: 3a20 7363 616c 6172 2c20 6f70 7469 6f6e  : scalar, option
+0001c1f0: 616c 2c20 6465 6661 756c 743a 2031 0d0a  al, default: 1..
+0001c200: 2020 2020 2020 2020 2020 2020 4d61 7869              Maxi
+0001c210: 6d75 6d20 636f 6c6f 7220 7661 6c75 6520  mum color value 
+0001c220: 6f66 2068 6967 686c 6967 6874 6564 2073  of highlighted s
+0001c230: 7572 6661 6365 2066 6163 6573 2e0d 0a20  urface faces... 
+0001c240: 2020 2020 2020 2020 2020 2048 6569 6768             Heigh
+0001c250: 7420 7661 6c75 6520 7261 6e67 6573 2066  t value ranges f
+0001c260: 726f 6d20 3020 746f 2031 2e0d 0a0d 0a20  rom 0 to 1..... 
+0001c270: 2020 2020 2020 2064 6972 6563 7469 6f6e         direction
+0001c280: 203a 2061 7272 6179 2d6c 696b 652c 206f   : array-like, o
+0001c290: 7074 696f 6e61 6c2c 2064 6566 6175 6c74  ptional, default
+0001c2a0: 3a20 2831 2c30 2c31 290d 0a20 2020 2020  : (1,0,1)..     
+0001c2b0: 2020 2020 2020 2041 2078 797a 2076 6563         A xyz vec
+0001c2c0: 746f 7220 706f 696e 7469 6e67 2074 6f20  tor pointing to 
+0001c2d0: 7468 6520 696c 6c75 6d69 6e61 7469 6f6e  the illumination
+0001c2e0: 2073 6f75 7263 652e 200d 0a0d 0a20 2020   source. ....   
+0001c2f0: 2020 2020 2066 6f63 7573 203a 2073 6361       focus : sca
+0001c300: 6c61 722c 206f 7074 696f 6e61 6c2c 2064  lar, optional, d
+0001c310: 6566 6175 6c74 3a20 310d 0a20 2020 2020  efault: 1..     
+0001c320: 2020 2020 2020 2048 6967 686c 6967 6874         Highlight
+0001c330: 696e 6720 666f 6375 7320 6164 6a75 7374  ing focus adjust
+0001c340: 6d65 6e74 2066 726f 6d20 6c6f 7720 746f  ment from low to
+0001c350: 2068 6967 6820 7769 7468 2061 2076 616c   high with a val
+0001c360: 7565 0d0a 2020 2020 2020 2020 2020 2020  ue..            
+0001c370: 6f66 2031 2066 6f72 2071 7561 6472 6174  of 1 for quadrat
+0001c380: 6963 2076 6172 6961 7469 6f6e 7320 7769  ic variations wi
+0001c390: 7468 2074 6865 206e 6f72 6d61 6c20 6469  th the normal di
+0001c3a0: 7265 6374 696f 6e2e 0d0a 2020 2020 2020  rection...      
+0001c3b0: 2020 2020 2020 466f 6375 7320 7661 6c75        Focus valu
+0001c3c0: 6520 7261 6e67 6573 2066 726f 6d20 302e  e ranges from 0.
+0001c3d0: 3120 746f 2033 2e20 2020 2020 0d0a 2020  1 to 3.     ..  
+0001c3e0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+0001c3f0: 6178 203a 204d 6174 706c 6f74 6c69 6220  ax : Matplotlib 
+0001c400: 3344 2061 7865 732e 0d0a 0d0a 2020 2020  3D axes.....    
+0001c410: 2020 2020 7276 6965 7720 3a20 626f 6f6c      rview : bool
+0001c420: 6561 6e2c 2064 6566 6175 6c74 3a20 4661  ean, default: Fa
+0001c430: 6c73 650d 0a20 2020 2020 2020 2020 2020  lse..           
+0001c440: 2049 6620 5472 7565 2c20 6469 7265 6374   If True, direct
+0001c450: 696f 6e20 6973 2072 656c 6174 6976 6520  ion is relative 
+0001c460: 746f 2074 6865 2076 6965 772c 0d0a 2020  to the view,..  
+0001c470: 2020 2020 2020 2020 2020 206f 7468 6572             other
+0001c480: 7769 7365 2c20 7265 6c61 7469 7665 2074  wise, relative t
+0001c490: 6f20 7468 6520 6178 6573 2e0d 0a0d 0a20  o the axes..... 
+0001c4a0: 2020 2020 2020 2052 6574 7572 6e73 0d0a         Returns..
+0001c4b0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0d          -------.
+0001c4c0: 0a20 2020 2020 2020 2073 656c 6620 3a20  .        self : 
+0001c4d0: 7375 7266 6163 6520 6f62 6a65 6374 0d0a  surface object..
+0001c4e0: 0d0a 2020 2020 2020 2020 2222 220d 0a0d  ..        """...
+0001c4f0: 0a20 2020 2020 2020 2069 6620 6469 7265  .        if dire
+0001c500: 6374 696f 6e20 6973 204e 6f6e 6520 3a20  ction is None : 
+0001c510: 6469 7265 6374 696f 6e20 3d20 5f49 4c4c  direction = _ILL
+0001c520: 554d 0d0a 2020 2020 2020 2020 7669 6577  UM..        view
+0001c530: 6469 722c 6175 7366 203d 204e 6f6e 652c  dir,ausf = None,
+0001c540: 4e6f 6e65 0d0a 2020 2020 2020 2020 6966  None..        if
+0001c550: 2061 7820 6973 206e 6f74 204e 6f6e 653a   ax is not None:
+0001c560: 0d0a 2020 2020 2020 2020 2020 2020 6175  ..            au
+0001c570: 7366 203d 205f 6178 6973 5553 4628 6178  sf = _axisUSF(ax
+0001c580: 290d 0a20 2020 2020 2020 2020 2020 2076  )..            v
+0001c590: 6965 7764 6972 203d 2065 6c65 765f 617a  iewdir = elev_az
+0001c5a0: 696d 5f32 7665 6374 6f72 2861 782e 656c  im_2vector(ax.el
+0001c5b0: 6576 2c61 782e 617a 696d 290d 0a20 2020  ev,ax.azim)..   
+0001c5c0: 2020 2020 2020 2020 2069 6620 7276 6965           if rvie
+0001c5d0: 7720 3a20 6469 7265 6374 696f 6e20 3d20  w : direction = 
+0001c5e0: 7274 7628 6469 7265 6374 696f 6e2c 6178  rtv(direction,ax
+0001c5f0: 2e65 6c65 762c 6178 2e61 7a69 6d29 0d0a  .elev,ax.azim)..
+0001c600: 0d0a 2020 2020 2020 2020 6966 206e 702e  ..        if np.
+0001c610: 616e 7928 2028 6865 6967 6874 3c30 2920  any( (height<0) 
+0001c620: 7c20 2868 6569 6768 743e 3129 2029 203a  | (height>1) ) :
+0001c630: 0d0a 2020 2020 2020 2020 2020 2020 7261  ..            ra
+0001c640: 6973 6520 5661 6c75 6545 7272 6f72 2827  ise ValueError('
+0001c650: 6865 6967 6874 2076 616c 7565 732c 207b  height values, {
+0001c660: 7d2c 206d 7573 7420 6265 2062 6574 7765  }, must be betwe
+0001c670: 656e 2030 2061 6e64 2031 272e 666f 726d  en 0 and 1'.form
+0001c680: 6174 2868 6569 6768 7429 290d 0a20 2020  at(height))..   
+0001c690: 2020 2020 2069 6620 666f 6375 7320 6973       if focus is
+0001c6a0: 206e 6f74 204e 6f6e 653a 0d0a 2020 2020   not None:..    
+0001c6b0: 2020 2020 2020 2020 6966 2028 666f 6375          if (focu
+0001c6c0: 733c 302e 3120 6f72 2066 6f63 7573 3e33  s<0.1 or focus>3
+0001c6d0: 2920 3a0d 0a20 2020 2020 2020 2020 2020  ) :..           
+0001c6e0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+0001c6f0: 4572 726f 7228 2766 6f63 7573 206d 7573  Error('focus mus
+0001c700: 7420 6265 2062 6574 7765 656e 2030 2e31  t be between 0.1
+0001c710: 2061 6e64 2033 2e20 2c20 666f 756e 6420   and 3. , found 
+0001c720: 7b7d 272e 666f 726d 6174 2866 6f63 7573  {}'.format(focus
+0001c730: 2929 0d0a 2020 2020 0d0a 2020 2020 2020  ))..    ..      
+0001c740: 2020 7665 7274 7320 3d20 7365 6c66 2e76    verts = self.v
+0001c750: 6572 7465 7843 6f6f 725b 2073 656c 662e  ertexCoor[ self.
+0001c760: 6676 496e 6469 6365 7320 5d0d 0a20 2020  fvIndices ]..   
+0001c770: 2020 2020 206e 6f72 6d73 203d 2073 656c       norms = sel
+0001c780: 662e 5f67 6574 5f66 6163 655f 6e6f 726d  f._get_face_norm
+0001c790: 616c 7328 7665 7274 732c 6175 7366 290d  als(verts,ausf).
+0001c7a0: 0a20 2020 2020 2020 2075 6e69 7444 6972  .        unitDir
+0001c7b0: 6563 7469 6f6e 203d 206e 702e 6469 7669  ection = np.divi
+0001c7c0: 6465 2820 6469 7265 6374 696f 6e2c 206e  de( direction, n
+0001c7d0: 702e 6c69 6e61 6c67 2e6e 6f72 6d28 6469  p.linalg.norm(di
+0001c7e0: 7265 6374 696f 6e29 2029 0d0a 2020 2020  rection) )..    
+0001c7f0: 2020 2020 6470 726f 6420 3d20 6e70 2e64      dprod = np.d
+0001c800: 6f74 2820 6e6f 726d 732c 2075 6e69 7444  ot( norms, unitD
+0001c810: 6972 6563 7469 6f6e 2029 0d0a 0d0a 2020  irection )....  
+0001c820: 2020 2020 2020 6966 2076 6965 7764 6972        if viewdir
+0001c830: 2069 7320 6e6f 7420 4e6f 6e65 203a 0d0a   is not None :..
+0001c840: 2020 2020 2020 2020 2020 2020 7664 6f74              vdot
+0001c850: 203d 206e 702e 646f 7428 6e6f 726d 732c   = np.dot(norms,
+0001c860: 7669 6577 6469 7229 0d0a 2020 2020 2020  viewdir)..      
+0001c870: 2020 2020 2020 6470 726f 6420 3d20 6e70        dprod = np
+0001c880: 2e77 6865 7265 286e 702e 6c65 7373 2876  .where(np.less(v
+0001c890: 646f 742c 5b30 2e30 5d29 2c2d 6470 726f  dot,[0.0]),-dpro
+0001c8a0: 642c 6470 726f 6429 0d0a 0d0a 2020 2020  d,dprod)....    
+0001c8b0: 2020 2020 2320 303c 643c 312c 2068 6575      # 0<d<1, heu
+0001c8c0: 7269 7374 6963 2066 756e 6374 696f 6e20  ristic function 
+0001c8d0: 666f 7220 0d0a 2020 2020 2020 2020 2320  for ..        # 
+0001c8e0: 6e6f 726d 616c 697a 6564 2064 6f6d 6169  normalized domai
+0001c8f0: 6e20 6f66 2065 6666 6563 7469 7665 2064  n of effective d
+0001c900: 6f74 2070 726f 6475 6374 2c20 643d 6628  ot product, d=f(
+0001c910: 6470 726f 6429 0d0a 2020 2020 2020 2020  dprod)..        
+0001c920: 6420 3d20 6e70 2e77 6865 7265 2864 7072  d = np.where(dpr
+0001c930: 6f64 3c30 202c 2030 2c20 6470 726f 6429  od<0 , 0, dprod)
+0001c940: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+0001c950: 2069 6620 666f 6375 7320 6973 204e 6f6e   if focus is Non
+0001c960: 6520 3a20 666f 6375 7320 3d20 310d 0a20  e : focus = 1.. 
+0001c970: 2020 2020 2020 2064 3020 3d20 6e70 2e70         d0 = np.p
+0001c980: 6f77 6572 2866 6f63 7573 2c31 2f32 292f  ower(focus,1/2)/
+0001c990: 322e 300d 0a20 2020 2020 2020 2079 203d  2.0..        y =
+0001c9a0: 2028 642d 6430 292f 2831 2d64 3029 0d0a   (d-d0)/(1-d0)..
+0001c9b0: 2020 2020 2020 2020 6420 3d20 6e70 2e77          d = np.w
+0001c9c0: 6865 7265 2879 3c30 202c 2030 2c20 7929  here(y<0 , 0, y)
+0001c9d0: 0d0a 2020 2020 2020 2020 6420 3d20 6e70  ..        d = np
+0001c9e0: 2e70 6f77 6572 2864 2c31 2e30 2b32 2a66  .power(d,1.0+2*f
+0001c9f0: 6f63 7573 290d 0a0d 0a20 2020 2020 2020  ocus)....       
+0001ca00: 2023 2065 7874 7261 6374 2048 5356 2c20   # extract HSV, 
+0001ca10: 6c65 6176 696e 6720 616c 7068 6120 756e  leaving alpha un
+0001ca20: 6368 616e 6765 642e 0d0a 2020 2020 2020  changed...      
+0001ca30: 2020 7365 6c66 2e5f 706f 7374 5072 6f63    self._postProc
+0001ca40: 5f73 7572 6661 6365 436f 6c6f 7273 2829  _surfaceColors()
+0001ca50: 0d0a 2020 2020 2020 2020 6f72 6967 5f63  ..        orig_c
+0001ca60: 6f6c 6f72 7320 3d20 7365 6c66 2e5f 6466  olors = self._df
+0001ca70: 6163 6563 6f6c 6f72 7320 2023 2075 7064  acecolors  # upd
+0001ca80: 6174 6520 666f 7220 765f 312e 322e 300d  ate for v_1.2.0.
+0001ca90: 0a20 2020 2020 2020 2061 6c70 6861 7320  .        alphas 
+0001caa0: 3d20 6f72 6967 5f63 6f6c 6f72 735b 3a2c  = orig_colors[:,
+0001cab0: 333a 345d 0d0a 2020 2020 2020 2020 6663  3:4]..        fc
+0001cac0: 5f6c 6573 735f 616c 7068 6120 3d20 6f72  _less_alpha = or
+0001cad0: 6967 5f63 6f6c 6f72 735b 3a2c 3a33 5d0d  ig_colors[:,:3].
+0001cae0: 0a20 2020 2020 2020 2068 7376 5f76 616c  .        hsv_val
+0001caf0: 7320 3d20 636d 2e63 6f6c 6f72 732e 7267  s = cm.colors.rg
+0001cb00: 625f 746f 5f68 7376 2866 635f 6c65 7373  b_to_hsv(fc_less
+0001cb10: 5f61 6c70 6861 290d 0a0d 0a20 2020 2020  _alpha)....     
+0001cb20: 2020 2023 2061 646a 7573 7420 636f 6c6f     # adjust colo
+0001cb30: 7220 7361 7475 7261 7469 6f6e 2061 6e64  r saturation and
+0001cb40: 2076 616c 7565 2c20 6c69 6e65 6172 2077   value, linear w
+0001cb50: 6974 6820 6e6f 726d 616c 697a 6564 2064  ith normalized d
+0001cb60: 6f6d 6169 6e2e 0d0a 2020 2020 2020 2020  omain...        
+0001cb70: 6864 203d 2068 6569 6768 742a 640d 0a20  hd = height*d.. 
+0001cb80: 2020 2020 2020 206f 6d68 6420 3d20 286e         omhd = (n
+0001cb90: 702e 6f6e 6573 2820 6c65 6e28 6e6f 726d  p.ones( len(norm
+0001cba0: 7329 2029 202d 2068 6429 0d0a 2020 2020  s) ) - hd)..    
+0001cbb0: 2020 2020 6f6d 6864 203d 206f 6d68 645b      omhd = omhd[
+0001cbc0: 3a2c 6e70 2e6e 6577 6178 6973 5d0d 0a20  :,np.newaxis].. 
+0001cbd0: 2020 2020 2020 2068 7376 5f76 616c 735b         hsv_vals[
+0001cbe0: 3a2c 315d 203d 2028 6f6d 6864 2a68 7376  :,1] = (omhd*hsv
+0001cbf0: 5f76 616c 735b 3a2c 313a 325d 295b 3a2c  _vals[:,1:2])[:,
+0001cc00: 305d 0d0a 2020 2020 2020 2020 6873 765f  0]..        hsv_
+0001cc10: 7661 6c73 5b3a 2c32 5d20 3d20 286f 6d68  vals[:,2] = (omh
+0001cc20: 642a 6873 765f 7661 6c73 5b3a 2c32 3a33  d*hsv_vals[:,2:3
+0001cc30: 5d29 5b3a 2c30 5d0d 0a20 2020 2020 2020  ])[:,0]..       
+0001cc40: 2068 7376 5f76 616c 735b 3a2c 325d 202b   hsv_vals[:,2] +
+0001cc50: 3d20 6864 0d0a 2020 2020 2020 2020 7267  = hd..        rg
+0001cc60: 625f 7661 6c73 203d 2020 636d 2e63 6f6c  b_vals =  cm.col
+0001cc70: 6f72 732e 6873 765f 746f 5f72 6762 2868  ors.hsv_to_rgb(h
+0001cc80: 7376 5f76 616c 7329 0d0a 2020 2020 2020  sv_vals)..      
+0001cc90: 2020 6869 6c69 7465 5f63 6f6c 6f72 7320    hilite_colors 
+0001cca0: 3d20 6e70 2e63 6f6e 6361 7465 6e61 7465  = np.concatenate
+0001ccb0: 2828 7267 625f 7661 6c73 2c20 616c 7068  ((rgb_vals, alph
+0001ccc0: 6173 292c 2061 7869 733d 3129 0d0a 2020  as), axis=1)..  
+0001ccd0: 2020 2020 2020 7365 6c66 2e73 6574 5f63        self.set_c
+0001cce0: 6f6c 6f72 2868 696c 6974 655f 636f 6c6f  olor(hilite_colo
+0001ccf0: 7273 290d 0a20 2020 2020 2020 2072 6574  rs)..        ret
+0001cd00: 7572 6e20 7365 6c66 0d0a 0d0a 2020 2020  urn self....    
+0001cd10: 6465 6620 6661 6465 2873 656c 662c 6465  def fade(self,de
+0001cd20: 7074 683d 302c 656c 6576 3d4e 6f6e 652c  pth=0,elev=None,
+0001cd30: 617a 696d 3d4e 6f6e 652c 6178 3d4e 6f6e  azim=None,ax=Non
+0001cd40: 6529 203a 0d0a 2020 2020 2020 2020 2222  e) :..        ""
+0001cd50: 220d 0a20 2020 2020 2020 2052 6564 7563  "..        Reduc
+0001cd60: 6520 7375 7266 6163 6520 6661 6365 206f  e surface face o
+0001cd70: 7061 6369 7479 2062 6173 6564 206f 6e20  pacity based on 
+0001cd80: 6661 6365 2070 6f73 6974 696f 6e20 7265  face position re
+0001cd90: 6c61 7469 7665 0d0a 2020 2020 2020 2020  lative..        
+0001cda0: 746f 2074 6865 2076 6965 7720 6f72 6965  to the view orie
+0001cdb0: 6e74 6174 696f 6e2e 200d 0a20 2020 2020  ntation. ..     
+0001cdc0: 2020 200d 0a20 2020 2020 2020 2050 6172     ..        Par
+0001cdd0: 616d 6574 6572 730d 0a20 2020 2020 2020  ameters..       
+0001cde0: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
+0001cdf0: 2020 2020 2064 6570 7468 203a 2073 6361       depth : sca
+0001ce00: 6c61 722c 206f 7074 696f 6e61 6c2c 2064  lar, optional, d
+0001ce10: 6566 6175 6c74 3a20 300d 0a20 2020 2020  efault: 0..     
+0001ce20: 2020 2020 2020 204d 696e 696d 756d 206f         Minimum o
+0001ce30: 7061 6369 7479 2074 6f20 3120 666f 7220  pacity to 1 for 
+0001ce40: 6661 6365 206f 7061 6369 7479 2066 726f  face opacity fro
+0001ce50: 6d20 6261 636b 0d0a 2020 2020 2020 2020  m back..        
+0001ce60: 2020 2020 746f 2066 726f 6e74 2066 6163      to front fac
+0001ce70: 6520 6365 6e74 6572 2070 6f73 6974 696f  e center positio
+0001ce80: 6e2e 0d0a 2020 2020 2020 2020 2020 2020  n...            
+0001ce90: 4465 7074 6820 7661 6c75 6520 7261 6e67  Depth value rang
+0001cea0: 6573 2066 726f 6d20 3020 746f 2031 2e0d  es from 0 to 1..
+0001ceb0: 0a0d 0a20 2020 2020 2020 2065 6c65 7620  ...        elev 
+0001cec0: 3a20 7363 616c 6172 2c20 6f70 7469 6f6e  : scalar, option
+0001ced0: 616c 2c20 6465 6661 756c 743a 2033 300d  al, default: 30.
+0001cee0: 0a20 2020 2020 2020 2020 2020 2045 6c65  .            Ele
+0001cef0: 7661 7469 6f6e 206f 6620 7468 6520 6178  vation of the ax
+0001cf00: 6573 2076 6965 772e 0d0a 0d0a 2020 2020  es view.....    
+0001cf10: 2020 2020 617a 696d 203a 2073 6361 6c61      azim : scala
+0001cf20: 722c 206f 7074 696f 6e61 6c2c 2064 6566  r, optional, def
+0001cf30: 6175 6c74 3a20 2d36 300d 0a20 2020 2020  ault: -60..     
+0001cf40: 2020 2020 2020 2041 7a69 6d75 7468 206f         Azimuth o
+0001cf50: 6620 7468 6520 6178 6573 2076 6965 772e  f the axes view.
+0001cf60: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
+0001cf70: 2020 2020 2061 783a 204d 6174 706c 6f74       ax: Matplot
+0001cf80: 6c69 6220 3344 2061 7865 732e 0d0a 2020  lib 3D axes...  
+0001cf90: 2020 2020 2020 2020 2020 4966 206e 6f74            If not
+0001cfa0: 204e 6f6e 652c 2065 6c65 7620 616e 6420   None, elev and 
+0001cfb0: 617a 696d 2061 7265 2074 616b 656e 2066  azim are taken f
+0001cfc0: 726f 6d20 7468 6520 6178 2e0d 0a20 2020  rom the ax...   
+0001cfd0: 2020 2020 200d 0a20 2020 2020 2020 2052       ..        R
+0001cfe0: 6574 7572 6e73 0d0a 2020 2020 2020 2020  eturns..        
+0001cff0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
+0001d000: 2073 656c 6620 3a20 7375 7266 6163 6520   self : surface 
+0001d010: 6f62 6a65 6374 0d0a 0d0a 2020 2020 2020  object....      
+0001d020: 2020 2222 220d 0a0d 0a20 2020 2020 2020    """....       
+0001d030: 2069 6620 6178 2069 7320 4e6f 6e65 203a   if ax is None :
+0001d040: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+0001d050: 2065 6c65 7620 6973 204e 6f6e 653a 2065   elev is None: e
+0001d060: 6c65 7620 3d20 5f44 4654 5f56 4945 575b  lev = _DFT_VIEW[
+0001d070: 305d 0d0a 2020 2020 2020 2020 2020 2020  0]..            
+0001d080: 6966 2061 7a69 6d20 6973 204e 6f6e 653a  if azim is None:
+0001d090: 2061 7a69 6d20 3d20 5f44 4654 5f56 4945   azim = _DFT_VIE
+0001d0a0: 575b 315d 0d0a 2020 2020 2020 2020 656c  W[1]..        el
+0001d0b0: 7365 203a 0d0a 2020 2020 2020 2020 2020  se :..          
+0001d0c0: 2020 656c 6576 203d 2061 782e 656c 6576    elev = ax.elev
+0001d0d0: 0d0a 2020 2020 2020 2020 2020 2020 617a  ..            az
+0001d0e0: 696d 203d 2061 782e 617a 696d 0d0a 2020  im = ax.azim..  
+0001d0f0: 2020 2020 2020 6469 7265 6374 696f 6e20        direction 
+0001d100: 3d20 656c 6576 5f61 7a69 6d5f 3276 6563  = elev_azim_2vec
+0001d110: 746f 7228 656c 6576 2c20 617a 696d 290d  tor(elev, azim).
+0001d120: 0a20 2020 2020 2020 2075 6e69 7444 6972  .        unitDir
+0001d130: 6563 7469 6f6e 203d 206e 702e 6469 7669  ection = np.divi
+0001d140: 6465 2820 6469 7265 6374 696f 6e2c 206e  de( direction, n
+0001d150: 702e 6c69 6e61 6c67 2e6e 6f72 6d28 6469  p.linalg.norm(di
+0001d160: 7265 6374 696f 6e29 2029 0d0a 0d0a 2020  rection) )....  
+0001d170: 2020 2020 2020 6966 206e 702e 616e 7928        if np.any(
+0001d180: 2028 6465 7074 683c 3029 206f 7220 2864   (depth<0) or (d
+0001d190: 6570 7468 3e31 2920 2920 3a0d 0a20 2020  epth>1) ) :..   
+0001d1a0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+0001d1b0: 616c 7565 4572 726f 7228 2764 6570 7468  alueError('depth
+0001d1c0: 2076 616c 7565 732c 207b 7d2c 206d 7573   values, {}, mus
+0001d1d0: 7420 6265 2062 6574 7765 656e 2030 2061  t be between 0 a
+0001d1e0: 6e64 2031 272e 666f 726d 6174 2864 6570  nd 1'.format(dep
+0001d1f0: 7468 2929 0d0a 0d0a 2020 2020 2020 2020  th))....        
+0001d200: 7665 7274 7320 3d20 7365 6c66 2e76 6572  verts = self.ver
+0001d210: 7465 7843 6f6f 725b 206e 702e 6172 7261  texCoor[ np.arra
+0001d220: 7928 7365 6c66 2e66 7649 6e64 6963 6573  y(self.fvIndices
+0001d230: 2920 5d0d 0a20 2020 2020 2020 2066 6163  ) ]..        fac
+0001d240: 6543 656e 7465 7243 6f6f 7220 3d20 7365  eCenterCoor = se
+0001d250: 6c66 2e5f 6765 745f 6661 6365 5f63 656e  lf._get_face_cen
+0001d260: 7465 7273 2876 6572 7473 290d 0a0d 0a20  ters(verts).... 
+0001d270: 2020 2020 2020 2073 656c 662e 5f70 6f73         self._pos
+0001d280: 7450 726f 635f 7375 7266 6163 6543 6f6c  tProc_surfaceCol
+0001d290: 6f72 7328 290d 0a20 2020 2020 2020 2063  ors()..        c
+0001d2a0: 6f6c 6f72 7320 3d20 7365 6c66 2e5f 6466  olors = self._df
+0001d2b0: 6163 6563 6f6c 6f72 7320 2023 2075 7064  acecolors  # upd
+0001d2c0: 6174 6520 666f 7220 765f 312e 322e 300d  ate for v_1.2.0.
+0001d2d0: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
+0001d2e0: 6661 6365 4365 6e74 6572 436f 6f72 2920  faceCenterCoor) 
+0001d2f0: 3d3d 2031 203a 2072 6574 7572 6e20 7365  == 1 : return se
+0001d300: 6c66 2023 2066 6164 6520 6e6f 7420 6176  lf # fade not av
+0001d310: 6169 6c61 626c 6520 666f 7220 7369 6e67  ailable for sing
+0001d320: 6c65 2066 6163 6520 6c69 6e65 200d 0a20  le face line .. 
+0001d330: 2020 2020 2020 2064 7470 726f 6420 3d20         dtprod = 
+0001d340: 6e70 2e64 6f74 2866 6163 6543 656e 7465  np.dot(faceCente
+0001d350: 7243 6f6f 722c 756e 6974 4469 7265 6374  rCoor,unitDirect
+0001d360: 696f 6e29 0d0a 2020 2020 2020 2020 6470  ion)..        dp
+0001d370: 7261 6e67 6520 3d20 6e70 2e61 6d61 7828  range = np.amax(
+0001d380: 6474 7072 6f64 292d 6e70 2e61 6d69 6e28  dtprod)-np.amin(
+0001d390: 6474 7072 6f64 290d 0a20 2020 2020 2020  dtprod)..       
+0001d3a0: 206e 6f72 6d5f 6470 203d 2028 6474 7072   norm_dp = (dtpr
+0001d3b0: 6f64 202d 206e 702e 616d 696e 2864 7470  od - np.amin(dtp
+0001d3c0: 726f 6429 292f 6470 7261 6e67 650d 0a20  rod))/dprange.. 
+0001d3d0: 2020 2020 2020 2066 6164 6578 203d 2028         fadex = (
+0001d3e0: 312d 6465 7074 6829 2a6e 6f72 6d5f 6470  1-depth)*norm_dp
+0001d3f0: 202b 2064 6570 7468 0d0a 0d0a 2020 2020   + depth....    
+0001d400: 2020 2020 6f72 6967 5f63 6f6c 6f72 7320      orig_colors 
+0001d410: 3d20 636f 6c6f 7273 0d0a 2020 2020 2020  = colors..      
+0001d420: 2020 6663 5f6c 6573 735f 616c 7068 6120    fc_less_alpha 
+0001d430: 3d20 6f72 6967 5f63 6f6c 6f72 735b 3a2c  = orig_colors[:,
+0001d440: 3a33 5d0d 0a20 2020 2020 2020 2066 6164  :3]..        fad
+0001d450: 6578 203d 2066 6164 6578 2a6f 7269 675f  ex = fadex*orig_
+0001d460: 636f 6c6f 7273 5b3a 2c33 5d20 2023 2075  colors[:,3]  # u
+0001d470: 7064 6174 6520 666f 7220 765f 312e 322e  pdate for v_1.2.
+0001d480: 300d 0a20 2020 2020 2020 2066 6164 6564  0..        faded
+0001d490: 5f63 6f6c 6f72 7320 3d20 6e70 2e63 6f6e  _colors = np.con
+0001d4a0: 6361 7465 6e61 7465 2828 6663 5f6c 6573  catenate((fc_les
+0001d4b0: 735f 616c 7068 612c 2066 6164 6578 5b3a  s_alpha, fadex[:
+0001d4c0: 2c6e 702e 6e65 7761 7869 735d 2029 2c20  ,np.newaxis] ), 
+0001d4d0: 6178 6973 3d31 290d 0a20 2020 2020 2020  axis=1)..       
+0001d4e0: 2073 656c 662e 7365 745f 636f 6c6f 7228   self.set_color(
+0001d4f0: 6661 6465 645f 636f 6c6f 7273 2920 0d0a  faded_colors) ..
+0001d500: 2020 2020 2020 2020 2320 6865 7572 6973          # heuris
+0001d510: 7469 6320 6170 7072 6f61 6368 2074 6f20  tic approach to 
+0001d520: 6869 6469 6e67 2066 6163 6520 6564 6765  hiding face edge
+0001d530: 732e 2020 4241 4e44 4149 4420 7570 6461  s.  BANDAID upda
+0001d540: 7465 2066 6f72 2076 5f31 2e32 2e30 0d0a  te for v_1.2.0..
+0001d550: 2020 2020 2020 2020 616c 7068 6120 3d20          alpha = 
+0001d560: 2864 6570 7468 2b31 292f 3220 2023 2074  (depth+1)/2  # t
+0001d570: 616b 6520 7468 6520 6d69 6470 6f69 6e74  ake the midpoint
+0001d580: 206f 6620 7468 6520 6772 6164 6965 6e74   of the gradient
+0001d590: 2e0d 0a20 2020 2020 2020 206c 7720 3d20  ...        lw = 
+0001d5a0: 2030 2e30 3036 332a 6e70 2e65 7870 2834   0.0063*np.exp(4
+0001d5b0: 2e32 2a61 6c70 6861 290d 0a20 2020 2020  .2*alpha)..     
+0001d5c0: 2020 2073 656c 662e 7365 745f 6c69 6e65     self.set_line
+0001d5d0: 7769 6474 6828 6c77 290d 0a20 2020 2020  width(lw)..     
+0001d5e0: 2020 2020 200d 0a20 2020 2020 2020 2072       ..        r
+0001d5f0: 6574 7572 6e20 7365 6c66 0d0a 0d0a 2020  eturn self....  
+0001d600: 2020 6465 6620 7472 616e 7366 6f72 6d28    def transform(
+0001d610: 7365 6c66 2c20 726f 7461 7465 3d4e 6f6e  self, rotate=Non
+0001d620: 652c 2073 6361 6c65 3d31 2e30 2c20 7472  e, scale=1.0, tr
+0001d630: 616e 736c 6174 653d 5b30 2c30 2c30 5d20  anslate=[0,0,0] 
+0001d640: 2920 203a 0d0a 2020 2020 2020 2020 2222  )  :..        ""
+0001d650: 220d 0a20 2020 2020 2020 204c 696e 6561  "..        Linea
+0001d660: 7220 7472 616e 7366 6f72 6d61 7469 6f6e  r transformation
+0001d670: 206f 6620 7468 6520 7375 7266 6163 6520   of the surface 
+0001d680: 6f62 6a65 6374 2e0d 0a0d 0a20 2020 2020  object.....     
+0001d690: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
+0001d6a0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+0001d6b0: 2d0d 0a20 2020 2020 2020 2072 6f74 6174  -..        rotat
+0001d6c0: 6520 3a20 2061 7272 6179 2d6c 696b 652c  e :  array-like,
+0001d6d0: 206f 7074 696f 6e61 6c2c 2064 6566 6175   optional, defau
+0001d6e0: 6c74 3a20 4e6f 6e65 0d0a 2020 2020 2020  lt: None..      
+0001d6f0: 2020 2020 2020 4120 3320 6279 2033 2072        A 3 by 3 r
+0001d700: 6f74 6174 696f 6e20 6d61 7472 6978 2e0d  otation matrix..
+0001d710: 0a0d 0a20 2020 2020 2020 2073 6361 6c65  ...        scale
+0001d720: 203a 2033 4420 6172 7261 7920 6f72 2073   : 3D array or s
+0001d730: 6361 6c61 722c 206f 7074 696f 6e61 6c2c  calar, optional,
+0001d740: 2064 6566 6175 6c74 3a20 312e 300d 0a20   default: 1.0.. 
+0001d750: 2020 2020 2020 2020 2020 204d 756c 7469             Multi
+0001d760: 706c 6965 7273 206f 6620 7468 6520 6f62  pliers of the ob
+0001d770: 6a65 6374 2063 6f6f 7264 696e 6174 6573  ject coordinates
+0001d780: 2c20 696e 0d0a 2020 2020 2020 2020 2020  , in..          
+0001d790: 2020 7879 7a20 636f 6f72 6469 6e61 7465    xyz coordinate
+0001d7a0: 732e 2049 6620 6120 7369 6e67 6c65 2073  s. If a single s
+0001d7b0: 6361 6c61 722c 2074 6872 6565 0d0a 2020  calar, three..  
+0001d7c0: 2020 2020 2020 2020 2020 6d75 6c74 6970            multip
+0001d7d0: 6c69 6572 7320 6172 6520 7468 6520 7361  liers are the sa
+0001d7e0: 6d65 2076 616c 7565 2e0d 0a20 2020 2020  me value...     
+0001d7f0: 2020 200d 0a20 2020 2020 2020 2074 7261     ..        tra
+0001d800: 6e73 6c61 7465 203a 2061 7272 6179 2d6c  nslate : array-l
+0001d810: 696b 652c 206f 7074 696f 6e61 6c2c 2064  ike, optional, d
+0001d820: 6566 6175 6c74 3a20 5b30 2c30 2c30 5d0d  efault: [0,0,0].
+0001d830: 0a20 2020 2020 2020 2020 2020 2041 2078  .            A x
+0001d840: 797a 2074 7261 6e73 6c61 7469 6f6e 2076  yz translation v
+0001d850: 6563 746f 7220 6f66 206f 626a 6563 7420  ector of object 
+0001d860: 6f72 6967 696e 2e20 0d0a 0d0a 2020 2020  origin. ....    
+0001d870: 2020 2020 5265 7475 726e 730d 0a20 2020      Returns..   
+0001d880: 2020 2020 202d 2d2d 2d2d 2d2d 0d0a 2020       -------..  
+0001d890: 2020 2020 2020 7365 6c66 203a 2073 7572        self : sur
+0001d8a0: 6661 6365 206f 626a 6563 740d 0a0d 0a20  face object.... 
+0001d8b0: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
+0001d8c0: 2020 2020 6966 2072 6f74 6174 6520 6973      if rotate is
+0001d8d0: 204e 6f6e 6520 3a20 726f 7461 7465 203d   None : rotate =
+0001d8e0: 206e 702e 6964 656e 7469 7479 2833 290d   np.identity(3).
+0001d8f0: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
+0001d900: 7374 616e 6365 2873 6361 6c65 2c28 696e  stance(scale,(in
+0001d910: 742c 666c 6f61 7429 2920 3a0d 0a20 2020  t,float)) :..   
+0001d920: 2020 2020 2020 2020 2073 6361 6c65 203d           scale =
+0001d930: 2020 6e70 2e66 756c 6c28 332c 7363 616c    np.full(3,scal
+0001d940: 6529 2e61 7374 7970 6528 666c 6f61 7429  e).astype(float)
+0001d950: 0d0a 2020 2020 2020 2020 232e 2e2e 2e2e  ..        #.....
+0001d960: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0001d970: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0001d980: 2020 2020 0d0a 2020 2020 2020 2020 6465      ..        de
+0001d990: 6620 6973 4f72 7468 284d 2920 3a0d 0a20  f isOrth(M) :.. 
+0001d9a0: 2020 2020 2020 2020 2020 204d 203d 206e             M = n
+0001d9b0: 702e 6172 7261 7928 4d29 0d0a 2020 2020  p.array(M)..    
+0001d9c0: 2020 2020 2020 2020 746f 6c20 3d20 302e          tol = 0.
+0001d9d0: 3030 3030 310d 0a20 2020 2020 2020 2020  00001..         
+0001d9e0: 2020 2070 726f 6420 3d20 6e70 2e64 6f74     prod = np.dot
+0001d9f0: 284d 2c4d 2e54 290d 0a20 2020 2020 2020  (M,M.T)..       
+0001da00: 2020 2020 206e 702e 6669 6c6c 5f64 6961       np.fill_dia
+0001da10: 676f 6e61 6c28 7072 6f64 2c30 2e30 290d  gonal(prod,0.0).
+0001da20: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0001da30: 7572 6e20 6e6f 7420 286e 702e 6162 7328  urn not (np.abs(
+0001da40: 7072 6f64 293e 746f 6c29 2e61 6e79 2829  prod)>tol).any()
+0001da50: 0d0a 2020 2020 2020 2020 232e 2e2e 2e2e  ..        #.....
+0001da60: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0001da70: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0001da80: 2020 2020 0d0a 2020 2020 2020 2020 7472      ..        tr
+0001da90: 616e 7320 3d20 6c61 6d62 6461 2056 2c53  ans = lambda V,S
+0001daa0: 2c54 203a 206e 702e 6164 6428 2020 6e70  ,T : np.add(  np
+0001dab0: 2e64 6f74 2820 6e70 2e6d 756c 7469 706c  .dot( np.multipl
+0001dac0: 7928 562c 5329 2c72 6f74 6174 6529 202c  y(V,S),rotate) ,
+0001dad0: 5429 0d0a 2020 2020 2020 2020 232e 2e2e  T)..        #...
+0001dae0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0001daf0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0001db00: 2e2e 2020 2020 0d0a 2020 2020 2020 2020  ..    ..        
+0001db10: 6966 206e 6f74 2069 734f 7274 6828 726f  if not isOrth(ro
+0001db20: 7461 7465 2920 3a0d 0a20 2020 2020 2020  tate) :..       
+0001db30: 2020 2020 2077 6172 6e69 6e67 732e 7761       warnings.wa
+0001db40: 726e 2827 5472 616e 7366 6f72 6d20 726f  rn('Transform ro
+0001db50: 7461 7465 206d 6174 7269 7820 6973 204e  tate matrix is N
+0001db60: 4f54 204f 7274 686f 6769 6e61 6c2e 2729  OT Orthoginal.')
+0001db70: 0d0a 0d0a 2020 2020 2020 2020 7620 3d20  ....        v = 
+0001db80: 7472 616e 7328 2073 656c 662e 7665 7274  trans( self.vert
+0001db90: 6578 436f 6f72 2c20 7363 616c 652c 2074  exCoor, scale, t
+0001dba0: 7261 6e73 6c61 7465 2020 290d 0a20 2020  ranslate  )..   
+0001dbb0: 2020 2020 2069 6620 7365 6c66 2e76 6563       if self.vec
+0001dbc0: 746f 725f 6669 656c 6420 6973 206e 6f74  tor_field is not
+0001dbd0: 204e 6f6e 6520 3a20 0d0a 2020 2020 2020   None : ..      
+0001dbe0: 2020 2020 2020 6e53 6361 6c20 3d20 6e70        nScal = np
+0001dbf0: 2e64 6976 6964 6528 7363 616c 652c 206e  .divide(scale, n
+0001dc00: 702e 6c69 6e61 6c67 2e6e 6f72 6d28 7363  p.linalg.norm(sc
+0001dc10: 616c 6529 2020 2029 0d0a 2020 2020 2020  ale)   )..      
+0001dc20: 2020 2020 2020 7365 6c66 2e76 6563 746f        self.vecto
+0001dc30: 725f 6669 656c 6420 3d20 7472 616e 7328  r_field = trans(
+0001dc40: 2073 656c 662e 7665 6374 6f72 5f66 6965   self.vector_fie
+0001dc50: 6c64 2c20 6e53 6361 6c2c 205b 302c 302c  ld, nScal, [0,0,
+0001dc60: 305d 2020 290d 0a20 2020 2020 2020 2073  0]  )..        s
+0001dc70: 656c 662e 7665 7274 6578 436f 6f72 203d  elf.vertexCoor =
+0001dc80: 2076 0d0a 2020 2020 2020 2020 7365 6c66   v..        self
+0001dc90: 2e5f 7365 745f 6765 6f6d 6574 7269 635f  ._set_geometric_
+0001dca0: 626f 756e 6473 2829 0d0a 2020 2020 2020  bounds()..      
+0001dcb0: 2020 7365 6c66 2e73 6574 5f76 6572 7473    self.set_verts
+0001dcc0: 2820 765b 206e 702e 6172 7261 7928 7365  ( v[ np.array(se
+0001dcd0: 6c66 2e66 7649 6e64 6963 6573 2920 5d20  lf.fvIndices) ] 
+0001dce0: 290d 0a20 2020 2020 2020 2073 656c 662e  )..        self.
+0001dcf0: 5f73 7572 6661 6365 5368 6170 6543 6861  _surfaceShapeCha
+0001dd00: 6e67 6564 203d 2054 7275 650d 0a20 2020  nged = True..   
+0001dd10: 2020 2020 2073 656c 662e 7363 616c 6520       self.scale 
+0001dd20: 3d20 7363 616c 650d 0a20 2020 2020 2020  = scale..       
+0001dd30: 2073 656c 662e 7472 616e 736c 6174 696f   self.translatio
+0001dd40: 6e20 3d20 7472 616e 736c 6174 650d 0a20  n = translate.. 
+0001dd50: 2020 2020 2020 2073 656c 662e 726f 7461         self.rota
+0001dd60: 7469 6f6e 203d 2072 6f74 6174 650d 0a20  tion = rotate.. 
+0001dd70: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0001dd80: 6c66 0d0a 0d0a 2020 2020 6465 6620 6765  lf....    def ge
+0001dd90: 745f 7472 616e 7366 6f72 6d41 7869 7328  t_transformAxis(
+0001dda0: 7365 6c66 2c20 2a2a 6b61 7267 7329 203a  self, **kargs) :
+0001ddb0: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
+0001ddc0: 2020 2020 2020 204c 696e 6533 4443 6f6c         Line3DCol
+0001ddd0: 6c65 6374 696f 6e20 6f66 2074 6865 2027  lection of the '
+0001dde0: 6c61 7374 2720 7472 616e 7366 6f72 6d65  last' transforme
+0001ddf0: 6420 7375 7266 6163 6520 636f 6f72 6469  d surface coordi
+0001de00: 6e61 7465 2061 7869 732e 0d0a 2020 2020  nate axis...    
+0001de10: 2020 2020 0d0a 2020 2020 2020 2020 5061      ..        Pa
+0001de20: 7261 6d65 7465 7273 0d0a 2020 2020 2020  rameters..      
+0001de30: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
+0001de40: 2020 2020 2020 6c65 6e6d 756c 7420 3a20        lenmult : 
+0001de50: 7363 616c 6172 206f 7220 3344 2061 7272  scalar or 3D arr
+0001de60: 6179 2c20 6f70 7469 6f6e 616c 2c20 6465  ay, optional, de
+0001de70: 6661 756c 743a 2031 0d0a 2020 2020 2020  fault: 1..      
+0001de80: 2020 2020 2020 5363 616c 6172 206d 756c        Scalar mul
+0001de90: 7469 706c 6965 7220 6f66 2074 6865 2074  tiplier of the t
+0001dea0: 6872 6565 2063 6f6f 7264 696e 6174 6520  hree coordinate 
+0001deb0: 6178 6973 2e0d 0a0d 0a20 2020 2020 2020  axis.....       
+0001dec0: 2077 6964 7468 203a 2073 6361 6c61 722c   width : scalar,
+0001ded0: 206f 7074 696f 6e61 6c2c 2064 6566 6175   optional, defau
+0001dee0: 6c74 3a20 312e 350d 0a20 2020 2020 2020  lt: 1.5..       
+0001def0: 2020 2020 204c 696e 6520 7769 6474 6820       Line width 
+0001df00: 6f66 2074 6865 2063 6f6f 7264 696e 6174  of the coordinat
+0001df10: 6520 6178 6973 2e20 2020 0d0a 0d0a 2020  e axis.   ....  
+0001df20: 2020 2020 2020 636f 6c6f 7220 3a20 6120        color : a 
+0001df30: 436f 6c6f 7220 6f72 2033 4420 6172 7261  Color or 3D arra
+0001df40: 7920 6f66 2043 6f6c 6f72 732c 206f 7074  y of Colors, opt
+0001df50: 696f 6e61 6c2c 2064 6566 6175 6c74 3a20  ional, default: 
+0001df60: 5b27 7227 2c27 6727 2c27 6227 5d0d 0a0d  ['r','g','b']...
+0001df70: 0a20 2020 2020 2020 206e 6567 6178 6973  .        negaxis
+0001df80: 203a 2062 6f6f 6c65 616e 2c20 6f70 7469   : boolean, opti
+0001df90: 6f6e 616c 2c20 6465 6661 756c 743a 2046  onal, default: F
+0001dfa0: 616c 7365 0d0a 2020 2020 2020 2020 2020  alse..          
+0001dfb0: 2020 4966 2054 7275 652c 2069 6e63 6c75    If True, inclu
+0001dfc0: 6465 2074 6865 206e 6567 6174 6976 6520  de the negative 
+0001dfd0: 6178 6973 2c20 6f74 6865 7277 6973 6520  axis, otherwise 
+0001dfe0: 6178 6973 2073 7461 7274 2061 7420 6f72  axis start at or
+0001dff0: 6967 696e 2e0d 0a0d 0a20 2020 2020 2020  igin.....       
+0001e000: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
+0001e010: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
+0001e020: 2020 204c 696e 6533 4443 6f6c 6c65 6374     Line3DCollect
+0001e030: 696f 6e20 6f62 6a65 6374 0d0a 0d0a 2020  ion object....  
+0001e040: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
+0001e050: 2020 206b 6172 6744 6674 203d 207b 2027     kargDft = { '
+0001e060: 6c65 6e6d 756c 7427 3a31 2e30 2c20 2777  lenmult':1.0, 'w
+0001e070: 6964 7468 273a 312e 352c 2027 636f 6c6f  idth':1.5, 'colo
+0001e080: 7227 3a5b 2772 272c 2767 272c 2762 275d  r':['r','g','b']
+0001e090: 2c20 276e 6567 6178 6973 273a 4661 6c73  , 'negaxis':Fals
+0001e0a0: 6520 7d0d 0a20 2020 2020 2020 204b 5720  e }..        KW 
+0001e0b0: 3d20 4b57 7072 6f63 6573 736f 7228 6b61  = KWprocessor(ka
+0001e0c0: 7267 4466 742c 2767 6574 5f74 7261 6e73  rgDft,'get_trans
+0001e0d0: 666f 726d 4178 6973 272c 2a2a 6b61 7267  formAxis',**karg
+0001e0e0: 7329 0d0a 2020 2020 2020 2020 6c65 6e6d  s)..        lenm
+0001e0f0: 756c 7420 3d20 4b57 2e67 6574 5661 6c28  ult = KW.getVal(
+0001e100: 276c 656e 6d75 6c74 2729 0d0a 2020 2020  'lenmult')..    
+0001e110: 2020 2020 7769 6474 6820 3d20 4b57 2e67      width = KW.g
+0001e120: 6574 5661 6c28 2777 6964 7468 2729 0d0a  etVal('width')..
+0001e130: 2020 2020 2020 2020 636f 6c6f 7220 3d20          color = 
+0001e140: 4b57 2e67 6574 5661 6c28 2763 6f6c 6f72  KW.getVal('color
+0001e150: 2729 0d0a 2020 2020 2020 2020 6e65 6761  ')..        nega
+0001e160: 7869 7320 3d20 4b57 2e67 6574 5661 6c28  xis = KW.getVal(
+0001e170: 276e 6567 6178 6973 2729 0d0a 2020 2020  'negaxis')..    
+0001e180: 2020 2020 0d0a 2020 2020 2020 2020 7365      ..        se
+0001e190: 6c66 5072 6f70 203d 207b 0d0a 2020 2020  lfProp = {..    
+0001e1a0: 2020 2020 2020 2020 2773 6361 6c65 2720          'scale' 
+0001e1b0: 3a20 7365 6c66 2e73 6361 6c65 2c0d 0a20  : self.scale,.. 
+0001e1c0: 2020 2020 2020 2020 2020 2027 726f 7461             'rota
+0001e1d0: 7469 6f6e 2720 3a20 7365 6c66 2e72 6f74  tion' : self.rot
+0001e1e0: 6174 696f 6e2c 0d0a 2020 2020 2020 2020  ation,..        
+0001e1f0: 2020 2020 2774 7261 6e73 6c61 7469 6f6e      'translation
+0001e200: 2720 3a20 7365 6c66 2e74 7261 6e73 6c61  ' : self.transla
+0001e210: 7469 6f6e 0d0a 2020 2020 2020 2020 7d0d  tion..        }.
+0001e220: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0001e230: 5f74 7261 6e73 666f 726d 4178 6973 2873  _transformAxis(s
+0001e240: 656c 6650 726f 702c 6c65 6e6d 756c 742c  elfProp,lenmult,
+0001e250: 2077 6964 7468 2c20 636f 6c6f 722c 206e   width, color, n
+0001e260: 6567 6178 6973 290d 0a0d 0a20 2020 2064  egaxis)....    d
+0001e270: 6566 206d 6170 5f67 656f 6d5f 6672 6f6d  ef map_geom_from
+0001e280: 5f73 7664 2873 656c 662c 2064 6174 612c  _svd(self, data,
+0001e290: 2070 633d 4e6f 6e65 2029 203a 0d0a 2020   pc=None ) :..  
+0001e2a0: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
+0001e2b0: 2020 2054 7261 6e73 666f 726d 2073 7572     Transform sur
+0001e2c0: 6661 6365 2067 656f 6d65 7472 7920 6261  face geometry ba
+0001e2d0: 7365 6420 6f6e 2061 2050 4341 2061 6e61  sed on a PCA ana
+0001e2e0: 6c79 7369 7320 6f66 2061 2064 6174 6120  lysis of a data 
+0001e2f0: 7365 742e 0d0a 2020 2020 2020 2020 5265  set...        Re
+0001e300: 7375 6c74 2076 616c 7565 7320 636f 6e74  sult values cont
+0001e310: 6169 6e65 6420 696e 2074 6865 2073 7572  ained in the sur
+0001e320: 6661 6365 2070 726f 7065 7274 7920 7376  face property sv
+0001e330: 645f 6469 6374 2e0d 0a20 2020 2020 2020  d_dict...       
+0001e340: 200d 0a20 2020 2020 2020 2050 6172 616d   ..        Param
+0001e350: 6574 6572 730d 0a20 2020 2020 2020 202d  eters..        -
+0001e360: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
+0001e370: 2020 2064 6174 6120 3a20 4e20 7820 3320     data : N x 3 
+0001e380: 6172 7261 7920 6f66 2078 2c79 2c7a 2064  array of x,y,z d
+0001e390: 6174 6120 636f 6f72 6469 6e61 7465 732e  ata coordinates.
+0001e3a0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+0001e3b0: 2020 2020 7063 203a 2073 6361 6c61 722c      pc : scalar,
+0001e3c0: 206f 7074 696f 6e61 6c2c 2064 6566 6175   optional, defau
+0001e3d0: 6c74 3a20 4e6f 6e65 0d0a 2020 2020 2020  lt: None..      
+0001e3e0: 2020 2020 2020 5365 7473 2074 6865 206d        Sets the m
+0001e3f0: 696e 696d 756d 2073 697a 6520 6f66 2074  inimum size of t
+0001e400: 6865 2073 7572 6661 6365 2062 6173 6564  he surface based
+0001e410: 206f 6e20 7468 650d 0a20 2020 2020 2020   on the..       
+0001e420: 2020 2020 2072 656c 6174 6976 6520 6e75       relative nu
+0001e430: 6d62 6572 206f 6620 6461 7461 2e20 2056  mber of data.  V
+0001e440: 616c 7565 2072 616e 6765 2066 726f 6d20  alue range from 
+0001e450: 3020 746f 2031 2c20 0d0a 2020 2020 2020  0 to 1, ..      
+0001e460: 2020 2020 2020 7769 7468 2031 2066 6f72        with 1 for
+0001e470: 2031 3030 252e 2020 4966 204e 6f6e 652c   100%.  If None,
+0001e480: 206f 6e65 2073 7461 6e64 6172 6420 6465   one standard de
+0001e490: 7669 6174 696f 6e0d 0a20 2020 2020 2020  viation..       
+0001e4a0: 2020 2020 206f 6620 7468 6520 6461 7461       of the data
+0001e4b0: 2073 6574 7320 7468 6520 7375 7266 6163   sets the surfac
+0001e4c0: 6520 7369 7a65 2e0d 0a20 2020 2020 2020  e size...       
+0001e4d0: 2020 2020 200d 0a20 2020 2020 2020 2052       ..        R
+0001e4e0: 6574 7572 6e73 0d0a 2020 2020 2020 2020  eturns..        
+0001e4f0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
+0001e500: 2073 656c 6620 3a20 7375 7266 6163 6520   self : surface 
+0001e510: 6f62 6a65 6374 0d0a 0d0a 2020 2020 2020  object....      
+0001e520: 2020 2222 220d 0a0d 0a20 2020 2020 2020    """....       
+0001e530: 2069 6620 7365 6c66 2e5f 6973 436f 6d70   if self._isComp
+0001e540: 6f73 6974 6553 7572 6661 6365 203a 0d0a  ositeSurface :..
+0001e550: 2020 2020 2020 2020 2020 2020 7761 726e              warn
+0001e560: 696e 6773 2e77 6172 6e28 2744 6174 6120  ings.warn('Data 
+0001e570: 6f70 6572 6174 696f 6e20 6e6f 7420 6176  operation not av
+0001e580: 6169 6c61 626c 6520 666f 7220 636f 6d62  ailable for comb
+0001e590: 696e 6564 2073 6861 7065 732e 2729 0d0a  ined shapes.')..
+0001e5a0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0001e5b0: 726e 2073 656c 660d 0a20 2020 2020 2020  rn self..       
+0001e5c0: 2064 6174 615f 6d65 616e 203d 2064 6174   data_mean = dat
+0001e5d0: 612e 6d65 616e 2861 7869 733d 3029 0d0a  a.mean(axis=0)..
+0001e5e0: 2020 2020 2020 2020 6461 7461 5f63 656e          data_cen
+0001e5f0: 7465 7265 6420 3d20 6461 7461 202d 2064  tered = data - d
+0001e600: 6174 615f 6d65 616e 0d0a 0d0a 2020 2020  ata_mean....    
+0001e610: 2020 2020 5561 2c20 7361 2c20 5674 6120      Ua, sa, Vta 
+0001e620: 3d20 6e70 2e6c 696e 616c 672e 7376 6428  = np.linalg.svd(
+0001e630: 6461 7461 5f63 656e 7465 7265 6429 0d0a  data_centered)..
+0001e640: 2020 2020 2020 2020 6461 7461 4176 6520          dataAve 
+0001e650: 3d20 6e70 2e6d 6561 6e28 7361 2920 2020  = np.mean(sa)   
+0001e660: 2020 2020 0d0a 2020 2020 2020 2020 7363      ..        sc
+0001e670: 616c 6520 3d20 7361 2f64 6174 6141 7665  ale = sa/dataAve
+0001e680: 0d0a 2020 2020 2020 2020 7472 616e 4461  ..        tranDa
+0001e690: 7461 203d 206e 702e 6469 7669 6465 286e  ta = np.divide(n
+0001e6a0: 702e 646f 7428 6461 7461 5f63 656e 7465  p.dot(data_cente
+0001e6b0: 7265 642c 5674 612e 5429 2c73 6361 6c65  red,Vta.T),scale
+0001e6c0: 2029 2020 2020 2020 200d 0a20 2020 2020   )       ..     
+0001e6d0: 2020 2064 6973 4172 723d 6e70 2e6c 696e     disArr=np.lin
+0001e6e0: 616c 672e 6e6f 726d 2874 7261 6e44 6174  alg.norm(tranDat
+0001e6f0: 612c 6178 6973 3d31 2920 2020 2020 200d  a,axis=1)      .
+0001e700: 0a20 2020 2020 2020 2064 6973 4172 7253  .        disArrS
+0001e710: 756d 203d 206e 702e 6c69 6e61 6c67 2e6e  um = np.linalg.n
+0001e720: 6f72 6d28 6469 7341 7272 290d 0a20 2020  orm(disArr)..   
+0001e730: 2020 2020 206c 656e 6469 7341 7272 203d       lendisArr =
+0001e740: 206c 656e 2864 6973 4172 7229 0d0a 2020   len(disArr)..  
+0001e750: 2020 2020 2020 7265 664c 656e 203d 2064        refLen = d
+0001e760: 6973 4172 7253 756d 2f6e 702e 7371 7274  isArrSum/np.sqrt
+0001e770: 286c 656e 6469 7341 7272 2920 2020 2020  (lendisArr)     
+0001e780: 2020 200d 0a20 2020 2020 2020 2073 3d72     ..        s=r
+0001e790: 6566 4c65 6e0d 0a20 2020 2020 2020 2064  efLen..        d
+0001e7a0: 6973 4172 7220 203d 206e 702e 6469 7669  isArr  = np.divi
+0001e7b0: 6465 2864 6973 4172 722c 7265 664c 656e  de(disArr,refLen
+0001e7c0: 290d 0a20 2020 2020 2020 200d 0a20 2020  )..        ..   
+0001e7d0: 2020 2020 2069 6620 7063 2069 7320 6e6f       if pc is no
+0001e7e0: 7420 4e6f 6e65 3a0d 0a20 2020 2020 2020  t None:..       
+0001e7f0: 2020 2020 2064 6c65 6e20 3d20 6c65 6e28       dlen = len(
+0001e800: 6469 7341 7272 290d 0a20 2020 2020 2020  disArr)..       
+0001e810: 2020 2020 2064 696e 6465 7820 3d20 696e       dindex = in
+0001e820: 7428 646c 656e 2a70 6329 0d0a 2020 2020  t(dlen*pc)..    
+0001e830: 2020 2020 2020 2020 6966 2064 696e 6465          if dinde
+0001e840: 7820 3e3d 2064 6c65 6e20 3a20 6469 6e64  x >= dlen : dind
+0001e850: 6578 203d 2064 6c65 6e20 2d20 310d 0a20  ex = dlen - 1.. 
+0001e860: 2020 2020 2020 2020 2020 2069 6620 6469             if di
+0001e870: 6e64 6578 203c 2020 3020 2020 203a 2064  ndex <  0    : d
+0001e880: 696e 6465 7820 3d20 300d 0a20 2020 2020  index = 0..     
+0001e890: 2020 2020 2020 2073 203d 206e 702e 736f         s = np.so
+0001e8a0: 7274 2864 6973 4172 7229 5b64 696e 6465  rt(disArr)[dinde
+0001e8b0: 785d 0d0a 2020 2020 2020 2020 2020 2020  x]..            
+0001e8c0: 6469 7341 7272 203d 2064 6973 4172 722f  disArr = disArr/
+0001e8d0: 730d 0a20 2020 2020 2020 2020 2020 2073  s..            s
+0001e8e0: 203d 2073 2a72 6566 4c65 6e0d 0a0d 0a20   = s*refLen.... 
+0001e8f0: 2020 2020 2020 2073 656c 662e 7472 616e         self.tran
+0001e900: 7366 6f72 6d28 5674 612c 732a 7363 616c  sform(Vta,s*scal
+0001e910: 652c 6461 7461 5f6d 6561 6e29 200d 0a20  e,data_mean) .. 
+0001e920: 2020 2020 2020 2073 656c 662e 5f73 7664         self._svd
+0001e930: 5f64 6963 7420 3d20 7b0d 0a20 2020 2020  _dict = {..     
+0001e940: 2020 2020 2020 2027 6469 7361 7272 273a         'disarr':
+0001e950: 2064 6973 4172 722c 2027 7369 676d 6127   disArr, 'sigma'
+0001e960: 3a20 7265 664c 656e 2c20 2774 7261 6e73  : refLen, 'trans
+0001e970: 273a 205b 5674 612c 732a 7363 616c 652c  ': [Vta,s*scale,
+0001e980: 6461 7461 5f6d 6561 6e5d 0d0a 2020 2020  data_mean]..    
+0001e990: 2020 2020 7d0d 0a20 2020 2020 2020 2072      }..        r
+0001e9a0: 6574 7572 6e20 7365 6c66 0d0a 0d0a 2020  eturn self....  
+0001e9b0: 2020 6465 6620 636f 6e74 6f75 724c 696e    def contourLin
+0001e9c0: 6573 2873 656c 662c 2a64 6973 742c 2a2a  es(self,*dist,**
+0001e9d0: 6b61 7267 7329 203a 0d0a 2020 2020 2020  kargs) :..      
+0001e9e0: 2020 2222 220d 0a20 2020 2020 2020 2043    """..        C
+0001e9f0: 6f6c 6f72 4c69 6e65 3344 436f 6c6c 6563  olorLine3DCollec
+0001ea00: 7469 6f6e 2063 6f6e 746f 7572 206c 696e  tion contour lin
+0001ea10: 6573 206f 6e20 7468 6520 7375 7266 6163  es on the surfac
+0001ea20: 652e 0d0a 0d0a 2020 2020 2020 2020 5061  e.....        Pa
+0001ea30: 7261 6d65 7465 7273 0d0a 2020 2020 2020  rameters..      
+0001ea40: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
+0001ea50: 2020 2020 2020 6469 7374 203a 2066 6c6f        dist : flo
+0001ea60: 6174 730d 0a20 2020 2020 2020 2020 2020  ats..           
+0001ea70: 2044 6973 7461 6e63 6573 2066 726f 6d20   Distances from 
+0001ea80: 7468 6520 6f72 6967 696e 2074 6f20 7468  the origin to th
+0001ea90: 6520 7375 7266 6163 6520 6f66 2069 6e74  e surface of int
+0001eaa0: 6572 7365 6374 696f 6e2c 0d0a 2020 2020  ersection,..    
+0001eab0: 2020 2020 2020 2020 616c 6f6e 6720 7468          along th
+0001eac0: 6520 6469 7265 6374 696f 6e20 7665 6374  e direction vect
+0001ead0: 6f72 2e0d 0a20 2020 2020 2020 2020 2020  or...           
+0001eae0: 2020 200d 0a20 2020 2020 2020 2064 6972     ..        dir
+0001eaf0: 6563 7469 6f6e 203a 2061 7272 6179 2d6c  ection : array-l
+0001eb00: 696b 652c 206f 7074 696f 6e61 6c2c 2064  ike, optional, d
+0001eb10: 6566 6175 6c74 3a20 5b30 2c30 2c31 5d0d  efault: [0,0,1].
+0001eb20: 0a20 2020 2020 2020 2020 2020 2041 2078  .            A x
+0001eb30: 797a 2076 6563 746f 7220 6e6f 726d 616c  yz vector normal
+0001eb40: 2074 6f20 7468 6520 696e 7465 7273 6563   to the intersec
+0001eb50: 7469 6f6e 2070 6c61 6e65 730d 0a20 2020  tion planes..   
+0001eb60: 2020 2020 2020 2020 2066 6f72 2070 6c61           for pla
+0001eb70: 6e61 7220 636f 6e74 6f75 7273 206f 7220  nar contours or 
+0001eb80: 6178 6961 6c20 6469 7265 6374 696f 6e20  axial direction 
+0001eb90: 6f66 0d0a 2020 2020 2020 2020 2020 2020  of..            
+0001eba0: 6379 6c69 6e64 6572 7320 666f 7220 6379  cylinders for cy
+0001ebb0: 6c69 6e64 7269 6361 6c20 636f 6e74 6f75  lindrical contou
+0001ebc0: 7273 2e0d 0a0d 0a20 2020 2020 2020 206e  rs.....        n
+0001ebd0: 616d 6520 3a20 7374 7269 6e67 2069 6465  ame : string ide
+0001ebe0: 6e74 6966 6965 7220 2864 6566 6175 6c74  ntifier (default
+0001ebf0: 204e 6f6e 6529 0d0a 0d0a 2020 2020 2020   None)....      
+0001ec00: 2020 636f 6c6f 7220 3a20 636f 6c6f 7220    color : color 
+0001ec10: 2864 6566 6175 6c74 2069 7320 7468 6520  (default is the 
+0001ec20: 7375 7266 6163 6520 636f 6c6f 7273 290d  surface colors).
+0001ec30: 0a0d 0a20 2020 2020 2020 2063 6f6f 7220  ...        coor 
+0001ec40: 3a20 696e 7465 6765 7220 6f72 2073 7472  : integer or str
+0001ec50: 696e 6720 696e 6469 6361 7469 6e67 2074  ing indicating t
+0001ec60: 6865 2074 7970 6520 6f66 2063 6f6e 746f  he type of conto
+0001ec70: 7572 2073 7572 6661 6365 3a0d 0a20 2020  ur surface:..   
+0001ec80: 2020 2020 2020 2020 2030 2c20 702c 2050           0, p, P
+0001ec90: 2c20 7879 7a2c 706c 616e 6172 2020 2020  , xyz,planar    
+0001eca0: 2020 2020 2020 2020 2020 2020 202d 2070               - p
+0001ecb0: 6c61 6e61 7220 2864 6566 6175 6c74 2c20  lanar (default, 
+0001ecc0: 706c 616e 6172 2026 2070 6f6c 6172 290d  planar & polar).
+0001ecd0: 0a20 2020 2020 2020 2020 2020 2031 2c20  .            1, 
+0001ece0: 632c 2043 2c20 6379 6c69 6e64 6572 2c70  c, C, cylinder,p
+0001ecf0: 706c 6172 2c63 796c 696e 6472 6963 616c  plar,cylindrical
+0001ed00: 202d 2063 796c 696e 6465 7220 2864 6566   - cylinder (def
+0001ed10: 6175 6c74 2c20 6379 6c69 6e64 7269 6361  ault, cylindrica
+0001ed20: 6c29 0d0a 2020 2020 2020 2020 2020 2020  l)..            
+0001ed30: 322c 2073 2c20 532c 2073 7068 6572 652c  2, s, S, sphere,
+0001ed40: 7370 6865 7269 6361 6c20 2020 2020 2020  spherical       
+0001ed50: 2020 2020 2d20 7370 6865 7265 2028 6465      - sphere (de
+0001ed60: 6661 756c 742c 2073 7068 6572 6963 616c  fault, spherical
+0001ed70: 290d 0a20 2020 2020 2020 2020 2020 2033  )..            3
+0001ed80: 2c20 782c 2058 2020 2020 2020 2020 2020  , x, X          
+0001ed90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001eda0: 2020 202d 2079 2d7a 2070 6c61 6e65 0d0a     - y-z plane..
+0001edb0: 2020 2020 2020 2020 2020 2020 342c 2079              4, y
+0001edc0: 2c20 5920 2020 2020 2020 2020 2020 2020  , Y             
+0001edd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ede0: 2d20 782d 7a20 706c 616e 650d 0a20 2020  - x-z plane..   
+0001edf0: 2020 2020 2020 2020 2035 2c20 7a2c 205a           5, z, Z
+0001ee00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ee10: 2020 2020 2020 2020 2020 2020 202d 2078               - x
+0001ee20: 2d79 2070 6c61 6e65 0d0a 0d0a 2020 2020  -y plane....    
+0001ee30: 2020 2020 5265 7475 726e 730d 0a20 2020      Returns..   
+0001ee40: 2020 2020 202d 2d2d 2d2d 2d2d 0d0a 2020       -------..  
+0001ee50: 2020 2020 2020 7365 6c66 203a 206c 696e        self : lin
+0001ee60: 6520 6f62 6a65 6374 0d0a 0d0a 2020 2020  e object....    
+0001ee70: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
+0001ee80: 2065 7874 4466 7420 3d20 7b20 2764 6972   extDft = { 'dir
+0001ee90: 6563 7469 6f6e 273a 5b30 2c30 2c31 2e30  ection':[0,0,1.0
+0001eea0: 5d2c 2027 6e61 6d65 273a 204e 6f6e 652c  ], 'name': None,
+0001eeb0: 2027 636f 6c6f 7227 3a20 4e6f 6e65 207d   'color': None }
+0001eec0: 0d0a 2020 2020 2020 2020 6b61 7267 4466  ..        kargDf
+0001eed0: 7420 3d20 7b20 2a2a 5f43 4f4f 525f 4b57  t = { **_COOR_KW
+0001eee0: 4152 4753 2c20 2a2a 6578 7444 6674 207d  ARGS, **extDft }
+0001eef0: 0d0a 2020 2020 2020 2020 2320 7265 7365  ..        # rese
+0001ef00: 7420 6465 6661 756c 7420 2763 6f6f 7227  t default 'coor'
+0001ef10: 2066 6f72 2063 796c 696e 6472 6963 616c   for cylindrical
+0001ef20: 2061 6e64 2073 7068 6572 6963 616c 2063   and spherical c
+0001ef30: 6f6f 7220 7375 7266 6163 6573 2e0d 0a20  oor surfaces... 
+0001ef40: 2020 2020 2020 2063 6f6f 7256 616c 203d         coorVal =
+0001ef50: 2030 0d0a 2020 2020 2020 2020 6966 2073   0..        if s
+0001ef60: 656c 662e 636f 6f72 5479 7065 203d 3d20  elf.coorType == 
+0001ef70: 5f43 4f4f 5253 5953 5b22 4359 4c49 4e44  _COORSYS["CYLIND
+0001ef80: 5249 4341 4c22 5d20 3a20 636f 6f72 5661  RICAL"] : coorVa
+0001ef90: 6c20 3d20 310d 0a20 2020 2020 2020 2069  l = 1..        i
+0001efa0: 6620 7365 6c66 2e63 6f6f 7254 7970 6520  f self.coorType 
+0001efb0: 3d3d 205f 434f 4f52 5359 535b 2253 5048  == _COORSYS["SPH
+0001efc0: 4552 4943 414c 225d 203a 2020 2063 6f6f  ERICAL"] :   coo
+0001efd0: 7256 616c 203d 2032 0d0a 2020 2020 2020  rVal = 2..      
+0001efe0: 2020 6966 2063 6f6f 7256 616c 2021 3d20    if coorVal != 
+0001eff0: 3020 3a0d 0a20 2020 2020 2020 2020 2020  0 :..           
+0001f000: 2074 656d 7020 3d20 636f 7079 2e64 6565   temp = copy.dee
+0001f010: 7063 6f70 7928 5f43 4f4f 525f 4b57 4152  pcopy(_COOR_KWAR
+0001f020: 4753 290d 0a20 2020 2020 2020 2020 2020  GS)..           
+0001f030: 2074 656d 705b 2763 6f6f 7227 5d5b 305d   temp['coor'][0]
+0001f040: 203d 205b 636f 6f72 5661 6c5d 0d0a 2020   = [coorVal]..  
+0001f050: 2020 2020 2020 2020 2020 6b61 7267 4466            kargDf
+0001f060: 7420 3d20 7b20 2a2a 7465 6d70 2c20 2a2a  t = { **temp, **
+0001f070: 6578 7444 6674 207d 0d0a 0d0a 2020 2020  extDft }....    
+0001f080: 2020 2020 4b57 203d 204b 5770 726f 6365      KW = KWproce
+0001f090: 7373 6f72 286b 6172 6744 6674 2c27 636f  ssor(kargDft,'co
+0001f0a0: 6e74 6f75 724c 696e 6573 272c 2a2a 6b61  ntourLines',**ka
+0001f0b0: 7267 7329 0d0a 2020 2020 2020 2020 6349  rgs)..        cI
+0001f0c0: 6e64 6578 203d 204b 572e 6765 7456 616c  ndex = KW.getVal
+0001f0d0: 2827 636f 6f72 2729 0d0a 2020 2020 2020  ('coor')..      
+0001f0e0: 2020 6469 7265 6374 696f 6e20 3d20 4b57    direction = KW
+0001f0f0: 2e67 6574 5661 6c28 2764 6972 6563 7469  .getVal('directi
+0001f100: 6f6e 2729 0d0a 2020 2020 2020 2020 6e61  on')..        na
+0001f110: 6d65 203d 204b 572e 6765 7456 616c 2827  me = KW.getVal('
+0001f120: 6e61 6d65 2729 0d0a 2020 2020 2020 2020  name')..        
+0001f130: 636f 6c6f 7220 3d20 4b57 2e67 6574 5661  color = KW.getVa
+0001f140: 6c28 2763 6f6c 6f72 2729 0d0a 0d0a 2020  l('color')....  
+0001f150: 2020 2020 2020 6966 2064 6972 6563 7469        if directi
+0001f160: 6f6e 2069 7320 4e6f 6e65 203a 2064 6972  on is None : dir
+0001f170: 6563 7469 6f6e 203d 2065 7874 4466 745b  ection = extDft[
+0001f180: 2764 6972 6563 7469 6f6e 275d 0d0a 2020  'direction']..  
+0001f190: 2020 2020 2020 6966 2063 496e 6465 783d        if cIndex=
+0001f1a0: 3d33 203a 2063 496e 6465 782c 2064 6972  =3 : cIndex, dir
+0001f1b0: 6563 7469 6f6e 203d 2030 2c20 5b20 312c  ection = 0, [ 1,
+0001f1c0: 302c 3020 5d0d 0a20 2020 2020 2020 2069  0,0 ]..        i
+0001f1d0: 6620 6349 6e64 6578 3d3d 3420 3a20 6349  f cIndex==4 : cI
+0001f1e0: 6e64 6578 2c20 6469 7265 6374 696f 6e20  ndex, direction 
+0001f1f0: 3d20 302c 205b 2030 2c31 2c30 205d 0d0a  = 0, [ 0,1,0 ]..
+0001f200: 2020 2020 2020 2020 6966 2063 496e 6465          if cInde
+0001f210: 783d 3d35 203a 2063 496e 6465 782c 2064  x==5 : cIndex, d
+0001f220: 6972 6563 7469 6f6e 203d 2030 2c20 5b20  irection = 0, [ 
+0001f230: 302c 302c 3120 5d0d 0a0d 0a20 2020 2020  0,0,1 ]....     
+0001f240: 2020 2064 6f74 7072 6f64 203d 205f 636f     dotprod = _co
+0001f250: 6f72 5f64 6f74 7072 6f64 2864 6972 6563  or_dotprod(direc
+0001f260: 7469 6f6e 2c63 496e 6465 782c 7365 6c66  tion,cIndex,self
+0001f270: 2e76 6572 7465 7843 6f6f 7229 0d0a 2020  .vertexCoor)..  
+0001f280: 2020 2020 2020 636f 6e4c 696e 6573 203d        conLines =
+0001f290: 2020 7365 6c66 2e5f 636f 6e74 6f75 724c    self._contourL
+0001f2a0: 696e 6543 6f6c 6c65 6374 696f 6e28 2064  ineCollection( d
+0001f2b0: 6f74 7072 6f64 2c64 6972 6563 7469 6f6e  otprod,direction
+0001f2c0: 2c2a 6469 7374 2029 0d0a 2020 2020 2020  ,*dist )..      
+0001f2d0: 2020 6966 2063 6f6e 4c69 6e65 7320 6973    if conLines is
+0001f2e0: 204e 6f6e 6520 3a0d 0a20 2020 2020 2020   None :..       
+0001f2f0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+0001f300: 4572 726f 7228 274e 6f20 7375 7266 6163  Error('No surfac
+0001f310: 652e 636f 6e74 6f75 724c 696e 6573 2077  e.contourLines w
+0001f320: 6572 6520 666f 756e 642e 2729 0d0a 2020  ere found.')..  
+0001f330: 2020 2020 2020 6966 2063 496e 6465 7820        if cIndex 
+0001f340: 3d3d 2030 203a 2063 6f6e 4c69 6e65 732e  == 0 : conLines.
+0001f350: 5f70 6c61 6e65 4e6f 726d 616c 203d 2064  _planeNormal = d
+0001f360: 6972 6563 7469 6f6e 0d0a 2020 2020 2020  irection..      
+0001f370: 2020 6966 206e 616d 6520 6973 206e 6f74    if name is not
+0001f380: 204e 6f6e 6520 203a 2063 6f6e 4c69 6e65   None  : conLine
+0001f390: 732e 6e61 6d65 203d 206b 6172 6773 5b27  s.name = kargs['
+0001f3a0: 6e61 6d65 275d 0d0a 2020 2020 2020 2020  name']..        
+0001f3b0: 6966 2063 6f6c 6f72 2069 7320 6e6f 7420  if color is not 
+0001f3c0: 4e6f 6e65 203a 2063 6f6e 4c69 6e65 732e  None : conLines.
+0001f3d0: 7365 745f 636f 6c6f 7228 6b61 7267 735b  set_color(kargs[
+0001f3e0: 2763 6f6c 6f72 275d 290d 0a20 2020 2020  'color'])..     
+0001f3f0: 2020 2072 6574 7572 6e20 636f 6e4c 696e     return conLin
+0001f400: 6573 0d0a 0d0a 2020 2020 6465 6620 636f  es....    def co
+0001f410: 6e74 6f75 724c 696e 6553 6574 2873 656c  ntourLineSet(sel
+0001f420: 662c 6e75 6d62 3d32 2c2a 2a6b 6172 6773  f,numb=2,**kargs
+0001f430: 2920 3a0d 0a20 2020 2020 2020 2022 2222  ) :..        """
+0001f440: 0d0a 2020 2020 2020 2020 436f 6c6f 724c  ..        ColorL
+0001f450: 696e 6533 4443 6f6c 6c65 6374 696f 6e20  ine3DCollection 
+0001f460: 6f66 2065 7665 6e6c 7920 7370 6163 6564  of evenly spaced
+0001f470: 2063 6f6e 746f 7572 206c 696e 6573 206f   contour lines o
+0001f480: 6e20 7468 6520 7375 7266 6163 652e 0d0a  n the surface...
+0001f490: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
+0001f4a0: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
+0001f4b0: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
+0001f4c0: 2020 6e75 6d62 203a 2069 6e74 6567 6572    numb : integer
+0001f4d0: 0d0a 2020 2020 2020 2020 2020 2020 4e75  ..            Nu
+0001f4e0: 6d62 6572 206f 6620 636f 6e74 6f75 7220  mber of contour 
+0001f4f0: 6c69 6e65 7320 696e 7465 7273 6563 7469  lines intersecti
+0001f500: 6e67 2061 2073 7572 6661 6365 2e0d 0a20  ng a surface... 
+0001f510: 2020 2020 2020 2020 2020 204e 756d 6220             Numb 
+0001f520: 7661 6c75 6520 6d75 7374 2062 6520 6765  value must be ge
+0001f530: 7474 6572 2074 6861 6e20 7a65 726f 2e20  tter than zero. 
+0001f540: 2020 2020 0d0a 2020 2020 2020 2020 0d0a      ..        ..
+0001f550: 2020 2020 2020 2020 6469 7265 6374 696f          directio
+0001f560: 6e20 3a20 6172 7261 792d 6c69 6b65 2c20  n : array-like, 
+0001f570: 6f70 7469 6f6e 616c 2c20 6465 6661 756c  optional, defaul
+0001f580: 743a 205b 302c 302c 315d 0d0a 2020 2020  t: [0,0,1]..    
+0001f590: 2020 2020 2020 2020 4120 7879 7a20 7665          A xyz ve
+0001f5a0: 6374 6f72 206e 6f72 6d61 6c20 746f 2074  ctor normal to t
+0001f5b0: 6865 2069 6e74 6572 7365 6374 696f 6e20  he intersection 
+0001f5c0: 706c 616e 6573 0d0a 2020 2020 2020 2020  planes..        
+0001f5d0: 2020 2020 666f 7220 706c 616e 6172 2063      for planar c
+0001f5e0: 6f6e 746f 7572 7320 6f72 2061 7869 616c  ontours or axial
+0001f5f0: 2064 6972 6563 7469 6f6e 206f 660d 0a20   direction of.. 
+0001f600: 2020 2020 2020 2020 2020 2063 796c 696e             cylin
+0001f610: 6465 7273 2066 6f72 2063 796c 696e 6472  ders for cylindr
+0001f620: 6963 616c 2063 6f6e 746f 7572 732e 0d0a  ical contours...
+0001f630: 0d0a 2020 2020 2020 2020 6e61 6d65 2020  ..        name  
+0001f640: 3a20 7374 7269 6e67 2069 6465 6e74 6966  : string identif
+0001f650: 6965 7220 2864 6566 6175 6c74 204e 6f6e  ier (default Non
+0001f660: 6529 0d0a 0d0a 2020 2020 2020 2020 636f  e)....        co
+0001f670: 6c6f 7220 3a20 636f 6c6f 7220 2864 6566  lor : color (def
+0001f680: 6175 6c74 2069 7320 7468 6520 7375 7266  ault is the surf
+0001f690: 6163 6520 636f 6c6f 7273 290d 0a0d 0a20  ace colors).... 
+0001f6a0: 2020 2020 2020 2063 6f6f 7220 3a20 696e         coor : in
+0001f6b0: 7465 6765 7220 6f72 2073 7472 696e 6720  teger or string 
+0001f6c0: 696e 6469 6361 7469 6e67 2074 6865 2074  indicating the t
+0001f6d0: 7970 6520 6f66 2063 6f6e 746f 7572 2073  ype of contour s
+0001f6e0: 7572 6661 6365 3a0d 0a20 2020 2020 2020  urface:..       
+0001f6f0: 2020 2020 2030 2c20 702c 2050 2c20 7879       0, p, P, xy
+0001f700: 7a2c 706c 616e 6172 2020 2020 2020 2020  z,planar        
+0001f710: 2020 2020 2020 2020 202d 2070 6c61 6e61           - plana
+0001f720: 7220 2864 6566 6175 6c74 2c20 706c 616e  r (default, plan
+0001f730: 6172 2026 2070 6f6c 6172 290d 0a20 2020  ar & polar)..   
+0001f740: 2020 2020 2020 2020 2031 2c20 632c 2043           1, c, C
+0001f750: 2c20 6379 6c69 6e64 6572 2c70 706c 6172  , cylinder,pplar
+0001f760: 2c63 796c 696e 6472 6963 616c 202d 2063  ,cylindrical - c
+0001f770: 796c 696e 6465 7220 2864 6566 6175 6c74  ylinder (default
+0001f780: 2c20 6379 6c69 6e64 7269 6361 6c29 0d0a  , cylindrical)..
+0001f790: 2020 2020 2020 2020 2020 2020 322c 2073              2, s
+0001f7a0: 2c20 532c 2073 7068 6572 652c 7370 6865  , S, sphere,sphe
+0001f7b0: 7269 6361 6c20 2020 2020 2020 2020 2020  rical           
+0001f7c0: 2d20 7370 6865 7265 2028 6465 6661 756c  - sphere (defaul
+0001f7d0: 742c 2073 7068 6572 6963 616c 290d 0a20  t, spherical).. 
+0001f7e0: 2020 2020 2020 2020 2020 2033 2c20 782c             3, x,
+0001f7f0: 2058 2020 2020 2020 2020 2020 2020 2020   X              
+0001f800: 2020 2020 2020 2020 2020 2020 2020 202d                 -
+0001f810: 2079 2d7a 2070 6c61 6e65 0d0a 2020 2020   y-z plane..    
+0001f820: 2020 2020 2020 2020 342c 2079 2c20 5920          4, y, Y 
+0001f830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f840: 2020 2020 2020 2020 2020 2020 2d20 782d              - x-
+0001f850: 7a20 706c 616e 650d 0a20 2020 2020 2020  z plane..       
+0001f860: 2020 2020 2035 2c20 7a2c 205a 2020 2020       5, z, Z    
+0001f870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f880: 2020 2020 2020 2020 202d 2078 2d79 2070           - x-y p
+0001f890: 6c61 6e65 0d0a 0d0a 2020 2020 2020 2020  lane....        
+0001f8a0: 5265 7475 726e 730d 0a20 2020 2020 2020  Returns..       
+0001f8b0: 202d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020   -------..      
+0001f8c0: 2020 7365 6c66 203a 206c 696e 6520 6f62    self : line ob
+0001f8d0: 6a65 6374 0d0a 0d0a 2020 2020 2020 2020  ject....        
+0001f8e0: 2222 220d 0a20 2020 2020 2020 2065 7874  """..        ext
+0001f8f0: 4466 7420 3d20 7b20 2764 6972 6563 7469  Dft = { 'directi
+0001f900: 6f6e 273a 5b30 2c30 2c31 2e30 5d2c 2027  on':[0,0,1.0], '
+0001f910: 6e61 6d65 273a 204e 6f6e 652c 2027 636f  name': None, 'co
+0001f920: 6c6f 7227 3a20 4e6f 6e65 207d 0d0a 2020  lor': None }..  
+0001f930: 2020 2020 2020 6b61 7267 4466 7420 3d20        kargDft = 
+0001f940: 7b20 2a2a 5f43 4f4f 525f 4b57 4152 4753  { **_COOR_KWARGS
+0001f950: 2c20 2a2a 6578 7444 6674 207d 0d0a 2020  , **extDft }..  
+0001f960: 2020 2020 2020 2320 7265 7365 7420 6465        # reset de
+0001f970: 6661 756c 7420 2763 6f6f 7227 2066 6f72  fault 'coor' for
+0001f980: 2063 796c 696e 6472 6963 616c 2061 6e64   cylindrical and
+0001f990: 2073 7068 6572 6963 616c 2063 6f6f 7220   spherical coor 
+0001f9a0: 7375 7266 6163 6573 2e0d 0a20 2020 2020  surfaces...     
+0001f9b0: 2020 2063 6f6f 7256 616c 203d 2030 0d0a     coorVal = 0..
+0001f9c0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+0001f9d0: 636f 6f72 5479 7065 203d 3d20 5f43 4f4f  coorType == _COO
+0001f9e0: 5253 5953 5b22 4359 4c49 4e44 5249 4341  RSYS["CYLINDRICA
+0001f9f0: 4c22 5d20 3a20 636f 6f72 5661 6c20 3d20  L"] : coorVal = 
+0001fa00: 310d 0a20 2020 2020 2020 2069 6620 7365  1..        if se
+0001fa10: 6c66 2e63 6f6f 7254 7970 6520 3d3d 205f  lf.coorType == _
+0001fa20: 434f 4f52 5359 535b 2253 5048 4552 4943  COORSYS["SPHERIC
+0001fa30: 414c 225d 203a 2020 2063 6f6f 7256 616c  AL"] :   coorVal
+0001fa40: 203d 2032 0d0a 2020 2020 2020 2020 6966   = 2..        if
+0001fa50: 2063 6f6f 7256 616c 2021 3d20 3020 3a0d   coorVal != 0 :.
+0001fa60: 0a20 2020 2020 2020 2020 2020 2074 656d  .            tem
+0001fa70: 7020 3d20 636f 7079 2e64 6565 7063 6f70  p = copy.deepcop
+0001fa80: 7928 5f43 4f4f 525f 4b57 4152 4753 290d  y(_COOR_KWARGS).
+0001fa90: 0a20 2020 2020 2020 2020 2020 2074 656d  .            tem
+0001faa0: 705b 2763 6f6f 7227 5d5b 305d 203d 205b  p['coor'][0] = [
+0001fab0: 636f 6f72 5661 6c5d 0d0a 2020 2020 2020  coorVal]..      
+0001fac0: 2020 2020 2020 6b61 7267 4466 7420 3d20        kargDft = 
+0001fad0: 7b20 2a2a 7465 6d70 2c20 2a2a 6578 7444  { **temp, **extD
+0001fae0: 6674 207d 0d0a 2020 2020 2020 2020 0d0a  ft }..        ..
+0001faf0: 2020 2020 2020 2020 4b57 203d 204b 5770          KW = KWp
+0001fb00: 726f 6365 7373 6f72 286b 6172 6744 6674  rocessor(kargDft
+0001fb10: 2c27 636f 6e74 6f75 724c 696e 6553 6574  ,'contourLineSet
+0001fb20: 272c 2a2a 6b61 7267 7329 0d0a 2020 2020  ',**kargs)..    
+0001fb30: 2020 2020 6349 6e64 6578 203d 204b 572e      cIndex = KW.
+0001fb40: 6765 7456 616c 2827 636f 6f72 2729 0d0a  getVal('coor')..
+0001fb50: 2020 2020 2020 2020 6469 7265 6374 696f          directio
+0001fb60: 6e20 3d20 4b57 2e67 6574 5661 6c28 2764  n = KW.getVal('d
+0001fb70: 6972 6563 7469 6f6e 2729 0d0a 2020 2020  irection')..    
+0001fb80: 2020 2020 6e61 6d65 203d 204b 572e 6765      name = KW.ge
+0001fb90: 7456 616c 2827 6e61 6d65 2729 0d0a 2020  tVal('name')..  
+0001fba0: 2020 2020 2020 636f 6c6f 7220 3d20 4b57        color = KW
+0001fbb0: 2e67 6574 5661 6c28 2763 6f6c 6f72 2729  .getVal('color')
+0001fbc0: 0d0a 0d0a 2020 2020 2020 2020 646f 7470  ....        dotp
+0001fbd0: 726f 6420 3d20 5f63 6f6f 725f 646f 7470  rod = _coor_dotp
+0001fbe0: 726f 6428 6469 7265 6374 696f 6e2c 6349  rod(direction,cI
+0001fbf0: 6e64 6578 2c73 656c 662e 7665 7274 6578  ndex,self.vertex
+0001fc00: 436f 6f72 2920 200d 0a20 2020 2020 2020  Coor)  ..       
+0001fc10: 206d 6178 6420 3d20 6e70 2e61 6d61 7828   maxd = np.amax(
+0001fc20: 646f 7470 726f 6429 0d0a 2020 2020 2020  dotprod)..      
+0001fc30: 2020 6d69 6e64 203d 206e 702e 616d 696e    mind = np.amin
+0001fc40: 2864 6f74 7072 6f64 290d 0a20 2020 2020  (dotprod)..     
+0001fc50: 2020 2063 6f6e 7661 6c73 203d 206e 702e     convals = np.
+0001fc60: 6c69 6e73 7061 6365 286d 696e 642c 6d61  linspace(mind,ma
+0001fc70: 7864 2c6e 756d 622b 3229 5b31 3a6e 756d  xd,numb+2)[1:num
+0001fc80: 622b 315d 0d0a 2020 2020 2020 2020 636f  b+1]..        co
+0001fc90: 6e76 616c 7320 3d20 7475 706c 6528 636f  nvals = tuple(co
+0001fca0: 6e76 616c 7329 200d 0a20 2020 2020 2020  nvals) ..       
+0001fcb0: 2063 6f6e 4c69 6e65 7320 3d20 7365 6c66   conLines = self
+0001fcc0: 2e5f 636f 6e74 6f75 724c 696e 6543 6f6c  ._contourLineCol
+0001fcd0: 6c65 6374 696f 6e28 2064 6f74 7072 6f64  lection( dotprod
+0001fce0: 2c64 6972 6563 7469 6f6e 2c63 6f6e 7661  ,direction,conva
+0001fcf0: 6c73 2029 0d0a 2020 2020 2020 2020 6966  ls )..        if
+0001fd00: 2063 496e 6465 7820 3d3d 2030 203a 2063   cIndex == 0 : c
+0001fd10: 6f6e 4c69 6e65 732e 5f70 6c61 6e65 4e6f  onLines._planeNo
+0001fd20: 726d 616c 203d 2064 6972 6563 7469 6f6e  rmal = direction
+0001fd30: 0d0a 2020 2020 2020 2020 6966 206e 616d  ..        if nam
+0001fd40: 6520 6973 206e 6f74 204e 6f6e 6520 203a  e is not None  :
+0001fd50: 2063 6f6e 4c69 6e65 732e 6e61 6d65 203d   conLines.name =
+0001fd60: 206b 6172 6773 5b27 6e61 6d65 275d 0d0a   kargs['name']..
+0001fd70: 2020 2020 2020 2020 6966 2063 6f6c 6f72          if color
+0001fd80: 2069 7320 6e6f 7420 4e6f 6e65 203a 2063   is not None : c
+0001fd90: 6f6e 4c69 6e65 732e 7365 745f 636f 6c6f  onLines.set_colo
+0001fda0: 7228 6b61 7267 735b 2763 6f6c 6f72 275d  r(kargs['color']
+0001fdb0: 290d 0a20 2020 2020 2020 200d 0a20 2020  )..        ..   
+0001fdc0: 2020 2020 2072 6574 7572 6e20 636f 6e4c       return conL
+0001fdd0: 696e 6573 0d0a 0d0a 2020 2020 6465 6620  ines....    def 
+0001fde0: 6576 6572 7428 7365 6c66 2920 3a0d 0a20  evert(self) :.. 
+0001fdf0: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
+0001fe00: 2020 2020 5265 7665 7273 6520 6469 7265      Reverse dire
+0001fe10: 6374 696f 6e20 6f66 2066 6163 6520 6e6f  ction of face no
+0001fe20: 726d 616c 732e 0d0a 2020 2020 2020 2020  rmals...        
+0001fe30: 2222 220d 0a20 2020 2020 2020 2073 656c  """..        sel
+0001fe40: 662e 6676 496e 6469 6365 7320 3d20 6e70  f.fvIndices = np
+0001fe50: 2e66 6c69 7028 7365 6c66 2e66 7649 6e64  .flip(self.fvInd
+0001fe60: 6963 6573 2c20 6178 6973 3d31 290d 0a20  ices, axis=1).. 
+0001fe70: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0001fe80: 6c66 0d0a 0d0a 2020 2020 6465 6620 646f  lf....    def do
+0001fe90: 6d61 696e 2873 656c 662c 2078 6c69 6d3d  main(self, xlim=
+0001fea0: 4e6f 6e65 2c20 796c 696d 3d4e 6f6e 652c  None, ylim=None,
+0001feb0: 207a 6c69 6d3d 4e6f 6e65 2920 3a0d 0a20   zlim=None) :.. 
+0001fec0: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
+0001fed0: 2020 2020 5365 7420 7468 6520 646f 6d61      Set the doma
+0001fee0: 696e 206f 6620 7468 6520 7375 7266 6163  in of the surfac
+0001fef0: 652e 0d0a 0d0a 2020 2020 2020 2020 5573  e.....        Us
+0001ff00: 6564 2066 6f72 2073 6574 7469 6e67 2074  ed for setting t
+0001ff10: 6865 2064 6f6d 6169 6e20 6f66 2074 6865  he domain of the
+0001ff20: 2062 6173 652e 0d0a 0d0a 2020 2020 2020   base.....      
+0001ff30: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
+0001ff40: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+0001ff50: 0d0a 2020 2020 2020 2020 786c 696d 2c20  ..        xlim, 
+0001ff60: 796c 696d 2c20 7a6c 696d 203a 2032 6420  ylim, zlim : 2d 
+0001ff70: 6172 7261 7973 0d0a 2020 2020 2020 2020  arrays..        
+0001ff80: 2020 2020 4d69 6e69 6d75 6d20 616e 6420      Minimum and 
+0001ff90: 6d61 7869 6d75 6d20 7661 6c75 6573 206f  maximum values o
+0001ffa0: 6620 7468 6520 6172 7261 7973 2061 7265  f the arrays are
+0001ffb0: 2075 7365 6420 746f 2073 6361 6c65 0d0a   used to scale..
+0001ffc0: 2020 2020 2020 2020 2020 2020 616e 6420              and 
+0001ffd0: 7472 616e 736c 6174 6520 7468 6520 7375  translate the su
+0001ffe0: 7266 6163 6520 6672 6f6d 2061 6e20 696e  rface from an in
+0001fff0: 7469 616c 2064 6f6d 6169 6e73 206f 660d  tial domains of.
+00020000: 0a20 2020 2020 2020 2020 2020 205b 202d  .            [ -
+00020010: 312c 2031 205d 0d0a 2020 2020 2020 2020  1, 1 ]..        
+00020020: 2020 2020 4966 2073 6574 2074 6f20 4e6f      If set to No
+00020030: 6e65 2c20 7468 6520 646f 6d61 696e 7320  ne, the domains 
+00020040: 6172 6520 756e 6368 616e 6765 642e 0d0a  are unchanged...
+00020050: 0d0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+00020060: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+00020070: 2d2d 0d0a 2020 2020 2020 2020 7365 6c66  --..        self
+00020080: 203a 2073 7572 6661 6365 206f 626a 6563   : surface objec
+00020090: 740d 0a0d 0a20 2020 2020 2020 2022 2222  t....        """
+000200a0: 0d0a 2020 2020 2020 2020 6465 6620 7365  ..        def se
+000200b0: 7444 6f6d 6169 6e28 7879 7a2c 206d 782c  tDomain(xyz, mx,
+000200c0: 6278 2c20 6d79 2c62 792c 206d 7a2c 627a  bx, my,by, mz,bz
+000200d0: 2920 3a0d 0a20 2020 2020 2020 2020 2020  ) :..           
+000200e0: 2078 2c79 2c7a 203d 2078 797a 0d0a 2020   x,y,z = xyz..  
+000200f0: 2020 2020 2020 2020 2020 5820 3d20 6d78            X = mx
+00020100: 2a78 202b 2062 780d 0a20 2020 2020 2020  *x + bx..       
+00020110: 2020 2020 2059 203d 206d 792a 7920 2b20       Y = my*y + 
+00020120: 6279 0d0a 2020 2020 2020 2020 2020 2020  by..            
+00020130: 5a20 3d20 6d7a 2a7a 202b 2062 7a0d 0a20  Z = mz*z + bz.. 
+00020140: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00020150: 6e20 582c 592c 5a20 2020 2020 2020 0d0a  n X,Y,Z       ..
+00020160: 2020 2020 2020 2020 6465 6620 6765 7443          def getC
+00020170: 6f6e 7428 206c 696d 7320 2920 3a0d 0a20  ont( lims ) :.. 
+00020180: 2020 2020 2020 2020 2020 206d 2c20 6220             m, b 
+00020190: 3d20 312e 302c 2030 2e30 0d0a 2020 2020  = 1.0, 0.0..    
+000201a0: 2020 2020 2020 2020 6966 206c 696d 7320          if lims 
+000201b0: 6973 206e 6f74 204e 6f6e 6520 3a0d 0a20  is not None :.. 
+000201c0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+000201d0: 2061 6c6c 6f77 2073 696e 676c 6520 626e   allow single bn
+000201e0: 6472 7920 746f 2062 6520 696e 7075 7420  dry to be input 
+000201f0: 6173 2061 2066 6c6f 6174 0d0a 2020 2020  as a float..    
+00020200: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+00020210: 7369 6e73 7461 6e63 6528 6c69 6d73 2c20  sinstance(lims, 
+00020220: 2869 6e74 2c66 6c6f 6174 2929 203a 206c  (int,float)) : l
+00020230: 696d 7320 3d20 5b2d 6c69 6d73 2c6c 696d  ims = [-lims,lim
+00020240: 735d 0d0a 2020 2020 2020 2020 2020 2020  s]..            
+00020250: 2020 2020 6d2c 2062 203d 2030 2e35 2a28      m, b = 0.5*(
+00020260: 6c69 6d73 5b31 5d2d 6c69 6d73 5b30 5d29  lims[1]-lims[0])
+00020270: 202c 2030 2e35 2a28 6c69 6d73 5b31 5d2b   , 0.5*(lims[1]+
+00020280: 6c69 6d73 5b30 5d29 0d0a 2020 2020 2020  lims[0])..      
+00020290: 2020 2020 2020 7265 7475 726e 206d 2c20        return m, 
+000202a0: 620d 0a20 2020 2020 2020 206d 782c 2062  b..        mx, b
+000202b0: 7820 3d20 6765 7443 6f6e 7428 786c 696d  x = getCont(xlim
+000202c0: 290d 0a20 2020 2020 2020 206d 792c 2062  )..        my, b
+000202d0: 7920 3d20 6765 7443 6f6e 7428 796c 696d  y = getCont(ylim
+000202e0: 290d 0a20 2020 2020 2020 206d 7a2c 2062  )..        mz, b
+000202f0: 7a20 3d20 6765 7443 6f6e 7428 7a6c 696d  z = getCont(zlim
+00020300: 290d 0a20 2020 2020 2020 2073 656c 662e  )..        self.
+00020310: 5f6d 6170 5f67 656f 6d5f 6672 6f6d 5f6f  _map_geom_from_o
+00020320: 7028 6c61 6d62 6461 2041 203a 2073 6574  p(lambda A : set
+00020330: 446f 6d61 696e 2841 2c20 6d78 2c62 782c  Domain(A, mx,bx,
+00020340: 206d 792c 6279 2c20 6d7a 2c62 7a29 2c46   my,by, mz,bz),F
+00020350: 616c 7365 2c4e 6f6e 652c 4661 6c73 6529  alse,None,False)
+00020360: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00020370: 2073 656c 660d 0a0d 0a0d 0a63 6c61 7373   self......class
+00020380: 2043 7562 6963 5375 7266 6163 6528 5375   CubicSurface(Su
+00020390: 7266 6163 6533 4443 6f6c 6c65 6374 696f  rface3DCollectio
+000203a0: 6e29 203a 0d0a 2020 2020 2222 220d 0a20  n) :..    """.. 
+000203b0: 2020 2043 7562 6963 2033 4420 7375 7266     Cubic 3D surf
+000203c0: 6163 6520 696e 2043 6172 7465 7369 616e  ace in Cartesian
+000203d0: 2063 6f6f 7264 696e 6174 6573 2077 6974   coordinates wit
+000203e0: 6820 7265 6374 616e 6775 6c61 7220 6661  h rectangular fa
+000203f0: 6365 732e 0d0a 0d0a 2020 2020 4d65 7468  ces.....    Meth
+00020400: 6f64 7320 6172 6520 696e 6865 7269 7465  ods are inherite
+00020410: 6420 6672 6f6d 2074 6865 2053 7572 6661  d from the Surfa
+00020420: 6365 3344 436f 6c6c 6563 7469 6f6e 2e0d  ce3DCollection..
+00020430: 0a0d 0a20 2020 2022 2222 0d0a 2020 2020  ...    """..    
+00020440: 0d0a 2020 2020 4073 7461 7469 636d 6574  ..    @staticmet
+00020450: 686f 6420 0d0a 2020 2020 6465 6620 5f67  hod ..    def _g
+00020460: 6574 5f63 7562 6963 5f73 7572 6661 6365  et_cubic_surface
+00020470: 5f64 6963 7469 6f6e 6172 7928 2920 3a0d  _dictionary() :.
+00020480: 0a20 2020 2020 2020 2022 2222 2043 6f6e  .        """ Con
+00020490: 7374 7275 6374 7320 7468 6520 6469 6374  structs the dict
+000204a0: 696f 6e61 7279 206f 6620 6261 7365 2070  ionary of base p
+000204b0: 6c61 6e61 7220 7375 7266 6163 6520 6765  lanar surface ge
+000204c0: 6f6d 6574 7269 6573 2e20 2222 220d 0a0d  ometries. """...
+000204d0: 0a20 2020 2020 2020 2073 7572 6661 6365  .        surface
+000204e0: 7344 6963 7469 6f6e 6172 7920 3d20 7b7d  sDictionary = {}
+000204f0: 0d0a 2020 2020 2020 2020 6261 7365 5665  ..        baseVe
+00020500: 7274 203d 205b 5d0d 0a0d 0a20 2020 2020  rt = []....     
+00020510: 2020 2062 6173 6556 6572 7420 3d20 5b20     baseVert = [ 
+00020520: 5b20 312c 2d31 2c20 2d31 5d2c 205b 2031  [ 1,-1, -1], [ 1
+00020530: 2c20 312c 202d 315d 2c20 5b2d 312c 2031  , 1, -1], [-1, 1
+00020540: 2c20 2d31 5d2c 205b 2d31 2c2d 312c 202d  , -1], [-1,-1, -
+00020550: 315d 2c0d 0a20 2020 2020 2020 2020 2020  1],..           
+00020560: 2020 2020 2020 2020 2020 5b20 312c 2d31            [ 1,-1
+00020570: 2c20 2031 5d2c 205b 2031 2c20 312c 2020  ,  1], [ 1, 1,  
+00020580: 315d 2c20 5b2d 312c 2031 2c20 2031 5d2c  1], [-1, 1,  1],
+00020590: 205b 2d31 2c2d 312c 2020 315d 205d 0d0a   [-1,-1,  1] ]..
+000205a0: 0d0a 2020 2020 2020 2020 6375 6265 4661  ..        cubeFa
+000205b0: 6365 733d 280d 0a20 2020 2020 2020 2020  ces=(..         
+000205c0: 2020 205b 302c 312c 352c 345d 2c20 5b31     [0,1,5,4], [1
+000205d0: 2c32 2c36 2c35 5d2c 205b 322c 332c 372c  ,2,6,5], [2,3,7,
+000205e0: 365d 2c20 5b33 2c30 2c34 2c37 5d2c 0d0a  6], [3,0,4,7],..
+000205f0: 2020 2020 2020 2020 2020 2020 5b34 2c35              [4,5
+00020600: 2c36 2c37 5d2c 205b 302c 332c 322c 315d  ,6,7], [0,3,2,1]
+00020610: 0d0a 2020 2020 2020 2020 290d 0a0d 0a20  ..        ).... 
+00020620: 2020 2020 2020 2046 6320 3d20 6c65 6e28         Fc = len(
+00020630: 6375 6265 4661 6365 7329 0d0a 0d0a 2020  cubeFaces)....  
+00020640: 2020 2020 2020 6375 6265 203d 2020 7b20        cube =  { 
+00020650: 2762 6173 6546 6163 6549 6e64 6963 6573  'baseFaceIndices
+00020660: 2720 3a20 6375 6265 4661 6365 7320 2c20  ' : cubeFaces , 
+00020670: 2762 6173 6556 6572 7469 6365 7343 6f6f  'baseVerticesCoo
+00020680: 7227 203a 2062 6173 6556 6572 742c 2027  r' : baseVert, '
+00020690: 6665 7650 6172 616d 2720 3a20 5b46 632c  fevParam' : [Fc,
+000206a0: 302c 325d 207d 0d0a 2020 2020 2020 2020  0,2] }..        
+000206b0: 7375 7266 6163 6573 4469 6374 696f 6e61  surfacesDictiona
+000206c0: 7279 5b27 6375 6269 6327 5d20 3d20 6375  ry['cubic'] = cu
+000206d0: 6265 0d0a 0d0a 2020 2020 2020 2020 7265  be....        re
+000206e0: 7475 726e 2073 7572 6661 6365 7344 6963  turn surfacesDic
+000206f0: 7469 6f6e 6172 790d 0a0d 0a20 2020 205f  tionary....    _
+00020700: 6261 7365 5f73 7572 6661 6365 7320 3d20  base_surfaces = 
+00020710: 5f67 6574 5f63 7562 6963 5f73 7572 6661  _get_cubic_surfa
+00020720: 6365 5f64 6963 7469 6f6e 6172 792e 5f5f  ce_dictionary.__
+00020730: 6675 6e63 5f5f 2829 0d0a 2020 2020 5f64  func__()..    _d
+00020740: 6566 6175 6c74 5f62 6173 6520 3d20 2763  efault_base = 'c
+00020750: 7562 6963 2720 2023 2064 6566 6175 6c74  ubic'  # default
+00020760: 2061 7373 6967 6e6d 656e 7420 6973 2069   assignment is i
+00020770: 6e64 6963 6174 6564 2069 6e20 5f5f 696e  ndicated in __in
+00020780: 6974 2044 6f63 7374 7269 6e67 2e0d 0a0d  it Docstring....
+00020790: 0a20 2020 2040 636c 6173 736d 6574 686f  .    @classmetho
+000207a0: 640d 0a20 2020 2064 6566 205f 5866 6576  d..    def _Xfev
+000207b0: 2863 6c73 2c72 657a 2c20 6261 7365 7479  (cls,rez, basety
+000207c0: 7065 3d4e 6f6e 6529 203a 0d0a 2020 2020  pe=None) :..    
+000207d0: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
+000207e0: 2043 616c 6375 6c61 7465 7320 7468 6520   Calculates the 
+000207f0: 6e75 6d62 6572 206f 6620 6661 6365 732c  number of faces,
+00020800: 2065 6467 6573 2c20 616e 6420 7665 7274   edges, and vert
+00020810: 6963 6573 206f 6620 6120 4375 6269 6353  ices of a CubicS
+00020820: 7572 6661 6365 2e0d 0a0d 0a20 2020 2020  urface.....     
+00020830: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
+00020840: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00020850: 2d0d 0a20 2020 2020 2020 2072 657a 203a  -..        rez :
+00020860: 2069 6e74 6567 6572 0d0a 2020 2020 2020   integer..      
+00020870: 2020 2020 2020 4e75 6d62 6572 206f 6620        Number of 
+00020880: 7265 6375 7273 6976 6520 7375 6264 6976  recursive subdiv
+00020890: 6973 696f 6e73 206f 6620 6120 7472 6961  isions of a tria
+000208a0: 6e67 756c 6174 6564 2062 6173 6520 6661  ngulated base fa
+000208b0: 6365 732e 0d0a 2020 2020 2020 2020 0d0a  ces...        ..
+000208c0: 2020 2020 2020 2020 6261 7365 7479 7065          basetype
+000208d0: 203a 204e 6f6e 650d 0a20 2020 2020 2020   : None..       
+000208e0: 2020 2020 2050 6c61 6365 686f 6c64 6572       Placeholder
+000208f0: 2061 7267 756d 656e 7420 6861 7320 6e6f   argument has no
+00020900: 2065 6666 6563 742e 0d0a 2020 2020 2020   effect...      
+00020910: 2020 0d0a 2020 2020 2020 2020 5265 7475    ..        Retu
+00020920: 726e 730d 0a20 2020 2020 2020 202d 2d2d  rns..        ---
+00020930: 2d2d 2d2d 0d0a 2020 2020 2020 2020 6c69  ----..        li
+00020940: 7374 3a20 7468 6520 6e75 6d62 6572 206f  st: the number o
+00020950: 6620 6661 6365 732c 2065 6467 6573 2c20  f faces, edges, 
+00020960: 616e 6420 7665 7274 6963 6573 2e0d 0a0d  and vertices....
+00020970: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
+00020980: 2020 2020 2020 4620 3d20 362a 2834 2a2a        F = 6*(4**
+00020990: 7265 7a29 200d 0a20 2020 2020 2020 2072  rez) ..        r
+000209a0: 6574 7572 6e20 5b20 2046 2c20 322a 462c  eturn [  F, 2*F,
+000209b0: 2046 2b32 2020 5d0d 0a0d 0a20 2020 2064   F+2  ]....    d
+000209c0: 6566 205f 5f69 6e69 745f 5f28 7365 6c66  ef __init__(self
+000209d0: 2c20 7265 7a3d 302c 206e 616d 653d 4e6f  , rez=0, name=No
+000209e0: 6e65 2c20 2a2a 6b77 6172 6773 293a 0d0a  ne, **kwargs):..
+000209f0: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
+00020a00: 2020 2020 2043 7265 6174 6520 6120 6375       Create a cu
+00020a10: 6269 6320 7375 7266 6163 6520 6f66 2032  bic surface of 2
+00020a20: 2078 2032 2078 2032 2075 6e69 7473 2e0d   x 2 x 2 units..
+00020a30: 0a0d 0a20 2020 2020 2020 2050 6172 616d  ...        Param
+00020a40: 6574 6572 730d 0a20 2020 2020 2020 202d  eters..        -
+00020a50: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
+00020a60: 2020 2072 657a 203a 2069 6e74 6567 6572     rez : integer
+00020a70: 2c20 6f70 7469 6f6e 616c 2c20 6465 6661  , optional, defa
+00020a80: 756c 743a 2030 0d0a 2020 2020 2020 2020  ult: 0..        
+00020a90: 2020 2020 4e75 6d62 6572 206f 6620 7265      Number of re
+00020aa0: 6375 7273 6976 6520 7375 6264 6976 6973  cursive subdivis
+00020ab0: 696f 6e73 206f 6620 7468 6520 7265 6374  ions of the rect
+00020ac0: 616e 6775 6c61 7465 6420 6261 7365 2066  angulated base f
+00020ad0: 6163 6573 2e0d 0a20 2020 2020 2020 2020  aces...         
+00020ae0: 2020 2052 657a 2076 616c 7565 7320 7261     Rez values ra
+00020af0: 6e67 6520 6672 6f6d 2030 2074 6f20 372e  nge from 0 to 7.
+00020b00: 0d0a 0d0a 2020 2020 2020 2020 6e61 6d65  ....        name
+00020b10: 203a 2073 7472 696e 672c 206f 7074 696f   : string, optio
+00020b20: 6e61 6c2c 2064 6566 6175 6c74 3a20 4e6f  nal, default: No
+00020b30: 6e65 2e0d 0a20 2020 2020 2020 2020 2020  ne...           
+00020b40: 2044 6573 6372 6970 7469 7665 2069 6465   Descriptive ide
+00020b50: 6e74 6966 6965 7220 666f 7220 7468 6520  ntifier for the 
+00020b60: 6765 6f6d 6574 7279 2e0d 0a20 2020 2020  geometry...     
+00020b70: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00020b80: 2052 6169 7365 730d 0a20 2020 2020 2020   Raises..       
+00020b90: 202d 2d2d 2d2d 2d0d 0a20 2020 2020 2020   ------..       
+00020ba0: 2056 616c 7565 4572 726f 720d 0a20 2020   ValueError..   
+00020bb0: 2020 2020 2020 2020 2049 6620 7265 7a20           If rez 
+00020bc0: 6973 206e 6f74 2061 6e20 696e 7465 6765  is not an intege
+00020bd0: 7220 696e 2072 616e 6765 2030 2074 6f20  r in range 0 to 
+00020be0: 372e 0d0a 0d0a 2020 2020 2020 2020 4f74  7.....        Ot
+00020bf0: 6865 7220 5061 7261 6d65 7465 7273 0d0a  her Parameters..
+00020c00: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00020c10: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
+00020c20: 2020 2a2a 6b77 6172 6773 0d0a 2020 2020    **kwargs..    
+00020c30: 2020 2020 2020 2020 416c 6c20 6f74 6865          All othe
+00020c40: 7220 7061 7261 6d65 7465 7273 2061 7265  r parameters are
+00020c50: 2070 6173 7365 6420 6f6e 2074 6f20 2773   passed on to 's
+00020c60: 3364 6c69 622e 7375 7266 6163 652e 5375  3dlib.surface.Su
+00020c70: 7266 6163 6533 4443 6f6c 6c65 6374 696f  rface3DCollectio
+00020c80: 6e27 2e0d 0a0d 0a20 2020 2020 2020 2022  n'.....        "
+00020c90: 2222 0d0a 2020 2020 2020 2020 2320 2e2e  ""..        # ..
+00020ca0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00020cb0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00020cc0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00020cd0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 0d0a  ................
+00020ce0: 2020 2020 2020 2020 6465 6620 6d69 6456          def midV
+00020cf0: 4675 6e28 7665 6374 412c 2076 6563 7442  Fun(vectA, vectB
+00020d00: 2920 3a0d 0a20 2020 2020 2020 2020 2020  ) :..           
+00020d10: 2022 2222 4d69 642d 706f 696e 7420 6265   """Mid-point be
+00020d20: 7477 6565 6e20 7477 6f20 706f 696e 7473  tween two points
+00020d30: 2069 6e20 7468 6520 7879 2070 6c61 6e65   in the xy plane
+00020d40: 2e22 2222 0d0a 2020 2020 2020 2020 2020  ."""..          
+00020d50: 2020 6d69 6420 3d20 6e70 2e61 6464 2876    mid = np.add(v
+00020d60: 6563 7441 2c76 6563 7442 290d 0a20 2020  ectA,vectB)..   
+00020d70: 2020 2020 2020 2020 206d 6964 203d 206e           mid = n
+00020d80: 702e 6d75 6c74 6970 6c79 2830 2e35 2c6d  p.multiply(0.5,m
+00020d90: 6964 290d 0a20 2020 2020 2020 2020 2020  id)..           
+00020da0: 2072 6574 7572 6e20 6d69 640d 0a20 2020   return mid..   
+00020db0: 2020 2020 2023 202e 2e2e 2e2e 2e2e 2e2e       # .........
+00020dc0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00020dd0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00020de0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00020df0: 2e2e 2e2e 2e2e 2e0d 0a0d 0a20 2020 2020  ...........     
+00020e00: 2020 2069 6620 6e6f 7420 6973 696e 7374     if not isinst
+00020e10: 616e 6365 2872 657a 2c20 696e 7429 203a  ance(rez, int) :
+00020e20: 0d0a 2020 2020 2020 2020 2020 2020 7261  ..            ra
+00020e30: 6973 6520 5661 6c75 6545 7272 6f72 2827  ise ValueError('
+00020e40: 496e 636f 7272 6563 7420 7265 7a20 7479  Incorrect rez ty
+00020e50: 7065 2c20 6d75 7374 2062 6120 6f66 2074  pe, must ba of t
+00020e60: 7970 6520 696e 7427 290d 0a20 2020 2020  ype int')..     
+00020e70: 2020 2069 6620 2872 657a 3c30 2920 6f72     if (rez<0) or
+00020e80: 2028 7265 7a3e 5f4d 4158 5245 5a29 203a   (rez>_MAXREZ) :
+00020e90: 0d0a 2020 2020 2020 2020 2020 2020 7261  ..            ra
+00020ea0: 6973 6520 5661 6c75 6545 7272 6f72 2827  ise ValueError('
+00020eb0: 496e 636f 7272 6573 7420 7265 7a20 6f66  Incorrest rez of
+00020ec0: 207b 7d2c 206d 7573 7420 6265 2061 6e20   {}, must be an 
+00020ed0: 696e 742c 2030 203c 3d20 7265 7a20 3c3d  int, 0 <= rez <=
+00020ee0: 207b 7d27 2e66 6f72 6d61 7428 7265 7a2c   {}'.format(rez,
+00020ef0: 5f4d 4158 5245 5a29 290d 0a20 2020 2020  _MAXREZ))..     
+00020f00: 2020 2062 6173 6574 7970 6520 3d20 7365     basetype = se
+00020f10: 6c66 2e5f 6465 6661 756c 745f 6261 7365  lf._default_base
+00020f20: 0d0a 2020 2020 2020 2020 6261 7365 5375  ..        baseSu
+00020f30: 7266 4f62 6a20 3d20 7365 6c66 2e5f 6261  rfObj = self._ba
+00020f40: 7365 5f73 7572 6661 6365 735b 6261 7365  se_surfaces[base
+00020f50: 7479 7065 5d0d 0a20 2020 2020 2020 2062  type]..        b
+00020f60: 6173 6556 636f 6f72 203d 2062 6173 6553  aseVcoor = baseS
+00020f70: 7572 664f 626a 5b27 6261 7365 5665 7274  urfObj['baseVert
+00020f80: 6963 6573 436f 6f72 275d 0d0a 2020 2020  icesCoor']..    
+00020f90: 2020 2020 6261 7365 4661 6365 5665 7274      baseFaceVert
+00020fa0: 6578 496e 6469 6365 7320 3d62 6173 6553  exIndices =baseS
+00020fb0: 7572 664f 626a 5b27 6261 7365 4661 6365  urfObj['baseFace
+00020fc0: 496e 6469 6365 7327 5d0d 0a20 2020 2020  Indices']..     
+00020fd0: 2020 200d 0a20 2020 2020 2020 2069 6e64     ..        ind
+00020fe0: 6578 4f62 6a2c 7665 7274 6578 436f 6f72  exObj,vertexCoor
+00020ff0: 203d 2073 656c 662e 7265 6374 616e 6775   = self.rectangu
+00021000: 6c61 7465 4261 7365 2872 657a 2c62 6173  lateBase(rez,bas
+00021010: 6556 636f 6f72 2c62 6173 6546 6163 6556  eVcoor,baseFaceV
+00021020: 6572 7465 7849 6e64 6963 6573 2c20 6d69  ertexIndices, mi
+00021030: 6456 4675 6e29 0d0a 2020 2020 2020 2020  dVFun)..        
+00021040: 6661 6365 496e 6469 6365 7320 3d20 696e  faceIndices = in
+00021050: 6465 784f 626a 5b27 6661 6365 275d 0d0a  dexObj['face']..
+00021060: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+00021070: 2020 7375 7065 7228 292e 5f5f 696e 6974    super().__init
+00021080: 5f5f 2876 6572 7465 7843 6f6f 722c 2066  __(vertexCoor, f
+00021090: 6163 6549 6e64 6963 6573 2c20 6e61 6d65  aceIndices, name
+000210a0: 2c20 2a2a 6b77 6172 6773 290d 0a0d 0a20  , **kwargs).... 
+000210b0: 2020 2020 2020 2073 656c 662e 636f 6f72         self.coor
+000210c0: 5479 7065 203d 205f 434f 4f52 5359 535b  Type = _COORSYS[
+000210d0: 2258 595a 225d 0d0a 2020 2020 2020 2020  "XYZ"]..        
+000210e0: 7365 6c66 2e5f 6e6f 726d 616c 5f73 6361  self._normal_sca
+000210f0: 6c65 203d 205f 6e6f 726d 4c65 6e67 7468  le = _normLength
+00021100: 2820 6c65 6e28 6661 6365 496e 6469 6365  ( len(faceIndice
+00021110: 7329 2c20 302e 3631 2c20 312e 3530 2029  s), 0.61, 1.50 )
+00021120: 0d0a 2020 2020 2020 2020 7365 6c66 2e5f  ..        self._
+00021130: 7265 7a20 3d20 7265 7a0d 0a20 2020 2020  rez = rez..     
+00021140: 2020 2073 656c 662e 5f62 6173 6574 7970     self._basetyp
+00021150: 6520 3d20 6261 7365 7479 7065 0d0a 2020  e = basetype..  
+00021160: 2020 2020 2020 7265 7475 726e 0d0a 0d0a        return....
+00021170: 2020 2020 6465 6620 646f 6d61 696e 2873      def domain(s
+00021180: 656c 662c 2078 6c69 6d2c 2079 6c69 6d3d  elf, xlim, ylim=
+00021190: 4e6f 6e65 2c20 7a6c 696d 3d4e 6f6e 6529  None, zlim=None)
+000211a0: 203a 0d0a 2020 2020 2020 2020 2222 220d   :..        """.
+000211b0: 0a20 2020 2020 2020 2053 6574 2074 6865  .        Set the
+000211c0: 2064 6f6d 6169 6e20 6f66 2074 6865 2063   domain of the c
+000211d0: 7562 6963 2073 7572 6661 6365 2e0d 0a0d  ubic surface....
+000211e0: 0a20 2020 2020 2020 2055 7365 6420 666f  .        Used fo
+000211f0: 7220 7365 7474 696e 6720 7468 6520 6d69  r setting the mi
+00021200: 6e2c 6d61 7820 7661 6c75 6573 206f 6620  n,max values of 
+00021210: 7468 6520 6261 7365 2063 7562 652e 0d0a  the base cube...
+00021220: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+00021230: 2020 4e6f 7465 3a20 7468 6973 2043 7562    Note: this Cub
+00021240: 6963 5375 7266 6163 6520 6d65 7468 6f64  icSurface method
+00021250: 2075 7365 7320 616e 2061 6c74 6572 6e61   uses an alterna
+00021260: 7469 7665 206c 6973 7420 6f66 2061 7267  tive list of arg
+00021270: 756d 656e 7473 0d0a 2020 2020 2020 2020  uments..        
+00021280: 6672 6f6d 2074 6865 2062 6173 6520 636c  from the base cl
+00021290: 6173 7320 646f 6d61 696e 206d 6574 686f  ass domain metho
+000212a0: 642e 2020 5573 696e 6720 7468 6520 786c  d.  Using the xl
+000212b0: 696d 2061 7267 2061 6262 7265 7669 6174  im arg abbreviat
+000212c0: 6573 2073 6574 7469 6e67 0d0a 2020 2020  es setting..    
+000212d0: 2020 2020 6964 656e 7469 6361 6c20 646f      identical do
+000212e0: 6d61 696e 7320 666f 7220 616c 6c20 7468  mains for all th
+000212f0: 7265 6520 6178 6573 2e20 0d0a 0d0a 2020  ree axes. ....  
+00021300: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+00021310: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
+00021320: 2d2d 2d2d 0d0a 2020 2020 2020 2020 786c  ----..        xl
+00021330: 696d 203a 2061 206e 756d 6265 722c 206c  im : a number, l
+00021340: 6973 7420 6f72 2061 7272 6179 2c20 6465  ist or array, de
+00021350: 6661 756c 743a 2031 0d0a 2020 2020 2020  fault: 1..      
+00021360: 2020 2020 2020 5468 6520 646f 6d61 696e        The domain
+00021370: 206f 6620 7468 6520 6675 6e63 7469 6f6e   of the function
+00021380: 2065 7661 6c75 6174 696f 6e2e 2020 466f   evaluation.  Fo
+00021390: 7220 6120 6e75 6d62 6572 2c20 6e2c 0d0a  r a number, n,..
+000213a0: 2020 2020 2020 2020 2020 2020 7468 6520              the 
+000213b0: 782c 792c 7a20 6178 6573 2064 6f6d 6169  x,y,z axes domai
+000213c0: 6e73 2077 696c 6c20 6265 205b 2d6e 2c6e  ns will be [-n,n
+000213d0: 5d2e 2046 6f72 2061 2031 2d64 696d 656e  ]. For a 1-dimen
+000213e0: 7369 6f6e 616c 2032 2d65 6c65 6d65 6e74  sional 2-element
+000213f0: 206c 6973 742c 0d0a 2020 2020 2020 2020   list,..        
+00021400: 2020 2020 5b61 2c62 5d20 7769 6c6c 2062      [a,b] will b
+00021410: 6520 6173 7369 676e 6564 2074 6865 2064  e assigned the d
+00021420: 6f6d 6169 6e20 666f 7220 616c 6c20 3320  omain for all 3 
+00021430: 6178 6573 2e20 2055 7369 6e67 2061 206c  axes.  Using a l
+00021440: 6973 7420 6f66 206c 6973 7420 2861 7272  ist of list (arr
+00021450: 6179 292c 0d0a 2020 2020 2020 2020 2020  ay),..          
+00021460: 2020 6173 205b 205b 612c 625d 2c5b 632c    as [ [a,b],[c,
+00021470: 645d 2c5b 652c 665d 205d 2c20 7468 6520  d],[e,f] ], the 
+00021480: 646f 6d61 696e 2069 7320 6173 7369 676e  domain is assign
+00021490: 6564 2069 6e64 6976 6964 7561 6c6c 7920  ed individually 
+000214a0: 666f 7220 6561 6368 206f 6620 7468 650d  for each of the.
+000214b0: 0a20 2020 2020 2020 2020 2020 2074 6872  .            thr
+000214c0: 6565 2063 6f6f 7264 696e 6174 6520 6178  ee coordinate ax
+000214d0: 6573 2e0d 0a20 2020 2020 2020 2020 2020  es...           
+000214e0: 204d 7573 7420 6265 2061 2032 4420 6172   Must be a 2D ar
+000214f0: 7261 7920 6966 2079 6c69 6d20 6f72 207a  ray if ylim or z
+00021500: 6c69 6d20 6973 2073 6574 2e0d 0a0d 0a20  lim is set..... 
+00021510: 2020 2020 2020 2079 6c69 6d2c 207a 6c69         ylim, zli
+00021520: 6d20 3a20 3244 2061 7272 6179 2c20 6465  m : 2D array, de
+00021530: 6661 756c 743a 204e 6f6e 650d 0a20 2020  fault: None..   
+00021540: 2020 2020 2020 2020 2053 6574 2074 6865           Set the
+00021550: 2079 6c69 6d20 616e 642f 6f72 207a 6c69   ylim and/or zli
+00021560: 6d2e 0d0a 0d0a 2020 2020 2020 2020 5265  m.....        Re
+00021570: 7475 726e 730d 0a20 2020 2020 2020 202d  turns..        -
+00021580: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
+00021590: 7365 6c66 203a 2043 7562 6963 5375 7266  self : CubicSurf
+000215a0: 6163 6520 6f62 6a65 6374 0d0a 0d0a 2020  ace object....  
+000215b0: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
+000215c0: 2020 2023 2074 6865 2066 6f6c 6c6f 7769     # the followi
+000215d0: 6e67 2061 6c6c 6f77 7320 616c 7465 726e  ng allows altern
+000215e0: 6174 6976 6520 2761 7267 206c 6973 7427  ative 'arg list'
+000215f0: 2075 7365 6420 696e 2073 7570 6572 2e0d   used in super..
+00021600: 0a20 2020 2020 2020 2074 6573 7420 3d20  .        test = 
+00021610: 796c 696d 2069 7320 4e6f 6e65 2061 6e64  ylim is None and
+00021620: 207a 6c69 6d20 6973 204e 6f6e 650d 0a20   zlim is None.. 
+00021630: 2020 2020 2020 2069 6620 6e6f 7420 7465         if not te
+00021640: 7374 3a0d 0a20 2020 2020 2020 2020 2020  st:..           
+00021650: 2073 7570 6572 2829 2e64 6f6d 6169 6e28   super().domain(
+00021660: 786c 696d 2c79 6c69 6d2c 7a6c 696d 290d  xlim,ylim,zlim).
+00021670: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00021680: 7572 6e20 7365 6c66 0d0a 2020 2020 2020  urn self..      
+00021690: 2020 646f 6d61 696e 203d 2053 7572 6661    domain = Surfa
+000216a0: 6365 3344 436f 6c6c 6563 7469 6f6e 2e5f  ce3DCollection._
+000216b0: 696e 7465 7270 7265 745f 646f 6d61 696e  interpret_domain
+000216c0: 2878 6c69 6d29 0d0a 0d0a 2020 2020 2020  (xlim)....      
+000216d0: 2020 7363 6c20 3d20 6c61 6d62 6461 206d    scl = lambda m
+000216e0: 696e 2c6d 6178 203a 2028 6d61 782d 6d69  in,max : (max-mi
+000216f0: 6e29 2f32 0d0a 2020 2020 2020 2020 7472  n)/2..        tr
+00021700: 6e20 3d20 6c61 6d62 6461 206d 696e 2c6d  n = lambda min,m
+00021710: 6178 203a 2028 6d61 782b 6d69 6e29 2f32  ax : (max+min)/2
+00021720: 0d0a 2020 2020 2020 2020 7363 616c 6520  ..        scale 
+00021730: 3d20 2020 2020 5b20 7363 6c28 645b 305d  =     [ scl(d[0]
+00021740: 2c64 5b31 5d29 2066 6f72 2064 2069 6e20  ,d[1]) for d in 
+00021750: 646f 6d61 696e 205d 0d0a 2020 2020 2020  domain ]..      
+00021760: 2020 7472 616e 736c 6174 6520 3d20 5b20    translate = [ 
+00021770: 7472 6e28 645b 305d 2c64 5b31 5d29 2066  trn(d[0],d[1]) f
+00021780: 6f72 2064 2069 6e20 646f 6d61 696e 205d  or d in domain ]
+00021790: 0d0a 2020 2020 2020 2020 7365 6c66 2e74  ..        self.t
+000217a0: 7261 6e73 666f 726d 284e 6f6e 652c 7363  ransform(None,sc
+000217b0: 616c 652c 7472 616e 736c 6174 6529 0d0a  ale,translate)..
+000217c0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+000217d0: 656c 660d 0a0d 0a0d 0a0d 0a63 6c61 7373  elf........class
+000217e0: 2050 6c61 6e61 7253 7572 6661 6365 2853   PlanarSurface(S
+000217f0: 7572 6661 6365 3344 436f 6c6c 6563 7469  urface3DCollecti
+00021800: 6f6e 2920 3a0d 0a20 2020 2022 2222 0d0a  on) :..    """..
+00021810: 2020 2020 466c 6174 2073 7175 6172 6520      Flat square 
+00021820: 3344 2073 7572 6661 6365 2069 6e20 4361  3D surface in Ca
+00021830: 7274 6573 6961 6e20 636f 6f72 6469 6e61  rtesian coordina
+00021840: 7465 732e 0d0a 0d0a 2020 2020 4d65 7468  tes.....    Meth
+00021850: 6f64 7320 6172 6520 696e 6865 7269 7465  ods are inherite
+00021860: 6420 6672 6f6d 2074 6865 2053 7572 6661  d from the Surfa
+00021870: 6365 3344 436f 6c6c 6563 7469 6f6e 2e0d  ce3DCollection..
+00021880: 0a20 2020 2050 6c61 6e61 7220 7375 7266  .    Planar surf
+00021890: 6163 6520 6765 6f6d 6574 7269 6573 2061  ace geometries a
+000218a0: 7265 2063 7265 6174 6564 2069 6e20 7468  re created in th
+000218b0: 6973 2073 7562 636c 6173 732e 0d0a 0d0a  is subclass.....
+000218c0: 2020 2020 2222 220d 0a20 2020 200d 0a20      """..    .. 
+000218d0: 2020 2040 7374 6174 6963 6d65 7468 6f64     @staticmethod
+000218e0: 0d0a 2020 2020 6465 6620 7261 6e64 2872  ..    def rand(r
+000218f0: 657a 3d30 2c73 6565 643d 4e6f 6e65 2c6e  ez=0,seed=None,n
+00021900: 616d 653d 4e6f 6e65 2c6b 696e 643d 4e6f  ame=None,kind=No
+00021910: 6e65 2c2a 2a6b 6172 6773 2920 3a0d 0a20  ne,**kargs) :.. 
+00021920: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
+00021930: 2020 2020 506c 616e 6172 5375 7266 6163      PlanarSurfac
+00021940: 6520 7769 7468 2072 616e 646f 6d20 7472  e with random tr
+00021950: 6961 6e67 756c 6172 2066 6163 6573 2e0d  iangular faces..
+00021960: 0a0d 0a20 2020 2020 2020 2050 6172 616d  ...        Param
+00021970: 6574 6572 730d 0a20 2020 2020 2020 202d  eters..        -
+00021980: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
+00021990: 2020 2072 657a 203a 206e 756d 6265 722c     rez : number,
+000219a0: 206f 7074 696f 6e61 6c2c 2064 6566 6175   optional, defau
+000219b0: 6c74 3a20 300d 0a20 2020 2020 2020 2020  lt: 0..         
+000219c0: 2020 204e 756d 6265 7220 6f66 2027 7265     Number of 're
+000219d0: 6375 7273 6976 6527 2073 7562 6469 7669  cursive' subdivi
+000219e0: 7369 6f6e 7320 6f66 2074 6865 2074 7269  sions of the tri
+000219f0: 616e 6775 6c61 7465 6420 6261 7365 2066  angulated base f
+00021a00: 6163 6573 2e0d 0a20 2020 2020 2020 2020  aces...         
+00021a10: 2020 2052 657a 2076 616c 7565 7320 7261     Rez values ra
+00021a20: 6e67 6520 6672 6f6d 2030 2074 6f20 372e  nge from 0 to 7.
+00021a30: 0d0a 0d0a 2020 2020 2020 2020 7365 6564  ....        seed
+00021a40: 203a 2069 6e74 6567 6572 2c20 6f70 7469   : integer, opti
+00021a50: 6f6e 616c 2c20 6465 6661 756c 743a 204e  onal, default: N
+00021a60: 6f6e 650d 0a20 2020 2020 2020 2020 2020  one..           
+00021a70: 2041 6e20 696e 6974 6961 6c69 7a61 7469   An initializati
+00021a80: 6f6e 2073 6565 6420 666f 7220 7261 6e64  on seed for rand
+00021a90: 6f6d 2067 656e 6572 6174 696f 6e2e 0d0a  om generation...
+00021aa0: 0d0a 2020 2020 2020 2020 6e61 6d65 203a  ..        name :
+00021ab0: 2073 7472 696e 672c 206f 7074 696f 6e61   string, optiona
+00021ac0: 6c2c 2064 6566 6175 6c74 3a20 4e6f 6e65  l, default: None
+00021ad0: 2e0d 0a20 2020 2020 2020 2020 2020 2044  ...            D
+00021ae0: 6573 6372 6970 7469 7665 2069 6465 6e74  escriptive ident
+00021af0: 6966 6965 7220 666f 7220 7468 6520 6765  ifier for the ge
+00021b00: 6f6d 6574 7279 2e0d 0a0d 0a20 2020 2020  ometry.....     
+00021b10: 2020 206b 696e 6420 3a20 7374 7269 6e67     kind : string
+00021b20: 2c20 6f70 7469 6f6e 616c 2c20 6465 6661  , optional, defa
+00021b30: 756c 743a 204e 6f6e 650d 0a20 2020 2020  ult: None..     
+00021b40: 2020 2020 2020 2028 7265 7365 7276 6564         (reserved
+00021b50: 2c20 6e6f 7420 696d 706c 656d 656e 7465  , not implemente
+00021b60: 6429 200d 0a0d 0a20 2020 2020 2020 2052  d) ....        R
+00021b70: 6169 7365 730d 0a20 2020 2020 2020 202d  aises..        -
+00021b80: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2056  -----..        V
+00021b90: 616c 7565 4572 726f 720d 0a20 2020 2020  alueError..     
+00021ba0: 2020 2020 2020 2049 6620 7265 7a20 6973         If rez is
+00021bb0: 206e 6f74 2061 6e20 696e 7465 6765 7220   not an integer 
+00021bc0: 696e 2072 616e 6765 2030 2074 6f20 372e  in range 0 to 7.
+00021bd0: 0d0a 2020 2020 2020 2020 2020 2020 4966  ..            If
+00021be0: 2062 6173 6574 7970 6520 6973 206e 6f74   basetype is not
+00021bf0: 2072 6563 6f67 6e69 7a65 6420 666f 7220   recognized for 
+00021c00: 7468 6973 2073 7572 6661 6365 2063 6f6e  this surface con
+00021c10: 7374 7275 6374 6f72 2e0d 0a0d 0a20 2020  structor.....   
+00021c20: 2020 2020 204f 7468 6572 2050 6172 616d       Other Param
+00021c30: 6574 6572 730d 0a20 2020 2020 2020 202d  eters..        -
+00021c40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d  ---------------.
+00021c50: 0a20 2020 2020 2020 202a 2a6b 7761 7267  .        **kwarg
+00021c60: 730d 0a20 2020 2020 2020 2020 2020 2041  s..            A
+00021c70: 6c6c 206f 7468 6572 2070 6172 616d 6574  ll other paramet
+00021c80: 6572 7320 6172 6520 7061 7373 6564 206f  ers are passed o
+00021c90: 6e20 746f 2027 7333 646c 6962 2e73 7572  n to 's3dlib.sur
+00021ca0: 6661 6365 2e53 7572 6661 6365 3344 436f  face.Surface3DCo
+00021cb0: 6c6c 6563 7469 6f6e 272e 0d0a 2020 2020  llection'...    
+00021cc0: 2020 2020 0d0a 2020 2020 2020 2020 5265      ..        Re
+00021cd0: 7475 726e 730d 0a20 2020 2020 2020 202d  turns..        -
+00021ce0: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
+00021cf0: 7375 7266 6163 6520 3a20 506c 616e 6172  surface : Planar
+00021d00: 5375 7266 6163 6520 6f62 6a65 6374 2e0d  Surface object..
+00021d10: 0a0d 0a20 2020 2020 2020 2022 2222 0d0a  ...        """..
+00021d20: 0d0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
+00021d30: 2069 7369 6e73 7461 6e63 6528 7265 7a2c   isinstance(rez,
+00021d40: 2028 696e 742c 666c 6f61 7429 2920 3a0d   (int,float)) :.
+00021d50: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+00021d60: 7365 2056 616c 7565 4572 726f 7228 2749  se ValueError('I
+00021d70: 6e63 6f72 7265 6374 2072 657a 2074 7970  ncorrect rez typ
+00021d80: 652c 206d 7573 7420 6265 2061 206e 756d  e, must be a num
+00021d90: 6265 7227 290d 0a20 2020 2020 2020 2069  ber')..        i
+00021da0: 6620 2872 657a 3c30 2920 6f72 2028 7265  f (rez<0) or (re
+00021db0: 7a3e 5f4d 4158 5245 5a29 203a 0d0a 2020  z>_MAXREZ) :..  
+00021dc0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00021dd0: 5661 6c75 6545 7272 6f72 2827 496e 636f  ValueError('Inco
+00021de0: 7272 6573 7420 7265 7a20 6f66 207b 7d2c  rrest rez of {},
+00021df0: 206d 7573 7420 6265 2061 6e20 696e 742c   must be an int,
+00021e00: 2030 203c 3d20 7265 7a20 3c3d 207b 7d27   0 <= rez <= {}'
+00021e10: 2e66 6f72 6d61 7428 7265 7a2c 5f4d 4158  .format(rez,_MAX
+00021e20: 5245 5a29 290d 0a0d 0a20 2020 2020 2020  REZ))....       
+00021e30: 2069 6620 7365 6564 2069 7320 6e6f 7420   if seed is not 
+00021e40: 4e6f 6e65 203a 0d0a 2020 2020 2020 2020  None :..        
+00021e50: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
+00021e60: 7461 6e63 6528 7365 6564 2c20 696e 7429  tance(seed, int)
+00021e70: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
+00021e80: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+00021e90: 7272 6f72 2827 496e 636f 7272 6563 7420  rror('Incorrect 
+00021ea0: 7365 6564 2074 7970 652c 206d 7573 7420  seed type, must 
+00021eb0: 6261 206f 6620 7479 7065 2069 6e74 2729  ba of type int')
+00021ec0: 200d 0a20 2020 2020 2020 2020 2020 206e   ..            n
+00021ed0: 702e 7261 6e64 6f6d 2e73 6565 6428 7365  p.random.seed(se
+00021ee0: 6564 290d 0a0d 0a20 2020 2020 2020 204e  ed)....        N
+00021ef0: 203d 2069 6e74 2820 382a 2834 2a2a 7265   = int( 8*(4**re
+00021f00: 7a29 2f32 202b 2034 2a28 322a 2a72 657a  z)/2 + 4*(2**rez
+00021f10: 2920 2b20 3120 290d 0a20 2020 2020 2020  ) + 1 )..       
+00021f20: 2078 203d 2032 2a6e 702e 7261 6e64 6f6d   x = 2*np.random
+00021f30: 2e72 616e 6428 204e 2029 202d 2031 0d0a  .rand( N ) - 1..
+00021f40: 2020 2020 2020 2020 7920 3d20 322a 6e70          y = 2*np
+00021f50: 2e72 616e 646f 6d2e 7261 6e64 2820 4e20  .random.rand( N 
+00021f60: 2920 2d20 3120 0d0a 2020 2020 2020 2020  ) - 1 ..        
+00021f70: 7879 6461 7461 203d 206e 702e 6172 7261  xydata = np.arra
+00021f80: 7928 5b78 2c79 5d29 2e54 0d0a 2020 2020  y([x,y]).T..    
+00021f90: 2020 2020 7465 7373 203d 2073 7061 7469      tess = spati
+00021fa0: 616c 2e44 656c 6175 6e61 7928 7879 6461  al.Delaunay(xyda
+00021fb0: 7461 290d 0a0d 0a20 2020 2020 2020 2069  ta)....        i
+00021fc0: 6620 6e61 6d65 2069 7320 4e6f 6e65 203a  f name is None :
+00021fd0: 206e 616d 6520 3d20 2772 616e 646f 6d20   name = 'random 
+00021fe0: 6d65 7368 270d 0a20 2020 2020 2020 2073  mesh'..        s
+00021ff0: 7572 6661 6365 203d 2050 6c61 6e61 7253  urface = PlanarS
+00022000: 7572 6661 6365 286e 616d 653d 6e61 6d65  urface(name=name
+00022010: 2c2a 2a6b 6172 6773 2920 2023 2073 6574  ,**kargs)  # set
+00022020: 2074 6f20 7468 6520 636c 6173 7320 6465   to the class de
+00022030: 6661 756c 7420 6f62 6a65 6374 0d0a 2020  fault object..  
+00022040: 2020 2020 2020 2320 7265 7365 7420 7665        # reset ve
+00022050: 7274 732c 2066 6163 6549 6e64 6963 6573  rts, faceIndices
+00022060: 2061 6e64 2065 6467 6573 2028 7265 7461   and edges (reta
+00022070: 696e 2063 6c61 7373 2063 6f6f 7264 696e  in class coordin
+00022080: 6174 6520 7379 7374 656d 292e 0d0a 2020  ate system)...  
+00022090: 2020 2020 2020 7665 7274 7320 3d20 6e70        verts = np
+000220a0: 2e7a 6572 6f73 2820 284e 2c33 2929 0d0a  .zeros( (N,3))..
+000220b0: 2020 2020 2020 2020 7665 7274 735b 3a2c          verts[:,
+000220c0: 3a32 5d20 3d20 7465 7373 2e70 6f69 6e74  :2] = tess.point
+000220d0: 730d 0a20 2020 2020 2020 2066 6163 6549  s..        faceI
+000220e0: 6e64 6963 6573 203d 2074 6573 732e 7369  ndices = tess.si
+000220f0: 6d70 6c69 6365 730d 0a20 2020 2020 2020  mplices..       
+00022100: 200d 0a20 2020 2020 2020 2073 7572 6661   ..        surfa
+00022110: 6365 2e76 6572 7465 7843 6f6f 7220 3d20  ce.vertexCoor = 
+00022120: 7665 7274 730d 0a20 2020 2020 2020 2073  verts..        s
+00022130: 7572 6661 6365 2e66 7649 6e64 6963 6573  urface.fvIndices
+00022140: 203d 2066 6163 6549 6e64 6963 6573 0d0a   = faceIndices..
+00022150: 2020 2020 2020 2020 7375 7266 6163 652e          surface.
+00022160: 6576 496e 6469 6365 7320 3d20 7375 7266  evIndices = surf
+00022170: 6163 652e 5f67 6574 5f65 6467 6573 5f66  ace._get_edges_f
+00022180: 726f 6d5f 6661 6365 7328 6661 6365 496e  rom_faces(faceIn
+00022190: 6469 6365 7329 0d0a 2020 2020 2020 2020  dices)..        
+000221a0: 7375 7266 6163 652e 7666 496e 6469 6365  surface.vfIndice
+000221b0: 734c 6973 7420 3d20 7375 7266 6163 652e  sList = surface.
+000221c0: 5f76 6572 7465 7843 6f6d 6d6f 6e46 6163  _vertexCommonFac
+000221d0: 6549 6e64 6963 6573 2829 0d0a 2020 2020  eIndices()..    
+000221e0: 2020 2020 7375 7266 6163 652e 6566 496e      surface.efIn
+000221f0: 6469 6365 734c 6973 7420 3d20 7375 7266  dicesList = surf
+00022200: 6163 652e 5f65 6467 6543 6f6d 6d6f 6e46  ace._edgeCommonF
+00022210: 6163 6549 6e64 6963 6573 2829 0d0a 2020  aceIndices()..  
+00022220: 2020 2020 2020 7375 7266 6163 652e 7365        surface.se
+00022230: 745f 7665 7274 7328 2076 6572 7473 5b66  t_verts( verts[f
+00022240: 6163 6549 6e64 6963 6573 5d20 290d 0a20  aceIndices] ).. 
+00022250: 2020 2020 2020 2073 7572 6661 6365 2e5f         surface._
+00022260: 7365 745f 6765 6f6d 6574 7269 635f 626f  set_geometric_bo
+00022270: 756e 6473 2829 0d0a 2020 2020 2020 2020  unds()..        
+00022280: 7375 7266 6163 652e 5f72 657a 203d 2073  surface._rez = s
+00022290: 7472 2872 657a 2920 6966 2069 7369 6e73  tr(rez) if isins
+000222a0: 7461 6e63 6528 7265 7a2c 696e 7429 2065  tance(rez,int) e
+000222b0: 6c73 6520 277b 3a2e 3166 7d27 2e66 6f72  lse '{:.1f}'.for
+000222c0: 6d61 7428 7265 7a29 0d0a 2020 2020 2020  mat(rez)..      
+000222d0: 2020 7375 7266 6163 652e 5f62 6173 6574    surface._baset
+000222e0: 7970 6520 3d20 2772 616e 645f 272b 7374  ype = 'rand_'+st
+000222f0: 7228 7365 6564 290d 0a20 2020 2020 2020  r(seed)..       
+00022300: 2072 6574 7572 6e20 7375 7266 6163 650d   return surface.
+00022310: 0a0d 0a20 2020 2040 7374 6174 6963 6d65  ...    @staticme
+00022320: 7468 6f64 0d0a 2020 2020 6465 6620 5f67  thod..    def _g
+00022330: 6574 5f70 6c61 6e61 725f 7375 7266 6163  et_planar_surfac
+00022340: 6573 5f64 6963 7469 6f6e 6172 7928 2920  es_dictionary() 
+00022350: 3a0d 0a20 2020 2020 2020 2022 2222 2043  :..        """ C
+00022360: 6f6e 7374 7275 6374 7320 7468 6520 6469  onstructs the di
+00022370: 6374 696f 6e61 7279 206f 6620 6261 7365  ctionary of base
+00022380: 2070 6c61 6e61 7220 7375 7266 6163 6520   planar surface 
+00022390: 6765 6f6d 6574 7269 6573 2e20 2222 220d  geometries. """.
+000223a0: 0a0d 0a20 2020 2020 2020 2073 7572 6661  ...        surfa
+000223b0: 6365 7344 6963 7469 6f6e 6172 7920 3d20  cesDictionary = 
+000223c0: 7b7d 0d0a 0d0a 2020 2020 2020 2020 6261  {}....        ba
+000223d0: 7365 5665 7274 203d 205b 205b 302c 302c  seVert = [ [0,0,
+000223e0: 305d 2c0d 0a20 2020 2020 2020 2020 2020  0],..           
+000223f0: 2020 2020 2020 2020 2020 5b31 2c31 2c30            [1,1,0
+00022400: 5d2c 205b 2d31 2c31 2c30 5d2c 205b 2d31  ], [-1,1,0], [-1
+00022410: 2c2d 312c 305d 2c20 5b31 2c2d 312c 305d  ,-1,0], [1,-1,0]
+00022420: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00022430: 2020 2020 2020 2020 5b31 2c30 2c30 5d2c          [1,0,0],
+00022440: 205b 302c 312c 305d 2c20 5b2d 312c 302c   [0,1,0], [-1,0,
+00022450: 305d 2c20 5b30 2c2d 312c 305d 205d 0d0a  0], [0,-1,0] ]..
+00022460: 0d0a 2020 2020 2020 2020 7156 6572 7420  ..        qVert 
+00022470: 3d20 5b20 6261 7365 5665 7274 5b69 5d20  = [ baseVert[i] 
+00022480: 666f 7220 6920 696e 2072 616e 6765 2830  for i in range(0
+00022490: 2c35 2920 5d0d 0a0d 0a20 2020 2020 2020  ,5) ]....       
+000224a0: 2071 7561 6446 6163 6573 3d28 200d 0a20   quadFaces=( .. 
+000224b0: 2020 2020 2020 2020 2020 205b 302c 312c             [0,1,
+000224c0: 325d 2c5b 302c 322c 335d 2c5b 302c 332c  2],[0,2,3],[0,3,
+000224d0: 345d 2c5b 302c 342c 315d 2029 0d0a 2020  4],[0,4,1] )..  
+000224e0: 2020 2020 2020 6f63 7446 6163 6573 313d        octFaces1=
+000224f0: 280d 0a20 2020 2020 2020 2020 2020 205b  (..            [
+00022500: 302c 352c 365d 2c5b 302c 362c 375d 2c5b  0,5,6],[0,6,7],[
+00022510: 302c 372c 385d 2c5b 302c 382c 355d 2c0d  0,7,8],[0,8,5],.
+00022520: 0a20 2020 2020 2020 2020 2020 205b 352c  .            [5,
+00022530: 312c 365d 2c5b 362c 322c 375d 2c5b 372c  1,6],[6,2,7],[7,
+00022540: 332c 385d 2c5b 382c 342c 355d 2029 0d0a  3,8],[8,4,5] )..
+00022550: 2020 2020 2020 2020 6f63 7446 6163 6573          octFaces
+00022560: 323d 280d 0a20 2020 2020 2020 2020 2020  2=(..           
+00022570: 205b 302c 352c 315d 2c5b 302c 312c 365d   [0,5,1],[0,1,6]
+00022580: 2c5b 302c 362c 325d 2c5b 302c 322c 375d  ,[0,6,2],[0,2,7]
+00022590: 2c0d 0a20 2020 2020 2020 2020 2020 205b  ,..            [
+000225a0: 302c 372c 335d 2c5b 302c 332c 385d 2c5b  0,7,3],[0,3,8],[
+000225b0: 302c 382c 345d 2c5b 302c 342c 355d 2029  0,8,4],[0,4,5] )
+000225c0: 0d0a 2020 2020 2020 2020 6772 6964 4661  ..        gridFa
+000225d0: 6365 733d 280d 0a20 2020 2020 2020 2020  ces=(..         
+000225e0: 2020 205b 302c 352c 312c 365d 2c20 5b30     [0,5,1,6], [0
+000225f0: 2c36 2c32 2c37 5d2c 205b 302c 372c 332c  ,6,2,7], [0,7,3,
+00022600: 385d 2c20 5b30 2c38 2c34 2c35 5d0d 0a20  8], [0,8,4,5].. 
+00022610: 2020 2020 2020 2029 0d0a 0d0a 2020 2020         )....    
+00022620: 2020 2020 4671 203d 206c 656e 2871 7561      Fq = len(qua
+00022630: 6446 6163 6573 290d 0a20 2020 2020 2020  dFaces)..       
+00022640: 2046 3120 3d20 6c65 6e28 6f63 7446 6163   F1 = len(octFac
+00022650: 6573 3129 0d0a 2020 2020 2020 2020 4632  es1)..        F2
+00022660: 203d 206c 656e 286f 6374 4661 6365 7332   = len(octFaces2
+00022670: 290d 0a20 2020 2020 2020 2046 6320 3d20  )..        Fc = 
+00022680: 6c65 6e28 6772 6964 4661 6365 7329 0d0a  len(gridFaces)..
+00022690: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+000226a0: 2020 7175 6164 203d 2020 7b20 2762 6173    quad =  { 'bas
+000226b0: 6546 6163 6549 6e64 6963 6573 2720 3a20  eFaceIndices' : 
+000226c0: 7175 6164 4661 6365 7320 2c20 2762 6173  quadFaces , 'bas
+000226d0: 6556 6572 7469 6365 7343 6f6f 7227 203a  eVerticesCoor' :
+000226e0: 2071 5665 7274 2c20 2766 6576 5061 7261   qVert, 'fevPara
+000226f0: 6d27 203a 205b 4671 2c32 2c31 5d20 7d0d  m' : [Fq,2,1] }.
+00022700: 0a20 2020 2020 2020 206f 6374 3120 3d20  .        oct1 = 
+00022710: 207b 2027 6261 7365 4661 6365 496e 6469   { 'baseFaceIndi
+00022720: 6365 7327 203a 206f 6374 4661 6365 7331  ces' : octFaces1
+00022730: 202c 2027 6261 7365 5665 7274 6963 6573   , 'baseVertices
+00022740: 436f 6f72 2720 3a20 6261 7365 5665 7274  Coor' : baseVert
+00022750: 2c20 2766 6576 5061 7261 6d27 203a 205b  , 'fevParam' : [
+00022760: 4631 2c34 2c31 5d20 7d0d 0a20 2020 2020  F1,4,1] }..     
+00022770: 2020 206f 6374 3220 3d20 207b 2027 6261     oct2 =  { 'ba
+00022780: 7365 4661 6365 496e 6469 6365 7327 203a  seFaceIndices' :
+00022790: 206f 6374 4661 6365 7332 202c 2027 6261   octFaces2 , 'ba
+000227a0: 7365 5665 7274 6963 6573 436f 6f72 2720  seVerticesCoor' 
+000227b0: 3a20 6261 7365 5665 7274 2c20 2766 6576  : baseVert, 'fev
+000227c0: 5061 7261 6d27 203a 205b 4632 2c34 2c31  Param' : [F2,4,1
+000227d0: 5d20 7d0d 0a20 2020 2020 2020 2067 7269  ] }..        gri
+000227e0: 6420 3d20 207b 2027 6261 7365 4661 6365  d =  { 'baseFace
+000227f0: 496e 6469 6365 7327 203a 2067 7269 6446  Indices' : gridF
+00022800: 6163 6573 202c 2027 6261 7365 5665 7274  aces , 'baseVert
+00022810: 6963 6573 436f 6f72 2720 3a20 6261 7365  icesCoor' : base
+00022820: 5665 7274 2c20 2766 6576 5061 7261 6d27  Vert, 'fevParam'
+00022830: 203a 205b 4663 2c30 2c32 5d20 7d0d 0a0d   : [Fc,0,2] }...
+00022840: 0a20 2020 2020 2020 2073 7572 6661 6365  .        surface
+00022850: 7344 6963 7469 6f6e 6172 795b 2771 7561  sDictionary['qua
+00022860: 6427 5d20 3d20 7175 6164 0d0a 2020 2020  d'] = quad..    
+00022870: 2020 2020 7375 7266 6163 6573 4469 6374      surfacesDict
+00022880: 696f 6e61 7279 5b27 6f63 7431 275d 203d  ionary['oct1'] =
+00022890: 206f 6374 310d 0a20 2020 2020 2020 2073   oct1..        s
+000228a0: 7572 6661 6365 7344 6963 7469 6f6e 6172  urfacesDictionar
+000228b0: 795b 276f 6374 3227 5d20 3d20 6f63 7432  y['oct2'] = oct2
+000228c0: 0d0a 2020 2020 2020 2020 7375 7266 6163  ..        surfac
+000228d0: 6573 4469 6374 696f 6e61 7279 5b27 7371  esDictionary['sq
+000228e0: 7527 5d20 3d20 6772 6964 0d0a 0d0a 2020  u'] = grid....  
+000228f0: 2020 2020 2020 2320 2d2d 2d2d 2d2d 2d2d        # --------
+00022900: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00022910: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00022920: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00022930: 2d2d 0d0a 2020 2020 2020 2020 6d72 203d  --..        mr =
+00022940: 2030 2e30 310d 0a20 2020 2020 2020 204d   0.01..        M
+00022950: 5220 3d20 6d72 2a6e 702e 7371 7274 2832  R = mr*np.sqrt(2
+00022960: 290d 0a20 2020 2020 2020 2071 5665 7274  )..        qVert
+00022970: 533d 636f 7079 2e63 6f70 7928 2073 7572  S=copy.copy( sur
+00022980: 6661 6365 7344 6963 7469 6f6e 6172 795b  facesDictionary[
+00022990: 2771 7561 6427 5d5b 2762 6173 6556 6572  'quad']['baseVer
+000229a0: 7469 6365 7343 6f6f 7227 5d20 290d 0a20  ticesCoor'] ).. 
+000229b0: 2020 2020 2020 2071 5665 7274 535b 305d         qVertS[0]
+000229c0: 203d 2020 205b 204d 522c 2020 302c 2030   =   [ MR,  0, 0
+000229d0: 5d0d 0a20 2020 2020 2020 2071 5665 7274  ]..        qVert
+000229e0: 532e 6170 7065 6e64 285b 2020 302c 204d  S.append([  0, M
+000229f0: 522c 2030 5d29 0d0a 2020 2020 2020 2020  R, 0])..        
+00022a00: 7156 6572 7453 2e61 7070 656e 6428 5b2d  qVertS.append([-
+00022a10: 4d52 2c20 2030 2c20 305d 290d 0a20 2020  MR,  0, 0])..   
+00022a20: 2020 2020 2071 5665 7274 532e 6170 7065       qVertS.appe
+00022a30: 6e64 285b 3020 202c 2d4d 522c 2030 5d29  nd([0  ,-MR, 0])
+00022a40: 0d0a 0d0a 2020 2020 2020 2020 6261 7365  ....        base
+00022a50: 5665 7274 5320 3d20 636f 7079 2e63 6f70  VertS = copy.cop
+00022a60: 7928 7375 7266 6163 6573 4469 6374 696f  y(surfacesDictio
+00022a70: 6e61 7279 5b27 6f63 7431 275d 5b27 6261  nary['oct1']['ba
+00022a80: 7365 5665 7274 6963 6573 436f 6f72 275d  seVerticesCoor']
+00022a90: 290d 0a20 2020 2020 2020 2062 6173 6556  )..        baseV
+00022aa0: 6572 7453 5b30 5d20 3d20 2020 5b20 6d72  ertS[0] =   [ mr
+00022ab0: 2c20 6d72 2c20 305d 0d0a 2020 2020 2020  , mr, 0]..      
+00022ac0: 2020 6261 7365 5665 7274 532e 6170 7065    baseVertS.appe
+00022ad0: 6e64 285b 2d6d 722c 206d 722c 2030 5d29  nd([-mr, mr, 0])
+00022ae0: 0d0a 2020 2020 2020 2020 6261 7365 5665  ..        baseVe
+00022af0: 7274 532e 6170 7065 6e64 285b 2d6d 722c  rtS.append([-mr,
+00022b00: 2d6d 722c 2030 5d29 0d0a 2020 2020 2020  -mr, 0])..      
+00022b10: 2020 6261 7365 5665 7274 532e 6170 7065    baseVertS.appe
+00022b20: 6e64 285b 206d 722c 2d6d 722c 2030 5d29  nd([ mr,-mr, 0])
+00022b30: 0d0a 0d0a 2020 2020 2020 2020 7175 6164  ....        quad
+00022b40: 4661 6365 7353 3d28 200d 0a20 2020 2020  FacesS=( ..     
+00022b50: 2020 2020 2020 205b 352c 312c 325d 2c5b         [5,1,2],[
+00022b60: 362c 322c 335d 2c5b 372c 332c 345d 2c5b  6,2,3],[7,3,4],[
+00022b70: 302c 342c 315d 2c0d 0a20 2020 2020 2020  0,4,1],..       
+00022b80: 2020 2020 205b 312c 352c 305d 2c5b 322c       [1,5,0],[2,
+00022b90: 362c 355d 2c5b 332c 372c 365d 2c5b 342c  6,5],[3,7,6],[4,
+00022ba0: 302c 375d 2029 0d0a 0d0a 2020 2020 2020  0,7] )....      
+00022bb0: 2020 6f63 7446 6163 6573 3153 3d28 0d0a    octFaces1S=(..
+00022bc0: 2020 2020 2020 2020 2020 2020 5b20 302c              [ 0,
+00022bd0: 2035 2c20 365d 2c5b 2039 2c20 362c 2037   5, 6],[ 9, 6, 7
+00022be0: 5d2c 5b31 302c 2037 2c20 385d 2c5b 3131  ],[10, 7, 8],[11
+00022bf0: 2c20 382c 2035 5d2c 0d0a 2020 2020 2020  , 8, 5],..      
+00022c00: 2020 2020 2020 5b20 352c 2031 2c20 365d        [ 5, 1, 6]
+00022c10: 2c5b 2036 2c20 322c 2037 5d2c 5b20 372c  ,[ 6, 2, 7],[ 7,
+00022c20: 2033 2c20 385d 2c5b 2038 2c20 342c 2035   3, 8],[ 8, 4, 5
+00022c30: 5d2c 0d0a 2020 2020 2020 2020 2020 2020  ],..            
+00022c40: 5b20 352c 2030 2c31 315d 2c5b 2036 2c20  [ 5, 0,11],[ 6, 
+00022c50: 392c 2030 5d2c 5b20 372c 3130 2c20 395d  9, 0],[ 7,10, 9]
+00022c60: 2c5b 2038 2c31 312c 3130 5d20 290d 0a0d  ,[ 8,11,10] )...
+00022c70: 0a20 2020 2020 2020 206f 6374 4661 6365  .        octFace
+00022c80: 7332 533d 280d 0a20 2020 2020 2020 2020  s2S=(..         
+00022c90: 2020 205b 2030 2c20 352c 2031 5d2c 5b20     [ 0, 5, 1],[ 
+00022ca0: 302c 2031 2c20 365d 2c5b 2039 2c20 362c  0, 1, 6],[ 9, 6,
+00022cb0: 2032 5d2c 5b20 392c 2032 2c20 375d 2c0d   2],[ 9, 2, 7],.
+00022cc0: 0a20 2020 2020 2020 2020 2020 205b 3130  .            [10
+00022cd0: 2c20 372c 2033 5d2c 5b31 302c 2033 2c20  , 7, 3],[10, 3, 
+00022ce0: 385d 2c5b 3131 2c20 382c 2034 5d2c 5b31  8],[11, 8, 4],[1
+00022cf0: 312c 2034 2c20 355d 2c0d 0a20 2020 2020  1, 4, 5],..     
+00022d00: 2020 2020 2020 205b 2035 2c20 302c 3131         [ 5, 0,11
+00022d10: 5d2c 5b20 362c 2039 2c20 305d 2c5b 2037  ],[ 6, 9, 0],[ 7
+00022d20: 2c31 302c 2039 5d2c 5b20 382c 3131 2c31  ,10, 9],[ 8,11,1
+00022d30: 305d 2029 0d0a 0d0a 0d0a 2020 2020 2020  0] )......      
+00022d40: 2020 4671 5320 3d20 6c65 6e28 7175 6164    FqS = len(quad
+00022d50: 4661 6365 7353 290d 0a20 2020 2020 2020  FacesS)..       
+00022d60: 2046 3153 203d 206c 656e 286f 6374 4661   F1S = len(octFa
+00022d70: 6365 7331 5329 0d0a 2020 2020 2020 2020  ces1S)..        
+00022d80: 4632 5320 3d20 6c65 6e28 6f63 7446 6163  F2S = len(octFac
+00022d90: 6573 3253 290d 0a20 2020 2020 2020 2071  es2S)..        q
+00022da0: 7561 6453 203d 2020 7b20 2762 6173 6546  uadS =  { 'baseF
+00022db0: 6163 6549 6e64 6963 6573 2720 3a20 7175  aceIndices' : qu
+00022dc0: 6164 4661 6365 7353 202c 2027 6261 7365  adFacesS , 'base
+00022dd0: 5665 7274 6963 6573 436f 6f72 2720 3a20  VerticesCoor' : 
+00022de0: 7156 6572 7453 2c20 2766 6576 5061 7261  qVertS, 'fevPara
+00022df0: 6d27 203a 205b 4671 532c 322c 315d 207d  m' : [FqS,2,1] }
+00022e00: 0d0a 2020 2020 2020 2020 6f63 7431 5320  ..        oct1S 
+00022e10: 3d20 207b 2027 6261 7365 4661 6365 496e  =  { 'baseFaceIn
+00022e20: 6469 6365 7327 203a 206f 6374 4661 6365  dices' : octFace
+00022e30: 7331 5320 2c20 2762 6173 6556 6572 7469  s1S , 'baseVerti
+00022e40: 6365 7343 6f6f 7227 203a 2062 6173 6556  cesCoor' : baseV
+00022e50: 6572 7453 2c20 2766 6576 5061 7261 6d27  ertS, 'fevParam'
+00022e60: 203a 205b 4631 532c 342c 315d 207d 0d0a   : [F1S,4,1] }..
+00022e70: 2020 2020 2020 2020 6f63 7432 5320 3d20          oct2S = 
+00022e80: 207b 2027 6261 7365 4661 6365 496e 6469   { 'baseFaceIndi
+00022e90: 6365 7327 203a 206f 6374 4661 6365 7332  ces' : octFaces2
+00022ea0: 5320 2c20 2762 6173 6556 6572 7469 6365  S , 'baseVertice
+00022eb0: 7343 6f6f 7227 203a 2062 6173 6556 6572  sCoor' : baseVer
+00022ec0: 7453 2c20 2766 6576 5061 7261 6d27 203a  tS, 'fevParam' :
+00022ed0: 205b 4632 532c 342c 315d 207d 0d0a 0d0a   [F2S,4,1] }....
+00022ee0: 2020 2020 2020 2020 7375 7266 6163 6573          surfaces
+00022ef0: 4469 6374 696f 6e61 7279 5b27 7175 6164  Dictionary['quad
+00022f00: 5f63 275d 203d 2071 7561 6453 0d0a 2020  _c'] = quadS..  
+00022f10: 2020 2020 2020 7375 7266 6163 6573 4469        surfacesDi
+00022f20: 6374 696f 6e61 7279 5b27 6f63 7431 5f63  ctionary['oct1_c
+00022f30: 275d 203d 206f 6374 3153 0d0a 2020 2020  '] = oct1S..    
+00022f40: 2020 2020 7375 7266 6163 6573 4469 6374      surfacesDict
+00022f50: 696f 6e61 7279 5b27 6f63 7432 5f63 275d  ionary['oct2_c']
+00022f60: 203d 206f 6374 3253 0d0a 0d0a 2020 2020   = oct2S....    
+00022f70: 2020 2020 7265 7475 726e 2073 7572 6661      return surfa
+00022f80: 6365 7344 6963 7469 6f6e 6172 790d 0a20  cesDictionary.. 
+00022f90: 2020 200d 0a20 2020 2040 7374 6174 6963     ..    @static
+00022fa0: 6d65 7468 6f64 0d0a 2020 2020 6465 6620  method..    def 
+00022fb0: 5f6d 6964 5665 6374 6f72 4675 6e28 7665  _midVectorFun(ve
+00022fc0: 6374 412c 2076 6563 7442 2920 3a0d 0a20  ctA, vectB) :.. 
+00022fd0: 2020 2020 2020 2022 2222 4d69 642d 706f         """Mid-po
+00022fe0: 696e 7420 6265 7477 6565 6e20 7477 6f20  int between two 
+00022ff0: 706f 696e 7473 2069 6e20 7468 6520 7879  points in the xy
+00023000: 2070 6c61 6e65 2e22 2222 0d0a 0d0a 2020   plane."""....  
+00023010: 2020 2020 2020 6d69 6420 3d20 6e70 2e61        mid = np.a
+00023020: 6464 2876 6563 7441 2c76 6563 7442 290d  dd(vectA,vectB).
+00023030: 0a20 2020 2020 2020 206d 6964 203d 206e  .        mid = n
+00023040: 702e 6d75 6c74 6970 6c79 2830 2e35 2c6d  p.multiply(0.5,m
+00023050: 6964 290d 0a20 2020 2020 2020 2072 6574  id)..        ret
+00023060: 7572 6e20 6d69 640d 0a20 2020 200d 0a20  urn mid..    .. 
+00023070: 2020 205f 6261 7365 5f73 7572 6661 6365     _base_surface
+00023080: 7320 3d20 5f67 6574 5f70 6c61 6e61 725f  s = _get_planar_
+00023090: 7375 7266 6163 6573 5f64 6963 7469 6f6e  surfaces_diction
+000230a0: 6172 792e 5f5f 6675 6e63 5f5f 2829 0d0a  ary.__func__()..
+000230b0: 2020 2020 5f64 6566 6175 6c74 5f62 6173      _default_bas
+000230c0: 6520 3d20 2771 7561 6427 2020 2320 6465  e = 'quad'  # de
+000230d0: 6661 756c 7420 6173 7369 676e 6d65 6e74  fault assignment
+000230e0: 2069 7320 696e 6469 6361 7465 6420 696e   is indicated in
+000230f0: 205f 5f69 6e69 7420 446f 6373 7472 696e   __init Docstrin
+00023100: 672e 0d0a 0d0a 2020 2020 4063 6c61 7373  g.....    @class
+00023110: 6d65 7468 6f64 0d0a 2020 2020 6465 6620  method..    def 
+00023120: 6772 6964 2863 6c73 2c78 6469 762c 2079  grid(cls,xdiv, y
+00023130: 6469 762c 2062 6173 6574 7970 653d 2772  div, basetype='r
+00023140: 272c 206d 696e 7261 643d 4e6f 6e65 2c20  ', minrad=None, 
+00023150: 6e61 6d65 3d4e 6f6e 652c 202a 2a6b 7761  name=None, **kwa
+00023160: 7267 7329 203a 0d0a 2020 2020 2020 2020  rgs) :..        
+00023170: 2222 220d 0a20 2020 2020 2020 2050 6c61  """..        Pla
+00023180: 6e61 7253 7572 6661 6365 2077 6974 6820  narSurface with 
+00023190: 5820 616e 6420 5920 7265 6374 616e 6775  X and Y rectangu
+000231a0: 6c61 7220 6661 6365 732e 0d0a 0d0a 2020  lar faces.....  
+000231b0: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+000231c0: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
+000231d0: 2d2d 2d2d 0d0a 2020 2020 2020 2020 7864  ----..        xd
+000231e0: 6976 203a 2069 6e74 6567 6572 2c20 7265  iv : integer, re
+000231f0: 7175 6972 6564 2e0d 0a20 2020 2020 2020  quired...       
+00023200: 2020 2020 204e 756d 6265 7220 6f66 2058       Number of X
+00023210: 2064 6976 6973 696f 6e73 2e0d 0a0d 0a20   divisions..... 
+00023220: 2020 2020 2020 2079 6469 7620 3a20 696e         ydiv : in
+00023230: 7465 6765 722c 2072 6571 7569 7265 642e  teger, required.
+00023240: 0d0a 2020 2020 2020 2020 2020 2020 4e75  ..            Nu
+00023250: 6d62 6572 206f 6620 5920 6469 7669 7369  mber of Y divisi
+00023260: 6f6e 732e 0d0a 0d0a 2020 2020 2020 2020  ons.....        
+00023270: 6261 7365 7479 7065 203a 207b 2764 272c  basetype : {'d',
+00023280: 2772 277d 2c20 6f70 7469 6f6e 616c 2c20  'r'}, optional, 
+00023290: 6465 6661 756c 743a 2027 7227 0d0a 2020  default: 'r'..  
+000232a0: 2020 2020 2020 2020 2020 5374 6172 7469            Starti
+000232b0: 6e67 2073 7572 6661 6365 2067 656f 6d65  ng surface geome
+000232c0: 7472 6965 7320 6672 6f6d 2077 6869 6368  tries from which
+000232d0: 2074 6865 2073 7572 6661 6365 2069 730d   the surface is.
+000232e0: 0a20 2020 2020 2020 2020 2020 2063 6f6e  .            con
+000232f0: 7374 7275 6374 6564 2069 6e64 6963 6174  structed indicat
+00023300: 696e 6720 6661 6365 2073 6861 7065 2e0d  ing face shape..
+00023310: 0a0d 0a20 2020 2020 2020 206d 696e 7261  ...        minra
+00023320: 6420 3a20 706c 6163 6568 6f6c 6465 722c  d : placeholder,
+00023330: 206e 6f74 2075 7365 642e 0d0a 0d0a 2020   not used.....  
+00023340: 2020 2020 2020 6e61 6d65 203a 2073 7472        name : str
+00023350: 696e 672c 206f 7074 696f 6e61 6c2c 2064  ing, optional, d
+00023360: 6566 6175 6c74 3a20 4e6f 6e65 2e0d 0a20  efault: None... 
+00023370: 2020 2020 2020 2020 2020 2044 6573 6372             Descr
+00023380: 6970 7469 7665 2069 6465 6e74 6966 6965  iptive identifie
+00023390: 722e 0d0a 0d0a 2020 2020 2020 2020 5261  r.....        Ra
+000233a0: 6973 6573 0d0a 2020 2020 2020 2020 2d2d  ises..        --
+000233b0: 2d2d 2d2d 0d0a 2020 2020 2020 2020 5661  ----..        Va
+000233c0: 6c75 6545 7272 6f72 0d0a 2020 2020 2020  lueError..      
+000233d0: 2020 2020 2020 4966 2078 6469 7620 6973        If xdiv is
+000233e0: 206e 6f74 2061 6e20 696e 7465 6765 7220   not an integer 
+000233f0: 6772 6561 7465 7220 6f72 2065 7175 616c  greater or equal
+00023400: 2074 6f20 312e 0d0a 2020 2020 2020 2020   to 1...        
+00023410: 2020 2020 4966 2079 6469 7620 6973 206e      If ydiv is n
+00023420: 6f74 2061 6e20 696e 7465 6765 7220 6772  ot an integer gr
+00023430: 6561 7465 7220 6f72 2065 7175 616c 2074  eater or equal t
+00023440: 6f20 312e 0d0a 0d0a 2020 2020 2020 2020  o 1.....        
+00023450: 4f74 6865 7220 5061 7261 6d65 7465 7273  Other Parameters
+00023460: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
+00023470: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
+00023480: 2020 2020 2a2a 6b77 6172 6773 0d0a 2020      **kwargs..  
+00023490: 2020 2020 2020 2020 2020 416c 6c20 6f74            All ot
+000234a0: 6865 7220 7061 7261 6d65 7465 7273 2061  her parameters a
+000234b0: 7265 2070 6173 7365 6420 6f6e 2074 6f20  re passed on to 
+000234c0: 2773 3364 6c69 622e 7375 7266 6163 652e  's3dlib.surface.
+000234d0: 5375 7266 6163 6533 4443 6f6c 6c65 6374  Surface3DCollect
+000234e0: 696f 6e27 2e0d 0a20 2020 2020 2020 200d  ion'...        .
+000234f0: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+00023500: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
+00023510: 2d0d 0a20 2020 2020 2020 2073 7572 6661  -..        surfa
+00023520: 6365 203a 2050 6c61 6e61 7253 7572 6661  ce : PlanarSurfa
+00023530: 6365 206f 626a 6563 742e 0d0a 0d0a 2020  ce object.....  
+00023540: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
+00023550: 2020 2073 706c 6974 5369 7a65 203d 204e     splitSize = N
+00023560: 6f6e 650d 0a20 2020 2020 2020 206d 696e  one..        min
+00023570: 7261 6420 3d20 4e6f 6e65 0d0a 2020 2020  rad = None..    
+00023580: 2020 2020 2320 6e6f 7465 3a20 7265 7665      # note: reve
+00023590: 7273 616c 206f 6620 6e61 6e67 2c20 6e72  rsal of nang, nr
+000235a0: 6164 2061 7267 7375 6d65 6e74 7320 636f  ad argsuments co
+000235b0: 6d70 6172 6564 2074 6f20 6f74 6865 7220  mpared to other 
+000235c0: 696e 6865 7269 7465 6420 636c 6173 7320  inherited class 
+000235d0: 6772 6964 206d 6574 686f 6473 2e0d 0a20  grid methods... 
+000235e0: 2020 2020 2020 206e 7261 642c 206e 616e         nrad, nan
+000235f0: 6720 3d20 7964 6976 2c20 7864 6976 0d0a  g = ydiv, xdiv..
+00023600: 2020 2020 2020 2020 7375 7266 6163 6520          surface 
+00023610: 3d20 636c 732e 5f73 7175 6172 655f 6e65  = cls._square_ne
+00023620: 7428 6e72 6164 2c20 6e61 6e67 2c20 6261  t(nrad, nang, ba
+00023630: 7365 7479 7065 2c6d 696e 7261 642c 2073  setype,minrad, s
+00023640: 706c 6974 5369 7a65 2c20 6e61 6d65 2c20  plitSize, name, 
+00023650: 2a2a 6b77 6172 6773 290d 0a20 2020 2020  **kwargs)..     
+00023660: 2020 2073 7572 6661 6365 2e5f 706f 7374     surface._post
+00023670: 5072 6f63 5f73 7572 6661 6365 436f 6c6f  Proc_surfaceColo
+00023680: 7273 2854 7275 6529 0d0a 2020 2020 2020  rs(True)..      
+00023690: 2020 7375 7266 6163 652e 5f72 657a 203d    surface._rez =
+000236a0: 2073 7572 6661 6365 2e5f 6361 6c63 5f72   surface._calc_r
+000236b0: 657a 2820 3420 290d 0a20 2020 2020 2020  ez( 4 )..       
+000236c0: 2072 6574 7572 6e20 7375 7266 6163 650d   return surface.
+000236d0: 0a0d 0a20 2020 2040 636c 6173 736d 6574  ...    @classmet
+000236e0: 686f 640d 0a20 2020 2064 6566 2070 6e74  hod..    def pnt
+000236f0: 7375 7266 2863 6c73 2c20 7879 7a5f 706f  surf(cls, xyz_po
+00023700: 696e 7473 2c20 6e61 6d65 3d4e 6f6e 652c  ints, name=None,
+00023710: 202a 2a6b 6172 6773 2920 3a0d 0a20 2020   **kargs) :..   
+00023720: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
+00023730: 2020 506c 616e 6172 5375 7266 6163 6520    PlanarSurface 
+00023740: 6672 6f6d 2070 6f69 6e74 7320 696e 2043  from points in C
+00023750: 6172 7465 7369 616e 2063 6f6f 7264 696e  artesian coordin
+00023760: 6174 6573 2e0d 0a0d 0a20 2020 2020 2020  ates.....       
+00023770: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
+00023780: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
+00023790: 0a20 2020 2020 2020 2078 797a 5f70 6f69  .        xyz_poi
+000237a0: 6e74 7320 3a20 6172 7261 792c 2072 6571  nts : array, req
+000237b0: 7569 7265 642e 0d0a 2020 2020 2020 2020  uired...        
+000237c0: 2020 2020 416e 204e 2058 2033 2061 7272      An N X 3 arr
+000237d0: 6179 206f 6620 4e20 4361 7274 6573 6961  ay of N Cartesia
+000237e0: 6e20 636f 6f72 6469 6e61 7465 2070 6f69  n coordinate poi
+000237f0: 6e74 732e 0d0a 0d0a 2020 2020 2020 2020  nts.....        
+00023800: 6e61 6d65 203a 2073 7472 696e 672c 206f  name : string, o
+00023810: 7074 696f 6e61 6c2c 2064 6566 6175 6c74  ptional, default
+00023820: 3a20 4e6f 6e65 2e0d 0a20 2020 2020 2020  : None...       
+00023830: 2020 2020 2044 6573 6372 6970 7469 7665       Descriptive
+00023840: 2069 6465 6e74 6966 6965 7220 666f 7220   identifier for 
+00023850: 7468 6520 706f 696e 7420 7375 7266 6163  the point surfac
+00023860: 652e 0d0a 0d0a 2020 2020 2020 2020 5265  e.....        Re
+00023870: 7475 726e 730d 0a20 2020 2020 2020 202d  turns..        -
+00023880: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
+00023890: 7375 7266 6163 6520 3a20 506c 616e 6172  surface : Planar
+000238a0: 5375 7266 6163 6520 6f62 6a65 6374 0d0a  Surface object..
+000238b0: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
+000238c0: 2020 2020 2020 2064 6174 6150 7473 203d         dataPts =
+000238d0: 206e 702e 6172 7261 7928 7879 7a5f 706f   np.array(xyz_po
+000238e0: 696e 7473 290d 0a20 2020 2020 2020 2078  ints)..        x
+000238f0: 797a 5074 7320 3d20 6461 7461 5074 732e  yzPts = dataPts.
+00023900: 540d 0a0d 0a20 2020 2020 2020 2066 7649  T....        fvI
+00023910: 6e64 6963 6573 203d 2074 7269 2e54 7269  ndices = tri.Tri
+00023920: 616e 6775 6c61 7469 6f6e 2878 797a 5074  angulation(xyzPt
+00023930: 735b 305d 2c78 797a 5074 735b 315d 292e  s[0],xyzPts[1]).
+00023940: 7472 6961 6e67 6c65 730d 0a20 2020 2020  triangles..     
+00023950: 2020 2062 6173 655f 7375 7266 6163 6520     base_surface 
+00023960: 3d20 5375 7266 6163 6533 4443 6f6c 6c65  = Surface3DColle
+00023970: 6374 696f 6e28 6461 7461 5074 732c 2066  ction(dataPts, f
+00023980: 7649 6e64 6963 6573 2c20 636f 6c6f 723d  vIndices, color=
+00023990: 2774 616e 2729 2e73 6861 6465 2829 0d0a  'tan').shade()..
+000239a0: 2020 2020 2020 2020 6661 6365 496e 6469          faceIndi
+000239b0: 6365 7320 3d20 6261 7365 5f73 7572 6661  ces = base_surfa
+000239c0: 6365 2e66 7649 6e64 6963 6573 0d0a 2020  ce.fvIndices..  
+000239d0: 2020 2020 2020 7665 7274 7320 3d20 6461        verts = da
+000239e0: 7461 5074 730d 0a0d 0a20 2020 2020 2020  taPts....       
+000239f0: 2069 6620 6e61 6d65 2069 7320 4e6f 6e65   if name is None
+00023a00: 203a 206e 616d 6520 3d20 2770 6f69 6e74   : name = 'point
+00023a10: 2073 7572 6661 6365 270d 0a20 2020 2020   surface'..     
+00023a20: 2020 2073 7572 6661 6365 203d 2050 6c61     surface = Pla
+00023a30: 6e61 7253 7572 6661 6365 286e 616d 653d  narSurface(name=
+00023a40: 6e61 6d65 2c2a 2a6b 6172 6773 2920 0d0a  name,**kargs) ..
+00023a50: 2020 2020 2020 2020 7375 7266 6163 652e          surface.
+00023a60: 7665 7274 6578 436f 6f72 203d 2076 6572  vertexCoor = ver
+00023a70: 7473 0d0a 2020 2020 2020 2020 7375 7266  ts..        surf
+00023a80: 6163 652e 6676 496e 6469 6365 7320 3d20  ace.fvIndices = 
+00023a90: 6661 6365 496e 6469 6365 730d 0a20 2020  faceIndices..   
+00023aa0: 2020 2020 2073 7572 6661 6365 2e65 7649       surface.evI
+00023ab0: 6e64 6963 6573 203d 2073 7572 6661 6365  ndices = surface
+00023ac0: 2e5f 6765 745f 6564 6765 735f 6672 6f6d  ._get_edges_from
+00023ad0: 5f66 6163 6573 2866 6163 6549 6e64 6963  _faces(faceIndic
+00023ae0: 6573 290d 0a20 2020 2020 2020 2073 7572  es)..        sur
+00023af0: 6661 6365 2e76 6649 6e64 6963 6573 4c69  face.vfIndicesLi
+00023b00: 7374 203d 2073 7572 6661 6365 2e5f 7665  st = surface._ve
+00023b10: 7274 6578 436f 6d6d 6f6e 4661 6365 496e  rtexCommonFaceIn
+00023b20: 6469 6365 7328 290d 0a20 2020 2020 2020  dices()..       
+00023b30: 2073 7572 6661 6365 2e65 6649 6e64 6963   surface.efIndic
+00023b40: 6573 4c69 7374 203d 2073 7572 6661 6365  esList = surface
+00023b50: 2e5f 6564 6765 436f 6d6d 6f6e 4661 6365  ._edgeCommonFace
+00023b60: 496e 6469 6365 7328 290d 0a20 2020 2020  Indices()..     
+00023b70: 2020 2073 7572 6661 6365 2e73 6574 5f76     surface.set_v
+00023b80: 6572 7473 2820 7665 7274 735b 6661 6365  erts( verts[face
+00023b90: 496e 6469 6365 735d 2029 0d0a 2020 2020  Indices] )..    
+00023ba0: 2020 2020 7375 7266 6163 652e 5f73 6574      surface._set
+00023bb0: 5f67 656f 6d65 7472 6963 5f62 6f75 6e64  _geometric_bound
+00023bc0: 7328 290d 0a20 2020 2020 2020 2073 7572  s()..        sur
+00023bd0: 6661 6365 2e5f 7265 7a20 3d20 7375 7266  face._rez = surf
+00023be0: 6163 652e 5f63 616c 635f 7265 7a28 3429  ace._calc_rez(4)
+00023bf0: 0d0a 2020 2020 2020 2020 7375 7266 6163  ..        surfac
+00023c00: 652e 5f62 6173 6574 7970 6520 3d20 2770  e._basetype = 'p
+00023c10: 6e74 7375 7266 270d 0a20 2020 2020 2020  ntsurf'..       
+00023c20: 2072 6574 7572 6e20 7375 7266 6163 650d   return surface.
+00023c30: 0a0d 0a20 2020 2040 636c 6173 736d 6574  ...    @classmet
+00023c40: 686f 640d 0a20 2020 2064 6566 205f 5866  hod..    def _Xf
+00023c50: 6576 2863 6c73 2c72 657a 2c20 6261 7365  ev(cls,rez, base
+00023c60: 7479 7065 3d4e 6f6e 6529 203a 0d0a 2020  type=None) :..  
+00023c70: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
+00023c80: 2020 2043 616c 6375 6c61 7465 7320 7468     Calculates th
+00023c90: 6520 6e75 6d62 6572 206f 6620 6661 6365  e number of face
+00023ca0: 732c 2065 6467 6573 2c20 616e 6420 7665  s, edges, and ve
+00023cb0: 7274 6963 6573 206f 6620 6120 506c 616e  rtices of a Plan
+00023cc0: 6172 5375 7266 6163 652e 0d0a 0d0a 2020  arSurface.....  
+00023cd0: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+00023ce0: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
+00023cf0: 2d2d 2d2d 0d0a 2020 2020 2020 2020 7265  ----..        re
+00023d00: 7a20 3a20 696e 7465 6765 720d 0a20 2020  z : integer..   
+00023d10: 2020 2020 2020 2020 204e 756d 6265 7220           Number 
+00023d20: 6f66 2072 6563 7572 7369 7665 2073 7562  of recursive sub
+00023d30: 6469 7669 7369 6f6e 7320 6f66 2061 2074  divisions of a t
+00023d40: 7269 616e 6775 6c61 7465 6420 6261 7365  riangulated base
+00023d50: 2066 6163 6573 2e0d 0a20 2020 2020 2020   faces...       
+00023d60: 200d 0a20 2020 2020 2020 2062 6173 6574   ..        baset
+00023d70: 7970 6520 3a20 7374 7269 6e67 0d0a 2020  ype : string..  
+00023d80: 2020 2020 2020 2020 2020 5374 6172 7469            Starti
+00023d90: 6e67 2073 7572 6661 6365 2067 656f 6d65  ng surface geome
+00023da0: 7472 6965 7320 6672 6f6d 2077 6869 6368  tries from which
+00023db0: 2074 6865 2073 7572 6661 6365 2077 6f75   the surface wou
+00023dc0: 6c64 2062 650d 0a20 2020 2020 2020 2020  ld be..         
+00023dd0: 2020 2063 6f6e 7374 7275 6374 6564 2075     constructed u
+00023de0: 7369 6e67 2072 6563 7572 7369 7665 2073  sing recursive s
+00023df0: 7562 6469 7669 7369 6f6e 7320 6f66 2074  ubdivisions of t
+00023e00: 6865 2074 7269 616e 6775 6c61 7220 6661  he triangular fa
+00023e10: 6365 732e 0d0a 2020 2020 2020 2020 0d0a  ces...        ..
+00023e20: 2020 2020 2020 2020 5265 7475 726e 730d          Returns.
+00023e30: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00023e40: 0d0a 2020 2020 2020 2020 6c69 7374 3a20  ..        list: 
+00023e50: 7468 6520 6e75 6d62 6572 206f 6620 6661  the number of fa
+00023e60: 6365 732c 2065 6467 6573 2c20 616e 6420  ces, edges, and 
+00023e70: 7665 7274 6963 6573 2e0d 0a0d 0a20 2020  vertices.....   
+00023e80: 2020 2020 2022 2222 0d0a 0d0a 2020 2020       """....    
+00023e90: 2020 2020 7265 7475 726e 2073 7570 6572      return super
+00023ea0: 2829 2e5f 6665 7628 7265 7a2c 6261 7365  ()._fev(rez,base
+00023eb0: 7479 7065 2c63 6c73 290d 0a0d 0a20 2020  type,cls)....   
+00023ec0: 2040 7374 6174 6963 6d65 7468 6f64 0d0a   @staticmethod..
+00023ed0: 2020 2020 6465 6620 6d65 7368 6772 6964      def meshgrid
+00023ee0: 2858 2c59 2c5a 2c72 6576 6e6f 726d 616c  (X,Y,Z,revnormal
+00023ef0: 3d46 616c 7365 2c67 7269 643d 4661 6c73  =False,grid=Fals
+00023f00: 652c 206e 616d 653d 4e6f 6e65 2920 3a0d  e, name=None) :.
+00023f10: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
+00023f20: 2020 2020 2020 506c 616e 6172 5375 7266        PlanarSurf
+00023f30: 6163 6520 6f62 6a65 6374 2062 6173 6564  ace object based
+00023f40: 206f 6e20 6120 6d65 7368 6772 6964 2e0d   on a meshgrid..
+00023f50: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+00023f60: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
+00023f70: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00023f80: 2d0d 0a20 2020 2020 2020 2058 2c59 2c5a  -..        X,Y,Z
+00023f90: 203a 204e 2078 204d 2061 7272 6179 730d   : N x M arrays.
+00023fa0: 0a20 2020 2020 2020 2020 2020 2043 6172  .            Car
+00023fb0: 7465 7369 616e 2078 2c79 2c7a 2063 6f6f  tesian x,y,z coo
+00023fc0: 7264 696e 6174 6520 7661 6c75 6573 2e0d  rdinate values..
+00023fd0: 0a0d 0a20 2020 2020 2020 2072 6576 6e6f  ...        revno
+00023fe0: 726d 616c 203a 207b 2054 7275 652c 2046  rmal : { True, F
+00023ff0: 616c 7365 207d 2c20 626f 6f6c 6561 6e2c  alse }, boolean,
+00024000: 2064 6566 6175 6c74 3a20 4661 6c73 650d   default: False.
+00024010: 0a20 2020 2020 2020 2020 2020 2052 6576  .            Rev
+00024020: 6572 7365 2074 6865 2066 6163 6520 6e6f  erse the face no
+00024030: 726d 616c 2064 6972 6563 7469 6f6e 7320  rmal directions 
+00024040: 6966 2054 7275 652e 0d0a 0d0a 2020 2020  if True.....    
+00024050: 2020 2020 6772 6964 203a 207b 2054 7275      grid : { Tru
+00024060: 652c 2046 616c 7365 207d 2c20 626f 6f6c  e, False }, bool
+00024070: 6561 6e2c 2064 6566 6175 6c74 3a20 4661  ean, default: Fa
+00024080: 6c73 650d 0a20 2020 2020 2020 2020 2020  lse..           
+00024090: 2049 6620 5472 7565 2c20 706f 6c79 676f   If True, polygo
+000240a0: 6e20 6661 6365 7320 6172 6520 7265 6374  n faces are rect
+000240b0: 616e 6775 6c61 722e 2020 4966 0d0a 2020  angular.  If..  
+000240c0: 2020 2020 2020 2020 2020 4661 6c73 652c            False,
+000240d0: 2070 6f6c 7967 6f6e 2066 6163 6573 2061   polygon faces a
+000240e0: 7265 2074 7269 616e 6775 6c61 722e 0d0a  re triangular...
+000240f0: 0d0a 2020 2020 2020 2020 6e61 6d65 203a  ..        name :
+00024100: 2073 7472 696e 672c 206f 7074 696f 6e61   string, optiona
+00024110: 6c2c 2064 6566 6175 6c74 3a20 4e6f 6e65  l, default: None
+00024120: 2e0d 0a20 2020 2020 2020 2020 2020 2044  ...            D
+00024130: 6573 6372 6970 7469 7665 2069 6465 6e74  escriptive ident
+00024140: 6966 6965 7220 666f 7220 7468 6520 6d65  ifier for the me
+00024150: 7368 2073 7572 6661 6365 2e0d 0a0d 0a20  sh surface..... 
+00024160: 2020 2020 2020 2052 6574 7572 6e73 0d0a         Returns..
+00024170: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0d          -------.
+00024180: 0a20 2020 2020 2020 2073 7572 6661 6365  .        surface
+00024190: 203a 2050 6c61 6e61 7253 7572 6661 6365   : PlanarSurface
+000241a0: 206f 626a 6563 740d 0a20 2020 2020 2020   object..       
+000241b0: 200d 0a20 2020 2020 2020 2022 2222 0d0a   ..        """..
+000241c0: 0d0a 2020 2020 2020 2020 7665 7274 436f  ..        vertCo
+000241d0: 6f72 203d 206e 702e 7265 7368 6170 6528  or = np.reshape(
+000241e0: 6e70 2e73 7461 636b 2828 582c 592c 5a29  np.stack((X,Y,Z)
+000241f0: 2c20 6178 6973 3d32 2029 2c20 282d 312c  , axis=2 ), (-1,
+00024200: 3329 2029 0d0a 2020 2020 2020 2020 6c65  3) )..        le
+00024210: 6e59 2c20 6c65 6e58 203d 205a 2e73 6861  nY, lenX = Z.sha
+00024220: 7065 0d0a 2020 2020 2020 2020 6d74 7220  pe..        mtr 
+00024230: 3d20 6e70 2e72 6573 6861 7065 2820 6e70  = np.reshape( np
+00024240: 2e61 7261 6e67 6528 6c65 6e58 2a6c 656e  .arange(lenX*len
+00024250: 5929 2020 2c20 286c 656e 592c 6c65 6e58  Y)  , (lenY,lenX
+00024260: 2929 0d0a 2020 2020 2020 2020 4120 3d20  ))..        A = 
+00024270: 6d74 725b 3a2c 303a 6c65 6e58 2d31 5d5b  mtr[:,0:lenX-1][
+00024280: 303a 6c65 6e59 2d31 2c3a 5d2e 666c 6174  0:lenY-1,:].flat
+00024290: 7465 6e28 290d 0a20 2020 2020 2020 2042  ten()..        B
+000242a0: 203d 2041 202b 2031 0d0a 2020 2020 2020   = A + 1..      
+000242b0: 2020 4320 3d20 4120 2b20 6c65 6e58 202b    C = A + lenX +
+000242c0: 310d 0a20 2020 2020 2020 2044 203d 2041  1..        D = A
+000242d0: 202b 206c 656e 580d 0a20 2020 2020 2020   + lenX..       
+000242e0: 2069 6620 7265 766e 6f72 6d61 6c20 3a0d   if revnormal :.
+000242f0: 0a20 2020 2020 2020 2020 2020 2074 203d  .            t =
+00024300: 2042 0d0a 2020 2020 2020 2020 2020 2020   B..            
+00024310: 4220 3d20 440d 0a20 2020 2020 2020 2020  B = D..         
+00024320: 2020 2044 203d 2074 0d0a 2020 2020 2020     D = t..      
+00024330: 2020 6661 6365 496e 6469 6365 7320 3d20    faceIndices = 
+00024340: 6e70 2e73 7461 636b 2820 2841 2c42 2c43  np.stack( (A,B,C
+00024350: 2c44 2920 292e 540d 0a0d 0a20 2020 2020  ,D) ).T....     
+00024360: 2020 2069 6620 6772 6964 203a 206f 626a     if grid : obj
+00024370: 203d 2050 6c61 6e61 7253 7572 6661 6365   = PlanarSurface
+00024380: 2820 6261 7365 7479 7065 3d27 7371 7527  ( basetype='squ'
+00024390: 290d 0a20 2020 2020 2020 2065 6c73 6520  )..        else 
+000243a0: 3a20 2020 206f 626a 203d 2050 6c61 6e61  :    obj = Plana
+000243b0: 7253 7572 6661 6365 2820 290d 0a20 2020  rSurface( )..   
+000243c0: 2020 2020 206f 626a 2e76 6572 7465 7843       obj.vertexC
+000243d0: 6f6f 7220 3d20 7665 7274 436f 6f72 0d0a  oor = vertCoor..
+000243e0: 2020 2020 2020 2020 6f62 6a2e 6676 496e          obj.fvIn
+000243f0: 6469 6365 7320 3d20 6661 6365 496e 6469  dices = faceIndi
+00024400: 6365 730d 0a20 2020 2020 2020 206f 626a  ces..        obj
+00024410: 2e5f 6e6f 726d 616c 5f73 6361 6c65 203d  ._normal_scale =
+00024420: 205f 6e6f 726d 4c65 6e67 7468 2820 6c65   _normLength( le
+00024430: 6e28 6661 6365 496e 6469 6365 7329 2c20  n(faceIndices), 
+00024440: 302c 2030 2c20 3420 290d 0a20 2020 2020  0, 0, 4 )..     
+00024450: 2020 206f 626a 2e5f 7365 745f 6765 6f6d     obj._set_geom
+00024460: 6574 7269 635f 626f 756e 6473 2829 0d0a  etric_bounds()..
+00024470: 2020 2020 2020 2020 6f62 6a2e 5f73 7572          obj._sur
+00024480: 6661 6365 5368 6170 6543 6861 6e67 6564  faceShapeChanged
+00024490: 203d 2054 7275 6520 2020 2020 2020 200d   = True        .
+000244a0: 0a0d 0a20 2020 2020 2020 2076 203d 206f  ...        v = o
+000244b0: 626a 2e76 6572 7465 7843 6f6f 720d 0a20  bj.vertexCoor.. 
+000244c0: 2020 2020 2020 2066 7669 203d 206f 626a         fvi = obj
+000244d0: 2e66 7649 6e64 6963 6573 0d0a 0d0a 2020  .fvIndices....  
+000244e0: 2020 2020 2020 6966 2067 7269 6420 3a0d        if grid :.
+000244f0: 0a20 2020 2020 2020 2020 2020 206f 626a  .            obj
+00024500: 2e76 6649 6e64 6963 6573 4c69 7374 203d  .vfIndicesList =
+00024510: 206f 626a 2e5f 7665 7274 6578 436f 6d6d   obj._vertexComm
+00024520: 6f6e 4661 6365 496e 6469 6365 7328 290d  onFaceIndices().
+00024530: 0a20 2020 2020 2020 2020 2020 2065 6467  .            edg
+00024540: 6549 6e64 6963 6573 203d 206f 626a 2e5f  eIndices = obj._
+00024550: 6765 745f 6564 6765 735f 6672 6f6d 5f66  get_edges_from_f
+00024560: 6163 6573 286f 626a 2e66 7649 6e64 6963  aces(obj.fvIndic
+00024570: 6573 290d 0a20 2020 2020 2020 2020 2020  es)..           
+00024580: 206f 626a 2e65 7649 6e64 6963 6573 203d   obj.evIndices =
+00024590: 206e 702e 6172 7261 7928 6564 6765 496e   np.array(edgeIn
+000245a0: 6469 6365 7329 0d0a 2020 2020 2020 2020  dices)..        
+000245b0: 2020 2020 6f62 6a2e 6566 496e 6469 6365      obj.efIndice
+000245c0: 734c 6973 7420 3d20 6f62 6a2e 5f65 6467  sList = obj._edg
+000245d0: 6543 6f6d 6d6f 6e46 6163 6549 6e64 6963  eCommonFaceIndic
+000245e0: 6573 2829 0d0a 0d0a 2020 2020 2020 2020  es()....        
+000245f0: 6f62 6a2e 7365 745f 7665 7274 7328 765b  obj.set_verts(v[
+00024600: 6676 695d 290d 0a0d 0a20 2020 2020 2020  fvi])....       
+00024610: 2069 6620 6e6f 7420 6772 6964 203a 206f   if not grid : o
+00024620: 626a 2e74 7269 616e 6775 6c61 7465 2829  bj.triangulate()
+00024630: 0d0a 2020 2020 2020 2020 6966 206e 616d  ..        if nam
+00024640: 6520 6973 204e 6f6e 6520 3a20 6e61 6d65  e is None : name
+00024650: 203d 2027 6d65 7368 6772 6964 270d 0a20   = 'meshgrid'.. 
+00024660: 2020 2020 2020 206f 626a 2e6e 616d 6520         obj.name 
+00024670: 3d20 6e61 6d65 0d0a 0d0a 2020 2020 2020  = name....      
+00024680: 2020 7265 7475 726e 206f 626a 0d0a 0d0a    return obj....
+00024690: 2020 2020 6465 6620 5f5f 696e 6974 5f5f      def __init__
+000246a0: 2873 656c 662c 2072 657a 3d30 2c20 6261  (self, rez=0, ba
+000246b0: 7365 7479 7065 3d4e 6f6e 652c 206e 616d  setype=None, nam
+000246c0: 653d 4e6f 6e65 2c20 2a2a 6b77 6172 6773  e=None, **kwargs
+000246d0: 293a 0d0a 2020 2020 2020 2020 2222 220d  ):..        """.
+000246e0: 0a20 2020 2020 2020 2043 7265 6174 6520  .        Create 
+000246f0: 666c 6174 2073 7175 6172 6520 7375 7266  flat square surf
+00024700: 6163 6520 6f66 2032 2078 2032 2075 6e69  ace of 2 x 2 uni
+00024710: 7473 2e0d 0a0d 0a20 2020 2020 2020 2050  ts.....        P
+00024720: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
+00024730: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
+00024740: 2020 2020 2020 2072 657a 203a 2069 6e74         rez : int
+00024750: 6567 6572 2c20 6f70 7469 6f6e 616c 2c20  eger, optional, 
+00024760: 6465 6661 756c 743a 2030 0d0a 2020 2020  default: 0..    
+00024770: 2020 2020 2020 2020 4e75 6d62 6572 206f          Number o
+00024780: 6620 7265 6375 7273 6976 6520 7375 6264  f recursive subd
+00024790: 6976 6973 696f 6e73 206f 6620 7468 6520  ivisions of the 
+000247a0: 7472 6961 6e67 756c 6174 6564 2062 6173  triangulated bas
+000247b0: 6520 6661 6365 732e 0d0a 2020 2020 2020  e faces...      
+000247c0: 2020 2020 2020 5265 7a20 7661 6c75 6573        Rez values
+000247d0: 2072 616e 6765 2066 726f 6d20 3020 746f   range from 0 to
+000247e0: 2037 2e0d 0a20 2020 2020 2020 2020 2020   7...           
+000247f0: 200d 0a20 2020 2020 2020 2062 6173 6574   ..        baset
+00024800: 7970 6520 3a20 7b27 7175 6164 272c 276f  ype : {'quad','o
+00024810: 6374 3127 2c27 6f63 7432 272c 2773 7175  ct1','oct2','squ
+00024820: 277d 2c20 6f70 7469 6f6e 616c 2c20 6465  '}, optional, de
+00024830: 6661 756c 743a 2027 7175 6164 270d 0a20  fault: 'quad'.. 
+00024840: 2020 2020 2020 2020 2020 2053 7461 7274             Start
+00024850: 696e 6720 7375 7266 6163 6520 6765 6f6d  ing surface geom
+00024860: 6574 7269 6573 2066 726f 6d20 7768 6963  etries from whic
+00024870: 6820 7468 6520 7375 7266 6163 6520 6973  h the surface is
+00024880: 0d0a 2020 2020 2020 2020 2020 2020 636f  ..            co
+00024890: 6e73 7472 7563 7465 6420 7573 696e 6720  nstructed using 
+000248a0: 7265 6375 7273 6976 6520 7375 6264 6976  recursive subdiv
+000248b0: 6973 696f 6e73 206f 6620 7468 6520 6661  isions of the fa
+000248c0: 6365 732e 0d0a 0d0a 2020 2020 2020 2020  ces.....        
+000248d0: 6e61 6d65 203a 2073 7472 696e 672c 206f  name : string, o
+000248e0: 7074 696f 6e61 6c2c 2064 6566 6175 6c74  ptional, default
+000248f0: 3a20 4e6f 6e65 2e0d 0a20 2020 2020 2020  : None...       
+00024900: 2020 2020 2044 6573 6372 6970 7469 7665       Descriptive
+00024910: 2069 6465 6e74 6966 6965 7220 666f 7220   identifier for 
+00024920: 7468 6520 6765 6f6d 6574 7279 2e0d 0a0d  the geometry....
+00024930: 0a20 2020 2020 2020 2052 6169 7365 730d  .        Raises.
+00024940: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d0d  .        ------.
+00024950: 0a20 2020 2020 2020 2056 616c 7565 4572  .        ValueEr
+00024960: 726f 720d 0a20 2020 2020 2020 2020 2020  ror..           
+00024970: 2049 6620 7265 7a20 6973 206e 6f74 2061   If rez is not a
+00024980: 6e20 696e 7465 6765 7220 696e 2072 616e  n integer in ran
+00024990: 6765 2030 2074 6f20 372e 0d0a 2020 2020  ge 0 to 7...    
+000249a0: 2020 2020 2020 2020 4966 2062 6173 6574          If baset
+000249b0: 7970 6520 6973 206e 6f74 2072 6563 6f67  ype is not recog
+000249c0: 6e69 7a65 6420 666f 7220 7468 6973 2073  nized for this s
+000249d0: 7572 6661 6365 2063 6f6e 7374 7275 6374  urface construct
+000249e0: 6f72 2e0d 0a0d 0a20 2020 2020 2020 204f  or.....        O
+000249f0: 7468 6572 2050 6172 616d 6574 6572 730d  ther Parameters.
+00024a00: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00024a10: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
+00024a20: 2020 202a 2a6b 7761 7267 730d 0a20 2020     **kwargs..   
+00024a30: 2020 2020 2020 2020 2041 6c6c 206f 7468           All oth
+00024a40: 6572 2070 6172 616d 6574 6572 7320 6172  er parameters ar
+00024a50: 6520 7061 7373 6564 206f 6e20 746f 2027  e passed on to '
+00024a60: 7333 646c 6962 2e73 7572 6661 6365 2e53  s3dlib.surface.S
+00024a70: 7572 6661 6365 3344 436f 6c6c 6563 7469  urface3DCollecti
+00024a80: 6f6e 272e 0d0a 0d0a 2020 2020 2020 2020  on'.....        
+00024a90: 2222 220d 0a0d 0a20 2020 2020 2020 2069  """....        i
+00024aa0: 6620 6e6f 7420 6973 696e 7374 616e 6365  f not isinstance
+00024ab0: 2872 657a 2c20 696e 7429 203a 0d0a 2020  (rez, int) :..  
+00024ac0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00024ad0: 5661 6c75 6545 7272 6f72 2827 496e 636f  ValueError('Inco
+00024ae0: 7272 6563 7420 7265 7a20 7479 7065 2c20  rrect rez type, 
+00024af0: 6d75 7374 2062 6120 6f66 2074 7970 6520  must ba of type 
+00024b00: 696e 7427 290d 0a20 2020 2020 2020 2069  int')..        i
+00024b10: 6620 2872 657a 3c30 2920 6f72 2028 7265  f (rez<0) or (re
+00024b20: 7a3e 5f4d 4158 5245 5a29 203a 0d0a 2020  z>_MAXREZ) :..  
+00024b30: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00024b40: 5661 6c75 6545 7272 6f72 2827 496e 636f  ValueError('Inco
+00024b50: 7272 6573 7420 7265 7a20 6f66 207b 7d2c  rrest rez of {},
+00024b60: 206d 7573 7420 6265 2061 6e20 696e 742c   must be an int,
+00024b70: 2030 203c 3d20 7265 7a20 3c3d 207b 7d27   0 <= rez <= {}'
+00024b80: 2e66 6f72 6d61 7428 7265 7a2c 5f4d 4158  .format(rez,_MAX
+00024b90: 5245 5a29 290d 0a20 2020 2020 2020 2069  REZ))..        i
+00024ba0: 6620 6261 7365 7479 7065 2069 7320 4e6f  f basetype is No
+00024bb0: 6e65 203a 2062 6173 6574 7970 6520 3d20  ne : basetype = 
+00024bc0: 7365 6c66 2e5f 6465 6661 756c 745f 6261  self._default_ba
+00024bd0: 7365 0d0a 2020 2020 2020 2020 6966 2062  se..        if b
+00024be0: 6173 6574 7970 6520 6e6f 7420 696e 2073  asetype not in s
+00024bf0: 656c 662e 5f62 6173 655f 7375 7266 6163  elf._base_surfac
+00024c00: 6573 203a 0d0a 2020 2020 2020 2020 2020  es :..          
+00024c10: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+00024c20: 6f72 2827 4261 7365 7479 7065 207b 7d20  or('Basetype {} 
+00024c30: 6973 206e 6f74 2072 6563 6f67 6e69 7a65  is not recognize
+00024c40: 642e 2050 6f73 7369 626c 6520 7661 6c75  d. Possible valu
+00024c50: 6573 2061 7265 3a20 7b7d 272e 666f 726d  es are: {}'.form
+00024c60: 6174 2862 6173 6574 7970 652c 6c69 7374  at(basetype,list
+00024c70: 2873 656c 662e 5f62 6173 655f 7375 7266  (self._base_surf
+00024c80: 6163 6573 2929 290d 0a20 2020 2020 2020  aces)))..       
+00024c90: 2062 6173 6553 7572 664f 626a 203d 2073   baseSurfObj = s
+00024ca0: 656c 662e 5f62 6173 655f 7375 7266 6163  elf._base_surfac
+00024cb0: 6573 5b62 6173 6574 7970 655d 0d0a 2020  es[basetype]..  
+00024cc0: 2020 2020 2020 6261 7365 5663 6f6f 7220        baseVcoor 
+00024cd0: 3d20 6261 7365 5375 7266 4f62 6a5b 2762  = baseSurfObj['b
+00024ce0: 6173 6556 6572 7469 6365 7343 6f6f 7227  aseVerticesCoor'
+00024cf0: 5d0d 0a20 2020 2020 2020 2062 6173 6546  ]..        baseF
+00024d00: 6163 6556 6572 7465 7849 6e64 6963 6573  aceVertexIndices
+00024d10: 203d 6261 7365 5375 7266 4f62 6a5b 2762   =baseSurfObj['b
+00024d20: 6173 6546 6163 6549 6e64 6963 6573 275d  aseFaceIndices']
+00024d30: 0d0a 2020 2020 2020 2020 6966 2062 6173  ..        if bas
+00024d40: 6574 7970 6520 3d3d 2027 7371 7527 203a  etype == 'squ' :
+00024d50: 0d0a 2020 2020 2020 2020 2020 2020 696e  ..            in
+00024d60: 6465 784f 626a 2c76 6572 7465 7843 6f6f  dexObj,vertexCoo
+00024d70: 7220 3d20 7365 6c66 2e72 6563 7461 6e67  r = self.rectang
+00024d80: 756c 6174 6542 6173 6528 7265 7a2c 6261  ulateBase(rez,ba
+00024d90: 7365 5663 6f6f 722c 6261 7365 4661 6365  seVcoor,baseFace
+00024da0: 5665 7274 6578 496e 6469 6365 732c 2073  VertexIndices, s
+00024db0: 656c 662e 5f6d 6964 5665 6374 6f72 4675  elf._midVectorFu
+00024dc0: 6e29 0d0a 2020 2020 2020 2020 656c 7365  n)..        else
+00024dd0: 203a 2020 2020 0d0a 2020 2020 2020 2020   :    ..        
+00024de0: 2020 2020 696e 6465 784f 626a 2c76 6572      indexObj,ver
+00024df0: 7465 7843 6f6f 7220 3d20 7365 6c66 2e74  texCoor = self.t
+00024e00: 7269 616e 6775 6c61 7465 4261 7365 2872  riangulateBase(r
+00024e10: 657a 2c62 6173 6556 636f 6f72 2c62 6173  ez,baseVcoor,bas
+00024e20: 6546 6163 6556 6572 7465 7849 6e64 6963  eFaceVertexIndic
+00024e30: 6573 2c20 7365 6c66 2e5f 6d69 6456 6563  es, self._midVec
+00024e40: 746f 7246 756e 290d 0a20 2020 2020 2020  torFun)..       
+00024e50: 2066 6163 6549 6e64 6963 6573 203d 2069   faceIndices = i
+00024e60: 6e64 6578 4f62 6a5b 2766 6163 6527 5d0d  ndexObj['face'].
+00024e70: 0a0d 0a20 2020 2020 2020 2073 7570 6572  ...        super
+00024e80: 2829 2e5f 5f69 6e69 745f 5f28 7665 7274  ().__init__(vert
+00024e90: 6578 436f 6f72 2c20 6661 6365 496e 6469  exCoor, faceIndi
+00024ea0: 6365 732c 206e 616d 652c 202a 2a6b 7761  ces, name, **kwa
+00024eb0: 7267 7329 0d0a 0d0a 2020 2020 2020 2020  rgs)....        
+00024ec0: 7365 6c66 2e63 6f6f 7254 7970 6520 3d20  self.coorType = 
+00024ed0: 5f43 4f4f 5253 5953 5b22 5859 5a22 5d0d  _COORSYS["XYZ"].
+00024ee0: 0a20 2020 2020 2020 2073 656c 662e 5f6e  .        self._n
+00024ef0: 6f72 6d61 6c5f 7363 616c 6520 3d20 5f6e  ormal_scale = _n
+00024f00: 6f72 6d4c 656e 6774 6828 206c 656e 2866  ormLength( len(f
+00024f10: 6163 6549 6e64 6963 6573 292c 2030 2c20  aceIndices), 0, 
+00024f20: 302c 2034 2029 0d0a 2020 2020 2020 2020  0, 4 )..        
+00024f30: 7365 6c66 2e5f 7265 7a20 3d20 7265 7a0d  self._rez = rez.
+00024f40: 0a20 2020 2020 2020 2073 656c 662e 5f62  .        self._b
+00024f50: 6173 6574 7970 6520 3d20 6261 7365 7479  asetype = basety
+00024f60: 7065 0d0a 2020 2020 2020 2020 7265 7475  pe..        retu
+00024f70: 726e 0d0a 0d0a 2020 2020 6465 6620 7363  rn....    def sc
+00024f80: 616c 655f 6461 7461 6672 616d 6528 7365  ale_dataframe(se
+00024f90: 6c66 2c58 2c59 2c5a 2920 3a0d 0a20 2020  lf,X,Y,Z) :..   
+00024fa0: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
+00024fb0: 2020 5363 616c 696e 6720 7468 6520 7375    Scaling the su
+00024fc0: 7266 6163 6520 6765 6f6d 6574 7279 2062  rface geometry b
+00024fd0: 6173 6564 206f 6e20 6120 6461 7461 6772  ased on a datagr
+00024fe0: 6964 2e0d 0a0d 0a20 2020 2020 2020 2050  id.....        P
+00024ff0: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
+00025000: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
+00025010: 2020 2020 2020 2058 2c20 592c 205a 203a         X, Y, Z :
+00025020: 204e 2078 204d 2061 7272 6179 730d 0a20   N x M arrays.. 
+00025030: 2020 2020 2020 2020 2020 204d 696e 696d             Minim
+00025040: 756d 2061 6e64 206d 6178 696d 756d 2076  um and maximum v
+00025050: 616c 7565 7320 6f66 2074 6865 2061 7272  alues of the arr
+00025060: 6179 7320 6172 6520 7573 6564 2074 6f20  ays are used to 
+00025070: 7363 616c 650d 0a20 2020 2020 2020 2020  scale..         
+00025080: 2020 2061 6e64 2074 7261 6e73 6c61 7465     and translate
+00025090: 2074 6865 2073 7572 6661 6365 2066 726f   the surface fro
+000250a0: 6d20 616e 2069 6e74 6961 6c20 646f 6d61  m an intial doma
+000250b0: 696e 206f 660d 0a20 2020 2020 2020 2020  in of..         
+000250c0: 2020 205b 2028 2d31 2c31 292c 2028 2d31     [ (-1,1), (-1
+000250d0: 2c31 292c 2028 302c 3129 205d 0d0a 0d0a  ,1), (0,1) ]....
+000250e0: 2020 2020 2020 2020 5265 7475 726e 730d          Returns.
+000250f0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00025100: 0d0a 2020 2020 2020 2020 7365 6c66 203a  ..        self :
+00025110: 2050 6c61 6e61 7253 7572 6661 6365 206f   PlanarSurface o
+00025120: 626a 6563 740d 0a0d 0a20 2020 2020 2020  bject....       
+00025130: 2022 2222 0d0a 0d0a 2020 2020 2020 2020   """....        
+00025140: 7265 7475 726e 205f 7363 616c 655f 6461  return _scale_da
+00025150: 7461 6672 616d 6528 7365 6c66 2c58 2c59  taframe(self,X,Y
+00025160: 2c5a 290d 0a0d 0a20 2020 2064 6566 2064  ,Z)....    def d
+00025170: 6f6d 6169 6e28 7365 6c66 2c20 786c 696d  omain(self, xlim
+00025180: 3d4e 6f6e 652c 2079 6c69 6d3d 4e6f 6e65  =None, ylim=None
+00025190: 2c20 7a63 6f6f 723d 4e6f 6e65 2920 3a0d  , zcoor=None) :.
+000251a0: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
+000251b0: 2020 2020 2020 5365 7420 7468 6520 646f        Set the do
+000251c0: 6d61 696e 206f 6620 7468 6520 706c 616e  main of the plan
+000251d0: 6172 2073 7572 6661 6365 2e0d 0a0d 0a20  ar surface..... 
+000251e0: 2020 2020 2020 2055 7365 6420 666f 7220         Used for 
+000251f0: 7365 7474 696e 6720 7468 6520 6c69 6d69  setting the limi
+00025200: 7473 206f 6620 7468 6520 6261 7365 2070  ts of the base p
+00025210: 6c61 6e65 2e0d 0a0d 0a20 2020 2020 2020  lane.....       
+00025220: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
+00025230: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
+00025240: 0a20 2020 2020 2020 2078 6c69 6d2c 2079  .        xlim, y
+00025250: 6c69 6d20 3a20 3264 2061 7272 6179 730d  lim : 2d arrays.
+00025260: 0a20 2020 2020 2020 2020 2020 204d 696e  .            Min
+00025270: 696d 756d 2061 6e64 206d 6178 696d 756d  imum and maximum
+00025280: 2076 616c 7565 7320 6f66 2074 6865 2061   values of the a
+00025290: 7272 6179 7320 6172 6520 7573 6564 2074  rrays are used t
+000252a0: 6f20 7363 616c 650d 0a20 2020 2020 2020  o scale..       
+000252b0: 2020 2020 2061 6e64 2074 7261 6e73 6c61       and transla
+000252c0: 7465 2074 6865 2073 7572 6661 6365 2066  te the surface f
+000252d0: 726f 6d20 616e 2069 6e74 6961 6c20 646f  rom an intial do
+000252e0: 6d61 696e 7320 6f66 0d0a 2020 2020 2020  mains of..      
+000252f0: 2020 2020 2020 5b20 2d31 2c20 3120 5d0d        [ -1, 1 ].
+00025300: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
+00025310: 7365 7420 746f 204e 6f6e 652c 2074 6865  set to None, the
+00025320: 2064 6f6d 6169 6e73 2061 7265 2075 6e63   domains are unc
+00025330: 6861 6e67 6564 2e0d 0a0d 0a20 2020 2020  hanged.....     
+00025340: 2020 207a 636f 6f72 3a20 6e75 6d62 6572     zcoor: number
+00025350: 2c20 6465 6661 756c 7420 3a20 300d 0a20  , default : 0.. 
+00025360: 2020 2020 2020 2020 2020 205a 206f 6666             Z off
+00025370: 7365 7420 6f66 2074 6865 2070 6c61 6e65  set of the plane
+00025380: 2e0d 0a20 2020 2020 2020 2020 2020 2049  ...            I
+00025390: 6620 7365 7420 746f 204e 6f6e 652c 2074  f set to None, t
+000253a0: 6865 205a 206f 6666 7365 7420 6973 2075  he Z offset is u
+000253b0: 6e63 6861 6e67 6564 2e0d 0a0d 0a20 2020  nchanged.....   
+000253c0: 2020 2020 2052 6574 7572 6e73 0d0a 2020       Returns..  
+000253d0: 2020 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20        -------.. 
+000253e0: 2020 2020 2020 2073 656c 6620 3a20 506c         self : Pl
+000253f0: 616e 6172 5375 7266 6163 6520 6f62 6a65  anarSurface obje
+00025400: 6374 0d0a 0d0a 0d0a 2020 2020 2020 2020  ct......        
+00025410: 2222 220d 0a20 2020 2020 2020 2064 6566  """..        def
+00025420: 2073 6574 446f 6d61 696e 2878 797a 2c20   setDomain(xyz, 
+00025430: 6d78 2c62 782c 6d79 2c62 792c 6d7a 2920  mx,bx,my,by,mz) 
+00025440: 3a0d 0a20 2020 2020 2020 2020 2020 2078  :..            x
+00025450: 2c79 2c7a 203d 2078 797a 0d0a 2020 2020  ,y,z = xyz..    
+00025460: 2020 2020 2020 2020 5820 3d20 6d78 2a78          X = mx*x
+00025470: 202b 2062 780d 0a20 2020 2020 2020 2020   + bx..         
+00025480: 2020 2059 203d 206d 792a 7920 2b20 6279     Y = my*y + by
+00025490: 0d0a 2020 2020 2020 2020 2020 2020 5a20  ..            Z 
+000254a0: 3d20 7a20 6966 206d 7a20 6973 204e 6f6e  = z if mz is Non
+000254b0: 6520 656c 7365 206e 702e 6675 6c6c 286c  e else np.full(l
+000254c0: 656e 287a 292c 6d7a 290d 0a20 2020 2020  en(z),mz)..     
+000254d0: 2020 2020 2020 2072 6574 7572 6e20 582c         return X,
+000254e0: 592c 5a20 2020 2020 2020 0d0a 2020 2020  Y,Z       ..    
+000254f0: 2020 2020 6465 6620 6765 7443 6f6e 7428      def getCont(
+00025500: 206c 696d 7320 2920 3a0d 0a20 2020 2020   lims ) :..     
+00025510: 2020 2020 2020 206d 2c20 6220 3d20 312e         m, b = 1.
+00025520: 302c 2030 2e30 0d0a 2020 2020 2020 2020  0, 0.0..        
+00025530: 2020 2020 6966 206c 696d 7320 6973 206e      if lims is n
+00025540: 6f74 204e 6f6e 6520 3a0d 0a20 2020 2020  ot None :..     
+00025550: 2020 2020 2020 2020 2020 2023 2061 6c6c             # all
+00025560: 6f77 2073 696e 676c 6520 626e 6472 7920  ow single bndry 
+00025570: 746f 2062 6520 696e 7075 7420 6173 2061  to be input as a
+00025580: 2066 6c6f 6174 0d0a 2020 2020 2020 2020   float..        
+00025590: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+000255a0: 7461 6e63 6528 6c69 6d73 2c20 2869 6e74  tance(lims, (int
+000255b0: 2c66 6c6f 6174 2929 203a 206c 696d 7320  ,float)) : lims 
+000255c0: 3d20 5b2d 6c69 6d73 2c6c 696d 735d 0d0a  = [-lims,lims]..
+000255d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000255e0: 6d2c 2062 203d 2030 2e35 2a28 6c69 6d73  m, b = 0.5*(lims
+000255f0: 5b31 5d2d 6c69 6d73 5b30 5d29 202c 2030  [1]-lims[0]) , 0
+00025600: 2e35 2a28 6c69 6d73 5b31 5d2b 6c69 6d73  .5*(lims[1]+lims
+00025610: 5b30 5d29 0d0a 2020 2020 2020 2020 2020  [0])..          
+00025620: 2020 7265 7475 726e 206d 2c20 620d 0a20    return m, b.. 
+00025630: 2020 2020 2020 206d 782c 2062 7820 3d20         mx, bx = 
+00025640: 6765 7443 6f6e 7428 786c 696d 290d 0a20  getCont(xlim).. 
+00025650: 2020 2020 2020 206d 792c 2062 7920 3d20         my, by = 
+00025660: 6765 7443 6f6e 7428 796c 696d 290d 0a20  getCont(ylim).. 
+00025670: 2020 2020 2020 2073 656c 662e 6d61 705f         self.map_
+00025680: 6765 6f6d 5f66 726f 6d5f 6f70 286c 616d  geom_from_op(lam
+00025690: 6264 6120 4120 3a20 7365 7444 6f6d 6169  bda A : setDomai
+000256a0: 6e28 412c 206d 782c 6278 2c6d 792c 6279  n(A, mx,bx,my,by
+000256b0: 2c7a 636f 6f72 2929 0d0a 2020 2020 2020  ,zcoor))..      
+000256c0: 2020 7265 7475 726e 2073 656c 660d 0a0d    return self...
+000256d0: 0a63 6c61 7373 2050 6f6c 6172 5375 7266  .class PolarSurf
+000256e0: 6163 6528 5375 7266 6163 6533 4443 6f6c  ace(Surface3DCol
+000256f0: 6c65 6374 696f 6e29 203a 0d0a 2020 2020  lection) :..    
+00025700: 2222 220d 0a20 2020 2046 6c61 7420 6469  """..    Flat di
+00025710: 736b 2033 4420 7375 7266 6163 6520 696e  sk 3D surface in
+00025720: 2070 6f6c 6172 2063 6f6f 7264 696e 6174   polar coordinat
+00025730: 6573 2e0d 0a0d 0a20 2020 204d 6574 686f  es.....    Metho
+00025740: 6473 2061 7265 2069 6e68 6572 6974 6564  ds are inherited
+00025750: 2066 726f 6d20 7468 6520 5375 7266 6163   from the Surfac
+00025760: 6533 4443 6f6c 6c65 6374 696f 6e2e 0d0a  e3DCollection...
+00025770: 2020 2020 506f 6c61 7220 7375 7266 6163      Polar surfac
+00025780: 6520 6765 6f6d 6574 7269 6573 2061 7265  e geometries are
+00025790: 2063 7265 6174 6564 2069 6e20 7468 6973   created in this
+000257a0: 2073 7562 636c 6173 732e 0d0a 0d0a 2020   subclass.....  
+000257b0: 2020 2222 220d 0a0d 0a20 2020 2040 7374    """....    @st
+000257c0: 6174 6963 6d65 7468 6f64 0d0a 2020 2020  aticmethod..    
+000257d0: 6465 6620 7261 6e64 2872 657a 3d30 2c73  def rand(rez=0,s
+000257e0: 6565 643d 4e6f 6e65 2c6e 616d 653d 4e6f  eed=None,name=No
+000257f0: 6e65 2c6b 696e 643d 4e6f 6e65 2c2a 2a6b  ne,kind=None,**k
+00025800: 6172 6773 2920 3a0d 0a20 2020 2020 2020  args) :..       
+00025810: 2022 2222 0d0a 2020 2020 2020 2020 506f   """..        Po
+00025820: 6c61 7253 7572 6661 6365 2077 6974 6820  larSurface with 
+00025830: 7261 6e64 6f6d 2074 7269 616e 6775 6c61  random triangula
+00025840: 7220 6661 6365 732e 0d0a 0d0a 2020 2020  r faces.....    
+00025850: 2020 2020 5061 7261 6d65 7465 7273 0d0a      Parameters..
+00025860: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00025870: 2d2d 0d0a 2020 2020 2020 2020 7265 7a20  --..        rez 
+00025880: 3a20 6e75 6d62 6572 2c20 6f70 7469 6f6e  : number, option
+00025890: 616c 2c20 6465 6661 756c 743a 2030 0d0a  al, default: 0..
+000258a0: 2020 2020 2020 2020 2020 2020 4e75 6d62              Numb
+000258b0: 6572 206f 6620 2772 6563 7572 7369 7665  er of 'recursive
+000258c0: 2720 7375 6264 6976 6973 696f 6e73 206f  ' subdivisions o
+000258d0: 6620 7468 6520 7472 6961 6e67 756c 6174  f the triangulat
+000258e0: 6564 2062 6173 6520 6661 6365 732e 0d0a  ed base faces...
+000258f0: 2020 2020 2020 2020 2020 2020 5265 7a20              Rez 
+00025900: 7661 6c75 6573 2072 616e 6765 2066 726f  values range fro
+00025910: 6d20 3020 746f 2037 2e0d 0a0d 0a20 2020  m 0 to 7.....   
+00025920: 2020 2020 2073 6565 6420 3a20 696e 7465       seed : inte
+00025930: 6765 722c 206f 7074 696f 6e61 6c2c 2064  ger, optional, d
+00025940: 6566 6175 6c74 3a20 4e6f 6e65 0d0a 2020  efault: None..  
+00025950: 2020 2020 2020 2020 2020 416e 2069 6e69            An ini
+00025960: 7469 616c 697a 6174 696f 6e20 7365 6564  tialization seed
+00025970: 2066 6f72 2072 616e 646f 6d20 6765 6e65   for random gene
+00025980: 7261 7469 6f6e 2e0d 0a0d 0a20 2020 2020  ration.....     
+00025990: 2020 206e 616d 6520 3a20 7374 7269 6e67     name : string
+000259a0: 2c20 6f70 7469 6f6e 616c 2c20 6465 6661  , optional, defa
+000259b0: 756c 743a 204e 6f6e 652e 0d0a 2020 2020  ult: None...    
+000259c0: 2020 2020 2020 2020 4465 7363 7269 7074          Descript
+000259d0: 6976 6520 6964 656e 7469 6669 6572 2066  ive identifier f
+000259e0: 6f72 2074 6865 2067 656f 6d65 7472 792e  or the geometry.
+000259f0: 0d0a 0d0a 2020 2020 2020 2020 6b69 6e64  ....        kind
+00025a00: 203a 2073 7472 696e 672c 206f 7074 696f   : string, optio
+00025a10: 6e61 6c2c 2064 6566 6175 6c74 3a20 4e6f  nal, default: No
+00025a20: 6e65 0d0a 2020 2020 2020 2020 2020 2020  ne..            
+00025a30: 2872 6573 6572 7665 642c 206e 6f74 2069  (reserved, not i
+00025a40: 6d70 6c65 6d65 6e74 6564 2920 0d0a 0d0a  mplemented) ....
+00025a50: 2020 2020 2020 2020 5261 6973 6573 0d0a          Raises..
+00025a60: 2020 2020 2020 2020 2d2d 2d2d 2d2d 0d0a          ------..
+00025a70: 2020 2020 2020 2020 5661 6c75 6545 7272          ValueErr
+00025a80: 6f72 0d0a 2020 2020 2020 2020 2020 2020  or..            
+00025a90: 4966 2072 657a 2069 7320 6e6f 7420 616e  If rez is not an
+00025aa0: 2069 6e74 6567 6572 2069 6e20 7261 6e67   integer in rang
+00025ab0: 6520 3020 746f 2037 2e0d 0a20 2020 2020  e 0 to 7...     
+00025ac0: 2020 2020 2020 2049 6620 6261 7365 7479         If basety
+00025ad0: 7065 2069 7320 6e6f 7420 7265 636f 676e  pe is not recogn
+00025ae0: 697a 6564 2066 6f72 2074 6869 7320 7375  ized for this su
+00025af0: 7266 6163 6520 636f 6e73 7472 7563 746f  rface constructo
+00025b00: 722e 0d0a 0d0a 2020 2020 2020 2020 4f74  r.....        Ot
+00025b10: 6865 7220 5061 7261 6d65 7465 7273 0d0a  her Parameters..
+00025b20: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00025b30: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
+00025b40: 2020 2a2a 6b77 6172 6773 0d0a 2020 2020    **kwargs..    
+00025b50: 2020 2020 2020 2020 416c 6c20 6f74 6865          All othe
+00025b60: 7220 7061 7261 6d65 7465 7273 2061 7265  r parameters are
+00025b70: 2070 6173 7365 6420 6f6e 2074 6f20 2773   passed on to 's
+00025b80: 3364 6c69 622e 7375 7266 6163 652e 5375  3dlib.surface.Su
+00025b90: 7266 6163 6533 4443 6f6c 6c65 6374 696f  rface3DCollectio
+00025ba0: 6e27 2e0d 0a20 2020 2020 2020 200d 0a20  n'...        .. 
+00025bb0: 2020 2020 2020 2052 6574 7572 6e73 0d0a         Returns..
+00025bc0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0d          -------.
+00025bd0: 0a20 2020 2020 2020 2073 7572 6661 6365  .        surface
+00025be0: 203a 2050 6f6c 6172 5375 7266 6163 6520   : PolarSurface 
+00025bf0: 6f62 6a65 6374 2e0d 0a0d 0a20 2020 2020  object.....     
+00025c00: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
+00025c10: 232e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  #...............
+00025c20: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00025c30: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00025c40: 2e2e 2e2e 2e2e 2e2e 2e2e 0d0a 2020 2020  ............    
+00025c50: 2020 2020 6465 6620 7261 6e64 6f6d 5f6c      def random_l
+00025c60: 696e 4469 7374 2873 697a 6529 203a 0d0a  inDist(size) :..
+00025c70: 2020 2020 2020 2020 2020 2020 6e4c 6f6f              nLoo
+00025c80: 702c 6e43 6f6e 7472 6f6c 2c73 616d 706c  p,nControl,sampl
+00025c90: 6573 203d 2030 2c20 3130 2a2a 362c 205b  es = 0, 10**6, [
+00025ca0: 5d0d 0a20 2020 2020 2020 2020 2020 2077  ]..            w
+00025cb0: 6869 6c65 206c 656e 2873 616d 706c 6573  hile len(samples
+00025cc0: 293c 7369 7a65 2061 6e64 206e 4c6f 6f70  )<size and nLoop
+00025cd0: 3c6e 436f 6e74 726f 6c3a 0d0a 2020 2020  <nControl:..    
+00025ce0: 2020 2020 2020 2020 2020 2020 783d 6e70              x=np
+00025cf0: 2e72 616e 646f 6d2e 7261 6e64 6f6d 5f73  .random.random_s
+00025d00: 616d 706c 6528 290d 0a20 2020 2020 2020  ample()..       
+00025d10: 2020 2020 2020 2020 2070 726f 623d 782f           prob=x/
+00025d20: 320d 0a20 2020 2020 2020 2020 2020 2020  2..             
+00025d30: 2020 2061 7373 6572 7420 7072 6f62 3e3d     assert prob>=
+00025d40: 3020 616e 6420 7072 6f62 3c3d 310d 0a20  0 and prob<=1.. 
+00025d50: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00025d60: 6620 6e70 2e72 616e 646f 6d2e 7261 6e64  f np.random.rand
+00025d70: 6f6d 5f73 616d 706c 6528 2920 3c3d 7072  om_sample() <=pr
+00025d80: 6f62 3a20 7361 6d70 6c65 7320 2b3d 205b  ob: samples += [
+00025d90: 785d 0d0a 2020 2020 2020 2020 2020 2020  x]..            
+00025da0: 2020 2020 6e4c 6f6f 702b 3d31 0d0a 2020      nLoop+=1..  
+00025db0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00025dc0: 206e 702e 6172 7261 7928 7361 6d70 6c65   np.array(sample
+00025dd0: 7329 0d0a 2020 2020 2020 2020 232e 2e2e  s)..        #...
+00025de0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00025df0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00025e00: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00025e10: 2e2e 2e2e 2e2e 0d0a 0d0a 2020 2020 2020  ..........      
+00025e20: 2020 6966 206e 6f74 2069 7369 6e73 7461    if not isinsta
+00025e30: 6e63 6528 7265 7a2c 2028 696e 742c 666c  nce(rez, (int,fl
+00025e40: 6f61 7429 2920 3a0d 0a20 2020 2020 2020  oat)) :..       
+00025e50: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+00025e60: 4572 726f 7228 2749 6e63 6f72 7265 6374  Error('Incorrect
+00025e70: 2072 657a 2074 7970 652c 206d 7573 7420   rez type, must 
+00025e80: 6265 2061 206e 756d 6265 722e 2729 0d0a  be a number.')..
+00025e90: 2020 2020 2020 2020 6966 2028 7265 7a3c          if (rez<
+00025ea0: 3029 206f 7220 2872 657a 3e5f 4d41 5852  0) or (rez>_MAXR
+00025eb0: 455a 2920 3a0d 0a20 2020 2020 2020 2020  EZ) :..         
+00025ec0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+00025ed0: 726f 7228 2749 6e63 6f72 7265 7374 2072  ror('Incorrest r
+00025ee0: 657a 206f 6620 7b7d 2c20 6d75 7374 2062  ez of {}, must b
+00025ef0: 6520 6120 6e75 6d62 6572 2c20 3020 3c3d  e a number, 0 <=
+00025f00: 2072 657a 203c 3d20 7b7d 272e 666f 726d   rez <= {}'.form
+00025f10: 6174 2872 657a 2c5f 4d41 5852 455a 2929  at(rez,_MAXREZ))
+00025f20: 0d0a 0d0a 2020 2020 2020 2020 6966 2073  ....        if s
+00025f30: 6565 6420 6973 206e 6f74 204e 6f6e 6520  eed is not None 
+00025f40: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
+00025f50: 6620 6e6f 7420 6973 696e 7374 616e 6365  f not isinstance
+00025f60: 2873 6565 642c 2069 6e74 2920 3a0d 0a20  (seed, int) :.. 
+00025f70: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00025f80: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+00025f90: 2749 6e63 6f72 7265 6374 2073 6565 6420  'Incorrect seed 
+00025fa0: 7479 7065 2c20 6d75 7374 2062 6120 6f66  type, must ba of
+00025fb0: 2074 7970 6520 696e 7427 2920 0d0a 2020   type int') ..  
+00025fc0: 2020 2020 2020 2020 2020 6e70 2e72 616e            np.ran
+00025fd0: 646f 6d2e 7365 6564 2873 6565 6429 0d0a  dom.seed(seed)..
+00025fe0: 0d0a 2020 2020 2020 2020 4e20 3d20 696e  ..        N = in
+00025ff0: 7428 2036 2a28 342a 2a72 657a 292f 3220  t( 6*(4**rez)/2 
+00026000: 2b20 332a 2832 2a2a 7265 7a29 202b 2031  + 3*(2**rez) + 1
+00026010: 2029 0d0a 2020 2020 2020 2020 7220 3d20   )..        r = 
+00026020: 7261 6e64 6f6d 5f6c 696e 4469 7374 2820  random_linDist( 
+00026030: 4e20 290d 0a20 2020 2020 2020 2074 203d  N )..        t =
+00026040: 2032 2a6e 702e 7069 2a6e 702e 7261 6e64   2*np.pi*np.rand
+00026050: 6f6d 2e72 616e 6428 204e 2029 0d0a 2020  om.rand( N )..  
+00026060: 2020 2020 2020 7a20 3d20 6e70 2e7a 6572        z = np.zer
+00026070: 6f73 2820 4e20 290d 0a20 2020 2020 2020  os( N )..       
+00026080: 2064 6174 6120 3d20 506f 6c61 7253 7572   data = PolarSur
+00026090: 6661 6365 2e63 6f6f 725f 636f 6e76 6572  face.coor_conver
+000260a0: 7428 5b72 2c74 2c7a 5d2c 5472 7565 292e  t([r,t,z],True).
+000260b0: 540d 0a20 2020 2020 2020 2072 7464 6174  T..        rtdat
+000260c0: 6120 3d20 6461 7461 5b3a 2c3a 325d 0d0a  a = data[:,:2]..
+000260d0: 2020 2020 2020 2020 7465 7373 203d 2073          tess = s
+000260e0: 7061 7469 616c 2e44 656c 6175 6e61 7928  patial.Delaunay(
+000260f0: 7274 6461 7461 290d 0a0d 0a20 2020 2020  rtdata)....     
+00026100: 2020 2069 6620 6e61 6d65 2069 7320 4e6f     if name is No
+00026110: 6e65 203a 206e 616d 6520 3d20 2772 616e  ne : name = 'ran
+00026120: 646f 6d20 6d65 7368 270d 0a20 2020 2020  dom mesh'..     
+00026130: 2020 2073 7572 6661 6365 203d 2050 6f6c     surface = Pol
+00026140: 6172 5375 7266 6163 6528 6e61 6d65 3d6e  arSurface(name=n
+00026150: 616d 652c 2a2a 6b61 7267 7329 2020 2320  ame,**kargs)  # 
+00026160: 7365 7420 746f 2074 6865 2063 6c61 7373  set to the class
+00026170: 2064 6566 6175 6c74 206f 626a 6563 740d   default object.
+00026180: 0a20 2020 2020 2020 2023 2072 6573 6574  .        # reset
+00026190: 2076 6572 7473 2c20 6661 6365 496e 6469   verts, faceIndi
+000261a0: 6365 7320 616e 6420 6564 6765 7320 2872  ces and edges (r
+000261b0: 6574 6169 6e20 636c 6173 7320 636f 6f72  etain class coor
+000261c0: 6469 6e61 7465 2073 7973 7465 6d29 2e0d  dinate system)..
+000261d0: 0a20 2020 2020 2020 2076 6572 7473 203d  .        verts =
+000261e0: 206e 702e 7a65 726f 7328 2028 4e2c 3329   np.zeros( (N,3)
+000261f0: 290d 0a20 2020 2020 2020 2076 6572 7473  )..        verts
+00026200: 5b3a 2c3a 325d 203d 2074 6573 732e 706f  [:,:2] = tess.po
+00026210: 696e 7473 0d0a 2020 2020 2020 2020 6661  ints..        fa
+00026220: 6365 496e 6469 6365 7320 3d20 7465 7373  ceIndices = tess
+00026230: 2e73 696d 706c 6963 6573 0d0a 2020 2020  .simplices..    
+00026240: 2020 2020 0d0a 2020 2020 2020 2020 7375      ..        su
+00026250: 7266 6163 652e 7665 7274 6578 436f 6f72  rface.vertexCoor
+00026260: 203d 2076 6572 7473 0d0a 2020 2020 2020   = verts..      
+00026270: 2020 7375 7266 6163 652e 6676 496e 6469    surface.fvIndi
+00026280: 6365 7320 3d20 6661 6365 496e 6469 6365  ces = faceIndice
+00026290: 730d 0a20 2020 2020 2020 2073 7572 6661  s..        surfa
+000262a0: 6365 2e65 7649 6e64 6963 6573 203d 2073  ce.evIndices = s
+000262b0: 7572 6661 6365 2e5f 6765 745f 6564 6765  urface._get_edge
+000262c0: 735f 6672 6f6d 5f66 6163 6573 2866 6163  s_from_faces(fac
+000262d0: 6549 6e64 6963 6573 290d 0a20 2020 2020  eIndices)..     
+000262e0: 2020 2073 7572 6661 6365 2e76 6649 6e64     surface.vfInd
+000262f0: 6963 6573 4c69 7374 203d 2073 7572 6661  icesList = surfa
+00026300: 6365 2e5f 7665 7274 6578 436f 6d6d 6f6e  ce._vertexCommon
+00026310: 4661 6365 496e 6469 6365 7328 290d 0a20  FaceIndices().. 
+00026320: 2020 2020 2020 2073 7572 6661 6365 2e65         surface.e
+00026330: 6649 6e64 6963 6573 4c69 7374 203d 2073  fIndicesList = s
+00026340: 7572 6661 6365 2e5f 6564 6765 436f 6d6d  urface._edgeComm
+00026350: 6f6e 4661 6365 496e 6469 6365 7328 290d  onFaceIndices().
+00026360: 0a20 2020 2020 2020 2073 7572 6661 6365  .        surface
+00026370: 2e73 6574 5f76 6572 7473 2820 7665 7274  .set_verts( vert
+00026380: 735b 6661 6365 496e 6469 6365 735d 2029  s[faceIndices] )
+00026390: 0d0a 2020 2020 2020 2020 7375 7266 6163  ..        surfac
+000263a0: 652e 5f73 6574 5f67 656f 6d65 7472 6963  e._set_geometric
+000263b0: 5f62 6f75 6e64 7328 290d 0a20 2020 2020  _bounds()..     
+000263c0: 2020 2073 7572 6661 6365 2e5f 7265 7a20     surface._rez 
+000263d0: 3d20 7374 7228 7265 7a29 2069 6620 6973  = str(rez) if is
+000263e0: 696e 7374 616e 6365 2872 657a 2c69 6e74  instance(rez,int
+000263f0: 2920 656c 7365 2027 7b3a 2e31 667d 272e  ) else '{:.1f}'.
+00026400: 666f 726d 6174 2872 657a 290d 0a20 2020  format(rez)..   
+00026410: 2020 2020 2073 7572 6661 6365 2e5f 6261       surface._ba
+00026420: 7365 7479 7065 203d 2027 7261 6e64 5f27  setype = 'rand_'
+00026430: 2b73 7472 2873 6565 6429 0d0a 2020 2020  +str(seed)..    
+00026440: 2020 2020 7265 7475 726e 2073 7572 6661      return surfa
+00026450: 6365 0d0a 0d0a 2020 2020 4073 7461 7469  ce....    @stati
+00026460: 636d 6574 686f 640d 0a20 2020 2064 6566  cmethod..    def
+00026470: 205f 6765 745f 706f 6c61 725f 7375 7266   _get_polar_surf
+00026480: 6163 6573 5f64 6963 7469 6f6e 6172 7928  aces_dictionary(
+00026490: 2920 3a0d 0a20 2020 2020 2020 2022 2222  ) :..        """
+000264a0: 436f 6e73 7472 7563 7473 2074 6865 2064  Constructs the d
+000264b0: 6963 7469 6f6e 6172 7920 6f66 2062 6173  ictionary of bas
+000264c0: 6520 706f 6c61 7220 7375 7266 6163 6520  e polar surface 
+000264d0: 6765 6f6d 6574 7269 6573 2e22 2222 0d0a  geometries."""..
+000264e0: 0d0a 2020 2020 2020 2020 7375 7266 6163  ..        surfac
+000264f0: 6573 4469 6374 696f 6e61 7279 203d 207b  esDictionary = {
+00026500: 7d0d 0a20 2020 2020 2020 2073 6f66 6620  }..        soff 
+00026510: 3d20 302e 3030 3031 0d0a 2020 2020 2020  = 0.0001..      
+00026520: 2020 7830 203d 2030 2e35 0d0a 2020 2020    x0 = 0.5..    
+00026530: 2020 2020 7930 203d 206e 702e 7371 7274      y0 = np.sqrt
+00026540: 2833 292f 320d 0a20 2020 200d 0a20 2020  (3)/2..    ..   
+00026550: 2020 2020 2062 6173 6556 6572 7420 3d20       baseVert = 
+00026560: 5b20 5b30 2c30 2c30 5d2c 0d0a 2020 2020  [ [0,0,0],..    
+00026570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026580: 205b 312c 302c 305d 2c20 205b 7830 2c79   [1,0,0],  [x0,y
+00026590: 302c 305d 2c20 2020 5b2d 7830 2c79 302c  0,0],   [-x0,y0,
+000265a0: 305d 2c0d 0a20 2020 2020 2020 2020 2020  0],..           
+000265b0: 2020 2020 2020 2020 2020 5b2d 312c 302c            [-1,0,
+000265c0: 305d 2c20 5b2d 7830 2c2d 7930 2c30 5d2c  0], [-x0,-y0,0],
+000265d0: 205b 7830 2c2d 7930 2c30 5d20 5d0d 0a0d   [x0,-y0,0] ]...
+000265e0: 0a20 2020 2020 2020 2071 5665 7274 203d  .        qVert =
+000265f0: 205b 205b 302c 302c 305d 2c0d 0a20 2020   [ [0,0,0],..   
+00026600: 2020 2020 2020 2020 2020 2020 2020 205b                 [
+00026610: 312c 302c 305d 2c20 5b30 2c31 2c30 5d2c  1,0,0], [0,1,0],
+00026620: 205b 2d31 2c30 2c30 5d2c 205b 302c 2d31   [-1,0,0], [0,-1
+00026630: 2c30 5d20 5d0d 0a0d 0a20 2020 2020 2020  ,0] ]....       
+00026640: 2078 3053 2c20 7930 5320 3d20 736f 6666   x0S, y0S = soff
+00026650: 2a79 302c 2073 6f66 662a 7830 0d0a 0d0a  *y0, soff*x0....
+00026660: 2020 2020 2020 2020 6261 7365 5665 7274          baseVert
+00026670: 5320 3d20 5b20 5b31 2c2d 7930 532c 305d  S = [ [1,-y0S,0]
+00026680: 2c20 5b31 2c20 7930 532c 305d 2c0d 0a20  , [1, y0S,0],.. 
+00026690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000266a0: 2020 2020 205b 7830 2c79 302c 305d 2c20       [x0,y0,0], 
+000266b0: 5b2d 7830 2c79 302c 305d 2c20 5b2d 312c  [-x0,y0,0], [-1,
+000266c0: 302c 305d 2c20 0d0a 2020 2020 2020 2020  0,0], ..        
+000266d0: 2020 2020 2020 2020 2020 2020 2020 5b2d                [-
+000266e0: 7830 2c2d 7930 2c30 5d2c 205b 7830 2c2d  x0,-y0,0], [x0,-
+000266f0: 7930 2c30 5d2c 205b 2078 3053 2c20 2079  y0,0], [ x0S,  y
+00026700: 3053 2c30 5d2c 0d0a 2020 2020 2020 2020  0S,0],..        
+00026710: 2020 2020 2020 2020 2020 2020 2020 5b20                [ 
+00026720: 2020 302c 2073 6f66 662c 305d 2c20 5b2d    0, soff,0], [-
+00026730: 7830 532c 2020 7930 532c 305d 2c0d 0a20  x0S,  y0S,0],.. 
+00026740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026750: 2020 2020 205b 2d78 3053 2c20 2d79 3053       [-x0S, -y0S
+00026760: 2c30 5d2c 205b 2020 2030 2c2d 736f 6666  ,0], [   0,-soff
+00026770: 2c30 5d2c 205b 2078 3053 2c20 2d79 3053  ,0], [ x0S, -y0S
+00026780: 2c30 5d20 5d0d 0a0d 0a20 2020 2020 2020  ,0] ]....       
+00026790: 2071 5665 7274 5320 3d20 5b20 5b31 2c2d   qVertS = [ [1,-
+000267a0: 736f 6666 2c30 5d2c 0d0a 2020 2020 2020  soff,0],..      
+000267b0: 2020 2020 2020 2020 2020 2020 205b 312c               [1,
+000267c0: 2073 6f66 662c 305d 2c20 5b30 2c31 2c30   soff,0], [0,1,0
+000267d0: 5d2c 205b 2d31 2c30 2c30 5d2c 205b 302c  ], [-1,0,0], [0,
+000267e0: 2d31 2c30 5d2c 0d0a 2020 2020 2020 2020  -1,0],..        
+000267f0: 2020 2020 2020 2020 2020 205b 2073 6f66             [ sof
+00026800: 662c 2073 6f66 662c 305d 2c20 5b2d 736f  f, soff,0], [-so
+00026810: 6666 202c 736f 6666 2c30 5d2c 205b 2d73  ff ,soff,0], [-s
+00026820: 6f66 662c 2d73 6f66 662c 305d 2c20 5b73  off,-soff,0], [s
+00026830: 6f66 662c 2d73 6f66 662c 305d 205d 0d0a  off,-soff,0] ]..
+00026840: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+00026850: 2020 6261 7365 4661 6365 733d 285b 302c    baseFaces=([0,
+00026860: 312c 325d 2c5b 302c 322c 335d 2c5b 302c  1,2],[0,2,3],[0,
+00026870: 332c 345d 2c5b 302c 342c 355d 2c5b 302c  3,4],[0,4,5],[0,
+00026880: 352c 365d 2c5b 302c 362c 315d 290d 0a20  5,6],[0,6,1]).. 
+00026890: 2020 2020 2020 2071 7561 6446 6163 6573         quadFaces
+000268a0: 3d28 5b30 2c31 2c32 5d2c 5b30 2c32 2c33  =([0,1,2],[0,2,3
+000268b0: 5d2c 5b30 2c33 2c34 5d2c 5b30 2c34 2c31  ],[0,3,4],[0,4,1
+000268c0: 5d29 0d0a 0d0a 2020 2020 2020 2020 6261  ])....        ba
+000268d0: 7365 4661 6365 7353 3d28 205b 372c 312c  seFacesS=( [7,1,
+000268e0: 325d 2c20 5b38 2c32 2c33 5d2c 205b 392c  2], [8,2,3], [9,
+000268f0: 332c 345d 2c20 205b 3130 2c34 2c35 5d2c  3,4],  [10,4,5],
+00026900: 2020 5b31 312c 352c 365d 2c20 5b31 322c    [11,5,6], [12,
+00026910: 362c 305d 2c0d 0a20 2020 2020 2020 2020  6,0],..         
+00026920: 2020 2020 2020 2020 2020 2020 5b32 2c38              [2,8
+00026930: 2c37 5d2c 205b 332c 392c 385d 2c20 5b34  ,7], [3,9,8], [4
+00026940: 2c31 302c 395d 2c20 5b35 2c31 312c 3130  ,10,9], [5,11,10
+00026950: 5d2c 205b 362c 3132 2c31 315d 2029 0d0a  ], [6,12,11] )..
+00026960: 0d0a 2020 2020 2020 2020 7175 6164 4661  ..        quadFa
+00026970: 6365 7353 3d28 205b 352c 312c 325d 2c5b  cesS=( [5,1,2],[
+00026980: 362c 322c 335d 2c5b 372c 332c 345d 2c5b  6,2,3],[7,3,4],[
+00026990: 382c 342c 305d 2c0d 0a20 2020 2020 2020  8,4,0],..       
+000269a0: 2020 2020 2020 2020 2020 2020 205b 322c               [2,
+000269b0: 362c 355d 2c5b 332c 372c 365d 2c5b 342c  6,5],[3,7,6],[4,
+000269c0: 382c 375d 2029 0d0a 0d0a 2020 2020 2020  8,7] )....      
+000269d0: 2020 4673 203d 206c 656e 2871 7561 6446    Fs = len(quadF
+000269e0: 6163 6573 290d 0a20 2020 2020 2020 2046  aces)..        F
+000269f0: 6820 3d20 6c65 6e28 6261 7365 4661 6365  h = len(baseFace
+00026a00: 7329 0d0a 2020 2020 2020 2020 4673 5320  s)..        FsS 
+00026a10: 3d20 6c65 6e28 7175 6164 4661 6365 7353  = len(quadFacesS
+00026a20: 290d 0a20 2020 2020 2020 2046 6853 203d  )..        FhS =
+00026a30: 206c 656e 2862 6173 6546 6163 6573 5329   len(baseFacesS)
+00026a40: 0d0a 2020 2020 2020 2020 7371 7561 7265  ..        square
+00026a50: 203d 2020 7b20 2762 6173 6546 6163 6549   =  { 'baseFaceI
+00026a60: 6e64 6963 6573 2720 3a20 7175 6164 4661  ndices' : quadFa
+00026a70: 6365 7320 2c20 2762 6173 6556 6572 7469  ces , 'baseVerti
+00026a80: 6365 7343 6f6f 7227 203a 2071 5665 7274  cesCoor' : qVert
+00026a90: 2c20 2766 6576 5061 7261 6d27 203a 205b  , 'fevParam' : [
+00026aa0: 4673 2c32 2c31 5d20 7d0d 0a20 2020 2020  Fs,2,1] }..     
+00026ab0: 2020 2068 6578 6167 203d 2020 7b20 2762     hexag =  { 'b
+00026ac0: 6173 6546 6163 6549 6e64 6963 6573 2720  aseFaceIndices' 
+00026ad0: 3a20 6261 7365 4661 6365 7320 2c20 2762  : baseFaces , 'b
+00026ae0: 6173 6556 6572 7469 6365 7343 6f6f 7227  aseVerticesCoor'
+00026af0: 203a 2062 6173 6556 6572 742c 2027 6665   : baseVert, 'fe
+00026b00: 7650 6172 616d 2720 3a20 5b46 682c 332c  vParam' : [Fh,3,
+00026b10: 315d 207d 0d0a 2020 2020 2020 2020 7371  1] }..        sq
+00026b20: 7561 7265 5320 3d20 207b 2027 6261 7365  uareS =  { 'base
+00026b30: 4661 6365 496e 6469 6365 7327 203a 2071  FaceIndices' : q
+00026b40: 7561 6446 6163 6573 5320 2c20 2762 6173  uadFacesS , 'bas
+00026b50: 6556 6572 7469 6365 7343 6f6f 7227 203a  eVerticesCoor' :
+00026b60: 2071 5665 7274 532c 2027 6665 7650 6172   qVertS, 'fevPar
+00026b70: 616d 2720 3a20 5b46 7353 2c34 2e35 2c31  am' : [FsS,4.5,1
+00026b80: 5d20 7d0d 0a20 2020 2020 2020 2068 6578  ] }..        hex
+00026b90: 6167 5320 3d20 207b 2027 6261 7365 4661  agS =  { 'baseFa
+00026ba0: 6365 496e 6469 6365 7327 203a 2062 6173  ceIndices' : bas
+00026bb0: 6546 6163 6573 5320 2c20 2762 6173 6556  eFacesS , 'baseV
+00026bc0: 6572 7469 6365 7343 6f6f 7227 203a 2062  erticesCoor' : b
+00026bd0: 6173 6556 6572 7453 2c20 2766 6576 5061  aseVertS, 'fevPa
+00026be0: 7261 6d27 203a 205b 4668 532c 362e 352c  ram' : [FhS,6.5,
+00026bf0: 315d 207d 0d0a 2020 2020 200d 0a20 2020  1] }..     ..   
+00026c00: 2020 2020 2073 7572 6661 6365 7344 6963       surfacesDic
+00026c10: 7469 6f6e 6172 795b 2773 7175 275d 203d  tionary['squ'] =
+00026c20: 2073 7175 6172 650d 0a20 2020 2020 2020   square..       
+00026c30: 2073 7572 6661 6365 7344 6963 7469 6f6e   surfacesDiction
+00026c40: 6172 795b 2768 6578 275d 203d 2068 6578  ary['hex'] = hex
+00026c50: 6167 0d0a 2020 2020 2020 2020 7375 7266  ag..        surf
+00026c60: 6163 6573 4469 6374 696f 6e61 7279 5b27  acesDictionary['
+00026c70: 7371 755f 7327 5d20 3d20 7371 7561 7265  squ_s'] = square
+00026c80: 530d 0a20 2020 2020 2020 2073 7572 6661  S..        surfa
+00026c90: 6365 7344 6963 7469 6f6e 6172 795b 2768  cesDictionary['h
+00026ca0: 6578 5f73 275d 203d 2068 6578 6167 530d  ex_s'] = hexagS.
+00026cb0: 0a20 2020 2020 2020 2023 202e 2e2e 2027  .        # ... '
+00026cc0: 7370 6563 6961 6c20 6361 7365 2720 6f6e  special case' on
+00026cd0: 6c79 2066 6f72 2066 6576 206d 6574 686f  ly for fev metho
+00026ce0: 6420 666f 7220 706f 6c61 7220 7375 7266  d for polar surf
+00026cf0: 6163 6573 2e0d 0a20 2020 2020 2020 2073  aces...        s
+00026d00: 7572 6661 6365 7344 6963 7469 6f6e 6172  urfacesDictionar
+00026d10: 795b 2773 7175 5f63 275d 203d 207b 2027  y['squ_c'] = { '
+00026d20: 6665 7650 6172 616d 2720 3a20 5b31 362c  fevParam' : [16,
+00026d30: 352c 315d 207d 0d0a 2020 2020 2020 2020  5,1] }..        
+00026d40: 7375 7266 6163 6573 4469 6374 696f 6e61  surfacesDictiona
+00026d50: 7279 5b27 6865 785f 6327 5d20 3d20 7b20  ry['hex_c'] = { 
+00026d60: 2766 6576 5061 7261 6d27 203a 205b 3132  'fevParam' : [12
+00026d70: 2c34 2c31 5d20 7d0d 0a0d 0a20 2020 2020  ,4,1] }....     
+00026d80: 2020 2072 6574 7572 6e20 7375 7266 6163     return surfac
+00026d90: 6573 4469 6374 696f 6e61 7279 0d0a 0d0a  esDictionary....
+00026da0: 2020 2020 4073 7461 7469 636d 6574 686f      @staticmetho
+00026db0: 640d 0a20 2020 2064 6566 205f 6d69 6456  d..    def _midV
+00026dc0: 6563 746f 7246 756e 2876 6563 7441 2c20  ectorFun(vectA, 
+00026dd0: 7665 6374 4229 203a 0d0a 2020 2020 2020  vectB) :..      
+00026de0: 2020 2222 224d 6964 2d70 6f69 6e74 2061    """Mid-point a
+00026df0: 7420 7468 6520 6d69 6420 7261 6469 616c  t the mid radial
+00026e00: 2070 6f73 6974 696f 6e20 6265 7477 6565   position betwee
+00026e10: 6e20 7477 6f20 706f 696e 7473 2069 6e20  n two points in 
+00026e20: 6120 706c 616e 652e 2222 220d 0a20 2020  a plane."""..   
+00026e30: 2020 2020 206d 6964 203d 206e 702e 6164       mid = np.ad
+00026e40: 6428 7665 6374 412c 7665 6374 4229 0d0a  d(vectA,vectB)..
+00026e50: 2020 2020 2020 2020 6d69 6420 3d20 6e70          mid = np
+00026e60: 2e6d 756c 7469 706c 7928 302e 352c 6d69  .multiply(0.5,mi
+00026e70: 6429 0d0a 2020 2020 2020 2020 6120 3d20  d)..        a = 
+00026e80: 286e 702e 6c69 6e61 6c67 2e6e 6f72 6d28  (np.linalg.norm(
+00026e90: 7665 6374 4129 2b6e 702e 6c69 6e61 6c67  vectA)+np.linalg
+00026ea0: 2e6e 6f72 6d28 7665 6374 4229 292f 320d  .norm(vectB))/2.
+00026eb0: 0a20 2020 2020 2020 2062 203d 206e 702e  .        b = np.
+00026ec0: 6c69 6e61 6c67 2e6e 6f72 6d28 6d69 6429  linalg.norm(mid)
+00026ed0: 0d0a 2020 2020 2020 2020 6d69 6420 3d20  ..        mid = 
+00026ee0: 6e70 2e6d 756c 7469 706c 7928 6d69 642c  np.multiply(mid,
+00026ef0: 612f 6229 0d0a 2020 2020 2020 2020 7265  a/b)..        re
+00026f00: 7475 726e 206d 6964 0d0a 0d0a 2020 2020  turn mid....    
+00026f10: 4073 7461 7469 636d 6574 686f 640d 0a20  @staticmethod.. 
+00026f20: 2020 2064 6566 205f 6d61 7033 4474 6f32     def _map3Dto2
+00026f30: 4473 7175 6172 6528 7879 7a29 203a 0d0a  Dsquare(xyz) :..
+00026f40: 2020 2020 2020 2020 2222 224f 7665 7272          """Overr
+00026f50: 6964 6520 6d61 7020 7375 7266 6163 6520  ide map surface 
+00026f60: 746f 2072 6563 7461 6775 6c61 7220 756e  to rectagular un
+00026f70: 6974 2063 6f6f 7264 696e 6174 6573 2028  it coordinates (
+00026f80: 302c 3129 2e22 2222 0d0a 2020 2020 2020  0,1)."""..      
+00026f90: 2020 782c 792c 5f20 3d20 7879 7a0d 0a20    x,y,_ = xyz.. 
+00026fa0: 2020 2020 2020 2074 6865 7461 203d 206e         theta = n
+00026fb0: 702e 6172 6374 616e 3228 792c 7829 0d0a  p.arctan2(y,x)..
+00026fc0: 2020 2020 2020 2020 7468 6574 6120 3d20          theta = 
+00026fd0: 6e70 2e77 6865 7265 2820 7468 6574 613c  np.where( theta<
+00026fe0: 302c 2032 2e30 2a6e 702e 7069 202b 2074  0, 2.0*np.pi + t
+00026ff0: 6865 7461 202c 7468 6574 6129 0d0a 2020  heta ,theta)..  
+00027000: 2020 2020 2020 6120 3d20 7468 6574 612f        a = theta/
+00027010: 2832 2a6e 702e 7069 290d 0a20 2020 2020  (2*np.pi)..     
+00027020: 2020 2072 203d 206e 702e 7371 7274 2878     r = np.sqrt(x
+00027030: 2a78 2b79 2a79 290d 0a20 2020 2020 2020  *x+y*y)..       
+00027040: 2062 203d 2031 2d72 0d0a 2020 2020 2020   b = 1-r..      
+00027050: 2020 6120 3d20 6e70 2e63 6c69 7028 612c    a = np.clip(a,
+00027060: 302e 302c 312e 3029 200d 0a20 2020 2020  0.0,1.0) ..     
+00027070: 2020 2062 203d 206e 702e 636c 6970 2862     b = np.clip(b
+00027080: 2c30 2e30 2c31 2e30 2920 0d0a 2020 2020  ,0.0,1.0) ..    
+00027090: 2020 2020 7265 7475 726e 205b 612c 625d      return [a,b]
+000270a0: 0d0a 0d0a 2020 2020 4073 7461 7469 636d  ....    @staticm
+000270b0: 6574 686f 640d 0a20 2020 2064 6566 2063  ethod..    def c
+000270c0: 6f6f 725f 636f 6e76 6572 7428 7879 7a2c  oor_convert(xyz,
+000270d0: 2074 6f63 6172 743d 4661 6c73 6529 203a   tocart=False) :
+000270e0: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
+000270f0: 2020 2020 2020 2054 7261 6e66 6f72 6d61         Tranforma
+00027100: 7469 6f6e 2062 6574 7765 656e 2070 6f6c  tion between pol
+00027110: 6172 2061 6e64 2043 6172 7465 7369 616e  ar and Cartesian
+00027120: 2063 6f6f 7264 696e 6174 6573 2e0d 0a20   coordinates... 
+00027130: 2020 2020 2020 2054 6865 2061 6e67 756c         The angul
+00027140: 6172 2063 6f6f 7264 696e 6174 6520 6973  ar coordinate is
+00027150: 2069 6e20 7261 6469 616e 7320 7769 7468   in radians with
+00027160: 2064 6f6d 6169 6e20 3020 746f 2032 7069   domain 0 to 2pi
+00027170: 2e0d 0a0d 0a20 2020 2020 2020 2050 6172  .....        Par
+00027180: 616d 6574 6572 730d 0a20 2020 2020 2020  ameters..       
+00027190: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
+000271a0: 2020 2020 2078 797a 203a 2033 784e 2061       xyz : 3xN a
+000271b0: 7272 6179 0d0a 2020 2020 2020 2020 2020  rray..          
+000271c0: 2020 4e20 6e75 6d62 6572 206f 6620 7665    N number of ve
+000271d0: 6374 6f72 7320 696e 2065 6974 6865 7220  ctors in either 
+000271e0: 706f 6c61 7220 6f72 2063 6172 7465 7369  polar or cartesi
+000271f0: 616e 2063 6f6f 7264 696e 6174 6573 2e0d  an coordinates..
+00027200: 0a0d 0a20 2020 2020 2020 2074 6f63 6172  ...        tocar
+00027210: 7420 3a20 7b20 5472 7565 2c20 4661 6c73  t : { True, Fals
+00027220: 6520 7d2c 2064 6566 6175 6c74 3a20 4661  e }, default: Fa
+00027230: 6c73 650d 0a20 2020 2020 2020 2020 2020  lse..           
+00027240: 2049 6620 5472 7565 2c20 696e 7075 7420   If True, input 
+00027250: 6973 2070 6f6c 6172 2061 6e64 206f 7574  is polar and out
+00027260: 7075 7420 6973 2063 6172 7465 7369 616e  put is cartesian
+00027270: 2e0d 0a20 2020 2020 2020 2020 2020 2049  ...            I
+00027280: 6620 4661 6c73 652c 2069 6e70 7574 2069  f False, input i
+00027290: 7320 6361 7274 6573 6961 6e20 616e 6420  s cartesian and 
+000272a0: 6f75 7470 7574 2069 7320 706f 6c61 722e  output is polar.
+000272b0: 0d0a 0d0a 2020 2020 2020 2020 5265 7475  ....        Retu
+000272c0: 726e 730d 0a20 2020 2020 2020 202d 2d2d  rns..        ---
+000272d0: 2d2d 2d2d 0d0a 2020 2020 2020 2020 6c69  ----..        li
+000272e0: 7374 3a20 3378 4e20 6172 7261 790d 0a20  st: 3xN array.. 
+000272f0: 2020 2020 2020 2020 2020 2054 7261 6e73             Trans
+00027300: 666f 726d 6564 2063 6f6f 7264 696e 6174  formed coordinat
+00027310: 6573 2e20 0d0a 0d0a 2020 2020 2020 2020  es. ....        
+00027320: 2222 220d 0a0d 0a20 2020 2020 2020 2069  """....        i
+00027330: 6620 746f 6361 7274 203a 0d0a 2020 2020  f tocart :..    
+00027340: 2020 2020 2020 2020 722c 2074 6865 7461          r, theta
+00027350: 2c20 7a20 3d20 7879 7a0d 0a20 2020 2020  , z = xyz..     
+00027360: 2020 2020 2020 2078 203d 2072 202a 206e         x = r * n
+00027370: 702e 636f 7328 7468 6574 6129 0d0a 2020  p.cos(theta)..  
+00027380: 2020 2020 2020 2020 2020 7920 3d20 7220            y = r 
+00027390: 2a20 6e70 2e73 696e 2874 6865 7461 290d  * np.sin(theta).
+000273a0: 0a20 2020 2020 2020 2020 2020 2061 6263  .            abc
+000273b0: 203d 205b 782c 792c 7a5d 0d0a 2020 2020   = [x,y,z]..    
+000273c0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+000273d0: 2020 2020 2020 2078 2c79 2c7a 203d 2078         x,y,z = x
+000273e0: 797a 0d0a 2020 2020 2020 2020 2020 2020  yz..            
+000273f0: 5220 3d20 6e70 2e73 7172 7428 2078 2a78  R = np.sqrt( x*x
+00027400: 202b 2079 2a79 2029 0d0a 2020 2020 2020   + y*y )..      
+00027410: 2020 2020 2020 7468 6574 6120 3d20 6e70        theta = np
+00027420: 2e61 7263 7461 6e32 2879 2c78 290d 0a20  .arctan2(y,x).. 
+00027430: 2020 2020 2020 2020 2020 2074 6865 7461             theta
+00027440: 203d 206e 702e 7768 6572 6528 7468 6574   = np.where(thet
+00027450: 613c 302c 7468 6574 612b 322a 6e70 2e70  a<0,theta+2*np.p
+00027460: 692c 7468 6574 6129 0d0a 2020 2020 2020  i,theta)..      
+00027470: 2020 2020 2020 6162 6320 3d20 5b52 2c74        abc = [R,t
+00027480: 6865 7461 2c7a 5d0d 0a20 2020 2020 2020  heta,z]..       
+00027490: 2061 6263 203d 206e 702e 6172 7261 7928   abc = np.array(
+000274a0: 6162 6329 0d0a 2020 2020 2020 2020 7265  abc)..        re
+000274b0: 7475 726e 2061 6263 0d0a 0d0a 2020 2020  turn abc....    
+000274c0: 5f62 6173 655f 7375 7266 6163 6573 203d  _base_surfaces =
+000274d0: 205f 6765 745f 706f 6c61 725f 7375 7266   _get_polar_surf
+000274e0: 6163 6573 5f64 6963 7469 6f6e 6172 792e  aces_dictionary.
+000274f0: 5f5f 6675 6e63 5f5f 2829 0d0a 2020 2020  __func__()..    
+00027500: 5f64 6566 6175 6c74 5f62 6173 6520 3d20  _default_base = 
+00027510: 2768 6578 2720 2023 2064 6566 6175 6c74  'hex'  # default
+00027520: 2061 7373 6967 6e6d 656e 7420 6973 2069   assignment is i
+00027530: 6e64 6963 6174 6564 2069 6e20 5f5f 696e  ndicated in __in
+00027540: 6974 2044 6f63 7374 7269 6e67 2e0d 0a20  it Docstring... 
+00027550: 2020 205f 6765 6f6d 5479 7065 203d 205f     _geomType = _
+00027560: 434f 4f52 5359 535b 2750 4f4c 4152 275d  COORSYS['POLAR']
+00027570: 0d0a 0d0a 2020 2020 4063 6c61 7373 6d65  ....    @classme
+00027580: 7468 6f64 0d0a 2020 2020 6465 6620 5f75  thod..    def _u
+00027590: 7677 5f74 6f5f 7879 7a28 2063 6c73 2c75  vw_to_xyz( cls,u
+000275a0: 7677 2c20 7274 7a29 203a 2020 0d0a 2020  vw, rtz) :  ..  
+000275b0: 2020 2020 2020 2222 224f 7665 7272 6964        """Overrid
+000275c0: 6520 726f 7461 7469 6f6e 616c 2074 7261  e rotational tra
+000275d0: 6e73 666f 726d 6174 696f 6e20 6174 2061  nsformation at a
+000275e0: 2070 6f6c 6172 2063 6f6f 7264 696e 6174   polar coordinat
+000275f0: 652e 2222 220d 0a20 2020 2020 2020 2072  e."""..        r
+00027600: 6574 7572 6e20 7375 7065 7228 292e 5f64  eturn super()._d
+00027610: 6973 705f 746f 5f78 797a 2820 7576 772c  isp_to_xyz( uvw,
+00027620: 2072 747a 5b31 5d20 290d 0a0d 0a20 2020   rtz[1] )....   
+00027630: 2040 636c 6173 736d 6574 686f 640d 0a20   @classmethod.. 
+00027640: 2020 2064 6566 2067 7269 6428 636c 732c     def grid(cls,
+00027650: 6e72 6164 2c20 6e61 6e67 2c20 6261 7365  nrad, nang, base
+00027660: 7479 7065 3d27 6427 2c20 6d69 6e72 6164  type='d', minrad
+00027670: 3d4e 6f6e 652c 206e 616d 653d 4e6f 6e65  =None, name=None
+00027680: 2c20 2a2a 6b77 6172 6773 2920 3a0d 0a20  , **kwargs) :.. 
+00027690: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
+000276a0: 2020 2020 506f 6c61 7253 7572 6661 6365      PolarSurface
+000276b0: 2077 6974 6820 6178 6961 6c20 616e 6420   with axial and 
+000276c0: 7261 6469 616c 2066 6163 6573 2e0d 0a0d  radial faces....
+000276d0: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+000276e0: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
+000276f0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
+00027700: 206e 7261 6420 3a20 696e 7465 6765 722c   nrad : integer,
+00027710: 2072 6571 7569 7265 642e 0d0a 2020 2020   required...    
+00027720: 2020 2020 2020 2020 4e75 6d62 6572 206f          Number o
+00027730: 6620 7261 6469 616c 2073 7562 6469 7669  f radial subdivi
+00027740: 7369 6f6e 732e 2020 4d69 6e69 6d75 6d20  sions.  Minimum 
+00027750: 7661 6c75 6520 6973 2031 0d0a 0d0a 2020  value is 1....  
+00027760: 2020 2020 2020 6e61 6e67 203a 2069 6e74        nang : int
+00027770: 6567 6572 2c20 7265 7175 6972 6564 2e0d  eger, required..
+00027780: 0a20 2020 2020 2020 2020 2020 204e 756d  .            Num
+00027790: 6265 7220 6f66 2061 6e67 756c 6172 2073  ber of angular s
+000277a0: 7562 6469 7669 7369 6f6e 732e 204d 696e  ubdivisions. Min
+000277b0: 696d 756d 2076 616c 7565 2069 7320 332e  imum value is 3.
+000277c0: 0d0a 0d0a 2020 2020 2020 2020 6261 7365  ....        base
+000277d0: 7479 7065 203a 207b 2764 272c 2773 272c  type : {'d','s',
+000277e0: 2771 272c 2777 272c 2772 272c 2778 277d  'q','w','r','x'}
+000277f0: 2c20 6f70 7469 6f6e 616c 2c20 6465 6661  , optional, defa
+00027800: 756c 743a 2027 6427 0d0a 2020 2020 2020  ult: 'd'..      
+00027810: 2020 2020 2020 5374 6172 7469 6e67 2073        Starting s
+00027820: 7572 6661 6365 2067 656f 6d65 7472 6965  urface geometrie
+00027830: 7320 6672 6f6d 2077 6869 6368 2074 6865  s from which the
+00027840: 2073 7572 6661 6365 2069 730d 0a20 2020   surface is..   
+00027850: 2020 2020 2020 2020 2063 6f6e 7374 7275           constru
+00027860: 6374 6564 2069 6e64 6963 6174 696e 6720  cted indicating 
+00027870: 6661 6365 2073 6861 7065 2061 6e64 2069  face shape and i
+00027880: 6620 7370 6c69 742e 0d0a 0d0a 2020 2020  f split.....    
+00027890: 2020 2020 6d69 6e72 6164 203a 2073 6361      minrad : sca
+000278a0: 6c61 722c 206f 7074 696f 6e61 6c2c 2064  lar, optional, d
+000278b0: 6566 6175 6c74 3a20 302e 3031 0d0a 2020  efault: 0.01..  
+000278c0: 2020 2020 2020 2020 2020 5468 6520 6d69            The mi
+000278d0: 6e69 6d75 6d20 6469 7374 616e 6365 2066  nimum distance f
+000278e0: 726f 6d20 7468 6520 7a2d 6178 6973 206f  rom the z-axis o
+000278f0: 6620 616e 7920 7665 7274 6578 2063 6f6f  f any vertex coo
+00027900: 7264 696e 6174 652e 0d0a 2020 2020 2020  rdinate...      
+00027910: 2020 2020 2020 5573 6520 6973 2064 6570        Use is dep
+00027920: 656e 6465 6e74 206f 6e20 6261 7365 7479  endent on basety
+00027930: 7065 2e0d 0a0d 0a20 2020 2020 2020 206e  pe.....        n
+00027940: 616d 6520 3a20 7374 7269 6e67 2c20 6f70  ame : string, op
+00027950: 7469 6f6e 616c 2c20 6465 6661 756c 743a  tional, default:
+00027960: 204e 6f6e 652e 0d0a 2020 2020 2020 2020   None...        
+00027970: 2020 2020 4465 7363 7269 7074 6976 6520      Descriptive 
+00027980: 6964 656e 7469 6669 6572 2e0d 0a0d 0a20  identifier..... 
+00027990: 2020 2020 2020 2052 6169 7365 730d 0a20         Raises.. 
+000279a0: 2020 2020 2020 202d 2d2d 2d2d 2d0d 0a20         ------.. 
+000279b0: 2020 2020 2020 2056 616c 7565 4572 726f         ValueErro
+000279c0: 720d 0a20 2020 2020 2020 2020 2020 2049  r..            I
+000279d0: 6620 6e72 6164 2069 7320 6e6f 7420 616e  f nrad is not an
+000279e0: 2069 6e74 6567 6572 2067 7265 6174 6572   integer greater
+000279f0: 206f 7220 6571 7561 6c20 746f 2031 2e0d   or equal to 1..
+00027a00: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
+00027a10: 6e61 6e67 2069 7320 6e6f 7420 616e 2069  nang is not an i
+00027a20: 6e74 6567 6572 2067 7265 6174 6572 206f  nteger greater o
+00027a30: 7220 6571 7561 6c20 746f 2033 2e0d 0a0d  r equal to 3....
+00027a40: 0a20 2020 2020 2020 204f 7468 6572 2050  .        Other P
+00027a50: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
+00027a60: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
+00027a70: 2d2d 2d0d 0a20 2020 2020 2020 202a 2a6b  ---..        **k
+00027a80: 7761 7267 730d 0a20 2020 2020 2020 2020  wargs..         
+00027a90: 2020 2041 6c6c 206f 7468 6572 2070 6172     All other par
+00027aa0: 616d 6574 6572 7320 6172 6520 7061 7373  ameters are pass
+00027ab0: 6564 206f 6e20 746f 2027 7333 646c 6962  ed on to 's3dlib
+00027ac0: 2e73 7572 6661 6365 2e53 7572 6661 6365  .surface.Surface
+00027ad0: 3344 436f 6c6c 6563 7469 6f6e 272e 0d0a  3DCollection'...
+00027ae0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+00027af0: 2020 5265 7475 726e 730d 0a20 2020 2020    Returns..     
+00027b00: 2020 202d 2d2d 2d2d 2d2d 0d0a 2020 2020     -------..    
+00027b10: 2020 2020 7375 7266 6163 6520 3a20 506f      surface : Po
+00027b20: 6c61 7253 7572 6661 6365 206f 626a 6563  larSurface objec
+00027b30: 742e 0d0a 0d0a 2020 2020 2020 2020 2222  t.....        ""
+00027b40: 220d 0a20 2020 2020 2020 204e 6661 6365  "..        Nface
+00027b50: 7320 3d20 7b20 2764 273a 2033 2c20 2773  s = { 'd': 3, 's
+00027b60: 273a 2033 2c20 2771 273a 362c 2027 7727  ': 3, 'q':6, 'w'
+00027b70: 3a36 2c20 2772 273a 332c 2027 7827 3a33  :6, 'r':3, 'x':3
+00027b80: 2020 7d20 2023 2031 2c33 0d0a 2020 2020    }  # 1,3..    
+00027b90: 2020 2020 7370 6c69 7453 697a 6520 3d20      splitSize = 
+00027ba0: 4e6f 6e65 0d0a 2020 2020 2020 2020 7375  None..        su
+00027bb0: 7266 6163 6520 3d20 636c 732e 5f73 7175  rface = cls._squ
+00027bc0: 6172 655f 6e65 7428 6e72 6164 2c20 6e61  are_net(nrad, na
+00027bd0: 6e67 2c20 6261 7365 7479 7065 2c6d 696e  ng, basetype,min
+00027be0: 7261 642c 2073 706c 6974 5369 7a65 2c20  rad, splitSize, 
+00027bf0: 6e61 6d65 2c20 2a2a 6b77 6172 6773 290d  name, **kwargs).
+00027c00: 0a20 2020 2020 2020 2073 7572 6661 6365  .        surface
+00027c10: 2e5f 706f 7374 5072 6f63 5f73 7572 6661  ._postProc_surfa
+00027c20: 6365 436f 6c6f 7273 2854 7275 6529 0d0a  ceColors(True)..
+00027c30: 2020 2020 2020 2020 7375 7266 6163 652e          surface.
+00027c40: 5f72 657a 203d 2073 7572 6661 6365 2e5f  _rez = surface._
+00027c50: 6361 6c63 5f72 657a 2820 3620 290d 0a20  calc_rez( 6 ).. 
+00027c60: 2020 2020 2020 2072 6574 7572 6e20 7375         return su
+00027c70: 7266 6163 650d 0a0d 0a20 2020 2040 636c  rface....    @cl
+00027c80: 6173 736d 6574 686f 640d 0a20 2020 2064  assmethod..    d
+00027c90: 6566 2070 6e74 7375 7266 2863 6c73 2c20  ef pntsurf(cls, 
+00027ca0: 7274 7a5f 706f 696e 7473 2c20 6e61 6d65  rtz_points, name
+00027cb0: 3d4e 6f6e 652c 202a 2a6b 6172 6773 2920  =None, **kargs) 
+00027cc0: 3a0d 0a20 2020 2020 2020 2022 2222 0d0a  :..        """..
+00027cd0: 2020 2020 2020 2020 506f 6c61 7253 7572          PolarSur
+00027ce0: 6661 6365 2066 726f 6d20 706f 696e 7473  face from points
+00027cf0: 2069 6e20 706f 6c61 7220 636f 6f72 6469   in polar coordi
+00027d00: 6e61 7465 732e 0d0a 0d0a 2020 2020 2020  nates.....      
+00027d10: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
+00027d20: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00027d30: 0d0a 2020 2020 2020 2020 7274 7a5f 706f  ..        rtz_po
+00027d40: 696e 7473 203a 2061 7272 6179 2c20 7265  ints : array, re
+00027d50: 7175 6972 6564 2e0d 0a20 2020 2020 2020  quired...       
+00027d60: 2020 2020 2041 6e20 4e20 5820 3320 6172       An N X 3 ar
+00027d70: 7261 7920 6f66 204e 2070 6f6c 6172 2063  ray of N polar c
+00027d80: 6f6f 7264 696e 6174 6520 706f 696e 7473  oordinate points
+00027d90: 2e0d 0a0d 0a20 2020 2020 2020 206e 616d  .....        nam
+00027da0: 6520 3a20 7374 7269 6e67 2c20 6f70 7469  e : string, opti
+00027db0: 6f6e 616c 2c20 6465 6661 756c 743a 204e  onal, default: N
+00027dc0: 6f6e 652e 0d0a 2020 2020 2020 2020 2020  one...          
+00027dd0: 2020 4465 7363 7269 7074 6976 6520 6964    Descriptive id
+00027de0: 656e 7469 6669 6572 2066 6f72 2074 6865  entifier for the
+00027df0: 2070 6f69 6e74 2073 7572 6661 6365 2e0d   point surface..
+00027e00: 0a0d 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
+00027e10: 6e73 0d0a 2020 2020 2020 2020 2d2d 2d2d  ns..        ----
+00027e20: 2d2d 2d0d 0a20 2020 2020 2020 2073 7572  ---..        sur
+00027e30: 6661 6365 203a 2050 6f6c 6172 5375 7266  face : PolarSurf
+00027e40: 6163 6520 6f62 6a65 6374 0d0a 0d0a 2020  ace object....  
+00027e50: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
+00027e60: 2020 2064 6174 6150 7473 203d 206e 702e     dataPts = np.
+00027e70: 6172 7261 7928 7274 7a5f 706f 696e 7473  array(rtz_points
+00027e80: 290d 0a20 2020 2020 2020 2078 797a 5074  )..        xyzPt
+00027e90: 7320 3d20 506f 6c61 7253 7572 6661 6365  s = PolarSurface
+00027ea0: 2e63 6f6f 725f 636f 6e76 6572 7428 6461  .coor_convert(da
+00027eb0: 7461 5074 732e 542c 5472 7565 290d 0a0d  taPts.T,True)...
+00027ec0: 0a20 2020 2020 2020 2066 7649 6e64 6963  .        fvIndic
+00027ed0: 6573 203d 2074 7269 2e54 7269 616e 6775  es = tri.Triangu
+00027ee0: 6c61 7469 6f6e 2878 797a 5074 735b 305d  lation(xyzPts[0]
+00027ef0: 2c78 797a 5074 735b 315d 292e 7472 6961  ,xyzPts[1]).tria
+00027f00: 6e67 6c65 730d 0a20 2020 2020 2020 2062  ngles..        b
+00027f10: 6173 655f 7375 7266 6163 6520 3d20 5375  ase_surface = Su
+00027f20: 7266 6163 6533 4443 6f6c 6c65 6374 696f  rface3DCollectio
+00027f30: 6e28 6461 7461 5074 732c 2066 7649 6e64  n(dataPts, fvInd
+00027f40: 6963 6573 2c20 636f 6c6f 723d 2774 616e  ices, color='tan
+00027f50: 2729 2e73 6861 6465 2829 0d0a 2020 2020  ').shade()..    
+00027f60: 2020 2020 6661 6365 496e 6469 6365 7320      faceIndices 
+00027f70: 3d20 6261 7365 5f73 7572 6661 6365 2e66  = base_surface.f
+00027f80: 7649 6e64 6963 6573 0d0a 2020 2020 2020  vIndices..      
+00027f90: 2020 7665 7274 7320 3d20 7879 7a50 7473    verts = xyzPts
+00027fa0: 2e54 0d0a 0d0a 2020 2020 2020 2020 6966  .T....        if
+00027fb0: 206e 616d 6520 6973 204e 6f6e 6520 3a20   name is None : 
+00027fc0: 6e61 6d65 203d 2027 706f 696e 7420 7375  name = 'point su
+00027fd0: 7266 6163 6527 0d0a 2020 2020 2020 2020  rface'..        
+00027fe0: 7375 7266 6163 6520 3d20 506f 6c61 7253  surface = PolarS
+00027ff0: 7572 6661 6365 286e 616d 653d 6e61 6d65  urface(name=name
+00028000: 2c2a 2a6b 6172 6773 2920 0d0a 2020 2020  ,**kargs) ..    
+00028010: 2020 2020 7375 7266 6163 652e 7665 7274      surface.vert
+00028020: 6578 436f 6f72 203d 2076 6572 7473 0d0a  exCoor = verts..
+00028030: 2020 2020 2020 2020 7375 7266 6163 652e          surface.
+00028040: 6676 496e 6469 6365 7320 3d20 6661 6365  fvIndices = face
+00028050: 496e 6469 6365 730d 0a20 2020 2020 2020  Indices..       
+00028060: 2073 7572 6661 6365 2e65 7649 6e64 6963   surface.evIndic
+00028070: 6573 203d 2073 7572 6661 6365 2e5f 6765  es = surface._ge
+00028080: 745f 6564 6765 735f 6672 6f6d 5f66 6163  t_edges_from_fac
+00028090: 6573 2866 6163 6549 6e64 6963 6573 290d  es(faceIndices).
+000280a0: 0a20 2020 2020 2020 2073 7572 6661 6365  .        surface
+000280b0: 2e76 6649 6e64 6963 6573 4c69 7374 203d  .vfIndicesList =
+000280c0: 2073 7572 6661 6365 2e5f 7665 7274 6578   surface._vertex
+000280d0: 436f 6d6d 6f6e 4661 6365 496e 6469 6365  CommonFaceIndice
+000280e0: 7328 290d 0a20 2020 2020 2020 2073 7572  s()..        sur
+000280f0: 6661 6365 2e65 6649 6e64 6963 6573 4c69  face.efIndicesLi
+00028100: 7374 203d 2073 7572 6661 6365 2e5f 6564  st = surface._ed
+00028110: 6765 436f 6d6d 6f6e 4661 6365 496e 6469  geCommonFaceIndi
+00028120: 6365 7328 290d 0a20 2020 2020 2020 2073  ces()..        s
+00028130: 7572 6661 6365 2e73 6574 5f76 6572 7473  urface.set_verts
+00028140: 2820 7665 7274 735b 6661 6365 496e 6469  ( verts[faceIndi
+00028150: 6365 735d 2029 0d0a 2020 2020 2020 2020  ces] )..        
+00028160: 7375 7266 6163 652e 5f73 6574 5f67 656f  surface._set_geo
+00028170: 6d65 7472 6963 5f62 6f75 6e64 7328 290d  metric_bounds().
+00028180: 0a20 2020 2020 2020 2073 7572 6661 6365  .        surface
+00028190: 2e5f 7265 7a20 3d20 7375 7266 6163 652e  ._rez = surface.
+000281a0: 5f63 616c 635f 7265 7a28 3429 0d0a 2020  _calc_rez(4)..  
+000281b0: 2020 2020 2020 7375 7266 6163 652e 5f62        surface._b
+000281c0: 6173 6574 7970 6520 3d20 2770 6e74 7375  asetype = 'pntsu
+000281d0: 7266 270d 0a20 2020 2020 2020 2072 6574  rf'..        ret
+000281e0: 7572 6e20 7375 7266 6163 650d 0a0d 0a20  urn surface.... 
+000281f0: 2020 2040 636c 6173 736d 6574 686f 640d     @classmethod.
+00028200: 0a20 2020 2064 6566 205f 5866 6576 2863  .    def _Xfev(c
+00028210: 6c73 2c72 657a 2c20 6261 7365 7479 7065  ls,rez, basetype
+00028220: 3d4e 6f6e 652c 206d 696e 7261 643d 4e6f  =None, minrad=No
+00028230: 6e65 2920 3a0d 0a20 2020 2020 2020 2022  ne) :..        "
+00028240: 2222 0d0a 2020 2020 2020 2020 4361 6c63  ""..        Calc
+00028250: 756c 6174 6573 206e 756d 6265 7220 6f66  ulates number of
+00028260: 2066 6163 6573 2c20 6564 6765 732c 2061   faces, edges, a
+00028270: 6e64 2076 6572 7469 6365 7320 6f66 2061  nd vertices of a
+00028280: 2050 6f6c 6172 5375 7266 6163 652e 0d0a   PolarSurface...
+00028290: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
+000282a0: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
+000282b0: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
+000282c0: 2020 7265 7a20 3a20 696e 7465 6765 720d    rez : integer.
+000282d0: 0a20 2020 2020 2020 2020 2020 204e 756d  .            Num
+000282e0: 6265 7220 6f66 2072 6563 7572 7369 7665  ber of recursive
+000282f0: 2073 7562 6469 7669 7369 6f6e 7320 6f66   subdivisions of
+00028300: 2061 2074 7269 616e 6775 6c61 7465 6420   a triangulated 
+00028310: 6261 7365 2066 6163 6573 2e0d 0a20 2020  base faces...   
+00028320: 2020 2020 200d 0a20 2020 2020 2020 2062       ..        b
+00028330: 6173 6574 7970 6520 3a20 7374 7269 6e67  asetype : string
+00028340: 0d0a 2020 2020 2020 2020 2020 2020 5374  ..            St
+00028350: 6172 7469 6e67 2073 7572 6661 6365 2067  arting surface g
+00028360: 656f 6d65 7472 6965 7320 6672 6f6d 2077  eometries from w
+00028370: 6869 6368 2074 6865 2073 7572 6661 6365  hich the surface
+00028380: 2077 6f75 6c64 2062 650d 0a20 2020 2020   would be..     
+00028390: 2020 2020 2020 2063 6f6e 7374 7275 6374         construct
+000283a0: 6564 2075 7369 6e67 2072 6563 7572 7369  ed using recursi
+000283b0: 7665 2073 7562 6469 7669 7369 6f6e 7320  ve subdivisions 
+000283c0: 6f66 2074 6865 2074 7269 616e 6775 6c61  of the triangula
+000283d0: 7220 6661 6365 732e 0d0a 2020 2020 2020  r faces...      
+000283e0: 2020 0d0a 2020 2020 2020 2020 5265 7475    ..        Retu
+000283f0: 726e 730d 0a20 2020 2020 2020 202d 2d2d  rns..        ---
+00028400: 2d2d 2d2d 0d0a 2020 2020 2020 2020 6c69  ----..        li
+00028410: 7374 3a20 7468 6520 6e75 6d62 6572 206f  st: the number o
+00028420: 6620 6661 6365 732c 2065 6467 6573 2c20  f faces, edges, 
+00028430: 616e 6420 7665 7274 6963 6573 2e0d 0a20  and vertices... 
+00028440: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00028450: 2022 2222 0d0a 2020 2020 2020 2020 6966   """..        if
+00028460: 2069 7369 6e73 7461 6e63 6528 7265 7a2c   isinstance(rez,
+00028470: 286c 6973 742c 7475 706c 6529 2920 3a20  (list,tuple)) : 
+00028480: 2320 6368 6563 6b20 666f 7220 6469 736b  # check for disk
+00028490: 2e2e 2e0d 0a20 2020 2020 2020 2020 2020  .....           
+000284a0: 206e 7261 6420 3d20 7265 7a5b 305d 0d0a   nrad = rez[0]..
+000284b0: 2020 2020 2020 2020 2020 2020 6e61 6e67              nang
+000284c0: 203d 2072 657a 5b31 5d0d 0a20 2020 2020   = rez[1]..     
+000284d0: 2020 2020 2020 2023 206f 6e6c 7920 6368         # only ch
+000284e0: 6563 6b20 6973 2065 6e64 696e 6720 696e  eck is ending in
+000284f0: 2073 0d0a 2020 2020 2020 2020 2020 2020   s..            
+00028500: 6973 5370 6c69 7420 3d20 6261 7365 7479  isSplit = basety
+00028510: 7065 5b20 6c65 6e28 6261 7365 7479 7065  pe[ len(basetype
+00028520: 292d 315d 203d 3d20 2773 270d 0a20 2020  )-1] == 's'..   
+00028530: 2020 2020 2020 2020 2069 6620 6d69 6e72           if minr
+00028540: 6164 2069 7320 4e6f 6e65 203a 0d0a 2020  ad is None :..  
+00028550: 2020 2020 2020 2020 2020 2020 2020 6620                f 
+00028560: 3d20 322a 6e72 6164 2a6e 616e 6720 2d20  = 2*nrad*nang - 
+00028570: 6e61 6e67 0d0a 2020 2020 2020 2020 2020  nang..          
+00028580: 2020 2020 2020 6520 3d20 332a 6e72 6164        e = 3*nrad
+00028590: 2a6e 616e 6720 2d20 6e61 6e67 0d0a 2020  *nang - nang..  
+000285a0: 2020 2020 2020 2020 2020 2020 2020 7620                v 
+000285b0: 3d20 6e72 6164 2a6e 616e 6720 2b20 310d  = nrad*nang + 1.
+000285c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000285d0: 2069 6620 6973 5370 6c69 7420 3a0d 0a20   if isSplit :.. 
+000285e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000285f0: 2020 2065 202b 3d20 6e72 6164 0d0a 2020     e += nrad..  
+00028600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028610: 2020 7620 2b3d 206e 7261 640d 0a20 2020    v += nrad..   
+00028620: 2020 2020 2020 2020 2065 6c73 6520 3a20           else : 
+00028630: 2023 2061 6e79 2076 616c 7565 2077 696c   # any value wil
+00028640: 6c20 7472 6967 6765 7220 7468 6973 2063  l trigger this c
+00028650: 6f6e 6469 7469 6f6e 2e0d 0a20 2020 2020  ondition...     
+00028660: 2020 2020 2020 2020 2020 2066 203d 2032             f = 2
+00028670: 2a6e 7261 642a 6e61 6e67 0d0a 2020 2020  *nrad*nang..    
+00028680: 2020 2020 2020 2020 2020 2020 6520 3d20              e = 
+00028690: 332a 6e72 6164 2a6e 616e 6720 2b20 6e61  3*nrad*nang + na
+000286a0: 6e67 0d0a 2020 2020 2020 2020 2020 2020  ng..            
+000286b0: 2020 2020 7620 3d20 286e 7261 642b 3129      v = (nrad+1)
+000286c0: 2a6e 616e 670d 0a20 2020 2020 2020 2020  *nang..         
+000286d0: 2020 2020 2020 2069 6620 6973 5370 6c69         if isSpli
+000286e0: 7420 3a0d 0a20 2020 2020 2020 2020 2020  t :..           
+000286f0: 2020 2020 2020 2020 2065 202b 3d20 6e72           e += nr
+00028700: 6164 2020 2020 0d0a 2020 2020 2020 2020  ad    ..        
+00028710: 2020 2020 2020 2020 2020 2020 7620 2b3d              v +=
+00028720: 206e 7261 6420 2b20 3120 2020 200d 0a20   nrad + 1    .. 
+00028730: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00028740: 6e20 5b66 2c65 2c76 5d0d 0a0d 0a20 2020  n [f,e,v]....   
+00028750: 2020 2020 2072 6574 7572 6e20 7375 7065       return supe
+00028760: 7228 292e 5f66 6576 2872 657a 2c62 6173  r()._fev(rez,bas
+00028770: 6574 7970 652c 636c 7329 0d0a 0d0a 2020  etype,cls)....  
+00028780: 2020 4073 7461 7469 636d 6574 686f 640d    @staticmethod.
+00028790: 0a20 2020 2064 6566 205f 666c 6174 5f73  .    def _flat_s
+000287a0: 706c 6974 5f63 7963 6c69 6e64 6572 2872  plit_cyclinder(r
+000287b0: 657a 2c62 6173 6574 7970 652c 6d69 6e72  ez,basetype,minr
+000287c0: 6164 2c20 2a2a 6b77 6172 6773 2920 3a0d  ad, **kwargs) :.
+000287d0: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
+000287e0: 2020 2020 2020 5472 616e 7366 6f72 6d20        Transform 
+000287f0: 6379 6c69 6e64 7269 6361 6c20 6261 7365  cylindrical base
+00028800: 2073 7572 6661 6365 2074 6f20 706f 6c61   surface to pola
+00028810: 7220 636f 6f72 6469 6e61 7465 732e 200d  r coordinates. .
+00028820: 0a0d 0a20 2020 2020 2020 206e 6f74 6520  ...        note 
+00028830: 3a20 2054 6869 7320 6d65 7468 6f64 2070  :  This method p
+00028840: 726f 7669 6465 7320 616e 2061 6c74 6572  rovides an alter
+00028850: 6e61 7469 7665 2074 6f20 7468 6520 0d0a  native to the ..
+00028860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028870: 706f 6c65 7220 6261 7365 7479 7065 7320  poler basetypes 
+00028880: 6f66 2027 6865 785f 7327 2061 6e64 2027  of 'hex_s' and '
+00028890: 7371 755f 7327 2e0d 0a20 2020 2020 2020  squ_s'...       
+000288a0: 2020 2020 2020 2020 2054 6865 2067 7269           The gri
+000288b0: 6473 2063 6f6e 7374 7275 6374 6564 2068  ds constructed h
+000288c0: 6572 6520 6d61 7920 7072 6f76 6964 6520  ere may provide 
+000288d0: 736d 6f6f 7468 6572 0d0a 2020 2020 2020  smoother..      
+000288e0: 2020 2020 2020 2020 2020 6765 6f6d 6574            geomet
+000288f0: 7269 6573 2064 6570 656e 6469 6e67 206f  ries depending o
+00028900: 6e20 7468 6520 6d61 7070 696e 6720 6675  n the mapping fu
+00028910: 6e63 7469 6f6e 732e 0d0a 2020 2020 2020  nctions...      
+00028920: 2020 2222 220d 0a0d 0a20 2020 2020 2020    """....       
+00028930: 2023 202e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e   # .............
+00028940: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00028950: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00028960: 2e2e 2e2e 0d0a 2020 2020 2020 2020 6465  ......        de
+00028970: 6620 6379 6c32 706f 6c28 7274 7a29 3a0d  f cyl2pol(rtz):.
+00028980: 0a20 2020 2020 2020 2020 2020 2072 2c74  .            r,t
+00028990: 2c7a 203d 2072 747a 0d0a 2020 2020 2020  ,z = rtz..      
+000289a0: 2020 2020 2020 6220 3d20 2831 2e30 2b6d        b = (1.0+m
+000289b0: 696e 7261 6429 2f32 2e30 0d0a 2020 2020  inrad)/2.0..    
+000289c0: 2020 2020 2020 2020 6d20 3d20 2d28 312e          m = -(1.
+000289d0: 302d 6d69 6e72 6164 292f 322e 300d 0a20  0-minrad)/2.0.. 
+000289e0: 2020 2020 2020 2020 2020 2052 203d 206d             R = m
+000289f0: 2a7a 202b 2062 0d0a 2020 2020 2020 2020  *z + b..        
+00028a00: 2020 2020 5a20 3d20 302a 7a0d 0a20 2020      Z = 0*z..   
+00028a10: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00028a20: 522c 742c 5a0d 0a20 2020 2020 2020 2023  R,t,Z..        #
+00028a30: 202e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e   ...............
+00028a40: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00028a50: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00028a60: 2e2e 0d0a 2020 2020 2020 2020 6966 2062  ....        if b
+00028a70: 6173 6574 7970 6520 3d3d 2027 7371 755f  asetype == 'squ_
+00028a80: 6327 203a 2063 796c 6261 7365 203d 2027  c' : cylbase = '
+00028a90: 7371 755f 7327 200d 0a20 2020 2020 2020  squ_s' ..       
+00028aa0: 2069 6620 6261 7365 7479 7065 203d 3d20   if basetype == 
+00028ab0: 2768 6578 5f63 2720 3a20 6379 6c62 6173  'hex_c' : cylbas
+00028ac0: 6520 3d20 2774 7269 5f73 270d 0a20 2020  e = 'tri_s'..   
+00028ad0: 2020 2020 2063 796c 5f6f 626a 203d 2043       cyl_obj = C
+00028ae0: 796c 696e 6472 6963 616c 5375 7266 6163  ylindricalSurfac
+00028af0: 6528 7265 7a2c 6379 6c62 6173 652c 202a  e(rez,cylbase, *
+00028b00: 2a6b 7761 7267 7329 2e6d 6170 5f67 656f  *kwargs).map_geo
+00028b10: 6d5f 6672 6f6d 5f6f 7028 6379 6c32 706f  m_from_op(cyl2po
+00028b20: 6c29 0d0a 2020 2020 2020 2020 6261 7365  l)..        base
+00028b30: 4661 6365 5665 7274 6578 496e 6469 6365  FaceVertexIndice
+00028b40: 7320 3d20 6379 6c5f 6f62 6a2e 5f62 6173  s = cyl_obj._bas
+00028b50: 655f 7375 7266 6163 6573 5b63 796c 6261  e_surfaces[cylba
+00028b60: 7365 5d20 5b27 6261 7365 4661 6365 496e  se] ['baseFaceIn
+00028b70: 6469 6365 7327 5d20 2020 200d 0a20 2020  dices']    ..   
+00028b80: 2020 2020 2066 7649 6e64 6963 6573 203d       fvIndices =
+00028b90: 2063 796c 5f6f 626a 2e66 7649 6e64 6963   cyl_obj.fvIndic
+00028ba0: 6573 0d0a 2020 2020 2020 2020 7665 7274  es..        vert
+00028bb0: 6578 436f 6f72 203d 2063 796c 5f6f 626a  exCoor = cyl_obj
+00028bc0: 2e76 6572 7465 7843 6f6f 720d 0a20 2020  .vertexCoor..   
+00028bd0: 2020 2020 2065 7649 6e64 6963 6573 203d       evIndices =
+00028be0: 2063 796c 5f6f 626a 2e65 7649 6e64 6963   cyl_obj.evIndic
+00028bf0: 6573 0d0a 2020 2020 2020 2020 7265 7475  es..        retu
+00028c00: 726e 2076 6572 7465 7843 6f6f 722c 2066  rn vertexCoor, f
+00028c10: 7649 6e64 6963 6573 2c20 6576 496e 6469  vIndices, evIndi
+00028c20: 6365 732c 2062 6173 6546 6163 6556 6572  ces, baseFaceVer
+00028c30: 7465 7849 6e64 6963 6573 2c0d 0a0d 0a20  texIndices,.... 
+00028c40: 2020 2064 6566 205f 5f69 6e69 745f 5f28     def __init__(
+00028c50: 7365 6c66 2c20 7265 7a3d 302c 2062 6173  self, rez=0, bas
+00028c60: 6574 7970 653d 4e6f 6e65 2c20 6d69 6e72  etype=None, minr
+00028c70: 6164 3d4e 6f6e 652c 206e 616d 653d 4e6f  ad=None, name=No
+00028c80: 6e65 2c20 2a2a 6b77 6172 6773 293a 0d0a  ne, **kwargs):..
+00028c90: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
+00028ca0: 2020 2020 2043 7265 6174 6520 666c 6174       Create flat
+00028cb0: 2064 6973 6b20 7375 7266 6163 6520 6f66   disk surface of
+00028cc0: 2075 6e69 7420 7261 6469 7573 2e0d 0a0d   unit radius....
+00028cd0: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+00028ce0: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
+00028cf0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
+00028d00: 2072 657a 203a 2069 6e74 6567 6572 2c20   rez : integer, 
+00028d10: 6f70 7469 6f6e 616c 2c20 6465 6661 756c  optional, defaul
+00028d20: 743a 2030 0d0a 2020 2020 2020 2020 2020  t: 0..          
+00028d30: 2020 4e75 6d62 6572 206f 6620 7265 6375    Number of recu
+00028d40: 7273 6976 6520 7375 6264 6976 6973 696f  rsive subdivisio
+00028d50: 6e73 206f 6620 7468 6520 7472 6961 6e67  ns of the triang
+00028d60: 756c 6174 6564 2062 6173 6520 6661 6365  ulated base face
+00028d70: 732e 0d0a 2020 2020 2020 2020 2020 2020  s...            
+00028d80: 5265 7a20 7661 6c75 6573 2072 616e 6765  Rez values range
+00028d90: 2066 726f 6d20 3020 746f 2037 2e0d 0a20   from 0 to 7... 
+00028da0: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
+00028db0: 2020 2020 2062 6173 6574 7970 6520 3a20       basetype : 
+00028dc0: 7b27 7371 7527 2c27 6865 7827 2c27 7371  {'squ','hex','sq
+00028dd0: 755f 7327 2c27 6865 785f 7327 2c27 7371  u_s','hex_s','sq
+00028de0: 755f 6327 2c27 6865 785f 6327 7d2c 206f  u_c','hex_c'}, o
+00028df0: 7074 696f 6e61 6c2c 2064 6566 6175 6c74  ptional, default
+00028e00: 3a20 2768 6578 270d 0a20 2020 2020 2020  : 'hex'..       
+00028e10: 2020 2020 2053 7461 7274 696e 6720 7375       Starting su
+00028e20: 7266 6163 6520 6765 6f6d 6574 7269 6573  rface geometries
+00028e30: 2066 726f 6d20 7768 6963 6820 7468 6520   from which the 
+00028e40: 7375 7266 6163 6520 6973 0d0a 2020 2020  surface is..    
+00028e50: 2020 2020 2020 2020 636f 6e73 7472 7563          construc
+00028e60: 7465 6420 7573 696e 6720 7265 6375 7273  ted using recurs
+00028e70: 6976 6520 7375 6264 6976 6973 696f 6e73  ive subdivisions
+00028e80: 206f 6620 7468 6520 7472 6961 6e67 756c   of the triangul
+00028e90: 6172 2066 6163 6573 2e0d 0a0d 0a20 2020  ar faces.....   
+00028ea0: 2020 2020 206d 696e 7261 6420 3a20 7363       minrad : sc
+00028eb0: 616c 6172 2c20 6f70 7469 6f6e 616c 2c20  alar, optional, 
+00028ec0: 6465 6661 756c 743a 2030 2e30 310d 0a20  default: 0.01.. 
+00028ed0: 2020 2020 2020 2020 2020 2046 6f72 2062             For b
+00028ee0: 6173 6574 7970 6573 2027 7371 755f 6327  asetypes 'squ_c'
+00028ef0: 2061 6e64 2027 6865 785f 632c 2074 6865   and 'hex_c, the
+00028f00: 206d 696e 696d 756d 0d0a 2020 2020 2020   minimum..      
+00028f10: 2020 2020 2020 6469 7374 616e 6365 2066        distance f
+00028f20: 726f 6d20 7468 6520 7a2d 6178 6973 206f  rom the z-axis o
+00028f30: 6620 616e 7920 7665 7274 6578 2063 6f6f  f any vertex coo
+00028f40: 7264 696e 6174 652e 0d0a 0d0a 2020 2020  rdinate.....    
+00028f50: 2020 2020 6e61 6d65 203a 2073 7472 696e      name : strin
+00028f60: 672c 206f 7074 696f 6e61 6c2c 2064 6566  g, optional, def
+00028f70: 6175 6c74 3a20 4e6f 6e65 2e0d 0a20 2020  ault: None...   
+00028f80: 2020 2020 2020 2020 2044 6573 6372 6970           Descrip
+00028f90: 7469 7665 2069 6465 6e74 6966 6965 7220  tive identifier 
+00028fa0: 666f 7220 7468 6520 6765 6f6d 6574 7279  for the geometry
+00028fb0: 2e0d 0a0d 0a20 2020 2020 2020 2052 6169  .....        Rai
+00028fc0: 7365 730d 0a20 2020 2020 2020 202d 2d2d  ses..        ---
+00028fd0: 2d2d 2d0d 0a20 2020 2020 2020 2056 616c  ---..        Val
+00028fe0: 7565 4572 726f 720d 0a20 2020 2020 2020  ueError..       
+00028ff0: 2020 2020 2049 6620 7265 7a20 6973 206e       If rez is n
+00029000: 6f74 2061 6e20 696e 7465 6765 7220 696e  ot an integer in
+00029010: 2072 616e 6765 2030 2074 6f20 372e 0d0a   range 0 to 7...
+00029020: 2020 2020 2020 2020 2020 2020 4966 2062              If b
+00029030: 6173 6574 7970 6520 6973 206e 6f74 2072  asetype is not r
+00029040: 6563 6f67 6e69 7a65 6420 666f 7220 7468  ecognized for th
+00029050: 6973 2073 7572 6661 6365 2063 6f6e 7374  is surface const
+00029060: 7275 6374 6f72 2e0d 0a0d 0a20 2020 2020  ructor.....     
+00029070: 2020 204f 7468 6572 2050 6172 616d 6574     Other Paramet
+00029080: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
+00029090: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20  -------------.. 
+000290a0: 2020 2020 2020 202a 2a6b 7761 7267 730d         **kwargs.
+000290b0: 0a20 2020 2020 2020 2020 2020 2041 6c6c  .            All
+000290c0: 206f 7468 6572 2070 6172 616d 6574 6572   other parameter
+000290d0: 7320 6172 6520 7061 7373 6564 206f 6e20  s are passed on 
+000290e0: 746f 2027 7333 646c 6962 2e73 7572 6661  to 's3dlib.surfa
+000290f0: 6365 2e53 7572 6661 6365 3344 436f 6c6c  ce.Surface3DColl
+00029100: 6563 7469 6f6e 272e 0d0a 0d0a 2020 2020  ection'.....    
+00029110: 2020 2020 2222 220d 0a0d 0a20 2020 2020      """....     
+00029120: 2020 2069 6620 6d69 6e72 6164 2069 7320     if minrad is 
+00029130: 4e6f 6e65 203a 206d 696e 7261 6420 3d20  None : minrad = 
+00029140: 5f4d 494e 5241 440d 0a20 2020 2020 2020  _MINRAD..       
+00029150: 2069 6620 6e6f 7420 6973 696e 7374 616e   if not isinstan
+00029160: 6365 2872 657a 2c20 696e 7429 203a 0d0a  ce(rez, int) :..
+00029170: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00029180: 6520 5661 6c75 6545 7272 6f72 2827 496e  e ValueError('In
+00029190: 636f 7272 6563 7420 7265 7a20 7479 7065  correct rez type
+000291a0: 2c20 6d75 7374 2062 6120 6f66 2074 7970  , must ba of typ
+000291b0: 6520 696e 7427 290d 0a20 2020 2020 2020  e int')..       
+000291c0: 2069 6620 2872 657a 3c30 2920 6f72 2028   if (rez<0) or (
+000291d0: 7265 7a3e 5f4d 4158 5245 5a29 203a 0d0a  rez>_MAXREZ) :..
+000291e0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+000291f0: 6520 5661 6c75 6545 7272 6f72 2827 496e  e ValueError('In
+00029200: 636f 7272 6573 7420 7265 7a20 6f66 207b  correst rez of {
+00029210: 7d2c 206d 7573 7420 6265 2061 6e20 696e  }, must be an in
+00029220: 742c 2030 203c 3d20 7265 7a20 3c3d 207b  t, 0 <= rez <= {
+00029230: 7d27 2e66 6f72 6d61 7428 7265 7a2c 5f4d  }'.format(rez,_M
+00029240: 4158 5245 5a29 290d 0a20 2020 2020 2020  AXREZ))..       
+00029250: 2069 6620 6261 7365 7479 7065 2069 7320   if basetype is 
+00029260: 4e6f 6e65 203a 2062 6173 6574 7970 6520  None : basetype 
+00029270: 3d20 7365 6c66 2e5f 6465 6661 756c 745f  = self._default_
+00029280: 6261 7365 0d0a 2020 2020 2020 2020 2320  base..        # 
+00029290: 2e2e 2e20 6368 6563 6b20 666f 7220 2773  ... check for 's
+000292a0: 7065 6369 616c 2063 6173 6527 2028 7567  pecial case' (ug
+000292b0: 6c79 2063 6f64 6520 6275 7420 6e65 6564  ly code but need
+000292c0: 6564 290d 0a20 2020 2020 2020 2069 6620  ed)..        if 
+000292d0: 6261 7365 7479 7065 203d 3d20 2773 7175  basetype == 'squ
+000292e0: 5f63 2720 6f72 2062 6173 6574 7970 6520  _c' or basetype 
+000292f0: 3d3d 2027 6865 785f 6327 203a 0d0a 2020  == 'hex_c' :..  
+00029300: 2020 2020 2020 2020 2020 7665 7274 6578            vertex
+00029310: 436f 6f72 2c20 6661 6365 496e 6469 6365  Coor, faceIndice
+00029320: 732c 2065 6467 6549 6e64 6963 6573 2c20  s, edgeIndices, 
+00029330: 6266 7669 203d 2073 656c 662e 5f66 6c61  bfvi = self._fla
+00029340: 745f 7370 6c69 745f 6379 636c 696e 6465  t_split_cyclinde
+00029350: 7228 7265 7a2c 6261 7365 7479 7065 2c6d  r(rez,basetype,m
+00029360: 696e 7261 642c 202a 2a6b 7761 7267 7329  inrad, **kwargs)
+00029370: 0d0a 2020 2020 2020 2020 2020 2020 6261  ..            ba
+00029380: 7365 4661 6365 5665 7274 6578 496e 6469  seFaceVertexIndi
+00029390: 6365 7320 3d20 6266 7669 0d0a 2020 2020  ces = bfvi..    
+000293a0: 2020 2020 656c 7365 203a 0d0a 2020 2020      else :..    
+000293b0: 2020 2020 2020 2020 6966 2062 6173 6574          if baset
+000293c0: 7970 6520 6e6f 7420 696e 2073 656c 662e  ype not in self.
+000293d0: 5f62 6173 655f 7375 7266 6163 6573 203a  _base_surfaces :
+000293e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000293f0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+00029400: 6f72 2827 4261 7365 7479 7065 207b 7d20  or('Basetype {} 
+00029410: 6973 206e 6f74 2072 6563 6f67 6e69 7a65  is not recognize
+00029420: 642e 2050 6f73 7369 626c 6520 7661 6c75  d. Possible valu
+00029430: 6573 2061 7265 3a20 7b7d 272e 666f 726d  es are: {}'.form
+00029440: 6174 2862 6173 6574 7970 652c 6c69 7374  at(basetype,list
+00029450: 2873 656c 662e 5f62 6173 655f 7375 7266  (self._base_surf
+00029460: 6163 6573 2929 290d 0a20 2020 2020 2020  aces)))..       
+00029470: 2020 2020 2062 6173 6553 7572 664f 626a       baseSurfObj
+00029480: 203d 2073 656c 662e 5f62 6173 655f 7375   = self._base_su
+00029490: 7266 6163 6573 5b62 6173 6574 7970 655d  rfaces[basetype]
+000294a0: 0d0a 2020 2020 2020 2020 2020 2020 6261  ..            ba
+000294b0: 7365 5663 6f6f 7220 3d20 6261 7365 5375  seVcoor = baseSu
+000294c0: 7266 4f62 6a5b 2762 6173 6556 6572 7469  rfObj['baseVerti
+000294d0: 6365 7343 6f6f 7227 5d0d 0a20 2020 2020  cesCoor']..     
+000294e0: 2020 2020 2020 2062 6173 6546 6163 6556         baseFaceV
+000294f0: 6572 7465 7849 6e64 6963 6573 203d 6261  ertexIndices =ba
+00029500: 7365 5375 7266 4f62 6a5b 2762 6173 6546  seSurfObj['baseF
+00029510: 6163 6549 6e64 6963 6573 275d 0d0a 2020  aceIndices']..  
+00029520: 2020 2020 2020 2020 2020 696e 6465 784f            indexO
+00029530: 626a 2c76 6572 7465 7843 6f6f 7220 3d20  bj,vertexCoor = 
+00029540: 7365 6c66 2e74 7269 616e 6775 6c61 7465  self.triangulate
+00029550: 4261 7365 2872 657a 2c62 6173 6556 636f  Base(rez,baseVco
+00029560: 6f72 2c62 6173 6546 6163 6556 6572 7465  or,baseFaceVerte
+00029570: 7849 6e64 6963 6573 2c20 7365 6c66 2e5f  xIndices, self._
+00029580: 6d69 6456 6563 746f 7246 756e 290d 0a20  midVectorFun).. 
+00029590: 2020 2020 2020 2020 2020 2066 6163 6549             faceI
+000295a0: 6e64 6963 6573 203d 2069 6e64 6578 4f62  ndices = indexOb
+000295b0: 6a5b 2766 6163 6527 5d0d 0a20 2020 2020  j['face']..     
+000295c0: 2020 2020 2020 2065 6467 6549 6e64 6963         edgeIndic
+000295d0: 6573 203d 2069 6e64 6578 4f62 6a5b 2765  es = indexObj['e
+000295e0: 6467 6527 5d0d 0a0d 0a20 2020 2020 2020  dge']....       
+000295f0: 2073 7570 6572 2829 2e5f 5f69 6e69 745f   super().__init_
+00029600: 5f28 7665 7274 6578 436f 6f72 2c20 6661  _(vertexCoor, fa
+00029610: 6365 496e 6469 6365 732c 206e 616d 652c  ceIndices, name,
+00029620: 202a 2a6b 7761 7267 7329 0d0a 0d0a 2020   **kwargs)....  
+00029630: 2020 2020 2020 7365 6c66 2e63 6f6f 7254        self.coorT
+00029640: 7970 6520 3d20 5f43 4f4f 5253 5953 5b22  ype = _COORSYS["
+00029650: 504f 4c41 5222 5d0d 0a20 2020 2020 2020  POLAR"]..       
+00029660: 2073 656c 662e 5f6e 6f72 6d61 6c5f 7363   self._normal_sc
+00029670: 616c 6520 3d20 5f6e 6f72 6d4c 656e 6774  ale = _normLengt
+00029680: 6828 206c 656e 2866 6163 6549 6e64 6963  h( len(faceIndic
+00029690: 6573 292c 2031 2e32 2c20 312e 3535 2c20  es), 1.2, 1.55, 
+000296a0: 6e70 2e70 6920 290d 0a20 2020 2020 2020  np.pi )..       
+000296b0: 2073 656c 662e 5f72 657a 203d 2072 657a   self._rez = rez
+000296c0: 0d0a 2020 2020 2020 2020 7365 6c66 2e5f  ..        self._
+000296d0: 6261 7365 7479 7065 203d 2062 6173 6574  basetype = baset
+000296e0: 7970 650d 0a20 2020 2020 2020 2072 6574  ype..        ret
+000296f0: 7572 6e0d 0a0d 0a20 2020 2064 6566 2064  urn....    def d
+00029700: 6f6d 6169 6e28 7365 6c66 2c20 7261 6469  omain(self, radi
+00029710: 7573 3d4e 6f6e 652c 207a 636f 6f72 3d4e  us=None, zcoor=N
+00029720: 6f6e 6529 203a 0d0a 2020 2020 2020 2020  one) :..        
+00029730: 2222 220d 0a20 2020 2020 2020 2053 6574  """..        Set
+00029740: 2074 6865 2064 6f6d 6169 6e20 6f66 2074   the domain of t
+00029750: 6865 2070 6f6c 6172 2073 7572 6661 6365  he polar surface
+00029760: 2e0d 0a0d 0a20 2020 2020 2020 2055 7365  .....        Use
+00029770: 6420 666f 7220 7365 7474 696e 6720 7468  d for setting th
+00029780: 6520 6c69 6d69 7473 206f 6620 7468 6520  e limits of the 
+00029790: 6261 7365 2070 6f6c 6172 2070 6c61 6e65  base polar plane
+000297a0: 2e0d 0a0d 0a20 2020 2020 2020 2050 6172  .....        Par
+000297b0: 616d 6574 6572 730d 0a20 2020 2020 2020  ameters..       
+000297c0: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
+000297d0: 2020 2020 2020 7261 6469 7573 3a20 6e75        radius: nu
+000297e0: 6d62 6572 2c20 6465 6661 756c 7420 3a20  mber, default : 
+000297f0: 310d 0a20 2020 2020 2020 2020 2020 2052  1..            R
+00029800: 6164 6975 7320 6f66 2074 6865 2070 6f6c  adius of the pol
+00029810: 6172 2073 7572 6661 6365 2e0d 0a20 2020  ar surface...   
+00029820: 2020 2020 2020 2020 2049 6620 7365 7420           If set 
+00029830: 746f 204e 6f6e 652c 2074 6865 2072 6164  to None, the rad
+00029840: 6975 7320 6973 2075 6e63 6861 6e67 6564  ius is unchanged
+00029850: 2e0d 0a0d 0a20 2020 2020 2020 207a 636f  .....        zco
+00029860: 6f72 3a20 6e75 6d62 6572 2c20 6465 6661  or: number, defa
+00029870: 756c 7420 3a20 300d 0a20 2020 2020 2020  ult : 0..       
+00029880: 2020 2020 205a 206f 6666 7365 7420 6f66       Z offset of
+00029890: 2074 6865 2070 6f6c 6172 2070 6c61 6e65   the polar plane
+000298a0: 2e0d 0a20 2020 2020 2020 2020 2020 2049  ...            I
+000298b0: 6620 7365 7420 746f 204e 6f6e 652c 2074  f set to None, t
+000298c0: 6865 205a 206f 6666 7365 7420 6973 2075  he Z offset is u
+000298d0: 6e63 6861 6e67 6564 2e0d 0a20 2020 2020  nchanged...     
+000298e0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+000298f0: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
+00029900: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
+00029910: 2020 2073 656c 6620 3a20 506f 6c61 7253     self : PolarS
+00029920: 7572 6661 6365 206f 626a 6563 740d 0a0d  urface object...
+00029930: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
+00029940: 2020 2020 2020 6465 6620 7365 7444 6f6d        def setDom
+00029950: 6169 6e28 7274 7a2c 206d 722c 206d 7a29  ain(rtz, mr, mz)
+00029960: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
+00029970: 722c 742c 7a20 3d20 7274 7a0d 0a20 2020  r,t,z = rtz..   
+00029980: 2020 2020 2020 2020 2052 203d 206d 722a           R = mr*
+00029990: 720d 0a20 2020 2020 2020 2020 2020 205a  r..            Z
+000299a0: 203d 207a 2069 6620 6d7a 2069 7320 4e6f   = z if mz is No
+000299b0: 6e65 2065 6c73 6520 6e70 2e66 756c 6c28  ne else np.full(
+000299c0: 6c65 6e28 7a29 2c6d 7a29 0d0a 2020 2020  len(z),mz)..    
+000299d0: 2020 2020 2020 2020 7265 7475 726e 2052          return R
+000299e0: 2c74 2c5a 2020 2020 2020 200d 0a20 2020  ,t,Z       ..   
+000299f0: 2020 2020 2064 6566 2067 6574 436f 6e74       def getCont
+00029a00: 286c 696d 7329 203a 0d0a 2020 2020 2020  (lims) :..      
+00029a10: 2020 2020 2020 6d20 3d20 312e 300d 0a20        m = 1.0.. 
+00029a20: 2020 2020 2020 2020 2020 2069 6620 6c69             if li
+00029a30: 6d73 2069 7320 6e6f 7420 4e6f 6e65 203a  ms is not None :
+00029a40: 206d 203d 206c 696d 730d 0a20 2020 2020   m = lims..     
+00029a50: 2020 2020 2020 2072 6574 7572 6e20 6d0d         return m.
+00029a60: 0a20 2020 2020 2020 206d 7220 3d20 6765  .        mr = ge
+00029a70: 7443 6f6e 7428 7261 6469 7573 290d 0a20  tCont(radius).. 
+00029a80: 2020 2020 2020 2073 656c 662e 6d61 705f         self.map_
+00029a90: 6765 6f6d 5f66 726f 6d5f 6f70 286c 616d  geom_from_op(lam
+00029aa0: 6264 6120 4120 3a20 7365 7444 6f6d 6169  bda A : setDomai
+00029ab0: 6e28 412c 206d 722c 7a63 6f6f 7220 2929  n(A, mr,zcoor ))
+00029ac0: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00029ad0: 2073 656c 660d 0a0d 0a63 6c61 7373 2043   self....class C
+00029ae0: 796c 696e 6472 6963 616c 5375 7266 6163  ylindricalSurfac
+00029af0: 6528 5375 7266 6163 6533 4443 6f6c 6c65  e(Surface3DColle
+00029b00: 6374 696f 6e29 203a 0d0a 2020 2020 2222  ction) :..    ""
+00029b10: 220d 0a20 2020 2043 796c 696e 6472 6963  "..    Cylindric
+00029b20: 616c 2033 4420 7375 7266 6163 6520 696e  al 3D surface in
+00029b30: 2063 796c 696e 6472 6963 616c 2063 6f6f   cylindrical coo
+00029b40: 7264 696e 6174 6573 2e0d 0a0d 0a20 2020  rdinates.....   
+00029b50: 204d 6574 686f 6473 2061 7265 2069 6e68   Methods are inh
+00029b60: 6572 6974 6564 2066 726f 6d20 7468 6520  erited from the 
+00029b70: 5375 7266 6163 6533 4443 6f6c 6c65 6374  Surface3DCollect
+00029b80: 696f 6e2e 0d0a 2020 2020 4379 6c69 6e64  ion...    Cylind
+00029b90: 7269 6361 6c20 7375 7266 6163 6520 6765  rical surface ge
+00029ba0: 6f6d 6574 7269 6573 2061 7265 2063 7265  ometries are cre
+00029bb0: 6174 6564 2069 6e20 7468 6973 2073 7562  ated in this sub
+00029bc0: 636c 6173 732e 0d0a 0d0a 2020 2020 2222  class.....    ""
+00029bd0: 220d 0a0d 0a20 2020 2040 7374 6174 6963  "....    @static
+00029be0: 6d65 7468 6f64 0d0a 2020 2020 6465 6620  method..    def 
+00029bf0: 7261 6e64 2872 657a 3d30 2c73 6565 643d  rand(rez=0,seed=
+00029c00: 4e6f 6e65 2c6e 616d 653d 4e6f 6e65 2c6b  None,name=None,k
+00029c10: 696e 643d 4e6f 6e65 2c2a 2a6b 6172 6773  ind=None,**kargs
+00029c20: 2920 3a0d 0a20 2020 2020 2020 2022 2222  ) :..        """
+00029c30: 0d0a 2020 2020 2020 2020 4379 6c69 6e64  ..        Cylind
+00029c40: 7269 6361 6c53 7572 6661 6365 2077 6974  ricalSurface wit
+00029c50: 6820 7261 6e64 6f6d 2074 7269 616e 6775  h random triangu
+00029c60: 6c61 7220 6661 6365 732e 0d0a 0d0a 2020  lar faces.....  
+00029c70: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+00029c80: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
+00029c90: 2d2d 2d2d 0d0a 2020 2020 2020 2020 7265  ----..        re
+00029ca0: 7a20 3a20 6e75 6d62 6572 2c20 6f70 7469  z : number, opti
+00029cb0: 6f6e 616c 2c20 6465 6661 756c 743a 2030  onal, default: 0
+00029cc0: 0d0a 2020 2020 2020 2020 2020 2020 4e75  ..            Nu
+00029cd0: 6d62 6572 206f 6620 2772 6563 7572 7369  mber of 'recursi
+00029ce0: 7665 2720 7375 6264 6976 6973 696f 6e73  ve' subdivisions
+00029cf0: 206f 6620 7468 6520 7472 6961 6e67 756c   of the triangul
+00029d00: 6174 6564 2062 6173 6520 6661 6365 732e  ated base faces.
+00029d10: 0d0a 2020 2020 2020 2020 2020 2020 5265  ..            Re
+00029d20: 7a20 7661 6c75 6573 2072 616e 6765 2066  z values range f
+00029d30: 726f 6d20 3020 746f 2037 2e0d 0a0d 0a20  rom 0 to 7..... 
+00029d40: 2020 2020 2020 2073 6565 6420 3a20 696e         seed : in
+00029d50: 7465 6765 722c 206f 7074 696f 6e61 6c2c  teger, optional,
+00029d60: 2064 6566 6175 6c74 3a20 4e6f 6e65 0d0a   default: None..
+00029d70: 2020 2020 2020 2020 2020 2020 416e 2069              An i
+00029d80: 6e69 7469 616c 697a 6174 696f 6e20 7365  nitialization se
+00029d90: 6564 2066 6f72 2072 616e 646f 6d20 6765  ed for random ge
+00029da0: 6e65 7261 7469 6f6e 2e0d 0a0d 0a20 2020  neration.....   
+00029db0: 2020 2020 206e 616d 6520 3a20 7374 7269       name : stri
+00029dc0: 6e67 2c20 6f70 7469 6f6e 616c 2c20 6465  ng, optional, de
+00029dd0: 6661 756c 743a 204e 6f6e 652e 0d0a 2020  fault: None...  
+00029de0: 2020 2020 2020 2020 2020 4465 7363 7269            Descri
+00029df0: 7074 6976 6520 6964 656e 7469 6669 6572  ptive identifier
+00029e00: 2066 6f72 2074 6865 2067 656f 6d65 7472   for the geometr
+00029e10: 792e 0d0a 0d0a 2020 2020 2020 2020 6b69  y.....        ki
+00029e20: 6e64 203a 2073 7472 696e 672c 206f 7074  nd : string, opt
+00029e30: 696f 6e61 6c2c 2064 6566 6175 6c74 3a20  ional, default: 
+00029e40: 4e6f 6e65 0d0a 2020 2020 2020 2020 2020  None..          
+00029e50: 2020 2872 6573 6572 7665 642c 206e 6f74    (reserved, not
+00029e60: 2069 6d70 6c65 6d65 6e74 6564 2920 0d0a   implemented) ..
+00029e70: 0d0a 2020 2020 2020 2020 5261 6973 6573  ..        Raises
+00029e80: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
+00029e90: 0d0a 2020 2020 2020 2020 5661 6c75 6545  ..        ValueE
+00029ea0: 7272 6f72 0d0a 2020 2020 2020 2020 2020  rror..          
+00029eb0: 2020 4966 2072 657a 2069 7320 6e6f 7420    If rez is not 
+00029ec0: 616e 2069 6e74 6567 6572 2069 6e20 7261  an integer in ra
+00029ed0: 6e67 6520 3020 746f 2037 2e0d 0a20 2020  nge 0 to 7...   
+00029ee0: 2020 2020 2020 2020 2049 6620 6261 7365           If base
+00029ef0: 7479 7065 2069 7320 6e6f 7420 7265 636f  type is not reco
+00029f00: 676e 697a 6564 2066 6f72 2074 6869 7320  gnized for this 
+00029f10: 7375 7266 6163 6520 636f 6e73 7472 7563  surface construc
+00029f20: 746f 722e 0d0a 0d0a 2020 2020 2020 2020  tor.....        
+00029f30: 4f74 6865 7220 5061 7261 6d65 7465 7273  Other Parameters
+00029f40: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
+00029f50: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
+00029f60: 2020 2020 2a2a 6b77 6172 6773 0d0a 2020      **kwargs..  
+00029f70: 2020 2020 2020 2020 2020 416c 6c20 6f74            All ot
+00029f80: 6865 7220 7061 7261 6d65 7465 7273 2061  her parameters a
+00029f90: 7265 2070 6173 7365 6420 6f6e 2074 6f20  re passed on to 
+00029fa0: 2773 3364 6c69 622e 7375 7266 6163 652e  's3dlib.surface.
+00029fb0: 5375 7266 6163 6533 4443 6f6c 6c65 6374  Surface3DCollect
+00029fc0: 696f 6e27 2e0d 0a20 2020 2020 2020 200d  ion'...        .
+00029fd0: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+00029fe0: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
+00029ff0: 2d0d 0a20 2020 2020 2020 2073 7572 6661  -..        surfa
+0002a000: 6365 203a 2043 796c 696e 6472 6963 616c  ce : Cylindrical
+0002a010: 5375 7266 6163 6520 6f62 6a65 6374 2e0d  Surface object..
+0002a020: 0a0d 0a20 2020 2020 2020 2022 2222 0d0a  ...        """..
+0002a030: 2020 2020 2020 2020 232e 2e2e 2e2e 2e2e          #.......
+0002a040: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0002a050: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0002a060: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0002a070: 2e2e 0d0a 2020 2020 2020 2020 6465 6620  ....        def 
+0002a080: 7261 6e64 6f6d 5f73 696e 4469 7374 2873  random_sinDist(s
+0002a090: 697a 6529 203a 0d0a 2020 2020 2020 2020  ize) :..        
+0002a0a0: 2020 2020 6e4c 6f6f 702c 6e43 6f6e 7472      nLoop,nContr
+0002a0b0: 6f6c 2c73 616d 706c 6573 203d 2030 2c20  ol,samples = 0, 
+0002a0c0: 3130 2a2a 362c 205b 5d0d 0a20 2020 2020  10**6, []..     
+0002a0d0: 2020 2020 2020 2077 6869 6c65 206c 656e         while len
+0002a0e0: 2873 616d 706c 6573 293c 7369 7a65 2061  (samples)<size a
+0002a0f0: 6e64 206e 4c6f 6f70 3c6e 436f 6e74 726f  nd nLoop<nContro
+0002a100: 6c3a 0d0a 2020 2020 2020 2020 2020 2020  l:..            
+0002a110: 2020 2020 783d 6e70 2e72 616e 646f 6d2e      x=np.random.
+0002a120: 7261 6e64 6f6d 5f73 616d 706c 6528 290d  random_sample().
+0002a130: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002a140: 2070 726f 623d 6e70 2e73 696e 2878 2a6e   prob=np.sin(x*n
+0002a150: 702e 7069 292f 320d 0a20 2020 2020 2020  p.pi)/2..       
+0002a160: 2020 2020 2020 2020 2061 7373 6572 7420           assert 
+0002a170: 7072 6f62 3e3d 3020 616e 6420 7072 6f62  prob>=0 and prob
+0002a180: 3c3d 310d 0a20 2020 2020 2020 2020 2020  <=1..           
+0002a190: 2020 2020 2069 6620 6e70 2e72 616e 646f       if np.rando
+0002a1a0: 6d2e 7261 6e64 6f6d 5f73 616d 706c 6528  m.random_sample(
+0002a1b0: 2920 3c3d 7072 6f62 3a20 7361 6d70 6c65  ) <=prob: sample
+0002a1c0: 7320 2b3d 205b 785d 0d0a 2020 2020 2020  s += [x]..      
+0002a1d0: 2020 2020 2020 2020 2020 6e4c 6f6f 702b            nLoop+
+0002a1e0: 3d31 0d0a 2020 2020 2020 2020 2020 2020  =1..            
+0002a1f0: 7265 7475 726e 206e 702e 6172 7261 7928  return np.array(
+0002a200: 7361 6d70 6c65 7329 0d0a 2020 2020 2020  samples)..      
+0002a210: 2020 232e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e    #.............
+0002a220: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0002a230: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0002a240: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 0d0a 0d0a  ................
+0002a250: 2020 2020 2020 2020 6966 206e 6f74 2069          if not i
+0002a260: 7369 6e73 7461 6e63 6528 7265 7a2c 2028  sinstance(rez, (
+0002a270: 696e 742c 2066 6c6f 6174 2929 203a 0d0a  int, float)) :..
+0002a280: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0002a290: 6520 5661 6c75 6545 7272 6f72 2827 496e  e ValueError('In
+0002a2a0: 636f 7272 6563 7420 7265 7a20 7479 7065  correct rez type
+0002a2b0: 2c20 6d75 7374 2062 6520 6120 6e75 6d62  , must be a numb
+0002a2c0: 6572 2e27 290d 0a20 2020 2020 2020 2069  er.')..        i
+0002a2d0: 6620 2872 657a 3c30 2920 6f72 2028 7265  f (rez<0) or (re
+0002a2e0: 7a3e 5f4d 4158 5245 5a29 203a 0d0a 2020  z>_MAXREZ) :..  
+0002a2f0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0002a300: 5661 6c75 6545 7272 6f72 2827 496e 636f  ValueError('Inco
+0002a310: 7272 6573 7420 7265 7a20 6f66 207b 7d2c  rrest rez of {},
+0002a320: 206d 7573 7420 6265 2061 206e 756d 6265   must be a numbe
+0002a330: 722c 2030 203c 3d20 7265 7a20 3c3d 207b  r, 0 <= rez <= {
+0002a340: 7d27 2e66 6f72 6d61 7428 7265 7a2c 5f4d  }'.format(rez,_M
+0002a350: 4158 5245 5a29 290d 0a0d 0a20 2020 2020  AXREZ))....     
+0002a360: 2020 2069 6620 7365 6564 2069 7320 6e6f     if seed is no
+0002a370: 7420 4e6f 6e65 203a 0d0a 2020 2020 2020  t None :..      
+0002a380: 2020 2020 2020 6966 206e 6f74 2069 7369        if not isi
+0002a390: 6e73 7461 6e63 6528 7365 6564 2c20 696e  nstance(seed, in
+0002a3a0: 7429 203a 0d0a 2020 2020 2020 2020 2020  t) :..          
+0002a3b0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+0002a3c0: 6545 7272 6f72 2827 496e 636f 7272 6563  eError('Incorrec
+0002a3d0: 7420 7365 6564 2074 7970 652c 206d 7573  t seed type, mus
+0002a3e0: 7420 6261 206f 6620 7479 7065 2069 6e74  t ba of type int
+0002a3f0: 2729 200d 0a20 2020 2020 2020 2020 2020  ') ..           
+0002a400: 206e 702e 7261 6e64 6f6d 2e73 6565 6428   np.random.seed(
+0002a410: 7365 6564 290d 0a0d 0a20 2020 2020 2020  seed)....       
+0002a420: 204e 203d 2069 6e74 2831 322a 2834 2a2a   N = int(12*(4**
+0002a430: 7265 7a29 2f32 202b 2033 2a28 322a 2a72  rez)/2 + 3*(2**r
+0002a440: 657a 2929 0d0a 2020 2020 2020 2020 7220  ez))..        r 
+0002a450: 3d20 6e70 2e6f 6e65 7328 204e 2029 0d0a  = np.ones( N )..
+0002a460: 2020 2020 2020 2020 7420 3d20 6e70 2e72          t = np.r
+0002a470: 616e 646f 6d2e 756e 6966 6f72 6d28 302c  andom.uniform(0,
+0002a480: 322a 6e70 2e70 692c 204e 290d 0a20 2020  2*np.pi, N)..   
+0002a490: 2020 2020 207a 203d 206e 702e 7261 6e64       z = np.rand
+0002a4a0: 6f6d 2e75 6e69 666f 726d 282d 312c 312c  om.uniform(-1,1,
+0002a4b0: 204e 290d 0a20 2020 2020 2020 2064 6174   N)..        dat
+0002a4c0: 6150 7473 203d 206e 702e 6172 7261 7928  aPts = np.array(
+0002a4d0: 205b 722c 742c 7a5d 2029 2e54 0d0a 2020   [r,t,z] ).T..  
+0002a4e0: 2020 2020 2020 6966 206e 616d 6520 6973        if name is
+0002a4f0: 204e 6f6e 6520 3a20 6e61 6d65 203d 2027   None : name = '
+0002a500: 7261 6e64 6f6d 206d 6573 6827 0d0a 2020  random mesh'..  
+0002a510: 2020 2020 2020 7375 7266 6163 6520 3d20        surface = 
+0002a520: 4379 6c69 6e64 7269 6361 6c53 7572 6661  CylindricalSurfa
+0002a530: 6365 2e70 6e74 7375 7266 2864 6174 6150  ce.pntsurf(dataP
+0002a540: 7473 2c20 6e61 6d65 3d4e 6f6e 652c 202a  ts, name=None, *
+0002a550: 2a6b 6172 6773 290d 0a20 2020 2020 2020  *kargs)..       
+0002a560: 2073 7572 6661 6365 2e5f 7265 7a20 3d20   surface._rez = 
+0002a570: 7374 7228 7265 7a29 2069 6620 6973 696e  str(rez) if isin
+0002a580: 7374 616e 6365 2872 657a 2c69 6e74 2920  stance(rez,int) 
+0002a590: 656c 7365 2027 7b3a 2e31 667d 272e 666f  else '{:.1f}'.fo
+0002a5a0: 726d 6174 2872 657a 290d 0a20 2020 2020  rmat(rez)..     
+0002a5b0: 2020 2073 7572 6661 6365 2e5f 6261 7365     surface._base
+0002a5c0: 7479 7065 203d 2027 7261 6e64 5f27 2b73  type = 'rand_'+s
+0002a5d0: 7472 2873 6565 6429 0d0a 2020 2020 2020  tr(seed)..      
+0002a5e0: 2020 7265 7475 726e 2073 7572 6661 6365    return surface
+0002a5f0: 0d0a 0d0a 2020 2020 4073 7461 7469 636d  ....    @staticm
+0002a600: 6574 686f 640d 0a20 2020 2064 6566 205f  ethod..    def _
+0002a610: 6765 745f 6379 6c69 6e64 7269 6361 6c5f  get_cylindrical_
+0002a620: 7375 7266 6163 6573 5f64 6963 7469 6f6e  surfaces_diction
+0002a630: 6172 7928 2920 3a0d 0a20 2020 2020 2020  ary() :..       
+0002a640: 2022 2222 436f 6e73 7472 7563 7473 2074   """Constructs t
+0002a650: 6865 2064 6963 7469 6f6e 6172 7920 6f66  he dictionary of
+0002a660: 2062 6173 6520 6379 6c69 6e64 7269 6361   base cylindrica
+0002a670: 6c20 7375 7266 6163 6520 6765 6f6d 6574  l surface geomet
+0002a680: 7269 6573 2e20 2222 220d 0a0d 0a20 2020  ries. """....   
+0002a690: 2020 2020 2073 7572 6661 6365 7344 6963       surfacesDic
+0002a6a0: 7469 6f6e 6172 7920 3d20 7b7d 0d0a 2020  tionary = {}..  
+0002a6b0: 2020 2020 2020 6465 6620 636f 6e73 7472        def constr
+0002a6c0: 7563 745f 7472 6963 796c 696e 6465 7228  uct_tricylinder(
+0002a6d0: 2920 3a0d 0a20 2020 2020 2020 2020 2020  ) :..           
+0002a6e0: 2079 3020 3d20 6e70 2e73 7172 7428 332e   y0 = np.sqrt(3.
+0002a6f0: 3029 2f32 2e30 0d0a 2020 2020 2020 2020  0)/2.0..        
+0002a700: 2020 2020 7830 203d 2030 2e35 0d0a 0d0a      x0 = 0.5....
+0002a710: 2020 2020 2020 2020 2020 2020 6261 7365              base
+0002a720: 5665 7274 203d 205b 205b 312c 302c 305d  Vert = [ [1,0,0]
+0002a730: 2c20 2020 5b2d 7830 2c2d 7930 2c30 5d2c  ,   [-x0,-y0,0],
+0002a740: 205b 2d78 302c 7930 2c30 5d2c 0d0a 2020   [-x0,y0,0],..  
+0002a750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a760: 2020 2020 2020 205b 2d31 2c30 2c31 5d2c         [-1,0,1],
+0002a770: 2020 5b78 302c 2d79 302c 315d 2c20 205b    [x0,-y0,1],  [
+0002a780: 7830 2c79 302c 315d 2c0d 0a20 2020 2020  x0,y0,1],..     
+0002a790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a7a0: 2020 2020 5b2d 312c 302c 2d31 5d2c 205b      [-1,0,-1], [
+0002a7b0: 7830 2c2d 7930 2c2d 315d 2c20 5b78 302c  x0,-y0,-1], [x0,
+0002a7c0: 7930 2c2d 315d 205d 0d0a 0d0a 2020 2020  y0,-1] ]....    
+0002a7d0: 2020 2020 2020 2020 6261 7365 4661 6365          baseFace
+0002a7e0: 733d 2820 0d0a 2020 2020 2020 2020 2020  s=( ..          
+0002a7f0: 2020 2020 2020 5b30 2c32 2c35 5d2c 5b32        [0,2,5],[2
+0002a800: 2c31 2c33 5d2c 5b31 2c30 2c34 5d2c 0d0a  ,1,3],[1,0,4],..
+0002a810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a820: 5b30 2c35 2c34 5d2c 5b32 2c33 2c35 5d2c  [0,5,4],[2,3,5],
+0002a830: 5b31 2c34 2c33 5d2c 200d 0a20 2020 2020  [1,4,3], ..     
+0002a840: 2020 2020 2020 2020 2020 205b 302c 382c             [0,8,
+0002a850: 325d 2c5b 322c 362c 315d 2c5b 312c 372c  2],[2,6,1],[1,7,
+0002a860: 305d 2c0d 0a20 2020 2020 2020 2020 2020  0],..           
+0002a870: 2020 2020 205b 302c 372c 385d 2c5b 322c       [0,7,8],[2,
+0002a880: 382c 365d 2c5b 312c 362c 375d 290d 0a0d  8,6],[1,6,7])...
+0002a890: 0a20 2020 2020 2020 2020 2020 2046 6f20  .            Fo 
+0002a8a0: 3d20 6c65 6e28 6261 7365 4661 6365 7329  = len(baseFaces)
+0002a8b0: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
+0002a8c0: 7475 726e 207b 2027 6261 7365 4661 6365  turn { 'baseFace
+0002a8d0: 496e 6469 6365 7327 203a 2062 6173 6546  Indices' : baseF
+0002a8e0: 6163 6573 202c 2027 6261 7365 5665 7274  aces , 'baseVert
+0002a8f0: 6963 6573 436f 6f72 2720 3a20 6261 7365  icesCoor' : base
+0002a900: 5665 7274 2c20 2766 6576 5061 7261 6d27  Vert, 'fevParam'
+0002a910: 203a 205b 466f 2c33 2c30 5d20 7d0d 0a0d   : [Fo,3,0] }...
+0002a920: 0a20 2020 2020 2020 2064 6566 2063 6f6e  .        def con
+0002a930: 7374 7275 6374 5f74 7269 6379 6c69 6e64  struct_tricylind
+0002a940: 6572 5f76 2829 203a 0d0a 2020 2020 2020  er_v() :..      
+0002a950: 2020 2020 2020 7666 695f 6420 3d20 636f        vfi_d = co
+0002a960: 6e73 7472 7563 745f 7472 6963 796c 696e  nstruct_tricylin
+0002a970: 6465 7228 290d 0a20 2020 2020 2020 2020  der()..         
+0002a980: 2020 2062 6173 6556 6572 7420 3d20 2076     baseVert =  v
+0002a990: 6669 5f64 5b27 6261 7365 5665 7274 6963  fi_d['baseVertic
+0002a9a0: 6573 436f 6f72 275d 0d0a 2020 2020 2020  esCoor']..      
+0002a9b0: 2020 2020 2020 6261 7365 4661 6365 7320        baseFaces 
+0002a9c0: 3d20 7666 695f 645b 2762 6173 6546 6163  = vfi_d['baseFac
+0002a9d0: 6549 6e64 6963 6573 275d 0d0a 2020 2020  eIndices']..    
+0002a9e0: 2020 2020 2020 2020 6261 7365 5665 7274          baseVert
+0002a9f0: 203d 2062 6173 6556 6572 7420 2b20 5b5b   = baseVert + [[
+0002aa00: 302c 302c 315d 2c5b 302c 302c 2d31 5d5d  0,0,1],[0,0,-1]]
+0002aa10: 0d0a 2020 2020 2020 2020 2020 2020 6261  ..            ba
+0002aa20: 7365 4661 6365 7320 3d20 6c69 7374 2862  seFaces = list(b
+0002aa30: 6173 6546 6163 6573 290d 0a20 2020 2020  aseFaces)..     
+0002aa40: 2020 2020 2020 2061 6464 4661 6365 7320         addFaces 
+0002aa50: 3d20 5b20 0d0a 2020 2020 2020 2020 2020  = [ ..          
+0002aa60: 2020 2020 2020 5b33 2c34 2c39 5d2c 5b34        [3,4,9],[4
+0002aa70: 2c35 2c39 5d2c 5b35 2c33 2c39 5d2c 0d0a  ,5,9],[5,3,9],..
+0002aa80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002aa90: 5b36 2c38 2c31 305d 2c5b 382c 372c 3130  [6,8,10],[8,7,10
+0002aaa0: 5d2c 5b37 2c36 2c31 305d 205d 0d0a 2020  ],[7,6,10] ]..  
+0002aab0: 2020 2020 2020 2020 2020 6261 7365 4661            baseFa
+0002aac0: 6365 7320 3d20 6261 7365 4661 6365 7320  ces = baseFaces 
+0002aad0: 2b20 6164 6446 6163 6573 0d0a 2020 2020  + addFaces..    
+0002aae0: 2020 2020 2020 2020 466f 203d 206c 656e          Fo = len
+0002aaf0: 2862 6173 6546 6163 6573 290d 0a20 2020  (baseFaces)..   
+0002ab00: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0002ab10: 7b20 2762 6173 6546 6163 6549 6e64 6963  { 'baseFaceIndic
+0002ab20: 6573 2720 3a20 6261 7365 4661 6365 7320  es' : baseFaces 
+0002ab30: 2c20 2762 6173 6556 6572 7469 6365 7343  , 'baseVerticesC
+0002ab40: 6f6f 7227 203a 2062 6173 6556 6572 742c  oor' : baseVert,
+0002ab50: 2027 6665 7650 6172 616d 2720 3a20 5b46   'fevParam' : [F
+0002ab60: 6f2c 302c 325d 207d 0d0a 2020 2020 2020  o,0,2] }..      
+0002ab70: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+0002ab80: 6465 6620 636f 6e73 7472 7563 745f 7472  def construct_tr
+0002ab90: 6932 6379 6c69 6e64 6572 2829 203a 0d0a  i2cylinder() :..
+0002aba0: 2020 2020 2020 2020 2020 2020 7930 203d              y0 =
+0002abb0: 206e 702e 7371 7274 2833 2e30 292f 322e   np.sqrt(3.0)/2.
+0002abc0: 300d 0a20 2020 2020 2020 2020 2020 2078  0..            x
+0002abd0: 3020 3d20 302e 3520 0d0a 0d0a 2020 2020  0 = 0.5 ....    
+0002abe0: 2020 2020 2020 2020 6261 7365 5665 7274          baseVert
+0002abf0: 203d 205b 205b 2d31 2c30 2c30 5d2c 205b   = [ [-1,0,0], [
+0002ac00: 7830 2c2d 7930 2c30 5d2c 2020 205b 7830  x0,-y0,0],   [x0
+0002ac10: 2c79 302c 305d 2c0d 0a20 2020 2020 2020  ,y0,0],..       
+0002ac20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ac30: 2020 5b31 2c30 2c31 5d2c 2020 5b2d 7830    [1,0,1],  [-x0
+0002ac40: 2c2d 7930 2c31 5d2c 2020 5b2d 7830 2c79  ,-y0,1],  [-x0,y
+0002ac50: 302c 315d 2c0d 0a20 2020 2020 2020 2020  0,1],..         
+0002ac60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ac70: 5b31 2c30 2c2d 315d 2c20 5b2d 7830 2c2d  [1,0,-1], [-x0,-
+0002ac80: 7930 2c2d 315d 2c20 5b2d 7830 2c79 302c  y0,-1], [-x0,y0,
+0002ac90: 2d31 5d20 5d0d 0a0d 0a20 2020 2020 2020  -1] ]....       
+0002aca0: 2020 2020 2062 6173 6546 6163 6573 3d28       baseFaces=(
+0002acb0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+0002acc0: 2020 205b 302c 342c 355d 2c5b 312c 332c     [0,4,5],[1,3,
+0002acd0: 345d 2c5b 322c 352c 335d 2c0d 0a20 2020  4],[2,5,3],..   
+0002ace0: 2020 2020 2020 2020 2020 2020 205b 302c               [0,
+0002acf0: 382c 375d 2c5b 312c 372c 365d 2c5b 322c  8,7],[1,7,6],[2,
+0002ad00: 362c 385d 2c0d 0a20 2020 2020 2020 2020  6,8],..         
+0002ad10: 2020 2020 2020 205b 302c 372c 345d 2c5b         [0,7,4],[
+0002ad20: 312c 362c 335d 2c5b 322c 382c 355d 2c0d  1,6,3],[2,8,5],.
+0002ad30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002ad40: 205b 302c 352c 385d 2c5b 312c 342c 375d   [0,5,8],[1,4,7]
+0002ad50: 2c5b 322c 332c 365d 290d 0a0d 0a20 2020  ,[2,3,6])....   
+0002ad60: 2020 2020 2020 2020 2046 6f20 3d20 6c65           Fo = le
+0002ad70: 6e28 6261 7365 4661 6365 7329 0d0a 2020  n(baseFaces)..  
+0002ad80: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0002ad90: 207b 2027 6261 7365 4661 6365 496e 6469   { 'baseFaceIndi
+0002ada0: 6365 7327 203a 2062 6173 6546 6163 6573  ces' : baseFaces
+0002adb0: 202c 2027 6261 7365 5665 7274 6963 6573   , 'baseVertices
+0002adc0: 436f 6f72 2720 3a20 6261 7365 5665 7274  Coor' : baseVert
+0002add0: 2c20 2766 6576 5061 7261 6d27 203a 205b  , 'fevParam' : [
+0002ade0: 466f 2c33 2c30 5d20 7d0d 0a0d 0a20 2020  Fo,3,0] }....   
+0002adf0: 2020 2020 2064 6566 2063 6f6e 7374 7275       def constru
+0002ae00: 6374 5f74 7269 3263 796c 696e 6465 725f  ct_tri2cylinder_
+0002ae10: 7628 2920 3a0d 0a20 2020 2020 2020 2020  v() :..         
+0002ae20: 2020 2076 6669 5f64 203d 2063 6f6e 7374     vfi_d = const
+0002ae30: 7275 6374 5f74 7269 3263 796c 696e 6465  ruct_tri2cylinde
+0002ae40: 7228 290d 0a20 2020 2020 2020 2020 2020  r()..           
+0002ae50: 2062 6173 6556 6572 7420 3d20 2076 6669   baseVert =  vfi
+0002ae60: 5f64 5b27 6261 7365 5665 7274 6963 6573  _d['baseVertices
+0002ae70: 436f 6f72 275d 0d0a 2020 2020 2020 2020  Coor']..        
+0002ae80: 2020 2020 6261 7365 4661 6365 7320 3d20      baseFaces = 
+0002ae90: 7666 695f 645b 2762 6173 6546 6163 6549  vfi_d['baseFaceI
+0002aea0: 6e64 6963 6573 275d 0d0a 2020 2020 2020  ndices']..      
+0002aeb0: 2020 2020 2020 6261 7365 5665 7274 203d        baseVert =
+0002aec0: 2062 6173 6556 6572 7420 2b20 5b5b 302c   baseVert + [[0,
+0002aed0: 302c 315d 2c5b 302c 302c 2d31 5d5d 0d0a  0,1],[0,0,-1]]..
+0002aee0: 2020 2020 2020 2020 2020 2020 6261 7365              base
+0002aef0: 4661 6365 7320 3d20 6c69 7374 2862 6173  Faces = list(bas
+0002af00: 6546 6163 6573 290d 0a20 2020 2020 2020  eFaces)..       
+0002af10: 2020 2020 2061 6464 4661 6365 7320 3d20       addFaces = 
+0002af20: 5b20 0d0a 2020 2020 2020 2020 2020 2020  [ ..            
+0002af30: 2020 2020 5b33 2c39 2c34 5d2c 5b34 2c39      [3,9,4],[4,9
+0002af40: 2c35 5d2c 5b35 2c39 2c33 5d2c 0d0a 2020  ,5],[5,9,3],..  
+0002af50: 2020 2020 2020 2020 2020 2020 2020 5b36                [6
+0002af60: 2c31 302c 385d 2c5b 372c 3130 2c36 5d2c  ,10,8],[7,10,6],
+0002af70: 5b38 2c31 302c 375d 205d 0d0a 2020 2020  [8,10,7] ]..    
+0002af80: 2020 2020 2020 2020 6261 7365 4661 6365          baseFace
+0002af90: 7320 3d20 6261 7365 4661 6365 7320 2b20  s = baseFaces + 
+0002afa0: 6164 6446 6163 6573 0d0a 2020 2020 2020  addFaces..      
+0002afb0: 2020 2020 2020 466f 203d 206c 656e 2862        Fo = len(b
+0002afc0: 6173 6546 6163 6573 290d 0a20 2020 2020  aseFaces)..     
+0002afd0: 2020 2020 2020 2072 6574 7572 6e20 7b20         return { 
+0002afe0: 2762 6173 6546 6163 6549 6e64 6963 6573  'baseFaceIndices
+0002aff0: 2720 3a20 6261 7365 4661 6365 7320 2c20  ' : baseFaces , 
+0002b000: 2762 6173 6556 6572 7469 6365 7343 6f6f  'baseVerticesCoo
+0002b010: 7227 203a 2062 6173 6556 6572 742c 2027  r' : baseVert, '
+0002b020: 6665 7650 6172 616d 2720 3a20 5b46 6f2c  fevParam' : [Fo,
+0002b030: 302c 325d 207d 0d0a 0d0a 2020 2020 2020  0,2] }....      
+0002b040: 2020 6465 6620 636f 6e73 7472 7563 745f    def construct_
+0002b050: 7472 6932 6379 6c69 6e64 6572 5f73 6c69  tri2cylinder_sli
+0002b060: 6365 6428 2920 3a0d 0a20 2020 2020 2020  ced() :..       
+0002b070: 2020 2020 2079 3020 3d20 6e70 2e73 7172       y0 = np.sqr
+0002b080: 7428 332e 3029 2f32 2e30 0d0a 2020 2020  t(3.0)/2.0..    
+0002b090: 2020 2020 2020 2020 7830 203d 2030 2e35          x0 = 0.5
+0002b0a0: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
+0002b0b0: 2079 6f66 203d 2030 2e30 3030 310d 0a0d   yof = 0.0001...
+0002b0c0: 0a20 2020 2020 2020 2020 2020 2062 6173  .            bas
+0002b0d0: 6556 6572 7420 3d20 5b20 5b2d 312c 302c  eVert = [ [-1,0,
+0002b0e0: 305d 2c20 2020 5b78 302c 2d79 302c 305d  0],   [x0,-y0,0]
+0002b0f0: 2c20 2020 5b78 302c 7930 2c30 5d2c 0d0a  ,   [x0,y0,0],..
+0002b100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b110: 2020 2020 2020 2020 205b 312c 796f 662c           [1,yof,
+0002b120: 315d 2c20 205b 2d78 302c 2d79 302c 315d  1],  [-x0,-y0,1]
+0002b130: 2c20 205b 2d78 302c 7930 2c31 5d2c 0d0a  ,  [-x0,y0,1],..
+0002b140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b150: 2020 2020 2020 2020 205b 312c 796f 662c           [1,yof,
+0002b160: 2d31 5d2c 205b 2d78 302c 2d79 302c 2d31  -1], [-x0,-y0,-1
+0002b170: 5d2c 205b 2d78 302c 7930 2c2d 315d 2c0d  ], [-x0,y0,-1],.
+0002b180: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002b190: 2020 2020 2020 2020 2020 5b31 2c2d 796f            [1,-yo
+0002b1a0: 662c 315d 2c20 5b31 2c2d 796f 662c 2d31  f,1], [1,-yof,-1
+0002b1b0: 5d20 5d0d 0a0d 0a20 2020 2020 2020 2020  ] ]....         
+0002b1c0: 2020 2062 6173 6546 6163 6573 3d28 200d     baseFaces=( .
+0002b1d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002b1e0: 205b 302c 342c 355d 2c5b 312c 392c 345d   [0,4,5],[1,9,4]
+0002b1f0: 2c5b 322c 352c 335d 2c0d 0a20 2020 2020  ,[2,5,3],..     
+0002b200: 2020 2020 2020 2020 2020 205b 302c 382c             [0,8,
+0002b210: 375d 2c5b 312c 372c 3130 5d2c 5b32 2c36  7],[1,7,10],[2,6
+0002b220: 2c38 5d2c 0d0a 2020 2020 2020 2020 2020  ,8],..          
+0002b230: 2020 2020 2020 5b30 2c37 2c34 5d2c 5b31        [0,7,4],[1
+0002b240: 2c31 302c 395d 2c5b 322c 382c 355d 2c0d  ,10,9],[2,8,5],.
+0002b250: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
+0002b260: 2020 205b 302c 352c 385d 2c5b 312c 342c     [0,5,8],[1,4,
+0002b270: 375d 2c5b 322c 332c 365d 290d 0a0d 0a20  7],[2,3,6]).... 
+0002b280: 2020 2020 2020 2020 2020 2046 6f20 3d20             Fo = 
+0002b290: 6c65 6e28 6261 7365 4661 6365 7329 0d0a  len(baseFaces)..
+0002b2a0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0002b2b0: 726e 207b 2027 6261 7365 4661 6365 496e  rn { 'baseFaceIn
+0002b2c0: 6469 6365 7327 203a 2062 6173 6546 6163  dices' : baseFac
+0002b2d0: 6573 202c 2027 6261 7365 5665 7274 6963  es , 'baseVertic
+0002b2e0: 6573 436f 6f72 2720 3a20 6261 7365 5665  esCoor' : baseVe
+0002b2f0: 7274 2c20 2766 6576 5061 7261 6d27 203a  rt, 'fevParam' :
+0002b300: 205b 466f 2c34 2c31 5d20 7d0d 0a0d 0a20   [Fo,4,1] }.... 
+0002b310: 2020 2020 2020 2064 6566 2063 6f6e 7374         def const
+0002b320: 7275 6374 5f74 7269 3263 796c 696e 6465  ruct_tri2cylinde
+0002b330: 725f 736c 6963 6564 5f76 2829 203a 0d0a  r_sliced_v() :..
+0002b340: 2020 2020 2020 2020 2020 2020 7666 695f              vfi_
+0002b350: 6420 3d20 636f 6e73 7472 7563 745f 7472  d = construct_tr
+0002b360: 6932 6379 6c69 6e64 6572 5f73 6c69 6365  i2cylinder_slice
+0002b370: 6428 290d 0a20 2020 2020 2020 2020 2020  d()..           
+0002b380: 2062 6173 6556 6572 7420 3d20 2076 6669   baseVert =  vfi
+0002b390: 5f64 5b27 6261 7365 5665 7274 6963 6573  _d['baseVertices
+0002b3a0: 436f 6f72 275d 0d0a 2020 2020 2020 2020  Coor']..        
+0002b3b0: 2020 2020 6261 7365 4661 6365 7320 3d20      baseFaces = 
+0002b3c0: 7666 695f 645b 2762 6173 6546 6163 6549  vfi_d['baseFaceI
+0002b3d0: 6e64 6963 6573 275d 0d0a 2020 2020 2020  ndices']..      
+0002b3e0: 2020 2020 2020 6261 7365 5665 7274 203d        baseVert =
+0002b3f0: 2062 6173 6556 6572 7420 2b20 5b5b 302c   baseVert + [[0,
+0002b400: 302c 315d 2c5b 302c 302c 2d31 5d5d 0d0a  0,1],[0,0,-1]]..
+0002b410: 2020 2020 2020 2020 2020 2020 6261 7365              base
+0002b420: 4661 6365 7320 3d20 6c69 7374 2862 6173  Faces = list(bas
+0002b430: 6546 6163 6573 290d 0a20 2020 2020 2020  eFaces)..       
+0002b440: 2020 2020 2061 6464 4661 6365 7320 3d20       addFaces = 
+0002b450: 5b20 0d0a 2020 2020 2020 2020 2020 2020  [ ..            
+0002b460: 2020 2020 5b33 2c35 2c31 315d 2c5b 352c      [3,5,11],[5,
+0002b470: 342c 3131 5d2c 5b34 2c39 2c31 315d 2c20  4,11],[4,9,11], 
+0002b480: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0002b490: 2020 5b38 2c36 2c31 325d 2c5b 372c 382c    [8,6,12],[7,8,
+0002b4a0: 3132 5d2c 5b31 302c 372c 3132 5d20 5d0d  12],[10,7,12] ].
+0002b4b0: 0a20 2020 2020 2020 2020 2020 2062 6173  .            bas
+0002b4c0: 6546 6163 6573 203d 2062 6173 6546 6163  eFaces = baseFac
+0002b4d0: 6573 202b 2061 6464 4661 6365 730d 0a20  es + addFaces.. 
+0002b4e0: 2020 2020 2020 2020 2020 2046 6f20 3d20             Fo = 
+0002b4f0: 6c65 6e28 6261 7365 4661 6365 7329 0d0a  len(baseFaces)..
+0002b500: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0002b510: 726e 207b 2027 6261 7365 4661 6365 496e  rn { 'baseFaceIn
+0002b520: 6469 6365 7327 203a 2062 6173 6546 6163  dices' : baseFac
+0002b530: 6573 202c 2027 6261 7365 5665 7274 6963  es , 'baseVertic
+0002b540: 6573 436f 6f72 2720 3a20 6261 7365 5665  esCoor' : baseVe
+0002b550: 7274 2c20 2766 6576 5061 7261 6d27 203a  rt, 'fevParam' :
+0002b560: 205b 466f 2c30 2c32 5d20 7d0d 0a0d 0a20   [Fo,0,2] }.... 
+0002b570: 2020 2020 2020 2064 6566 2063 6f6e 7374         def const
+0002b580: 7275 6374 5f71 7561 6463 796c 696e 6465  ruct_quadcylinde
+0002b590: 7228 2920 3a0d 0a20 2020 2020 2020 2020  r() :..         
+0002b5a0: 2020 2078 7930 203d 2031 2e30 2f6e 702e     xy0 = 1.0/np.
+0002b5b0: 7371 7274 2832 2e30 290d 0a0d 0a20 2020  sqrt(2.0)....   
+0002b5c0: 2020 2020 2020 2020 2062 6173 6556 6572           baseVer
+0002b5d0: 7420 3d20 5b20 5b31 2c30 2c30 5d2c 2020  t = [ [1,0,0],  
+0002b5e0: 2020 2020 5b30 2c2d 312c 305d 2c20 2020      [0,-1,0],   
+0002b5f0: 2020 205b 2d31 2c30 2c30 5d2c 2020 2020     [-1,0,0],    
+0002b600: 2020 205b 302c 312c 305d 2c0d 0a20 2020     [0,1,0],..   
+0002b610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b620: 2020 2020 2020 5b78 7930 2c78 7930 2c31        [xy0,xy0,1
+0002b630: 5d2c 2020 5b2d 7879 302c 7879 302c 315d  ],  [-xy0,xy0,1]
+0002b640: 2c20 205b 2d78 7930 2c2d 7879 302c 315d  ,  [-xy0,-xy0,1]
+0002b650: 2c20 205b 7879 302c 2d78 7930 2c31 5d2c  ,  [xy0,-xy0,1],
+0002b660: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0002b670: 2020 2020 2020 2020 2020 205b 7879 302c             [xy0,
+0002b680: 7879 302c 2d31 5d2c 205b 2d78 7930 2c78  xy0,-1], [-xy0,x
+0002b690: 7930 2c2d 315d 2c20 5b2d 7879 302c 2d78  y0,-1], [-xy0,-x
+0002b6a0: 7930 2c2d 315d 2c20 5b78 7930 2c2d 7879  y0,-1], [xy0,-xy
+0002b6b0: 302c 2d31 5d20 5d0d 0a0d 0a20 2020 2020  0,-1] ]....     
+0002b6c0: 2020 2020 2020 2062 6173 6546 6163 6573         baseFaces
+0002b6d0: 3d28 200d 0a20 2020 2020 2020 2020 2020  =( ..           
+0002b6e0: 2020 2020 205b 312c 302c 375d 2c5b 322c       [1,0,7],[2,
+0002b6f0: 312c 365d 2c5b 332c 322c 355d 2c5b 302c  1,6],[3,2,5],[0,
+0002b700: 332c 345d 2c0d 0a20 2020 2020 2020 2020  3,4],..         
+0002b710: 2020 2020 2020 205b 342c 332c 355d 2c5b         [4,3,5],[
+0002b720: 352c 322c 365d 2c5b 362c 312c 375d 2c5b  5,2,6],[6,1,7],[
+0002b730: 372c 302c 345d 2c0d 0a20 2020 2020 2020  7,0,4],..       
+0002b740: 2020 2020 2020 2020 205b 302c 382c 335d           [0,8,3]
+0002b750: 2c5b 332c 392c 325d 2c5b 322c 3130 2c31  ,[3,9,2],[2,10,1
+0002b760: 5d2c 5b31 2c31 312c 305d 2c0d 0a20 2020  ],[1,11,0],..   
+0002b770: 2020 2020 2020 2020 2020 2020 205b 302c               [0,
+0002b780: 3131 2c38 5d2c 5b33 2c38 2c39 5d2c 5b32  11,8],[3,8,9],[2
+0002b790: 2c39 2c31 305d 2c5b 312c 3130 2c31 315d  ,9,10],[1,10,11]
+0002b7a0: 2029 0d0a 0d0a 2020 2020 2020 2020 2020   )....          
+0002b7b0: 2020 466f 203d 206c 656e 2862 6173 6546    Fo = len(baseF
+0002b7c0: 6163 6573 290d 0a20 2020 2020 2020 2020  aces)..         
+0002b7d0: 2020 2072 6574 7572 6e20 7b20 2762 6173     return { 'bas
+0002b7e0: 6546 6163 6549 6e64 6963 6573 2720 3a20  eFaceIndices' : 
+0002b7f0: 6261 7365 4661 6365 7320 2c20 2762 6173  baseFaces , 'bas
+0002b800: 6556 6572 7469 6365 7343 6f6f 7227 203a  eVerticesCoor' :
+0002b810: 2062 6173 6556 6572 742c 2027 6665 7650   baseVert, 'fevP
+0002b820: 6172 616d 2720 3a20 5b46 6f2c 342c 305d  aram' : [Fo,4,0]
+0002b830: 207d 0d0a 0d0a 2020 2020 2020 2020 6465   }....        de
+0002b840: 6620 636f 6e73 7472 7563 745f 7175 6164  f construct_quad
+0002b850: 6379 6c69 6e64 6572 5f76 2829 203a 0d0a  cylinder_v() :..
+0002b860: 2020 2020 2020 2020 2020 2020 7666 695f              vfi_
+0002b870: 6420 3d20 636f 6e73 7472 7563 745f 7175  d = construct_qu
+0002b880: 6164 6379 6c69 6e64 6572 2829 0d0a 2020  adcylinder()..  
+0002b890: 2020 2020 2020 2020 2020 6261 7365 5665            baseVe
+0002b8a0: 7274 203d 2020 7666 695f 645b 2762 6173  rt =  vfi_d['bas
+0002b8b0: 6556 6572 7469 6365 7343 6f6f 7227 5d0d  eVerticesCoor'].
+0002b8c0: 0a20 2020 2020 2020 2020 2020 2062 6173  .            bas
+0002b8d0: 6546 6163 6573 203d 2076 6669 5f64 5b27  eFaces = vfi_d['
+0002b8e0: 6261 7365 4661 6365 496e 6469 6365 7327  baseFaceIndices'
+0002b8f0: 5d0d 0a20 2020 2020 2020 2020 2020 2062  ]..            b
+0002b900: 6173 6556 6572 7420 3d20 6261 7365 5665  aseVert = baseVe
+0002b910: 7274 202b 205b 5b30 2c30 2c31 5d2c 5b30  rt + [[0,0,1],[0
+0002b920: 2c30 2c2d 315d 5d0d 0a20 2020 2020 2020  ,0,-1]]..       
+0002b930: 2020 2020 2062 6173 6546 6163 6573 203d       baseFaces =
+0002b940: 206c 6973 7428 6261 7365 4661 6365 7329   list(baseFaces)
+0002b950: 0d0a 2020 2020 2020 2020 2020 2020 6164  ..            ad
+0002b960: 6446 6163 6573 203d 205b 200d 0a20 2020  dFaces = [ ..   
+0002b970: 2020 2020 2020 2020 2020 2020 205b 342c               [4,
+0002b980: 352c 3132 5d2c 5b35 2c36 2c31 325d 2c5b  5,12],[5,6,12],[
+0002b990: 362c 372c 3132 5d2c 5b37 2c34 2c31 325d  6,7,12],[7,4,12]
+0002b9a0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0002b9b0: 2020 205b 392c 382c 3133 5d2c 5b31 302c     [9,8,13],[10,
+0002b9c0: 392c 3133 5d2c 5b31 312c 3130 2c31 335d  9,13],[11,10,13]
+0002b9d0: 2c5b 382c 3131 2c31 335d 205d 0d0a 2020  ,[8,11,13] ]..  
+0002b9e0: 2020 2020 2020 2020 2020 6261 7365 4661            baseFa
+0002b9f0: 6365 7320 3d20 6261 7365 4661 6365 7320  ces = baseFaces 
+0002ba00: 2b20 6164 6446 6163 6573 0d0a 2020 2020  + addFaces..    
+0002ba10: 2020 2020 2020 2020 466f 203d 206c 656e          Fo = len
+0002ba20: 2862 6173 6546 6163 6573 290d 0a20 2020  (baseFaces)..   
+0002ba30: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0002ba40: 7b20 2762 6173 6546 6163 6549 6e64 6963  { 'baseFaceIndic
+0002ba50: 6573 2720 3a20 6261 7365 4661 6365 7320  es' : baseFaces 
+0002ba60: 2c20 2762 6173 6556 6572 7469 6365 7343  , 'baseVerticesC
+0002ba70: 6f6f 7227 203a 2062 6173 6556 6572 742c  oor' : baseVert,
+0002ba80: 2027 6665 7650 6172 616d 2720 3a20 5b46   'fevParam' : [F
+0002ba90: 6f2c 302c 325d 207d 0d0a 0d0a 2020 2020  o,0,2] }....    
+0002baa0: 2020 2020 6465 6620 636f 6e73 7472 7563      def construc
+0002bab0: 745f 7175 6164 3263 796c 696e 6465 7228  t_quad2cylinder(
+0002bac0: 2920 3a0d 0a20 2020 2020 2020 2020 2020  ) :..           
+0002bad0: 2078 7930 203d 2031 2e30 2f6e 702e 7371   xy0 = 1.0/np.sq
+0002bae0: 7274 2832 2e30 290d 0a0d 0a20 2020 2020  rt(2.0)....     
+0002baf0: 2020 2020 2020 2062 6173 6556 6572 7420         baseVert 
+0002bb00: 3d20 5b20 5b78 7930 2c78 7930 2c30 5d2c  = [ [xy0,xy0,0],
+0002bb10: 205b 2d78 7930 2c78 7930 2c30 5d2c 205b   [-xy0,xy0,0], [
+0002bb20: 2d78 7930 2c2d 7879 302c 305d 2c20 5b78  -xy0,-xy0,0], [x
+0002bb30: 7930 2c2d 7879 302c 305d 2c0d 0a20 2020  y0,-xy0,0],..   
+0002bb40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bb50: 2020 2020 2020 5b31 2c30 2c31 5d2c 2020        [1,0,1],  
+0002bb60: 2020 205b 302c 2d31 2c31 5d2c 2020 2020     [0,-1,1],    
+0002bb70: 205b 2d31 2c30 2c31 5d2c 2020 2020 2020   [-1,0,1],      
+0002bb80: 5b30 2c31 2c31 5d2c 0d0a 2020 2020 2020  [0,1,1],..      
+0002bb90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bba0: 2020 205b 312c 302c 2d31 5d2c 2020 2020     [1,0,-1],    
+0002bbb0: 5b30 2c2d 312c 2d31 5d2c 2020 2020 5b2d  [0,-1,-1],    [-
+0002bbc0: 312c 302c 2d31 5d2c 2020 2020 205b 302c  1,0,-1],     [0,
+0002bbd0: 312c 2d31 5d20 5d0d 0a0d 0a20 2020 2020  1,-1] ]....     
+0002bbe0: 2020 2020 2020 2062 6173 6546 6163 6573         baseFaces
+0002bbf0: 3d28 200d 0a20 2020 2020 2020 2020 2020  =( ..           
+0002bc00: 2020 2020 205b 302c 372c 345d 2c5b 312c       [0,7,4],[1,
+0002bc10: 362c 375d 2c5b 322c 352c 365d 2c5b 332c  6,7],[2,5,6],[3,
+0002bc20: 342c 355d 2c0d 0a20 2020 2020 2020 2020  4,5],..         
+0002bc30: 2020 2020 2020 205b 302c 382c 3131 5d2c         [0,8,11],
+0002bc40: 5b31 2c31 312c 3130 5d2c 5b32 2c31 302c  [1,11,10],[2,10,
+0002bc50: 395d 2c5b 332c 392c 385d 2c0d 0a20 2020  9],[3,9,8],..   
+0002bc60: 2020 2020 2020 2020 2020 2020 205b 302c               [0,
+0002bc70: 342c 385d 2c5b 312c 372c 3131 5d2c 5b32  4,8],[1,7,11],[2
+0002bc80: 2c36 2c31 305d 2c5b 332c 352c 395d 2c0d  ,6,10],[3,5,9],.
+0002bc90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002bca0: 205b 302c 3131 2c37 5d2c 5b31 2c31 302c   [0,11,7],[1,10,
+0002bcb0: 365d 2c5b 322c 392c 355d 2c5b 332c 382c  6],[2,9,5],[3,8,
+0002bcc0: 345d 2029 0d0a 0d0a 2020 2020 2020 2020  4] )....        
+0002bcd0: 2020 2020 466f 203d 206c 656e 2862 6173      Fo = len(bas
+0002bce0: 6546 6163 6573 290d 0a20 2020 2020 2020  eFaces)..       
+0002bcf0: 2020 2020 2072 6574 7572 6e20 7b20 2762       return { 'b
+0002bd00: 6173 6546 6163 6549 6e64 6963 6573 2720  aseFaceIndices' 
+0002bd10: 3a20 6261 7365 4661 6365 7320 2c20 2762  : baseFaces , 'b
+0002bd20: 6173 6556 6572 7469 6365 7343 6f6f 7227  aseVerticesCoor'
+0002bd30: 203a 2062 6173 6556 6572 742c 2027 6665   : baseVert, 'fe
+0002bd40: 7650 6172 616d 2720 3a20 5b46 6f2c 342c  vParam' : [Fo,4,
+0002bd50: 305d 207d 0d0a 0d0a 2020 2020 2020 2020  0] }....        
+0002bd60: 6465 6620 636f 6e73 7472 7563 745f 7175  def construct_qu
+0002bd70: 6164 3263 796c 696e 6465 725f 7628 2920  ad2cylinder_v() 
+0002bd80: 3a0d 0a20 2020 2020 2020 2020 2020 2076  :..            v
+0002bd90: 6669 5f64 203d 2063 6f6e 7374 7275 6374  fi_d = construct
+0002bda0: 5f71 7561 6432 6379 6c69 6e64 6572 2829  _quad2cylinder()
+0002bdb0: 0d0a 2020 2020 2020 2020 2020 2020 6261  ..            ba
+0002bdc0: 7365 5665 7274 203d 2020 7666 695f 645b  seVert =  vfi_d[
+0002bdd0: 2762 6173 6556 6572 7469 6365 7343 6f6f  'baseVerticesCoo
+0002bde0: 7227 5d0d 0a20 2020 2020 2020 2020 2020  r']..           
+0002bdf0: 2062 6173 6546 6163 6573 203d 2076 6669   baseFaces = vfi
+0002be00: 5f64 5b27 6261 7365 4661 6365 496e 6469  _d['baseFaceIndi
+0002be10: 6365 7327 5d0d 0a20 2020 2020 2020 2020  ces']..         
+0002be20: 2020 2062 6173 6556 6572 7420 3d20 6261     baseVert = ba
+0002be30: 7365 5665 7274 202b 205b 5b30 2c30 2c31  seVert + [[0,0,1
+0002be40: 5d2c 5b30 2c30 2c2d 315d 5d0d 0a20 2020  ],[0,0,-1]]..   
+0002be50: 2020 2020 2020 2020 2062 6173 6546 6163           baseFac
+0002be60: 6573 203d 206c 6973 7428 6261 7365 4661  es = list(baseFa
+0002be70: 6365 7329 0d0a 2020 2020 2020 2020 2020  ces)..          
+0002be80: 2020 6164 6446 6163 6573 203d 205b 200d    addFaces = [ .
+0002be90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002bea0: 205b 352c 342c 3132 5d2c 5b36 2c35 2c31   [5,4,12],[6,5,1
+0002beb0: 325d 2c5b 372c 362c 3132 5d2c 5b34 2c37  2],[7,6,12],[4,7
+0002bec0: 2c31 325d 2c0d 0a20 2020 2020 2020 2020  ,12],..         
+0002bed0: 2020 2020 2020 205b 382c 392c 3133 5d2c         [8,9,13],
+0002bee0: 5b39 2c31 302c 3133 5d2c 5b31 302c 3131  [9,10,13],[10,11
+0002bef0: 2c31 335d 2c5b 3131 2c38 2c31 335d 205d  ,13],[11,8,13] ]
+0002bf00: 0d0a 2020 2020 2020 2020 2020 2020 6261  ..            ba
+0002bf10: 7365 4661 6365 7320 3d20 6261 7365 4661  seFaces = baseFa
+0002bf20: 6365 7320 2b20 6164 6446 6163 6573 0d0a  ces + addFaces..
+0002bf30: 2020 2020 2020 2020 2020 2020 466f 203d              Fo =
+0002bf40: 206c 656e 2862 6173 6546 6163 6573 290d   len(baseFaces).
+0002bf50: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0002bf60: 7572 6e20 7b20 2762 6173 6546 6163 6549  urn { 'baseFaceI
+0002bf70: 6e64 6963 6573 2720 3a20 6261 7365 4661  ndices' : baseFa
+0002bf80: 6365 7320 2c20 2762 6173 6556 6572 7469  ces , 'baseVerti
+0002bf90: 6365 7343 6f6f 7227 203a 2062 6173 6556  cesCoor' : baseV
+0002bfa0: 6572 742c 2027 6665 7650 6172 616d 2720  ert, 'fevParam' 
+0002bfb0: 3a20 5b46 6f2c 302c 325d 207d 0d0a 0d0a  : [Fo,0,2] }....
+0002bfc0: 2020 2020 2020 2020 6465 6620 636f 6e73          def cons
+0002bfd0: 7472 7563 745f 7175 6164 3263 796c 696e  truct_quad2cylin
+0002bfe0: 6465 725f 736c 6963 6564 2829 203a 0d0a  der_sliced() :..
+0002bff0: 2020 2020 2020 2020 2020 2020 7879 3020              xy0 
+0002c000: 3d20 312e 302f 6e70 2e73 7172 7428 322e  = 1.0/np.sqrt(2.
+0002c010: 3029 0d0a 2020 2020 2020 2020 2020 2020  0)..            
+0002c020: 796f 6620 3d20 302e 3030 3031 0d0a 0d0a  yof = 0.0001....
+0002c030: 2020 2020 2020 2020 2020 2020 6261 7365              base
+0002c040: 5665 7274 203d 205b 205b 7879 302c 7879  Vert = [ [xy0,xy
+0002c050: 302c 305d 2c20 5b2d 7879 302c 7879 302c  0,0], [-xy0,xy0,
+0002c060: 305d 2c20 5b2d 7879 302c 2d78 7930 2c30  0], [-xy0,-xy0,0
+0002c070: 5d2c 205b 7879 302c 2d78 7930 2c30 5d2c  ], [xy0,-xy0,0],
+0002c080: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0002c090: 2020 2020 2020 2020 2020 205b 312c 796f             [1,yo
+0002c0a0: 662c 315d 2c20 2020 5b30 2c2d 312c 315d  f,1],   [0,-1,1]
+0002c0b0: 2c20 2020 2020 5b2d 312c 302c 315d 2c20  ,     [-1,0,1], 
+0002c0c0: 2020 2020 2020 5b30 2c31 2c31 5d2c 0d0a        [0,1,1],..
+0002c0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c0e0: 2020 2020 2020 2020 205b 312c 796f 662c           [1,yof,
+0002c0f0: 2d31 5d2c 2020 5b30 2c2d 312c 2d31 5d2c  -1],  [0,-1,-1],
+0002c100: 2020 2020 5b2d 312c 302c 2d31 5d2c 2020      [-1,0,-1],  
+0002c110: 2020 2020 5b30 2c31 2c2d 315d 2c0d 0a20      [0,1,-1],.. 
+0002c120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c130: 2020 2020 2020 2020 5b31 2c2d 796f 662c          [1,-yof,
+0002c140: 315d 2c20 205b 312c 2d79 6f66 2c2d 315d  1],  [1,-yof,-1]
+0002c150: 205d 0d0a 0d0a 2020 2020 2020 2020 2020   ]....          
+0002c160: 2020 6261 7365 4661 6365 733d 2820 0d0a    baseFaces=( ..
+0002c170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c180: 5b30 2c37 2c34 5d2c 5b31 2c36 2c37 5d2c  [0,7,4],[1,6,7],
+0002c190: 5b32 2c35 2c36 5d2c 5b33 2c31 322c 355d  [2,5,6],[3,12,5]
+0002c1a0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0002c1b0: 2020 205b 302c 382c 3131 5d2c 5b31 2c31     [0,8,11],[1,1
+0002c1c0: 312c 3130 5d2c 5b32 2c31 302c 395d 2c5b  1,10],[2,10,9],[
+0002c1d0: 332c 392c 3133 5d2c 0d0a 2020 2020 2020  3,9,13],..      
+0002c1e0: 2020 2020 2020 2020 2020 5b30 2c34 2c38            [0,4,8
+0002c1f0: 5d2c 5b31 2c37 2c31 315d 2c5b 322c 362c  ],[1,7,11],[2,6,
+0002c200: 3130 5d2c 5b33 2c35 2c39 5d2c 0d0a 2020  10],[3,5,9],..  
+0002c210: 2020 2020 2020 2020 2020 2020 2020 5b30                [0
+0002c220: 2c31 312c 375d 2c5b 312c 3130 2c36 5d2c  ,11,7],[1,10,6],
+0002c230: 5b32 2c39 2c35 5d2c 5b33 2c31 332c 3132  [2,9,5],[3,13,12
+0002c240: 5d20 290d 0a0d 0a20 2020 2020 2020 2020  ] )....         
+0002c250: 2020 2046 6f20 3d20 6c65 6e28 6261 7365     Fo = len(base
+0002c260: 4661 6365 7329 0d0a 2020 2020 2020 2020  Faces)..        
+0002c270: 2020 2020 7265 7475 726e 207b 2027 6261      return { 'ba
+0002c280: 7365 4661 6365 496e 6469 6365 7327 203a  seFaceIndices' :
+0002c290: 2062 6173 6546 6163 6573 202c 2027 6261   baseFaces , 'ba
+0002c2a0: 7365 5665 7274 6963 6573 436f 6f72 2720  seVerticesCoor' 
+0002c2b0: 3a20 6261 7365 5665 7274 2c20 2766 6576  : baseVert, 'fev
+0002c2c0: 5061 7261 6d27 203a 205b 466f 2c35 2c31  Param' : [Fo,5,1
+0002c2d0: 5d20 7d0d 0a0d 0a20 2020 2020 2020 2064  ] }....        d
+0002c2e0: 6566 2063 6f6e 7374 7275 6374 5f71 7561  ef construct_qua
+0002c2f0: 6432 6379 6c69 6e64 6572 5f73 6c69 6365  d2cylinder_slice
+0002c300: 645f 7628 2920 3a0d 0a20 2020 2020 2020  d_v() :..       
+0002c310: 2020 2020 2076 6669 5f64 203d 2063 6f6e       vfi_d = con
+0002c320: 7374 7275 6374 5f71 7561 6432 6379 6c69  struct_quad2cyli
+0002c330: 6e64 6572 5f73 6c69 6365 6428 290d 0a20  nder_sliced().. 
+0002c340: 2020 2020 2020 2020 2020 2062 6173 6556             baseV
+0002c350: 6572 7420 3d20 2076 6669 5f64 5b27 6261  ert =  vfi_d['ba
+0002c360: 7365 5665 7274 6963 6573 436f 6f72 275d  seVerticesCoor']
+0002c370: 0d0a 2020 2020 2020 2020 2020 2020 6261  ..            ba
+0002c380: 7365 4661 6365 7320 3d20 7666 695f 645b  seFaces = vfi_d[
+0002c390: 2762 6173 6546 6163 6549 6e64 6963 6573  'baseFaceIndices
+0002c3a0: 275d 0d0a 2020 2020 2020 2020 2020 2020  ']..            
+0002c3b0: 6261 7365 5665 7274 203d 2062 6173 6556  baseVert = baseV
+0002c3c0: 6572 7420 2b20 5b5b 302c 302c 315d 2c5b  ert + [[0,0,1],[
+0002c3d0: 302c 302c 2d31 5d5d 0d0a 2020 2020 2020  0,0,-1]]..      
+0002c3e0: 2020 2020 2020 6261 7365 4661 6365 7320        baseFaces 
+0002c3f0: 3d20 6c69 7374 2862 6173 6546 6163 6573  = list(baseFaces
+0002c400: 290d 0a20 2020 2020 2020 2020 2020 2061  )..            a
+0002c410: 6464 4661 6365 7320 3d20 5b20 0d0a 2020  ddFaces = [ ..  
+0002c420: 2020 2020 2020 2020 2020 2020 2020 5b34                [4
+0002c430: 2c37 2c31 345d 2c5b 372c 362c 3134 5d2c  ,7,14],[7,6,14],
+0002c440: 5b36 2c35 2c31 345d 2c5b 352c 3132 2c31  [6,5,14],[5,12,1
+0002c450: 345d 2c0d 0a20 2020 2020 2020 2020 2020  4],..           
+0002c460: 2020 2020 205b 3131 2c38 2c31 355d 2c5b       [11,8,15],[
+0002c470: 3130 2c31 312c 3135 5d2c 5b39 2c31 302c  10,11,15],[9,10,
+0002c480: 3135 5d2c 5b31 332c 392c 3135 5d20 5d0d  15],[13,9,15] ].
+0002c490: 0a20 2020 2020 2020 2020 2020 2062 6173  .            bas
+0002c4a0: 6546 6163 6573 203d 2062 6173 6546 6163  eFaces = baseFac
+0002c4b0: 6573 202b 2061 6464 4661 6365 730d 0a20  es + addFaces.. 
+0002c4c0: 2020 2020 2020 2020 2020 2046 6f20 3d20             Fo = 
+0002c4d0: 6c65 6e28 6261 7365 4661 6365 7329 0d0a  len(baseFaces)..
+0002c4e0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0002c4f0: 726e 207b 2027 6261 7365 4661 6365 496e  rn { 'baseFaceIn
+0002c500: 6469 6365 7327 203a 2062 6173 6546 6163  dices' : baseFac
+0002c510: 6573 202c 2027 6261 7365 5665 7274 6963  es , 'baseVertic
+0002c520: 6573 436f 6f72 2720 3a20 6261 7365 5665  esCoor' : baseVe
+0002c530: 7274 2c20 2766 6576 5061 7261 6d27 203a  rt, 'fevParam' :
+0002c540: 205b 466f 2c30 2c32 5d20 7d0d 0a0d 0a20   [Fo,0,2] }.... 
+0002c550: 2020 2020 2020 2073 7572 6661 6365 7344         surfacesD
+0002c560: 6963 7469 6f6e 6172 795b 2774 7269 275d  ictionary['tri']
+0002c570: 203d 2063 6f6e 7374 7275 6374 5f74 7269   = construct_tri
+0002c580: 6379 6c69 6e64 6572 2829 0d0a 2020 2020  cylinder()..    
+0002c590: 2020 2020 7375 7266 6163 6573 4469 6374      surfacesDict
+0002c5a0: 696f 6e61 7279 5b27 7371 7527 5d20 3d20  ionary['squ'] = 
+0002c5b0: 636f 6e73 7472 7563 745f 7175 6164 6379  construct_quadcy
+0002c5c0: 6c69 6e64 6572 2829 0d0a 2020 2020 2020  linder()..      
+0002c5d0: 2020 7375 7266 6163 6573 4469 6374 696f    surfacesDictio
+0002c5e0: 6e61 7279 5b27 7472 6932 275d 203d 2063  nary['tri2'] = c
+0002c5f0: 6f6e 7374 7275 6374 5f74 7269 3263 796c  onstruct_tri2cyl
+0002c600: 696e 6465 7228 290d 0a20 2020 2020 2020  inder()..       
+0002c610: 2073 7572 6661 6365 7344 6963 7469 6f6e   surfacesDiction
+0002c620: 6172 795b 2773 7175 3227 5d20 3d20 636f  ary['squ2'] = co
+0002c630: 6e73 7472 7563 745f 7175 6164 3263 796c  nstruct_quad2cyl
+0002c640: 696e 6465 7228 290d 0a20 2020 2020 2020  inder()..       
+0002c650: 2073 7572 6661 6365 7344 6963 7469 6f6e   surfacesDiction
+0002c660: 6172 795b 2774 7269 5f73 275d 203d 2063  ary['tri_s'] = c
+0002c670: 6f6e 7374 7275 6374 5f74 7269 3263 796c  onstruct_tri2cyl
+0002c680: 696e 6465 725f 736c 6963 6564 2829 0d0a  inder_sliced()..
+0002c690: 2020 2020 2020 2020 7375 7266 6163 6573          surfaces
+0002c6a0: 4469 6374 696f 6e61 7279 5b27 7371 755f  Dictionary['squ_
+0002c6b0: 7327 5d20 3d20 636f 6e73 7472 7563 745f  s'] = construct_
+0002c6c0: 7175 6164 3263 796c 696e 6465 725f 736c  quad2cylinder_sl
+0002c6d0: 6963 6564 2829 0d0a 0d0a 2020 2020 2020  iced()....      
+0002c6e0: 2020 7375 7266 6163 6573 4469 6374 696f    surfacesDictio
+0002c6f0: 6e61 7279 5b27 7472 695f 7627 5d20 3d20  nary['tri_v'] = 
+0002c700: 636f 6e73 7472 7563 745f 7472 6963 796c  construct_tricyl
+0002c710: 696e 6465 725f 7628 290d 0a20 2020 2020  inder_v()..     
+0002c720: 2020 2073 7572 6661 6365 7344 6963 7469     surfacesDicti
+0002c730: 6f6e 6172 795b 2773 7175 5f76 275d 203d  onary['squ_v'] =
+0002c740: 2063 6f6e 7374 7275 6374 5f71 7561 6463   construct_quadc
+0002c750: 796c 696e 6465 725f 7628 290d 0a20 2020  ylinder_v()..   
+0002c760: 2020 2020 2073 7572 6661 6365 7344 6963       surfacesDic
+0002c770: 7469 6f6e 6172 795b 2774 7269 325f 7627  tionary['tri2_v'
+0002c780: 5d20 3d20 636f 6e73 7472 7563 745f 7472  ] = construct_tr
+0002c790: 6932 6379 6c69 6e64 6572 5f76 2829 0d0a  i2cylinder_v()..
+0002c7a0: 2020 2020 2020 2020 7375 7266 6163 6573          surfaces
+0002c7b0: 4469 6374 696f 6e61 7279 5b27 7371 7532  Dictionary['squ2
+0002c7c0: 5f76 275d 203d 2063 6f6e 7374 7275 6374  _v'] = construct
+0002c7d0: 5f71 7561 6432 6379 6c69 6e64 6572 5f76  _quad2cylinder_v
+0002c7e0: 2829 0d0a 2020 2020 2020 2020 7375 7266  ()..        surf
+0002c7f0: 6163 6573 4469 6374 696f 6e61 7279 5b27  acesDictionary['
+0002c800: 7472 695f 7376 275d 203d 2063 6f6e 7374  tri_sv'] = const
+0002c810: 7275 6374 5f74 7269 3263 796c 696e 6465  ruct_tri2cylinde
+0002c820: 725f 736c 6963 6564 5f76 2829 0d0a 2020  r_sliced_v()..  
+0002c830: 2020 2020 2020 7375 7266 6163 6573 4469        surfacesDi
+0002c840: 6374 696f 6e61 7279 5b27 7371 755f 7376  ctionary['squ_sv
+0002c850: 275d 203d 2063 6f6e 7374 7275 6374 5f71  '] = construct_q
+0002c860: 7561 6432 6379 6c69 6e64 6572 5f73 6c69  uad2cylinder_sli
+0002c870: 6365 645f 7628 290d 0a20 2020 2020 2020  ced_v()..       
+0002c880: 2072 6574 7572 6e20 7375 7266 6163 6573   return surfaces
+0002c890: 4469 6374 696f 6e61 7279 0d0a 2020 2020  Dictionary..    
+0002c8a0: 0d0a 2020 2020 4073 7461 7469 636d 6574  ..    @staticmet
+0002c8b0: 686f 640d 0a20 2020 2064 6566 205f 6d69  hod..    def _mi
+0002c8c0: 6456 6563 746f 7246 756e 2876 6563 7441  dVectorFun(vectA
+0002c8d0: 2c20 7665 6374 4229 203a 2020 0d0a 2020  , vectB) :  ..  
+0002c8e0: 2020 2020 2020 2222 224d 6964 2d70 6f69        """Mid-poi
+0002c8f0: 6e74 2062 6574 7765 656e 2074 776f 2070  nt between two p
+0002c900: 6f69 6e74 7320 6f6e 2061 2075 6e69 7420  oints on a unit 
+0002c910: 6379 6c69 6e64 6572 2e22 2222 0d0a 2020  cylinder."""..  
+0002c920: 2020 2020 2020 6d69 6420 3d20 6e70 2e61        mid = np.a
+0002c930: 6464 2876 6563 7441 2c76 6563 7442 290d  dd(vectA,vectB).
+0002c940: 0a20 2020 2020 2020 206d 6964 203d 206e  .        mid = n
+0002c950: 702e 6d75 6c74 6970 6c79 2830 2e35 2c6d  p.multiply(0.5,m
+0002c960: 6964 290d 0a20 2020 2020 2020 207a 203d  id)..        z =
+0002c970: 206e 702e 646f 7428 6d69 642c 5b30 2c30   np.dot(mid,[0,0
+0002c980: 2c31 5d29 0d0a 2020 2020 2020 2020 7620  ,1])..        v 
+0002c990: 3d20 6e70 2e73 7562 7472 6163 7428 6d69  = np.subtract(mi
+0002c9a0: 642c 5b30 2c30 2c7a 5d29 0d0a 2020 2020  d,[0,0,z])..    
+0002c9b0: 2020 2020 7879 203d 2020 762f 6e70 2e6c      xy =  v/np.l
+0002c9c0: 696e 616c 672e 6e6f 726d 2876 290d 0a20  inalg.norm(v).. 
+0002c9d0: 2020 2020 2020 2023 2078 7920 6973 2075         # xy is u
+0002c9e0: 6e69 7420 7665 6374 6f72 2061 7420 6379  nit vector at cy
+0002c9f0: 6c69 6e64 6572 2072 6164 6975 732c 2062  linder radius, b
+0002ca00: 7574 0d0a 2020 2020 2020 2020 2320 6973  ut..        # is
+0002ca10: 2061 7665 7261 6765 206f 6620 7261 6469   average of radi
+0002ca20: 7573 2066 6f72 2074 6f70 2026 2062 6f74  us for top & bot
+0002ca30: 746f 6d20 6661 6365 732e 0d0a 2020 2020  tom faces...    
+0002ca40: 2020 2020 7a41 203d 206e 702e 646f 7428      zA = np.dot(
+0002ca50: 7665 6374 412c 5b30 2c30 2c31 5d29 0d0a  vectA,[0,0,1])..
+0002ca60: 2020 2020 2020 2020 7641 203d 206e 702e          vA = np.
+0002ca70: 7375 6274 7261 6374 2876 6563 7441 2c5b  subtract(vectA,[
+0002ca80: 302c 302c 7a41 5d29 0d0a 2020 2020 2020  0,0,zA])..      
+0002ca90: 2020 7a42 203d 206e 702e 646f 7428 7665    zB = np.dot(ve
+0002caa0: 6374 422c 5b30 2c30 2c31 5d29 0d0a 2020  ctB,[0,0,1])..  
+0002cab0: 2020 2020 2020 7642 203d 206e 702e 7375        vB = np.su
+0002cac0: 6274 7261 6374 2876 6563 7442 2c5b 302c  btract(vectB,[0,
+0002cad0: 302c 7a42 5d29 0d0a 2020 2020 2020 2020  0,zB])..        
+0002cae0: 6120 3d20 2820 6e70 2e6c 696e 616c 672e  a = ( np.linalg.
+0002caf0: 6e6f 726d 2876 4129 202b 206e 702e 6c69  norm(vA) + np.li
+0002cb00: 6e61 6c67 2e6e 6f72 6d28 7642 2920 292f  nalg.norm(vB) )/
+0002cb10: 322e 300d 0a20 2020 2020 2020 2078 7920  2.0..        xy 
+0002cb20: 3d20 2061 2a78 790d 0a20 2020 2020 2020  =  a*xy..       
+0002cb30: 2072 6574 7572 6e20 6e70 2e61 6464 2878   return np.add(x
+0002cb40: 792c 5b30 2c30 2c7a 5d29 0d0a 0d0a 2020  y,[0,0,z])....  
+0002cb50: 2020 4073 7461 7469 636d 6574 686f 640d    @staticmethod.
+0002cb60: 0a20 2020 2064 6566 205f 6d61 7033 4474  .    def _map3Dt
+0002cb70: 6f32 4473 7175 6172 6528 7879 7a29 203a  o2Dsquare(xyz) :
+0002cb80: 0d0a 2020 2020 2020 2020 2222 224f 7665  ..        """Ove
+0002cb90: 7272 6964 6520 6d61 7020 7375 7266 6163  rride map surfac
+0002cba0: 6520 746f 2072 6563 7461 6775 6c61 7220  e to rectagular 
+0002cbb0: 756e 6974 2063 6f6f 7264 696e 6174 6573  unit coordinates
+0002cbc0: 2028 302c 3129 2e22 2222 0d0a 2020 2020   (0,1)."""..    
+0002cbd0: 2020 2020 782c 792c 7a20 3d20 7879 7a0d      x,y,z = xyz.
+0002cbe0: 0a20 2020 2020 2020 2074 6865 7461 203d  .        theta =
+0002cbf0: 206e 702e 6172 6374 616e 3228 792c 7829   np.arctan2(y,x)
+0002cc00: 0d0a 2020 2020 2020 2020 7468 6574 6120  ..        theta 
+0002cc10: 3d20 6e70 2e77 6865 7265 2820 7468 6574  = np.where( thet
+0002cc20: 613c 302c 2032 2e30 2a6e 702e 7069 202b  a<0, 2.0*np.pi +
+0002cc30: 2074 6865 7461 202c 7468 6574 6129 0d0a   theta ,theta)..
+0002cc40: 2020 2020 2020 2020 6120 3d20 7468 6574          a = thet
+0002cc50: 612f 2832 2a6e 702e 7069 290d 0a20 2020  a/(2*np.pi)..   
+0002cc60: 2020 2020 2062 203d 2020 7a2f 3220 2b20       b =  z/2 + 
+0002cc70: 302e 3520 0d0a 2020 2020 2020 2020 6120  0.5 ..        a 
+0002cc80: 3d20 6e70 2e63 6c69 7028 612c 302e 302c  = np.clip(a,0.0,
+0002cc90: 312e 3029 200d 0a20 2020 2020 2020 2062  1.0) ..        b
+0002cca0: 203d 206e 702e 636c 6970 2862 2c30 2e30   = np.clip(b,0.0
+0002ccb0: 2c31 2e30 2920 0d0a 2020 2020 2020 2020  ,1.0) ..        
+0002ccc0: 7265 7475 726e 205b 612c 625d 0d0a 0d0a  return [a,b]....
+0002ccd0: 2020 2020 4073 7461 7469 636d 6574 686f      @staticmetho
+0002cce0: 640d 0a20 2020 2064 6566 2063 6f6f 725f  d..    def coor_
+0002ccf0: 636f 6e76 6572 7428 7879 7a2c 2074 6f63  convert(xyz, toc
+0002cd00: 6172 743d 4661 6c73 6529 203a 0d0a 2020  art=False) :..  
+0002cd10: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
+0002cd20: 2020 2054 7261 6e73 666f 726d 6174 696f     Transformatio
+0002cd30: 6e20 6265 7477 6565 6e20 6379 6c69 6e64  n between cylind
+0002cd40: 7269 6361 6c20 616e 6420 4361 7274 6573  rical and Cartes
+0002cd50: 6961 6e20 636f 6f72 6469 6e61 7465 732e  ian coordinates.
+0002cd60: 0d0a 2020 2020 2020 2020 5468 6520 616e  ..        The an
+0002cd70: 6775 6c61 7220 636f 6f72 6469 6e61 7465  gular coordinate
+0002cd80: 2069 7320 696e 2072 6164 6961 6e73 2077   is in radians w
+0002cd90: 6974 6820 646f 6d61 696e 2030 2074 6f20  ith domain 0 to 
+0002cda0: 3270 692e 0d0a 0d0a 2020 2020 2020 2020  2pi.....        
+0002cdb0: 5061 7261 6d65 7465 7273 0d0a 2020 2020  Parameters..    
+0002cdc0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a      ----------..
+0002cdd0: 2020 2020 2020 2020 7879 7a20 3a20 3378          xyz : 3x
+0002cde0: 4e0d 0a20 2020 2020 2020 2020 2020 204e  N..            N
+0002cdf0: 206e 756d 6265 7220 6f66 2076 6563 746f   number of vecto
+0002ce00: 7273 2069 6e20 6569 7468 6572 2063 796c  rs in either cyl
+0002ce10: 696e 6472 6963 616c 206f 7220 6361 7274  indrical or cart
+0002ce20: 6573 6961 6e20 636f 6f72 6469 6e61 7465  esian coordinate
+0002ce30: 732c 0d0a 2020 2020 2020 2020 2020 2020  s,..            
+0002ce40: 696e 636c 7564 696e 6720 7468 6520 7a20  including the z 
+0002ce50: 636f 6f72 6469 6e61 7465 2820 7768 6963  coordinate( whic
+0002ce60: 6820 7265 6d61 696e 7320 756e 6368 616e  h remains unchan
+0002ce70: 6765 6429 2e0d 0a0d 0a20 2020 2020 2020  ged).....       
+0002ce80: 2074 6f63 6172 7420 3a20 7b20 5472 7565   tocart : { True
+0002ce90: 2c20 4661 6c73 6520 7d2c 2064 6566 6175  , False }, defau
+0002cea0: 6c74 3a20 4661 6c73 650d 0a20 2020 2020  lt: False..     
+0002ceb0: 2020 2020 2020 2049 6620 5472 7565 2c20         If True, 
+0002cec0: 696e 7075 7420 6973 2063 796c 696e 6472  input is cylindr
+0002ced0: 6963 616c 2061 6e64 206f 7574 7075 7420  ical and output 
+0002cee0: 6973 2063 6172 7465 7369 616e 2e0d 0a20  is cartesian... 
+0002cef0: 2020 2020 2020 2020 2020 2049 6620 4661             If Fa
+0002cf00: 6c73 652c 2069 6e70 7574 2069 7320 6361  lse, input is ca
+0002cf10: 7274 6573 6961 6e20 616e 6420 6f75 7470  rtesian and outp
+0002cf20: 7574 2069 7320 6379 6c69 6e64 7269 6361  ut is cylindrica
+0002cf30: 6c2e 0d0a 0d0a 2020 2020 2020 2020 5265  l.....        Re
+0002cf40: 7475 726e 730d 0a20 2020 2020 2020 202d  turns..        -
+0002cf50: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
+0002cf60: 6c69 7374 3a20 3378 4e20 6172 7261 790d  list: 3xN array.
+0002cf70: 0a20 2020 2020 2020 2020 2020 2054 7261  .            Tra
+0002cf80: 6e73 666f 726d 6564 2063 6f6f 7264 696e  nsformed coordin
+0002cf90: 6174 6573 2e20 0d0a 0d0a 2020 2020 2020  ates. ....      
+0002cfa0: 2020 2222 220d 0a0d 0a20 2020 2020 2020    """....       
+0002cfb0: 2069 6620 746f 6361 7274 203a 0d0a 2020   if tocart :..  
+0002cfc0: 2020 2020 2020 2020 2020 722c 2074 6865            r, the
+0002cfd0: 7461 2c20 7a20 3d20 7879 7a0d 0a20 2020  ta, z = xyz..   
+0002cfe0: 2020 2020 2020 2020 2078 203d 2072 202a           x = r *
+0002cff0: 206e 702e 636f 7328 7468 6574 6129 0d0a   np.cos(theta)..
+0002d000: 2020 2020 2020 2020 2020 2020 7920 3d20              y = 
+0002d010: 7220 2a20 6e70 2e73 696e 2874 6865 7461  r * np.sin(theta
+0002d020: 290d 0a20 2020 2020 2020 2020 2020 2061  )..            a
+0002d030: 6263 203d 205b 782c 792c 7a5d 0d0a 2020  bc = [x,y,z]..  
+0002d040: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+0002d050: 2020 2020 2020 2020 2078 2c79 2c7a 203d           x,y,z =
+0002d060: 2078 797a 0d0a 2020 2020 2020 2020 2020   xyz..          
+0002d070: 2020 5220 3d20 6e70 2e73 7172 7428 2078    R = np.sqrt( x
+0002d080: 2a78 202b 2079 2a79 2029 0d0a 2020 2020  *x + y*y )..    
+0002d090: 2020 2020 2020 2020 7468 6574 6120 3d20          theta = 
+0002d0a0: 6e70 2e61 7263 7461 6e32 2879 2c78 290d  np.arctan2(y,x).
+0002d0b0: 0a20 2020 2020 2020 2020 2020 2074 6865  .            the
+0002d0c0: 7461 203d 206e 702e 7768 6572 6528 7468  ta = np.where(th
+0002d0d0: 6574 613c 302c 7468 6574 612b 322a 6e70  eta<0,theta+2*np
+0002d0e0: 2e70 692c 7468 6574 6129 0d0a 2020 2020  .pi,theta)..    
+0002d0f0: 2020 2020 2020 2020 6162 6320 3d20 5b52          abc = [R
+0002d100: 2c74 6865 7461 2c7a 5d0d 0a20 2020 2020  ,theta,z]..     
+0002d110: 2020 2061 6263 203d 206e 702e 6172 7261     abc = np.arra
+0002d120: 7928 6162 6329 0d0a 2020 2020 2020 2020  y(abc)..        
+0002d130: 7265 7475 726e 2061 6263 0d0a 0d0a 2020  return abc....  
+0002d140: 2020 5f62 6173 655f 7375 7266 6163 6573    _base_surfaces
+0002d150: 203d 205f 6765 745f 6379 6c69 6e64 7269   = _get_cylindri
+0002d160: 6361 6c5f 7375 7266 6163 6573 5f64 6963  cal_surfaces_dic
+0002d170: 7469 6f6e 6172 792e 5f5f 6675 6e63 5f5f  tionary.__func__
+0002d180: 2829 0d0a 2020 2020 5f64 6566 6175 6c74  ()..    _default
+0002d190: 5f62 6173 6520 3d20 2774 7269 2720 2023  _base = 'tri'  #
+0002d1a0: 2064 6566 6175 6c74 2061 7373 6967 6e6d   default assignm
+0002d1b0: 656e 7420 6973 2069 6e64 6963 6174 6564  ent is indicated
+0002d1c0: 2069 6e20 5f5f 696e 6974 2044 6f63 7374   in __init Docst
+0002d1d0: 7269 6e67 2e0d 0a20 2020 205f 6765 6f6d  ring...    _geom
+0002d1e0: 5479 7065 203d 205f 434f 4f52 5359 535b  Type = _COORSYS[
+0002d1f0: 2743 594c 494e 4452 4943 414c 275d 0d0a  'CYLINDRICAL']..
+0002d200: 0d0a 2020 2020 4063 6c61 7373 6d65 7468  ..    @classmeth
+0002d210: 6f64 0d0a 2020 2020 6465 6620 5f63 796c  od..    def _cyl
+0002d220: 5f76 6f6c 5f73 7175 6172 655f 6e65 7428  _vol_square_net(
+0002d230: 636c 732c 206e 756d 5a2c 206e 756d 552c  cls, numZ, numU,
+0002d240: 2062 6173 6574 7970 652c 6d69 6e52 6164   basetype,minRad
+0002d250: 2c20 7370 6c69 7453 697a 652c 206e 756d  , splitSize, num
+0002d260: 522c 206e 616d 653d 4e6f 6e65 2c20 2a2a  R, name=None, **
+0002d270: 6b77 6172 6773 2920 3a0d 0a20 2020 2020  kwargs) :..     
+0002d280: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
+0002d290: 6d65 7468 6f64 206f 6e6c 7920 6361 6c6c  method only call
+0002d2a0: 6564 2062 7920 7468 6520 4379 6c69 6e64  ed by the Cylind
+0002d2b0: 6572 5375 7266 6163 6520 636c 6173 736d  erSurface classm
+0002d2c0: 6574 686f 6420 6772 6964 204f 4e4c 5920  ethod grid ONLY 
+0002d2d0: 666f 7220 766f 6c75 6d65 2063 796c 696e  for volume cylin
+0002d2e0: 6465 7220 6f62 6a65 6374 732e 0d0a 2020  der objects...  
+0002d2f0: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
+0002d300: 2020 2023 2044 6576 4e6f 7465 3a20 2074     # DevNote:  t
+0002d310: 6869 7320 6d65 7468 6f64 2075 7365 7320  his method uses 
+0002d320: 7468 6520 7361 6d65 2061 6c67 6f72 6974  the same algorit
+0002d330: 686d 2061 7320 7468 6520 6261 7365 2063  hm as the base c
+0002d340: 6c61 7373 205f 7371 7561 7265 5f6e 6574  lass _square_net
+0002d350: 2063 6c61 7373 6d65 7468 6f64 2e0d 0a20   classmethod... 
+0002d360: 2020 2020 2020 2023 2020 2020 2020 2020         #        
+0002d370: 2020 2054 6869 7320 7761 7320 646f 6e65     This was done
+0002d380: 2074 6f20 7369 6d70 6c69 6679 2074 6865   to simplify the
+0002d390: 2063 6f64 6520 666f 7220 7468 6973 2073   code for this s
+0002d3a0: 7065 6369 616c 2063 6173 6520 7261 7468  pecial case rath
+0002d3b0: 6572 2074 6861 6e0d 0a20 2020 2020 2020  er than..       
+0002d3c0: 2023 2020 2020 2020 2020 2020 2061 6464   #           add
+0002d3d0: 2061 6464 6974 696f 6e61 6c20 2763 6f6e   additional 'con
+0002d3e0: 766f 6c75 7465 6427 206c 6f67 6963 2074  voluted' logic t
+0002d3f0: 6f20 7468 6520 5f73 7175 6172 655f 6e65  o the _square_ne
+0002d400: 7420 6d65 7468 6f64 2e20 200d 0a20 2020  t method.  ..   
+0002d410: 2020 2020 2023 2020 2020 2020 2020 2020       #          
+0002d420: 2046 6f72 2074 6869 7320 6361 7365 2c20   For this case, 
+0002d430: 7468 6520 616c 676f 7269 7468 6d20 636f  the algorithm co
+0002d440: 6d62 696e 6573 206f 6e65 2063 796c 696e  mbines one cylin
+0002d450: 6472 6963 616c 2061 6e64 2074 776f 2070  drical and two p
+0002d460: 6f6c 6172 2067 7269 6473 2e0d 0a0d 0a20  olar grids..... 
+0002d470: 2020 2020 2020 2023 204e 6f74 653a 206e         # Note: n
+0002d480: 756d 5820 616e 6420 6e75 6d5f 5820 6172  umX and num_X ar
+0002d490: 6520 7468 6520 6e75 6d62 6572 206f 6620  e the number of 
+0002d4a0: 6469 7669 7369 6f6e 7320 616e 6420 7468  divisions and th
+0002d4b0: 6520 6e75 6d62 6572 206f 6620 636f 6f72  e number of coor
+0002d4c0: 2070 6f73 6974 696f 6e73 2e0d 0a20 2020   positions...   
+0002d4d0: 2020 2020 2069 6620 6e75 6d52 2069 7320       if numR is 
+0002d4e0: 4e6f 6e65 203a 2020 6e75 6d52 203d 2069  None :  numR = i
+0002d4f0: 6e74 2828 6e75 6d5a 2b31 292f 3229 0d0a  nt((numZ+1)/2)..
+0002d500: 2020 2020 2020 2020 6966 2062 6173 6574          if baset
+0002d510: 7970 6520 6973 204e 6f6e 6520 3a20 6261  ype is None : ba
+0002d520: 7365 7479 7065 203d 2027 6427 0d0a 2020  setype = 'd'..  
+0002d530: 2020 2020 2020 6966 206d 696e 5261 6420        if minRad 
+0002d540: 6973 204e 6f6e 6520 3a20 6d69 6e52 6164  is None : minRad
+0002d550: 203d 205f 4d49 4e52 4144 0d0a 2020 2020   = _MINRAD..    
+0002d560: 2020 2020 6966 2073 706c 6974 5369 7a65      if splitSize
+0002d570: 2069 7320 4e6f 6e65 203a 2073 706c 6974   is None : split
+0002d580: 5369 7a65 203d 205f 5350 4c49 5453 495a  Size = _SPLITSIZ
+0002d590: 450d 0a20 2020 2020 2020 200d 0a20 2020  E..        ..   
+0002d5a0: 2020 2020 2062 6173 6574 7970 6520 3d20       basetype = 
+0002d5b0: 6261 7365 7479 7065 2e6c 6f77 6572 2829  basetype.lower()
+0002d5c0: 0d0a 2020 2020 2020 2020 6261 7365 6c69  ..        baseli
+0002d5d0: 7374 203d 205b 2764 272c 2773 272c 2771  st = ['d','s','q
+0002d5e0: 272c 2777 272c 2772 272c 2778 275d 0d0a  ','w','r','x']..
+0002d5f0: 2020 2020 2020 2020 6966 2062 6173 6574          if baset
+0002d600: 7970 6520 6e6f 7420 696e 2062 6173 656c  ype not in basel
+0002d610: 6973 7420 3a0d 0a20 2020 2020 2020 2020  ist :..         
+0002d620: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+0002d630: 726f 7228 2247 7269 6420 6261 7365 7479  ror("Grid basety
+0002d640: 7065 2027 7b7d 2720 6973 206e 6f74 2072  pe '{}' is not r
+0002d650: 6563 6f67 6e69 7a65 642e 2050 6f73 7369  ecognized. Possi
+0002d660: 626c 6520 7661 6c75 6573 2061 7265 3a20  ble values are: 
+0002d670: 7b7d 2e22 2e66 6f72 6d61 7428 6261 7365  {}.".format(base
+0002d680: 7479 7065 2c6c 6973 7428 6261 7365 6c69  type,list(baseli
+0002d690: 7374 2929 290d 0a0d 0a20 2020 2020 2020  st)))....       
+0002d6a0: 2069 7353 706c 6974 203d 2028 6261 7365   isSplit = (base
+0002d6b0: 7479 7065 203d 3d20 2773 2729 206f 7220  type == 's') or 
+0002d6c0: 2862 6173 6574 7970 6520 3d3d 2027 7727  (basetype == 'w'
+0002d6d0: 2920 6f72 2028 6261 7365 7479 7065 203d  ) or (basetype =
+0002d6e0: 3d20 2778 2729 0d0a 2020 2020 2020 2020  = 'x')..        
+0002d6f0: 6e65 6564 7354 7269 6167 203d 206e 6f74  needsTriag = not
+0002d700: 2028 2028 6261 7365 7479 7065 203d 3d20   ( (basetype == 
+0002d710: 2772 2729 206f 7220 2862 6173 6574 7970  'r') or (basetyp
+0002d720: 6520 3d3d 2027 7827 2920 2029 0d0a 2020  e == 'x')  )..  
+0002d730: 2020 2020 2020 6861 7343 656e 7465 7220        hasCenter 
+0002d740: 3d20 2862 6173 6574 7970 6520 3d3d 2027  = (basetype == '
+0002d750: 6427 2920 6f72 2028 6261 7365 7479 7065  d') or (basetype
+0002d760: 203d 3d20 2773 2729 0d0a 0d0a 2020 2020   == 's')....    
+0002d770: 2020 2020 2320 5420 616e 676c 6520 7261      # T angle ra
+0002d780: 6e67 6573 2020 202e 2e2e 2e2e 0d0a 2020  nges   .......  
+0002d790: 2020 2020 2020 6e75 6d5f 5520 3d20 6e75        num_U = nu
+0002d7a0: 6d55 2b31 2069 6620 6973 5370 6c69 7420  mU+1 if isSplit 
+0002d7b0: 656c 7365 206e 756d 550d 0a20 2020 2020  else numU..     
+0002d7c0: 2020 206d 696e 5f55 203d 2030 2e30 0d0a     min_U = 0.0..
+0002d7d0: 2020 2020 2020 2020 6d61 785f 5520 3d20          max_U = 
+0002d7e0: 2831 2d31 2f6e 756d 5f55 292a 322a 6e70  (1-1/num_U)*2*np
+0002d7f0: 2e70 690d 0a20 2020 2020 2020 2069 6620  .pi..        if 
+0002d800: 6973 5370 6c69 7420 3a20 6d61 785f 5520  isSplit : max_U 
+0002d810: 3d20 2832 2d73 706c 6974 5369 7a65 292a  = (2-splitSize)*
+0002d820: 6e70 2e70 690d 0a20 2020 2020 2020 2063  np.pi..        c
+0002d830: 6f6f 725f 5520 3d20 6e70 2e6c 696e 7370  oor_U = np.linsp
+0002d840: 6163 6528 6d69 6e5f 552c 6d61 785f 552c  ace(min_U,max_U,
+0002d850: 6e75 6d5f 5529 0d0a 0d0a 2020 2020 2020  num_U)....      
+0002d860: 2020 2320 5220 6469 736b 2072 616e 6765    # R disk range
+0002d870: 7320 2e2e 2e2e 2e2e 2e2e 0d0a 2020 2020  s ..........    
+0002d880: 2020 2020 6966 2068 6173 4365 6e74 6572      if hasCenter
+0002d890: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
+0002d8a0: 6e75 6d5f 522c 696e 6e5f 5220 3d20 6e75  num_R,inn_R = nu
+0002d8b0: 6d52 2d31 2c20 312e 302f 6e75 6d52 0d0a  mR-1, 1.0/numR..
+0002d8c0: 2020 2020 2020 2020 2020 2020 6f75 745f              out_
+0002d8d0: 5220 3d20 312e 302d 2831 2e30 2f6e 756d  R = 1.0-(1.0/num
+0002d8e0: 5229 0d0a 2020 2020 2020 2020 656c 7365  R)..        else
+0002d8f0: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
+0002d900: 6e75 6d5f 522c 696e 6e5f 5220 3d20 6e75  num_R,inn_R = nu
+0002d910: 6d52 2c20 2020 6d69 6e52 6164 0d0a 2020  mR,   minRad..  
+0002d920: 2020 2020 2020 2020 2020 6f75 745f 5220            out_R 
+0002d930: 3d20 312e 302d 2831 2e30 2f6e 756d 5229  = 1.0-(1.0/numR)
+0002d940: 202b 206d 696e 5261 642f 6e75 6d52 0d0a   + minRad/numR..
+0002d950: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+0002d960: 2020 636f 6f72 5f52 5f62 6f74 203d 206e    coor_R_bot = n
+0002d970: 702e 6c69 6e73 7061 6365 2869 6e6e 5f52  p.linspace(inn_R
+0002d980: 2c6f 7574 5f52 2c20 6e75 6d5f 5229 0d0a  ,out_R, num_R)..
+0002d990: 2020 2020 2020 2020 636f 6f72 5f52 5f6d          coor_R_m
+0002d9a0: 6964 203d 206e 702e 6675 6c6c 286e 756d  id = np.full(num
+0002d9b0: 5a2b 312c 312e 3029 0d0a 2020 2020 2020  Z+1,1.0)..      
+0002d9c0: 2020 636f 6f72 5f52 5f74 6f70 203d 206e    coor_R_top = n
+0002d9d0: 702e 6c69 6e73 7061 6365 286f 7574 5f52  p.linspace(out_R
+0002d9e0: 2c69 6e6e 5f52 2c20 6e75 6d5f 5229 0d0a  ,inn_R, num_R)..
+0002d9f0: 2020 2020 2020 2020 6e75 6d5f 5a20 3d20          num_Z = 
+0002da00: 6e75 6d5a 2b31 0d0a 2020 2020 2020 2020  numZ+1..        
+0002da10: 636f 6f72 5f5a 5f62 6f74 203d 206e 702e  coor_Z_bot = np.
+0002da20: 6675 6c6c 286e 756d 5f52 2c2d 312e 3029  full(num_R,-1.0)
+0002da30: 0d0a 2020 2020 2020 2020 636f 6f72 5f5a  ..        coor_Z
+0002da40: 5f6d 6964 203d 206e 702e 6c69 6e73 7061  _mid = np.linspa
+0002da50: 6365 282d 312e 302c 312e 302c 6e75 6d5f  ce(-1.0,1.0,num_
+0002da60: 5a29 0d0a 2020 2020 2020 2020 636f 6f72  Z)..        coor
+0002da70: 5f5a 5f74 6f70 203d 206e 702e 6675 6c6c  _Z_top = np.full
+0002da80: 286e 756d 5f52 2c20 312e 3029 0d0a 0d0a  (num_R, 1.0)....
+0002da90: 2020 2020 2020 2020 636f 6f72 5f52 203d          coor_R =
+0002daa0: 206e 702e 636f 6e63 6174 656e 6174 6528   np.concatenate(
+0002dab0: 2028 636f 6f72 5f52 5f62 6f74 2c63 6f6f   (coor_R_bot,coo
+0002dac0: 725f 525f 6d69 642c 636f 6f72 5f52 5f74  r_R_mid,coor_R_t
+0002dad0: 6f70 292c 6178 6973 3d30 290d 0a20 2020  op),axis=0)..   
+0002dae0: 2020 2020 2063 6f6f 725f 5a20 3d20 6e70       coor_Z = np
+0002daf0: 2e63 6f6e 6361 7465 6e61 7465 2820 2863  .concatenate( (c
+0002db00: 6f6f 725f 5a5f 626f 742c 636f 6f72 5f5a  oor_Z_bot,coor_Z
+0002db10: 5f6d 6964 2c63 6f6f 725f 5a5f 746f 7029  _mid,coor_Z_top)
+0002db20: 2c61 7869 733d 3029 0d0a 2020 2020 2020  ,axis=0)..      
+0002db30: 2020 0d0a 2020 2020 2020 2020 6e75 6d56    ..        numV
+0002db40: 203d 2032 2a6e 756d 5220 2b20 6e75 6d5a   = 2*numR + numZ
+0002db50: 0d0a 2020 2020 2020 2020 6e75 6d5f 5620  ..        num_V 
+0002db60: 3d20 322a 6e75 6d5f 5220 2b20 6e75 6d5f  = 2*num_R + num_
+0002db70: 5a0d 0a20 2020 2020 2020 2074 6f74 5665  Z..        totVe
+0002db80: 7274 7320 3d20 6e75 6d5f 552a 6e75 6d5f  rts = num_U*num_
+0002db90: 560d 0a0d 0a20 2020 2020 2020 2055 5f63  V....        U_c
+0002dba0: 6f6f 7220 3d20 6e70 2e74 696c 6528 636f  oor = np.tile(co
+0002dbb0: 6f72 5f55 2c6e 756d 5f56 290d 0a20 2020  or_U,num_V)..   
+0002dbc0: 2020 2020 2052 5f63 6f6f 7220 3d20 6e70       R_coor = np
+0002dbd0: 2e74 696c 6528 636f 6f72 5f52 2c28 6e75  .tile(coor_R,(nu
+0002dbe0: 6d5f 552c 3129 290d 0a20 2020 2020 2020  m_U,1))..       
+0002dbf0: 2052 5f63 6f6f 7220 3d20 6e70 2e72 6176   R_coor = np.rav
+0002dc00: 656c 2852 5f63 6f6f 722c 6f72 6465 723d  el(R_coor,order=
+0002dc10: 2746 2729 0d0a 2020 2020 2020 2020 5a5f  'F')..        Z_
+0002dc20: 636f 6f72 203d 206e 702e 7469 6c65 2863  coor = np.tile(c
+0002dc30: 6f6f 725f 5a2c 286e 756d 5f55 2c31 2929  oor_Z,(num_U,1))
+0002dc40: 0d0a 2020 2020 2020 2020 5a5f 636f 6f72  ..        Z_coor
+0002dc50: 203d 206e 702e 7261 7665 6c28 5a5f 636f   = np.ravel(Z_co
+0002dc60: 6f72 2c6f 7264 6572 3d27 4627 290d 0a0d  or,order='F')...
+0002dc70: 0a20 2020 2020 2020 2061 6263 203d 206e  .        abc = n
+0002dc80: 702e 6172 7261 7928 5b52 5f63 6f6f 722c  p.array([R_coor,
+0002dc90: 555f 636f 6f72 2c5a 5f63 6f6f 725d 290d  U_coor,Z_coor]).
+0002dca0: 0a20 2020 2020 2020 2078 797a 203d 2043  .        xyz = C
+0002dcb0: 796c 696e 6472 6963 616c 5375 7266 6163  ylindricalSurfac
+0002dcc0: 652e 636f 6f72 5f63 6f6e 7665 7274 2861  e.coor_convert(a
+0002dcd0: 6263 2c54 7275 6529 0d0a 2020 2020 2020  bc,True)..      
+0002dce0: 2020 7665 7274 7320 3d20 6e70 2e61 7272    verts = np.arr
+0002dcf0: 6179 2878 797a 292e 540d 0a20 2020 2020  ay(xyz).T..     
+0002dd00: 2020 206e 756d 5674 203d 206e 756d 5f56     numVt = num_V
+0002dd10: 2d31 2069 6620 6861 7343 656e 7465 7220  -1 if hasCenter 
+0002dd20: 656c 7365 206e 756d 560d 0a20 2020 2020  else numV..     
+0002dd30: 2020 2066 6163 6549 6e64 6963 6573 203d     faceIndices =
+0002dd40: 2063 6c73 2e5f 6772 6964 5f66 6163 655f   cls._grid_face_
+0002dd50: 696e 6469 6365 7328 6e75 6d55 2c6e 756d  indices(numU,num
+0002dd60: 5674 2c69 7353 706c 6974 2c6e 6565 6473  Vt,isSplit,needs
+0002dd70: 5472 6961 6729 0d0a 0d0a 2020 2020 2020  Triag)....      
+0002dd80: 2020 6966 2068 6173 4365 6e74 6572 203a    if hasCenter :
+0002dd90: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+0002dda0: 6164 6420 746f 7020 7472 6961 6e67 756c  add top triangul
+0002ddb0: 6172 2066 6163 6573 202e 2e2e 0d0a 2020  ar faces .....  
+0002ddc0: 2020 2020 2020 2020 2020 746f 7056 6572            topVer
+0002ddd0: 7420 3d20 6e70 2e61 7272 6179 285b 5b30  t = np.array([[0
+0002dde0: 2e30 2c30 2e30 2c31 5d5d 290d 0a20 2020  .0,0.0,1]])..   
+0002ddf0: 2020 2020 2020 2020 2074 6f70 496e 6465           topInde
+0002de00: 7820 3d20 746f 7456 6572 7473 0d0a 2020  x = totVerts..  
+0002de10: 2020 2020 2020 2020 2020 7374 6172 7449            startI
+0002de20: 6e64 6578 203d 2074 6f70 496e 6465 7820  ndex = topIndex 
+0002de30: 2d20 6e75 6d5f 550d 0a20 2020 2020 2020  - num_U..       
+0002de40: 2020 2020 2065 6e64 496e 6465 7820 3d20       endIndex = 
+0002de50: 746f 7049 6e64 6578 2d32 2069 6620 6973  topIndex-2 if is
+0002de60: 5370 6c69 7420 656c 7365 2074 6f70 496e  Split else topIn
+0002de70: 6465 782d 310d 0a20 2020 2020 2020 2020  dex-1..         
+0002de80: 2020 2061 203d 206e 702e 6c69 6e73 7061     a = np.linspa
+0002de90: 6365 2873 7461 7274 496e 6465 782c 656e  ce(startIndex,en
+0002dea0: 6449 6e64 6578 2c6e 756d 552c 6474 7970  dIndex,numU,dtyp
+0002deb0: 653d 696e 7429 0d0a 2020 2020 2020 2020  e=int)..        
+0002dec0: 2020 2020 6220 3d20 612b 3120 6966 2069      b = a+1 if i
+0002ded0: 7353 706c 6974 2065 6c73 6520 6e70 2e61  sSplit else np.a
+0002dee0: 7070 656e 6428 2061 5b31 3a5d 2c20 5b73  ppend( a[1:], [s
+0002def0: 7461 7274 496e 6465 785d 2029 0d0a 2020  tartIndex] )..  
+0002df00: 2020 2020 2020 2020 2020 6320 3d20 6e70            c = np
+0002df10: 2e66 756c 6c28 6e75 6d55 2c74 6f70 496e  .full(numU,topIn
+0002df20: 6465 7829 0d0a 2020 2020 2020 2020 2020  dex)..          
+0002df30: 2020 6162 6320 3d20 6e70 2e61 7272 6179    abc = np.array
+0002df40: 285b 612c 622c 635d 292e 540d 0a20 2020  ([a,b,c]).T..   
+0002df50: 2020 2020 2020 2020 2076 6572 7473 203d           verts =
+0002df60: 206e 702e 6170 7065 6e64 2876 6572 7473   np.append(verts
+0002df70: 2c74 6f70 5665 7274 2c20 6178 6973 3d30  ,topVert, axis=0
+0002df80: 290d 0a20 2020 2020 2020 2020 2020 2066  )..            f
+0002df90: 6163 6549 6e64 6963 6573 203d 206e 702e  aceIndices = np.
+0002dfa0: 6170 7065 6e64 2866 6163 6549 6e64 6963  append(faceIndic
+0002dfb0: 6573 2c61 6263 2c20 6178 6973 3d30 290d  es,abc, axis=0).
+0002dfc0: 0a0d 0a20 2020 2020 2020 2020 2020 2023  ...            #
+0002dfd0: 2061 6464 2062 6f74 746f 6d20 7472 6961   add bottom tria
+0002dfe0: 6e67 756c 6172 2066 6163 6573 7320 2e2e  ngular facess ..
+0002dff0: 2e0d 0a20 2020 2020 2020 2020 2020 2062  ...            b
+0002e000: 746d 5665 7274 203d 206e 702e 6172 7261  tmVert = np.arra
+0002e010: 7928 5b5b 302e 302c 302e 302c 2d31 5d5d  y([[0.0,0.0,-1]]
+0002e020: 290d 0a20 2020 2020 2020 2020 2020 2062  )..            b
+0002e030: 746d 496e 6465 7820 3d20 746f 7456 6572  tmIndex = totVer
+0002e040: 7473 2b31 0d0a 2020 2020 2020 2020 2020  ts+1..          
+0002e050: 2020 7374 6172 7449 6e64 6578 2c65 6e64    startIndex,end
+0002e060: 496e 6465 7820 3d20 302c 6e75 6d55 2d31  Index = 0,numU-1
+0002e070: 0d0a 2020 2020 2020 2020 2020 2020 6120  ..            a 
+0002e080: 3d20 6e70 2e6c 696e 7370 6163 6528 7374  = np.linspace(st
+0002e090: 6172 7449 6e64 6578 2c65 6e64 496e 6465  artIndex,endInde
+0002e0a0: 782c 6e75 6d55 2c64 7479 7065 3d69 6e74  x,numU,dtype=int
+0002e0b0: 290d 0a20 2020 2020 2020 2020 2020 2062  )..            b
+0002e0c0: 203d 2061 2b31 2069 6620 6973 5370 6c69   = a+1 if isSpli
+0002e0d0: 7420 656c 7365 206e 702e 6170 7065 6e64  t else np.append
+0002e0e0: 2820 615b 313a 5d2c 205b 7374 6172 7449  ( a[1:], [startI
+0002e0f0: 6e64 6578 5d20 290d 0a20 2020 2020 2020  ndex] )..       
+0002e100: 2020 2020 2063 203d 206e 702e 6675 6c6c       c = np.full
+0002e110: 286e 756d 552c 6274 6d49 6e64 6578 290d  (numU,btmIndex).
+0002e120: 0a20 2020 2020 2020 2020 2020 2062 6163  .            bac
+0002e130: 203d 206e 702e 6172 7261 7928 5b62 2c61   = np.array([b,a
+0002e140: 2c63 5d29 2e54 2020 2320 6261 6320 696e  ,c]).T  # bac in
+0002e150: 7374 6561 6420 666f 7220 6162 6320 666f  stead for abc fo
+0002e160: 7220 6f75 7477 6172 6420 6e6f 726d 616c  r outward normal
+0002e170: 732e 0d0a 2020 2020 2020 2020 2020 2020  s...            
+0002e180: 7665 7274 7320 3d20 6e70 2e61 7070 656e  verts = np.appen
+0002e190: 6428 7665 7274 732c 6274 6d56 6572 742c  d(verts,btmVert,
+0002e1a0: 2061 7869 733d 3029 0d0a 2020 2020 2020   axis=0)..      
+0002e1b0: 2020 2020 2020 6661 6365 496e 6469 6365        faceIndice
+0002e1c0: 7320 3d20 6e70 2e61 7070 656e 6428 6661  s = np.append(fa
+0002e1d0: 6365 496e 6469 6365 732c 6261 632c 2061  ceIndices,bac, a
+0002e1e0: 7869 733d 3029 0d0a 0d0a 2020 2020 2020  xis=0)....      
+0002e1f0: 2020 7375 7266 6163 6520 3d20 636c 7328    surface = cls(
+0002e200: 2a2a 6b77 6172 6773 2920 2023 2073 6574  **kwargs)  # set
+0002e210: 2074 6f20 7468 6520 636c 6173 7320 6465   to the class de
+0002e220: 6661 756c 7420 6f62 6a65 6374 0d0a 2020  fault object..  
+0002e230: 2020 2020 2020 2320 7265 7365 7420 7665        # reset ve
+0002e240: 7274 732c 2066 6163 6549 6e64 6963 6573  rts, faceIndices
+0002e250: 2061 6e64 2065 6467 6573 2028 7265 7461   and edges (reta
+0002e260: 696e 2063 6c61 7373 2063 6f6f 7264 696e  in class coordin
+0002e270: 6174 6520 7379 7374 656d 292e 0d0a 2020  ate system)...  
+0002e280: 2020 2020 2020 7375 7266 6163 652e 7665        surface.ve
+0002e290: 7274 6578 436f 6f72 203d 2076 6572 7473  rtexCoor = verts
+0002e2a0: 0d0a 2020 2020 2020 2020 7375 7266 6163  ..        surfac
+0002e2b0: 652e 6676 496e 6469 6365 7320 3d20 6661  e.fvIndices = fa
+0002e2c0: 6365 496e 6469 6365 730d 0a20 2020 2020  ceIndices..     
+0002e2d0: 2020 2073 7572 6661 6365 2e65 7649 6e64     surface.evInd
+0002e2e0: 6963 6573 203d 2073 7572 6661 6365 2e5f  ices = surface._
+0002e2f0: 6765 745f 6564 6765 735f 6672 6f6d 5f66  get_edges_from_f
+0002e300: 6163 6573 2866 6163 6549 6e64 6963 6573  aces(faceIndices
+0002e310: 290d 0a20 2020 2020 2020 2073 7572 6661  )..        surfa
+0002e320: 6365 2e76 6649 6e64 6963 6573 4c69 7374  ce.vfIndicesList
+0002e330: 203d 2073 7572 6661 6365 2e5f 7665 7274   = surface._vert
+0002e340: 6578 436f 6d6d 6f6e 4661 6365 496e 6469  exCommonFaceIndi
+0002e350: 6365 7328 290d 0a20 2020 2020 2020 2073  ces()..        s
+0002e360: 7572 6661 6365 2e65 6649 6e64 6963 6573  urface.efIndices
+0002e370: 4c69 7374 203d 2073 7572 6661 6365 2e5f  List = surface._
+0002e380: 6564 6765 436f 6d6d 6f6e 4661 6365 496e  edgeCommonFaceIn
+0002e390: 6469 6365 7328 290d 0a20 2020 2020 2020  dices()..       
+0002e3a0: 2073 7572 6661 6365 2e73 6574 5f76 6572   surface.set_ver
+0002e3b0: 7473 2820 7665 7274 735b 6661 6365 496e  ts( verts[faceIn
+0002e3c0: 6469 6365 735d 2029 0d0a 2020 2020 2020  dices] )..      
+0002e3d0: 2020 7375 7266 6163 652e 5f73 6574 5f67    surface._set_g
+0002e3e0: 656f 6d65 7472 6963 5f62 6f75 6e64 7328  eometric_bounds(
+0002e3f0: 290d 0a20 2020 2020 2020 2073 7572 6661  )..        surfa
+0002e400: 6365 2e6e 616d 6520 3d20 6e61 6d65 0d0a  ce.name = name..
+0002e410: 2020 2020 2020 2020 7375 7266 6163 652e          surface.
+0002e420: 5f62 6173 6574 7970 6520 3d20 2767 7269  _basetype = 'gri
+0002e430: 645f 272b 6261 7365 7479 7065 2b27 7627  d_'+basetype+'v'
+0002e440: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+0002e450: 2073 7572 6661 6365 0d0a 0d0a 2020 2020   surface....    
+0002e460: 4063 6c61 7373 6d65 7468 6f64 0d0a 2020  @classmethod..  
+0002e470: 2020 6465 6620 5f75 7677 5f74 6f5f 7879    def _uvw_to_xy
+0002e480: 7a28 636c 732c 2075 7677 2c20 7274 7a29  z(cls, uvw, rtz)
+0002e490: 203a 0d0a 2020 2020 2020 2020 2222 224f   :..        """O
+0002e4a0: 7665 7272 6964 6520 726f 7461 7469 6f6e  verride rotation
+0002e4b0: 616c 2074 7261 6e66 6f72 6d61 7469 6f6e  al tranformation
+0002e4c0: 2061 7420 6120 6379 6c69 6e64 7269 6361   at a cylindrica
+0002e4d0: 6c20 636f 6f72 6469 6e61 7465 2e22 2222  l coordinate."""
+0002e4e0: 200d 0a20 2020 2020 2020 2072 6574 7572   ..        retur
+0002e4f0: 6e20 7375 7065 7228 292e 5f64 6973 705f  n super()._disp_
+0002e500: 746f 5f78 797a 2820 7576 772c 2072 747a  to_xyz( uvw, rtz
+0002e510: 5b31 5d2c 204e 6f6e 6520 290d 0a0d 0a20  [1], None ).... 
+0002e520: 2020 2040 636c 6173 736d 6574 686f 640d     @classmethod.
+0002e530: 0a20 2020 2064 6566 2067 7269 6428 636c  .    def grid(cl
+0002e540: 732c 206e 7665 7220 2c6e 616e 672c 2062  s, nver ,nang, b
+0002e550: 6173 6574 7970 653d 2764 272c 6d69 6e72  asetype='d',minr
+0002e560: 6164 3d4e 6f6e 652c 206e 756d 523d 4e6f  ad=None, numR=No
+0002e570: 6e65 2c20 6e61 6d65 3d4e 6f6e 652c 202a  ne, name=None, *
+0002e580: 2a6b 7761 7267 7329 203a 0d0a 2020 2020  *kwargs) :..    
+0002e590: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
+0002e5a0: 2043 796c 696e 6472 6963 616c 5375 7266   CylindricalSurf
+0002e5b0: 6163 6520 7769 7468 2061 7869 616c 2061  ace with axial a
+0002e5c0: 6e64 2076 6572 7469 6361 6c20 6661 6365  nd vertical face
+0002e5d0: 732e 0d0a 0d0a 2020 2020 2020 2020 5061  s.....        Pa
+0002e5e0: 7261 6d65 7465 7273 0d0a 2020 2020 2020  rameters..      
+0002e5f0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
+0002e600: 2020 2020 2020 6e76 6572 203a 2069 6e74        nver : int
+0002e610: 6567 6572 2c20 7265 7175 6972 6564 2e0d  eger, required..
+0002e620: 0a20 2020 2020 2020 2020 2020 204e 756d  .            Num
+0002e630: 6265 7220 6f66 2076 6572 7469 6361 6c20  ber of vertical 
+0002e640: 7375 6264 6976 6973 696f 6e73 2e20 204d  subdivisions.  M
+0002e650: 696e 696d 756d 2076 616c 7565 2069 7320  inimum value is 
+0002e660: 310d 0a0d 0a20 2020 2020 2020 206e 616e  1....        nan
+0002e670: 6720 3a20 696e 7465 6765 722c 2072 6571  g : integer, req
+0002e680: 7569 7265 642e 0d0a 2020 2020 2020 2020  uired...        
+0002e690: 2020 2020 4e75 6d62 6572 206f 6620 616e      Number of an
+0002e6a0: 6775 6c61 7220 7375 6264 6976 6973 696f  gular subdivisio
+0002e6b0: 6e73 2e20 4d69 6e69 6d75 6d20 7661 6c75  ns. Minimum valu
+0002e6c0: 6520 6973 2033 2e0d 0a20 2020 2020 2020  e is 3...       
+0002e6d0: 200d 0a20 2020 2020 2020 2062 6173 6574   ..        baset
+0002e6e0: 7970 6520 3a20 7b27 6427 2c27 7127 2c27  ype : {'d','q','
+0002e6f0: 7227 2c27 7327 2c27 7727 2c27 7827 2c20  r','s','w','x', 
+0002e700: 2764 7627 2c27 7176 272c 2772 7627 2c27  'dv','qv','rv','
+0002e710: 7376 272c 2777 7627 2c27 7876 277d 2c20  sv','wv','xv'}, 
+0002e720: 6f70 7469 6f6e 616c 2c20 6465 6661 756c  optional, defaul
+0002e730: 743a 2027 6427 0d0a 2020 2020 2020 2020  t: 'd'..        
+0002e740: 2020 2020 5374 6172 7469 6e67 2073 7572      Starting sur
+0002e750: 6661 6365 2067 656f 6d65 7472 6965 7320  face geometries 
+0002e760: 6672 6f6d 2077 6869 6368 2074 6865 2073  from which the s
+0002e770: 7572 6661 6365 2069 730d 0a20 2020 2020  urface is..     
+0002e780: 2020 2020 2020 2063 6f6e 7374 7275 6374         construct
+0002e790: 6564 2069 6e64 6963 6174 696e 6720 6661  ed indicating fa
+0002e7a0: 6365 2073 6861 7065 2061 6e64 2069 6620  ce shape and if 
+0002e7b0: 7370 6c69 742e 0d0a 0d0a 2020 2020 2020  split.....      
+0002e7c0: 2020 6d69 6e72 6164 203a 2073 6361 6c61    minrad : scala
+0002e7d0: 722c 206f 7074 696f 6e61 6c2c 2064 6566  r, optional, def
+0002e7e0: 6175 6c74 3a20 302e 3031 0d0a 2020 2020  ault: 0.01..    
+0002e7f0: 2020 2020 2020 2020 5468 6520 6d69 6e69          The mini
+0002e800: 6d75 6d20 6469 7374 616e 6365 2066 726f  mum distance fro
+0002e810: 6d20 7468 6520 7a2d 6178 6973 206f 6620  m the z-axis of 
+0002e820: 616e 7920 7665 7274 6578 2063 6f6f 7264  any vertex coord
+0002e830: 696e 6174 652e 0d0a 2020 2020 2020 2020  inate...        
+0002e840: 2020 2020 5573 6520 6973 2064 6570 656e      Use is depen
+0002e850: 6465 6e74 206f 6e20 6261 7365 7479 7065  dent on basetype
+0002e860: 2e0d 0a0d 0a20 2020 2020 2020 206e 756d  .....        num
+0002e870: 5220 3a20 696e 7465 6765 722c 206f 7074  R : integer, opt
+0002e880: 696f 6e61 6c2c 2064 6566 6175 6c74 3a20  ional, default: 
+0002e890: 4e6f 6e65 0d0a 2020 2020 2020 2020 2020  None..          
+0002e8a0: 2020 4f6e 6c79 2061 7070 6c69 6361 626c    Only applicabl
+0002e8b0: 6520 666f 7220 766f 6c75 6d65 2063 796c  e for volume cyl
+0002e8c0: 696e 6465 7220 6765 6f6d 6574 7269 6573  inder geometries
+0002e8d0: 2e0d 0a20 2020 2020 2020 2020 2020 204e  ...            N
+0002e8e0: 756d 6265 7220 6f66 2072 6164 6961 6c20  umber of radial 
+0002e8f0: 7375 6264 6976 6973 696f 6e73 2066 6f72  subdivisions for
+0002e900: 2076 6f6c 756d 6520 6379 6c69 6e64 6572   volume cylinder
+0002e910: 732e 0d0a 2020 2020 2020 2020 2020 2020  s...            
+0002e920: 5768 656e 204e 6f6e 652c 2064 6566 6175  When None, defau
+0002e930: 6c74 2069 7320 6861 6c66 2074 6865 206e  lt is half the n
+0002e940: 756d 6265 7220 6f66 2076 6572 7469 6361  umber of vertica
+0002e950: 6c20 7375 6264 6976 6973 696f 6e73 2e0d  l subdivisions..
+0002e960: 0a0d 0a20 2020 2020 2020 206e 616d 6520  ...        name 
+0002e970: 3a20 7374 7269 6e67 2c20 6f70 7469 6f6e  : string, option
+0002e980: 616c 2c20 6465 6661 756c 743a 204e 6f6e  al, default: Non
+0002e990: 652e 0d0a 2020 2020 2020 2020 2020 2020  e...            
+0002e9a0: 4465 7363 7269 7074 6976 6520 6964 656e  Descriptive iden
+0002e9b0: 7469 6669 6572 2e0d 0a0d 0a20 2020 2020  tifier.....     
+0002e9c0: 2020 2052 6169 7365 730d 0a20 2020 2020     Raises..     
+0002e9d0: 2020 202d 2d2d 2d2d 2d0d 0a20 2020 2020     ------..     
+0002e9e0: 2020 2056 616c 7565 4572 726f 720d 0a20     ValueError.. 
+0002e9f0: 2020 2020 2020 2020 2020 2049 6620 6e76             If nv
+0002ea00: 6572 2069 7320 6e6f 7420 616e 2069 6e74  er is not an int
+0002ea10: 6567 6572 2067 7265 6174 6572 206f 7220  eger greater or 
+0002ea20: 6571 7561 6c20 746f 2031 2e0d 0a20 2020  equal to 1...   
+0002ea30: 2020 2020 2020 2020 2049 6620 6e61 6e67           If nang
+0002ea40: 2069 7320 6e6f 7420 616e 2069 6e74 6567   is not an integ
+0002ea50: 6572 2067 7265 6174 6572 206f 7220 6571  er greater or eq
+0002ea60: 7561 6c20 746f 2033 2e0d 0a0d 0a20 2020  ual to 3.....   
+0002ea70: 2020 2020 204f 7468 6572 2050 6172 616d       Other Param
+0002ea80: 6574 6572 730d 0a20 2020 2020 2020 202d  eters..        -
+0002ea90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d  ---------------.
+0002eaa0: 0a20 2020 2020 2020 202a 2a6b 7761 7267  .        **kwarg
+0002eab0: 730d 0a20 2020 2020 2020 2020 2020 2041  s..            A
+0002eac0: 6c6c 206f 7468 6572 2070 6172 616d 6574  ll other paramet
+0002ead0: 6572 7320 6172 6520 7061 7373 6564 206f  ers are passed o
+0002eae0: 6e20 746f 2027 7333 646c 6962 2e73 7572  n to 's3dlib.sur
+0002eaf0: 6661 6365 2e53 7572 6661 6365 3344 436f  face.Surface3DCo
+0002eb00: 6c6c 6563 7469 6f6e 272e 0d0a 2020 2020  llection'...    
+0002eb10: 2020 2020 0d0a 2020 2020 2020 2020 5265      ..        Re
+0002eb20: 7475 726e 730d 0a20 2020 2020 2020 202d  turns..        -
+0002eb30: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
+0002eb40: 7375 7266 6163 6520 3a20 4379 6c69 6e64  surface : Cylind
+0002eb50: 7269 6361 6c53 7572 6661 6365 206f 626a  ricalSurface obj
+0002eb60: 6563 742e 0d0a 0d0a 2020 2020 2020 2020  ect.....        
+0002eb70: 2222 220d 0a20 2020 2020 2020 204e 6661  """..        Nfa
+0002eb80: 6365 7320 3d20 7b20 2764 273a 2036 2c20  ces = { 'd': 6, 
+0002eb90: 2020 2773 273a 2036 2c20 2020 2771 273a    's': 6,   'q':
+0002eba0: 362c 2020 2027 7727 3a36 2c20 2020 2772  6,   'w':6,   'r
+0002ebb0: 273a 332c 2020 2778 273a 332c 0d0a 2020  ':3,  'x':3,..  
+0002ebc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ebd0: 2027 6476 273a 2031 322c 2027 7376 273a   'dv': 12, 'sv':
+0002ebe0: 2031 322c 2027 7176 273a 3138 2c20 2777   12, 'qv':18, 'w
+0002ebf0: 7627 3a31 382c 2027 7276 273a 392c 2027  v':18, 'rv':9, '
+0002ec00: 7876 273a 3920 207d 2020 2320 312c 330d  xv':9  }  # 1,3.
+0002ec10: 0a20 2020 2020 2020 2073 706c 6974 5369  .        splitSi
+0002ec20: 7a65 203d 204e 6f6e 6520 2023 2046 7574  ze = None  # Fut
+0002ec30: 4465 763a 2063 7572 7265 6e74 6c79 2c20  Dev: currently, 
+0002ec40: 6e6f 7420 7573 6572 2061 6363 6573 7361  not user accessa
+0002ec50: 626c 652e 0d0a 2020 2020 2020 2020 6466  ble...        df
+0002ec60: 744e 6661 6365 7320 3d20 3132 0d0a 0d0a  tNfaces = 12....
+0002ec70: 2020 2020 2020 2020 6261 7365 7479 7065          basetype
+0002ec80: 203d 2062 6173 6574 7970 652e 6c6f 7765   = basetype.lowe
+0002ec90: 7228 290d 0a20 2020 2020 2020 2069 6620  r()..        if 
+0002eca0: 6261 7365 7479 7065 2e65 6e64 7377 6974  basetype.endswit
+0002ecb0: 6828 2776 2729 203a 0d0a 2020 2020 2020  h('v') :..      
+0002ecc0: 2020 2020 2020 6466 744e 6661 6365 7320        dftNfaces 
+0002ecd0: 3d20 3138 0d0a 2020 2020 2020 2020 2020  = 18..          
+0002ece0: 2020 7375 6274 7970 6520 3d20 6261 7365    subtype = base
+0002ecf0: 7479 7065 5b30 5d0d 0a20 2020 2020 2020  type[0]..       
+0002ed00: 2020 2020 2073 7572 6661 6365 203d 2043       surface = C
+0002ed10: 796c 696e 6472 6963 616c 5375 7266 6163  ylindricalSurfac
+0002ed20: 652e 5f63 796c 5f76 6f6c 5f73 7175 6172  e._cyl_vol_squar
+0002ed30: 655f 6e65 7428 206e 7665 7220 2c6e 616e  e_net( nver ,nan
+0002ed40: 672c 2073 7562 7479 7065 2c20 6d69 6e72  g, subtype, minr
+0002ed50: 6164 2c20 7370 6c69 7453 697a 652c 206e  ad, splitSize, n
+0002ed60: 756d 522c 206e 616d 652c 202a 2a6b 7761  umR, name, **kwa
+0002ed70: 7267 7329 0d0a 2020 2020 2020 2020 656c  rgs)..        el
+0002ed80: 7365 203a 200d 0a20 2020 2020 2020 2020  se : ..         
+0002ed90: 2020 2073 7572 6661 6365 203d 2063 6c73     surface = cls
+0002eda0: 2e5f 7371 7561 7265 5f6e 6574 286e 7665  ._square_net(nve
+0002edb0: 7220 2c6e 616e 672c 6261 7365 7479 7065  r ,nang,basetype
+0002edc0: 2c6d 696e 7261 642c 7370 6c69 7453 697a  ,minrad,splitSiz
+0002edd0: 652c 206e 616d 652c 202a 2a6b 7761 7267  e, name, **kwarg
+0002ede0: 7329 0d0a 2020 2020 2020 2020 7375 7266  s)..        surf
+0002edf0: 6163 652e 5f70 6f73 7450 726f 635f 7375  ace._postProc_su
+0002ee00: 7266 6163 6543 6f6c 6f72 7328 5472 7565  rfaceColors(True
+0002ee10: 290d 0a20 2020 2020 2020 2073 7572 6661  )..        surfa
+0002ee20: 6365 2e5f 7265 7a20 3d20 7375 7266 6163  ce._rez = surfac
+0002ee30: 652e 5f63 616c 635f 7265 7a28 2064 6674  e._calc_rez( dft
+0002ee40: 4e66 6163 6573 2029 0d0a 2020 2020 2020  Nfaces )..      
+0002ee50: 2020 7265 7475 726e 2073 7572 6661 6365    return surface
+0002ee60: 2020 2020 2020 200d 0a0d 0a20 2020 2040         ....    @
+0002ee70: 636c 6173 736d 6574 686f 640d 0a20 2020  classmethod..   
+0002ee80: 2064 6566 2070 6e74 7375 7266 2863 6c73   def pntsurf(cls
+0002ee90: 2c20 7274 7a5f 706f 696e 7473 2c20 6e61  , rtz_points, na
+0002eea0: 6d65 3d4e 6f6e 652c 202a 2a6b 6172 6773  me=None, **kargs
+0002eeb0: 2920 3a0d 0a20 2020 2020 2020 2022 2222  ) :..        """
+0002eec0: 0d0a 2020 2020 2020 2020 4379 6c69 6e64  ..        Cylind
+0002eed0: 7269 6361 6c53 7572 6661 6365 2066 726f  ricalSurface fro
+0002eee0: 6d20 706f 696e 7473 2069 6e20 6379 6c69  m points in cyli
+0002eef0: 6e64 7269 6361 6c20 636f 6f72 6469 6e61  ndrical coordina
+0002ef00: 7465 732e 0d0a 0d0a 2020 2020 2020 2020  tes.....        
+0002ef10: 5061 7261 6d65 7465 7273 0d0a 2020 2020  Parameters..    
+0002ef20: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a      ----------..
+0002ef30: 2020 2020 2020 2020 7274 7a5f 706f 696e          rtz_poin
+0002ef40: 7473 203a 2061 7272 6179 2c20 7265 7175  ts : array, requ
+0002ef50: 6972 6564 2e0d 0a20 2020 2020 2020 2020  ired...         
+0002ef60: 2020 2041 6e20 4e20 5820 3320 6172 7261     An N X 3 arra
+0002ef70: 7920 6f66 204e 2063 796c 696e 6472 6963  y of N cylindric
+0002ef80: 616c 2063 6f6f 7264 696e 6174 6520 706f  al coordinate po
+0002ef90: 696e 7473 2e0d 0a0d 0a20 2020 2020 2020  ints.....       
+0002efa0: 206e 616d 6520 3a20 7374 7269 6e67 2c20   name : string, 
+0002efb0: 6f70 7469 6f6e 616c 2c20 6465 6661 756c  optional, defaul
+0002efc0: 743a 204e 6f6e 652e 0d0a 2020 2020 2020  t: None...      
+0002efd0: 2020 2020 2020 4465 7363 7269 7074 6976        Descriptiv
+0002efe0: 6520 6964 656e 7469 6669 6572 2066 6f72  e identifier for
+0002eff0: 2074 6865 2070 6f69 6e74 2073 7572 6661   the point surfa
+0002f000: 6365 2e0d 0a0d 0a20 2020 2020 2020 2052  ce.....        R
+0002f010: 6574 7572 6e73 0d0a 2020 2020 2020 2020  eturns..        
+0002f020: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
+0002f030: 2073 7572 6661 6365 203a 2043 796c 696e   surface : Cylin
+0002f040: 6472 6963 616c 5375 7266 6163 6520 6f62  dricalSurface ob
+0002f050: 6a65 6374 0d0a 0d0a 2020 2020 2020 2020  ject....        
+0002f060: 2222 220d 0a20 2020 2020 2020 2064 6174  """..        dat
+0002f070: 6150 7473 203d 206e 702e 6172 7261 7928  aPts = np.array(
+0002f080: 7274 7a5f 706f 696e 7473 290d 0a0d 0a20  rtz_points).... 
+0002f090: 2020 2020 2020 2063 796c 5074 7320 3d20         cylPts = 
+0002f0a0: 6e70 2e61 7272 6179 2864 6174 6150 7473  np.array(dataPts
+0002f0b0: 2e54 290d 0a20 2020 2020 2020 2063 796c  .T)..        cyl
+0002f0c0: 5074 735b 305d 203d 206e 702e 616d 6178  Pts[0] = np.amax
+0002f0d0: 2863 796c 5074 735b 305d 290d 0a20 2020  (cylPts[0])..   
+0002f0e0: 2020 2020 2078 797a 5f63 796c 5074 7320       xyz_cylPts 
+0002f0f0: 3d20 4379 6c69 6e64 7269 6361 6c53 7572  = CylindricalSur
+0002f100: 6661 6365 2e63 6f6f 725f 636f 6e76 6572  face.coor_conver
+0002f110: 7428 6379 6c50 7473 2c54 7275 6529 0d0a  t(cylPts,True)..
+0002f120: 2020 2020 2020 2020 6d69 6e5a 2c6d 6178          minZ,max
+0002f130: 5a20 3d20 6e70 2e61 6d69 6e28 6379 6c50  Z = np.amin(cylP
+0002f140: 7473 5b32 5d29 2c20 6e70 2e61 6d61 7828  ts[2]), np.amax(
+0002f150: 6379 6c50 7473 5b32 5d29 0d0a 2020 2020  cylPts[2])..    
+0002f160: 2020 2020 6f66 6673 6574 5a20 3d20 286d      offsetZ = (m
+0002f170: 6178 5a2b 6d69 6e5a 292f 320d 0a20 2020  axZ+minZ)/2..   
+0002f180: 2020 2020 2078 797a 5f63 796c 5074 735b       xyz_cylPts[
+0002f190: 325d 203d 2078 797a 5f63 796c 5074 735b  2] = xyz_cylPts[
+0002f1a0: 325d 202d 206f 6666 7365 745a 0d0a 0d0a  2] - offsetZ....
+0002f1b0: 2020 2020 2020 2020 7370 6850 7473 203d          sphPts =
+0002f1c0: 2053 7068 6572 6963 616c 5375 7266 6163   SphericalSurfac
+0002f1d0: 652e 636f 6f72 5f63 6f6e 7665 7274 2878  e.coor_convert(x
+0002f1e0: 797a 5f63 796c 5074 732c 4661 6c73 6529  yz_cylPts,False)
+0002f1f0: 0d0a 2020 2020 2020 2020 726d 6178 203d  ..        rmax =
+0002f200: 206e 702e 616d 6178 2873 7068 5074 735b   np.amax(sphPts[
+0002f210: 305d 290d 0a20 2020 2020 2020 2073 7068  0])..        sph
+0002f220: 5074 735b 305d 203d 2072 6d61 780d 0a20  Pts[0] = rmax.. 
+0002f230: 2020 2020 2020 2078 797a 5f73 7068 5074         xyz_sphPt
+0002f240: 7320 3d20 5370 6865 7269 6361 6c53 7572  s = SphericalSur
+0002f250: 6661 6365 2e63 6f6f 725f 636f 6e76 6572  face.coor_conver
+0002f260: 7428 7370 6850 7473 2c54 7275 6529 0d0a  t(sphPts,True)..
+0002f270: 2020 2020 2020 2020 7074 546f 702c 7074          ptTop,pt
+0002f280: 4274 6d20 3d20 5b30 2c30 2c72 6d61 785d  Btm = [0,0,rmax]
+0002f290: 2c20 5b30 2c30 2c2d 726d 6178 5d0d 0a20  , [0,0,-rmax].. 
+0002f2a0: 2020 2020 2020 2078 797a 5f73 7068 5074         xyz_sphPt
+0002f2b0: 7320 3d20 6e70 2e61 7070 656e 6428 7879  s = np.append(xy
+0002f2c0: 7a5f 7370 6850 7473 2e54 2c5b 7074 546f  z_sphPts.T,[ptTo
+0002f2d0: 702c 7074 4274 6d5d 2c61 7869 733d 3029  p,ptBtm],axis=0)
+0002f2e0: 2e54 0d0a 0d0a 2020 2020 2020 2020 2320  .T....        # 
+0002f2f0: 6e6f 7465 3a20 7468 6520 666f 6c6c 6f77  note: the follow
+0002f300: 696e 6720 7375 7266 6163 6520 6d65 7468  ing surface meth
+0002f310: 6f64 2063 6875 6c6c 2063 6f72 7265 6374  od chull correct
+0002f320: 7320 6661 6365 206e 6f72 6d61 6c0d 0a20  s face normal.. 
+0002f330: 2020 2020 2020 2023 206f 7269 656e 7461         # orienta
+0002f340: 7469 6f6e 7320 736f 2073 7061 7469 616c  tions so spatial
+0002f350: 2e43 6f6e 7665 7848 756c 6c20 7761 7320  .ConvexHull was 
+0002f360: 6e6f 7420 6469 7265 6374 6c79 2075 7365  not directly use
+0002f370: 642e 0d0a 2020 2020 2020 2020 6875 6c6c  d...        hull
+0002f380: 5f73 7572 6661 6365 203d 2053 7572 6661  _surface = Surfa
+0002f390: 6365 3344 436f 6c6c 6563 7469 6f6e 2e63  ce3DCollection.c
+0002f3a0: 6875 6c6c 2878 797a 5f73 7068 5074 732e  hull(xyz_sphPts.
+0002f3b0: 5429 0d0a 0d0a 2020 2020 2020 2020 7665  T)....        ve
+0002f3c0: 7274 7320 3d20 4379 6c69 6e64 7269 6361  rts = Cylindrica
+0002f3d0: 6c53 7572 6661 6365 2e63 6f6f 725f 636f  lSurface.coor_co
+0002f3e0: 6e76 6572 7428 6461 7461 5074 732e 542c  nvert(dataPts.T,
+0002f3f0: 5472 7565 292e 540d 0a20 2020 2020 2020  True).T..       
+0002f400: 2023 2072 656d 6f76 6520 6661 6365 7320   # remove faces 
+0002f410: 6174 7461 6368 6564 2074 6f20 7468 6520  attached to the 
+0002f420: 7477 6f20 746f 7020 2620 626f 7474 6f6d  two top & bottom
+0002f430: 2076 6572 7469 6365 732e 0d0a 2020 2020   vertices...    
+0002f440: 2020 2020 4e20 3d20 6c65 6e28 6461 7461      N = len(data
+0002f450: 5074 7329 0d0a 2020 2020 2020 2020 6676  Pts)..        fv
+0002f460: 496e 6469 6365 7320 3d20 6875 6c6c 5f73  Indices = hull_s
+0002f470: 7572 6661 6365 2e66 7649 6e64 6963 6573  urface.fvIndices
+0002f480: 0d0a 2020 2020 2020 2020 6d61 7849 6e64  ..        maxInd
+0002f490: 6963 6573 203d 206e 702e 6d61 7828 6676  ices = np.max(fv
+0002f4a0: 496e 6469 6365 732c 6178 6973 3d31 290d  Indices,axis=1).
+0002f4b0: 0a20 2020 2020 2020 2073 686f 756c 646b  .        shouldk
+0002f4c0: 6565 7020 3d20 6e70 2e77 6865 7265 286d  eep = np.where(m
+0002f4d0: 6178 496e 6469 6365 7320 3c20 4e29 0d0a  axIndices < N)..
+0002f4e0: 2020 2020 2020 2020 6661 6365 496e 6469          faceIndi
+0002f4f0: 6365 7320 3d20 6676 496e 6469 6365 735b  ces = fvIndices[
+0002f500: 7368 6f75 6c64 6b65 6570 5d0d 0a0d 0a20  shouldkeep].... 
+0002f510: 2020 2020 2020 2069 6620 6e61 6d65 2069         if name i
+0002f520: 7320 4e6f 6e65 203a 206e 616d 6520 3d20  s None : name = 
+0002f530: 2770 6f69 6e74 2073 7572 6661 6365 270d  'point surface'.
+0002f540: 0a20 2020 2020 2020 2073 7572 6661 6365  .        surface
+0002f550: 203d 2043 796c 696e 6472 6963 616c 5375   = CylindricalSu
+0002f560: 7266 6163 6528 6e61 6d65 3d6e 616d 652c  rface(name=name,
+0002f570: 2a2a 6b61 7267 7329 200d 0a20 2020 2020  **kargs) ..     
+0002f580: 2020 2073 7572 6661 6365 2e76 6572 7465     surface.verte
+0002f590: 7843 6f6f 7220 3d20 7665 7274 730d 0a20  xCoor = verts.. 
+0002f5a0: 2020 2020 2020 2073 7572 6661 6365 2e66         surface.f
+0002f5b0: 7649 6e64 6963 6573 203d 2066 6163 6549  vIndices = faceI
+0002f5c0: 6e64 6963 6573 0d0a 2020 2020 2020 2020  ndices..        
+0002f5d0: 7375 7266 6163 652e 6576 496e 6469 6365  surface.evIndice
+0002f5e0: 7320 3d20 7375 7266 6163 652e 5f67 6574  s = surface._get
+0002f5f0: 5f65 6467 6573 5f66 726f 6d5f 6661 6365  _edges_from_face
+0002f600: 7328 6661 6365 496e 6469 6365 7329 0d0a  s(faceIndices)..
+0002f610: 2020 2020 2020 2020 7375 7266 6163 652e          surface.
+0002f620: 7666 496e 6469 6365 734c 6973 7420 3d20  vfIndicesList = 
+0002f630: 7375 7266 6163 652e 5f76 6572 7465 7843  surface._vertexC
+0002f640: 6f6d 6d6f 6e46 6163 6549 6e64 6963 6573  ommonFaceIndices
+0002f650: 2829 0d0a 2020 2020 2020 2020 7375 7266  ()..        surf
+0002f660: 6163 652e 6566 496e 6469 6365 734c 6973  ace.efIndicesLis
+0002f670: 7420 3d20 7375 7266 6163 652e 5f65 6467  t = surface._edg
+0002f680: 6543 6f6d 6d6f 6e46 6163 6549 6e64 6963  eCommonFaceIndic
+0002f690: 6573 2829 0d0a 2020 2020 2020 2020 7375  es()..        su
+0002f6a0: 7266 6163 652e 7365 745f 7665 7274 7328  rface.set_verts(
+0002f6b0: 2076 6572 7473 5b66 6163 6549 6e64 6963   verts[faceIndic
+0002f6c0: 6573 5d20 290d 0a20 2020 2020 2020 2073  es] )..        s
+0002f6d0: 7572 6661 6365 2e5f 7365 745f 6765 6f6d  urface._set_geom
+0002f6e0: 6574 7269 635f 626f 756e 6473 2829 0d0a  etric_bounds()..
+0002f6f0: 2020 2020 2020 2020 7375 7266 6163 652e          surface.
+0002f700: 5f72 657a 203d 2073 7572 6661 6365 2e5f  _rez = surface._
+0002f710: 6361 6c63 5f72 657a 2831 3229 0d0a 2020  calc_rez(12)..  
+0002f720: 2020 2020 2020 7375 7266 6163 652e 5f62        surface._b
+0002f730: 6173 6574 7970 6520 3d20 2770 6e74 7375  asetype = 'pntsu
+0002f740: 7266 270d 0a20 2020 2020 2020 2072 6574  rf'..        ret
+0002f750: 7572 6e20 7375 7266 6163 650d 0a0d 0a20  urn surface.... 
+0002f760: 2020 2040 636c 6173 736d 6574 686f 640d     @classmethod.
+0002f770: 0a20 2020 2064 6566 205f 5866 6576 2863  .    def _Xfev(c
+0002f780: 6c73 2c72 657a 2c20 6261 7365 7479 7065  ls,rez, basetype
+0002f790: 3d4e 6f6e 652c 206d 696e 7261 643d 4e6f  =None, minrad=No
+0002f7a0: 6e65 2920 3a0d 0a20 2020 2020 2020 2022  ne) :..        "
+0002f7b0: 2222 0d0a 2020 2020 2020 2020 4361 6c63  ""..        Calc
+0002f7c0: 756c 6174 6573 206e 756d 6265 7220 6f66  ulates number of
+0002f7d0: 2066 6163 6573 2c20 6564 6765 732c 2061   faces, edges, a
+0002f7e0: 6e64 2076 6572 7469 6365 7320 6f66 2061  nd vertices of a
+0002f7f0: 2043 796c 696e 6472 6963 616c 5375 7266   CylindricalSurf
+0002f800: 6163 652e 0d0a 0d0a 2020 2020 2020 2020  ace.....        
+0002f810: 5061 7261 6d65 7465 7273 0d0a 2020 2020  Parameters..    
+0002f820: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a      ----------..
+0002f830: 2020 2020 2020 2020 7265 7a20 3a20 696e          rez : in
+0002f840: 7465 6765 720d 0a20 2020 2020 2020 2020  teger..         
+0002f850: 2020 204e 756d 6265 7220 6f66 2072 6563     Number of rec
+0002f860: 7572 7369 7665 2073 7562 6469 7669 7369  ursive subdivisi
+0002f870: 6f6e 7320 6f66 2061 2074 7269 616e 6775  ons of a triangu
+0002f880: 6c61 7465 6420 6261 7365 2066 6163 6573  lated base faces
+0002f890: 2e0d 0a20 2020 2020 2020 200d 0a20 2020  ...        ..   
+0002f8a0: 2020 2020 2062 6173 6574 7970 6520 3a20       basetype : 
+0002f8b0: 7374 7269 6e67 0d0a 2020 2020 2020 2020  string..        
+0002f8c0: 2020 2020 5374 6172 7469 6e67 2073 7572      Starting sur
+0002f8d0: 6661 6365 2067 656f 6d65 7472 6965 7320  face geometries 
+0002f8e0: 6672 6f6d 2077 6869 6368 2074 6865 2073  from which the s
+0002f8f0: 7572 6661 6365 2077 6f75 6c64 2062 650d  urface would be.
+0002f900: 0a20 2020 2020 2020 2020 2020 2063 6f6e  .            con
+0002f910: 7374 7275 6374 6564 2075 7369 6e67 2072  structed using r
+0002f920: 6563 7572 7369 7665 2073 7562 6469 7669  ecursive subdivi
+0002f930: 7369 6f6e 7320 6f66 2074 6865 2074 7269  sions of the tri
+0002f940: 616e 6775 6c61 7220 6661 6365 732e 0d0a  angular faces...
+0002f950: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+0002f960: 2020 5265 7475 726e 730d 0a20 2020 2020    Returns..     
+0002f970: 2020 202d 2d2d 2d2d 2d2d 0d0a 2020 2020     -------..    
+0002f980: 2020 2020 6c69 7374 3a20 7468 6520 6e75      list: the nu
+0002f990: 6d62 6572 206f 6620 6661 6365 732c 2065  mber of faces, e
+0002f9a0: 6467 6573 2c20 616e 6420 7665 7274 6963  dges, and vertic
+0002f9b0: 6573 2e0d 0a0d 0a20 2020 2020 2020 2022  es.....        "
+0002f9c0: 2222 0d0a 2020 2020 2020 2020 6966 2069  ""..        if i
+0002f9d0: 7369 6e73 7461 6e63 6528 7265 7a2c 286c  sinstance(rez,(l
+0002f9e0: 6973 742c 7475 706c 6529 2920 3a20 2320  ist,tuple)) : # 
+0002f9f0: 6368 6563 6b20 666f 7220 7269 6e67 2e2e  check for ring..
+0002fa00: 2e0d 0a20 2020 2020 2020 2020 2020 206e  ...            n
+0002fa10: 7665 7220 3d20 7265 7a5b 305d 0d0a 2020  ver = rez[0]..  
+0002fa20: 2020 2020 2020 2020 2020 6e61 6e67 203d            nang =
+0002fa30: 2072 657a 5b31 5d0d 0a20 2020 2020 2020   rez[1]..       
+0002fa40: 2020 2020 2023 206f 6e6c 7920 6368 6563       # only chec
+0002fa50: 6b20 6973 2065 6e64 696e 6720 696e 2073  k is ending in s
+0002fa60: 0d0a 2020 2020 2020 2020 2020 2020 6973  ..            is
+0002fa70: 5370 6c69 7420 3d20 6261 7365 7479 7065  Split = basetype
+0002fa80: 5b20 6c65 6e28 6261 7365 7479 7065 292d  [ len(basetype)-
+0002fa90: 315d 203d 3d20 2773 270d 0a20 2020 2020  1] == 's'..     
+0002faa0: 2020 2020 2020 2066 203d 2032 2a6e 7665         f = 2*nve
+0002fab0: 722a 6e61 6e67 0d0a 2020 2020 2020 2020  r*nang..        
+0002fac0: 2020 2020 6520 3d20 332a 6e76 6572 2a6e      e = 3*nver*n
+0002fad0: 616e 6720 2b20 6e61 6e67 0d0a 2020 2020  ang + nang..    
+0002fae0: 2020 2020 2020 2020 7620 3d20 286e 7665          v = (nve
+0002faf0: 7220 2b20 3129 2a6e 616e 670d 0a20 2020  r + 1)*nang..   
+0002fb00: 2020 2020 2020 2020 2069 6620 6973 5370           if isSp
+0002fb10: 6c69 7420 3a0d 0a20 2020 2020 2020 2020  lit :..         
+0002fb20: 2020 2020 2020 2065 202b 3d20 6e76 6572         e += nver
+0002fb30: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0002fb40: 2020 7620 2b3d 206e 7665 7220 2b20 310d    v += nver + 1.
+0002fb50: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0002fb60: 7572 6e20 5b66 2c65 2c76 5d20 2020 2020  urn [f,e,v]     
+0002fb70: 2020 2020 2020 0d0a 0d0a 2020 2020 2020        ....      
+0002fb80: 2020 7265 7475 726e 2073 7570 6572 2829    return super()
+0002fb90: 2e5f 6665 7628 7265 7a2c 6261 7365 7479  ._fev(rez,basety
+0002fba0: 7065 2c63 6c73 290d 0a20 2020 2020 2020  pe,cls)..       
+0002fbb0: 2020 2020 2020 2020 0d0a 2020 2020 6465          ..    de
+0002fbc0: 6620 5f5f 696e 6974 5f5f 2873 656c 662c  f __init__(self,
+0002fbd0: 2072 657a 3d30 2c20 6261 7365 7479 7065   rez=0, basetype
+0002fbe0: 3d4e 6f6e 652c 206e 616d 653d 4e6f 6e65  =None, name=None
+0002fbf0: 2c20 2a2a 6b77 6172 6773 293a 0d0a 2020  , **kwargs):..  
+0002fc00: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
+0002fc10: 2020 2043 7265 6174 6520 6379 6c69 6e64     Create cylind
+0002fc20: 7269 6361 6c20 7375 7266 6163 6520 6f66  rical surface of
+0002fc30: 2075 6e69 7420 7261 6469 7573 2061 6e64   unit radius and
+0002fc40: 206c 656e 6774 6820 322e 0d0a 0d0a 2020   length 2.....  
+0002fc50: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+0002fc60: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
+0002fc70: 2d2d 2d2d 0d0a 2020 2020 2020 2020 7265  ----..        re
+0002fc80: 7a20 3a20 696e 7465 6765 722c 206f 7074  z : integer, opt
+0002fc90: 696f 6e61 6c2c 2064 6566 6175 6c74 3a20  ional, default: 
+0002fca0: 300d 0a20 2020 2020 2020 2020 2020 204e  0..            N
+0002fcb0: 756d 6265 7220 6f66 2072 6563 7572 7369  umber of recursi
+0002fcc0: 7665 2073 7562 6469 7669 7369 6f6e 7320  ve subdivisions 
+0002fcd0: 6f66 2074 6865 2074 7269 616e 6775 6c61  of the triangula
+0002fce0: 7465 6420 6261 7365 2066 6163 6573 2e0d  ted base faces..
+0002fcf0: 0a20 2020 2020 2020 2020 2020 2052 657a  .            Rez
+0002fd00: 2076 616c 7565 7320 7261 6e67 6520 6672   values range fr
+0002fd10: 6f6d 2030 2074 6f20 372e 0d0a 2020 2020  om 0 to 7...    
+0002fd20: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+0002fd30: 2020 6261 7365 7479 7065 203a 207b 2774    basetype : {'t
+0002fd40: 7269 272c 2773 7175 272c 2774 7269 3227  ri','squ','tri2'
+0002fd50: 2c27 7371 7532 272c 2774 7269 5f73 272c  ,'squ2','tri_s',
+0002fd60: 2773 7175 5f73 272c 2027 7472 695f 7627  'squ_s', 'tri_v'
+0002fd70: 2c27 7371 755f 7627 2c27 7472 6932 5f76  ,'squ_v','tri2_v
+0002fd80: 272c 2773 7175 325f 7627 2c27 7472 695f  ','squ2_v','tri_
+0002fd90: 7376 272c 2773 7175 5f73 7627 7d2c 206f  sv','squ_sv'}, o
+0002fda0: 7074 696f 6e61 6c2c 2064 6566 6175 6c74  ptional, default
+0002fdb0: 3a20 2774 7269 270d 0a20 2020 2020 2020  : 'tri'..       
+0002fdc0: 2020 2020 2053 7461 7274 696e 6720 7375       Starting su
+0002fdd0: 7266 6163 6520 6765 6f6d 6574 7269 6573  rface geometries
+0002fde0: 2066 726f 6d20 7768 6963 6820 7468 6520   from which the 
+0002fdf0: 7375 7266 6163 6520 6973 0d0a 2020 2020  surface is..    
+0002fe00: 2020 2020 2020 2020 636f 6e73 7472 7563          construc
+0002fe10: 7465 6420 7573 696e 6720 7265 6375 7273  ted using recurs
+0002fe20: 6976 6520 7375 6264 6976 6973 696f 6e73  ive subdivisions
+0002fe30: 206f 6620 7468 6520 7472 6961 6e67 756c   of the triangul
+0002fe40: 6172 2066 6163 6573 2e0d 0a0d 0a20 2020  ar faces.....   
+0002fe50: 2020 2020 206e 616d 6520 3a20 7374 7269       name : stri
+0002fe60: 6e67 2c20 6f70 7469 6f6e 616c 2c20 6465  ng, optional, de
+0002fe70: 6661 756c 743a 204e 6f6e 652e 0d0a 2020  fault: None...  
+0002fe80: 2020 2020 2020 2020 2020 4465 7363 7269            Descri
+0002fe90: 7074 6976 6520 6964 656e 7469 6669 6572  ptive identifier
+0002fea0: 2066 6f72 2074 6865 2067 656f 6d65 7472   for the geometr
+0002feb0: 792e 0d0a 0d0a 2020 2020 2020 2020 5261  y.....        Ra
+0002fec0: 6973 6573 0d0a 2020 2020 2020 2020 2d2d  ises..        --
+0002fed0: 2d2d 2d2d 0d0a 2020 2020 2020 2020 5661  ----..        Va
+0002fee0: 6c75 6545 7272 6f72 0d0a 2020 2020 2020  lueError..      
+0002fef0: 2020 2020 2020 4966 2072 657a 2069 7320        If rez is 
+0002ff00: 6e6f 7420 616e 2069 6e74 6567 6572 2069  not an integer i
+0002ff10: 6e20 7261 6e67 6520 3020 746f 2037 2e0d  n range 0 to 7..
+0002ff20: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
+0002ff30: 6261 7365 7479 7065 2069 7320 6e6f 7420  basetype is not 
+0002ff40: 7265 636f 676e 697a 6564 2066 6f72 2074  recognized for t
+0002ff50: 6869 7320 7375 7266 6163 6520 636f 6e73  his surface cons
+0002ff60: 7472 7563 746f 722e 0d0a 0d0a 2020 2020  tructor.....    
+0002ff70: 2020 2020 4f74 6865 7220 5061 7261 6d65      Other Parame
+0002ff80: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
+0002ff90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a  --------------..
+0002ffa0: 2020 2020 2020 2020 2a2a 6b77 6172 6773          **kwargs
+0002ffb0: 0d0a 2020 2020 2020 2020 2020 2020 416c  ..            Al
+0002ffc0: 6c20 6f74 6865 7220 7061 7261 6d65 7465  l other paramete
+0002ffd0: 7273 2061 7265 2070 6173 7365 6420 6f6e  rs are passed on
+0002ffe0: 2074 6f20 2773 3364 6c69 622e 7375 7266   to 's3dlib.surf
+0002fff0: 6163 652e 5375 7266 6163 6533 4443 6f6c  ace.Surface3DCol
+00030000: 6c65 6374 696f 6e27 2e0d 0a20 2020 2020  lection'...     
+00030010: 2020 200d 0a20 2020 2020 2020 2022 2222     ..        """
+00030020: 0d0a 0d0a 2020 2020 2020 2020 6966 206e  ....        if n
+00030030: 6f74 2069 7369 6e73 7461 6e63 6528 7265  ot isinstance(re
+00030040: 7a2c 2069 6e74 2920 3a0d 0a20 2020 2020  z, int) :..     
+00030050: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+00030060: 7565 4572 726f 7228 2749 6e63 6f72 7265  ueError('Incorre
+00030070: 6374 2072 657a 2074 7970 652c 206d 7573  ct rez type, mus
+00030080: 7420 6261 206f 6620 7479 7065 2069 6e74  t ba of type int
+00030090: 2729 0d0a 2020 2020 2020 2020 6966 2028  ')..        if (
+000300a0: 7265 7a3c 3029 206f 7220 2872 657a 3e5f  rez<0) or (rez>_
+000300b0: 4d41 5852 455a 2920 3a0d 0a20 2020 2020  MAXREZ) :..     
+000300c0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+000300d0: 7565 4572 726f 7228 2749 6e63 6f72 7265  ueError('Incorre
+000300e0: 7374 2072 657a 206f 6620 7b7d 2c20 6d75  st rez of {}, mu
+000300f0: 7374 2062 6520 616e 2069 6e74 2c20 3020  st be an int, 0 
+00030100: 3c3d 2072 657a 203c 3d20 7b7d 272e 666f  <= rez <= {}'.fo
+00030110: 726d 6174 2872 657a 2c5f 4d41 5852 455a  rmat(rez,_MAXREZ
+00030120: 2929 0d0a 2020 2020 2020 2020 6966 2062  ))..        if b
+00030130: 6173 6574 7970 6520 6973 204e 6f6e 6520  asetype is None 
+00030140: 3a20 6261 7365 7479 7065 203d 2073 656c  : basetype = sel
+00030150: 662e 5f64 6566 6175 6c74 5f62 6173 650d  f._default_base.
+00030160: 0a20 2020 2020 2020 2069 6620 6261 7365  .        if base
+00030170: 7479 7065 206e 6f74 2069 6e20 7365 6c66  type not in self
+00030180: 2e5f 6261 7365 5f73 7572 6661 6365 7320  ._base_surfaces 
+00030190: 3a0d 0a20 2020 2020 2020 2020 2020 2072  :..            r
+000301a0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+000301b0: 2742 6173 6574 7970 6520 7b7d 2069 7320  'Basetype {} is 
+000301c0: 6e6f 7420 7265 636f 676e 697a 6564 2e20  not recognized. 
+000301d0: 506f 7373 6962 6c65 2076 616c 7565 7320  Possible values 
+000301e0: 6172 653a 207b 7d27 2e66 6f72 6d61 7428  are: {}'.format(
+000301f0: 6261 7365 7479 7065 2c6c 6973 7428 7365  basetype,list(se
+00030200: 6c66 2e5f 6261 7365 5f73 7572 6661 6365  lf._base_surface
+00030210: 7329 2929 0d0a 2020 2020 2020 2020 6261  s)))..        ba
+00030220: 7365 5375 7266 4f62 6a20 3d20 7365 6c66  seSurfObj = self
+00030230: 2e5f 6261 7365 5f73 7572 6661 6365 735b  ._base_surfaces[
+00030240: 6261 7365 7479 7065 5d0d 0a20 2020 2020  basetype]..     
+00030250: 2020 2062 6173 6556 636f 6f72 203d 2062     baseVcoor = b
+00030260: 6173 6553 7572 664f 626a 5b27 6261 7365  aseSurfObj['base
+00030270: 5665 7274 6963 6573 436f 6f72 275d 0d0a  VerticesCoor']..
+00030280: 2020 2020 2020 2020 6261 7365 4661 6365          baseFace
+00030290: 5665 7274 6578 496e 6469 6365 7320 3d62  VertexIndices =b
+000302a0: 6173 6553 7572 664f 626a 5b27 6261 7365  aseSurfObj['base
+000302b0: 4661 6365 496e 6469 6365 7327 5d0d 0a20  FaceIndices'].. 
+000302c0: 2020 2020 2020 2069 6e64 6578 4f62 6a2c         indexObj,
+000302d0: 7665 7274 6578 436f 6f72 203d 2073 656c  vertexCoor = sel
+000302e0: 662e 7472 6961 6e67 756c 6174 6542 6173  f.triangulateBas
+000302f0: 6528 7265 7a2c 6261 7365 5663 6f6f 722c  e(rez,baseVcoor,
+00030300: 6261 7365 4661 6365 5665 7274 6578 496e  baseFaceVertexIn
+00030310: 6469 6365 732c 2073 656c 662e 5f6d 6964  dices, self._mid
+00030320: 5665 6374 6f72 4675 6e29 0d0a 2020 2020  VectorFun)..    
+00030330: 2020 2020 6661 6365 496e 6469 6365 7320      faceIndices 
+00030340: 3d20 696e 6465 784f 626a 5b27 6661 6365  = indexObj['face
+00030350: 275d 0d0a 0d0a 2020 2020 2020 2020 7375  ']....        su
+00030360: 7065 7228 292e 5f5f 696e 6974 5f5f 2876  per().__init__(v
+00030370: 6572 7465 7843 6f6f 722c 2066 6163 6549  ertexCoor, faceI
+00030380: 6e64 6963 6573 2c20 6e61 6d65 2c20 2a2a  ndices, name, **
+00030390: 6b77 6172 6773 290d 0a0d 0a20 2020 2020  kwargs)....     
+000303a0: 2020 2073 656c 662e 636f 6f72 5479 7065     self.coorType
+000303b0: 203d 205f 434f 4f52 5359 535b 2243 594c   = _COORSYS["CYL
+000303c0: 494e 4452 4943 414c 225d 0d0a 2020 2020  INDRICAL"]..    
+000303d0: 2020 2020 7365 6c66 2e5f 6e6f 726d 616c      self._normal
+000303e0: 5f73 6361 6c65 203d 2020 5f6e 6f72 6d4c  _scale =  _normL
+000303f0: 656e 6774 6828 206c 656e 2866 6163 6549  ength( len(faceI
+00030400: 6e64 6963 6573 292c 2031 2e31 342c 2031  ndices), 1.14, 1
+00030410: 2e33 3129 0d0a 2020 2020 2020 2020 7365  .31)..        se
+00030420: 6c66 2e5f 7265 7a20 3d20 7265 7a0d 0a20  lf._rez = rez.. 
+00030430: 2020 2020 2020 2073 656c 662e 5f62 6173         self._bas
+00030440: 6574 7970 6520 3d20 6261 7365 7479 7065  etype = basetype
+00030450: 0d0a 2020 2020 2020 2020 7365 6c66 2e64  ..        self.d
+00030460: 6973 705f 5665 6374 6f72 203d 206e 702e  isp_Vector = np.
+00030470: 6172 7261 7928 205b 312c 312c 305d 2029  array( [1,1,0] )
+00030480: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00030490: 204e 6f6e 650d 0a0d 0a20 2020 2064 6566   None....    def
+000304a0: 2064 6f6d 6169 6e28 7365 6c66 2c20 7261   domain(self, ra
+000304b0: 6469 7573 3d4e 6f6e 652c 207a 6c69 6d3d  dius=None, zlim=
+000304c0: 4e6f 6e65 2920 3a0d 0a20 2020 2020 2020  None) :..       
+000304d0: 2022 2222 0d0a 2020 2020 2020 2020 5365   """..        Se
+000304e0: 7420 7468 6520 646f 6d61 696e 206f 6620  t the domain of 
+000304f0: 7468 6520 6379 6c69 6e64 7269 6361 6c20  the cylindrical 
+00030500: 7375 7266 6163 652e 0d0a 0d0a 2020 2020  surface.....    
+00030510: 2020 2020 5573 6564 2066 6f72 2073 6574      Used for set
+00030520: 7469 6e67 2074 6865 206c 696d 6974 7320  ting the limits 
+00030530: 6f66 2074 6865 2062 6173 6520 6379 6c69  of the base cyli
+00030540: 6e64 6572 2e0d 0a0d 0a20 2020 2020 2020  nder.....       
+00030550: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
+00030560: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
+00030570: 0a20 2020 2020 2020 2072 6164 6975 733a  .        radius:
+00030580: 206e 756d 6265 722c 2064 6566 6175 6c74   number, default
+00030590: 203a 2031 0d0a 2020 2020 2020 2020 2020   : 1..          
+000305a0: 2020 5261 6469 7573 206f 6620 7468 6520    Radius of the 
+000305b0: 6379 6c69 6e64 7269 6361 6c20 7375 7266  cylindrical surf
+000305c0: 6163 652e 0d0a 2020 2020 2020 2020 2020  ace...          
+000305d0: 2020 4966 2073 6574 2074 6f20 4e6f 6e65    If set to None
+000305e0: 2c20 7468 6520 646f 6d61 696e 2069 7320  , the domain is 
+000305f0: 756e 6368 616e 6765 642e 0d0a 0d0a 2020  unchanged.....  
+00030600: 2020 2020 2020 7a6c 696d 203a 2032 6420        zlim : 2d 
+00030610: 6172 7261 790d 0a20 2020 2020 2020 2020  array..         
+00030620: 2020 204d 696e 696d 756d 2061 6e64 206d     Minimum and m
+00030630: 6178 696d 756d 2076 616c 7565 7320 6f66  aximum values of
+00030640: 2074 6865 2061 7272 6179 7320 6172 6520   the arrays are 
+00030650: 7573 6564 2074 6f20 7363 616c 650d 0a20  used to scale.. 
+00030660: 2020 2020 2020 2020 2020 2061 6e64 2074             and t
+00030670: 7261 6e73 6c61 7465 2074 6865 2073 7572  ranslate the sur
+00030680: 6661 6365 2066 726f 6d20 616e 2069 6e74  face from an int
+00030690: 6961 6c20 646f 6d61 696e 206f 660d 0a20  ial domain of.. 
+000306a0: 2020 2020 2020 2020 2020 205b 202d 312c             [ -1,
+000306b0: 2031 205d 0d0a 2020 2020 2020 2020 2020   1 ]..          
+000306c0: 2020 4966 2073 6574 2074 6f20 4e6f 6e65    If set to None
+000306d0: 2c20 7468 6520 5a2d 646f 6d61 696e 2069  , the Z-domain i
+000306e0: 7320 756e 6368 616e 6765 642e 0d0a 0d0a  s unchanged.....
+000306f0: 2020 2020 2020 2020 5265 7475 726e 730d          Returns.
+00030700: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00030710: 0d0a 2020 2020 2020 2020 7365 6c66 203a  ..        self :
+00030720: 2043 796c 696e 6472 6963 616c 5375 7266   CylindricalSurf
+00030730: 6163 6520 6f62 6a65 6374 0d0a 0d0a 2020  ace object....  
+00030740: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
+00030750: 2020 2064 6566 2073 6574 446f 6d61 696e     def setDomain
+00030760: 2872 747a 2c20 6d72 2c20 6d7a 2c62 7a29  (rtz, mr, mz,bz)
+00030770: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
+00030780: 722c 742c 7a20 3d20 7274 7a0d 0a20 2020  r,t,z = rtz..   
+00030790: 2020 2020 2020 2020 2052 203d 206d 722a           R = mr*
+000307a0: 720d 0a20 2020 2020 2020 2020 2020 205a  r..            Z
+000307b0: 203d 206d 7a2a 7a20 2b20 627a 0d0a 2020   = mz*z + bz..  
+000307c0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+000307d0: 2052 2c74 2c5a 2020 2020 2020 200d 0a20   R,t,Z       .. 
+000307e0: 2020 2020 2020 2064 6566 2067 6574 436f         def getCo
+000307f0: 6e74 5f72 286c 696d 7329 203a 0d0a 2020  nt_r(lims) :..  
+00030800: 2020 2020 2020 2020 2020 6d20 3d20 312e            m = 1.
+00030810: 300d 0a20 2020 2020 2020 2020 2020 2069  0..            i
+00030820: 6620 6c69 6d73 2069 7320 6e6f 7420 4e6f  f lims is not No
+00030830: 6e65 203a 206d 203d 206c 696d 730d 0a20  ne : m = lims.. 
+00030840: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00030850: 6e20 6d0d 0a20 2020 2020 2020 2064 6566  n m..        def
+00030860: 2067 6574 436f 6e74 2820 6c69 6d73 2029   getCont( lims )
+00030870: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
+00030880: 6d2c 2062 203d 2031 2e30 2c20 302e 300d  m, b = 1.0, 0.0.
+00030890: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+000308a0: 6c69 6d73 2069 7320 6e6f 7420 4e6f 6e65  lims is not None
+000308b0: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
+000308c0: 2020 2020 2320 616c 6c6f 7720 7369 6e67      # allow sing
+000308d0: 6c65 2062 6e64 7279 2074 6f20 6265 2069  le bndry to be i
+000308e0: 6e70 7574 2061 7320 6120 666c 6f61 740d  nput as a float.
+000308f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00030900: 2069 6620 6973 696e 7374 616e 6365 286c   if isinstance(l
+00030910: 696d 732c 2028 696e 742c 666c 6f61 7429  ims, (int,float)
+00030920: 2920 3a20 6c69 6d73 203d 205b 2d6c 696d  ) : lims = [-lim
+00030930: 732c 6c69 6d73 5d0d 0a20 2020 2020 2020  s,lims]..       
+00030940: 2020 2020 2020 2020 206d 2c20 6220 3d20           m, b = 
+00030950: 302e 352a 286c 696d 735b 315d 2d6c 696d  0.5*(lims[1]-lim
+00030960: 735b 305d 2920 2c20 302e 352a 286c 696d  s[0]) , 0.5*(lim
+00030970: 735b 315d 2b6c 696d 735b 305d 290d 0a20  s[1]+lims[0]).. 
+00030980: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00030990: 6e20 6d2c 2062 0d0a 2020 2020 2020 2020  n m, b..        
+000309a0: 6d72 203d 2067 6574 436f 6e74 5f72 2872  mr = getCont_r(r
+000309b0: 6164 6975 7329 0d0a 2020 2020 2020 2020  adius)..        
+000309c0: 6d7a 2c20 627a 203d 2067 6574 436f 6e74  mz, bz = getCont
+000309d0: 287a 6c69 6d29 0d0a 2020 2020 2020 2020  (zlim)..        
+000309e0: 7365 6c66 2e6d 6170 5f67 656f 6d5f 6672  self.map_geom_fr
+000309f0: 6f6d 5f6f 7028 6c61 6d62 6461 2041 203a  om_op(lambda A :
+00030a00: 2073 6574 446f 6d61 696e 2841 2c20 6d72   setDomain(A, mr
+00030a10: 2c20 6d7a 2c62 7a29 290d 0a20 2020 2020  , mz,bz))..     
+00030a20: 2020 2072 6574 7572 6e20 7365 6c66 0d0a     return self..
+00030a30: 0d0a 636c 6173 7320 5370 6865 7269 6361  ..class Spherica
+00030a40: 6c53 7572 6661 6365 2853 7572 6661 6365  lSurface(Surface
+00030a50: 3344 436f 6c6c 6563 7469 6f6e 2920 3a0d  3DCollection) :.
+00030a60: 0a20 2020 2022 2222 0d0a 2020 2020 5370  .    """..    Sp
+00030a70: 6865 7269 6361 6c20 3344 2073 7572 6661  herical 3D surfa
+00030a80: 6365 2069 6e20 7370 6865 7269 6361 6c20  ce in spherical 
+00030a90: 636f 6f72 6469 6e61 7465 732e 0d0a 0d0a  coordinates.....
+00030aa0: 2020 2020 4d65 7468 6f64 7320 6172 6520      Methods are 
+00030ab0: 696e 6865 7269 7465 6420 6672 6f6d 2074  inherited from t
+00030ac0: 6865 2053 7572 6661 6365 3344 436f 6c6c  he Surface3DColl
+00030ad0: 6563 7469 6f6e 2e0d 0a20 2020 2053 7068  ection...    Sph
+00030ae0: 6572 6963 616c 2073 7572 6661 6365 2067  erical surface g
+00030af0: 656f 6d65 7472 6965 7320 6172 6520 6372  eometries are cr
+00030b00: 6561 7465 6420 696e 2074 6869 7320 7375  eated in this su
+00030b10: 6263 6c61 7373 2e0d 0a0d 0a20 2020 2022  bclass.....    "
+00030b20: 2222 0d0a 0d0a 2020 2020 4073 7461 7469  ""....    @stati
+00030b30: 636d 6574 686f 640d 0a20 2020 2064 6566  cmethod..    def
+00030b40: 2072 616e 6428 7265 7a3d 302c 7365 6564   rand(rez=0,seed
+00030b50: 3d4e 6f6e 652c 6e61 6d65 3d4e 6f6e 652c  =None,name=None,
+00030b60: 6b69 6e64 3d4e 6f6e 652c 2a2a 6b61 7267  kind=None,**karg
+00030b70: 7329 203a 0d0a 2020 2020 2020 2020 2222  s) :..        ""
+00030b80: 220d 0a20 2020 2020 2020 2053 7068 6572  "..        Spher
+00030b90: 6963 616c 5375 7266 6163 6520 7769 7468  icalSurface with
+00030ba0: 2072 616e 646f 6d20 7472 6961 6e67 756c   random triangul
+00030bb0: 6172 2066 6163 6573 2e0d 0a0d 0a20 2020  ar faces.....   
+00030bc0: 2020 2020 2050 6172 616d 6574 6572 730d       Parameters.
+00030bd0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00030be0: 2d2d 2d0d 0a20 2020 2020 2020 2072 657a  ---..        rez
+00030bf0: 203a 206e 756d 6265 722c 206f 7074 696f   : number, optio
+00030c00: 6e61 6c2c 2064 6566 6175 6c74 3a20 300d  nal, default: 0.
+00030c10: 0a20 2020 2020 2020 2020 2020 204e 756d  .            Num
+00030c20: 6265 7220 6f66 2027 7265 6375 7273 6976  ber of 'recursiv
+00030c30: 6527 2073 7562 6469 7669 7369 6f6e 7320  e' subdivisions 
+00030c40: 6f66 2074 6865 2074 7269 616e 6775 6c61  of the triangula
+00030c50: 7465 6420 6261 7365 2066 6163 6573 2e0d  ted base faces..
+00030c60: 0a20 2020 2020 2020 2020 2020 2052 657a  .            Rez
+00030c70: 2076 616c 7565 7320 7261 6e67 6520 6672   values range fr
+00030c80: 6f6d 2030 2074 6f20 372e 0d0a 0d0a 2020  om 0 to 7.....  
+00030c90: 2020 2020 2020 7365 6564 203a 2069 6e74        seed : int
+00030ca0: 6567 6572 2c20 6f70 7469 6f6e 616c 2c20  eger, optional, 
+00030cb0: 6465 6661 756c 743a 204e 6f6e 650d 0a20  default: None.. 
+00030cc0: 2020 2020 2020 2020 2020 2041 6e20 696e             An in
+00030cd0: 6974 6961 6c69 7a61 7469 6f6e 2073 6565  itialization see
+00030ce0: 6420 666f 7220 7261 6e64 6f6d 2067 656e  d for random gen
+00030cf0: 6572 6174 696f 6e2e 0d0a 0d0a 2020 2020  eration.....    
+00030d00: 2020 2020 6e61 6d65 203a 2073 7472 696e      name : strin
+00030d10: 672c 206f 7074 696f 6e61 6c2c 2064 6566  g, optional, def
+00030d20: 6175 6c74 3a20 4e6f 6e65 2e0d 0a20 2020  ault: None...   
+00030d30: 2020 2020 2020 2020 2044 6573 6372 6970           Descrip
+00030d40: 7469 7665 2069 6465 6e74 6966 6965 7220  tive identifier 
+00030d50: 666f 7220 7468 6520 6765 6f6d 6574 7279  for the geometry
+00030d60: 2e0d 0a0d 0a20 2020 2020 2020 206b 696e  .....        kin
+00030d70: 6420 3a20 7374 7269 6e67 2c20 6f70 7469  d : string, opti
+00030d80: 6f6e 616c 2c20 6465 6661 756c 743a 204e  onal, default: N
+00030d90: 6f6e 650d 0a20 2020 2020 2020 2020 2020  one..           
+00030da0: 2028 7265 7365 7276 6564 2c20 6e6f 7420   (reserved, not 
+00030db0: 696d 706c 656d 656e 7465 6429 200d 0a0d  implemented) ...
+00030dc0: 0a20 2020 2020 2020 2052 6169 7365 730d  .        Raises.
+00030dd0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d0d  .        ------.
+00030de0: 0a20 2020 2020 2020 2056 616c 7565 4572  .        ValueEr
+00030df0: 726f 720d 0a20 2020 2020 2020 2020 2020  ror..           
+00030e00: 2049 6620 7265 7a20 6973 206e 6f74 2061   If rez is not a
+00030e10: 6e20 696e 7465 6765 7220 696e 2072 616e  n integer in ran
+00030e20: 6765 2030 2074 6f20 372e 0d0a 2020 2020  ge 0 to 7...    
+00030e30: 2020 2020 2020 2020 4966 2062 6173 6574          If baset
+00030e40: 7970 6520 6973 206e 6f74 2072 6563 6f67  ype is not recog
+00030e50: 6e69 7a65 6420 666f 7220 7468 6973 2073  nized for this s
+00030e60: 7572 6661 6365 2063 6f6e 7374 7275 6374  urface construct
+00030e70: 6f72 2e0d 0a0d 0a20 2020 2020 2020 204f  or.....        O
+00030e80: 7468 6572 2050 6172 616d 6574 6572 730d  ther Parameters.
+00030e90: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00030ea0: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
+00030eb0: 2020 202a 2a6b 7761 7267 730d 0a20 2020     **kwargs..   
+00030ec0: 2020 2020 2020 2020 2041 6c6c 206f 7468           All oth
+00030ed0: 6572 2070 6172 616d 6574 6572 7320 6172  er parameters ar
+00030ee0: 6520 7061 7373 6564 206f 6e20 746f 2027  e passed on to '
+00030ef0: 7333 646c 6962 2e73 7572 6661 6365 2e53  s3dlib.surface.S
+00030f00: 7572 6661 6365 3344 436f 6c6c 6563 7469  urface3DCollecti
+00030f10: 6f6e 272e 0d0a 2020 2020 2020 2020 0d0a  on'...        ..
+00030f20: 2020 2020 2020 2020 5265 7475 726e 730d          Returns.
+00030f30: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00030f40: 0d0a 2020 2020 2020 2020 7375 7266 6163  ..        surfac
+00030f50: 6520 3a20 5370 6865 7269 6361 6c53 7572  e : SphericalSur
+00030f60: 6661 6365 206f 626a 6563 742e 0d0a 0d0a  face object.....
+00030f70: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
+00030f80: 2020 2020 2023 2e2e 2e2e 2e2e 2e2e 2e2e       #..........
+00030f90: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00030fa0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00030fb0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e0d  ................
+00030fc0: 0a20 2020 2020 2020 2064 6566 2072 616e  .        def ran
+00030fd0: 646f 6d5f 7369 6e44 6973 7428 7369 7a65  dom_sinDist(size
+00030fe0: 2920 3a0d 0a20 2020 2020 2020 2020 2020  ) :..           
+00030ff0: 206e 4c6f 6f70 2c6e 436f 6e74 726f 6c2c   nLoop,nControl,
+00031000: 7361 6d70 6c65 7320 3d20 302c 2031 302a  samples = 0, 10*
+00031010: 2a36 2c20 5b5d 0d0a 2020 2020 2020 2020  *6, []..        
+00031020: 2020 2020 7768 696c 6520 6c65 6e28 7361      while len(sa
+00031030: 6d70 6c65 7329 3c73 697a 6520 616e 6420  mples)<size and 
+00031040: 6e4c 6f6f 703c 6e43 6f6e 7472 6f6c 3a0d  nLoop<nControl:.
+00031050: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00031060: 2078 3d6e 702e 7261 6e64 6f6d 2e72 616e   x=np.random.ran
+00031070: 646f 6d5f 7361 6d70 6c65 2829 0d0a 2020  dom_sample()..  
+00031080: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+00031090: 6f62 3d6e 702e 7369 6e28 782a 6e70 2e70  ob=np.sin(x*np.p
+000310a0: 6929 2f32 0d0a 2020 2020 2020 2020 2020  i)/2..          
+000310b0: 2020 2020 2020 6173 7365 7274 2070 726f        assert pro
+000310c0: 623e 3d30 2061 6e64 2070 726f 623c 3d31  b>=0 and prob<=1
+000310d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000310e0: 2020 6966 206e 702e 7261 6e64 6f6d 2e72    if np.random.r
+000310f0: 616e 646f 6d5f 7361 6d70 6c65 2829 203c  andom_sample() <
+00031100: 3d70 726f 623a 2073 616d 706c 6573 202b  =prob: samples +
+00031110: 3d20 5b78 5d0d 0a20 2020 2020 2020 2020  = [x]..         
+00031120: 2020 2020 2020 206e 4c6f 6f70 2b3d 310d         nLoop+=1.
+00031130: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00031140: 7572 6e20 6e70 2e61 7272 6179 2873 616d  urn np.array(sam
+00031150: 706c 6573 290d 0a20 2020 2020 2020 2023  ples)..        #
+00031160: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00031170: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00031180: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00031190: 2e2e 2e2e 2e2e 2e2e 2e0d 0a0d 0a20 2020  .............   
+000311a0: 2020 2020 2069 6620 6e6f 7420 6973 696e       if not isin
+000311b0: 7374 616e 6365 2872 657a 2c20 2869 6e74  stance(rez, (int
+000311c0: 2c20 666c 6f61 7429 2920 3a0d 0a20 2020  , float)) :..   
+000311d0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+000311e0: 616c 7565 4572 726f 7228 2749 6e63 6f72  alueError('Incor
+000311f0: 7265 6374 2072 657a 2074 7970 652c 206d  rect rez type, m
+00031200: 7573 7420 6265 2061 206e 756d 6265 722e  ust be a number.
+00031210: 2729 0d0a 2020 2020 2020 2020 6966 2028  ')..        if (
+00031220: 7265 7a3c 3029 206f 7220 2872 657a 3e5f  rez<0) or (rez>_
+00031230: 4d41 5852 455a 2920 3a0d 0a20 2020 2020  MAXREZ) :..     
+00031240: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+00031250: 7565 4572 726f 7228 2749 6e63 6f72 7265  ueError('Incorre
+00031260: 7374 2072 657a 206f 6620 7b7d 2c20 6d75  st rez of {}, mu
+00031270: 7374 2062 6520 6120 6e75 6d62 6572 2c20  st be a number, 
+00031280: 3020 3c3d 2072 657a 203c 3d20 7b7d 272e  0 <= rez <= {}'.
+00031290: 666f 726d 6174 2872 657a 2c5f 4d41 5852  format(rez,_MAXR
+000312a0: 455a 2929 0d0a 0d0a 2020 2020 2020 2020  EZ))....        
+000312b0: 6966 2073 6565 6420 6973 206e 6f74 204e  if seed is not N
+000312c0: 6f6e 6520 3a0d 0a20 2020 2020 2020 2020  one :..         
+000312d0: 2020 2069 6620 6e6f 7420 6973 696e 7374     if not isinst
+000312e0: 616e 6365 2873 6565 642c 2069 6e74 2920  ance(seed, int) 
+000312f0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00031300: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+00031310: 726f 7228 2749 6e63 6f72 7265 6374 2073  ror('Incorrect s
+00031320: 6565 6420 7479 7065 2c20 6d75 7374 2062  eed type, must b
+00031330: 6120 6f66 2074 7970 6520 696e 7427 2920  a of type int') 
+00031340: 0d0a 2020 2020 2020 2020 2020 2020 6e70  ..            np
+00031350: 2e72 616e 646f 6d2e 7365 6564 2873 6565  .random.seed(see
+00031360: 6429 0d0a 0d0a 2020 2020 2020 2020 4e20  d)....        N 
+00031370: 3d20 696e 7428 3230 2a28 342a 2a72 657a  = int(20*(4**rez
+00031380: 292f 3220 2b20 3229 0d0a 2020 2020 2020  )/2 + 2)..      
+00031390: 2020 7220 3d20 6e70 2e6f 6e65 7328 204e    r = np.ones( N
+000313a0: 2029 0d0a 2020 2020 2020 2020 7420 3d20   )..        t = 
+000313b0: 322a 6e70 2e70 692a 6e70 2e72 616e 646f  2*np.pi*np.rando
+000313c0: 6d2e 7261 6e64 2820 4e20 290d 0a20 2020  m.rand( N )..   
+000313d0: 2020 2020 2070 203d 206e 702e 7069 2a72       p = np.pi*r
+000313e0: 616e 646f 6d5f 7369 6e44 6973 7428 204e  andom_sinDist( N
+000313f0: 2029 0d0a 2020 2020 2020 2020 6461 7461   )..        data
+00031400: 203d 2053 7068 6572 6963 616c 5375 7266   = SphericalSurf
+00031410: 6163 652e 636f 6f72 5f63 6f6e 7665 7274  ace.coor_convert
+00031420: 285b 722c 742c 705d 2c54 7275 6529 2e54  ([r,t,p],True).T
+00031430: 0d0a 2020 2020 2020 2020 6875 6c6c 7375  ..        hullsu
+00031440: 7266 203d 2053 7572 6661 6365 3344 436f  rf = Surface3DCo
+00031450: 6c6c 6563 7469 6f6e 2e63 6875 6c6c 2864  llection.chull(d
+00031460: 6174 6129 0d0a 0d0a 2020 2020 2020 2020  ata)....        
+00031470: 6966 206e 616d 6520 6973 204e 6f6e 6520  if name is None 
+00031480: 3a20 6e61 6d65 203d 2027 7261 6e64 6f6d  : name = 'random
+00031490: 206d 6573 6827 0d0a 2020 2020 2020 2020   mesh'..        
+000314a0: 7375 7266 6163 6520 3d20 5370 6865 7269  surface = Spheri
+000314b0: 6361 6c53 7572 6661 6365 286e 616d 653d  calSurface(name=
+000314c0: 6e61 6d65 2c2a 2a6b 6172 6773 2920 2023  name,**kargs)  #
+000314d0: 2073 6574 2074 6f20 7468 6520 636c 6173   set to the clas
+000314e0: 7320 6465 6661 756c 7420 6f62 6a65 6374  s default object
+000314f0: 0d0a 2020 2020 2020 2020 2320 7265 7365  ..        # rese
+00031500: 7420 7665 7274 732c 2066 6163 6549 6e64  t verts, faceInd
+00031510: 6963 6573 2061 6e64 2065 6467 6573 2028  ices and edges (
+00031520: 7265 7461 696e 2063 6c61 7373 2063 6f6f  retain class coo
+00031530: 7264 696e 6174 6520 7379 7374 656d 292e  rdinate system).
+00031540: 0d0a 2020 2020 2020 2020 7665 7274 7320  ..        verts 
+00031550: 3d20 6875 6c6c 7375 7266 2e76 6572 7465  = hullsurf.verte
+00031560: 7843 6f6f 720d 0a20 2020 2020 2020 2066  xCoor..        f
+00031570: 6163 6549 6e64 6963 6573 203d 2068 756c  aceIndices = hul
+00031580: 6c73 7572 662e 6676 496e 6469 6365 730d  lsurf.fvIndices.
+00031590: 0a0d 0a20 2020 2020 2020 2073 7572 6661  ...        surfa
+000315a0: 6365 2e76 6572 7465 7843 6f6f 7220 3d20  ce.vertexCoor = 
+000315b0: 7665 7274 730d 0a20 2020 2020 2020 2073  verts..        s
+000315c0: 7572 6661 6365 2e66 7649 6e64 6963 6573  urface.fvIndices
+000315d0: 203d 2066 6163 6549 6e64 6963 6573 0d0a   = faceIndices..
+000315e0: 2020 2020 2020 2020 7375 7266 6163 652e          surface.
+000315f0: 6576 496e 6469 6365 7320 3d20 7375 7266  evIndices = surf
+00031600: 6163 652e 5f67 6574 5f65 6467 6573 5f66  ace._get_edges_f
+00031610: 726f 6d5f 6661 6365 7328 6661 6365 496e  rom_faces(faceIn
+00031620: 6469 6365 7329 0d0a 2020 2020 2020 2020  dices)..        
+00031630: 7375 7266 6163 652e 7666 496e 6469 6365  surface.vfIndice
+00031640: 734c 6973 7420 3d20 7375 7266 6163 652e  sList = surface.
+00031650: 5f76 6572 7465 7843 6f6d 6d6f 6e46 6163  _vertexCommonFac
+00031660: 6549 6e64 6963 6573 2829 0d0a 2020 2020  eIndices()..    
+00031670: 2020 2020 7375 7266 6163 652e 6566 496e      surface.efIn
+00031680: 6469 6365 734c 6973 7420 3d20 7375 7266  dicesList = surf
+00031690: 6163 652e 5f65 6467 6543 6f6d 6d6f 6e46  ace._edgeCommonF
+000316a0: 6163 6549 6e64 6963 6573 2829 0d0a 2020  aceIndices()..  
+000316b0: 2020 2020 2020 7375 7266 6163 652e 7365        surface.se
+000316c0: 745f 7665 7274 7328 2076 6572 7473 5b66  t_verts( verts[f
+000316d0: 6163 6549 6e64 6963 6573 5d20 290d 0a20  aceIndices] ).. 
+000316e0: 2020 2020 2020 2073 7572 6661 6365 2e5f         surface._
+000316f0: 7365 745f 6765 6f6d 6574 7269 635f 626f  set_geometric_bo
+00031700: 756e 6473 2829 0d0a 2020 2020 2020 2020  unds()..        
+00031710: 7375 7266 6163 652e 5f72 657a 203d 2073  surface._rez = s
+00031720: 7472 2872 657a 2920 6966 2069 7369 6e73  tr(rez) if isins
+00031730: 7461 6e63 6528 7265 7a2c 696e 7429 2065  tance(rez,int) e
+00031740: 6c73 6520 277b 3a2e 3166 7d27 2e66 6f72  lse '{:.1f}'.for
+00031750: 6d61 7428 7265 7a29 0d0a 2020 2020 2020  mat(rez)..      
+00031760: 2020 7375 7266 6163 652e 5f62 6173 6574    surface._baset
+00031770: 7970 6520 3d20 2772 616e 645f 272b 7374  ype = 'rand_'+st
+00031780: 7228 7365 6564 290d 0a20 2020 2020 2020  r(seed)..       
+00031790: 2072 6574 7572 6e20 7375 7266 6163 650d   return surface.
+000317a0: 0a0d 0a20 2020 2040 7374 6174 6963 6d65  ...    @staticme
+000317b0: 7468 6f64 0d0a 2020 2020 6465 6620 706c  thod..    def pl
+000317c0: 6174 6f6e 6963 2872 657a 3d30 2c62 6173  atonic(rez=0,bas
+000317d0: 6574 7970 653d 4e6f 6e65 2c6e 616d 653d  etype=None,name=
+000317e0: 4e6f 6e65 2c20 2a2a 6b77 6172 6773 2920  None, **kwargs) 
+000317f0: 3a0d 0a20 2020 2020 2020 2022 2222 0d0a  :..        """..
+00031800: 2020 2020 2020 2020 506c 6174 6f6e 6963          Platonic
+00031810: 2053 6f6c 6964 2073 7572 6661 6365 732e   Solid surfaces.
+00031820: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+00031830: 2020 2020 5061 7261 6d65 7465 7273 0d0a      Parameters..
+00031840: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00031850: 2d2d 0d0a 2020 2020 2020 2020 7265 7a20  --..        rez 
+00031860: 3a20 696e 7465 6765 722c 206f 7074 696f  : integer, optio
+00031870: 6e61 6c2c 2064 6566 6175 6c74 3a20 300d  nal, default: 0.
+00031880: 0a20 2020 2020 2020 2020 2020 204e 756d  .            Num
+00031890: 6265 7220 6f66 2072 6563 7572 7369 7665  ber of recursive
+000318a0: 2073 7562 6469 7669 7369 6f6e 7320 6f66   subdivisions of
+000318b0: 2074 6865 2074 7269 616e 6775 6c61 7465   the triangulate
+000318c0: 6420 6261 7365 2066 6163 6573 2e0d 0a20  d base faces... 
+000318d0: 2020 2020 2020 2020 2020 2052 657a 2076             Rez v
+000318e0: 616c 7565 7320 7261 6e67 6520 6672 6f6d  alues range from
+000318f0: 2030 2074 6f20 372e 0d0a 2020 2020 2020   0 to 7...      
+00031900: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00031910: 6261 7365 7479 7065 203a 207b 2774 6574  basetype : {'tet
+00031920: 7261 272c 276f 6374 6127 2c27 6963 6f73  ra','octa','icos
+00031930: 6127 2c27 6375 6265 272c 2764 6f64 6563  a','cube','dodec
+00031940: 6127 7d2c 206f 7074 696f 6e61 6c2c 2064  a'}, optional, d
+00031950: 6566 6175 6c74 3a20 2769 636f 7361 270d  efault: 'icosa'.
+00031960: 0a20 2020 2020 2020 2020 2020 2053 7461  .            Sta
+00031970: 7274 696e 6720 7375 7266 6163 6520 6765  rting surface ge
+00031980: 6f6d 6574 7269 6573 2066 726f 6d20 7768  ometries from wh
+00031990: 6963 6820 7468 6520 7375 7266 6163 6520  ich the surface 
+000319a0: 6973 0d0a 2020 2020 2020 2020 2020 2020  is..            
+000319b0: 636f 6e73 7472 7563 7465 6420 7573 696e  constructed usin
+000319c0: 6720 7265 6375 7273 6976 6520 7375 6264  g recursive subd
+000319d0: 6976 6973 696f 6e73 206f 6620 7468 6520  ivisions of the 
+000319e0: 7472 6961 6e67 756c 6172 2066 6163 6573  triangular faces
+000319f0: 2e0d 0a0d 0a20 2020 2020 2020 206e 616d  .....        nam
+00031a00: 6520 3a20 7374 7269 6e67 2c20 6f70 7469  e : string, opti
+00031a10: 6f6e 616c 2c20 6465 6661 756c 743a 204e  onal, default: N
+00031a20: 6f6e 652e 0d0a 2020 2020 2020 2020 2020  one...          
+00031a30: 2020 4465 7363 7269 7074 6976 6520 6964    Descriptive id
+00031a40: 656e 7469 6669 6572 2066 6f72 2074 6865  entifier for the
+00031a50: 2067 656f 6d65 7472 792e 0d0a 0d0a 2020   geometry.....  
+00031a60: 2020 2020 2020 5265 7475 726e 730d 0a20        Returns.. 
+00031a70: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0d0a         -------..
+00031a80: 2020 2020 2020 2020 5370 6865 7269 6361          Spherica
+00031a90: 6c53 7572 6661 6365 206f 626a 6563 740d  lSurface object.
+00031aa0: 0a0d 0a20 2020 2020 2020 204f 7468 6572  ...        Other
+00031ab0: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
+00031ac0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+00031ad0: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 202a  -----..        *
+00031ae0: 2a6b 7761 7267 730d 0a20 2020 2020 2020  *kwargs..       
+00031af0: 2020 2020 2041 6c6c 206f 7468 6572 2070       All other p
+00031b00: 6172 616d 6574 6572 7320 6172 6520 7061  arameters are pa
+00031b10: 7373 6564 206f 6e20 746f 2027 7333 646c  ssed on to 's3dl
+00031b20: 6962 2e73 7572 6661 6365 2e53 7068 6572  ib.surface.Spher
+00031b30: 6963 616c 5375 7266 6163 6527 2e0d 0a0d  icalSurface'....
+00031b40: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
+00031b50: 2020 2020 2020 232e 2e2e 2e2e 2e2e 2e2e        #.........
+00031b60: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00031b70: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 0d0a 2020  ..............  
+00031b80: 2020 2020 2020 6465 6620 6665 765f 6375        def fev_cu
+00031b90: 6265 5f61 2829 203a 0d0a 2020 2020 2020  be_a() :..      
+00031ba0: 2020 2020 2020 7620 3d20 5b20 5b2d 312c        v = [ [-1,
+00031bb0: 2d31 2c2d 315d 2c5b 2d31 2c20 312c 2d31  -1,-1],[-1, 1,-1
+00031bc0: 5d2c 5b20 312c 2031 2c2d 315d 2c5b 2031  ],[ 1, 1,-1],[ 1
+00031bd0: 2c2d 312c 2d31 5d2c 0d0a 2020 2020 2020  ,-1,-1],..      
+00031be0: 2020 2020 2020 2020 2020 2020 5b2d 312c              [-1,
+00031bf0: 2d31 2c20 315d 2c5b 2d31 2c20 312c 2031  -1, 1],[-1, 1, 1
+00031c00: 5d2c 5b20 312c 2031 2c20 315d 2c5b 2031  ],[ 1, 1, 1],[ 1
+00031c10: 2c2d 312c 2031 5d20 5d0d 0a20 2020 2020  ,-1, 1] ]..     
+00031c20: 2020 2020 2020 2066 203d 205b 205b 302c         f = [ [0,
+00031c30: 312c 322c 335d 2c5b 342c 372c 362c 355d  1,2,3],[4,7,6,5]
+00031c40: 2c5b 302c 332c 372c 345d 2c5b 332c 322c  ,[0,3,7,4],[3,2,
+00031c50: 362c 375d 2c5b 322c 312c 352c 365d 2c5b  6,7],[2,1,5,6],[
+00031c60: 312c 302c 342c 355d 5d0d 0a20 2020 2020  1,0,4,5]]..     
+00031c70: 2020 2020 2020 2065 203d 205b 205b 332c         e = [ [3,
+00031c80: 325d 2c5b 322c 315d 2c5b 312c 305d 2c5b  2],[2,1],[1,0],[
+00031c90: 302c 335d 2c20 5b37 2c36 5d2c 5b36 2c35  0,3], [7,6],[6,5
+00031ca0: 5d2c 5b35 2c34 5d2c 5b34 2c37 5d2c 205b  ],[5,4],[4,7], [
+00031cb0: 302c 345d 2c5b 332c 375d 2c5b 322c 365d  0,4],[3,7],[2,6]
+00031cc0: 2c5b 312c 355d 5d0d 0a20 2020 2020 2020  ,[1,5]]..       
+00031cd0: 2020 2020 2072 6574 7572 6e20 6e70 2e61       return np.a
+00031ce0: 7272 6179 2876 292c 6e70 2e61 7272 6179  rray(v),np.array
+00031cf0: 2866 292c 6e70 2e61 7272 6179 2865 290d  (f),np.array(e).
+00031d00: 0a20 2020 2020 2020 2064 6566 205f 7072  .        def _pr
+00031d10: 6554 7269 616e 6775 6c61 7465 446f 646f  eTriangulateDodo
+00031d20: 6328 762c 662c 652c 6663 2920 3a0d 0a20  c(v,f,e,fc) :.. 
+00031d30: 2020 2020 2020 2020 2020 2023 2028 7370             # (sp
+00031d40: 6563 6961 6c20 4361 7365 290d 0a20 2020  ecial Case)..   
+00031d50: 2020 2020 2020 2020 2023 204f 6e6c 7920           # Only 
+00031d60: 7573 6564 2066 6f72 2072 657a 3d31 206f  used for rez=1 o
+00031d70: 6620 6120 706c 6174 6f6e 6963 2064 6f64  f a platonic dod
+00031d80: 6563 6168 6564 726f 6e2e 2045 6163 6820  ecahedron. Each 
+00031d90: 7065 6e74 6167 6f6e 0d0a 2020 2020 2020  pentagon..      
+00031da0: 2020 2020 2020 2320 6973 2062 726f 6b65        # is broke
+00031db0: 6e20 696e 746f 2035 2069 736f 6365 6c65  n into 5 isocele
+00031dc0: 7320 7472 6961 6e67 6c65 7320 6672 6f6d  s triangles from
+00031dd0: 2061 2063 656e 7465 7265 6420 7665 7274   a centered vert
+00031de0: 6578 2e0d 0a20 2020 2020 2020 2020 2020  ex...           
+00031df0: 2073 7562 4661 6365 496e 6469 6365 732c   subFaceIndices,
+00031e00: 7375 6245 6467 6549 6e64 6963 6573 203d  subEdgeIndices =
+00031e10: 205b 5d2c 5b5d 0d0a 2020 2020 2020 2020   [],[]..        
+00031e20: 2020 2020 6e65 7743 6f6f 7273 2c6e 6577      newCoors,new
+00031e30: 436f 6c6f 7220 3d20 5b5d 2c5b 5d0d 0a20  Color = [],[].. 
+00031e40: 2020 2020 2020 2020 2020 206e 7649 6e78             nvInx
+00031e50: 203d 206c 656e 2876 290d 0a20 2020 2020   = len(v)..     
+00031e60: 2020 2020 2020 2066 6f72 2069 2c20 6661         for i, fa
+00031e70: 6365 2069 6e20 656e 756d 6572 6174 6528  ce in enumerate(
+00031e80: 6629 203a 0d0a 2020 2020 2020 2020 2020  f) :..          
+00031e90: 2020 2020 2020 666f 7220 6e30 2069 6e20        for n0 in 
+00031ea0: 7261 6e67 6528 3529 203a 0d0a 2020 2020  range(5) :..    
+00031eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031ec0: 6e31 203d 2028 6e30 2b31 2925 350d 0a20  n1 = (n0+1)%5.. 
+00031ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031ee0: 2020 2073 7562 4661 6365 496e 6469 6365     subFaceIndice
+00031ef0: 732e 6170 7065 6e64 2820 5b66 6163 655b  s.append( [face[
+00031f00: 6e30 5d2c 6661 6365 5b6e 315d 2c6e 7649  n0],face[n1],nvI
+00031f10: 6e78 2b69 5d20 290d 0a20 2020 2020 2020  nx+i] )..       
+00031f20: 2020 2020 2020 2020 2020 2020 2073 7562               sub
+00031f30: 4564 6765 496e 6469 6365 732e 6170 7065  EdgeIndices.appe
+00031f40: 6e64 2820 5b66 6163 655b 6e30 5d2c 6e76  nd( [face[n0],nv
+00031f50: 496e 782b 695d 2029 0d0a 2020 2020 2020  Inx+i] )..      
+00031f60: 2020 2020 2020 2020 2020 6e65 7743 6f6f            newCoo
+00031f70: 7273 2e61 7070 656e 6428 206e 702e 7375  rs.append( np.su
+00031f80: 6d28 765b 6661 6365 5d2c 2061 7869 733d  m(v[face], axis=
+00031f90: 3029 2f35 2029 0d0a 2020 2020 2020 2020  0)/5 )..        
+00031fa0: 2020 2020 2020 2020 6e65 7743 6f6c 6f72          newColor
+00031fb0: 202b 3d20 5b66 635b 695d 5d2a 350d 0a20   += [fc[i]]*5.. 
+00031fc0: 2020 2020 2020 2020 2020 206e 6577 7665             newve
+00031fd0: 7274 7320 3d20 6e70 2e61 7070 656e 6428  rts = np.append(
+00031fe0: 762c 6e65 7743 6f6f 7273 2c61 7869 733d  v,newCoors,axis=
+00031ff0: 3029 200d 0a20 2020 2020 2020 2020 2020  0) ..           
+00032000: 206e 6577 6676 496e 7820 3d20 6e70 2e61   newfvInx = np.a
+00032010: 7272 6179 2873 7562 4661 6365 496e 6469  rray(subFaceIndi
+00032020: 6365 7329 200d 0a20 2020 2020 2020 2020  ces) ..         
+00032030: 2020 206e 6577 4576 496e 7820 3d20 6e70     newEvInx = np
+00032040: 2e61 7070 656e 6428 652c 7375 6245 6467  .append(e,subEdg
+00032050: 6549 6e64 6963 6573 2c61 7869 733d 3029  eIndices,axis=0)
+00032060: 200d 0a20 2020 2020 2020 2020 2020 206e   ..            n
+00032070: 6577 436f 6c6f 7220 3d20 6e70 2e61 7272  ewColor = np.arr
+00032080: 6179 286e 6577 436f 6c6f 7229 0d0a 2020  ay(newColor)..  
+00032090: 2020 2020 2020 2020 2020 7265 7475 726e            return
+000320a0: 206e 6577 7665 7274 732c 6e65 7766 7649   newverts,newfvI
+000320b0: 6e78 2c6e 6577 4576 496e 782c 6e65 7743  nx,newEvInx,newC
+000320c0: 6f6c 6f72 0d0a 2020 2020 2020 2020 232e  olor..        #.
+000320d0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+000320e0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+000320f0: 2e2e 2e2e 0d0a 2020 2020 2020 2020 6966  ......        if
+00032100: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
+00032110: 7265 7a2c 2069 6e74 2920 3a0d 0a20 2020  rez, int) :..   
+00032120: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+00032130: 616c 7565 4572 726f 7228 2749 6e63 6f72  alueError('Incor
+00032140: 7265 6374 2072 657a 2074 7970 652c 206d  rect rez type, m
+00032150: 7573 7420 6261 206f 6620 7479 7065 2069  ust ba of type i
+00032160: 6e74 2729 0d0a 2020 2020 2020 2020 6966  nt')..        if
+00032170: 2028 7265 7a3c 3029 206f 7220 2872 657a   (rez<0) or (rez
+00032180: 3e5f 4d41 5852 455a 2920 3a0d 0a20 2020  >_MAXREZ) :..   
+00032190: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+000321a0: 616c 7565 4572 726f 7228 2749 6e63 6f72  alueError('Incor
+000321b0: 7265 7374 2072 657a 206f 6620 7b7d 2c20  rest rez of {}, 
+000321c0: 6d75 7374 2062 6520 616e 2069 6e74 2c20  must be an int, 
+000321d0: 3020 3c3d 2072 657a 203c 3d20 7b7d 272e  0 <= rez <= {}'.
+000321e0: 666f 726d 6174 2872 657a 2c5f 4d41 5852  format(rez,_MAXR
+000321f0: 455a 2929 0d0a 2020 2020 2020 2020 6966  EZ))..        if
+00032200: 2062 6173 6574 7970 6520 6973 204e 6f6e   basetype is Non
+00032210: 6520 3a20 6261 7365 7479 7065 203d 2053  e : basetype = S
+00032220: 7068 6572 6963 616c 5375 7266 6163 652e  phericalSurface.
+00032230: 5f64 6566 6175 6c74 5f62 6173 650d 0a0d  _default_base...
+00032240: 0a20 2020 2020 2020 2062 6173 6544 6963  .        baseDic
+00032250: 7420 3d20 7b20 2774 6574 7261 273a 2274  t = { 'tetra':"t
+00032260: 6574 7261 6865 6472 6f6e 222c 276f 6374  etrahedron",'oct
+00032270: 6127 3a22 6f63 7461 6865 6472 6f6e 222c  a':"octahedron",
+00032280: 0d0a 2020 2020 2020 2020 2020 2020 2769  ..            'i
+00032290: 636f 7361 273a 2269 636f 7361 6865 6472  cosa':"icosahedr
+000322a0: 6f6e 222c 2763 7562 6527 3a22 6375 6265  on",'cube':"cube
+000322b0: 222c 2764 6f64 6563 6127 3a22 646f 6465  ",'dodeca':"dode
+000322c0: 6361 6865 6472 6f6e 222c 0d0a 2020 2020  cahedron",..    
+000322d0: 2020 2020 2020 2020 2763 7562 655f 6127          'cube_a'
+000322e0: 3a22 6375 6265 5f61 6c69 676e 2220 207d  :"cube_align"  }
+000322f0: 0d0a 2020 2020 2020 2020 6261 7365 4368  ..        baseCh
+00032300: 6563 6b20 3d20 6261 7365 4469 6374 2e6b  eck = baseDict.k
+00032310: 6579 7328 290d 0a0d 0a20 2020 2020 2020  eys()....       
+00032320: 2069 6620 6261 7365 7479 7065 206e 6f74   if basetype not
+00032330: 2069 6e20 6261 7365 4368 6563 6b20 3a0d   in baseCheck :.
+00032340: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+00032350: 7365 2056 616c 7565 4572 726f 7228 2742  se ValueError('B
+00032360: 6173 6574 7970 6520 7b7d 2069 7320 6e6f  asetype {} is no
+00032370: 7420 7265 636f 676e 697a 6564 2e20 506f  t recognized. Po
+00032380: 7373 6962 6c65 2076 616c 7565 7320 6172  ssible values ar
+00032390: 653a 207b 7d27 2e66 6f72 6d61 7428 6261  e: {}'.format(ba
+000323a0: 7365 7479 7065 2c62 6173 6543 6865 636b  setype,baseCheck
+000323b0: 2920 290d 0a0d 0a20 2020 2020 2020 2069  ) )....        i
+000323c0: 6620 6261 7365 7479 7065 203d 3d20 2763  f basetype == 'c
+000323d0: 7562 655f 6127 203a 0d0a 2020 2020 2020  ube_a' :..      
+000323e0: 2020 2020 2020 7375 7266 6163 6520 3d20        surface = 
+000323f0: 5370 6865 7269 6361 6c53 7572 6661 6365  SphericalSurface
+00032400: 2862 6173 6574 7970 653d 2763 7562 6527  (basetype='cube'
+00032410: 2c6e 616d 653d 6e61 6d65 2c20 2a2a 6b77  ,name=name, **kw
+00032420: 6172 6773 290d 0a20 2020 2020 2020 2065  args)..        e
+00032430: 6c73 6520 3a20 2020 200d 0a20 2020 2020  lse :    ..     
+00032440: 2020 2020 2020 2073 7572 6661 6365 203d         surface =
+00032450: 2053 7068 6572 6963 616c 5375 7266 6163   SphericalSurfac
+00032460: 6528 6261 7365 7479 7065 3d62 6173 6574  e(basetype=baset
+00032470: 7970 652c 6e61 6d65 3d6e 616d 652c 202a  ype,name=name, *
+00032480: 2a6b 7761 7267 7329 0d0a 0d0a 2020 2020  *kwargs)....    
+00032490: 2020 2020 7375 7266 6163 652e 5f72 657a      surface._rez
+000324a0: 203d 2072 657a 0d0a 2020 2020 2020 2020   = rez..        
+000324b0: 6966 2062 6173 6574 7970 6520 3d3d 2027  if basetype == '
+000324c0: 6375 6265 5f61 2720 3a0d 0a20 2020 2020  cube_a' :..     
+000324d0: 2020 2020 2020 2076 2c66 2c65 203d 2066         v,f,e = f
+000324e0: 6576 5f63 7562 655f 6128 290d 0a20 2020  ev_cube_a()..   
+000324f0: 2020 2020 2020 2020 2073 7572 6661 6365           surface
+00032500: 2e76 6572 7465 7843 6f6f 7220 3d20 760d  .vertexCoor = v.
+00032510: 0a20 2020 2020 2020 2020 2020 2073 7572  .            sur
+00032520: 6661 6365 2e66 7649 6e64 6963 6573 203d  face.fvIndices =
+00032530: 2066 0d0a 2020 2020 2020 2020 2020 2020   f..            
+00032540: 7375 7266 6163 652e 6576 496e 6469 6365  surface.evIndice
+00032550: 7320 3d20 650d 0a20 2020 2020 2020 2020  s = e..         
+00032560: 2020 2073 7572 6661 6365 2e76 6649 6e64     surface.vfInd
+00032570: 6963 6573 4c69 7374 203d 2073 7572 6661  icesList = surfa
+00032580: 6365 2e5f 7665 7274 6578 436f 6d6d 6f6e  ce._vertexCommon
+00032590: 4661 6365 496e 6469 6365 7328 290d 0a20  FaceIndices().. 
+000325a0: 2020 2020 2020 2020 2020 2073 7572 6661             surfa
+000325b0: 6365 2e65 6649 6e64 6963 6573 4c69 7374  ce.efIndicesList
+000325c0: 203d 2073 7572 6661 6365 2e5f 6564 6765   = surface._edge
+000325d0: 436f 6d6d 6f6e 4661 6365 496e 6469 6365  CommonFaceIndice
+000325e0: 7328 290d 0a20 2020 2020 2020 2020 2020  s()..           
+000325f0: 2073 7572 6661 6365 2e73 6574 5f76 6572   surface.set_ver
+00032600: 7473 2820 765b 665d 2029 0d0a 2020 2020  ts( v[f] )..    
+00032610: 2020 2020 6966 2062 6173 6574 7970 6520      if basetype 
+00032620: 3d3d 2027 6375 6265 2720 3a0d 0a20 2020  == 'cube' :..   
+00032630: 2020 2020 2020 2020 2076 2c66 2c65 203d           v,f,e =
+00032640: 2053 7068 6572 6963 616c 5375 7266 6163   SphericalSurfac
+00032650: 652e 6765 745f 6375 6265 2829 0d0a 2020  e.get_cube()..  
+00032660: 2020 2020 2020 2020 2020 7375 7266 6163            surfac
+00032670: 652e 7665 7274 6578 436f 6f72 203d 2076  e.vertexCoor = v
+00032680: 0d0a 2020 2020 2020 2020 2020 2020 7375  ..            su
+00032690: 7266 6163 652e 6676 496e 6469 6365 7320  rface.fvIndices 
+000326a0: 3d20 660d 0a20 2020 2020 2020 2020 2020  = f..           
+000326b0: 2073 7572 6661 6365 2e65 7649 6e64 6963   surface.evIndic
+000326c0: 6573 203d 2065 0d0a 2020 2020 2020 2020  es = e..        
+000326d0: 2020 2020 7375 7266 6163 652e 7666 496e      surface.vfIn
+000326e0: 6469 6365 734c 6973 7420 3d20 7375 7266  dicesList = surf
+000326f0: 6163 652e 5f76 6572 7465 7843 6f6d 6d6f  ace._vertexCommo
+00032700: 6e46 6163 6549 6e64 6963 6573 2829 0d0a  nFaceIndices()..
+00032710: 2020 2020 2020 2020 2020 2020 7375 7266              surf
+00032720: 6163 652e 6566 496e 6469 6365 734c 6973  ace.efIndicesLis
+00032730: 7420 3d20 7375 7266 6163 652e 5f65 6467  t = surface._edg
+00032740: 6543 6f6d 6d6f 6e46 6163 6549 6e64 6963  eCommonFaceIndic
+00032750: 6573 2829 0d0a 2020 2020 2020 2020 2020  es()..          
+00032760: 2020 7375 7266 6163 652e 7365 745f 7665    surface.set_ve
+00032770: 7274 7328 2076 5b66 5d20 290d 0a20 2020  rts( v[f] )..   
+00032780: 2020 2020 2069 6620 6261 7365 7479 7065       if basetype
+00032790: 203d 3d20 2764 6f64 6563 6127 203a 0d0a   == 'dodeca' :..
+000327a0: 2020 2020 2020 2020 2020 2020 762c 662c              v,f,
+000327b0: 6520 3d20 5370 6865 7269 6361 6c53 7572  e = SphericalSur
+000327c0: 6661 6365 2e67 6574 5f64 6f64 6563 6168  face.get_dodecah
+000327d0: 6564 726f 6e28 290d 0a20 2020 2020 2020  edron()..       
+000327e0: 2020 2020 2069 6620 7265 7a3e 3020 3a0d       if rez>0 :.
+000327f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00032800: 2066 6320 3d20 7375 7266 6163 652e 5f64   fc = surface._d
+00032810: 6661 6365 636f 6c6f 7273 2020 2320 7570  facecolors  # up
+00032820: 6461 7465 2066 6f72 2076 5f31 2e32 2e30  date for v_1.2.0
+00032830: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00032840: 2020 762c 662c 652c 6663 203d 205f 7072    v,f,e,fc = _pr
+00032850: 6554 7269 616e 6775 6c61 7465 446f 646f  eTriangulateDodo
+00032860: 6328 762c 662c 652c 6663 290d 0a20 2020  c(v,f,e,fc)..   
+00032870: 2020 2020 2020 2020 2020 2020 2073 7572               sur
+00032880: 6661 6365 2e73 6574 5f66 6163 6563 6f6c  face.set_facecol
+00032890: 6f72 2866 6329 0d0a 2020 2020 2020 2020  or(fc)..        
+000328a0: 2020 2020 2020 2020 7265 7a20 2d3d 2031          rez -= 1
+000328b0: 0d0a 2020 2020 2020 2020 2020 2020 7375  ..            su
+000328c0: 7266 6163 652e 7665 7274 6578 436f 6f72  rface.vertexCoor
+000328d0: 203d 2076 0d0a 2020 2020 2020 2020 2020   = v..          
+000328e0: 2020 7375 7266 6163 652e 6676 496e 6469    surface.fvIndi
+000328f0: 6365 7320 3d20 660d 0a20 2020 2020 2020  ces = f..       
+00032900: 2020 2020 2073 7572 6661 6365 2e65 7649       surface.evI
+00032910: 6e64 6963 6573 203d 2065 0d0a 2020 2020  ndices = e..    
+00032920: 2020 2020 2020 2020 7375 7266 6163 652e          surface.
+00032930: 7666 496e 6469 6365 734c 6973 7420 3d20  vfIndicesList = 
+00032940: 7375 7266 6163 652e 5f76 6572 7465 7843  surface._vertexC
+00032950: 6f6d 6d6f 6e46 6163 6549 6e64 6963 6573  ommonFaceIndices
+00032960: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
+00032970: 7375 7266 6163 652e 6566 496e 6469 6365  surface.efIndice
+00032980: 734c 6973 7420 3d20 7375 7266 6163 652e  sList = surface.
+00032990: 5f65 6467 6543 6f6d 6d6f 6e46 6163 6549  _edgeCommonFaceI
+000329a0: 6e64 6963 6573 2829 0d0a 2020 2020 2020  ndices()..      
+000329b0: 2020 2020 2020 7375 7266 6163 652e 7365        surface.se
+000329c0: 745f 7665 7274 7328 2076 5b66 5d20 290d  t_verts( v[f] ).
+000329d0: 0a0d 0a20 2020 2020 2020 2073 7572 6661  ...        surfa
+000329e0: 6365 2e5f 706f 7374 5072 6f63 5f73 7572  ce._postProc_sur
+000329f0: 6661 6365 436f 6c6f 7273 2854 7275 6529  faceColors(True)
+00032a00: 0d0a 2020 2020 2020 2020 6966 2072 657a  ..        if rez
+00032a10: 203e 2030 203a 0d0a 2020 2020 2020 2020   > 0 :..        
+00032a20: 2020 2020 7375 7266 6163 652e 7472 6961      surface.tria
+00032a30: 6e67 756c 6174 6528 7265 7a29 0d0a 2020  ngulate(rez)..  
+00032a40: 2020 2020 0d0a 2020 2020 2020 2020 7375      ..        su
+00032a50: 7266 6163 652e 5f73 6574 5f67 656f 6d65  rface._set_geome
+00032a60: 7472 6963 5f62 6f75 6e64 7328 290d 0a20  tric_bounds().. 
+00032a70: 2020 2020 2020 2073 7572 6661 6365 2e5f         surface._
+00032a80: 6261 7365 7479 7065 203d 2062 6173 6574  basetype = baset
+00032a90: 7970 6520 2b20 272a 2720 2020 0d0a 2020  ype + '*'   ..  
+00032aa0: 2020 2020 2020 7375 7266 6163 652e 6e61        surface.na
+00032ab0: 6d65 203d 2062 6173 6544 6963 745b 6261  me = baseDict[ba
+00032ac0: 7365 7479 7065 5d20 6966 206e 616d 6520  setype] if name 
+00032ad0: 6973 204e 6f6e 6520 656c 7365 206e 616d  is None else nam
+00032ae0: 650d 0a20 2020 2020 2020 2072 6574 7572  e..        retur
+00032af0: 6e20 7375 7266 6163 650d 0a0d 0a20 2020  n surface....   
+00032b00: 2040 7374 6174 6963 6d65 7468 6f64 0d0a   @staticmethod..
+00032b10: 2020 2020 6465 6620 6765 745f 646f 6465      def get_dode
+00032b20: 6361 6865 6472 6f6e 2829 203a 0d0a 2020  cahedron() :..  
+00032b30: 2020 2020 2020 2222 224e 756d 7079 2061        """Numpy a
+00032b40: 7272 6179 7320 6f66 2064 6f64 6563 6168  rrays of dodecah
+00032b50: 6564 726f 6e20 7665 7274 6963 6573 2028  edron vertices (
+00032b60: 3230 2c33 2920 616e 6420 6661 6365 2076  20,3) and face v
+00032b70: 6572 7465 7820 696e 6469 6365 7320 2831  ertex indices (1
+00032b80: 322c 3529 0d0a 2020 2020 2020 2020 2020  2,5)..          
+00032b90: 2061 6e64 2065 6467 6520 7665 7274 6578   and edge vertex
+00032ba0: 2069 6e64 6963 6573 2028 3330 2c32 290d   indices (30,2).
+00032bb0: 0a20 2020 2020 2020 2022 2222 2020 2020  .        """    
+00032bc0: 2020 200d 0a20 2020 2020 2020 2076 2c66     ..        v,f
+00032bd0: 2c65 203d 2053 7068 6572 6963 616c 5375  ,e = SphericalSu
+00032be0: 7266 6163 652e 5f67 6574 5f70 6c61 746f  rface._get_plato
+00032bf0: 6e69 635f 736f 6c69 6473 5f64 6963 7469  nic_solids_dicti
+00032c00: 6f6e 6172 7928 2764 6f64 6563 6127 290d  onary('dodeca').
+00032c10: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00032c20: 6e70 2e61 7272 6179 2876 292c 206e 702e  np.array(v), np.
+00032c30: 6172 7261 7928 6629 2c20 6e70 2e61 7272  array(f), np.arr
+00032c40: 6179 2865 290d 0a0d 0a20 2020 2040 7374  ay(e)....    @st
+00032c50: 6174 6963 6d65 7468 6f64 0d0a 2020 2020  aticmethod..    
+00032c60: 6465 6620 6765 745f 6375 6265 2829 203a  def get_cube() :
+00032c70: 0d0a 2020 2020 2020 2020 2222 224e 756d  ..        """Num
+00032c80: 7079 2061 7272 6179 7320 6f66 2063 7562  py arrays of cub
+00032c90: 6520 7665 7274 6963 6573 2028 382c 3329  e vertices (8,3)
+00032ca0: 2061 6e64 2066 6163 6520 7665 7274 6578   and face vertex
+00032cb0: 2069 6e64 6963 6573 2036 2c35 290d 0a20   indices 6,5).. 
+00032cc0: 2020 2020 2020 2020 2020 616e 6420 6564            and ed
+00032cd0: 6765 2076 6572 7465 7820 696e 6469 6365  ge vertex indice
+00032ce0: 7320 2831 322c 3229 0d0a 2020 2020 2020  s (12,2)..      
+00032cf0: 2020 2222 220d 0a20 2020 2020 2020 2076    """..        v
+00032d00: 2c66 2c65 203d 2053 7068 6572 6963 616c  ,f,e = Spherical
+00032d10: 5375 7266 6163 652e 5f67 6574 5f70 6c61  Surface._get_pla
+00032d20: 746f 6e69 635f 736f 6c69 6473 5f64 6963  tonic_solids_dic
+00032d30: 7469 6f6e 6172 7928 2763 7562 6527 290d  tionary('cube').
+00032d40: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00032d50: 6e70 2e61 7272 6179 2876 292c 206e 702e  np.array(v), np.
+00032d60: 6172 7261 7928 6629 2c20 6e70 2e61 7272  array(f), np.arr
+00032d70: 6179 2865 290d 0a0d 0a20 2020 2040 7374  ay(e)....    @st
+00032d80: 6174 6963 6d65 7468 6f64 0d0a 2020 2020  aticmethod..    
+00032d90: 6465 6620 5f67 6574 5f70 6c61 746f 6e69  def _get_platoni
+00032da0: 635f 736f 6c69 6473 5f64 6963 7469 6f6e  c_solids_diction
+00032db0: 6172 7928 6765 7441 7272 6179 7320 3d20  ary(getArrays = 
+00032dc0: 4e6f 6e65 2920 3a0d 0a20 2020 2020 2020  None) :..       
+00032dd0: 2022 2222 436f 6e73 7472 7563 7473 2074   """Constructs t
+00032de0: 6865 2064 6963 7469 6f6e 6172 7920 6f66  he dictionary of
+00032df0: 2062 6173 6520 7370 6865 7269 6361 6c20   base spherical 
+00032e00: 7375 7266 6163 6520 6765 6f6d 6574 7269  surface geometri
+00032e10: 6573 2e22 2222 0d0a 2020 2020 2020 2020  es."""..        
+00032e20: 2320 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  # ..............
+00032e30: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00032e40: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00032e50: 2e2e 2e2e 2e2e 0d0a 2020 2020 2020 2020  ........        
+00032e60: 6465 6620 6765 745f 6375 6265 2829 203a  def get_cube() :
+00032e70: 0d0a 2020 2020 2020 2020 2020 2020 7a65  ..            ze
+00032e80: 7461 203d 2031 2f33 0d0a 2020 2020 2020  ta = 1/3..      
+00032e90: 2020 2020 2020 7830 203d 206e 702e 7371        x0 = np.sq
+00032ea0: 7274 2832 292f 330d 0a20 2020 2020 2020  rt(2)/3..       
+00032eb0: 2020 2020 2079 3020 3d20 7830 2a6e 702e       y0 = x0*np.
+00032ec0: 7371 7274 2833 290d 0a20 2020 2020 2020  sqrt(3)..       
+00032ed0: 2020 2020 2063 6869 203d 2032 2a78 300d       chi = 2*x0.
+00032ee0: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+00032ef0: 2020 2020 2020 2063 7562 6542 6173 6556         cubeBaseV
+00032f00: 6572 7420 3d20 5b20 5b30 2c30 2c31 5d2c  ert = [ [0,0,1],
+00032f10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00032f20: 2020 2020 2020 2020 2020 2020 2020 205b                 [
+00032f30: 6368 692c 302c 7a65 7461 5d2c 2020 205b  chi,0,zeta],   [
+00032f40: 2d78 302c 7930 2c7a 6574 615d 2c20 205b  -x0,y0,zeta],  [
+00032f50: 2d78 302c 2d79 302c 7a65 7461 5d2c 0d0a  -x0,-y0,zeta],..
+00032f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032f70: 2020 2020 2020 2020 2020 2020 205b 2d63               [-c
+00032f80: 6869 2c30 2c2d 7a65 7461 5d2c 205b 7830  hi,0,-zeta], [x0
+00032f90: 2c2d 7930 2c2d 7a65 7461 5d2c 205b 7830  ,-y0,-zeta], [x0
+00032fa0: 2c79 302c 2d7a 6574 615d 2c0d 0a20 2020  ,y0,-zeta],..   
+00032fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032fc0: 2020 2020 2020 2020 2020 5b30 2c30 2c2d            [0,0,-
+00032fd0: 315d 205d 0d0a 0d0a 2020 2020 2020 2020  1] ]....        
+00032fe0: 2020 2020 6375 6265 4261 7365 4661 6365      cubeBaseFace
+00032ff0: 733d 5b20 0d0a 2020 2020 2020 2020 2020  s=[ ..          
+00033000: 2020 2020 2020 5b30 2c31 2c36 2c32 5d2c        [0,1,6,2],
+00033010: 5b30 2c32 2c34 2c33 5d2c 5b30 2c33 2c35  [0,2,4,3],[0,3,5
+00033020: 2c31 5d2c 0d0a 2020 2020 2020 2020 2020  ,1],..          
+00033030: 2020 2020 2020 5b37 2c36 2c31 2c35 5d2c        [7,6,1,5],
+00033040: 5b37 2c34 2c32 2c36 5d2c 5b37 2c35 2c33  [7,4,2,6],[7,5,3
+00033050: 2c34 5d20 5d0d 0a20 2020 2020 2020 2020  ,4] ]..         
+00033060: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
+00033070: 2063 7562 6542 6173 6545 6467 6573 203d   cubeBaseEdges =
+00033080: 205b 205b 302c 315d 2c20 5b30 2c32 5d2c   [ [0,1], [0,2],
+00033090: 205b 302c 335d 2c20 5b37 2c34 5d2c 205b   [0,3], [7,4], [
+000330a0: 372c 355d 2c20 5b37 2c36 5d2c 0d0a 2020  7,5], [7,6],..  
+000330b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000330c0: 2020 2020 2020 2020 2020 2020 5b31 2c36              [1,6
+000330d0: 5d2c 205b 362c 325d 2c20 5b32 2c34 5d2c  ], [6,2], [2,4],
+000330e0: 205b 342c 335d 2c20 5b33 2c35 5d2c 205b   [4,3], [3,5], [
+000330f0: 352c 315d 205d 0d0a 0d0a 2020 2020 2020  5,1] ]....      
+00033100: 2020 2020 2020 7265 7475 726e 2063 7562        return cub
+00033110: 6542 6173 6556 6572 742c 2063 7562 6542  eBaseVert, cubeB
+00033120: 6173 6546 6163 6573 2c20 6375 6265 4261  aseFaces, cubeBa
+00033130: 7365 4564 6765 7320 0d0a 2020 2020 2020  seEdges ..      
+00033140: 2020 6465 6620 6765 745f 646f 6465 6361    def get_dodeca
+00033150: 6865 6472 6f6e 2829 203a 0d0a 2020 2020  hedron() :..    
+00033160: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+00033170: 2020 2020 2020 7a65 7461 203d 2031 2f33        zeta = 1/3
+00033180: 0d0a 2020 2020 2020 2020 2020 2020 6b73  ..            ks
+00033190: 6920 3d20 6e70 2e73 7172 7428 3529 2f33  i = np.sqrt(5)/3
+000331a0: 0d0a 2020 2020 2020 2020 2020 2020 6c61  ..            la
+000331b0: 6d5f 7371 7520 3d20 382f 390d 0a20 2020  m_squ = 8/9..   
+000331c0: 2020 2020 2020 2020 2068 4564 6765 5f73           hEdge_s
+000331d0: 7175 203d 2028 312d 6b73 6929 2f32 0d0a  qu = (1-ksi)/2..
+000331e0: 0d0a 2020 2020 2020 2020 2020 2020 4178  ..            Ax
+000331f0: 203d 2032 2f33 0d0a 2020 2020 2020 2020   = 2/3..        
+00033200: 2020 2020 4170 7820 3d20 312f 330d 0a20      Apx = 1/3.. 
+00033210: 2020 2020 2020 2020 2020 2042 7820 3d20             Bx = 
+00033220: 6e70 2e73 7172 7428 6c61 6d5f 7371 752d  np.sqrt(lam_squ-
+00033230: 6845 6467 655f 7371 7529 0d0a 2020 2020  hEdge_squ)..    
+00033240: 2020 2020 2020 2020 4378 203d 206b 7369          Cx = ksi
+00033250: 200d 0a20 2020 2020 2020 2020 2020 2044   ..            D
+00033260: 7820 3d20 312d 4278 0d0a 2020 2020 2020  x = 1-Bx..      
+00033270: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00033280: 2020 2020 4170 7920 3d20 6e70 2e73 7172      Apy = np.sqr
+00033290: 7428 3329 2f33 0d0a 2020 2020 2020 2020  t(3)/3..        
+000332a0: 2020 2020 4279 203d 206e 702e 7371 7274      By = np.sqrt
+000332b0: 2868 4564 6765 5f73 7175 290d 0a20 2020  (hEdge_squ)..   
+000332c0: 2020 2020 2020 2020 2043 7920 3d20 4170           Cy = Ap
+000332d0: 790d 0a20 2020 2020 2020 2020 2020 2044  y..            D
+000332e0: 7920 3d20 4279 202b 2043 790d 0a0d 0a20  y = By + Cy.... 
+000332f0: 2020 2020 2020 2020 2020 2023 202d 2d2d             # ---
+00033300: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00033310: 2d2d 2d2d 0d0a 0d0a 2020 2020 2020 2020  ----....        
+00033320: 2020 2020 646f 6354 6f70 203d 205b 205b      docTop = [ [
+00033330: 302c 302c 315d 2c0d 0a20 2020 2020 2020  0,0,1],..       
+00033340: 2020 2020 2020 2020 205b 4178 2c20 302c           [Ax, 0,
+00033350: 206b 7369 5d2c 205b 2d41 7078 2c20 4170   ksi], [-Apx, Ap
+00033360: 792c 206b 7369 5d2c 205b 2d41 7078 2c20  y, ksi], [-Apx, 
+00033370: 2d41 7079 2c20 6b73 695d 2c0d 0a20 2020  -Apy, ksi],..   
+00033380: 2020 2020 2020 2020 2020 2020 205b 4378               [Cx
+00033390: 2c20 4379 2c20 7a65 7461 5d2c 205b 4478  , Cy, zeta], [Dx
+000333a0: 2c20 4479 2c20 7a65 7461 5d2c 205b 2d42  , Dy, zeta], [-B
+000333b0: 782c 2042 792c 207a 6574 615d 2c0d 0a20  x, By, zeta],.. 
+000333c0: 2020 2020 2020 2020 2020 2020 2020 205b                 [
+000333d0: 2d42 782c 202d 4279 2c20 7a65 7461 5d2c  -Bx, -By, zeta],
+000333e0: 205b 4478 2c20 2d44 792c 207a 6574 615d   [Dx, -Dy, zeta]
+000333f0: 2c20 5b43 782c 202d 4379 2c20 7a65 7461  , [Cx, -Cy, zeta
+00033400: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
+00033410: 2020 205d 0d0a 2020 2020 2020 2020 2020     ]..          
+00033420: 2020 646f 6342 6f74 746f 6d20 3d20 5b5d    docBottom = []
+00033430: 0d0a 2020 2020 2020 2020 2020 2020 666f  ..            fo
+00033440: 7220 7665 7220 696e 2064 6f63 546f 7020  r ver in docTop 
+00033450: 3a20 646f 6342 6f74 746f 6d2e 6170 7065  : docBottom.appe
+00033460: 6e64 2820 6e70 2e6d 756c 7469 706c 7928  nd( np.multiply(
+00033470: 7665 722c 5b2d 312c 312c 2d31 5d29 2e74  ver,[-1,1,-1]).t
+00033480: 6f6c 6973 7428 2920 290d 0a20 2020 2020  olist() )..     
+00033490: 2020 2020 2020 2064 6f63 6261 7365 5665         docbaseVe
+000334a0: 7274 203d 206e 702e 636f 6e63 6174 656e  rt = np.concaten
+000334b0: 6174 6528 2864 6f63 546f 702c 646f 6342  ate((docTop,docB
+000334c0: 6f74 746f 6d29 292e 746f 6c69 7374 2829  ottom)).tolist()
+000334d0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+000334e0: 646f 6362 6173 6546 6163 6573 203d 205b  docbaseFaces = [
+000334f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00033500: 2020 5b30 2c31 2c34 2c35 2c32 5d2c 205b    [0,1,4,5,2], [
+00033510: 302c 322c 362c 372c 335d 202c 205b 302c  0,2,6,7,3] , [0,
+00033520: 332c 382c 392c 315d 2c0d 0a20 2020 2020  3,8,9,1],..     
+00033530: 2020 2020 2020 2020 2020 205b 312c 392c             [1,9,
+00033540: 3137 2c31 362c 345d 2c20 5b32 2c35 2c31  17,16,4], [2,5,1
+00033550: 352c 3134 2c36 5d2c 205b 332c 372c 3139  5,14,6], [3,7,19
+00033560: 2c31 382c 385d 2c0d 0a20 2020 2020 2020  ,18,8],..       
+00033570: 2020 2020 2020 2020 205b 3130 2c31 322c           [10,12,
+00033580: 3136 2c31 372c 3133 5d2c 205b 3130 2c31  16,17,13], [10,1
+00033590: 312c 3134 2c31 352c 3132 5d2c 205b 3130  1,14,15,12], [10
+000335a0: 2c31 332c 3138 2c31 392c 3131 5d2c 0d0a  ,13,18,19,11],..
+000335b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000335c0: 5b31 312c 3139 2c37 2c36 2c31 345d 2c5b  [11,19,7,6,14],[
+000335d0: 3133 2c31 372c 392c 382c 3138 5d2c 5b31  13,17,9,8,18],[1
+000335e0: 322c 3135 2c35 2c34 2c31 365d 0d0a 2020  2,15,5,4,16]..  
+000335f0: 2020 2020 2020 2020 2020 5d0d 0a0d 0a20            ].... 
+00033600: 2020 2020 2020 2020 2020 2064 6f63 6261             docba
+00033610: 7365 4564 6765 7320 3d20 5b0d 0a20 2020  seEdges = [..   
+00033620: 2020 2020 2020 2020 2020 2020 205b 2030               [ 0
+00033630: 2c20 315d 2c20 5b20 302c 2032 5d2c 205b  , 1], [ 0, 2], [
+00033640: 2030 2c20 335d 2c20 5b20 342c 2035 5d2c   0, 3], [ 4, 5],
+00033650: 205b 2036 2c20 375d 2c20 5b20 382c 2039   [ 6, 7], [ 8, 9
+00033660: 5d2c 200d 0a20 2020 2020 2020 2020 2020  ], ..           
+00033670: 2020 2020 205b 2031 2c20 395d 2c20 5b20       [ 1, 9], [ 
+00033680: 312c 2034 5d2c 205b 2032 2c20 355d 2c20  1, 4], [ 2, 5], 
+00033690: 5b20 322c 2036 5d2c 205b 2033 2c20 375d  [ 2, 6], [ 3, 7]
+000336a0: 2c20 5b20 332c 2038 5d2c 0d0a 2020 2020  , [ 3, 8],..    
+000336b0: 2020 2020 2020 2020 2020 2020 5b31 302c              [10,
+000336c0: 3131 5d2c 205b 3130 2c31 325d 2c20 5b31  11], [10,12], [1
+000336d0: 302c 3133 5d2c 205b 3134 2c31 355d 2c20  0,13], [14,15], 
+000336e0: 5b31 362c 3137 5d2c 205b 3138 2c31 395d  [16,17], [18,19]
+000336f0: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
+00033700: 2020 2020 5b31 312c 3139 5d2c 205b 3131      [11,19], [11
+00033710: 2c31 345d 2c20 5b31 322c 3135 5d2c 205b  ,14], [12,15], [
+00033720: 3132 2c31 365d 2c20 5b31 332c 3137 5d2c  12,16], [13,17],
+00033730: 205b 3133 2c31 385d 2c0d 0a20 2020 2020   [13,18],..     
+00033740: 2020 2020 2020 2020 2020 205b 2036 2c31             [ 6,1
+00033750: 345d 2c20 5b20 342c 3136 5d2c 205b 2038  4], [ 4,16], [ 8
+00033760: 2c31 385d 2c20 5b20 352c 3135 5d2c 205b  ,18], [ 5,15], [
+00033770: 2039 2c31 375d 2c20 5b20 372c 3139 5d20   9,17], [ 7,19] 
+00033780: 200d 0a20 2020 2020 2020 2020 2020 205d   ..            ]
+00033790: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+000337a0: 7265 7475 726e 2064 6f63 6261 7365 5665  return docbaseVe
+000337b0: 7274 2c20 646f 6362 6173 6546 6163 6573  rt, docbaseFaces
+000337c0: 2c20 646f 6362 6173 6545 6467 6573 0d0a  , docbaseEdges..
+000337d0: 2020 2020 2020 2020 6465 6620 636f 6e73          def cons
+000337e0: 7472 7563 745f 7465 7472 6168 6564 726f  truct_tetrahedro
+000337f0: 6e28 2920 3a0d 0a20 2020 2020 2020 2020  n() :..         
+00033800: 2020 2063 5371 7220 3d20 286e 702e 7461     cSqr = (np.ta
+00033810: 6e28 6e70 2e70 692f 3329 292a 286e 702e  n(np.pi/3))*(np.
+00033820: 7461 6e28 6e70 2e70 692f 3329 290d 0a20  tan(np.pi/3)).. 
+00033830: 2020 2020 2020 2020 2020 207a 6574 6120             zeta 
+00033840: 3d20 2863 5371 722d 3129 2f28 322a 6353  = (cSqr-1)/(2*cS
+00033850: 7172 290d 0a20 2020 2020 2020 2020 2020  qr)..           
+00033860: 2063 6869 203d 206e 702e 7371 7274 2833   chi = np.sqrt(3
+00033870: 2a63 5371 722d 3129 2a6e 702e 7371 7274  *cSqr-1)*np.sqrt
+00033880: 2863 5371 722b 3129 2f28 322a 6353 7172  (cSqr+1)/(2*cSqr
+00033890: 290d 0a20 2020 2020 2020 2020 2020 2078  )..            x
+000338a0: 3020 3d20 6368 692a 6e70 2e63 6f73 286e  0 = chi*np.cos(n
+000338b0: 702e 7069 2f33 290d 0a20 2020 2020 2020  p.pi/3)..       
+000338c0: 2020 2020 2079 3020 3d20 6368 692a 6e70       y0 = chi*np
+000338d0: 2e73 696e 286e 702e 7069 2f33 290d 0a20  .sin(np.pi/3).. 
+000338e0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+000338f0: 2020 2020 2062 6173 6556 6572 7420 3d20       baseVert = 
+00033900: 5b20 5b30 2c30 2c31 5d2c 0d0a 2020 2020  [ [0,0,1],..    
+00033910: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033920: 2020 2020 205b 6368 692c 302c 2d7a 6574       [chi,0,-zet
+00033930: 615d 2c20 5b2d 7830 2c79 302c 2d7a 6574  a], [-x0,y0,-zet
+00033940: 615d 2c20 5b2d 7830 2c2d 7930 2c2d 7a65  a], [-x0,-y0,-ze
+00033950: 7461 5d20 5d0d 0a0d 0a20 2020 2020 2020  ta] ]....       
+00033960: 2020 2020 2062 6173 6546 6163 6573 3d28       baseFaces=(
+00033970: 5b30 2c31 2c32 5d2c 5b30 2c32 2c33 5d2c  [0,1,2],[0,2,3],
+00033980: 5b30 2c33 2c31 5d2c 5b31 2c33 2c32 5d29  [0,3,1],[1,3,2])
+00033990: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+000339a0: 466f 203d 206c 656e 2862 6173 6546 6163  Fo = len(baseFac
+000339b0: 6573 290d 0a20 2020 2020 2020 2020 2020  es)..           
+000339c0: 2072 6574 7572 6e20 7b20 2762 6173 6546   return { 'baseF
+000339d0: 6163 6549 6e64 6963 6573 2720 3a20 6261  aceIndices' : ba
+000339e0: 7365 4661 6365 7320 2c20 2762 6173 6556  seFaces , 'baseV
+000339f0: 6572 7469 6365 7343 6f6f 7227 203a 2062  erticesCoor' : b
+00033a00: 6173 6556 6572 742c 2027 6665 7650 6172  aseVert, 'fevPar
+00033a10: 616d 2720 3a20 5b46 6f2c 302c 325d 207d  am' : [Fo,0,2] }
+00033a20: 0d0a 2020 2020 2020 2020 6465 6620 636f  ..        def co
+00033a30: 6e73 7472 7563 745f 6375 6265 2829 203a  nstruct_cube() :
+00033a40: 0d0a 2020 2020 2020 2020 2020 2020 6375  ..            cu
+00033a50: 6265 4261 7365 5665 7274 2c20 6375 6265  beBaseVert, cube
+00033a60: 4261 7365 4661 6365 732c 2063 7562 6542  BaseFaces, cubeB
+00033a70: 6173 6545 6467 6573 203d 2067 6574 5f63  aseEdges = get_c
+00033a80: 7562 6528 290d 0a20 2020 2020 2020 2020  ube()..         
+00033a90: 2020 2062 6173 6546 6163 6573 203d 205b     baseFaces = [
+00033aa0: 5d0d 0a20 2020 2020 2020 2020 2020 2062  ]..            b
+00033ab0: 6173 6556 6572 7420 3d20 6375 6265 4261  aseVert = cubeBa
+00033ac0: 7365 5665 7274 2e63 6f70 7928 290d 0a0d  seVert.copy()...
+00033ad0: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+00033ae0: 2066 6163 6520 696e 2063 7562 6542 6173   face in cubeBas
+00033af0: 6546 6163 6573 203a 0d0a 2020 2020 2020  eFaces :..      
+00033b00: 2020 2020 2020 2020 2020 7663 5375 6d20            vcSum 
+00033b10: 3d20 5b30 2c30 2c30 5d0d 0a20 2020 2020  = [0,0,0]..     
+00033b20: 2020 2020 2020 2020 2020 2023 2067 6574             # get
+00033b30: 2073 7175 6172 6520 6661 6365 2063 656e   square face cen
+00033b40: 7465 720d 0a20 2020 2020 2020 2020 2020  ter..           
+00033b50: 2020 2020 2066 6f72 2076 4920 696e 2066       for vI in f
+00033b60: 6163 6520 3a20 7663 5375 6d20 3d20 6e70  ace : vcSum = np
+00033b70: 2e61 6464 2876 6353 756d 2c63 7562 6542  .add(vcSum,cubeB
+00033b80: 6173 6556 6572 745b 7649 5d29 0d0a 2020  aseVert[vI])..  
+00033b90: 2020 2020 2020 2020 2020 2020 2020 7663                vc
+00033ba0: 5375 6d20 3d20 6e70 2e64 6976 6964 6528  Sum = np.divide(
+00033bb0: 7663 5375 6d2c 3429 0d0a 2020 2020 2020  vcSum,4)..      
+00033bc0: 2020 2020 2020 2020 2020 7663 4365 6e74            vcCent
+00033bd0: 6572 203d 2076 6353 756d 2f6e 702e 6c69  er = vcSum/np.li
+00033be0: 6e61 6c67 2e6e 6f72 6d28 7663 5375 6d29  nalg.norm(vcSum)
+00033bf0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00033c00: 2020 7649 6e64 6578 203d 206c 656e 2862    vIndex = len(b
+00033c10: 6173 6556 6572 7429 0d0a 2020 2020 2020  aseVert)..      
+00033c20: 2020 2020 2020 2020 2020 6261 7365 5665            baseVe
+00033c30: 7274 2e61 7070 656e 6428 7663 4365 6e74  rt.append(vcCent
+00033c40: 6572 290d 0a20 2020 2020 2020 2020 2020  er)..           
+00033c50: 2020 2020 2023 2073 7562 6469 7669 6465       # subdivide
+00033c60: 2063 7562 6520 6661 6365 2069 6e74 6f20   cube face into 
+00033c70: 3420 7472 6961 6e67 6c65 730d 0a20 2020  4 triangles..   
+00033c80: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+00033c90: 2069 2069 6e20 7261 6e67 6528 302c 3429   i in range(0,4)
+00033ca0: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
+00033cb0: 2020 2020 2020 2020 6e65 7746 6163 6520          newFace 
+00033cc0: 3d20 5b5d 0d0a 2020 2020 2020 2020 2020  = []..          
+00033cd0: 2020 2020 2020 2020 2020 6e65 7746 6163            newFac
+00033ce0: 652e 6170 7065 6e64 2876 496e 6465 7829  e.append(vIndex)
+00033cf0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00033d00: 2020 2020 2020 6e65 7746 6163 652e 6170        newFace.ap
+00033d10: 7065 6e64 2866 6163 655b 695d 290d 0a20  pend(face[i]).. 
+00033d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033d30: 2020 206e 6577 4661 6365 2e61 7070 656e     newFace.appen
+00033d40: 6428 6661 6365 5b20 2869 2b31 2925 345d  d(face[ (i+1)%4]
+00033d50: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00033d60: 2020 2020 2020 2062 6173 6546 6163 6573         baseFaces
+00033d70: 2e61 7070 656e 6428 6e65 7746 6163 6529  .append(newFace)
+00033d80: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+00033d90: 466f 203d 206c 656e 2862 6173 6546 6163  Fo = len(baseFac
+00033da0: 6573 290d 0a20 2020 2020 2020 2020 2020  es)..           
+00033db0: 2072 6574 7572 6e20 7b20 2762 6173 6546   return { 'baseF
+00033dc0: 6163 6549 6e64 6963 6573 2720 3a20 6261  aceIndices' : ba
+00033dd0: 7365 4661 6365 7320 2c20 2762 6173 6556  seFaces , 'baseV
+00033de0: 6572 7469 6365 7343 6f6f 7227 203a 2062  erticesCoor' : b
+00033df0: 6173 6556 6572 742c 2027 6665 7650 6172  aseVert, 'fevPar
+00033e00: 616d 2720 3a20 5b46 6f2c 302c 325d 207d  am' : [Fo,0,2] }
+00033e10: 0d0a 2020 2020 2020 2020 6465 6620 636f  ..        def co
+00033e20: 6e73 7472 7563 745f 6375 6265 5328 2920  nstruct_cubeS() 
+00033e30: 3a0d 0a20 2020 2020 2020 2020 2020 207a  :..            z
+00033e40: 6574 6120 3d20 312f 330d 0a20 2020 2020  eta = 1/3..     
+00033e50: 2020 2020 2020 2078 3020 3d20 6e70 2e73         x0 = np.s
+00033e60: 7172 7428 3229 2f33 0d0a 2020 2020 2020  qrt(2)/3..      
+00033e70: 2020 2020 2020 7930 203d 2078 302a 6e70        y0 = x0*np
+00033e80: 2e73 7172 7428 3329 0d0a 2020 2020 2020  .sqrt(3)..      
+00033e90: 2020 2020 2020 6368 6920 3d20 322a 7830        chi = 2*x0
+00033ea0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+00033eb0: 736f 6666 203d 2030 2e30 310d 0a20 2020  soff = 0.01..   
+00033ec0: 2020 2020 2020 2020 2078 3053 2c20 7930           x0S, y0
+00033ed0: 5320 3d20 736f 6666 2f32 2c20 736f 6666  S = soff/2, soff
+00033ee0: 2a6e 702e 7371 7274 2833 2e30 292f 322e  *np.sqrt(3.0)/2.
+00033ef0: 300d 0a20 2020 2020 2020 2020 2020 2077  0..            w
+00033f00: 203d 2079 3053 2f32 2e0d 0a0d 0a20 2020   = y0S/2.....   
+00033f10: 2020 2020 2020 2020 2063 7562 6542 6173           cubeBas
+00033f20: 6556 6572 7420 3d20 5b20 5b63 6869 2c2d  eVert = [ [chi,-
+00033f30: 772c 7a65 7461 5d2c 205b 6368 692c 2077  w,zeta], [chi, w
+00033f40: 2c7a 6574 615d 2c0d 0a20 2020 2020 2020  ,zeta],..       
+00033f50: 2020 2020 2020 2020 205b 2d78 302c 7930           [-x0,y0
+00033f60: 2c7a 6574 615d 2c20 2020 5b2d 7830 2c2d  ,zeta],   [-x0,-
+00033f70: 7930 2c7a 6574 615d 2c20 205b 2d63 6869  y0,zeta],  [-chi
+00033f80: 2c30 2c2d 7a65 7461 5d2c 2020 5b78 302c  ,0,-zeta],  [x0,
+00033f90: 2d79 302c 2d7a 6574 615d 2c20 2020 5b78  -y0,-zeta],   [x
+00033fa0: 302c 7930 2c2d 7a65 7461 5d2c 0d0a 2020  0,y0,-zeta],..  
+00033fb0: 2020 2020 2020 2020 2020 2020 2020 5b20                [ 
+00033fc0: 736f 6666 2c20 2020 772c 2031 5d2c 205b  soff,   w, 1], [
+00033fd0: 2020 7830 532c 2079 3053 2c20 315d 2c20    x0S, y0S, 1], 
+00033fe0: 5b20 2d78 3053 2c20 7930 532c 2031 5d2c  [ -x0S, y0S, 1],
+00033ff0: 205b 202d 736f 6666 2c20 2020 302c 2031   [ -soff,   0, 1
+00034000: 5d2c 205b 202d 7830 532c 2d79 3053 2c20  ], [ -x0S,-y0S, 
+00034010: 315d 2c0d 0a20 2020 2020 2020 2020 2020  1],..           
+00034020: 2020 2020 205b 2020 7830 532c 2d79 3053       [  x0S,-y0S
+00034030: 2c20 315d 2c20 5b20 736f 6666 2c20 202d  , 1], [ soff,  -
+00034040: 772c 2031 5d2c 0d0a 2020 2020 2020 2020  w, 1],..        
+00034050: 2020 2020 2020 2020 5b20 736f 6666 2c20          [ soff, 
+00034060: 2020 772c 2d31 5d2c 205b 2020 7830 532c    w,-1], [  x0S,
+00034070: 2079 3053 2c2d 315d 2c20 5b20 2d78 3053   y0S,-1], [ -x0S
+00034080: 2c20 7930 532c 2d31 5d2c 205b 202d 736f  , y0S,-1], [ -so
+00034090: 6666 2c20 2020 302c 2d31 5d2c 205b 202d  ff,   0,-1], [ -
+000340a0: 7830 532c 2d79 3053 2c2d 315d 2c0d 0a20  x0S,-y0S,-1],.. 
+000340b0: 2020 2020 2020 2020 2020 2020 2020 205b                 [
+000340c0: 2020 7830 532c 2d79 3053 2c2d 315d 2c20    x0S,-y0S,-1], 
+000340d0: 5b20 736f 6666 2c20 202d 772c 2d31 5d20  [ soff,  -w,-1] 
+000340e0: 5d0d 0a0d 0a20 2020 2020 2020 2020 2020  ]....           
+000340f0: 2063 7562 6542 6173 6546 6163 6573 3d28   cubeBaseFaces=(
+00034100: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+00034110: 2020 205b 2037 2c20 312c 2036 2c20 385d     [ 7, 1, 6, 8]
+00034120: 2c20 5b20 382c 2036 2c20 322c 2039 5d2c  , [ 8, 6, 2, 9],
+00034130: 205b 2039 2c20 322c 2034 2c31 305d 2c20   [ 9, 2, 4,10], 
+00034140: 5b31 302c 2034 2c20 332c 3131 5d2c 205b  [10, 4, 3,11], [
+00034150: 3131 2c20 332c 2035 2c31 325d 2c20 5b31  11, 3, 5,12], [1
+00034160: 322c 2035 2c20 302c 3133 5d2c 200d 0a20  2, 5, 0,13], .. 
+00034170: 2020 2020 2020 2020 2020 2020 2020 205b                 [
+00034180: 3134 2c31 352c 2036 2c20 315d 2c20 5b31  14,15, 6, 1], [1
+00034190: 352c 3136 2c20 322c 2036 5d2c 205b 3136  5,16, 2, 6], [16
+000341a0: 2c31 372c 2034 2c20 325d 2c20 5b31 372c  ,17, 4, 2], [17,
+000341b0: 3138 2c20 332c 2034 5d2c 205b 3138 2c31  18, 3, 4], [18,1
+000341c0: 392c 2035 2c20 335d 2c20 5b31 392c 3230  9, 5, 3], [19,20
+000341d0: 2c20 302c 2035 5d20 290d 0a20 2020 2020  , 0, 5] )..     
+000341e0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+000341f0: 2020 2020 2062 6173 6546 6163 6573 203d       baseFaces =
+00034200: 205b 5d0d 0a20 2020 2020 2020 2020 2020   []..           
+00034210: 2062 6173 6556 6572 7420 3d20 6375 6265   baseVert = cube
+00034220: 4261 7365 5665 7274 2e63 6f70 7928 290d  BaseVert.copy().
+00034230: 0a0d 0a20 2020 2020 2020 2020 2020 2066  ...            f
+00034240: 6f72 2066 6163 6520 696e 2063 7562 6542  or face in cubeB
+00034250: 6173 6546 6163 6573 203a 0d0a 2020 2020  aseFaces :..    
+00034260: 2020 2020 2020 2020 2020 2020 7663 5375              vcSu
+00034270: 6d20 3d20 5b30 2c30 2c30 5d0d 0a20 2020  m = [0,0,0]..   
+00034280: 2020 2020 2020 2020 2020 2020 2023 2067               # g
+00034290: 6574 2073 7175 6172 6520 6661 6365 2063  et square face c
+000342a0: 656e 7465 720d 0a20 2020 2020 2020 2020  enter..         
+000342b0: 2020 2020 2020 2066 6f72 2076 4920 696e         for vI in
+000342c0: 2066 6163 6520 3a20 7663 5375 6d20 3d20   face : vcSum = 
+000342d0: 6e70 2e61 6464 2876 6353 756d 2c63 7562  np.add(vcSum,cub
+000342e0: 6542 6173 6556 6572 745b 7649 5d29 0d0a  eBaseVert[vI])..
+000342f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034300: 7663 5375 6d20 3d20 6e70 2e64 6976 6964  vcSum = np.divid
+00034310: 6528 7663 5375 6d2c 3429 0d0a 2020 2020  e(vcSum,4)..    
+00034320: 2020 2020 2020 2020 2020 2020 7663 4365              vcCe
+00034330: 6e74 6572 203d 2076 6353 756d 2f6e 702e  nter = vcSum/np.
+00034340: 6c69 6e61 6c67 2e6e 6f72 6d28 7663 5375  linalg.norm(vcSu
+00034350: 6d29 0d0a 2020 2020 2020 2020 2020 2020  m)..            
+00034360: 2020 2020 7649 6e64 6578 203d 206c 656e      vIndex = len
+00034370: 2862 6173 6556 6572 7429 0d0a 2020 2020  (baseVert)..    
+00034380: 2020 2020 2020 2020 2020 2020 6261 7365              base
+00034390: 5665 7274 2e61 7070 656e 6428 7663 4365  Vert.append(vcCe
+000343a0: 6e74 6572 290d 0a20 2020 2020 2020 2020  nter)..         
+000343b0: 2020 2020 2020 2023 2073 7562 6469 7669         # subdivi
+000343c0: 6465 2063 7562 6520 6661 6365 2069 6e74  de cube face int
+000343d0: 6f20 3420 7472 6961 6e67 6c65 730d 0a20  o 4 triangles.. 
+000343e0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+000343f0: 6f72 2069 2069 6e20 7261 6e67 6528 302c  or i in range(0,
+00034400: 3429 203a 0d0a 2020 2020 2020 2020 2020  4) :..          
+00034410: 2020 2020 2020 2020 2020 6e65 7746 6163            newFac
+00034420: 6520 3d20 5b5d 0d0a 2020 2020 2020 2020  e = []..        
+00034430: 2020 2020 2020 2020 2020 2020 6e65 7746              newF
+00034440: 6163 652e 6170 7065 6e64 2876 496e 6465  ace.append(vInde
+00034450: 7829 0d0a 2020 2020 2020 2020 2020 2020  x)..            
+00034460: 2020 2020 2020 2020 6e65 7746 6163 652e          newFace.
+00034470: 6170 7065 6e64 2866 6163 655b 695d 290d  append(face[i]).
+00034480: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00034490: 2020 2020 206e 6577 4661 6365 2e61 7070       newFace.app
+000344a0: 656e 6428 6661 6365 5b20 2869 2b31 2925  end(face[ (i+1)%
+000344b0: 345d 290d 0a20 2020 2020 2020 2020 2020  4])..           
+000344c0: 2020 2020 2020 2020 2062 6173 6546 6163           baseFac
+000344d0: 6573 2e61 7070 656e 6428 6e65 7746 6163  es.append(newFac
+000344e0: 6529 0d0a 0d0a 2020 2020 2020 2020 2020  e)....          
+000344f0: 2020 466f 203d 206c 656e 2862 6173 6546    Fo = len(baseF
+00034500: 6163 6573 290d 0a20 2020 2020 2020 2020  aces)..         
+00034510: 2020 2072 6574 7572 6e20 7b20 2762 6173     return { 'bas
+00034520: 6546 6163 6549 6e64 6963 6573 2720 3a20  eFaceIndices' : 
+00034530: 6261 7365 4661 6365 7320 2c20 2762 6173  baseFaces , 'bas
+00034540: 6556 6572 7469 6365 7343 6f6f 7227 203a  eVerticesCoor' :
+00034550: 2062 6173 6556 6572 742c 2027 6665 7650   baseVert, 'fevP
+00034560: 6172 616d 2720 3a20 5b46 6f2c 382c 315d  aram' : [Fo,8,1]
+00034570: 207d 0d0a 2020 2020 2020 2020 6465 6620   }..        def 
+00034580: 636f 6e73 7472 7563 745f 6f63 7461 6865  construct_octahe
+00034590: 6472 6f6e 2829 3a0d 0a20 2020 2020 2020  dron():..       
+000345a0: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
+000345b0: 2020 2062 6173 6556 6572 7420 3d20 5b20     baseVert = [ 
+000345c0: 5b30 2c30 2c31 5d2c 0d0a 2020 2020 2020  [0,0,1],..      
+000345d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000345e0: 2020 205b 312c 302c 305d 2c20 5b30 2c31     [1,0,0], [0,1
+000345f0: 2c30 5d2c 205b 2d31 2c30 2c30 5d2c 205b  ,0], [-1,0,0], [
+00034600: 302c 2d31 2c30 5d2c 0d0a 2020 2020 2020  0,-1,0],..      
+00034610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034620: 2020 205b 302c 302c 2d31 5d20 5d0d 0a0d     [0,0,-1] ]...
+00034630: 0a20 2020 2020 2020 2020 2020 2062 6173  .            bas
+00034640: 6546 6163 6573 3d28 5b30 2c31 2c32 5d2c  eFaces=([0,1,2],
+00034650: 5b30 2c32 2c33 5d2c 5b30 2c33 2c34 5d2c  [0,2,3],[0,3,4],
+00034660: 5b30 2c34 2c31 5d2c 0d0a 2020 2020 2020  [0,4,1],..      
+00034670: 2020 2020 2020 2020 2020 5b35 2c32 2c31            [5,2,1
+00034680: 5d2c 5b35 2c33 2c32 5d2c 5b35 2c34 2c33  ],[5,3,2],[5,4,3
+00034690: 5d2c 5b35 2c31 2c34 5d29 0d0a 0d0a 2020  ],[5,1,4])....  
+000346a0: 2020 2020 2020 2020 2020 466f 203d 206c            Fo = l
+000346b0: 656e 2862 6173 6546 6163 6573 290d 0a0d  en(baseFaces)...
+000346c0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+000346d0: 7572 6e20 7b20 2762 6173 6546 6163 6549  urn { 'baseFaceI
+000346e0: 6e64 6963 6573 2720 3a20 6261 7365 4661  ndices' : baseFa
+000346f0: 6365 7320 2c20 2762 6173 6556 6572 7469  ces , 'baseVerti
+00034700: 6365 7343 6f6f 7227 203a 2062 6173 6556  cesCoor' : baseV
+00034710: 6572 742c 2027 6665 7650 6172 616d 2720  ert, 'fevParam' 
+00034720: 3a20 5b46 6f2c 302c 325d 207d 0d0a 2020  : [Fo,0,2] }..  
+00034730: 2020 2020 2020 6465 6620 636f 6e73 7472        def constr
+00034740: 7563 745f 6f63 7461 6865 6472 6f6e 5328  uct_octahedronS(
+00034750: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+00034760: 736f 6666 203d 2030 2e30 310d 0a0d 0a20  soff = 0.01.... 
+00034770: 2020 2020 2020 2020 2020 2062 6173 6556             baseV
+00034780: 6572 7453 203d 205b 5d0d 0a20 2020 2020  ertS = []..     
+00034790: 2020 2020 2020 2078 3053 2c20 7930 5320         x0S, y0S 
+000347a0: 3d20 736f 6666 2f6e 702e 7371 7274 2832  = soff/np.sqrt(2
+000347b0: 2e30 292c 2073 6f66 662f 6e70 2e73 7172  .0), soff/np.sqr
+000347c0: 7428 322e 3029 0d0a 0d0a 2020 2020 2020  t(2.0)....      
+000347d0: 2020 2020 2020 6261 7365 5665 7274 5320        baseVertS 
+000347e0: 3d20 5b20 5b31 2c2d 7930 532c 305d 2c0d  = [ [1,-y0S,0],.
+000347f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00034800: 2020 2020 2020 2020 2020 205b 312c 2079             [1, y
+00034810: 3053 2c30 5d2c 2020 2020 2020 205b 302c  0S,0],       [0,
+00034820: 312c 305d 2c20 2020 2020 2020 205b 2d31  1,0],        [-1
+00034830: 2c30 2c30 5d2c 2020 2020 2020 2020 5b30  ,0,0],        [0
+00034840: 2c2d 312c 305d 2c0d 0a20 2020 2020 2020  ,-1,0],..       
+00034850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034860: 2020 205b 2078 3053 2c20 2079 3053 2c20     [ x0S,  y0S, 
+00034870: 315d 2c20 5b2d 7830 532c 2020 7930 532c  1], [-x0S,  y0S,
+00034880: 2031 5d2c 205b 2d78 3053 2c20 2d79 3053   1], [-x0S, -y0S
+00034890: 2c20 315d 2c20 5b20 7830 532c 202d 7930  , 1], [ x0S, -y0
+000348a0: 532c 2031 5d2c 0d0a 2020 2020 2020 2020  S, 1],..        
+000348b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000348c0: 2020 5b20 7830 532c 2020 7930 532c 2d31    [ x0S,  y0S,-1
+000348d0: 5d2c 205b 2d78 3053 2c20 2079 3053 2c2d  ], [-x0S,  y0S,-
+000348e0: 315d 2c20 5b2d 7830 532c 202d 7930 532c  1], [-x0S, -y0S,
+000348f0: 2d31 5d2c 205b 2078 3053 2c20 2d79 3053  -1], [ x0S, -y0S
+00034900: 2c2d 315d 205d 0d0a 0d0a 2020 2020 2020  ,-1] ]....      
+00034910: 2020 2020 2020 6261 7365 4661 6365 7353        baseFacesS
+00034920: 3d28 205b 352c 312c 325d 2c20 5b36 2c32  =( [5,1,2], [6,2
+00034930: 2c33 5d2c 205b 372c 332c 345d 2c20 5b38  ,3], [7,3,4], [8
+00034940: 2c34 2c30 5d2c 0d0a 2020 2020 2020 2020  ,4,0],..        
+00034950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034960: 205b 322c 362c 355d 2c20 5b33 2c37 2c36   [2,6,5], [3,7,6
+00034970: 5d2c 205b 342c 382c 375d 2c0d 0a20 2020  ], [4,8,7],..   
+00034980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034990: 2020 2020 2020 5b39 2c32 2c31 5d2c 205b        [9,2,1], [
+000349a0: 3130 2c33 2c32 5d2c 205b 3131 2c34 2c33  10,3,2], [11,4,3
+000349b0: 5d2c 205b 3132 2c30 2c34 5d2c 0d0a 2020  ], [12,0,4],..  
+000349c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000349d0: 2020 2020 2020 205b 322c 392c 3130 5d2c         [2,9,10],
+000349e0: 205b 332c 3130 2c31 315d 2c20 5b34 2c31   [3,10,11], [4,1
+000349f0: 312c 3132 5d20 290d 0a0d 0a20 2020 2020  1,12] )....     
+00034a00: 2020 2020 2020 2046 6f53 203d 206c 656e         FoS = len
+00034a10: 2862 6173 6546 6163 6573 5329 0d0a 0d0a  (baseFacesS)....
+00034a20: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00034a30: 726e 207b 2027 6261 7365 4661 6365 496e  rn { 'baseFaceIn
+00034a40: 6469 6365 7327 203a 2062 6173 6546 6163  dices' : baseFac
+00034a50: 6573 5320 2c20 2762 6173 6556 6572 7469  esS , 'baseVerti
+00034a60: 6365 7343 6f6f 7227 203a 2062 6173 6556  cesCoor' : baseV
+00034a70: 6572 7453 2c20 2766 6576 5061 7261 6d27  ertS, 'fevParam'
+00034a80: 203a 205b 466f 532c 352c 315d 207d 0d0a   : [FoS,5,1] }..
+00034a90: 2020 2020 2020 2020 6465 6620 636f 6e73          def cons
+00034aa0: 7472 7563 745f 646f 6465 6361 6865 6472  truct_dodecahedr
+00034ab0: 6f6e 2829 203a 0d0a 2020 2020 2020 2020  on() :..        
+00034ac0: 2020 2020 646f 6362 6173 6556 6572 742c      docbaseVert,
+00034ad0: 2064 6f63 6261 7365 4661 6365 732c 2064   docbaseFaces, d
+00034ae0: 6f63 6261 7365 4564 6765 7320 3d20 6765  ocbaseEdges = ge
+00034af0: 745f 646f 6465 6361 6865 6472 6f6e 2829  t_dodecahedron()
+00034b00: 0d0a 2020 2020 2020 2020 2020 2020 6261  ..            ba
+00034b10: 7365 4661 6365 7320 3d20 5b5d 0d0a 2020  seFaces = []..  
+00034b20: 2020 2020 2020 2020 2020 6261 7365 5665            baseVe
+00034b30: 7274 203d 2064 6f63 6261 7365 5665 7274  rt = docbaseVert
+00034b40: 2e63 6f70 7928 290d 0a20 2020 2020 2020  .copy()..       
+00034b50: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
+00034b60: 2020 2066 6f72 2066 6163 6520 696e 2064     for face in d
+00034b70: 6f63 6261 7365 4661 6365 7320 3a0d 0a20  ocbaseFaces :.. 
+00034b80: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+00034b90: 6353 756d 203d 205b 302c 302c 305d 0d0a  cSum = [0,0,0]..
+00034ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034bb0: 2320 6765 7420 7065 6e74 6167 6f6e 2066  # get pentagon f
+00034bc0: 6163 6520 6365 6e74 6572 0d0a 2020 2020  ace center..    
+00034bd0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00034be0: 7649 2069 6e20 6661 6365 203a 2076 6353  vI in face : vcS
+00034bf0: 756d 203d 206e 702e 6164 6428 7663 5375  um = np.add(vcSu
+00034c00: 6d2c 646f 6362 6173 6556 6572 745b 7649  m,docbaseVert[vI
+00034c10: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
+00034c20: 2020 2020 7663 5375 6d20 3d20 6e70 2e64      vcSum = np.d
+00034c30: 6976 6964 6528 7663 5375 6d2c 3429 0d0a  ivide(vcSum,4)..
+00034c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034c50: 7663 4365 6e74 6572 203d 2076 6353 756d  vcCenter = vcSum
+00034c60: 2f6e 702e 6c69 6e61 6c67 2e6e 6f72 6d28  /np.linalg.norm(
+00034c70: 7663 5375 6d29 0d0a 2020 2020 2020 2020  vcSum)..        
+00034c80: 2020 2020 2020 2020 7649 6e64 6578 203d          vIndex =
+00034c90: 206c 656e 2862 6173 6556 6572 7429 0d0a   len(baseVert)..
+00034ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034cb0: 6261 7365 5665 7274 2e61 7070 656e 6428  baseVert.append(
+00034cc0: 7663 4365 6e74 6572 290d 0a20 2020 2020  vcCenter)..     
+00034cd0: 2020 2020 2020 2020 2020 2023 2073 7562             # sub
+00034ce0: 6469 7669 6465 2070 656e 7461 676f 6e20  divide pentagon 
+00034cf0: 6661 6365 2069 6e74 6f20 3520 7472 6961  face into 5 tria
+00034d00: 6e67 6c65 730d 0a20 2020 2020 2020 2020  ngles..         
+00034d10: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
+00034d20: 7261 6e67 6528 302c 3529 203a 0d0a 2020  range(0,5) :..  
+00034d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034d40: 2020 6e65 7746 6163 6520 3d20 5b5d 0d0a    newFace = []..
+00034d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034d60: 2020 2020 6e65 7746 6163 652e 6170 7065      newFace.appe
+00034d70: 6e64 2876 496e 6465 7829 0d0a 2020 2020  nd(vIndex)..    
+00034d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034d90: 6e65 7746 6163 652e 6170 7065 6e64 2866  newFace.append(f
+00034da0: 6163 655b 695d 290d 0a20 2020 2020 2020  ace[i])..       
+00034db0: 2020 2020 2020 2020 2020 2020 206e 6577               new
+00034dc0: 4661 6365 2e61 7070 656e 6428 6661 6365  Face.append(face
+00034dd0: 5b20 2869 2b31 2925 355d 290d 0a20 2020  [ (i+1)%5])..   
+00034de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034df0: 2062 6173 6546 6163 6573 2e61 7070 656e   baseFaces.appen
+00034e00: 6428 6e65 7746 6163 6529 0d0a 0d0a 2020  d(newFace)....  
+00034e10: 2020 2020 2020 2020 2020 466f 203d 206c            Fo = l
+00034e20: 656e 2862 6173 6546 6163 6573 290d 0a20  en(baseFaces).. 
+00034e30: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00034e40: 6e20 7b20 2762 6173 6546 6163 6549 6e64  n { 'baseFaceInd
+00034e50: 6963 6573 2720 3a20 6261 7365 4661 6365  ices' : baseFace
+00034e60: 7320 2c20 2762 6173 6556 6572 7469 6365  s , 'baseVertice
+00034e70: 7343 6f6f 7227 203a 2062 6173 6556 6572  sCoor' : baseVer
+00034e80: 742c 2027 6665 7650 6172 616d 2720 3a20  t, 'fevParam' : 
+00034e90: 5b46 6f2c 302c 325d 207d 0d0a 2020 2020  [Fo,0,2] }..    
+00034ea0: 2020 2020 6465 6620 636f 6e73 7472 7563      def construc
+00034eb0: 745f 6963 6f73 6168 6564 726f 6e28 293a  t_icosahedron():
+00034ec0: 0d0a 2020 2020 2020 2020 2020 2020 6353  ..            cS
+00034ed0: 7172 203d 2028 6e70 2e74 616e 286e 702e  qr = (np.tan(np.
+00034ee0: 7069 2f35 2929 2a28 6e70 2e74 616e 286e  pi/5))*(np.tan(n
+00034ef0: 702e 7069 2f35 2929 0d0a 2020 2020 2020  p.pi/5))..      
+00034f00: 2020 2020 2020 7a65 7461 203d 2028 312d        zeta = (1-
+00034f10: 6353 7172 292f 2832 2a63 5371 7229 0d0a  cSqr)/(2*cSqr)..
+00034f20: 2020 2020 2020 2020 2020 2020 6368 6920              chi 
+00034f30: 3d20 6e70 2e73 7172 7428 332a 6353 7172  = np.sqrt(3*cSqr
+00034f40: 2d31 292a 6e70 2e73 7172 7428 6353 7172  -1)*np.sqrt(cSqr
+00034f50: 2b31 292f 2832 2a63 5371 7229 0d0a 2020  +1)/(2*cSqr)..  
+00034f60: 2020 2020 2020 2020 2020 7468 6574 6149            thetaI
+00034f70: 6e63 203d 2032 2a6e 702e 7069 2f35 0d0a  nc = 2*np.pi/5..
+00034f80: 2020 2020 2020 2020 2020 2020 7468 6574              thet
+00034f90: 614f 6666 203d 2074 6865 7461 496e 632f  aOff = thetaInc/
+00034fa0: 320d 0a0d 0a20 2020 2020 2020 2020 2020  2....           
+00034fb0: 2062 6173 6556 6572 7420 3d20 5b5d 0d0a   baseVert = []..
+00034fc0: 2020 2020 2020 2020 2020 2020 6261 7365              base
+00034fd0: 5665 7274 2e61 7070 656e 6428 5b30 2c30  Vert.append([0,0
+00034fe0: 2c31 5d29 0d0a 2020 2020 2020 2020 2020  ,1])..          
+00034ff0: 2020 666f 7220 6920 696e 2072 616e 6765    for i in range
+00035000: 2830 2c35 2920 3a0d 0a20 2020 2020 2020  (0,5) :..       
+00035010: 2020 2020 2020 2020 2074 6865 7461 203d           theta =
+00035020: 2069 2a74 6865 7461 496e 630d 0a20 2020   i*thetaInc..   
+00035030: 2020 2020 2020 2020 2020 2020 2062 6173               bas
+00035040: 6556 6572 742e 6170 7065 6e64 2820 5b20  eVert.append( [ 
+00035050: 6368 692a 6e70 2e63 6f73 2874 6865 7461  chi*np.cos(theta
+00035060: 292c 2063 6869 2a6e 702e 7369 6e28 7468  ), chi*np.sin(th
+00035070: 6574 6129 2c20 7a65 7461 5d20 290d 0a20  eta), zeta] ).. 
+00035080: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
+00035090: 2069 6e20 7261 6e67 6528 302c 3529 203a   in range(0,5) :
+000350a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000350b0: 2020 7468 6574 6120 3d20 7468 6574 614f    theta = thetaO
+000350c0: 6666 2b69 2a74 6865 7461 496e 630d 0a20  ff+i*thetaInc.. 
+000350d0: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+000350e0: 6173 6556 6572 742e 6170 7065 6e64 2820  aseVert.append( 
+000350f0: 5b20 6368 692a 6e70 2e63 6f73 2874 6865  [ chi*np.cos(the
+00035100: 7461 292c 2063 6869 2a6e 702e 7369 6e28  ta), chi*np.sin(
+00035110: 7468 6574 6129 2c20 2d7a 6574 615d 2029  theta), -zeta] )
+00035120: 0d0a 2020 2020 2020 2020 2020 2020 6261  ..            ba
+00035130: 7365 5665 7274 2e61 7070 656e 6428 5b30  seVert.append([0
+00035140: 2c30 2c2d 315d 290d 0a0d 0a20 2020 2020  ,0,-1])....     
+00035150: 2020 2020 2020 2062 6173 6546 6163 6573         baseFaces
+00035160: 3d28 5b30 2c31 2c32 5d2c 5b30 2c32 2c33  =([0,1,2],[0,2,3
+00035170: 5d2c 5b30 2c33 2c34 5d2c 5b30 2c34 2c35  ],[0,3,4],[0,4,5
+00035180: 5d2c 5b30 2c35 2c31 5d2c 0d0a 2020 2020  ],[0,5,1],..    
+00035190: 2020 2020 2020 2020 2020 2020 5b36 2c32              [6,2
+000351a0: 2c31 5d2c 5b37 2c33 2c32 5d2c 5b38 2c34  ,1],[7,3,2],[8,4
+000351b0: 2c33 5d2c 5b39 2c35 2c34 5d2c 5b31 302c  ,3],[9,5,4],[10,
+000351c0: 312c 355d 2c0d 0a20 2020 2020 2020 2020  1,5],..         
+000351d0: 2020 2020 2020 205b 322c 362c 375d 2c5b         [2,6,7],[
+000351e0: 332c 372c 385d 2c5b 342c 382c 395d 2c5b  3,7,8],[4,8,9],[
+000351f0: 352c 392c 3130 5d2c 5b31 2c31 302c 365d  5,9,10],[1,10,6]
+00035200: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00035210: 2020 205b 3131 2c37 2c36 5d2c 5b31 312c     [11,7,6],[11,
+00035220: 382c 375d 2c5b 3131 2c39 2c38 5d2c 5b31  8,7],[11,9,8],[1
+00035230: 312c 3130 2c39 5d2c 5b31 312c 362c 3130  1,10,9],[11,6,10
+00035240: 5d29 0d0a 0d0a 2020 2020 2020 2020 2020  ])....          
+00035250: 2020 466f 203d 206c 656e 2862 6173 6546    Fo = len(baseF
+00035260: 6163 6573 290d 0a20 2020 2020 2020 2020  aces)..         
+00035270: 2020 2072 6574 7572 6e20 7b20 2762 6173     return { 'bas
+00035280: 6546 6163 6549 6e64 6963 6573 2720 3a20  eFaceIndices' : 
+00035290: 6261 7365 4661 6365 7320 2c20 2762 6173  baseFaces , 'bas
+000352a0: 6556 6572 7469 6365 7343 6f6f 7227 203a  eVerticesCoor' :
+000352b0: 2062 6173 6556 6572 742c 2027 6665 7650   baseVert, 'fevP
+000352c0: 6172 616d 2720 3a20 5b46 6f2c 302c 325d  aram' : [Fo,0,2]
+000352d0: 207d 0d0a 2020 2020 2020 2020 2320 2e2e   }..        # ..
+000352e0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+000352f0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00035300: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00035310: 2e2e 0d0a 2020 2020 2020 2020 6966 2067  ....        if g
+00035320: 6574 4172 7261 7973 203d 3d20 2763 7562  etArrays == 'cub
+00035330: 6527 203a 2072 6574 7572 6e20 6765 745f  e' : return get_
+00035340: 6375 6265 2829 0d0a 2020 2020 2020 2020  cube()..        
+00035350: 6966 2067 6574 4172 7261 7973 203d 3d20  if getArrays == 
+00035360: 2764 6f64 6563 6127 203a 2072 6574 7572  'dodeca' : retur
+00035370: 6e20 6765 745f 646f 6465 6361 6865 6472  n get_dodecahedr
+00035380: 6f6e 2829 0d0a 0d0a 2020 2020 2020 2020  on()....        
+00035390: 7375 7266 6163 6573 4469 6374 696f 6e61  surfacesDictiona
+000353a0: 7279 203d 207b 7d0d 0a20 2020 2020 2020  ry = {}..       
+000353b0: 2073 7572 6661 6365 7344 6963 7469 6f6e   surfacesDiction
+000353c0: 6172 795b 2774 6574 7261 275d 2020 3d20  ary['tetra']  = 
+000353d0: 636f 6e73 7472 7563 745f 7465 7472 6168  construct_tetrah
+000353e0: 6564 726f 6e28 290d 0a20 2020 2020 2020  edron()..       
+000353f0: 2073 7572 6661 6365 7344 6963 7469 6f6e   surfacesDiction
+00035400: 6172 795b 2763 7562 6527 5d20 2020 3d20  ary['cube']   = 
+00035410: 636f 6e73 7472 7563 745f 6375 6265 2829  construct_cube()
+00035420: 0d0a 2020 2020 2020 2020 7375 7266 6163  ..        surfac
+00035430: 6573 4469 6374 696f 6e61 7279 5b27 6375  esDictionary['cu
+00035440: 6265 5f73 275d 203d 2063 6f6e 7374 7275  be_s'] = constru
+00035450: 6374 5f63 7562 6553 2829 0d0a 2020 2020  ct_cubeS()..    
+00035460: 2020 2020 7375 7266 6163 6573 4469 6374      surfacesDict
+00035470: 696f 6e61 7279 5b27 6f63 7461 275d 2020  ionary['octa']  
+00035480: 203d 2063 6f6e 7374 7275 6374 5f6f 6374   = construct_oct
+00035490: 6168 6564 726f 6e28 290d 0a20 2020 2020  ahedron()..     
+000354a0: 2020 2073 7572 6661 6365 7344 6963 7469     surfacesDicti
+000354b0: 6f6e 6172 795b 276f 6374 615f 7327 5d20  onary['octa_s'] 
+000354c0: 3d20 636f 6e73 7472 7563 745f 6f63 7461  = construct_octa
+000354d0: 6865 6472 6f6e 5328 290d 0a20 2020 2020  hedronS()..     
+000354e0: 2020 2073 7572 6661 6365 7344 6963 7469     surfacesDicti
+000354f0: 6f6e 6172 795b 2764 6f64 6563 6127 5d20  onary['dodeca'] 
+00035500: 3d20 636f 6e73 7472 7563 745f 646f 6465  = construct_dode
+00035510: 6361 6865 6472 6f6e 2829 0d0a 2020 2020  cahedron()..    
+00035520: 2020 2020 7375 7266 6163 6573 4469 6374      surfacesDict
+00035530: 696f 6e61 7279 5b27 6963 6f73 6127 5d20  ionary['icosa'] 
+00035540: 203d 2063 6f6e 7374 7275 6374 5f69 636f   = construct_ico
+00035550: 7361 6865 6472 6f6e 2829 0d0a 2020 2020  sahedron()..    
+00035560: 2020 2020 2320 2e2e 2e20 2773 7065 6369      # ... 'speci
+00035570: 616c 2063 6173 6527 206f 6e6c 7920 666f  al case' only fo
+00035580: 7220 6665 7620 6d65 7468 6f64 2066 6f72  r fev method for
+00035590: 2073 7068 6572 6963 616c 2073 7572 6661   spherical surfa
+000355a0: 6365 732e 0d0a 2020 2020 2020 2020 7375  ces...        su
+000355b0: 7266 6163 6573 4469 6374 696f 6e61 7279  rfacesDictionary
+000355c0: 5b27 6f63 7461 5f63 275d 203d 207b 2027  ['octa_c'] = { '
+000355d0: 6665 7650 6172 616d 2720 3a20 5b31 362c  fevParam' : [16,
+000355e0: 352c 315d 207d 0d0a 2020 2020 2020 2020  5,1] }..        
+000355f0: 7375 7266 6163 6573 4469 6374 696f 6e61  surfacesDictiona
+00035600: 7279 5b27 6375 6265 5f63 275d 203d 207b  ry['cube_c'] = {
+00035610: 2027 6665 7650 6172 616d 2720 3a20 5b31   'fevParam' : [1
+00035620: 322c 342c 315d 207d 0d0a 2020 2020 2020  2,4,1] }..      
+00035630: 2020 2320 2e2e 2e20 2773 7065 6369 616c    # ... 'special
+00035640: 2063 6173 6527 206f 6e6c 7920 666f 7220   case' only for 
+00035650: 6665 7620 6d65 7468 6f64 2066 6f72 2070  fev method for p
+00035660: 6c61 746f 6e69 6320 7375 7266 6163 6573  latonic surfaces
+00035670: 2e0d 0a20 2020 2020 2020 2073 7572 6661  ...        surfa
+00035680: 6365 7344 6963 7469 6f6e 6172 795b 2763  cesDictionary['c
+00035690: 7562 655f 6127 5d20 3d20 7b20 2766 6576  ube_a'] = { 'fev
+000356a0: 5061 7261 6d27 203a 205b 3132 2c30 2c32  Param' : [12,0,2
+000356b0: 5d20 7d0d 0a20 2020 2020 2020 2073 7572  ] }..        sur
+000356c0: 6661 6365 7344 6963 7469 6f6e 6172 795b  facesDictionary[
+000356d0: 2763 7562 652a 275d 203d 207b 2027 6665  'cube*'] = { 'fe
+000356e0: 7650 6172 616d 2720 3a20 5b31 322c 302c  vParam' : [12,0,
+000356f0: 325d 207d 0d0a 2020 2020 2020 2020 7375  2] }..        su
+00035700: 7266 6163 6573 4469 6374 696f 6e61 7279  rfacesDictionary
+00035710: 5b27 646f 6465 6361 2a27 5d20 3d20 7b20  ['dodeca*'] = { 
+00035720: 2766 6576 5061 7261 6d27 203a 205b 3336  'fevParam' : [36
+00035730: 2c30 2c32 5d20 7d0d 0a0d 0a20 2020 2020  ,0,2] }....     
+00035740: 2020 2072 6574 7572 6e20 7375 7266 6163     return surfac
+00035750: 6573 4469 6374 696f 6e61 7279 0d0a 0d0a  esDictionary....
+00035760: 2020 2020 4073 7461 7469 636d 6574 686f      @staticmetho
+00035770: 640d 0a20 2020 2064 6566 205f 6d69 6456  d..    def _midV
+00035780: 6563 746f 7246 756e 2876 6563 7441 2c20  ectorFun(vectA, 
+00035790: 7665 6374 4229 203a 0d0a 2020 2020 2020  vectB) :..      
+000357a0: 2020 2222 224d 6964 2d70 6f69 6e74 2062    """Mid-point b
+000357b0: 6574 7765 656e 2074 776f 2070 6f69 6e74  etween two point
+000357c0: 7320 6f6e 2061 2075 6e69 7420 7370 6865  s on a unit sphe
+000357d0: 7265 2e22 2222 0d0a 2020 2020 2020 2020  re."""..        
+000357e0: 6d69 6420 3d20 6e70 2e61 6464 2876 6563  mid = np.add(vec
+000357f0: 7441 2c76 6563 7442 290d 0a20 2020 2020  tA,vectB)..     
+00035800: 2020 2072 6574 7572 6e20 6d69 642f 6e70     return mid/np
+00035810: 2e6c 696e 616c 672e 6e6f 726d 286d 6964  .linalg.norm(mid
+00035820: 290d 0a20 2020 200d 0a20 2020 2040 7374  )..    ..    @st
+00035830: 6174 6963 6d65 7468 6f64 0d0a 2020 2020  aticmethod..    
+00035840: 6465 6620 5f6d 6170 3344 746f 3244 7371  def _map3Dto2Dsq
+00035850: 7561 7265 2878 797a 2920 3a0d 0a20 2020  uare(xyz) :..   
+00035860: 2020 2020 2022 2222 4f76 6572 7269 6465       """Override
+00035870: 206d 6170 2073 7572 6661 6365 2074 6f20   map surface to 
+00035880: 7265 6374 6167 756c 6172 2075 6e69 7420  rectagular unit 
+00035890: 636f 6f72 6469 6e61 7465 7320 2830 2c31  coordinates (0,1
+000358a0: 292e 2222 220d 0a20 2020 2020 2020 2078  )."""..        x
+000358b0: 2c79 2c7a 203d 2078 797a 0d0a 2020 2020  ,y,z = xyz..    
+000358c0: 2020 2020 7420 3d20 6e70 2e61 7263 7461      t = np.arcta
+000358d0: 6e32 2879 2c78 290d 0a20 2020 2020 2020  n2(y,x)..       
+000358e0: 2074 6865 7461 203d 206e 702e 7768 6572   theta = np.wher
+000358f0: 6528 2074 3c30 2c20 322e 302a 6e70 2e70  e( t<0, 2.0*np.p
+00035900: 6920 2b20 7420 2c74 290d 0a20 2020 2020  i + t ,t)..     
+00035910: 2020 2070 6869 203d 206e 702e 6172 6373     phi = np.arcs
+00035920: 696e 287a 290d 0a20 2020 2020 2020 2061  in(z)..        a
+00035930: 203d 2074 6865 7461 2f28 322a 6e70 2e70   = theta/(2*np.p
+00035940: 6929 0d0a 2020 2020 2020 2020 6220 3d20  i)..        b = 
+00035950: 2070 6869 2f6e 702e 7069 202b 2030 2e35   phi/np.pi + 0.5
+00035960: 0d0a 2020 2020 2020 2020 6120 3d20 6e70  ..        a = np
+00035970: 2e63 6c69 7028 612c 302e 302c 312e 3029  .clip(a,0.0,1.0)
+00035980: 200d 0a20 2020 2020 2020 2062 203d 206e   ..        b = n
+00035990: 702e 636c 6970 2862 2c30 2e30 2c31 2e30  p.clip(b,0.0,1.0
+000359a0: 2920 0d0a 2020 2020 2020 2020 7265 7475  ) ..        retu
+000359b0: 726e 205b 612c 625d 0d0a 0d0a 2020 2020  rn [a,b]....    
+000359c0: 4073 7461 7469 636d 6574 686f 640d 0a20  @staticmethod.. 
+000359d0: 2020 2064 6566 2063 6f6f 725f 636f 6e76     def coor_conv
+000359e0: 6572 7428 7879 7a2c 2074 6f63 6172 743d  ert(xyz, tocart=
+000359f0: 4661 6c73 6529 203a 0d0a 2020 2020 2020  False) :..      
+00035a00: 2020 2222 220d 0a20 2020 2020 2020 2054    """..        T
+00035a10: 7261 6e73 666f 726d 6174 696f 6e20 6265  ransformation be
+00035a20: 7477 6565 6e20 7370 6865 7269 6361 6c20  tween spherical 
+00035a30: 616e 6420 4361 7274 6573 6961 6e20 636f  and Cartesian co
+00035a40: 6f72 6469 6e61 7465 732e 0d0a 2020 2020  ordinates...    
+00035a50: 2020 2020 5468 6520 617a 696d 7574 6861      The azimutha
+00035a60: 6c20 636f 6f72 6469 6e61 7465 2069 7320  l coordinate is 
+00035a70: 696e 2072 6164 6961 6e73 2077 6974 6820  in radians with 
+00035a80: 646f 6d61 696e 2030 2074 6f20 3270 692e  domain 0 to 2pi.
+00035a90: 0d0a 2020 2020 2020 2020 5468 6520 706f  ..        The po
+00035aa0: 6c61 7220 616e 676c 6520 6973 2069 6e20  lar angle is in 
+00035ab0: 7261 6469 616e 7320 7769 7468 2064 6f6d  radians with dom
+00035ac0: 6169 6e20 3020 746f 2070 692e 0d0a 0d0a  ain 0 to pi.....
+00035ad0: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+00035ae0: 7273 0d0a 2020 2020 2020 2020 2d2d 2d2d  rs..        ----
+00035af0: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
+00035b00: 7879 7a20 3a20 3378 4e20 6172 7261 790d  xyz : 3xN array.
+00035b10: 0a20 2020 2020 2020 2020 2020 204e 206e  .            N n
+00035b20: 756d 6265 7220 6f66 2076 6563 746f 7273  umber of vectors
+00035b30: 2069 6e20 6569 7468 6572 2073 7068 6572   in either spher
+00035b40: 6963 616c 206f 7220 6361 7274 6573 6961  ical or cartesia
+00035b50: 6e20 636f 6f72 6469 6e61 7465 732c 0d0a  n coordinates,..
+00035b60: 0d0a 2020 2020 2020 2020 746f 6361 7274  ..        tocart
+00035b70: 203a 207b 2054 7275 652c 2046 616c 7365   : { True, False
+00035b80: 207d 2c20 6465 6661 756c 743a 2046 616c   }, default: Fal
+00035b90: 7365 0d0a 2020 2020 2020 2020 2020 2020  se..            
+00035ba0: 4966 2054 7275 652c 2069 6e70 7574 2069  If True, input i
+00035bb0: 7320 7370 6865 7269 6361 6c20 616e 6420  s spherical and 
+00035bc0: 6f75 7470 7574 2069 7320 6361 7274 6573  output is cartes
+00035bd0: 6961 6e2e 0d0a 2020 2020 2020 2020 2020  ian...          
+00035be0: 2020 4966 2046 616c 7365 2c20 696e 7075    If False, inpu
+00035bf0: 7420 6973 2063 6172 7465 7369 616e 2061  t is cartesian a
+00035c00: 6e64 206f 7574 7075 7420 6973 2073 7068  nd output is sph
+00035c10: 6572 6963 616c 2e0d 0a0d 0a20 2020 2020  erical.....     
+00035c20: 2020 2052 6574 7572 6e73 0d0a 2020 2020     Returns..    
+00035c30: 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020      -------..   
+00035c40: 2020 2020 206c 6973 743a 2033 784e 2061       list: 3xN a
+00035c50: 7272 6179 0d0a 2020 2020 2020 2020 2020  rray..          
+00035c60: 2020 5472 616e 7366 6f72 6d65 6420 636f    Transformed co
+00035c70: 6f72 6469 6e61 7465 732e 200d 0a0d 0a20  ordinates. .... 
+00035c80: 2020 2020 2020 2022 2222 0d0a 0d0a 2020         """....  
+00035c90: 2020 2020 2020 6966 2074 6f63 6172 7420        if tocart 
+00035ca0: 3a0d 0a20 2020 2020 2020 2020 2020 2072  :..            r
+00035cb0: 2c20 7468 6574 612c 2070 6869 203d 2078  , theta, phi = x
+00035cc0: 797a 0d0a 2020 2020 2020 2020 2020 2020  yz..            
+00035cd0: 7820 3d20 722a 6e70 2e73 696e 2870 6869  x = r*np.sin(phi
+00035ce0: 292a 6e70 2e63 6f73 2874 6865 7461 290d  )*np.cos(theta).
+00035cf0: 0a20 2020 2020 2020 2020 2020 2079 203d  .            y =
+00035d00: 2072 2a6e 702e 7369 6e28 7068 6929 2a6e   r*np.sin(phi)*n
+00035d10: 702e 7369 6e28 7468 6574 6129 0d0a 2020  p.sin(theta)..  
+00035d20: 2020 2020 2020 2020 2020 7a20 3d20 722a            z = r*
+00035d30: 6e70 2e63 6f73 2870 6869 290d 0a20 2020  np.cos(phi)..   
+00035d40: 2020 2020 2020 2020 2061 6263 203d 205b           abc = [
+00035d50: 782c 792c 7a5d 0d0a 2020 2020 2020 2020  x,y,z]..        
+00035d60: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+00035d70: 2020 2078 2c79 2c7a 203d 2078 797a 0d0a     x,y,z = xyz..
+00035d80: 2020 2020 2020 2020 2020 2020 5220 3d20              R = 
+00035d90: 6e70 2e73 7172 7428 2078 2a78 202b 2079  np.sqrt( x*x + y
+00035da0: 2a79 202b 207a 2a7a 2029 0d0a 2020 2020  *y + z*z )..    
+00035db0: 2020 2020 2020 2020 7068 6920 3d20 6e70          phi = np
+00035dc0: 2e6e 616e 5f74 6f5f 6e75 6d28 6e70 2e61  .nan_to_num(np.a
+00035dd0: 7263 636f 7328 7a2f 5229 290d 0a20 2020  rccos(z/R))..   
+00035de0: 2020 2020 2020 2020 2074 6865 7461 203d           theta =
+00035df0: 206e 702e 6172 6374 616e 3228 792c 7829   np.arctan2(y,x)
+00035e00: 0d0a 2020 2020 2020 2020 2020 2020 7468  ..            th
+00035e10: 6574 6120 3d20 6e70 2e77 6865 7265 2874  eta = np.where(t
+00035e20: 6865 7461 3c30 2c74 6865 7461 2b32 2a6e  heta<0,theta+2*n
+00035e30: 702e 7069 2c74 6865 7461 290d 0a20 2020  p.pi,theta)..   
+00035e40: 2020 2020 2020 2020 2061 6263 203d 205b           abc = [
+00035e50: 522c 7468 6574 612c 7068 695d 0d0a 2020  R,theta,phi]..  
+00035e60: 2020 2020 2020 6162 6320 3d20 6e70 2e61        abc = np.a
+00035e70: 7272 6179 2861 6263 290d 0a20 2020 2020  rray(abc)..     
+00035e80: 2020 2072 6574 7572 6e20 6162 630d 0a0d     return abc...
+00035e90: 0a20 2020 205f 6261 7365 5f73 7572 6661  .    _base_surfa
+00035ea0: 6365 7320 3d20 5f67 6574 5f70 6c61 746f  ces = _get_plato
+00035eb0: 6e69 635f 736f 6c69 6473 5f64 6963 7469  nic_solids_dicti
+00035ec0: 6f6e 6172 792e 5f5f 6675 6e63 5f5f 2829  onary.__func__()
+00035ed0: 0d0a 2020 2020 5f64 6566 6175 6c74 5f62  ..    _default_b
+00035ee0: 6173 6520 3d20 2769 636f 7361 2720 2023  ase = 'icosa'  #
+00035ef0: 2064 6566 6175 6c74 2061 7373 6967 6e6d   default assignm
+00035f00: 656e 7420 6973 2069 6e64 6963 6174 6564  ent is indicated
+00035f10: 2069 6e20 5f5f 696e 6974 2044 6f63 7374   in __init Docst
+00035f20: 7269 6e67 2e0d 0a20 2020 205f 6765 6f6d  ring...    _geom
+00035f30: 5479 7065 203d 205f 434f 4f52 5359 535b  Type = _COORSYS[
+00035f40: 2753 5048 4552 4943 414c 275d 0d0a 0d0a  'SPHERICAL']....
+00035f50: 2020 2020 4063 6c61 7373 6d65 7468 6f64      @classmethod
+00035f60: 0d0a 2020 2020 6465 6620 5f75 7677 5f74  ..    def _uvw_t
+00035f70: 6f5f 7879 7a28 636c 732c 2075 7677 2c20  o_xyz(cls, uvw, 
+00035f80: 7274 7029 203a 0d0a 2020 2020 2020 2020  rtp) :..        
+00035f90: 2222 224f 7665 7272 6964 6520 726f 7461  """Override rota
+00035fa0: 7469 6f6e 616c 2074 7261 6e73 666f 726d  tional transform
+00035fb0: 6174 696f 6e20 6174 2061 2073 7068 6572  ation at a spher
+00035fc0: 6963 616c 2063 6f6f 7264 696e 6174 652e  ical coordinate.
+00035fd0: 2222 2220 0d0a 2020 2020 2020 2020 7265  """ ..        re
+00035fe0: 7475 726e 2073 7570 6572 2829 2e5f 6469  turn super()._di
+00035ff0: 7370 5f74 6f5f 7879 7a28 2075 7677 2c20  sp_to_xyz( uvw, 
+00036000: 7274 705b 315d 2c20 7274 705b 325d 2029  rtp[1], rtp[2] )
+00036010: 0d0a 0d0a 2020 2020 4063 6c61 7373 6d65  ....    @classme
+00036020: 7468 6f64 0d0a 2020 2020 6465 6620 6772  thod..    def gr
+00036030: 6964 2863 6c73 2c6e 6c61 742c 206e 6c6e  id(cls,nlat, nln
+00036040: 672c 2062 6173 6574 7970 653d 2764 272c  g, basetype='d',
+00036050: 206d 696e 7261 643d 4e6f 6e65 2c20 6e61   minrad=None, na
+00036060: 6d65 3d4e 6f6e 652c 202a 2a6b 7761 7267  me=None, **kwarg
+00036070: 7329 203a 0d0a 2020 2020 2020 2020 2222  s) :..        ""
+00036080: 220d 0a20 2020 2020 2020 2053 7068 6572  "..        Spher
+00036090: 6963 616c 5375 7266 6163 6520 7769 7468  icalSurface with
+000360a0: 206c 6174 6974 7564 6520 616e 6420 6c6f   latitude and lo
+000360b0: 6e67 6974 7564 6520 6661 6365 732e 0d0a  ngitude faces...
+000360c0: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
+000360d0: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
+000360e0: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
+000360f0: 2020 6e6c 6174 203a 2069 6e74 6567 6572    nlat : integer
+00036100: 2c20 7265 7175 6972 6564 2e0d 0a20 2020  , required...   
+00036110: 2020 2020 2020 2020 204e 756d 6265 7220           Number 
+00036120: 6f66 206c 6174 6974 7564 6520 7375 6264  of latitude subd
+00036130: 6976 6973 696f 6e73 2e20 204d 696e 696d  ivisions.  Minim
+00036140: 756d 2076 616c 7565 2069 7320 320d 0a0d  um value is 2...
+00036150: 0a20 2020 2020 2020 206e 6c6e 6720 3a20  .        nlng : 
+00036160: 696e 7465 6765 722c 2072 6571 7569 7265  integer, require
+00036170: 642e 0d0a 2020 2020 2020 2020 2020 2020  d...            
+00036180: 4e75 6d62 6572 206f 6620 6c6f 6e67 6974  Number of longit
+00036190: 7564 6520 7375 6264 6976 6973 696f 6e73  ude subdivisions
+000361a0: 2e20 4d69 6e69 6d75 6d20 7661 6c75 6520  . Minimum value 
+000361b0: 6973 2033 2e0d 0a0d 0a20 2020 2020 2020  is 3.....       
+000361c0: 2062 6173 6574 7970 6520 3a20 7b27 6427   basetype : {'d'
+000361d0: 2c27 7327 2c27 7127 2c27 7727 2c27 7227  ,'s','q','w','r'
+000361e0: 2c27 7827 7d2c 206f 7074 696f 6e61 6c2c  ,'x'}, optional,
+000361f0: 2064 6566 6175 6c74 3a20 2764 270d 0a20   default: 'd'.. 
+00036200: 2020 2020 2020 2020 2020 2053 7461 7274             Start
+00036210: 696e 6720 7375 7266 6163 6520 6765 6f6d  ing surface geom
+00036220: 6574 7269 6573 2066 726f 6d20 7768 6963  etries from whic
+00036230: 6820 7468 6520 7375 7266 6163 6520 6973  h the surface is
+00036240: 0d0a 2020 2020 2020 2020 2020 2020 636f  ..            co
+00036250: 6e73 7472 7563 7465 6420 696e 6469 6361  nstructed indica
+00036260: 7469 6e67 2066 6163 6520 7368 6170 6520  ting face shape 
+00036270: 616e 6420 6966 2073 706c 6974 2e0d 0a20  and if split... 
+00036280: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00036290: 206d 696e 7261 6420 3a20 7363 616c 6172   minrad : scalar
+000362a0: 2c20 6f70 7469 6f6e 616c 2c20 6465 6661  , optional, defa
+000362b0: 756c 743a 2030 2e30 310d 0a20 2020 2020  ult: 0.01..     
+000362c0: 2020 2020 2020 2054 6865 206d 696e 696d         The minim
+000362d0: 756d 2064 6973 7461 6e63 6520 6672 6f6d  um distance from
+000362e0: 2074 6865 207a 2d61 7869 7320 6f66 2061   the z-axis of a
+000362f0: 6e79 2076 6572 7465 7820 636f 6f72 6469  ny vertex coordi
+00036300: 6e61 7465 2e0d 0a20 2020 2020 2020 2020  nate...         
+00036310: 2020 2055 7365 2069 7320 6465 7065 6e64     Use is depend
+00036320: 656e 7420 6f6e 2062 6173 6574 7970 652e  ent on basetype.
+00036330: 0d0a 0d0a 2020 2020 2020 2020 6e61 6d65  ....        name
+00036340: 203a 2073 7472 696e 672c 206f 7074 696f   : string, optio
+00036350: 6e61 6c2c 2064 6566 6175 6c74 3a20 4e6f  nal, default: No
+00036360: 6e65 2e0d 0a20 2020 2020 2020 2020 2020  ne...           
+00036370: 2044 6573 6372 6970 7469 7665 2069 6465   Descriptive ide
+00036380: 6e74 6966 6965 722e 0d0a 0d0a 2020 2020  ntifier.....    
+00036390: 2020 2020 5261 6973 6573 0d0a 2020 2020      Raises..    
+000363a0: 2020 2020 2d2d 2d2d 2d2d 0d0a 2020 2020      ------..    
+000363b0: 2020 2020 5661 6c75 6545 7272 6f72 0d0a      ValueError..
+000363c0: 2020 2020 2020 2020 2020 2020 4966 206e              If n
+000363d0: 6c61 7420 6973 206e 6f74 2061 6e20 696e  lat is not an in
+000363e0: 7465 6765 7220 6772 6561 7465 7220 6f72  teger greater or
+000363f0: 2065 7175 616c 2074 6f20 322e 0d0a 2020   equal to 2...  
+00036400: 2020 2020 2020 2020 2020 4966 206e 6c6e            If nln
+00036410: 6720 6973 206e 6f74 2061 6e20 696e 7465  g is not an inte
+00036420: 6765 7220 6772 6561 7465 7220 6f72 2065  ger greater or e
+00036430: 7175 616c 2074 6f20 332e 0d0a 0d0a 2020  qual to 3.....  
+00036440: 2020 2020 2020 4f74 6865 7220 5061 7261        Other Para
+00036450: 6d65 7465 7273 0d0a 2020 2020 2020 2020  meters..        
+00036460: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00036470: 0d0a 2020 2020 2020 2020 2a2a 6b77 6172  ..        **kwar
+00036480: 6773 0d0a 2020 2020 2020 2020 2020 2020  gs..            
+00036490: 416c 6c20 6f74 6865 7220 7061 7261 6d65  All other parame
+000364a0: 7465 7273 2061 7265 2070 6173 7365 6420  ters are passed 
+000364b0: 6f6e 2074 6f20 2773 3364 6c69 622e 7375  on to 's3dlib.su
+000364c0: 7266 6163 652e 5375 7266 6163 6533 4443  rface.Surface3DC
+000364d0: 6f6c 6c65 6374 696f 6e27 2e0d 0a20 2020  ollection'...   
+000364e0: 2020 2020 200d 0a20 2020 2020 2020 2052       ..        R
+000364f0: 6574 7572 6e73 0d0a 2020 2020 2020 2020  eturns..        
+00036500: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
+00036510: 2073 7572 6661 6365 203a 2053 7068 6572   surface : Spher
+00036520: 6963 616c 5375 7266 6163 6520 6f62 6a65  icalSurface obje
+00036530: 6374 2e0d 0a0d 0a20 2020 2020 2020 2022  ct.....        "
+00036540: 2222 0d0a 2020 2020 2020 2020 4e66 6163  ""..        Nfac
+00036550: 6573 203d 207b 2027 6427 3a20 362c 2027  es = { 'd': 6, '
+00036560: 7327 3a20 362c 2027 7127 3a31 322c 2027  s': 6, 'q':12, '
+00036570: 7727 3a31 322c 2027 7227 3a36 2c20 2778  w':12, 'r':6, 'x
+00036580: 273a 3620 207d 2020 2320 322c 330d 0a20  ':6  }  # 2,3.. 
+00036590: 2020 2020 2020 2073 706c 6974 5369 7a65         splitSize
+000365a0: 203d 204e 6f6e 650d 0a20 2020 2020 2020   = None..       
+000365b0: 206e 7261 642c 206e 616e 6720 3d20 6e6c   nrad, nang = nl
+000365c0: 6174 2c20 6e6c 6e67 0d0a 2020 2020 2020  at, nlng..      
+000365d0: 2020 7375 7266 6163 6520 3d20 636c 732e    surface = cls.
+000365e0: 5f73 7175 6172 655f 6e65 7428 6e72 6164  _square_net(nrad
+000365f0: 2c20 6e61 6e67 2c20 6261 7365 7479 7065  , nang, basetype
+00036600: 2c6d 696e 7261 642c 2073 706c 6974 5369  ,minrad, splitSi
+00036610: 7a65 2c20 6e61 6d65 2c20 2a2a 6b77 6172  ze, name, **kwar
+00036620: 6773 290d 0a20 2020 2020 2020 2073 7572  gs)..        sur
+00036630: 6661 6365 2e5f 706f 7374 5072 6f63 5f73  face._postProc_s
+00036640: 7572 6661 6365 436f 6c6f 7273 2854 7275  urfaceColors(Tru
+00036650: 6529 0d0a 2020 2020 2020 2020 7375 7266  e)..        surf
+00036660: 6163 652e 5f72 657a 203d 2073 7572 6661  ace._rez = surfa
+00036670: 6365 2e5f 6361 6c63 5f72 657a 2820 3230  ce._calc_rez( 20
+00036680: 2029 0d0a 2020 2020 2020 2020 7265 7475   )..        retu
+00036690: 726e 2073 7572 6661 6365 0d0a 0d0a 2020  rn surface....  
+000366a0: 2020 4063 6c61 7373 6d65 7468 6f64 0d0a    @classmethod..
+000366b0: 2020 2020 6465 6620 706e 7473 7572 6628      def pntsurf(
+000366c0: 636c 732c 2072 7470 5f70 6f69 6e74 732c  cls, rtp_points,
+000366d0: 206e 616d 653d 4e6f 6e65 2c20 2a2a 6b61   name=None, **ka
+000366e0: 7267 7329 203a 0d0a 2020 2020 2020 2020  rgs) :..        
+000366f0: 2222 220d 0a20 2020 2020 2020 2053 7068  """..        Sph
+00036700: 6572 6963 616c 5375 7266 6163 6520 6672  ericalSurface fr
+00036710: 6f6d 2070 6f69 6e74 7320 696e 2073 7068  om points in sph
+00036720: 6572 6963 616c 2063 6f6f 7264 696e 6174  erical coordinat
+00036730: 6573 2e0d 0a0d 0a20 2020 2020 2020 2050  es.....        P
+00036740: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
+00036750: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
+00036760: 2020 2020 2020 2072 7470 5f70 6f69 6e74         rtp_point
+00036770: 7320 3a20 6172 7261 792c 2072 6571 7569  s : array, requi
+00036780: 7265 642e 0d0a 2020 2020 2020 2020 2020  red...          
+00036790: 2020 416e 204e 2058 2033 2061 7272 6179    An N X 3 array
+000367a0: 206f 6620 4e20 7370 6865 7269 6361 6c20   of N spherical 
+000367b0: 636f 6f72 6469 6e61 7465 2070 6f69 6e74  coordinate point
+000367c0: 732e 0d0a 0d0a 2020 2020 2020 2020 6e61  s.....        na
+000367d0: 6d65 203a 2073 7472 696e 672c 206f 7074  me : string, opt
+000367e0: 696f 6e61 6c2c 2064 6566 6175 6c74 3a20  ional, default: 
+000367f0: 4e6f 6e65 2e0d 0a20 2020 2020 2020 2020  None...         
+00036800: 2020 2044 6573 6372 6970 7469 7665 2069     Descriptive i
+00036810: 6465 6e74 6966 6965 7220 666f 7220 7468  dentifier for th
+00036820: 6520 706f 696e 7420 7375 7266 6163 652e  e point surface.
+00036830: 0d0a 0d0a 2020 2020 2020 2020 5265 7475  ....        Retu
+00036840: 726e 730d 0a20 2020 2020 2020 202d 2d2d  rns..        ---
+00036850: 2d2d 2d2d 0d0a 2020 2020 2020 2020 7375  ----..        su
+00036860: 7266 6163 6520 3a20 5370 6865 7269 6361  rface : Spherica
+00036870: 6c53 7572 6661 6365 206f 626a 6563 740d  lSurface object.
+00036880: 0a0d 0a20 2020 2020 2020 2022 2222 0d0a  ...        """..
+00036890: 2020 2020 2020 2020 6461 7461 5074 7320          dataPts 
+000368a0: 3d20 6e70 2e61 7272 6179 2872 7470 5f70  = np.array(rtp_p
+000368b0: 6f69 6e74 7329 0d0a 0d0a 2020 2020 2020  oints)....      
+000368c0: 2020 7370 6850 7473 203d 2064 6174 6150    sphPts = dataP
+000368d0: 7473 2e54 0d0a 2020 2020 2020 2020 7879  ts.T..        xy
+000368e0: 7a50 7473 203d 2053 7068 6572 6963 616c  zPts = Spherical
+000368f0: 5375 7266 6163 652e 636f 6f72 5f63 6f6e  Surface.coor_con
+00036900: 7665 7274 2864 6174 6150 7473 2e54 2c54  vert(dataPts.T,T
+00036910: 7275 6529 0d0a 2020 2020 2020 2020 726d  rue)..        rm
+00036920: 6178 203d 206e 702e 616d 6178 2873 7068  ax = np.amax(sph
+00036930: 5074 735b 305d 290d 0a20 2020 2020 2020  Pts[0])..       
+00036940: 2073 7068 5074 735b 305d 203d 2072 6d61   sphPts[0] = rma
+00036950: 780d 0a20 2020 2020 2020 2078 797a 5f73  x..        xyz_s
+00036960: 7068 5074 7320 3d20 5370 6865 7269 6361  phPts = Spherica
+00036970: 6c53 7572 6661 6365 2e63 6f6f 725f 636f  lSurface.coor_co
+00036980: 6e76 6572 7428 7370 6850 7473 2c54 7275  nvert(sphPts,Tru
+00036990: 6529 0d0a 2020 2020 2020 2020 6875 6c6c  e)..        hull
+000369a0: 5f73 7572 6661 6365 203d 2053 7572 6661  _surface = Surfa
+000369b0: 6365 3344 436f 6c6c 6563 7469 6f6e 2e63  ce3DCollection.c
+000369c0: 6875 6c6c 2878 797a 5f73 7068 5074 732e  hull(xyz_sphPts.
+000369d0: 5429 0d0a 2020 2020 2020 2020 7665 7274  T)..        vert
+000369e0: 7320 3d20 7879 7a50 7473 2e54 0d0a 2020  s = xyzPts.T..  
+000369f0: 2020 2020 2020 6661 6365 496e 6469 6365        faceIndice
+00036a00: 7320 3d20 6875 6c6c 5f73 7572 6661 6365  s = hull_surface
+00036a10: 2e66 7649 6e64 6963 6573 0d0a 0d0a 2020  .fvIndices....  
+00036a20: 2020 2020 2020 6966 206e 616d 6520 6973        if name is
+00036a30: 204e 6f6e 6520 3a20 6e61 6d65 203d 2027   None : name = '
+00036a40: 706f 696e 7420 7375 7266 6163 6527 0d0a  point surface'..
+00036a50: 2020 2020 2020 2020 7375 7266 6163 6520          surface 
+00036a60: 3d20 5370 6865 7269 6361 6c53 7572 6661  = SphericalSurfa
+00036a70: 6365 286e 616d 653d 6e61 6d65 2c2a 2a6b  ce(name=name,**k
+00036a80: 6172 6773 2920 0d0a 2020 2020 2020 2020  args) ..        
+00036a90: 7375 7266 6163 652e 7665 7274 6578 436f  surface.vertexCo
+00036aa0: 6f72 203d 2076 6572 7473 0d0a 2020 2020  or = verts..    
+00036ab0: 2020 2020 7375 7266 6163 652e 6676 496e      surface.fvIn
+00036ac0: 6469 6365 7320 3d20 6661 6365 496e 6469  dices = faceIndi
+00036ad0: 6365 730d 0a20 2020 2020 2020 2073 7572  ces..        sur
+00036ae0: 6661 6365 2e65 7649 6e64 6963 6573 203d  face.evIndices =
+00036af0: 2073 7572 6661 6365 2e5f 6765 745f 6564   surface._get_ed
+00036b00: 6765 735f 6672 6f6d 5f66 6163 6573 2866  ges_from_faces(f
+00036b10: 6163 6549 6e64 6963 6573 290d 0a20 2020  aceIndices)..   
+00036b20: 2020 2020 2073 7572 6661 6365 2e76 6649       surface.vfI
+00036b30: 6e64 6963 6573 4c69 7374 203d 2073 7572  ndicesList = sur
+00036b40: 6661 6365 2e5f 7665 7274 6578 436f 6d6d  face._vertexComm
+00036b50: 6f6e 4661 6365 496e 6469 6365 7328 290d  onFaceIndices().
+00036b60: 0a20 2020 2020 2020 2073 7572 6661 6365  .        surface
+00036b70: 2e65 6649 6e64 6963 6573 4c69 7374 203d  .efIndicesList =
+00036b80: 2073 7572 6661 6365 2e5f 6564 6765 436f   surface._edgeCo
+00036b90: 6d6d 6f6e 4661 6365 496e 6469 6365 7328  mmonFaceIndices(
+00036ba0: 290d 0a20 2020 2020 2020 2073 7572 6661  )..        surfa
+00036bb0: 6365 2e73 6574 5f76 6572 7473 2820 7665  ce.set_verts( ve
+00036bc0: 7274 735b 6661 6365 496e 6469 6365 735d  rts[faceIndices]
+00036bd0: 2029 0d0a 2020 2020 2020 2020 7375 7266   )..        surf
+00036be0: 6163 652e 5f73 6574 5f67 656f 6d65 7472  ace._set_geometr
+00036bf0: 6963 5f62 6f75 6e64 7328 290d 0a20 2020  ic_bounds()..   
+00036c00: 2020 2020 2073 7572 6661 6365 2e5f 7265       surface._re
+00036c10: 7a20 3d20 7375 7266 6163 652e 5f63 616c  z = surface._cal
+00036c20: 635f 7265 7a28 3230 290d 0a20 2020 2020  c_rez(20)..     
+00036c30: 2020 2073 7572 6661 6365 2e5f 6261 7365     surface._base
+00036c40: 7479 7065 203d 2027 706e 7473 7572 6627  type = 'pntsurf'
+00036c50: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00036c60: 2073 7572 6661 6365 0d0a 0d0a 2020 2020   surface....    
+00036c70: 4063 6c61 7373 6d65 7468 6f64 0d0a 2020  @classmethod..  
+00036c80: 2020 6465 6620 5f58 6665 7628 636c 732c    def _Xfev(cls,
+00036c90: 2072 657a 2c20 6261 7365 7479 7065 3d4e   rez, basetype=N
+00036ca0: 6f6e 652c 206d 696e 7261 643d 4e6f 6e65  one, minrad=None
+00036cb0: 2920 3a0d 0a20 2020 2020 2020 2022 2222  ) :..        """
+00036cc0: 0d0a 2020 2020 2020 2020 4361 6c63 756c  ..        Calcul
+00036cd0: 6174 6573 206e 756d 6265 7220 6f66 2066  ates number of f
+00036ce0: 6163 6573 2c20 6564 6765 732c 2061 6e64  aces, edges, and
+00036cf0: 2076 6572 7469 6365 7320 6f66 2061 2053   vertices of a S
+00036d00: 7068 6572 6963 616c 5375 7266 6163 652e  phericalSurface.
+00036d10: 0d0a 0d0a 2020 2020 2020 2020 5061 7261  ....        Para
+00036d20: 6d65 7465 7273 0d0a 2020 2020 2020 2020  meters..        
+00036d30: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
+00036d40: 2020 2020 7265 7a20 3a20 696e 7465 6765      rez : intege
+00036d50: 720d 0a20 2020 2020 2020 2020 2020 204e  r..            N
+00036d60: 756d 6265 7220 6f66 2072 6563 7572 7369  umber of recursi
+00036d70: 7665 2073 7562 6469 7669 7369 6f6e 7320  ve subdivisions 
+00036d80: 6f66 2061 2074 7269 616e 6775 6c61 7465  of a triangulate
+00036d90: 6420 6261 7365 2066 6163 6573 2e0d 0a20  d base faces... 
+00036da0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00036db0: 2062 6173 6574 7970 6520 3a20 7374 7269   basetype : stri
+00036dc0: 6e67 0d0a 2020 2020 2020 2020 2020 2020  ng..            
+00036dd0: 5374 6172 7469 6e67 2073 7572 6661 6365  Starting surface
+00036de0: 2067 656f 6d65 7472 6965 7320 6672 6f6d   geometries from
+00036df0: 2077 6869 6368 2074 6865 2073 7572 6661   which the surfa
+00036e00: 6365 2077 6f75 6c64 2062 650d 0a20 2020  ce would be..   
+00036e10: 2020 2020 2020 2020 2063 6f6e 7374 7275           constru
+00036e20: 6374 6564 2075 7369 6e67 2072 6563 7572  cted using recur
+00036e30: 7369 7665 2073 7562 6469 7669 7369 6f6e  sive subdivision
+00036e40: 7320 6f66 2074 6865 2074 7269 616e 6775  s of the triangu
+00036e50: 6c61 7220 6661 6365 732e 0d0a 2020 2020  lar faces...    
+00036e60: 2020 2020 0d0a 2020 2020 2020 2020 5265      ..        Re
+00036e70: 7475 726e 730d 0a20 2020 2020 2020 202d  turns..        -
+00036e80: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
+00036e90: 6c69 7374 3a20 7468 6520 6e75 6d62 6572  list: the number
+00036ea0: 206f 6620 6661 6365 732c 2065 6467 6573   of faces, edges
+00036eb0: 2c20 616e 6420 7665 7274 6963 6573 2e0d  , and vertices..
+00036ec0: 0a0d 0a20 2020 2020 2020 2022 2222 0d0a  ...        """..
+00036ed0: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+00036ee0: 7461 6e63 6528 7265 7a2c 286c 6973 742c  tance(rez,(list,
+00036ef0: 7475 706c 6529 2920 3a20 2320 6368 6563  tuple)) : # chec
+00036f00: 6b20 666f 7220 676c 6f62 652e 2e2e 0d0a  k for globe.....
+00036f10: 2020 2020 2020 2020 2020 2020 6e6c 6174              nlat
+00036f20: 203d 2072 657a 5b30 5d0d 0a20 2020 2020   = rez[0]..     
+00036f30: 2020 2020 2020 206e 6c6e 6720 3d20 7265         nlng = re
+00036f40: 7a5b 315d 0d0a 2020 2020 2020 2020 2020  z[1]..          
+00036f50: 2020 2320 6f6e 6c79 2063 6865 636b 2069    # only check i
+00036f60: 7320 656e 6469 6e67 2069 6e20 730d 0a20  s ending in s.. 
+00036f70: 2020 2020 2020 2020 2020 2069 7353 706c             isSpl
+00036f80: 6974 203d 2062 6173 6574 7970 655b 206c  it = basetype[ l
+00036f90: 656e 2862 6173 6574 7970 6529 2d31 5d20  en(basetype)-1] 
+00036fa0: 3d3d 2027 7327 0d0a 2020 2020 2020 2020  == 's'..        
+00036fb0: 2020 2020 6966 206d 696e 7261 6420 6973      if minrad is
+00036fc0: 204e 6f6e 6520 3a0d 0a20 2020 2020 2020   None :..       
+00036fd0: 2020 2020 2020 2020 2066 203d 2032 2a6e           f = 2*n
+00036fe0: 6c61 742a 6e6c 6e67 202d 2032 2a6e 6c6e  lat*nlng - 2*nln
+00036ff0: 670d 0a20 2020 2020 2020 2020 2020 2020  g..             
+00037000: 2020 2065 203d 2033 2a6e 6c61 742a 6e6c     e = 3*nlat*nl
+00037010: 6e67 202d 2033 2a6e 6c6e 670d 0a20 2020  ng - 3*nlng..   
+00037020: 2020 2020 2020 2020 2020 2020 2076 203d               v =
+00037030: 206e 6c61 742a 6e6c 6e67 202d 206e 6c6e   nlat*nlng - nln
+00037040: 6720 2b20 320d 0a20 2020 2020 2020 2020  g + 2..         
+00037050: 2020 2020 2020 2069 6620 6973 5370 6c69         if isSpli
+00037060: 7420 3a0d 0a20 2020 2020 2020 2020 2020  t :..           
+00037070: 2020 2020 2020 2020 2065 202b 3d20 6e6c           e += nl
+00037080: 6174 0d0a 2020 2020 2020 2020 2020 2020  at..            
+00037090: 2020 2020 2020 2020 7620 2b3d 206e 6c61          v += nla
+000370a0: 7420 2d20 310d 0a20 2020 2020 2020 2020  t - 1..         
+000370b0: 2020 2065 6c73 6520 3a20 2023 2061 6e79     else :  # any
+000370c0: 2076 616c 7565 2077 696c 6c20 7472 6967   value will trig
+000370d0: 6765 7220 7468 6973 2063 6f6e 6469 7469  ger this conditi
+000370e0: 6f6e 2e0d 0a20 2020 2020 2020 2020 2020  on...           
+000370f0: 2020 2020 2066 203d 2032 2a6e 6c61 742a       f = 2*nlat*
+00037100: 6e6c 6e67 0d0a 2020 2020 2020 2020 2020  nlng..          
+00037110: 2020 2020 2020 6520 3d20 332a 6e6c 6174        e = 3*nlat
+00037120: 2a6e 6c6e 6720 2b20 6e6c 6e67 0d0a 2020  *nlng + nlng..  
+00037130: 2020 2020 2020 2020 2020 2020 2020 7620                v 
+00037140: 3d20 6e6c 6174 2a6e 6c6e 6720 2b20 6e6c  = nlat*nlng + nl
+00037150: 6e67 0d0a 2020 2020 2020 2020 2020 2020  ng..            
+00037160: 2020 2020 6966 2069 7353 706c 6974 203a      if isSplit :
+00037170: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00037180: 2020 2020 2020 6520 2b3d 206e 6c61 7420        e += nlat 
+00037190: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
+000371a0: 2020 2020 2020 2020 2076 202b 3d20 6e6c           v += nl
+000371b0: 6174 202b 2031 2020 2020 0d0a 2020 2020  at + 1    ..    
+000371c0: 2020 2020 2020 2020 7265 7475 726e 205b          return [
+000371d0: 662c 652c 765d 0d0a 0d0a 2020 2020 2020  f,e,v]....      
+000371e0: 2020 7265 7475 726e 2073 7570 6572 2829    return super()
+000371f0: 2e5f 6665 7628 7265 7a2c 6261 7365 7479  ._fev(rez,basety
+00037200: 7065 2c63 6c73 290d 0a0d 0a20 2020 2040  pe,cls)....    @
+00037210: 7374 6174 6963 6d65 7468 6f64 0d0a 2020  staticmethod..  
+00037220: 2020 6465 6620 5f73 7068 6572 6963 616c    def _spherical
+00037230: 5f73 706c 6974 5f63 796c 696e 6465 7228  _split_cylinder(
+00037240: 7265 7a2c 6261 7365 7479 7065 2c6d 696e  rez,basetype,min
+00037250: 7261 642c 202a 2a6b 7761 7267 7329 203a  rad, **kwargs) :
+00037260: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
+00037270: 2020 2020 2020 2054 7261 6e73 666f 726d         Transform
+00037280: 2063 796c 696e 6472 6963 616c 2062 6173   cylindrical bas
+00037290: 6520 7375 7266 6163 6520 746f 2073 7068  e surface to sph
+000372a0: 6572 6963 616c 2063 6f6f 7264 696e 6174  erical coordinat
+000372b0: 6573 2e20 0d0a 0d0a 2020 2020 2020 2020  es. ....        
+000372c0: 6e6f 7465 203a 2020 5468 6973 206d 6574  note :  This met
+000372d0: 686f 6420 7072 6f76 6964 6573 2061 6e20  hod provides an 
+000372e0: 616c 7465 726e 6174 6976 6520 746f 2074  alternative to t
+000372f0: 6865 200d 0a20 2020 2020 2020 2020 2020  he ..           
+00037300: 2020 2020 2073 7068 6572 6963 616c 2062       spherical b
+00037310: 6173 6574 7970 6573 206f 6620 2768 6578  asetypes of 'hex
+00037320: 5f73 2720 616e 6420 2773 7175 6172 655f  _s' and 'square_
+00037330: 7327 2e0d 0a20 2020 2020 2020 2020 2020  s'...           
+00037340: 2020 2020 2054 6865 2067 7269 6473 2063       The grids c
+00037350: 6f6e 7374 7275 6374 6564 2068 6572 6520  onstructed here 
+00037360: 6d61 7920 7072 6f76 6964 6520 736d 6f6f  may provide smoo
+00037370: 7468 6572 0d0a 2020 2020 2020 2020 2020  ther..          
+00037380: 2020 2020 2020 6765 6f6d 6574 7269 6573        geometries
+00037390: 2064 6570 656e 6469 6e67 206f 6e20 7468   depending on th
+000373a0: 6520 6d61 7070 696e 6720 6675 6e63 7469  e mapping functi
+000373b0: 6f6e 732e 0d0a 2020 2020 2020 2020 2222  ons...        ""
+000373c0: 220d 0a0d 0a20 2020 2020 2020 2023 202e  "....        # .
+000373d0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+000373e0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+000373f0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00037400: 0d0a 2020 2020 2020 2020 6465 6620 6379  ..        def cy
+00037410: 6c32 7370 6828 7274 7a29 3a0d 0a20 2020  l2sph(rtz):..   
+00037420: 2020 2020 2020 2020 2072 2c74 2c7a 203d           r,t,z =
+00037430: 2072 747a 0d0a 2020 2020 2020 2020 2020   rtz..          
+00037440: 2020 6d69 6e70 6869 203d 206e 702e 6172    minphi = np.ar
+00037450: 6363 6f73 286d 696e 7261 6429 0d0a 2020  ccos(minrad)..  
+00037460: 2020 2020 2020 2020 2020 7068 6920 3d20            phi = 
+00037470: 7a2a 6d69 6e70 6869 0d0a 2020 2020 2020  z*minphi..      
+00037480: 2020 2020 2020 5a20 3d20 6e70 2e73 696e        Z = np.sin
+00037490: 2870 6869 290d 0a20 2020 2020 2020 2020  (phi)..         
+000374a0: 2020 2052 203d 206e 702e 636f 7328 7068     R = np.cos(ph
+000374b0: 6929 0d0a 2020 2020 2020 2020 2020 2020  i)..            
+000374c0: 7265 7475 726e 2052 2c74 2c5a 0d0a 2020  return R,t,Z..  
+000374d0: 2020 2020 2020 2320 2e2e 2e2e 2e2e 2e2e        # ........
+000374e0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+000374f0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00037500: 2e2e 2e2e 2e2e 2e2e 2e0d 0a20 2020 2020  ...........     
+00037510: 2020 2069 6620 6261 7365 7479 7065 203d     if basetype =
+00037520: 3d20 276f 6374 615f 6327 203a 2063 796c  = 'octa_c' : cyl
+00037530: 6261 7365 203d 2027 7371 755f 7327 200d  base = 'squ_s' .
+00037540: 0a20 2020 2020 2020 2069 6620 6261 7365  .        if base
+00037550: 7479 7065 203d 3d20 2763 7562 655f 6327  type == 'cube_c'
+00037560: 203a 2020 2020 6379 6c62 6173 6520 3d20   :    cylbase = 
+00037570: 2774 7269 5f73 270d 0a20 2020 2020 2020  'tri_s'..       
+00037580: 2063 796c 5f6f 626a 203d 2043 796c 696e   cyl_obj = Cylin
+00037590: 6472 6963 616c 5375 7266 6163 6528 7265  dricalSurface(re
+000375a0: 7a2c 6379 6c62 6173 652c 202a 2a6b 7761  z,cylbase, **kwa
+000375b0: 7267 7329 2e6d 6170 5f67 656f 6d5f 6672  rgs).map_geom_fr
+000375c0: 6f6d 5f6f 7028 6379 6c32 7370 6829 0d0a  om_op(cyl2sph)..
+000375d0: 2020 2020 2020 2020 6261 7365 4661 6365          baseFace
+000375e0: 5665 7274 6578 496e 6469 6365 7320 3d20  VertexIndices = 
+000375f0: 6379 6c5f 6f62 6a2e 5f62 6173 655f 7375  cyl_obj._base_su
+00037600: 7266 6163 6573 5b63 796c 6261 7365 5d20  rfaces[cylbase] 
+00037610: 5b27 6261 7365 4661 6365 496e 6469 6365  ['baseFaceIndice
+00037620: 7327 5d20 2020 200d 0a20 2020 2020 2020  s']    ..       
+00037630: 2066 7649 6e64 6963 6573 203d 2063 796c   fvIndices = cyl
+00037640: 5f6f 626a 2e66 7649 6e64 6963 6573 0d0a  _obj.fvIndices..
+00037650: 2020 2020 2020 2020 7665 7274 6578 436f          vertexCo
+00037660: 6f72 203d 2063 796c 5f6f 626a 2e76 6572  or = cyl_obj.ver
+00037670: 7465 7843 6f6f 720d 0a20 2020 2020 2020  texCoor..       
+00037680: 2065 7649 6e64 6963 6573 203d 2063 796c   evIndices = cyl
+00037690: 5f6f 626a 2e65 7649 6e64 6963 6573 0d0a  _obj.evIndices..
+000376a0: 2020 2020 2020 2020 7265 7475 726e 2076          return v
+000376b0: 6572 7465 7843 6f6f 722c 2066 7649 6e64  ertexCoor, fvInd
+000376c0: 6963 6573 2c20 6576 496e 6469 6365 732c  ices, evIndices,
+000376d0: 2062 6173 6546 6163 6556 6572 7465 7849   baseFaceVertexI
+000376e0: 6e64 6963 6573 2c0d 0a0d 0a20 2020 2064  ndices,....    d
+000376f0: 6566 205f 5f69 6e69 745f 5f28 7365 6c66  ef __init__(self
+00037700: 2c20 7265 7a3d 302c 2062 6173 6574 7970  , rez=0, basetyp
+00037710: 653d 4e6f 6e65 2c20 6d69 6e72 6164 3d4e  e=None, minrad=N
+00037720: 6f6e 652c 206e 616d 653d 4e6f 6e65 2c20  one, name=None, 
+00037730: 2a2a 6b77 6172 6773 293a 0d0a 2020 2020  **kwargs):..    
+00037740: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
+00037750: 2043 7265 6174 6520 7370 6865 7269 6361   Create spherica
+00037760: 6c20 7375 7266 6163 6520 6f66 2075 6e69  l surface of uni
+00037770: 7420 7261 6469 7573 2e0d 0a0d 0a20 2020  t radius.....   
+00037780: 2020 2020 2050 6172 616d 6574 6572 730d       Parameters.
+00037790: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+000377a0: 2d2d 2d0d 0a20 2020 2020 2020 2072 657a  ---..        rez
+000377b0: 203a 2069 6e74 6567 6572 2c20 6f70 7469   : integer, opti
+000377c0: 6f6e 616c 2c20 6465 6661 756c 743a 2030  onal, default: 0
+000377d0: 0d0a 2020 2020 2020 2020 2020 2020 4e75  ..            Nu
+000377e0: 6d62 6572 206f 6620 7265 6375 7273 6976  mber of recursiv
+000377f0: 6520 7375 6264 6976 6973 696f 6e73 206f  e subdivisions o
+00037800: 6620 7468 6520 7472 6961 6e67 756c 6174  f the triangulat
+00037810: 6564 2062 6173 6520 6661 6365 732e 0d0a  ed base faces...
+00037820: 2020 2020 2020 2020 2020 2020 5265 7a20              Rez 
+00037830: 7661 6c75 6573 2072 616e 6765 2066 726f  values range fro
+00037840: 6d20 3020 746f 2037 2e0d 0a20 2020 2020  m 0 to 7...     
+00037850: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00037860: 2062 6173 6574 7970 6520 3a20 7b27 7465   basetype : {'te
+00037870: 7472 6127 2c27 6f63 7461 272c 2769 636f  tra','octa','ico
+00037880: 7361 272c 2763 7562 6527 2c27 646f 6465  sa','cube','dode
+00037890: 6361 272c 205c 0d0a 2020 2020 2020 2020  ca', \..        
+000378a0: 2020 2020 276f 6374 615f 7327 2c27 6375      'octa_s','cu
+000378b0: 6265 5f73 272c 276f 6374 615f 6327 2c27  be_s','octa_c','
+000378c0: 6375 6265 5f63 277d 2c20 6f70 7469 6f6e  cube_c'}, option
+000378d0: 616c 2c20 6465 6661 756c 743a 2027 6963  al, default: 'ic
+000378e0: 6f73 6127 0d0a 2020 2020 2020 2020 2020  osa'..          
+000378f0: 2020 5374 6172 7469 6e67 2073 7572 6661    Starting surfa
+00037900: 6365 2067 656f 6d65 7472 6965 7320 6672  ce geometries fr
+00037910: 6f6d 2077 6869 6368 2074 6865 2073 7572  om which the sur
+00037920: 6661 6365 2069 730d 0a20 2020 2020 2020  face is..       
+00037930: 2020 2020 2063 6f6e 7374 7275 6374 6564       constructed
+00037940: 2075 7369 6e67 2072 6563 7572 7369 7665   using recursive
+00037950: 2073 7562 6469 7669 7369 6f6e 7320 6f66   subdivisions of
+00037960: 2074 6865 2074 7269 616e 6775 6c61 7220   the triangular 
+00037970: 6661 6365 732e 0d0a 2020 2020 2020 2020  faces...        
+00037980: 2020 2020 416c 6c20 6261 7365 7479 7065      All basetype
+00037990: 7320 6172 6520 6261 7365 6420 6f6e 2074  s are based on t
+000379a0: 6865 2066 6976 6520 706c 6174 6f6e 6963  he five platonic
+000379b0: 2073 6f6c 6964 732e 0d0a 0d0a 2020 2020   solids.....    
+000379c0: 2020 2020 6d69 6e72 6164 203a 2073 6361      minrad : sca
+000379d0: 6c61 722c 206f 7074 696f 6e61 6c2c 2064  lar, optional, d
+000379e0: 6566 6175 6c74 3a20 302e 3031 0d0a 2020  efault: 0.01..  
+000379f0: 2020 2020 2020 2020 2020 466f 7220 6261            For ba
+00037a00: 7365 7479 7065 7320 276f 6374 615f 6327  setypes 'octa_c'
+00037a10: 2061 6e64 2027 6375 6265 5f63 2c20 7468   and 'cube_c, th
+00037a20: 6520 6d69 6e69 6d75 6d0d 0a20 2020 2020  e minimum..     
+00037a30: 2020 2020 2020 2064 6973 7461 6e63 6520         distance 
+00037a40: 6672 6f6d 2074 6865 207a 2d61 7869 7320  from the z-axis 
+00037a50: 6f66 2061 6e79 2076 6572 7465 7820 636f  of any vertex co
+00037a60: 6f72 6469 6e61 7465 2e0d 0a0d 0a20 2020  ordinate.....   
+00037a70: 2020 2020 206e 616d 6520 3a20 7374 7269       name : stri
+00037a80: 6e67 2c20 6f70 7469 6f6e 616c 2c20 6465  ng, optional, de
+00037a90: 6661 756c 743a 204e 6f6e 652e 0d0a 2020  fault: None...  
+00037aa0: 2020 2020 2020 2020 2020 4465 7363 7269            Descri
+00037ab0: 7074 6976 6520 6964 656e 7469 6669 6572  ptive identifier
+00037ac0: 2066 6f72 2074 6865 2067 656f 6d65 7472   for the geometr
+00037ad0: 792e 0d0a 0d0a 2020 2020 2020 2020 5261  y.....        Ra
+00037ae0: 6973 6573 0d0a 2020 2020 2020 2020 2d2d  ises..        --
+00037af0: 2d2d 2d2d 0d0a 2020 2020 2020 2020 5661  ----..        Va
+00037b00: 6c75 6545 7272 6f72 0d0a 2020 2020 2020  lueError..      
+00037b10: 2020 2020 2020 4966 2072 657a 2069 7320        If rez is 
+00037b20: 6e6f 7420 616e 2069 6e74 6567 6572 2069  not an integer i
+00037b30: 6e20 7261 6e67 6520 3020 746f 2037 2e0d  n range 0 to 7..
+00037b40: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
+00037b50: 6261 7365 7479 7065 2069 7320 6e6f 7420  basetype is not 
+00037b60: 7265 636f 676e 697a 6564 2066 6f72 2074  recognized for t
+00037b70: 6869 7320 7375 7266 6163 6520 636f 6e73  his surface cons
+00037b80: 7472 7563 746f 722e 0d0a 0d0a 2020 2020  tructor.....    
+00037b90: 2020 2020 4f74 6865 7220 5061 7261 6d65      Other Parame
+00037ba0: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
+00037bb0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a  --------------..
+00037bc0: 2020 2020 2020 2020 2a2a 6b77 6172 6773          **kwargs
+00037bd0: 0d0a 2020 2020 2020 2020 2020 2020 416c  ..            Al
+00037be0: 6c20 6f74 6865 7220 7061 7261 6d65 7465  l other paramete
+00037bf0: 7273 2061 7265 2070 6173 7365 6420 6f6e  rs are passed on
+00037c00: 2074 6f20 2773 3364 6c69 622e 7375 7266   to 's3dlib.surf
+00037c10: 6163 652e 5375 7266 6163 6533 4443 6f6c  ace.Surface3DCol
+00037c20: 6c65 6374 696f 6e27 2e0d 0a0d 0a20 2020  lection'.....   
+00037c30: 2020 2020 2022 2222 0d0a 0d0a 2020 2020       """....    
+00037c40: 2020 2020 6966 206d 696e 7261 6420 6973      if minrad is
+00037c50: 204e 6f6e 6520 3a20 6d69 6e72 6164 203d   None : minrad =
+00037c60: 205f 4d49 4e52 4144 0d0a 2020 2020 2020   _MINRAD..      
+00037c70: 2020 6966 206e 6f74 2069 7369 6e73 7461    if not isinsta
+00037c80: 6e63 6528 7265 7a2c 2069 6e74 2920 3a0d  nce(rez, int) :.
+00037c90: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+00037ca0: 7365 2056 616c 7565 4572 726f 7228 2749  se ValueError('I
+00037cb0: 6e63 6f72 7265 6374 2072 657a 2074 7970  ncorrect rez typ
+00037cc0: 652c 206d 7573 7420 6261 206f 6620 7479  e, must ba of ty
+00037cd0: 7065 2069 6e74 2729 0d0a 2020 2020 2020  pe int')..      
+00037ce0: 2020 6966 2028 7265 7a3c 3029 206f 7220    if (rez<0) or 
+00037cf0: 2872 657a 3e5f 4d41 5852 455a 2920 3a0d  (rez>_MAXREZ) :.
+00037d00: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+00037d10: 7365 2056 616c 7565 4572 726f 7228 2749  se ValueError('I
+00037d20: 6e63 6f72 7265 7374 2072 657a 206f 6620  ncorrest rez of 
+00037d30: 7b7d 2c20 6d75 7374 2062 6520 616e 2069  {}, must be an i
+00037d40: 6e74 2c20 3020 3c3d 2072 657a 203c 3d20  nt, 0 <= rez <= 
+00037d50: 7b7d 272e 666f 726d 6174 2872 657a 2c5f  {}'.format(rez,_
+00037d60: 4d41 5852 455a 2929 0d0a 2020 2020 2020  MAXREZ))..      
+00037d70: 2020 6966 2062 6173 6574 7970 6520 6973    if basetype is
+00037d80: 204e 6f6e 6520 3a20 6261 7365 7479 7065   None : basetype
+00037d90: 203d 2073 656c 662e 5f64 6566 6175 6c74   = self._default
+00037da0: 5f62 6173 650d 0a20 2020 2020 2020 2023  _base..        #
+00037db0: 202e 2e2e 2063 6865 636b 2066 6f72 2027   ... check for '
+00037dc0: 7370 6563 6961 6c20 6361 7365 2720 2875  special case' (u
+00037dd0: 676c 7920 636f 6465 2062 7574 206e 6565  gly code but nee
+00037de0: 6465 642c 204d 524f 4929 0d0a 2020 2020  ded, MROI)..    
+00037df0: 2020 2020 6966 2062 6173 6574 7970 6520      if basetype 
+00037e00: 3d3d 2027 6f63 7461 5f63 2720 6f72 2062  == 'octa_c' or b
+00037e10: 6173 6574 7970 6520 3d3d 2027 6375 6265  asetype == 'cube
+00037e20: 5f63 2720 3a0d 0a20 2020 2020 2020 2020  _c' :..         
+00037e30: 2020 2076 6572 7465 7843 6f6f 722c 2066     vertexCoor, f
+00037e40: 6163 6549 6e64 6963 6573 2c20 6564 6765  aceIndices, edge
+00037e50: 496e 6469 6365 732c 2062 6676 6920 3d20  Indices, bfvi = 
+00037e60: 7365 6c66 2e5f 7370 6865 7269 6361 6c5f  self._spherical_
+00037e70: 7370 6c69 745f 6379 6c69 6e64 6572 2872  split_cylinder(r
+00037e80: 657a 2c62 6173 6574 7970 652c 6d69 6e72  ez,basetype,minr
+00037e90: 6164 2c20 2a2a 6b77 6172 6773 290d 0a20  ad, **kwargs).. 
+00037ea0: 2020 2020 2020 2020 2020 2062 6173 6546             baseF
+00037eb0: 6163 6556 6572 7465 7849 6e64 6963 6573  aceVertexIndices
+00037ec0: 203d 2062 6676 690d 0a20 2020 2020 2020   = bfvi..       
+00037ed0: 2065 6c73 6520 3a0d 0a20 2020 2020 2020   else :..       
+00037ee0: 2020 2020 2069 6620 6261 7365 7479 7065       if basetype
+00037ef0: 206e 6f74 2069 6e20 7365 6c66 2e5f 6261   not in self._ba
+00037f00: 7365 5f73 7572 6661 6365 7320 3a0d 0a20  se_surfaces :.. 
+00037f10: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00037f20: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+00037f30: 2742 6173 6574 7970 6520 7b7d 2069 7320  'Basetype {} is 
+00037f40: 6e6f 7420 7265 636f 676e 697a 6564 2e20  not recognized. 
+00037f50: 506f 7373 6962 6c65 2076 616c 7565 7320  Possible values 
+00037f60: 6172 653a 207b 7d27 2e66 6f72 6d61 7428  are: {}'.format(
+00037f70: 6261 7365 7479 7065 2c6c 6973 7428 7365  basetype,list(se
+00037f80: 6c66 2e5f 6261 7365 5f73 7572 6661 6365  lf._base_surface
+00037f90: 7329 2929 0d0a 2020 2020 2020 2020 2020  s)))..          
+00037fa0: 2020 6261 7365 5375 7266 4f62 6a20 3d20    baseSurfObj = 
+00037fb0: 7365 6c66 2e5f 6261 7365 5f73 7572 6661  self._base_surfa
+00037fc0: 6365 735b 6261 7365 7479 7065 5d0d 0a20  ces[basetype].. 
+00037fd0: 2020 2020 2020 2020 2020 2062 6173 6556             baseV
+00037fe0: 636f 6f72 203d 2062 6173 6553 7572 664f  coor = baseSurfO
+00037ff0: 626a 5b27 6261 7365 5665 7274 6963 6573  bj['baseVertices
+00038000: 436f 6f72 275d 0d0a 2020 2020 2020 2020  Coor']..        
+00038010: 2020 2020 6261 7365 4661 6365 5665 7274      baseFaceVert
+00038020: 6578 496e 6469 6365 7320 3d62 6173 6553  exIndices =baseS
+00038030: 7572 664f 626a 5b27 6261 7365 4661 6365  urfObj['baseFace
+00038040: 496e 6469 6365 7327 5d0d 0a20 2020 2020  Indices']..     
+00038050: 2020 2020 2020 2069 6e64 6578 4f62 6a2c         indexObj,
+00038060: 7665 7274 6578 436f 6f72 203d 2073 656c  vertexCoor = sel
+00038070: 662e 7472 6961 6e67 756c 6174 6542 6173  f.triangulateBas
+00038080: 6528 7265 7a2c 6261 7365 5663 6f6f 722c  e(rez,baseVcoor,
+00038090: 6261 7365 4661 6365 5665 7274 6578 496e  baseFaceVertexIn
+000380a0: 6469 6365 732c 2073 656c 662e 5f6d 6964  dices, self._mid
+000380b0: 5665 6374 6f72 4675 6e29 0d0a 2020 2020  VectorFun)..    
+000380c0: 2020 2020 2020 2020 6661 6365 496e 6469          faceIndi
+000380d0: 6365 7320 3d20 696e 6465 784f 626a 5b27  ces = indexObj['
+000380e0: 6661 6365 275d 0d0a 2020 2020 2020 2020  face']..        
+000380f0: 2020 2020 6564 6765 496e 6469 6365 7320      edgeIndices 
+00038100: 3d20 696e 6465 784f 626a 5b27 6564 6765  = indexObj['edge
+00038110: 275d 0d0a 2020 2020 2020 2020 0d0a 2020  ']..        ..  
+00038120: 2020 2020 2020 7375 7065 7228 292e 5f5f        super().__
+00038130: 696e 6974 5f5f 2876 6572 7465 7843 6f6f  init__(vertexCoo
+00038140: 722c 2066 6163 6549 6e64 6963 6573 2c20  r, faceIndices, 
+00038150: 6e61 6d65 2c20 2a2a 6b77 6172 6773 290d  name, **kwargs).
+00038160: 0a0d 0a20 2020 2020 2020 2073 656c 662e  ...        self.
+00038170: 636f 6f72 5479 7065 203d 205f 434f 4f52  coorType = _COOR
+00038180: 5359 535b 2253 5048 4552 4943 414c 225d  SYS["SPHERICAL"]
+00038190: 0d0a 2020 2020 2020 2020 7365 6c66 2e5f  ..        self._
+000381a0: 6e6f 726d 616c 5f73 6361 6c65 203d 205f  normal_scale = _
+000381b0: 6e6f 726d 4c65 6e67 7468 2820 6c65 6e28  normLength( len(
+000381c0: 6661 6365 496e 6469 6365 7329 2c20 302e  faceIndices), 0.
+000381d0: 3631 2c20 312e 3532 290d 0a20 2020 2020  61, 1.52)..     
+000381e0: 2020 2073 656c 662e 5f72 657a 203d 2072     self._rez = r
+000381f0: 657a 0d0a 2020 2020 2020 2020 7365 6c66  ez..        self
+00038200: 2e5f 6261 7365 7479 7065 203d 2062 6173  ._basetype = bas
+00038210: 6574 7970 650d 0a20 2020 2020 2020 2073  etype..        s
+00038220: 656c 662e 6469 7370 5f56 6563 746f 7220  elf.disp_Vector 
+00038230: 3d20 6e70 2e61 7272 6179 2820 5b31 2c31  = np.array( [1,1
+00038240: 2c31 5d20 290d 0a20 2020 2020 2020 2072  ,1] )..        r
+00038250: 6574 7572 6e20 4e6f 6e65 0d0a 2020 2020  eturn None..    
+00038260: 0d0a 2020 2020 6465 6620 646f 6d61 696e  ..    def domain
+00038270: 2873 656c 662c 2072 6164 6975 733d 4e6f  (self, radius=No
+00038280: 6e65 2920 3a0d 0a20 2020 2020 2020 2022  ne) :..        "
+00038290: 2222 0d0a 2020 2020 2020 2020 5365 7420  ""..        Set 
+000382a0: 7468 6520 646f 6d61 696e 206f 6620 7468  the domain of th
+000382b0: 6520 7370 6865 7269 6361 6c20 7375 7266  e spherical surf
+000382c0: 6163 652e 0d0a 0d0a 2020 2020 2020 2020  ace.....        
+000382d0: 5573 6564 2066 6f72 2073 6574 7469 6e67  Used for setting
+000382e0: 2074 6865 2072 6164 6975 7320 6f66 2074   the radius of t
+000382f0: 6865 2062 6173 6520 7370 6865 7265 2e0d  he base sphere..
+00038300: 0a0d 0a20 2020 2020 2020 2050 6172 616d  ...        Param
+00038310: 6574 6572 730d 0a20 2020 2020 2020 202d  eters..        -
+00038320: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
+00038330: 2020 2072 6164 6975 733a 206e 756d 6265     radius: numbe
+00038340: 722c 2064 6566 6175 6c74 203a 2031 0d0a  r, default : 1..
+00038350: 2020 2020 2020 2020 2020 2020 5261 6469              Radi
+00038360: 7573 206f 6620 7468 6520 7370 6865 7269  us of the spheri
+00038370: 6361 6c20 7375 7266 6163 652e 0d0a 2020  cal surface...  
+00038380: 2020 2020 2020 2020 2020 4966 2073 6574            If set
+00038390: 2074 6f20 4e6f 6e65 2c20 7468 6520 7261   to None, the ra
+000383a0: 6469 7573 2069 7320 756e 6368 616e 6765  dius is unchange
+000383b0: 642e 0d0a 0d0a 2020 2020 2020 2020 5265  d.....        Re
+000383c0: 7475 726e 730d 0a20 2020 2020 2020 202d  turns..        -
+000383d0: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
+000383e0: 7365 6c66 203a 2053 7068 6572 6963 616c  self : Spherical
+000383f0: 5375 7266 6163 6520 6f62 6a65 6374 0d0a  Surface object..
+00038400: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
+00038410: 2020 2020 2020 2064 6566 2073 6574 446f         def setDo
+00038420: 6d61 696e 2872 7470 2c20 6d72 2029 203a  main(rtp, mr ) :
+00038430: 0d0a 2020 2020 2020 2020 2020 2020 722c  ..            r,
+00038440: 742c 7020 3d20 7274 700d 0a20 2020 2020  t,p = rtp..     
+00038450: 2020 2020 2020 2052 203d 206d 722a 720d         R = mr*r.
+00038460: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00038470: 7572 6e20 522c 742c 7020 2020 2020 2020  urn R,t,p       
+00038480: 0d0a 2020 2020 2020 2020 6465 6620 6765  ..        def ge
+00038490: 7443 6f6e 7428 6c69 6d73 2920 3a0d 0a20  tCont(lims) :.. 
+000384a0: 2020 2020 2020 2020 2020 206d 203d 2031             m = 1
+000384b0: 2e30 0d0a 2020 2020 2020 2020 2020 2020  .0..            
+000384c0: 6966 206c 696d 7320 6973 206e 6f74 204e  if lims is not N
+000384d0: 6f6e 6520 3a20 6d20 3d20 6c69 6d73 0d0a  one : m = lims..
+000384e0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+000384f0: 726e 206d 0d0a 2020 2020 2020 2020 6d72  rn m..        mr
+00038500: 203d 2067 6574 436f 6e74 2872 6164 6975   = getCont(radiu
+00038510: 7329 0d0a 2020 2020 2020 2020 7365 6c66  s)..        self
+00038520: 2e6d 6170 5f67 656f 6d5f 6672 6f6d 5f6f  .map_geom_from_o
+00038530: 7028 6c61 6d62 6461 2041 203a 2073 6574  p(lambda A : set
+00038540: 446f 6d61 696e 2841 2c20 6d72 2029 290d  Domain(A, mr )).
+00038550: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00038560: 7365 6c66 0d0a 0d0a 0d0a 0d0a 636c 6173  self........clas
+00038570: 7320 5665 6374 6f72 3344 436f 6c6c 6563  s Vector3DCollec
+00038580: 7469 6f6e 284c 696e 6533 4443 6f6c 6c65  tion(Line3DColle
+00038590: 6374 696f 6e29 203a 0d0a 2020 2020 2222  ction) :..    ""
+000385a0: 220d 0a20 2020 2043 6f6c 6c65 6374 696f  "..    Collectio
+000385b0: 6e20 6f66 2033 4420 7665 6374 6f72 7320  n of 3D vectors 
+000385c0: 7265 7072 6573 656e 7465 6420 6173 2061  represented as a
+000385d0: 7272 6f77 732e 0d0a 0d0a 2020 2020 2222  rrows.....    ""
+000385e0: 220d 0a0d 0a20 2020 2023 2046 7574 4465  "....    # FutDe
+000385f0: 763a 2061 6464 6974 696f 6e61 6c20 6d65  v: additional me
+00038600: 7468 6f64 7320 746f 2061 6464 2066 756e  thods to add fun
+00038610: 6374 696f 6e61 6c69 7479 2e0d 0a0d 0a20  ctionality..... 
+00038620: 2020 2064 6566 205f 5f69 6e69 745f 5f28     def __init__(
+00038630: 7365 6c66 2c20 6c6f 6361 7469 6f6e 2c20  self, location, 
+00038640: 7665 6374 202c 2061 6c72 3d4e 6f6e 652c  vect , alr=None,
+00038650: 206e 616d 653d 4e6f 6e65 2c20 2a2a 6b77   name=None, **kw
+00038660: 6172 6773 2920 3a0d 0a20 2020 2020 2020  args) :..       
+00038670: 2022 2222 0d0a 2020 2020 2020 2020 4372   """..        Cr
+00038680: 6561 7465 2061 2063 6f6c 6c65 6374 696f  eate a collectio
+00038690: 6e20 6f66 2033 4420 7665 6374 6f72 732e  n of 3D vectors.
+000386a0: 0d0a 0d0a 2020 2020 2020 2020 5061 7261  ....        Para
+000386b0: 6d65 7465 7273 0d0a 2020 2020 2020 2020  meters..        
+000386c0: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
+000386d0: 2020 2020 6c6f 6361 7469 6f6e 203a 204e      location : N
+000386e0: 2078 2033 2066 6c6f 6174 2061 7272 6179   x 3 float array
+000386f0: 0d0a 2020 2020 2020 2020 2020 2020 4361  ..            Ca
+00038700: 7274 6573 6961 6e20 636f 6f72 6469 6e61  rtesian coordina
+00038710: 7465 206c 6f63 6174 696f 6e20 2874 6169  te location (tai
+00038720: 6c73 2920 666f 7220 4e20 6e75 6d62 6572  ls) for N number
+00038730: 206f 6620 7665 6374 6f72 732e 0d0a 0d0a   of vectors.....
+00038740: 2020 2020 2020 2020 7665 6374 203a 204e          vect : N
+00038750: 2078 2033 2066 6c6f 6174 2061 7272 6179   x 3 float array
+00038760: 0d0a 2020 2020 2020 2020 2020 2020 4e20  ..            N 
+00038770: 6e75 6d62 6572 206f 6620 7665 6374 6f72  number of vector
+00038780: 7320 696e 2043 6172 7465 7369 616e 2063  s in Cartesian c
+00038790: 6f6f 7264 696e 6174 6573 2e0d 0a0d 0a20  oordinates..... 
+000387a0: 2020 2020 2020 2061 6c72 203a 2073 6361         alr : sca
+000387b0: 6c61 722c 206f 7074 696f 6e61 6c2c 2064  lar, optional, d
+000387c0: 6566 6175 6c74 3a20 302e 3235 0d0a 2020  efault: 0.25..  
+000387d0: 2020 2020 2020 2020 2020 4178 6973 206c            Axis l
+000387e0: 656e 6774 6820 7261 7469 6f2c 2068 6561  ength ratio, hea
+000387f0: 6420 7369 7a65 2074 6f20 7665 6374 6f72  d size to vector
+00038800: 206d 6167 6e69 7475 6465 2e0d 0a0d 0a20   magnitude..... 
+00038810: 2020 2020 2020 206e 616d 6520 3a20 7374         name : st
+00038820: 7269 6e67 2069 6465 6e74 6966 6965 720d  ring identifier.
+00038830: 0a0d 0a20 2020 2020 2020 204f 7468 6572  ...        Other
+00038840: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
+00038850: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+00038860: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 202a  -----..        *
+00038870: 2a6b 7761 7267 730d 0a20 2020 2020 2020  *kwargs..       
+00038880: 2020 2020 2041 6c6c 206f 7468 6572 2070       All other p
+00038890: 6172 616d 6574 6572 7320 6172 6520 7061  arameters are pa
+000388a0: 7373 6564 206f 6e20 746f 206d 706c 5f74  ssed on to mpl_t
+000388b0: 6f6f 6c6b 6974 732e 6d70 6c6f 7433 642e  oolkits.mplot3d.
+000388c0: 6172 7433 642e 4c69 6e65 3344 436f 6c6c  art3d.Line3DColl
+000388d0: 6563 7469 6f6e 2e0d 0a20 2020 2020 2020  ection...       
+000388e0: 2020 2020 2056 616c 6964 206b 6579 776f       Valid keywo
+000388f0: 7264 7320 696e 636c 7564 653a 2063 6f6c  rds include: col
+00038900: 6f72 732c 206c 696e 6577 6964 7468 732e  ors, linewidths.
+00038910: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+00038920: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
+00038930: 2023 206e 6f74 653a 2073 656c 6620 636f   # note: self co
+00038940: 6f72 2074 7970 6573 2070 7269 6d61 7269  or types primari
+00038950: 616c 6c79 2075 7365 6420 666f 7220 6578  ally used for ex
+00038960: 706f 7274 2069 6e66 6f2e 0d0a 0d0a 2020  port info.....  
+00038970: 2020 2020 2020 7365 6c66 2e63 6f6f 7254        self.coorT
+00038980: 7970 6520 3d20 5f43 4f4f 5253 5953 5b22  ype = _COORSYS["
+00038990: 5859 5a22 5d0d 0a20 2020 2020 2020 2073  XYZ"]..        s
+000389a0: 656c 662e 7576 774f 7269 656e 7461 7469  elf.uvwOrientati
+000389b0: 6f6e 5479 7065 203d 205f 434f 4f52 5359  onType = _COORSY
+000389c0: 535b 2258 595a 225d 0d0a 0d0a 2020 2020  S["XYZ"]....    
+000389d0: 2020 2020 6966 2061 6c72 2069 7320 4e6f      if alr is No
+000389e0: 6e65 203a 2061 6c72 203d 205f 4446 545f  ne : alr = _DFT_
+000389f0: 414c 520d 0a20 2020 2020 2020 2073 656c  ALR..        sel
+00038a00: 662e 5f61 6c72 203d 2061 6c72 0d0a 0d0a  f._alr = alr....
+00038a10: 2020 2020 2020 2020 7365 6c66 2e62 6173          self.bas
+00038a20: 654c 6f63 6174 696f 6e20 3d20 6e70 2e61  eLocation = np.a
+00038a30: 7272 6179 286c 6f63 6174 696f 6e2c 2064  rray(location, d
+00038a40: 7479 7065 3d66 6c6f 6174 290d 0a20 2020  type=float)..   
+00038a50: 2020 2020 2073 656c 662e 6261 7365 5665       self.baseVe
+00038a60: 6374 203d 206e 702e 6172 7261 7928 7665  ct = np.array(ve
+00038a70: 6374 2c20 6474 7970 653d 666c 6f61 7429  ct, dtype=float)
+00038a80: 0d0a 0d0a 2020 2020 2020 2020 6c69 6e65  ....        line
+00038a90: 732c 5859 5a2c 5556 5720 3d20 7365 6c66  s,XYZ,UVW = self
+00038aa0: 2e5f 7175 6976 6572 4c69 6e65 7328 6c6f  ._quiverLines(lo
+00038ab0: 6361 7469 6f6e 2c76 6563 742c 616c 7229  cation,vect,alr)
+00038ac0: 0d0a 2020 2020 2020 2020 2320 6e6f 7465  ..        # note
+00038ad0: 3a20 5f71 7569 7665 724c 696e 6573 206d  : _quiverLines m
+00038ae0: 6179 2072 656d 6f76 6520 7a65 726f 206c  ay remove zero l
+00038af0: 656e 6774 6820 7665 6374 0d0a 2020 2020  ength vect..    
+00038b00: 2020 2020 7365 6c66 2e6c 6f63 6174 696f      self.locatio
+00038b10: 6e20 3d20 5859 5a0d 0a20 2020 2020 2020  n = XYZ..       
+00038b20: 2073 656c 662e 7665 6374 203d 2055 5657   self.vect = UVW
+00038b30: 0d0a 0d0a 2020 2020 2020 2020 6966 2027  ....        if '
+00038b40: 636f 6c6f 7227 2069 6e20 6b77 6172 6773  color' in kwargs
+00038b50: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
+00038b60: 7472 793a 0d0a 2020 2020 2020 2020 2020  try:..          
+00038b70: 2020 2020 2020 7465 7374 203d 2063 6f6c        test = col
+00038b80: 6f72 732e 746f 5f72 6762 6128 206b 7761  ors.to_rgba( kwa
+00038b90: 7267 735b 2763 6f6c 6f72 275d 2029 0d0a  rgs['color'] )..
+00038ba0: 2020 2020 2020 2020 2020 2020 6578 6365              exce
+00038bb0: 7074 3a0d 0a20 2020 2020 2020 2020 2020  pt:..           
+00038bc0: 2020 2020 2064 656c 206b 7761 7267 735b       del kwargs[
+00038bd0: 2763 6f6c 6f72 275d 0d0a 2020 2020 2020  'color']..      
+00038be0: 2020 2020 2020 2020 2020 7761 726e 696e            warnin
+00038bf0: 6773 2e77 6172 6e28 224f 6e6c 7920 6120  gs.warn("Only a 
+00038c00: 5349 4e47 4c45 2063 6f6c 6f72 2076 616c  SINGLE color val
+00038c10: 7565 206d 6179 2062 6520 7573 6564 2066  ue may be used f
+00038c20: 6f72 2076 6563 746f 7220 696e 7374 616e  or vector instan
+00038c30: 7469 6174 696f 6e22 290d 0a0d 0a20 2020  tiation")....   
+00038c40: 2020 2020 2073 7570 6572 2829 2e5f 5f69       super().__i
+00038c50: 6e69 745f 5f28 6c69 6e65 732c 202a 2a6b  nit__(lines, **k
+00038c60: 7761 7267 7329 0d0a 2020 2020 2020 2020  wargs)..        
+00038c70: 2373 656c 662e 5f67 656f 6d4e 616d 6520  #self._geomName 
+00038c80: 3d20 6e61 6d65 2020 2020 2320 5265 6475  = name    # Redu
+00038c90: 6e61 6e74 2066 726f 6d20 6e65 7874 206c  nant from next l
+00038ca0: 696e 652c 2069 6e74 6572 6e61 6c20 7472  ine, internal tr
+00038cb0: 6163 6b69 6e67 2074 6f20 6465 7465 726d  acking to determ
+00038cc0: 696e 6520 6966 2073 6574 2e2e 2e0d 0a20  ine if set..... 
+00038cd0: 2020 2020 2020 2073 656c 662e 6e61 6d65         self.name
+00038ce0: 203d 206e 616d 650d 0a20 2020 2020 2020   = name..       
+00038cf0: 2073 656c 662e 7661 6c75 6573 4e61 6d65   self.valuesName
+00038d00: 203d 204e 6f6e 650d 0a20 2020 2020 2020   = None..       
+00038d10: 2073 656c 662e 6261 7365 436f 6c6f 7220   self.baseColor 
+00038d20: 3d20 6e70 2e61 7272 6179 2873 656c 662e  = np.array(self.
+00038d30: 6765 745f 636f 6c6f 7228 295b 305d 292e  get_color()[0]).
+00038d40: 666c 6174 7465 6e28 292e 746f 6c69 7374  flatten().tolist
+00038d50: 2829 0d0a 0d0a 0d0a 2020 2020 2020 2020  ()......        
+00038d60: 7365 6c66 2e5f 626f 756e 6473 203d 207b  self._bounds = {
+00038d70: 7d0d 0a20 2020 2020 2020 205f 7365 745f  }..        _set_
+00038d80: 6765 6f6d 426f 756e 6473 2873 656c 662e  geomBounds(self.
+00038d90: 6c6f 6361 7469 6f6e 2c73 656c 662e 5f62  location,self._b
+00038da0: 6f75 6e64 7329 0d0a 2020 2020 2020 2020  ounds)..        
+00038db0: 7365 6c66 2e5f 626f 756e 6473 5b27 766c  self._bounds['vl
+00038dc0: 696d 275d 203d 2020 2020 205f 4446 545f  im'] =     _DFT_
+00038dd0: 564c 494d 2020 2020 2020 2020 2023 2e2e  VLIM         #..
+00038de0: 2066 726f 6d20 6f70 6572 6174 696f 6e0d   from operation.
+00038df0: 0a20 2020 2020 2020 2073 656c 662e 5f62  .        self._b
+00038e00: 6f75 6e64 735b 2776 6572 7476 6c69 6d27  ounds['vertvlim'
+00038e10: 5d20 3d20 5f44 4654 5f56 4552 5456 4c49  ] = _DFT_VERTVLI
+00038e20: 4d20 2020 2020 232e 2e20 6672 6f6d 2064  M     #.. from d
+00038e30: 6972 6563 7469 6f6e 206f 7220 6d61 676e  irection or magn
+00038e40: 6974 7564 650d 0a0d 0a20 2020 2064 6566  itude....    def
+00038e50: 205f 7365 745f 7665 6374 436f 6c6f 7228   _set_vectColor(
+00038e60: 7365 6c66 2c20 636f 6c6f 7229 203a 0d0a  self, color) :..
+00038e70: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+00038e80: 2020 2320 6e6f 7465 3a20 666f 7220 6120    # note: for a 
+00038e90: 6c69 7374 206f 6620 666f 7572 2063 6f6c  list of four col
+00038ea0: 6f72 7320 5b20 412c 422c 432c 4420 5d2c  ors [ A,B,C,D ],
+00038eb0: 2072 6573 756c 7420 6973 0d0a 2020 2020   result is..    
+00038ec0: 2020 2020 2320 2020 2020 2020 5b20 412c      #       [ A,
+00038ed0: 422c 432c 442c 2041 2c41 2c20 422c 422c  B,C,D, A,A, B,B,
+00038ee0: 2043 2c43 2c20 442c 4420 5d2e 0d0a 2020   C,C, D,D ]...  
+00038ef0: 2020 2020 2020 2320 2020 2020 2020 6c69        #       li
+00038f00: 6e65 2073 6567 6d65 6e74 2063 6f6c 6f72  ne segment color
+00038f10: 732c 2074 6865 6e20 6120 7061 6972 2066  s, then a pair f
+00038f20: 6f72 2065 6163 6820 6172 726f 7720 6865  or each arrow he
+00038f30: 6164 2028 3220 6c69 6e65 7329 2e0d 0a0d  ad (2 lines)....
+00038f40: 0a20 2020 2020 2020 2068 6561 6420 3d20  .        head = 
+00038f50: 6e70 2e61 7261 6e67 6528 6c65 6e28 636f  np.arange(len(co
+00038f60: 6c6f 7229 290d 0a20 2020 2020 2020 2074  lor))..        t
+00038f70: 6169 6c20 3d20 6e70 2e72 6176 656c 2820  ail = np.ravel( 
+00038f80: 5b20 5b68 6561 645d 2c5b 6865 6164 5d20  [ [head],[head] 
+00038f90: 5d20 2c20 6f72 6465 723d 2746 2729 0d0a  ] , order='F')..
+00038fa0: 2020 2020 2020 2020 696e 6465 7820 3d20          index = 
+00038fb0: 6e70 2e61 7070 656e 6428 6865 6164 2c74  np.append(head,t
+00038fc0: 6169 6c29 0d0a 2020 2020 2020 2020 2373  ail)..        #s
+00038fd0: 656c 662e 5f65 6467 6563 6f6c 6f72 7320  elf._edgecolors 
+00038fe0: 3d20 636f 6c6f 725b 696e 6465 785d 0d0a  = color[index]..
+00038ff0: 2020 2020 2020 2020 7365 6c66 2e73 6574          self.set
+00039000: 5f63 6f6c 6f72 2863 6f6c 6f72 5b69 6e64  _color(color[ind
+00039010: 6578 5d29 2020 2020 2023 2075 7064 6174  ex])     # updat
+00039020: 6520 666f 7220 765f 312e 322e 300d 0a20  e for v_1.2.0.. 
+00039030: 2020 2020 2020 2072 6574 7572 6e0d 0a0d         return...
+00039040: 0a20 2020 2064 6566 205f 5f73 7472 5f5f  .    def __str__
+00039050: 2873 656c 6629 203a 0d0a 2020 2020 2020  (self) :..      
+00039060: 2020 2320 6e6f 7465 3a20 6561 6368 2076    # note: each v
+00039070: 6563 746f 7220 7265 7072 6573 656e 7461  ector representa
+00039080: 7469 6f6e 2069 7320 636f 6d70 6f73 6564  tion is composed
+00039090: 206f 6620 3320 6c69 6e65 730d 0a20 2020   of 3 lines..   
+000390a0: 2020 2020 206e 756d 6256 6563 7420 3d20       numbVect = 
+000390b0: 696e 7428 6c65 6e28 7365 6c66 2e5f 7365  int(len(self._se
+000390c0: 676d 656e 7473 3364 292f 3329 0d0a 2020  gments3d)/3)..  
+000390d0: 2020 2020 2020 6e61 6d65 203d 2073 656c        name = sel
+000390e0: 662e 5f5f 636c 6173 735f 5f2e 5f5f 6e61  f.__class__.__na
+000390f0: 6d65 5f5f 0d0a 2020 2020 2020 2020 7661  me__..        va
+00039100: 6c20 3d20 6e61 6d65 202b 2027 3a20 2076  l = name + ':  v
+00039110: 6563 746f 7273 3a20 7b7d 272e 666f 726d  ectors: {}'.form
+00039120: 6174 286e 756d 6256 6563 7429 0d0a 2020  at(numbVect)..  
+00039130: 2020 2020 2020 7265 7475 726e 2076 616c        return val
+00039140: 0d0a 0d0a 2020 2020 6465 6620 5f71 7569  ....    def _qui
+00039150: 7665 724c 696e 6573 2820 7365 6c66 2c20  verLines( self, 
+00039160: 7643 2c20 764e 2c20 616c 7229 203a 0d0a  vC, vN, alr) :..
+00039170: 2020 2020 2020 2020 2320 2e2e 2e2e 2e2e          # ......
+00039180: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00039190: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+000391a0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 0d0a 2020  ..............  
+000391b0: 2020 2020 2020 6465 6620 7175 6976 6572        def quiver
+000391c0: 2820 2a61 7267 732c 206c 656e 6774 683d  ( *args, length=
+000391d0: 312c 2061 7272 6f77 5f6c 656e 6774 685f  1, arrow_length_
+000391e0: 7261 7469 6f3d 616c 722c 2070 6976 6f74  ratio=alr, pivot
+000391f0: 3d27 7461 696c 272c 206e 6f72 6d61 6c69  ='tail', normali
+00039200: 7a65 3d46 616c 7365 293a 0d0a 2020 2020  ze=False):..    
+00039210: 2020 2020 2020 2020 2320 7461 6b65 6e20          # taken 
+00039220: 6469 7265 6374 6c79 2066 726f 6d20 6d70  directly from mp
+00039230: 6c5f 746f 6f6c 6b69 7473 2e6d 706c 6f74  l_toolkits.mplot
+00039240: 3364 2e61 7865 7333 6420 736f 7572 6365  3d.axes3d source
+00039250: 200d 0a20 2020 2020 2020 2020 2020 2023   ..            #
+00039260: 2061 6e64 2072 656d 6f76 6564 2061 7869   and removed axi
+00039270: 7320 7265 6665 7265 6e63 652e 2020 4163  s reference.  Ac
+00039280: 6b6e 6f77 6c65 6467 656d 656e 743a 0d0a  knowledgement:..
+00039290: 2020 2020 2020 2020 2020 2020 2320 436f              # Co
+000392a0: 7079 7269 6768 7420 2863 2920 3230 3132  pyright (c) 2012
+000392b0: 2d32 3031 3320 4d61 7470 6c6f 746c 6962  -2013 Matplotlib
+000392c0: 2044 6576 656c 6f70 6d65 6e74 2054 6561   Development Tea
+000392d0: 6d3b 2041 6c6c 2052 6967 6874 7320 5265  m; All Rights Re
+000392e0: 7365 7276 6564 0d0a 2020 2020 2020 2020  served..        
+000392f0: 2020 2020 2320 2e2e 2e2e 2e2e 2e2e 2e2e      # ..........
+00039300: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00039310: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00039320: 2e2e 2e2e 2e0d 0a20 2020 2020 2020 2020  .......         
+00039330: 2020 2064 6566 2063 616c 635f 6172 726f     def calc_arro
+00039340: 7728 7576 772c 2061 6e67 6c65 3d31 3529  w(uvw, angle=15)
+00039350: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00039360: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
+00039370: 2020 2020 2020 2020 546f 2063 616c 6375          To calcu
+00039380: 6c61 7465 2074 6865 2061 7272 6f77 2068  late the arrow h
+00039390: 6561 642e 2075 7677 2073 686f 756c 6420  ead. uvw should 
+000393a0: 6265 2061 2075 6e69 7420 7665 6374 6f72  be a unit vector
+000393b0: 2e0d 0a20 2020 2020 2020 2020 2020 2020  ...             
+000393c0: 2020 2057 6520 6e6f 726d 616c 697a 6520     We normalize 
+000393d0: 6974 2068 6572 653a 0d0a 2020 2020 2020  it here:..      
+000393e0: 2020 2020 2020 2020 2020 2222 220d 0a20            """.. 
+000393f0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00039400: 2067 6574 2075 6e69 7420 6469 7265 6374   get unit direct
+00039410: 696f 6e20 7665 6374 6f72 2070 6572 7065  ion vector perpe
+00039420: 6e64 6963 756c 6172 2074 6f20 2875 2c76  ndicular to (u,v
+00039430: 2c77 290d 0a20 2020 2020 2020 2020 2020  ,w)..           
+00039440: 2020 2020 206e 6f72 6d20 3d20 6e70 2e6c       norm = np.l
+00039450: 696e 616c 672e 6e6f 726d 2875 7677 5b3a  inalg.norm(uvw[:
+00039460: 325d 290d 0a20 2020 2020 2020 2020 2020  2])..           
+00039470: 2020 2020 2069 6620 6e6f 726d 203e 2030       if norm > 0
+00039480: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00039490: 2020 2020 2020 2078 203d 2075 7677 5b31         x = uvw[1
+000394a0: 5d20 2f20 6e6f 726d 0d0a 2020 2020 2020  ] / norm..      
+000394b0: 2020 2020 2020 2020 2020 2020 2020 7920                y 
+000394c0: 3d20 2d75 7677 5b30 5d20 2f20 6e6f 726d  = -uvw[0] / norm
+000394d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000394e0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+000394f0: 2020 2020 2020 2020 2020 2020 2078 2c20               x, 
+00039500: 7920 3d20 302c 2031 0d0a 0d0a 2020 2020  y = 0, 1....    
+00039510: 2020 2020 2020 2020 2020 2020 2320 636f              # co
+00039520: 6d70 7574 6520 7468 6520 7477 6f20 6172  mpute the two ar
+00039530: 726f 7768 6561 6420 6469 7265 6374 696f  rowhead directio
+00039540: 6e20 756e 6974 2076 6563 746f 7273 0d0a  n unit vectors..
+00039550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039560: 7261 203d 206e 702e 7261 6469 616e 7328  ra = np.radians(
+00039570: 616e 676c 6529 0d0a 2020 2020 2020 2020  angle)..        
+00039580: 2020 2020 2020 2020 6320 3d20 6e70 2e63          c = np.c
+00039590: 6f73 2872 6129 0d0a 2020 2020 2020 2020  os(ra)..        
+000395a0: 2020 2020 2020 2020 7320 3d20 6e70 2e73          s = np.s
+000395b0: 696e 2872 6129 0d0a 0d0a 2020 2020 2020  in(ra)....      
+000395c0: 2020 2020 2020 2020 2020 2320 636f 6e73            # cons
+000395d0: 7472 7563 7420 7468 6520 726f 7461 7469  truct the rotati
+000395e0: 6f6e 206d 6174 7269 6365 730d 0a20 2020  on matrices..   
+000395f0: 2020 2020 2020 2020 2020 2020 2052 706f               Rpo
+00039600: 7320 3d20 6e70 2e61 7272 6179 285b 5b63  s = np.array([[c
+00039610: 2b28 782a 2a32 292a 2831 2d63 292c 2078  +(x**2)*(1-c), x
+00039620: 2a79 2a28 312d 6329 2c20 792a 735d 2c0d  *y*(1-c), y*s],.
+00039630: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00039640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039650: 205b 792a 782a 2831 2d63 292c 2063 2b28   [y*x*(1-c), c+(
+00039660: 792a 2a32 292a 2831 2d63 292c 202d 782a  y**2)*(1-c), -x*
+00039670: 735d 2c0d 0a20 2020 2020 2020 2020 2020  s],..           
+00039680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039690: 2020 2020 205b 2d79 2a73 2c20 782a 732c       [-y*s, x*s,
+000396a0: 2063 5d5d 290d 0a20 2020 2020 2020 2020   c]])..         
+000396b0: 2020 2020 2020 2023 206f 7070 6f73 6974         # opposit
+000396c0: 6520 726f 7461 7469 6f6e 206e 6567 6174  e rotation negat
+000396d0: 6573 2061 6c6c 2074 6865 2073 696e 2074  es all the sin t
+000396e0: 6572 6d73 0d0a 2020 2020 2020 2020 2020  erms..          
+000396f0: 2020 2020 2020 526e 6567 203d 2052 706f        Rneg = Rpo
+00039700: 732e 636f 7079 2829 0d0a 2020 2020 2020  s.copy()..      
+00039710: 2020 2020 2020 2020 2020 526e 6567 5b5b            Rneg[[
+00039720: 302c 2031 2c20 322c 2032 5d2c 205b 322c  0, 1, 2, 2], [2,
+00039730: 2032 2c20 302c 2031 5d5d 203d 205c 0d0a   2, 0, 1]] = \..
+00039740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039750: 2020 2020 2d52 6e65 675b 5b30 2c20 312c      -Rneg[[0, 1,
+00039760: 2032 2c20 325d 2c20 5b32 2c20 322c 2030   2, 2], [2, 2, 0
+00039770: 2c20 315d 5d0d 0a0d 0a20 2020 2020 2020  , 1]]....       
+00039780: 2020 2020 2020 2020 2023 206d 756c 7469           # multi
+00039790: 706c 7920 7468 656d 2074 6f20 6765 7420  ply them to get 
+000397a0: 7468 6520 726f 7461 7465 6420 7665 6374  the rotated vect
+000397b0: 6f72 0d0a 2020 2020 2020 2020 2020 2020  or..            
+000397c0: 2020 2020 7265 7475 726e 2052 706f 732e      return Rpos.
+000397d0: 646f 7428 7576 7729 2c20 526e 6567 2e64  dot(uvw), Rneg.d
+000397e0: 6f74 2875 7677 290d 0a20 2020 2020 2020  ot(uvw)..       
+000397f0: 2020 2020 2023 202e 2e2e 2e2e 2e2e 2e2e       # .........
 00039800: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
 00039810: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00039820: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00039830: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00039840: 2e0d 0a20 2020 2020 2020 200d 0a20 2020  ...        ..   
-00039850: 2020 2020 2069 6620 6e6f 7420 6973 696e       if not isin
-00039860: 7374 616e 6365 286f 7468 722c 2043 6f6c  stance(othr, Col
-00039870: 6f72 4c69 6e65 3344 436f 6c6c 6563 7469  orLine3DCollecti
-00039880: 6f6e 2920 3a0d 0a20 2020 2020 2020 2020  on) :..         
-00039890: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-000398a0: 726f 7228 2741 6464 206f 7065 7261 7469  ror('Add operati
-000398b0: 6f6e 7320 6361 6e20 6f6e 6c79 2061 7070  ons can only app
-000398c0: 6c79 2062 6574 7765 656e 2043 6f6c 6f72  ly between Color
-000398d0: 4c69 6e65 3344 436f 6c6c 6563 7469 6f6e  Line3DCollection
-000398e0: 206f 626a 6563 7473 2e27 290d 0a0d 0a20   objects.').... 
-000398f0: 2020 2020 2020 2023 2076 6572 7465 7843         # vertexC
-00039900: 6f6f 7220 6172 6520 6172 7261 792d 6c69  oor are array-li
-00039910: 6b65 2e0d 0a20 2020 2020 2020 2074 6f70  ke...        top
-00039920: 5665 7243 6f6f 7220 3d20 7365 6c66 2e76  VerCoor = self.v
-00039930: 6572 7465 7843 6f6f 720d 0a20 2020 2020  ertexCoor..     
-00039940: 2020 2062 6f74 5665 7243 6f6f 7220 3d20     botVerCoor = 
-00039950: 6f74 6872 2e76 6572 7465 7843 6f6f 720d  othr.vertexCoor.
-00039960: 0a20 2020 2020 2020 2074 6f74 5665 7243  .        totVerC
-00039970: 6f6f 7220 3d20 6e70 2e61 7070 656e 6428  oor = np.append(
-00039980: 746f 7056 6572 436f 6f72 2c62 6f74 5665  topVerCoor,botVe
-00039990: 7243 6f6f 722c 6178 6973 3d30 290d 0a20  rCoor,axis=0).. 
-000399a0: 2020 2020 2020 206e 6578 7449 6e64 6578         nextIndex
-000399b0: 203d 206c 656e 2874 6f70 5665 7243 6f6f   = len(topVerCoo
-000399c0: 7229 0d0a 0d0a 2020 2020 2020 2020 2320  r)....        # 
-000399d0: 6c69 6e65 496e 6469 6365 7320 6172 6520  lineIndices are 
-000399e0: 696e 7420 4c69 7374 730d 0a20 2020 2020  int Lists..     
-000399f0: 2020 2074 6f70 6c69 6e65 496e 6469 6365     toplineIndice
-00039a00: 7320 3d20 7365 6c66 2e6c 696e 6549 6e64  s = self.lineInd
-00039a10: 6963 6573 0d0a 2020 2020 2020 2020 626f  ices..        bo
-00039a20: 746c 696e 6549 6e64 6963 6573 203d 2063  tlineIndices = c
-00039a30: 6f70 792e 636f 7079 286f 7468 722e 6c69  opy.copy(othr.li
-00039a40: 6e65 496e 6469 6365 7329 0d0a 2020 2020  neIndices)..    
-00039a50: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
-00039a60: 6765 286c 656e 2862 6f74 6c69 6e65 496e  ge(len(botlineIn
-00039a70: 6469 6365 7329 2920 3a20 0d0a 2020 2020  dices)) : ..    
-00039a80: 2020 2020 2020 2020 626f 746c 696e 6549          botlineI
-00039a90: 6e64 6963 6573 5b69 5d20 3d20 6e70 2e61  ndices[i] = np.a
-00039aa0: 6464 2820 626f 746c 696e 6549 6e64 6963  dd( botlineIndic
-00039ab0: 6573 5b69 5d20 2c20 6e65 7874 496e 6465  es[i] , nextInde
-00039ac0: 7820 292e 746f 6c69 7374 2829 0d0a 2020  x ).tolist()..  
-00039ad0: 2020 2020 2020 746f 744c 696e 6549 6e64        totLineInd
-00039ae0: 6963 6573 203d 2063 6f70 792e 636f 7079  ices = copy.copy
-00039af0: 2874 6f70 6c69 6e65 496e 6469 6365 7329  (toplineIndices)
-00039b00: 0d0a 2020 2020 2020 2020 666f 7220 6c69  ..        for li
-00039b10: 6e65 2069 6e20 626f 746c 696e 6549 6e64  ne in botlineInd
-00039b20: 6963 6573 203a 0d0a 2020 2020 2020 2020  ices :..        
-00039b30: 2020 2020 746f 744c 696e 6549 6e64 6963      totLineIndic
-00039b40: 6573 2e61 7070 656e 6428 6c69 6e65 290d  es.append(line).
-00039b50: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
-00039b60: 2020 2023 2073 6567 6d49 6e64 6963 6573     # segmIndices
-00039b70: 2061 7265 2069 6e74 204c 6973 7473 0d0a   are int Lists..
-00039b80: 2020 2020 2020 2020 746f 7053 6567 6d49          topSegmI
-00039b90: 6e64 6963 6573 203d 2073 656c 662e 7365  ndices = self.se
-00039ba0: 676d 496e 6469 6365 730d 0a20 2020 2020  gmIndices..     
-00039bb0: 2020 2062 6f74 5365 676d 496e 6469 6365     botSegmIndice
-00039bc0: 7320 3d20 636f 7079 2e63 6f70 7928 6f74  s = copy.copy(ot
-00039bd0: 6872 2e73 6567 6d49 6e64 6963 6573 290d  hr.segmIndices).
-00039be0: 0a20 2020 2020 2020 2066 6f72 2069 2069  .        for i i
-00039bf0: 6e20 7261 6e67 6528 6c65 6e28 626f 7453  n range(len(botS
-00039c00: 6567 6d49 6e64 6963 6573 2929 203a 200d  egmIndices)) : .
-00039c10: 0a20 2020 2020 2020 2020 2020 2062 6f74  .            bot
-00039c20: 5365 676d 496e 6469 6365 735b 695d 203d  SegmIndices[i] =
-00039c30: 206e 702e 6164 6428 2062 6f74 5365 676d   np.add( botSegm
-00039c40: 496e 6469 6365 735b 695d 202c 206e 6578  Indices[i] , nex
-00039c50: 7449 6e64 6578 2029 2e74 6f6c 6973 7428  tIndex ).tolist(
-00039c60: 290d 0a20 2020 2020 2020 2074 6f74 5365  )..        totSe
-00039c70: 676d 496e 6469 6365 7320 3d20 636f 7079  gmIndices = copy
-00039c80: 2e63 6f70 7928 746f 7053 6567 6d49 6e64  .copy(topSegmInd
-00039c90: 6963 6573 290d 0a20 2020 2020 2020 2066  ices)..        f
-00039ca0: 6f72 206c 696e 6520 696e 2062 6f74 5365  or line in botSe
-00039cb0: 676d 496e 6469 6365 7320 3a0d 0a20 2020  gmIndices :..   
-00039cc0: 2020 2020 2020 2020 2074 6f74 5365 676d           totSegm
-00039cd0: 496e 6469 6365 732e 6170 7065 6e64 286c  Indices.append(l
-00039ce0: 696e 6529 0d0a 0d0a 2020 2020 2020 2020  ine)....        
-00039cf0: 2320 6564 6765 636f 6c6f 7273 2061 7265  # edgecolors are
-00039d00: 2061 7272 6179 2d6c 696b 650d 0a20 2020   array-like..   
-00039d10: 2020 2020 2074 6f70 4564 6765 436f 6c6f       topEdgeColo
-00039d20: 7273 203d 2067 6574 5f6c 696e 6543 6f6c  rs = get_lineCol
-00039d30: 6f72 7328 7365 6c66 2e5f 6564 6765 636f  ors(self._edgeco
-00039d40: 6c6f 7273 2c74 6f70 5365 676d 496e 6469  lors,topSegmIndi
-00039d50: 6365 7329 2020 0d0a 2020 2020 2020 2020  ces)  ..        
-00039d60: 626f 7445 6467 6543 6f6c 6f72 7320 3d20  botEdgeColors = 
-00039d70: 6765 745f 6c69 6e65 436f 6c6f 7273 286f  get_lineColors(o
-00039d80: 7468 722e 5f65 6467 6563 6f6c 6f72 732c  thr._edgecolors,
-00039d90: 626f 7453 6567 6d49 6e64 6963 6573 290d  botSegmIndices).
-00039da0: 0a20 2020 2020 2020 2074 6f74 4564 6765  .        totEdge
-00039db0: 436f 6c6f 7273 203d 206e 702e 6170 7065  Colors = np.appe
-00039dc0: 6e64 2874 6f70 4564 6765 436f 6c6f 7273  nd(topEdgeColors
-00039dd0: 2c62 6f74 4564 6765 436f 6c6f 7273 2c61  ,botEdgeColors,a
-00039de0: 7869 733d 3029 0d0a 0d0a 2020 2020 2020  xis=0)....      
-00039df0: 2020 2320 4675 7444 6576 3a20 2761 6464    # FutDev: 'add
-00039e00: 2720 7769 6c6c 206e 6f74 2072 6574 6169  ' will not retai
-00039e10: 6e20 6c69 6e65 2063 6f6c 6c65 6374 696f  n line collectio
-00039e20: 6e73 2e20 204e 6565 6465 6420 666f 7220  ns.  Needed for 
-00039e30: 6578 706f 7274 0d0a 2020 2020 2020 2020  export..        
-00039e40: 2320 2020 2020 2020 2020 2062 7574 2073  #          but s
-00039e50: 7566 6669 6369 656e 7420 666f 7220 7265  ufficient for re
-00039e60: 6e64 6572 696e 672e 204d 524f 490d 0a20  ndering. MROI.. 
-00039e70: 2020 2020 2020 206e 6577 4c69 6e65 203d         newLine =
-00039e80: 2043 6f6c 6f72 4c69 6e65 3344 436f 6c6c   ColorLine3DColl
-00039e90: 6563 7469 6f6e 2874 6f74 5665 7243 6f6f  ection(totVerCoo
-00039ea0: 722c 746f 7453 6567 6d49 6e64 6963 6573  r,totSegmIndices
-00039eb0: 2c63 6f6c 6f72 3d74 6f74 4564 6765 436f  ,color=totEdgeCo
-00039ec0: 6c6f 7273 290d 0a20 2020 200d 0a20 2020  lors)..    ..   
-00039ed0: 2020 2020 206e 6577 4c69 6e65 2e69 7353       newLine.isS
-00039ee0: 6872 6564 6465 6420 3d20 7365 6c66 2e69  hredded = self.i
-00039ef0: 7353 6872 6564 6465 6420 616e 6420 6f74  sShredded and ot
-00039f00: 6872 2e69 7353 6872 6564 6465 640d 0a20  hr.isShredded.. 
-00039f10: 2020 2020 2020 206e 6577 4c69 6e65 2e5f         newLine._
-00039f20: 706c 616e 654e 6f72 6d61 6c20 3d20 4e6f  planeNormal = No
-00039f30: 6e65 2020 232e 2e20 636f 756c 6420 6368  ne  #.. could ch
-00039f40: 6563 6b20 6865 7265 2069 6620 7361 6d65  eck here if same
-00039f50: 206e 6f72 6d61 6c73 2e0d 0a20 2020 2020   normals...     
-00039f60: 2020 206e 6577 4c69 6e65 2e5f 7365 745f     newLine._set_
-00039f70: 6765 6f6d 6574 7269 635f 626f 756e 6473  geometric_bounds
-00039f80: 2829 0d0a 0d0a 2020 2020 2020 2020 7265  ()....        re
-00039f90: 7475 726e 206e 6577 4c69 6e65 0d0a 0d0a  turn newLine....
-00039fa0: 2020 2020 6465 6620 5f5f 7374 725f 5f28      def __str__(
-00039fb0: 7365 6c66 2920 3a0d 0a20 2020 2020 2020  self) :..       
-00039fc0: 2023 206e 6f74 653a 2065 6163 6820 6c69   # note: each li
-00039fd0: 6e65 2072 6570 7265 7365 6e74 6174 696f  ne representatio
-00039fe0: 6e20 6973 2063 6f6d 706f 7365 6420 6f66  n is composed of
-00039ff0: 206d 756c 7469 706c 6520 7365 676d 656e   multiple segmen
-0003a000: 7420 6c69 6e65 732e 0d0a 2020 2020 2020  t lines...      
-0003a010: 2020 6e75 6d56 6572 7473 203d 206c 656e    numVerts = len
-0003a020: 2873 656c 662e 7665 7274 6578 436f 6f72  (self.vertexCoor
-0003a030: 290d 0a20 2020 2020 2020 206e 756d 4c69  )..        numLi
-0003a040: 6e65 7320 3d20 6c65 6e28 7365 6c66 2e6c  nes = len(self.l
-0003a050: 696e 6549 6e64 6963 6573 290d 0a20 2020  ineIndices)..   
-0003a060: 2020 2020 206e 756d 5365 6720 3d20 300d       numSeg = 0.
-0003a070: 0a20 2020 2020 2020 2066 6f72 206c 696e  .        for lin
-0003a080: 6520 696e 2073 656c 662e 5f73 6567 6d65  e in self._segme
-0003a090: 6e74 7333 6420 3a0d 0a20 2020 2020 2020  nts3d :..       
-0003a0a0: 2020 2020 206e 756d 5365 6720 2b3d 206c       numSeg += l
-0003a0b0: 656e 286c 696e 6529 202d 310d 0a20 2020  en(line) -1..   
-0003a0c0: 2020 2020 206e 616d 6520 3d20 7365 6c66       name = self
-0003a0d0: 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e 616d  .__class__.__nam
-0003a0e0: 655f 5f0d 0a20 2020 2020 2020 2069 6620  e__..        if 
-0003a0f0: 7365 6c66 2e72 657a 2069 7320 6e6f 7420  self.rez is not 
-0003a100: 4e6f 6e65 203a 206e 616d 6520 3d20 6e61  None : name = na
-0003a110: 6d65 202b 2027 2028 7b7d 293a 272e 666f  me + ' ({}):'.fo
-0003a120: 726d 6174 2873 656c 662e 7265 7a29 0d0a  rmat(self.rez)..
-0003a130: 2020 2020 2020 2020 7661 6c20 3d20 6e61          val = na
-0003a140: 6d65 202b 2027 3a20 6c69 6e65 733a 207b  me + ': lines: {
-0003a150: 7d2c 2073 6567 733a 207b 7d2c 2076 6572  }, segs: {}, ver
-0003a160: 7473 3a20 7b7d 272e 666f 726d 6174 286e  ts: {}'.format(n
-0003a170: 756d 4c69 6e65 732c 6e75 6d53 6567 2c6e  umLines,numSeg,n
-0003a180: 756d 5665 7274 7329 0d0a 2020 2020 2020  umVerts)..      
-0003a190: 2020 7265 7475 726e 2076 616c 0d0a 0d0a    return val....
-0003a1a0: 2020 2020 6465 6620 5f73 6872 6564 2873      def _shred(s
-0003a1b0: 656c 6629 203a 0d0a 2020 2020 2020 2020  elf) :..        
-0003a1c0: 2320 636f 6e76 6572 7420 6d75 6c74 692d  # convert multi-
-0003a1d0: 7365 676d 656e 7420 6c69 6e65 7320 746f  segment lines to
-0003a1e0: 206d 756c 7469 706c 6520 6f6e 652d 7365   multiple one-se
-0003a1f0: 676d 656e 7420 6c69 6e65 732e 0d0a 2020  gment lines...  
-0003a200: 2020 2020 2020 2320 5265 7175 6972 6564        # Required
-0003a210: 2066 6f72 2061 7070 6c69 6361 7469 6f6e   for application
-0003a220: 206f 6620 6e6f 6e2d 756e 6966 6f72 6d20   of non-uniform 
-0003a230: 6c69 6e65 2063 6f6c 6f72 2e0d 0a20 2020  line color...   
-0003a240: 2020 2020 200d 0a20 2020 2020 2020 206c       ..        l
-0003a250: 696e 6573 6567 7320 3d20 7365 6c66 2e6c  inesegs = self.l
-0003a260: 696e 6549 6e64 6963 6573 0d0a 2020 2020  ineIndices..    
-0003a270: 2020 2020 696e 6469 6365 7320 3d20 5b5d      indices = []
-0003a280: 0d0a 2020 2020 2020 2020 666f 7220 6c69  ..        for li
-0003a290: 6e65 2069 6e20 6c69 6e65 7365 6773 203a  ne in linesegs :
-0003a2a0: 0d0a 2020 2020 2020 2020 2020 2020 6e75  ..            nu
-0003a2b0: 6d53 6567 7320 3d20 6c65 6e28 6c69 6e65  mSegs = len(line
-0003a2c0: 2920 2d20 310d 0a20 2020 2020 2020 2020  ) - 1..         
-0003a2d0: 2020 2066 6f72 2073 6567 2069 6e20 7261     for seg in ra
-0003a2e0: 6e67 6520 286e 756d 5365 6773 2920 3a0d  nge (numSegs) :.
-0003a2f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003a300: 2074 203d 205b 206c 696e 655b 7365 675d   t = [ line[seg]
-0003a310: 2c6c 696e 655b 7365 672b 315d 205d 0d0a  ,line[seg+1] ]..
-0003a320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a330: 696e 6469 6365 732e 6170 7065 6e64 2874  indices.append(t
-0003a340: 290d 0a20 2020 2020 2020 2073 6567 6d65  )..        segme
-0003a350: 6e74 7320 3d20 7365 6c66 2e76 6572 7465  nts = self.verte
-0003a360: 7843 6f6f 725b 6e70 2e61 7272 6179 2869  xCoor[np.array(i
-0003a370: 6e64 6963 6573 295d 0d0a 2020 2020 2020  ndices)]..      
-0003a380: 2020 7365 6c66 2e73 6567 6d49 6e64 6963    self.segmIndic
-0003a390: 6573 203d 2069 6e64 6963 6573 0d0a 2020  es = indices..  
-0003a3a0: 2020 2020 2020 7365 6c66 2e73 6574 5f73        self.set_s
-0003a3b0: 6567 6d65 6e74 7328 7365 676d 656e 7473  egments(segments
-0003a3c0: 290d 0a20 2020 2020 2020 2073 656c 662e  )..        self.
-0003a3d0: 6973 5368 7265 6464 6564 203d 2054 7275  isShredded = Tru
-0003a3e0: 650d 0a20 2020 2020 2020 2072 6574 7572  e..        retur
-0003a3f0: 6e20 7365 676d 656e 7473 0d0a 0d0a 2020  n segments....  
-0003a400: 2020 6465 6620 5f73 6872 6564 5f73 6567    def _shred_seg
-0003a410: 6d5f 636f 6c6f 7228 7365 6c66 2c6e 756d  m_color(self,num
-0003a420: 4469 7629 203a 0d0a 2020 2020 2020 2020  Div) :..        
-0003a430: 696e 6974 436f 6c6f 7273 203d 2073 656c  initColors = sel
-0003a440: 662e 5f65 6467 6563 6f6c 6f72 7320 2023  f._edgecolors  #
-0003a450: 2063 6f6c 6f72 7320 6265 666f 7265 206c   colors before l
-0003a460: 696e 6520 7368 7265 6464 696e 670d 0a20  ine shredding.. 
-0003a470: 2020 2020 2020 206e 756d 436f 6c6f 7273         numColors
-0003a480: 203d 206c 656e 2869 6e69 7443 6f6c 6f72   = len(initColor
-0003a490: 7329 0d0a 2020 2020 2020 2020 6c69 6e65  s)..        line
-0003a4a0: 7365 6773 203d 2073 656c 662e 7365 676d  segs = self.segm
-0003a4b0: 496e 6469 6365 730d 0a20 2020 2020 2020  Indices..       
-0003a4c0: 2063 6f6c 6f72 7320 3d20 5b5d 0d0a 2020   colors = []..  
-0003a4d0: 2020 2020 2020 636f 6c6f 7249 6e64 6578        colorIndex
-0003a4e0: 203d 2030 0d0a 2020 2020 2020 2020 666f   = 0..        fo
-0003a4f0: 7220 6c69 6e65 2069 6e20 6c69 6e65 7365  r line in linese
-0003a500: 6773 203a 0d0a 2020 2020 2020 2020 2020  gs :..          
-0003a510: 2020 6375 7272 656e 7443 6f6c 6f72 203d    currentColor =
-0003a520: 2069 6e69 7443 6f6c 6f72 735b 636f 6c6f   initColors[colo
-0003a530: 7249 6e64 6578 5d0d 0a20 2020 2020 2020  rIndex]..       
-0003a540: 2020 2020 2066 6f72 2073 6567 2069 6e20       for seg in 
-0003a550: 7261 6e67 6520 286e 756d 4469 7629 203a  range (numDiv) :
-0003a560: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0003a570: 2020 636f 6c6f 7273 2e61 7070 656e 6428    colors.append(
-0003a580: 6375 7272 656e 7443 6f6c 6f72 290d 0a20  currentColor).. 
-0003a590: 2020 2020 2020 2020 2020 2063 6f6c 6f72             color
-0003a5a0: 496e 6465 7820 3d20 2863 6f6c 6f72 496e  Index = (colorIn
-0003a5b0: 6465 782b 3129 256e 756d 436f 6c6f 7273  dex+1)%numColors
-0003a5c0: 0d0a 2020 2020 2020 2020 636f 6c6f 7273  ..        colors
-0003a5d0: 203d 206e 702e 6172 7261 7928 636f 6c6f   = np.array(colo
-0003a5e0: 7273 2920 2020 2020 2320 636f 6c6f 7273  rs)     # colors
-0003a5f0: 2061 6674 6572 206c 696e 6520 7368 7265   after line shre
-0003a600: 6464 696e 670d 0a0d 0a20 2020 2020 2020  dding....       
-0003a610: 2072 6574 7572 6e20 636f 6c6f 7273 0d0a   return colors..
-0003a620: 0d0a 2020 2020 6465 6620 5f73 6872 6564  ..    def _shred
-0003a630: 5f63 6f6c 6f72 2873 656c 6629 203a 0d0a  _color(self) :..
-0003a640: 2020 2020 2020 2020 2320 5369 6e63 6520          # Since 
-0003a650: 6c69 6e65 2063 6f6c 6f72 7320 6172 6520  line colors are 
-0003a660: 696e 2061 2053 494e 474c 4520 4c69 7374  in a SINGLE List
-0003a670: 206f 6620 636f 6c6f 7273 0d0a 2020 2020   of colors..    
-0003a680: 2020 2020 2320 666f 7220 6d75 6c69 7470      # for mulitp
-0003a690: 6c65 206c 696e 6573 2077 6974 6820 6d75  le lines with mu
-0003a6a0: 6c74 6970 6c65 2073 6567 6d65 6e74 2063  ltiple segment c
-0003a6b0: 6f6c 6f72 732c 0d0a 2020 2020 2020 2020  olors,..        
-0003a6c0: 2320 636f 6c6f 7273 2066 6f72 2061 206d  # colors for a m
-0003a6d0: 756c 7469 2d73 6567 6d65 6e74 206c 696e  ulti-segment lin
-0003a6e0: 6520 6f66 2061 2073 696e 676c 6520 636f  e of a single co
-0003a6f0: 6c6f 720d 0a20 2020 2020 2020 2023 2069  lor..        # i
-0003a700: 7320 7265 636f 6e73 7472 7563 7465 6420  s reconstructed 
-0003a710: 696e 746f 206d 756c 7469 706c 6520 636f  into multiple co
-0003a720: 6c6f 7273 206f 6620 7468 650d 0a20 2020  lors of the..   
-0003a730: 2020 2020 2023 2073 616d 6520 636f 6c6f       # same colo
-0003a740: 722e 2020 2820 7365 6520 5f73 6872 6564  r.  ( see _shred
-0003a750: 2029 0d0a 2020 2020 2020 2020 2320 496e   )..        # In
-0003a760: 6469 7669 6475 616c 2073 6567 656d 6e74  dividual segemnt
-0003a770: 2063 6f6c 6f72 7320 6172 6520 6e65 6564   colors are need
-0003a780: 6564 2066 6f72 206c 696e 650d 0a20 2020  ed for line..   
-0003a790: 2020 2020 2023 2073 6861 6469 6e67 2c20       # shading, 
-0003a7a0: 636c 6970 7069 6e67 2c20 616e 6420 616c  clipping, and al
-0003a7b0: 7068 6120 7365 7474 696e 672e 0d0a 0d0a  pha setting.....
-0003a7c0: 2020 2020 2020 2020 696e 6974 436f 6c6f          initColo
-0003a7d0: 7273 203d 2073 656c 662e 5f65 6467 6563  rs = self._edgec
-0003a7e0: 6f6c 6f72 7320 2023 2063 6f6c 6f72 7320  olors  # colors 
-0003a7f0: 6265 666f 7265 206c 696e 6520 7368 7265  before line shre
-0003a800: 6464 696e 670d 0a20 2020 2020 2020 206e  dding..        n
-0003a810: 756d 436f 6c6f 7273 203d 206c 656e 2869  umColors = len(i
-0003a820: 6e69 7443 6f6c 6f72 7329 0d0a 2020 2020  nitColors)..    
-0003a830: 2020 2020 6c69 6e65 7365 6773 203d 2073      linesegs = s
-0003a840: 656c 662e 6c69 6e65 496e 6469 6365 730d  elf.lineIndices.
-0003a850: 0a20 2020 2020 2020 2063 6f6c 6f72 7320  .        colors 
-0003a860: 3d20 5b5d 0d0a 2020 2020 2020 2020 636f  = []..        co
-0003a870: 6c6f 7249 6e64 6578 203d 2030 0d0a 2020  lorIndex = 0..  
-0003a880: 2020 2020 2020 666f 7220 6c69 6e65 2069        for line i
-0003a890: 6e20 6c69 6e65 7365 6773 203a 0d0a 2020  n linesegs :..  
-0003a8a0: 2020 2020 2020 2020 2020 6e75 6d53 6567            numSeg
-0003a8b0: 7320 3d20 6c65 6e28 6c69 6e65 2920 2d20  s = len(line) - 
-0003a8c0: 310d 0a20 2020 2020 2020 2020 2020 2063  1..            c
-0003a8d0: 7572 7265 6e74 436f 6c6f 7220 3d20 696e  urrentColor = in
-0003a8e0: 6974 436f 6c6f 7273 5b63 6f6c 6f72 496e  itColors[colorIn
-0003a8f0: 6465 785d 0d0a 2020 2020 2020 2020 2020  dex]..          
-0003a900: 2020 666f 7220 7365 6720 696e 2072 616e    for seg in ran
-0003a910: 6765 2028 6e75 6d53 6567 7329 203a 0d0a  ge (numSegs) :..
-0003a920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a930: 636f 6c6f 7273 2e61 7070 656e 6428 6375  colors.append(cu
-0003a940: 7272 656e 7443 6f6c 6f72 290d 0a20 2020  rrentColor)..   
-0003a950: 2020 2020 2020 2020 2063 6f6c 6f72 496e           colorIn
-0003a960: 6465 7820 3d20 2863 6f6c 6f72 496e 6465  dex = (colorInde
-0003a970: 782b 3129 256e 756d 436f 6c6f 7273 0d0a  x+1)%numColors..
-0003a980: 2020 2020 2020 2020 636f 6c6f 7273 203d          colors =
-0003a990: 206e 702e 6172 7261 7928 636f 6c6f 7273   np.array(colors
-0003a9a0: 2920 2020 2020 2320 636f 6c6f 7273 2061  )     # colors a
-0003a9b0: 6674 6572 206c 696e 6520 7368 7265 6464  fter line shredd
-0003a9c0: 696e 670d 0a0d 0a20 2020 2020 2020 2072  ing....        r
-0003a9d0: 6574 7572 6e20 636f 6c6f 7273 0d0a 0d0a  eturn colors....
-0003a9e0: 2020 2020 6465 6620 5f67 6574 5f73 6567      def _get_seg
-0003a9f0: 6d65 6e74 5f63 656e 7465 7273 2873 656c  ment_centers(sel
-0003aa00: 662c 7365 676d 656e 7473 2920 3a0d 0a20  f,segments) :.. 
-0003aa10: 2020 2020 2020 2023 2073 6567 6d65 6e74         # segment
-0003aa20: 2063 656e 7465 7273 2066 726f 6d20 7365   centers from se
-0003aa30: 676d 656e 7420 706f 696e 7420 636f 6f72  gment point coor
-0003aa40: 6469 6e61 7465 732e 0d0a 2020 2020 2020  dinates...      
-0003aa50: 2020 2320 4173 7375 6d65 6420 7365 676d    # Assumed segm
-0003aa60: 656e 7473 206f 6620 6120 7368 7265 6464  ents of a shredd
-0003aa70: 6564 206c 696e 652e 0d0a 2020 2020 2020  ed line...      
-0003aa80: 2020 7666 5420 3d20 6e70 2e74 7261 6e73    vfT = np.trans
-0003aa90: 706f 7365 2873 6567 6d65 6e74 732c 2028  pose(segments, (
-0003aaa0: 312c 322c 3029 2029 0d0a 2020 2020 2020  1,2,0) )..      
-0003aab0: 2020 6e75 6d56 6572 7473 203d 2076 6654    numVerts = vfT
-0003aac0: 2e73 6861 7065 5b30 5d0d 0a20 2020 2020  .shape[0]..     
-0003aad0: 2020 2073 756d 5620 3d20 6e70 2e73 756d     sumV = np.sum
-0003aae0: 2876 6654 2c20 6178 6973 3d30 290d 0a20  (vfT, axis=0).. 
-0003aaf0: 2020 2020 2020 2072 6574 7572 6e20 6e70         return np
-0003ab00: 2e74 7261 6e73 706f 7365 2873 756d 5629  .transpose(sumV)
-0003ab10: 2f6e 756d 5665 7274 730d 0a0d 0a20 2020  /numVerts....   
-0003ab20: 2064 6566 205f 6765 745f 7365 676d 656e   def _get_segmen
-0003ab30: 745f 6469 7265 6374 696f 6e73 2873 656c  t_directions(sel
-0003ab40: 662c 7365 676d 656e 7473 2920 3a0d 0a20  f,segments) :.. 
-0003ab50: 2020 2020 2020 2023 2073 6567 6d65 6e74         # segment
-0003ab60: 2075 6e69 7420 6469 7265 6374 696f 6e73   unit directions
-0003ab70: 2066 726f 6d20 7365 676d 656e 7420 706f   from segment po
-0003ab80: 696e 7420 636f 6f72 6469 6e61 7465 732e  int coordinates.
-0003ab90: 0d0a 2020 2020 2020 2020 2320 4173 7375  ..        # Assu
-0003aba0: 6d65 6420 7365 676d 656e 7473 206f 6620  med segments of 
-0003abb0: 6120 7368 7265 6464 6564 206c 696e 652e  a shredded line.
-0003abc0: 0d0a 2020 2020 2020 2020 7666 5420 3d20  ..        vfT = 
-0003abd0: 6e70 2e74 7261 6e73 706f 7365 2873 6567  np.transpose(seg
-0003abe0: 6d65 6e74 732c 2028 312c 302c 3229 2029  ments, (1,0,2) )
-0003abf0: 0d0a 2020 2020 2020 2020 6469 7265 6374  ..        direct
-0003ac00: 696f 6e20 3d20 7666 545b 315d 202d 2076  ion = vfT[1] - v
-0003ac10: 6654 5b30 5d0d 0a20 2020 2020 2020 2073  fT[0]..        s
-0003ac20: 7a20 3d20 6e70 2e6c 696e 616c 672e 6e6f  z = np.linalg.no
-0003ac30: 726d 2864 6972 6563 7469 6f6e 2c20 6178  rm(direction, ax
-0003ac40: 6973 3d31 295b 3a2c 6e70 2e6e 6577 6178  is=1)[:,np.newax
-0003ac50: 6973 5d0d 0a20 2020 2020 2020 2075 6e69  is]..        uni
-0003ac60: 7456 6563 746f 7220 3d20 6e70 2e64 6976  tVector = np.div
-0003ac70: 6964 6528 2064 6972 6563 7469 6f6e 2c20  ide( direction, 
-0003ac80: 737a 2029 0d0a 2020 2020 2020 2020 7265  sz )..        re
-0003ac90: 7475 726e 2075 6e69 7456 6563 746f 720d  turn unitVector.
-0003aca0: 0a0d 0a20 2020 2064 6566 205f 7365 745f  ...    def _set_
-0003acb0: 6765 6f6d 6574 7269 635f 626f 756e 6473  geometric_bounds
-0003acc0: 2873 656c 6629 203a 0d0a 2020 2020 2020  (self) :..      
-0003acd0: 2020 5f73 6574 5f67 656f 6d42 6f75 6e64    _set_geomBound
-0003ace0: 7328 7365 6c66 2e76 6572 7465 7843 6f6f  s(self.vertexCoo
-0003acf0: 722c 7365 6c66 2e5f 626f 756e 6473 290d  r,self._bounds).
-0003ad00: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0003ad10: 2020 200d 0a20 2020 200d 0a20 2020 2064     ..    ..    d
-0003ad20: 6566 205f 6765 745f 7365 676d 656e 7473  ef _get_segments
-0003ad30: 2820 7365 6c66 2c20 762c 2053 2020 2920  ( self, v, S  ) 
-0003ad40: 3a0d 0a20 2020 2020 2020 2023 2053 696e  :..        # Sin
-0003ad50: 6365 206c 696e 6520 7365 676d 656e 7473  ce line segments
-0003ad60: 2061 7265 2069 6e20 6120 4c69 7374 206f   are in a List o
-0003ad70: 6620 6d75 6c74 6970 6c65 206c 696e 6573  f multiple lines
-0003ad80: 2c0d 0a20 2020 2020 2020 2023 206c 696e  ,..        # lin
-0003ad90: 6520 7665 7274 6963 6573 2061 7265 2073  e vertices are s
-0003ada0: 6574 2070 6572 206c 696e 6520 696e 2074  et per line in t
-0003adb0: 6865 206c 696e 6520 636f 6c6c 6563 7469  he line collecti
-0003adc0: 6f6e 0d0a 2020 2020 2020 2020 2320 746f  on..        # to
-0003add0: 2072 6563 6f6e 7374 7275 6374 2074 6865   reconstruct the
-0003ade0: 2073 6567 6d65 6e74 2063 6f6f 7264 696e   segment coordin
-0003adf0: 6174 6573 2028 2073 656c 662e 5f73 6567  ates ( self._seg
-0003ae00: 6d65 6e74 7333 6420 290d 0a0d 0a20 2020  ments3d )....   
-0003ae10: 2020 2020 2023 2044 6576 4e6f 7465 3a20       # DevNote: 
-0003ae20: 676f 7420 746f 2062 6520 6120 6265 7474  got to be a bett
-0003ae30: 6572 2077 6179 206f 6620 646f 696e 6720  er way of doing 
-0003ae40: 7468 6973 2c20 6275 7420 6c69 6e65 0d0a  this, but line..
-0003ae50: 2020 2020 2020 2020 2320 2020 2020 2020          #       
-0003ae60: 2020 2073 6574 7320 6172 6520 6c69 7374     sets are list
-0003ae70: 7320 7769 7468 2076 6172 7969 6e67 206e  s with varying n
-0003ae80: 756d 6265 7220 6f66 2073 6567 6d65 6e74  umber of segment
-0003ae90: 730d 0a20 2020 2020 2020 2023 2020 2020  s..        #    
-0003aea0: 2020 2020 2020 756e 7469 6c20 7368 7265        until shre
-0003aeb0: 6464 6564 2c20 7468 656e 2061 6c6c 2074  dded, then all t
-0003aec0: 6865 2073 616d 6520 6e75 6d62 6572 206f  he same number o
-0003aed0: 6620 7365 6773 2e0d 0a0d 0a20 2020 2020  f segs.....     
-0003aee0: 2020 2069 6620 7365 6c66 2e69 7353 6872     if self.isShr
-0003aef0: 6564 6465 6420 3a20 2072 6574 7572 6e20  edded :  return 
-0003af00: 765b 6e70 2e61 7272 6179 2853 295d 0d0a  v[np.array(S)]..
-0003af10: 0d0a 2020 2020 2020 2020 7365 676d 656e  ..        segmen
-0003af20: 7473 203d 205b 4e6f 6e65 5d2a 6c65 6e28  ts = [None]*len(
-0003af30: 5329 0d0a 2020 2020 2020 2020 666f 7220  S)..        for 
-0003af40: 7665 726c 6973 7420 696e 2072 616e 6765  verlist in range
-0003af50: 286c 656e 2853 2929 203a 0d0a 2020 2020  (len(S)) :..    
-0003af60: 2020 2020 2020 2020 7665 7241 7272 203d          verArr =
-0003af70: 205b 4e6f 6e65 5d2a 6c65 6e28 2053 5b76   [None]*len( S[v
-0003af80: 6572 6c69 7374 5d20 290d 0a20 2020 2020  erlist] )..     
-0003af90: 2020 2020 2020 2066 6f72 2076 6572 496e         for verIn
-0003afa0: 7820 696e 2072 616e 6765 2820 6c65 6e28  x in range( len(
-0003afb0: 2053 5b76 6572 6c69 7374 5d20 2920 2920   S[verlist] ) ) 
-0003afc0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0003afd0: 2020 2076 6572 4172 725b 7665 7249 6e78     verArr[verInx
-0003afe0: 5d20 3d20 765b 2053 5b76 6572 6c69 7374  ] = v[ S[verlist
-0003aff0: 5d5b 7665 7249 6e78 5d20 5d0d 0a20 2020  ][verInx] ]..   
-0003b000: 2020 2020 2020 2020 2073 6567 6d65 6e74           segment
-0003b010: 735b 7665 726c 6973 745d 203d 2076 6572  s[verlist] = ver
-0003b020: 4172 720d 0a0d 0a20 2020 2020 2020 2072  Arr....        r
-0003b030: 6574 7572 6e20 7365 676d 656e 7473 0d0a  eturn segments..
-0003b040: 2020 2020 0d0a 2020 2020 2320 2d2d 2d2d      ..    # ----
-0003b050: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0003b060: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0003b070: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0003b080: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0003b090: 2d2b 0d0a 2020 2020 2320 4e6f 7465 3a20  -+..    # Note: 
-0003b0a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b0d0: 2020 2020 2020 2020 2020 2020 2020 207c                 |
-0003b0e0: 0d0a 2020 2020 2320 7468 6520 666f 6c6c  ..    # the foll
-0003b0f0: 6f77 696e 6720 6669 7665 205f 632e 2e2e  owing five _c...
-0003b100: 2e5f 7665 7274 206d 6574 686f 6473 2061  ._vert methods a
-0003b110: 7373 6967 6e20 636f 6c6f 7220 616e 6420  ssign color and 
-0003b120: 7661 6c75 6573 2066 6f72 2020 207c 0d0a  values for   |..
-0003b130: 2020 2020 2320 6561 6368 2076 6572 7465      # each verte
-0003b140: 7820 7768 6963 6820 6172 6520 6f6e 6c79  x which are only
-0003b150: 2075 7365 6420 666f 7220 4675 7444 6576   used for FutDev
-0003b160: 2065 7870 6f72 7420 6f66 2076 6572 7465   export of verte
-0003b170: 7820 636f 6c6f 7273 2020 207c 0d0a 2020  x colors   |..  
-0003b180: 2020 2320 2873 6567 6d65 6e74 2063 656e    # (segment cen
-0003b190: 7465 7220 636f 6c6f 7273 2061 7265 2075  ter colors are u
-0003b1a0: 7365 6420 666f 7220 7468 6520 6d61 7470  sed for the matp
-0003b1b0: 6c6f 746c 6962 2072 656e 6465 7269 6e67  lotlib rendering
-0003b1c0: 2920 2020 2020 2020 207c 0d0a 2020 2020  )        |..    
-0003b1d0: 2320 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  # --------------
-0003b1e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0003b1f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0003b200: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0003b210: 2d2d 2d2d 2d2d 2d2b 200d 0a0d 0a20 2020  -------+ ....   
-0003b220: 2064 6566 205f 6d61 705f 636d 6170 5f66   def _map_cmap_f
-0003b230: 726f 6d5f 7365 7175 656e 6365 5f76 6572  rom_sequence_ver
-0003b240: 7428 7365 6c66 2c63 6d61 7029 203a 0d0a  t(self,cmap) :..
-0003b250: 2020 2020 2020 2020 6920 3d20 6e70 2e6c          i = np.l
-0003b260: 696e 7370 6163 6528 302e 302c 312e 302c  inspace(0.0,1.0,
-0003b270: 206c 656e 2873 656c 662e 7665 7274 6578   len(self.vertex
-0003b280: 436f 6f72 2920 2920 2020 200d 0a20 2020  Coor) )    ..   
-0003b290: 2020 2020 206e 6f72 6d20 3d20 636f 6c6f       norm = colo
-0003b2a0: 7273 2e4e 6f72 6d61 6c69 7a65 2876 6d69  rs.Normalize(vmi
-0003b2b0: 6e3d 302e 302c 766d 6178 3d31 2e30 290d  n=0.0,vmax=1.0).
-0003b2c0: 0a0d 0a20 2020 2020 2020 2063 6f6c 6f72  ...        color
-0003b2d0: 203d 2063 6d61 7028 6e6f 726d 2869 2929   = cmap(norm(i))
-0003b2e0: 0d0a 2020 2020 2020 2020 7365 6c66 2e76  ..        self.v
-0003b2f0: 6572 7465 7843 6f6c 6f72 203d 2063 6f6c  ertexColor = col
-0003b300: 6f72 0d0a 2020 2020 2020 2020 7365 6c66  or..        self
-0003b310: 2e76 6572 7465 7856 616c 7565 7320 3d20  .vertexValues = 
-0003b320: 6c69 7374 2820 7261 6e67 6528 6c65 6e28  list( range(len(
-0003b330: 7365 6c66 2e76 6572 7465 7843 6f6f 7229  self.vertexCoor)
-0003b340: 2920 290d 0a20 2020 2020 2020 2073 656c  ) )..        sel
-0003b350: 662e 5f62 6f75 6e64 735b 2776 6572 7476  f._bounds['vertv
-0003b360: 6c69 6d27 5d20 3d20 5b20 302e 302c 2031  lim'] = [ 0.0, 1
-0003b370: 2e30 205d 0d0a 2020 2020 2020 2020 7265  .0 ]..        re
-0003b380: 7475 726e 0d0a 0d0a 2020 2020 6465 6620  turn....    def 
-0003b390: 5f6d 6170 5f63 6d61 705f 6672 6f6d 5f64  _map_cmap_from_d
-0003b3a0: 6972 6563 7469 6f6e 5f76 6572 7428 2073  irection_vert( s
-0003b3b0: 656c 662c 2065 6467 6563 6f6c 6f72 732c  elf, edgecolors,
-0003b3c0: 2065 6467 6576 616c 7565 732c 2076 426f   edgevalues, vBo
-0003b3d0: 756e 6473 2029 203a 0d0a 2020 2020 2020  unds ) :..      
-0003b3e0: 2020 2320 7369 6e63 6520 7468 6520 6469    # since the di
-0003b3f0: 7265 6374 696f 6e20 6973 2064 6570 656e  rection is depen
-0003b400: 6465 6e74 206f 6e20 7477 6f20 7665 7274  dent on two vert
-0003b410: 6963 6573 2c0d 0a20 2020 2020 2020 2023  ices,..        #
-0003b420: 2074 6865 2073 6567 6d65 6e74 2063 6f6c   the segment col
-0003b430: 6f72 7320 6172 6520 7573 6564 2066 6f72  ors are used for
-0003b440: 2074 6865 2076 6572 7465 7843 6f6c 6f72   the vertexColor
-0003b450: 732e 0d0a 2020 2020 2020 2020 2320 5468  s...        # Th
-0003b460: 6520 6c61 7374 2076 6572 7465 7820 636f  e last vertex co
-0003b470: 6c6f 7220 6973 2061 7373 6967 6e65 6420  lor is assigned 
-0003b480: 7468 6520 6c61 7374 2073 6567 6d65 6e74  the last segment
-0003b490: 0d0a 2020 2020 2020 2020 2320 7365 676d  ..        # segm
-0003b4a0: 656e 7420 636f 6c6f 7220 6173 2061 6e20  ent color as an 
-0003b4b0: 6170 7072 6f78 696d 6174 696f 6e2e 0d0a  approximation...
-0003b4c0: 2020 2020 2020 2020 6e75 6d45 6467 6573          numEdges
-0003b4d0: 203d 206c 656e 2865 6467 6563 6f6c 6f72   = len(edgecolor
-0003b4e0: 7329 0d0a 0d0a 2020 2020 2020 2020 6c61  s)....        la
-0003b4f0: 7374 436f 6c6f 7220 3d20 6564 6765 636f  stColor = edgeco
-0003b500: 6c6f 7273 5b6e 756d 4564 6765 732d 315d  lors[numEdges-1]
-0003b510: 0d0a 2020 2020 2020 2020 7643 6f6c 6f72  ..        vColor
-0003b520: 203d 2063 6f70 792e 636f 7079 2865 6467   = copy.copy(edg
-0003b530: 6563 6f6c 6f72 7329 0d0a 2020 2020 2020  ecolors)..      
-0003b540: 2020 7643 6f6c 6f72 203d 206e 702e 6170    vColor = np.ap
-0003b550: 7065 6e64 2876 436f 6c6f 722c 5b6c 6173  pend(vColor,[las
-0003b560: 7443 6f6c 6f72 5d2c 6178 6973 3d30 290d  tColor],axis=0).
-0003b570: 0a0d 0a20 2020 2020 2020 206c 6173 7456  ...        lastV
-0003b580: 616c 7565 203d 2065 6467 6576 616c 7565  alue = edgevalue
-0003b590: 735b 6e75 6d45 6467 6573 2d31 5d0d 0a20  s[numEdges-1].. 
-0003b5a0: 2020 2020 2020 2076 5661 6c75 6520 3d20         vValue = 
-0003b5b0: 636f 7079 2e63 6f70 7928 6564 6765 7661  copy.copy(edgeva
-0003b5c0: 6c75 6573 290d 0a20 2020 2020 2020 2076  lues)..        v
-0003b5d0: 5661 6c75 6520 3d20 6e70 2e61 7070 656e  Value = np.appen
-0003b5e0: 6428 7656 616c 7565 2c5b 6c61 7374 5661  d(vValue,[lastVa
-0003b5f0: 6c75 655d 2c61 7869 733d 3029 0d0a 2020  lue],axis=0)..  
-0003b600: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-0003b610: 7365 6c66 2e76 6572 7465 7843 6f6c 6f72  self.vertexColor
-0003b620: 203d 2076 436f 6c6f 720d 0a20 2020 2020   = vColor..     
-0003b630: 2020 2073 656c 662e 7665 7274 6578 5661     self.vertexVa
-0003b640: 6c75 6573 203d 2076 5661 6c75 650d 0a20  lues = vValue.. 
-0003b650: 2020 2020 2020 2073 656c 662e 5f62 6f75         self._bou
-0003b660: 6e64 735b 2776 6572 7476 6c69 6d27 5d20  nds['vertvlim'] 
-0003b670: 3d20 7642 6f75 6e64 730d 0a20 2020 2020  = vBounds..     
-0003b680: 2020 2072 6574 7572 6e0d 0a0d 0a20 2020     return....   
-0003b690: 2064 6566 205f 6d61 705f 636d 6170 5f66   def _map_cmap_f
-0003b6a0: 726f 6d5f 6461 7461 6772 6964 5f76 6572  rom_datagrid_ver
-0003b6b0: 7428 7365 6c66 2c67 2c20 6465 6c74 612c  t(self,g, delta,
-0003b6c0: 2064 6d69 6e2c 2063 6d61 7029 203a 0d0a   dmin, cmap) :..
-0003b6d0: 0d0a 2020 2020 2020 2020 782c 792c 7a20  ..        x,y,z 
-0003b6e0: 3d20 6e70 2e74 7261 6e73 706f 7365 2873  = np.transpose(s
-0003b6f0: 656c 662e 7665 7274 6578 436f 6f72 290d  elf.vertexCoor).
-0003b700: 0a0d 0a20 2020 2020 2020 2023 206e 6f72  ...        # nor
-0003b710: 6d61 6c69 7a65 2078 7920 706c 616e 6520  malize xy plane 
-0003b720: 2d31 2074 6f20 310d 0a20 2020 2020 2020  -1 to 1..       
-0003b730: 2078 203d 206e 702e 696e 7465 7270 2820   x = np.interp( 
-0003b740: 782c 2028 782e 6d69 6e28 292c 2078 2e6d  x, (x.min(), x.m
-0003b750: 6178 2829 292c 2028 2d31 2e30 2c20 312e  ax()), (-1.0, 1.
-0003b760: 3029 2029 0d0a 2020 2020 2020 2020 7920  0) )..        y 
-0003b770: 3d20 6e70 2e69 6e74 6572 7028 2079 2c20  = np.interp( y, 
-0003b780: 2879 2e6d 696e 2829 2c20 792e 6d61 7828  (y.min(), y.max(
-0003b790: 2929 2c20 282d 312e 302c 2031 2e30 2920  )), (-1.0, 1.0) 
-0003b7a0: 290d 0a0d 0a20 2020 2020 2020 2074 7269  )....        tri
-0003b7b0: 616c 203d 205b 2067 2820 785b 695d 2c79  al = [ g( x[i],y
-0003b7c0: 5b69 5d29 5b30 5d20 666f 7220 6920 696e  [i])[0] for i in
-0003b7d0: 2072 616e 6765 286c 656e 2878 2929 205d   range(len(x)) ]
-0003b7e0: 0d0a 0d0a 2020 2020 2020 2020 7620 3d20  ....        v = 
-0003b7f0: 6e70 2e61 7272 6179 2874 7269 616c 292a  np.array(trial)*
-0003b800: 6465 6c74 6120 2b20 646d 696e 0d0a 2020  delta + dmin..  
-0003b810: 2020 2020 2020 766d 696e 2c20 766d 6178        vmin, vmax
-0003b820: 203d 2076 2e6d 696e 2829 2c20 762e 6d61   = v.min(), v.ma
-0003b830: 7828 290d 0a20 2020 2020 2020 206e 6f72  x()..        nor
-0003b840: 6d20 3d20 636f 6c6f 7273 2e4e 6f72 6d61  m = colors.Norma
-0003b850: 6c69 7a65 2876 6d69 6e3d 762e 6d69 6e28  lize(vmin=v.min(
-0003b860: 292c 766d 6178 3d76 2e6d 6178 2829 290d  ),vmax=v.max()).
-0003b870: 0a0d 0a20 2020 2020 2020 2063 6f6c 6f72  ...        color
-0003b880: 203d 2063 6d61 7028 6e6f 726d 2876 2929   = cmap(norm(v))
-0003b890: 0d0a 2020 2020 2020 2020 7365 6c66 2e76  ..        self.v
-0003b8a0: 6572 7465 7843 6f6c 6f72 203d 2063 6f6c  ertexColor = col
-0003b8b0: 6f72 0d0a 2020 2020 2020 2020 7365 6c66  or..        self
-0003b8c0: 2e76 6572 7465 7856 616c 7565 7320 3d20  .vertexValues = 
-0003b8d0: 760d 0a20 2020 2020 2020 2073 656c 662e  v..        self.
-0003b8e0: 5f62 6f75 6e64 735b 2776 6572 7476 6c69  _bounds['vertvli
-0003b8f0: 6d27 5d20 3d20 5b20 766d 696e 2c20 766d  m'] = [ vmin, vm
-0003b900: 6178 205d 200d 0a20 2020 2020 2020 2072  ax ] ..        r
-0003b910: 6574 7572 6e20 0d0a 0d0a 2020 2020 6465  eturn ....    de
-0003b920: 6620 5f6d 6170 5f63 6d61 705f 6672 6f6d  f _map_cmap_from
-0003b930: 5f6f 705f 7665 7274 2873 656c 662c 206f  _op_vert(self, o
-0003b940: 7065 7261 7469 6f6e 2c20 636d 6170 2920  peration, cmap) 
-0003b950: 3a0d 0a20 2020 2020 2020 2078 797a 203d  :..        xyz =
-0003b960: 206e 702e 7472 616e 7370 6f73 6528 7365   np.transpose(se
-0003b970: 6c66 2e76 6572 7465 7843 6f6f 7229 0d0a  lf.vertexCoor)..
-0003b980: 2020 2020 2020 2020 7620 3d20 6e70 2e61          v = np.a
-0003b990: 7272 6179 286f 7065 7261 7469 6f6e 2878  rray(operation(x
-0003b9a0: 797a 2929 0d0a 2020 2020 2020 2020 766d  yz))..        vm
-0003b9b0: 696e 2c20 766d 6178 203d 2076 2e6d 696e  in, vmax = v.min
-0003b9c0: 2829 2c20 762e 6d61 7828 290d 0a20 2020  (), v.max()..   
-0003b9d0: 2020 2020 206e 6f72 6d20 3d20 636f 6c6f       norm = colo
-0003b9e0: 7273 2e4e 6f72 6d61 6c69 7a65 2876 6d69  rs.Normalize(vmi
-0003b9f0: 6e3d 762e 6d69 6e28 292c 766d 6178 3d76  n=v.min(),vmax=v
-0003ba00: 2e6d 6178 2829 290d 0a20 2020 2020 2020  .max())..       
-0003ba10: 200d 0a20 2020 2020 2020 2063 6f6c 6f72   ..        color
-0003ba20: 203d 2063 6d61 7028 6e6f 726d 2876 2929   = cmap(norm(v))
-0003ba30: 0d0a 2020 2020 2020 2020 7365 6c66 2e76  ..        self.v
-0003ba40: 6572 7465 7843 6f6c 6f72 203d 2063 6f6c  ertexColor = col
-0003ba50: 6f72 0d0a 2020 2020 2020 2020 7365 6c66  or..        self
-0003ba60: 2e76 6572 7465 7856 616c 7565 7320 3d20  .vertexValues = 
-0003ba70: 760d 0a20 2020 2020 2020 2073 656c 662e  v..        self.
-0003ba80: 5f62 6f75 6e64 735b 2776 6572 7476 6c69  _bounds['vertvli
-0003ba90: 6d27 5d20 3d20 5b20 766d 696e 2c20 766d  m'] = [ vmin, vm
-0003baa0: 6178 205d 200d 0a20 2020 2020 2020 2072  ax ] ..        r
-0003bab0: 6574 7572 6e20 0d0a 0d0a 2020 2020 6465  eturn ....    de
-0003bac0: 6620 5f6d 6170 5f63 6f6c 6f72 5f66 726f  f _map_color_fro
-0003bad0: 6d5f 6f70 5f76 6572 7428 7365 6c66 2c20  m_op_vert(self, 
-0003bae0: 6f70 6572 6174 696f 6e2c 2072 6762 2920  operation, rgb) 
-0003baf0: 3a0d 0a20 2020 2020 2020 2078 797a 203d  :..        xyz =
-0003bb00: 206e 702e 7472 616e 7370 6f73 6528 7365   np.transpose(se
-0003bb10: 6c66 2e76 6572 7465 7843 6f6f 7229 0d0a  lf.vertexCoor)..
-0003bb20: 2020 2020 2020 2020 636f 6c6f 7273 203d          colors =
-0003bb30: 206e 702e 6172 7261 7928 6f70 6572 6174   np.array(operat
-0003bb40: 696f 6e28 7879 7a29 290d 0a20 2020 2020  ion(xyz))..     
-0003bb50: 2020 2063 6f6c 6f72 7320 3d20 6e70 2e74     colors = np.t
-0003bb60: 7261 6e73 706f 7365 2863 6f6c 6f72 7329  ranspose(colors)
-0003bb70: 0d0a 2020 2020 2020 2020 636f 6c6f 7273  ..        colors
-0003bb80: 203d 206e 702e 636c 6970 2863 6f6c 6f72   = np.clip(color
-0003bb90: 732c 302c 3129 0d0a 2020 2020 2020 2020  s,0,1)..        
-0003bba0: 6966 2072 6762 203a 2052 4742 203d 2063  if rgb : RGB = c
-0003bbb0: 6f6c 6f72 730d 0a20 2020 2020 2020 2065  olors..        e
-0003bbc0: 6c73 6520 3a20 2020 5247 4220 3d20 636d  lse :   RGB = cm
-0003bbd0: 2e63 6f6c 6f72 732e 6873 765f 746f 5f72  .colors.hsv_to_r
-0003bbe0: 6762 2863 6f6c 6f72 7329 0d0a 2020 2020  gb(colors)..    
-0003bbf0: 2020 2020 6966 2052 4742 2e73 6861 7065      if RGB.shape
-0003bc00: 5b31 5d20 6973 2033 203a 0d0a 2020 2020  [1] is 3 :..    
-0003bc10: 2020 2020 2020 2020 6f6e 6573 203d 206e          ones = n
-0003bc20: 702e 6f6e 6573 2852 4742 2e73 6861 7065  p.ones(RGB.shape
-0003bc30: 5b30 5d29 5b3a 2c6e 702e 6e65 7761 7869  [0])[:,np.newaxi
-0003bc40: 735d 0d0a 2020 2020 2020 2020 2020 2020  s]..            
-0003bc50: 5247 4220 3d20 6e70 2e63 6f6e 6361 7465  RGB = np.concate
-0003bc60: 6e61 7465 2828 5247 422c 6f6e 6573 292c  nate((RGB,ones),
-0003bc70: 6178 6973 3d31 290d 0a20 2020 2020 2020  axis=1)..       
-0003bc80: 200d 0a20 2020 2020 2020 2073 656c 662e   ..        self.
-0003bc90: 7665 7274 6578 436f 6c6f 7220 3d20 5247  vertexColor = RG
-0003bca0: 420d 0a20 2020 2020 2020 2073 656c 662e  B..        self.
-0003bcb0: 7665 7274 6578 5661 6c75 6573 203d 204e  vertexValues = N
-0003bcc0: 6f6e 650d 0a20 2020 2020 2020 2073 656c  one..        sel
-0003bcd0: 662e 5f62 6f75 6e64 735b 2776 6572 7476  f._bounds['vertv
-0003bce0: 6c69 6d27 5d20 3d20 5b20 302e 302c 2031  lim'] = [ 0.0, 1
-0003bcf0: 2e30 205d 200d 0a20 2020 2020 2020 2072  .0 ] ..        r
-0003bd00: 6574 7572 6e0d 0a0d 0a20 2020 2023 202d  eturn....    # -
-0003bd10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0003bd20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0003bd30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0003bd40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0003bd50: 2d2d 2d2d 0d0a 0d0a 2020 2020 4070 726f  ----....    @pro
-0003bd60: 7065 7274 790d 0a20 2020 2064 6566 2076  perty..    def v
-0003bd70: 6c69 6d28 7365 6c66 2920 3a0d 0a20 2020  lim(self) :..   
-0003bd80: 2020 2020 2027 2727 5261 6e67 6520 6f66       '''Range of
-0003bd90: 2073 6361 6c61 7220 7661 6c75 6573 2077   scalar values w
-0003bda0: 6869 6368 206d 6179 2062 6520 6173 736f  hich may be asso
-0003bdb0: 6369 6174 6564 2077 6974 6820 636f 6c6f  ciated with colo
-0003bdc0: 7227 2727 0d0a 2020 2020 2020 2020 7265  r'''..        re
-0003bdd0: 7475 726e 2073 656c 662e 5f62 6f75 6e64  turn self._bound
-0003bde0: 735b 2776 6c69 6d27 5d0d 0a0d 0a20 2020  s['vlim']....   
-0003bdf0: 2040 766c 696d 2e73 6574 7465 720d 0a20   @vlim.setter.. 
-0003be00: 2020 2064 6566 2076 6c69 6d28 7365 6c66     def vlim(self
-0003be10: 2c76 616c 2920 3a0d 0a20 2020 2020 2020  ,val) :..       
-0003be20: 2073 656c 662e 5f62 6f75 6e64 735b 2776   self._bounds['v
-0003be30: 6c69 6d27 5d20 3d20 7661 6c0d 0a20 2020  lim'] = val..   
-0003be40: 2020 2020 2072 6574 7572 6e0d 0a0d 0a20       return.... 
-0003be50: 2020 2040 7072 6f70 6572 7479 0d0a 2020     @property..  
-0003be60: 2020 6465 6620 6e61 6d65 2873 656c 6629    def name(self)
-0003be70: 203a 0d0a 2020 2020 2020 2020 2727 2744   :..        '''D
-0003be80: 6573 6372 6970 7469 7665 2069 6465 6e74  escriptive ident
-0003be90: 6966 6965 7220 666f 7220 7468 6520 6c69  ifier for the li
-0003bea0: 6e65 2067 656f 6d65 7472 792e 2727 270d  ne geometry.'''.
-0003beb0: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-0003bec0: 2e5f 6765 6f6d 4e61 6d65 2069 7320 4e6f  ._geomName is No
-0003bed0: 6e65 203a 2072 6574 7572 6e20 2727 0d0a  ne : return ''..
-0003bee0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0003bef0: 656c 662e 5f67 656f 6d4e 616d 650d 0a0d  elf._geomName...
-0003bf00: 0a20 2020 2040 6e61 6d65 2e73 6574 7465  .    @name.sette
-0003bf10: 720d 0a20 2020 2064 6566 206e 616d 6528  r..    def name(
-0003bf20: 7365 6c66 2c20 7661 6c29 203a 0d0a 2020  self, val) :..  
-0003bf30: 2020 2020 2020 7365 6c66 2e5f 6765 6f6d        self._geom
-0003bf40: 4e61 6d65 203d 2076 616c 0d0a 2020 2020  Name = val..    
-0003bf50: 2020 2020 7365 6c66 2e73 6574 5f6c 6162      self.set_lab
-0003bf60: 656c 2820 2727 2069 6620 7661 6c20 6973  el( '' if val is
-0003bf70: 204e 6f6e 6520 656c 7365 2076 616c 290d   None else val).
-0003bf80: 0a20 2020 2020 2020 2072 6574 7572 6e0d  .        return.
-0003bf90: 0a0d 0a20 2020 2040 7072 6f70 6572 7479  ...    @property
-0003bfa0: 0d0a 2020 2020 6465 6620 636e 616d 6528  ..    def cname(
-0003bfb0: 7365 6c66 2920 3a0d 0a20 2020 2020 2020  self) :..       
-0003bfc0: 2027 2727 4465 7363 7269 7074 6976 6520   '''Descriptive 
-0003bfd0: 6964 656e 7469 6669 6572 2066 6f72 2076  identifier for v
-0003bfe0: 616c 7565 7320 696e 6469 6361 7465 6420  alues indicated 
-0003bff0: 6279 2063 6f6c 6f72 2e27 2727 0d0a 2020  by color.'''..  
-0003c000: 2020 2020 2020 6966 2073 656c 662e 7661        if self.va
-0003c010: 6c75 6573 4e61 6d65 2069 7320 4e6f 6e65  luesName is None
-0003c020: 203a 2072 6574 7572 6e20 2727 0d0a 2020   : return ''..  
-0003c030: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-0003c040: 662e 7661 6c75 6573 4e61 6d65 0d0a 0d0a  f.valuesName....
-0003c050: 2020 2020 4063 6e61 6d65 2e73 6574 7465      @cname.sette
-0003c060: 720d 0a20 2020 2064 6566 2063 6e61 6d65  r..    def cname
-0003c070: 2873 656c 662c 2076 616c 2920 3a0d 0a20  (self, val) :.. 
-0003c080: 2020 2020 2020 2073 656c 662e 7661 6c75         self.valu
-0003c090: 6573 4e61 6d65 203d 2076 616c 0d0a 2020  esName = val..  
-0003c0a0: 2020 2020 2020 7265 7475 726e 0d0a 0d0a        return....
-0003c0b0: 2020 2020 4070 726f 7065 7274 790d 0a20      @property.. 
-0003c0c0: 2020 2064 6566 2076 6572 7469 6365 7328     def vertices(
-0003c0d0: 7365 6c66 2920 3a0d 0a20 2020 2020 2020  self) :..       
-0003c0e0: 2022 2222 4120 3320 7820 4e20 6172 7261   """A 3 x N arra
-0003c0f0: 7920 6f66 206c 696e 6520 7665 7274 6963  y of line vertic
-0003c100: 6573 2e22 2222 0d0a 2020 2020 2020 2020  es."""..        
-0003c110: 7620 3d20 7365 6c66 2e76 6572 7465 7843  v = self.vertexC
-0003c120: 6f6f 720d 0a20 2020 2020 2020 206d 203d  oor..        m =
-0003c130: 206e 702e 7472 616e 7370 6f73 6528 7629   np.transpose(v)
-0003c140: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-0003c150: 206d 0d0a 0d0a 2020 2020 4070 726f 7065   m....    @prope
-0003c160: 7274 790d 0a20 2020 2064 6566 2073 6567  rty..    def seg
-0003c170: 6d65 6e74 6365 6e74 6572 7328 7365 6c66  mentcenters(self
-0003c180: 2920 3a0d 0a20 2020 2020 2020 2022 2222  ) :..        """
-0003c190: 4120 3320 7820 4e20 6172 7261 7920 6f66  A 3 x N array of
-0003c1a0: 206c 696e 6520 7365 676d 656e 7420 6365   line segment ce
-0003c1b0: 6e74 6572 732e 2222 2220 200d 0a20 2020  nters."""  ..   
-0003c1c0: 2020 2020 2073 6567 6d65 6e74 7320 3d20       segments = 
-0003c1d0: 7365 6c66 2e5f 7365 676d 656e 7473 3364  self._segments3d
-0003c1e0: 0d0a 2020 2020 2020 2020 746f 7453 6567  ..        totSeg
-0003c1f0: 7320 3d20 5b5d 0d0a 2020 2020 2020 2020  s = []..        
-0003c200: 666f 7220 6c69 6e65 2069 6e20 7365 676d  for line in segm
-0003c210: 656e 7473 203a 0d0a 2020 2020 2020 2020  ents :..        
-0003c220: 2020 2020 6e70 6c69 6e65 203d 206e 702e      npline = np.
-0003c230: 6172 7261 7928 6c69 6e65 290d 0a20 2020  array(line)..   
-0003c240: 2020 2020 2020 2020 2066 6f72 2073 6567           for seg
-0003c250: 4978 2069 6e20 7261 6e67 6528 6e70 6c69  Ix in range(npli
-0003c260: 6e65 2e73 6861 7065 5b30 5d2d 3129 203a  ne.shape[0]-1) :
-0003c270: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0003c280: 2020 6365 6e74 6572 203d 206e 702e 6164    center = np.ad
-0003c290: 6428 6e70 6c69 6e65 5b73 6567 4978 5d2c  d(npline[segIx],
-0003c2a0: 6e70 6c69 6e65 5b73 6567 4978 2b31 5d29  npline[segIx+1])
-0003c2b0: 2f32 0d0a 2020 2020 2020 2020 2020 2020  /2..            
-0003c2c0: 2020 2020 746f 7453 6567 732e 6170 7065      totSegs.appe
-0003c2d0: 6e64 2863 656e 7465 7229 0d0a 2020 2020  nd(center)..    
-0003c2e0: 2020 2020 6d20 3d20 6e70 2e74 7261 6e73      m = np.trans
-0003c2f0: 706f 7365 286e 702e 6172 7261 7928 746f  pose(np.array(to
-0003c300: 7453 6567 7329 290d 0a20 2020 2020 2020  tSegs))..       
-0003c310: 2072 6574 7572 6e20 6d0d 0a0d 0a20 2020   return m....   
-0003c320: 2040 7072 6f70 6572 7479 0d0a 2020 2020   @property..    
-0003c330: 6465 6620 7365 676d 656e 7464 6972 6563  def segmentdirec
-0003c340: 7469 6f6e 7328 7365 6c66 2920 3a0d 0a20  tions(self) :.. 
-0003c350: 2020 2020 2020 2022 2222 4120 4e20 7820         """A N x 
-0003c360: 3320 6172 7261 7920 6f66 206c 696e 6520  3 array of line 
-0003c370: 7365 676d 656e 7420 6469 7265 6374 696f  segment directio
-0003c380: 6e20 7665 6374 6f72 732e 2222 2220 0d0a  n vectors.""" ..
-0003c390: 2020 2020 2020 2020 2320 2d2d 2d2d 2d2d          # ------
-0003c3a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0003c3b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0003c3c0: 2d2d 2d0d 0a20 2020 2020 2020 2073 6567  ---..        seg
-0003c3d0: 6d65 6e74 7320 3d20 7365 6c66 2e5f 7365  ments = self._se
-0003c3e0: 676d 656e 7473 3364 0d0a 2020 2020 2020  gments3d..      
-0003c3f0: 2020 6966 206e 6f74 2073 656c 662e 6973    if not self.is
-0003c400: 5368 7265 6464 6564 203a 0d0a 2020 2020  Shredded :..    
-0003c410: 2020 2020 2020 2020 7365 676d 656e 7473          segments
-0003c420: 203d 2073 656c 662e 5f73 6872 6564 2829   = self._shred()
-0003c430: 0d0a 2020 2020 2020 2020 2320 2d2d 2d2d  ..        # ----
-0003c440: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0003c450: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0003c460: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2076  -----..        v
-0003c470: 6654 203d 206e 702e 7472 616e 7370 6f73  fT = np.transpos
-0003c480: 6528 7365 676d 656e 7473 2c20 2831 2c30  e(segments, (1,0
-0003c490: 2c32 2920 290d 0a20 2020 2020 2020 2064  ,2) )..        d
-0003c4a0: 6972 6563 7469 6f6e 203d 2076 6654 5b31  irection = vfT[1
-0003c4b0: 5d20 2d20 7666 545b 305d 0d0a 2020 2020  ] - vfT[0]..    
-0003c4c0: 2020 2020 7265 7475 726e 2064 6972 6563      return direc
-0003c4d0: 7469 6f6e 0d0a 0d0a 2020 2020 4070 726f  tion....    @pro
-0003c4e0: 7065 7274 790d 0a20 2020 2064 6566 2073  perty..    def s
-0003c4f0: 6567 6d65 6e74 636f 6c6f 7273 2873 656c  egmentcolors(sel
-0003c500: 6629 203a 0d0a 2020 2020 2020 2020 2222  f) :..        ""
-0003c510: 2241 204e 2078 2034 2061 7272 6179 206f  "A N x 4 array o
-0003c520: 6620 7365 676d 656e 7420 636f 6c6f 7273  f segment colors
-0003c530: 2e22 2222 0d0a 2020 2020 2020 2020 7265  ."""..        re
-0003c540: 7475 726e 2073 656c 662e 5f65 6467 6563  turn self._edgec
-0003c550: 6f6c 6f72 730d 0a0d 0a20 2020 2040 7072  olors....    @pr
-0003c560: 6f70 6572 7479 0d0a 2020 2020 6465 6620  operty..    def 
-0003c570: 626f 756e 6473 2873 656c 6629 203a 0d0a  bounds(self) :..
-0003c580: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
-0003c590: 2020 2020 2044 6963 7469 6f6e 6172 7920       Dictionary 
-0003c5a0: 6f66 206c 696e 6520 6765 6f6d 6574 7269  of line geometri
-0003c5b0: 6320 616e 6420 7661 6c75 6520 7261 6e67  c and value rang
-0003c5c0: 6573 2e0d 0a20 2020 2020 2020 200d 0a20  es...        .. 
-0003c5d0: 2020 2020 2020 2045 6163 6820 6469 6374         Each dict
-0003c5e0: 696f 6e61 7279 2076 616c 7565 2069 7320  ionary value is 
-0003c5f0: 6120 3220 666c 6f61 7420 6172 7261 7920  a 2 float array 
-0003c600: 6f66 206d 696e 696d 756d 0d0a 2020 2020  of minimum..    
-0003c610: 2020 2020 616e 6420 6d61 7869 6d75 6d20      and maximum 
-0003c620: 7661 6c75 6573 206f 6620 7468 6520 6c69  values of the li
-0003c630: 6e65 2e20 204b 6579 7320 6172 653a 0d0a  ne.  Keys are:..
-0003c640: 0d0a 2020 2020 2020 2020 2778 6c69 6d27  ..        'xlim'
-0003c650: 203a 2078 2d63 6f6f 7264 696e 6174 650d   : x-coordinate.
-0003c660: 0a0d 0a20 2020 2020 2020 2027 796c 696d  ...        'ylim
-0003c670: 2720 3a20 792d 636f 6f72 6469 6e61 7465  ' : y-coordinate
-0003c680: 0d0a 0d0a 2020 2020 2020 2020 277a 6c69  ....        'zli
-0003c690: 6d27 203a 207a 2d63 6f6f 7264 696e 6174  m' : z-coordinat
-0003c6a0: 650d 0a0d 0a20 2020 2020 2020 2027 725f  e....        'r_
-0003c6b0: 7879 2720 3a20 7261 6469 616c 2064 6973  xy' : radial dis
-0003c6c0: 7461 6e63 6520 6672 6f6d 2074 6865 207a  tance from the z
-0003c6d0: 2061 7869 730d 0a0d 0a20 2020 2020 2020   axis....       
-0003c6e0: 2027 726f 7267 2720 3a20 7261 6469 616c   'rorg' : radial
-0003c6f0: 2064 6973 7461 6e63 6520 6672 6f6d 2074   distance from t
-0003c700: 6865 206f 7269 6769 6e0d 0a0d 0a20 2020  he origin....   
-0003c710: 2020 2020 2027 766c 696d 2720 3a20 7661       'vlim' : va
-0003c720: 6c75 6520 6675 6e63 7469 6f6e 616c 2061  lue functional a
-0003c730: 7373 6967 6e6d 656e 7473 2e0d 0a20 2020  ssignments...   
-0003c740: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-0003c750: 2020 2056 616c 7565 7320 6172 6520 6173     Values are as
-0003c760: 7369 676e 6564 2066 726f 6d20 7468 6520  signed from the 
-0003c770: 6765 6f6d 6574 7279 2061 6e64 2063 6f6c  geometry and col
-0003c780: 6f72 206d 6170 7069 6e67 206d 6574 686f  or mapping metho
-0003c790: 6473 2c0d 0a20 2020 2020 2020 2069 6e63  ds,..        inc
-0003c7a0: 6c75 6469 6e67 2063 6c6c 6970 7069 6e67  luding cllipping
-0003c7b0: 2e0d 0a0d 0a20 2020 2020 2020 2022 2222  .....        """
-0003c7c0: 0d0a 0d0a 2020 2020 2020 2020 7265 7475  ....        retu
-0003c7d0: 726e 2073 656c 662e 5f62 6f75 6e64 730d  rn self._bounds.
-0003c7e0: 0a20 2020 200d 0a20 2020 2040 7072 6f70  .    ..    @prop
-0003c7f0: 6572 7479 0d0a 2020 2020 6465 6620 6342  erty..    def cB
-0003c800: 6172 5f53 6361 6c61 724d 6170 7061 626c  ar_ScalarMappabl
-0003c810: 6528 7365 6c66 2920 3a0d 0a20 2020 2020  e(self) :..     
-0003c820: 2020 2022 2222 6d61 7470 6c6f 746c 6962     """matplotlib
-0003c830: 2e63 6d2e 5363 616c 6172 4d61 7070 6162  .cm.ScalarMappab
-0003c840: 6c65 206f 626a 6563 7420 666f 7220 6c69  le object for li
-0003c850: 6e65 2076 616c 7565 732e 2022 2222 0d0a  ne values. """..
-0003c860: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-0003c870: 2073 656c 662e 7374 6342 6172 5f53 6361   self.stcBar_Sca
-0003c880: 6c61 724d 6170 7061 626c 6528 290d 0a0d  larMappable()...
-0003c890: 0a20 2020 2064 6566 2073 7463 4261 725f  .    def stcBar_
-0003c8a0: 5363 616c 6172 4d61 7070 6162 6c65 2873  ScalarMappable(s
-0003c8b0: 656c 662c 2073 7472 6970 653d 4e6f 6e65  elf, stripe=None
-0003c8c0: 2c20 6267 636f 6c6f 723d 276b 2729 203a  , bgcolor='k') :
-0003c8d0: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
-0003c8e0: 2020 2020 2020 2053 6361 6c61 724d 6170         ScalarMap
-0003c8f0: 7061 626c 6520 6f62 6a65 6374 2077 6974  pable object wit
-0003c900: 6820 7374 7269 7065 6420 636f 6c6f 7220  h striped color 
-0003c910: 7661 6c75 6573 2e0d 0a20 2020 2020 2020  values...       
-0003c920: 2050 7269 6d61 7269 6c79 2075 7365 6675   Primarily usefu
-0003c930: 6c20 666f 7220 6469 7370 6c61 7920 6f66  l for display of
-0003c940: 2063 6f6e 746f 7572 2063 6f6c 6f72 6261   contour colorba
-0003c950: 7273 2e20 0d0a 2020 2020 2020 2020 0d0a  rs. ..        ..
-0003c960: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
-0003c970: 7273 0d0a 2020 2020 2020 2020 2d2d 2d2d  rs..        ----
-0003c980: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
-0003c990: 7374 7269 7065 203a 2069 6e74 6567 6572  stripe : integer
-0003c9a0: 2c20 6f70 7469 6f6e 616c 2c20 6465 6661  , optional, defa
-0003c9b0: 756c 743a 204e 6f6e 650d 0a20 2020 2020  ult: None..     
-0003c9c0: 2020 2020 2020 204e 756d 6265 7220 6f66         Number of
-0003c9d0: 2063 6f6c 6f72 2073 7472 6970 6573 2e20   color stripes. 
-0003c9e0: 2049 6620 4e6f 6e65 2c20 6e6f 0d0a 2020   If None, no..  
-0003c9f0: 2020 2020 2020 2020 2020 7374 7269 7065            stripe
-0003ca00: 7320 6172 6520 666f 726d 6564 2e0d 0a20  s are formed... 
-0003ca10: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-0003ca20: 2062 6763 6f6c 6f72 203a 2063 6f6c 6f72   bgcolor : color
-0003ca30: 2c20 6f70 7469 6f6e 616c 2c20 6465 6661  , optional, defa
-0003ca40: 756c 743a 2027 626c 6163 6b27 0d0a 2020  ult: 'black'..  
-0003ca50: 2020 2020 2020 2020 2020 436f 6c6f 7220            Color 
-0003ca60: 6265 7477 6565 6e20 7468 6520 7374 7269  between the stri
-0003ca70: 7065 732e 0d0a 2020 2020 2020 2020 0d0a  pes...        ..
-0003ca80: 2020 2020 2020 2020 5265 7475 726e 730d          Returns.
-0003ca90: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0003caa0: 0d0a 2020 2020 2020 2020 7365 6c66 203a  ..        self :
-0003cab0: 204d 6174 706c 6f74 6c69 622e 636d 2e53   Matplotlib.cm.S
-0003cac0: 6361 6c61 724d 6170 7061 626c 6520 6f62  calarMappable ob
-0003cad0: 6a65 6374 0d0a 2020 2020 2020 2020 0d0a  ject..        ..
-0003cae0: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
-0003caf0: 2020 2020 2023 202e 2e2e 2e2e 2e2e 2e2e       # .........
-0003cb00: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0003cb10: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 0d0a  ................
-0003cb20: 2020 2020 2020 2020 6465 6620 7374 7269          def stri
-0003cb30: 7065 436d 6170 2820 636d 6170 2c20 6e75  peCmap( cmap, nu
-0003cb40: 6d62 2c20 6261 636b 6772 6f75 6e64 3d27  mb, background='
-0003cb50: 6b27 2c20 636e 616d 653d 4e6f 6e65 2920  k', cname=None) 
-0003cb60: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
-0003cb70: 6620 6973 696e 7374 616e 6365 2863 6d61  f isinstance(cma
-0003cb80: 702c 7374 7229 203a 200d 0a20 2020 2020  p,str) : ..     
-0003cb90: 2020 2020 2020 2020 2020 2063 6d61 7020             cmap 
-0003cba0: 3d20 636d 2e67 6574 5f63 6d61 7028 636d  = cm.get_cmap(cm
-0003cbb0: 6170 290d 0a20 2020 2020 2020 2020 2020  ap)..           
-0003cbc0: 206e 756d 6253 6567 7320 3d20 3235 360d   numbSegs = 256.
-0003cbd0: 0a20 2020 2020 2020 2020 2020 206d 6178  .            max
-0003cbe0: 496e 6478 203d 206e 756d 6253 6567 732d  Indx = numbSegs-
-0003cbf0: 310d 0a20 2020 2020 2020 2020 2020 2062  1..            b
-0003cc00: 6772 6e64 203d 2063 6d2e 636f 6c6f 7273  grnd = cm.colors
-0003cc10: 2e74 6f5f 7267 6261 5f61 7272 6179 2862  .to_rgba_array(b
-0003cc20: 6163 6b67 726f 756e 6429 0d0a 2020 2020  ackground)..    
-0003cc30: 2020 2020 2020 2020 634c 6973 7420 3d20          cList = 
-0003cc40: 6e70 2e74 696c 6528 2062 6772 6e64 2c20  np.tile( bgrnd, 
-0003cc50: 286e 756d 6253 6567 732c 3129 290d 0a20  (numbSegs,1)).. 
-0003cc60: 2020 2020 2020 2020 2020 2066 496e 6465             fInde
-0003cc70: 7820 3d20 6e70 2e6c 696e 7370 6163 6528  x = np.linspace(
-0003cc80: 302e 302c 312e 302c 6e75 6d62 290d 0a20  0.0,1.0,numb).. 
-0003cc90: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
-0003cca0: 2069 6e20 6649 6e64 6578 203a 0d0a 2020   in fIndex :..  
-0003ccb0: 2020 2020 2020 2020 2020 2020 2020 696e                in
-0003ccc0: 6465 7820 3d20 696e 7428 692a 286d 6178  dex = int(i*(max
-0003ccd0: 496e 6478 2929 0d0a 2020 2020 2020 2020  Indx))..        
-0003cce0: 2020 2020 2020 2020 634c 6973 745b 696e          cList[in
-0003ccf0: 6465 785d 203d 2063 6d61 7028 6929 0d0a  dex] = cmap(i)..
-0003cd00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003cd10: 6966 2069 6e64 6578 203c 206d 6178 496e  if index < maxIn
-0003cd20: 6478 203a 2063 4c69 7374 5b69 6e64 6578  dx : cList[index
-0003cd30: 2b31 5d20 3d20 636d 6170 2869 290d 0a20  +1] = cmap(i).. 
-0003cd40: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0003cd50: 6c73 6520 3a20 634c 6973 745b 696e 6465  lse : cList[inde
-0003cd60: 782d 325d 203d 2063 6d61 7028 6929 0d0a  x-2] = cmap(i)..
-0003cd70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003cd80: 6966 2069 6e64 6578 203e 2030 203a 2063  if index > 0 : c
-0003cd90: 4c69 7374 5b69 6e64 6578 2d31 5d20 3d20  List[index-1] = 
-0003cda0: 636d 6170 2869 290d 0a20 2020 2020 2020  cmap(i)..       
-0003cdb0: 2020 2020 2020 2020 2065 6c73 6520 3a20           else : 
-0003cdc0: 634c 6973 745b 696e 6465 782b 325d 203d  cList[index+2] =
-0003cdd0: 2063 6d61 7028 6929 0d0a 2020 2020 2020   cmap(i)..      
-0003cde0: 2020 2020 2020 7265 7475 726e 2063 6f6c        return col
-0003cdf0: 6f72 732e 4c69 7374 6564 436f 6c6f 726d  ors.ListedColorm
-0003ce00: 6170 2863 4c69 7374 290d 0a20 2020 2020  ap(cList)..     
-0003ce10: 2020 2023 202e 2e2e 2e2e 2e2e 2e2e 2e2e     # ...........
-0003ce20: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0003ce30: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 0d0a 2020  ..............  
-0003ce40: 2020 2020 2020 766d 696e 2c20 766d 6178        vmin, vmax
-0003ce50: 203d 2073 656c 662e 5f62 6f75 6e64 735b   = self._bounds[
-0003ce60: 2776 6c69 6d27 5d0d 0a20 2020 2020 2020  'vlim']..       
-0003ce70: 206e 6f72 6d20 3d20 636f 6c6f 7273 2e4e   norm = colors.N
-0003ce80: 6f72 6d61 6c69 7a65 2876 6d69 6e3d 766d  ormalize(vmin=vm
-0003ce90: 696e 2c76 6d61 783d 766d 6178 290d 0a20  in,vmax=vmax).. 
-0003cea0: 2020 2020 2020 206f 626a 4d61 7020 3d20         objMap = 
-0003ceb0: 7365 6c66 2e67 6574 5f63 6d61 7028 290d  self.get_cmap().
-0003cec0: 0a20 2020 2020 2020 2069 6620 7374 7269  .        if stri
-0003ced0: 7065 2069 7320 6e6f 7420 4e6f 6e65 3a0d  pe is not None:.
-0003cee0: 0a20 2020 2020 2020 2020 2020 206f 626a  .            obj
-0003cef0: 4d61 7020 3d20 7374 7269 7065 436d 6170  Map = stripeCmap
-0003cf00: 2820 6f62 6a4d 6170 2c20 7374 7269 7065  ( objMap, stripe
-0003cf10: 2c20 6267 636f 6c6f 7229 200d 0a20 2020  , bgcolor) ..   
-0003cf20: 2020 2020 2073 6d20 3d20 636d 2e53 6361       sm = cm.Sca
-0003cf30: 6c61 724d 6170 7061 626c 6528 636d 6170  larMappable(cmap
-0003cf40: 3d6f 626a 4d61 702c 206e 6f72 6d3d 6e6f  =objMap, norm=no
-0003cf50: 726d 290d 0a20 2020 2020 2020 2073 6d2e  rm)..        sm.
-0003cf60: 7365 745f 6172 7261 7928 5b5d 290d 0a20  set_array([]).. 
-0003cf70: 2020 2020 2020 2072 6574 7572 6e20 736d         return sm
-0003cf80: 2020 2020 2020 2020 0d0a 0d0a 2020 2020          ....    
-0003cf90: 6465 6620 7368 7265 6428 7365 6c66 2c20  def shred(self, 
-0003cfa0: 7265 7a3d 3029 203a 0d0a 2020 2020 2020  rez=0) :..      
-0003cfb0: 2020 2222 220d 0a20 2020 2020 2020 2052    """..        R
-0003cfc0: 6563 7572 7369 7665 6c79 2068 616c 7665  ecursively halve
-0003cfd0: 2065 6163 6820 6c69 6e65 2073 6567 6d65   each line segme
-0003cfe0: 6e74 2069 6e74 6f20 7365 7061 7261 7465  nt into separate
-0003cff0: 206c 696e 6573 2e0d 0a20 2020 2020 2020   lines...       
-0003d000: 200d 0a20 2020 2020 2020 2050 6172 616d   ..        Param
-0003d010: 6574 6572 730d 0a20 2020 2020 2020 202d  eters..        -
-0003d020: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
-0003d030: 2020 2072 657a 203a 2069 6e74 6567 6572     rez : integer
-0003d040: 2c20 6f70 7469 6f6e 616c 2c20 6465 6661  , optional, defa
-0003d050: 756c 743a 2030 0d0a 2020 2020 2020 2020  ult: 0..        
-0003d060: 2020 2020 4e75 6d62 6572 206f 6620 7265      Number of re
-0003d070: 6375 7273 6976 6520 7375 6264 6976 6973  cursive subdivis
-0003d080: 696f 6e73 206f 6620 6120 6c69 6e65 2073  ions of a line s
-0003d090: 6567 6d65 6e74 2e0d 0a20 2020 2020 2020  egment...       
-0003d0a0: 2020 2020 2056 616c 7565 7320 7261 6e67       Values rang
-0003d0b0: 6520 6672 6f6d 2030 2074 6f20 372e 0d0a  e from 0 to 7...
-0003d0c0: 0d0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
-0003d0d0: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
-0003d0e0: 2d2d 0d0a 2020 2020 2020 2020 7365 6c66  --..        self
-0003d0f0: 203a 206c 696e 6520 6f62 6a65 6374 0d0a   : line object..
-0003d100: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-0003d110: 2020 2222 220d 0a20 2020 2020 2020 2023    """..        #
-0003d120: 202e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e   ...............
-0003d130: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0003d140: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0003d150: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 0d0a  ................
-0003d160: 2020 2020 2020 2020 6465 6620 6d69 6453          def midS
-0003d170: 6567 6d65 6e74 5665 7274 6963 6573 286e  egmentVertices(n
-0003d180: 756d 4469 762c 7461 696c 436f 6f72 2c20  umDiv,tailCoor, 
-0003d190: 6865 6164 436f 6f72 2920 3a0d 0a20 2020  headCoor) :..   
-0003d1a0: 2020 2020 2020 2020 2023 2072 6574 7572           # retur
-0003d1b0: 6e20 6164 6465 6420 7375 6264 6976 6973  n added subdivis
-0003d1c0: 696f 6e20 7665 7274 6963 6573 2c20 696e  ion vertices, in
-0003d1d0: 206f 7264 6572 2066 726f 6d0d 0a20 2020   order from..   
-0003d1e0: 2020 2020 2020 2020 2023 2074 6169 6c20           # tail 
-0003d1f0: 746f 2068 6561 642e 0d0a 2020 2020 2020  to head...      
-0003d200: 2020 2020 2020 6d69 6e4c 656e 203d 2031        minLen = 1
-0003d210: 2e30 2f6e 756d 4469 760d 0a20 2020 2020  .0/numDiv..     
-0003d220: 2020 2020 2020 2064 6976 4172 7220 3d20         divArr = 
-0003d230: 6e70 2e6c 696e 7370 6163 6528 6d69 6e4c  np.linspace(minL
-0003d240: 656e 2c31 2e30 2d6d 696e 4c65 6e2c 206e  en,1.0-minLen, n
-0003d250: 756d 4469 762d 3129 0d0a 2020 2020 2020  umDiv-1)..      
-0003d260: 2020 2020 2020 6465 6c74 6120 3d20 6e70        delta = np
-0003d270: 2e61 7272 6179 2868 6561 6443 6f6f 7229  .array(headCoor)
-0003d280: 202d 206e 702e 6172 7261 7928 7461 696c   - np.array(tail
-0003d290: 436f 6f72 290d 0a20 2020 2020 2020 2020  Coor)..         
-0003d2a0: 2020 2076 5365 7420 3d20 5b20 7461 696c     vSet = [ tail
-0003d2b0: 436f 6f72 202b 206e 702e 6d75 6c74 6970  Coor + np.multip
-0003d2c0: 6c79 2864 656c 7461 2c6d 756c 7429 2066  ly(delta,mult) f
-0003d2d0: 6f72 206d 756c 7420 696e 2064 6976 4172  or mult in divAr
-0003d2e0: 7220 205d 0d0a 2020 2020 2020 2020 2020  r  ]..          
-0003d2f0: 2020 7653 6574 203d 206e 702e 6172 7261    vSet = np.arra
-0003d300: 7928 7653 6574 290d 0a20 2020 2020 2020  y(vSet)..       
-0003d310: 2020 2020 2072 6574 7572 6e20 7653 6574       return vSet
-0003d320: 0d0a 2020 2020 2020 2020 2320 2e2e 2e2e  ..        # ....
-0003d330: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0003d340: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0003d350: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0003d360: 2e2e 2e2e 2e2e 2e2e 2e0d 0a20 2020 2020  ...........     
-0003d370: 2020 200d 0a20 2020 2020 2020 2069 6620     ..        if 
-0003d380: 6e6f 7420 6973 696e 7374 616e 6365 2872  not isinstance(r
-0003d390: 657a 2c20 696e 7429 203a 0d0a 2020 2020  ez, int) :..    
-0003d3a0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-0003d3b0: 6c75 6545 7272 6f72 2827 496e 636f 7272  lueError('Incorr
-0003d3c0: 6563 7420 7265 7a20 7479 7065 2c20 6d75  ect rez type, mu
-0003d3d0: 7374 2062 6120 6f66 2074 7970 6520 696e  st ba of type in
-0003d3e0: 7427 290d 0a20 2020 2020 2020 2069 6620  t')..        if 
-0003d3f0: 2872 657a 3c30 2920 6f72 2028 7265 7a3e  (rez<0) or (rez>
-0003d400: 5f4d 4158 5245 5a29 203a 0d0a 2020 2020  _MAXREZ) :..    
-0003d410: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-0003d420: 6c75 6545 7272 6f72 2827 496e 636f 7272  lueError('Incorr
-0003d430: 6573 7420 7265 7a20 6f66 207b 7d2c 206d  est rez of {}, m
-0003d440: 7573 7420 6265 2061 6e20 696e 742c 2030  ust be an int, 0
-0003d450: 203c 3d20 7265 7a20 3c3d 207b 7d27 2e66   <= rez <= {}'.f
-0003d460: 6f72 6d61 7428 7265 7a2c 5f4d 4158 5245  ormat(rez,_MAXRE
-0003d470: 5a29 290d 0a0d 0a20 2020 2020 2020 206e  Z))....        n
-0003d480: 756d 4469 7620 3d20 696e 7428 322a 2a72  umDiv = int(2**r
-0003d490: 657a 290d 0a20 2020 2020 2020 2023 2046  ez)..        # F
-0003d4a0: 7574 4465 763a 2066 6f6c 6c6f 7769 6e67  utDev: following
-0003d4b0: 2073 6565 6d73 2074 6f20 776f 726b 2069   seems to work i
-0003d4c0: 6e20 6361 7365 7320 6368 6563 6b65 6420  n cases checked 
-0003d4d0: 6275 7420 7374 696c 6c20 6e6f 7420 3130  but still not 10
-0003d4e0: 3025 2063 6f6e 6669 6465 6e74 2e0d 0a20  0% confident... 
-0003d4f0: 2020 2020 2020 2069 6620 6e6f 7420 7365         if not se
-0003d500: 6c66 2e69 7353 6872 6564 6465 6420 3a0d  lf.isShredded :.
-0003d510: 0a20 2020 2020 2020 2020 2020 2063 6f6c  .            col
-0003d520: 6f72 7320 3d20 7365 6c66 2e5f 7368 7265  ors = self._shre
-0003d530: 645f 636f 6c6f 7228 290d 0a20 2020 2020  d_color()..     
-0003d540: 2020 2020 2020 2073 656c 662e 5f73 6872         self._shr
-0003d550: 6564 2829 0d0a 2020 2020 2020 2020 2020  ed()..          
-0003d560: 2020 7365 6c66 2e5f 6564 6765 636f 6c6f    self._edgecolo
-0003d570: 7273 203d 2063 6f6c 6f72 730d 0a20 2020  rs = colors..   
-0003d580: 2020 2020 2020 2020 2023 2044 4556 4e4f           # DEVNO
-0003d590: 5445 3a20 636f 6c6f 7273 206e 6f77 2072  TE: colors now r
-0003d5a0: 6566 6572 2074 6f20 7365 676d 656e 7420  efer to segment 
-0003d5b0: 636f 6c6f 7273 2c20 6e6f 7420 6c69 6e65  colors, not line
-0003d5c0: 2063 6f6c 6f72 732e 0d0a 2020 2020 2020   colors...      
-0003d5d0: 2020 6966 2072 657a 3d3d 303a 2072 6574    if rez==0: ret
-0003d5e0: 7572 6e20 7365 6c66 0d0a 2020 2020 2020  urn self..      
-0003d5f0: 2020 656c 7365 203a 0d0a 2020 2020 2020    else :..      
-0003d600: 2020 2020 2063 6f6c 6f72 7320 3d20 7365       colors = se
-0003d610: 6c66 2e5f 7368 7265 645f 7365 676d 5f63  lf._shred_segm_c
-0003d620: 6f6c 6f72 286e 756d 4469 7629 200d 0a0d  olor(numDiv) ...
-0003d630: 0a20 2020 2020 2020 206e 756d 5365 6720  .        numSeg 
-0003d640: 3d20 300d 0a20 2020 2020 2020 2066 6f72  = 0..        for
-0003d650: 206c 696e 6520 696e 2073 656c 662e 6c69   line in self.li
-0003d660: 6e65 496e 6469 6365 7320 3a20 6e75 6d53  neIndices : numS
-0003d670: 6567 202b 3d20 6c65 6e28 6c69 6e65 292d  eg += len(line)-
-0003d680: 310d 0a20 2020 2020 2020 200d 0a20 2020  1..        ..   
-0003d690: 2020 2020 206e 6577 5f76 6572 7465 7843       new_vertexC
-0003d6a0: 6f6f 7220 3d20 6e70 2e63 6f70 7928 7365  oor = np.copy(se
-0003d6b0: 6c66 2e76 6572 7465 7843 6f6f 7229 0d0a  lf.vertexCoor)..
-0003d6c0: 2020 2020 2020 2020 6e65 775f 6c69 6e65          new_line
-0003d6d0: 496e 6469 6365 7320 3d20 5b5d 0d0a 2020  Indices = []..  
-0003d6e0: 2020 2020 2020 6e65 775f 7374 6172 745f        new_start_
-0003d6f0: 7665 7274 5f69 6e64 6578 203d 206c 656e  vert_index = len
-0003d700: 2873 656c 662e 7665 7274 6578 436f 6f72  (self.vertexCoor
-0003d710: 290d 0a20 2020 2020 2020 2066 6f72 206c  )..        for l
-0003d720: 696e 6520 696e 2073 656c 662e 6c69 6e65  ine in self.line
-0003d730: 496e 6469 6365 7320 3a0d 0a20 2020 2020  Indices :..     
-0003d740: 2020 2020 2020 2073 696e 676c 655f 6c69         single_li
-0003d750: 6e65 496e 6465 7820 3d20 5b5d 0d0a 2020  neIndex = []..  
-0003d760: 2020 2020 2020 2020 2020 6e75 6d4c 696e            numLin
-0003d770: 6553 6567 7320 3d20 6c65 6e28 6c69 6e65  eSegs = len(line
-0003d780: 292d 310d 0a20 2020 2020 2020 2020 2020  )-1..           
-0003d790: 206c 6173 744c 696e 6556 6572 7449 6e64   lastLineVertInd
-0003d7a0: 6578 203d 206e 756d 4c69 6e65 5365 6773  ex = numLineSegs
-0003d7b0: 0d0a 2020 2020 2020 2020 2020 2020 666f  ..            fo
-0003d7c0: 7220 6920 696e 2072 616e 6765 286e 756d  r i in range(num
-0003d7d0: 4c69 6e65 5365 6773 2029 203a 0d0a 2020  LineSegs ) :..  
-0003d7e0: 2020 2020 2020 2020 2020 2020 2020 7461                ta
-0003d7f0: 696c 5f76 6572 7420 3d20 7365 6c66 2e76  il_vert = self.v
-0003d800: 6572 7465 7843 6f6f 725b 206c 696e 655b  ertexCoor[ line[
-0003d810: 695d 205d 2020 200d 0a20 2020 2020 2020  i] ]   ..       
-0003d820: 2020 2020 2020 2020 2068 6561 645f 7665           head_ve
-0003d830: 7274 203d 2073 656c 662e 7665 7274 6578  rt = self.vertex
-0003d840: 436f 6f72 5b20 6c69 6e65 5b69 2b31 5d20  Coor[ line[i+1] 
-0003d850: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
-0003d860: 2020 2073 696e 676c 655f 6c69 6e65 496e     single_lineIn
-0003d870: 6465 782e 6170 7065 6e64 2820 6c69 6e65  dex.append( line
-0003d880: 5b69 5d20 290d 0a20 2020 2020 2020 2020  [i] )..         
-0003d890: 2020 2020 2020 206e 6577 5f76 6572 7473         new_verts
-0003d8a0: 203d 206d 6964 5365 676d 656e 7456 6572   = midSegmentVer
-0003d8b0: 7469 6365 7328 6e75 6d44 6976 2c74 6169  tices(numDiv,tai
-0003d8c0: 6c5f 7665 7274 2c20 6865 6164 5f76 6572  l_vert, head_ver
-0003d8d0: 7429 0d0a 2020 2020 2020 2020 2020 2020  t)..            
-0003d8e0: 2020 2020 6e65 775f 7665 7274 6578 436f      new_vertexCo
-0003d8f0: 6f72 203d 206e 702e 636f 6e63 6174 656e  or = np.concaten
-0003d900: 6174 6528 2028 6e65 775f 7665 7274 6578  ate( (new_vertex
-0003d910: 436f 6f72 2c6e 6577 5f76 6572 7473 292c  Coor,new_verts),
-0003d920: 6178 6973 3d30 290d 0a20 2020 2020 2020  axis=0)..       
-0003d930: 2020 2020 2020 2020 206e 6578 745f 7374           next_st
-0003d940: 6172 745f 696e 6465 7820 3d20 6e65 775f  art_index = new_
-0003d950: 7374 6172 745f 7665 7274 5f69 6e64 6578  start_vert_index
-0003d960: 202b 206c 656e 286e 6577 5f76 6572 7473   + len(new_verts
-0003d970: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0003d980: 2020 2074 656d 7020 3d20 5b2a 7261 6e67     temp = [*rang
-0003d990: 6528 6e65 775f 7374 6172 745f 7665 7274  e(new_start_vert
-0003d9a0: 5f69 6e64 6578 2c6e 6578 745f 7374 6172  _index,next_star
-0003d9b0: 745f 696e 6465 7829 5d0d 0a20 2020 2020  t_index)]..     
-0003d9c0: 2020 2020 2020 2020 2020 2073 696e 676c             singl
-0003d9d0: 655f 6c69 6e65 496e 6465 782e 6578 7465  e_lineIndex.exte
-0003d9e0: 6e64 2820 7465 6d70 2029 0d0a 2020 2020  nd( temp )..    
-0003d9f0: 2020 2020 2020 2020 2020 2020 6e65 775f              new_
-0003da00: 7374 6172 745f 7665 7274 5f69 6e64 6578  start_vert_index
-0003da10: 203d 206e 6578 745f 7374 6172 745f 696e   = next_start_in
-0003da20: 6465 780d 0a20 2020 2020 2020 2020 2020  dex..           
-0003da30: 2020 2020 2069 6620 2869 2b31 2920 3d3d       if (i+1) ==
-0003da40: 206c 6173 744c 696e 6556 6572 7449 6e64   lastLineVertInd
-0003da50: 6578 203a 2073 696e 676c 655f 6c69 6e65  ex : single_line
-0003da60: 496e 6465 782e 6170 7065 6e64 2820 6c69  Index.append( li
-0003da70: 6e65 5b69 2b31 5d20 290d 0a20 2020 2020  ne[i+1] )..     
-0003da80: 2020 2020 2020 206e 6577 5f6c 696e 6549         new_lineI
-0003da90: 6e64 6963 6573 2e61 7070 656e 6428 7369  ndices.append(si
-0003daa0: 6e67 6c65 5f6c 696e 6549 6e64 6578 290d  ngle_lineIndex).
-0003dab0: 0a0d 0a20 2020 2020 2020 2073 656c 662e  ...        self.
-0003dac0: 7665 7274 6578 436f 6f72 203d 206e 6577  vertexCoor = new
-0003dad0: 5f76 6572 7465 7843 6f6f 720d 0a20 2020  _vertexCoor..   
-0003dae0: 2020 2020 2073 656c 662e 6c69 6e65 496e       self.lineIn
-0003daf0: 6469 6365 7320 3d20 6e65 775f 6c69 6e65  dices = new_line
-0003db00: 496e 6469 6365 730d 0a20 2020 2020 2020  Indices..       
-0003db10: 2073 656c 662e 5f73 6872 6564 2829 0d0a   self._shred()..
-0003db20: 2020 2020 2020 2020 7365 6c66 2e5f 6564          self._ed
-0003db30: 6765 636f 6c6f 7273 203d 2063 6f6c 6f72  gecolors = color
-0003db40: 730d 0a20 2020 2020 2020 2072 6574 7572  s..        retur
-0003db50: 6e20 7365 6c66 0d0a 2020 2020 0d0a 2020  n self..    ..  
-0003db60: 2020 6465 6620 6d61 705f 636d 6170 5f66    def map_cmap_f
-0003db70: 726f 6d5f 7365 7175 656e 6365 2820 7365  rom_sequence( se
-0003db80: 6c66 2c20 636d 6170 3d4e 6f6e 652c 2073  lf, cmap=None, s
-0003db90: 6f70 3d4e 6f6e 652c 2063 6e61 6d65 3d4e  op=None, cname=N
-0003dba0: 6f6e 6520 2920 3a0d 0a20 2020 2020 2020  one ) :..       
-0003dbb0: 2022 2222 0d0a 2020 2020 2020 2020 5365   """..        Se
-0003dbc0: 7175 656e 7469 616c 2063 6f6c 6f72 2061  quential color a
-0003dbd0: 7373 6967 6e6d 656e 7420 6f66 2065 6163  ssignment of eac
-0003dbe0: 6820 6c69 6e65 2073 6567 6d65 6e74 2e0d  h line segment..
-0003dbf0: 0a0d 0a20 2020 2020 2020 2050 6172 616d  ...        Param
-0003dc00: 6574 6572 730d 0a20 2020 2020 2020 202d  eters..        -
-0003dc10: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
-0003dc20: 2020 2063 6d61 7020 3a20 7374 7220 6f72     cmap : str or
-0003dc30: 2043 6f6c 6f72 6d61 702c 206f 7074 696f   Colormap, optio
-0003dc40: 6e61 6c2c 2064 6566 6175 6c74 3a20 2776  nal, default: 'v
-0003dc50: 6972 6964 6973 270d 0a20 2020 2020 2020  iridis'..       
-0003dc60: 2020 2020 2041 2043 6f6c 6f72 6d61 7020       A Colormap 
-0003dc70: 696e 7374 616e 6365 206f 7220 7265 6769  instance or regi
-0003dc80: 7374 6572 6564 2063 6f6c 6f72 6d61 7020  stered colormap 
-0003dc90: 6e61 6d65 2e0d 0a20 2020 2020 2020 200d  name...        .
-0003dca0: 0a20 2020 2020 2020 2073 6f70 203a 2066  .        sop : f
-0003dcb0: 756e 6374 696f 6e20 6f62 6a65 6374 2c20  unction object, 
-0003dcc0: 6f70 7469 6f6e 616c 2c20 6465 6661 756c  optional, defaul
-0003dcd0: 743a 204e 6f6e 650d 0a20 2020 2020 2020  t: None..       
-0003dce0: 2020 2020 2046 756e 6374 696f 6e20 7468       Function th
-0003dcf0: 6174 2074 616b 6573 206f 6e65 2061 7267  at takes one arg
-0003dd00: 756d 656e 742c 0d0a 2020 2020 2020 2020  ument,..        
-0003dd10: 2020 2020 6120 4e20 4e75 6d70 7920 6172      a N Numpy ar
-0003dd20: 7261 7920 6f66 2073 6361 6c61 7220 7661  ray of scalar va
-0003dd30: 6c75 6573 2072 616e 6769 6e67 2030 2074  lues ranging 0 t
-0003dd40: 6f20 312e 0d0a 2020 2020 2020 2020 2020  o 1...          
-0003dd50: 2020 5468 6520 6675 6e63 7469 6f6e 2072    The function r
-0003dd60: 6574 7572 6e73 2061 204e 756d 7079 2061  eturns a Numpy a
-0003dd70: 7272 6179 206f 6620 7363 616c 6172 2076  rray of scalar v
-0003dd80: 616c 7565 732e 0d0a 0d0a 2020 2020 2020  alues.....      
-0003dd90: 2020 636e 616d 6520 3a20 7374 722c 206f    cname : str, o
-0003dda0: 7074 696f 6e61 6c2c 2064 6566 6175 6c74  ptional, default
-0003ddb0: 3a20 6675 6e63 7469 6f6e 206f 626a 6563  : function objec
-0003ddc0: 7420 6e61 6d65 0d0a 2020 2020 2020 2020  t name..        
-0003ddd0: 2020 2020 2020 2020 6966 206e 6f74 2061          if not a
-0003dde0: 206c 616d 6264 6120 6675 6e63 7469 6f6e   lambda function
-0003ddf0: 2c20 6f74 6865 7277 6973 6520 2727 2e0d  , otherwise ''..
-0003de00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003de10: 2049 6465 6e74 6966 6965 7220 666f 7220   Identifier for 
-0003de20: 7468 6520 636f 6c6f 7220 7661 6c75 6573  the color values
-0003de30: 2e0d 0a20 2020 2020 2020 200d 0a20 2020  ...        ..   
-0003de40: 2020 2020 2052 6574 7572 6e73 0d0a 2020       Returns..  
-0003de50: 2020 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20        -------.. 
-0003de60: 2020 2020 2020 2073 656c 6620 3a20 6c69         self : li
-0003de70: 6e65 206f 626a 6563 740d 0a0d 0a20 2020  ne object....   
-0003de80: 2020 2020 2022 2222 0d0a 0d0a 2020 2020       """....    
-0003de90: 2020 2020 6966 2063 6d61 7020 6973 206e      if cmap is n
-0003dea0: 6f74 204e 6f6e 6520 3a0d 0a20 2020 2020  ot None :..     
-0003deb0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-0003dec0: 616e 6365 2863 6d61 702c 7374 7229 203a  ance(cmap,str) :
-0003ded0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-0003dee0: 2020 2073 656c 662e 7365 745f 636d 6170     self.set_cmap
-0003def0: 2863 6d2e 6765 745f 636d 6170 2863 6d61  (cm.get_cmap(cma
-0003df00: 7029 290d 0a20 2020 2020 2020 2020 2020  p))..           
-0003df10: 2065 6c73 6520 3a0d 0a20 2020 2020 2020   else :..       
-0003df20: 2020 2020 2020 2020 2073 656c 662e 7365           self.se
-0003df30: 745f 636d 6170 2863 6d61 7029 0d0a 2020  t_cmap(cmap)..  
-0003df40: 2020 2020 2020 636d 5f63 6f6c 6f72 4d61        cm_colorMa
-0003df50: 7020 3d20 7365 6c66 2e67 6574 5f63 6d61  p = self.get_cma
-0003df60: 7028 290d 0a0d 0a20 2020 2020 2020 2073  p()....        s
-0003df70: 656c 662e 7661 6c75 6573 4e61 6d65 203d  elf.valuesName =
-0003df80: 2027 5365 7175 656e 6365 2720 2020 0d0a   'Sequence'   ..
-0003df90: 2020 2020 2020 2020 2320 2d2d 2d2d 2d2d          # ------
-0003dfa0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0003dfb0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0003dfc0: 2d2d 2d0d 0a20 2020 2020 2020 2073 6567  ---..        seg
-0003dfd0: 6d65 6e74 7320 3d20 7365 6c66 2e5f 7365  ments = self._se
-0003dfe0: 676d 656e 7473 3364 0d0a 2020 2020 2020  gments3d..      
-0003dff0: 2020 6966 206e 6f74 2073 656c 662e 6973    if not self.is
-0003e000: 5368 7265 6464 6564 203a 0d0a 2020 2020  Shredded :..    
-0003e010: 2020 2020 2020 2020 7365 676d 656e 7473          segments
-0003e020: 203d 2073 656c 662e 5f73 6872 6564 2829   = self._shred()
-0003e030: 0d0a 2020 2020 2020 2020 2320 2d2d 2d2d  ..        # ----
-0003e040: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0003e050: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0003e060: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2069  -----..        i
-0003e070: 203d 206e 702e 6c69 6e73 7061 6365 2830   = np.linspace(0
-0003e080: 2e30 2c31 2e30 2c20 6c65 6e28 7365 676d  .0,1.0, len(segm
-0003e090: 656e 7473 2920 290d 0a20 2020 2020 2020  ents) )..       
-0003e0a0: 2076 203d 2069 0d0a 2020 2020 2020 2020   v = i..        
-0003e0b0: 766d 696e 2c20 766d 6178 203d 2030 2e30  vmin, vmax = 0.0
-0003e0c0: 2c20 312e 300d 0a20 2020 2020 2020 2069  , 1.0..        i
-0003e0d0: 6620 736f 7020 6973 206e 6f74 204e 6f6e  f sop is not Non
-0003e0e0: 6520 3a0d 0a20 2020 2020 2020 2020 2020  e :..           
-0003e0f0: 2074 656d 7020 3d20 5f67 6574 4675 6e63   temp = _getFunc
-0003e100: 7469 6f6e 4e61 6d65 2873 6f70 2c63 6e61  tionName(sop,cna
-0003e110: 6d65 290d 0a20 2020 2020 2020 2020 2020  me)..           
-0003e120: 2069 6620 7465 6d70 2069 7320 6e6f 7420   if temp is not 
-0003e130: 4e6f 6e65 203a 2073 656c 662e 7661 6c75  None : self.valu
-0003e140: 6573 4e61 6d65 203d 2074 656d 700d 0a20  esName = temp.. 
-0003e150: 2020 2020 2020 2020 2020 2076 203d 206e             v = n
-0003e160: 702e 6172 7261 7928 736f 7028 6929 290d  p.array(sop(i)).
-0003e170: 0a20 2020 2020 2020 2020 2020 2076 6d69  .            vmi
-0003e180: 6e2c 2076 6d61 7820 3d20 762e 6d69 6e28  n, vmax = v.min(
-0003e190: 292c 2076 2e6d 6178 2829 0d0a 0d0a 2020  ), v.max()....  
-0003e1a0: 2020 2020 2020 6e6f 726d 203d 2063 6f6c        norm = col
-0003e1b0: 6f72 732e 4e6f 726d 616c 697a 6528 766d  ors.Normalize(vm
-0003e1c0: 696e 3d76 6d69 6e2c 766d 6178 3d76 6d61  in=vmin,vmax=vma
-0003e1d0: 7829 0d0a 2020 2020 2020 2020 7365 6c66  x)..        self
-0003e1e0: 2e5f 6564 6765 636f 6c6f 7273 203d 2063  ._edgecolors = c
-0003e1f0: 6d5f 636f 6c6f 724d 6170 286e 6f72 6d28  m_colorMap(norm(
-0003e200: 7629 290d 0a20 2020 2020 2020 2073 656c  v))..        sel
-0003e210: 662e 7365 6756 616c 7565 7320 3d20 760d  f.segValues = v.
-0003e220: 0a20 2020 2020 2020 2073 656c 662e 5f62  .        self._b
-0003e230: 6f75 6e64 735b 2776 6c69 6d27 5d20 3d20  ounds['vlim'] = 
-0003e240: 5b20 766d 696e 2c20 766d 6178 205d 200d  [ vmin, vmax ] .
-0003e250: 0a20 2020 2020 2020 2023 202e 2e2e 2e2e  .        # .....
-0003e260: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0003e270: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0003e280: 2e2e 2e2e 2e2e 2e2e 0d0a 2020 2020 2020  ..........      
-0003e290: 2020 7365 6c66 2e5f 6d61 705f 636d 6170    self._map_cmap
-0003e2a0: 5f66 726f 6d5f 7365 7175 656e 6365 5f76  _from_sequence_v
-0003e2b0: 6572 7428 636d 5f63 6f6c 6f72 4d61 7029  ert(cm_colorMap)
-0003e2c0: 0d0a 2020 2020 2020 2020 2320 2e2e 2e2e  ..        # ....
+00039820: 2e2e 2e2e 2e2e 0d0a 2020 2020 2020 2020  ........        
+00039830: 2020 2020 6172 6769 203d 2036 0d0a 2020      argi = 6..  
+00039840: 2020 2020 2020 2020 2020 6966 206c 656e            if len
+00039850: 2861 7267 7329 203c 2061 7267 693a 0d0a  (args) < argi:..
+00039860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039870: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+00039880: 2827 5772 6f6e 6720 6e75 6d62 6572 206f  ('Wrong number o
+00039890: 6620 6172 6775 6d65 6e74 732e 2045 7870  f arguments. Exp
+000398a0: 6563 7465 6420 2564 2067 6f74 2025 6427  ected %d got %d'
+000398b0: 2025 0d0a 2020 2020 2020 2020 2020 2020   %..            
+000398c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000398d0: 2020 2020 2861 7267 692c 206c 656e 2861      (argi, len(a
+000398e0: 7267 7329 2929 0d0a 2020 2020 2020 2020  rgs)))..        
+000398f0: 2020 2020 696e 7075 745f 6172 6773 203d      input_args =
+00039900: 2061 7267 735b 3a61 7267 695d 0d0a 2020   args[:argi]..  
+00039910: 2020 2020 2020 2020 2020 6d61 736b 7320            masks 
+00039920: 3d20 5b6b 2e6d 6173 6b20 666f 7220 6b20  = [k.mask for k 
+00039930: 696e 2069 6e70 7574 5f61 7267 730d 0a20  in input_args.. 
+00039940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039950: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+00039960: 286b 2c20 6e70 2e6d 612e 4d61 736b 6564  (k, np.ma.Masked
+00039970: 4172 7261 7929 5d0d 0a20 2020 2020 2020  Array)]..       
+00039980: 2020 2020 2062 6361 7374 203d 206e 702e       bcast = np.
+00039990: 6272 6f61 6463 6173 745f 6172 7261 7973  broadcast_arrays
+000399a0: 282a 696e 7075 745f 6172 6773 2c20 2a6d  (*input_args, *m
+000399b0: 6173 6b73 290d 0a20 2020 2020 2020 2020  asks)..         
+000399c0: 2020 2069 6e70 7574 5f61 7267 7320 3d20     input_args = 
+000399d0: 6263 6173 745b 3a61 7267 695d 0d0a 2020  bcast[:argi]..  
+000399e0: 2020 2020 2020 2020 2020 6d61 736b 7320            masks 
+000399f0: 3d20 6263 6173 745b 6172 6769 3a5d 0d0a  = bcast[argi:]..
+00039a00: 2020 2020 2020 2020 2020 2020 6966 206d              if m
+00039a10: 6173 6b73 3a0d 0a20 2020 2020 2020 2020  asks:..         
+00039a20: 2020 2020 2020 206d 6173 6b20 3d20 7265         mask = re
+00039a30: 6475 6365 286e 702e 6c6f 6769 6361 6c5f  duce(np.logical_
+00039a40: 6f72 2c20 6d61 736b 7329 0d0a 2020 2020  or, masks)..    
+00039a50: 2020 2020 2020 2020 2020 2020 696e 7075              inpu
+00039a60: 745f 6172 6773 203d 205b 6e70 2e6d 612e  t_args = [np.ma.
+00039a70: 6172 7261 7928 6b2c 206d 6173 6b3d 6d61  array(k, mask=ma
+00039a80: 736b 292e 636f 6d70 7265 7373 6564 2829  sk).compressed()
+00039a90: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00039aa0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+00039ab0: 7220 6b20 696e 2069 6e70 7574 5f61 7267  r k in input_arg
+00039ac0: 735d 0d0a 2020 2020 2020 2020 2020 2020  s]..            
+00039ad0: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+00039ae0: 2020 2020 2020 2069 6e70 7574 5f61 7267         input_arg
+00039af0: 7320 3d20 5b6e 702e 7261 7665 6c28 6b29  s = [np.ravel(k)
+00039b00: 2066 6f72 206b 2069 6e20 696e 7075 745f   for k in input_
+00039b10: 6172 6773 5d0d 0a0d 0a20 2020 2020 2020  args]....       
+00039b20: 2020 2020 2069 6620 616e 7928 6c65 6e28       if any(len(
+00039b30: 7629 203d 3d20 3020 666f 7220 7620 696e  v) == 0 for v in
+00039b40: 2069 6e70 7574 5f61 7267 7329 3a0d 0a20   input_args):.. 
+00039b50: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00039b60: 6574 7572 6e20 5b5d 0d0a 2020 2020 2020  eturn []..      
+00039b70: 2020 2020 2020 7368 6166 745f 6474 203d        shaft_dt =
+00039b80: 206e 702e 6172 7261 7928 5b30 2c20 6c65   np.array([0, le
+00039b90: 6e67 7468 5d29 0d0a 2020 2020 2020 2020  ngth])..        
+00039ba0: 2020 2020 6172 726f 775f 6474 203d 2073      arrow_dt = s
+00039bb0: 6861 6674 5f64 7420 2a20 6172 726f 775f  haft_dt * arrow_
+00039bc0: 6c65 6e67 7468 5f72 6174 696f 0d0a 2020  length_ratio..  
+00039bd0: 2020 2020 2020 2020 2020 6966 2070 6976            if piv
+00039be0: 6f74 203d 3d20 2774 6169 6c27 3a0d 0a20  ot == 'tail':.. 
+00039bf0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00039c00: 6861 6674 5f64 7420 2d3d 206c 656e 6774  haft_dt -= lengt
+00039c10: 680d 0a20 2020 2020 2020 2020 2020 2065  h..            e
+00039c20: 6c69 6620 7069 766f 7420 3d3d 2027 6d69  lif pivot == 'mi
+00039c30: 6464 6c65 273a 0d0a 2020 2020 2020 2020  ddle':..        
+00039c40: 2020 2020 2020 2020 7368 6166 745f 6474          shaft_dt
+00039c50: 202d 3d20 6c65 6e67 7468 2f32 2e0d 0a20   -= length/2... 
+00039c60: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+00039c70: 7069 766f 7420 213d 2027 7469 7027 3a0d  pivot != 'tip':.
+00039c80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00039c90: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+00039ca0: 7228 2749 6e76 616c 6964 2070 6976 6f74  r('Invalid pivot
+00039cb0: 2061 7267 756d 656e 743a 2027 202b 2073   argument: ' + s
+00039cc0: 7472 2870 6976 6f74 2929 0d0a 2020 2020  tr(pivot))..    
+00039cd0: 2020 2020 2020 2020 5859 5a20 3d20 6e70          XYZ = np
+00039ce0: 2e63 6f6c 756d 6e5f 7374 6163 6b28 696e  .column_stack(in
+00039cf0: 7075 745f 6172 6773 5b3a 335d 290d 0a20  put_args[:3]).. 
+00039d00: 2020 2020 2020 2020 2020 2055 5657 203d             UVW =
+00039d10: 206e 702e 636f 6c75 6d6e 5f73 7461 636b   np.column_stack
+00039d20: 2869 6e70 7574 5f61 7267 735b 333a 6172  (input_args[3:ar
+00039d30: 6769 5d29 2e61 7374 7970 6528 666c 6f61  gi]).astype(floa
+00039d40: 7429 0d0a 2020 2020 2020 2020 2020 2020  t)..            
+00039d50: 6e6f 726d 203d 206e 702e 6c69 6e61 6c67  norm = np.linalg
+00039d60: 2e6e 6f72 6d28 5556 572c 2061 7869 733d  .norm(UVW, axis=
+00039d70: 3129 0d0a 2020 2020 2020 2020 2020 2020  1)..            
+00039d80: 6d61 736b 203d 206e 6f72 6d20 3e20 300d  mask = norm > 0.
+00039d90: 0a20 2020 2020 2020 2020 2020 2058 595a  .            XYZ
+00039da0: 203d 2058 595a 5b6d 6173 6b5d 0d0a 2020   = XYZ[mask]..  
+00039db0: 2020 2020 2020 2020 2020 6966 206e 6f72            if nor
+00039dc0: 6d61 6c69 7a65 3a0d 0a20 2020 2020 2020  malize:..       
+00039dd0: 2020 2020 2020 2020 2055 5657 203d 2055           UVW = U
+00039de0: 5657 5b6d 6173 6b5d 202f 206e 6f72 6d5b  VW[mask] / norm[
+00039df0: 6d61 736b 5d2e 7265 7368 6170 6528 282d  mask].reshape((-
+00039e00: 312c 2031 2929 0d0a 2020 2020 2020 2020  1, 1))..        
+00039e10: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+00039e20: 2020 2020 2020 2020 2020 2055 5657 203d             UVW =
+00039e30: 2055 5657 5b6d 6173 6b5d 0d0a 2020 2020   UVW[mask]..    
+00039e40: 2020 2020 2020 2020 6966 206c 656e 2858          if len(X
+00039e50: 595a 2920 3e20 303a 0d0a 2020 2020 2020  YZ) > 0:..      
+00039e60: 2020 2020 2020 2020 2020 7368 6166 7473            shafts
+00039e70: 203d 2028 5859 5a20 2d20 6e70 2e6d 756c   = (XYZ - np.mul
+00039e80: 7469 706c 792e 6f75 7465 7228 7368 6166  tiply.outer(shaf
+00039e90: 745f 6474 2c20 5556 5729 292e 7377 6170  t_dt, UVW)).swap
+00039ea0: 6178 6573 2830 2c20 3129 0d0a 2020 2020  axes(0, 1)..    
+00039eb0: 2020 2020 2020 2020 2020 2020 6865 6164              head
+00039ec0: 5f64 6972 7320 3d20 6e70 2e61 7272 6179  _dirs = np.array
+00039ed0: 285b 6361 6c63 5f61 7272 6f77 2864 2920  ([calc_arrow(d) 
+00039ee0: 666f 7220 6420 696e 2055 5657 5d29 0d0a  for d in UVW])..
+00039ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039f00: 6865 6164 7320 3d20 7368 6166 7473 5b3a  heads = shafts[:
+00039f10: 2c20 3a31 5d20 2d20 6e70 2e6d 756c 7469  , :1] - np.multi
+00039f20: 706c 792e 6f75 7465 7228 6172 726f 775f  ply.outer(arrow_
+00039f30: 6474 2c20 6865 6164 5f64 6972 7329 0d0a  dt, head_dirs)..
+00039f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039f50: 6865 6164 732e 7368 6170 6520 3d20 286c  heads.shape = (l
+00039f60: 656e 2861 7272 6f77 5f64 7429 2c20 2d31  en(arrow_dt), -1
+00039f70: 2c20 3329 0d0a 2020 2020 2020 2020 2020  , 3)..          
+00039f80: 2020 2020 2020 6865 6164 7320 3d20 6865        heads = he
+00039f90: 6164 732e 7377 6170 6178 6573 2830 2c20  ads.swapaxes(0, 
+00039fa0: 3129 0d0a 2020 2020 2020 2020 2020 2020  1)..            
+00039fb0: 2020 2020 6c69 6e65 7320 3d20 5b2a 7368      lines = [*sh
+00039fc0: 6166 7473 2c20 2a68 6561 6473 5d0d 0a20  afts, *heads].. 
+00039fd0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00039fe0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00039ff0: 2020 6c69 6e65 7320 3d20 5b5d 0d0a 2020    lines = []..  
+0003a000: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0003a010: 206c 696e 6573 202c 2058 595a 2c55 5657   lines , XYZ,UVW
+0003a020: 2020 2023 203c 2d2d 2d20 6164 6465 6420     # <--- added 
+0003a030: 7265 7475 726e 206f 6620 5859 5a2c 5556  return of XYZ,UV
+0003a040: 570d 0a20 2020 2020 2020 2023 202e 2e2e  W..        # ...
+0003a050: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0003a060: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0003a070: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e0d  ................
+0003a080: 0a20 2020 2020 2020 2078 2c79 2c7a 203d  .        x,y,z =
+0003a090: 206e 702e 7472 616e 7370 6f73 6528 2076   np.transpose( v
+0003a0a0: 4320 290d 0a20 2020 2020 2020 2075 2c76  C )..        u,v
+0003a0b0: 2c77 203d 206e 702e 7472 616e 7370 6f73  ,w = np.transpos
+0003a0c0: 6528 2076 4e20 290d 0a20 2020 2020 2020  e( vN )..       
+0003a0d0: 206c 696e 6573 2c20 5859 5a2c 2055 5657   lines, XYZ, UVW
+0003a0e0: 203d 2071 7569 7665 7228 782c 792c 7a2c   = quiver(x,y,z,
+0003a0f0: 752c 762c 7729 0d0a 2020 2020 2020 2020  u,v,w)..        
+0003a100: 7265 7475 726e 206c 696e 6573 2c20 5859  return lines, XY
+0003a110: 5a2c 2055 5657 0d0a 0d0a 2020 2020 4070  Z, UVW....    @p
+0003a120: 726f 7065 7274 790d 0a20 2020 2064 6566  roperty..    def
+0003a130: 2061 6c72 2873 656c 6629 203a 0d0a 2020   alr(self) :..  
+0003a140: 2020 2020 2020 2727 2741 7272 6f77 2068        '''Arrow h
+0003a150: 6561 6420 746f 206c 656e 6774 6820 7261  ead to length ra
+0003a160: 7469 6f2e 2727 270d 0a20 2020 2020 2020  tio.'''..       
+0003a170: 2072 6574 7572 6e20 7365 6c66 2e5f 616c   return self._al
+0003a180: 720d 0a0d 0a20 2020 2040 616c 722e 7365  r....    @alr.se
+0003a190: 7474 6572 0d0a 2020 2020 6465 6620 616c  tter..    def al
+0003a1a0: 7228 7365 6c66 2c20 7661 6c29 203a 0d0a  r(self, val) :..
+0003a1b0: 2020 2020 2020 2020 6c6f 6361 7469 6f6e          location
+0003a1c0: 203d 2073 656c 662e 6261 7365 4c6f 6361   = self.baseLoca
+0003a1d0: 7469 6f6e 0d0a 2020 2020 2020 2020 7665  tion..        ve
+0003a1e0: 6374 203d 2073 656c 662e 6261 7365 5665  ct = self.baseVe
+0003a1f0: 6374 0d0a 2020 2020 2020 2020 6966 2076  ct..        if v
+0003a200: 616c 2069 7320 4e6f 6e65 203a 2076 616c  al is None : val
+0003a210: 203d 205f 4446 545f 414c 520d 0a20 2020   = _DFT_ALR..   
+0003a220: 2020 2020 2073 656c 662e 5f61 6c72 203d       self._alr =
+0003a230: 2076 616c 0d0a 2020 2020 2020 2020 6c69   val..        li
+0003a240: 6e65 732c 5f2c 5f20 3d20 7365 6c66 2e5f  nes,_,_ = self._
+0003a250: 7175 6976 6572 4c69 6e65 7328 6c6f 6361  quiverLines(loca
+0003a260: 7469 6f6e 2c76 6563 742c 7365 6c66 2e5f  tion,vect,self._
+0003a270: 616c 7229 0d0a 2020 2020 2020 2020 7365  alr)..        se
+0003a280: 6c66 2e73 6574 5f73 6567 6d65 6e74 7328  lf.set_segments(
+0003a290: 6c69 6e65 7329 0d0a 2020 2020 2020 2020  lines)..        
+0003a2a0: 7265 7475 726e 0d0a 0d0a 2020 2020 4070  return....    @p
+0003a2b0: 726f 7065 7274 790d 0a20 2020 2064 6566  roperty..    def
+0003a2c0: 2076 6c69 6d28 7365 6c66 2920 3a0d 0a20   vlim(self) :.. 
+0003a2d0: 2020 2020 2020 2027 2727 5261 6e67 6520         '''Range 
+0003a2e0: 6f66 2076 616c 7565 7320 6173 736f 6369  of values associ
+0003a2f0: 6174 6564 2077 6974 6820 636f 6c6f 7227  ated with color'
+0003a300: 2727 0d0a 2020 2020 2020 2020 7265 7475  ''..        retu
+0003a310: 726e 2073 656c 662e 5f62 6f75 6e64 735b  rn self._bounds[
+0003a320: 2776 6c69 6d27 5d0d 0a0d 0a20 2020 2040  'vlim']....    @
+0003a330: 766c 696d 2e73 6574 7465 720d 0a20 2020  vlim.setter..   
+0003a340: 2064 6566 2076 6c69 6d28 7365 6c66 2c76   def vlim(self,v
+0003a350: 616c 2920 3a0d 0a20 2020 2020 2020 2073  al) :..        s
+0003a360: 656c 662e 5f62 6f75 6e64 735b 2776 6c69  elf._bounds['vli
+0003a370: 6d27 5d20 3d20 7661 6c0d 0a20 2020 2020  m'] = val..     
+0003a380: 2020 2072 6574 7572 6e0d 0a0d 0a20 2020     return....   
+0003a390: 2040 7072 6f70 6572 7479 0d0a 2020 2020   @property..    
+0003a3a0: 6465 6620 6e61 6d65 2873 656c 6629 203a  def name(self) :
+0003a3b0: 0d0a 2020 2020 2020 2020 2727 2744 6573  ..        '''Des
+0003a3c0: 6372 6970 7469 7665 2069 6465 6e74 6966  criptive identif
+0003a3d0: 6965 7220 666f 7220 7468 6520 7665 6374  ier for the vect
+0003a3e0: 6f72 2067 656f 6d65 7472 792e 2727 270d  or geometry.'''.
+0003a3f0: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+0003a400: 2e5f 6765 6f6d 4e61 6d65 2069 7320 4e6f  ._geomName is No
+0003a410: 6e65 203a 2072 6574 7572 6e20 2727 0d0a  ne : return ''..
+0003a420: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0003a430: 656c 662e 5f67 656f 6d4e 616d 650d 0a0d  elf._geomName...
+0003a440: 0a20 2020 2040 6e61 6d65 2e73 6574 7465  .    @name.sette
+0003a450: 720d 0a20 2020 2064 6566 206e 616d 6528  r..    def name(
+0003a460: 7365 6c66 2c20 7661 6c29 203a 0d0a 2020  self, val) :..  
+0003a470: 2020 2020 2020 7365 6c66 2e5f 6765 6f6d        self._geom
+0003a480: 4e61 6d65 203d 2076 616c 0d0a 2020 2020  Name = val..    
+0003a490: 2020 2020 7365 6c66 2e73 6574 5f6c 6162      self.set_lab
+0003a4a0: 656c 2820 2727 2069 6620 7661 6c20 6973  el( '' if val is
+0003a4b0: 204e 6f6e 6520 656c 7365 2076 616c 290d   None else val).
+0003a4c0: 0a20 2020 2020 2020 2072 6574 7572 6e0d  .        return.
+0003a4d0: 0a0d 0a20 2020 2040 7072 6f70 6572 7479  ...    @property
+0003a4e0: 0d0a 2020 2020 6465 6620 636e 616d 6528  ..    def cname(
+0003a4f0: 7365 6c66 2920 3a0d 0a20 2020 2020 2020  self) :..       
+0003a500: 2027 2727 4465 7363 7269 7074 6976 6520   '''Descriptive 
+0003a510: 6964 656e 7469 6669 6572 2066 6f72 2076  identifier for v
+0003a520: 616c 7565 7320 696e 6469 6361 7465 6420  alues indicated 
+0003a530: 6279 2063 6f6c 6f72 2e27 2727 0d0a 2020  by color.'''..  
+0003a540: 2020 2020 2020 6966 2073 656c 662e 7661        if self.va
+0003a550: 6c75 6573 4e61 6d65 2069 7320 4e6f 6e65  luesName is None
+0003a560: 203a 2072 6574 7572 6e20 2727 0d0a 2020   : return ''..  
+0003a570: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0003a580: 662e 7661 6c75 6573 4e61 6d65 0d0a 0d0a  f.valuesName....
+0003a590: 2020 2020 4063 6e61 6d65 2e73 6574 7465      @cname.sette
+0003a5a0: 720d 0a20 2020 2064 6566 2063 6e61 6d65  r..    def cname
+0003a5b0: 2873 656c 662c 2076 616c 2920 3a0d 0a20  (self, val) :.. 
+0003a5c0: 2020 2020 2020 2073 656c 662e 7661 6c75         self.valu
+0003a5d0: 6573 4e61 6d65 203d 2076 616c 0d0a 2020  esName = val..  
+0003a5e0: 2020 2020 2020 7265 7475 726e 0d0a 0d0a        return....
+0003a5f0: 2020 2020 4070 726f 7065 7274 790d 0a20      @property.. 
+0003a600: 2020 2064 6566 2062 6f75 6e64 7328 7365     def bounds(se
+0003a610: 6c66 2920 3a0d 0a20 2020 2020 2020 2022  lf) :..        "
+0003a620: 2222 0d0a 2020 2020 2020 2020 4469 6374  ""..        Dict
+0003a630: 696f 6e61 7279 206f 6620 7665 6374 6f72  ionary of vector
+0003a640: 2067 656f 6d65 7472 6963 2061 6e64 2076   geometric and v
+0003a650: 616c 7565 2072 616e 6765 732e 0d0a 2020  alue ranges...  
+0003a660: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+0003a670: 4561 6368 2064 6963 7469 6f6e 6172 7920  Each dictionary 
+0003a680: 7661 6c75 6520 6973 2061 2032 2066 6c6f  value is a 2 flo
+0003a690: 6174 2061 7272 6179 206f 6620 6d69 6e69  at array of mini
+0003a6a0: 6d75 6d0d 0a20 2020 2020 2020 2061 6e64  mum..        and
+0003a6b0: 206d 6178 696d 756d 2076 616c 7565 7320   maximum values 
+0003a6c0: 6f66 2074 6865 2076 6563 746f 7220 6c6f  of the vector lo
+0003a6d0: 6361 7469 6f6e 2e20 204b 6579 7320 6172  cation.  Keys ar
+0003a6e0: 653a 0d0a 0d0a 2020 2020 2020 2020 2778  e:....        'x
+0003a6f0: 6c69 6d27 203a 2078 2d63 6f6f 7264 696e  lim' : x-coordin
+0003a700: 6174 650d 0a0d 0a20 2020 2020 2020 2027  ate....        '
+0003a710: 796c 696d 2720 3a20 792d 636f 6f72 6469  ylim' : y-coordi
+0003a720: 6e61 7465 0d0a 0d0a 2020 2020 2020 2020  nate....        
+0003a730: 277a 6c69 6d27 203a 207a 2d63 6f6f 7264  'zlim' : z-coord
+0003a740: 696e 6174 650d 0a0d 0a20 2020 2020 2020  inate....       
+0003a750: 2027 725f 7879 2720 3a20 7261 6469 616c   'r_xy' : radial
+0003a760: 2064 6973 7461 6e63 6520 6672 6f6d 2074   distance from t
+0003a770: 6865 207a 2061 7869 730d 0a0d 0a20 2020  he z axis....   
+0003a780: 2020 2020 2027 726f 7267 2720 3a20 7261       'rorg' : ra
+0003a790: 6469 616c 2064 6973 7461 6e63 6520 6672  dial distance fr
+0003a7a0: 6f6d 2074 6865 206f 7269 6769 6e0d 0a0d  om the origin...
+0003a7b0: 0a20 2020 2020 2020 2027 766c 696d 2720  .        'vlim' 
+0003a7c0: 3a20 7661 6c75 6520 6675 6e63 7469 6f6e  : value function
+0003a7d0: 616c 2061 7373 6967 6e6d 656e 7473 2e0d  al assignments..
+0003a7e0: 0a0d 0a20 2020 2020 2020 2027 7665 7274  ...        'vert
+0003a7f0: 766c 696d 3a20 6d61 676e 6974 7564 650d  vlim: magnitude.
+0003a800: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
+0003a810: 2020 2020 2020 2056 616c 7565 7320 6172         Values ar
+0003a820: 6520 6173 7369 676e 6564 2066 726f 6d20  e assigned from 
+0003a830: 7468 6520 6765 6f6d 6574 7279 2061 6e64  the geometry and
+0003a840: 2063 6f6c 6f72 206d 6170 7069 6e67 206d   color mapping m
+0003a850: 6574 686f 6473 2e0d 0a0d 0a20 2020 2020  ethods.....     
+0003a860: 2020 2022 2222 0d0a 0d0a 2020 2020 2020     """....      
+0003a870: 2020 7265 7475 726e 2073 656c 662e 5f62    return self._b
+0003a880: 6f75 6e64 730d 0a0d 0a20 2020 2064 6566  ounds....    def
+0003a890: 206d 6170 5f63 6f6c 6f72 5f66 726f 6d5f   map_color_from_
+0003a8a0: 6f70 2820 7365 6c66 2c20 6f70 6572 6174  op( self, operat
+0003a8b0: 696f 6e2c 2072 6762 3d54 7275 652c 2063  ion, rgb=True, c
+0003a8c0: 6e61 6d65 3d4e 6f6e 6520 2920 3a0d 0a20  name=None ) :.. 
+0003a8d0: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
+0003a8e0: 2020 2020 4173 7369 676e 6d65 6e74 206f      Assignment o
+0003a8f0: 6620 7665 6374 6f72 2063 6f6c 6f72 2066  f vector color f
+0003a900: 726f 6d20 6120 6675 6e63 7469 6f6e 2e0d  rom a function..
+0003a910: 0a0d 0a20 2020 2020 2020 2056 6563 746f  ...        Vecto
+0003a920: 7220 636f 6c6f 7273 2061 7265 2061 7373  r colors are ass
+0003a930: 6967 6e65 6420 6672 6f6d 2061 2066 756e  igned from a fun
+0003a940: 6374 696f 6e0d 0a20 2020 2020 2020 206f  ction..        o
+0003a950: 6620 6469 7265 6374 696f 6e20 616e 6420  f direction and 
+0003a960: 6c6f 6361 7469 6f6e 2063 6f6f 7264 696e  location coordin
+0003a970: 6174 6573 2e0d 0a0d 0a20 2020 2020 2020  ates.....       
+0003a980: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
+0003a990: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
+0003a9a0: 0a20 2020 2020 2020 206f 7065 7261 7469  .        operati
+0003a9b0: 6f6e 203a 2066 756e 6374 696f 6e20 6f62  on : function ob
+0003a9c0: 6a65 6374 0d0a 2020 2020 2020 2020 2020  ject..          
+0003a9d0: 2020 4675 6e63 7469 6f6e 2074 6861 7420    Function that 
+0003a9e0: 7461 6b65 7320 7477 6f20 6172 6775 6d65  takes two argume
+0003a9f0: 6e74 732c 2062 6f74 680d 0a20 2020 2020  nts, both..     
+0003aa00: 2020 2020 2020 2061 2033 784e 204e 756d         a 3xN Num
+0003aa10: 7079 2061 7272 6179 206f 6620 7879 7a20  py array of xyz 
+0003aa20: 636f 6f72 6469 6e61 7465 732e 0d0a 2020  coordinates...  
+0003aa30: 2020 2020 2020 2020 2020 5468 6520 6669            The fi
+0003aa40: 7273 7420 616e 6420 7365 636f 6e64 2061  rst and second a
+0003aa50: 7267 756d 656e 7473 2061 7265 2074 6865  rguments are the
+0003aa60: 206c 6f63 6174 696f 6e0d 0a20 2020 2020   location..     
+0003aa70: 2020 2020 2020 2061 6e64 2064 6972 6563         and direc
+0003aa80: 7469 6f6e 2c20 7265 7370 6563 7469 7665  tion, respective
+0003aa90: 6c79 2e0d 0a20 2020 2020 2020 2020 2020  ly...           
+0003aaa0: 2054 6865 2066 756e 6374 696f 6e20 7265   The function re
+0003aab0: 7475 726e 7320 6120 3378 4e20 636f 6c6f  turns a 3xN colo
+0003aac0: 7220 7661 6c75 652e 0d0a 0d0a 2020 2020  r value.....    
+0003aad0: 2020 2020 7267 6220 3a20 626f 6f6c 207b      rgb : bool {
+0003aae0: 5472 7565 2c20 4661 6c73 657d 2c20 6f70  True, False}, op
+0003aaf0: 7469 6f6e 616c 2c20 6465 6661 756c 743a  tional, default:
+0003ab00: 2054 7275 650d 0a20 2020 2020 2020 2020   True..         
+0003ab10: 2020 2042 7920 6465 6661 756c 742c 2052     By default, R
+0003ab20: 4742 2063 6f6c 6f72 2076 616c 7565 7320  GB color values 
+0003ab30: 6172 6520 7265 7475 726e 6564 2062 7920  are returned by 
+0003ab40: 7468 650d 0a20 2020 2020 2020 2020 2020  the..           
+0003ab50: 206f 7065 7261 7469 6f6e 2066 756e 6374   operation funct
+0003ab60: 696f 6e2e 2020 4966 2073 6574 2046 616c  ion.  If set Fal
+0003ab70: 7365 2c20 7468 6520 6f70 6572 6174 696f  se, the operatio
+0003ab80: 6e0d 0a20 2020 2020 2020 2020 2020 2072  n..            r
+0003ab90: 6574 7572 6e73 2048 5356 2063 6f6c 6f72  eturns HSV color
+0003aba0: 2076 616c 7565 732e 0d0a 0d0a 2020 2020   values.....    
+0003abb0: 2020 2020 5265 7475 726e 730d 0a20 2020      Returns..   
+0003abc0: 2020 2020 202d 2d2d 2d2d 2d2d 0d0a 2020       -------..  
+0003abd0: 2020 2020 2020 7365 6c66 203a 2056 6563        self : Vec
+0003abe0: 746f 7233 4443 6f6c 6c65 6374 696f 6e20  tor3DCollection 
+0003abf0: 6f62 6a65 6374 0d0a 0d0a 2020 2020 2020  object....      
+0003ac00: 2020 2222 220d 0a20 2020 2020 2020 2078    """..        x
+0003ac10: 797a 203d 206e 702e 7472 616e 7370 6f73  yz = np.transpos
+0003ac20: 6528 7365 6c66 2e6c 6f63 6174 696f 6e29  e(self.location)
+0003ac30: 0d0a 2020 2020 2020 2020 7576 7720 3d20  ..        uvw = 
+0003ac40: 6e70 2e74 7261 6e73 706f 7365 2873 656c  np.transpose(sel
+0003ac50: 662e 7665 6374 290d 0a20 2020 2020 2020  f.vect)..       
+0003ac60: 2023 202e 2e2e 2e2e 0d0a 2020 2020 2020   # .......      
+0003ac70: 2020 636f 6c6f 7273 203d 206e 702e 6172    colors = np.ar
+0003ac80: 7261 7928 6f70 6572 6174 696f 6e28 7879  ray(operation(xy
+0003ac90: 7a2c 7576 7729 290d 0a20 2020 2020 2020  z,uvw))..       
+0003aca0: 2063 6f6c 6f72 7320 3d20 6e70 2e74 7261   colors = np.tra
+0003acb0: 6e73 706f 7365 2863 6f6c 6f72 7329 0d0a  nspose(colors)..
+0003acc0: 2020 2020 2020 2020 636f 6c6f 7273 203d          colors =
+0003acd0: 206e 702e 636c 6970 2863 6f6c 6f72 732c   np.clip(colors,
+0003ace0: 302c 3129 0d0a 2020 2020 2020 2020 6966  0,1)..        if
+0003acf0: 2072 6762 203a 2052 4742 203d 2063 6f6c   rgb : RGB = col
+0003ad00: 6f72 730d 0a20 2020 2020 2020 2065 6c73  ors..        els
+0003ad10: 6520 3a20 2020 5247 4220 3d20 636d 2e63  e :   RGB = cm.c
+0003ad20: 6f6c 6f72 732e 6873 765f 746f 5f72 6762  olors.hsv_to_rgb
+0003ad30: 2863 6f6c 6f72 7329 0d0a 0d0a 2020 2020  (colors)....    
+0003ad40: 2020 2020 6966 2052 4742 2e73 6861 7065      if RGB.shape
+0003ad50: 5b31 5d20 3d3d 2033 203a 0d0a 2020 2020  [1] == 3 :..    
+0003ad60: 2020 2020 2020 2020 6f6e 6573 203d 206e          ones = n
+0003ad70: 702e 6f6e 6573 2852 4742 2e73 6861 7065  p.ones(RGB.shape
+0003ad80: 5b30 5d29 5b3a 2c6e 702e 6e65 7761 7869  [0])[:,np.newaxi
+0003ad90: 735d 0d0a 2020 2020 2020 2020 2020 2020  s]..            
+0003ada0: 5247 4220 3d20 6e70 2e63 6f6e 6361 7465  RGB = np.concate
+0003adb0: 6e61 7465 2828 5247 422c 6f6e 6573 292c  nate((RGB,ones),
+0003adc0: 6178 6973 3d31 290d 0a0d 0a20 2020 2020  axis=1)....     
+0003add0: 2020 2073 656c 662e 5f73 6574 5f76 6563     self._set_vec
+0003ade0: 7443 6f6c 6f72 2852 4742 290d 0a20 2020  tColor(RGB)..   
+0003adf0: 2020 2020 2063 6e61 6d65 203d 205f 6765       cname = _ge
+0003ae00: 7446 756e 6374 696f 6e4e 616d 6528 6f70  tFunctionName(op
+0003ae10: 6572 6174 696f 6e2c 636e 616d 6529 0d0a  eration,cname)..
+0003ae20: 2020 2020 2020 2020 6966 2063 6e61 6d65          if cname
+0003ae30: 2069 7320 6e6f 7420 4e6f 6e65 203a 2073   is not None : s
+0003ae40: 656c 662e 7661 6c75 6573 4e61 6d65 203d  elf.valuesName =
+0003ae50: 2063 6e61 6d65 0d0a 2020 2020 200d 0a20   cname..     .. 
+0003ae60: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0003ae70: 6c66 0d0a 0d0a 2020 2020 6465 6620 6d61  lf....    def ma
+0003ae80: 705f 636d 6170 5f66 726f 6d5f 6f70 2820  p_cmap_from_op( 
+0003ae90: 7365 6c66 2c20 6f70 6572 6174 696f 6e2c  self, operation,
+0003aea0: 2063 6d61 703d 4e6f 6e65 2c20 636e 616d   cmap=None, cnam
+0003aeb0: 653d 4e6f 6e65 2029 203a 0d0a 2020 2020  e=None ) :..    
+0003aec0: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
+0003aed0: 2046 756e 6374 696f 6e61 6c20 6173 7369   Functional assi
+0003aee0: 676e 6d65 6e74 206f 6620 6120 7665 6374  gnment of a vect
+0003aef0: 6f72 2063 6f6c 6f72 2066 726f 6d20 6120  or color from a 
+0003af00: 636f 6c6f 7220 6d61 702e 0d0a 0d0a 2020  color map.....  
+0003af10: 2020 2020 2020 4c6f 6361 7469 6f6e 2061        Location a
+0003af20: 6e64 2064 6972 6563 7469 6f6e 2063 6f6f  nd direction coo
+0003af30: 7264 696e 6174 6573 2061 7265 2075 7365  rdinates are use
+0003af40: 6420 746f 2063 616c 6375 6c61 7465 2061  d to calculate a
+0003af50: 2073 6361 6c61 7220 0d0a 2020 2020 2020   scalar ..      
+0003af60: 2020 7768 6963 6820 6973 2074 6865 6e20    which is then 
+0003af70: 7573 6564 2074 6f20 6173 7369 676e 2066  used to assign f
+0003af80: 6163 6520 636f 6c6f 7273 2066 726f 6d20  ace colors from 
+0003af90: 610d 0a20 2020 2020 2020 2063 6f6c 6f72  a..        color
+0003afa0: 6d61 702e 0d0a 0d0a 2020 2020 2020 2020  map.....        
+0003afb0: 5061 7261 6d65 7465 7273 0d0a 2020 2020  Parameters..    
+0003afc0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a      ----------..
+0003afd0: 2020 2020 2020 2020 6f70 6572 6174 696f          operatio
+0003afe0: 6e20 3a20 6675 6e63 7469 6f6e 206f 626a  n : function obj
+0003aff0: 6563 740d 0a20 2020 2020 2020 2020 2020  ect..           
+0003b000: 2046 756e 6374 696f 6e20 7468 6174 2074   Function that t
+0003b010: 616b 6573 2074 776f 2061 7267 756d 656e  akes two argumen
+0003b020: 7473 2c20 626f 7468 0d0a 2020 2020 2020  ts, both..      
+0003b030: 2020 2020 2020 6120 3378 4e20 4e75 6d70        a 3xN Nump
+0003b040: 7920 6172 7261 7920 6f66 2078 797a 2063  y array of xyz c
+0003b050: 6f6f 7264 696e 6174 6573 2e0d 0a20 2020  oordinates...   
+0003b060: 2020 2020 2020 2020 2054 6865 2066 6972           The fir
+0003b070: 7374 2061 6e64 2073 6563 6f6e 6420 6172  st and second ar
+0003b080: 6775 6d65 6e74 7320 6172 6520 7468 6520  guments are the 
+0003b090: 6c6f 6361 7469 6f6e 0d0a 2020 2020 2020  location..      
+0003b0a0: 2020 2020 2020 616e 6420 6469 7265 6374        and direct
+0003b0b0: 696f 6e2c 2072 6573 7065 6374 6976 656c  ion, respectivel
+0003b0c0: 792e 0d0a 2020 2020 2020 2020 2020 2020  y...            
+0003b0d0: 5468 6520 6675 6e63 7469 6f6e 2072 6574  The function ret
+0003b0e0: 7572 6e73 2061 204e 756d 7079 2061 7272  urns a Numpy arr
+0003b0f0: 6179 206f 6620 7363 616c 6172 2076 616c  ay of scalar val
+0003b100: 7565 732e 0d0a 0d0a 2020 2020 2020 2020  ues.....        
+0003b110: 636d 6170 203a 2073 7472 206f 7220 436f  cmap : str or Co
+0003b120: 6c6f 726d 6170 2c20 6f70 7469 6f6e 616c  lormap, optional
+0003b130: 0d0a 2020 2020 2020 2020 2020 2020 4120  ..            A 
+0003b140: 436f 6c6f 726d 6170 2069 6e73 7461 6e63  Colormap instanc
+0003b150: 6520 6f72 2072 6567 6973 7465 7265 6420  e or registered 
+0003b160: 636f 6c6f 726d 6170 206e 616d 652e 0d0a  colormap name...
+0003b170: 2020 2020 2020 2020 2020 2020 4966 206e              If n
+0003b180: 6f74 2061 7373 6967 6e65 642c 2074 6865  ot assigned, the
+0003b190: 2073 7572 6661 6365 2043 6f6c 6f72 6d61   surface Colorma
+0003b1a0: 7020 6973 2075 7365 642e 0d0a 2020 2020  p is used...    
+0003b1b0: 2020 2020 2020 2020 5468 6520 636f 6c6f          The colo
+0003b1c0: 726d 6170 206d 6170 7320 7468 6520 6675  rmap maps the fu
+0003b1d0: 6e63 7469 6f6e 2072 6574 7572 6e20 7661  nction return va
+0003b1e0: 6c75 6573 2074 6f20 636f 6c6f 7273 2e0d  lues to colors..
+0003b1f0: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+0003b200: 2020 2052 6574 7572 6e73 0d0a 2020 2020     Returns..    
+0003b210: 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020      -------..   
+0003b220: 2020 2020 2073 656c 6620 3a20 5665 6374       self : Vect
+0003b230: 6f72 3344 436f 6c6c 6563 7469 6f6e 206f  or3DCollection o
+0003b240: 626a 6563 740d 0a0d 0a20 2020 2020 2020  bject....       
+0003b250: 2022 2222 0d0a 2020 2020 2020 2020 0d0a   """..        ..
+0003b260: 2020 2020 2020 2020 6966 2063 6d61 7020          if cmap 
+0003b270: 6973 206e 6f74 204e 6f6e 6520 3a0d 0a20  is not None :.. 
+0003b280: 2020 2020 2020 2020 2020 2069 6620 6973             if is
+0003b290: 696e 7374 616e 6365 2863 6d61 702c 7374  instance(cmap,st
+0003b2a0: 7229 203a 200d 0a20 2020 2020 2020 2020  r) : ..         
+0003b2b0: 2020 2020 2020 2073 656c 662e 7365 745f         self.set_
+0003b2c0: 636d 6170 2863 6d2e 6765 745f 636d 6170  cmap(cm.get_cmap
+0003b2d0: 2863 6d61 7029 290d 0a20 2020 2020 2020  (cmap))..       
+0003b2e0: 2020 2020 2065 6c73 6520 3a0d 0a20 2020       else :..   
+0003b2f0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0003b300: 662e 7365 745f 636d 6170 2863 6d61 7029  f.set_cmap(cmap)
+0003b310: 0d0a 2020 2020 2020 2020 636d 5f63 6f6c  ..        cm_col
+0003b320: 6f72 4d61 7020 3d20 7365 6c66 2e67 6574  orMap = self.get
+0003b330: 5f63 6d61 7028 290d 0a0d 0a20 2020 2020  _cmap()....     
+0003b340: 2020 2078 797a 203d 206e 702e 7472 616e     xyz = np.tran
+0003b350: 7370 6f73 6528 7365 6c66 2e6c 6f63 6174  spose(self.locat
+0003b360: 696f 6e29 0d0a 2020 2020 2020 2020 7576  ion)..        uv
+0003b370: 7720 3d20 6e70 2e74 7261 6e73 706f 7365  w = np.transpose
+0003b380: 2873 656c 662e 7665 6374 290d 0a20 2020  (self.vect)..   
+0003b390: 2020 2020 2023 202e 2e2e 2e2e 0d0a 2020       # .......  
+0003b3a0: 2020 2020 2020 7620 3d20 6e70 2e61 7272        v = np.arr
+0003b3b0: 6179 286f 7065 7261 7469 6f6e 2878 797a  ay(operation(xyz
+0003b3c0: 2c75 7677 2929 0d0a 2020 2020 2020 2020  ,uvw))..        
+0003b3d0: 6e6f 726d 203d 2063 6f6c 6f72 732e 4e6f  norm = colors.No
+0003b3e0: 726d 616c 697a 6528 766d 696e 3d76 2e6d  rmalize(vmin=v.m
+0003b3f0: 696e 2829 2c76 6d61 783d 762e 6d61 7828  in(),vmax=v.max(
+0003b400: 2929 0d0a 2020 2020 2020 2020 636f 6c6f  ))..        colo
+0003b410: 7220 3d20 636d 5f63 6f6c 6f72 4d61 7028  r = cm_colorMap(
+0003b420: 6e6f 726d 2876 2929 0d0a 2020 2020 2020  norm(v))..      
+0003b430: 2020 7365 6c66 2e5f 7365 745f 7665 6374    self._set_vect
+0003b440: 436f 6c6f 7228 636f 6c6f 7229 0d0a 2020  Color(color)..  
+0003b450: 2020 2020 2020 636e 616d 6520 3d20 5f67        cname = _g
+0003b460: 6574 4675 6e63 7469 6f6e 4e61 6d65 286f  etFunctionName(o
+0003b470: 7065 7261 7469 6f6e 2c63 6e61 6d65 290d  peration,cname).
+0003b480: 0a20 2020 2020 2020 2069 6620 636e 616d  .        if cnam
+0003b490: 6520 6973 206e 6f74 204e 6f6e 653a 2073  e is not None: s
+0003b4a0: 656c 662e 7661 6c75 6573 4e61 6d65 203d  elf.valuesName =
+0003b4b0: 2063 6e61 6d65 0d0a 2020 2020 2020 2020   cname..        
+0003b4c0: 7365 6c66 2e5f 626f 756e 6473 5b27 766c  self._bounds['vl
+0003b4d0: 696d 275d 203d 205b 2076 2e6d 696e 2829  im'] = [ v.min()
+0003b4e0: 2c20 762e 6d61 7828 2920 5d0d 0a0d 0a20  , v.max() ].... 
+0003b4f0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0003b500: 6c66 0d0a 0d0a 2020 2020 6465 6620 6d61  lf....    def ma
+0003b510: 705f 636d 6170 5f66 726f 6d5f 6d61 676e  p_cmap_from_magn
+0003b520: 6974 7564 6528 2073 656c 662c 2063 6d61  itude( self, cma
+0003b530: 703d 4e6f 6e65 2c20 636e 616d 653d 4e6f  p=None, cname=No
+0003b540: 6e65 2029 203a 0d0a 2020 2020 2020 2020  ne ) :..        
+0003b550: 2222 220d 0a20 2020 2020 2020 2056 6563  """..        Vec
+0003b560: 746f 7220 636f 6c6f 7220 6173 7369 676e  tor color assign
+0003b570: 6d65 6e74 2075 7369 6e67 2076 6563 746f  ment using vecto
+0003b580: 7220 6d61 676e 6974 7564 652e 0d0a 0d0a  r magnitude.....
+0003b590: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+0003b5a0: 7273 0d0a 2020 2020 2020 2020 2d2d 2d2d  rs..        ----
+0003b5b0: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
+0003b5c0: 636d 6170 203a 2073 7472 206f 7220 436f  cmap : str or Co
+0003b5d0: 6c6f 726d 6170 2c20 6f70 7469 6f6e 616c  lormap, optional
+0003b5e0: 2c20 6465 6661 756c 743a 2027 7669 7269  , default: 'viri
+0003b5f0: 6469 7327 0d0a 2020 2020 2020 2020 2020  dis'..          
+0003b600: 2020 4120 436f 6c6f 726d 6170 2069 6e73    A Colormap ins
+0003b610: 7461 6e63 6520 6f72 2072 6567 6973 7465  tance or registe
+0003b620: 7265 6420 636f 6c6f 726d 6170 206e 616d  red colormap nam
+0003b630: 652e 0d0a 2020 2020 2020 2020 2020 2020  e...            
+0003b640: 4966 206e 6f74 2061 7373 6967 6e65 642c  If not assigned,
+0003b650: 2074 6865 2073 7572 6661 6365 2043 6f6c   the surface Col
+0003b660: 6f72 6d61 7020 6973 2075 7365 642e 0d0a  ormap is used...
+0003b670: 2020 2020 2020 2020 2020 2020 5468 6520              The 
+0003b680: 636f 6c6f 726d 6170 206d 6170 7320 7468  colormap maps th
+0003b690: 6520 646f 7420 7072 6f64 7563 7420 7661  e dot product va
+0003b6a0: 6c75 6573 2074 6f20 636f 6c6f 7273 2e0d  lues to colors..
+0003b6b0: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+0003b6c0: 2020 2052 6574 7572 6e73 0d0a 2020 2020     Returns..    
+0003b6d0: 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020      -------..   
+0003b6e0: 2020 2020 2073 656c 6620 3a20 5665 6374       self : Vect
+0003b6f0: 6f72 3344 436f 6c6c 6563 7469 6f6e 206f  or3DCollection o
+0003b700: 626a 6563 740d 0a0d 0a20 2020 2020 2020  bject....       
+0003b710: 2022 2222 0d0a 0d0a 2020 2020 2020 2020   """....        
+0003b720: 6966 2063 6d61 7020 6973 206e 6f74 204e  if cmap is not N
+0003b730: 6f6e 6520 3a0d 0a20 2020 2020 2020 2020  one :..         
+0003b740: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+0003b750: 2863 6d61 702c 7374 7229 203a 200d 0a20  (cmap,str) : .. 
+0003b760: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0003b770: 656c 662e 7365 745f 636d 6170 2863 6d2e  elf.set_cmap(cm.
+0003b780: 6765 745f 636d 6170 2863 6d61 7029 290d  get_cmap(cmap)).
+0003b790: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+0003b7a0: 6520 3a0d 0a20 2020 2020 2020 2020 2020  e :..           
+0003b7b0: 2020 2020 2073 656c 662e 7365 745f 636d       self.set_cm
+0003b7c0: 6170 2863 6d61 7029 0d0a 2020 2020 2020  ap(cmap)..      
+0003b7d0: 2020 636d 5f63 6f6c 6f72 4d61 7020 3d20    cm_colorMap = 
+0003b7e0: 7365 6c66 2e67 6574 5f63 6d61 7028 290d  self.get_cmap().
+0003b7f0: 0a0d 0a20 2020 2020 2020 206d 6167 203d  ...        mag =
+0003b800: 206e 702e 6c69 6e61 6c67 2e6e 6f72 6d28   np.linalg.norm(
+0003b810: 7365 6c66 2e76 6563 742c 6178 6973 3d31  self.vect,axis=1
+0003b820: 290d 0a20 2020 2020 2020 206e 6f72 6d20  )..        norm 
+0003b830: 3d20 636f 6c6f 7273 2e4e 6f72 6d61 6c69  = colors.Normali
+0003b840: 7a65 2876 6d69 6e3d 6d61 672e 6d69 6e28  ze(vmin=mag.min(
+0003b850: 292c 766d 6178 3d6d 6167 2e6d 6178 2829  ),vmax=mag.max()
+0003b860: 290d 0a20 2020 2020 2020 2063 6f6c 6f72  )..        color
+0003b870: 203d 2063 6d5f 636f 6c6f 724d 6170 286e   = cm_colorMap(n
+0003b880: 6f72 6d28 6d61 6729 290d 0a20 2020 2020  orm(mag))..     
+0003b890: 2020 2073 656c 662e 5f73 6574 5f76 6563     self._set_vec
+0003b8a0: 7443 6f6c 6f72 2863 6f6c 6f72 290d 0a20  tColor(color).. 
+0003b8b0: 2020 2020 2020 2073 656c 662e 636e 616d         self.cnam
+0003b8c0: 6520 3d20 636e 616d 650d 0a20 2020 2020  e = cname..     
+0003b8d0: 2020 2069 6620 636e 616d 6520 6973 204e     if cname is N
+0003b8e0: 6f6e 653a 2073 656c 662e 636e 616d 6520  one: self.cname 
+0003b8f0: 3d20 274d 6167 6e69 7475 6465 270d 0a20  = 'Magnitude'.. 
+0003b900: 2020 2020 2020 2073 656c 662e 5f62 6f75         self._bou
+0003b910: 6e64 735b 2776 6572 7476 6c69 6d27 5d20  nds['vertvlim'] 
+0003b920: 3d20 5b20 6d61 672e 6d69 6e28 292c 206d  = [ mag.min(), m
+0003b930: 6167 2e6d 6178 2829 205d 0d0a 0d0a 2020  ag.max() ]....  
+0003b940: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0003b950: 660d 0a20 2020 200d 0a20 2020 2064 6566  f..    ..    def
+0003b960: 206d 6170 5f63 6d61 705f 6672 6f6d 5f64   map_cmap_from_d
+0003b970: 6972 6563 7469 6f6e 2820 7365 6c66 2c20  irection( self, 
+0003b980: 636d 6170 3d4e 6f6e 652c 2064 6972 6563  cmap=None, direc
+0003b990: 7469 6f6e 3d5b 312c 312c 315d 2c20 636e  tion=[1,1,1], cn
+0003b9a0: 616d 653d 4e6f 6e65 2029 203a 0d0a 2020  ame=None ) :..  
+0003b9b0: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
+0003b9c0: 2020 2056 6563 746f 7220 636f 6c6f 7220     Vector color 
+0003b9d0: 6173 7369 676e 6d65 6e74 2075 7369 6e67  assignment using
+0003b9e0: 2076 6563 746f 7220 6469 7265 6374 696f   vector directio
+0003b9f0: 6e20 7265 6c61 7469 7665 2074 6f20 6469  n relative to di
+0003ba00: 7265 6374 696f 6e20 6172 6775 6d65 6e74  rection argument
+0003ba10: 2e0d 0a0d 0a20 2020 2020 2020 2054 6865  .....        The
+0003ba20: 2064 6f74 2070 726f 6475 6374 206f 6620   dot product of 
+0003ba30: 7665 6374 6f72 2064 6972 6563 7469 6f6e  vector direction
+0003ba40: 2077 6974 6820 7468 6520 6172 6775 6d65   with the argume
+0003ba50: 6e74 2064 6972 6563 7469 6f6e 200d 0a20  nt direction .. 
+0003ba60: 2020 2020 2020 2069 7320 7573 6564 2074         is used t
+0003ba70: 6f20 6173 7369 676e 2076 6563 746f 7220  o assign vector 
+0003ba80: 636f 6c6f 7273 2066 726f 6d20 6120 636f  colors from a co
+0003ba90: 6c6f 726d 6170 2e0d 0a0d 0a20 2020 2020  lormap.....     
+0003baa0: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
+0003bab0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+0003bac0: 2d0d 0a20 2020 2020 2020 2063 6d61 7020  -..        cmap 
+0003bad0: 3a20 7374 7220 6f72 2043 6f6c 6f72 6d61  : str or Colorma
+0003bae0: 702c 206f 7074 696f 6e61 6c2c 2064 6566  p, optional, def
+0003baf0: 6175 6c74 3a20 2776 6972 6964 6973 270d  ault: 'viridis'.
+0003bb00: 0a20 2020 2020 2020 2020 2020 2041 2043  .            A C
+0003bb10: 6f6c 6f72 6d61 7020 696e 7374 616e 6365  olormap instance
+0003bb20: 206f 7220 7265 6769 7374 6572 6564 2063   or registered c
+0003bb30: 6f6c 6f72 6d61 7020 6e61 6d65 2e0d 0a20  olormap name... 
+0003bb40: 2020 2020 2020 2020 2020 2049 6620 6e6f             If no
+0003bb50: 7420 6173 7369 676e 6564 2c20 7468 6520  t assigned, the 
+0003bb60: 7375 7266 6163 6520 436f 6c6f 726d 6170  surface Colormap
+0003bb70: 2069 7320 7573 6564 2e0d 0a20 2020 2020   is used...     
+0003bb80: 2020 2020 2020 2054 6865 2063 6f6c 6f72         The color
+0003bb90: 6d61 7020 6d61 7073 2074 6865 2064 6f74  map maps the dot
+0003bba0: 2070 726f 6475 6374 2076 616c 7565 7320   product values 
+0003bbb0: 746f 2063 6f6c 6f72 732e 0d0a 2020 2020  to colors...    
+0003bbc0: 2020 2020 0d0a 2020 2020 2020 2020 6469      ..        di
+0003bbd0: 7265 6374 696f 6e20 3a20 6c69 7374 206f  rection : list o
+0003bbe0: 6620 7369 7a65 2033 2c20 6f70 7469 6f6e  f size 3, option
+0003bbf0: 616c 2c20 6465 6661 756c 743a 205b 312c  al, default: [1,
+0003bc00: 312c 315d 0d0a 2020 2020 2020 2020 2020  1,1]..          
+0003bc10: 2020 4120 3344 2076 6563 746f 7220 696e    A 3D vector in
+0003bc20: 2078 797a 2043 6172 7465 7369 616e 2063   xyz Cartesian c
+0003bc30: 6f6f 7264 696e 6174 6573 2064 6573 6967  oordinates desig
+0003bc40: 6e61 7469 6e67 0d0a 2020 2020 2020 2020  nating..        
+0003bc50: 2020 2020 7468 6520 7265 6665 7265 6e63      the referenc
+0003bc60: 6520 6469 7265 6374 696f 6e2e 0d0a 0d0a  e direction.....
+0003bc70: 2020 2020 2020 2020 7265 6643 6f6f 7220          refCoor 
+0003bc80: 3a20 7374 7269 6e67 2c20 6f70 7469 6f6e  : string, option
+0003bc90: 616c 2c20 6465 6661 756c 743a 2022 5859  al, default: "XY
+0003bca0: 5a22 0d0a 2020 2020 2020 2020 2020 2020  Z"..            
+0003bcb0: 4469 7265 6374 696f 6e20 636f 6f72 6469  Direction coordi
+0003bcc0: 6e61 7465 2073 7973 7465 6d20 666f 7220  nate system for 
+0003bcd0: 7468 6520 6576 616c 7561 7469 6f6e 2e0d  the evaluation..
+0003bce0: 0a20 2020 2020 2020 2020 2020 2028 4e6f  .            (No
+0003bcf0: 7420 696d 706c 696d 656e 7465 6429 0d0a  t implimented)..
+0003bd00: 0d0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+0003bd10: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+0003bd20: 2d2d 0d0a 2020 2020 2020 2020 7365 6c66  --..        self
+0003bd30: 203a 2056 6563 746f 7233 4443 6f6c 6c65   : Vector3DColle
+0003bd40: 6374 696f 6e20 6f62 6a65 6374 0d0a 0d0a  ction object....
+0003bd50: 2020 2020 2020 2020 2222 220d 0a0d 0a20          """.... 
+0003bd60: 2020 2020 2023 2046 7574 4465 763a 2020       # FutDev:  
+0003bd70: 616c 6c6f 7720 696e 7075 7420 6469 7265  allow input dire
+0003bd80: 6374 696f 6e20 746f 2062 6520 696e 206f  ction to be in o
+0003bd90: 7468 6572 2063 6f6f 7220 7379 7374 656d  ther coor system
+0003bda0: 7320 2872 6566 436f 6f72 290d 0a20 2020  s (refCoor)..   
+0003bdb0: 2020 2023 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e     #............
+0003bdc0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0003bdd0: 2e2e 2e2e 2e2e 2e2e 2e20 2020 200d 0a20  .........    .. 
+0003bde0: 2020 2020 2020 2064 6566 2067 6574 436f         def getCo
+0003bdf0: 6c6f 724d 6170 2866 766f 2c63 6d61 702c  lorMap(fvo,cmap,
+0003be00: 2064 6972 6563 7469 6f6e 2920 3a0d 0a20   direction) :.. 
+0003be10: 2020 2020 2020 2020 2020 2075 6e69 7456             unitV
+0003be20: 6563 746f 7220 3d20 6c61 6d62 6461 2076  ector = lambda v
+0003be30: 203a 206e 702e 6469 7669 6465 2820 762c   : np.divide( v,
+0003be40: 206e 702e 6c69 6e61 6c67 2e6e 6f72 6d28   np.linalg.norm(
+0003be50: 7629 2029 0d0a 2020 2020 2020 2020 2020  v) )..          
+0003be60: 2020 696e 6369 6465 6e74 4c69 6768 7420    incidentLight 
+0003be70: 3d20 756e 6974 5665 6374 6f72 2820 6469  = unitVector( di
+0003be80: 7265 6374 696f 6e20 290d 0a20 2020 2020  rection )..     
+0003be90: 2020 2020 2020 2064 203d 206e 702e 646f         d = np.do
+0003bea0: 7428 6676 6f2c 696e 6369 6465 6e74 4c69  t(fvo,incidentLi
+0003beb0: 6768 7429 0d0a 2020 2020 2020 2020 2020  ght)..          
+0003bec0: 2020 7620 3d20 6e70 2e61 6464 2864 2c31    v = np.add(d,1
+0003bed0: 290d 0a20 2020 2020 2020 2020 2020 2076  )..            v
+0003bee0: 203d 206e 702e 6469 7669 6465 2876 2c32   = np.divide(v,2
+0003bef0: 290d 0a20 2020 2020 2020 2020 2020 2076  )..            v
+0003bf00: 203d 206e 702e 6162 7328 7629 0d0a 2020   = np.abs(v)..  
+0003bf10: 2020 2020 2020 2020 2020 6e6f 726d 203d            norm =
+0003bf20: 2063 6f6c 6f72 732e 4e6f 726d 616c 697a   colors.Normaliz
+0003bf30: 6528 766d 696e 3d76 2e6d 696e 2829 2c76  e(vmin=v.min(),v
+0003bf40: 6d61 783d 762e 6d61 7828 2929 0d0a 2020  max=v.max())..  
+0003bf50: 2020 2020 2020 2020 2020 636f 6c6f 724d            colorM
+0003bf60: 6170 203d 2063 6d61 7028 6e6f 726d 2876  ap = cmap(norm(v
+0003bf70: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
+0003bf80: 7365 6c66 2e5f 626f 756e 6473 5b27 7665  self._bounds['ve
+0003bf90: 7274 766c 696d 275d 203d 205b 2076 2e6d  rtvlim'] = [ v.m
+0003bfa0: 696e 2829 2c20 762e 6d61 7828 2920 5d0d  in(), v.max() ].
+0003bfb0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0003bfc0: 7572 6e20 636f 6c6f 724d 6170 0d0a 2020  urn colorMap..  
+0003bfd0: 2020 2020 2020 232e 2e2e 2e2e 2e2e 2e2e        #.........
+0003bfe0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0003bff0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 0d0a 0d0a  ................
+0003c000: 2020 2020 2020 2020 6966 2063 6d61 7020          if cmap 
+0003c010: 6973 206e 6f74 204e 6f6e 6520 3a0d 0a20  is not None :.. 
+0003c020: 2020 2020 2020 2020 2020 2069 6620 6973             if is
+0003c030: 696e 7374 616e 6365 2863 6d61 702c 7374  instance(cmap,st
+0003c040: 7229 203a 200d 0a20 2020 2020 2020 2020  r) : ..         
+0003c050: 2020 2020 2020 2073 656c 662e 7365 745f         self.set_
+0003c060: 636d 6170 2863 6d2e 6765 745f 636d 6170  cmap(cm.get_cmap
+0003c070: 2863 6d61 7029 290d 0a20 2020 2020 2020  (cmap))..       
+0003c080: 2020 2020 2065 6c73 6520 3a0d 0a20 2020       else :..   
+0003c090: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0003c0a0: 662e 7365 745f 636d 6170 2863 6d61 7029  f.set_cmap(cmap)
+0003c0b0: 0d0a 2020 2020 2020 2020 636d 5f63 6f6c  ..        cm_col
+0003c0c0: 6f72 4d61 7020 3d20 7365 6c66 2e67 6574  orMap = self.get
+0003c0d0: 5f63 6d61 7028 290d 0a0d 0a20 2020 2020  _cmap()....     
+0003c0e0: 2020 2063 6f6c 6f72 203d 2067 6574 436f     color = getCo
+0003c0f0: 6c6f 724d 6170 2873 656c 662e 7665 6374  lorMap(self.vect
+0003c100: 2c20 636d 5f63 6f6c 6f72 4d61 702c 2064  , cm_colorMap, d
+0003c110: 6972 6563 7469 6f6e 290d 0a20 2020 2020  irection)..     
+0003c120: 2020 2073 656c 662e 5f73 6574 5f76 6563     self._set_vec
+0003c130: 7443 6f6c 6f72 2863 6f6c 6f72 290d 0a20  tColor(color).. 
+0003c140: 2020 2020 2020 2073 656c 662e 636e 616d         self.cnam
+0003c150: 6520 3d20 636e 616d 650d 0a20 2020 2020  e = cname..     
+0003c160: 2020 2069 6620 636e 616d 6520 6973 204e     if cname is N
+0003c170: 6f6e 653a 2073 656c 662e 636e 616d 6520  one: self.cname 
+0003c180: 3d20 2744 6972 6563 7469 6f6e 270d 0a0d  = 'Direction'...
+0003c190: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0003c1a0: 7365 6c66 0d0a 0d0a 0d0a 0d0a 636c 6173  self........clas
+0003c1b0: 7320 436f 6c6f 724c 696e 6533 4443 6f6c  s ColorLine3DCol
+0003c1c0: 6c65 6374 696f 6e28 4c69 6e65 3344 436f  lection(Line3DCo
+0003c1d0: 6c6c 6563 7469 6f6e 2920 3a0d 0a20 2020  llection) :..   
+0003c1e0: 2022 2222 0d0a 2020 2020 4261 7365 2063   """..    Base c
+0003c1f0: 6c61 7373 2066 6f72 206e 6f6e 2d75 6e69  lass for non-uni
+0003c200: 666f 726d 6c79 2063 6f6c 6f72 6564 2033  formly colored 3
+0003c210: 4420 6c69 6e65 732e 0d0a 0d0a 2020 2020  D lines.....    
+0003c220: 2222 220d 0a0d 0a20 2020 2023 2046 7574  """....    # Fut
+0003c230: 4465 763a 2054 6869 7320 636c 6173 7320  Dev: This class 
+0003c240: 6c65 6176 6573 2061 206c 6f74 206f 6620  leaves a lot of 
+0003c250: 726f 6f6d 2066 6f72 2069 6d70 726f 7665  room for improve
+0003c260: 6d65 6e74 2e0d 0a20 2020 2023 204e 6565  ment...    # Nee
+0003c270: 6420 6265 7474 6572 2075 7365 206f 6620  d better use of 
+0003c280: 4e75 6d70 7920 616e 6420 6265 7474 6572  Numpy and better
+0003c290: 2061 7070 726f 6163 6820 746f 0d0a 2020   approach to..  
+0003c2a0: 2020 2320 6469 6666 6572 656e 7469 6174    # differentiat
+0003c2b0: 696e 6720 6265 7477 6565 6e20 636f 6c6c  ing between coll
+0003c2c0: 6563 7469 6f6e 732c 206c 696e 6573 2026  ections, lines &
+0003c2d0: 2073 6567 6d65 6e74 730d 0a20 2020 2023   segments..    #
+0003c2e0: 2074 6f20 6163 636f 6d6f 6461 7465 204d   to accomodate M
+0003c2f0: 6174 706c 6f74 2072 656e 6465 7269 6e67  atplot rendering
+0003c300: 2061 6e64 2066 7574 7572 6520 6578 706f   and future expo
+0003c310: 7274 2e20 4d52 4f49 0d0a 0d0a 2020 2020  rt. MROI....    
+0003c320: 4073 7461 7469 636d 6574 686f 640d 0a20  @staticmethod.. 
+0003c330: 2020 2064 6566 206d 6573 6867 7269 6428     def meshgrid(
+0003c340: 582c 592c 5a2c 206e 616d 653d 4e6f 6e65  X,Y,Z, name=None
+0003c350: 2920 3a0d 0a20 2020 2020 2020 2022 2222  ) :..        """
+0003c360: 0d0a 2020 2020 2020 2020 436f 6c6f 724c  ..        ColorL
+0003c370: 696e 6533 4443 6f6c 6c65 6374 696f 6e2c  ine3DCollection,
+0003c380: 2061 2073 6574 206f 6620 7879 2073 6c69   a set of xy sli
+0003c390: 6365 206c 696e 6573 2062 6173 6564 206f  ce lines based o
+0003c3a0: 6e20 6120 6d65 7368 6772 6964 2e0d 0a20  n a meshgrid... 
+0003c3b0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+0003c3c0: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
+0003c3d0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
+0003c3e0: 0a20 2020 2020 2020 2058 2c59 2c5a 203a  .        X,Y,Z :
+0003c3f0: 204e 2078 204d 2061 7272 6179 730d 0a20   N x M arrays.. 
+0003c400: 2020 2020 2020 2020 2020 2043 6172 7465             Carte
+0003c410: 7369 616e 2078 2c79 2c7a 2063 6f6f 7264  sian x,y,z coord
+0003c420: 696e 6174 6520 7661 6c75 6573 2e0d 0a0d  inate values....
+0003c430: 0a20 2020 2020 2020 206e 616d 6520 3a20  .        name : 
+0003c440: 7374 7269 6e67 2c20 6f70 7469 6f6e 616c  string, optional
+0003c450: 2c20 6465 6661 756c 743a 204e 6f6e 652e  , default: None.
+0003c460: 0d0a 2020 2020 2020 2020 2020 2020 4465  ..            De
+0003c470: 7363 7269 7074 6976 6520 6964 656e 7469  scriptive identi
+0003c480: 6669 6572 2066 6f72 2074 6865 206d 6573  fier for the mes
+0003c490: 6820 7375 7266 6163 652e 0d0a 0d0a 2020  h surface.....  
+0003c4a0: 2020 2020 2020 5265 7475 726e 730d 0a20        Returns.. 
+0003c4b0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0d0a         -------..
+0003c4c0: 2020 2020 2020 2020 7375 7266 6163 6520          surface 
+0003c4d0: 3a20 436f 6c6f 724c 696e 6533 4443 6f6c  : ColorLine3DCol
+0003c4e0: 6c65 6374 696f 6e20 6f62 6a65 6374 0d0a  lection object..
+0003c4f0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+0003c500: 2020 2222 220d 0a0d 0a20 2020 2020 2020    """....       
+0003c510: 2023 204e 6565 6473 2063 6c65 616e 7570   # Needs cleanup
+0003c520: 204d 524f 490d 0a20 2020 2020 2020 2078   MROI..        x
+0003c530: 5f6c 696e 6556 6572 7473 5074 7320 3d20  _lineVertsPts = 
+0003c540: 6e70 2e61 7272 6179 2858 295b 305d 0d0a  np.array(X)[0]..
+0003c550: 2020 2020 2020 2020 795f 6c69 6e65 5665          y_lineVe
+0003c560: 7274 7350 7473 203d 206e 702e 6172 7261  rtsPts = np.arra
+0003c570: 7928 5929 5b3a 2c30 5d0d 0a20 2020 2020  y(Y)[:,0]..     
+0003c580: 2020 207a 5f6c 696e 6573 203d 206e 702e     z_lines = np.
+0003c590: 6172 7261 7928 5a29 0d0a 2020 2020 2020  array(Z)..      
+0003c5a0: 2020 6e75 6d62 5f58 5f6c 696e 6573 203d    numb_X_lines =
+0003c5b0: 206c 656e 2878 5f6c 696e 6556 6572 7473   len(x_lineVerts
+0003c5c0: 5074 7329 0d0a 2020 2020 2020 2020 6e75  Pts)..        nu
+0003c5d0: 6d62 5f59 5f6c 696e 6573 203d 206c 656e  mb_Y_lines = len
+0003c5e0: 2879 5f6c 696e 6556 6572 7473 5074 7329  (y_lineVertsPts)
+0003c5f0: 0d0a 2020 2020 2020 2020 696e 6469 6365  ..        indice
+0003c600: 7320 3d20 5b4e 6f6e 655d 2a28 206e 756d  s = [None]*( num
+0003c610: 625f 585f 6c69 6e65 7320 2b20 6e75 6d62  b_X_lines + numb
+0003c620: 5f59 5f6c 696e 6573 2029 0d0a 2020 2020  _Y_lines )..    
+0003c630: 2020 2020 696e 6465 7820 3d20 300d 0a0d      index = 0...
+0003c640: 0a20 2020 2020 2020 2076 6572 7473 203d  .        verts =
+0003c650: 205b 5d0d 0a20 2020 2020 2020 2023 202e   []..        # .
+0003c660: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0003c670: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0003c680: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0003c690: 2e0d 0a20 2020 2020 2020 206e 756d 5665  ...        numVe
+0003c6a0: 7274 7320 3d20 6e75 6d62 5f59 5f6c 696e  rts = numb_Y_lin
+0003c6b0: 6573 0d0a 2020 2020 2020 2020 6c69 6e65  es..        line
+0003c6c0: 5665 7274 7350 7473 203d 2079 5f6c 696e  VertsPts = y_lin
+0003c6d0: 6556 6572 7473 5074 730d 0a20 2020 2020  eVertsPts..     
+0003c6e0: 2020 207a 5f58 5f6c 696e 6573 203d 207a     z_X_lines = z
+0003c6f0: 5f6c 696e 6573 0d0a 2020 2020 2020 2020  _lines..        
+0003c700: 666f 7220 6958 2069 6e20 7261 6e67 6528  for iX in range(
+0003c710: 6e75 6d62 5f58 5f6c 696e 6573 2920 3a0d  numb_X_lines) :.
+0003c720: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+0003c730: 2069 5920 696e 2072 616e 6765 286e 756d   iY in range(num
+0003c740: 5665 7274 7329 203a 0d0a 2020 2020 2020  Verts) :..      
+0003c750: 2020 2020 2020 2020 2020 7665 7274 732e            verts.
+0003c760: 6170 7065 6e64 2820 5b20 785f 6c69 6e65  append( [ x_line
+0003c770: 5665 7274 7350 7473 5b69 585d 202c 206c  VertsPts[iX] , l
+0003c780: 696e 6556 6572 7473 5074 735b 6959 5d2c  ineVertsPts[iY],
+0003c790: 207a 5f58 5f6c 696e 6573 5b69 592c 6958   z_X_lines[iY,iX
+0003c7a0: 5d20 5d29 0d0a 0d0a 2020 2020 2020 2020  ] ])....        
+0003c7b0: 666f 7220 6920 696e 2072 616e 6765 2830  for i in range(0
+0003c7c0: 2c6e 756d 625f 585f 6c69 6e65 7329 203a  ,numb_X_lines) :
+0003c7d0: 0d0a 2020 2020 2020 2020 2020 2020 696e  ..            in
+0003c7e0: 6469 6365 735b 695d 203d 205b 4e6f 6e65  dices[i] = [None
+0003c7f0: 5d2a 286e 756d 5665 7274 7329 0d0a 2020  ]*(numVerts)..  
+0003c800: 2020 2020 2020 2020 2020 666f 7220 6a20            for j 
+0003c810: 696e 2072 616e 6765 286e 756d 5665 7274  in range(numVert
+0003c820: 7329 203a 0d0a 2020 2020 2020 2020 2020  s) :..          
+0003c830: 2020 2020 2020 696e 6469 6365 735b 695d        indices[i]
+0003c840: 5b6a 5d20 3d20 696e 6465 780d 0a20 2020  [j] = index..   
+0003c850: 2020 2020 2020 2020 2020 2020 2069 6e64               ind
+0003c860: 6578 202b 3d20 310d 0a20 2020 2020 2020  ex += 1..       
+0003c870: 2023 202e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e   # .............
+0003c880: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0003c890: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0003c8a0: 2e2e 2e2e 2e0d 0a20 2020 2020 2020 206e  .......        n
+0003c8b0: 756d 5665 7274 7320 3d20 6e75 6d62 5f58  umVerts = numb_X
+0003c8c0: 5f6c 696e 6573 0d0a 2020 2020 2020 2020  _lines..        
+0003c8d0: 6c69 6e65 5665 7274 7350 7473 203d 2078  lineVertsPts = x
+0003c8e0: 5f6c 696e 6556 6572 7473 5074 730d 0a20  _lineVertsPts.. 
+0003c8f0: 2020 2020 2020 207a 5f59 5f6c 696e 6573         z_Y_lines
+0003c900: 203d 207a 5f6c 696e 6573 0d0a 2020 2020   = z_lines..    
+0003c910: 2020 2020 666f 7220 6959 2069 6e20 7261      for iY in ra
+0003c920: 6e67 6528 6e75 6d62 5f59 5f6c 696e 6573  nge(numb_Y_lines
+0003c930: 2920 3a0d 0a20 2020 2020 2020 2020 2020  ) :..           
+0003c940: 2066 6f72 2069 5820 696e 2072 616e 6765   for iX in range
+0003c950: 286e 756d 5665 7274 7329 203a 0d0a 2020  (numVerts) :..  
+0003c960: 2020 2020 2020 2020 2020 2020 2020 7665                ve
+0003c970: 7274 732e 6170 7065 6e64 2820 5b20 206c  rts.append( [  l
+0003c980: 696e 6556 6572 7473 5074 735b 6958 5d2c  ineVertsPts[iX],
+0003c990: 2079 5f6c 696e 6556 6572 7473 5074 735b   y_lineVertsPts[
+0003c9a0: 6959 5d20 2c7a 5f59 5f6c 696e 6573 5b69  iY] ,z_Y_lines[i
+0003c9b0: 592c 6958 5d20 5d29 0d0a 0d0a 2020 2020  Y,iX] ])....    
+0003c9c0: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
+0003c9d0: 6765 286e 756d 625f 585f 6c69 6e65 732c  ge(numb_X_lines,
+0003c9e0: 6e75 6d62 5f58 5f6c 696e 6573 2b6e 756d  numb_X_lines+num
+0003c9f0: 625f 595f 6c69 6e65 7329 203a 0d0a 2020  b_Y_lines) :..  
+0003ca00: 2020 2020 2020 2020 2020 696e 6469 6365            indice
+0003ca10: 735b 695d 203d 205b 4e6f 6e65 5d2a 286e  s[i] = [None]*(n
+0003ca20: 756d 5665 7274 7329 0d0a 2020 2020 2020  umVerts)..      
+0003ca30: 2020 2020 2020 666f 7220 6a20 696e 2072        for j in r
+0003ca40: 616e 6765 286e 756d 5665 7274 7329 203a  ange(numVerts) :
+0003ca50: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0003ca60: 2020 696e 6469 6365 735b 695d 5b6a 5d20    indices[i][j] 
+0003ca70: 3d20 696e 6465 780d 0a20 2020 2020 2020  = index..       
+0003ca80: 2020 2020 2020 2020 2069 6e64 6578 202b           index +
+0003ca90: 3d20 310d 0a0d 0a20 2020 2020 2020 2076  = 1....        v
+0003caa0: 6572 7473 203d 206e 702e 6172 7261 7928  erts = np.array(
+0003cab0: 7665 7274 7329 0d0a 0d0a 2020 2020 2020  verts)....      
+0003cac0: 2020 7265 7475 726e 2043 6f6c 6f72 4c69    return ColorLi
+0003cad0: 6e65 3344 436f 6c6c 6563 7469 6f6e 2876  ne3DCollection(v
+0003cae0: 6572 7473 2c69 6e64 6963 6573 2c6e 616d  erts,indices,nam
+0003caf0: 653d 6e61 6d65 290d 0a0d 0a20 2020 2064  e=name)....    d
+0003cb00: 6566 205f 5f69 6e69 745f 5f28 7365 6c66  ef __init__(self
+0003cb10: 2c20 7665 7274 6578 436f 6f72 2c20 7365  , vertexCoor, se
+0003cb20: 676d 496e 6469 6365 732c 206e 616d 653d  gmIndices, name=
+0003cb30: 4e6f 6e65 2c20 2a2a 6b77 6172 6773 2920  None, **kwargs) 
+0003cb40: 3a0d 0a20 2020 2020 2020 2022 2222 0d0a  :..        """..
+0003cb50: 2020 2020 2020 2020 4120 7365 7420 3344          A set 3D
+0003cb60: 206c 696e 6573 2c20 6561 6368 206c 696e   lines, each lin
+0003cb70: 6520 7769 7468 2061 2076 6172 7969 6e67  e with a varying
+0003cb80: 206e 756d 6265 7220 6f66 2073 6571 7565   number of seque
+0003cb90: 6e74 6961 6c20 7665 7274 6963 6573 2e0d  ntial vertices..
+0003cba0: 0a0d 0a20 2020 2020 2020 2050 6172 616d  ...        Param
+0003cbb0: 6574 6572 730d 0a20 2020 2020 2020 202d  eters..        -
+0003cbc0: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
+0003cbd0: 2020 2076 6572 7465 7843 6f6f 7220 3a20     vertexCoor : 
+0003cbe0: 5620 7820 3320 666c 6f61 7420 6172 7261  V x 3 float arra
+0003cbf0: 792d 6c69 6b65 200d 0a20 2020 2020 2020  y-like ..       
+0003cc00: 2020 2020 2041 6e20 6172 7261 7920 6f66       An array of
+0003cc10: 2056 206e 756d 6265 7220 6f66 2078 797a   V number of xyz
+0003cc20: 2076 6572 7465 7820 636f 6f72 6469 6e61   vertex coordina
+0003cc30: 7465 732e 0d0a 0d0a 2020 2020 2020 2020  tes.....        
+0003cc40: 7365 676d 496e 6469 6365 7320 3a20 4c20  segmIndices : L 
+0003cc50: 7820 4e6c 2069 6e74 206c 6973 740d 0a20  x Nl int list.. 
+0003cc60: 2020 2020 2020 2020 2020 2041 6e20 6c69             An li
+0003cc70: 7374 206f 6620 4c20 6e75 6d62 6572 206f  st of L number o
+0003cc80: 6620 4e6c 206c 696e 6520 7665 7274 6578  f Nl line vertex
+0003cc90: 2069 6e64 6963 6573 2c20 7768 6572 650d   indices, where.
+0003cca0: 0a20 2020 2020 2020 2020 2020 204e 6c20  .            Nl 
+0003ccb0: 6973 2074 6865 206e 756d 6265 7220 6f66  is the number of
+0003ccc0: 2076 6572 7469 6365 7320 666f 7220 7468   vertices for th
+0003ccd0: 6520 4c74 6820 6c69 6e65 2e0d 0a0d 0a20  e Lth line..... 
+0003cce0: 2020 2020 2020 206e 616d 6520 3a20 7374         name : st
+0003ccf0: 7269 6e67 2c20 6f70 7469 6f6e 616c 2c20  ring, optional, 
+0003cd00: 6465 6661 756c 743a 204e 6f6e 652e 0d0a  default: None...
+0003cd10: 2020 2020 2020 2020 2020 2020 4465 7363              Desc
+0003cd20: 7269 7074 6976 6520 6964 656e 7469 6669  riptive identifi
+0003cd30: 6572 2e0d 0a0d 0a20 2020 2020 2020 204f  er.....        O
+0003cd40: 7468 6572 2050 6172 616d 6574 6572 730d  ther Parameters.
+0003cd50: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0003cd60: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
+0003cd70: 2020 202a 2a6b 7761 7267 730d 0a20 2020     **kwargs..   
+0003cd80: 2020 2020 2020 2020 2041 6c6c 206f 7468           All oth
+0003cd90: 6572 2070 6172 616d 6574 6572 7320 6172  er parameters ar
+0003cda0: 6520 7061 7373 6564 206f 6e20 746f 206d  e passed on to m
+0003cdb0: 706c 5f74 6f6f 6c6b 6974 732e 6d70 6c6f  pl_toolkits.mplo
+0003cdc0: 7433 642e 6172 7433 642e 4c69 6e65 3344  t3d.art3d.Line3D
+0003cdd0: 436f 6c6c 6563 7469 6f6e 2e0d 0a20 2020  Collection...   
+0003cde0: 2020 2020 2020 2020 2056 616c 6964 206b           Valid k
+0003cdf0: 6579 776f 7264 7320 696e 636c 7564 653a  eywords include:
+0003ce00: 2063 6f6c 6f72 732c 206c 696e 6577 6964   colors, linewid
+0003ce10: 7468 732e 0d0a 2020 2020 2020 2020 0d0a  ths...        ..
+0003ce20: 2020 2020 2020 2020 2222 220d 0a0d 0a20          """.... 
+0003ce30: 2020 2020 2020 2073 656c 662e 7665 7274         self.vert
+0003ce40: 6578 436f 6f72 203d 206e 702e 6172 7261  exCoor = np.arra
+0003ce50: 7928 7665 7274 6578 436f 6f72 2c64 7479  y(vertexCoor,dty
+0003ce60: 7065 3d66 6c6f 6174 290d 0a0d 0a20 2020  pe=float)....   
+0003ce70: 2020 2020 2069 6620 7365 676d 496e 6469       if segmIndi
+0003ce80: 6365 7320 6973 204e 6f6e 6520 3a0d 0a20  ces is None :.. 
+0003ce90: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0003cea0: 6c69 6e65 496e 6469 6365 7320 3d20 5b20  lineIndices = [ 
+0003ceb0: 5b2a 7261 6e67 6528 6c65 6e28 7665 7274  [*range(len(vert
+0003cec0: 6578 436f 6f72 2929 5d20 5d0d 0a0d 0a20  exCoor))] ].... 
+0003ced0: 2020 2020 2020 2020 2020 206c 696e 6573             lines
+0003cee0: 6567 7320 3d20 7365 6c66 2e6c 696e 6549  egs = self.lineI
+0003cef0: 6e64 6963 6573 0d0a 2020 2020 2020 2020  ndices..        
+0003cf00: 2020 2020 696e 6469 6365 7320 3d20 5b5d      indices = []
+0003cf10: 0d0a 2020 2020 2020 2020 2020 2020 666f  ..            fo
+0003cf20: 7220 6c69 6e65 2069 6e20 6c69 6e65 7365  r line in linese
+0003cf30: 6773 203a 0d0a 2020 2020 2020 2020 2020  gs :..          
+0003cf40: 2020 2020 2020 6e75 6d53 6567 7320 3d20        numSegs = 
+0003cf50: 6c65 6e28 6c69 6e65 2920 2d20 310d 0a20  len(line) - 1.. 
+0003cf60: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0003cf70: 6f72 2073 6567 2069 6e20 7261 6e67 6520  or seg in range 
+0003cf80: 286e 756d 5365 6773 2920 3a0d 0a20 2020  (numSegs) :..   
+0003cf90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003cfa0: 2074 203d 205b 206c 696e 655b 7365 675d   t = [ line[seg]
+0003cfb0: 2c6c 696e 655b 7365 672b 315d 205d 0d0a  ,line[seg+1] ]..
+0003cfc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003cfd0: 2020 2020 696e 6469 6365 732e 6170 7065      indices.appe
+0003cfe0: 6e64 2874 290d 0a20 2020 2020 2020 2020  nd(t)..         
+0003cff0: 2020 2073 656c 662e 7365 676d 496e 6469     self.segmIndi
+0003d000: 6365 7320 3d20 696e 6469 6365 730d 0a0d  ces = indices...
+0003d010: 0a20 2020 2020 2020 2065 6c73 6520 3a20  .        else : 
+0003d020: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+0003d030: 616c 6c20 696e 6469 6365 7320 6d75 7374  all indices must
+0003d040: 2062 6520 6c69 7374 732c 206e 6f74 206e   be lists, not n
+0003d050: 756d 7079 2061 7272 6179 732e 0d0a 2020  umpy arrays...  
+0003d060: 2020 2020 2020 2020 2020 7365 676d 496e            segmIn
+0003d070: 6469 6365 7320 3d20 6c69 7374 2873 6567  dices = list(seg
+0003d080: 6d49 6e64 6963 6573 290d 0a0d 0a20 2020  mIndices)....   
+0003d090: 2020 2020 2020 2020 2023 2073 6567 6d49           # segmI
+0003d0a0: 6e64 6963 6573 2077 696c 6c20 6265 2073  ndices will be s
+0003d0b0: 6872 6564 6465 6420 666f 7220 616e 7920  hredded for any 
+0003d0c0: 636f 6c6f 7220 6f70 6572 6174 696f 6e0d  color operation.
+0003d0d0: 0a20 2020 2020 2020 2020 2020 2023 2066  .            # f
+0003d0e0: 6f72 6d69 6e67 206d 756c 7469 706c 6520  orming multiple 
+0003d0f0: 7369 6e67 6c65 2073 6567 6d65 6e74 206c  single segment l
+0003d100: 696e 6573 2e0d 0a20 2020 2020 2020 2020  ines...         
+0003d110: 2020 2073 656c 662e 7365 676d 496e 6469     self.segmIndi
+0003d120: 6365 7320 3d20 7365 676d 496e 6469 6365  ces = segmIndice
+0003d130: 732e 636f 7079 2829 0d0a 0d0a 2020 2020  s.copy()....    
+0003d140: 2020 2020 2020 2020 2320 6c69 6e65 496e          # lineIn
+0003d150: 6469 6365 7320 6172 6520 6170 7065 6e64  dices are append
+0003d160: 6564 2066 6f72 2061 6e20 6164 6420 6f70  ed for an add op
+0003d170: 6572 6174 696f 6e2c 0d0a 2020 2020 2020  eration,..      
+0003d180: 2020 2020 2020 2320 7768 6572 6520 6c69        # where li
+0003d190: 6e65 496e 6469 6365 7320 7072 6573 6572  neIndices preser
+0003d1a0: 7665 2069 6e64 6976 6964 7561 6c20 276c  ve individual 'l
+0003d1b0: 696e 6573 2720 6576 656e 2074 686f 7567  ines' even thoug
+0003d1c0: 680d 0a20 2020 2020 2020 2020 2020 2023  h..            #
+0003d1d0: 2061 6c6c 206c 696e 6573 2061 7265 2062   all lines are b
+0003d1e0: 726f 6b65 6e20 696e 746f 2073 696e 676c  roken into singl
+0003d1f0: 6520 7365 676d 656e 7420 6c69 6e65 7320  e segment lines 
+0003d200: 6f6d 6365 2073 6872 6564 6465 642e 0d0a  omce shredded...
+0003d210: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0003d220: 2e6c 696e 6549 6e64 6963 6573 203d 2073  .lineIndices = s
+0003d230: 6567 6d49 6e64 6963 6573 2e63 6f70 7928  egmIndices.copy(
+0003d240: 290d 0a0d 0a20 2020 2020 2020 2073 656c  )....        sel
+0003d250: 662e 6973 5368 7265 6464 6564 203d 2046  f.isShredded = F
+0003d260: 616c 7365 0d0a 0d0a 2020 2020 2020 2020  alse....        
+0003d270: 5320 3d20 7365 6c66 2e73 6567 6d49 6e64  S = self.segmInd
+0003d280: 6963 6573 0d0a 2020 2020 2020 2020 7620  ices..        v 
+0003d290: 3d20 7365 6c66 2e76 6572 7465 7843 6f6f  = self.vertexCoo
+0003d2a0: 720d 0a0d 0a20 2020 2020 2020 2073 6567  r....        seg
+0003d2b0: 6d65 6e74 7320 3d20 5b4e 6f6e 655d 2a6c  ments = [None]*l
+0003d2c0: 656e 2853 290d 0a20 2020 2020 2020 2066  en(S)..        f
+0003d2d0: 6f72 2076 6572 6c69 7374 2069 6e20 7261  or verlist in ra
+0003d2e0: 6e67 6528 6c65 6e28 5329 2920 3a0d 0a20  nge(len(S)) :.. 
+0003d2f0: 2020 2020 2020 2020 2020 2076 6572 4172             verAr
+0003d300: 7220 3d20 5b4e 6f6e 655d 2a6c 656e 2820  r = [None]*len( 
+0003d310: 535b 7665 726c 6973 745d 2029 0d0a 2020  S[verlist] )..  
+0003d320: 2020 2020 2020 2020 2020 666f 7220 7665            for ve
+0003d330: 7249 6e78 2069 6e20 7261 6e67 6528 206c  rInx in range( l
+0003d340: 656e 2820 535b 7665 726c 6973 745d 2029  en( S[verlist] )
+0003d350: 2029 203a 0d0a 2020 2020 2020 2020 2020   ) :..          
+0003d360: 2020 2020 2020 7665 7241 7272 5b76 6572        verArr[ver
+0003d370: 496e 785d 203d 2076 5b20 535b 7665 726c  Inx] = v[ S[verl
+0003d380: 6973 745d 5b76 6572 496e 785d 205d 0d0a  ist][verInx] ]..
+0003d390: 2020 2020 2020 2020 2020 2020 7365 676d              segm
+0003d3a0: 656e 7473 5b76 6572 6c69 7374 5d20 3d20  ents[verlist] = 
+0003d3b0: 7665 7241 7272 0d0a 0d0a 2020 2020 2020  verArr....      
+0003d3c0: 2020 7375 7065 7228 292e 5f5f 696e 6974    super().__init
+0003d3d0: 5f5f 2873 6567 6d65 6e74 732c 202a 2a6b  __(segments, **k
+0003d3e0: 7761 7267 7329 0d0a 2020 2020 2020 2020  wargs)..        
+0003d3f0: 2373 656c 662e 5f67 656f 6d4e 616d 6520  #self._geomName 
+0003d400: 3d20 4e6f 6e65 2020 2020 2320 5265 6475  = None    # Redu
+0003d410: 6e64 616e 7420 6672 6f6d 206e 6578 7420  ndant from next 
+0003d420: 6c69 6e65 2c20 696e 7465 726e 616c 2074  line, internal t
+0003d430: 7261 636b 696e 6720 746f 2064 6574 6572  racking to deter
+0003d440: 6d69 6e65 2069 6620 7365 742e 2e2e 0d0a  mine if set.....
+0003d450: 2020 2020 2020 2020 7365 6c66 2e6e 616d          self.nam
+0003d460: 6520 3d20 6e61 6d65 0d0a 2020 2020 2020  e = name..      
+0003d470: 2020 7365 6c66 2e76 616c 7565 734e 616d    self.valuesNam
+0003d480: 6520 3d20 4e6f 6e65 0d0a 0d0a 2020 2020  e = None....    
+0003d490: 2020 2020 2320 2e2e 2e2e 2e2e 2e2e 2e2e      # ..........
+0003d4a0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0003d4b0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0003d4c0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0003d4d0: 2e2e 2e2e 2e0d 0a20 2020 2020 2020 2073  .......        s
+0003d4e0: 656c 662e 636f 6f72 5479 7065 203d 205f  elf.coorType = _
+0003d4f0: 434f 4f52 5359 535b 2258 595a 225d 0d0a  COORSYS["XYZ"]..
+0003d500: 2020 2020 2020 2020 7365 6c66 2e62 6173          self.bas
+0003d510: 6543 6f6c 6f72 203d 206e 702e 6172 7261  eColor = np.arra
+0003d520: 7928 7365 6c66 2e67 6574 5f63 6f6c 6f72  y(self.get_color
+0003d530: 2829 5b30 5d29 2e66 6c61 7474 656e 2829  ()[0]).flatten()
+0003d540: 2e74 6f6c 6973 7428 290d 0a20 2020 2020  .tolist()..     
+0003d550: 2020 2073 656c 662e 7665 7274 6578 436f     self.vertexCo
+0003d560: 6c6f 7220 3d20 6e70 2e61 7272 6179 2820  lor = np.array( 
+0003d570: 5b20 7365 6c66 2e62 6173 6543 6f6c 6f72  [ self.baseColor
+0003d580: 205d 2029 0d0a 2020 2020 2020 2020 2320   ] )..        # 
+0003d590: 666f 6c6c 6f77 696e 6720 6173 7369 676e  following assign
+0003d5a0: 6564 2077 6865 6e20 7375 7266 6163 6520  ed when surface 
+0003d5b0: 636f 6c6f 7220 6170 706c 6965 6420 7573  color applied us
+0003d5c0: 696e 6720 616e 206f 7065 7261 7469 6f6e  ing an operation
+0003d5d0: 0d0a 2020 2020 2020 2020 7365 6c66 2e76  ..        self.v
+0003d5e0: 6572 7465 7856 616c 7565 7320 3d20 4e6f  ertexValues = No
+0003d5f0: 6e65 0d0a 2020 2020 2020 2020 7365 6c66  ne..        self
+0003d600: 2e73 6567 5661 6c75 6573 203d 204e 6f6e  .segValues = Non
+0003d610: 650d 0a20 2020 2020 2020 2023 202e 2e2e  e..        # ...
+0003d620: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0003d630: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0003d640: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0003d650: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 0d0a 2020  ..............  
+0003d660: 2020 2020 2020 7365 6c66 2e73 6574 5f6a        self.set_j
+0003d670: 6f69 6e73 7479 6c65 2827 726f 756e 6427  oinstyle('round'
+0003d680: 290d 0a20 2020 2020 2020 2073 656c 662e  )..        self.
+0003d690: 7365 745f 6361 7073 7479 6c65 2827 726f  set_capstyle('ro
+0003d6a0: 756e 6427 290d 0a20 2020 2020 2020 2073  und')..        s
+0003d6b0: 656c 662e 7363 616c 6520 3d20 5b31 2c31  elf.scale = [1,1
+0003d6c0: 2c31 5d20 2020 2020 2020 2020 2020 2020  ,1]             
+0003d6d0: 2020 2020 2020 2020 2023 2066 6f72 2061           # for a
+0003d6e0: 7869 7320 7768 656e 2074 7261 6e73 666f  xis when transfo
+0003d6f0: 726d 6564 2e0d 0a20 2020 2020 2020 2073  rmed...        s
+0003d700: 656c 662e 7472 616e 736c 6174 696f 6e20  elf.translation 
+0003d710: 3d20 5b30 2c30 2c30 5d20 2020 2020 2020  = [0,0,0]       
+0003d720: 2020 2020 2020 2020 2023 2066 6f72 2061           # for a
+0003d730: 7869 7320 7768 656e 2074 7261 6e73 666f  xis when transfo
+0003d740: 726d 6564 2e0d 0a20 2020 2020 2020 2073  rmed...        s
+0003d750: 656c 662e 726f 7461 7469 6f6e 203d 2020  elf.rotation =  
+0003d760: 6e70 2e69 6465 6e74 6974 7928 3329 2e74  np.identity(3).t
+0003d770: 6f6c 6973 7428 2920 2023 2066 6f72 2061  olist()  # for a
+0003d780: 7869 7320 7768 656e 2074 7261 6e73 666f  xis when transfo
+0003d790: 726d 6564 2e0d 0a20 2020 2020 2020 2073  rmed...        s
+0003d7a0: 656c 662e 7265 7374 6f72 6564 436c 6970  elf.restoredClip
+0003d7b0: 203d 204e 6f6e 650d 0a0d 0a20 2020 2020   = None....     
+0003d7c0: 2020 2073 656c 662e 7265 7a20 3d20 4e6f     self.rez = No
+0003d7d0: 6e65 0d0a 2020 2020 2020 2020 7365 6c66  ne..        self
+0003d7e0: 2e5f 626f 756e 6473 203d 207b 7d0d 0a20  ._bounds = {}.. 
+0003d7f0: 2020 2020 2020 2073 656c 662e 5f73 6574         self._set
+0003d800: 5f67 656f 6d65 7472 6963 5f62 6f75 6e64  _geometric_bound
+0003d810: 7328 290d 0a20 2020 2020 2020 2073 656c  s()..        sel
+0003d820: 662e 5f62 6f75 6e64 735b 2776 6c69 6d27  f._bounds['vlim'
+0003d830: 5d20 3d20 2020 2020 5f44 4654 5f56 4c49  ] =     _DFT_VLI
+0003d840: 4d20 0d0a 2020 2020 2020 2020 7365 6c66  M ..        self
+0003d850: 2e5f 626f 756e 6473 5b27 7665 7274 766c  ._bounds['vertvl
+0003d860: 696d 275d 203d 205f 4446 545f 5645 5254  im'] = _DFT_VERT
+0003d870: 564c 494d 0d0a 2020 2020 2020 2020 7365  VLIM..        se
+0003d880: 6c66 2e5f 706c 616e 654e 6f72 6d61 6c20  lf._planeNormal 
+0003d890: 3d20 4e6f 6e65 2020 232e 2e20 7365 7420  = None  #.. set 
+0003d8a0: 666f 7220 706c 616e 6172 2063 6f6e 746f  for planar conto
+0003d8b0: 7572 732c 2066 6f72 2046 7574 4465 760d  urs, for FutDev.
+0003d8c0: 0a0d 0a20 2020 2040 7374 6174 6963 6d65  ...    @staticme
+0003d8d0: 7468 6f64 0d0a 2020 2020 6465 6620 5f6d  thod..    def _m
+0003d8e0: 6964 5665 6374 6f72 4675 6e28 7665 6374  idVectorFun(vect
+0003d8f0: 412c 2076 6563 7442 2920 3a0d 0a20 2020  A, vectB) :..   
+0003d900: 2020 2020 2022 2222 4d69 642d 706f 696e       """Mid-poin
+0003d910: 7420 6265 7477 6565 6e20 7477 6f20 706f  t between two po
+0003d920: 696e 7473 2069 6e20 7468 6520 7879 2070  ints in the xy p
+0003d930: 6c61 6e65 2e22 2222 0d0a 2020 2020 2020  lane."""..      
+0003d940: 2020 6d69 6420 3d20 6e70 2e61 6464 2876    mid = np.add(v
+0003d950: 6563 7441 2c76 6563 7442 290d 0a20 2020  ectA,vectB)..   
+0003d960: 2020 2020 206d 6964 203d 206e 702e 6d75       mid = np.mu
+0003d970: 6c74 6970 6c79 2830 2e35 2c6d 6964 290d  ltiply(0.5,mid).
+0003d980: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0003d990: 6d69 640d 0a0d 0a20 2020 2040 7374 6174  mid....    @stat
+0003d9a0: 6963 6d65 7468 6f64 0d0a 2020 2020 6465  icmethod..    de
+0003d9b0: 6620 5f65 7874 7261 6374 4c69 6e65 7328  f _extractLines(
+0003d9c0: 6c69 6e65 5365 676d 656e 7473 2920 3a0d  lineSegments) :.
+0003d9d0: 0a20 2020 2020 2020 2023 2045 6467 6520  .        # Edge 
+0003d9e0: 6172 7261 7920 736f 7274 696e 6720 746f  array sorting to
+0003d9f0: 206c 696e 6520 6172 7261 7973 2c20 7768   line arrays, wh
+0003da00: 6963 6820 6d61 7920 6265 206c 6f6f 7073  ich may be loops
+0003da10: 2e20 4564 6765 2061 7272 6179 730d 0a20  . Edge arrays.. 
+0003da20: 2020 2020 2020 2023 206d 7573 7420 6861         # must ha
+0003da30: 7665 2074 776f 2069 6e64 6963 6573 2069  ve two indices i
+0003da40: 6e20 636f 6e73 6973 7465 6e74 206f 7264  n consistent ord
+0003da50: 6572 2e0d 0a20 2020 2020 2020 2023 2054  er...        # T
+0003da60: 6869 7320 6973 2061 6e20 2775 6e73 6872  his is an 'unshr
+0003da70: 6564 2720 6675 6e63 7469 6f6e 2e0d 0a20  ed' function... 
+0003da80: 2020 2020 2020 2023 202e 2e2e 2e2e 2e2e         # .......
+0003da90: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0003daa0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0003dab0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0003dac0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e0d 0a20 2020  .............   
+0003dad0: 2020 2020 2064 6566 2065 7874 7261 6374       def extract
+0003dae0: 4c69 6e65 2865 6467 6544 6963 7429 203a  Line(edgeDict) :
+0003daf0: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+0003db00: 7573 6520 6120 6469 6374 696f 6e61 7279  use a dictionary
+0003db10: 2074 6f20 6275 696c 6420 6120 2773 6f72   to build a 'sor
+0003db20: 742d 6f66 2720 7369 6e67 6c65 206c 696e  t-of' single lin
+0003db30: 6b65 6420 6c69 7374 0d0a 2020 2020 2020  ked list..      
+0003db40: 2020 2020 2020 2320 6e6f 7465 3a20 696e        # note: in
+0003db50: 6465 782d 6c69 7374 2077 6f75 6c64 2063  dex-list would c
+0003db60: 6f6e 6169 6e20 6d61 6e79 2065 6d70 6c79  onain many emply
+0003db70: 2076 616c 7565 732e 0d0a 2020 2020 2020   values...      
+0003db80: 2020 2020 2020 6564 6765 4469 6374 5f66        edgeDict_f
+0003db90: 6c20 3d20 6564 6765 4469 6374 0d0a 2020  l = edgeDict..  
+0003dba0: 2020 2020 2020 2020 2020 6b20 3d20 6c69            k = li
+0003dbb0: 7374 2865 6467 6544 6963 742e 6b65 7973  st(edgeDict.keys
+0003dbc0: 2829 295b 305d 0d0a 2020 2020 2020 2020  ())[0]..        
+0003dbd0: 2020 2020 7620 3d20 6c69 7374 2865 6467      v = list(edg
+0003dbe0: 6544 6963 742e 7661 6c75 6573 2829 295b  eDict.values())[
+0003dbf0: 305d 0d0a 2020 2020 2020 2020 2020 2020  0]..            
+0003dc00: 6c69 6e65 203d 205b 6b2c 765d 0d0a 2020  line = [k,v]..  
+0003dc10: 2020 2020 2020 2020 2020 6564 6765 4469            edgeDi
+0003dc20: 6374 5f66 6c2e 706f 7028 6b29 0d0a 0d0a  ct_fl.pop(k)....
+0003dc30: 2020 2020 2020 2020 2020 2020 2320 6164              # ad
+0003dc40: 6420 7365 676d 656e 7473 2074 6f20 7468  d segments to th
+0003dc50: 6520 7461 696c 203a 0d0a 2020 2020 2020  e tail :..      
+0003dc60: 2020 2020 2020 636f 6e74 696e 7565 4275        continueBu
+0003dc70: 696c 6420 3d20 5472 7565 0d0a 2020 2020  ild = True..    
+0003dc80: 2020 2020 2020 2020 7768 696c 6520 636f          while co
+0003dc90: 6e74 696e 7565 4275 696c 6420 3a0d 0a20  ntinueBuild :.. 
+0003dca0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+0003dcb0: 6f6e 7469 6e75 6542 7569 6c64 203d 2046  ontinueBuild = F
+0003dcc0: 616c 7365 0d0a 2020 2020 2020 2020 2020  alse..          
+0003dcd0: 2020 2020 2020 656e 6420 3d20 6c69 6e65        end = line
+0003dce0: 5b6c 656e 286c 696e 6529 2d31 5d0d 0a20  [len(line)-1].. 
+0003dcf0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0003dd00: 6620 656e 6420 696e 2065 6467 6544 6963  f end in edgeDic
+0003dd10: 745f 666c 203a 0d0a 2020 2020 2020 2020  t_fl :..        
+0003dd20: 2020 2020 2020 2020 2020 2020 6c69 6e65              line
+0003dd30: 2e61 7070 656e 6428 6564 6765 4469 6374  .append(edgeDict
+0003dd40: 5f66 6c5b 656e 645d 290d 0a20 2020 2020  _fl[end])..     
+0003dd50: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0003dd60: 6467 6544 6963 745f 666c 2e70 6f70 2865  dgeDict_fl.pop(e
+0003dd70: 6e64 290d 0a20 2020 2020 2020 2020 2020  nd)..           
+0003dd80: 2020 2020 2020 2020 2063 6f6e 7469 6e75           continu
+0003dd90: 6542 7569 6c64 203d 2054 7275 650d 0a20  eBuild = True.. 
+0003dda0: 2020 2020 2020 2020 2020 2069 6620 6c69             if li
+0003ddb0: 6e65 5b6c 656e 286c 696e 6529 2d31 5d20  ne[len(line)-1] 
+0003ddc0: 3d3d 206c 696e 655b 305d 203a 200d 0a20  == line[0] : .. 
+0003ddd0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0003dde0: 6574 7572 6e20 6c69 6e65 2c65 6467 6544  eturn line,edgeD
+0003ddf0: 6963 745f 666c 0d0a 2020 2020 2020 2020  ict_fl..        
+0003de00: 2020 2020 2320 7468 656e 206c 696e 6520      # then line 
+0003de10: 6973 206e 6f74 2061 206c 6f6f 7020 736f  is not a loop so
+0003de20: 2063 6f6e 7469 6e75 652c 2061 6464 696e   continue, addin
+0003de30: 6720 7365 676d 656e 7473 2074 6f20 6865  g segments to he
+0003de40: 6164 203a 0d0a 2020 2020 2020 2020 2020  ad :..          
+0003de50: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
+0003de60: 6564 6765 4469 6374 5f6c 6620 3d20 7b20  edgeDict_lf = { 
+0003de70: 7661 6c75 653a 6b65 7920 666f 7220 6b65  value:key for ke
+0003de80: 792c 7661 6c75 6520 696e 2065 6467 6544  y,value in edgeD
+0003de90: 6963 745f 666c 2e69 7465 6d73 2829 7d0d  ict_fl.items()}.
+0003dea0: 0a20 2020 2020 2020 2020 2020 2063 6f6e  .            con
+0003deb0: 7469 6e75 6542 7569 6c64 203d 2054 7275  tinueBuild = Tru
+0003dec0: 650d 0a20 2020 2020 2020 2020 2020 2077  e..            w
+0003ded0: 6869 6c65 2063 6f6e 7469 6e75 6542 7569  hile continueBui
+0003dee0: 6c64 203a 0d0a 2020 2020 2020 2020 2020  ld :..          
+0003def0: 2020 2020 2020 636f 6e74 696e 7565 4275        continueBu
+0003df00: 696c 6420 3d20 4661 6c73 650d 0a20 2020  ild = False..   
+0003df10: 2020 2020 2020 2020 2020 2020 2073 7461               sta
+0003df20: 7274 203d 206c 696e 655b 305d 0d0a 2020  rt = line[0]..  
+0003df30: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0003df40: 2073 7461 7274 2069 6e20 6564 6765 4469   start in edgeDi
+0003df50: 6374 5f6c 6620 3a0d 0a20 2020 2020 2020  ct_lf :..       
+0003df60: 2020 2020 2020 2020 2020 2020 206c 696e               lin
+0003df70: 652e 696e 7365 7274 2830 2c65 6467 6544  e.insert(0,edgeD
+0003df80: 6963 745f 6c66 5b73 7461 7274 5d29 0d0a  ict_lf[start])..
+0003df90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003dfa0: 2020 2020 6564 6765 4469 6374 5f6c 662e      edgeDict_lf.
+0003dfb0: 706f 7028 7374 6172 7429 0d0a 2020 2020  pop(start)..    
+0003dfc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003dfd0: 636f 6e74 696e 7565 4275 696c 6420 3d20  continueBuild = 
+0003dfe0: 5472 7565 0d0a 2020 2020 2020 2020 2020  True..          
+0003dff0: 2020 6564 6765 4469 6374 5f6e 7874 203d    edgeDict_nxt =
+0003e000: 207b 2076 616c 7565 3a6b 6579 2066 6f72   { value:key for
+0003e010: 206b 6579 2c76 616c 7565 2069 6e20 6564   key,value in ed
+0003e020: 6765 4469 6374 5f6c 662e 6974 656d 7328  geDict_lf.items(
+0003e030: 2920 7d20 2020 2020 2020 200d 0a20 2020  ) }        ..   
+0003e040: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0003e050: 6c69 6e65 2c20 6564 6765 4469 6374 5f6e  line, edgeDict_n
+0003e060: 7874 0d0a 2020 2020 2020 2020 2320 2e2e  xt..        # ..
+0003e070: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0003e080: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0003e090: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0003e0a0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0003e0b0: 0d0a 2020 2020 2020 2020 6564 6765 4469  ..        edgeDi
+0003e0c0: 6374 203d 2020 7b20 6c69 7465 6d5b 305d  ct =  { litem[0]
+0003e0d0: 3a6c 6974 656d 5b31 5d20 2066 6f72 206c  :litem[1]  for l
+0003e0e0: 6974 656d 2069 6e20 6c69 6e65 5365 676d  item in lineSegm
+0003e0f0: 656e 7473 207d 0d0a 2020 2020 2020 2020  ents }..        
+0003e100: 6c69 6e65 7320 3d20 5b5d 0d0a 2020 2020  lines = []..    
+0003e110: 2020 2020 7768 696c 6528 6c65 6e28 6564      while(len(ed
+0003e120: 6765 4469 6374 293e 3029 203a 0d0a 2020  geDict)>0) :..  
+0003e130: 2020 2020 2020 2020 2020 6c69 6e65 2c65            line,e
+0003e140: 6467 6544 6963 7420 3d20 6578 7472 6163  dgeDict = extrac
+0003e150: 744c 696e 6528 6564 6765 4469 6374 290d  tLine(edgeDict).
+0003e160: 0a20 2020 2020 2020 2020 2020 206c 696e  .            lin
+0003e170: 6573 2e61 7070 656e 6428 6c69 6e65 290d  es.append(line).
+0003e180: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0003e190: 6c69 6e65 730d 0a0d 0a20 2020 2064 6566  lines....    def
+0003e1a0: 205f 5f61 6464 5f5f 2873 656c 662c 206f   __add__(self, o
+0003e1b0: 7468 7229 203a 0d0a 2020 2020 2020 2020  thr) :..        
+0003e1c0: 2222 220d 0a20 2020 2020 2020 2043 6f6d  """..        Com
+0003e1d0: 6269 6e65 2074 776f 206c 696e 6520 6f62  bine two line ob
+0003e1e0: 6a65 6374 7320 696e 746f 2061 2073 696e  jects into a sin
+0003e1f0: 676c 6520 6c69 6e65 206f 626a 6563 742e  gle line object.
+0003e200: 0d0a 0d0a 2020 2020 2020 2020 5061 7261  ....        Para
+0003e210: 6d65 7465 7273 0d0a 2020 2020 2020 2020  meters..        
+0003e220: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
+0003e230: 2020 2020 6f74 6872 203a 2043 6f6c 6f72      othr : Color
+0003e240: 4c69 6e65 3344 436f 6c6c 6563 7469 6f6e  Line3DCollection
+0003e250: 206f 626a 6563 7420 0d0a 2020 2020 2020   object ..      
+0003e260: 2020 0d0a 2020 2020 2020 2020 5265 7475    ..        Retu
+0003e270: 726e 730d 0a20 2020 2020 2020 202d 2d2d  rns..        ---
+0003e280: 2d2d 2d2d 0d0a 2020 2020 2020 2020 436f  ----..        Co
+0003e290: 6c6f 724c 696e 6533 4443 6f6c 6c65 6374  lorLine3DCollect
+0003e2a0: 696f 6e20 6f62 6a65 6374 0d0a 0d0a 2020  ion object....  
+0003e2b0: 2020 2020 2020 2222 220d 0a0d 0a20 2020        """....   
+0003e2c0: 2020 2020 2023 202e 2e2e 2e2e 2e2e 2e2e       # .........
 0003e2d0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
 0003e2e0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0003e2f0: 2e2e 2e2e 2e2e 2e2e 2e0d 0a20 2020 2020  ...........     
-0003e300: 2020 2072 6574 7572 6e20 7365 6c66 2020     return self  
-0003e310: 200d 0a0d 0a20 2020 2064 6566 206d 6170   ....    def map
-0003e320: 5f63 6d61 705f 6672 6f6d 5f64 6972 6563  _cmap_from_direc
-0003e330: 7469 6f6e 2820 7365 6c66 2c20 6469 7265  tion( self, dire
-0003e340: 6374 696f 6e3d 4e6f 6e65 2c20 636d 6170  ction=None, cmap
-0003e350: 3d4e 6f6e 652c 2069 7341 6273 3d46 616c  =None, isAbs=Fal
-0003e360: 7365 2c20 636e 616d 653d 4e6f 6e65 2020  se, cname=None  
-0003e370: 2920 3a0d 0a20 2020 2020 2020 2022 2222  ) :..        """
-0003e380: 0d0a 2020 2020 2020 2020 4173 7369 676e  ..        Assign
-0003e390: 6d65 6e74 206f 6620 6c69 6e65 2063 6f6c  ment of line col
-0003e3a0: 6f72 2062 6173 6564 206f 6e20 6c69 6e65  or based on line
-0003e3b0: 2073 6567 6d65 6e74 2064 6972 6563 7469   segment directi
-0003e3c0: 6f6e 2e0d 0a0d 0a20 2020 2020 2020 2054  on.....        T
-0003e3d0: 6865 2064 6f74 2070 726f 6475 6374 206f  he dot product o
-0003e3e0: 6620 6c69 6e65 2073 6567 6d65 6e74 2064  f line segment d
-0003e3f0: 6972 6563 7469 6f6e 7320 7769 7468 2074  irections with t
-0003e400: 6865 2064 6972 6563 7469 6f6e 2070 6172  he direction par
-0003e410: 616d 656e 7465 720d 0a20 2020 2020 2020  amenter..       
-0003e420: 2069 7320 7573 6564 2074 6f20 6173 7369   is used to assi
-0003e430: 676e 206c 696e 6520 7365 676d 656e 7420  gn line segment 
-0003e440: 636f 6c6f 7273 2066 726f 6d20 6120 636f  colors from a co
-0003e450: 6c6f 726d 6170 2e0d 0a0d 0a20 2020 2020  lormap.....     
-0003e460: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
-0003e470: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-0003e480: 2d0d 0a20 2020 2020 2020 2064 6972 6563  -..        direc
-0003e490: 7469 6f6e 203a 2061 7272 6179 2d6c 696b  tion : array-lik
-0003e4a0: 652c 206f 7074 696f 6e61 6c2c 2064 6566  e, optional, def
-0003e4b0: 6175 6c74 3a20 2831 2c30 2c31 290d 0a20  ault: (1,0,1).. 
-0003e4c0: 2020 2020 2020 2020 2020 2041 2078 797a             A xyz
-0003e4d0: 2076 6563 746f 722e 200d 0a0d 0a20 2020   vector. ....   
-0003e4e0: 2020 2020 2063 6d61 7020 3a20 7374 7220       cmap : str 
-0003e4f0: 6f72 2043 6f6c 6f72 6d61 702c 206f 7074  or Colormap, opt
-0003e500: 696f 6e61 6c2c 2064 6566 6175 6c74 3a20  ional, default: 
-0003e510: 2776 6972 6964 6973 270d 0a20 2020 2020  'viridis'..     
-0003e520: 2020 2020 2020 2041 2043 6f6c 6f72 6d61         A Colorma
-0003e530: 7020 696e 7374 616e 6365 206f 7220 7265  p instance or re
-0003e540: 6769 7374 6572 6564 2063 6f6c 6f72 6d61  gistered colorma
-0003e550: 7020 6e61 6d65 2e0d 0a20 2020 2020 2020  p name...       
-0003e560: 200d 0a20 2020 2020 2020 2069 7341 6273   ..        isAbs
-0003e570: 203a 2062 6f6f 6c65 616e 2c20 6f70 7469   : boolean, opti
-0003e580: 6f6e 616c 2c20 6465 6661 756c 743a 2046  onal, default: F
-0003e590: 616c 7365 0d0a 2020 2020 2020 2020 2020  alse..          
-0003e5a0: 2020 2020 2020 4966 2054 7275 652c 2074        If True, t
-0003e5b0: 6865 2061 6273 6f6c 7574 6520 7661 6c75  he absolute valu
-0003e5c0: 6520 6f66 2074 6865 2064 6f74 2070 726f  e of the dot pro
-0003e5d0: 6475 6374 0d0a 2020 2020 2020 2020 2020  duct..          
-0003e5e0: 2020 2020 2020 7769 6c6c 2063 6f6e 7472        will contr
-0003e5f0: 6f6c 2074 6865 2063 6f6c 6f72 2e0d 0a0d  ol the color....
-0003e600: 0a20 2020 2020 2020 2063 6e61 6d65 203a  .        cname :
-0003e610: 2073 7472 2c20 6f70 7469 6f6e 616c 2c20   str, optional, 
-0003e620: 6465 6661 756c 7420 6973 204e 6f6e 650d  default is None.
-0003e630: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003e640: 2049 6465 6e74 6966 6965 7220 666f 7220   Identifier for 
-0003e650: 7468 6520 636f 6c6f 7220 7661 6c75 6573  the color values
-0003e660: 2e0d 0a0d 0a20 2020 2020 2020 2052 6574  .....        Ret
-0003e670: 7572 6e73 0d0a 2020 2020 2020 2020 2d2d  urns..        --
-0003e680: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2073  -----..        s
-0003e690: 656c 6620 3a20 6c69 6e65 206f 626a 6563  elf : line objec
-0003e6a0: 740d 0a0d 0a20 2020 2020 2020 2022 2222  t....        """
-0003e6b0: 0d0a 0d0a 2020 2020 2020 2020 6966 2064  ....        if d
-0003e6c0: 6972 6563 7469 6f6e 2069 7320 4e6f 6e65  irection is None
-0003e6d0: 203a 2064 6972 6563 7469 6f6e 203d 205f   : direction = _
-0003e6e0: 494c 4c55 4d0d 0a0d 0a20 2020 2020 2020  ILLUM....       
-0003e6f0: 2069 6620 636d 6170 2069 7320 6e6f 7420   if cmap is not 
-0003e700: 4e6f 6e65 203a 0d0a 2020 2020 2020 2020  None :..        
-0003e710: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-0003e720: 6528 636d 6170 2c73 7472 2920 3a20 0d0a  e(cmap,str) : ..
-0003e730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e740: 7365 6c66 2e73 6574 5f63 6d61 7028 636d  self.set_cmap(cm
-0003e750: 2e67 6574 5f63 6d61 7028 636d 6170 2929  .get_cmap(cmap))
-0003e760: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
-0003e770: 7365 203a 0d0a 2020 2020 2020 2020 2020  se :..          
-0003e780: 2020 2020 2020 7365 6c66 2e73 6574 5f63        self.set_c
-0003e790: 6d61 7028 636d 6170 290d 0a20 2020 2020  map(cmap)..     
-0003e7a0: 2020 2063 6d5f 636f 6c6f 724d 6170 203d     cm_colorMap =
-0003e7b0: 2073 656c 662e 6765 745f 636d 6170 2829   self.get_cmap()
-0003e7c0: 0d0a 0d0a 0d0a 2020 2020 2020 2020 7365  ......        se
-0003e7d0: 6c66 2e76 616c 7565 734e 616d 6520 3d20  lf.valuesName = 
-0003e7e0: 636e 616d 650d 0a20 2020 2020 2020 2023  cname..        #
-0003e7f0: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
-0003e800: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0003e810: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
-0003e820: 2020 2020 7365 676d 656e 7473 203d 2073      segments = s
-0003e830: 656c 662e 5f73 6567 6d65 6e74 7333 640d  elf._segments3d.
-0003e840: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
-0003e850: 7365 6c66 2e69 7353 6872 6564 6465 6420  self.isShredded 
-0003e860: 3a0d 0a20 2020 2020 2020 2020 2020 2073  :..            s
-0003e870: 6567 6d65 6e74 7320 3d20 7365 6c66 2e5f  egments = self._
-0003e880: 7368 7265 6428 290d 0a20 2020 2020 2020  shred()..       
-0003e890: 2023 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   # -------------
-0003e8a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0003e8b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020  ------------..  
-0003e8c0: 2020 2020 2020 7365 6744 6972 203d 2073        segDir = s
-0003e8d0: 656c 662e 5f67 6574 5f73 6567 6d65 6e74  elf._get_segment
-0003e8e0: 5f64 6972 6563 7469 6f6e 7328 7365 676d  _directions(segm
-0003e8f0: 656e 7473 290d 0a20 2020 2020 2020 2075  ents)..        u
-0003e900: 6e69 7444 6972 6563 7469 6f6e 203d 206e  nitDirection = n
-0003e910: 702e 6469 7669 6465 2820 6469 7265 6374  p.divide( direct
-0003e920: 696f 6e2c 206e 702e 6c69 6e61 6c67 2e6e  ion, np.linalg.n
-0003e930: 6f72 6d28 6469 7265 6374 696f 6e29 2029  orm(direction) )
-0003e940: 0d0a 2020 2020 2020 2020 7620 3d20 6e70  ..        v = np
-0003e950: 2e64 6f74 2873 6567 4469 722c 756e 6974  .dot(segDir,unit
-0003e960: 4469 7265 6374 696f 6e29 0d0a 2020 2020  Direction)..    
-0003e970: 2020 2020 6966 2069 7341 6273 203a 2076      if isAbs : v
-0003e980: 203d 202d 6e70 2e61 6273 2876 290d 0a20   = -np.abs(v).. 
-0003e990: 2020 2020 2020 2076 6d69 6e2c 2076 6d61         vmin, vma
-0003e9a0: 7820 3d20 762e 6d69 6e28 292c 2076 2e6d  x = v.min(), v.m
-0003e9b0: 6178 2829 0d0a 2020 2020 2020 2020 6e6f  ax()..        no
-0003e9c0: 726d 203d 2063 6f6c 6f72 732e 4e6f 726d  rm = colors.Norm
-0003e9d0: 616c 697a 6528 766d 696e 3d76 2e6d 696e  alize(vmin=v.min
-0003e9e0: 2829 2c76 6d61 783d 762e 6d61 7828 2929  (),vmax=v.max())
-0003e9f0: 0d0a 0d0a 2020 2020 2020 2020 7365 6c66  ....        self
-0003ea00: 2e5f 6564 6765 636f 6c6f 7273 203d 2063  ._edgecolors = c
-0003ea10: 6d5f 636f 6c6f 724d 6170 286e 6f72 6d28  m_colorMap(norm(
-0003ea20: 7629 290d 0a20 2020 2020 2020 2073 656c  v))..        sel
-0003ea30: 662e 7365 6756 616c 7565 7320 3d20 760d  f.segValues = v.
-0003ea40: 0a20 2020 2020 2020 2073 656c 662e 5f62  .        self._b
-0003ea50: 6f75 6e64 735b 2776 6c69 6d27 5d20 3d20  ounds['vlim'] = 
-0003ea60: 5b20 766d 696e 2c20 766d 6178 205d 200d  [ vmin, vmax ] .
-0003ea70: 0a20 2020 2020 2020 2023 202e 2e2e 2e2e  .        # .....
-0003ea80: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0003ea90: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0003eaa0: 2e2e 2e2e 2e2e 2e2e 0d0a 2020 2020 2020  ..........      
-0003eab0: 2020 7365 6c66 2e5f 6d61 705f 636d 6170    self._map_cmap
-0003eac0: 5f66 726f 6d5f 6469 7265 6374 696f 6e5f  _from_direction_
-0003ead0: 7665 7274 2820 7365 6c66 2e5f 6564 6765  vert( self._edge
-0003eae0: 636f 6c6f 7273 2c20 7365 6c66 2e73 6567  colors, self.seg
-0003eaf0: 5661 6c75 6573 2c20 7365 6c66 2e5f 626f  Values, self._bo
-0003eb00: 756e 6473 5b27 766c 696d 275d 2029 0d0a  unds['vlim'] )..
-0003eb10: 2020 2020 2020 2020 2320 2e2e 2e2e 2e2e          # ......
-0003eb20: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0003eb30: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0003eb40: 2e2e 2e2e 2e2e 2e0d 0a20 2020 2020 2020  .........       
-0003eb50: 2072 6574 7572 6e20 7365 6c66 0d0a 0d0a   return self....
-0003eb60: 2020 2020 6465 6620 6d61 705f 636d 6170      def map_cmap
-0003eb70: 5f66 726f 6d5f 6461 7461 6772 6964 2873  _from_datagrid(s
-0003eb80: 656c 662c 2064 6174 6167 7269 642c 2063  elf, datagrid, c
-0003eb90: 6d61 703d 4e6f 6e65 2c20 636e 616d 653d  map=None, cname=
-0003eba0: 4e6f 6e65 2029 203a 0d0a 2020 2020 2020  None ) :..      
-0003ebb0: 2020 2222 220d 0a20 2020 2020 2020 204c    """..        L
-0003ebc0: 696e 6520 636f 6c6f 7220 6173 7369 676e  ine color assign
-0003ebd0: 6d65 6e74 2075 7369 6e67 2061 2032 4420  ment using a 2D 
-0003ebe0: 6461 7461 6772 6964 2e0d 0a0d 0a20 2020  datagrid.....   
-0003ebf0: 2020 2020 2044 6174 6167 7269 6420 7661       Datagrid va
-0003ec00: 6c75 6573 2061 7265 206e 6f72 6d61 6c69  lues are normali
-0003ec10: 7a65 6420 696e 2074 6865 2072 616e 6765  zed in the range
-0003ec20: 2030 2074 6f20 312e 0d0a 0d0a 2020 2020   0 to 1.....    
-0003ec30: 2020 2020 2222 220d 0a0d 0a20 2020 2020      """....     
-0003ec40: 2020 2064 6174 6120 3d20 6461 7461 6772     data = datagr
-0003ec50: 6964 0d0a 2020 2020 2020 2020 646d 6178  id..        dmax
-0003ec60: 203d 206e 702e 616d 6178 2864 6174 6167   = np.amax(datag
-0003ec70: 7269 6429 0d0a 2020 2020 2020 2020 646d  rid)..        dm
-0003ec80: 696e 203d 206e 702e 616d 696e 2864 6174  in = np.amin(dat
-0003ec90: 6167 7269 6429 0d0a 2020 2020 2020 2020  agrid)..        
-0003eca0: 6465 6c74 6120 3d20 646d 6178 2d64 6d69  delta = dmax-dmi
-0003ecb0: 6e0d 0a20 2020 2020 2020 2064 6174 6120  n..        data 
-0003ecc0: 3d20 2864 6174 6167 7269 6420 2d20 646d  = (datagrid - dm
-0003ecd0: 696e 292f 6465 6c74 610d 0a20 2020 2020  in)/delta..     
-0003ece0: 2020 2078 6420 3d20 6e70 2e6c 696e 7370     xd = np.linsp
-0003ecf0: 6163 6528 2d31 2c20 312c 2064 6174 612e  ace(-1, 1, data.
-0003ed00: 7368 6170 655b 305d 2029 0d0a 2020 2020  shape[0] )..    
-0003ed10: 2020 2020 7964 203d 206e 702e 6c69 6e73      yd = np.lins
-0003ed20: 7061 6365 282d 312c 2031 2c20 6461 7461  pace(-1, 1, data
-0003ed30: 2e73 6861 7065 5b31 5d20 290d 0a20 2020  .shape[1] )..   
-0003ed40: 2020 2020 2067 203d 2020 696e 7465 7270       g =  interp
-0003ed50: 6f6c 6174 652e 696e 7465 7270 3264 2879  olate.interp2d(y
-0003ed60: 642c 2078 642c 2064 6174 612c 206b 696e  d, xd, data, kin
-0003ed70: 643d 2763 7562 6963 2729 0d0a 0d0a 2020  d='cubic')....  
-0003ed80: 2020 2020 2020 2320 2d2d 2d2d 2d2d 2d2d        # --------
-0003ed90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0003eda0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0003edb0: 2d0d 0a20 2020 2020 2020 2069 6620 636d  -..        if cm
-0003edc0: 6170 2069 7320 6e6f 7420 4e6f 6e65 203a  ap is not None :
-0003edd0: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-0003ede0: 2069 7369 6e73 7461 6e63 6528 636d 6170   isinstance(cmap
-0003edf0: 2c73 7472 2920 3a20 0d0a 2020 2020 2020  ,str) : ..      
-0003ee00: 2020 2020 2020 2020 2020 7365 6c66 2e73            self.s
-0003ee10: 6574 5f63 6d61 7028 636d 2e67 6574 5f63  et_cmap(cm.get_c
-0003ee20: 6d61 7028 636d 6170 2929 0d0a 2020 2020  map(cmap))..    
-0003ee30: 2020 2020 2020 2020 656c 7365 203a 0d0a          else :..
-0003ee40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ee50: 7365 6c66 2e73 6574 5f63 6d61 7028 636d  self.set_cmap(cm
-0003ee60: 6170 290d 0a20 2020 2020 2020 2063 6d5f  ap)..        cm_
-0003ee70: 636f 6c6f 724d 6170 203d 2073 656c 662e  colorMap = self.
-0003ee80: 6765 745f 636d 6170 2829 0d0a 0d0a 2020  get_cmap()....  
-0003ee90: 2020 2020 2020 7365 6c66 2e76 616c 7565        self.value
-0003eea0: 734e 616d 6520 3d20 636e 616d 650d 0a0d  sName = cname...
-0003eeb0: 0a20 2020 2020 2020 2023 202d 2d2d 2d2d  .        # -----
-0003eec0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0003eed0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0003eee0: 2d2d 2d2d 0d0a 2020 2020 2020 2020 7365  ----..        se
-0003eef0: 676d 656e 7473 203d 2073 656c 662e 5f73  gments = self._s
-0003ef00: 6567 6d65 6e74 7333 640d 0a20 2020 2020  egments3d..     
-0003ef10: 2020 2069 6620 6e6f 7420 7365 6c66 2e69     if not self.i
-0003ef20: 7353 6872 6564 6465 6420 3a0d 0a20 2020  sShredded :..   
-0003ef30: 2020 2020 2020 2020 2073 6567 6d65 6e74           segment
-0003ef40: 7320 3d20 7365 6c66 2e5f 7368 7265 6428  s = self._shred(
-0003ef50: 290d 0a20 2020 2020 2020 2023 202d 2d2d  )..        # ---
-0003ef60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0003ef70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0003ef80: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
-0003ef90: 7365 6743 6f6f 7220 3d20 7365 6c66 2e5f  segCoor = self._
-0003efa0: 6765 745f 7365 676d 656e 745f 6365 6e74  get_segment_cent
-0003efb0: 6572 7328 7365 676d 656e 7473 290d 0a20  ers(segments).. 
-0003efc0: 2020 2020 2020 2078 2c79 2c7a 203d 206e         x,y,z = n
-0003efd0: 702e 7472 616e 7370 6f73 6528 7365 6743  p.transpose(segC
-0003efe0: 6f6f 7229 0d0a 0d0a 2020 2020 2020 2020  oor)....        
-0003eff0: 2320 6e6f 726d 616c 697a 6520 7879 2070  # normalize xy p
-0003f000: 6c61 6e65 202d 3120 746f 2031 0d0a 2020  lane -1 to 1..  
-0003f010: 2020 2020 2020 7820 3d20 6e70 2e69 6e74        x = np.int
-0003f020: 6572 7028 2078 2c20 2878 2e6d 696e 2829  erp( x, (x.min()
-0003f030: 2c20 782e 6d61 7828 2929 2c20 282d 312e  , x.max()), (-1.
-0003f040: 302c 2031 2e30 2920 290d 0a20 2020 2020  0, 1.0) )..     
-0003f050: 2020 2079 203d 206e 702e 696e 7465 7270     y = np.interp
-0003f060: 2820 792c 2028 792e 6d69 6e28 292c 2079  ( y, (y.min(), y
-0003f070: 2e6d 6178 2829 292c 2028 2d31 2e30 2c20  .max()), (-1.0, 
-0003f080: 312e 3029 2029 0d0a 0d0a 2020 2020 2020  1.0) )....      
-0003f090: 2020 7472 6961 6c20 3d20 5b20 6728 2078    trial = [ g( x
-0003f0a0: 5b69 5d2c 795b 695d 295b 305d 2066 6f72  [i],y[i])[0] for
-0003f0b0: 2069 2069 6e20 7261 6e67 6528 6c65 6e28   i in range(len(
-0003f0c0: 7829 2920 5d0d 0a0d 0a20 2020 2020 2020  x)) ]....       
-0003f0d0: 2076 203d 206e 702e 6172 7261 7928 7472   v = np.array(tr
-0003f0e0: 6961 6c29 2a64 656c 7461 202b 2064 6d69  ial)*delta + dmi
-0003f0f0: 6e0d 0a20 2020 2020 2020 2076 6d69 6e2c  n..        vmin,
-0003f100: 2076 6d61 7820 3d20 762e 6d69 6e28 292c   vmax = v.min(),
-0003f110: 2076 2e6d 6178 2829 0d0a 2020 2020 2020   v.max()..      
-0003f120: 2020 6e6f 726d 203d 2063 6f6c 6f72 732e    norm = colors.
-0003f130: 4e6f 726d 616c 697a 6528 766d 696e 3d76  Normalize(vmin=v
-0003f140: 2e6d 696e 2829 2c76 6d61 783d 762e 6d61  .min(),vmax=v.ma
-0003f150: 7828 2929 0d0a 0d0a 2020 2020 2020 2020  x())....        
-0003f160: 7365 6c66 2e5f 6564 6765 636f 6c6f 7273  self._edgecolors
-0003f170: 203d 2063 6d5f 636f 6c6f 724d 6170 286e   = cm_colorMap(n
-0003f180: 6f72 6d28 7629 290d 0a20 2020 2020 2020  orm(v))..       
-0003f190: 2073 656c 662e 7365 6756 616c 7565 7320   self.segValues 
-0003f1a0: 3d20 760d 0a20 2020 2020 2020 2073 656c  = v..        sel
-0003f1b0: 662e 5f62 6f75 6e64 735b 2776 6c69 6d27  f._bounds['vlim'
-0003f1c0: 5d20 3d20 5b20 766d 696e 2c20 766d 6178  ] = [ vmin, vmax
-0003f1d0: 205d 200d 0a0d 0a20 2020 2020 2020 2023   ] ....        #
-0003f1e0: 202e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e   ...............
-0003f1f0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0003f200: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 0d0a  ................
-0003f210: 2020 2020 2020 2020 7365 6c66 2e5f 6d61          self._ma
-0003f220: 705f 636d 6170 5f66 726f 6d5f 6461 7461  p_cmap_from_data
-0003f230: 6772 6964 5f76 6572 7428 672c 2064 656c  grid_vert(g, del
-0003f240: 7461 2c20 646d 696e 2c20 636d 5f63 6f6c  ta, dmin, cm_col
-0003f250: 6f72 4d61 7029 0d0a 2020 2020 2020 2020  orMap)..        
-0003f260: 2320 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  # ..............
-0003f270: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0003f280: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e0d  ................
-0003f290: 0a0d 0a20 2020 2020 2020 2072 6574 7572  ...        retur
-0003f2a0: 6e20 7365 6c66 0d0a 0d0a 2020 2020 6465  n self....    de
-0003f2b0: 6620 6d61 705f 636d 6170 5f66 726f 6d5f  f map_cmap_from_
-0003f2c0: 6f70 2820 7365 6c66 2c20 6f70 6572 6174  op( self, operat
-0003f2d0: 696f 6e2c 2063 6d61 703d 4e6f 6e65 2c20  ion, cmap=None, 
-0003f2e0: 636e 616d 653d 4e6f 6e65 2029 203a 0d0a  cname=None ) :..
-0003f2f0: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
-0003f300: 2020 2020 2046 756e 6374 696f 6e61 6c20       Functional 
-0003f310: 6173 7369 676e 6d65 6e74 206f 6620 6120  assignment of a 
-0003f320: 636f 6c6f 7220 6672 6f6d 2061 2063 6f6c  color from a col
-0003f330: 6f72 206d 6170 2e0d 0a0d 0a20 2020 2020  or map.....     
-0003f340: 2020 204c 696e 6520 7365 676d 656e 7420     Line segment 
-0003f350: 6365 6e74 6572 2063 6f6f 7264 696e 6174  center coordinat
-0003f360: 6573 2061 7265 2075 7365 6420 746f 2063  es are used to c
-0003f370: 616c 6375 6c61 7465 2061 2073 6361 6c61  alculate a scala
-0003f380: 7220 7768 6963 680d 0a20 2020 2020 2020  r which..       
-0003f390: 2069 7320 7468 656e 2075 7365 6420 746f   is then used to
-0003f3a0: 2061 7373 6967 6e20 7365 676d 656e 7420   assign segment 
-0003f3b0: 636f 6c6f 7273 2066 726f 6d20 6120 636f  colors from a co
-0003f3c0: 6c6f 726d 6170 2e0d 0a0d 0a20 2020 2020  lormap.....     
-0003f3d0: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
-0003f3e0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-0003f3f0: 2d0d 0a20 2020 2020 2020 206f 7065 7261  -..        opera
-0003f400: 7469 6f6e 203a 2066 756e 6374 696f 6e20  tion : function 
-0003f410: 6f62 6a65 6374 0d0a 2020 2020 2020 2020  object..        
-0003f420: 2020 2020 4675 6e63 7469 6f6e 2074 6861      Function tha
-0003f430: 7420 7461 6b65 7320 6f6e 6520 6172 6775  t takes one argu
-0003f440: 6d65 6e74 2c0d 0a20 2020 2020 2020 2020  ment,..         
-0003f450: 2020 2061 2033 784e 204e 756d 7079 2061     a 3xN Numpy a
-0003f460: 7272 6179 206f 6620 6e61 7469 7665 2063  rray of native c
-0003f470: 6f6f 7264 696e 6174 6573 2e0d 0a20 2020  oordinates...   
-0003f480: 2020 2020 2020 2020 2054 6865 2066 756e           The fun
-0003f490: 6374 696f 6e20 7265 7475 726e 7320 6120  ction returns a 
-0003f4a0: 4e75 6d70 7920 6172 7261 7920 6f66 2073  Numpy array of s
-0003f4b0: 6361 6c61 7220 7661 6c75 6573 2e0d 0a0d  calar values....
-0003f4c0: 0a20 2020 2020 2020 2063 6d61 7020 3a20  .        cmap : 
-0003f4d0: 7374 7220 6f72 2043 6f6c 6f72 6d61 702c  str or Colormap,
-0003f4e0: 206f 7074 696f 6e61 6c2c 2064 6566 6175   optional, defau
-0003f4f0: 6c74 3a20 2776 6972 6964 6973 270d 0a20  lt: 'viridis'.. 
-0003f500: 2020 2020 2020 2020 2020 2041 2043 6f6c             A Col
-0003f510: 6f72 6d61 7020 696e 7374 616e 6365 206f  ormap instance o
-0003f520: 7220 7265 6769 7374 6572 6564 2063 6f6c  r registered col
-0003f530: 6f72 6d61 7020 6e61 6d65 2e0d 0a20 2020  ormap name...   
-0003f540: 2020 2020 200d 0a20 2020 2020 2020 2063       ..        c
-0003f550: 6e61 6d65 203a 2073 7472 2c20 6f70 7469  name : str, opti
-0003f560: 6f6e 616c 2c20 6465 6661 756c 743a 2066  onal, default: f
-0003f570: 756e 6374 696f 6e20 6f62 6a65 6374 206e  unction object n
-0003f580: 616d 650d 0a20 2020 2020 2020 2020 2020  ame..           
-0003f590: 2020 2020 2069 6620 6e6f 7420 6120 6c61       if not a la
-0003f5a0: 6d62 6461 2066 756e 6374 696f 6e2c 206f  mbda function, o
-0003f5b0: 7468 6572 7769 7365 2027 272e 0d0a 2020  therwise ''...  
-0003f5c0: 2020 2020 2020 2020 2020 2020 2020 4964                Id
-0003f5d0: 656e 7469 6669 6572 2066 6f72 2074 6865  entifier for the
-0003f5e0: 2063 6f6c 6f72 2076 616c 7565 732e 0d0a   color values...
-0003f5f0: 0d0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
-0003f600: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
-0003f610: 2d2d 0d0a 2020 2020 2020 2020 7365 6c66  --..        self
-0003f620: 203a 206c 696e 6520 6f62 6a65 6374 0d0a   : line object..
-0003f630: 0d0a 2020 2020 2020 2020 2222 2220 2020  ..        """   
-0003f640: 2020 2020 0d0a 2020 2020 2020 2020 636e      ..        cn
-0003f650: 616d 6520 3d20 5f67 6574 4675 6e63 7469  ame = _getFuncti
-0003f660: 6f6e 4e61 6d65 286f 7065 7261 7469 6f6e  onName(operation
-0003f670: 2c63 6e61 6d65 290d 0a20 2020 2020 2020  ,cname)..       
-0003f680: 2069 6620 636e 616d 6520 6973 206e 6f74   if cname is not
-0003f690: 204e 6f6e 6520 3a20 7365 6c66 2e76 616c   None : self.val
-0003f6a0: 7565 734e 616d 6520 3d20 636e 616d 650d  uesName = cname.
-0003f6b0: 0a0d 0a20 2020 2020 2020 2069 6620 636d  ...        if cm
-0003f6c0: 6170 2069 7320 6e6f 7420 4e6f 6e65 203a  ap is not None :
-0003f6d0: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-0003f6e0: 2069 7369 6e73 7461 6e63 6528 636d 6170   isinstance(cmap
-0003f6f0: 2c73 7472 2920 3a20 0d0a 2020 2020 2020  ,str) : ..      
-0003f700: 2020 2020 2020 2020 2020 7365 6c66 2e73            self.s
-0003f710: 6574 5f63 6d61 7028 636d 2e67 6574 5f63  et_cmap(cm.get_c
-0003f720: 6d61 7028 636d 6170 2929 0d0a 2020 2020  map(cmap))..    
-0003f730: 2020 2020 2020 2020 656c 7365 203a 0d0a          else :..
-0003f740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f750: 7365 6c66 2e73 6574 5f63 6d61 7028 636d  self.set_cmap(cm
-0003f760: 6170 290d 0a20 2020 2020 2020 2063 6d5f  ap)..        cm_
-0003f770: 636f 6c6f 724d 6170 203d 2073 656c 662e  colorMap = self.
-0003f780: 6765 745f 636d 6170 2829 0d0a 0d0a 2020  get_cmap()....  
-0003f790: 2020 2020 2020 2320 2d2d 2d2d 2d2d 2d2d        # --------
-0003f7a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0003f7b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0003f7c0: 2d0d 0a20 2020 2020 2020 2073 6567 6d65  -..        segme
-0003f7d0: 6e74 7320 3d20 7365 6c66 2e5f 7365 676d  nts = self._segm
-0003f7e0: 656e 7473 3364 0d0a 2020 2020 2020 2020  ents3d..        
-0003f7f0: 6966 206e 6f74 2073 656c 662e 6973 5368  if not self.isSh
-0003f800: 7265 6464 6564 203a 0d0a 2020 2020 2020  redded :..      
-0003f810: 2020 2020 2020 7365 676d 656e 7473 203d        segments =
-0003f820: 2073 656c 662e 5f73 6872 6564 2829 0d0a   self._shred()..
-0003f830: 2020 2020 2020 2020 2320 2d2d 2d2d 2d2d          # ------
-0003f840: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0003f850: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0003f860: 2d2d 2d0d 0a20 2020 2020 2020 2073 6567  ---..        seg
-0003f870: 436f 6f72 203d 2073 656c 662e 5f67 6574  Coor = self._get
-0003f880: 5f73 6567 6d65 6e74 5f63 656e 7465 7273  _segment_centers
-0003f890: 2873 6567 6d65 6e74 7329 0d0a 2020 2020  (segments)..    
-0003f8a0: 2020 2020 2320 2e2e 2e2e 2e0d 0a20 2020      # .......   
-0003f8b0: 2020 2020 2078 797a 203d 206e 702e 7472       xyz = np.tr
-0003f8c0: 616e 7370 6f73 6528 7365 6743 6f6f 7229  anspose(segCoor)
-0003f8d0: 0d0a 2020 2020 2020 2020 7620 3d20 6e70  ..        v = np
-0003f8e0: 2e61 7272 6179 286f 7065 7261 7469 6f6e  .array(operation
-0003f8f0: 2878 797a 2929 0d0a 2020 2020 2020 2020  (xyz))..        
-0003f900: 766d 696e 2c20 766d 6178 203d 2076 2e6d  vmin, vmax = v.m
-0003f910: 696e 2829 2c20 762e 6d61 7828 290d 0a20  in(), v.max().. 
-0003f920: 2020 2020 2020 206e 6f72 6d20 3d20 636f         norm = co
-0003f930: 6c6f 7273 2e4e 6f72 6d61 6c69 7a65 2876  lors.Normalize(v
-0003f940: 6d69 6e3d 762e 6d69 6e28 292c 766d 6178  min=v.min(),vmax
-0003f950: 3d76 2e6d 6178 2829 290d 0a20 2020 2020  =v.max())..     
-0003f960: 2020 200d 0a20 2020 2020 2020 2073 656c     ..        sel
-0003f970: 662e 5f65 6467 6563 6f6c 6f72 7320 3d20  f._edgecolors = 
-0003f980: 636d 5f63 6f6c 6f72 4d61 7028 6e6f 726d  cm_colorMap(norm
-0003f990: 2876 2929 0d0a 2020 2020 2020 2020 7365  (v))..        se
-0003f9a0: 6c66 2e73 6567 5661 6c75 6573 203d 2076  lf.segValues = v
-0003f9b0: 0d0a 2020 2020 2020 2020 7365 6c66 2e5f  ..        self._
-0003f9c0: 626f 756e 6473 5b27 766c 696d 275d 203d  bounds['vlim'] =
-0003f9d0: 205b 2076 6d69 6e2c 2076 6d61 7820 5d20   [ vmin, vmax ] 
-0003f9e0: 0d0a 2020 2020 2020 2020 2320 3d3d 3d3d  ..        # ====
-0003f9f0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0003fa00: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0003fa10: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0003fa20: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0003fa30: 3d3d 3d3d 0d0a 2020 2020 2020 2020 7365  ====..        se
-0003fa40: 6c66 2e5f 6d61 705f 636d 6170 5f66 726f  lf._map_cmap_fro
-0003fa50: 6d5f 6f70 5f76 6572 7428 6f70 6572 6174  m_op_vert(operat
-0003fa60: 696f 6e2c 2063 6d5f 636f 6c6f 724d 6170  ion, cm_colorMap
-0003fa70: 290d 0a20 2020 2020 2020 2023 203d 3d3d  )..        # ===
-0003fa80: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0003fa90: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0003faa0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0003fab0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0003fac0: 3d3d 3d3d 3d0d 0a20 2020 2020 2020 2072  =====..        r
-0003fad0: 6574 7572 6e20 7365 6c66 2020 2020 0d0a  eturn self    ..
-0003fae0: 0d0a 2020 2020 6465 6620 6d61 705f 636f  ..    def map_co
-0003faf0: 6c6f 725f 6672 6f6d 5f6f 7028 2073 656c  lor_from_op( sel
-0003fb00: 662c 206f 7065 7261 7469 6f6e 2c20 7267  f, operation, rg
-0003fb10: 623d 5472 7565 2c20 636e 616d 653d 4e6f  b=True, cname=No
-0003fb20: 6e65 2029 203a 0d0a 2020 2020 2020 2020  ne ) :..        
-0003fb30: 2222 220d 0a20 2020 2020 2020 2041 7373  """..        Ass
-0003fb40: 6967 6e6d 656e 7420 6f66 206c 696e 6520  ignment of line 
-0003fb50: 636f 6c6f 7220 6672 6f6d 2061 2066 756e  color from a fun
-0003fb60: 6374 696f 6e2e 0d0a 0d0a 2020 2020 2020  ction.....      
-0003fb70: 2020 4c69 6e65 2073 6567 6d65 6e74 2063    Line segment c
-0003fb80: 6f6c 6f72 7320 6172 6520 6173 7369 676e  olors are assign
-0003fb90: 6564 2066 726f 6d20 6120 6675 6e63 7469  ed from a functi
-0003fba0: 6f6e 206f 6620 6c69 6e65 2020 0d0a 2020  on of line  ..  
-0003fbb0: 2020 2020 2020 7365 676d 656e 7420 6365        segment ce
-0003fbc0: 6e74 6572 2063 6f6f 7264 696e 6174 6573  nter coordinates
-0003fbd0: 2e0d 0a0d 0a20 2020 2020 2020 2050 6172  .....        Par
-0003fbe0: 616d 6574 6572 730d 0a20 2020 2020 2020  ameters..       
-0003fbf0: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
-0003fc00: 2020 2020 206f 7065 7261 7469 6f6e 203a       operation :
-0003fc10: 2066 756e 6374 696f 6e20 6f62 6a65 6374   function object
-0003fc20: 0d0a 2020 2020 2020 2020 2020 2020 4675  ..            Fu
-0003fc30: 6e63 7469 6f6e 2074 6861 7420 7461 6b65  nction that take
-0003fc40: 7320 6f6e 6520 6172 6775 6d65 6e74 2c0d  s one argument,.
-0003fc50: 0a20 2020 2020 2020 2020 2020 2061 2033  .            a 3
-0003fc60: 784e 204e 756d 7079 2061 7272 6179 206f  xN Numpy array o
-0003fc70: 6620 6e61 7469 7665 2063 6f6f 7264 696e  f native coordin
-0003fc80: 6174 6573 2e0d 0a20 2020 2020 2020 2020  ates...         
-0003fc90: 2020 2054 6865 2066 756e 6374 696f 6e20     The function 
-0003fca0: 7265 7475 726e 7320 6120 3378 4e20 636f  returns a 3xN co
-0003fcb0: 6c6f 7220 7661 6c75 652e 0d0a 0d0a 2020  lor value.....  
-0003fcc0: 2020 2020 2020 7267 6220 3a20 626f 6f6c        rgb : bool
-0003fcd0: 207b 5472 7565 2c20 4661 6c73 657d 2c20   {True, False}, 
-0003fce0: 6f70 7469 6f6e 616c 2c20 6465 6661 756c  optional, defaul
-0003fcf0: 743a 2054 7275 650d 0a20 2020 2020 2020  t: True..       
-0003fd00: 2020 2020 2042 7920 6465 6661 756c 742c       By default,
-0003fd10: 2052 4742 2063 6f6c 6f72 2076 616c 7565   RGB color value
-0003fd20: 7320 6172 6520 7265 7475 726e 6564 2062  s are returned b
-0003fd30: 7920 7468 650d 0a20 2020 2020 2020 2020  y the..         
-0003fd40: 2020 206f 7065 7261 7469 6f6e 2066 756e     operation fun
-0003fd50: 6374 696f 6e2e 2020 4966 2073 6574 2046  ction.  If set F
-0003fd60: 616c 7365 2c20 7468 6520 6f70 6572 6174  alse, the operat
-0003fd70: 696f 6e0d 0a20 2020 2020 2020 2020 2020  ion..           
-0003fd80: 2072 6574 7572 6e73 2048 5356 2063 6f6c   returns HSV col
-0003fd90: 6f72 2076 616c 7565 732e 0d0a 2020 2020  or values...    
-0003fda0: 2020 2020 0d0a 2020 2020 2020 2020 636e      ..        cn
-0003fdb0: 616d 6520 3a20 7374 722c 206f 7074 696f  ame : str, optio
-0003fdc0: 6e61 6c2c 2064 6566 6175 6c74 3a20 6675  nal, default: fu
-0003fdd0: 6e63 7469 6f6e 206f 626a 6563 7420 6e61  nction object na
-0003fde0: 6d65 0d0a 2020 2020 2020 2020 2020 2020  me..            
-0003fdf0: 2020 2020 6966 206e 6f74 2061 206c 616d      if not a lam
-0003fe00: 6264 6120 6675 6e63 7469 6f6e 2c20 6f74  bda function, ot
-0003fe10: 6865 7277 6973 6520 2727 2e0d 0a20 2020  herwise ''...   
-0003fe20: 2020 2020 2020 2020 2020 2020 2049 6465               Ide
-0003fe30: 6e74 6966 6965 7220 666f 7220 7468 6520  ntifier for the 
-0003fe40: 636f 6c6f 7220 7661 6c75 6573 2e0d 0a20  color values... 
-0003fe50: 2020 2020 2020 2020 2020 2020 2020 200d                 .
-0003fe60: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-0003fe70: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-0003fe80: 2d0d 0a20 2020 2020 2020 2073 656c 6620  -..        self 
-0003fe90: 3a20 6c69 6e65 206f 626a 6563 740d 0a0d  : line object...
-0003fea0: 0a20 2020 2020 2020 2022 2222 2020 2020  .        """    
-0003feb0: 2020 200d 0a20 2020 2020 2020 2063 6e61     ..        cna
-0003fec0: 6d65 203d 205f 6765 7446 756e 6374 696f  me = _getFunctio
-0003fed0: 6e4e 616d 6528 6f70 6572 6174 696f 6e2c  nName(operation,
-0003fee0: 636e 616d 6529 0d0a 2020 2020 2020 2020  cname)..        
-0003fef0: 6966 2063 6e61 6d65 2069 7320 6e6f 7420  if cname is not 
-0003ff00: 4e6f 6e65 203a 2073 656c 662e 7661 6c75  None : self.valu
-0003ff10: 6573 4e61 6d65 203d 2063 6e61 6d65 0d0a  esName = cname..
-0003ff20: 2020 2020 2020 2020 2320 2d2d 2d2d 2d2d          # ------
-0003ff30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0003ff40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0003ff50: 2d2d 2d0d 0a20 2020 2020 2020 2073 6567  ---..        seg
-0003ff60: 6d65 6e74 7320 3d20 7365 6c66 2e5f 7365  ments = self._se
-0003ff70: 676d 656e 7473 3364 0d0a 2020 2020 2020  gments3d..      
-0003ff80: 2020 6966 206e 6f74 2073 656c 662e 6973    if not self.is
-0003ff90: 5368 7265 6464 6564 203a 0d0a 2020 2020  Shredded :..    
-0003ffa0: 2020 2020 2020 2020 7365 676d 656e 7473          segments
-0003ffb0: 203d 7365 6c66 2e5f 7368 7265 6428 290d   =self._shred().
-0003ffc0: 0a20 2020 2020 2020 2023 202d 2d2d 2d2d  .        # -----
-0003ffd0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0003ffe0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0003fff0: 2d2d 2d2d 0d0a 2020 2020 2020 2020 7365  ----..        se
-00040000: 6743 6f6f 7220 3d20 7365 6c66 2e5f 6765  gCoor = self._ge
-00040010: 745f 7365 676d 656e 745f 6365 6e74 6572  t_segment_center
-00040020: 7328 7365 676d 656e 7473 290d 0a0d 0a20  s(segments).... 
-00040030: 2020 2020 2020 2078 797a 203d 206e 702e         xyz = np.
-00040040: 7472 616e 7370 6f73 6528 7365 6743 6f6f  transpose(segCoo
-00040050: 7229 0d0a 2020 2020 2020 2020 636f 6c6f  r)..        colo
-00040060: 7273 203d 206e 702e 6172 7261 7928 6f70  rs = np.array(op
-00040070: 6572 6174 696f 6e28 7879 7a29 290d 0a20  eration(xyz)).. 
-00040080: 2020 2020 2020 2063 6f6c 6f72 7320 3d20         colors = 
-00040090: 6e70 2e74 7261 6e73 706f 7365 2863 6f6c  np.transpose(col
-000400a0: 6f72 7329 0d0a 2020 2020 2020 2020 636f  ors)..        co
-000400b0: 6c6f 7273 203d 206e 702e 636c 6970 2863  lors = np.clip(c
-000400c0: 6f6c 6f72 732c 302c 3129 0d0a 2020 2020  olors,0,1)..    
-000400d0: 2020 2020 6966 2072 6762 203a 2052 4742      if rgb : RGB
-000400e0: 203d 2063 6f6c 6f72 730d 0a20 2020 2020   = colors..     
-000400f0: 2020 2065 6c73 6520 3a20 2020 5247 4220     else :   RGB 
-00040100: 3d20 636d 2e63 6f6c 6f72 732e 6873 765f  = cm.colors.hsv_
-00040110: 746f 5f72 6762 2863 6f6c 6f72 7329 0d0a  to_rgb(colors)..
-00040120: 2020 2020 2020 2020 6966 2052 4742 2e73          if RGB.s
-00040130: 6861 7065 5b31 5d20 6973 2033 203a 0d0a  hape[1] is 3 :..
-00040140: 2020 2020 2020 2020 2020 2020 6f6e 6573              ones
-00040150: 203d 206e 702e 6f6e 6573 2852 4742 2e73   = np.ones(RGB.s
-00040160: 6861 7065 5b30 5d29 5b3a 2c6e 702e 6e65  hape[0])[:,np.ne
-00040170: 7761 7869 735d 0d0a 2020 2020 2020 2020  waxis]..        
-00040180: 2020 2020 5247 4220 3d20 6e70 2e63 6f6e      RGB = np.con
-00040190: 6361 7465 6e61 7465 2828 5247 422c 6f6e  catenate((RGB,on
-000401a0: 6573 292c 6178 6973 3d31 290d 0a20 2020  es),axis=1)..   
-000401b0: 2020 2020 200d 0a20 2020 2020 2020 2073       ..        s
-000401c0: 656c 662e 5f65 6467 6563 6f6c 6f72 7320  elf._edgecolors 
-000401d0: 3d20 5247 420d 0a20 2020 2020 2020 2073  = RGB..        s
-000401e0: 656c 662e 7365 6756 616c 7565 7320 3d20  elf.segValues = 
-000401f0: 4e6f 6e65 0d0a 2020 2020 2020 2020 7365  None..        se
-00040200: 6c66 2e5f 626f 756e 6473 5b27 766c 696d  lf._bounds['vlim
-00040210: 275d 203d 205b 2030 2e30 2c20 312e 3020  '] = [ 0.0, 1.0 
-00040220: 5d20 0d0a 2020 2020 2020 2020 2320 3d3d  ] ..        # ==
-00040230: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00040240: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00040250: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00040260: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00040270: 3d3d 3d3d 3d3d 0d0a 2020 2020 2020 2020  ======..        
-00040280: 7365 6c66 2e5f 6d61 705f 636f 6c6f 725f  self._map_color_
-00040290: 6672 6f6d 5f6f 705f 7665 7274 2820 6f70  from_op_vert( op
-000402a0: 6572 6174 696f 6e2c 2072 6762 2029 0d0a  eration, rgb )..
-000402b0: 2020 2020 2020 2020 2320 3d3d 3d3d 3d3d          # ======
-000402c0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000402d0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000402e0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000402f0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00040300: 3d3d 0d0a 2020 2020 2020 2020 7265 7475  ==..        retu
-00040310: 726e 2073 656c 6620 2020 200d 0a0d 0a20  rn self    .... 
-00040320: 2020 2064 6566 206d 6170 5f67 656f 6d5f     def map_geom_
-00040330: 6672 6f6d 5f6f 7028 7365 6c66 2c20 6f70  from_op(self, op
-00040340: 6572 6174 696f 6e2c 206e 616d 653d 4e6f  eration, name=No
-00040350: 6e65 2920 3a0d 0a20 2020 2020 2020 2022  ne) :..        "
-00040360: 2222 0d0a 2020 2020 2020 2020 4675 6e63  ""..        Func
-00040370: 7469 6f6e 616c 2074 7261 6e73 666f 726d  tional transform
-00040380: 6174 696f 6e20 6f66 206c 696e 6520 7665  ation of line ve
-00040390: 7274 6578 2063 6f6f 7264 696e 6174 6573  rtex coordinates
-000403a0: 2e0d 0a0d 0a20 2020 2020 2020 2050 6172  .....        Par
-000403b0: 616d 6574 6572 730d 0a20 2020 2020 2020  ameters..       
-000403c0: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
-000403d0: 2020 2020 206f 7065 7261 7469 6f6e 203a       operation :
-000403e0: 2066 756e 6374 696f 6e20 6f62 6a65 6374   function object
-000403f0: 0d0a 2020 2020 2020 2020 2020 2020 436f  ..            Co
-00040400: 6f72 6469 6e61 7465 206d 6170 7069 6e67  ordinate mapping
-00040410: 2066 756e 6374 696f 6e20 7468 6174 2074   function that t
-00040420: 616b 6573 206f 6e65 0d0a 2020 2020 2020  akes one..      
-00040430: 2020 2020 2020 6172 6775 6d65 6e74 2c20        argument, 
-00040440: 6120 3378 4e20 4e75 6d70 7920 6172 7261  a 3xN Numpy arra
-00040450: 7920 6f66 206e 6174 6976 6520 636f 6f72  y of native coor
-00040460: 6469 6e61 7465 732e 0d0a 2020 2020 2020  dinates...      
-00040470: 2020 2020 2020 5468 6520 6675 6e63 7469        The functi
-00040480: 6f6e 2072 6574 7572 6e73 2061 2033 784e  on returns a 3xN
-00040490: 2061 7272 6179 206f 6620 636f 6f72 6469   array of coordi
-000404a0: 6e61 7465 732e 0d0a 0d0a 2020 2020 2020  nates.....      
-000404b0: 2020 6e61 6d65 203a 2073 7472 696e 672c    name : string,
-000404c0: 206f 7074 696f 6e61 6c2c 2064 6566 6175   optional, defau
-000404d0: 6c74 3a20 4e6f 6e65 206f 7220 6f70 2066  lt: None or op f
-000404e0: 756e 6374 696f 6e20 6e61 6d65 2e0d 0a20  unction name... 
-000404f0: 2020 2020 2020 2020 2020 2044 6573 6372             Descr
-00040500: 6970 7469 7665 2069 6465 6e74 6966 6965  iptive identifie
-00040510: 7220 666f 7220 7468 6520 6765 6f6d 6574  r for the geomet
-00040520: 7279 2e0d 0a0d 0a20 2020 2020 2020 2052  ry.....        R
-00040530: 6574 7572 6e73 0d0a 2020 2020 2020 2020  eturns..        
-00040540: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-00040550: 2073 656c 6620 3a20 6c69 6e65 206f 626a   self : line obj
-00040560: 6563 740d 0a0d 0a20 2020 2020 2020 2022  ect....        "
-00040570: 2222 0d0a 2020 2020 2020 2020 6f72 6743  ""..        orgC
-00040580: 6f6f 7220 3d20 7365 6c66 2e76 6572 7465  oor = self.verte
-00040590: 7843 6f6f 720d 0a20 2020 2020 2020 2078  xCoor..        x
-000405a0: 797a 203d 206e 702e 7472 616e 7370 6f73  yz = np.transpos
-000405b0: 6528 6f72 6743 6f6f 7229 0d0a 2020 2020  e(orgCoor)..    
-000405c0: 2020 2020 5859 5a20 3d20 6e70 2e61 7272      XYZ = np.arr
-000405d0: 6179 286f 7065 7261 7469 6f6e 2878 797a  ay(operation(xyz
-000405e0: 2929 0d0a 2020 2020 2020 2020 7620 3d20  ))..        v = 
-000405f0: 6e70 2e74 7261 6e73 706f 7365 2858 595a  np.transpose(XYZ
-00040600: 290d 0a20 2020 2020 2020 2073 656c 662e  )..        self.
-00040610: 7665 7274 6578 436f 6f72 203d 2076 0d0a  vertexCoor = v..
-00040620: 2020 2020 2020 2020 7365 676d 656e 7473          segments
-00040630: 203d 2073 656c 662e 5f67 6574 5f73 6567   = self._get_seg
-00040640: 6d65 6e74 7328 2073 656c 662e 7665 7274  ments( self.vert
-00040650: 6578 436f 6f72 2c20 7365 6c66 2e73 6567  exCoor, self.seg
-00040660: 6d49 6e64 6963 6573 2020 290d 0a20 2020  mIndices  )..   
-00040670: 2020 2020 2073 656c 662e 7365 745f 7365       self.set_se
-00040680: 676d 656e 7473 2873 6567 6d65 6e74 7329  gments(segments)
-00040690: 0d0a 2020 2020 2020 2020 7365 6c66 2e5f  ..        self._
-000406a0: 7365 745f 6765 6f6d 6574 7269 635f 626f  set_geometric_bo
-000406b0: 756e 6473 2829 0d0a 2020 2020 2020 2020  unds()..        
-000406c0: 6966 206e 616d 6520 6973 204e 6f6e 6520  if name is None 
-000406d0: 3a20 6e61 6d65 203d 2073 656c 662e 5f67  : name = self._g
-000406e0: 656f 6d4e 616d 650d 0a20 2020 2020 2020  eomName..       
-000406f0: 206e 616d 6520 3d20 5f67 6574 4675 6e63   name = _getFunc
-00040700: 7469 6f6e 4e61 6d65 286f 7065 7261 7469  tionName(operati
-00040710: 6f6e 2c6e 616d 6529 0d0a 2020 2020 2020  on,name)..      
-00040720: 2020 6966 206e 616d 6520 6973 206e 6f74    if name is not
-00040730: 204e 6f6e 6520 3a20 7365 6c66 2e5f 6765   None : self._ge
-00040740: 6f6d 4e61 6d65 203d 206e 616d 650d 0a20  omName = name.. 
-00040750: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00040760: 6c66 0d0a 0d0a 2020 2020 6465 6620 6d61  lf....    def ma
-00040770: 705f 746f 5f70 6c61 6e65 2873 656c 662c  p_to_plane(self,
-00040780: 2064 6973 742c 202a 2a6b 6172 6773 2920   dist, **kargs) 
-00040790: 3a0d 0a20 2020 2020 2020 2022 2222 0d0a  :..        """..
-000407a0: 2020 2020 2020 2020 5072 6f6a 6563 7420          Project 
-000407b0: 6c69 6e65 206f 6e74 6f20 6120 6d61 7070  line onto a mapp
-000407c0: 696e 6720 7375 7266 6163 652e 0d0a 0d0a  ing surface.....
-000407d0: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
-000407e0: 7273 0d0a 2020 2020 2020 2020 2d2d 2d2d  rs..        ----
-000407f0: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
-00040800: 6469 7374 203a 206e 756d 6265 722c 206f  dist : number, o
-00040810: 7074 696f 6e61 6c2c 2064 6566 6175 6c74  ptional, default
-00040820: 203a 2030 2e30 200d 0a20 2020 2020 2020   : 0.0 ..       
-00040830: 2020 2020 2064 6973 7461 6e63 6520 6672       distance fr
-00040840: 6f6d 2074 6865 206f 7269 6769 6e20 746f  om the origin to
-00040850: 2074 6865 2073 7572 6661 6365 2c0d 0a20   the surface,.. 
-00040860: 2020 2020 2020 2020 2020 2061 6c6f 6e67             along
-00040870: 2074 6865 2064 6972 6563 7469 6f6e 2076   the direction v
-00040880: 6563 746f 722e 0d0a 0d0a 2020 2020 2020  ector.....      
-00040890: 2020 6469 7265 6374 696f 6e20 3a20 6172    direction : ar
-000408a0: 7261 792d 6c69 6b65 2c20 6f70 7469 6f6e  ray-like, option
-000408b0: 616c 2c20 6465 6661 756c 743a 205b 302c  al, default: [0,
-000408c0: 302c 315d 0d0a 2020 2020 2020 2020 2020  0,1]..          
-000408d0: 2020 4120 7879 7a20 7665 6374 6f72 206e    A xyz vector n
-000408e0: 6f72 6d61 6c20 746f 2074 6865 2069 6e74  ormal to the int
-000408f0: 6572 7365 6374 696f 6e20 706c 616e 6573  ersection planes
-00040900: 0d0a 2020 2020 2020 2020 2020 2020 666f  ..            fo
-00040910: 7220 706c 616e 6172 206d 6170 7069 6e67  r planar mapping
-00040920: 206f 7220 6178 6961 6c20 6469 7265 6374   or axial direct
-00040930: 696f 6e20 6f66 200d 0a20 2020 2020 2020  ion of ..       
-00040940: 2020 2020 2061 2063 796c 696e 6465 7220       a cylinder 
-00040950: 666f 7220 6379 6c69 6e64 7269 6361 6c20  for cylindrical 
-00040960: 6d61 7070 696e 672e 0d0a 0d0a 2020 2020  mapping.....    
-00040970: 2020 2020 636f 6f72 203a 2069 6e74 6567      coor : integ
-00040980: 6572 206f 7220 7374 7269 6e67 2069 6e64  er or string ind
-00040990: 6963 6174 696e 6720 7468 6520 7479 7065  icating the type
-000409a0: 206f 6620 6d61 7070 696e 6720 7375 7266   of mapping surf
-000409b0: 6163 653a 0d0a 2020 2020 2020 2020 2020  ace:..          
-000409c0: 2020 302c 2070 2c20 502c 2078 797a 2c70    0, p, P, xyz,p
-000409d0: 6c61 6e61 7220 2020 2020 2020 2020 2020  lanar           
-000409e0: 2020 2020 2020 2d20 706c 616e 6172 2028        - planar (
-000409f0: 6465 6661 756c 7429 0d0a 2020 2020 2020  default)..      
-00040a00: 2020 2020 2020 312c 2063 2c20 432c 2063        1, c, C, c
-00040a10: 796c 696e 6465 722c 7070 6c61 722c 6379  ylinder,pplar,cy
-00040a20: 6c69 6e64 7269 6361 6c20 2d20 6379 6c69  lindrical - cyli
-00040a30: 6e64 6572 0d0a 2020 2020 2020 2020 2020  nder..          
-00040a40: 2020 322c 2073 2c20 532c 2073 7068 6572    2, s, S, spher
-00040a50: 652c 7370 6865 7269 6361 6c20 2020 2020  e,spherical     
-00040a60: 2020 2020 2020 2d20 7370 6865 7265 0d0a        - sphere..
-00040a70: 2020 2020 2020 2020 2020 2020 332c 2078              3, x
-00040a80: 2c20 5820 2020 2020 2020 2020 2020 2020  , X             
-00040a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040aa0: 2d20 792d 7a20 706c 616e 650d 0a20 2020  - y-z plane..   
-00040ab0: 2020 2020 2020 2020 2034 2c20 792c 2059           4, y, Y
-00040ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040ad0: 2020 2020 2020 2020 2020 2020 202d 2078               - x
-00040ae0: 2d7a 2070 6c61 6e65 0d0a 2020 2020 2020  -z plane..      
-00040af0: 2020 2020 2020 352c 207a 2c20 5a20 2020        5, z, Z   
-00040b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040b10: 2020 2020 2020 2020 2020 2d20 782d 7920            - x-y 
-00040b20: 706c 616e 650d 0a0d 0a20 2020 2020 2020  plane....       
-00040b30: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
-00040b40: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
-00040b50: 2020 2073 656c 6620 3a20 6c69 6e65 206f     self : line o
-00040b60: 626a 6563 740d 0a0d 0a20 2020 2020 2020  bject....       
-00040b70: 2022 2222 0d0a 2020 2020 2020 2020 6469   """..        di
-00040b80: 7244 6674 203d 207b 2027 6469 7265 6374  rDft = { 'direct
-00040b90: 696f 6e27 3a20 5b30 2c30 2c31 2e30 5d20  ion': [0,0,1.0] 
-00040ba0: 7d0d 0a20 2020 2020 2020 206b 6172 6744  }..        kargD
-00040bb0: 6674 203d 207b 202a 2a5f 434f 4f52 5f4b  ft = { **_COOR_K
-00040bc0: 5741 5247 532c 202a 2a64 6972 4466 7420  WARGS, **dirDft 
-00040bd0: 7d0d 0a20 2020 2020 2020 204b 5720 3d20  }..        KW = 
-00040be0: 4b57 7072 6f63 6573 736f 7228 206b 6172  KWprocessor( kar
-00040bf0: 6744 6674 2c20 276d 6170 5f74 6f5f 706c  gDft, 'map_to_pl
-00040c00: 616e 6527 2c20 2a2a 6b61 7267 7329 0d0a  ane', **kargs)..
-00040c10: 2020 2020 2020 2020 636f 6f72 203d 204b          coor = K
-00040c20: 572e 6765 7456 616c 2827 636f 6f72 2729  W.getVal('coor')
-00040c30: 0d0a 2020 2020 2020 2020 6469 7265 6374  ..        direct
-00040c40: 696f 6e20 3d20 4b57 2e67 6574 5661 6c28  ion = KW.getVal(
-00040c50: 2764 6972 6563 7469 6f6e 2729 0d0a 0d0a  'direction')....
-00040c60: 2020 2020 2020 2020 6966 2063 6f6f 723d          if coor=
-00040c70: 3d33 203a 2063 6f6f 722c 2064 6972 6563  =3 : coor, direc
-00040c80: 7469 6f6e 203d 2030 2c20 5b20 312c 302c  tion = 0, [ 1,0,
-00040c90: 3020 5d0d 0a20 2020 2020 2020 2069 6620  0 ]..        if 
-00040ca0: 636f 6f72 3d3d 3420 3a20 636f 6f72 2c20  coor==4 : coor, 
-00040cb0: 6469 7265 6374 696f 6e20 3d20 302c 205b  direction = 0, [
-00040cc0: 2030 2c31 2c30 205d 0d0a 2020 2020 2020   0,1,0 ]..      
-00040cd0: 2020 6966 2063 6f6f 723d 3d35 203a 2063    if coor==5 : c
-00040ce0: 6f6f 722c 2064 6972 6563 7469 6f6e 203d  oor, direction =
-00040cf0: 2030 2c20 5b20 302c 302c 3120 5d0d 0a0d   0, [ 0,0,1 ]...
-00040d00: 0a20 2020 2020 2020 2023 202e 2e2e 2e2e  .        # .....
-00040d10: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00040d20: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00040d30: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00040d40: 2e2e 0d0a 2020 2020 2020 2020 6465 6620  ....        def 
-00040d50: 7072 6f6a 6563 745f 706c 616e 6528 7879  project_plane(xy
-00040d60: 7a29 203a 0d0a 2020 2020 2020 2020 2020  z) :..          
-00040d70: 2020 7665 7274 7320 3d20 7879 7a2e 540d    verts = xyz.T.
-00040d80: 0a20 2020 2020 2020 2020 2020 2075 6e69  .            uni
-00040d90: 7444 6972 6563 7469 6f6e 203d 206e 702e  tDirection = np.
-00040da0: 6469 7669 6465 2820 6469 7265 6374 696f  divide( directio
-00040db0: 6e2c 206e 702e 6c69 6e61 6c67 2e6e 6f72  n, np.linalg.nor
-00040dc0: 6d28 6469 7265 6374 696f 6e29 2029 0d0a  m(direction) )..
-00040dd0: 2020 2020 2020 2020 2020 2020 6470 726f              dpro
-00040de0: 6420 3d20 6e70 2e64 6f74 2820 7665 7274  d = np.dot( vert
-00040df0: 732c 2075 6e69 7444 6972 6563 7469 6f6e  s, unitDirection
-00040e00: 2029 0d0a 2020 2020 2020 2020 2020 2020   )..            
-00040e10: 7664 6f74 203d 206e 702e 6172 7261 7928  vdot = np.array(
-00040e20: 5b64 7072 6f64 5d29 2e54 0d0a 2020 2020  [dprod]).T..    
-00040e30: 2020 2020 2020 2020 6455 6e69 7420 3d20          dUnit = 
-00040e40: 6e70 2e74 696c 6528 756e 6974 4469 7265  np.tile(unitDire
-00040e50: 6374 696f 6e2c 2028 6c65 6e28 7665 7274  ction, (len(vert
-00040e60: 7329 2c31 2920 290d 0a20 2020 2020 2020  s),1) )..       
-00040e70: 2020 2020 2076 556e 6974 203d 2076 646f       vUnit = vdo
-00040e80: 742a 6455 6e69 740d 0a20 2020 2020 2020  t*dUnit..       
-00040e90: 2020 2020 2064 556e 6974 203d 2064 6973       dUnit = dis
-00040ea0: 742a 6455 6e69 740d 0a20 2020 2020 2020  t*dUnit..       
-00040eb0: 2020 2020 2070 726f 6a56 6572 7473 203d       projVerts =
-00040ec0: 2076 6572 7473 202b 2028 6455 6e69 7420   verts + (dUnit 
-00040ed0: 2d20 7655 6e69 7429 0d0a 2020 2020 2020  - vUnit)..      
-00040ee0: 2020 2020 2020 7265 7475 726e 2070 726f        return pro
-00040ef0: 6a56 6572 7473 2e54 0d0a 2020 2020 2020  jVerts.T..      
-00040f00: 2020 6465 6620 7072 6f6a 6563 745f 6379    def project_cy
-00040f10: 6c28 7879 7a29 203a 0d0a 2020 2020 2020  l(xyz) :..      
-00040f20: 2020 2020 2020 7665 7274 7320 3d20 7879        verts = xy
-00040f30: 7a2e 540d 0a20 2020 2020 2020 2020 2020  z.T..           
-00040f40: 2075 6e69 7444 6972 6563 7469 6f6e 203d   unitDirection =
-00040f50: 206e 702e 6469 7669 6465 2820 6469 7265   np.divide( dire
-00040f60: 6374 696f 6e2c 206e 702e 6c69 6e61 6c67  ction, np.linalg
-00040f70: 2e6e 6f72 6d28 6469 7265 6374 696f 6e29  .norm(direction)
-00040f80: 2029 0d0a 2020 2020 2020 2020 2020 2020   )..            
-00040f90: 646d 6167 203d 206e 702e 646f 7428 7665  dmag = np.dot(ve
-00040fa0: 7274 732c 756e 6974 4469 7265 6374 696f  rts,unitDirectio
-00040fb0: 6e29 0d0a 2020 2020 2020 2020 2020 2020  n)..            
-00040fc0: 7556 6563 7420 3d20 6e70 2e74 696c 6528  uVect = np.tile(
-00040fd0: 756e 6974 4469 7265 6374 696f 6e2c 286c  unitDirection,(l
-00040fe0: 656e 2864 6d61 6729 2c31 2920 290d 0a20  en(dmag),1) ).. 
-00040ff0: 2020 2020 2020 2020 2020 2064 5665 6374             dVect
-00041000: 203d 206e 702e 6172 7261 7928 5b64 6d61   = np.array([dma
-00041010: 675d 292e 540d 0a20 2020 2020 2020 2020  g]).T..         
-00041020: 2020 2041 203d 2075 5665 6374 2a64 5665     A = uVect*dVe
-00041030: 6374 0d0a 2020 2020 2020 2020 2020 2020  ct..            
-00041040: 7a65 7461 203d 2076 6572 7473 202d 2041  zeta = verts - A
-00041050: 0d0a 2020 2020 2020 2020 2020 2020 7a65  ..            ze
-00041060: 7461 6e6f 726d 203d 206e 702e 6c69 6e61  tanorm = np.lina
-00041070: 6c67 2e6e 6f72 6d28 7a65 7461 2c61 7869  lg.norm(zeta,axi
-00041080: 733d 3129 0d0a 2020 2020 2020 2020 2020  s=1)..          
-00041090: 2020 7a6e 6f72 6d20 3d20 6e70 2e74 696c    znorm = np.til
-000410a0: 6528 7a65 7461 6e6f 726d 2c20 2833 2c31  e(zetanorm, (3,1
-000410b0: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
-000410c0: 756e 6974 5a65 7461 203d 206e 702e 6469  unitZeta = np.di
-000410d0: 7669 6465 2820 7a65 7461 2c20 7a6e 6f72  vide( zeta, znor
-000410e0: 6d2e 5429 200d 0a20 2020 2020 2020 2020  m.T) ..         
-000410f0: 2020 2023 2061 626f 7665 206d 6179 2072     # above may r
-00041100: 6570 6f72 7420 6e61 6e20 7761 726e 696e  eport nan warnin
-00041110: 672c 2062 7574 2066 6f6c 6c6f 7769 6e67  g, but following
-00041120: 2063 6f72 7265 6374 7320 7468 6573 6520   corrects these 
-00041130: 7661 6c75 6573 2e0d 0a20 2020 2020 2020  values...       
-00041140: 2020 2020 2075 6e69 745a 6574 615b 207a       unitZeta[ z
-00041150: 6574 616e 6f72 6d20 3c3d 2030 2e30 2c20  etanorm <= 0.0, 
-00041160: 3a20 5d20 3d20 5b30 2e30 2c30 2e30 2c30  : ] = [0.0,0.0,0
-00041170: 2e30 5d0d 0a20 2020 2020 2020 2020 2020  .0]..           
-00041180: 2070 726f 6a56 6572 7473 203d 2041 202b   projVerts = A +
-00041190: 2064 6973 742a 756e 6974 5a65 7461 0d0a   dist*unitZeta..
-000411a0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-000411b0: 726e 2070 726f 6a56 6572 7473 2e54 0d0a  rn projVerts.T..
-000411c0: 2020 2020 2020 2020 6465 6620 7072 6f6a          def proj
-000411d0: 6563 745f 7370 6828 7879 7a29 203a 0d0a  ect_sph(xyz) :..
-000411e0: 2020 2020 2020 2020 2020 2020 7665 7274              vert
-000411f0: 7320 3d20 7879 7a2e 540d 0a20 2020 2020  s = xyz.T..     
-00041200: 2020 2020 2020 2064 7072 6f64 203d 206e         dprod = n
-00041210: 702e 6c69 6e61 6c67 2e6e 6f72 6d28 7665  p.linalg.norm(ve
-00041220: 7274 732c 6178 6973 3d31 290d 0a20 2020  rts,axis=1)..   
-00041230: 2020 2020 2020 2020 2074 6e6f 726d 203d           tnorm =
-00041240: 206e 702e 7469 6c65 2864 7072 6f64 2c20   np.tile(dprod, 
-00041250: 2833 2c31 2920 290d 0a20 2020 2020 2020  (3,1) )..       
-00041260: 2020 2020 2075 6e69 7456 6572 7473 203d       unitVerts =
-00041270: 206e 702e 6469 7669 6465 2820 7665 7274   np.divide( vert
-00041280: 732c 2074 6e6f 726d 2e54 2029 0d0a 2020  s, tnorm.T )..  
-00041290: 2020 2020 2020 2020 2020 7072 6f6a 5665            projVe
-000412a0: 7274 7320 3d20 6469 7374 202a 2075 6e69  rts = dist * uni
-000412b0: 7456 6572 7473 0d0a 2020 2020 2020 2020  tVerts..        
-000412c0: 2020 2020 7265 7475 726e 2070 726f 6a56      return projV
-000412d0: 6572 7473 2e54 0d0a 2020 2020 2020 2020  erts.T..        
-000412e0: 2320 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  # ..............
-000412f0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00041300: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00041310: 2e2e 2e2e 2e2e 2e2e 2e0d 0a20 2020 2020  ...........     
-00041320: 2020 2070 726f 6a65 6374 203d 2070 726f     project = pro
-00041330: 6a65 6374 5f70 6c61 6e65 0d0a 2020 2020  ject_plane..    
-00041340: 2020 2020 6966 2063 6f6f 7220 3d3d 2031      if coor == 1
-00041350: 203a 2070 726f 6a65 6374 203d 2070 726f   : project = pro
-00041360: 6a65 6374 5f63 796c 0d0a 2020 2020 2020  ject_cyl..      
-00041370: 2020 6966 2063 6f6f 7220 3d3d 2032 203a    if coor == 2 :
-00041380: 2070 726f 6a65 6374 203d 2070 726f 6a65   project = proje
-00041390: 6374 5f73 7068 0d0a 0d0a 2020 2020 2020  ct_sph....      
-000413a0: 2020 7265 7475 726e 2073 656c 662e 6d61    return self.ma
-000413b0: 705f 6765 6f6d 5f66 726f 6d5f 6f70 2820  p_geom_from_op( 
-000413c0: 7072 6f6a 6563 7420 290d 0a0d 0a20 2020  project )....   
-000413d0: 2064 6566 2063 6c69 7028 7365 6c66 2c20   def clip(self, 
-000413e0: 6f70 6572 6174 696f 6e29 203a 0d0a 2020  operation) :..  
-000413f0: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
-00041400: 2020 2052 656d 6f76 6520 7365 676d 656e     Remove segmen
-00041410: 7473 2066 726f 6d20 7468 6520 6c69 6e65  ts from the line
-00041420: 2e0d 0a20 2020 2020 2020 204e 4f54 453a  ...        NOTE:
-00041430: 2061 6c6c 206f 7065 7261 7469 6f6e 7320   all operations 
-00041440: 6172 6520 696e 2078 797a 2063 6f6f 7264  are in xyz coord
-00041450: 696e 6174 6573 2e0d 0a0d 0a20 2020 2020  inates.....     
-00041460: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
-00041470: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-00041480: 2d0d 0a20 2020 2020 2020 206f 7065 7261  -..        opera
-00041490: 7469 6f6e 203a 2066 756e 6374 696f 6e20  tion : function 
-000414a0: 6f62 6a65 6374 0d0a 2020 2020 2020 2020  object..        
-000414b0: 2020 2020 4675 6e63 7469 6f6e 2074 6861      Function tha
-000414c0: 7420 7461 6b65 7320 6f6e 6520 6172 6775  t takes one argu
-000414d0: 6d65 6e74 2c20 6120 3378 4e20 4e75 6d70  ment, a 3xN Nump
-000414e0: 7920 6172 7261 7920 6f66 2063 6f6f 7264  y array of coord
-000414f0: 696e 6174 6573 2e0d 0a20 2020 2020 2020  inates...       
-00041500: 2020 2020 2054 6865 2066 756e 6374 696f       The functio
-00041510: 6e20 7265 7475 726e 7320 4e20 6172 7261  n returns N arra
-00041520: 7920 6f66 2062 6f6f 6c20 7b20 5472 7565  y of bool { True
-00041530: 2c20 4661 6c73 6520 7d20 696e 6469 6361  , False } indica
-00041540: 7469 6e67 2069 660d 0a20 2020 2020 2020  ting if..       
-00041550: 2020 2020 2074 6865 2073 6567 6d65 6e74       the segment
-00041560: 2c20 6174 2074 6865 2073 6567 6d65 6e74  , at the segment
-00041570: 2063 656e 7465 7220 636f 6f72 6469 6e61   center coordina
-00041580: 7465 2c20 6973 2074 6f20 6265 200d 0a20  te, is to be .. 
-00041590: 2020 2020 2020 2020 2020 2072 6574 6169             retai
-000415a0: 6e65 6420 2854 7275 6529 2e20 204f 7468  ned (True).  Oth
-000415b0: 6572 7769 7365 2c20 7468 6520 7365 676d  erwise, the segm
-000415c0: 656e 7420 6973 2072 656d 6f76 6564 2066  ent is removed f
-000415d0: 726f 6d20 7468 650d 0a20 2020 2020 2020  rom the..       
-000415e0: 2020 2020 206c 696e 6520 2846 616c 7365       line (False
-000415f0: 292e 0d0a 0d0a 2020 2020 2020 2020 5265  ).....        Re
-00041600: 7475 726e 730d 0a20 2020 2020 2020 202d  turns..        -
-00041610: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
-00041620: 7365 6c66 203a 206c 696e 6520 6f62 6a65  self : line obje
-00041630: 6374 0d0a 0d0a 2020 2020 2020 2020 2222  ct....        ""
-00041640: 220d 0a20 2020 2020 2020 2023 202d 2d2d  "..        # ---
-00041650: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00041660: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00041670: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
-00041680: 636f 6c6f 7273 203d 2073 656c 662e 5f65  colors = self._e
-00041690: 6467 6563 6f6c 6f72 730d 0a20 2020 2020  dgecolors..     
-000416a0: 2020 2073 6567 6d65 6e74 7320 3d20 7365     segments = se
-000416b0: 6c66 2e5f 7365 676d 656e 7473 3364 0d0a  lf._segments3d..
-000416c0: 0d0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
-000416d0: 662e 7265 7374 6f72 6564 436c 6970 2069  f.restoredClip i
-000416e0: 7320 4e6f 6e65 203a 0d0a 2020 2020 2020  s None :..      
-000416f0: 2020 2020 2020 7365 6c66 2e72 6573 746f        self.resto
-00041700: 7265 6443 6c69 7020 3d20 7b20 0d0a 2020  redClip = { ..  
-00041710: 2020 2020 2020 2020 2020 2020 2020 2769                'i
-00041720: 6e64 6963 6573 2720 3a20 7365 6c66 2e73  ndices' : self.s
-00041730: 6567 6d49 6e64 6963 6573 2c20 0d0a 2020  egmIndices, ..  
-00041740: 2020 2020 2020 2020 2020 2020 2020 2763                'c
-00041750: 6f6c 6f72 7327 203a 2063 6f6c 6f72 732c  olors' : colors,
-00041760: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00041770: 2020 2769 7353 6872 6564 6465 6427 203a    'isShredded' :
-00041780: 2073 656c 662e 6973 5368 7265 6464 6564   self.isShredded
-00041790: 207d 0d0a 0d0a 2020 2020 2020 2020 6966   }....        if
-000417a0: 206e 6f74 2073 656c 662e 6973 5368 7265   not self.isShre
-000417b0: 6464 6564 203a 0d0a 2020 2020 2020 2020  dded :..        
-000417c0: 2020 2020 2320 2e2e 2e2e 206e 6f74 653a      # .... note:
-000417d0: 636f 6c6f 7273 206d 6f64 6966 6965 642c  colors modified,
-000417e0: 206e 6f74 2063 7265 6174 6564 0d0a 2020   not created..  
-000417f0: 2020 2020 2020 2020 2020 636f 6c6f 7273            colors
-00041800: 203d 2073 656c 662e 5f73 6872 6564 5f63   = self._shred_c
-00041810: 6f6c 6f72 2829 0d0a 2020 2020 2020 2020  olor()..        
-00041820: 2020 2020 7365 676d 656e 7473 203d 2073      segments = s
-00041830: 656c 662e 5f73 6872 6564 2829 0d0a 2020  elf._shred()..  
-00041840: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00041850: 6564 6765 636f 6c6f 7273 203d 2063 6f6c  edgecolors = col
-00041860: 6f72 730d 0a20 2020 2020 2020 2065 6c73  ors..        els
-00041870: 6520 3a0d 0a20 2020 2020 2020 2020 2020  e :..           
-00041880: 206c 656e 436f 6c20 3d20 6c65 6e28 7365   lenCol = len(se
-00041890: 6c66 2e5f 6564 6765 636f 6c6f 7273 290d  lf._edgecolors).
-000418a0: 0a20 2020 2020 2020 2020 2020 206c 656e  .            len
-000418b0: 5365 6720 3d20 6c65 6e28 7365 676d 656e  Seg = len(segmen
-000418c0: 7473 290d 0a20 2020 2020 2020 2020 2020  ts)..           
-000418d0: 2069 6620 6c65 6e43 6f6c 2021 3d20 6c65   if lenCol != le
-000418e0: 6e53 6567 203a 2063 6f6c 6f72 7320 3d20  nSeg : colors = 
-000418f0: 7365 6c66 2e5f 7368 7265 645f 636f 6c6f  self._shred_colo
-00041900: 7228 290d 0a20 2020 2020 2020 2023 202d  r()..        # -
-00041910: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00041920: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00041930: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
-00041940: 2020 7365 6743 6f6f 7220 3d20 7365 6c66    segCoor = self
-00041950: 2e5f 6765 745f 7365 676d 656e 745f 6365  ._get_segment_ce
-00041960: 6e74 6572 7328 7365 676d 656e 7473 290d  nters(segments).
-00041970: 0a20 2020 2020 2020 2078 797a 203d 206e  .        xyz = n
-00041980: 702e 7472 616e 7370 6f73 6528 7365 6743  p.transpose(segC
-00041990: 6f6f 7229 0d0a 2020 2020 2020 2020 7368  oor)..        sh
-000419a0: 6f75 6c64 4b65 6570 203d 206e 702e 6172  ouldKeep = np.ar
-000419b0: 7261 7928 6f70 6572 6174 696f 6e28 7879  ray(operation(xy
-000419c0: 7a29 290d 0a0d 0a20 2020 2020 2020 2069  z))....        i
-000419d0: 6620 6e70 2e61 6e79 2873 686f 756c 644b  f np.any(shouldK
-000419e0: 6565 7029 2069 7320 4e6f 6e65 203a 0d0a  eep) is None :..
-000419f0: 2020 2020 2020 2020 2020 2020 7761 726e              warn
-00041a00: 696e 6773 2e77 6172 6e28 2757 4152 4e49  ings.warn('WARNI
-00041a10: 4e47 3a20 436c 6970 7069 6e67 2072 6573  NG: Clipping res
-00041a20: 756c 7465 6420 696e 206e 6f20 6c69 6e65  ulted in no line
-00041a30: 7320 666f 756e 642c 206c 696e 6520 7265  s found, line re
-00041a40: 7475 726e 2075 6e63 6c69 7070 6564 2e27  turn unclipped.'
-00041a50: 290d 0a20 2020 2020 2020 2020 2020 2072  )..            r
-00041a60: 6574 7572 6e20 7365 6c66 0d0a 0d0a 2020  eturn self....  
-00041a70: 2020 2020 2020 636c 6970 496e 6469 6365        clipIndice
-00041a80: 7320 3d20 6e70 2e61 7272 6179 2873 656c  s = np.array(sel
-00041a90: 662e 7365 676d 496e 6469 6365 7329 5b73  f.segmIndices)[s
-00041aa0: 686f 756c 644b 6565 705d 0d0a 2020 2020  houldKeep]..    
-00041ab0: 2020 2020 636c 6970 436f 6c6f 7273 203d      clipColors =
-00041ac0: 2063 6f6c 6f72 735b 7368 6f75 6c64 4b65   colors[shouldKe
-00041ad0: 6570 5d0d 0a20 2020 2020 2020 200d 0a20  ep]..        .. 
-00041ae0: 2020 2020 2020 2063 6c69 7043 6f6c 6f72         clipColor
-00041af0: 7320 3d20 6e70 2e61 7272 6179 2863 6c69  s = np.array(cli
-00041b00: 7043 6f6c 6f72 7329 0d0a 2020 2020 2020  pColors)..      
-00041b10: 2020 636c 6970 436f 6f72 203d 2073 656c    clipCoor = sel
-00041b20: 662e 7665 7274 6578 436f 6f72 5b20 206e  f.vertexCoor[  n
-00041b30: 702e 6172 7261 7928 636c 6970 496e 6469  p.array(clipIndi
-00041b40: 6365 7329 205d 2020 2023 2074 6865 206c  ces) ]   # the l
-00041b50: 696e 6573 6574 2069 7320 7368 7265 6464  ineset is shredd
-00041b60: 6564 2073 6f20 6361 6e20 646f 2074 6869  ed so can do thi
-00041b70: 732e 0d0a 2020 2020 2020 2020 7365 6c66  s...        self
-00041b80: 2e73 6574 5f73 6567 6d65 6e74 7328 636c  .set_segments(cl
-00041b90: 6970 436f 6f72 290d 0a20 2020 2020 2020  ipCoor)..       
-00041ba0: 2073 656c 662e 7365 745f 636f 6c6f 7228   self.set_color(
-00041bb0: 636c 6970 436f 6c6f 7273 290d 0a20 2020  clipColors)..   
-00041bc0: 2020 2020 2023 2046 7574 4465 763a 2027       # FutDev: '
-00041bd0: 636f 7272 6563 7427 2064 6566 696e 6974  correct' definit
-00041be0: 696f 6e20 7368 6f75 6c64 2075 7365 206e  ion should use n
-00041bf0: 7061 7272 6179 7320 666f 7220 7365 676d  parrays for segm
-00041c00: 496e 6469 6365 7320 6e6f 7420 6c69 7374  Indices not list
-00041c10: 7320 0d0a 2020 2020 2020 2020 2320 7365  s ..        # se
-00041c20: 6c66 2e73 6567 6d49 6e64 6963 6573 203d  lf.segmIndices =
-00041c30: 2063 6c69 7049 6e64 6963 6573 2020 2e2e   clipIndices  ..
-00041c40: 2e20 6275 6720 6669 782c 2020 6a75 7374  . bug fix,  just
-00041c50: 2061 2062 616e 6461 6964 2e0d 0a20 2020   a bandaid...   
-00041c60: 2020 2020 2073 656c 662e 7365 676d 496e       self.segmIn
-00041c70: 6469 6365 7320 3d20 636c 6970 496e 6469  dices = clipIndi
-00041c80: 6365 732e 746f 6c69 7374 2829 0d0a 0d0a  ces.tolist()....
-00041c90: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00041ca0: 656c 660d 0a0d 0a20 2020 2064 6566 2063  elf....    def c
-00041cb0: 6c69 705f 706c 616e 6528 7365 6c66 2c64  lip_plane(self,d
-00041cc0: 6973 742c 2a2a 6b61 7267 7329 203a 0d0a  ist,**kargs) :..
-00041cd0: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
-00041ce0: 2020 2020 2052 656d 6f76 6520 7365 676d       Remove segm
-00041cf0: 656e 7473 2066 726f 6d20 7468 6520 6c69  ents from the li
-00041d00: 6e65 2062 6173 6564 206f 6e20 6120 636c  ne based on a cl
-00041d10: 6970 2073 7572 6661 6365 2e0d 0a0d 0a20  ip surface..... 
-00041d20: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-00041d30: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
-00041d40: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2064  -----..        d
-00041d50: 6973 7420 3a20 6e75 6d62 6572 2c20 6f70  ist : number, op
-00041d60: 7469 6f6e 616c 2c20 6465 6661 756c 7420  tional, default 
-00041d70: 3a20 302e 3020 0d0a 2020 2020 2020 2020  : 0.0 ..        
-00041d80: 2020 2020 4469 7374 616e 6365 2066 726f      Distance fro
-00041d90: 6d20 7468 6520 6f72 6967 696e 2074 6f20  m the origin to 
-00041da0: 7468 6520 636c 6970 2073 7572 6661 6365  the clip surface
-00041db0: 2c0d 0a20 2020 2020 2020 2020 2020 2061  ,..            a
-00041dc0: 6c6f 6e67 2074 6865 2064 6972 6563 7469  long the directi
-00041dd0: 6f6e 2076 6563 746f 722e 0d0a 0d0a 2020  on vector.....  
-00041de0: 2020 2020 2020 6469 7265 6374 696f 6e20        direction 
-00041df0: 3a20 6172 7261 792d 6c69 6b65 2c20 6f70  : array-like, op
-00041e00: 7469 6f6e 616c 2c20 6465 6661 756c 743a  tional, default:
-00041e10: 205b 302c 302c 315d 0d0a 2020 2020 2020   [0,0,1]..      
-00041e20: 2020 2020 2020 4120 7879 7a20 7665 6374        A xyz vect
-00041e30: 6f72 206e 6f72 6d61 6c20 746f 2074 6865  or normal to the
-00041e40: 2069 6e74 6572 7365 6374 696f 6e20 706c   intersection pl
-00041e50: 616e 650d 0a20 2020 2020 2020 2020 2020  ane..           
-00041e60: 2066 6f72 2061 2070 6c61 6e61 7220 636c   for a planar cl
-00041e70: 6970 2073 7572 6661 6365 206f 7220 6178  ip surface or ax
-00041e80: 6961 6c20 6469 7265 6374 696f 6e20 6f66  ial direction of
-00041e90: 200d 0a20 2020 2020 2020 2020 2020 2061   ..            a
-00041ea0: 2063 796c 696e 6465 7220 666f 7220 6120   cylinder for a 
-00041eb0: 6379 6c69 6e64 7269 6361 6c20 636c 6970  cylindrical clip
-00041ec0: 2073 7572 6661 6365 2e0d 0a0d 0a20 2020   surface.....   
-00041ed0: 2020 2020 2063 6f6f 7220 3a20 696e 7465       coor : inte
-00041ee0: 6765 7220 6f72 2073 7472 696e 6720 696e  ger or string in
-00041ef0: 6469 6361 7469 6e67 2074 6865 2074 7970  dicating the typ
-00041f00: 6520 6f66 2063 6c69 7020 7375 7266 6163  e of clip surfac
-00041f10: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00041f20: 302c 2070 2c20 502c 2078 797a 2c70 6c61  0, p, P, xyz,pla
-00041f30: 6e61 7220 2020 2020 2020 2020 2020 2020  nar             
-00041f40: 2020 2020 2d20 706c 616e 6172 2028 6465      - planar (de
-00041f50: 6661 756c 7429 0d0a 2020 2020 2020 2020  fault)..        
-00041f60: 2020 2020 312c 2063 2c20 432c 2063 796c      1, c, C, cyl
-00041f70: 696e 6465 722c 7070 6c61 722c 6379 6c69  inder,pplar,cyli
-00041f80: 6e64 7269 6361 6c20 2d20 6379 6c69 6e64  ndrical - cylind
-00041f90: 6572 0d0a 2020 2020 2020 2020 2020 2020  er..            
-00041fa0: 322c 2073 2c20 532c 2073 7068 6572 652c  2, s, S, sphere,
-00041fb0: 7370 6865 7269 6361 6c20 2020 2020 2020  spherical       
-00041fc0: 2020 2020 2d20 7370 6865 7265 0d0a 2020      - sphere..  
-00041fd0: 2020 2020 2020 2020 2020 332c 2078 2c20            3, x, 
-00041fe0: 5820 2020 2020 2020 2020 2020 2020 2020  X               
-00041ff0: 2020 2020 2020 2020 2020 2020 2020 2d20                - 
-00042000: 792d 7a20 706c 616e 650d 0a20 2020 2020  y-z plane..     
-00042010: 2020 2020 2020 2034 2c20 792c 2059 2020         4, y, Y  
-00042020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042030: 2020 2020 2020 2020 2020 202d 2078 2d7a             - x-z
-00042040: 2070 6c61 6e65 0d0a 2020 2020 2020 2020   plane..        
-00042050: 2020 2020 352c 207a 2c20 5a20 2020 2020      5, z, Z     
-00042060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042070: 2020 2020 2020 2020 2d20 782d 7920 706c          - x-y pl
-00042080: 616e 650d 0a0d 0a20 2020 2020 2020 2052  ane....        R
-00042090: 6574 7572 6e73 0d0a 2020 2020 2020 2020  eturns..        
-000420a0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-000420b0: 2073 656c 6620 3a20 6c69 6e65 206f 626a   self : line obj
-000420c0: 6563 740d 0a0d 0a20 2020 2020 2020 2022  ect....        "
-000420d0: 2222 0d0a 2020 2020 2020 2020 2023 202e  ""..         # .
-000420e0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-000420f0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00042100: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00042110: 2e2e 2e2e 2e2e 2e2e 2e2e 0d0a 2020 2020  ............    
-00042120: 2020 2020 6465 6620 636c 6970 5f6f 7028      def clip_op(
-00042130: 7879 7a2c 6469 7374 2c63 6f6f 722c 6469  xyz,dist,coor,di
-00042140: 7265 6374 696f 6e29 203a 0d0a 2020 2020  rection) :..    
-00042150: 2020 2020 2020 2020 6162 6320 3d20 6e70          abc = np
-00042160: 2e74 7261 6e73 706f 7365 2878 797a 290d  .transpose(xyz).
-00042170: 0a20 2020 2020 2020 2020 2020 2064 6f74  .            dot
-00042180: 7072 6f64 203d 205f 636f 6f72 5f64 6f74  prod = _coor_dot
-00042190: 7072 6f64 2864 6972 6563 7469 6f6e 2c63  prod(direction,c
-000421a0: 6f6f 722c 6162 6329 0d0a 2020 2020 2020  oor,abc)..      
-000421b0: 2020 2020 2020 7368 6f75 6c64 636c 6970        shouldclip
-000421c0: 203d 206e 702e 6c65 7373 2864 6f74 7072   = np.less(dotpr
-000421d0: 6f64 2c6e 702e 6675 6c6c 286c 656e 2864  od,np.full(len(d
-000421e0: 6f74 7072 6f64 292c 6469 7374 2929 0d0a  otprod),dist))..
-000421f0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00042200: 726e 2073 686f 756c 6463 6c69 700d 0a20  rn shouldclip.. 
-00042210: 2020 2020 2020 2023 202e 2e2e 2e2e 2e2e         # .......
-00042220: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00042230: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00042240: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00042250: 2e2e 2e2e 0d0a 2020 2020 2020 2020 6469  ......        di
-00042260: 7244 6674 203d 207b 2027 6469 7265 6374  rDft = { 'direct
-00042270: 696f 6e27 3a20 5b30 2c30 2c31 2e30 5d20  ion': [0,0,1.0] 
-00042280: 7d0d 0a20 2020 2020 2020 206b 6172 6744  }..        kargD
-00042290: 6674 203d 207b 202a 2a5f 434f 4f52 5f4b  ft = { **_COOR_K
-000422a0: 5741 5247 532c 202a 2a64 6972 4466 7420  WARGS, **dirDft 
-000422b0: 7d0d 0a20 2020 2020 2020 204b 5720 3d20  }..        KW = 
-000422c0: 4b57 7072 6f63 6573 736f 7228 206b 6172  KWprocessor( kar
-000422d0: 6744 6674 2c20 2763 6c69 705f 706c 616e  gDft, 'clip_plan
-000422e0: 6527 2c20 2a2a 6b61 7267 7329 0d0a 2020  e', **kargs)..  
-000422f0: 2020 2020 2020 636f 6f72 203d 204b 572e        coor = KW.
-00042300: 6765 7456 616c 2827 636f 6f72 2729 0d0a  getVal('coor')..
-00042310: 2020 2020 2020 2020 6469 7265 6374 696f          directio
-00042320: 6e20 3d20 4b57 2e67 6574 5661 6c28 2764  n = KW.getVal('d
-00042330: 6972 6563 7469 6f6e 2729 0d0a 0d0a 2020  irection')....  
-00042340: 2020 2020 2020 6966 2063 6f6f 723d 3d33        if coor==3
-00042350: 203a 2063 6f6f 722c 2064 6972 6563 7469   : coor, directi
-00042360: 6f6e 203d 2030 2c20 5b20 312c 302c 3020  on = 0, [ 1,0,0 
-00042370: 5d0d 0a20 2020 2020 2020 2069 6620 636f  ]..        if co
-00042380: 6f72 3d3d 3420 3a20 636f 6f72 2c20 6469  or==4 : coor, di
-00042390: 7265 6374 696f 6e20 3d20 302c 205b 2030  rection = 0, [ 0
-000423a0: 2c31 2c30 205d 0d0a 2020 2020 2020 2020  ,1,0 ]..        
-000423b0: 6966 2063 6f6f 723d 3d35 203a 2063 6f6f  if coor==5 : coo
-000423c0: 722c 2064 6972 6563 7469 6f6e 203d 2030  r, direction = 0
-000423d0: 2c20 5b20 302c 302c 3120 5d0d 0a20 2020  , [ 0,0,1 ]..   
-000423e0: 2020 2020 200d 0a20 2020 2020 2020 2072       ..        r
-000423f0: 6574 7572 6e20 7365 6c66 2e63 6c69 7028  eturn self.clip(
-00042400: 6c61 6d62 6461 2078 797a 203a 2063 6c69  lambda xyz : cli
-00042410: 705f 6f70 2878 797a 2c64 6973 742c 636f  p_op(xyz,dist,co
-00042420: 6f72 2c64 6972 6563 7469 6f6e 2920 290d  or,direction) ).
-00042430: 0a0d 0a20 2020 2064 6566 205f 7265 7374  ...    def _rest
-00042440: 6f72 655f 6672 6f6d 5f63 6c69 7028 7365  ore_from_clip(se
-00042450: 6c66 2920 3a0d 0a20 2020 2020 2020 2022  lf) :..        "
-00042460: 2222 0d0a 2020 2020 2020 2020 5265 7365  ""..        Rese
-00042470: 7420 7365 676d 656e 7420 616e 6420 636f  t segment and co
-00042480: 6c6f 7273 2070 7269 6f72 2074 6f20 616e  lors prior to an
-00042490: 7920 636c 6970 206f 7065 7261 7469 6f6e  y clip operation
-000424a0: 2e0d 0a20 2020 2020 2020 2028 696e 2064  ...        (in d
-000424b0: 6576 656c 6f70 6d65 6e74 290d 0a20 2020  evelopment)..   
-000424c0: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
-000424d0: 2020 0d0a 2020 2020 2020 2020 6966 2073    ..        if s
-000424e0: 656c 662e 7265 7374 6f72 6564 436c 6970  elf.restoredClip
-000424f0: 2069 7320 4e6f 6e65 203a 0d0a 2020 2020   is None :..    
-00042500: 2020 2020 2020 2020 7761 726e 696e 6773          warnings
-00042510: 2e77 6172 6e28 2754 6865 7265 2061 7265  .warn('There are
-00042520: 206e 6f20 636c 6970 7065 6420 6c69 6e65   no clipped line
-00042530: 7320 746f 2072 6573 746f 7265 2e27 290d  s to restore.').
-00042540: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00042550: 7572 6e20 7365 6c66 0d0a 0d0a 2020 2020  urn self....    
-00042560: 2020 2020 7365 6c66 2e69 7353 6872 6564      self.isShred
-00042570: 6465 6420 3d20 7365 6c66 2e72 6573 746f  ded = self.resto
-00042580: 7265 6443 6c69 705b 2769 7353 6872 6564  redClip['isShred
-00042590: 6465 6427 5d0d 0a20 2020 2020 2020 2073  ded']..        s
-000425a0: 656c 662e 7365 745f 636f 6c6f 7228 2073  elf.set_color( s
-000425b0: 656c 662e 7265 7374 6f72 6564 436c 6970  elf.restoredClip
-000425c0: 5b27 636f 6c6f 7273 275d 2029 0d0a 2020  ['colors'] )..  
-000425d0: 2020 2020 2020 7365 6c66 2e73 6567 6d49        self.segmI
-000425e0: 6e64 6963 6573 203d 2073 656c 662e 7265  ndices = self.re
-000425f0: 7374 6f72 6564 436c 6970 5b27 696e 6469  storedClip['indi
-00042600: 6365 7327 5d0d 0a20 2020 2020 2020 2073  ces']..        s
-00042610: 6567 6d49 6e64 6963 6573 203d 2073 656c  egmIndices = sel
-00042620: 662e 7365 676d 496e 6469 6365 730d 0a0d  f.segmIndices...
-00042630: 0a20 2020 2020 2020 2073 6567 6d65 6e74  .        segment
-00042640: 7320 3d20 7365 6c66 2e5f 6765 745f 7365  s = self._get_se
-00042650: 676d 656e 7473 2820 7365 6c66 2e76 6572  gments( self.ver
-00042660: 7465 7843 6f6f 722c 2073 6567 6d49 6e64  texCoor, segmInd
-00042670: 6963 6573 2020 290d 0a20 2020 2020 2020  ices  )..       
-00042680: 2073 656c 662e 7365 745f 7365 676d 656e   self.set_segmen
-00042690: 7473 2873 6567 6d65 6e74 7329 2020 2020  ts(segments)    
-000426a0: 0d0a 2020 2020 2020 2020 7365 6c66 2e72  ..        self.r
-000426b0: 6573 746f 7265 6443 6c69 7020 3d20 4e6f  estoredClip = No
-000426c0: 6e65 0d0a 2020 2020 2020 2020 7265 7475  ne..        retu
-000426d0: 726e 2073 656c 660d 0a0d 0a20 2020 2064  rn self....    d
-000426e0: 6566 2073 6574 5f6c 696e 655f 616c 7068  ef set_line_alph
-000426f0: 6128 7365 6c66 2c20 616c 7068 612c 2063  a(self, alpha, c
-00042700: 6f6e 7374 616e 743d 4661 6c73 6529 203a  onstant=False) :
-00042710: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
-00042720: 2020 2020 2020 2041 646a 7573 7420 7468         Adjust th
-00042730: 6520 616c 7068 6120 7661 6c75 6520 6f66  e alpha value of
-00042740: 2074 6865 206c 696e 6520 7365 676d 656e   the line segmen
-00042750: 7420 636f 6c6f 7273 2e0d 0a0d 0a20 2020  t colors.....   
-00042760: 2020 2020 2050 6172 616d 6574 6572 730d       Parameters.
-00042770: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00042780: 2d2d 2d0d 0a20 2020 2020 2020 2061 6c70  ---..        alp
-00042790: 6861 203a 2073 6361 6c61 720d 0a20 2020  ha : scalar..   
-000427a0: 2020 2020 2020 2020 2020 2041 6c70 6861             Alpha
-000427b0: 2069 7320 696e 2074 6865 2064 6f6d 6169   is in the domai
-000427c0: 6e20 3020 746f 2031 2e0d 0a0d 0a20 2020  n 0 to 1.....   
-000427d0: 2020 2020 2063 6f6e 7374 616e 7420 3a20       constant : 
-000427e0: 626f 6f6c 207b 2054 7275 652c 2046 616c  bool { True, Fal
-000427f0: 7365 207d 2c20 6f70 7469 6f6e 616c 2c20  se }, optional, 
-00042800: 4661 6c73 650d 0a20 2020 2020 2020 2020  False..         
-00042810: 2020 2049 6620 4661 6c73 652c 2073 6567     If False, seg
-00042820: 6d65 6e74 2063 6f6c 6f72 2076 616c 7565  ment color value
-00042830: 7320 6172 6520 6d75 6c74 6970 6c69 6564  s are multiplied
-00042840: 2062 790d 0a20 2020 2020 2020 2020 2020   by..           
-00042850: 2061 6c70 6861 2e20 2049 6620 5472 7565   alpha.  If True
-00042860: 2c20 616c 6c20 7365 676d 656e 7420 636f  , all segment co
-00042870: 6c6f 7273 2061 6c70 6861 2063 6861 6e6e  lors alpha chann
-00042880: 656c 730d 0a20 2020 2020 2020 2020 2020  els..           
-00042890: 2061 7265 2061 7373 6967 6e65 6420 746f   are assigned to
-000428a0: 2061 6c70 6861 2e0d 0a0d 0a20 2020 2020   alpha.....     
-000428b0: 2020 2052 6574 7572 6e73 0d0a 2020 2020     Returns..    
-000428c0: 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020      -------..   
-000428d0: 2020 2020 2073 656c 6620 3a20 6c69 6e65       self : line
-000428e0: 206f 626a 6563 740d 0a0d 0a20 2020 2020   object....     
-000428f0: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
-00042900: 0d0a 2020 2020 2020 2020 6966 2028 616c  ..        if (al
-00042910: 7068 613c 302e 3029 206f 7220 2861 6c70  pha<0.0) or (alp
-00042920: 6861 3e31 2e30 2920 3a0d 0a20 2020 2020  ha>1.0) :..     
-00042930: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-00042940: 7565 4572 726f 7228 276c 696e 6520 616c  ueError('line al
-00042950: 7068 6120 6d75 7374 2062 6520 6265 7477  pha must be betw
-00042960: 6565 6e20 3020 616e 6420 312c 2066 6f75  een 0 and 1, fou
-00042970: 6e64 207b 7d27 2e66 6f72 6d61 7428 616c  nd {}'.format(al
-00042980: 7068 6129 290d 0a0d 0a20 2020 2020 2020  pha))....       
-00042990: 206f 7269 675f 636f 6c6f 7273 203d 2073   orig_colors = s
-000429a0: 656c 662e 5f65 6467 6563 6f6c 6f72 730d  elf._edgecolors.
-000429b0: 0a20 2020 2020 2020 2069 6620 636f 6e73  .        if cons
-000429c0: 7461 6e74 203a 0d0a 2020 2020 2020 2020  tant :..        
-000429d0: 2020 2020 6e70 2e70 7574 5f61 6c6f 6e67      np.put_along
-000429e0: 5f61 7869 7328 6f72 6967 5f63 6f6c 6f72  _axis(orig_color
-000429f0: 732c 206e 702e 6172 7261 7928 5b5b 335d  s, np.array([[3]
-00042a00: 5d29 2c20 616c 7068 612c 2061 7869 733d  ]), alpha, axis=
-00042a10: 3129 0d0a 2020 2020 2020 2020 2020 2020  1)..            
-00042a20: 636f 6c6f 724d 6170 203d 206f 7269 675f  colorMap = orig_
-00042a30: 636f 6c6f 7273 0d0a 2020 2020 2020 2020  colors..        
-00042a40: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-00042a50: 2020 2063 6f6c 6f72 4d61 7020 3d20 6e70     colorMap = np
-00042a60: 2e6d 756c 7469 706c 7928 6f72 6967 5f63  .multiply(orig_c
-00042a70: 6f6c 6f72 732c 6e70 2e61 7272 6179 285b  olors,np.array([
-00042a80: 312e 302c 312e 302c 312e 302c 616c 7068  1.0,1.0,1.0,alph
-00042a90: 615d 2929 0d0a 2020 2020 2020 2020 0d0a  a]))..        ..
-00042aa0: 2020 2020 2020 2020 7365 6c66 2e5f 6564          self._ed
-00042ab0: 6765 636f 6c6f 7273 203d 2063 6f6c 6f72  gecolors = color
-00042ac0: 4d61 700d 0a0d 0a20 2020 2020 2020 2072  Map....        r
-00042ad0: 6574 7572 6e20 7365 6c66 0d0a 0d0a 2020  eturn self....  
-00042ae0: 2020 6465 6620 7368 6164 6528 7365 6c66    def shade(self
-00042af0: 2c20 6465 7074 683d 302c 2064 6972 6563  , depth=0, direc
-00042b00: 7469 6f6e 3d4e 6f6e 652c 2063 6f6e 7472  tion=None, contr
-00042b10: 6173 743d 4e6f 6e65 2920 3a0d 0a20 2020  ast=None) :..   
-00042b20: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
-00042b30: 2020 5265 6475 6365 206c 696e 6520 4853    Reduce line HS
-00042b40: 5620 636f 6c6f 7220 5661 6c75 6520 6261  V color Value ba
-00042b50: 7365 6420 6f6e 206c 696e 6520 7365 676d  sed on line segm
-00042b60: 656e 7420 6469 7265 6374 696f 6e2e 0d0a  ent direction...
-00042b70: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00042b80: 2020 5468 6520 646f 7420 7072 6f64 7563    The dot produc
-00042b90: 7420 6f66 206c 696e 6520 7365 676d 656e  t of line segmen
-00042ba0: 7420 7769 7468 2074 6865 2069 6c6c 756d  t with the illum
-00042bb0: 696e 6174 696f 6e20 6469 7265 6374 696f  ination directio
-00042bc0: 6e20 0d0a 2020 2020 2020 2020 6973 2075  n ..        is u
-00042bd0: 7365 6420 746f 2061 646a 7573 7420 6661  sed to adjust fa
-00042be0: 6365 2048 5356 2063 6f6c 6f72 2076 616c  ce HSV color val
-00042bf0: 7565 2e0d 0a0d 0a20 2020 2020 2020 2050  ue.....        P
-00042c00: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
-00042c10: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
-00042c20: 2020 2020 2020 2064 6570 7468 203a 2073         depth : s
-00042c30: 6361 6c61 722c 206f 7074 696f 6e61 6c2c  calar, optional,
-00042c40: 2064 6566 6175 6c74 3a20 300d 0a20 2020   default: 0..   
-00042c50: 2020 2020 2020 2020 204d 696e 696d 756d           Minimum
-00042c60: 2063 6f6c 6f72 2076 616c 7565 206f 6620   color value of 
-00042c70: 7368 6164 6564 206c 696e 6520 7365 676d  shaded line segm
-00042c80: 656e 7473 2e0d 0a20 2020 2020 2020 2020  ents...         
-00042c90: 2020 2044 6570 7468 2076 616c 7565 2072     Depth value r
-00042ca0: 616e 6765 7320 6672 6f6d 2030 2074 6f20  anges from 0 to 
-00042cb0: 312e 0d0a 0d0a 2020 2020 2020 2020 6469  1.....        di
-00042cc0: 7265 6374 696f 6e20 3a20 6172 7261 792d  rection : array-
-00042cd0: 6c69 6b65 2c20 6f70 7469 6f6e 616c 2c20  like, optional, 
-00042ce0: 6465 6661 756c 743a 2028 312c 302c 3129  default: (1,0,1)
-00042cf0: 0d0a 2020 2020 2020 2020 2020 2020 4120  ..            A 
-00042d00: 7879 7a20 7665 6374 6f72 2070 6f69 6e74  xyz vector point
-00042d10: 696e 6720 746f 2074 6865 2069 6c6c 756d  ing to the illum
-00042d20: 696e 6174 696f 6e20 736f 7572 6365 2e20  ination source. 
-00042d30: 0d0a 0d0a 2020 2020 2020 2020 636f 6e74  ....        cont
-00042d40: 7261 7374 203a 2073 6361 6c61 722c 206f  rast : scalar, o
-00042d50: 7074 696f 6e61 6c2c 2064 6566 6175 6c74  ptional, default
-00042d60: 3a20 310d 0a20 2020 2020 2020 2020 2020  : 1..           
-00042d70: 2053 6861 6469 6e67 2063 6f6e 7472 6173   Shading contras
-00042d80: 7420 6164 6a75 7374 6d65 6e74 2066 726f  t adjustment fro
-00042d90: 6d20 6c6f 7720 746f 2068 6967 6820 7769  m low to high wi
-00042da0: 7468 2061 2076 616c 7565 0d0a 2020 2020  th a value..    
-00042db0: 2020 2020 2020 2020 6f66 2031 2066 6f72          of 1 for
-00042dc0: 206c 696e 6561 7220 7661 7269 6174 696f   linear variatio
-00042dd0: 6e73 2077 6974 6820 7468 6520 6c69 6e65  ns with the line
-00042de0: 2073 6567 6d65 6e74 2064 6972 6563 7469   segment directi
-00042df0: 6f6e 2e0d 0a20 2020 2020 2020 2020 2020  on...           
-00042e00: 2043 6f6e 7472 6173 7420 7661 6c75 6520   Contrast value 
-00042e10: 7261 6e67 6573 2066 726f 6d20 302e 3120  ranges from 0.1 
-00042e20: 746f 2033 2e20 2020 2020 0d0a 2020 2020  to 3.     ..    
-00042e30: 2020 2020 0d0a 2020 2020 2020 2020 5265      ..        Re
-00042e40: 7475 726e 730d 0a20 2020 2020 2020 202d  turns..        -
-00042e50: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
-00042e60: 7365 6c66 203a 206c 696e 6520 6f62 6a65  self : line obje
-00042e70: 6374 0d0a 0d0a 2020 2020 2020 2020 2222  ct....        ""
-00042e80: 220d 0a0d 0a20 2020 2020 2020 2069 6620  "....        if 
-00042e90: 6469 7265 6374 696f 6e20 6973 204e 6f6e  direction is Non
-00042ea0: 6520 3a20 6469 7265 6374 696f 6e20 3d20  e : direction = 
-00042eb0: 5f49 4c4c 554d 0d0a 2020 2020 2020 2020  _ILLUM..        
-00042ec0: 6966 206e 702e 616e 7928 2028 6465 7074  if np.any( (dept
-00042ed0: 683c 3029 207c 2028 6465 7074 683e 3129  h<0) | (depth>1)
-00042ee0: 2029 203a 0d0a 2020 2020 2020 2020 2020   ) :..          
-00042ef0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-00042f00: 6f72 2827 6465 7074 6820 7661 6c75 6573  or('depth values
-00042f10: 2c20 7b7d 2c20 6d75 7374 2062 6520 6265  , {}, must be be
-00042f20: 7477 6565 6e20 3020 616e 6420 3127 2e66  tween 0 and 1'.f
-00042f30: 6f72 6d61 7428 6465 7074 6829 290d 0a20  ormat(depth)).. 
-00042f40: 2020 2020 2020 2069 6620 636f 6e74 7261         if contra
-00042f50: 7374 2069 7320 6e6f 7420 4e6f 6e65 3a0d  st is not None:.
-00042f60: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00042f70: 2863 6f6e 7472 6173 743c 302e 3120 6f72  (contrast<0.1 or
-00042f80: 2063 6f6e 7472 6173 743e 3329 203a 0d0a   contrast>3) :..
-00042f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042fa0: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-00042fb0: 2827 636f 6e74 7261 7374 206d 7573 7420  ('contrast must 
-00042fc0: 6265 2062 6574 7765 656e 2030 2e31 2061  be between 0.1 a
-00042fd0: 6e64 2033 2e20 2c20 666f 756e 6420 7b7d  nd 3. , found {}
-00042fe0: 272e 666f 726d 6174 2863 6f6e 7472 6173  '.format(contras
-00042ff0: 7429 290d 0a0d 0a0d 0a20 2020 2020 2020  t))......       
-00043000: 2023 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   # -------------
-00043010: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00043020: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020  ------------..  
-00043030: 2020 2020 2020 636f 6c6f 7273 203d 2073        colors = s
-00043040: 656c 662e 5f65 6467 6563 6f6c 6f72 730d  elf._edgecolors.
-00043050: 0a20 2020 2020 2020 2073 6567 6d65 6e74  .        segment
-00043060: 7320 3d20 7365 6c66 2e5f 7365 676d 656e  s = self._segmen
-00043070: 7473 3364 0d0a 2020 2020 2020 2020 6966  ts3d..        if
-00043080: 206e 6f74 2073 656c 662e 6973 5368 7265   not self.isShre
-00043090: 6464 6564 203a 0d0a 2020 2020 2020 2020  dded :..        
-000430a0: 2020 2020 2320 2e2e 2e2e 206e 6f74 653a      # .... note:
-000430b0: 636f 6c6f 7273 206d 6f64 6966 6965 642c  colors modified,
-000430c0: 206e 6f74 2063 7265 6174 6564 0d0a 2020   not created..  
-000430d0: 2020 2020 2020 2020 2020 636f 6c6f 7273            colors
-000430e0: 203d 2073 656c 662e 5f73 6872 6564 5f63   = self._shred_c
-000430f0: 6f6c 6f72 2829 0d0a 2020 2020 2020 2020  olor()..        
-00043100: 2020 2020 7365 676d 656e 7473 203d 2073      segments = s
-00043110: 656c 662e 5f73 6872 6564 2829 0d0a 2020  elf._shred()..  
-00043120: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00043130: 6564 6765 636f 6c6f 7273 203d 2063 6f6c  edgecolors = col
-00043140: 6f72 730d 0a20 2020 2020 2020 2065 6c73  ors..        els
-00043150: 6520 3a0d 0a20 2020 2020 2020 2020 2020  e :..           
-00043160: 206c 656e 436f 6c20 3d20 6c65 6e28 7365   lenCol = len(se
-00043170: 6c66 2e5f 6564 6765 636f 6c6f 7273 290d  lf._edgecolors).
-00043180: 0a20 2020 2020 2020 2020 2020 206c 656e  .            len
-00043190: 5365 6720 3d20 6c65 6e28 7365 676d 656e  Seg = len(segmen
-000431a0: 7473 290d 0a20 2020 2020 2020 2020 2020  ts)..           
-000431b0: 2069 6620 6c65 6e43 6f6c 2021 3d20 6c65   if lenCol != le
-000431c0: 6e53 6567 203a 2063 6f6c 6f72 7320 3d20  nSeg : colors = 
-000431d0: 7365 6c66 2e5f 7368 7265 645f 636f 6c6f  self._shred_colo
-000431e0: 7228 290d 0a20 2020 2020 2020 2023 202d  r()..        # -
-000431f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00043200: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00043210: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
-00043220: 2020 7365 6744 6972 203d 2073 656c 662e    segDir = self.
-00043230: 5f67 6574 5f73 6567 6d65 6e74 5f64 6972  _get_segment_dir
-00043240: 6563 7469 6f6e 7328 7365 676d 656e 7473  ections(segments
-00043250: 290d 0a20 2020 2020 2020 2075 6e69 7444  )..        unitD
-00043260: 6972 6563 7469 6f6e 203d 206e 702e 6469  irection = np.di
-00043270: 7669 6465 2820 6469 7265 6374 696f 6e2c  vide( direction,
-00043280: 206e 702e 6c69 6e61 6c67 2e6e 6f72 6d28   np.linalg.norm(
-00043290: 6469 7265 6374 696f 6e29 2029 0d0a 2020  direction) )..  
-000432a0: 2020 2020 2020 6474 7072 6f64 203d 206e        dtprod = n
-000432b0: 702e 646f 7428 7365 6744 6972 2c75 6e69  p.dot(segDir,uni
-000432c0: 7444 6972 6563 7469 6f6e 290d 0a20 2020  tDirection)..   
-000432d0: 2020 2020 2023 2066 6f72 204c 696e 6573       # for Lines
-000432e0: 2c20 6566 6665 6374 6976 6520 7368 6164  , effective shad
-000432f0: 6520 6973 206e 6f72 6d61 6c20 746f 206c  e is normal to l
-00043300: 696e 650d 0a20 2020 2020 2020 2064 203d  ine..        d =
-00043310: 2031 2d20 6e70 2e61 6273 2864 7470 726f   1- np.abs(dtpro
-00043320: 6429 0d0a 2020 2020 2020 2020 6966 2063  d)..        if c
-00043330: 6f6e 7472 6173 7420 6973 206e 6f74 204e  ontrast is not N
-00043340: 6f6e 6520 3a0d 0a20 2020 2020 2020 2020  one :..         
-00043350: 2020 2064 203d 2020 302e 352a 2820 3120     d =  0.5*( 1 
-00043360: 2b20 6e70 2e73 6967 6e28 6474 7072 6f64  + np.sign(dtprod
-00043370: 292a 6e70 2e70 6f77 6572 2820 6e70 2e61  )*np.power( np.a
-00043380: 6273 2864 7470 726f 6429 202c 2031 2f63  bs(dtprod) , 1/c
-00043390: 6f6e 7472 6173 7429 2029 2020 2020 2020  ontrast) )      
-000433a0: 0d0a 2020 2020 2020 2020 6f72 6967 5f63  ..        orig_c
-000433b0: 6f6c 6f72 7320 3d20 636f 6c6f 7273 0d0a  olors = colors..
-000433c0: 2020 2020 2020 2020 616c 7068 6173 203d          alphas =
-000433d0: 206f 7269 675f 636f 6c6f 7273 5b3a 2c33   orig_colors[:,3
-000433e0: 3a34 5d0d 0a20 2020 2020 2020 2066 635f  :4]..        fc_
-000433f0: 6c65 7373 5f61 6c70 6861 203d 206f 7269  less_alpha = ori
-00043400: 675f 636f 6c6f 7273 5b3a 2c3a 335d 0d0a  g_colors[:,:3]..
-00043410: 2020 2020 2020 2020 6873 765f 7661 6c73          hsv_vals
-00043420: 203d 2063 6d2e 636f 6c6f 7273 2e72 6762   = cm.colors.rgb
-00043430: 5f74 6f5f 6873 7628 6663 5f6c 6573 735f  _to_hsv(fc_less_
-00043440: 616c 7068 6129 0d0a 2020 2020 2020 2020  alpha)..        
-00043450: 2320 6164 6a75 7374 2063 6f6c 6f72 2076  # adjust color v
-00043460: 616c 7565 2077 6974 6820 6d75 6c74 6970  alue with multip
-00043470: 6c69 6572 2e0d 0a20 2020 2020 2020 2063  lier...        c
-00043480: 766d 203d 2028 2831 2d64 6570 7468 292a  vm = ((1-depth)*
-00043490: 6420 2b20 6465 7074 682a 6e70 2e6f 6e65  d + depth*np.one
-000434a0: 7328 6c65 6e28 6429 2929 5b3a 2c20 6e70  s(len(d)))[:, np
-000434b0: 2e6e 6577 6178 6973 5d0d 0a20 2020 2020  .newaxis]..     
-000434c0: 2020 2068 7376 5f76 616c 735b 3a2c 325d     hsv_vals[:,2]
-000434d0: 203d 2028 6376 6d2a 6873 765f 7661 6c73   = (cvm*hsv_vals
-000434e0: 5b3a 2c32 3a33 5d29 5b3a 2c30 5d0d 0a20  [:,2:3])[:,0].. 
-000434f0: 2020 2020 2020 2072 6762 5f76 616c 7320         rgb_vals 
-00043500: 3d20 2063 6d2e 636f 6c6f 7273 2e68 7376  =  cm.colors.hsv
-00043510: 5f74 6f5f 7267 6228 6873 765f 7661 6c73  _to_rgb(hsv_vals
-00043520: 290d 0a20 2020 2020 2020 2073 6861 6465  )..        shade
-00043530: 5f63 6f6c 6f72 7320 3d20 6e70 2e63 6f6e  _colors = np.con
-00043540: 6361 7465 6e61 7465 2828 7267 625f 7661  catenate((rgb_va
-00043550: 6c73 2c20 616c 7068 6173 292c 2061 7869  ls, alphas), axi
-00043560: 733d 3129 0d0a 2020 2020 2020 2020 7365  s=1)..        se
-00043570: 6c66 2e5f 6564 6765 636f 6c6f 7273 203d  lf._edgecolors =
-00043580: 2073 6861 6465 5f63 6f6c 6f72 730d 0a20   shade_colors.. 
-00043590: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-000435a0: 6c66 0d0a 0d0a 2020 2020 6465 6620 6661  lf....    def fa
-000435b0: 6465 2873 656c 662c 6465 7074 683d 302c  de(self,depth=0,
-000435c0: 656c 6576 3d4e 6f6e 652c 617a 696d 3d4e  elev=None,azim=N
-000435d0: 6f6e 652c 6178 3d4e 6f6e 6529 203a 0d0a  one,ax=None) :..
-000435e0: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
-000435f0: 2020 2020 2052 6564 7563 6520 6c69 6e65       Reduce line
-00043600: 206f 7061 6369 7479 2062 6173 6564 206f   opacity based o
-00043610: 6e20 6c69 6e65 2073 6567 6d65 6e74 2070  n line segment p
-00043620: 6f73 6974 696f 6e20 7265 6c61 7469 7665  osition relative
-00043630: 0d0a 2020 2020 2020 2020 746f 2074 6865  ..        to the
-00043640: 2076 6965 7720 6f72 6965 6e74 6174 696f   view orientatio
-00043650: 6e2e 0d0a 2020 2020 2020 2020 0d0a 2020  n...        ..  
-00043660: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
-00043670: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-00043680: 2d2d 2d2d 0d0a 2020 2020 2020 2020 6465  ----..        de
-00043690: 7074 6820 3a20 7363 616c 6172 2c20 6f70  pth : scalar, op
-000436a0: 7469 6f6e 616c 2c20 6465 6661 756c 743a  tional, default:
-000436b0: 2030 0d0a 2020 2020 2020 2020 2020 2020   0..            
-000436c0: 4d69 6e69 6d75 6d20 6f70 6163 6974 7920  Minimum opacity 
-000436d0: 746f 2031 2066 6f72 206c 696e 6561 7220  to 1 for linear 
-000436e0: 6c69 6e65 206f 7061 6369 7479 2066 726f  line opacity fro
-000436f0: 6d20 6261 636b 0d0a 2020 2020 2020 2020  m back..        
-00043700: 2020 2020 746f 2066 726f 6e74 206c 696e      to front lin
-00043710: 6520 7365 676d 656e 7420 706f 7369 7469  e segment positi
-00043720: 6f6e 2e0d 0a20 2020 2020 2020 2020 2020  on...           
-00043730: 2044 6570 7468 2076 616c 7565 2072 616e   Depth value ran
-00043740: 6765 7320 6672 6f6d 2030 2074 6f20 312e  ges from 0 to 1.
-00043750: 0d0a 0d0a 2020 2020 2020 2020 656c 6576  ....        elev
-00043760: 203a 2073 6361 6c61 722c 206f 7074 696f   : scalar, optio
-00043770: 6e61 6c2c 2064 6566 6175 6c74 3a20 3330  nal, default: 30
-00043780: 0d0a 2020 2020 2020 2020 2020 2020 456c  ..            El
-00043790: 6576 6174 696f 6e20 6f66 2074 6865 2061  evation of the a
-000437a0: 7865 7320 7669 6577 2e0d 0a0d 0a20 2020  xes view.....   
-000437b0: 2020 2020 2061 7a69 6d20 3a20 7363 616c       azim : scal
-000437c0: 6172 2c20 6f70 7469 6f6e 616c 2c20 6465  ar, optional, de
-000437d0: 6661 756c 743a 202d 3630 0d0a 2020 2020  fault: -60..    
-000437e0: 2020 2020 2020 2020 417a 696d 7574 6820          Azimuth 
-000437f0: 6f66 2074 6865 2061 7865 7320 7669 6577  of the axes view
-00043800: 2e20 0d0a 2020 2020 2020 2020 0d0a 2020  . ..        ..  
-00043810: 2020 2020 2020 6178 3a20 4d61 7470 6c6f        ax: Matplo
-00043820: 746c 6962 2033 4420 6178 6573 2e0d 0a20  tlib 3D axes... 
-00043830: 2020 2020 2020 2020 2020 2049 6620 6e6f             If no
-00043840: 7420 4e6f 6e65 2c20 656c 6576 2061 6e64  t None, elev and
-00043850: 2061 7a69 6d20 6172 6520 7461 6b65 6e20   azim are taken 
-00043860: 6672 6f6d 2074 6865 2061 782e 0d0a 2020  from the ax...  
-00043870: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-00043880: 5265 7475 726e 730d 0a20 2020 2020 2020  Returns..       
-00043890: 202d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020   -------..      
-000438a0: 2020 7365 6c66 203a 206c 696e 6520 6f62    self : line ob
-000438b0: 6a65 6374 0d0a 0d0a 2020 2020 2020 2020  ject....        
-000438c0: 2222 220d 0a0d 0a20 2020 2020 2020 2069  """....        i
-000438d0: 6620 6178 2069 7320 4e6f 6e65 203a 0d0a  f ax is None :..
-000438e0: 2020 2020 2020 2020 2020 2020 6966 2065              if e
-000438f0: 6c65 7620 6973 204e 6f6e 653a 2065 6c65  lev is None: ele
-00043900: 7620 3d20 5f44 4654 5f56 4945 575b 305d  v = _DFT_VIEW[0]
-00043910: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-00043920: 2061 7a69 6d20 6973 204e 6f6e 653a 2061   azim is None: a
-00043930: 7a69 6d20 3d20 5f44 4654 5f56 4945 575b  zim = _DFT_VIEW[
-00043940: 315d 0d0a 2020 2020 2020 2020 656c 7365  1]..        else
-00043950: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
-00043960: 656c 6576 203d 2061 782e 656c 6576 0d0a  elev = ax.elev..
-00043970: 2020 2020 2020 2020 2020 2020 617a 696d              azim
-00043980: 203d 2061 782e 617a 696d 0d0a 2020 2020   = ax.azim..    
-00043990: 2020 2020 6469 7265 6374 696f 6e20 3d20      direction = 
-000439a0: 656c 6576 5f61 7a69 6d5f 3276 6563 746f  elev_azim_2vecto
-000439b0: 7228 656c 6576 2c20 617a 696d 290d 0a20  r(elev, azim).. 
-000439c0: 2020 2020 2020 2075 6e69 7444 6972 6563         unitDirec
-000439d0: 7469 6f6e 203d 206e 702e 6469 7669 6465  tion = np.divide
-000439e0: 2820 6469 7265 6374 696f 6e2c 206e 702e  ( direction, np.
-000439f0: 6c69 6e61 6c67 2e6e 6f72 6d28 6469 7265  linalg.norm(dire
-00043a00: 6374 696f 6e29 2029 0d0a 0d0a 2020 2020  ction) )....    
-00043a10: 2020 2020 6966 206e 702e 616e 7928 2028      if np.any( (
-00043a20: 6465 7074 683c 3029 206f 7220 2864 6570  depth<0) or (dep
-00043a30: 7468 3e31 2920 2920 3a0d 0a20 2020 2020  th>1) ) :..     
-00043a40: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-00043a50: 7565 4572 726f 7228 2764 6570 7468 2076  ueError('depth v
-00043a60: 616c 7565 732c 207b 7d2c 206d 7573 7420  alues, {}, must 
-00043a70: 6265 2062 6574 7765 656e 2030 2061 6e64  be between 0 and
-00043a80: 2031 272e 666f 726d 6174 2864 6570 7468   1'.format(depth
-00043a90: 2929 0d0a 0d0a 2020 2020 2020 2020 2320  ))....        # 
-00043aa0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0003e2f0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0003e300: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0003e310: 2e2e 2e0d 0a20 2020 2020 2020 2064 6566  .....        def
+0003e320: 2067 6574 5f6c 696e 6543 6f6c 6f72 7328   get_lineColors(
+0003e330: 2063 6f6c 6f72 732c 206c 696e 6573 2920   colors, lines) 
+0003e340: 3a0d 0a20 2020 2020 2020 2020 2020 2063  :..            c
+0003e350: 6f6c 6f72 7320 3d20 6e70 2e61 7272 6179  olors = np.array
+0003e360: 2863 6f6c 6f72 7329 0d0a 2020 2020 2020  (colors)..      
+0003e370: 2020 2020 2020 6e6c 696e 6573 203d 206c        nlines = l
+0003e380: 656e 286c 696e 6573 290d 0a20 2020 2020  en(lines)..     
+0003e390: 2020 2020 2020 2069 6620 6c65 6e28 636f         if len(co
+0003e3a0: 6c6f 7273 2920 213d 206e 6c69 6e65 7320  lors) != nlines 
+0003e3b0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0003e3c0: 2020 2063 6f6c 6f72 7320 3d20 6e70 2e74     colors = np.t
+0003e3d0: 696c 6528 636f 6c6f 7273 2c28 6e6c 696e  ile(colors,(nlin
+0003e3e0: 6573 2c31 2929 0d0a 2020 2020 2020 2020  es,1))..        
+0003e3f0: 2020 2020 7265 7475 726e 2063 6f6c 6f72      return color
+0003e400: 730d 0a20 2020 2020 2020 2023 202e 2e2e  s..        # ...
+0003e410: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0003e420: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0003e430: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0003e440: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0003e450: 2e2e 2e2e 2e2e 2e2e 2e0d 0a20 2020 2020  ...........     
+0003e460: 2020 200d 0a20 2020 2020 2020 2069 6620     ..        if 
+0003e470: 6e6f 7420 6973 696e 7374 616e 6365 286f  not isinstance(o
+0003e480: 7468 722c 2043 6f6c 6f72 4c69 6e65 3344  thr, ColorLine3D
+0003e490: 436f 6c6c 6563 7469 6f6e 2920 3a0d 0a20  Collection) :.. 
+0003e4a0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0003e4b0: 2056 616c 7565 4572 726f 7228 2741 6464   ValueError('Add
+0003e4c0: 206f 7065 7261 7469 6f6e 7320 6361 6e20   operations can 
+0003e4d0: 6f6e 6c79 2061 7070 6c79 2062 6574 7765  only apply betwe
+0003e4e0: 656e 2043 6f6c 6f72 4c69 6e65 3344 436f  en ColorLine3DCo
+0003e4f0: 6c6c 6563 7469 6f6e 206f 626a 6563 7473  llection objects
+0003e500: 2e27 290d 0a0d 0a20 2020 2020 2020 2023  .')....        #
+0003e510: 2076 6572 7465 7843 6f6f 7220 6172 6520   vertexCoor are 
+0003e520: 6172 7261 792d 6c69 6b65 2e0d 0a20 2020  array-like...   
+0003e530: 2020 2020 2074 6f70 5665 7243 6f6f 7220       topVerCoor 
+0003e540: 3d20 7365 6c66 2e76 6572 7465 7843 6f6f  = self.vertexCoo
+0003e550: 720d 0a20 2020 2020 2020 2062 6f74 5665  r..        botVe
+0003e560: 7243 6f6f 7220 3d20 6f74 6872 2e76 6572  rCoor = othr.ver
+0003e570: 7465 7843 6f6f 720d 0a20 2020 2020 2020  texCoor..       
+0003e580: 2074 6f74 5665 7243 6f6f 7220 3d20 6e70   totVerCoor = np
+0003e590: 2e61 7070 656e 6428 746f 7056 6572 436f  .append(topVerCo
+0003e5a0: 6f72 2c62 6f74 5665 7243 6f6f 722c 6178  or,botVerCoor,ax
+0003e5b0: 6973 3d30 290d 0a20 2020 2020 2020 206e  is=0)..        n
+0003e5c0: 6578 7449 6e64 6578 203d 206c 656e 2874  extIndex = len(t
+0003e5d0: 6f70 5665 7243 6f6f 7229 0d0a 0d0a 2020  opVerCoor)....  
+0003e5e0: 2020 2020 2020 2320 6c69 6e65 496e 6469        # lineIndi
+0003e5f0: 6365 7320 6172 6520 696e 7420 4c69 7374  ces are int List
+0003e600: 730d 0a20 2020 2020 2020 2074 6f70 6c69  s..        topli
+0003e610: 6e65 496e 6469 6365 7320 3d20 7365 6c66  neIndices = self
+0003e620: 2e6c 696e 6549 6e64 6963 6573 0d0a 2020  .lineIndices..  
+0003e630: 2020 2020 2020 626f 746c 696e 6549 6e64        botlineInd
+0003e640: 6963 6573 203d 2063 6f70 792e 636f 7079  ices = copy.copy
+0003e650: 286f 7468 722e 6c69 6e65 496e 6469 6365  (othr.lineIndice
+0003e660: 7329 0d0a 2020 2020 2020 2020 666f 7220  s)..        for 
+0003e670: 6920 696e 2072 616e 6765 286c 656e 2862  i in range(len(b
+0003e680: 6f74 6c69 6e65 496e 6469 6365 7329 2920  otlineIndices)) 
+0003e690: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
+0003e6a0: 626f 746c 696e 6549 6e64 6963 6573 5b69  botlineIndices[i
+0003e6b0: 5d20 3d20 6e70 2e61 6464 2820 626f 746c  ] = np.add( botl
+0003e6c0: 696e 6549 6e64 6963 6573 5b69 5d20 2c20  ineIndices[i] , 
+0003e6d0: 6e65 7874 496e 6465 7820 292e 746f 6c69  nextIndex ).toli
+0003e6e0: 7374 2829 0d0a 2020 2020 2020 2020 746f  st()..        to
+0003e6f0: 744c 696e 6549 6e64 6963 6573 203d 2063  tLineIndices = c
+0003e700: 6f70 792e 636f 7079 2874 6f70 6c69 6e65  opy.copy(topline
+0003e710: 496e 6469 6365 7329 0d0a 2020 2020 2020  Indices)..      
+0003e720: 2020 666f 7220 6c69 6e65 2069 6e20 626f    for line in bo
+0003e730: 746c 696e 6549 6e64 6963 6573 203a 0d0a  tlineIndices :..
+0003e740: 2020 2020 2020 2020 2020 2020 746f 744c              totL
+0003e750: 696e 6549 6e64 6963 6573 2e61 7070 656e  ineIndices.appen
+0003e760: 6428 6c69 6e65 290d 0a20 2020 2020 2020  d(line)..       
+0003e770: 200d 0a20 2020 2020 2020 2023 2073 6567   ..        # seg
+0003e780: 6d49 6e64 6963 6573 2061 7265 2069 6e74  mIndices are int
+0003e790: 204c 6973 7473 0d0a 2020 2020 2020 2020   Lists..        
+0003e7a0: 746f 7053 6567 6d49 6e64 6963 6573 203d  topSegmIndices =
+0003e7b0: 2073 656c 662e 7365 676d 496e 6469 6365   self.segmIndice
+0003e7c0: 730d 0a20 2020 2020 2020 2062 6f74 5365  s..        botSe
+0003e7d0: 676d 496e 6469 6365 7320 3d20 636f 7079  gmIndices = copy
+0003e7e0: 2e63 6f70 7928 6f74 6872 2e73 6567 6d49  .copy(othr.segmI
+0003e7f0: 6e64 6963 6573 290d 0a20 2020 2020 2020  ndices)..       
+0003e800: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
+0003e810: 6c65 6e28 626f 7453 6567 6d49 6e64 6963  len(botSegmIndic
+0003e820: 6573 2929 203a 200d 0a20 2020 2020 2020  es)) : ..       
+0003e830: 2020 2020 2062 6f74 5365 676d 496e 6469       botSegmIndi
+0003e840: 6365 735b 695d 203d 206e 702e 6164 6428  ces[i] = np.add(
+0003e850: 2062 6f74 5365 676d 496e 6469 6365 735b   botSegmIndices[
+0003e860: 695d 202c 206e 6578 7449 6e64 6578 2029  i] , nextIndex )
+0003e870: 2e74 6f6c 6973 7428 290d 0a20 2020 2020  .tolist()..     
+0003e880: 2020 2074 6f74 5365 676d 496e 6469 6365     totSegmIndice
+0003e890: 7320 3d20 636f 7079 2e63 6f70 7928 746f  s = copy.copy(to
+0003e8a0: 7053 6567 6d49 6e64 6963 6573 290d 0a20  pSegmIndices).. 
+0003e8b0: 2020 2020 2020 2066 6f72 206c 696e 6520         for line 
+0003e8c0: 696e 2062 6f74 5365 676d 496e 6469 6365  in botSegmIndice
+0003e8d0: 7320 3a0d 0a20 2020 2020 2020 2020 2020  s :..           
+0003e8e0: 2074 6f74 5365 676d 496e 6469 6365 732e   totSegmIndices.
+0003e8f0: 6170 7065 6e64 286c 696e 6529 0d0a 0d0a  append(line)....
+0003e900: 2020 2020 2020 2020 2320 6564 6765 636f          # edgeco
+0003e910: 6c6f 7273 2061 7265 2061 7272 6179 2d6c  lors are array-l
+0003e920: 696b 650d 0a20 2020 2020 2020 2074 6f70  ike..        top
+0003e930: 4564 6765 436f 6c6f 7273 203d 2067 6574  EdgeColors = get
+0003e940: 5f6c 696e 6543 6f6c 6f72 7328 7365 6c66  _lineColors(self
+0003e950: 2e5f 6c65 6467 6563 6f6c 6f72 732c 746f  ._ledgecolors,to
+0003e960: 7053 6567 6d49 6e64 6963 6573 2920 2023  pSegmIndices)  #
+0003e970: 2075 7064 6174 6520 666f 7220 765f 312e   update for v_1.
+0003e980: 322e 3020 200d 0a20 2020 2020 2020 2062  2.0  ..        b
+0003e990: 6f74 4564 6765 436f 6c6f 7273 203d 2067  otEdgeColors = g
+0003e9a0: 6574 5f6c 696e 6543 6f6c 6f72 7328 6f74  et_lineColors(ot
+0003e9b0: 6872 2e5f 6c65 6467 6563 6f6c 6f72 732c  hr._ledgecolors,
+0003e9c0: 626f 7453 6567 6d49 6e64 6963 6573 2920  botSegmIndices) 
+0003e9d0: 2023 2075 7064 6174 6520 666f 7220 765f   # update for v_
+0003e9e0: 312e 322e 300d 0a20 2020 2020 2020 2074  1.2.0..        t
+0003e9f0: 6f74 4564 6765 436f 6c6f 7273 203d 206e  otEdgeColors = n
+0003ea00: 702e 6170 7065 6e64 2874 6f70 4564 6765  p.append(topEdge
+0003ea10: 436f 6c6f 7273 2c62 6f74 4564 6765 436f  Colors,botEdgeCo
+0003ea20: 6c6f 7273 2c61 7869 733d 3029 0d0a 0d0a  lors,axis=0)....
+0003ea30: 2020 2020 2020 2020 2320 4675 7444 6576          # FutDev
+0003ea40: 3a20 2761 6464 2720 7769 6c6c 206e 6f74  : 'add' will not
+0003ea50: 2072 6574 6169 6e20 6c69 6e65 2063 6f6c   retain line col
+0003ea60: 6c65 6374 696f 6e73 2e20 204e 6565 6465  lections.  Neede
+0003ea70: 6420 666f 7220 6578 706f 7274 0d0a 2020  d for export..  
+0003ea80: 2020 2020 2020 2320 2020 2020 2020 2020        #         
+0003ea90: 2062 7574 2073 7566 6669 6369 656e 7420   but sufficient 
+0003eaa0: 666f 7220 7265 6e64 6572 696e 672e 204d  for rendering. M
+0003eab0: 524f 490d 0a20 2020 2020 2020 206e 6577  ROI..        new
+0003eac0: 4c69 6e65 203d 2043 6f6c 6f72 4c69 6e65  Line = ColorLine
+0003ead0: 3344 436f 6c6c 6563 7469 6f6e 2874 6f74  3DCollection(tot
+0003eae0: 5665 7243 6f6f 722c 746f 7453 6567 6d49  VerCoor,totSegmI
+0003eaf0: 6e64 6963 6573 2c63 6f6c 6f72 3d74 6f74  ndices,color=tot
+0003eb00: 4564 6765 436f 6c6f 7273 290d 0a20 2020  EdgeColors)..   
+0003eb10: 200d 0a20 2020 2020 2020 206e 6577 4c69   ..        newLi
+0003eb20: 6e65 2e69 7353 6872 6564 6465 6420 3d20  ne.isShredded = 
+0003eb30: 7365 6c66 2e69 7353 6872 6564 6465 6420  self.isShredded 
+0003eb40: 616e 6420 6f74 6872 2e69 7353 6872 6564  and othr.isShred
+0003eb50: 6465 640d 0a20 2020 2020 2020 206e 6577  ded..        new
+0003eb60: 4c69 6e65 2e5f 706c 616e 654e 6f72 6d61  Line._planeNorma
+0003eb70: 6c20 3d20 4e6f 6e65 2020 232e 2e20 636f  l = None  #.. co
+0003eb80: 756c 6420 6368 6563 6b20 6865 7265 2069  uld check here i
+0003eb90: 6620 7361 6d65 206e 6f72 6d61 6c73 2e0d  f same normals..
+0003eba0: 0a20 2020 2020 2020 206e 6577 4c69 6e65  .        newLine
+0003ebb0: 2e5f 7365 745f 6765 6f6d 6574 7269 635f  ._set_geometric_
+0003ebc0: 626f 756e 6473 2829 0d0a 0d0a 2020 2020  bounds()....    
+0003ebd0: 2020 2020 7265 7475 726e 206e 6577 4c69      return newLi
+0003ebe0: 6e65 0d0a 0d0a 2020 2020 6465 6620 5f5f  ne....    def __
+0003ebf0: 7374 725f 5f28 7365 6c66 2920 3a0d 0a20  str__(self) :.. 
+0003ec00: 2020 2020 2020 2023 206e 6f74 653a 2065         # note: e
+0003ec10: 6163 6820 6c69 6e65 2072 6570 7265 7365  ach line represe
+0003ec20: 6e74 6174 696f 6e20 6973 2063 6f6d 706f  ntation is compo
+0003ec30: 7365 6420 6f66 206d 756c 7469 706c 6520  sed of multiple 
+0003ec40: 7365 676d 656e 7420 6c69 6e65 732e 0d0a  segment lines...
+0003ec50: 2020 2020 2020 2020 6e75 6d56 6572 7473          numVerts
+0003ec60: 203d 206c 656e 2873 656c 662e 7665 7274   = len(self.vert
+0003ec70: 6578 436f 6f72 290d 0a20 2020 2020 2020  exCoor)..       
+0003ec80: 206e 756d 4c69 6e65 7320 3d20 6c65 6e28   numLines = len(
+0003ec90: 7365 6c66 2e6c 696e 6549 6e64 6963 6573  self.lineIndices
+0003eca0: 290d 0a20 2020 2020 2020 206e 756d 5365  )..        numSe
+0003ecb0: 6720 3d20 300d 0a20 2020 2020 2020 2066  g = 0..        f
+0003ecc0: 6f72 206c 696e 6520 696e 2073 656c 662e  or line in self.
+0003ecd0: 5f73 6567 6d65 6e74 7333 6420 3a0d 0a20  _segments3d :.. 
+0003ece0: 2020 2020 2020 2020 2020 206e 756d 5365             numSe
+0003ecf0: 6720 2b3d 206c 656e 286c 696e 6529 202d  g += len(line) -
+0003ed00: 310d 0a20 2020 2020 2020 206e 616d 6520  1..        name 
+0003ed10: 3d20 7365 6c66 2e5f 5f63 6c61 7373 5f5f  = self.__class__
+0003ed20: 2e5f 5f6e 616d 655f 5f0d 0a20 2020 2020  .__name__..     
+0003ed30: 2020 2069 6620 7365 6c66 2e72 657a 2069     if self.rez i
+0003ed40: 7320 6e6f 7420 4e6f 6e65 203a 206e 616d  s not None : nam
+0003ed50: 6520 3d20 6e61 6d65 202b 2027 2028 7b7d  e = name + ' ({}
+0003ed60: 293a 272e 666f 726d 6174 2873 656c 662e  ):'.format(self.
+0003ed70: 7265 7a29 0d0a 2020 2020 2020 2020 7661  rez)..        va
+0003ed80: 6c20 3d20 6e61 6d65 202b 2027 3a20 6c69  l = name + ': li
+0003ed90: 6e65 733a 207b 7d2c 2073 6567 733a 207b  nes: {}, segs: {
+0003eda0: 7d2c 2076 6572 7473 3a20 7b7d 272e 666f  }, verts: {}'.fo
+0003edb0: 726d 6174 286e 756d 4c69 6e65 732c 6e75  rmat(numLines,nu
+0003edc0: 6d53 6567 2c6e 756d 5665 7274 7329 0d0a  mSeg,numVerts)..
+0003edd0: 2020 2020 2020 2020 7265 7475 726e 2076          return v
+0003ede0: 616c 0d0a 0d0a 2020 2020 6465 6620 5f70  al....    def _p
+0003edf0: 6f73 7450 726f 635f 7365 676d 656e 7443  ostProc_segmentC
+0003ee00: 6f6c 6f72 7328 7365 6c66 2920 3a0d 0a20  olors(self) :.. 
+0003ee10: 2020 2020 2020 2022 2222 204d 6174 706c         """ Matpl
+0003ee20: 6f74 6c69 6220 7769 6c6c 2027 6669 6c6c  otlib will 'fill
+0003ee30: 696e 2720 636f 6c6f 7273 2064 7572 696e  in' colors durin
+0003ee40: 6720 7265 6e64 6572 696e 6720 7573 696e  g rendering usin
+0003ee50: 6720 7468 650d 0a20 2020 2020 2020 2020  g the..         
+0003ee60: 2020 2066 6163 6563 6f6c 6f72 2061 7272     facecolor arr
+0003ee70: 6179 2e20 2874 6869 7320 6973 204e 4f54  ay. (this is NOT
+0003ee80: 2074 6865 2061 7373 6967 6e65 6420 636f   the assigned co
+0003ee90: 6c6f 7220 746f 2065 6467 6573 292e 0d0a  lor to edges)...
+0003eea0: 2020 2020 2020 2020 2020 2020 486f 7765              Howe
+0003eeb0: 7665 722c 2053 3344 6c69 6220 7769 6c6c  ver, S3Dlib will
+0003eec0: 2075 7365 2074 6865 2069 6e68 6572 6974   use the inherit
+0003eed0: 6564 205f 6564 6765 636f 6c6f 7273 200d  ed _edgecolors .
+0003eee0: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+0003eef0: 2074 6865 2061 7373 6967 6e65 6420 6564   the assigned ed
+0003ef00: 6567 2063 6f6c 6f72 732e 0d0a 2020 2020  eg colors...    
+0003ef10: 2020 2020 2020 2020 5768 656e 6576 6572          Whenever
+0003ef20: 2063 6f6c 6f72 2069 7320 2765 7874 6572   color is 'exter
+0003ef30: 6e61 6c6c 7927 2061 7373 6967 6e65 6420  nally' assigned 
+0003ef40: 6f72 2072 6561 7373 6967 6e65 642c 0d0a  or reassigned,..
+0003ef50: 2020 2020 2020 2020 2020 2020 6e65 6564              need
+0003ef60: 2074 6f20 6469 7265 6374 6c79 2061 7373   to directly ass
+0003ef70: 6967 6e20 636f 6c6f 7273 2066 6f72 2065  ign colors for e
+0003ef80: 6163 6820 6564 6765 2066 6f72 2061 6e79  ach edge for any
+0003ef90: 0d0a 2020 2020 2020 2020 2020 2020 6d65  ..            me
+0003efa0: 7468 6f64 2074 6861 7420 7573 6573 2065  thod that uses e
+0003efb0: 6467 6563 6f6c 6f72 732e 2020 5468 6973  dgecolors.  This
+0003efc0: 206f 6363 7572 7320 696e 6974 6961 6c6c   occurs initiall
+0003efd0: 790d 0a20 2020 2020 2020 2020 2020 2069  y..            i
+0003efe0: 6e20 7468 6520 6d65 7468 6f64 2062 6566  n the method bef
+0003eff0: 6f72 6520 636f 6c6f 7273 2061 7265 2061  ore colors are a
+0003f000: 7373 6967 6e65 6420 2020 2020 2020 2020  ssigned         
+0003f010: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
+0003f020: 2028 7365 745f 636f 6c6f 722c 202b 2c20   (set_color, +, 
+0003f030: 636c 6970 7069 6e67 2c20 7368 6164 696e  clipping, shadin
+0003f040: 672c 2065 6467 6573 2c20 6574 632e 290d  g, edges, etc.).
+0003f050: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
+0003f060: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
+0003f070: 2020 2020 4e20 3d20 6c65 6e28 7365 6c66      N = len(self
+0003f080: 2e73 6567 6d49 6e64 6963 6573 2920 2020  .segmIndices)   
+0003f090: 2023 206e 756d 6265 7220 6f66 2073 6567   # number of seg
+0003f0a0: 6d65 6e74 730d 0a20 2020 2020 2020 2069  ments..        i
+0003f0b0: 6e69 7445 4320 3d20 7365 6c66 2e5f 6c65  nitEC = self._le
+0003f0c0: 6467 6563 6f6c 6f72 7320 2020 2320 7570  dgecolors   # up
+0003f0d0: 6461 7465 2066 6f72 2076 5f31 2e32 2e30  date for v_1.2.0
+0003f0e0: 0d0a 2020 2020 2020 2020 696e 4c65 6e20  ..        inLen 
+0003f0f0: 3d20 6c65 6e28 696e 6974 4543 2920 2020  = len(initEC)   
+0003f100: 2020 2020 2020 2023 206e 756d 6265 7220         # number 
+0003f110: 6f66 2065 6467 6563 6f6c 6f72 730d 0a20  of edgecolors.. 
+0003f120: 2020 2020 2020 2069 6620 696e 4c65 6e20         if inLen 
+0003f130: 3d3d 204e 203a 2072 6574 7572 6e0d 0a20  == N : return.. 
+0003f140: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+0003f150: 616e 6365 2869 6e69 7445 432c 6e70 2e6e  ance(initEC,np.n
+0003f160: 6461 7272 6179 2920 3a20 696e 6974 4543  darray) : initEC
+0003f170: 203d 2069 6e69 7445 432e 746f 6c69 7374   = initEC.tolist
+0003f180: 2829 0d0a 2020 2020 2020 2020 6e20 3d20  ()..        n = 
+0003f190: 6d61 7468 2e63 6569 6c28 4e2f 696e 4c65  math.ceil(N/inLe
+0003f1a0: 6e29 0d0a 2020 2020 2020 2020 636f 6c6f  n)..        colo
+0003f1b0: 7263 6f6c 6c20 3d20 696e 6974 4543 2a6e  rcoll = initEC*n
+0003f1c0: 0d0a 2020 2020 2020 0d0a 2020 2020 2020  ..      ..      
+0003f1d0: 2020 7365 6c66 2e73 6574 5f63 6f6c 6f72    self.set_color
+0003f1e0: 2863 6f6c 6f72 636f 6c6c 5b30 3a4e 5d29  (colorcoll[0:N])
+0003f1f0: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+0003f200: 0d0a 0d0a 2020 2020 6465 6620 5f73 6872  ....    def _shr
+0003f210: 6564 2873 656c 6629 203a 0d0a 2020 2020  ed(self) :..    
+0003f220: 2020 2020 2320 636f 6e76 6572 7420 6d75      # convert mu
+0003f230: 6c74 692d 7365 676d 656e 7420 6c69 6e65  lti-segment line
+0003f240: 7320 746f 206d 756c 7469 706c 6520 6f6e  s to multiple on
+0003f250: 652d 7365 676d 656e 7420 6c69 6e65 732e  e-segment lines.
+0003f260: 0d0a 2020 2020 2020 2020 2320 5265 7175  ..        # Requ
+0003f270: 6972 6564 2066 6f72 2061 7070 6c69 6361  ired for applica
+0003f280: 7469 6f6e 206f 6620 6e6f 6e2d 756e 6966  tion of non-unif
+0003f290: 6f72 6d20 6c69 6e65 2063 6f6c 6f72 2e0d  orm line color..
+0003f2a0: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+0003f2b0: 2020 206c 696e 6573 6567 7320 3d20 7365     linesegs = se
+0003f2c0: 6c66 2e6c 696e 6549 6e64 6963 6573 0d0a  lf.lineIndices..
+0003f2d0: 2020 2020 2020 2020 696e 6469 6365 7320          indices 
+0003f2e0: 3d20 5b5d 0d0a 2020 2020 2020 2020 666f  = []..        fo
+0003f2f0: 7220 6c69 6e65 2069 6e20 6c69 6e65 7365  r line in linese
+0003f300: 6773 203a 0d0a 2020 2020 2020 2020 2020  gs :..          
+0003f310: 2020 6e75 6d53 6567 7320 3d20 6c65 6e28    numSegs = len(
+0003f320: 6c69 6e65 2920 2d20 310d 0a20 2020 2020  line) - 1..     
+0003f330: 2020 2020 2020 2066 6f72 2073 6567 2069         for seg i
+0003f340: 6e20 7261 6e67 6520 286e 756d 5365 6773  n range (numSegs
+0003f350: 2920 3a0d 0a20 2020 2020 2020 2020 2020  ) :..           
+0003f360: 2020 2020 2074 203d 205b 206c 696e 655b       t = [ line[
+0003f370: 7365 675d 2c6c 696e 655b 7365 672b 315d  seg],line[seg+1]
+0003f380: 205d 0d0a 2020 2020 2020 2020 2020 2020   ]..            
+0003f390: 2020 2020 696e 6469 6365 732e 6170 7065      indices.appe
+0003f3a0: 6e64 2874 290d 0a20 2020 2020 2020 2073  nd(t)..        s
+0003f3b0: 6567 6d65 6e74 7320 3d20 7365 6c66 2e76  egments = self.v
+0003f3c0: 6572 7465 7843 6f6f 725b 6e70 2e61 7272  ertexCoor[np.arr
+0003f3d0: 6179 2869 6e64 6963 6573 295d 0d0a 2020  ay(indices)]..  
+0003f3e0: 2020 2020 2020 7365 6c66 2e73 6567 6d49        self.segmI
+0003f3f0: 6e64 6963 6573 203d 2069 6e64 6963 6573  ndices = indices
+0003f400: 0d0a 2020 2020 2020 2020 7365 6c66 2e73  ..        self.s
+0003f410: 6574 5f73 6567 6d65 6e74 7328 7365 676d  et_segments(segm
+0003f420: 656e 7473 290d 0a20 2020 2020 2020 2073  ents)..        s
+0003f430: 656c 662e 6973 5368 7265 6464 6564 203d  elf.isShredded =
+0003f440: 2054 7275 650d 0a20 2020 2020 2020 2072   True..        r
+0003f450: 6574 7572 6e20 7365 676d 656e 7473 0d0a  eturn segments..
+0003f460: 0d0a 2020 2020 6465 6620 5f73 6872 6564  ..    def _shred
+0003f470: 5f73 6567 6d5f 636f 6c6f 7228 7365 6c66  _segm_color(self
+0003f480: 2c6e 756d 4469 7629 203a 0d0a 2020 2020  ,numDiv) :..    
+0003f490: 2020 2020 696e 6974 436f 6c6f 7273 203d      initColors =
+0003f4a0: 2073 656c 662e 5f6c 6564 6765 636f 6c6f   self._ledgecolo
+0003f4b0: 7273 2020 2320 636f 6c6f 7273 2062 6566  rs  # colors bef
+0003f4c0: 6f72 6520 6c69 6e65 2073 6872 6564 6469  ore line shreddi
+0003f4d0: 6e67 2020 2320 7570 6461 7465 2066 6f72  ng  # update for
+0003f4e0: 2076 5f31 2e32 2e30 0d0a 2020 2020 2020   v_1.2.0..      
+0003f4f0: 2020 6e75 6d43 6f6c 6f72 7320 3d20 6c65    numColors = le
+0003f500: 6e28 696e 6974 436f 6c6f 7273 290d 0a20  n(initColors).. 
+0003f510: 2020 2020 2020 206c 696e 6573 6567 7320         linesegs 
+0003f520: 3d20 7365 6c66 2e73 6567 6d49 6e64 6963  = self.segmIndic
+0003f530: 6573 0d0a 2020 2020 2020 2020 636f 6c6f  es..        colo
+0003f540: 7273 203d 205b 5d0d 0a20 2020 2020 2020  rs = []..       
+0003f550: 2063 6f6c 6f72 496e 6465 7820 3d20 300d   colorIndex = 0.
+0003f560: 0a20 2020 2020 2020 2066 6f72 206c 696e  .        for lin
+0003f570: 6520 696e 206c 696e 6573 6567 7320 3a0d  e in linesegs :.
+0003f580: 0a20 2020 2020 2020 2020 2020 2063 7572  .            cur
+0003f590: 7265 6e74 436f 6c6f 7220 3d20 696e 6974  rentColor = init
+0003f5a0: 436f 6c6f 7273 5b63 6f6c 6f72 496e 6465  Colors[colorInde
+0003f5b0: 785d 0d0a 2020 2020 2020 2020 2020 2020  x]..            
+0003f5c0: 666f 7220 7365 6720 696e 2072 616e 6765  for seg in range
+0003f5d0: 2028 6e75 6d44 6976 2920 3a0d 0a20 2020   (numDiv) :..   
+0003f5e0: 2020 2020 2020 2020 2020 2020 2063 6f6c               col
+0003f5f0: 6f72 732e 6170 7065 6e64 2863 7572 7265  ors.append(curre
+0003f600: 6e74 436f 6c6f 7229 0d0a 2020 2020 2020  ntColor)..      
+0003f610: 2020 2020 2020 636f 6c6f 7249 6e64 6578        colorIndex
+0003f620: 203d 2028 636f 6c6f 7249 6e64 6578 2b31   = (colorIndex+1
+0003f630: 2925 6e75 6d43 6f6c 6f72 730d 0a20 2020  )%numColors..   
+0003f640: 2020 2020 2063 6f6c 6f72 7320 3d20 6e70       colors = np
+0003f650: 2e61 7272 6179 2863 6f6c 6f72 7329 2020  .array(colors)  
+0003f660: 2020 2023 2063 6f6c 6f72 7320 6166 7465     # colors afte
+0003f670: 7220 6c69 6e65 2073 6872 6564 6469 6e67  r line shredding
+0003f680: 0d0a 0d0a 2020 2020 2020 2020 7265 7475  ....        retu
+0003f690: 726e 2063 6f6c 6f72 730d 0a0d 0a20 2020  rn colors....   
+0003f6a0: 2064 6566 205f 7368 7265 645f 636f 6c6f   def _shred_colo
+0003f6b0: 7228 7365 6c66 2920 3a0d 0a20 2020 2020  r(self) :..     
+0003f6c0: 2020 2023 2053 696e 6365 206c 696e 6520     # Since line 
+0003f6d0: 636f 6c6f 7273 2061 7265 2069 6e20 6120  colors are in a 
+0003f6e0: 5349 4e47 4c45 204c 6973 7420 6f66 2063  SINGLE List of c
+0003f6f0: 6f6c 6f72 730d 0a20 2020 2020 2020 2023  olors..        #
+0003f700: 2066 6f72 206d 756c 6974 706c 6520 6c69   for mulitple li
+0003f710: 6e65 7320 7769 7468 206d 756c 7469 706c  nes with multipl
+0003f720: 6520 7365 676d 656e 7420 636f 6c6f 7273  e segment colors
+0003f730: 2c0d 0a20 2020 2020 2020 2023 2063 6f6c  ,..        # col
+0003f740: 6f72 7320 666f 7220 6120 6d75 6c74 692d  ors for a multi-
+0003f750: 7365 676d 656e 7420 6c69 6e65 206f 6620  segment line of 
+0003f760: 6120 7369 6e67 6c65 2063 6f6c 6f72 0d0a  a single color..
+0003f770: 2020 2020 2020 2020 2320 6973 2072 6563          # is rec
+0003f780: 6f6e 7374 7275 6374 6564 2069 6e74 6f20  onstructed into 
+0003f790: 6d75 6c74 6970 6c65 2063 6f6c 6f72 7320  multiple colors 
+0003f7a0: 6f66 2074 6865 0d0a 2020 2020 2020 2020  of the..        
+0003f7b0: 2320 7361 6d65 2063 6f6c 6f72 2e20 2028  # same color.  (
+0003f7c0: 2073 6565 205f 7368 7265 6420 290d 0a20   see _shred ).. 
+0003f7d0: 2020 2020 2020 2023 2049 6e64 6976 6964         # Individ
+0003f7e0: 7561 6c20 7365 6765 6d6e 7420 636f 6c6f  ual segemnt colo
+0003f7f0: 7273 2061 7265 206e 6565 6465 6420 666f  rs are needed fo
+0003f800: 7220 6c69 6e65 0d0a 2020 2020 2020 2020  r line..        
+0003f810: 2320 7368 6164 696e 672c 2063 6c69 7070  # shading, clipp
+0003f820: 696e 672c 2061 6e64 2061 6c70 6861 2073  ing, and alpha s
+0003f830: 6574 7469 6e67 2e0d 0a0d 0a20 2020 2020  etting.....     
+0003f840: 2020 2069 6e69 7443 6f6c 6f72 7320 3d20     initColors = 
+0003f850: 7365 6c66 2e5f 6c65 6467 6563 6f6c 6f72  self._ledgecolor
+0003f860: 7320 2023 2063 6f6c 6f72 7320 6265 666f  s  # colors befo
+0003f870: 7265 206c 696e 6520 7368 7265 6464 696e  re line shreddin
+0003f880: 6720 2023 2075 7064 6174 6520 666f 7220  g  # update for 
+0003f890: 765f 312e 322e 300d 0a20 2020 2020 2020  v_1.2.0..       
+0003f8a0: 206e 756d 436f 6c6f 7273 203d 206c 656e   numColors = len
+0003f8b0: 2869 6e69 7443 6f6c 6f72 7329 0d0a 2020  (initColors)..  
+0003f8c0: 2020 2020 2020 6c69 6e65 7365 6773 203d        linesegs =
+0003f8d0: 2073 656c 662e 6c69 6e65 496e 6469 6365   self.lineIndice
+0003f8e0: 730d 0a20 2020 2020 2020 2063 6f6c 6f72  s..        color
+0003f8f0: 7320 3d20 5b5d 0d0a 2020 2020 2020 2020  s = []..        
+0003f900: 636f 6c6f 7249 6e64 6578 203d 2030 0d0a  colorIndex = 0..
+0003f910: 2020 2020 2020 2020 666f 7220 6c69 6e65          for line
+0003f920: 2069 6e20 6c69 6e65 7365 6773 203a 0d0a   in linesegs :..
+0003f930: 2020 2020 2020 2020 2020 2020 6e75 6d53              numS
+0003f940: 6567 7320 3d20 6c65 6e28 6c69 6e65 2920  egs = len(line) 
+0003f950: 2d20 310d 0a20 2020 2020 2020 2020 2020  - 1..           
+0003f960: 2063 7572 7265 6e74 436f 6c6f 7220 3d20   currentColor = 
+0003f970: 696e 6974 436f 6c6f 7273 5b63 6f6c 6f72  initColors[color
+0003f980: 496e 6465 785d 0d0a 2020 2020 2020 2020  Index]..        
+0003f990: 2020 2020 666f 7220 7365 6720 696e 2072      for seg in r
+0003f9a0: 616e 6765 2028 6e75 6d53 6567 7329 203a  ange (numSegs) :
+0003f9b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0003f9c0: 2020 636f 6c6f 7273 2e61 7070 656e 6428    colors.append(
+0003f9d0: 6375 7272 656e 7443 6f6c 6f72 290d 0a20  currentColor).. 
+0003f9e0: 2020 2020 2020 2020 2020 2063 6f6c 6f72             color
+0003f9f0: 496e 6465 7820 3d20 2863 6f6c 6f72 496e  Index = (colorIn
+0003fa00: 6465 782b 3129 256e 756d 436f 6c6f 7273  dex+1)%numColors
+0003fa10: 0d0a 2020 2020 2020 2020 636f 6c6f 7273  ..        colors
+0003fa20: 203d 206e 702e 6172 7261 7928 636f 6c6f   = np.array(colo
+0003fa30: 7273 2920 2020 2020 2320 636f 6c6f 7273  rs)     # colors
+0003fa40: 2061 6674 6572 206c 696e 6520 7368 7265   after line shre
+0003fa50: 6464 696e 670d 0a0d 0a20 2020 2020 2020  dding....       
+0003fa60: 2072 6574 7572 6e20 636f 6c6f 7273 0d0a   return colors..
+0003fa70: 0d0a 2020 2020 6465 6620 5f67 6574 5f73  ..    def _get_s
+0003fa80: 6567 6d65 6e74 5f63 656e 7465 7273 2873  egment_centers(s
+0003fa90: 656c 662c 7365 676d 656e 7473 2920 3a0d  elf,segments) :.
+0003faa0: 0a20 2020 2020 2020 2023 2073 6567 6d65  .        # segme
+0003fab0: 6e74 2063 656e 7465 7273 2066 726f 6d20  nt centers from 
+0003fac0: 7365 676d 656e 7420 706f 696e 7420 636f  segment point co
+0003fad0: 6f72 6469 6e61 7465 732e 0d0a 2020 2020  ordinates...    
+0003fae0: 2020 2020 2320 4173 7375 6d65 6420 7365      # Assumed se
+0003faf0: 676d 656e 7473 206f 6620 6120 7368 7265  gments of a shre
+0003fb00: 6464 6564 206c 696e 652e 0d0a 2020 2020  dded line...    
+0003fb10: 2020 2020 7666 5420 3d20 6e70 2e74 7261      vfT = np.tra
+0003fb20: 6e73 706f 7365 2873 6567 6d65 6e74 732c  nspose(segments,
+0003fb30: 2028 312c 322c 3029 2029 0d0a 2020 2020   (1,2,0) )..    
+0003fb40: 2020 2020 6e75 6d56 6572 7473 203d 2076      numVerts = v
+0003fb50: 6654 2e73 6861 7065 5b30 5d0d 0a20 2020  fT.shape[0]..   
+0003fb60: 2020 2020 2073 756d 5620 3d20 6e70 2e73       sumV = np.s
+0003fb70: 756d 2876 6654 2c20 6178 6973 3d30 290d  um(vfT, axis=0).
+0003fb80: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0003fb90: 6e70 2e74 7261 6e73 706f 7365 2873 756d  np.transpose(sum
+0003fba0: 5629 2f6e 756d 5665 7274 730d 0a0d 0a20  V)/numVerts.... 
+0003fbb0: 2020 2064 6566 205f 6765 745f 7365 676d     def _get_segm
+0003fbc0: 656e 745f 6469 7265 6374 696f 6e73 2873  ent_directions(s
+0003fbd0: 656c 662c 7365 676d 656e 7473 2920 3a0d  elf,segments) :.
+0003fbe0: 0a20 2020 2020 2020 2023 2073 6567 6d65  .        # segme
+0003fbf0: 6e74 2075 6e69 7420 6469 7265 6374 696f  nt unit directio
+0003fc00: 6e73 2066 726f 6d20 7365 676d 656e 7420  ns from segment 
+0003fc10: 706f 696e 7420 636f 6f72 6469 6e61 7465  point coordinate
+0003fc20: 732e 0d0a 2020 2020 2020 2020 2320 4173  s...        # As
+0003fc30: 7375 6d65 6420 7365 676d 656e 7473 206f  sumed segments o
+0003fc40: 6620 6120 7368 7265 6464 6564 206c 696e  f a shredded lin
+0003fc50: 652e 0d0a 2020 2020 2020 2020 7666 5420  e...        vfT 
+0003fc60: 3d20 6e70 2e74 7261 6e73 706f 7365 2873  = np.transpose(s
+0003fc70: 6567 6d65 6e74 732c 2028 312c 302c 3229  egments, (1,0,2)
+0003fc80: 2029 0d0a 2020 2020 2020 2020 6469 7265   )..        dire
+0003fc90: 6374 696f 6e20 3d20 7666 545b 315d 202d  ction = vfT[1] -
+0003fca0: 2076 6654 5b30 5d0d 0a20 2020 2020 2020   vfT[0]..       
+0003fcb0: 2073 7a20 3d20 6e70 2e6c 696e 616c 672e   sz = np.linalg.
+0003fcc0: 6e6f 726d 2864 6972 6563 7469 6f6e 2c20  norm(direction, 
+0003fcd0: 6178 6973 3d31 295b 3a2c 6e70 2e6e 6577  axis=1)[:,np.new
+0003fce0: 6178 6973 5d0d 0a20 2020 2020 2020 2075  axis]..        u
+0003fcf0: 6e69 7456 6563 746f 7220 3d20 6e70 2e64  nitVector = np.d
+0003fd00: 6976 6964 6528 2064 6972 6563 7469 6f6e  ivide( direction
+0003fd10: 2c20 737a 2029 0d0a 2020 2020 2020 2020  , sz )..        
+0003fd20: 7265 7475 726e 2075 6e69 7456 6563 746f  return unitVecto
+0003fd30: 720d 0a0d 0a20 2020 2064 6566 205f 7365  r....    def _se
+0003fd40: 745f 6765 6f6d 6574 7269 635f 626f 756e  t_geometric_boun
+0003fd50: 6473 2873 656c 6629 203a 0d0a 2020 2020  ds(self) :..    
+0003fd60: 2020 2020 5f73 6574 5f67 656f 6d42 6f75      _set_geomBou
+0003fd70: 6e64 7328 7365 6c66 2e76 6572 7465 7843  nds(self.vertexC
+0003fd80: 6f6f 722c 7365 6c66 2e5f 626f 756e 6473  oor,self._bounds
+0003fd90: 290d 0a20 2020 2020 2020 2072 6574 7572  )..        retur
+0003fda0: 6e20 2020 200d 0a20 2020 200d 0a20 2020  n    ..    ..   
+0003fdb0: 2064 6566 205f 6765 745f 7365 676d 656e   def _get_segmen
+0003fdc0: 7473 2820 7365 6c66 2c20 762c 2053 2020  ts( self, v, S  
+0003fdd0: 2920 3a0d 0a20 2020 2020 2020 2023 2053  ) :..        # S
+0003fde0: 696e 6365 206c 696e 6520 7365 676d 656e  ince line segmen
+0003fdf0: 7473 2061 7265 2069 6e20 6120 4c69 7374  ts are in a List
+0003fe00: 206f 6620 6d75 6c74 6970 6c65 206c 696e   of multiple lin
+0003fe10: 6573 2c0d 0a20 2020 2020 2020 2023 206c  es,..        # l
+0003fe20: 696e 6520 7665 7274 6963 6573 2061 7265  ine vertices are
+0003fe30: 2073 6574 2070 6572 206c 696e 6520 696e   set per line in
+0003fe40: 2074 6865 206c 696e 6520 636f 6c6c 6563   the line collec
+0003fe50: 7469 6f6e 0d0a 2020 2020 2020 2020 2320  tion..        # 
+0003fe60: 746f 2072 6563 6f6e 7374 7275 6374 2074  to reconstruct t
+0003fe70: 6865 2073 6567 6d65 6e74 2063 6f6f 7264  he segment coord
+0003fe80: 696e 6174 6573 2028 2073 656c 662e 5f73  inates ( self._s
+0003fe90: 6567 6d65 6e74 7333 6420 290d 0a0d 0a20  egments3d ).... 
+0003fea0: 2020 2020 2020 2023 2044 6576 4e6f 7465         # DevNote
+0003feb0: 3a20 676f 7420 746f 2062 6520 6120 6265  : got to be a be
+0003fec0: 7474 6572 2077 6179 206f 6620 646f 696e  tter way of doin
+0003fed0: 6720 7468 6973 2c20 6275 7420 6c69 6e65  g this, but line
+0003fee0: 0d0a 2020 2020 2020 2020 2320 2020 2020  ..        #     
+0003fef0: 2020 2020 2073 6574 7320 6172 6520 6c69       sets are li
+0003ff00: 7374 7320 7769 7468 2076 6172 7969 6e67  sts with varying
+0003ff10: 206e 756d 6265 7220 6f66 2073 6567 6d65   number of segme
+0003ff20: 6e74 730d 0a20 2020 2020 2020 2023 2020  nts..        #  
+0003ff30: 2020 2020 2020 2020 756e 7469 6c20 7368          until sh
+0003ff40: 7265 6464 6564 2c20 7468 656e 2061 6c6c  redded, then all
+0003ff50: 2074 6865 2073 616d 6520 6e75 6d62 6572   the same number
+0003ff60: 206f 6620 7365 6773 2e0d 0a0d 0a20 2020   of segs.....   
+0003ff70: 2020 2020 2069 6620 7365 6c66 2e69 7353       if self.isS
+0003ff80: 6872 6564 6465 6420 3a20 2072 6574 7572  hredded :  retur
+0003ff90: 6e20 765b 6e70 2e61 7272 6179 2853 295d  n v[np.array(S)]
+0003ffa0: 0d0a 0d0a 2020 2020 2020 2020 7365 676d  ....        segm
+0003ffb0: 656e 7473 203d 205b 4e6f 6e65 5d2a 6c65  ents = [None]*le
+0003ffc0: 6e28 5329 0d0a 2020 2020 2020 2020 666f  n(S)..        fo
+0003ffd0: 7220 7665 726c 6973 7420 696e 2072 616e  r verlist in ran
+0003ffe0: 6765 286c 656e 2853 2929 203a 0d0a 2020  ge(len(S)) :..  
+0003fff0: 2020 2020 2020 2020 2020 7665 7241 7272            verArr
+00040000: 203d 205b 4e6f 6e65 5d2a 6c65 6e28 2053   = [None]*len( S
+00040010: 5b76 6572 6c69 7374 5d20 290d 0a20 2020  [verlist] )..   
+00040020: 2020 2020 2020 2020 2066 6f72 2076 6572           for ver
+00040030: 496e 7820 696e 2072 616e 6765 2820 6c65  Inx in range( le
+00040040: 6e28 2053 5b76 6572 6c69 7374 5d20 2920  n( S[verlist] ) 
+00040050: 2920 3a0d 0a20 2020 2020 2020 2020 2020  ) :..           
+00040060: 2020 2020 2076 6572 4172 725b 7665 7249       verArr[verI
+00040070: 6e78 5d20 3d20 765b 2053 5b76 6572 6c69  nx] = v[ S[verli
+00040080: 7374 5d5b 7665 7249 6e78 5d20 5d0d 0a20  st][verInx] ].. 
+00040090: 2020 2020 2020 2020 2020 2073 6567 6d65             segme
+000400a0: 6e74 735b 7665 726c 6973 745d 203d 2076  nts[verlist] = v
+000400b0: 6572 4172 720d 0a0d 0a20 2020 2020 2020  erArr....       
+000400c0: 2072 6574 7572 6e20 7365 676d 656e 7473   return segments
+000400d0: 0d0a 2020 2020 0d0a 2020 2020 2320 2d2d  ..    ..    # --
+000400e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000400f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00040100: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00040110: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00040120: 2d2d 2d2b 0d0a 2020 2020 2320 4e6f 7465  ---+..    # Note
+00040130: 3a20 2020 2020 2020 2020 2020 2020 2020  :               
+00040140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040170: 207c 0d0a 2020 2020 2320 7468 6520 666f   |..    # the fo
+00040180: 6c6c 6f77 696e 6720 6669 7665 205f 632e  llowing five _c.
+00040190: 2e2e 2e5f 7665 7274 206d 6574 686f 6473  ..._vert methods
+000401a0: 2061 7373 6967 6e20 636f 6c6f 7220 616e   assign color an
+000401b0: 6420 7661 6c75 6573 2066 6f72 2020 207c  d values for   |
+000401c0: 0d0a 2020 2020 2320 6561 6368 2076 6572  ..    # each ver
+000401d0: 7465 7820 7768 6963 6820 6172 6520 6f6e  tex which are on
+000401e0: 6c79 2075 7365 6420 666f 7220 4675 7444  ly used for FutD
+000401f0: 6576 2065 7870 6f72 7420 6f66 2076 6572  ev export of ver
+00040200: 7465 7820 636f 6c6f 7273 2020 207c 0d0a  tex colors   |..
+00040210: 2020 2020 2320 2873 6567 6d65 6e74 2063      # (segment c
+00040220: 656e 7465 7220 636f 6c6f 7273 2061 7265  enter colors are
+00040230: 2075 7365 6420 666f 7220 7468 6520 6d61   used for the ma
+00040240: 7470 6c6f 746c 6962 2072 656e 6465 7269  tplotlib renderi
+00040250: 6e67 2920 2020 2020 2020 207c 0d0a 2020  ng)        |..  
+00040260: 2020 2320 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    # ------------
+00040270: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00040280: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00040290: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000402a0: 2d2d 2d2d 2d2d 2d2d 2d2b 200d 0a0d 0a20  ---------+ .... 
+000402b0: 2020 2064 6566 205f 6d61 705f 636d 6170     def _map_cmap
+000402c0: 5f66 726f 6d5f 7365 7175 656e 6365 5f76  _from_sequence_v
+000402d0: 6572 7428 7365 6c66 2c63 6d61 7029 203a  ert(self,cmap) :
+000402e0: 0d0a 2020 2020 2020 2020 6920 3d20 6e70  ..        i = np
+000402f0: 2e6c 696e 7370 6163 6528 302e 302c 312e  .linspace(0.0,1.
+00040300: 302c 206c 656e 2873 656c 662e 7665 7274  0, len(self.vert
+00040310: 6578 436f 6f72 2920 2920 2020 200d 0a20  exCoor) )    .. 
+00040320: 2020 2020 2020 206e 6f72 6d20 3d20 636f         norm = co
+00040330: 6c6f 7273 2e4e 6f72 6d61 6c69 7a65 2876  lors.Normalize(v
+00040340: 6d69 6e3d 302e 302c 766d 6178 3d31 2e30  min=0.0,vmax=1.0
+00040350: 290d 0a0d 0a20 2020 2020 2020 2063 6f6c  )....        col
+00040360: 6f72 203d 2063 6d61 7028 6e6f 726d 2869  or = cmap(norm(i
+00040370: 2929 0d0a 2020 2020 2020 2020 7365 6c66  ))..        self
+00040380: 2e76 6572 7465 7843 6f6c 6f72 203d 2063  .vertexColor = c
+00040390: 6f6c 6f72 0d0a 2020 2020 2020 2020 7365  olor..        se
+000403a0: 6c66 2e76 6572 7465 7856 616c 7565 7320  lf.vertexValues 
+000403b0: 3d20 6c69 7374 2820 7261 6e67 6528 6c65  = list( range(le
+000403c0: 6e28 7365 6c66 2e76 6572 7465 7843 6f6f  n(self.vertexCoo
+000403d0: 7229 2920 290d 0a20 2020 2020 2020 2073  r)) )..        s
+000403e0: 656c 662e 5f62 6f75 6e64 735b 2776 6572  elf._bounds['ver
+000403f0: 7476 6c69 6d27 5d20 3d20 5b20 302e 302c  tvlim'] = [ 0.0,
+00040400: 2031 2e30 205d 0d0a 2020 2020 2020 2020   1.0 ]..        
+00040410: 7265 7475 726e 0d0a 0d0a 2020 2020 6465  return....    de
+00040420: 6620 5f6d 6170 5f63 6d61 705f 6672 6f6d  f _map_cmap_from
+00040430: 5f64 6972 6563 7469 6f6e 5f76 6572 7428  _direction_vert(
+00040440: 2073 656c 662c 2065 6467 6563 6f6c 6f72   self, edgecolor
+00040450: 732c 2065 6467 6576 616c 7565 732c 2076  s, edgevalues, v
+00040460: 426f 756e 6473 2029 203a 0d0a 2020 2020  Bounds ) :..    
+00040470: 2020 2020 2320 7369 6e63 6520 7468 6520      # since the 
+00040480: 6469 7265 6374 696f 6e20 6973 2064 6570  direction is dep
+00040490: 656e 6465 6e74 206f 6e20 7477 6f20 7665  endent on two ve
+000404a0: 7274 6963 6573 2c0d 0a20 2020 2020 2020  rtices,..       
+000404b0: 2023 2074 6865 2073 6567 6d65 6e74 2063   # the segment c
+000404c0: 6f6c 6f72 7320 6172 6520 7573 6564 2066  olors are used f
+000404d0: 6f72 2074 6865 2076 6572 7465 7843 6f6c  or the vertexCol
+000404e0: 6f72 732e 0d0a 2020 2020 2020 2020 2320  ors...        # 
+000404f0: 5468 6520 6c61 7374 2076 6572 7465 7820  The last vertex 
+00040500: 636f 6c6f 7220 6973 2061 7373 6967 6e65  color is assigne
+00040510: 6420 7468 6520 6c61 7374 2073 6567 6d65  d the last segme
+00040520: 6e74 0d0a 2020 2020 2020 2020 2320 7365  nt..        # se
+00040530: 676d 656e 7420 636f 6c6f 7220 6173 2061  gment color as a
+00040540: 6e20 6170 7072 6f78 696d 6174 696f 6e2e  n approximation.
+00040550: 0d0a 2020 2020 2020 2020 6e75 6d45 6467  ..        numEdg
+00040560: 6573 203d 206c 656e 2865 6467 6563 6f6c  es = len(edgecol
+00040570: 6f72 7329 0d0a 0d0a 2020 2020 2020 2020  ors)....        
+00040580: 6c61 7374 436f 6c6f 7220 3d20 6564 6765  lastColor = edge
+00040590: 636f 6c6f 7273 5b6e 756d 4564 6765 732d  colors[numEdges-
+000405a0: 315d 0d0a 2020 2020 2020 2020 7643 6f6c  1]..        vCol
+000405b0: 6f72 203d 2063 6f70 792e 636f 7079 2865  or = copy.copy(e
+000405c0: 6467 6563 6f6c 6f72 7329 0d0a 2020 2020  dgecolors)..    
+000405d0: 2020 2020 7643 6f6c 6f72 203d 206e 702e      vColor = np.
+000405e0: 6170 7065 6e64 2876 436f 6c6f 722c 5b6c  append(vColor,[l
+000405f0: 6173 7443 6f6c 6f72 5d2c 6178 6973 3d30  astColor],axis=0
+00040600: 290d 0a0d 0a20 2020 2020 2020 206c 6173  )....        las
+00040610: 7456 616c 7565 203d 2065 6467 6576 616c  tValue = edgeval
+00040620: 7565 735b 6e75 6d45 6467 6573 2d31 5d0d  ues[numEdges-1].
+00040630: 0a20 2020 2020 2020 2076 5661 6c75 6520  .        vValue 
+00040640: 3d20 636f 7079 2e63 6f70 7928 6564 6765  = copy.copy(edge
+00040650: 7661 6c75 6573 290d 0a20 2020 2020 2020  values)..       
+00040660: 2076 5661 6c75 6520 3d20 6e70 2e61 7070   vValue = np.app
+00040670: 656e 6428 7656 616c 7565 2c5b 6c61 7374  end(vValue,[last
+00040680: 5661 6c75 655d 2c61 7869 733d 3029 0d0a  Value],axis=0)..
+00040690: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+000406a0: 2020 7365 6c66 2e76 6572 7465 7843 6f6c    self.vertexCol
+000406b0: 6f72 203d 2076 436f 6c6f 720d 0a20 2020  or = vColor..   
+000406c0: 2020 2020 2073 656c 662e 7665 7274 6578       self.vertex
+000406d0: 5661 6c75 6573 203d 2076 5661 6c75 650d  Values = vValue.
+000406e0: 0a20 2020 2020 2020 2073 656c 662e 5f62  .        self._b
+000406f0: 6f75 6e64 735b 2776 6572 7476 6c69 6d27  ounds['vertvlim'
+00040700: 5d20 3d20 7642 6f75 6e64 730d 0a20 2020  ] = vBounds..   
+00040710: 2020 2020 2072 6574 7572 6e0d 0a0d 0a20       return.... 
+00040720: 2020 2064 6566 205f 6d61 705f 636d 6170     def _map_cmap
+00040730: 5f66 726f 6d5f 6461 7461 6772 6964 5f76  _from_datagrid_v
+00040740: 6572 7428 7365 6c66 2c67 2c20 6465 6c74  ert(self,g, delt
+00040750: 612c 2064 6d69 6e2c 2063 6d61 7029 203a  a, dmin, cmap) :
+00040760: 0d0a 0d0a 2020 2020 2020 2020 782c 792c  ....        x,y,
+00040770: 5f20 3d20 6e70 2e74 7261 6e73 706f 7365  _ = np.transpose
+00040780: 2873 656c 662e 7665 7274 6578 436f 6f72  (self.vertexCoor
+00040790: 290d 0a0d 0a20 2020 2020 2020 2023 206e  )....        # n
+000407a0: 6f72 6d61 6c69 7a65 2078 7920 706c 616e  ormalize xy plan
+000407b0: 6520 2d31 2074 6f20 310d 0a20 2020 2020  e -1 to 1..     
+000407c0: 2020 2078 203d 206e 702e 696e 7465 7270     x = np.interp
+000407d0: 2820 782c 2028 782e 6d69 6e28 292c 2078  ( x, (x.min(), x
+000407e0: 2e6d 6178 2829 292c 2028 2d31 2e30 2c20  .max()), (-1.0, 
+000407f0: 312e 3029 2029 0d0a 2020 2020 2020 2020  1.0) )..        
+00040800: 7920 3d20 6e70 2e69 6e74 6572 7028 2079  y = np.interp( y
+00040810: 2c20 2879 2e6d 696e 2829 2c20 792e 6d61  , (y.min(), y.ma
+00040820: 7828 2929 2c20 282d 312e 302c 2031 2e30  x()), (-1.0, 1.0
+00040830: 2920 290d 0a0d 0a20 2020 2020 2020 2074  ) )....        t
+00040840: 7269 616c 203d 205b 2067 2820 785b 695d  rial = [ g( x[i]
+00040850: 2c79 5b69 5d29 5b30 5d20 666f 7220 6920  ,y[i])[0] for i 
+00040860: 696e 2072 616e 6765 286c 656e 2878 2929  in range(len(x))
+00040870: 205d 0d0a 0d0a 2020 2020 2020 2020 7620   ]....        v 
+00040880: 3d20 6e70 2e61 7272 6179 2874 7269 616c  = np.array(trial
+00040890: 292a 6465 6c74 6120 2b20 646d 696e 0d0a  )*delta + dmin..
+000408a0: 2020 2020 2020 2020 766d 696e 2c20 766d          vmin, vm
+000408b0: 6178 203d 2076 2e6d 696e 2829 2c20 762e  ax = v.min(), v.
+000408c0: 6d61 7828 290d 0a20 2020 2020 2020 206e  max()..        n
+000408d0: 6f72 6d20 3d20 636f 6c6f 7273 2e4e 6f72  orm = colors.Nor
+000408e0: 6d61 6c69 7a65 2876 6d69 6e3d 762e 6d69  malize(vmin=v.mi
+000408f0: 6e28 292c 766d 6178 3d76 2e6d 6178 2829  n(),vmax=v.max()
+00040900: 290d 0a0d 0a20 2020 2020 2020 2063 6f6c  )....        col
+00040910: 6f72 203d 2063 6d61 7028 6e6f 726d 2876  or = cmap(norm(v
+00040920: 2929 0d0a 2020 2020 2020 2020 7365 6c66  ))..        self
+00040930: 2e76 6572 7465 7843 6f6c 6f72 203d 2063  .vertexColor = c
+00040940: 6f6c 6f72 0d0a 2020 2020 2020 2020 7365  olor..        se
+00040950: 6c66 2e76 6572 7465 7856 616c 7565 7320  lf.vertexValues 
+00040960: 3d20 760d 0a20 2020 2020 2020 2073 656c  = v..        sel
+00040970: 662e 5f62 6f75 6e64 735b 2776 6572 7476  f._bounds['vertv
+00040980: 6c69 6d27 5d20 3d20 5b20 766d 696e 2c20  lim'] = [ vmin, 
+00040990: 766d 6178 205d 200d 0a20 2020 2020 2020  vmax ] ..       
+000409a0: 2072 6574 7572 6e20 0d0a 0d0a 2020 2020   return ....    
+000409b0: 6465 6620 5f6d 6170 5f63 6d61 705f 6672  def _map_cmap_fr
+000409c0: 6f6d 5f6f 705f 7665 7274 2873 656c 662c  om_op_vert(self,
+000409d0: 206f 7065 7261 7469 6f6e 2c20 636d 6170   operation, cmap
+000409e0: 2920 3a0d 0a20 2020 2020 2020 2078 797a  ) :..        xyz
+000409f0: 203d 206e 702e 7472 616e 7370 6f73 6528   = np.transpose(
+00040a00: 7365 6c66 2e76 6572 7465 7843 6f6f 7229  self.vertexCoor)
+00040a10: 0d0a 2020 2020 2020 2020 7620 3d20 6e70  ..        v = np
+00040a20: 2e61 7272 6179 286f 7065 7261 7469 6f6e  .array(operation
+00040a30: 2878 797a 2929 0d0a 2020 2020 2020 2020  (xyz))..        
+00040a40: 766d 696e 2c20 766d 6178 203d 2076 2e6d  vmin, vmax = v.m
+00040a50: 696e 2829 2c20 762e 6d61 7828 290d 0a20  in(), v.max().. 
+00040a60: 2020 2020 2020 206e 6f72 6d20 3d20 636f         norm = co
+00040a70: 6c6f 7273 2e4e 6f72 6d61 6c69 7a65 2876  lors.Normalize(v
+00040a80: 6d69 6e3d 762e 6d69 6e28 292c 766d 6178  min=v.min(),vmax
+00040a90: 3d76 2e6d 6178 2829 290d 0a20 2020 2020  =v.max())..     
+00040aa0: 2020 200d 0a20 2020 2020 2020 2063 6f6c     ..        col
+00040ab0: 6f72 203d 2063 6d61 7028 6e6f 726d 2876  or = cmap(norm(v
+00040ac0: 2929 0d0a 2020 2020 2020 2020 7365 6c66  ))..        self
+00040ad0: 2e76 6572 7465 7843 6f6c 6f72 203d 2063  .vertexColor = c
+00040ae0: 6f6c 6f72 0d0a 2020 2020 2020 2020 7365  olor..        se
+00040af0: 6c66 2e76 6572 7465 7856 616c 7565 7320  lf.vertexValues 
+00040b00: 3d20 760d 0a20 2020 2020 2020 2073 656c  = v..        sel
+00040b10: 662e 5f62 6f75 6e64 735b 2776 6572 7476  f._bounds['vertv
+00040b20: 6c69 6d27 5d20 3d20 5b20 766d 696e 2c20  lim'] = [ vmin, 
+00040b30: 766d 6178 205d 200d 0a20 2020 2020 2020  vmax ] ..       
+00040b40: 2072 6574 7572 6e20 0d0a 0d0a 2020 2020   return ....    
+00040b50: 6465 6620 5f6d 6170 5f63 6f6c 6f72 5f66  def _map_color_f
+00040b60: 726f 6d5f 6f70 5f76 6572 7428 7365 6c66  rom_op_vert(self
+00040b70: 2c20 6f70 6572 6174 696f 6e2c 2072 6762  , operation, rgb
+00040b80: 2920 3a0d 0a20 2020 2020 2020 2078 797a  ) :..        xyz
+00040b90: 203d 206e 702e 7472 616e 7370 6f73 6528   = np.transpose(
+00040ba0: 7365 6c66 2e76 6572 7465 7843 6f6f 7229  self.vertexCoor)
+00040bb0: 0d0a 2020 2020 2020 2020 636f 6c6f 7273  ..        colors
+00040bc0: 203d 206e 702e 6172 7261 7928 6f70 6572   = np.array(oper
+00040bd0: 6174 696f 6e28 7879 7a29 290d 0a20 2020  ation(xyz))..   
+00040be0: 2020 2020 2063 6f6c 6f72 7320 3d20 6e70       colors = np
+00040bf0: 2e74 7261 6e73 706f 7365 2863 6f6c 6f72  .transpose(color
+00040c00: 7329 0d0a 2020 2020 2020 2020 636f 6c6f  s)..        colo
+00040c10: 7273 203d 206e 702e 636c 6970 2863 6f6c  rs = np.clip(col
+00040c20: 6f72 732c 302c 3129 0d0a 2020 2020 2020  ors,0,1)..      
+00040c30: 2020 6966 2072 6762 203a 2052 4742 203d    if rgb : RGB =
+00040c40: 2063 6f6c 6f72 730d 0a20 2020 2020 2020   colors..       
+00040c50: 2065 6c73 6520 3a20 2020 5247 4220 3d20   else :   RGB = 
+00040c60: 636d 2e63 6f6c 6f72 732e 6873 765f 746f  cm.colors.hsv_to
+00040c70: 5f72 6762 2863 6f6c 6f72 7329 0d0a 2020  _rgb(colors)..  
+00040c80: 2020 2020 2020 6966 2052 4742 2e73 6861        if RGB.sha
+00040c90: 7065 5b31 5d20 3d3d 2033 203a 0d0a 2020  pe[1] == 3 :..  
+00040ca0: 2020 2020 2020 2020 2020 6f6e 6573 203d            ones =
+00040cb0: 206e 702e 6f6e 6573 2852 4742 2e73 6861   np.ones(RGB.sha
+00040cc0: 7065 5b30 5d29 5b3a 2c6e 702e 6e65 7761  pe[0])[:,np.newa
+00040cd0: 7869 735d 0d0a 2020 2020 2020 2020 2020  xis]..          
+00040ce0: 2020 5247 4220 3d20 6e70 2e63 6f6e 6361    RGB = np.conca
+00040cf0: 7465 6e61 7465 2828 5247 422c 6f6e 6573  tenate((RGB,ones
+00040d00: 292c 6178 6973 3d31 290d 0a20 2020 2020  ),axis=1)..     
+00040d10: 2020 200d 0a20 2020 2020 2020 2073 656c     ..        sel
+00040d20: 662e 7665 7274 6578 436f 6c6f 7220 3d20  f.vertexColor = 
+00040d30: 5247 420d 0a20 2020 2020 2020 2073 656c  RGB..        sel
+00040d40: 662e 7665 7274 6578 5661 6c75 6573 203d  f.vertexValues =
+00040d50: 204e 6f6e 650d 0a20 2020 2020 2020 2073   None..        s
+00040d60: 656c 662e 5f62 6f75 6e64 735b 2776 6572  elf._bounds['ver
+00040d70: 7476 6c69 6d27 5d20 3d20 5b20 302e 302c  tvlim'] = [ 0.0,
+00040d80: 2031 2e30 205d 200d 0a20 2020 2020 2020   1.0 ] ..       
+00040d90: 2072 6574 7572 6e0d 0a0d 0a20 2020 2023   return....    #
+00040da0: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
+00040db0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00040dc0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00040dd0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00040de0: 2d2d 2d2d 2d2d 0d0a 0d0a 2020 2020 4070  ------....    @p
+00040df0: 726f 7065 7274 790d 0a20 2020 2064 6566  roperty..    def
+00040e00: 205f 6c65 6467 6563 6f6c 6f72 7328 7365   _ledgecolors(se
+00040e10: 6c66 2920 3a0d 0a20 2020 2020 2020 2072  lf) :..        r
+00040e20: 6574 7572 6e20 7365 6c66 2e5f 6564 6765  eturn self._edge
+00040e30: 636f 6c6f 7273 0d0a 0d0a 2020 2020 405f  colors....    @_
+00040e40: 6c65 6467 6563 6f6c 6f72 732e 7365 7474  ledgecolors.sett
+00040e50: 6572 0d0a 2020 2020 6465 6620 5f6c 6564  er..    def _led
+00040e60: 6765 636f 6c6f 7273 2873 656c 662c 7661  gecolors(self,va
+00040e70: 6c29 203a 0d0a 2020 2020 2020 2020 7365  l) :..        se
+00040e80: 6c66 2e5f 6564 6765 636f 6c6f 7273 203d  lf._edgecolors =
+00040e90: 2076 616c 0d0a 2020 2020 2020 2020 7265   val..        re
+00040ea0: 7475 726e 0d0a 0d0a 2020 2020 4070 726f  turn....    @pro
+00040eb0: 7065 7274 790d 0a20 2020 2064 6566 2076  perty..    def v
+00040ec0: 6c69 6d28 7365 6c66 2920 3a0d 0a20 2020  lim(self) :..   
+00040ed0: 2020 2020 2027 2727 5261 6e67 6520 6f66       '''Range of
+00040ee0: 2073 6361 6c61 7220 7661 6c75 6573 2077   scalar values w
+00040ef0: 6869 6368 206d 6179 2062 6520 6173 736f  hich may be asso
+00040f00: 6369 6174 6564 2077 6974 6820 636f 6c6f  ciated with colo
+00040f10: 7227 2727 0d0a 2020 2020 2020 2020 7265  r'''..        re
+00040f20: 7475 726e 2073 656c 662e 5f62 6f75 6e64  turn self._bound
+00040f30: 735b 2776 6c69 6d27 5d0d 0a0d 0a20 2020  s['vlim']....   
+00040f40: 2040 766c 696d 2e73 6574 7465 720d 0a20   @vlim.setter.. 
+00040f50: 2020 2064 6566 2076 6c69 6d28 7365 6c66     def vlim(self
+00040f60: 2c76 616c 2920 3a0d 0a20 2020 2020 2020  ,val) :..       
+00040f70: 2073 656c 662e 5f62 6f75 6e64 735b 2776   self._bounds['v
+00040f80: 6c69 6d27 5d20 3d20 7661 6c0d 0a20 2020  lim'] = val..   
+00040f90: 2020 2020 2072 6574 7572 6e0d 0a0d 0a20       return.... 
+00040fa0: 2020 2040 7072 6f70 6572 7479 0d0a 2020     @property..  
+00040fb0: 2020 6465 6620 6e61 6d65 2873 656c 6629    def name(self)
+00040fc0: 203a 0d0a 2020 2020 2020 2020 2727 2744   :..        '''D
+00040fd0: 6573 6372 6970 7469 7665 2069 6465 6e74  escriptive ident
+00040fe0: 6966 6965 7220 666f 7220 7468 6520 6c69  ifier for the li
+00040ff0: 6e65 2067 656f 6d65 7472 792e 2727 270d  ne geometry.'''.
+00041000: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+00041010: 2e5f 6765 6f6d 4e61 6d65 2069 7320 4e6f  ._geomName is No
+00041020: 6e65 203a 2072 6574 7572 6e20 2727 0d0a  ne : return ''..
+00041030: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00041040: 656c 662e 5f67 656f 6d4e 616d 650d 0a0d  elf._geomName...
+00041050: 0a20 2020 2040 6e61 6d65 2e73 6574 7465  .    @name.sette
+00041060: 720d 0a20 2020 2064 6566 206e 616d 6528  r..    def name(
+00041070: 7365 6c66 2c20 7661 6c29 203a 0d0a 2020  self, val) :..  
+00041080: 2020 2020 2020 7365 6c66 2e5f 6765 6f6d        self._geom
+00041090: 4e61 6d65 203d 2076 616c 0d0a 2020 2020  Name = val..    
+000410a0: 2020 2020 7365 6c66 2e73 6574 5f6c 6162      self.set_lab
+000410b0: 656c 2820 2727 2069 6620 7661 6c20 6973  el( '' if val is
+000410c0: 204e 6f6e 6520 656c 7365 2076 616c 290d   None else val).
+000410d0: 0a20 2020 2020 2020 2072 6574 7572 6e0d  .        return.
+000410e0: 0a0d 0a20 2020 2040 7072 6f70 6572 7479  ...    @property
+000410f0: 0d0a 2020 2020 6465 6620 636e 616d 6528  ..    def cname(
+00041100: 7365 6c66 2920 3a0d 0a20 2020 2020 2020  self) :..       
+00041110: 2027 2727 4465 7363 7269 7074 6976 6520   '''Descriptive 
+00041120: 6964 656e 7469 6669 6572 2066 6f72 2076  identifier for v
+00041130: 616c 7565 7320 696e 6469 6361 7465 6420  alues indicated 
+00041140: 6279 2063 6f6c 6f72 2e27 2727 0d0a 2020  by color.'''..  
+00041150: 2020 2020 2020 6966 2073 656c 662e 7661        if self.va
+00041160: 6c75 6573 4e61 6d65 2069 7320 4e6f 6e65  luesName is None
+00041170: 203a 2072 6574 7572 6e20 2727 0d0a 2020   : return ''..  
+00041180: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00041190: 662e 7661 6c75 6573 4e61 6d65 0d0a 0d0a  f.valuesName....
+000411a0: 2020 2020 4063 6e61 6d65 2e73 6574 7465      @cname.sette
+000411b0: 720d 0a20 2020 2064 6566 2063 6e61 6d65  r..    def cname
+000411c0: 2873 656c 662c 2076 616c 2920 3a0d 0a20  (self, val) :.. 
+000411d0: 2020 2020 2020 2073 656c 662e 7661 6c75         self.valu
+000411e0: 6573 4e61 6d65 203d 2076 616c 0d0a 2020  esName = val..  
+000411f0: 2020 2020 2020 7265 7475 726e 0d0a 0d0a        return....
+00041200: 2020 2020 4070 726f 7065 7274 790d 0a20      @property.. 
+00041210: 2020 2064 6566 2076 6572 7469 6365 7328     def vertices(
+00041220: 7365 6c66 2920 3a0d 0a20 2020 2020 2020  self) :..       
+00041230: 2022 2222 4120 3320 7820 4e20 6172 7261   """A 3 x N arra
+00041240: 7920 6f66 206c 696e 6520 7665 7274 6963  y of line vertic
+00041250: 6573 2e22 2222 0d0a 2020 2020 2020 2020  es."""..        
+00041260: 7620 3d20 7365 6c66 2e76 6572 7465 7843  v = self.vertexC
+00041270: 6f6f 720d 0a20 2020 2020 2020 206d 203d  oor..        m =
+00041280: 206e 702e 7472 616e 7370 6f73 6528 7629   np.transpose(v)
+00041290: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+000412a0: 206d 0d0a 0d0a 2020 2020 4070 726f 7065   m....    @prope
+000412b0: 7274 790d 0a20 2020 2064 6566 2073 6567  rty..    def seg
+000412c0: 6d65 6e74 6365 6e74 6572 7328 7365 6c66  mentcenters(self
+000412d0: 2920 3a0d 0a20 2020 2020 2020 2022 2222  ) :..        """
+000412e0: 4120 3320 7820 4e20 6172 7261 7920 6f66  A 3 x N array of
+000412f0: 206c 696e 6520 7365 676d 656e 7420 6365   line segment ce
+00041300: 6e74 6572 732e 2222 2220 200d 0a20 2020  nters."""  ..   
+00041310: 2020 2020 2073 6567 6d65 6e74 7320 3d20       segments = 
+00041320: 7365 6c66 2e5f 7365 676d 656e 7473 3364  self._segments3d
+00041330: 0d0a 2020 2020 2020 2020 746f 7453 6567  ..        totSeg
+00041340: 7320 3d20 5b5d 0d0a 2020 2020 2020 2020  s = []..        
+00041350: 666f 7220 6c69 6e65 2069 6e20 7365 676d  for line in segm
+00041360: 656e 7473 203a 0d0a 2020 2020 2020 2020  ents :..        
+00041370: 2020 2020 6e70 6c69 6e65 203d 206e 702e      npline = np.
+00041380: 6172 7261 7928 6c69 6e65 290d 0a20 2020  array(line)..   
+00041390: 2020 2020 2020 2020 2066 6f72 2073 6567           for seg
+000413a0: 4978 2069 6e20 7261 6e67 6528 6e70 6c69  Ix in range(npli
+000413b0: 6e65 2e73 6861 7065 5b30 5d2d 3129 203a  ne.shape[0]-1) :
+000413c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000413d0: 2020 6365 6e74 6572 203d 206e 702e 6164    center = np.ad
+000413e0: 6428 6e70 6c69 6e65 5b73 6567 4978 5d2c  d(npline[segIx],
+000413f0: 6e70 6c69 6e65 5b73 6567 4978 2b31 5d29  npline[segIx+1])
+00041400: 2f32 0d0a 2020 2020 2020 2020 2020 2020  /2..            
+00041410: 2020 2020 746f 7453 6567 732e 6170 7065      totSegs.appe
+00041420: 6e64 2863 656e 7465 7229 0d0a 2020 2020  nd(center)..    
+00041430: 2020 2020 6d20 3d20 6e70 2e74 7261 6e73      m = np.trans
+00041440: 706f 7365 286e 702e 6172 7261 7928 746f  pose(np.array(to
+00041450: 7453 6567 7329 290d 0a20 2020 2020 2020  tSegs))..       
+00041460: 2072 6574 7572 6e20 6d0d 0a0d 0a20 2020   return m....   
+00041470: 2040 7072 6f70 6572 7479 0d0a 2020 2020   @property..    
+00041480: 6465 6620 7365 676d 656e 7464 6972 6563  def segmentdirec
+00041490: 7469 6f6e 7328 7365 6c66 2920 3a0d 0a20  tions(self) :.. 
+000414a0: 2020 2020 2020 2022 2222 4120 4e20 7820         """A N x 
+000414b0: 3320 6172 7261 7920 6f66 206c 696e 6520  3 array of line 
+000414c0: 7365 676d 656e 7420 6469 7265 6374 696f  segment directio
+000414d0: 6e20 7665 6374 6f72 732e 2222 2220 0d0a  n vectors.""" ..
+000414e0: 2020 2020 2020 2020 2320 2d2d 2d2d 2d2d          # ------
+000414f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00041500: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00041510: 2d2d 2d0d 0a20 2020 2020 2020 2073 6567  ---..        seg
+00041520: 6d65 6e74 7320 3d20 7365 6c66 2e5f 7365  ments = self._se
+00041530: 676d 656e 7473 3364 0d0a 2020 2020 2020  gments3d..      
+00041540: 2020 6966 206e 6f74 2073 656c 662e 6973    if not self.is
+00041550: 5368 7265 6464 6564 203a 0d0a 2020 2020  Shredded :..    
+00041560: 2020 2020 2020 2020 7365 676d 656e 7473          segments
+00041570: 203d 2073 656c 662e 5f73 6872 6564 2829   = self._shred()
+00041580: 0d0a 2020 2020 2020 2020 2320 2d2d 2d2d  ..        # ----
+00041590: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000415a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000415b0: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2076  -----..        v
+000415c0: 6654 203d 206e 702e 7472 616e 7370 6f73  fT = np.transpos
+000415d0: 6528 7365 676d 656e 7473 2c20 2831 2c30  e(segments, (1,0
+000415e0: 2c32 2920 290d 0a20 2020 2020 2020 2064  ,2) )..        d
+000415f0: 6972 6563 7469 6f6e 203d 2076 6654 5b31  irection = vfT[1
+00041600: 5d20 2d20 7666 545b 305d 0d0a 2020 2020  ] - vfT[0]..    
+00041610: 2020 2020 7265 7475 726e 2064 6972 6563      return direc
+00041620: 7469 6f6e 0d0a 0d0a 2020 2020 4070 726f  tion....    @pro
+00041630: 7065 7274 790d 0a20 2020 2064 6566 2073  perty..    def s
+00041640: 6567 6d65 6e74 636f 6c6f 7273 2873 656c  egmentcolors(sel
+00041650: 6629 203a 0d0a 2020 2020 2020 2020 2222  f) :..        ""
+00041660: 2241 204e 2078 2034 2061 7272 6179 206f  "A N x 4 array o
+00041670: 6620 7365 676d 656e 7420 636f 6c6f 7273  f segment colors
+00041680: 2e22 2222 0d0a 2020 2020 2020 2020 7265  ."""..        re
+00041690: 7475 726e 2073 656c 662e 5f6c 6564 6765  turn self._ledge
+000416a0: 636f 6c6f 7273 2020 2320 7570 6461 7465  colors  # update
+000416b0: 2066 6f72 2076 5f31 2e32 2e30 0d0a 0d0a   for v_1.2.0....
+000416c0: 2020 2020 4070 726f 7065 7274 790d 0a20      @property.. 
+000416d0: 2020 2064 6566 2062 6f75 6e64 7328 7365     def bounds(se
+000416e0: 6c66 2920 3a0d 0a20 2020 2020 2020 2022  lf) :..        "
+000416f0: 2222 0d0a 2020 2020 2020 2020 4469 6374  ""..        Dict
+00041700: 696f 6e61 7279 206f 6620 6c69 6e65 2067  ionary of line g
+00041710: 656f 6d65 7472 6963 2061 6e64 2076 616c  eometric and val
+00041720: 7565 2072 616e 6765 732e 0d0a 2020 2020  ue ranges...    
+00041730: 2020 2020 0d0a 2020 2020 2020 2020 4561      ..        Ea
+00041740: 6368 2064 6963 7469 6f6e 6172 7920 7661  ch dictionary va
+00041750: 6c75 6520 6973 2061 2032 2066 6c6f 6174  lue is a 2 float
+00041760: 2061 7272 6179 206f 6620 6d69 6e69 6d75   array of minimu
+00041770: 6d0d 0a20 2020 2020 2020 2061 6e64 206d  m..        and m
+00041780: 6178 696d 756d 2076 616c 7565 7320 6f66  aximum values of
+00041790: 2074 6865 206c 696e 652e 2020 4b65 7973   the line.  Keys
+000417a0: 2061 7265 3a0d 0a0d 0a20 2020 2020 2020   are:....       
+000417b0: 2027 786c 696d 2720 3a20 782d 636f 6f72   'xlim' : x-coor
+000417c0: 6469 6e61 7465 0d0a 0d0a 2020 2020 2020  dinate....      
+000417d0: 2020 2779 6c69 6d27 203a 2079 2d63 6f6f    'ylim' : y-coo
+000417e0: 7264 696e 6174 650d 0a0d 0a20 2020 2020  rdinate....     
+000417f0: 2020 2027 7a6c 696d 2720 3a20 7a2d 636f     'zlim' : z-co
+00041800: 6f72 6469 6e61 7465 0d0a 0d0a 2020 2020  ordinate....    
+00041810: 2020 2020 2772 5f78 7927 203a 2072 6164      'r_xy' : rad
+00041820: 6961 6c20 6469 7374 616e 6365 2066 726f  ial distance fro
+00041830: 6d20 7468 6520 7a20 6178 6973 0d0a 0d0a  m the z axis....
+00041840: 2020 2020 2020 2020 2772 6f72 6727 203a          'rorg' :
+00041850: 2072 6164 6961 6c20 6469 7374 616e 6365   radial distance
+00041860: 2066 726f 6d20 7468 6520 6f72 6967 696e   from the origin
+00041870: 0d0a 0d0a 2020 2020 2020 2020 2776 6c69  ....        'vli
+00041880: 6d27 203a 2076 616c 7565 2066 756e 6374  m' : value funct
+00041890: 696f 6e61 6c20 6173 7369 676e 6d65 6e74  ional assignment
+000418a0: 732e 0d0a 2020 2020 2020 2020 2020 2020  s...            
+000418b0: 0d0a 2020 2020 2020 2020 5661 6c75 6573  ..        Values
+000418c0: 2061 7265 2061 7373 6967 6e65 6420 6672   are assigned fr
+000418d0: 6f6d 2074 6865 2067 656f 6d65 7472 7920  om the geometry 
+000418e0: 616e 6420 636f 6c6f 7220 6d61 7070 696e  and color mappin
+000418f0: 6720 6d65 7468 6f64 732c 0d0a 2020 2020  g methods,..    
+00041900: 2020 2020 696e 636c 7564 696e 6720 636c      including cl
+00041910: 6c69 7070 696e 672e 0d0a 0d0a 2020 2020  lipping.....    
+00041920: 2020 2020 2222 220d 0a0d 0a20 2020 2020      """....     
+00041930: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+00041940: 626f 756e 6473 0d0a 2020 2020 0d0a 2020  bounds..    ..  
+00041950: 2020 4070 726f 7065 7274 790d 0a20 2020    @property..   
+00041960: 2064 6566 2063 4261 725f 5363 616c 6172   def cBar_Scalar
+00041970: 4d61 7070 6162 6c65 2873 656c 6629 203a  Mappable(self) :
+00041980: 0d0a 2020 2020 2020 2020 2222 226d 6174  ..        """mat
+00041990: 706c 6f74 6c69 622e 636d 2e53 6361 6c61  plotlib.cm.Scala
+000419a0: 724d 6170 7061 626c 6520 6f62 6a65 6374  rMappable object
+000419b0: 2066 6f72 206c 696e 6520 7661 6c75 6573   for line values
+000419c0: 2e20 2222 220d 0a0d 0a20 2020 2020 2020  . """....       
+000419d0: 2072 6574 7572 6e20 7365 6c66 2e73 7463   return self.stc
+000419e0: 4261 725f 5363 616c 6172 4d61 7070 6162  Bar_ScalarMappab
+000419f0: 6c65 2829 0d0a 0d0a 2020 2020 6465 6620  le()....    def 
+00041a00: 7374 6342 6172 5f53 6361 6c61 724d 6170  stcBar_ScalarMap
+00041a10: 7061 626c 6528 7365 6c66 2c20 7374 7269  pable(self, stri
+00041a20: 7065 3d4e 6f6e 652c 2062 6763 6f6c 6f72  pe=None, bgcolor
+00041a30: 3d27 6b27 2920 3a0d 0a20 2020 2020 2020  ='k') :..       
+00041a40: 2022 2222 0d0a 2020 2020 2020 2020 5363   """..        Sc
+00041a50: 616c 6172 4d61 7070 6162 6c65 206f 626a  alarMappable obj
+00041a60: 6563 7420 7769 7468 2073 7472 6970 6564  ect with striped
+00041a70: 2063 6f6c 6f72 2076 616c 7565 732e 0d0a   color values...
+00041a80: 2020 2020 2020 2020 5072 696d 6172 696c          Primaril
+00041a90: 7920 7573 6566 756c 2066 6f72 2064 6973  y useful for dis
+00041aa0: 706c 6179 206f 6620 636f 6e74 6f75 7220  play of contour 
+00041ab0: 636f 6c6f 7262 6172 732e 200d 0a20 2020  colorbars. ..   
+00041ac0: 2020 2020 200d 0a20 2020 2020 2020 2050       ..        P
+00041ad0: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
+00041ae0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
+00041af0: 2020 2020 2020 2073 7472 6970 6520 3a20         stripe : 
+00041b00: 696e 7465 6765 722c 206f 7074 696f 6e61  integer, optiona
+00041b10: 6c2c 2064 6566 6175 6c74 3a20 4e6f 6e65  l, default: None
+00041b20: 0d0a 2020 2020 2020 2020 2020 2020 4e75  ..            Nu
+00041b30: 6d62 6572 206f 6620 636f 6c6f 7220 7374  mber of color st
+00041b40: 7269 7065 732e 2020 4966 204e 6f6e 652c  ripes.  If None,
+00041b50: 206e 6f0d 0a20 2020 2020 2020 2020 2020   no..           
+00041b60: 2073 7472 6970 6573 2061 7265 2066 6f72   stripes are for
+00041b70: 6d65 642e 0d0a 2020 2020 2020 2020 0d0a  med...        ..
+00041b80: 2020 2020 2020 2020 6267 636f 6c6f 7220          bgcolor 
+00041b90: 3a20 636f 6c6f 722c 206f 7074 696f 6e61  : color, optiona
+00041ba0: 6c2c 2064 6566 6175 6c74 3a20 2762 6c61  l, default: 'bla
+00041bb0: 636b 270d 0a20 2020 2020 2020 2020 2020  ck'..           
+00041bc0: 2043 6f6c 6f72 2062 6574 7765 656e 2074   Color between t
+00041bd0: 6865 2073 7472 6970 6573 2e0d 0a20 2020  he stripes...   
+00041be0: 2020 2020 200d 0a20 2020 2020 2020 2052       ..        R
+00041bf0: 6574 7572 6e73 0d0a 2020 2020 2020 2020  eturns..        
+00041c00: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
+00041c10: 2073 656c 6620 3a20 4d61 7470 6c6f 746c   self : Matplotl
+00041c20: 6962 2e63 6d2e 5363 616c 6172 4d61 7070  ib.cm.ScalarMapp
+00041c30: 6162 6c65 206f 626a 6563 740d 0a20 2020  able object..   
+00041c40: 2020 2020 200d 0a20 2020 2020 2020 2022       ..        "
+00041c50: 2222 0d0a 2020 2020 2020 2020 2320 2e2e  ""..        # ..
+00041c60: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00041c70: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00041c80: 2e2e 2e2e 2e0d 0a20 2020 2020 2020 2064  .......        d
+00041c90: 6566 2073 7472 6970 6543 6d61 7028 2063  ef stripeCmap( c
+00041ca0: 6d61 702c 206e 756d 622c 2062 6163 6b67  map, numb, backg
+00041cb0: 726f 756e 643d 276b 272c 2063 6e61 6d65  round='k', cname
+00041cc0: 3d4e 6f6e 6529 203a 0d0a 2020 2020 2020  =None) :..      
+00041cd0: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
+00041ce0: 6e63 6528 636d 6170 2c73 7472 2920 3a20  nce(cmap,str) : 
+00041cf0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00041d00: 2020 636d 6170 203d 2063 6d2e 6765 745f    cmap = cm.get_
+00041d10: 636d 6170 2863 6d61 7029 0d0a 2020 2020  cmap(cmap)..    
+00041d20: 2020 2020 2020 2020 6e75 6d62 5365 6773          numbSegs
+00041d30: 203d 2032 3536 0d0a 2020 2020 2020 2020   = 256..        
+00041d40: 2020 2020 6d61 7849 6e64 7820 3d20 6e75      maxIndx = nu
+00041d50: 6d62 5365 6773 2d31 0d0a 2020 2020 2020  mbSegs-1..      
+00041d60: 2020 2020 2020 6267 726e 6420 3d20 636d        bgrnd = cm
+00041d70: 2e63 6f6c 6f72 732e 746f 5f72 6762 615f  .colors.to_rgba_
+00041d80: 6172 7261 7928 6261 636b 6772 6f75 6e64  array(background
+00041d90: 290d 0a20 2020 2020 2020 2020 2020 2063  )..            c
+00041da0: 4c69 7374 203d 206e 702e 7469 6c65 2820  List = np.tile( 
+00041db0: 6267 726e 642c 2028 6e75 6d62 5365 6773  bgrnd, (numbSegs
+00041dc0: 2c31 2929 0d0a 2020 2020 2020 2020 2020  ,1))..          
+00041dd0: 2020 6649 6e64 6578 203d 206e 702e 6c69    fIndex = np.li
+00041de0: 6e73 7061 6365 2830 2e30 2c31 2e30 2c6e  nspace(0.0,1.0,n
+00041df0: 756d 6229 0d0a 2020 2020 2020 2020 2020  umb)..          
+00041e00: 2020 666f 7220 6920 696e 2066 496e 6465    for i in fInde
+00041e10: 7820 3a0d 0a20 2020 2020 2020 2020 2020  x :..           
+00041e20: 2020 2020 2069 6e64 6578 203d 2069 6e74       index = int
+00041e30: 2869 2a28 6d61 7849 6e64 7829 290d 0a20  (i*(maxIndx)).. 
+00041e40: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00041e50: 4c69 7374 5b69 6e64 6578 5d20 3d20 636d  List[index] = cm
+00041e60: 6170 2869 290d 0a20 2020 2020 2020 2020  ap(i)..         
+00041e70: 2020 2020 2020 2069 6620 696e 6465 7820         if index 
+00041e80: 3c20 6d61 7849 6e64 7820 3a20 634c 6973  < maxIndx : cLis
+00041e90: 745b 696e 6465 782b 315d 203d 2063 6d61  t[index+1] = cma
+00041ea0: 7028 6929 0d0a 2020 2020 2020 2020 2020  p(i)..          
+00041eb0: 2020 2020 2020 656c 7365 203a 2063 4c69        else : cLi
+00041ec0: 7374 5b69 6e64 6578 2d32 5d20 3d20 636d  st[index-2] = cm
+00041ed0: 6170 2869 290d 0a20 2020 2020 2020 2020  ap(i)..         
+00041ee0: 2020 2020 2020 2069 6620 696e 6465 7820         if index 
+00041ef0: 3e20 3020 3a20 634c 6973 745b 696e 6465  > 0 : cList[inde
+00041f00: 782d 315d 203d 2063 6d61 7028 6929 0d0a  x-1] = cmap(i)..
+00041f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041f20: 656c 7365 203a 2063 4c69 7374 5b69 6e64  else : cList[ind
+00041f30: 6578 2b32 5d20 3d20 636d 6170 2869 290d  ex+2] = cmap(i).
+00041f40: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00041f50: 7572 6e20 636f 6c6f 7273 2e4c 6973 7465  urn colors.Liste
+00041f60: 6443 6f6c 6f72 6d61 7028 634c 6973 7429  dColormap(cList)
+00041f70: 0d0a 2020 2020 2020 2020 2320 2e2e 2e2e  ..        # ....
+00041f80: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00041f90: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00041fa0: 2e2e 2e0d 0a20 2020 2020 2020 2076 6d69  .....        vmi
+00041fb0: 6e2c 2076 6d61 7820 3d20 7365 6c66 2e5f  n, vmax = self._
+00041fc0: 626f 756e 6473 5b27 766c 696d 275d 0d0a  bounds['vlim']..
+00041fd0: 2020 2020 2020 2020 6e6f 726d 203d 2063          norm = c
+00041fe0: 6f6c 6f72 732e 4e6f 726d 616c 697a 6528  olors.Normalize(
+00041ff0: 766d 696e 3d76 6d69 6e2c 766d 6178 3d76  vmin=vmin,vmax=v
+00042000: 6d61 7829 0d0a 2020 2020 2020 2020 6f62  max)..        ob
+00042010: 6a4d 6170 203d 2073 656c 662e 6765 745f  jMap = self.get_
+00042020: 636d 6170 2829 0d0a 2020 2020 2020 2020  cmap()..        
+00042030: 6966 2073 7472 6970 6520 6973 206e 6f74  if stripe is not
+00042040: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
+00042050: 2020 2020 6f62 6a4d 6170 203d 2073 7472      objMap = str
+00042060: 6970 6543 6d61 7028 206f 626a 4d61 702c  ipeCmap( objMap,
+00042070: 2073 7472 6970 652c 2062 6763 6f6c 6f72   stripe, bgcolor
+00042080: 2920 0d0a 2020 2020 2020 2020 736d 203d  ) ..        sm =
+00042090: 2063 6d2e 5363 616c 6172 4d61 7070 6162   cm.ScalarMappab
+000420a0: 6c65 2863 6d61 703d 6f62 6a4d 6170 2c20  le(cmap=objMap, 
+000420b0: 6e6f 726d 3d6e 6f72 6d29 0d0a 2020 2020  norm=norm)..    
+000420c0: 2020 2020 736d 2e73 6574 5f61 7272 6179      sm.set_array
+000420d0: 285b 5d29 0d0a 2020 2020 2020 2020 7265  ([])..        re
+000420e0: 7475 726e 2073 6d20 2020 2020 2020 200d  turn sm        .
+000420f0: 0a0d 0a20 2020 2064 6566 2073 6872 6564  ...    def shred
+00042100: 2873 656c 662c 2072 657a 3d30 2920 3a0d  (self, rez=0) :.
+00042110: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
+00042120: 2020 2020 2020 5265 6375 7273 6976 656c        Recursivel
+00042130: 7920 6861 6c76 6520 6561 6368 206c 696e  y halve each lin
+00042140: 6520 7365 676d 656e 7420 696e 746f 2073  e segment into s
+00042150: 6570 6172 6174 6520 6c69 6e65 732e 0d0a  eparate lines...
+00042160: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+00042170: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
+00042180: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00042190: 0d0a 2020 2020 2020 2020 7265 7a20 3a20  ..        rez : 
+000421a0: 696e 7465 6765 722c 206f 7074 696f 6e61  integer, optiona
+000421b0: 6c2c 2064 6566 6175 6c74 3a20 300d 0a20  l, default: 0.. 
+000421c0: 2020 2020 2020 2020 2020 204e 756d 6265             Numbe
+000421d0: 7220 6f66 2072 6563 7572 7369 7665 2073  r of recursive s
+000421e0: 7562 6469 7669 7369 6f6e 7320 6f66 2061  ubdivisions of a
+000421f0: 206c 696e 6520 7365 676d 656e 742e 0d0a   line segment...
+00042200: 2020 2020 2020 2020 2020 2020 5661 6c75              Valu
+00042210: 6573 2072 616e 6765 2066 726f 6d20 3020  es range from 0 
+00042220: 746f 2037 2e0d 0a0d 0a20 2020 2020 2020  to 7.....       
+00042230: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
+00042240: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
+00042250: 2020 2073 656c 6620 3a20 6c69 6e65 206f     self : line o
+00042260: 626a 6563 740d 0a20 2020 2020 2020 200d  bject..        .
+00042270: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
+00042280: 2020 2020 2020 2320 2e2e 2e2e 2e2e 2e2e        # ........
+00042290: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+000422a0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+000422b0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+000422c0: 2e2e 2e2e 2e0d 0a20 2020 2020 2020 2064  .......        d
+000422d0: 6566 206d 6964 5365 676d 656e 7456 6572  ef midSegmentVer
+000422e0: 7469 6365 7328 6e75 6d44 6976 2c74 6169  tices(numDiv,tai
+000422f0: 6c43 6f6f 722c 2068 6561 6443 6f6f 7229  lCoor, headCoor)
+00042300: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
+00042310: 2320 7265 7475 726e 2061 6464 6564 2073  # return added s
+00042320: 7562 6469 7669 7369 6f6e 2076 6572 7469  ubdivision verti
+00042330: 6365 732c 2069 6e20 6f72 6465 7220 6672  ces, in order fr
+00042340: 6f6d 0d0a 2020 2020 2020 2020 2020 2020  om..            
+00042350: 2320 7461 696c 2074 6f20 6865 6164 2e0d  # tail to head..
+00042360: 0a20 2020 2020 2020 2020 2020 206d 696e  .            min
+00042370: 4c65 6e20 3d20 312e 302f 6e75 6d44 6976  Len = 1.0/numDiv
+00042380: 0d0a 2020 2020 2020 2020 2020 2020 6469  ..            di
+00042390: 7641 7272 203d 206e 702e 6c69 6e73 7061  vArr = np.linspa
+000423a0: 6365 286d 696e 4c65 6e2c 312e 302d 6d69  ce(minLen,1.0-mi
+000423b0: 6e4c 656e 2c20 6e75 6d44 6976 2d31 290d  nLen, numDiv-1).
+000423c0: 0a20 2020 2020 2020 2020 2020 2064 656c  .            del
+000423d0: 7461 203d 206e 702e 6172 7261 7928 6865  ta = np.array(he
+000423e0: 6164 436f 6f72 2920 2d20 6e70 2e61 7272  adCoor) - np.arr
+000423f0: 6179 2874 6169 6c43 6f6f 7229 0d0a 2020  ay(tailCoor)..  
+00042400: 2020 2020 2020 2020 2020 7653 6574 203d            vSet =
+00042410: 205b 2074 6169 6c43 6f6f 7220 2b20 6e70   [ tailCoor + np
+00042420: 2e6d 756c 7469 706c 7928 6465 6c74 612c  .multiply(delta,
+00042430: 6d75 6c74 2920 666f 7220 6d75 6c74 2069  mult) for mult i
+00042440: 6e20 6469 7641 7272 2020 5d0d 0a20 2020  n divArr  ]..   
+00042450: 2020 2020 2020 2020 2076 5365 7420 3d20           vSet = 
+00042460: 6e70 2e61 7272 6179 2876 5365 7429 0d0a  np.array(vSet)..
+00042470: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00042480: 726e 2076 5365 740d 0a20 2020 2020 2020  rn vSet..       
+00042490: 2023 202e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e   # .............
+000424a0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+000424b0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+000424c0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+000424d0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+000424e0: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
+000424f0: 7461 6e63 6528 7265 7a2c 2069 6e74 2920  tance(rez, int) 
+00042500: 3a0d 0a20 2020 2020 2020 2020 2020 2072  :..            r
+00042510: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+00042520: 2749 6e63 6f72 7265 6374 2072 657a 2074  'Incorrect rez t
+00042530: 7970 652c 206d 7573 7420 6261 206f 6620  ype, must ba of 
+00042540: 7479 7065 2069 6e74 2729 0d0a 2020 2020  type int')..    
+00042550: 2020 2020 6966 2028 7265 7a3c 3029 206f      if (rez<0) o
+00042560: 7220 2872 657a 3e5f 4d41 5852 455a 2920  r (rez>_MAXREZ) 
+00042570: 3a0d 0a20 2020 2020 2020 2020 2020 2072  :..            r
+00042580: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+00042590: 2749 6e63 6f72 7265 7374 2072 657a 206f  'Incorrest rez o
+000425a0: 6620 7b7d 2c20 6d75 7374 2062 6520 616e  f {}, must be an
+000425b0: 2069 6e74 2c20 3020 3c3d 2072 657a 203c   int, 0 <= rez <
+000425c0: 3d20 7b7d 272e 666f 726d 6174 2872 657a  = {}'.format(rez
+000425d0: 2c5f 4d41 5852 455a 2929 0d0a 0d0a 2020  ,_MAXREZ))....  
+000425e0: 2020 2020 2020 6e75 6d44 6976 203d 2069        numDiv = i
+000425f0: 6e74 2832 2a2a 7265 7a29 0d0a 2020 2020  nt(2**rez)..    
+00042600: 2020 2020 2320 4675 7444 6576 3a20 666f      # FutDev: fo
+00042610: 6c6c 6f77 696e 6720 7365 656d 7320 746f  llowing seems to
+00042620: 2077 6f72 6b20 696e 2063 6173 6573 2063   work in cases c
+00042630: 6865 636b 6564 2062 7574 2073 7469 6c6c  hecked but still
+00042640: 206e 6f74 2031 3030 2520 636f 6e66 6964   not 100% confid
+00042650: 656e 742e 0d0a 2020 2020 2020 2020 6966  ent...        if
+00042660: 206e 6f74 2073 656c 662e 6973 5368 7265   not self.isShre
+00042670: 6464 6564 203a 0d0a 2020 2020 2020 2020  dded :..        
+00042680: 2020 2020 636f 6c6f 7273 203d 2073 656c      colors = sel
+00042690: 662e 5f73 6872 6564 5f63 6f6c 6f72 2829  f._shred_color()
+000426a0: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
+000426b0: 6c66 2e5f 7368 7265 6428 290d 0a20 2020  lf._shred()..   
+000426c0: 2020 2020 2020 2020 2073 656c 662e 5f6c           self._l
+000426d0: 6564 6765 636f 6c6f 7273 203d 2063 6f6c  edgecolors = col
+000426e0: 6f72 7320 2023 2075 7064 6174 6520 666f  ors  # update fo
+000426f0: 7220 765f 312e 322e 300d 0a20 2020 2020  r v_1.2.0..     
+00042700: 2020 2020 2020 2023 2044 4556 4e4f 5445         # DEVNOTE
+00042710: 3a20 636f 6c6f 7273 206e 6f77 2072 6566  : colors now ref
+00042720: 6572 2074 6f20 7365 676d 656e 7420 636f  er to segment co
+00042730: 6c6f 7273 2c20 6e6f 7420 6c69 6e65 2063  lors, not line c
+00042740: 6f6c 6f72 732e 0d0a 2020 2020 2020 2020  olors...        
+00042750: 6966 2072 657a 3d3d 303a 2072 6574 7572  if rez==0: retur
+00042760: 6e20 7365 6c66 0d0a 2020 2020 2020 2020  n self..        
+00042770: 656c 7365 203a 0d0a 2020 2020 2020 2020  else :..        
+00042780: 2020 2063 6f6c 6f72 7320 3d20 7365 6c66     colors = self
+00042790: 2e5f 7368 7265 645f 7365 676d 5f63 6f6c  ._shred_segm_col
+000427a0: 6f72 286e 756d 4469 7629 200d 0a0d 0a20  or(numDiv) .... 
+000427b0: 2020 2020 2020 206e 756d 5365 6720 3d20         numSeg = 
+000427c0: 300d 0a20 2020 2020 2020 2066 6f72 206c  0..        for l
+000427d0: 696e 6520 696e 2073 656c 662e 6c69 6e65  ine in self.line
+000427e0: 496e 6469 6365 7320 3a20 6e75 6d53 6567  Indices : numSeg
+000427f0: 202b 3d20 6c65 6e28 6c69 6e65 292d 310d   += len(line)-1.
+00042800: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+00042810: 2020 206e 6577 5f76 6572 7465 7843 6f6f     new_vertexCoo
+00042820: 7220 3d20 6e70 2e63 6f70 7928 7365 6c66  r = np.copy(self
+00042830: 2e76 6572 7465 7843 6f6f 7229 0d0a 2020  .vertexCoor)..  
+00042840: 2020 2020 2020 6e65 775f 6c69 6e65 496e        new_lineIn
+00042850: 6469 6365 7320 3d20 5b5d 0d0a 2020 2020  dices = []..    
+00042860: 2020 2020 6e65 775f 7374 6172 745f 7665      new_start_ve
+00042870: 7274 5f69 6e64 6578 203d 206c 656e 2873  rt_index = len(s
+00042880: 656c 662e 7665 7274 6578 436f 6f72 290d  elf.vertexCoor).
+00042890: 0a20 2020 2020 2020 2066 6f72 206c 696e  .        for lin
+000428a0: 6520 696e 2073 656c 662e 6c69 6e65 496e  e in self.lineIn
+000428b0: 6469 6365 7320 3a0d 0a20 2020 2020 2020  dices :..       
+000428c0: 2020 2020 2073 696e 676c 655f 6c69 6e65       single_line
+000428d0: 496e 6465 7820 3d20 5b5d 0d0a 2020 2020  Index = []..    
+000428e0: 2020 2020 2020 2020 6e75 6d4c 696e 6553          numLineS
+000428f0: 6567 7320 3d20 6c65 6e28 6c69 6e65 292d  egs = len(line)-
+00042900: 310d 0a20 2020 2020 2020 2020 2020 206c  1..            l
+00042910: 6173 744c 696e 6556 6572 7449 6e64 6578  astLineVertIndex
+00042920: 203d 206e 756d 4c69 6e65 5365 6773 0d0a   = numLineSegs..
+00042930: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00042940: 6920 696e 2072 616e 6765 286e 756d 4c69  i in range(numLi
+00042950: 6e65 5365 6773 2029 203a 0d0a 2020 2020  neSegs ) :..    
+00042960: 2020 2020 2020 2020 2020 2020 7461 696c              tail
+00042970: 5f76 6572 7420 3d20 7365 6c66 2e76 6572  _vert = self.ver
+00042980: 7465 7843 6f6f 725b 206c 696e 655b 695d  texCoor[ line[i]
+00042990: 205d 2020 200d 0a20 2020 2020 2020 2020   ]   ..         
+000429a0: 2020 2020 2020 2068 6561 645f 7665 7274         head_vert
+000429b0: 203d 2073 656c 662e 7665 7274 6578 436f   = self.vertexCo
+000429c0: 6f72 5b20 6c69 6e65 5b69 2b31 5d20 5d0d  or[ line[i+1] ].
+000429d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000429e0: 2073 696e 676c 655f 6c69 6e65 496e 6465   single_lineInde
+000429f0: 782e 6170 7065 6e64 2820 6c69 6e65 5b69  x.append( line[i
+00042a00: 5d20 290d 0a20 2020 2020 2020 2020 2020  ] )..           
+00042a10: 2020 2020 206e 6577 5f76 6572 7473 203d       new_verts =
+00042a20: 206d 6964 5365 676d 656e 7456 6572 7469   midSegmentVerti
+00042a30: 6365 7328 6e75 6d44 6976 2c74 6169 6c5f  ces(numDiv,tail_
+00042a40: 7665 7274 2c20 6865 6164 5f76 6572 7429  vert, head_vert)
+00042a50: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00042a60: 2020 6e65 775f 7665 7274 6578 436f 6f72    new_vertexCoor
+00042a70: 203d 206e 702e 636f 6e63 6174 656e 6174   = np.concatenat
+00042a80: 6528 2028 6e65 775f 7665 7274 6578 436f  e( (new_vertexCo
+00042a90: 6f72 2c6e 6577 5f76 6572 7473 292c 6178  or,new_verts),ax
+00042aa0: 6973 3d30 290d 0a20 2020 2020 2020 2020  is=0)..         
+00042ab0: 2020 2020 2020 206e 6578 745f 7374 6172         next_star
+00042ac0: 745f 696e 6465 7820 3d20 6e65 775f 7374  t_index = new_st
+00042ad0: 6172 745f 7665 7274 5f69 6e64 6578 202b  art_vert_index +
+00042ae0: 206c 656e 286e 6577 5f76 6572 7473 290d   len(new_verts).
+00042af0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00042b00: 2074 656d 7020 3d20 5b2a 7261 6e67 6528   temp = [*range(
+00042b10: 6e65 775f 7374 6172 745f 7665 7274 5f69  new_start_vert_i
+00042b20: 6e64 6578 2c6e 6578 745f 7374 6172 745f  ndex,next_start_
+00042b30: 696e 6465 7829 5d0d 0a20 2020 2020 2020  index)]..       
+00042b40: 2020 2020 2020 2020 2073 696e 676c 655f           single_
+00042b50: 6c69 6e65 496e 6465 782e 6578 7465 6e64  lineIndex.extend
+00042b60: 2820 7465 6d70 2029 0d0a 2020 2020 2020  ( temp )..      
+00042b70: 2020 2020 2020 2020 2020 6e65 775f 7374            new_st
+00042b80: 6172 745f 7665 7274 5f69 6e64 6578 203d  art_vert_index =
+00042b90: 206e 6578 745f 7374 6172 745f 696e 6465   next_start_inde
+00042ba0: 780d 0a20 2020 2020 2020 2020 2020 2020  x..             
+00042bb0: 2020 2069 6620 2869 2b31 2920 3d3d 206c     if (i+1) == l
+00042bc0: 6173 744c 696e 6556 6572 7449 6e64 6578  astLineVertIndex
+00042bd0: 203a 2073 696e 676c 655f 6c69 6e65 496e   : single_lineIn
+00042be0: 6465 782e 6170 7065 6e64 2820 6c69 6e65  dex.append( line
+00042bf0: 5b69 2b31 5d20 290d 0a20 2020 2020 2020  [i+1] )..       
+00042c00: 2020 2020 206e 6577 5f6c 696e 6549 6e64       new_lineInd
+00042c10: 6963 6573 2e61 7070 656e 6428 7369 6e67  ices.append(sing
+00042c20: 6c65 5f6c 696e 6549 6e64 6578 290d 0a0d  le_lineIndex)...
+00042c30: 0a20 2020 2020 2020 2073 656c 662e 7665  .        self.ve
+00042c40: 7274 6578 436f 6f72 203d 206e 6577 5f76  rtexCoor = new_v
+00042c50: 6572 7465 7843 6f6f 720d 0a20 2020 2020  ertexCoor..     
+00042c60: 2020 2073 656c 662e 6c69 6e65 496e 6469     self.lineIndi
+00042c70: 6365 7320 3d20 6e65 775f 6c69 6e65 496e  ces = new_lineIn
+00042c80: 6469 6365 730d 0a20 2020 2020 2020 2073  dices..        s
+00042c90: 656c 662e 5f73 6872 6564 2829 0d0a 2020  elf._shred()..  
+00042ca0: 2020 2020 2020 7365 6c66 2e5f 6c65 6467        self._ledg
+00042cb0: 6563 6f6c 6f72 7320 3d20 636f 6c6f 7273  ecolors = colors
+00042cc0: 2020 2320 7570 6461 7465 2066 6f72 2076    # update for v
+00042cd0: 5f31 2e32 2e30 0d0a 2020 2020 2020 2020  _1.2.0..        
+00042ce0: 7265 7475 726e 2073 656c 660d 0a20 2020  return self..   
+00042cf0: 200d 0a20 2020 2064 6566 206d 6170 5f63   ..    def map_c
+00042d00: 6d61 705f 6672 6f6d 5f73 6571 7565 6e63  map_from_sequenc
+00042d10: 6528 2073 656c 662c 2063 6d61 703d 4e6f  e( self, cmap=No
+00042d20: 6e65 2c20 736f 703d 4e6f 6e65 2c20 636e  ne, sop=None, cn
+00042d30: 616d 653d 4e6f 6e65 2029 203a 0d0a 2020  ame=None ) :..  
+00042d40: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
+00042d50: 2020 2053 6571 7565 6e74 6961 6c20 636f     Sequential co
+00042d60: 6c6f 7220 6173 7369 676e 6d65 6e74 206f  lor assignment o
+00042d70: 6620 6561 6368 206c 696e 6520 7365 676d  f each line segm
+00042d80: 656e 742e 0d0a 0d0a 2020 2020 2020 2020  ent.....        
+00042d90: 5061 7261 6d65 7465 7273 0d0a 2020 2020  Parameters..    
+00042da0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a      ----------..
+00042db0: 2020 2020 2020 2020 636d 6170 203a 2073          cmap : s
+00042dc0: 7472 206f 7220 436f 6c6f 726d 6170 2c20  tr or Colormap, 
+00042dd0: 6f70 7469 6f6e 616c 2c20 6465 6661 756c  optional, defaul
+00042de0: 743a 2027 7669 7269 6469 7327 0d0a 2020  t: 'viridis'..  
+00042df0: 2020 2020 2020 2020 2020 4120 436f 6c6f            A Colo
+00042e00: 726d 6170 2069 6e73 7461 6e63 6520 6f72  rmap instance or
+00042e10: 2072 6567 6973 7465 7265 6420 636f 6c6f   registered colo
+00042e20: 726d 6170 206e 616d 652e 0d0a 2020 2020  rmap name...    
+00042e30: 2020 2020 0d0a 2020 2020 2020 2020 736f      ..        so
+00042e40: 7020 3a20 6675 6e63 7469 6f6e 206f 626a  p : function obj
+00042e50: 6563 742c 206f 7074 696f 6e61 6c2c 2064  ect, optional, d
+00042e60: 6566 6175 6c74 3a20 4e6f 6e65 0d0a 2020  efault: None..  
+00042e70: 2020 2020 2020 2020 2020 4675 6e63 7469            Functi
+00042e80: 6f6e 2074 6861 7420 7461 6b65 7320 6f6e  on that takes on
+00042e90: 6520 6172 6775 6d65 6e74 2c0d 0a20 2020  e argument,..   
+00042ea0: 2020 2020 2020 2020 2061 204e 204e 756d           a N Num
+00042eb0: 7079 2061 7272 6179 206f 6620 7363 616c  py array of scal
+00042ec0: 6172 2076 616c 7565 7320 7261 6e67 696e  ar values rangin
+00042ed0: 6720 3020 746f 2031 2e0d 0a20 2020 2020  g 0 to 1...     
+00042ee0: 2020 2020 2020 2054 6865 2066 756e 6374         The funct
+00042ef0: 696f 6e20 7265 7475 726e 7320 6120 4e75  ion returns a Nu
+00042f00: 6d70 7920 6172 7261 7920 6f66 2073 6361  mpy array of sca
+00042f10: 6c61 7220 7661 6c75 6573 2e0d 0a0d 0a20  lar values..... 
+00042f20: 2020 2020 2020 2063 6e61 6d65 203a 2073         cname : s
+00042f30: 7472 2c20 6f70 7469 6f6e 616c 2c20 6465  tr, optional, de
+00042f40: 6661 756c 743a 2066 756e 6374 696f 6e20  fault: function 
+00042f50: 6f62 6a65 6374 206e 616d 650d 0a20 2020  object name..   
+00042f60: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00042f70: 6e6f 7420 6120 6c61 6d62 6461 2066 756e  not a lambda fun
+00042f80: 6374 696f 6e2c 206f 7468 6572 7769 7365  ction, otherwise
+00042f90: 2027 272e 0d0a 2020 2020 2020 2020 2020   ''...          
+00042fa0: 2020 2020 2020 4964 656e 7469 6669 6572        Identifier
+00042fb0: 2066 6f72 2074 6865 2063 6f6c 6f72 2076   for the color v
+00042fc0: 616c 7565 732e 0d0a 2020 2020 2020 2020  alues...        
+00042fd0: 0d0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+00042fe0: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+00042ff0: 2d2d 0d0a 2020 2020 2020 2020 7365 6c66  --..        self
+00043000: 203a 206c 696e 6520 6f62 6a65 6374 0d0a   : line object..
+00043010: 0d0a 2020 2020 2020 2020 2222 220d 0a0d  ..        """...
+00043020: 0a20 2020 2020 2020 2069 6620 636d 6170  .        if cmap
+00043030: 2069 7320 6e6f 7420 4e6f 6e65 203a 0d0a   is not None :..
+00043040: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+00043050: 7369 6e73 7461 6e63 6528 636d 6170 2c73  sinstance(cmap,s
+00043060: 7472 2920 3a20 0d0a 2020 2020 2020 2020  tr) : ..        
+00043070: 2020 2020 2020 2020 7365 6c66 2e73 6574          self.set
+00043080: 5f63 6d61 7028 636d 2e67 6574 5f63 6d61  _cmap(cm.get_cma
+00043090: 7028 636d 6170 2929 0d0a 2020 2020 2020  p(cmap))..      
+000430a0: 2020 2020 2020 656c 7365 203a 0d0a 2020        else :..  
+000430b0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+000430c0: 6c66 2e73 6574 5f63 6d61 7028 636d 6170  lf.set_cmap(cmap
+000430d0: 290d 0a20 2020 2020 2020 2063 6d5f 636f  )..        cm_co
+000430e0: 6c6f 724d 6170 203d 2073 656c 662e 6765  lorMap = self.ge
+000430f0: 745f 636d 6170 2829 0d0a 0d0a 2020 2020  t_cmap()....    
+00043100: 2020 2020 7365 6c66 2e76 616c 7565 734e      self.valuesN
+00043110: 616d 6520 3d20 2753 6571 7565 6e63 6527  ame = 'Sequence'
+00043120: 2020 200d 0a20 2020 2020 2020 2023 202d     ..        # -
+00043130: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00043140: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00043150: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
+00043160: 2020 7365 676d 656e 7473 203d 2073 656c    segments = sel
+00043170: 662e 5f73 6567 6d65 6e74 7333 640d 0a20  f._segments3d.. 
+00043180: 2020 2020 2020 2069 6620 6e6f 7420 7365         if not se
+00043190: 6c66 2e69 7353 6872 6564 6465 6420 3a0d  lf.isShredded :.
+000431a0: 0a20 2020 2020 2020 2020 2020 2073 6567  .            seg
+000431b0: 6d65 6e74 7320 3d20 7365 6c66 2e5f 7368  ments = self._sh
+000431c0: 7265 6428 290d 0a20 2020 2020 2020 2023  red()..        #
+000431d0: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
+000431e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000431f0: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
+00043200: 2020 2020 6920 3d20 6e70 2e6c 696e 7370      i = np.linsp
+00043210: 6163 6528 302e 302c 312e 302c 206c 656e  ace(0.0,1.0, len
+00043220: 2873 6567 6d65 6e74 7329 2029 0d0a 2020  (segments) )..  
+00043230: 2020 2020 2020 7620 3d20 690d 0a20 2020        v = i..   
+00043240: 2020 2020 2076 6d69 6e2c 2076 6d61 7820       vmin, vmax 
+00043250: 3d20 302e 302c 2031 2e30 0d0a 2020 2020  = 0.0, 1.0..    
+00043260: 2020 2020 6966 2073 6f70 2069 7320 6e6f      if sop is no
+00043270: 7420 4e6f 6e65 203a 0d0a 2020 2020 2020  t None :..      
+00043280: 2020 2020 2020 7465 6d70 203d 205f 6765        temp = _ge
+00043290: 7446 756e 6374 696f 6e4e 616d 6528 736f  tFunctionName(so
+000432a0: 702c 636e 616d 6529 0d0a 2020 2020 2020  p,cname)..      
+000432b0: 2020 2020 2020 6966 2074 656d 7020 6973        if temp is
+000432c0: 206e 6f74 204e 6f6e 6520 3a20 7365 6c66   not None : self
+000432d0: 2e76 616c 7565 734e 616d 6520 3d20 7465  .valuesName = te
+000432e0: 6d70 0d0a 2020 2020 2020 2020 2020 2020  mp..            
+000432f0: 7620 3d20 6e70 2e61 7272 6179 2873 6f70  v = np.array(sop
+00043300: 2869 2929 0d0a 2020 2020 2020 2020 2020  (i))..          
+00043310: 2020 766d 696e 2c20 766d 6178 203d 2076    vmin, vmax = v
+00043320: 2e6d 696e 2829 2c20 762e 6d61 7828 290d  .min(), v.max().
+00043330: 0a0d 0a20 2020 2020 2020 206e 6f72 6d20  ...        norm 
+00043340: 3d20 636f 6c6f 7273 2e4e 6f72 6d61 6c69  = colors.Normali
+00043350: 7a65 2876 6d69 6e3d 766d 696e 2c76 6d61  ze(vmin=vmin,vma
+00043360: 783d 766d 6178 290d 0a20 2020 2020 2020  x=vmax)..       
+00043370: 2073 656c 662e 5f6c 6564 6765 636f 6c6f   self._ledgecolo
+00043380: 7273 203d 2063 6d5f 636f 6c6f 724d 6170  rs = cm_colorMap
+00043390: 286e 6f72 6d28 7629 2920 2023 2075 7064  (norm(v))  # upd
+000433a0: 6174 6520 666f 7220 765f 312e 322e 300d  ate for v_1.2.0.
+000433b0: 0a20 2020 2020 2020 2052 4742 203d 2063  .        RGB = c
+000433c0: 6d5f 636f 6c6f 724d 6170 286e 6f72 6d28  m_colorMap(norm(
+000433d0: 7629 290d 0a20 2020 2020 2020 2073 656c  v))..        sel
+000433e0: 662e 7365 745f 636f 6c6f 7228 5247 4229  f.set_color(RGB)
+000433f0: 2020 2320 3c3c 3c3c 3c3c 3c3c 3c3c 3c3c    # <<<<<<<<<<<<
+00043400: 3c3c 3c3c 3c3c 3c3c 3c3c 3c20 6465 6275  <<<<<<<<<<< debu
+00043410: 670d 0a0d 0a20 2020 2020 2020 2073 656c  g....        sel
+00043420: 662e 7365 6756 616c 7565 7320 3d20 760d  f.segValues = v.
+00043430: 0a20 2020 2020 2020 2073 656c 662e 5f62  .        self._b
+00043440: 6f75 6e64 735b 2776 6c69 6d27 5d20 3d20  ounds['vlim'] = 
+00043450: 5b20 766d 696e 2c20 766d 6178 205d 200d  [ vmin, vmax ] .
+00043460: 0a20 2020 2020 2020 2023 202e 2e2e 2e2e  .        # .....
+00043470: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00043480: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00043490: 2e2e 2e2e 2e2e 2e2e 0d0a 2020 2020 2020  ..........      
+000434a0: 2020 7365 6c66 2e5f 6d61 705f 636d 6170    self._map_cmap
+000434b0: 5f66 726f 6d5f 7365 7175 656e 6365 5f76  _from_sequence_v
+000434c0: 6572 7428 636d 5f63 6f6c 6f72 4d61 7029  ert(cm_colorMap)
+000434d0: 0d0a 2020 2020 2020 2020 2320 2e2e 2e2e  ..        # ....
+000434e0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+000434f0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00043500: 2e2e 2e2e 2e2e 2e2e 2e0d 0a20 2020 2020  ...........     
+00043510: 2020 2072 6574 7572 6e20 7365 6c66 2020     return self  
+00043520: 200d 0a0d 0a20 2020 2064 6566 206d 6170   ....    def map
+00043530: 5f63 6d61 705f 6672 6f6d 5f64 6972 6563  _cmap_from_direc
+00043540: 7469 6f6e 2820 7365 6c66 2c20 6469 7265  tion( self, dire
+00043550: 6374 696f 6e3d 4e6f 6e65 2c20 636d 6170  ction=None, cmap
+00043560: 3d4e 6f6e 652c 2069 7341 6273 3d46 616c  =None, isAbs=Fal
+00043570: 7365 2c20 636e 616d 653d 4e6f 6e65 2020  se, cname=None  
+00043580: 2920 3a0d 0a20 2020 2020 2020 2022 2222  ) :..        """
+00043590: 0d0a 2020 2020 2020 2020 4173 7369 676e  ..        Assign
+000435a0: 6d65 6e74 206f 6620 6c69 6e65 2063 6f6c  ment of line col
+000435b0: 6f72 2062 6173 6564 206f 6e20 6c69 6e65  or based on line
+000435c0: 2073 6567 6d65 6e74 2064 6972 6563 7469   segment directi
+000435d0: 6f6e 2e0d 0a0d 0a20 2020 2020 2020 2054  on.....        T
+000435e0: 6865 2064 6f74 2070 726f 6475 6374 206f  he dot product o
+000435f0: 6620 6c69 6e65 2073 6567 6d65 6e74 2064  f line segment d
+00043600: 6972 6563 7469 6f6e 7320 7769 7468 2074  irections with t
+00043610: 6865 2064 6972 6563 7469 6f6e 2070 6172  he direction par
+00043620: 616d 656e 7465 720d 0a20 2020 2020 2020  amenter..       
+00043630: 2069 7320 7573 6564 2074 6f20 6173 7369   is used to assi
+00043640: 676e 206c 696e 6520 7365 676d 656e 7420  gn line segment 
+00043650: 636f 6c6f 7273 2066 726f 6d20 6120 636f  colors from a co
+00043660: 6c6f 726d 6170 2e0d 0a0d 0a20 2020 2020  lormap.....     
+00043670: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
+00043680: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00043690: 2d0d 0a20 2020 2020 2020 2064 6972 6563  -..        direc
+000436a0: 7469 6f6e 203a 2061 7272 6179 2d6c 696b  tion : array-lik
+000436b0: 652c 206f 7074 696f 6e61 6c2c 2064 6566  e, optional, def
+000436c0: 6175 6c74 3a20 2831 2c30 2c31 290d 0a20  ault: (1,0,1).. 
+000436d0: 2020 2020 2020 2020 2020 2041 2078 797a             A xyz
+000436e0: 2076 6563 746f 722e 200d 0a0d 0a20 2020   vector. ....   
+000436f0: 2020 2020 2063 6d61 7020 3a20 7374 7220       cmap : str 
+00043700: 6f72 2043 6f6c 6f72 6d61 702c 206f 7074  or Colormap, opt
+00043710: 696f 6e61 6c2c 2064 6566 6175 6c74 3a20  ional, default: 
+00043720: 2776 6972 6964 6973 270d 0a20 2020 2020  'viridis'..     
+00043730: 2020 2020 2020 2041 2043 6f6c 6f72 6d61         A Colorma
+00043740: 7020 696e 7374 616e 6365 206f 7220 7265  p instance or re
+00043750: 6769 7374 6572 6564 2063 6f6c 6f72 6d61  gistered colorma
+00043760: 7020 6e61 6d65 2e0d 0a20 2020 2020 2020  p name...       
+00043770: 200d 0a20 2020 2020 2020 2069 7341 6273   ..        isAbs
+00043780: 203a 2062 6f6f 6c65 616e 2c20 6f70 7469   : boolean, opti
+00043790: 6f6e 616c 2c20 6465 6661 756c 743a 2046  onal, default: F
+000437a0: 616c 7365 0d0a 2020 2020 2020 2020 2020  alse..          
+000437b0: 2020 2020 2020 4966 2054 7275 652c 2074        If True, t
+000437c0: 6865 2061 6273 6f6c 7574 6520 7661 6c75  he absolute valu
+000437d0: 6520 6f66 2074 6865 2064 6f74 2070 726f  e of the dot pro
+000437e0: 6475 6374 0d0a 2020 2020 2020 2020 2020  duct..          
+000437f0: 2020 2020 2020 7769 6c6c 2063 6f6e 7472        will contr
+00043800: 6f6c 2074 6865 2063 6f6c 6f72 2e0d 0a0d  ol the color....
+00043810: 0a20 2020 2020 2020 2063 6e61 6d65 203a  .        cname :
+00043820: 2073 7472 2c20 6f70 7469 6f6e 616c 2c20   str, optional, 
+00043830: 6465 6661 756c 7420 6973 204e 6f6e 650d  default is None.
+00043840: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00043850: 2049 6465 6e74 6966 6965 7220 666f 7220   Identifier for 
+00043860: 7468 6520 636f 6c6f 7220 7661 6c75 6573  the color values
+00043870: 2e0d 0a0d 0a20 2020 2020 2020 2052 6574  .....        Ret
+00043880: 7572 6e73 0d0a 2020 2020 2020 2020 2d2d  urns..        --
+00043890: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2073  -----..        s
+000438a0: 656c 6620 3a20 6c69 6e65 206f 626a 6563  elf : line objec
+000438b0: 740d 0a0d 0a20 2020 2020 2020 2022 2222  t....        """
+000438c0: 0d0a 0d0a 2020 2020 2020 2020 6966 2064  ....        if d
+000438d0: 6972 6563 7469 6f6e 2069 7320 4e6f 6e65  irection is None
+000438e0: 203a 2064 6972 6563 7469 6f6e 203d 205f   : direction = _
+000438f0: 494c 4c55 4d0d 0a0d 0a20 2020 2020 2020  ILLUM....       
+00043900: 2069 6620 636d 6170 2069 7320 6e6f 7420   if cmap is not 
+00043910: 4e6f 6e65 203a 0d0a 2020 2020 2020 2020  None :..        
+00043920: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+00043930: 6528 636d 6170 2c73 7472 2920 3a20 0d0a  e(cmap,str) : ..
+00043940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00043950: 7365 6c66 2e73 6574 5f63 6d61 7028 636d  self.set_cmap(cm
+00043960: 2e67 6574 5f63 6d61 7028 636d 6170 2929  .get_cmap(cmap))
+00043970: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
+00043980: 7365 203a 0d0a 2020 2020 2020 2020 2020  se :..          
+00043990: 2020 2020 2020 7365 6c66 2e73 6574 5f63        self.set_c
+000439a0: 6d61 7028 636d 6170 290d 0a20 2020 2020  map(cmap)..     
+000439b0: 2020 2063 6d5f 636f 6c6f 724d 6170 203d     cm_colorMap =
+000439c0: 2073 656c 662e 6765 745f 636d 6170 2829   self.get_cmap()
+000439d0: 0d0a 0d0a 0d0a 2020 2020 2020 2020 7365  ......        se
+000439e0: 6c66 2e76 616c 7565 734e 616d 6520 3d20  lf.valuesName = 
+000439f0: 636e 616d 650d 0a20 2020 2020 2020 2023  cname..        #
+00043a00: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
+00043a10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00043a20: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
+00043a30: 2020 2020 7365 676d 656e 7473 203d 2073      segments = s
+00043a40: 656c 662e 5f73 6567 6d65 6e74 7333 640d  elf._segments3d.
+00043a50: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
+00043a60: 7365 6c66 2e69 7353 6872 6564 6465 6420  self.isShredded 
+00043a70: 3a0d 0a20 2020 2020 2020 2020 2020 2073  :..            s
+00043a80: 6567 6d65 6e74 7320 3d20 7365 6c66 2e5f  egments = self._
+00043a90: 7368 7265 6428 290d 0a20 2020 2020 2020  shred()..       
+00043aa0: 2023 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   # -------------
 00043ab0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00043ac0: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
-00043ad0: 2020 2063 6f6c 6f72 7320 3d20 7365 6c66     colors = self
-00043ae0: 2e5f 6564 6765 636f 6c6f 7273 0d0a 2020  ._edgecolors..  
-00043af0: 2020 2020 2020 7365 676d 656e 7473 203d        segments =
-00043b00: 2073 656c 662e 5f73 6567 6d65 6e74 7333   self._segments3
-00043b10: 640d 0a20 2020 2020 2020 2069 6620 6e6f  d..        if no
-00043b20: 7420 7365 6c66 2e69 7353 6872 6564 6465  t self.isShredde
-00043b30: 6420 3a0d 0a20 2020 2020 2020 2020 2020  d :..           
-00043b40: 2023 202e 2e2e 2e20 6e6f 7465 3a63 6f6c   # .... note:col
-00043b50: 6f72 7320 6d6f 6469 6669 6564 2c20 6e6f  ors modified, no
-00043b60: 7420 6372 6561 7465 640d 0a20 2020 2020  t created..     
-00043b70: 2020 2020 2020 2063 6f6c 6f72 7320 3d20         colors = 
-00043b80: 7365 6c66 2e5f 7368 7265 645f 636f 6c6f  self._shred_colo
-00043b90: 7228 290d 0a20 2020 2020 2020 2020 2020  r()..           
-00043ba0: 2073 6567 6d65 6e74 7320 3d20 7365 6c66   segments = self
-00043bb0: 2e5f 7368 7265 6428 290d 0a20 2020 2020  ._shred()..     
-00043bc0: 2020 2020 2020 2073 656c 662e 5f65 6467         self._edg
-00043bd0: 6563 6f6c 6f72 7320 3d20 636f 6c6f 7273  ecolors = colors
-00043be0: 0d0a 2020 2020 2020 2020 656c 7365 203a  ..        else :
-00043bf0: 0d0a 2020 2020 2020 2020 2020 2020 6c65  ..            le
-00043c00: 6e43 6f6c 203d 206c 656e 2873 656c 662e  nCol = len(self.
-00043c10: 5f65 6467 6563 6f6c 6f72 7329 0d0a 2020  _edgecolors)..  
-00043c20: 2020 2020 2020 2020 2020 6c65 6e53 6567            lenSeg
-00043c30: 203d 206c 656e 2873 6567 6d65 6e74 7329   = len(segments)
-00043c40: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-00043c50: 206c 656e 436f 6c20 213d 206c 656e 5365   lenCol != lenSe
-00043c60: 6720 3a20 636f 6c6f 7273 203d 2073 656c  g : colors = sel
-00043c70: 662e 5f73 6872 6564 5f63 6f6c 6f72 2829  f._shred_color()
-00043c80: 0d0a 2020 2020 2020 2020 2320 2d2d 2d2d  ..        # ----
-00043c90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00043ca0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00043cb0: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2073  -----..        s
-00043cc0: 6567 4365 6e74 6572 7320 3d20 7365 6c66  egCenters = self
-00043cd0: 2e5f 6765 745f 7365 676d 656e 745f 6365  ._get_segment_ce
-00043ce0: 6e74 6572 7328 7365 676d 656e 7473 290d  nters(segments).
-00043cf0: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
-00043d00: 7365 6743 656e 7465 7273 2920 3d3d 2031  segCenters) == 1
-00043d10: 203a 2072 6574 7572 6e20 7365 6c66 2023   : return self #
-00043d20: 2066 6164 6520 6e6f 7420 6176 6169 6c61   fade not availa
-00043d30: 626c 6520 666f 7220 7369 6e67 6c65 2073  ble for single s
-00043d40: 6567 6d65 6e74 206c 696e 6520 0d0a 2020  egment line ..  
-00043d50: 2020 2020 2020 6474 7072 6f64 203d 206e        dtprod = n
-00043d60: 702e 646f 7428 7365 6743 656e 7465 7273  p.dot(segCenters
-00043d70: 2c75 6e69 7444 6972 6563 7469 6f6e 290d  ,unitDirection).
-00043d80: 0a20 2020 2020 2020 2064 7072 616e 6765  .        dprange
-00043d90: 203d 206e 702e 616d 6178 2864 7470 726f   = np.amax(dtpro
-00043da0: 6429 2d6e 702e 616d 696e 2864 7470 726f  d)-np.amin(dtpro
-00043db0: 6429 0d0a 2020 2020 2020 2020 6e6f 726d  d)..        norm
-00043dc0: 5f64 7020 3d20 2864 7470 726f 6420 2d20  _dp = (dtprod - 
-00043dd0: 6e70 2e61 6d69 6e28 6474 7072 6f64 2929  np.amin(dtprod))
-00043de0: 2f64 7072 616e 6765 0d0a 2020 2020 2020  /dprange..      
-00043df0: 2020 6661 6465 7820 3d20 2831 2d64 6570    fadex = (1-dep
-00043e00: 7468 292a 6e6f 726d 5f64 7020 2b20 6465  th)*norm_dp + de
-00043e10: 7074 680d 0a0d 0a20 2020 2020 2020 206f  pth....        o
-00043e20: 7269 675f 636f 6c6f 7273 203d 2063 6f6c  rig_colors = col
-00043e30: 6f72 730d 0a20 2020 2020 2020 2066 635f  ors..        fc_
-00043e40: 6c65 7373 5f61 6c70 6861 203d 206f 7269  less_alpha = ori
-00043e50: 675f 636f 6c6f 7273 5b3a 2c3a 335d 0d0a  g_colors[:,:3]..
-00043e60: 0d0a 2020 2020 2020 2020 6661 6465 645f  ..        faded_
-00043e70: 636f 6c6f 7273 203d 206e 702e 636f 6e63  colors = np.conc
-00043e80: 6174 656e 6174 6528 2866 635f 6c65 7373  atenate((fc_less
-00043e90: 5f61 6c70 6861 2c20 6661 6465 785b 3a2c  _alpha, fadex[:,
-00043ea0: 6e70 2e6e 6577 6178 6973 5d20 292c 2061  np.newaxis] ), a
-00043eb0: 7869 733d 3129 0d0a 2020 2020 2020 2020  xis=1)..        
-00043ec0: 7365 6c66 2e5f 6564 6765 636f 6c6f 7273  self._edgecolors
-00043ed0: 203d 2066 6164 6564 5f63 6f6c 6f72 7320   = faded_colors 
-00043ee0: 2020 0d0a 2020 2020 2020 2020 7265 7475    ..        retu
-00043ef0: 726e 2073 656c 660d 0a0d 0a20 2020 2064  rn self....    d
-00043f00: 6566 2074 7261 6e73 666f 726d 2873 656c  ef transform(sel
-00043f10: 662c 2072 6f74 6174 653d 4e6f 6e65 2c20  f, rotate=None, 
-00043f20: 7363 616c 653d 312e 302c 2074 7261 6e73  scale=1.0, trans
-00043f30: 6c61 7465 3d5b 302c 302c 305d 2029 2020  late=[0,0,0] )  
-00043f40: 3a0d 0a20 2020 2020 2020 2022 2222 0d0a  :..        """..
-00043f50: 2020 2020 2020 2020 4c69 6e65 6172 2074          Linear t
-00043f60: 7261 6e73 666f 726d 6174 696f 6e20 6f66  ransformation of
-00043f70: 2074 6865 206c 696e 6520 6f62 6a65 6374   the line object
-00043f80: 2e0d 0a0d 0a20 2020 2020 2020 2050 6172  .....        Par
-00043f90: 616d 6574 6572 730d 0a20 2020 2020 2020  ameters..       
-00043fa0: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
-00043fb0: 2020 2020 2072 6f74 6174 6520 3a20 2061       rotate :  a
-00043fc0: 7272 6179 2d6c 696b 652c 206f 7074 696f  rray-like, optio
-00043fd0: 6e61 6c2c 2064 6566 6175 6c74 3a20 4e6f  nal, default: No
-00043fe0: 6e65 0d0a 2020 2020 2020 2020 2020 2020  ne..            
-00043ff0: 4120 3320 6279 2033 2072 6f74 6174 696f  A 3 by 3 rotatio
-00044000: 6e20 6d61 7472 6978 2e0d 0a0d 0a20 2020  n matrix.....   
-00044010: 2020 2020 2073 6361 6c65 203a 2033 4420       scale : 3D 
-00044020: 6172 7261 7920 6f72 2073 6361 6c61 722c  array or scalar,
-00044030: 206f 7074 696f 6e61 6c2c 2064 6566 6175   optional, defau
-00044040: 6c74 3a20 312e 300d 0a20 2020 2020 2020  lt: 1.0..       
-00044050: 2020 2020 204d 756c 7469 706c 6965 7273       Multipliers
-00044060: 206f 6620 7468 6520 6f62 6a65 6374 2063   of the object c
-00044070: 6f6f 7264 696e 6174 6573 2c20 696e 0d0a  oordinates, in..
-00044080: 2020 2020 2020 2020 2020 2020 7879 7a20              xyz 
-00044090: 636f 6f72 6469 6e61 7465 732e 2049 6620  coordinates. If 
-000440a0: 6120 7369 6e67 6c65 2073 6361 6c61 722c  a single scalar,
-000440b0: 2074 6872 6565 0d0a 2020 2020 2020 2020   three..        
-000440c0: 2020 2020 6d75 6c74 6970 6c69 6572 7320      multipliers 
-000440d0: 6172 6520 7468 6520 7361 6d65 2076 616c  are the same val
-000440e0: 7565 2e0d 0a20 2020 2020 2020 200d 0a20  ue...        .. 
-000440f0: 2020 2020 2020 2074 7261 6e73 6c61 7465         translate
-00044100: 203a 2061 7272 6179 2d6c 696b 652c 206f   : array-like, o
-00044110: 7074 696f 6e61 6c2c 2064 6566 6175 6c74  ptional, default
-00044120: 3a20 5b30 2c30 2c30 5d0d 0a20 2020 2020  : [0,0,0]..     
-00044130: 2020 2020 2020 2041 2078 797a 2074 7261         A xyz tra
-00044140: 6e73 6c61 7469 6f6e 2076 6563 746f 7220  nslation vector 
-00044150: 6f66 206f 626a 6563 7420 6f72 6967 696e  of object origin
-00044160: 2e20 0d0a 0d0a 2020 2020 2020 2020 5265  . ....        Re
-00044170: 7475 726e 730d 0a20 2020 2020 2020 202d  turns..        -
-00044180: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
-00044190: 7365 6c66 203a 206c 696e 6520 6f62 6a65  self : line obje
-000441a0: 6374 0d0a 0d0a 2020 2020 2020 2020 2222  ct....        ""
-000441b0: 220d 0a20 2020 2020 2020 2069 6620 726f  "..        if ro
-000441c0: 7461 7465 2069 7320 4e6f 6e65 203a 2072  tate is None : r
-000441d0: 6f74 6174 6520 3d20 6e70 2e69 6465 6e74  otate = np.ident
-000441e0: 6974 7928 3329 0d0a 2020 2020 2020 2020  ity(3)..        
-000441f0: 6966 2069 7369 6e73 7461 6e63 6528 7363  if isinstance(sc
-00044200: 616c 652c 2869 6e74 2c66 6c6f 6174 2929  ale,(int,float))
-00044210: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
-00044220: 7363 616c 6520 3d20 206e 702e 6675 6c6c  scale =  np.full
-00044230: 2833 2c73 6361 6c65 292e 6173 7479 7065  (3,scale).astype
-00044240: 2866 6c6f 6174 290d 0a20 2020 2020 2020  (float)..       
-00044250: 2023 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e   #..............
-00044260: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00044270: 2e2e 2e2e 2e2e 2e20 2020 200d 0a20 2020  .......    ..   
-00044280: 2020 2020 2064 6566 2069 734f 7274 6828       def isOrth(
-00044290: 4d29 203a 0d0a 2020 2020 2020 2020 2020  M) :..          
-000442a0: 2020 4d20 3d20 6e70 2e61 7272 6179 284d    M = np.array(M
-000442b0: 290d 0a20 2020 2020 2020 2020 2020 2074  )..            t
-000442c0: 6f6c 203d 2030 2e30 3030 3031 0d0a 2020  ol = 0.00001..  
-000442d0: 2020 2020 2020 2020 2020 7072 6f64 203d            prod =
-000442e0: 206e 702e 646f 7428 4d2c 4d2e 5429 0d0a   np.dot(M,M.T)..
-000442f0: 2020 2020 2020 2020 2020 2020 6e70 2e66              np.f
-00044300: 696c 6c5f 6469 6167 6f6e 616c 2870 726f  ill_diagonal(pro
-00044310: 642c 302e 3029 0d0a 2020 2020 2020 2020  d,0.0)..        
-00044320: 2020 2020 7265 7475 726e 206e 6f74 2028      return not (
-00044330: 6e70 2e61 6273 2870 726f 6429 3e74 6f6c  np.abs(prod)>tol
-00044340: 292e 616e 7928 290d 0a20 2020 2020 2020  ).any()..       
-00044350: 2023 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e   #..............
-00044360: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00044370: 2e2e 2e2e 2e2e 2e20 2020 200d 0a20 2020  .......    ..   
-00044380: 2020 2020 2074 7261 6e73 203d 206c 616d       trans = lam
-00044390: 6264 6120 562c 532c 5420 3a20 6e70 2e61  bda V,S,T : np.a
-000443a0: 6464 2820 206e 702e 646f 7428 206e 702e  dd(  np.dot( np.
-000443b0: 6d75 6c74 6970 6c79 2856 2c53 292c 726f  multiply(V,S),ro
-000443c0: 7461 7465 2920 2c54 290d 0a20 2020 2020  tate) ,T)..     
-000443d0: 2020 2023 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e     #............
-000443e0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-000443f0: 2e2e 2e2e 2e2e 2e2e 2e20 2020 200d 0a20  .........    .. 
-00044400: 2020 2020 2020 2069 6620 6e6f 7420 6973         if not is
-00044410: 4f72 7468 2872 6f74 6174 6529 203a 0d0a  Orth(rotate) :..
-00044420: 2020 2020 2020 2020 2020 2020 7761 726e              warn
-00044430: 696e 6773 2e77 6172 6e28 2754 7261 6e73  ings.warn('Trans
-00044440: 666f 726d 2072 6f74 6174 6520 6d61 7472  form rotate matr
-00044450: 6978 2069 7320 4e4f 5420 4f72 7468 6f67  ix is NOT Orthog
-00044460: 696e 616c 2e27 290d 0a20 2020 2020 2020  inal.')..       
-00044470: 200d 0a20 2020 2020 2020 2076 203d 2074   ..        v = t
-00044480: 7261 6e73 2820 7365 6c66 2e76 6572 7465  rans( self.verte
-00044490: 7843 6f6f 722c 2073 6361 6c65 2c20 7472  xCoor, scale, tr
-000444a0: 616e 736c 6174 6520 2029 0d0a 2020 2020  anslate  )..    
-000444b0: 2020 2020 7365 6773 203d 2073 656c 662e      segs = self.
-000444c0: 5f67 6574 5f73 6567 6d65 6e74 7328 2076  _get_segments( v
-000444d0: 2c20 7365 6c66 2e73 6567 6d49 6e64 6963  , self.segmIndic
-000444e0: 6573 290d 0a0d 0a20 2020 2020 2020 2073  es)....        s
-000444f0: 656c 662e 7665 7274 6578 436f 6f72 203d  elf.vertexCoor =
-00044500: 2076 0d0a 2020 2020 2020 2020 7365 6c66   v..        self
-00044510: 2e73 6574 5f73 6567 6d65 6e74 7328 7365  .set_segments(se
-00044520: 6773 290d 0a20 2020 2020 2020 2073 656c  gs)..        sel
-00044530: 662e 7363 616c 6520 3d20 7363 616c 650d  f.scale = scale.
-00044540: 0a20 2020 2020 2020 2073 656c 662e 7472  .        self.tr
-00044550: 616e 736c 6174 696f 6e20 3d20 7472 616e  anslation = tran
-00044560: 736c 6174 650d 0a20 2020 2020 2020 2073  slate..        s
-00044570: 656c 662e 726f 7461 7469 6f6e 203d 2072  elf.rotation = r
-00044580: 6f74 6174 650d 0a0d 0a20 2020 2020 2020  otate....       
-00044590: 205f 7365 745f 6765 6f6d 426f 756e 6473   _set_geomBounds
-000445a0: 2873 656c 662e 7665 7274 6578 436f 6f72  (self.vertexCoor
-000445b0: 2c73 656c 662e 5f62 6f75 6e64 7329 0d0a  ,self._bounds)..
-000445c0: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-000445d0: 2073 656c 660d 0a0d 0a20 2020 2064 6566   self....    def
-000445e0: 2067 6574 5f74 7261 6e73 666f 726d 4178   get_transformAx
-000445f0: 6973 2873 656c 662c 202a 2a6b 6172 6773  is(self, **kargs
-00044600: 2920 3a0d 0a20 2020 2020 2020 2022 2222  ) :..        """
-00044610: 0d0a 2020 2020 2020 2020 4c69 6e65 3344  ..        Line3D
-00044620: 436f 6c6c 6563 7469 6f6e 206f 6620 7468  Collection of th
-00044630: 6520 276c 6173 7427 2074 7261 6e73 666f  e 'last' transfo
-00044640: 726d 6564 206c 696e 6520 636f 6f72 6469  rmed line coordi
-00044650: 6e61 7465 2061 7869 732e 0d0a 2020 2020  nate axis...    
-00044660: 2020 2020 0d0a 2020 2020 2020 2020 5061      ..        Pa
-00044670: 7261 6d65 7465 7273 0d0a 2020 2020 2020  rameters..      
-00044680: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
-00044690: 2020 2020 2020 6c65 6e6d 756c 7420 3a20        lenmult : 
-000446a0: 7363 616c 6172 206f 7220 3344 2061 7272  scalar or 3D arr
-000446b0: 6179 2c20 6f70 7469 6f6e 616c 2c20 6465  ay, optional, de
-000446c0: 6661 756c 743a 2031 0d0a 2020 2020 2020  fault: 1..      
-000446d0: 2020 2020 2020 5363 616c 6172 206d 756c        Scalar mul
-000446e0: 7469 706c 6965 7220 6f66 2074 6865 2074  tiplier of the t
-000446f0: 6872 6565 2063 6f6f 7264 696e 6174 6520  hree coordinate 
-00044700: 6178 6973 2e0d 0a0d 0a20 2020 2020 2020  axis.....       
-00044710: 2077 6964 7468 203a 2073 6361 6c61 722c   width : scalar,
-00044720: 206f 7074 696f 6e61 6c2c 2064 6566 6175   optional, defau
-00044730: 6c74 3a20 312e 350d 0a20 2020 2020 2020  lt: 1.5..       
-00044740: 2020 2020 204c 696e 6520 7769 6474 6820       Line width 
-00044750: 6f66 2074 6865 2063 6f6f 7264 696e 6174  of the coordinat
-00044760: 6520 6178 6973 2e20 2020 0d0a 0d0a 2020  e axis.   ....  
-00044770: 2020 2020 2020 636f 6c6f 7220 3a20 6120        color : a 
-00044780: 436f 6c6f 7220 6f72 2033 4420 6172 7261  Color or 3D arra
-00044790: 7920 6f66 2043 6f6c 6f72 732c 206f 7074  y of Colors, opt
-000447a0: 696f 6e61 6c2c 2064 6566 6175 6c74 3a20  ional, default: 
-000447b0: 5b27 7227 2c27 6727 2c27 6227 5d0d 0a0d  ['r','g','b']...
-000447c0: 0a20 2020 2020 2020 206e 6567 6178 6973  .        negaxis
-000447d0: 203a 2062 6f6f 6c65 616e 2c20 6f70 7469   : boolean, opti
-000447e0: 6f6e 616c 2c20 6465 6661 756c 743a 2046  onal, default: F
-000447f0: 616c 7365 0d0a 2020 2020 2020 2020 2020  alse..          
-00044800: 2020 4966 2054 7275 652c 2069 6e63 6c75    If True, inclu
-00044810: 6465 2074 6865 206e 6567 6174 6976 6520  de the negative 
-00044820: 6178 6973 2c20 6f74 6865 7277 6973 6520  axis, otherwise 
-00044830: 6178 6573 2073 7461 7274 2061 7420 6f72  axes start at or
-00044840: 6967 696e 2e0d 0a0d 0a20 2020 2020 2020  igin.....       
-00044850: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
-00044860: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
-00044870: 2020 204c 696e 6533 4443 6f6c 6c65 6374     Line3DCollect
-00044880: 696f 6e20 6f62 6a65 6374 0d0a 0d0a 2020  ion object....  
-00044890: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
-000448a0: 2020 206b 6172 6744 6674 203d 207b 2027     kargDft = { '
-000448b0: 6c65 6e6d 756c 7427 3a31 2e30 2c20 2777  lenmult':1.0, 'w
-000448c0: 6964 7468 273a 312e 352c 2027 636f 6c6f  idth':1.5, 'colo
-000448d0: 7227 3a5b 2772 272c 2767 272c 2762 275d  r':['r','g','b']
-000448e0: 2c20 276e 6567 6178 6973 273a 4661 6c73  , 'negaxis':Fals
-000448f0: 6520 7d0d 0a20 2020 2020 2020 204b 5720  e }..        KW 
-00044900: 3d20 4b57 7072 6f63 6573 736f 7228 6b61  = KWprocessor(ka
-00044910: 7267 4466 742c 2767 6574 5f74 7261 6e73  rgDft,'get_trans
-00044920: 666f 726d 4178 6973 272c 2a2a 6b61 7267  formAxis',**karg
-00044930: 7329 0d0a 2020 2020 2020 2020 6c65 6e6d  s)..        lenm
-00044940: 756c 7420 3d20 4b57 2e67 6574 5661 6c28  ult = KW.getVal(
-00044950: 276c 656e 6d75 6c74 2729 0d0a 2020 2020  'lenmult')..    
-00044960: 2020 2020 7769 6474 6820 3d20 4b57 2e67      width = KW.g
-00044970: 6574 5661 6c28 2777 6964 7468 2729 0d0a  etVal('width')..
-00044980: 2020 2020 2020 2020 636f 6c6f 7220 3d20          color = 
-00044990: 4b57 2e67 6574 5661 6c28 2763 6f6c 6f72  KW.getVal('color
-000449a0: 2729 0d0a 2020 2020 2020 2020 6e65 6761  ')..        nega
-000449b0: 7869 7320 3d20 4b57 2e67 6574 5661 6c28  xis = KW.getVal(
-000449c0: 276e 6567 6178 6973 2729 0d0a 0d0a 2020  'negaxis')....  
-000449d0: 2020 2020 2020 7365 6c66 5072 6f70 203d        selfProp =
-000449e0: 207b 0d0a 2020 2020 2020 2020 2020 2020   {..            
-000449f0: 2773 6361 6c65 2720 3a20 7365 6c66 2e73  'scale' : self.s
-00044a00: 6361 6c65 2c0d 0a20 2020 2020 2020 2020  cale,..         
-00044a10: 2020 2027 726f 7461 7469 6f6e 2720 3a20     'rotation' : 
-00044a20: 7365 6c66 2e72 6f74 6174 696f 6e2c 0d0a  self.rotation,..
-00044a30: 2020 2020 2020 2020 2020 2020 2774 7261              'tra
-00044a40: 6e73 6c61 7469 6f6e 2720 3a20 7365 6c66  nslation' : self
-00044a50: 2e74 7261 6e73 6c61 7469 6f6e 0d0a 2020  .translation..  
-00044a60: 2020 2020 2020 7d0d 0a20 2020 2020 2020        }..       
-00044a70: 2072 6574 7572 6e20 5f74 7261 6e73 666f   return _transfo
-00044a80: 726d 4178 6973 2873 656c 6650 726f 702c  rmAxis(selfProp,
-00044a90: 6c65 6e6d 756c 742c 2077 6964 7468 2c20  lenmult, width, 
-00044aa0: 636f 6c6f 722c 206e 6567 6178 6973 290d  color, negaxis).
-00044ab0: 0a0d 0a20 2020 2064 6566 205f 7265 6374  ...    def _rect
-00044ac0: 616e 6775 6c61 7465 4669 6c6c 6564 5375  angulateFilledSu
-00044ad0: 7246 6163 6528 7365 6c66 2c72 657a 2c62  rFace(self,rez,b
-00044ae0: 6173 6556 636f 6f72 2c62 6173 6546 6163  aseVcoor,baseFac
-00044af0: 6556 6572 7465 7849 6e64 6963 6573 2c20  eVertexIndices, 
-00044b00: 6d69 6456 6563 7446 756e 6329 203a 0d0a  midVectFunc) :..
-00044b10: 2020 2020 2020 2020 7643 6f6f 7220 3d20          vCoor = 
-00044b20: 6261 7365 5663 6f6f 722e 636f 7079 2829  baseVcoor.copy()
-00044b30: 0d0a 2020 2020 2020 2020 6676 496e 6469  ..        fvIndi
-00044b40: 6365 7320 3d20 5b5d 0d0a 2020 2020 2020  ces = []..      
-00044b50: 2020 6576 496e 6469 6365 7320 3d20 5b5d    evIndices = []
-00044b60: 0d0a 2020 2020 2020 2020 232e 2e2e 2e2e  ..        #.....
-00044b70: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00044b80: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00044b90: 2020 2020 0d0a 2020 2020 2020 2020 6465      ..        de
-00044ba0: 6620 6765 7456 6572 7469 6365 734c 696e  f getVerticesLin
-00044bb0: 6528 6465 6772 6565 2c20 6c65 6674 496e  e(degree, leftIn
-00044bc0: 6465 782c 2072 6967 6874 496e 6465 7829  dex, rightIndex)
-00044bd0: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
-00044be0: 6465 6620 7265 6375 7273 5f65 6467 6543  def recurs_edgeC
-00044bf0: 6f6f 7228 6465 6772 6565 2c20 696e 6465  oor(degree, inde
-00044c00: 784f 7269 6769 6e2c 2069 7352 6967 6874  xOrigin, isRight
-00044c10: 2c20 6c65 6674 496e 6465 782c 2072 6967  , leftIndex, rig
-00044c20: 6874 496e 6465 782c 2045 696e 6465 7829  htIndex, Eindex)
-00044c30: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
-00044c40: 2020 2020 6d20 3d20 6465 6772 6565 202d      m = degree -
-00044c50: 2031 0d0a 2020 2020 2020 2020 2020 2020   1..            
-00044c60: 2020 2020 6465 6c74 6120 3d20 696e 7428      delta = int(
-00044c70: 6e70 2e70 6f77 6572 2832 2c6d 2929 0d0a  np.power(2,m))..
-00044c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044c90: 6966 2069 7352 6967 6874 203a 2064 656c  if isRight : del
-00044ca0: 7461 203d 202d 6465 6c74 610d 0a20 2020  ta = -delta..   
-00044cb0: 2020 2020 2020 2020 2020 2020 2069 203d               i =
-00044cc0: 2069 6e64 6578 4f72 6967 696e 202d 2064   indexOrigin - d
-00044cd0: 656c 7461 0d0a 2020 2020 2020 2020 2020  elta..          
-00044ce0: 2020 2020 2020 6d69 645f 636f 6f72 203d        mid_coor =
-00044cf0: 206d 6964 5665 6374 4675 6e63 2820 7643   midVectFunc( vC
-00044d00: 6f6f 725b 6c65 6674 496e 6465 785d 2c20  oor[leftIndex], 
-00044d10: 7643 6f6f 725b 7269 6768 7449 6e64 6578  vCoor[rightIndex
-00044d20: 5d20 290d 0a20 2020 2020 2020 2020 2020  ] )..           
-00044d30: 2020 2020 2063 7572 7265 6e74 436f 6f72       currentCoor
-00044d40: 496e 6465 7820 3d20 6c65 6e28 7643 6f6f  Index = len(vCoo
-00044d50: 7229 0d0a 2020 2020 2020 2020 2020 2020  r)..            
-00044d60: 2020 2020 7643 6f6f 722e 6170 7065 6e64      vCoor.append
-00044d70: 286d 6964 5f63 6f6f 7229 0d0a 2020 2020  (mid_coor)..    
-00044d80: 2020 2020 2020 2020 2020 2020 4569 6e64              Eind
-00044d90: 6578 5b69 5d20 3d20 6375 7272 656e 7443  ex[i] = currentC
-00044da0: 6f6f 7249 6e64 6578 0d0a 2020 2020 2020  oorIndex..      
-00044db0: 2020 2020 2020 2020 2020 6966 206d 203c            if m <
-00044dc0: 3d20 3020 3a0d 0a20 2020 2020 2020 2020  = 0 :..         
-00044dd0: 2020 2020 2020 2020 2020 2065 7649 6e64             evInd
-00044de0: 6963 6573 2e61 7070 656e 6428 205b 6c65  ices.append( [le
-00044df0: 6674 496e 6465 782c 2063 7572 7265 6e74  ftIndex, current
-00044e00: 436f 6f72 496e 6465 785d 2029 2020 2020  CoorIndex] )    
-00044e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044e20: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00044e30: 2020 2020 2020 6576 496e 6469 6365 732e        evIndices.
-00044e40: 6170 7065 6e64 2820 5b63 7572 7265 6e74  append( [current
-00044e50: 436f 6f72 496e 6465 782c 2072 6967 6874  CoorIndex, right
-00044e60: 496e 6465 785d 2029 2020 2020 2020 2020  Index] )        
-00044e70: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
-00044e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044e90: 2020 7265 7475 726e 0d0a 2020 2020 2020    return..      
-00044ea0: 2020 2020 2020 2020 2020 7265 6375 7273            recurs
-00044eb0: 5f65 6467 6543 6f6f 7228 6d2c 692c 4661  _edgeCoor(m,i,Fa
-00044ec0: 6c73 652c 6c65 6674 496e 6465 782c 6375  lse,leftIndex,cu
-00044ed0: 7272 656e 7443 6f6f 7249 6e64 6578 2c20  rrentCoorIndex, 
-00044ee0: 4569 6e64 6578 290d 0a20 2020 2020 2020  Eindex)..       
-00044ef0: 2020 2020 2020 2020 2072 6563 7572 735f           recurs_
-00044f00: 6564 6765 436f 6f72 286d 2c69 2c54 7275  edgeCoor(m,i,Tru
-00044f10: 652c 6375 7272 656e 7443 6f6f 7249 6e64  e,currentCoorInd
-00044f20: 6578 2c72 6967 6874 496e 6465 782c 2045  ex,rightIndex, E
-00044f30: 696e 6465 7829 0d0a 2020 2020 2020 2020  index)..        
-00044f40: 2020 2020 2020 2020 7265 7475 726e 0d0a          return..
-00044f50: 2020 2020 2020 2020 2020 2020 232e 2e2e              #...
-00044f60: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00044f70: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00044f80: 2e2e 2020 2020 0d0a 2020 2020 2020 2020  ..    ..        
-00044f90: 2020 2020 694f 7269 6769 6e20 3d20 696e      iOrigin = in
-00044fa0: 7428 6e70 2e70 6f77 6572 2832 2c64 6567  t(np.power(2,deg
-00044fb0: 7265 6529 290d 0a20 2020 2020 2020 2020  ree))..         
-00044fc0: 2020 2045 696e 6465 7820 3d20 5b4e 6f6e     Eindex = [Non
-00044fd0: 655d 2a28 694f 7269 6769 6e2b 3129 0d0a  e]*(iOrigin+1)..
-00044fe0: 2020 2020 2020 2020 2020 2020 4569 6e64              Eind
-00044ff0: 6578 5b30 5d20 3d20 6c65 6674 496e 6465  ex[0] = leftInde
-00045000: 780d 0a20 2020 2020 2020 2020 2020 2045  x..            E
-00045010: 696e 6465 785b 694f 7269 6769 6e5d 203d  index[iOrigin] =
-00045020: 2072 6967 6874 496e 6465 780d 0a20 2020   rightIndex..   
-00045030: 2020 2020 2020 2020 2069 6620 6465 6772           if degr
-00045040: 6565 3d3d 3020 3a0d 0a20 2020 2020 2020  ee==0 :..       
-00045050: 2020 2020 2020 2020 2065 7649 6e64 6963           evIndic
-00045060: 6573 2e61 7070 656e 6428 205b 6c65 6674  es.append( [left
-00045070: 496e 6465 782c 2072 6967 6874 496e 6465  Index, rightInde
-00045080: 785d 2029 0d0a 2020 2020 2020 2020 2020  x] )..          
-00045090: 2020 2020 2020 7265 7475 726e 2045 696e        return Ein
-000450a0: 6465 780d 0a20 2020 2020 2020 2020 2020  dex..           
-000450b0: 2072 6563 7572 735f 6564 6765 436f 6f72   recurs_edgeCoor
-000450c0: 2864 6567 7265 652c 2069 4f72 6967 696e  (degree, iOrigin
-000450d0: 2c20 4661 6c73 652c 206c 6566 7449 6e64  , False, leftInd
-000450e0: 6578 2c20 7269 6768 7449 6e64 6578 2c20  ex, rightIndex, 
-000450f0: 4569 6e64 6578 290d 0a20 2020 2020 2020  Eindex)..       
-00045100: 2020 2020 2072 6574 7572 6e20 4569 6e64       return Eind
-00045110: 6578 0d0a 2020 2020 2020 2020 232e 2e2e  ex..        #...
-00045120: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00045130: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00045140: 2e2e 2020 2020 0d0a 2020 2020 2020 2020  ..    ..        
-00045150: 6465 6620 7265 6375 7273 5f66 6163 6549  def recurs_faceI
-00045160: 6e64 6963 6573 2841 2c43 2c72 657a 293a  ndices(A,C,rez):
-00045170: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-00045180: 7369 6d69 6c61 7220 746f 2069 6e6e 6572  similar to inner
-00045190: 2066 756e 6374 696f 6e20 6f66 2074 7269   function of tri
-000451a0: 616e 6775 6c61 7465 4261 7365 0d0a 2020  angulateBase..  
-000451b0: 2020 2020 2020 2020 2020 6966 2072 657a            if rez
-000451c0: 3d3d 3020 3a0d 0a20 2020 2020 2020 2020  ==0 :..         
-000451d0: 2020 2020 2020 2061 6263 203d 205b 2041         abc = [ A
-000451e0: 5b30 5d2c 2041 5b31 5d2c 2043 5b30 5d2c  [0], A[1], C[0],
-000451f0: 2043 5b31 5d20 5d20 2020 2020 2020 2020   C[1] ]         
-00045200: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-00045210: 2020 2020 2020 2020 6676 496e 6469 6365          fvIndice
-00045220: 732e 6170 7065 6e64 2820 6162 6320 290d  s.append( abc ).
-00045230: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00045240: 2072 6574 7572 6e0d 0a20 2020 2020 2020   return..       
-00045250: 2020 2020 2023 202d 2d2d 2d2d 2d2d 2d2d       # ---------
-00045260: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00045270: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00045280: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020  ------------..  
-00045290: 2020 2020 2020 2020 2020 4a20 3d20 696e            J = in
-000452a0: 7428 2028 6c65 6e28 4129 2d31 292f 3220  t( (len(A)-1)/2 
-000452b0: 290d 0a20 2020 2020 2020 2020 2020 204b  )..            K
-000452c0: 203d 204a 202b 2031 0d0a 2020 2020 2020   = J + 1..      
-000452d0: 2020 2020 2020 2320 7375 6469 7669 6465        # sudivide
-000452e0: 2074 6865 2074 776f 2069 6e6e 6572 2071   the two inner q
-000452f0: 7561 6472 6174 6572 616c 7320 2e2e 2e2e  uadraterals ....
-00045300: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e0d 0a20  ............... 
-00045310: 2020 2020 2020 2020 2020 2072 6563 7572             recur
-00045320: 735f 6661 6365 496e 6469 6365 7328 2041  s_faceIndices( A
-00045330: 5b3a 4b5d 2c20 2043 5b4a 3a5d 2c20 7265  [:K],  C[J:], re
-00045340: 7a2d 3129 0d0a 2020 2020 2020 2020 2020  z-1)..          
-00045350: 2020 7265 6375 7273 5f66 6163 6549 6e64    recurs_faceInd
-00045360: 6963 6573 2820 435b 3a4b 5d2c 2020 415b  ices( C[:K],  A[
-00045370: 4a3a 5d2c 2072 657a 2d31 290d 0a20 2020  J:], rez-1)..   
-00045380: 2020 2020 2020 2020 2072 6574 7572 6e0d           return.
-00045390: 0a20 2020 2020 2020 2023 2e2e 2e2e 2e2e  .        #......
-000453a0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-000453b0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e0d  ................
-000453c0: 0a20 2020 2020 2020 2069 5f70 7265 765f  .        i_prev_
-000453d0: 3220 3d20 2d31 2020 2320 6368 6563 6b20  2 = -1  # check 
-000453e0: 666f 7220 6669 7273 7420 6661 6365 206f  for first face o
-000453f0: 6e6c 792e 0d0a 2020 2020 2020 2020 666f  nly...        fo
-00045400: 7220 6661 6365 2069 6e20 6261 7365 4661  r face in baseFa
-00045410: 6365 5665 7274 6578 496e 6469 6365 7320  ceVertexIndices 
-00045420: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
-00045430: 6620 695f 7072 6576 5f32 203d 3d20 6661  f i_prev_2 == fa
-00045440: 6365 5b33 5d20 3a0d 0a20 2020 2020 2020  ce[3] :..       
-00045450: 2020 2020 2020 2020 2042 203d 2044 5b3a           B = D[:
-00045460: 3a2d 315d 0d0a 2020 2020 2020 2020 2020  :-1]..          
-00045470: 2020 656c 7365 203a 0d0a 2020 2020 2020    else :..      
-00045480: 2020 2020 2020 2020 2020 4220 3d20 6765            B = ge
-00045490: 7456 6572 7469 6365 734c 696e 6528 7265  tVerticesLine(re
-000454a0: 7a2c 2066 6163 655b 335d 2c66 6163 655b  z, face[3],face[
-000454b0: 305d 2029 0d0a 2020 2020 2020 2020 2020  0] )..          
-000454c0: 2020 695f 7072 6576 5f32 203d 2020 6661    i_prev_2 =  fa
-000454d0: 6365 5b32 5d0d 0a20 2020 2020 2020 2020  ce[2]..         
-000454e0: 2020 2044 203d 2067 6574 5665 7274 6963     D = getVertic
-000454f0: 6573 4c69 6e65 2872 657a 2c20 6661 6365  esLine(rez, face
-00045500: 5b31 5d2c 6661 6365 5b32 5d20 290d 0a20  [1],face[2] ).. 
-00045510: 2020 2020 2020 2020 2020 2072 6563 7572             recur
-00045520: 735f 6661 6365 496e 6469 6365 7328 422c  s_faceIndices(B,
-00045530: 442c 7265 7a29 0d0a 0d0a 2020 2020 2020  D,rez)....      
-00045540: 2020 7665 7274 6578 436f 6f72 203d 206e    vertexCoor = n
-00045550: 702e 6172 7261 7928 7643 6f6f 7229 200d  p.array(vCoor) .
-00045560: 0a20 2020 2020 2020 2069 6e64 6578 4f62  .        indexOb
-00045570: 6a20 3d20 7b20 2766 6163 6527 3a20 6e70  j = { 'face': np
-00045580: 2e61 7272 6179 2866 7649 6e64 6963 6573  .array(fvIndices
-00045590: 2920 2c20 2765 6467 6527 3a20 6e70 2e61  ) , 'edge': np.a
-000455a0: 7272 6179 2865 7649 6e64 6963 6573 2920  rray(evIndices) 
-000455b0: 7d0d 0a20 2020 2020 2020 2072 6574 7572  }..        retur
-000455c0: 6e20 696e 6465 784f 626a 202c 7665 7274  n indexObj ,vert
-000455d0: 6578 436f 6f72 0d0a 0d0a 2020 2020 6465  exCoor....    de
-000455e0: 6620 5f67 6574 5f66 696c 6c65 645f 7375  f _get_filled_su
-000455f0: 7266 6163 6528 7365 6c66 2c20 6164 6465  rface(self, adde
-00045600: 6476 6572 7473 2c20 6c72 657a 3d30 2c20  dverts, lrez=0, 
-00045610: 7363 6c72 3d4e 6f6e 652c 2061 6c70 6861  sclr=None, alpha
-00045620: 3d4e 6f6e 652c 206e 616d 653d 4e6f 6e65  =None, name=None
-00045630: 2920 3a0d 0a20 2020 2020 2020 2023 2044  ) :..        # D
-00045640: 7561 6c20 7075 7270 6f73 6520 616c 676f  ual purpose algo
-00045650: 7269 7468 6d20 666f 7220 6c69 6e65 7320  rithm for lines 
-00045660: 7072 6f6a 6563 7465 6420 746f 2061 2070  projected to a p
-00045670: 6c61 6e65 2028 5472 7565 2920 6f72 0d0a  lane (True) or..
-00045680: 2020 2020 2020 2020 2320 5061 7261 6d65          # Parame
-00045690: 7472 6963 206c 696e 6573 2070 726f 6a65  tric lines proje
-000456a0: 6374 6564 2074 6f20 616e 6f74 6865 7220  cted to another 
-000456b0: 5061 7261 6d65 7472 6963 206c 696e 652e  Parametric line.
-000456c0: 0d0a 0d0a 2020 2020 2020 2020 232e 2e2e  ....        #...
-000456d0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-000456e0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-000456f0: 2e2e 0d0a 2020 2020 2020 2020 6465 6620  ....        def 
-00045700: 7072 6570 5365 6773 2829 203a 0d0a 2020  prepSegs() :..  
-00045710: 2020 2020 2020 2020 2020 2320 6465 764e            # devN
-00045720: 6f74 653a 2065 7665 6e20 6966 206c 696e  ote: even if lin
-00045730: 6573 2061 7265 206e 6f74 2073 6872 6564  es are not shred
-00045740: 6465 642c 2065 6163 680d 0a20 2020 2020  ded, each..     
-00045750: 2020 2020 2020 2023 206c 696e 6520 636f         # line co
-00045760: 756c 6420 706f 7373 6962 6c79 2068 6176  uld possibly hav
-00045770: 6520 6469 6666 6572 656e 7420 636f 6c6f  e different colo
-00045780: 7273 2e0d 0a20 2020 2020 2020 2020 2020  rs...           
-00045790: 2023 2048 656e 6365 2c20 6d75 7374 2063   # Hence, must c
-000457a0: 6f6e 7374 7275 6374 2073 7572 6661 6365  onstruct surface
-000457b0: 7320 6672 6f6d 2027 7368 7265 6464 6564  s from 'shredded
-000457c0: 270d 0a20 2020 2020 2020 2020 2020 2023  '..            #
-000457d0: 206c 696e 6573 2077 6974 686f 7574 2061   lines without a
-000457e0: 6374 7561 6c6c 7920 7368 7265 6464 696e  ctually shreddin
-000457f0: 6720 7468 6520 6c69 6e65 2e0d 0a20 2020  g the line...   
-00045800: 2020 2020 2020 2020 2023 2054 6865 2063           # The c
-00045810: 6f6c 6f72 2061 7272 6179 2069 7320 7468  olor array is th
-00045820: 656e 2066 6f72 2065 6163 6820 706f 6c79  en for each poly
-00045830: 676f 6e2e 0d0a 2020 2020 2020 2020 2020  gon...          
-00045840: 2020 2320 5468 6520 666f 6c6c 6f77 696e    # The followin
-00045850: 6720 6973 2061 6374 7561 6c6c 7920 736f  g is actually so
-00045860: 6d65 7768 6174 2061 2064 7570 6c69 6361  mewhat a duplica
-00045870: 7469 6f6e 0d0a 2020 2020 2020 2020 2020  tion..          
-00045880: 2020 2320 6f66 2074 6865 205f 7368 7265    # of the _shre
-00045890: 642e 0d0a 2020 2020 2020 2020 2020 2020  d...            
-000458a0: 6966 206e 6f74 2073 656c 662e 6973 5368  if not self.isSh
-000458b0: 7265 6464 6564 203a 0d0a 2020 2020 2020  redded :..      
-000458c0: 2020 2020 2020 2020 2020 636f 6c6f 7220            color 
-000458d0: 3d20 7365 6c66 2e5f 7368 7265 645f 636f  = self._shred_co
-000458e0: 6c6f 7228 290d 0a20 2020 2020 2020 2020  lor()..         
-000458f0: 2020 2020 2020 206c 696e 6573 6567 7320         linesegs 
-00045900: 3d20 7365 6c66 2e6c 696e 6549 6e64 6963  = self.lineIndic
-00045910: 6573 0d0a 2020 2020 2020 2020 2020 2020  es..            
-00045920: 2020 2020 696e 6469 6365 7320 3d20 5b5d      indices = []
-00045930: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00045940: 2020 666f 7220 6c69 6e65 2069 6e20 6c69    for line in li
-00045950: 6e65 7365 6773 203a 0d0a 2020 2020 2020  nesegs :..      
-00045960: 2020 2020 2020 2020 2020 2020 2020 6e75                nu
-00045970: 6d53 6567 7320 3d20 6c65 6e28 6c69 6e65  mSegs = len(line
-00045980: 2920 2d20 310d 0a20 2020 2020 2020 2020  ) - 1..         
-00045990: 2020 2020 2020 2020 2020 2066 6f72 2073             for s
-000459a0: 6567 2069 6e20 7261 6e67 6520 286e 756d  eg in range (num
-000459b0: 5365 6773 2920 3a0d 0a20 2020 2020 2020  Segs) :..       
-000459c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000459d0: 2074 203d 205b 206c 696e 655b 7365 675d   t = [ line[seg]
-000459e0: 2c6c 696e 655b 7365 672b 315d 205d 0d0a  ,line[seg+1] ]..
-000459f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045a00: 2020 2020 2020 2020 696e 6469 6365 732e          indices.
-00045a10: 6170 7065 6e64 2874 290d 0a20 2020 2020  append(t)..     
-00045a20: 2020 2020 2020 2020 2020 2076 6572 7449             vertI
-00045a30: 7820 3d20 6e70 2e61 7272 6179 2869 6e64  x = np.array(ind
-00045a40: 6963 6573 290d 0a20 2020 2020 2020 2020  ices)..         
-00045a50: 2020 2065 6c73 6520 3a0d 0a20 2020 2020     else :..     
-00045a60: 2020 2020 2020 2020 2020 2063 6f6c 6f72             color
-00045a70: 203d 2073 656c 662e 5f65 6467 6563 6f6c   = self._edgecol
-00045a80: 6f72 730d 0a20 2020 2020 2020 2020 2020  ors..           
-00045a90: 2020 2020 2076 6572 7449 783d 206e 702e       vertIx= np.
-00045aa0: 6172 7261 7928 7365 6c66 2e73 6567 6d49  array(self.segmI
-00045ab0: 6e64 6963 6573 290d 0a20 2020 2020 2020  ndices)..       
-00045ac0: 2020 2020 2072 6574 7572 6e20 7665 7274       return vert
-00045ad0: 4978 2c20 636f 6c6f 720d 0a20 2020 2020  Ix, color..     
-00045ae0: 2020 2023 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e     #............
-00045af0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00045b00: 2e2e 2e2e 2e2e 2e2e 2e0d 0a20 2020 2020  ...........     
-00045b10: 2020 200d 0a20 2020 2020 2020 2074 6f70     ..        top
-00045b20: 5365 6749 6e78 2c63 6f6c 6f72 203d 2070  SegInx,color = p
-00045b30: 7265 7053 6567 7328 290d 0a0d 0a20 2020  repSegs()....   
-00045b40: 2020 2020 2073 7449 6e78 203d 206c 656e       stInx = len
-00045b50: 2873 656c 662e 7665 7274 6578 436f 6f72  (self.vertexCoor
-00045b60: 290d 0a20 2020 2020 2020 2062 6f74 5365  )..        botSe
-00045b70: 6749 6e78 203d 2074 6f70 5365 6749 6e78  gInx = topSegInx
-00045b80: 202b 2073 7449 6e78 0d0a 2020 2020 2020   + stInx..      
-00045b90: 2020 746f 7053 6567 496e 7820 3d20 6e70    topSegInx = np
-00045ba0: 2e66 6c69 7028 746f 7053 6567 496e 782c  .flip(topSegInx,
-00045bb0: 6178 6973 3d31 290d 0a20 2020 2020 2020  axis=1)..       
-00045bc0: 2066 6349 6e64 7820 3d20 6e70 2e63 6f6e   fcIndx = np.con
-00045bd0: 6361 7465 6e61 7465 2820 2862 6f74 5365  catenate( (botSe
-00045be0: 6749 6e78 2c74 6f70 5365 6749 6e78 292c  gInx,topSegInx),
-00045bf0: 2061 7869 733d 3129 0d0a 2020 2020 2020   axis=1)..      
-00045c00: 2020 2020 200d 0a20 2020 2020 2020 2073       ..        s
-00045c10: 7665 7274 7320 3d20 6e70 2e63 6f6e 6361  verts = np.conca
-00045c20: 7465 6e61 7465 2828 7365 6c66 2e76 6572  tenate((self.ver
-00045c30: 7465 7843 6f6f 722c 6164 6465 6476 6572  texCoor,addedver
-00045c40: 7473 292c 6178 6973 3d30 290d 0a20 2020  ts),axis=0)..   
-00045c50: 2020 2020 2073 636f 6c6f 7220 3d20 6e70       scolor = np
-00045c60: 2e61 7272 6179 2863 6f6c 6f72 290d 0a0d  .array(color)...
-00045c70: 0a20 2020 2020 2020 2069 6620 6c72 657a  .        if lrez
-00045c80: 203e 2030 203a 0d0a 2020 2020 2020 2020   > 0 :..        
-00045c90: 2020 2020 7376 6572 7473 203d 206c 6973      sverts = lis
-00045ca0: 7428 7376 6572 7473 290d 0a20 2020 2020  t(sverts)..     
-00045cb0: 2020 2020 2020 2069 6e64 6578 4f62 6a20         indexObj 
-00045cc0: 2c76 6572 7465 7843 6f6f 7220 3d20 7365  ,vertexCoor = se
-00045cd0: 6c66 2e5f 7265 6374 616e 6775 6c61 7465  lf._rectangulate
-00045ce0: 4669 6c6c 6564 5375 7246 6163 6528 6c72  FilledSurFace(lr
-00045cf0: 657a 2c73 7665 7274 732c 6663 496e 6478  ez,sverts,fcIndx
-00045d00: 2c20 7365 6c66 2e5f 6d69 6456 6563 746f  , self._midVecto
-00045d10: 7246 756e 290d 0a20 2020 2020 2020 2020  rFun)..         
-00045d20: 2020 2073 7665 7274 7320 3d20 7665 7274     sverts = vert
-00045d30: 6578 436f 6f72 0d0a 2020 2020 2020 2020  exCoor..        
-00045d40: 2020 2020 6663 496e 6478 203d 2069 6e64      fcIndx = ind
-00045d50: 6578 4f62 6a5b 2766 6163 6527 5d0d 0a20  exObj['face'].. 
-00045d60: 2020 2020 2020 2020 2020 2073 636f 6c6f             scolo
-00045d70: 7220 3d20 6e70 2e72 6570 6561 7428 7363  r = np.repeat(sc
-00045d80: 6f6c 6f72 2c32 2a2a 6c72 657a 2c61 7869  olor,2**lrez,axi
-00045d90: 733d 3029 0d0a 0d0a 2020 2020 2020 2020  s=0)....        
-00045da0: 6966 2073 636c 7220 6973 206e 6f74 204e  if sclr is not N
-00045db0: 6f6e 6520 3a20 7363 6f6c 6f72 203d 2073  one : scolor = s
-00045dc0: 636c 720d 0a0d 0a20 2020 2020 2020 2069  clr....        i
-00045dd0: 6620 616c 7068 6120 6973 206e 6f74 204e  f alpha is not N
-00045de0: 6f6e 653a 0d0a 2020 2020 2020 2020 2020  one:..          
-00045df0: 2020 7375 7266 6163 6520 3d20 5375 7266    surface = Surf
-00045e00: 6163 6533 4443 6f6c 6c65 6374 696f 6e28  ace3DCollection(
-00045e10: 7376 6572 7473 2c20 6663 496e 6478 2c20  sverts, fcIndx, 
-00045e20: 6e61 6d65 3d6e 616d 652c 2063 6f6c 6f72  name=name, color
-00045e30: 3d73 636f 6c6f 722c 2061 6c70 6861 3d61  =scolor, alpha=a
-00045e40: 6c70 6861 290d 0a20 2020 2020 2020 2065  lpha)..        e
-00045e50: 6c73 6520 3a0d 0a20 2020 2020 2020 2020  lse :..         
-00045e60: 2020 2073 7572 6661 6365 203d 2053 7572     surface = Sur
-00045e70: 6661 6365 3344 436f 6c6c 6563 7469 6f6e  face3DCollection
-00045e80: 2873 7665 7274 732c 2066 6349 6e64 782c  (sverts, fcIndx,
-00045e90: 206e 616d 653d 6e61 6d65 2c63 6f6c 6f72   name=name,color
-00045ea0: 3d73 636f 6c6f 7229 0d0a 2020 2020 2020  =scolor)..      
-00045eb0: 2020 7265 7475 726e 2073 7572 6661 6365    return surface
-00045ec0: 0d0a 0d0a 2020 2020 6465 6620 6765 745f  ....    def get_
-00045ed0: 6669 6c6c 6564 5f73 7572 6661 6365 2873  filled_surface(s
-00045ee0: 656c 662c 2a2a 6b61 7267 7329 203a 0d0a  elf,**kargs) :..
-00045ef0: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
-00045f00: 2020 2020 2053 7572 6661 6365 3344 436f       Surface3DCo
-00045f10: 6c6c 6563 7469 6f6e 2066 726f 6d20 6120  llection from a 
-00045f20: 6c69 6e65 2070 726f 6a65 6374 6564 2074  line projected t
-00045f30: 6f20 6120 7375 7266 6163 652e 0d0a 0d0a  o a surface.....
-00045f40: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
-00045f50: 7273 0d0a 2020 2020 2020 2020 2d2d 2d2d  rs..        ----
-00045f60: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
-00045f70: 6469 7374 203a 206e 756d 6265 722c 206f  dist : number, o
-00045f80: 7074 696f 6e61 6c2c 2064 6566 6175 6c74  ptional, default
-00045f90: 203a 2030 2e30 200d 0a20 2020 2020 2020   : 0.0 ..       
-00045fa0: 2020 2020 2064 6973 7461 6e63 6520 6672       distance fr
-00045fb0: 6f6d 2074 6865 206f 7269 6769 6e20 746f  om the origin to
-00045fc0: 2074 6865 2070 726f 6a65 6374 6564 2073   the projected s
-00045fd0: 7572 6661 6365 2c0d 0a20 2020 2020 2020  urface,..       
-00045fe0: 2020 2020 2061 6c6f 6e67 2074 6865 2064       along the d
-00045ff0: 6972 6563 7469 6f6e 2076 6563 746f 722e  irection vector.
-00046000: 0d0a 0d0a 2020 2020 2020 2020 6469 7265  ....        dire
-00046010: 6374 696f 6e20 3a20 6172 7261 792d 6c69  ction : array-li
-00046020: 6b65 2c20 6f70 7469 6f6e 616c 2c20 6465  ke, optional, de
-00046030: 6661 756c 743a 205b 302c 302c 315d 0d0a  fault: [0,0,1]..
-00046040: 2020 2020 2020 2020 2020 2020 4120 7879              A xy
-00046050: 7a20 7665 6374 6f72 206e 6f72 6d61 6c20  z vector normal 
-00046060: 746f 2074 6865 2069 6e74 6572 7365 6374  to the intersect
-00046070: 696f 6e20 706c 616e 650d 0a20 2020 2020  ion plane..     
-00046080: 2020 2020 2020 2066 6f72 2070 6c61 6e61         for plana
-00046090: 7220 7072 6f6a 6563 7469 6f6e 7320 6f72  r projections or
-000460a0: 2061 7869 616c 2064 6972 6563 7469 6f6e   axial direction
-000460b0: 206f 6620 0d0a 2020 2020 2020 2020 2020   of ..          
-000460c0: 2020 6120 6379 6c69 6e64 6572 2066 6f72    a cylinder for
-000460d0: 2063 796c 696e 6472 6963 616c 2070 726f   cylindrical pro
-000460e0: 6a65 6374 696f 6e73 2e0d 0a0d 0a20 2020  jections.....   
-000460f0: 2020 2020 2063 6f6f 7220 3a20 696e 7465       coor : inte
-00046100: 6765 7220 6f72 2073 7472 696e 6720 696e  ger or string in
-00046110: 6469 6361 7469 6e67 2074 6865 2074 7970  dicating the typ
-00046120: 6520 6f66 2070 726f 6a65 6374 696f 6e20  e of projection 
-00046130: 7375 7266 6163 653a 0d0a 2020 2020 2020  surface:..      
-00046140: 2020 2020 2020 302c 2070 2c20 502c 2078        0, p, P, x
-00046150: 797a 2c70 6c61 6e61 7220 2020 2020 2020  yz,planar       
-00046160: 2020 2020 2020 2020 2020 2d20 706c 616e            - plan
-00046170: 6172 2028 6465 6661 756c 7429 0d0a 2020  ar (default)..  
-00046180: 2020 2020 2020 2020 2020 312c 2063 2c20            1, c, 
-00046190: 432c 2063 796c 696e 6465 722c 7070 6c61  C, cylinder,ppla
-000461a0: 722c 6379 6c69 6e64 7269 6361 6c20 2d20  r,cylindrical - 
-000461b0: 6379 6c69 6e64 6572 0d0a 2020 2020 2020  cylinder..      
-000461c0: 2020 2020 2020 322c 2073 2c20 532c 2073        2, s, S, s
-000461d0: 7068 6572 652c 7370 6865 7269 6361 6c20  phere,spherical 
-000461e0: 2020 2020 2020 2020 2020 2d20 7370 6865            - sphe
-000461f0: 7265 0d0a 2020 2020 2020 2020 2020 2020  re..            
-00046200: 332c 2078 2c20 5820 2020 2020 2020 2020  3, x, X         
-00046210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00046220: 2020 2020 2d20 792d 7a20 706c 616e 650d      - y-z plane.
-00046230: 0a20 2020 2020 2020 2020 2020 2034 2c20  .            4, 
-00046240: 792c 2059 2020 2020 2020 2020 2020 2020  y, Y            
-00046250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00046260: 202d 2078 2d7a 2070 6c61 6e65 0d0a 2020   - x-z plane..  
-00046270: 2020 2020 2020 2020 2020 352c 207a 2c20            5, z, 
-00046280: 5a20 2020 2020 2020 2020 2020 2020 2020  Z               
-00046290: 2020 2020 2020 2020 2020 2020 2020 2d20                - 
-000462a0: 782d 7920 706c 616e 650d 0a0d 0a20 2020  x-y plane....   
-000462b0: 2020 2020 206c 7265 7a20 3a20 706f 7369       lrez : posi
-000462c0: 7469 7665 2069 6e74 6567 6572 2c20 6f70  tive integer, op
-000462d0: 7469 6f6e 616c 2c20 6465 6661 756c 7420  tional, default 
-000462e0: 3a20 300d 0a20 2020 2020 2020 2020 2020  : 0..           
-000462f0: 2070 726f 6a65 6374 696f 6e20 7265 6375   projection recu
-00046300: 7273 6976 6520 7375 6264 6976 6973 696f  rsive subdivisio
-00046310: 6e73 2e0d 0a0d 0a20 2020 2020 2020 2063  ns.....        c
-00046320: 6f6c 6f72 203a 2043 6f6c 6f72 2c20 6f70  olor : Color, op
-00046330: 7469 6f6e 616c 2c20 6465 6661 756c 7420  tional, default 
-00046340: 3a20 6c69 6e65 2063 6f6c 6f72 0d0a 0d0a  : line color....
-00046350: 2020 2020 2020 2020 616c 7068 6120 3a20          alpha : 
-00046360: 7363 616c 6172 2c20 6f70 7469 6f6e 616c  scalar, optional
-00046370: 2c20 6465 6661 756c 7420 3a20 310d 0a20  , default : 1.. 
-00046380: 2020 2020 2020 2020 2020 2046 6163 6520             Face 
-00046390: 636f 6c6f 7220 616c 7068 6120 7661 6c75  color alpha valu
-000463a0: 652c 2069 6e20 7468 6520 7261 6e67 6520  e, in the range 
-000463b0: 3020 746f 2031 2e20 0d0a 2020 2020 2020  0 to 1. ..      
-000463c0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-000463d0: 6e61 6d65 203a 2073 7472 696e 672c 206f  name : string, o
-000463e0: 7074 696f 6e61 6c2c 2064 6566 6175 6c74  ptional, default
-000463f0: 3a20 4e6f 6e65 2e0d 0a20 2020 2020 2020  : None...       
-00046400: 2020 2020 2044 6573 6372 6970 7469 7665       Descriptive
-00046410: 2069 6465 6e74 6966 6965 7220 666f 7220   identifier for 
-00046420: 7468 6520 6765 6f6d 6574 7279 2e0d 0a0d  the geometry....
-00046430: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-00046440: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-00046450: 2d0d 0a20 2020 2020 2020 2053 7572 6661  -..        Surfa
-00046460: 6365 3344 436f 6c6c 6563 7469 6f6e 206f  ce3DCollection o
-00046470: 626a 6563 740d 0a20 2020 2020 2020 0d0a  bject..       ..
-00046480: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
-00046490: 2020 2020 2065 7874 4466 7420 3d20 7b20       extDft = { 
-000464a0: 2764 6972 6563 7469 6f6e 273a 5b30 2c30  'direction':[0,0
-000464b0: 2c31 5d2c 2027 6469 7374 273a 302e 302c  ,1], 'dist':0.0,
-000464c0: 2027 6c72 657a 273a 302c 2027 616c 7068   'lrez':0, 'alph
-000464d0: 6127 3a4e 6f6e 652c 2027 636f 6c6f 7227  a':None, 'color'
-000464e0: 3a4e 6f6e 652c 2027 6e61 6d65 273a 4e6f  :None, 'name':No
-000464f0: 6e65 207d 0d0a 2020 2020 2020 2020 6b61  ne }..        ka
-00046500: 7267 4466 7420 3d20 7b20 2a2a 5f43 4f4f  rgDft = { **_COO
-00046510: 525f 4b57 4152 4753 2c20 2a2a 6578 7444  R_KWARGS, **extD
-00046520: 6674 207d 0d0a 2020 2020 2020 2020 4b57  ft }..        KW
-00046530: 203d 204b 5770 726f 6365 7373 6f72 286b   = KWprocessor(k
-00046540: 6172 6744 6674 2c27 6765 745f 6669 6c6c  argDft,'get_fill
-00046550: 6564 5f73 7572 6661 6365 272c 2a2a 6b61  ed_surface',**ka
-00046560: 7267 7329 0d0a 2020 2020 2020 2020 6472  rgs)..        dr
-00046570: 6374 6e20 3d20 4b57 2e67 6574 5661 6c28  ctn = KW.getVal(
-00046580: 2764 6972 6563 7469 6f6e 2729 0d0a 2020  'direction')..  
-00046590: 2020 2020 2020 6178 6973 203d 204b 572e        axis = KW.
-000465a0: 6765 7456 616c 2827 636f 6f72 2729 0d0a  getVal('coor')..
-000465b0: 2020 2020 2020 2020 6261 7365 203d 204b          base = K
-000465c0: 572e 6765 7456 616c 2827 6469 7374 2729  W.getVal('dist')
-000465d0: 0d0a 2020 2020 2020 2020 6c72 657a 203d  ..        lrez =
-000465e0: 204b 572e 6765 7456 616c 2827 6c72 657a   KW.getVal('lrez
-000465f0: 2729 0d0a 2020 2020 2020 2020 616c 7068  ')..        alph
-00046600: 6120 3d20 4b57 2e67 6574 5661 6c28 2761  a = KW.getVal('a
-00046610: 6c70 6861 2729 0d0a 2020 2020 2020 2020  lpha')..        
-00046620: 636f 6c6f 7220 3d20 4b57 2e67 6574 5661  color = KW.getVa
-00046630: 6c28 2763 6f6c 6f72 2729 0d0a 2020 2020  l('color')..    
-00046640: 2020 2020 6e61 6d65 203d 204b 572e 6765      name = KW.ge
-00046650: 7456 616c 2827 6e61 6d65 2729 0d0a 0d0a  tVal('name')....
-00046660: 2020 2020 2020 2020 6966 2062 6173 6520          if base 
-00046670: 6973 204e 6f6e 6520 3a20 6261 7365 203d  is None : base =
-00046680: 2030 2e30 0d0a 2020 2020 2020 2020 6966   0.0..        if
-00046690: 2061 7869 733d 3d33 203a 2061 7869 732c   axis==3 : axis,
-000466a0: 2064 7263 746e 203d 2030 2c20 5b20 312c   drctn = 0, [ 1,
-000466b0: 302c 3020 5d0d 0a20 2020 2020 2020 2069  0,0 ]..        i
-000466c0: 6620 6178 6973 3d3d 3420 3a20 6178 6973  f axis==4 : axis
-000466d0: 2c20 6472 6374 6e20 3d20 302c 205b 2030  , drctn = 0, [ 0
-000466e0: 2c31 2c30 205d 0d0a 2020 2020 2020 2020  ,1,0 ]..        
-000466f0: 6966 2061 7869 733d 3d35 203a 2061 7869  if axis==5 : axi
-00046700: 732c 2064 7263 746e 203d 2030 2c20 5b20  s, drctn = 0, [ 
-00046710: 302c 302c 3120 5d0d 0a0d 0a20 2020 2020  0,0,1 ]....     
-00046720: 2020 2073 656c 6663 6f70 7920 3d20 636f     selfcopy = co
-00046730: 7079 2e63 6f70 7928 7365 6c66 290d 0a20  py.copy(self).. 
-00046740: 2020 2020 2020 206d 6170 7065 6473 656c         mappedsel
-00046750: 6620 3d20 7365 6c66 636f 7079 2e6d 6170  f = selfcopy.map
-00046760: 5f74 6f5f 706c 616e 6528 2062 6173 652c  _to_plane( base,
-00046770: 2064 6972 6563 7469 6f6e 3d64 7263 746e   direction=drctn
-00046780: 2c20 636f 6f72 3d61 7869 7329 0d0a 2020  , coor=axis)..  
-00046790: 2020 2020 2020 7375 7266 203d 2073 656c        surf = sel
-000467a0: 662e 6765 745f 7375 7266 6163 655f 746f  f.get_surface_to
-000467b0: 5f6c 696e 6528 6d61 7070 6564 7365 6c66  _line(mappedself
-000467c0: 2c20 6c72 657a 3d6c 7265 7a2c 2061 6c70  , lrez=lrez, alp
-000467d0: 6861 3d61 6c70 6861 2c20 636f 6c6f 723d  ha=alpha, color=
-000467e0: 636f 6c6f 722c 206e 616d 653d 6e61 6d65  color, name=name
-000467f0: 290d 0a20 2020 2020 2020 2072 6574 7572  )..        retur
-00046800: 6e20 7375 7266 0d0a 0d0a 2020 2020 6465  n surf....    de
-00046810: 6620 6765 745f 7375 7266 6163 655f 746f  f get_surface_to
-00046820: 5f6c 696e 6528 7365 6c66 2c20 6c69 6e65  _line(self, line
-00046830: 2c20 2a2a 6b61 7267 7329 203a 0d0a 2020  , **kargs) :..  
-00046840: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
-00046850: 2020 2053 7572 6661 6365 3344 436f 6c6c     Surface3DColl
-00046860: 6563 7469 6f6e 2066 726f 6d20 6120 6c69  ection from a li
-00046870: 6e65 2070 726f 6a65 6374 6564 2074 6f20  ne projected to 
-00046880: 616e 6f74 6865 7220 6c69 6e65 2e0d 0a0d  another line....
-00046890: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-000468a0: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
-000468b0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-000468c0: 206c 696e 6520 3a20 6c69 6e65 206f 626a   line : line obj
-000468d0: 6563 7420 7769 7468 2074 6865 2073 616d  ect with the sam
-000468e0: 6520 6e75 6d62 6572 206f 6620 7665 7274  e number of vert
-000468f0: 6963 6573 0d0a 2020 2020 2020 2020 2020  ices..          
-00046900: 2020 6173 2074 6865 2063 616c 6c69 6e67    as the calling
-00046910: 206f 626a 6563 742e 0d0a 0d0a 2020 2020   object.....    
-00046920: 2020 2020 6c72 657a 203a 2070 6f73 6974      lrez : posit
-00046930: 6976 6520 696e 7465 6765 722c 206f 7074  ive integer, opt
-00046940: 696f 6e61 6c2c 2064 6566 6175 6c74 203a  ional, default :
-00046950: 2030 0d0a 2020 2020 2020 2020 2020 2020   0..            
-00046960: 7072 6f6a 6563 7469 6f6e 2072 6563 7572  projection recur
-00046970: 7369 7665 2073 7562 6469 7669 7369 6f6e  sive subdivision
-00046980: 732e 0d0a 0d0a 2020 2020 2020 2020 636f  s.....        co
-00046990: 6c6f 7220 3a20 436f 6c6f 722c 206f 7074  lor : Color, opt
-000469a0: 696f 6e61 6c2c 206f 7074 696f 6e61 6c2c  ional, optional,
-000469b0: 2064 6566 6175 6c74 203a 206c 696e 6520   default : line 
-000469c0: 636f 6c6f 720d 0a0d 0a20 2020 2020 2020  color....       
-000469d0: 2061 6c70 6861 203a 2073 6361 6c61 722c   alpha : scalar,
-000469e0: 206f 7074 696f 6e61 6c2c 2064 6566 6175   optional, defau
-000469f0: 6c74 203a 204e 6f6e 6520 2831 290d 0a20  lt : None (1).. 
-00046a00: 2020 2020 2020 2020 2020 2046 6163 6520             Face 
-00046a10: 636f 6c6f 7220 616c 7068 6120 7661 6c75  color alpha valu
-00046a20: 652c 2069 6e20 7468 6520 7261 6e67 6520  e, in the range 
-00046a30: 3020 746f 2031 2e20 0d0a 2020 2020 2020  0 to 1. ..      
-00046a40: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-00046a50: 6e61 6d65 203a 2073 7472 696e 672c 206f  name : string, o
-00046a60: 7074 696f 6e61 6c2c 2064 6566 6175 6c74  ptional, default
-00046a70: 3a20 4e6f 6e65 2e0d 0a20 2020 2020 2020  : None...       
-00046a80: 2020 2020 2044 6573 6372 6970 7469 7665       Descriptive
-00046a90: 2069 6465 6e74 6966 6965 7220 666f 7220   identifier for 
-00046aa0: 7468 6520 6765 6f6d 6574 7279 2e0d 0a0d  the geometry....
-00046ab0: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-00046ac0: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-00046ad0: 2d0d 0a20 2020 2020 2020 2053 7572 6661  -..        Surfa
-00046ae0: 6365 3344 436f 6c6c 6563 7469 6f6e 206f  ce3DCollection o
-00046af0: 626a 6563 740d 0a20 2020 2020 2020 0d0a  bject..       ..
-00046b00: 2020 2020 2020 2020 2222 220d 0a0d 0a20          """.... 
-00046b10: 2020 2020 2020 206b 6172 6744 6674 203d         kargDft =
-00046b20: 207b 2027 6c72 657a 273a 302c 2027 616c   { 'lrez':0, 'al
-00046b30: 7068 6127 3a4e 6f6e 652c 2027 636f 6c6f  pha':None, 'colo
-00046b40: 7227 3a4e 6f6e 652c 2027 6e61 6d65 273a  r':None, 'name':
-00046b50: 4e6f 6e65 207d 0d0a 2020 2020 2020 2020  None }..        
-00046b60: 4b57 203d 204b 5770 726f 6365 7373 6f72  KW = KWprocessor
-00046b70: 286b 6172 6744 6674 2c27 6765 745f 7375  (kargDft,'get_su
-00046b80: 7266 6163 655f 746f 5f6c 696e 6527 2c2a  rface_to_line',*
-00046b90: 2a6b 6172 6773 290d 0a20 2020 2020 2020  *kargs)..       
-00046ba0: 206c 7265 7a20 3d20 4b57 2e67 6574 5661   lrez = KW.getVa
-00046bb0: 6c28 276c 7265 7a27 290d 0a20 2020 2020  l('lrez')..     
-00046bc0: 2020 2061 6c70 6861 203d 204b 572e 6765     alpha = KW.ge
-00046bd0: 7456 616c 2827 616c 7068 6127 290d 0a20  tVal('alpha').. 
-00046be0: 2020 2020 2020 206e 616d 6520 3d20 4b57         name = KW
-00046bf0: 2e67 6574 5661 6c28 276e 616d 6527 290d  .getVal('name').
-00046c00: 0a20 2020 2020 2020 2063 6f6c 6f72 3d20  .        color= 
-00046c10: 4b57 2e67 6574 5661 6c28 2763 6f6c 6f72  KW.getVal('color
-00046c20: 2729 0d0a 0d0a 2020 2020 2020 2020 6c65  ')....        le
-00046c30: 6e31 2c20 6c65 6e32 203d 206c 656e 2873  n1, len2 = len(s
-00046c40: 656c 662e 7665 7274 6578 436f 6f72 292c  elf.vertexCoor),
-00046c50: 206c 656e 286c 696e 652e 7665 7274 6578   len(line.vertex
-00046c60: 436f 6f72 290d 0a20 2020 2020 2020 2069  Coor)..        i
-00046c70: 6620 6c65 6e31 2021 3d20 6c65 6e32 203a  f len1 != len2 :
-00046c80: 0d0a 2020 2020 2020 2020 2020 2020 7261  ..            ra
-00046c90: 6973 6520 5661 6c75 6545 7272 6f72 2827  ise ValueError('
-00046ca0: 4d69 736d 6161 7463 6865 6420 6c69 6e65  Mismaatched line
-00046cb0: 2072 657a 2066 6f72 2050 6172 616d 6574   rez for Paramet
-00046cc0: 7269 6320 4c69 6e65 733a 207b 7d20 213d  ric Lines: {} !=
-00046cd0: 207b 7d27 2e66 6f72 6d61 7428 6c65 6e31   {}'.format(len1
-00046ce0: 2c6c 656e 3229 290d 0a0d 0a20 2020 2020  ,len2))....     
-00046cf0: 2020 2061 6464 6564 7665 7274 7320 3d20     addedverts = 
-00046d00: 6c69 6e65 2e76 6572 7465 7843 6f6f 720d  line.vertexCoor.
-00046d10: 0a0d 0a20 2020 2020 2020 2072 6574 7572  ...        retur
-00046d20: 6e20 7365 6c66 2e5f 6765 745f 6669 6c6c  n self._get_fill
-00046d30: 6564 5f73 7572 6661 6365 2861 6464 6564  ed_surface(added
-00046d40: 7665 7274 732c 206c 7265 7a3d 6c72 657a  verts, lrez=lrez
-00046d50: 2c20 7363 6c72 3d63 6f6c 6f72 2c20 616c  , sclr=color, al
-00046d60: 7068 613d 616c 7068 612c 206e 616d 653d  pha=alpha, name=
-00046d70: 6e61 6d65 290d 0a0d 0a0d 0a63 6c61 7373  name)......class
-00046d80: 2050 6172 616d 6574 7269 634c 696e 6528   ParametricLine(
-00046d90: 436f 6c6f 724c 696e 6533 4443 6f6c 6c65  ColorLine3DColle
-00046da0: 6374 696f 6e29 203a 0d0a 2020 2020 0d0a  ction) :..    ..
-00046db0: 2020 2020 6465 6620 5f5f 696e 6974 5f5f      def __init__
-00046dc0: 2820 7365 6c66 2c20 7265 7a20 2c20 6f70  ( self, rez , op
-00046dd0: 6572 6174 696f 6e3d 4e6f 6e65 2c20 6e61  eration=None, na
-00046de0: 6d65 3d4e 6f6e 652c 202a 2a6b 7761 7267  me=None, **kwarg
-00046df0: 7320 2920 3a0d 0a20 2020 2020 2020 2022  s ) :..        "
-00046e00: 2222 0d0a 2020 2020 2020 2020 4372 6561  ""..        Crea
-00046e10: 7465 2073 696e 676c 6520 6c69 6e65 2066  te single line f
-00046e20: 726f 6d20 6120 7061 7261 6d65 7472 6963  rom a parametric
-00046e30: 2066 756e 6374 696f 6e20 7769 7468 2064   function with d
-00046e40: 6f6d 6169 6e20 5b30 2c31 5d0d 0a0d 0a20  omain [0,1].... 
-00046e50: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-00046e60: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
-00046e70: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2072  -----..        r
-00046e80: 657a 203a 2069 6e74 6567 6572 2c20 6f70  ez : integer, op
-00046e90: 7469 6f6e 616c 2c20 6465 6661 756c 743a  tional, default:
-00046ea0: 2030 200d 0a20 2020 2020 2020 2020 2020   0 ..           
-00046eb0: 204e 756d 6265 7220 6f66 2072 6563 7572   Number of recur
-00046ec0: 7369 7665 2062 6973 6563 7469 6f6e 206f  sive bisection o
-00046ed0: 6620 6c69 6e65 2073 6567 6d65 6e74 732e  f line segments.
-00046ee0: 0d0a 2020 2020 2020 2020 2020 2020 5265  ..            Re
-00046ef0: 7a20 7661 6c75 6573 2072 616e 6765 2066  z values range f
-00046f00: 726f 6d20 3020 746f 2037 2e20 4966 2072  rom 0 to 7. If r
-00046f10: 657a 2069 7320 6c65 7373 2074 6861 6e20  ez is less than 
-00046f20: 7a65 726f 2c0d 0a20 2020 2020 2020 2020  zero,..         
-00046f30: 2020 206e 6567 6174 6976 6520 7661 6c75     negative valu
-00046f40: 6520 7769 6c6c 2062 6520 7468 6520 6e75  e will be the nu
-00046f50: 6d62 6572 206f 6620 7365 676d 656e 7473  mber of segments
-00046f60: 2e0d 0a0d 0a20 2020 2020 2020 206f 7065  .....        ope
-00046f70: 7261 7469 6f6e 203a 2066 756e 6374 696f  ration : functio
-00046f80: 6e20 6f62 6a65 6374 200d 0a20 2020 2020  n object ..     
-00046f90: 2020 2020 2020 2046 756e 6374 696f 6e20         Function 
-00046fa0: 7468 6174 2074 616b 6573 206f 6e65 2061  that takes one a
-00046fb0: 7267 756d 656e 742c 2061 204e 756d 7079  rgument, a Numpy
-00046fc0: 2066 6c6f 6174 0d0a 2020 2020 2020 2020   float..        
-00046fd0: 2020 2020 6172 7261 792e 2054 6865 2066      array. The f
-00046fe0: 756e 6374 696f 6e20 646f 6d61 696e 2069  unction domain i
-00046ff0: 7320 5b30 2e30 2c20 312c 305d 2061 6e64  s [0.0, 1,0] and
-00047000: 2072 6574 7572 6e73 0d0a 2020 2020 2020   returns..      
-00047010: 2020 2020 2020 6120 3320 5820 4e20 6172        a 3 X N ar
-00047020: 7261 7920 6f66 2078 797a 2063 6f6f 7264  ray of xyz coord
-00047030: 696e 6174 6573 2e0d 0a0d 0a20 2020 2020  inates.....     
-00047040: 2020 206e 616d 6520 3a20 7374 722c 206f     name : str, o
-00047050: 7074 696f 6e61 6c2c 2064 6566 6175 6c74  ptional, default
-00047060: 3a20 6675 6e63 7469 6f6e 206f 626a 6563  : function objec
-00047070: 7420 6e61 6d65 0d0a 2020 2020 2020 2020  t name..        
-00047080: 2020 2020 2020 2020 6966 206e 6f74 2061          if not a
-00047090: 206c 616d 6264 6120 6675 6e63 7469 6f6e   lambda function
-000470a0: 2c20 6f74 6865 7277 6973 6520 7374 7269  , otherwise stri
-000470b0: 6e67 2027 272e 0d0a 2020 2020 2020 2020  ng ''...        
-000470c0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-000470d0: 2020 4f74 6865 7220 5061 7261 6d65 7465    Other Paramete
-000470e0: 7273 0d0a 2020 2020 2020 2020 2d2d 2d2d  rs..        ----
-000470f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020  ------------..  
-00047100: 2020 2020 2020 2a2a 6b77 6172 6773 0d0a        **kwargs..
-00047110: 2020 2020 2020 2020 2020 2020 416c 6c20              All 
-00047120: 6f74 6865 7220 7061 7261 6d65 7465 7273  other parameters
-00047130: 2061 7265 2070 6173 7365 6420 6f6e 2074   are passed on t
-00047140: 6f20 2773 3364 6c69 622e 7375 7266 6163  o 's3dlib.surfac
-00047150: 652e 436f 6c6f 724c 696e 6533 4443 6f6c  e.ColorLine3DCol
-00047160: 6c65 6374 696f 6e27 2e0d 0a0d 0a20 2020  lection'.....   
-00047170: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
-00047180: 2020 2320 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    # ------------
-00047190: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000471a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20  -------------.. 
-000471b0: 2020 2020 2020 2064 6566 2064 6566 6175         def defau
-000471c0: 6c74 5f6c 696e 6528 6e75 6d56 6572 7473  lt_line(numVerts
-000471d0: 2920 3a0d 0a20 2020 2020 2020 2020 2020  ) :..           
-000471e0: 2023 2078 797a 2061 7865 7320 6c69 6e65   # xyz axes line
-000471f0: 7320 5b2d 312c 315d 0d0a 2020 2020 2020  s [-1,1]..      
-00047200: 2020 2020 2020 6c69 6e65 5661 6c73 203d        lineVals =
-00047210: 206e 702e 6c69 6e73 7061 6365 282d 312e   np.linspace(-1.
-00047220: 302c 312e 302c 2069 6e74 286e 756d 5665  0,1.0, int(numVe
-00047230: 7274 7329 2029 0d0a 2020 2020 2020 2020  rts) )..        
-00047240: 2020 2020 7a65 726f 7320 3d20 6e70 2e7a      zeros = np.z
-00047250: 6572 6f73 2820 696e 7428 6e75 6d56 6572  eros( int(numVer
-00047260: 7473 2920 290d 0a20 2020 2020 2020 2020  ts) )..         
-00047270: 2020 2058 6178 6973 203d 206e 702e 6173     Xaxis = np.as
-00047280: 6172 7261 7928 205b 6c69 6e65 5661 6c73  array( [lineVals
-00047290: 2c20 7a65 726f 732c 207a 6572 6f73 205d  , zeros, zeros ]
-000472a0: 2029 2e54 0d0a 2020 2020 2020 2020 2020   ).T..          
-000472b0: 2020 5961 7869 7320 3d20 6e70 2e61 7361    Yaxis = np.asa
-000472c0: 7272 6179 2820 5b7a 6572 6f73 2c20 6c69  rray( [zeros, li
-000472d0: 6e65 5661 6c73 2c20 7a65 726f 7320 5d20  neVals, zeros ] 
-000472e0: 292e 540d 0a20 2020 2020 2020 2020 2020  ).T..           
-000472f0: 205a 6178 6973 203d 206e 702e 6173 6172   Zaxis = np.asar
-00047300: 7261 7928 205b 7a65 726f 732c 207a 6572  ray( [zeros, zer
-00047310: 6f73 2c20 6c69 6e65 5661 6c73 205d 2029  os, lineVals ] )
-00047320: 2e54 0d0a 2020 2020 2020 2020 2020 2020  .T..            
-00047330: 7665 7274 7320 3d20 6e70 2e76 7374 6163  verts = np.vstac
-00047340: 6b28 2028 5861 7869 732c 5961 7869 732c  k( (Xaxis,Yaxis,
-00047350: 5a61 7869 7320 2929 0d0a 2020 2020 2020  Zaxis ))..      
-00047360: 2020 2020 2020 696e 6469 6365 7320 3d20        indices = 
-00047370: 5b4e 6f6e 655d 2a33 0d0a 2020 2020 2020  [None]*3..      
-00047380: 2020 2020 2020 696e 6465 7820 3d20 300d        index = 0.
-00047390: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-000473a0: 2069 2069 6e20 7261 6e67 6528 302c 3329   i in range(0,3)
-000473b0: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
-000473c0: 2020 2020 696e 6469 6365 735b 695d 203d      indices[i] =
-000473d0: 205b 4e6f 6e65 5d2a 286e 756d 5665 7274   [None]*(numVert
-000473e0: 7329 0d0a 2020 2020 2020 2020 2020 2020  s)..            
-000473f0: 2020 2020 666f 7220 6a20 696e 2072 616e      for j in ran
-00047400: 6765 286e 756d 5665 7274 7329 203a 0d0a  ge(numVerts) :..
-00047410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00047420: 2020 2020 696e 6469 6365 735b 695d 5b6a      indices[i][j
-00047430: 5d20 3d20 696e 6465 780d 0a20 2020 2020  ] = index..     
-00047440: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00047450: 6e64 6578 202b 3d20 310d 0a20 2020 2020  ndex += 1..     
-00047460: 2020 2020 2020 2072 6574 7572 6e20 7665         return ve
-00047470: 7274 732c 2069 6e64 6963 6573 0d0a 2020  rts, indices..  
-00047480: 2020 2020 2020 2320 2d2d 2d2d 2d2d 2d2d        # --------
-00047490: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000474a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000474b0: 2d0d 0a20 2020 2020 2020 2069 6620 6e6f  -..        if no
-000474c0: 7420 6973 696e 7374 616e 6365 2872 657a  t isinstance(rez
-000474d0: 2c69 6e74 2920 3a0d 0a20 2020 2020 2020  ,int) :..       
-000474e0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-000474f0: 4572 726f 7228 2750 6172 616d 6574 7269  Error('Parametri
-00047500: 634c 696e 653a 2049 6e63 6f72 7265 7374  cLine: Incorrest
-00047510: 2072 657a 206f 6620 7b7d 2c20 6d75 7374   rez of {}, must
-00047520: 2062 6520 616e 2069 6e74 272e 666f 726d   be an int'.form
-00047530: 6174 2872 657a 2929 0d0a 2020 2020 2020  at(rez))..      
-00047540: 2020 6966 2028 7265 7a3e 5f4d 4158 504c    if (rez>_MAXPL
-00047550: 5245 5a29 203a 0d0a 2020 2020 2020 2020  REZ) :..        
-00047560: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-00047570: 7272 6f72 2827 5061 7261 6d65 7472 6963  rror('Parametric
-00047580: 4c69 6e65 3a49 6e63 6f72 7265 7374 2072  Line:Incorrest r
-00047590: 657a 206f 6620 7b7d 2c20 6d75 7374 206c  ez of {}, must l
-000475a0: 6573 7320 7468 616e 206f 7220 6571 7561  ess than or equa
-000475b0: 6c20 746f 207b 7d27 2e66 6f72 6d61 7428  l to {}'.format(
-000475c0: 7265 7a2c 5f4d 4158 504c 5245 5a29 290d  rez,_MAXPLREZ)).
-000475d0: 0a20 2020 2020 2020 2069 6620 7265 7a3c  .        if rez<
-000475e0: 3020 3a0d 0a20 2020 2020 2020 2020 2020  0 :..           
-000475f0: 2073 656c 662e 6e75 6d53 6567 203d 202d   self.numSeg = -
-00047600: 7265 7a0d 0a20 2020 2020 2020 2020 2020  rez..           
-00047610: 2023 2046 7574 4465 763a 2073 686f 756c   # FutDev: shoul
-00047620: 6420 6368 6563 6b20 6966 203e 2032 2a2a  d check if > 2**
-00047630: 285f 4d41 5850 4c52 455a 2b31 290d 0a20  (_MAXPLREZ+1).. 
-00047640: 2020 2020 2020 2065 6c73 6520 3a0d 0a20         else :.. 
-00047650: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00047660: 6e75 6d53 6567 203d 2069 6e74 2832 2a2a  numSeg = int(2**
-00047670: 2872 657a 2b31 2929 0d0a 2020 2020 2020  (rez+1))..      
-00047680: 2020 6e75 6d56 6572 7473 203d 2073 656c    numVerts = sel
-00047690: 662e 6e75 6d53 6567 202b 2031 0d0a 2020  f.numSeg + 1..  
-000476a0: 2020 2020 2020 6966 206f 7065 7261 7469        if operati
-000476b0: 6f6e 2069 7320 4e6f 6e65 203a 0d0a 2020  on is None :..  
-000476c0: 2020 2020 2020 2020 2020 7665 7274 732c            verts,
-000476d0: 2069 6e64 6963 6573 203d 2064 6566 6175   indices = defau
-000476e0: 6c74 5f6c 696e 6528 6e75 6d56 6572 7473  lt_line(numVerts
-000476f0: 290d 0a20 2020 2020 2020 2065 6c73 6520  )..        else 
-00047700: 3a0d 0a20 2020 2020 2020 2020 2020 206e  :..            n
-00047710: 616d 6520 3d20 5f67 6574 4675 6e63 7469  ame = _getFuncti
-00047720: 6f6e 4e61 6d65 286f 7065 7261 7469 6f6e  onName(operation
-00047730: 2c6e 616d 6529 0d0a 2020 2020 2020 2020  ,name)..        
-00047740: 2020 2020 6c69 6e65 5661 6c73 203d 206e      lineVals = n
-00047750: 702e 6c69 6e73 7061 6365 2830 2e30 2c31  p.linspace(0.0,1
-00047760: 2e30 2c20 7365 6c66 2e6e 756d 5365 672b  .0, self.numSeg+
-00047770: 3129 0d0a 2020 2020 2020 2020 2020 2020  1)..            
-00047780: 7665 7274 7320 3d20 6e70 2e61 7272 6179  verts = np.array
-00047790: 286f 7065 7261 7469 6f6e 286c 696e 6556  (operation(lineV
-000477a0: 616c 7329 292e 540d 0a20 2020 2020 2020  als)).T..       
-000477b0: 2020 2020 2076 6572 7473 203d 2076 6572       verts = ver
-000477c0: 7473 2e74 6f6c 6973 7428 290d 0a20 2020  ts.tolist()..   
-000477d0: 2020 2020 2020 2020 2069 6e64 6963 6573           indices
-000477e0: 203d 205b 205b 2a72 616e 6765 286c 656e   = [ [*range(len
-000477f0: 2876 6572 7473 2929 5d20 5d0d 0a20 2020  (verts))] ]..   
-00047800: 2020 2020 2073 7570 6572 2829 2e5f 5f69       super().__i
-00047810: 6e69 745f 5f28 7665 7274 732c 2069 6e64  nit__(verts, ind
-00047820: 6963 6573 2c20 6e61 6d65 2c20 2a2a 6b77  ices, name, **kw
-00047830: 6172 6773 290d 0a0d 0a20 2020 2020 2020  args)....       
-00047840: 2073 656c 662e 7265 7a20 3d20 7265 7a0d   self.rez = rez.
-00047850: 0a0d 0a20 2020 2064 6566 205f 6765 7453  ...    def _getS
-00047860: 6c69 6365 2873 656c 662c 2067 2c20 6e75  lice(self, g, nu
-00047870: 6d56 6572 7473 2c20 646f 6d61 696e 2c20  mVerts, domain, 
-00047880: 7856 616c 3d4e 6f6e 652c 2079 5661 6c3d  xVal=None, yVal=
-00047890: 4e6f 6e65 2020 2920 3a0d 0a20 2020 2020  None  ) :..     
-000478a0: 2020 2069 6620 7856 616c 2069 7320 4e6f     if xVal is No
-000478b0: 6e65 2061 6e64 2079 5661 6c20 6973 204e  ne and yVal is N
-000478c0: 6f6e 6520 3a20 7265 7475 726e 204e 6f6e  one : return Non
-000478d0: 652c 204e 6f6e 650d 0a20 2020 2020 2020  e, None..       
-000478e0: 206e 756d 4c69 6e65 7320 3d20 300d 0a20   numLines = 0.. 
-000478f0: 2020 2020 2020 2069 6620 7856 616c 2069         if xVal i
-00047900: 7320 6e6f 7420 4e6f 6e65 203a 206e 756d  s not None : num
-00047910: 4c69 6e65 7320 2b3d 2031 0d0a 2020 2020  Lines += 1..    
-00047920: 2020 2020 6966 2079 5661 6c20 6973 206e      if yVal is n
-00047930: 6f74 204e 6f6e 6520 3a20 6e75 6d4c 696e  ot None : numLin
-00047940: 6573 202b 3d20 3120 2020 2020 2020 2020  es += 1         
-00047950: 2020 0d0a 2020 2020 2020 2020 696e 6469    ..        indi
-00047960: 6365 7320 3d20 5b4e 6f6e 655d 2a28 206e  ces = [None]*( n
-00047970: 756d 4c69 6e65 7320 290d 0a20 2020 2020  umLines )..     
-00047980: 2020 206e 756d 625f 585f 6c69 6e65 7320     numb_X_lines 
-00047990: 3d20 300d 0a20 2020 2020 2020 2069 6e64  = 0..        ind
-000479a0: 6578 203d 2030 0d0a 0d0a 2020 2020 2020  ex = 0....      
-000479b0: 2020 7665 7274 7320 3d20 5b5d 0d0a 2020    verts = []..  
-000479c0: 2020 2020 2020 6966 2078 5661 6c20 6973        if xVal is
-000479d0: 206e 6f74 204e 6f6e 6520 3a0d 0a20 2020   not None :..   
-000479e0: 2020 2020 2020 2020 206e 756d 625f 585f           numb_X_
-000479f0: 6c69 6e65 7320 3d20 310d 0a20 2020 2020  lines = 1..     
-00047a00: 2020 2020 2020 206c 696e 6556 6572 7473         lineVerts
-00047a10: 5074 7320 3d20 6e70 2e6c 696e 7370 6163  Pts = np.linspac
-00047a20: 6528 646f 6d61 696e 5b27 796d 696e 275d  e(domain['ymin']
-00047a30: 2c20 646f 6d61 696e 5b27 796d 6178 275d  , domain['ymax']
-00047a40: 2c20 6e75 6d56 6572 7473 2029 0d0a 2020  , numVerts )..  
-00047a50: 2020 2020 2020 2020 2020 785f 6c69 6e65            x_line
-00047a60: 5665 7274 7350 7473 203d 206e 702e 6172  VertsPts = np.ar
-00047a70: 7261 7928 5b78 5661 6c5d 2029 0d0a 2020  ray([xVal] )..  
-00047a80: 2020 2020 2020 2020 2020 7a5f 585f 6c69            z_X_li
-00047a90: 6e65 7320 3d20 6728 785f 6c69 6e65 5665  nes = g(x_lineVe
-00047aa0: 7274 7350 7473 2c6c 696e 6556 6572 7473  rtsPts,lineVerts
-00047ab0: 5074 7329 0d0a 0d0a 2020 2020 2020 2020  Pts)....        
-00047ac0: 2020 2020 666f 7220 6959 2069 6e20 7261      for iY in ra
-00047ad0: 6e67 6528 6e75 6d56 6572 7473 2920 3a0d  nge(numVerts) :.
-00047ae0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00047af0: 2020 7665 7274 732e 6170 7065 6e64 2820    verts.append( 
-00047b00: 5b20 7856 616c 202c 206c 696e 6556 6572  [ xVal , lineVer
-00047b10: 7473 5074 735b 6959 5d2c 207a 5f58 5f6c  tsPts[iY], z_X_l
-00047b20: 696e 6573 5b69 592c 305d 205d 290d 0a0d  ines[iY,0] ])...
-00047b30: 0a20 2020 2020 2020 2020 2020 2069 6e64  .            ind
-00047b40: 6963 6573 5b30 5d20 3d20 5b4e 6f6e 655d  ices[0] = [None]
-00047b50: 2a28 6e75 6d56 6572 7473 290d 0a20 2020  *(numVerts)..   
-00047b60: 2020 2020 2020 2020 2066 6f72 206a 2069           for j i
-00047b70: 6e20 7261 6e67 6528 6e75 6d56 6572 7473  n range(numVerts
-00047b80: 2920 3a0d 0a20 2020 2020 2020 2020 2020  ) :..           
-00047b90: 2020 2020 2069 6e64 6963 6573 5b30 5d5b       indices[0][
-00047ba0: 6a5d 203d 2069 6e64 6578 0d0a 2020 2020  j] = index..    
-00047bb0: 2020 2020 2020 2020 2020 2020 696e 6465              inde
-00047bc0: 7820 2b3d 2031 0d0a 2020 2020 2020 2020  x += 1..        
-00047bd0: 0d0a 2020 2020 2020 2020 6966 2079 5661  ..        if yVa
-00047be0: 6c20 6973 206e 6f74 204e 6f6e 6520 3a0d  l is not None :.
-00047bf0: 0a20 2020 2020 2020 2020 2020 206c 696e  .            lin
-00047c00: 6556 6572 7473 5074 7320 3d20 6e70 2e6c  eVertsPts = np.l
-00047c10: 696e 7370 6163 6528 646f 6d61 696e 5b27  inspace(domain['
-00047c20: 786d 696e 275d 2c20 646f 6d61 696e 5b27  xmin'], domain['
-00047c30: 786d 6178 275d 2c20 6e75 6d56 6572 7473  xmax'], numVerts
-00047c40: 2029 0d0a 2020 2020 2020 2020 2020 2020   )..            
-00047c50: 795f 6c69 6e65 5665 7274 7350 7473 203d  y_lineVertsPts =
-00047c60: 206e 702e 6172 7261 7928 5b79 5661 6c5d   np.array([yVal]
-00047c70: 2029 0d0a 2020 2020 2020 2020 2020 2020   )..            
-00047c80: 7a5f 595f 6c69 6e65 7320 3d20 6728 6c69  z_Y_lines = g(li
-00047c90: 6e65 5665 7274 7350 7473 2c20 795f 6c69  neVertsPts, y_li
-00047ca0: 6e65 5665 7274 7350 7473 290d 0a20 2020  neVertsPts)..   
-00047cb0: 2020 2020 2020 2020 2023 2074 6865 2066           # the f
-00047cc0: 6f6c 6c6f 7769 6e67 2c20 636f 6d70 656e  ollowing, compen
-00047cd0: 7361 7465 7320 666f 7220 696e 7465 7270  sates for interp
-00047ce0: 3264 2066 6f72 2064 6174 6167 7269 640d  2d for datagrid.
-00047cf0: 0a20 2020 2020 2020 2020 2020 2023 2077  .            # w
-00047d00: 6869 6368 2064 726f 7073 2074 6865 2066  hich drops the f
-00047d10: 6972 7374 2064 696d 656e 7369 6f6e 2c20  irst dimension, 
-00047d20: 7365 6520 6d61 705f 7879 536c 6963 655f  see map_xySlice_
-00047d30: 6672 6f6d 5f6f 7020 203f 3f3f 0d0a 2020  from_op  ???..  
-00047d40: 2020 2020 2020 2020 2020 7a5f 595f 6c69            z_Y_li
-00047d50: 6e65 7320 3d20 6e70 2e61 7272 6179 285b  nes = np.array([
-00047d60: 6728 6c69 6e65 5665 7274 7350 7473 2c20  g(lineVertsPts, 
-00047d70: 795f 6c69 6e65 5665 7274 7350 7473 295d  y_lineVertsPts)]
-00047d80: 290d 0a20 2020 2020 2020 2020 2020 200d  )..            .
-00047d90: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-00047da0: 2069 5820 696e 2072 616e 6765 286e 756d   iX in range(num
-00047db0: 5665 7274 7329 203a 0d0a 2020 2020 2020  Verts) :..      
-00047dc0: 2020 2020 2020 2020 2020 2076 6572 7473             verts
-00047dd0: 2e61 7070 656e 6428 205b 206c 696e 6556  .append( [ lineV
-00047de0: 6572 7473 5074 735b 6958 5d2c 2079 5661  ertsPts[iX], yVa
-00047df0: 6c2c 207a 5f59 5f6c 696e 6573 5b30 2c69  l, z_Y_lines[0,i
-00047e00: 585d 205d 290d 0a20 2020 2020 2020 2020  X] ])..         
-00047e10: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
-00047e20: 2069 6e64 6963 6573 5b6e 756d 625f 585f   indices[numb_X_
-00047e30: 6c69 6e65 735d 203d 205b 4e6f 6e65 5d2a  lines] = [None]*
-00047e40: 286e 756d 5665 7274 7329 0d0a 2020 2020  (numVerts)..    
-00047e50: 2020 2020 2020 2020 666f 7220 6a20 696e          for j in
-00047e60: 2072 616e 6765 286e 756d 5665 7274 7329   range(numVerts)
-00047e70: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
-00047e80: 2020 2020 696e 6469 6365 735b 6e75 6d62      indices[numb
-00047e90: 5f58 5f6c 696e 6573 5d5b 6a5d 203d 2069  _X_lines][j] = i
-00047ea0: 6e64 6578 0d0a 2020 2020 2020 2020 2020  ndex..          
-00047eb0: 2020 2020 2020 696e 6465 7820 2b3d 2031        index += 1
-00047ec0: 0d0a 0d0a 2020 2020 2020 2020 7665 7274  ....        vert
-00047ed0: 7320 3d20 6e70 2e61 7272 6179 2876 6572  s = np.array(ver
-00047ee0: 7473 290d 0a0d 0a20 2020 2020 2020 2072  ts)....        r
-00047ef0: 6574 7572 6e20 7665 7274 732c 2069 6e64  eturn verts, ind
-00047f00: 6963 6573 0d0a 0d0a 2020 2020 6465 6620  ices....    def 
-00047f10: 5f67 6574 536c 6963 6553 6574 2873 656c  _getSliceSet(sel
-00047f20: 662c 2067 2c20 6e75 6d56 6572 7473 2c20  f, g, numVerts, 
-00047f30: 646f 6d61 696e 2c20 7873 616d 706c 6573  domain, xsamples
-00047f40: 2c20 7973 616d 706c 6573 2029 203a 0d0a  , ysamples ) :..
-00047f50: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00047f60: 2020 6966 2078 7361 6d70 6c65 7320 6973    if xsamples is
-00047f70: 204e 6f6e 6520 616e 6420 7973 616d 706c   None and ysampl
-00047f80: 6573 2069 7320 4e6f 6e65 203a 2072 6574  es is None : ret
-00047f90: 7572 6e20 4e6f 6e65 2c20 4e6f 6e65 0d0a  urn None, None..
-00047fa0: 2020 2020 2020 2020 6e75 6d62 5f58 5f6c          numb_X_l
-00047fb0: 696e 6573 2c20 6e75 6d62 5f59 5f6c 696e  ines, numb_Y_lin
-00047fc0: 6573 203d 2030 2c30 0d0a 2020 2020 2020  es = 0,0..      
-00047fd0: 2020 6966 2078 7361 6d70 6c65 7320 6973    if xsamples is
-00047fe0: 206e 6f74 204e 6f6e 6520 3a20 6e75 6d62   not None : numb
-00047ff0: 5f58 5f6c 696e 6573 203d 2078 7361 6d70  _X_lines = xsamp
-00048000: 6c65 730d 0a20 2020 2020 2020 2069 6620  les..        if 
-00048010: 7973 616d 706c 6573 2069 7320 6e6f 7420  ysamples is not 
-00048020: 4e6f 6e65 203a 206e 756d 625f 595f 6c69  None : numb_Y_li
-00048030: 6e65 7320 3d20 7973 616d 706c 6573 0d0a  nes = ysamples..
-00048040: 2020 2020 2020 2020 696e 6469 6365 7320          indices 
-00048050: 3d20 5b4e 6f6e 655d 2a28 206e 756d 625f  = [None]*( numb_
-00048060: 585f 6c69 6e65 7320 2b20 6e75 6d62 5f59  X_lines + numb_Y
-00048070: 5f6c 696e 6573 2029 0d0a 2020 2020 2020  _lines )..      
-00048080: 2020 696e 6465 7820 3d20 300d 0a0d 0a20    index = 0.... 
-00048090: 2020 2020 2020 2076 6572 7473 203d 205b         verts = [
-000480a0: 5d0d 0a20 2020 2020 2020 2069 6620 7873  ]..        if xs
-000480b0: 616d 706c 6573 2069 7320 6e6f 7420 4e6f  amples is not No
-000480c0: 6e65 203a 0d0a 2020 2020 2020 2020 2020  ne :..          
-000480d0: 2020 6c69 6e65 5665 7274 7350 7473 203d    lineVertsPts =
-000480e0: 206e 702e 6c69 6e73 7061 6365 2864 6f6d   np.linspace(dom
-000480f0: 6169 6e5b 2779 6d69 6e27 5d2c 2064 6f6d  ain['ymin'], dom
-00048100: 6169 6e5b 2779 6d61 7827 5d2c 206e 756d  ain['ymax'], num
-00048110: 5665 7274 7320 290d 0a20 2020 2020 2020  Verts )..       
-00048120: 2020 2020 2078 5f6c 696e 6556 6572 7473       x_lineVerts
-00048130: 5074 7320 3d20 6e70 2e6c 696e 7370 6163  Pts = np.linspac
-00048140: 6528 646f 6d61 696e 5b27 786d 696e 275d  e(domain['xmin']
-00048150: 2c20 646f 6d61 696e 5b27 786d 6178 275d  , domain['xmax']
-00048160: 2c20 6e75 6d62 5f58 5f6c 696e 6573 2029  , numb_X_lines )
-00048170: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-00048180: 2078 7361 6d70 6c65 7320 3d3d 2031 203a   xsamples == 1 :
-00048190: 2078 5f6c 696e 6556 6572 7473 5074 7320   x_lineVertsPts 
-000481a0: 3d20 6e70 2e61 7361 7272 6179 285b 302e  = np.asarray([0.
-000481b0: 305d 290d 0a20 2020 2020 2020 2020 2020  0])..           
-000481c0: 207a 5f58 5f6c 696e 6573 203d 2067 2878   z_X_lines = g(x
-000481d0: 5f6c 696e 6556 6572 7473 5074 732c 6c69  _lineVertsPts,li
-000481e0: 6e65 5665 7274 7350 7473 290d 0a0d 0a20  neVertsPts).... 
-000481f0: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
-00048200: 5820 696e 2072 616e 6765 286e 756d 625f  X in range(numb_
-00048210: 585f 6c69 6e65 7329 203a 0d0a 2020 2020  X_lines) :..    
-00048220: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00048230: 6959 2069 6e20 7261 6e67 6528 6e75 6d56  iY in range(numV
-00048240: 6572 7473 2920 3a0d 0a20 2020 2020 2020  erts) :..       
-00048250: 2020 2020 2020 2020 2020 2020 2076 6572               ver
-00048260: 7473 2e61 7070 656e 6428 205b 2078 5f6c  ts.append( [ x_l
-00048270: 696e 6556 6572 7473 5074 735b 6958 5d20  ineVertsPts[iX] 
-00048280: 2c20 6c69 6e65 5665 7274 7350 7473 5b69  , lineVertsPts[i
-00048290: 595d 2c20 7a5f 585f 6c69 6e65 735b 6959  Y], z_X_lines[iY
-000482a0: 2c69 585d 205d 290d 0a0d 0a20 2020 2020  ,iX] ])....     
-000482b0: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
-000482c0: 7261 6e67 6528 302c 6e75 6d62 5f58 5f6c  range(0,numb_X_l
-000482d0: 696e 6573 2920 3a0d 0a20 2020 2020 2020  ines) :..       
-000482e0: 2020 2020 2020 2020 2069 6e64 6963 6573           indices
-000482f0: 5b69 5d20 3d20 5b4e 6f6e 655d 2a28 6e75  [i] = [None]*(nu
-00048300: 6d56 6572 7473 290d 0a20 2020 2020 2020  mVerts)..       
-00048310: 2020 2020 2020 2020 2066 6f72 206a 2069           for j i
-00048320: 6e20 7261 6e67 6528 6e75 6d56 6572 7473  n range(numVerts
-00048330: 2920 3a0d 0a20 2020 2020 2020 2020 2020  ) :..           
-00048340: 2020 2020 2020 2020 2069 6e64 6963 6573           indices
-00048350: 5b69 5d5b 6a5d 203d 2069 6e64 6578 0d0a  [i][j] = index..
-00048360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00048370: 2020 2020 696e 6465 7820 2b3d 2031 0d0a      index += 1..
-00048380: 0d0a 2020 2020 2020 2020 6966 2079 7361  ..        if ysa
-00048390: 6d70 6c65 7320 6973 206e 6f74 204e 6f6e  mples is not Non
-000483a0: 6520 3a0d 0a20 2020 2020 2020 2020 2020  e :..           
-000483b0: 206c 696e 6556 6572 7473 5074 7320 3d20   lineVertsPts = 
-000483c0: 6e70 2e6c 696e 7370 6163 6528 646f 6d61  np.linspace(doma
-000483d0: 696e 5b27 786d 696e 275d 2c20 646f 6d61  in['xmin'], doma
-000483e0: 696e 5b27 786d 6178 275d 2c20 6e75 6d56  in['xmax'], numV
-000483f0: 6572 7473 2029 0d0a 2020 2020 2020 2020  erts )..        
-00048400: 2020 2020 795f 6c69 6e65 5665 7274 7350      y_lineVertsP
-00048410: 7473 203d 206e 702e 6c69 6e73 7061 6365  ts = np.linspace
-00048420: 2864 6f6d 6169 6e5b 2779 6d69 6e27 5d2c  (domain['ymin'],
-00048430: 2064 6f6d 6169 6e5b 2779 6d61 7827 5d2c   domain['ymax'],
-00048440: 206e 756d 625f 595f 6c69 6e65 7320 290d   numb_Y_lines ).
-00048450: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00048460: 7973 616d 706c 6573 203d 3d20 3120 3a20  ysamples == 1 : 
-00048470: 795f 6c69 6e65 5665 7274 7350 7473 203d  y_lineVertsPts =
-00048480: 206e 702e 6173 6172 7261 7928 5b30 2e30   np.asarray([0.0
-00048490: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
-000484a0: 7a5f 595f 6c69 6e65 7320 3d20 6728 6c69  z_Y_lines = g(li
-000484b0: 6e65 5665 7274 7350 7473 2c79 5f6c 696e  neVertsPts,y_lin
-000484c0: 6556 6572 7473 5074 7329 0d0a 0d0a 2020  eVertsPts)....  
-000484d0: 2020 2020 2020 2020 2020 666f 7220 6959            for iY
-000484e0: 2069 6e20 7261 6e67 6528 6e75 6d62 5f59   in range(numb_Y
-000484f0: 5f6c 696e 6573 2920 3a0d 0a20 2020 2020  _lines) :..     
-00048500: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
-00048510: 5820 696e 2072 616e 6765 286e 756d 5665  X in range(numVe
-00048520: 7274 7329 203a 0d0a 2020 2020 2020 2020  rts) :..        
-00048530: 2020 2020 2020 2020 2020 2020 7665 7274              vert
-00048540: 732e 6170 7065 6e64 2820 5b20 206c 696e  s.append( [  lin
-00048550: 6556 6572 7473 5074 735b 6958 5d2c 2079  eVertsPts[iX], y
-00048560: 5f6c 696e 6556 6572 7473 5074 735b 6959  _lineVertsPts[iY
-00048570: 5d20 2c7a 5f59 5f6c 696e 6573 5b69 592c  ] ,z_Y_lines[iY,
-00048580: 6958 5d20 5d29 0d0a 0d0a 2020 2020 2020  iX] ])....      
-00048590: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
-000485a0: 616e 6765 286e 756d 625f 585f 6c69 6e65  ange(numb_X_line
-000485b0: 732c 6e75 6d62 5f58 5f6c 696e 6573 2b6e  s,numb_X_lines+n
-000485c0: 756d 625f 595f 6c69 6e65 7329 203a 0d0a  umb_Y_lines) :..
-000485d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000485e0: 696e 6469 6365 735b 695d 203d 205b 4e6f  indices[i] = [No
-000485f0: 6e65 5d2a 286e 756d 5665 7274 7329 0d0a  ne]*(numVerts)..
-00048600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00048610: 666f 7220 6a20 696e 2072 616e 6765 286e  for j in range(n
-00048620: 756d 5665 7274 7329 203a 0d0a 2020 2020  umVerts) :..    
-00048630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00048640: 696e 6469 6365 735b 695d 5b6a 5d20 3d20  indices[i][j] = 
-00048650: 696e 6465 780d 0a20 2020 2020 2020 2020  index..         
-00048660: 2020 2020 2020 2020 2020 2069 6e64 6578             index
-00048670: 202b 3d20 310d 0a20 2020 2020 2020 200d   += 1..        .
-00048680: 0a20 2020 2020 2020 2076 6572 7473 203d  .        verts =
-00048690: 206e 702e 6172 7261 7928 7665 7274 7329   np.array(verts)
-000486a0: 0d0a 0d0a 2020 2020 2020 2020 7265 7475  ....        retu
-000486b0: 726e 2076 6572 7473 2c20 696e 6469 6365  rn verts, indice
-000486c0: 730d 0a0d 0a20 2020 2064 6566 205f 6d61  s....    def _ma
-000486d0: 705f 7879 536c 6963 6528 7365 6c66 2c20  p_xySlice(self, 
-000486e0: 672c 202a 2a6b 6172 6773 2029 203a 2020  g, **kargs ) :  
-000486f0: 2020 2020 200d 0a20 2020 2020 2020 2078       ..        x
-00048700: 706c 616e 652c 2079 706c 616e 652c 2078  plane, yplane, x
-00048710: 7361 6d70 6c65 732c 2079 7361 6d70 6c65  samples, ysample
-00048720: 7320 3d20 4e6f 6e65 2c4e 6f6e 652c 4e6f  s = None,None,No
-00048730: 6e65 2c4e 6f6e 650d 0a20 2020 2020 2020  ne,None..       
-00048740: 2069 6620 2778 706c 616e 6527 2069 6e20   if 'xplane' in 
-00048750: 6b61 7267 7320 3a20 7870 6c61 6e65 203d  kargs : xplane =
-00048760: 206b 6172 6773 5b27 7870 6c61 6e65 275d   kargs['xplane']
-00048770: 0d0a 2020 2020 2020 2020 6966 2027 7970  ..        if 'yp
-00048780: 6c61 6e65 2720 696e 206b 6172 6773 203a  lane' in kargs :
-00048790: 2079 706c 616e 6520 3d20 6b61 7267 735b   yplane = kargs[
-000487a0: 2779 706c 616e 6527 5d0d 0a20 2020 2020  'yplane']..     
-000487b0: 2020 2069 6620 2778 7365 7427 2069 6e20     if 'xset' in 
-000487c0: 6b61 7267 7320 3a20 7873 616d 706c 6573  kargs : xsamples
-000487d0: 203d 206b 6172 6773 5b27 7873 6574 275d   = kargs['xset']
-000487e0: 0d0a 2020 2020 2020 2020 6966 2027 7973  ..        if 'ys
-000487f0: 6574 2720 696e 206b 6172 6773 203a 2079  et' in kargs : y
-00048800: 7361 6d70 6c65 7320 3d20 6b61 7267 735b  samples = kargs[
-00048810: 2779 7365 7427 5d0d 0a0d 0a20 2020 2020  'yset']....     
-00048820: 2020 2070 6c61 6e65 4e6f 726d 616c 203d     planeNormal =
-00048830: 204e 6f6e 6520 2023 2062 6f74 6820 7820   None  # both x 
-00048840: 616e 6420 7920 736c 6963 6520 706c 616e  and y slice plan
-00048850: 6573 2061 7265 2064 6566 696e 6564 2e0d  es are defined..
-00048860: 0a20 2020 2020 2020 2069 6620 2878 706c  .        if (xpl
-00048870: 616e 6520 6973 204e 6f6e 6529 2061 6e64  ane is None) and
-00048880: 2028 7873 616d 706c 6573 2069 7320 4e6f   (xsamples is No
-00048890: 6e65 2920 3a0d 0a20 2020 2020 2020 2020  ne) :..         
-000488a0: 2020 2070 6c61 6e65 4e6f 726d 616c 203d     planeNormal =
-000488b0: 205b 302c 312c 305d 2020 2320 6d75 7374   [0,1,0]  # must
-000488c0: 2062 6520 696e 2074 6865 2078 2d7a 2070   be in the x-z p
-000488d0: 6c61 6e65 0d0a 2020 2020 2020 2020 6966  lane..        if
-000488e0: 2028 7970 6c61 6e65 2069 7320 4e6f 6e65   (yplane is None
-000488f0: 2920 616e 6420 2879 7361 6d70 6c65 7320  ) and (ysamples 
-00048900: 6973 204e 6f6e 6529 203a 0d0a 2020 2020  is None) :..    
-00048910: 2020 2020 2020 2020 706c 616e 654e 6f72          planeNor
-00048920: 6d61 6c20 3d20 5b31 2c30 2c30 5d20 2023  mal = [1,0,0]  #
-00048930: 206d 7573 7420 6265 2069 6e20 7468 6520   must be in the 
-00048940: 792d 7a20 706c 616e 650d 0a0d 0a20 2020  y-z plane....   
-00048950: 2020 2020 2064 6f6d 6169 6e20 3d20 7b27       domain = {'
-00048960: 786d 696e 273a 2d31 2c20 2778 6d61 7827  xmin':-1, 'xmax'
-00048970: 3a31 2c20 2779 6d69 6e27 3a2d 312c 2027  :1, 'ymin':-1, '
-00048980: 796d 6178 273a 317d 0d0a 2020 2020 2020  ymax':1}..      
-00048990: 2020 6465 6620 6368 6563 6b41 7272 2820    def checkArr( 
-000489a0: 4120 2920 3a0d 0a20 2020 2020 2020 2020  A ) :..         
-000489b0: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-000489c0: 2841 2c28 6c69 7374 2c74 7570 6c65 2929  (A,(list,tuple))
-000489d0: 203a 2072 6574 7572 6e20 415b 305d 2c20   : return A[0], 
-000489e0: 415b 315d 0d0a 2020 2020 2020 2020 2020  A[1]..          
-000489f0: 2020 656c 7365 3a20 7265 7475 726e 202d    else: return -
-00048a00: 412c 410d 0a20 2020 2020 2020 2020 2020  A,A..           
-00048a10: 2020 2020 200d 0a20 2020 2020 2020 2069       ..        i
-00048a20: 6620 2778 6c69 6d27 2069 6e20 6b61 7267  f 'xlim' in karg
-00048a30: 7320 3a20 0d0a 2020 2020 2020 2020 2020  s : ..          
-00048a40: 2020 646f 6d61 696e 5b27 786d 696e 275d    domain['xmin']
-00048a50: 2c20 646f 6d61 696e 5b27 786d 6178 275d  , domain['xmax']
-00048a60: 203d 2063 6865 636b 4172 7228 6b61 7267   = checkArr(karg
-00048a70: 735b 2778 6c69 6d27 5d29 0d0a 2020 2020  s['xlim'])..    
-00048a80: 2020 2020 6966 2027 796c 696d 2720 696e      if 'ylim' in
-00048a90: 206b 6172 6773 203a 200d 0a20 2020 2020   kargs : ..     
-00048aa0: 2020 2020 2020 2064 6f6d 6169 6e5b 2779         domain['y
-00048ab0: 6d69 6e27 5d2c 2064 6f6d 6169 6e5b 2779  min'], domain['y
-00048ac0: 6d61 7827 5d20 3d20 6368 6563 6b41 7272  max'] = checkArr
-00048ad0: 286b 6172 6773 5b27 796c 696d 275d 290d  (kargs['ylim']).
-00048ae0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00048af0: 200d 0a20 2020 2020 2020 2023 202d 2d2d   ..        # ---
-00048b00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00048b10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00048b20: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
-00048b30: 6966 2028 2028 7873 616d 706c 6573 2069  if ( (xsamples i
-00048b40: 7320 4e6f 6e65 2061 6e64 2079 7361 6d70  s None and ysamp
-00048b50: 6c65 7320 6973 204e 6f6e 6529 2061 6e64  les is None) and
-00048b60: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
-00048b70: 2028 7870 6c61 6e65 2020 2069 7320 4e6f   (xplane   is No
-00048b80: 6e65 2061 6e64 2079 706c 616e 6520 2020  ne and yplane   
-00048b90: 6973 204e 6f6e 6529 2029 203a 2072 6574  is None) ) : ret
-00048ba0: 7572 6e20 7365 6c66 0d0a 0d0a 2020 2020  urn self....    
-00048bb0: 2020 2020 6e75 6d56 6572 7473 203d 2073      numVerts = s
-00048bc0: 656c 662e 6e75 6d53 6567 202b 2031 0d0a  elf.numSeg + 1..
-00048bd0: 2020 2020 2020 2020 7665 7274 5369 6e67          vertSing
-00048be0: 6c65 2c69 6e64 6963 6573 5369 6e67 6c65  le,indicesSingle
-00048bf0: 203d 2073 656c 662e 5f67 6574 536c 6963   = self._getSlic
-00048c00: 6528 672c 6e75 6d56 6572 7473 2c64 6f6d  e(g,numVerts,dom
-00048c10: 6169 6e2c 7870 6c61 6e65 2c20 7970 6c61  ain,xplane, ypla
-00048c20: 6e65 290d 0a20 2020 2020 2020 2076 6572  ne)..        ver
-00048c30: 7473 5365 742c 696e 6469 6365 7353 6574  tsSet,indicesSet
-00048c40: 203d 2073 656c 662e 5f67 6574 536c 6963   = self._getSlic
-00048c50: 6553 6574 2867 2c6e 756d 5665 7274 732c  eSet(g,numVerts,
-00048c60: 646f 6d61 696e 2c78 7361 6d70 6c65 732c  domain,xsamples,
-00048c70: 2079 7361 6d70 6c65 7329 0d0a 2020 2020   ysamples)..    
-00048c80: 2020 2020 0d0a 2020 2020 2020 2020 6966      ..        if
-00048c90: 2076 6572 7453 696e 676c 6520 6973 206e   vertSingle is n
-00048ca0: 6f74 204e 6f6e 6520 3a0d 0a20 2020 2020  ot None :..     
-00048cb0: 2020 2020 2020 2076 6572 7473 2c69 6e64         verts,ind
-00048cc0: 6963 6573 203d 2076 6572 7453 696e 676c  ices = vertSingl
-00048cd0: 652c 696e 6469 6365 7353 696e 676c 650d  e,indicesSingle.
-00048ce0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00048cf0: 7665 7274 7353 6574 2069 7320 6e6f 7420  vertsSet is not 
-00048d00: 4e6f 6e65 203a 0d0a 2020 2020 2020 2020  None :..        
-00048d10: 2020 2020 2020 2020 7374 6172 7449 6e64          startInd
-00048d20: 6578 203d 206c 656e 2876 6572 7473 290d  ex = len(verts).
-00048d30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00048d40: 2076 6572 7473 203d 206e 702e 636f 6e63   verts = np.conc
-00048d50: 6174 656e 6174 6528 2028 7665 7274 732c  atenate( (verts,
-00048d60: 7665 7274 7353 6574 292c 2061 7869 733d  vertsSet), axis=
-00048d70: 3029 0d0a 2020 2020 2020 2020 2020 2020  0)..            
-00048d80: 2020 2020 7368 6966 7465 6449 6e64 6963      shiftedIndic
-00048d90: 6573 5365 7420 3d20 205b 205b 2069 2b73  esSet =  [ [ i+s
-00048da0: 7461 7274 496e 6465 7820 666f 7220 6920  tartIndex for i 
-00048db0: 696e 206c 696e 6520 5d20 666f 7220 6c69  in line ] for li
-00048dc0: 6e65 2069 6e20 696e 6469 6365 7353 6574  ne in indicesSet
-00048dd0: 5d20 0d0a 2020 2020 2020 2020 2020 2020  ] ..            
-00048de0: 2020 2020 6e75 6d62 496e 6469 6365 5369      numbIndiceSi
-00048df0: 6e67 6c65 203d 206c 656e 2869 6e64 6963  ngle = len(indic
-00048e00: 6573 5369 6e67 6c65 290d 0a20 2020 2020  esSingle)..     
-00048e10: 2020 2020 2020 2020 2020 206e 756d 6249             numbI
-00048e20: 6e64 6963 6573 5365 7420 3d20 6c65 6e28  ndicesSet = len(
-00048e30: 7368 6966 7465 6449 6e64 6963 6573 5365  shiftedIndicesSe
-00048e40: 7429 0d0a 2020 2020 2020 2020 2020 2020  t)..            
-00048e50: 2020 2020 7465 6d70 203d 205b 4e6f 6e65      temp = [None
-00048e60: 5d2a 286e 756d 6249 6e64 6963 6553 696e  ]*(numbIndiceSin
-00048e70: 676c 6520 2b20 6e75 6d62 496e 6469 6365  gle + numbIndice
-00048e80: 7353 6574 290d 0a20 2020 2020 2020 2020  sSet)..         
-00048e90: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
-00048ea0: 7261 6e67 6528 6e75 6d62 496e 6469 6365  range(numbIndice
-00048eb0: 5369 6e67 6c65 2920 3a20 7465 6d70 5b69  Single) : temp[i
-00048ec0: 5d20 3d20 696e 6469 6365 7353 696e 676c  ] = indicesSingl
-00048ed0: 655b 695d 0d0a 2020 2020 2020 2020 2020  e[i]..          
-00048ee0: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
-00048ef0: 616e 6765 286e 756d 6249 6e64 6963 6573  ange(numbIndices
-00048f00: 5365 7429 203a 2074 656d 705b 692b 6e75  Set) : temp[i+nu
-00048f10: 6d62 496e 6469 6365 5369 6e67 6c65 5d20  mbIndiceSingle] 
-00048f20: 3d20 7368 6966 7465 6449 6e64 6963 6573  = shiftedIndices
-00048f30: 5365 745b 695d 0d0a 2020 2020 2020 2020  Set[i]..        
-00048f40: 2020 2020 2020 2020 696e 6469 6365 7320          indices 
-00048f50: 3d20 7465 6d70 0d0a 0d0a 2020 2020 2020  = temp....      
-00048f60: 2020 656c 7365 203a 200d 0a20 2020 2020    else : ..     
-00048f70: 2020 2020 2020 2076 6572 7473 2c69 6e64         verts,ind
-00048f80: 6963 6573 203d 2076 6572 7473 5365 742c  ices = vertsSet,
-00048f90: 696e 6469 6365 7353 6574 0d0a 0d0a 2020  indicesSet....  
-00048fa0: 2020 2020 2020 7365 6c66 2e6c 696e 6549        self.lineI
-00048fb0: 6e64 6963 6573 203d 2069 6e64 6963 6573  ndices = indices
-00048fc0: 0d0a 2020 2020 2020 2020 7365 6c66 2e76  ..        self.v
-00048fd0: 6572 7465 7843 6f6f 7220 3d20 7665 7274  ertexCoor = vert
-00048fe0: 730d 0a20 2020 2020 2020 2073 656c 662e  s..        self.
-00048ff0: 7365 676d 496e 6469 6365 7320 3d20 696e  segmIndices = in
-00049000: 6469 6365 730d 0a20 2020 2020 2020 2073  dices..        s
-00049010: 6567 7320 3d20 7365 6c66 2e5f 6765 745f  egs = self._get_
-00049020: 7365 676d 656e 7473 2820 7665 7274 732c  segments( verts,
-00049030: 2069 6e64 6963 6573 2020 290d 0a20 2020   indices  )..   
-00049040: 2020 2020 2073 656c 662e 7365 745f 7365       self.set_se
-00049050: 676d 656e 7473 2873 6567 7329 0d0a 2020  gments(segs)..  
-00049060: 2020 2020 2020 6966 206c 656e 2873 656c        if len(sel
-00049070: 662e 6765 745f 636f 6c6f 7228 2920 2920  f.get_color() ) 
-00049080: 3d3d 2031 203a 0d0a 2020 2020 2020 2020  == 1 :..        
-00049090: 2020 2020 6320 3d20 7365 6c66 2e67 6574      c = self.get
-000490a0: 5f63 6f6c 6f72 2829 5b30 5d0d 0a20 2020  _color()[0]..   
-000490b0: 2020 2020 2020 2020 2073 656c 662e 7365           self.se
-000490c0: 745f 636f 6c6f 7228 205b 635d 2a6c 656e  t_color( [c]*len
-000490d0: 2869 6e64 6963 6573 2920 2020 290d 0a20  (indices)   ).. 
-000490e0: 2020 2020 2020 2073 656c 662e 5f73 6574         self._set
-000490f0: 5f67 656f 6d65 7472 6963 5f62 6f75 6e64  _geometric_bound
-00049100: 7328 290d 0a20 2020 2020 2020 2073 656c  s()..        sel
-00049110: 662e 5f70 6c61 6e65 4e6f 726d 616c 203d  f._planeNormal =
-00049120: 2070 6c61 6e65 4e6f 726d 616c 0d0a 2020   planeNormal..  
-00049130: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00049140: 660d 0a0d 0a20 2020 2064 6566 206d 6170  f....    def map
-00049150: 5f78 7953 6c69 6365 5f66 726f 6d5f 6f70  _xySlice_from_op
-00049160: 2873 656c 662c 206f 7065 7261 7469 6f6e  (self, operation
-00049170: 2c20 2a2a 6b61 7267 7320 2920 3a0d 0a20  , **kargs ) :.. 
-00049180: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
-00049190: 2020 2020 5573 696e 6720 6120 6675 6e63      Using a func
-000491a0: 7469 6f6e 616c 206f 7065 7261 7469 6f6e  tional operation
-000491b0: 2c20 6c69 6e65 7320 6f66 207a 3d66 2878  , lines of z=f(x
-000491c0: 2920 6f72 207a 3d66 2879 2920 696e 2064  ) or z=f(y) in d
-000491d0: 6f6d 6169 6e20 2d31 2074 6f20 312e 0d0a  omain -1 to 1...
-000491e0: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-000491f0: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
-00049200: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
-00049210: 2020 6f70 6572 6174 696f 6e20 3a20 6675    operation : fu
-00049220: 6e63 7469 6f6e 206f 626a 6563 7420 0d0a  nction object ..
-00049230: 2020 2020 2020 2020 2020 2020 4675 6e63              Func
-00049240: 7469 6f6e 2074 6861 7420 7461 6b65 7320  tion that takes 
-00049250: 6f6e 6520 6172 6775 6d65 6e74 2c20 6120  one argument, a 
-00049260: 4e75 6d70 7920 666c 6f61 740d 0a20 2020  Numpy float..   
-00049270: 2020 2020 2020 2020 2033 2058 204e 2061           3 X N a
-00049280: 7272 6179 206f 6620 7879 7a20 636f 6f72  rray of xyz coor
-00049290: 6469 6e61 7465 7320 696e 2074 6865 2064  dinates in the d
-000492a0: 6f6d 6169 6e2e 0d0a 2020 2020 2020 2020  omain...        
-000492b0: 2020 2020 5468 6520 7265 7475 726e 2076      The return v
-000492c0: 616c 7565 2069 7320 6120 3320 5820 4e20  alue is a 3 X N 
-000492d0: 6172 7261 7920 6f66 2078 797a 2063 6f6f  array of xyz coo
-000492e0: 7264 696e 6174 6573 2e0d 0a0d 0a20 2020  rdinates.....   
-000492f0: 2020 2020 2078 706c 616e 6520 3a20 636f       xplane : co
-00049300: 6e74 6f75 7220 6174 2061 2063 6f6e 7374  ntour at a const
-00049310: 616e 7420 7661 6c75 6520 6f66 2078 3d78  ant value of x=x
-00049320: 706c 616e 650d 0a0d 0a20 2020 2020 2020  plane....       
-00049330: 2079 706c 616e 6520 3a20 636f 6e74 6f75   yplane : contou
-00049340: 7220 6174 2061 2063 6f6e 7374 616e 7420  r at a constant 
-00049350: 7661 6c75 6520 6f66 2079 3d78 706c 616e  value of y=xplan
-00049360: 650d 0a0d 0a20 2020 2020 2020 2078 7365  e....        xse
-00049370: 7420 3a20 2020 6e75 6d62 6572 206f 6620  t :   number of 
-00049380: 6576 656e 6c79 2073 7061 6365 6420 636f  evenly spaced co
-00049390: 6e74 6f75 7273 2c20 792d 6178 6973 206e  ntours, y-axis n
-000493a0: 6f72 6d61 6c20 706c 616e 650d 0a0d 0a20  ormal plane.... 
-000493b0: 2020 2020 2020 2079 7365 7420 3a20 2020         yset :   
-000493c0: 6e75 6d62 6572 206f 6620 6576 656e 6c79  number of evenly
-000493d0: 2073 7061 6365 6420 636f 6e74 6f75 7273   spaced contours
-000493e0: 2c20 782d 6178 6973 206e 6f72 6d61 6c20  , x-axis normal 
-000493f0: 706c 616e 650d 0a0d 0a20 2020 2020 2020  plane....       
-00049400: 2078 6c69 6d20 3a20 2020 5820 646f 6d61   xlim :   X doma
-00049410: 696e 206f 6620 6f70 6572 6174 696f 6e20  in of operation 
-00049420: 2820 6465 6661 756c 743a 205b 2d31 2c31  ( default: [-1,1
-00049430: 5d20 290d 0a0d 0a20 2020 2020 2020 2079  ] )....        y
-00049440: 6c69 6d20 3a20 2020 5920 646f 6d61 696e  lim :   Y domain
-00049450: 206f 6620 6f70 6572 6174 696f 6e20 2820   of operation ( 
-00049460: 6465 6661 756c 743a 205b 2d31 2c31 5d20  default: [-1,1] 
-00049470: 290d 0a0d 0a20 2020 2020 2020 2052 6574  )....        Ret
-00049480: 7572 6e73 0d0a 2020 2020 2020 2020 2d2d  urns..        --
-00049490: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2073  -----..        s
-000494a0: 656c 6620 3a20 5061 7261 6d65 7472 6963  elf : Parametric
-000494b0: 4c69 6e65 206f 626a 6563 740d 0a0d 0a20  Line object.... 
-000494c0: 2020 2020 2020 2022 2222 0d0a 0d0a 2020         """....  
-000494d0: 2020 2020 2020 6465 6620 7a56 616c 7565        def zValue
-000494e0: 5f67 656e 6572 6174 6f72 2878 4172 722c  _generator(xArr,
-000494f0: 2079 4172 722c 206f 7029 203a 0d0a 2020   yArr, op) :..  
-00049500: 2020 2020 2020 2020 2020 786c 656e 203d            xlen =
-00049510: 206c 656e 2878 4172 7229 0d0a 2020 2020   len(xArr)..    
-00049520: 2020 2020 2020 2020 796c 656e 203d 206c          ylen = l
-00049530: 656e 2879 4172 7229 0d0a 2020 2020 2020  en(yArr)..      
-00049540: 2020 2020 2020 7863 6f6c 203d 206e 702e        xcol = np.
-00049550: 7469 6c65 2820 5b31 2e30 2c30 2e30 2c30  tile( [1.0,0.0,0
-00049560: 2e30 5d2c 2028 786c 656e 2c31 2929 0d0a  .0], (xlen,1))..
-00049570: 2020 2020 2020 2020 2020 2020 7856 616c              xVal
-00049580: 203d 206e 702e 6d75 6c74 6970 6c79 2878   = np.multiply(x
-00049590: 636f 6c2e 542c 7841 7272 292e 540d 0a20  col.T,xArr).T.. 
-000495a0: 2020 2020 2020 2020 2020 2078 5661 6c33             xVal3
-000495b0: 203d 206e 702e 7469 6c65 2878 5661 6c2c   = np.tile(xVal,
-000495c0: 2028 796c 656e 2c31 2929 0d0a 2020 2020   (ylen,1))..    
-000495d0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-000495e0: 2020 2020 2020 7963 6f6c 203d 206e 702e        ycol = np.
-000495f0: 7469 6c65 2820 5b30 2e30 2c31 2e30 2c30  tile( [0.0,1.0,0
-00049600: 2e30 5d20 2c20 2879 6c65 6e2c 3129 290d  .0] , (ylen,1)).
-00049610: 0a20 2020 2020 2020 2020 2020 2079 5661  .            yVa
-00049620: 6c20 3d20 6e70 2e6d 756c 7469 706c 7928  l = np.multiply(
-00049630: 7963 6f6c 2e54 2c79 4172 7229 2e54 0d0a  ycol.T,yArr).T..
-00049640: 2020 2020 2020 2020 2020 2020 7956 616c              yVal
-00049650: 3320 3d20 6e70 2e72 6570 6561 7428 7956  3 = np.repeat(yV
-00049660: 616c 2c78 6c65 6e2c 6178 6973 3d30 290d  al,xlen,axis=0).
-00049670: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
-00049680: 2020 2020 2020 2020 2020 2070 7473 203d             pts =
-00049690: 2078 5661 6c33 202b 2079 5661 6c33 0d0a   xVal3 + yVal3..
-000496a0: 2020 2020 2020 2020 2020 2020 7074 7320              pts 
-000496b0: 3d20 6e70 2e72 6573 6861 7065 2870 7473  = np.reshape(pts
-000496c0: 2c28 786c 656e 2a79 6c65 6e2c 3329 290d  ,(xlen*ylen,3)).
-000496d0: 0a20 2020 2020 2020 2020 2020 2078 2c79  .            x,y
-000496e0: 2c7a 203d 206f 7028 7074 732e 5429 0d0a  ,z = op(pts.T)..
-000496f0: 2020 2020 2020 2020 2020 2020 7a20 3d20              z = 
-00049700: 6e70 2e72 6573 6861 7065 287a 2c28 796c  np.reshape(z,(yl
-00049710: 656e 2c78 6c65 6e29 290d 0a20 2020 2020  en,xlen))..     
-00049720: 2020 2020 2020 2023 2074 6865 2066 6f6c         # the fol
-00049730: 6c6f 7769 6e67 2c20 636f 6d70 656e 7361  lowing, compensa
-00049740: 7465 7320 666f 7220 696e 7465 7270 3264  tes for interp2d
-00049750: 2066 6f72 2064 6174 6167 7269 640d 0a20   for datagrid.. 
-00049760: 2020 2020 2020 2020 2020 2023 2077 6869             # whi
-00049770: 6368 2064 726f 7073 2074 6865 2066 6972  ch drops the fir
-00049780: 7374 2064 696d 656e 7369 6f6e 2c20 7365  st dimension, se
-00049790: 6520 5f67 6574 536c 6963 6520 0d0a 2020  e _getSlice ..  
-000497a0: 2020 2020 2020 2020 2020 6966 2079 6c65            if yle
-000497b0: 6e20 3d3d 2031 203a 207a 203d 207a 5b30  n == 1 : z = z[0
-000497c0: 5d0d 0a20 2020 2020 2020 2020 2020 2072  ]..            r
-000497d0: 6574 7572 6e20 7a0d 0a0d 0a20 2020 2020  eturn z....     
-000497e0: 2020 2064 6566 2067 2878 4172 722c 2079     def g(xArr, y
-000497f0: 4172 7229 203a 0d0a 2020 2020 2020 2020  Arr) :..        
-00049800: 2020 2020 7265 7475 726e 207a 5661 6c75      return zValu
-00049810: 655f 6765 6e65 7261 746f 7228 7841 7272  e_generator(xArr
-00049820: 2c20 7941 7272 2c20 6f70 6572 6174 696f  , yArr, operatio
-00049830: 6e29 0d0a 2020 2020 2020 2020 2320 2d2d  n)..        # --
-00049840: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00049850: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00049860: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-00049870: 206e 616d 6520 3d20 5f67 6574 4675 6e63   name = _getFunc
-00049880: 7469 6f6e 4e61 6d65 286f 7065 7261 7469  tionName(operati
-00049890: 6f6e 2c73 656c 662e 5f67 656f 6d4e 616d  on,self._geomNam
-000498a0: 6529 0d0a 2020 2020 2020 2020 6966 206e  e)..        if n
-000498b0: 616d 6520 6973 206e 6f74 204e 6f6e 6520  ame is not None 
-000498c0: 3a20 7365 6c66 2e5f 6765 6f6d 4e61 6d65  : self._geomName
-000498d0: 203d 206e 616d 650d 0a20 2020 2020 2020   = name..       
-000498e0: 2072 6574 7572 6e20 7365 6c66 2e5f 6d61   return self._ma
-000498f0: 705f 7879 536c 6963 6528 2067 2c20 2a2a  p_xySlice( g, **
-00049900: 6b61 7267 7320 2029 0d0a 0d0a 2020 2020  kargs  )....    
-00049910: 6465 6620 6d61 705f 7879 536c 6963 655f  def map_xySlice_
-00049920: 6672 6f6d 5f64 6174 6167 7269 6428 7365  from_datagrid(se
-00049930: 6c66 2c20 6461 7461 6772 6964 2c20 7363  lf, datagrid, sc
-00049940: 616c 653d 4e6f 6e65 2c20 2a2a 6b61 7267  ale=None, **karg
-00049950: 7320 2029 203a 0d0a 2020 2020 2020 2020  s  ) :..        
-00049960: 2222 220d 0a20 2020 2020 2020 2055 7369  """..        Usi
-00049970: 6e67 2061 2064 6174 6167 7269 642c 206c  ng a datagrid, l
-00049980: 696e 6573 206f 6620 7a3d 6628 7829 206f  ines of z=f(x) o
-00049990: 7220 7a3d 6628 7929 2069 6e20 646f 6d61  r z=f(y) in doma
-000499a0: 696e 205b 2d31 2c20 315d 0d0a 0d0a 2020  in [-1, 1]....  
-000499b0: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
-000499c0: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-000499d0: 2d2d 2d2d 0d0a 2020 2020 2020 2020 6461  ----..        da
-000499e0: 7461 6772 6964 203a 2032 4420 666c 6f61  tagrid : 2D floa
-000499f0: 7420 6172 7261 790d 0a0d 0a20 2020 2020  t array....     
-00049a00: 2020 2073 6361 6c65 3a20 6d75 6c74 6970     scale: multip
-00049a10: 6c69 6572 2066 6f72 2074 6865 205a 2064  lier for the Z d
-00049a20: 6972 6563 7469 6f6e 2e0d 0a0d 0a20 2020  irection.....   
-00049a30: 2020 2020 2078 706c 616e 6520 3a20 636f       xplane : co
-00049a40: 6e74 6f75 7220 6174 2061 2063 6f6e 7374  ntour at a const
-00049a50: 616e 7420 7661 6c75 6520 6f66 2078 3d78  ant value of x=x
-00049a60: 706c 616e 650d 0a0d 0a20 2020 2020 2020  plane....       
-00049a70: 2079 706c 616e 6520 3a20 636f 6e74 6f75   yplane : contou
-00049a80: 7220 6174 2061 2063 6f6e 7374 616e 7420  r at a constant 
-00049a90: 7661 6c75 6520 6f66 2079 3d78 706c 616e  value of y=xplan
-00049aa0: 650d 0a0d 0a20 2020 2020 2020 2078 7365  e....        xse
-00049ab0: 7420 3a20 2020 6e75 6d62 6572 206f 6620  t :   number of 
-00049ac0: 6576 656e 6c79 2073 7061 6365 6420 636f  evenly spaced co
-00049ad0: 6e74 6f75 7273 2c20 792d 6178 6973 206e  ntours, y-axis n
-00049ae0: 6f72 6d61 6c20 706c 616e 650d 0a0d 0a20  ormal plane.... 
-00049af0: 2020 2020 2020 2079 7365 7420 3a20 2020         yset :   
-00049b00: 6e75 6d62 6572 206f 6620 6576 656e 6c79  number of evenly
-00049b10: 2073 7061 6365 6420 636f 6e74 6f75 7273   spaced contours
-00049b20: 2c20 782d 6178 6973 206e 6f72 6d61 6c20  , x-axis normal 
-00049b30: 706c 616e 650d 0a0d 0a20 2020 2020 2020  plane....       
-00049b40: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
-00049b50: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
-00049b60: 2020 2073 656c 6620 3a20 5061 7261 6d65     self : Parame
-00049b70: 7472 6963 4c69 6e65 206f 626a 6563 740d  tricLine object.
-00049b80: 0a0d 0a20 2020 2020 2020 2022 2222 0d0a  ...        """..
-00049b90: 2020 2020 2020 2020 6966 2027 786c 696d          if 'xlim
-00049ba0: 2720 696e 206b 6172 6773 206f 7220 2779  ' in kargs or 'y
-00049bb0: 6c69 6d27 2069 6e20 6b61 7267 7320 3a0d  lim' in kargs :.
-00049bc0: 0a20 2020 2020 2020 2020 2020 2077 6172  .            war
-00049bd0: 6e69 6e67 732e 7761 726e 2827 786c 696d  nings.warn('xlim
-00049be0: 2061 6e64 2079 6c69 6d20 6172 6773 2066   and ylim args f
-00049bf0: 6f72 2044 6174 6167 7269 6420 7879 536c  or Datagrid xySl
-00049c00: 6963 6520 6e6f 7420 6176 6169 6c61 626c  ice not availabl
-00049c10: 652e 2729 0d0a 2020 2020 2020 2020 2020  e.')..          
-00049c20: 2020 7265 7475 726e 2073 656c 660d 0a20    return self.. 
-00049c30: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
-00049c40: 2020 2020 2064 6174 6120 3d20 6461 7461       data = data
-00049c50: 6772 6964 0d0a 2020 2020 2020 2020 646d  grid..        dm
-00049c60: 6178 203d 206e 702e 616d 6178 2864 6174  ax = np.amax(dat
-00049c70: 6167 7269 6429 0d0a 2020 2020 2020 2020  agrid)..        
-00049c80: 646d 696e 203d 206e 702e 616d 696e 2864  dmin = np.amin(d
-00049c90: 6174 6167 7269 6429 0d0a 2020 2020 2020  atagrid)..      
-00049ca0: 2020 6465 6c74 6120 3d20 646d 6178 2d64    delta = dmax-d
-00049cb0: 6d69 6e0d 0a20 2020 2020 2020 2064 6174  min..        dat
-00049cc0: 6120 3d20 2864 6174 6167 7269 6420 2d20  a = (datagrid - 
-00049cd0: 646d 696e 292f 6465 6c74 610d 0a20 2020  dmin)/delta..   
-00049ce0: 2020 2020 2078 6420 3d20 6e70 2e6c 696e       xd = np.lin
-00049cf0: 7370 6163 6528 2d31 2c20 312c 2064 6174  space(-1, 1, dat
-00049d00: 612e 7368 6170 655b 305d 2029 0d0a 2020  a.shape[0] )..  
-00049d10: 2020 2020 2020 7964 203d 206e 702e 6c69        yd = np.li
-00049d20: 6e73 7061 6365 282d 312c 2031 2c20 6461  nspace(-1, 1, da
-00049d30: 7461 2e73 6861 7065 5b31 5d20 290d 0a20  ta.shape[1] ).. 
-00049d40: 2020 2020 2020 2067 203d 2020 696e 7465         g =  inte
-00049d50: 7270 6f6c 6174 652e 696e 7465 7270 3264  rpolate.interp2d
-00049d60: 2879 642c 2078 642c 2064 6174 612c 206b  (yd, xd, data, k
-00049d70: 696e 643d 2763 7562 6963 2729 0d0a 0d0a  ind='cubic')....
-00049d80: 2020 2020 2020 2020 2320 2d2d 2d2d 2d2d          # ------
-00049d90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00049da0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00049db0: 2d2d 2d0d 0a20 2020 2020 2020 2073 656c  ---..        sel
-00049dc0: 662e 5f6d 6170 5f78 7953 6c69 6365 2820  f._map_xySlice( 
-00049dd0: 672c 202a 2a6b 6172 6773 2020 290d 0a20  g, **kargs  ).. 
-00049de0: 2020 2020 2020 2069 6620 7363 616c 6520         if scale 
-00049df0: 6973 206e 6f74 204e 6f6e 6520 3a20 0d0a  is not None : ..
-00049e00: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00049e10: 2e76 6572 7465 7843 6f6f 7220 3d20 6e70  .vertexCoor = np
-00049e20: 2e6d 756c 7469 706c 7928 7365 6c66 2e76  .multiply(self.v
-00049e30: 6572 7465 7843 6f6f 722c 5b31 2c31 2c73  ertexCoor,[1,1,s
-00049e40: 6361 6c65 5d29 0d0a 2020 2020 2020 2020  cale])..        
-00049e50: 2020 2020 696e 6469 6365 7320 3d20 7365      indices = se
-00049e60: 6c66 2e73 6567 6d49 6e64 6963 6573 0d0a  lf.segmIndices..
-00049e70: 2020 2020 2020 2020 2020 2020 7665 7274              vert
-00049e80: 733d 2073 656c 662e 7665 7274 6578 436f  s= self.vertexCo
-00049e90: 6f72 0d0a 2020 2020 2020 2020 2020 2020  or..            
-00049ea0: 7365 6773 203d 2073 656c 662e 5f67 6574  segs = self._get
-00049eb0: 5f73 6567 6d65 6e74 7328 2076 6572 7473  _segments( verts
-00049ec0: 2c20 696e 6469 6365 7320 2029 0d0a 2020  , indices  )..  
-00049ed0: 2020 2020 2020 2020 2020 7365 6c66 2e73            self.s
-00049ee0: 6574 5f73 6567 6d65 6e74 7328 7365 6773  et_segments(segs
-00049ef0: 290d 0a20 2020 2020 2020 2020 2020 200d  )..            .
-00049f00: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00049f10: 7365 6c66 0d0a 0d0a 2020 2020 6465 6620  self....    def 
-00049f20: 7363 616c 655f 6461 7461 6672 616d 6528  scale_dataframe(
-00049f30: 7365 6c66 2c58 2c59 2c5a 2920 3a20 0d0a  self,X,Y,Z) : ..
-00049f40: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
-00049f50: 2020 2020 204c 696e 6561 7220 7363 616c       Linear scal
-00049f60: 6520 616e 6420 7472 616e 736c 6174 6520  e and translate 
-00049f70: 7468 6520 6c69 6e65 732e 0d0a 0d0a 2020  the lines.....  
-00049f80: 2020 2020 2020 5573 6564 2066 6f72 2073        Used for s
-00049f90: 6361 6c69 6e67 2061 2067 656f 6d65 7472  caling a geometr
-00049fa0: 7920 6261 7365 6420 6f6e 2061 2064 6174  y based on a dat
-00049fb0: 6167 7269 642e 0d0a 0d0a 2020 2020 2020  agrid.....      
-00049fc0: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
-00049fd0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00049fe0: 0d0a 2020 2020 2020 2020 582c 2059 2c20  ..        X, Y, 
-00049ff0: 5a20 3a20 3264 2061 7272 6179 730d 0a20  Z : 2d arrays.. 
-0004a000: 2020 2020 2020 2020 2020 204d 696e 696d             Minim
-0004a010: 756d 2061 6e64 206d 6178 696d 756d 2076  um and maximum v
-0004a020: 616c 7565 7320 6f66 2074 6865 2061 7272  alues of the arr
-0004a030: 6179 7320 6172 6520 7573 6564 2074 6f20  ays are used to 
-0004a040: 7363 616c 650d 0a20 2020 2020 2020 2020  scale..         
-0004a050: 2020 2061 6e64 2074 7261 6e73 6c61 7465     and translate
-0004a060: 2074 6865 2073 7572 6661 6365 2066 726f   the surface fro
-0004a070: 6d20 616e 2069 6e74 6961 6c20 646f 6d61  m an intial doma
-0004a080: 696e 206f 660d 0a20 2020 2020 2020 2020  in of..         
-0004a090: 2020 205b 2028 2d31 2c31 292c 2028 2d31     [ (-1,1), (-1
-0004a0a0: 2c31 292c 2028 302c 3129 205d 0d0a 0d0a  ,1), (0,1) ]....
-0004a0b0: 2020 2020 2020 2020 5265 7475 726e 730d          Returns.
-0004a0c0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0004a0d0: 0d0a 2020 2020 2020 2020 7365 6c66 203a  ..        self :
-0004a0e0: 2050 6172 616d 6574 7269 634c 696e 6520   ParametricLine 
-0004a0f0: 6f62 6a65 6374 0d0a 0d0a 2020 2020 2020  object....      
-0004a100: 2020 2222 220d 0a0d 0a20 2020 2020 2020    """....       
-0004a110: 2072 6574 7572 6e20 5f73 6361 6c65 5f64   return _scale_d
-0004a120: 6174 6166 7261 6d65 2873 656c 662c 582c  ataframe(self,X,
-0004a130: 592c 5a29 0d0a 0d0a 636c 6173 7320 5365  Y,Z)....class Se
-0004a140: 676d 656e 744c 696e 6528 436f 6c6f 724c  gmentLine(ColorL
-0004a150: 696e 6533 4443 6f6c 6c65 6374 696f 6e29  ine3DCollection)
-0004a160: 203a 0d0a 2020 2020 0d0a 2020 2020 6465   :..    ..    de
-0004a170: 6620 5f5f 696e 6974 5f5f 2820 7365 6c66  f __init__( self
-0004a180: 2c20 7665 7274 6578 436f 6f72 202c 206e  , vertexCoor , n
-0004a190: 616d 653d 4e6f 6e65 2c20 2a2a 6b77 6172  ame=None, **kwar
-0004a1a0: 6773 2029 203a 0d0a 2020 2020 2020 2020  gs ) :..        
-0004a1b0: 2222 220d 0a20 2020 2020 2020 2041 2073  """..        A s
-0004a1c0: 696e 676c 6520 6c69 6e65 206f 6620 7371  ingle line of sq
-0004a1d0: 7565 6e74 6961 6c20 7365 676d 656e 7473  uential segments
-0004a1e0: 2066 726f 6d20 616e 2061 7272 6179 206f   from an array o
-0004a1f0: 6620 7665 7274 6963 6573 2e0d 0a0d 0a20  f vertices..... 
-0004a200: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-0004a210: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
-0004a220: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2076  -----..        v
-0004a230: 6572 7465 7843 6f6f 7220 3a20 5620 7820  ertexCoor : V x 
-0004a240: 3320 6e75 6d65 7269 6361 6c20 6172 7261  3 numerical arra
-0004a250: 792d 6c69 6b65 2e20 0d0a 2020 2020 2020  y-like. ..      
-0004a260: 2020 2020 2020 416e 2061 7272 6179 206f        An array o
-0004a270: 6620 5620 6e75 6d62 6572 206f 6620 7879  f V number of xy
-0004a280: 7a20 7665 7274 6578 2063 6f6f 7264 696e  z vertex coordin
-0004a290: 6174 6573 2e0d 0a0d 0a20 2020 2020 2020  ates.....       
-0004a2a0: 206e 616d 6520 3a20 7374 7269 6e67 2c20   name : string, 
-0004a2b0: 6f70 7469 6f6e 616c 2c20 6465 6661 756c  optional, defaul
-0004a2c0: 743a 204e 6f6e 652e 0d0a 2020 2020 2020  t: None...      
-0004a2d0: 2020 2020 2020 4465 7363 7269 7074 6976        Descriptiv
-0004a2e0: 6520 6964 656e 7469 6669 6572 2e0d 0a20  e identifier... 
-0004a2f0: 2020 2020 2020 2020 2020 2020 2020 200d                 .
-0004a300: 0a20 2020 2020 2020 204f 7468 6572 2050  .        Other P
-0004a310: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
-0004a320: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
-0004a330: 2d2d 2d0d 0a20 2020 2020 2020 202a 2a6b  ---..        **k
-0004a340: 7761 7267 730d 0a20 2020 2020 2020 2020  wargs..         
-0004a350: 2020 2041 6c6c 206f 7468 6572 2070 6172     All other par
-0004a360: 616d 6574 6572 7320 6172 6520 7061 7373  ameters are pass
-0004a370: 6564 206f 6e20 746f 2027 7333 646c 6962  ed on to 's3dlib
-0004a380: 2e73 7572 6661 6365 2e43 6f6c 6f72 4c69  .surface.ColorLi
-0004a390: 6e65 3344 436f 6c6c 6563 7469 6f6e 272e  ne3DCollection'.
-0004a3a0: 0d0a 0d0a 2020 2020 2020 2020 2222 2220  ....        """ 
-0004a3b0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-0004a3c0: 6c69 6e65 203d 2076 6572 7465 7843 6f6f  line = vertexCoo
-0004a3d0: 7220 2023 203c 2d2d 2d20 7375 7065 7220  r  # <--- super 
-0004a3e0: 7769 6c6c 206d 616b 6520 7468 6973 2074  will make this t
-0004a3f0: 6f20 6120 6e75 6d70 7920 666c 6f61 7420  o a numpy float 
-0004a400: 6172 7261 790d 0a20 2020 2020 2020 2069  array..        i
-0004a410: 6e64 6963 6573 203d 205b 205b 2a72 616e  ndices = [ [*ran
-0004a420: 6765 286c 656e 286c 696e 6529 295d 205d  ge(len(line))] ]
-0004a430: 0d0a 2020 2020 2020 2020 7375 7065 7228  ..        super(
-0004a440: 292e 5f5f 696e 6974 5f5f 286c 696e 652c  ).__init__(line,
-0004a450: 2069 6e64 6963 6573 2c20 6e61 6d65 2c20   indices, name, 
-0004a460: 2a2a 6b77 6172 6773 290d 0a0d 0a0d 0a0d  **kwargs).......
-0004a470: 0a23 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  .# =============
-0004a480: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0004a490: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0004a4a0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0004a4b0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0004a4c0: 3d3d 3d3d 2b0d 0a23 2044 6576 4e6f 7465  ====+..# DevNote
-0004a4d0: 203a 2041 6c74 686f 7567 6820 5375 7266   : Although Surf
-0004a4e0: 6163 652c 2056 6563 746f 7220 616e 6420  ace, Vector and 
-0004a4f0: 4c69 6e65 2063 6f6c 6c65 6374 696f 6e20  Line collection 
-0004a500: 636c 6173 7365 7320 6861 7665 2073 696d  classes have sim
-0004a510: 696c 6172 2020 2020 2020 7c0d 0a23 2020  ilar      |..#  
-0004a520: 2020 2020 2020 2020 206d 6574 686f 6473           methods
-0004a530: 2028 6567 2e20 6d61 702e 2e2e 2c20 6e61   (eg. map..., na
-0004a540: 6d65 2c20 636c 6970 202e 2e29 2c20 6469  me, clip ..), di
-0004a550: 6666 6572 656e 6365 7320 616d 6f6e 6720  fferences among 
-0004a560: 7468 6573 6520 636c 6173 7365 7320 2020  these classes   
-0004a570: 7c0d 0a23 2020 2020 2020 2020 2020 2061  |..#           a
-0004a580: 7265 2073 7566 6669 6369 656e 746c 7920  re sufficiently 
-0004a590: 6469 6666 6572 656e 7420 746f 206e 6f74  different to not
-0004a5a0: 2077 6172 7261 6e74 2061 2063 6c61 7373   warrant a class
-0004a5b0: 2074 6861 7420 7468 6573 6520 7468 7265   that these thre
-0004a5c0: 6520 2020 2020 7c0d 0a23 2020 2020 2020  e     |..#      
-0004a5d0: 2020 2020 2063 6c61 7373 6573 2063 6f75       classes cou
-0004a5e0: 6c64 2075 7365 2077 6974 6820 6d75 6c74  ld use with mult
-0004a5f0: 6970 6c65 2069 6e68 6572 6974 656e 6365  iple inheritence
-0004a600: 2e20 2049 6e73 7465 6164 2c20 7468 6520  .  Instead, the 
-0004a610: 666f 6c6c 6f77 696e 6720 2020 7c0d 0a23  following   |..#
-0004a620: 2020 2020 2020 2020 2020 206d 6574 686f             metho
-0004a630: 6473 2061 7265 2063 6f6d 6d6f 6e20 616d  ds are common am
-0004a640: 6f6e 6720 7468 6573 6520 7468 7265 6520  ong these three 
-0004a650: 636c 6173 7365 732e 2020 2020 2020 2020  classes.        
-0004a660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004a670: 2020 7c0d 0a23 2020 2020 2020 2020 2020    |..#          
-0004a680: 2046 7574 4465 7620 6d61 7920 6265 2075   FutDev may be u
-0004a690: 7365 6675 6c20 746f 2064 6566 696e 6520  seful to define 
-0004a6a0: 7375 6368 2061 2063 6c61 7373 2c20 6275  such a class, bu
-0004a6b0: 7420 4d52 4f49 2e20 2020 2020 2020 2020  t MROI.         
-0004a6c0: 2020 2020 2020 2020 7c0d 0a23 203d 3d3d          |..# ===
-0004a6d0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0004a6e0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0004a6f0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0004a700: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0004a710: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 2b0d  ==============+.
-0004a720: 0a0d 0a63 6c61 7373 204b 5770 726f 6365  ...class KWproce
-0004a730: 7373 6f72 2829 3a0d 0a20 2020 2022 2222  ssor():..    """
-0004a740: 2020 4163 6365 7373 2076 616c 7565 7320    Access values 
-0004a750: 6672 6f6d 2064 6566 6175 6c74 7320 6f72  from defaults or
-0004a760: 206b 7761 7267 732e 2022 2222 0d0a 0d0a   kwargs. """....
-0004a770: 2020 2020 6465 6620 5f5f 696e 6974 5f5f      def __init__
-0004a780: 2873 656c 662c 7661 6c44 6963 742c 206d  (self,valDict, m
-0004a790: 6574 686f 6453 7472 3d4e 6f6e 652c 2063  ethodStr=None, c
-0004a7a0: 6865 636b 496e 7075 744b 6579 733d 5472  heckInputKeys=Tr
-0004a7b0: 7565 2c20 2a2a 6b61 7267 7329 203a 0d0a  ue, **kargs) :..
-0004a7c0: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
-0004a7d0: 2020 2020 2056 616c 6964 6174 6520 696e       Validate in
-0004a7e0: 7075 7420 6f66 2061 206d 6574 686f 6427  put of a method'
-0004a7f0: 7320 6b77 6172 6773 2e20 2049 6e74 6572  s kwargs.  Inter
-0004a800: 6e61 6c20 7573 6520 4f4e 4c59 2e0d 0a0d  nal use ONLY....
-0004a810: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-0004a820: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
-0004a830: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-0004a840: 2076 616c 4469 6374 203a 2064 6963 7469   valDict : dicti
-0004a850: 6f6e 6172 7920 6f66 2061 7267 756d 656e  onary of argumen
-0004a860: 7420 6e61 6d65 732c 2064 6566 6175 6c74  t names, default
-0004a870: 7320 616e 6420 7661 6c69 6420 7661 6c75  s and valid valu
-0004a880: 6573 2e0d 0a20 2020 2020 2020 2020 2020  es...           
-0004a890: 206b 6579 202d 2020 206b 6579 776f 7264   key -   keyword
-0004a8a0: 2061 7267 756d 656e 7420 6e61 6d65 0d0a   argument name..
-0004a8b0: 2020 2020 2020 2020 2020 2020 7661 6c75              valu
-0004a8c0: 6520 2d20 7369 6e67 6c65 2064 6566 6175  e - single defau
-0004a8d0: 6c74 2076 616c 7565 2c20 6f72 206c 6973  lt value, or lis
-0004a8e0: 7420 6f66 2032 4420 6c69 7374 7320 746f  t of 2D lists to
-0004a8f0: 2062 6520 7661 6c69 6461 7465 643a 0d0a   be validated:..
-0004a900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004a910: 2020 2020 4966 2061 206c 6973 7420 6f66      If a list of
-0004a920: 206c 6973 742c 2074 6865 2073 7472 7563   list, the struc
-0004a930: 7475 7265 2069 733a 0d0a 2020 2020 2020  ture is:..      
-0004a940: 2020 2020 2020 2020 2020 2020 2020 7661                va
-0004a950: 6c75 655b 305d 202d 205b 2764 6566 6175  lue[0] - ['defau
-0004a960: 6c74 2076 616c 7565 275d 2020 2020 3c2d  lt value']    <-
-0004a970: 2073 696e 676c 6520 7661 6c75 650d 0a20   single value.. 
-0004a980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004a990: 2020 2076 616c 7565 5b31 5d20 2d20 5b20     value[1] - [ 
-0004a9a0: 612c 2062 2c20 632c 202e 2e2e 2e2e 205d  a, b, c, ..... ]
-0004a9b0: 2020 203c 2d20 6c69 7374 206f 6620 6120     <- list of a 
-0004a9c0: 6c69 7374 206f 6620 7661 6c69 6420 7661  list of valid va
-0004a9d0: 6c75 6573 0d0a 0d0a 2020 2020 2020 2020  lues....        
-0004a9e0: 6d65 7468 6f64 5374 7220 3a20 7374 7269  methodStr : stri
-0004a9f0: 6e67 2c20 6f70 7469 6f6e 616c 2c20 6465  ng, optional, de
-0004aa00: 6661 756c 743a 204e 6f6e 650d 0a20 2020  fault: None..   
-0004aa10: 2020 2020 2020 2020 2049 6465 6e74 6966           Identif
-0004aa20: 6965 7220 6f66 2074 6865 206d 6574 686f  ier of the metho
-0004aa30: 6420 6361 6c6c 6564 2077 6865 7265 2061  d called where a
-0004aa40: 2076 616c 6964 6174 696f 6e20 6572 726f   validation erro
-0004aa50: 7220 6f63 6375 7265 640d 0a20 2020 2020  r occured..     
-0004aa60: 2020 2020 2020 2077 6869 6368 2069 7320         which is 
-0004aa70: 7368 6f77 6e20 696e 2074 6865 2065 7272  shown in the err
-0004aa80: 6f72 206d 6573 7361 6765 2e0d 0a0d 0a20  or message..... 
-0004aa90: 2020 2020 2020 2063 6865 636b 496e 7075         checkInpu
-0004aaa0: 744b 6579 7320 3a20 626f 6f6c 2c20 6465  tKeys : bool, de
-0004aab0: 6661 756c 743a 2054 7275 650d 0a20 2020  fault: True..   
-0004aac0: 2020 2020 2020 2020 2049 6620 5472 7565           If True
-0004aad0: 2c20 6368 6563 6b20 6966 2061 6c6c 206b  , check if all k
-0004aae0: 6172 6773 2061 7265 2069 6e20 7468 6520  args are in the 
-0004aaf0: 7661 6c44 6963 742e 0d0a 2020 2020 2020  valDict...      
-0004ab00: 2020 2020 2020 556e 6b6e 6f77 6e20 6b65        Unknown ke
-0004ab10: 7973 2077 696c 6c20 7072 6f64 7563 6520  ys will produce 
-0004ab20: 6120 5661 6c75 6545 7272 6f72 2e0d 0a20  a ValueError... 
-0004ab30: 2020 2020 2020 2020 2020 2049 6620 4661             If Fa
-0004ab40: 6c73 652c 2069 676e 6f72 6520 6b61 7267  lse, ignore karg
-0004ab50: 7320 6e6f 7420 696e 2076 616c 4469 6374  s not in valDict
-0004ab60: 2e0d 0a0d 0a20 2020 2020 2020 206b 6172  .....        kar
-0004ab70: 6773 203a 0d0a 2020 2020 2020 2020 2020  gs :..          
-0004ab80: 2020 5468 6520 6469 6374 696f 6e61 7279    The dictionary
-0004ab90: 206f 626a 6563 7420 636f 6e74 6169 6e69   object containi
-0004aba0: 6e67 2074 6865 2069 6e70 7574 206b 6579  ng the input key
-0004abb0: 776f 7264 3a76 616c 7565 7320 746f 2062  word:values to b
-0004abc0: 6520 6578 7472 6163 7465 642e 0d0a 0d0a  e extracted.....
-0004abd0: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
-0004abe0: 2020 2020 2023 2046 7574 4465 763a 2063       # FutDev: c
-0004abf0: 6f75 6c64 2075 7365 2061 2064 6963 7469  ould use a dicti
-0004ac00: 6f6e 6172 7920 666f 7220 7661 6c75 655b  onary for value[
-0004ac10: 315d 2074 6f20 7661 6c69 6461 7465 2072  1] to validate r
-0004ac20: 616e 6765 7320 616e 6420 7479 7065 732e  anges and types.
-0004ac30: 0d0a 2020 2020 2020 2020 7365 6c66 2e76  ..        self.v
-0004ac40: 616c 4469 6374 203d 2076 616c 4469 6374  alDict = valDict
-0004ac50: 0d0a 2020 2020 2020 2020 7365 6c66 2e6b  ..        self.k
-0004ac60: 6172 6773 203d 206b 6172 6773 0d0a 2020  args = kargs..  
-0004ac70: 2020 2020 2020 7365 6c66 2e6d 6574 686f        self.metho
-0004ac80: 6420 3d20 6d65 7468 6f64 5374 720d 0a20  d = methodStr.. 
-0004ac90: 2020 2020 2020 2069 6620 6368 6563 6b49         if checkI
-0004aca0: 6e70 7574 4b65 7973 203a 0d0a 2020 2020  nputKeys :..    
-0004acb0: 2020 2020 2020 2020 6966 206c 656e 286b          if len(k
-0004acc0: 6172 6773 2920 3d3d 2030 2020 2020 3a20  args) == 0    : 
-0004acd0: 7265 7475 726e 0d0a 2020 2020 2020 2020  return..        
-0004ace0: 2020 2020 6966 206c 656e 2876 616c 4469      if len(valDi
-0004acf0: 6374 2920 3d3d 2030 2020 3a20 7265 7475  ct) == 0  : retu
-0004ad00: 726e 0d0a 2020 2020 2020 2020 2020 2020  rn..            
-0004ad10: 6572 724d 7367 203d 2022 4b65 7977 6f72  errMsg = "Keywor
-0004ad20: 642c 207b 7d2c 2069 7320 6e6f 7420 7265  d, {}, is not re
-0004ad30: 636f 676e 697a 6564 2e20 5c6e 204c 6973  cognized. \n Lis
-0004ad40: 7420 6f66 2070 6f73 7369 626c 6520 6b65  t of possible ke
-0004ad50: 7973 2061 7265 3a20 7b7d 220d 0a20 2020  ys are: {}"..   
-0004ad60: 2020 2020 2020 2020 2069 6620 6d65 7468           if meth
-0004ad70: 6f64 5374 7220 6973 206e 6f74 204e 6f6e  odStr is not Non
-0004ad80: 6520 3a20 6572 724d 7367 203d 2027 5b27  e : errMsg = '['
-0004ad90: 2b6d 6574 686f 6453 7472 2b27 5d20 2d20  +methodStr+'] - 
-0004ada0: 2720 2b20 6572 724d 7367 0d0a 2020 2020  ' + errMsg..    
-0004adb0: 2020 2020 2020 2020 666f 7220 6b65 7920          for key 
-0004adc0: 696e 206b 6172 6773 2e6b 6579 7328 2920  in kargs.keys() 
-0004add0: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
-0004ade0: 2020 2020 6966 206e 6f74 206b 6579 2069      if not key i
-0004adf0: 6e20 7661 6c44 6963 742e 6b65 7973 2829  n valDict.keys()
-0004ae00: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
-0004ae10: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-0004ae20: 6c75 6545 7272 6f72 2820 6572 724d 7367  lueError( errMsg
-0004ae30: 2e66 6f72 6d61 7428 6b65 792c 206c 6973  .format(key, lis
-0004ae40: 7428 7661 6c44 6963 742e 6b65 7973 2829  t(valDict.keys()
-0004ae50: 2920 2029 2029 0d0a 2020 2020 2020 2020  )  ) )..        
-0004ae60: 7265 7475 726e 2020 2020 0d0a 0d0a 2020  return    ....  
-0004ae70: 2020 6465 6620 5f64 6566 5661 6c28 7365    def _defVal(se
-0004ae80: 6c66 2c76 2920 3a0d 0a20 2020 2020 2020  lf,v) :..       
-0004ae90: 2076 616c 7565 203d 2073 656c 662e 7661   value = self.va
-0004aea0: 6c44 6963 745b 765d 0d0a 2020 2020 2020  lDict[v]..      
-0004aeb0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-0004aec0: 7661 6c75 652c 6c69 7374 2920 3a0d 0a20  value,list) :.. 
-0004aed0: 2020 2020 2020 2020 2020 2066 6972 7374             first
-0004aee0: 5661 6c20 3d20 7661 6c75 655b 305d 0d0a  Val = value[0]..
-0004aef0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0004af00: 726e 2066 6972 7374 5661 6c5b 305d 2069  rn firstVal[0] i
-0004af10: 6620 6973 696e 7374 616e 6365 2866 6972  f isinstance(fir
-0004af20: 7374 5661 6c2c 286c 6973 742c 7475 706c  stVal,(list,tupl
-0004af30: 6529 2920 656c 7365 2076 616c 7565 0d0a  e)) else value..
-0004af40: 2020 2020 2020 2020 7265 7475 726e 2076          return v
-0004af50: 616c 7565 0d0a 0d0a 2020 2020 6465 6620  alue....    def 
-0004af60: 5f76 616c 7565 4b65 7977 6f72 6445 7272  _valueKeywordErr
-0004af70: 6f72 2873 656c 662c 6b65 7953 7472 2c75  or(self,keyStr,u
-0004af80: 7372 5661 6c29 203a 0d0a 2020 2020 2020  srVal) :..      
-0004af90: 2020 6469 6356 616c 203d 2073 656c 662e    dicVal = self.
-0004afa0: 7661 6c44 6963 745b 6b65 7953 7472 5d0d  valDict[keyStr].
-0004afb0: 0a20 2020 2020 2020 2065 7272 4c69 7374  .        errList
-0004afc0: 203d 2064 6963 5661 6c5b 315d 0d0a 2020   = dicVal[1]..  
-0004afd0: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
-0004afe0: 616e 6765 2832 2c6c 656e 2864 6963 5661  ange(2,len(dicVa
-0004aff0: 6c29 2029 203a 2065 7272 4c69 7374 202b  l) ) : errList +
-0004b000: 3d20 6469 6356 616c 5b69 5d20 0d0a 2020  = dicVal[i] ..  
-0004b010: 2020 2020 2020 6572 7241 203d 2022 4b65        errA = "Ke
-0004b020: 7977 6f72 642c 207b 7d2c 2076 616c 7565  yword, {}, value
-0004b030: 206f 6620 7b7d 2069 7320 6e6f 7420 7265   of {} is not re
-0004b040: 636f 676e 697a 6564 2e5c 6e20 4c69 7374  cognized.\n List
-0004b050: 206f 6620 706f 7373 6962 6c65 2076 616c   of possible val
-0004b060: 7565 7320 6172 653a 207b 7d22 0d0a 2020  ues are: {}"..  
-0004b070: 2020 2020 2020 6572 7242 203d 2022 4b65        errB = "Ke
-0004b080: 7977 6f72 642c 207b 7d2c 2076 616c 7565  yword, {}, value
-0004b090: 206f 6620 277b 7d27 2069 7320 6e6f 7420   of '{}' is not 
-0004b0a0: 7265 636f 676e 697a 6564 2e5c 6e20 4c69  recognized.\n Li
-0004b0b0: 7374 206f 6620 706f 7373 6962 6c65 2076  st of possible v
-0004b0c0: 616c 7565 7320 6172 653a 207b 7d22 200d  alues are: {}" .
-0004b0d0: 0a20 2020 2020 2020 2065 7272 5374 7220  .        errStr 
-0004b0e0: 3d20 2065 7272 4220 6966 2069 7369 6e73  =  errB if isins
-0004b0f0: 7461 6e63 6528 7573 7256 616c 2c73 7472  tance(usrVal,str
-0004b100: 2920 656c 7365 2065 7272 4120 2020 2020  ) else errA     
-0004b110: 200d 0a20 2020 2020 2020 2069 6620 7365   ..        if se
-0004b120: 6c66 2e6d 6574 686f 6420 6973 206e 6f74  lf.method is not
-0004b130: 204e 6f6e 6520 3a20 6572 7253 7472 203d   None : errStr =
-0004b140: 2027 5b27 2b73 656c 662e 6d65 7468 6f64   '['+self.method
-0004b150: 2b27 5d20 2d20 2720 2b20 6572 7253 7472  +'] - ' + errStr
-0004b160: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-0004b170: 2065 7272 5374 722e 666f 726d 6174 286b   errStr.format(k
-0004b180: 6579 5374 722c 7374 7228 7573 7256 616c  eyStr,str(usrVal
-0004b190: 292c 6572 724c 6973 7429 0d0a 2020 2020  ),errList)..    
-0004b1a0: 2020 2020 0d0a 2020 2020 6465 6620 6765      ..    def ge
-0004b1b0: 7456 616c 2873 656c 662c 6b65 7953 7472  tVal(self,keyStr
-0004b1c0: 2c63 6865 636b 5661 6c69 6469 7479 3d54  ,checkValidity=T
-0004b1d0: 7275 6529 2020 3a0d 0a20 2020 2020 2020  rue)  :..       
-0004b1e0: 2022 2222 0d0a 2020 2020 2020 2020 5265   """..        Re
-0004b1f0: 7475 726e 2074 6865 206e 616d 6564 2061  turn the named a
-0004b200: 7267 756d 656e 7420 7661 6c75 652e 0d0a  rgument value...
-0004b210: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-0004b220: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
-0004b230: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
-0004b240: 2020 6b65 7953 7472 203a 2073 7472 696e    keyStr : strin
-0004b250: 672e 204b 6579 776f 7264 0d0a 0d0a 2020  g. Keyword....  
-0004b260: 2020 2020 2020 6368 6563 6b56 616c 6964        checkValid
-0004b270: 6974 7920 3a20 626f 6f6c 2c20 6f70 7469  ity : bool, opti
-0004b280: 6f6e 616c 2c20 6465 6661 756c 743a 2054  onal, default: T
-0004b290: 7275 650d 0a20 2020 2020 2020 2020 2020  rue..           
-0004b2a0: 2049 6620 5472 7565 2c20 6b61 7267 2076   If True, karg v
-0004b2b0: 616c 7565 2069 7320 6368 6563 6b65 6420  alue is checked 
-0004b2c0: 746f 2062 6520 7661 6c69 640d 0a20 2020  to be valid..   
-0004b2d0: 2020 2020 2020 2020 2061 6d6f 6e67 2074           among t
-0004b2e0: 6865 206c 6973 7420 6f66 2076 616c 6964  he list of valid
-0004b2f0: 2076 616c 7565 732e 0d0a 0d0a 2020 2020   values.....    
-0004b300: 2020 2020 5261 6973 6573 0d0a 2020 2020      Raises..    
-0004b310: 2020 2020 2d2d 2d2d 2d2d 0d0a 2020 2020      ------..    
-0004b320: 2020 2020 5661 6c75 6545 7272 6f72 0d0a      ValueError..
-0004b330: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-0004b340: 6e76 616c 6964 206b 6579 776f 7264 2061  nvalid keyword a
-0004b350: 7373 6967 6e6d 656e 742e 0d0a 0d0a 2020  ssignment.....  
-0004b360: 2020 2020 2020 5265 7475 726e 730d 0a20        Returns.. 
-0004b370: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0d0a         -------..
-0004b380: 2020 2020 2020 2020 2020 2020 7661 6c75              valu
-0004b390: 6520 6f66 206b 6579 776f 7264 2c20 6f72  e of keyword, or
-0004b3a0: 2074 6865 2064 6566 6175 6c74 2076 616c   the default val
-0004b3b0: 7565 2069 6620 7468 6520 6b65 7953 7472  ue if the keyStr
-0004b3c0: 2069 7320 6e6f 7420 666f 756e 6420 696e   is not found in
-0004b3d0: 206b 6172 6773 2e0d 0a0d 0a20 2020 2020   kargs.....     
-0004b3e0: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
-0004b3f0: 6465 6620 6c69 7374 4f66 4c69 7374 2876  def listOfList(v
-0004b400: 2920 3a0d 0a20 2020 2020 2020 2020 2020  ) :..           
-0004b410: 2069 6620 6e6f 7420 6973 696e 7374 616e   if not isinstan
-0004b420: 6365 2876 2c28 6c69 7374 2c74 7570 6c65  ce(v,(list,tuple
-0004b430: 2929 203a 2072 6574 7572 6e20 4661 6c73  )) : return Fals
-0004b440: 650d 0a20 2020 2020 2020 2020 2020 2072  e..            r
-0004b450: 6574 7572 6e20 6973 696e 7374 616e 6365  eturn isinstance
-0004b460: 2876 5b30 5d2c 286c 6973 742c 7475 706c  (v[0],(list,tupl
-0004b470: 6529 2920 0d0a 2020 2020 2020 2020 6b61  e)) ..        ka
-0004b480: 7267 7320 3d20 7365 6c66 2e6b 6172 6773  rgs = self.kargs
-0004b490: 0d0a 2020 2020 2020 2020 6966 206c 656e  ..        if len
-0004b4a0: 286b 6172 6773 2920 3d3d 2030 203a 2072  (kargs) == 0 : r
-0004b4b0: 6574 7572 6e20 7365 6c66 2e5f 6465 6656  eturn self._defV
-0004b4c0: 616c 286b 6579 5374 7229 0d0a 2020 2020  al(keyStr)..    
-0004b4d0: 2020 2020 6966 206b 6579 5374 7220 6e6f      if keyStr no
-0004b4e0: 7420 696e 2073 656c 662e 7661 6c44 6963  t in self.valDic
-0004b4f0: 7420 3a20 2320 6f6e 6c79 2066 6f72 2064  t : # only for d
-0004b500: 6576 656c 6f70 6d65 6e74 2070 7572 706f  evelopment purpo
-0004b510: 7365 732e 0d0a 2020 2020 2020 2020 2020  ses...          
-0004b520: 2020 7072 696e 7428 2223 2323 2323 2323    print("#######
-0004b530: 2323 2323 2323 2323 2320 434f 4445 2045  ######### CODE E
-0004b540: 5252 4f52 204b 5730 3031 2023 2323 2323  RROR KW001 #####
-0004b550: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004b560: 2229 0d0a 2020 2020 2020 2020 2020 2020  ")..            
-0004b570: 7265 7475 726e 204e 6f6e 650d 0a20 2020  return None..   
-0004b580: 2020 2020 2069 6620 6b65 7953 7472 2069       if keyStr i
-0004b590: 6e20 6b61 7267 7320 3a20 0d0a 2020 2020  n kargs : ..    
-0004b5a0: 2020 2020 2020 2020 6469 6356 616c 203d          dicVal =
-0004b5b0: 2073 656c 662e 7661 6c44 6963 745b 6b65   self.valDict[ke
-0004b5c0: 7953 7472 5d0d 0a20 2020 2020 2020 2020  yStr]..         
-0004b5d0: 2020 2075 7372 5661 6c20 3d20 6b61 7267     usrVal = karg
-0004b5e0: 735b 6b65 7953 7472 5d0d 0a20 2020 2020  s[keyStr]..     
-0004b5f0: 2020 2020 2020 2069 6620 6c69 7374 4f66         if listOf
-0004b600: 4c69 7374 2864 6963 5661 6c29 203a 0d0a  List(dicVal) :..
-0004b610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004b620: 666f 7220 764c 7374 2069 6e20 6469 6356  for vLst in dicV
-0004b630: 616c 203a 0d0a 2020 2020 2020 2020 2020  al :..          
-0004b640: 2020 2020 2020 2020 2020 6966 2075 7372            if usr
-0004b650: 5661 6c20 696e 2073 6574 2876 4c73 7429  Val in set(vLst)
-0004b660: 203a 2072 6574 7572 6e20 764c 7374 5b30   : return vLst[0
-0004b670: 5d20 233c 3c20 7661 6c75 6520 6973 2074  ] #<< value is t
-0004b680: 6865 2066 6972 7374 2e0d 0a20 2020 2020  he first...     
-0004b690: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
-0004b6a0: 7420 6368 6563 6b56 616c 6964 6974 7920  t checkValidity 
-0004b6b0: 3a20 7265 7475 726e 2075 7372 5661 6c0d  : return usrVal.
-0004b6c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0004b6d0: 2065 6c73 6520 3a0d 0a20 2020 2020 2020   else :..       
-0004b6e0: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-0004b6f0: 7365 2056 616c 7565 4572 726f 7228 2073  se ValueError( s
-0004b700: 656c 662e 5f76 616c 7565 4b65 7977 6f72  elf._valueKeywor
-0004b710: 6445 7272 6f72 286b 6579 5374 722c 7573  dError(keyStr,us
-0004b720: 7256 616c 2929 0d0a 2020 2020 2020 2020  rVal))..        
-0004b730: 2020 2020 7265 7475 726e 2075 7372 5661      return usrVa
-0004b740: 6c0d 0a20 2020 2020 2020 2072 6574 7572  l..        retur
-0004b750: 6e20 7365 6c66 2e5f 6465 6656 616c 286b  n self._defVal(k
-0004b760: 6579 5374 7229 0d0a 0d0a 2020 2020 6465  eyStr)....    de
-0004b770: 6620 6669 6c74 6572 2873 656c 6629 3a0d  f filter(self):.
-0004b780: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
-0004b790: 2020 2020 2020 5265 6d6f 7665 7320 6465        Removes de
-0004b7a0: 6661 756c 7473 2066 726f 6d20 6b61 7267  faults from karg
-0004b7b0: 732e 0d0a 2020 2020 2020 2020 5573 6520  s...        Use 
-0004b7c0: 696d 706c 6965 7320 7468 6174 206d 6f72  implies that mor
-0004b7d0: 6520 7468 616e 2064 6566 6175 6c74 206b  e than default k
-0004b7e0: 6172 6773 2061 7265 2074 6f20 6265 2075  args are to be u
-0004b7f0: 7365 642c 0d0a 2020 2020 2020 2020 7468  sed,..        th
-0004b800: 7573 2027 6368 6563 6b49 6e70 7574 4b65  us 'checkInputKe
-0004b810: 7973 2720 7368 6f75 6c64 2062 6520 7365  ys' should be se
-0004b820: 7420 746f 2046 616c 7365 2061 7420 5f5f  t to False at __
-0004b830: 696e 6974 5f5f 2e0d 0a20 2020 2020 2020  init__...       
-0004b840: 2022 2222 0d0a 2020 2020 2020 2020 666f   """..        fo
-0004b850: 7220 6b65 7920 696e 2073 656c 662e 7661  r key in self.va
-0004b860: 6c44 6963 743a 0d0a 2020 2020 2020 2020  lDict:..        
-0004b870: 2020 2020 7472 7920 3a20 2020 6465 6c20      try :   del 
-0004b880: 7365 6c66 2e6b 6172 6773 5b20 6b65 7920  self.kargs[ key 
-0004b890: 5d0d 0a20 2020 2020 2020 2020 2020 2065  ]..            e
-0004b8a0: 7863 6570 743a 2070 6173 730d 0a20 2020  xcept: pass..   
-0004b8b0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0004b8c0: 2e6b 6172 6773 0d0a 0d0a 0d0a 2320 4675  .kargs......# Fu
-0004b8d0: 7444 6576 3a20 696e 636c 7564 6520 7472  tDev: include tr
-0004b8e0: 616e 7366 6f72 6d0d 0a0d 0a64 6566 205f  ansform....def _
-0004b8f0: 6178 6973 5553 4628 6178 6573 2920 3a0d  axisUSF(axes) :.
-0004b900: 0a20 2020 2023 2061 7869 7320 756e 6974  .    # axis unit
-0004b910: 2073 6361 6c65 2066 6163 746f 720d 0a20   scale factor.. 
-0004b920: 2020 2078 6c69 6d20 3d20 6178 6573 2e67     xlim = axes.g
-0004b930: 6574 5f78 6c69 6d28 290d 0a20 2020 2079  et_xlim()..    y
-0004b940: 6c69 6d20 3d20 6178 6573 2e67 6574 5f79  lim = axes.get_y
-0004b950: 6c69 6d28 290d 0a20 2020 207a 6c69 6d20  lim()..    zlim 
-0004b960: 3d20 6178 6573 2e67 6574 5f7a 6c69 6d28  = axes.get_zlim(
-0004b970: 290d 0a20 2020 2078 5220 3d20 786c 696d  )..    xR = xlim
-0004b980: 5b31 5d2d 786c 696d 5b30 5d0d 0a20 2020  [1]-xlim[0]..   
-0004b990: 2079 5220 3d20 796c 696d 5b31 5d2d 796c   yR = ylim[1]-yl
-0004b9a0: 696d 5b30 5d0d 0a20 2020 207a 5220 3d20  im[0]..    zR = 
-0004b9b0: 7a6c 696d 5b31 5d2d 7a6c 696d 5b30 5d0d  zlim[1]-zlim[0].
-0004b9c0: 0a20 2020 2073 6620 3d20 6e70 2e61 7272  .    sf = np.arr
-0004b9d0: 6179 285b 2079 522a 7a52 2c20 7852 2a7a  ay([ yR*zR, xR*z
-0004b9e0: 522c 2078 522a 7952 205d 290d 0a20 2020  R, xR*yR ])..   
-0004b9f0: 2072 6574 7572 6e20 7366 2f6e 702e 6c69   return sf/np.li
-0004ba00: 6e61 6c67 2e6e 6f72 6d28 7366 290d 0a0d  nalg.norm(sf)...
-0004ba10: 0a64 6566 205f 636f 6f72 5f64 6f74 7072  .def _coor_dotpr
-0004ba20: 6f64 2864 6972 6563 7469 6f6e 2c63 496e  od(direction,cIn
-0004ba30: 6465 782c 7265 6643 6f6f 7229 203a 0d0a  dex,refCoor) :..
-0004ba40: 2020 2020 2320 7265 6643 6f6f 7220 6d61      # refCoor ma
-0004ba50: 7920 6265 2076 6572 7465 7828 636f 6e74  y be vertex(cont
-0004ba60: 6f75 7273 2920 6f72 2066 6163 6528 636c  ours) or face(cl
-0004ba70: 6970 2920 636f 6f72 6469 6e61 7465 732e  ip) coordinates.
-0004ba80: 0d0a 2020 2020 2320 6465 7465 726d 696e  ..    # determin
-0004ba90: 6573 2074 6865 2064 6973 7461 6e63 6520  es the distance 
-0004baa0: 6672 6f6d 2074 6865 2072 6566 436f 6f72  from the refCoor
-0004bab0: 2070 6f69 6e74 7320 746f 2065 6974 6865   points to eithe
-0004bac0: 723a 0d0a 2020 2020 2320 2020 2030 2e20  r:..    #    0. 
-0004bad0: 6120 706c 616e 652c 2028 706c 616e 6172  a plane, (planar
-0004bae0: 2063 6f6f 7264 696e 6174 6573 290d 0a20   coordinates).. 
-0004baf0: 2020 2023 2020 2020 312e 2061 206c 696e     #    1. a lin
-0004bb00: 652c 2020 2863 796c 696e 6472 6963 616c  e,  (cylindrical
-0004bb10: 2063 6f6f 7264 696e 6174 6573 290d 0a20   coordinates).. 
-0004bb20: 2020 2023 2020 2020 322e 2061 2070 6f69     #    2. a poi
-0004bb30: 6e74 2c20 2873 7068 6572 6963 616c 2063  nt, (spherical c
-0004bb40: 6f6f 7264 696e 6174 6573 290d 0a20 2020  oordinates)..   
-0004bb50: 2023 2075 7365 6420 666f 7220 7375 7266   # used for surf
-0004bb60: 6163 6520 636f 6e74 6f75 7273 2028 7665  ace contours (ve
-0004bb70: 7274 6963 6573 292c 2073 7572 6661 6365  rtices), surface
-0004bb80: 2063 6c69 7070 696e 6720 2866 6163 6573   clipping (faces
-0004bb90: 290d 0a20 2020 2023 2061 6e64 206c 696e  )..    # and lin
-0004bba0: 6520 636c 6970 7069 6e67 2028 7665 7274  e clipping (vert
-0004bbb0: 6963 6573 292e 0d0a 2020 2020 7665 7274  ices)...    vert
-0004bbc0: 7320 3d20 7265 6643 6f6f 720d 0a20 2020  s = refCoor..   
-0004bbd0: 2069 6620 6349 6e64 6578 203d 3d20 3120   if cIndex == 1 
-0004bbe0: 3a20 2020 2020 2023 202e 2e2e 2e2e 2e2e  :      # .......
-0004bbf0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2063  .............. c
-0004bc00: 796c 696e 6472 6963 616c 0d0a 2020 2020  ylindrical..    
-0004bc10: 2020 2020 6966 2064 6972 6563 7469 6f6e      if direction
-0004bc20: 2069 7320 4e6f 6e65 203a 0d0a 2020 2020   is None :..    
-0004bc30: 2020 2020 2020 2020 646f 7470 726f 6420          dotprod 
-0004bc40: 3d20 6e70 2e6c 696e 616c 672e 6e6f 726d  = np.linalg.norm
-0004bc50: 2876 6572 7473 5b3a 2c3a 325d 2c61 7869  (verts[:,:2],axi
-0004bc60: 733d 3129 2020 2320 7a2d 6178 6973 2064  s=1)  # z-axis d
-0004bc70: 6566 6175 6c74 0d0a 2020 2020 2020 2020  efault..        
-0004bc80: 656c 7365 203a 0d0a 2020 2020 2020 2020  else :..        
-0004bc90: 2020 2020 756e 6974 4469 7265 6374 696f      unitDirectio
-0004bca0: 6e20 3d20 6e70 2e64 6976 6964 6528 2064  n = np.divide( d
-0004bcb0: 6972 6563 7469 6f6e 2c20 6e70 2e6c 696e  irection, np.lin
-0004bcc0: 616c 672e 6e6f 726d 2864 6972 6563 7469  alg.norm(directi
-0004bcd0: 6f6e 2920 290d 0a20 2020 2020 2020 2020  on) )..         
-0004bce0: 2020 2064 6d61 6720 3d20 6e70 2e64 6f74     dmag = np.dot
-0004bcf0: 2876 6572 7473 2c75 6e69 7444 6972 6563  (verts,unitDirec
-0004bd00: 7469 6f6e 290d 0a20 2020 2020 2020 2020  tion)..         
-0004bd10: 2020 2075 5665 6374 203d 206e 702e 7469     uVect = np.ti
-0004bd20: 6c65 2875 6e69 7444 6972 6563 7469 6f6e  le(unitDirection
-0004bd30: 2c28 6c65 6e28 646d 6167 292c 3129 2029  ,(len(dmag),1) )
-0004bd40: 0d0a 2020 2020 2020 2020 2020 2020 6456  ..            dV
-0004bd50: 6563 7420 3d20 6e70 2e61 7272 6179 285b  ect = np.array([
-0004bd60: 646d 6167 5d29 2e54 0d0a 2020 2020 2020  dmag]).T..      
-0004bd70: 2020 2020 2020 7a65 7461 203d 2076 6572        zeta = ver
-0004bd80: 7473 202d 2075 5665 6374 2a64 5665 6374  ts - uVect*dVect
-0004bd90: 0d0a 2020 2020 2020 2020 2020 2020 646f  ..            do
-0004bda0: 7470 726f 6420 3d20 6e70 2e6c 696e 616c  tprod = np.linal
-0004bdb0: 672e 6e6f 726d 287a 6574 612c 6178 6973  g.norm(zeta,axis
-0004bdc0: 3d31 2920 0d0a 2020 2020 656c 6966 2063  =1) ..    elif c
-0004bdd0: 496e 6465 7820 3d3d 2032 203a 2020 2020  Index == 2 :    
-0004bde0: 2320 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  # ..............
-0004bdf0: 2e2e 2e2e 2e2e 2e20 7370 6865 7269 6361  ....... spherica
-0004be00: 6c0d 0a20 2020 2020 2020 2064 6f74 7072  l..        dotpr
-0004be10: 6f64 203d 206e 702e 6c69 6e61 6c67 2e6e  od = np.linalg.n
-0004be20: 6f72 6d28 7665 7274 732c 6178 6973 3d31  orm(verts,axis=1
-0004be30: 2920 2020 2020 2020 2020 2020 0d0a 2020  )           ..  
-0004be40: 2020 656c 7365 203a 2020 2020 2020 2020    else :        
-0004be50: 2020 2020 2020 2020 2320 2e2e 2e2e 2e2e          # ......
-0004be60: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e20  ............... 
-0004be70: 706c 616e 6172 0d0a 2020 2020 2020 2020  planar..        
-0004be80: 6966 2064 6972 6563 7469 6f6e 2069 7320  if direction is 
-0004be90: 4e6f 6e65 203a 2064 6972 6563 7469 6f6e  None : direction
-0004bea0: 203d 205b 302c 302c 312e 305d 2020 2320   = [0,0,1.0]  # 
-0004beb0: 7879 2d70 6c61 6e65 2064 6566 6175 6c74  xy-plane default
-0004bec0: 0d0a 2020 2020 2020 2020 756e 6974 4469  ..        unitDi
-0004bed0: 7265 6374 696f 6e20 3d20 6e70 2e64 6976  rection = np.div
-0004bee0: 6964 6528 2064 6972 6563 7469 6f6e 2c20  ide( direction, 
-0004bef0: 6e70 2e6c 696e 616c 672e 6e6f 726d 2864  np.linalg.norm(d
-0004bf00: 6972 6563 7469 6f6e 2920 290d 0a20 2020  irection) )..   
-0004bf10: 2020 2020 2064 6f74 7072 6f64 203d 206e       dotprod = n
-0004bf20: 702e 646f 7428 7665 7274 732c 756e 6974  p.dot(verts,unit
-0004bf30: 4469 7265 6374 696f 6e29 0d0a 2020 2020  Direction)..    
-0004bf40: 7265 7475 726e 2064 6f74 7072 6f64 0d0a  return dotprod..
-0004bf50: 0d0a 6465 6620 5f67 6574 4675 6e63 7469  ..def _getFuncti
-0004bf60: 6f6e 4e61 6d65 286f 702c 784e 616d 653d  onName(op,xName=
-0004bf70: 4e6f 6e65 2920 3a0d 0a20 2020 2069 6620  None) :..    if 
-0004bf80: 784e 616d 6520 6973 206e 6f74 204e 6f6e  xName is not Non
-0004bf90: 6520 3a20 7265 7475 726e 2078 4e61 6d65  e : return xName
-0004bfa0: 0d0a 2020 2020 2320 6173 7369 676e 2066  ..    # assign f
-0004bfb0: 756e 6374 696f 6e20 6e61 6d65 2069 6620  unction name if 
-0004bfc0: 6e6f 7420 6120 6c61 6d62 6461 2066 756e  not a lambda fun
-0004bfd0: 6374 696f 6e0d 0a20 2020 2066 6f62 6172  ction..    fobar
-0004bfe0: 203d 206c 616d 6264 6120 7820 3a20 780d   = lambda x : x.
-0004bff0: 0a20 2020 2069 6620 6f70 2e5f 5f6e 616d  .    if op.__nam
-0004c000: 655f 5f20 213d 2066 6f62 6172 2e5f 5f6e  e__ != fobar.__n
-0004c010: 616d 655f 5f20 3a0d 0a20 2020 2020 2020  ame__ :..       
-0004c020: 206e 616d 6520 3d20 6f70 2e5f 5f6e 616d   name = op.__nam
-0004c030: 655f 5f0d 0a20 2020 2065 6c73 6520 3a0d  e__..    else :.
-0004c040: 0a20 2020 2020 2020 206e 616d 6520 3d20  .        name = 
-0004c050: 4e6f 6e65 0d0a 2020 2020 7265 7475 726e  None..    return
-0004c060: 206e 616d 650d 0a0d 0a64 6566 205f 7365   name....def _se
-0004c070: 745f 6765 6f6d 426f 756e 6473 2876 2c62  t_geomBounds(v,b
-0004c080: 6f75 6e64 7329 203a 0d0a 2020 2020 2222  ounds) :..    ""
-0004c090: 2253 6574 205f 626f 756e 6473 2064 6963  "Set _bounds dic
-0004c0a0: 7469 6f6e 6172 7920 7661 6c75 6573 2066  tionary values f
-0004c0b0: 726f 6d20 7665 7274 6578 2063 6f6f 7264  rom vertex coord
-0004c0c0: 696e 6174 6573 2e22 2222 0d0a 0d0a 2020  inates."""....  
-0004c0d0: 2020 2320 7620 3d20 7365 6c66 2e76 6572    # v = self.ver
-0004c0e0: 7465 7843 6f6f 720d 0a20 2020 2078 6c69  texCoor..    xli
-0004c0f0: 6d2c 796c 696d 2c7a 6c69 6d20 3d20 6e70  m,ylim,zlim = np
-0004c100: 2e74 7261 6e73 706f 7365 2820 5b6e 702e  .transpose( [np.
-0004c110: 616d 696e 2876 202c 6178 6973 3d30 292c  amin(v ,axis=0),
-0004c120: 206e 702e 616d 6178 2876 202c 6178 6973   np.amax(v ,axis
-0004c130: 3d30 2920 5d20 290d 0a20 2020 2062 6f75  =0) ] )..    bou
-0004c140: 6e64 735b 2778 6c69 6d27 5d20 3d20 786c  nds['xlim'] = xl
-0004c150: 696d 0d0a 2020 2020 626f 756e 6473 5b27  im..    bounds['
-0004c160: 796c 696d 275d 203d 2079 6c69 6d0d 0a20  ylim'] = ylim.. 
-0004c170: 2020 2062 6f75 6e64 735b 277a 6c69 6d27     bounds['zlim'
-0004c180: 5d20 3d20 7a6c 696d 0d0a 2020 2020 726d  ] = zlim..    rm
-0004c190: 6178 5f78 7920 3d20 206e 702e 616d 6178  ax_xy =  np.amax
-0004c1a0: 2820 6e70 2e6c 696e 616c 672e 6e6f 726d  ( np.linalg.norm
-0004c1b0: 2876 5b3a 2c30 3a32 5d2c 2061 7869 733d  (v[:,0:2], axis=
-0004c1c0: 3129 2029 0d0a 2020 2020 726d 696e 5f78  1) )..    rmin_x
-0004c1d0: 7920 3d20 206e 702e 616d 696e 2820 6e70  y =  np.amin( np
-0004c1e0: 2e6c 696e 616c 672e 6e6f 726d 2876 5b3a  .linalg.norm(v[:
-0004c1f0: 2c30 3a32 5d2c 2061 7869 733d 3129 2029  ,0:2], axis=1) )
-0004c200: 0d0a 2020 2020 626f 756e 6473 5b27 725f  ..    bounds['r_
-0004c210: 7879 275d 203d 205b 726d 696e 5f78 792c  xy'] = [rmin_xy,
-0004c220: 2072 6d61 785f 7879 205d 200d 0a20 2020   rmax_xy ] ..   
-0004c230: 2072 6d61 785f 7879 7a20 3d20 6e70 2e61   rmax_xyz = np.a
-0004c240: 6d61 7828 206e 702e 6c69 6e61 6c67 2e6e  max( np.linalg.n
-0004c250: 6f72 6d28 762c 2061 7869 733d 3129 2029  orm(v, axis=1) )
-0004c260: 0d0a 2020 2020 726d 696e 5f78 797a 203d  ..    rmin_xyz =
-0004c270: 206e 702e 616d 696e 2820 6e70 2e6c 696e   np.amin( np.lin
-0004c280: 616c 672e 6e6f 726d 2876 2c20 6178 6973  alg.norm(v, axis
-0004c290: 3d31 2920 290d 0a20 2020 2062 6f75 6e64  =1) )..    bound
-0004c2a0: 735b 2772 6f72 6727 5d20 3d20 5b72 6d69  s['rorg'] = [rmi
-0004c2b0: 6e5f 7879 7a2c 2072 6d61 785f 7879 7a20  n_xyz, rmax_xyz 
-0004c2c0: 5d20 0d0a 2020 2020 626f 756e 6473 5b27  ] ..    bounds['
-0004c2d0: 726c 696d 275d 203d 205b 726d 6178 5f78  rlim'] = [rmax_x
-0004c2e0: 792c 2072 6d61 785f 7879 7a20 5d20 2023  y, rmax_xyz ]  #
-0004c2f0: 202e 2e20 7665 7374 6967 616c 0d0a 2020   .. vestigal..  
-0004c300: 2020 7265 7475 726e 2020 2020 0d0a 0d0a    return    ....
-0004c310: 6465 6620 5f73 6361 6c65 5f64 6174 6166  def _scale_dataf
-0004c320: 7261 6d65 286f 626a 2c58 2c59 2c5a 2920  rame(obj,X,Y,Z) 
-0004c330: 3a0d 0a20 2020 2022 2222 0d0a 2020 2020  :..    """..    
-0004c340: 4c69 6e65 6172 2073 6361 6c65 2061 6e64  Linear scale and
-0004c350: 2074 7261 6e73 6c61 7465 2074 6865 2067   translate the g
-0004c360: 656f 6d65 7472 792e 0d0a 0d0a 2020 2020  eometry.....    
-0004c370: 5573 6564 2066 6f72 2073 6361 6c69 6e67  Used for scaling
-0004c380: 2061 2067 656f 6d65 7472 7920 6261 7365   a geometry base
-0004c390: 6420 6f6e 2061 2064 6174 6167 7269 642e  d on a datagrid.
-0004c3a0: 0d0a 0d0a 2020 2020 5061 7261 6d65 7465  ....    Paramete
-0004c3b0: 7273 0d0a 2020 2020 2d2d 2d2d 2d2d 2d2d  rs..    --------
-0004c3c0: 2d2d 0d0a 2020 2020 582c 2059 2c20 5a20  --..    X, Y, Z 
-0004c3d0: 3a20 3264 2061 7272 6179 730d 0a20 2020  : 2d arrays..   
-0004c3e0: 2020 2020 204d 696e 696d 756d 2061 6e64       Minimum and
-0004c3f0: 206d 6178 696d 756d 2076 616c 7565 7320   maximum values 
-0004c400: 6f66 2074 6865 2061 7272 6179 7320 6172  of the arrays ar
-0004c410: 6520 7573 6564 2074 6f20 7363 616c 650d  e used to scale.
-0004c420: 0a20 2020 2020 2020 2061 6e64 2074 7261  .        and tra
-0004c430: 6e73 6c61 7465 2074 6865 2073 7572 6661  nslate the surfa
-0004c440: 6365 2066 726f 6d20 616e 2069 6e74 6961  ce from an intia
-0004c450: 6c20 646f 6d61 696e 206f 660d 0a20 2020  l domain of..   
-0004c460: 2020 2020 205b 2028 2d31 2c31 292c 2028       [ (-1,1), (
-0004c470: 2d31 2c31 292c 2028 302c 3129 205d 0d0a  -1,1), (0,1) ]..
-0004c480: 0d0a 2020 2020 5265 7475 726e 730d 0a20  ..    Returns.. 
-0004c490: 2020 202d 2d2d 2d2d 2d2d 0d0a 2020 2020     -------..    
-0004c4a0: 6f62 6a20 3a20 2066 6972 7374 2063 616c  obj :  first cal
-0004c4b0: 6c69 6e67 2061 7267 756d 656e 742c 206f  ling argument, o
-0004c4c0: 626a 6563 7420 0d0a 0d0a 2020 2020 2222  bject ....    ""
-0004c4d0: 220d 0a0d 0a20 2020 2058 6d69 6e2c 2058  "....    Xmin, X
-0004c4e0: 6d61 7820 3d20 6e70 2e61 6d69 6e28 5829  max = np.amin(X)
-0004c4f0: 2c20 6e70 2e61 6d61 7828 5829 0d0a 2020  , np.amax(X)..  
-0004c500: 2020 596d 696e 2c20 596d 6178 203d 206e    Ymin, Ymax = n
-0004c510: 702e 616d 696e 2859 292c 206e 702e 616d  p.amin(Y), np.am
-0004c520: 6178 2859 290d 0a20 2020 205a 6d69 6e2c  ax(Y)..    Zmin,
-0004c530: 205a 6d61 7820 3d20 6e70 2e61 6d69 6e28   Zmax = np.amin(
-0004c540: 5a29 2c20 6e70 2e61 6d61 7828 5a29 0d0a  Z), np.amax(Z)..
-0004c550: 2020 2020 5873 6361 6c65 203d 2028 586d      Xscale = (Xm
-0004c560: 6178 2d58 6d69 6e29 2f32 0d0a 2020 2020  ax-Xmin)/2..    
-0004c570: 5830 203d 2028 586d 6178 2b58 6d69 6e29  X0 = (Xmax+Xmin)
-0004c580: 2f32 0d0a 2020 2020 5973 6361 6c65 203d  /2..    Yscale =
-0004c590: 2028 596d 6178 2d59 6d69 6e29 2f32 0d0a   (Ymax-Ymin)/2..
-0004c5a0: 2020 2020 5930 203d 2028 596d 6178 2b59      Y0 = (Ymax+Y
-0004c5b0: 6d69 6e29 2f32 0d0a 2020 2020 5a73 6361  min)/2..    Zsca
-0004c5c0: 6c65 203d 205a 6d61 782d 5a6d 696e 0d0a  le = Zmax-Zmin..
-0004c5d0: 2020 2020 5a30 203d 205a 6d69 6e0d 0a20      Z0 = Zmin.. 
-0004c5e0: 2020 206f 626a 2e74 7261 6e73 666f 726d     obj.transform
-0004c5f0: 2873 6361 6c65 3d5b 5873 6361 6c65 2c59  (scale=[Xscale,Y
-0004c600: 7363 616c 652c 5a73 6361 6c65 5d2c 7472  scale,Zscale],tr
-0004c610: 616e 736c 6174 653d 5b58 302c 5930 2c5a  anslate=[X0,Y0,Z
-0004c620: 305d 290d 0a20 2020 2072 6574 7572 6e20  0])..    return 
-0004c630: 6f62 6a0d 0a0d 0a64 6566 205f 7472 616e  obj....def _tran
-0004c640: 7366 6f72 6d41 7869 7328 7365 6c66 5072  sformAxis(selfPr
-0004c650: 6f70 2c20 6c65 6e6d 756c 743d 312e 302c  op, lenmult=1.0,
-0004c660: 2077 6964 7468 3d31 2e35 2c20 636f 6c6f   width=1.5, colo
-0004c670: 7273 3d4e 6f6e 652c 206e 6567 6178 6973  rs=None, negaxis
-0004c680: 3d54 7275 6529 203a 0d0a 2020 2020 2222  =True) :..    ""
-0004c690: 220d 0a20 2020 204c 696e 6533 4443 6f6c  "..    Line3DCol
-0004c6a0: 6c65 6374 696f 6e20 6f66 2061 2074 7261  lection of a tra
-0004c6b0: 6e73 666f 726d 6564 2063 6f6f 7264 696e  nsformed coordin
-0004c6c0: 6174 6520 6178 6973 2e0d 0a20 2020 200d  ate axis...    .
-0004c6d0: 0a20 2020 206a 7573 7420 7461 6b65 206d  .    just take m
-0004c6e0: 6574 686f 6420 6672 6f6d 2073 7572 6661  ethod from surfa
-0004c6f0: 6365 2076 6572 7369 6f6e 2031 2e30 2061  ce version 1.0 a
-0004c700: 6e64 2061 6c6c 6f77 2075 7365 2066 6f72  nd allow use for
-0004c710: 2061 6c6c 0d0a 2020 2020 6f74 6865 7220   all..    other 
-0004c720: 7472 616e 7366 6f72 6d61 626c 6520 6f62  transformable ob
-0004c730: 6a65 6374 732e 0d0a 2020 2020 4361 6c6c  jects...    Call
-0004c740: 6564 2066 726f 6d20 7468 6520 696e 7465  ed from the inte
-0004c750: 7266 6163 6520 6d65 7468 6f64 2067 6574  rface method get
-0004c760: 5f74 7261 6e73 666f 726d 4178 6973 0d0a  _transformAxis..
-0004c770: 2020 2020 0d0a 2020 2020 5265 7475 726e      ..    Return
-0004c780: 730d 0a20 2020 202d 2d2d 2d2d 2d2d 0d0a  s..    -------..
-0004c790: 2020 2020 4c69 6e65 3344 436f 6c6c 6563      Line3DCollec
-0004c7a0: 7469 6f6e 0d0a 0d0a 2020 2020 2222 220d  tion....    """.
-0004c7b0: 0a20 2020 2073 656c 665f 7363 616c 6520  .    self_scale 
-0004c7c0: 3d20 7365 6c66 5072 6f70 5b27 7363 616c  = selfProp['scal
-0004c7d0: 6527 5d0d 0a20 2020 2073 656c 665f 726f  e']..    self_ro
-0004c7e0: 7461 7469 6f6e 203d 2073 656c 6650 726f  tation = selfPro
-0004c7f0: 705b 2772 6f74 6174 696f 6e27 5d0d 0a20  p['rotation'].. 
-0004c800: 2020 2073 656c 665f 7472 616e 736c 6174     self_translat
-0004c810: 696f 6e20 3d20 7365 6c66 5072 6f70 5b27  ion = selfProp['
-0004c820: 7472 616e 736c 6174 696f 6e27 5d0d 0a20  translation'].. 
-0004c830: 2020 2073 6361 6c65 203d 206e 702e 6d75     scale = np.mu
-0004c840: 6c74 6970 6c79 286c 656e 6d75 6c74 2c73  ltiply(lenmult,s
-0004c850: 656c 665f 7363 616c 6529 0d0a 2020 2020  elf_scale)..    
-0004c860: 6444 656c 7461 203d 206e 702e 6d75 6c74  dDelta = np.mult
-0004c870: 6970 6c79 286e 702e 6964 656e 7469 7479  iply(np.identity
-0004c880: 2833 292e 746f 6c69 7374 2829 2c73 6361  (3).tolist(),sca
-0004c890: 6c65 292e 746f 6c69 7374 2829 0d0a 2020  le).tolist()..  
-0004c8a0: 2020 6e70 646f 7420 3d20 6e70 2e64 6f74    npdot = np.dot
-0004c8b0: 2864 4465 6c74 612c 7365 6c66 5f72 6f74  (dDelta,self_rot
-0004c8c0: 6174 696f 6e29 0d0a 2020 2020 6e70 646f  ation)..    npdo
-0004c8d0: 7432 203d 206e 702e 6578 7061 6e64 5f64  t2 = np.expand_d
-0004c8e0: 696d 7328 6e70 646f 742c 6178 6973 3d31  ims(npdot,axis=1
-0004c8f0: 290d 0a20 2020 2069 6620 6e65 6761 7869  )..    if negaxi
-0004c900: 7320 3a0d 0a20 2020 2020 2020 206c 696e  s :..        lin
-0004c910: 6573 203d 206e 702e 636f 6e63 6174 656e  es = np.concaten
-0004c920: 6174 6528 2028 6e70 646f 7432 2c2d 6e70  ate( (npdot2,-np
-0004c930: 646f 7432 292c 6178 6973 3d31 290d 0a20  dot2),axis=1).. 
-0004c940: 2020 2065 6c73 6520 3a0d 0a20 2020 2020     else :..     
-0004c950: 2020 206c 696e 6573 203d 206e 702e 696e     lines = np.in
-0004c960: 7365 7274 286e 7064 6f74 322c 302c 5b30  sert(npdot2,0,[0
-0004c970: 2c30 2c30 5d2c 6178 6973 3d31 290d 0a20  ,0,0],axis=1).. 
-0004c980: 2020 206c 696e 6573 203d 206e 702e 6164     lines = np.ad
-0004c990: 6428 6c69 6e65 732c 7365 6c66 5f74 7261  d(lines,self_tra
-0004c9a0: 6e73 6c61 7469 6f6e 290d 0a20 2020 2069  nslation)..    i
-0004c9b0: 6620 636f 6c6f 7273 2069 7320 4e6f 6e65  f colors is None
-0004c9c0: 203a 200d 0a20 2020 2020 2020 2063 6f6c   : ..        col
-0004c9d0: 6f72 4d61 7020 3d20 5b27 7227 2c27 6727  orMap = ['r','g'
-0004c9e0: 2c27 6227 5d0d 0a20 2020 2065 6c73 6520  ,'b']..    else 
-0004c9f0: 3a0d 0a20 2020 2020 2020 2063 6f6c 6f72  :..        color
-0004ca00: 4d61 7020 3d20 636f 6c6f 7273 0d0a 2020  Map = colors..  
-0004ca10: 2020 6178 6973 436f 6c20 3d20 4c69 6e65    axisCol = Line
-0004ca20: 3344 436f 6c6c 6563 7469 6f6e 286c 696e  3DCollection(lin
-0004ca30: 6573 2c20 636f 6c6f 7273 3d63 6f6c 6f72  es, colors=color
-0004ca40: 4d61 702c 206c 696e 6577 6964 7468 733d  Map, linewidths=
-0004ca50: 7769 6474 6829 0d0a 2020 2020 7265 7475  width)..    retu
-0004ca60: 726e 2061 7869 7343 6f6c 2020 2020 2020  rn axisCol      
-0004ca70: 0d0a 0d0a 6465 6620 5f6e 6f72 6d4c 656e  ....def _normLen
-0004ca80: 6774 6828 204e 2c20 6578 702c 2066 6163  gth( N, exp, fac
-0004ca90: 2c20 6c69 6d69 7461 7265 613d 4e6f 6e65  , limitarea=None
-0004caa0: 2920 3a0d 0a20 2020 2022 2222 0d0a 2020  ) :..    """..  
-0004cab0: 2020 4465 6661 756c 7420 6661 6365 206e    Default face n
-0004cac0: 6f72 6d61 6c20 7665 6374 6f72 206c 656e  ormal vector len
-0004cad0: 6774 682e 0d0a 2020 2020 0d0a 2020 2020  gth...    ..    
-0004cae0: 4c65 6e67 7468 2070 726f 706f 7274 696f  Length proportio
-0004caf0: 6e61 6c20 746f 2074 6865 206d 6561 6e20  nal to the mean 
-0004cb00: 7472 6961 6e67 756c 6174 6564 2066 6163  triangulated fac
-0004cb10: 6520 6564 6765 206c 656e 6774 682e 0d0a  e edge length...
-0004cb20: 2020 2020 2222 220d 0a20 2020 2069 6620      """..    if 
-0004cb30: 6c69 6d69 7461 7265 6120 6973 204e 6f6e  limitarea is Non
-0004cb40: 6520 3a20 6c69 6d69 7461 7265 6120 3d20  e : limitarea = 
-0004cb50: 342a 6e70 2e70 690d 0a20 2020 2023 2061  4*np.pi..    # a
-0004cb60: 7261 7469 6f20 2d20 6172 6561 2072 6174  ratio - area rat
-0004cb70: 696f 2061 7320 6120 6675 6e63 7469 6f6e  io as a function
-0004cb80: 206f 6620 7468 6520 6e75 6d62 6572 206f   of the number o
-0004cb90: 6620 6661 6365 732c 204e 2e0d 0a20 2020  f faces, N...   
-0004cba0: 2023 2068 6575 7269 7374 6963 2076 616c   # heuristic val
-0004cbb0: 7565 732c 2065 7870 2061 6e64 2066 6163  ues, exp and fac
-0004cbc0: 2c20 6172 6520 6164 6a75 7374 6d65 6e74  , are adjustment
-0004cbd0: 2066 6f72 2073 6d61 6c6c 2072 657a 2073   for small rez s
-0004cbe0: 7572 6661 6365 732c 0d0a 2020 2020 2320  urfaces,..    # 
-0004cbf0: 7769 7468 2061 7261 7469 6f20 6c69 6d69  with aratio limi
-0004cc00: 7420 746f 2031 2066 6f72 206c 6172 6765  t to 1 for large
-0004cc10: 204e 2e20 2863 6f6e 7469 6e75 6f75 7320   N. (continuous 
-0004cc20: 736d 6f6f 7468 2073 7572 6661 6365 290d  smooth surface).
-0004cc30: 0a20 2020 2061 7261 7469 6f20 3d20 312e  .    aratio = 1.
-0004cc40: 3020 2d20 6661 632a 6e70 2e70 6f77 6572  0 - fac*np.power
-0004cc50: 284e 2c2d 6578 7029 0d0a 2020 2020 7363  (N,-exp)..    sc
-0004cc60: 203d 2030 2e35 2a28 312e 3532 3029 2020   = 0.5*(1.520)  
-0004cc70: 2320 7363 616c 6520 6f66 206e 6f72 6d61  # scale of norma
-0004cc80: 6c69 7a65 6420 6564 6765 206c 656e 6774  lized edge lengt
-0004cc90: 680d 0a20 2020 206e 4c65 6e20 3d20 7363  h..    nLen = sc
-0004cca0: 2a6e 702e 7371 7274 2861 7261 7469 6f2a  *np.sqrt(aratio*
-0004ccb0: 6c69 6d69 7461 7265 612f 4e29 0d0a 2020  limitarea/N)..  
-0004ccc0: 2020 7265 7475 726e 206e 4c65 6e0d 0a0d    return nLen...
-0004ccd0: 0a0d 0a0d 0a23 203d 3d3d 3d3d 3d3d 3d3d  .....# =========
-0004cce0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0004ccf0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0004cd00: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0004cd10: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0004cd20: 3d3d 3d3d 3d3d 3d3d 2b0d 0a23 2055 7469  ========+..# Uti
-0004cd30: 6c69 7479 2046 756e 6374 696f 6e73 3a20  lity Functions: 
-0004cd40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004cd50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004cd60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004cd70: 2020 2020 2020 2020 2020 2020 2020 7c0d                |.
-0004cd80: 0a23 2055 7365 6675 6c20 666f 7220 636f  .# Useful for co
-0004cd90: 6e73 7472 7563 7469 6f6e 206f 6620 3344  nstruction of 3D
-0004cda0: 204d 6174 706c 6f74 6c69 6220 6669 6775   Matplotlib figu
-0004cdb0: 7265 7320 636f 6d70 6f73 6564 206f 6620  res composed of 
-0004cdc0: 5333 446c 6962 206f 626a 6563 7473 2e20  S3Dlib objects. 
-0004cdd0: 2020 2020 7c0d 0a23 203d 3d3d 3d3d 3d3d      |..# =======
-0004cde0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0004cdf0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0004ce00: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0004ce10: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0004ce20: 3d3d 3d3d 3d3d 3d3d 3d3d 2b0d 0a0d 0a64  ==========+....d
-0004ce30: 6566 2073 6574 7570 4178 6973 2861 7865  ef setupAxis(axe
-0004ce40: 732c 202a 2a6b 6172 6773 2029 203a 0d0a  s, **kargs ) :..
-0004ce50: 2020 2020 2222 220d 0a20 2020 2041 6464      """..    Add
-0004ce60: 2058 595a 206f 7269 6769 6e20 636f 6f72   XYZ origin coor
-0004ce70: 6469 6e61 7465 2061 7869 7320 5665 6374  dinate axis Vect
-0004ce80: 6f72 3344 436f 6c6c 6563 7469 6f6e 2074  or3DCollection t
-0004ce90: 6f20 7468 6520 6178 6573 2e0d 0a0d 0a20  o the axes..... 
-0004cea0: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
-0004ceb0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
-0004cec0: 2020 2061 7865 7320 3a20 4d61 7470 6c6f     axes : Matplo
-0004ced0: 746c 6962 2033 4420 6178 6573 206f 626a  tlib 3D axes obj
-0004cee0: 6563 742e 0d0a 0d0a 2020 2020 6c65 6e67  ect.....    leng
-0004cef0: 7468 2020 3a20 636f 6f72 6469 6e61 7465  th  : coordinate
-0004cf00: 2061 7869 7320 6c65 6e67 7468 2028 7369   axis length (si
-0004cf10: 6e67 6c65 206f 7220 332d 7661 6c75 6520  ngle or 3-value 
-0004cf20: 6c69 7374 292c 2064 6566 6175 6c74 3a20  list), default: 
-0004cf30: 312e 350d 0a0d 0a20 2020 2063 6f6c 6f72  1.5....    color
-0004cf40: 2020 203a 2061 7869 7320 636f 6c6f 7220     : axis color 
-0004cf50: 2873 696e 676c 6520 6f72 2033 2d76 616c  (single or 3-val
-0004cf60: 7565 206c 6973 7429 2c20 6465 6661 756c  ue list), defaul
-0004cf70: 743a 2027 626c 6163 6b27 0d0a 0d0a 2020  t: 'black'....  
-0004cf80: 2020 6f66 6673 6574 2020 3a20 6178 6973    offset  : axis
-0004cf90: 2076 6563 746f 7220 6f66 6673 6574 2066   vector offset f
-0004cfa0: 726f 6d20 7468 6520 6f72 6967 696e 2028  rom the origin (
-0004cfb0: 7369 6e67 6c65 206f 7220 332d 7661 6c75  single or 3-valu
-0004cfc0: 6520 6c69 7374 292c 2064 6566 6175 6c74  e list), default
-0004cfd0: 3a20 300d 0a0d 0a20 2020 206c 6162 656c  : 0....    label
-0004cfe0: 7320 203a 2061 7869 7320 6c61 6265 6c20  s  : axis label 
-0004cff0: 2873 696e 676c 6520 6f72 2033 2d76 616c  (single or 3-val
-0004d000: 7565 206c 6973 7429 2c20 6465 6661 756c  ue list), defaul
-0004d010: 743a 205b 2758 272c 2759 272c 275a 275d  t: ['X','Y','Z']
-0004d020: 0d0a 0d0a 2020 2020 7061 6420 2020 2020  ....    pad     
-0004d030: 3a20 6c61 6265 6c20 7061 6464 696e 6720  : label padding 
-0004d040: 6672 6f6d 2074 6865 2076 6563 746f 7220  from the vector 
-0004d050: 6178 6973 2068 6561 6420 2873 696e 676c  axis head (singl
-0004d060: 6520 6f72 2033 2d76 616c 7565 206c 6973  e or 3-value lis
-0004d070: 7429 2c20 6465 6661 756c 743a 2030 2e31  t), default: 0.1
-0004d080: 350d 0a0d 0a20 2020 2077 6964 7468 2020  5....    width  
-0004d090: 203a 2061 7869 7320 6c69 6e65 2077 6964   : axis line wid
-0004d0a0: 7468 732c 2064 6566 6175 6c74 3a20 320d  ths, default: 2.
-0004d0b0: 0a0d 0a20 2020 206e 6567 6178 6973 203a  ...    negaxis :
-0004d0c0: 2073 686f 7720 6e65 6761 7469 7665 2061   show negative a
-0004d0d0: 7869 7320 6c69 6e65 2c20 6465 6661 756c  xis line, defaul
-0004d0e0: 743a 2046 616c 7365 0d0a 0d0a 2020 2020  t: False....    
-0004d0f0: 616c 7220 2020 2020 3a20 6178 6973 206c  alr     : axis l
-0004d100: 656e 6774 6820 7261 7469 6f2c 2068 6561  ength ratio, hea
-0004d110: 6420 7369 7a65 2074 6f20 6178 6973 206c  d size to axis l
-0004d120: 656e 6774 682c 2064 6566 6175 6c74 3a20  ength, default: 
-0004d130: 302e 320d 0a0d 0a20 2020 2052 6574 7572  0.2....    Retur
-0004d140: 6e73 0d0a 2020 2020 2d2d 2d2d 2d2d 2d0d  ns..    -------.
-0004d150: 0a20 2020 2061 7865 730d 0a0d 0a20 2020  .    axes....   
-0004d160: 2022 2222 0d0a 0d0a 2020 2020 6b61 7267   """....    karg
-0004d170: 4466 7420 3d20 7b20 276c 656e 6774 6827  Dft = { 'length'
-0004d180: 3a20 312e 352c 2027 636f 6c6f 7227 3a27  : 1.5, 'color':'
-0004d190: 6b27 2c20 276c 6162 656c 7327 3a5b 2758  k', 'labels':['X
-0004d1a0: 272c 2759 272c 275a 275d 2c0d 0a20 2020  ','Y','Z'],..   
-0004d1b0: 2020 2020 2020 2020 2020 2020 2027 6f66               'of
-0004d1c0: 6673 6574 273a 302e 302c 2027 7061 6427  fset':0.0, 'pad'
-0004d1d0: 3a20 302e 3135 2c20 2777 6964 7468 273a  : 0.15, 'width':
-0004d1e0: 322c 2027 616c 7227 3a30 2e32 2c20 276e  2, 'alr':0.2, 'n
-0004d1f0: 6567 6178 6973 273a 4661 6c73 657d 0d0a  egaxis':False}..
-0004d200: 2020 2020 4b57 203d 204b 5770 726f 6365      KW = KWproce
-0004d210: 7373 6f72 286b 6172 6744 6674 2c27 7365  ssor(kargDft,'se
-0004d220: 7475 7041 7869 7327 2c2a 2a6b 6172 6773  tupAxis',**kargs
-0004d230: 290d 0a20 2020 206c 656e 6774 6820 3d20  )..    length = 
-0004d240: 4b57 2e67 6574 5661 6c28 276c 656e 6774  KW.getVal('lengt
-0004d250: 6827 290d 0a20 2020 2063 6f6c 6f72 203d  h')..    color =
-0004d260: 204b 572e 6765 7456 616c 2827 636f 6c6f   KW.getVal('colo
-0004d270: 7227 290d 0a20 2020 206f 6666 7365 7420  r')..    offset 
-0004d280: 3d20 4b57 2e67 6574 5661 6c28 276f 6666  = KW.getVal('off
-0004d290: 7365 7427 290d 0a20 2020 206c 6162 656c  set')..    label
-0004d2a0: 7320 3d20 4b57 2e67 6574 5661 6c28 276c  s = KW.getVal('l
-0004d2b0: 6162 656c 7327 290d 0a20 2020 2070 6164  abels')..    pad
-0004d2c0: 203d 204b 572e 6765 7456 616c 2827 7061   = KW.getVal('pa
-0004d2d0: 6427 290d 0a20 2020 2077 6964 7468 203d  d')..    width =
-0004d2e0: 204b 572e 6765 7456 616c 2827 7769 6474   KW.getVal('widt
-0004d2f0: 6827 290d 0a20 2020 206e 6567 6178 6973  h')..    negaxis
-0004d300: 203d 204b 572e 6765 7456 616c 2827 6e65   = KW.getVal('ne
-0004d310: 6761 7869 7327 290d 0a20 2020 2061 6c72  gaxis')..    alr
-0004d320: 203d 204b 572e 6765 7456 616c 2827 616c   = KW.getVal('al
-0004d330: 7227 290d 0a20 2020 200d 0a20 2020 2023  r')..    ..    #
-0004d340: 204e 6f74 653a 206e 6f74 2063 6865 636b   Note: not check
-0004d350: 696e 6720 6172 7261 7920 6c65 6e67 7468  ing array length
-0004d360: 3d3d 332c 206f 7220 6120 7661 6c69 6420  ==3, or a valid 
-0004d370: 636f 6c6f 722e 0d0a 2020 2020 6966 2063  color...    if c
-0004d380: 6f6c 6f72 2069 7320 4e6f 6e65 203a 2063  olor is None : c
-0004d390: 6f6c 6f72 3d27 6b27 0d0a 2020 2020 6966  olor='k'..    if
-0004d3a0: 206e 6f74 2063 6f6c 6f72 732e 6973 5f63   not colors.is_c
-0004d3b0: 6f6c 6f72 5f6c 696b 6528 636f 6c6f 7229  olor_like(color)
-0004d3c0: 203a 2020 2320 6368 6563 6b20 6966 2061   :  # check if a
-0004d3d0: 7267 2069 7320 6120 636f 6c6f 7220 6172  rg is a color ar
-0004d3e0: 7261 792c 206e 6f74 2061 6e20 6172 7261  ray, not an arra
-0004d3f0: 7920 6f66 2063 6f6c 6f72 7320 0d0a 2020  y of colors ..  
-0004d400: 2020 2020 2020 636f 6c6f 7220 3d20 6e70        color = np
-0004d410: 2e61 7272 6179 2028 205b 636f 6c6f 7273  .array ( [colors
-0004d420: 2e74 6f5f 7267 6261 2863 6f6c 6f72 5b30  .to_rgba(color[0
-0004d430: 5d29 2c20 636f 6c6f 7273 2e74 6f5f 7267  ]), colors.to_rg
-0004d440: 6261 2863 6f6c 6f72 5b31 5d29 2c20 636f  ba(color[1]), co
-0004d450: 6c6f 7273 2e74 6f5f 7267 6261 2863 6f6c  lors.to_rgba(col
-0004d460: 6f72 5b32 5d29 2020 5d20 290d 0a20 2020  or[2])  ] )..   
-0004d470: 2065 6c73 6520 3a0d 0a20 2020 2020 2020   else :..       
-0004d480: 2063 6f6c 6f72 203d 206e 702e 6172 7261   color = np.arra
-0004d490: 7920 2820 5b63 6f6c 6f72 732e 746f 5f72  y ( [colors.to_r
-0004d4a0: 6762 6128 636f 6c6f 7229 2c20 636f 6c6f  gba(color), colo
-0004d4b0: 7273 2e74 6f5f 7267 6261 2863 6f6c 6f72  rs.to_rgba(color
-0004d4c0: 292c 2063 6f6c 6f72 732e 746f 5f72 6762  ), colors.to_rgb
-0004d4d0: 6128 636f 6c6f 7229 5d20 2029 0d0a 0d0a  a(color)]  )....
-0004d4e0: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
-0004d4f0: 7461 6e63 6528 6c65 6e67 7468 2c28 6c69  tance(length,(li
-0004d500: 7374 2c74 7570 6c65 2c6e 702e 6e64 6172  st,tuple,np.ndar
-0004d510: 7261 7929 2920 3a20 6c65 6e67 7468 203d  ray)) : length =
-0004d520: 2020 5b6c 656e 6774 682c 6c65 6e67 7468    [length,length
-0004d530: 2c6c 656e 6774 685d 200d 0a20 2020 206c  ,length] ..    l
-0004d540: 656e 6774 683d 6e70 2e61 7272 6179 286c  ength=np.array(l
-0004d550: 656e 6774 6829 0d0a 0d0a 2020 2020 6966  ength)....    if
-0004d560: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
-0004d570: 6f66 6673 6574 2c28 6c69 7374 2c74 7570  offset,(list,tup
-0004d580: 6c65 2c6e 702e 6e64 6172 7261 7929 2920  le,np.ndarray)) 
-0004d590: 3a20 206f 6666 7365 7420 3d20 5b6f 6666  :  offset = [off
-0004d5a0: 7365 742c 6f66 6673 6574 2c6f 6666 7365  set,offset,offse
-0004d5b0: 745d 0d0a 2020 2020 6f66 6673 6574 203d  t]..    offset =
-0004d5c0: 206e 702e 6172 7261 7928 6f66 6673 6574   np.array(offset
-0004d5d0: 290d 0a0d 0a20 2020 2069 6620 6c61 6265  )....    if labe
-0004d5e0: 6c73 2069 7320 4e6f 6e65 203a 206c 6162  ls is None : lab
-0004d5f0: 656c 7320 3d20 5b27 5827 2c27 5927 2c27  els = ['X','Y','
-0004d600: 5a27 5d0d 0a20 2020 2069 6620 6e6f 7420  Z']..    if not 
-0004d610: 6973 696e 7374 616e 6365 286c 6162 656c  isinstance(label
-0004d620: 732c 286c 6973 742c 7475 706c 652c 6e70  s,(list,tuple,np
-0004d630: 2e6e 6461 7272 6179 2929 203a 2020 6c61  .ndarray)) :  la
-0004d640: 6265 6c73 203d 205b 6c61 6265 6c73 2c6c  bels = [labels,l
-0004d650: 6162 656c 732c 6c61 6265 6c73 5d0d 0a20  abels,labels].. 
-0004d660: 2020 200d 0a20 2020 2069 6620 6e6f 7420     ..    if not 
-0004d670: 6973 696e 7374 616e 6365 2870 6164 2c28  isinstance(pad,(
-0004d680: 6c69 7374 2c74 7570 6c65 2c6e 702e 6e64  list,tuple,np.nd
-0004d690: 6172 7261 7929 2920 3a20 2070 6164 203d  array)) :  pad =
-0004d6a0: 205b 7061 642c 7061 642c 7061 645d 0d0a   [pad,pad,pad]..
-0004d6b0: 2020 2020 7061 6420 3d20 6e70 2e61 7272      pad = np.arr
-0004d6c0: 6179 2870 6164 290d 0a0d 0a20 2020 2022  ay(pad)....    "
-0004d6d0: 2222 5365 7420 5859 5a20 6f72 6967 696e  ""Set XYZ origin
-0004d6e0: 2063 6f6f 7264 696e 6174 6520 6178 6973   coordinate axis
-0004d6f0: 2061 7272 6f77 732e 2222 220d 0a20 2020   arrows."""..   
-0004d700: 2073 6567 6c65 6e67 7468 203d 206c 656e   seglength = len
-0004d710: 6774 682d 6f66 6673 6574 0d0a 2020 2020  gth-offset..    
-0004d720: 656e 6443 6f6f 7220 3d20 6e70 2e6d 756c  endCoor = np.mul
-0004d730: 7469 706c 7928 6e70 2e69 6465 6e74 6974  tiply(np.identit
-0004d740: 7928 3329 2c73 6567 6c65 6e67 7468 290d  y(3),seglength).
-0004d750: 0a20 2020 2073 7472 436f 6f72 203d 206e  .    strCoor = n
-0004d760: 702e 6d75 6c74 6970 6c79 286e 702e 6964  p.multiply(np.id
-0004d770: 656e 7469 7479 2833 292c 6f66 6673 6574  entity(3),offset
-0004d780: 290d 0a0d 0a20 2020 2078 797a 203d 206e  )....    xyz = n
-0004d790: 702e 7472 616e 7370 6f73 6528 2073 7472  p.transpose( str
-0004d7a0: 436f 6f72 2029 0d0a 2020 2020 7576 7720  Coor )..    uvw 
-0004d7b0: 3d20 6e70 2e74 7261 6e73 706f 7365 2820  = np.transpose( 
-0004d7c0: 656e 6443 6f6f 7220 290d 0a20 2020 2076  endCoor )..    v
-0004d7d0: 6366 203d 2056 6563 746f 7233 4443 6f6c  cf = Vector3DCol
-0004d7e0: 6c65 6374 696f 6e28 7879 7a2c 7576 772c  lection(xyz,uvw,
-0004d7f0: 616c 723d 616c 722c 2063 6f6c 6f72 3d63  alr=alr, color=c
-0004d800: 6f6c 6f72 5b30 5d2c 206c 696e 6577 6964  olor[0], linewid
-0004d810: 7468 3d77 6964 7468 290d 0a20 2020 2076  th=width)..    v
-0004d820: 6366 2e5f 7365 745f 7665 6374 436f 6c6f  cf._set_vectColo
-0004d830: 7228 636f 6c6f 7229 0d0a 2020 2020 6178  r(color)..    ax
-0004d840: 6573 2e61 6464 5f63 6f6c 6c65 6374 696f  es.add_collectio
-0004d850: 6e33 6428 2076 6366 2029 0d0a 0d0a 2020  n3d( vcf )....  
-0004d860: 2020 6966 206e 6567 6178 6973 203a 0d0a    if negaxis :..
-0004d870: 2020 2020 2020 2020 656e 6443 6f6f 7220          endCoor 
-0004d880: 3d20 6e70 2e6d 756c 7469 706c 7928 6e70  = np.multiply(np
-0004d890: 2e69 6465 6e74 6974 7928 3329 2c20 2d31  .identity(3), -1
-0004d8a0: 2e30 2a6c 656e 6774 6829 0d0a 2020 2020  .0*length)..    
-0004d8b0: 2020 2020 7374 7243 6f6f 7220 3d20 6e70      strCoor = np
-0004d8c0: 2e6d 756c 7469 706c 7928 6e70 2e69 6465  .multiply(np.ide
-0004d8d0: 6e74 6974 7928 3329 2c20 2d31 2e30 2a6f  ntity(3), -1.0*o
-0004d8e0: 6666 7365 7429 0d0a 2020 2020 2020 2020  ffset)..        
-0004d8f0: 7879 7a20 3d20 6e70 2e74 7261 6e73 706f  xyz = np.transpo
-0004d900: 7365 2820 7374 7243 6f6f 7220 290d 0a20  se( strCoor ).. 
-0004d910: 2020 2020 2020 2075 7677 203d 206e 702e         uvw = np.
-0004d920: 7472 616e 7370 6f73 6528 2065 6e64 436f  transpose( endCo
-0004d930: 6f72 2029 0d0a 2020 2020 2020 2020 7665  or )..        ve
-0004d940: 7274 6578 436f 6f72 203d 206e 702e 636f  rtexCoor = np.co
-0004d950: 6e63 6174 656e 6174 6528 2028 656e 6443  ncatenate( (endC
-0004d960: 6f6f 722c 7374 7243 6f6f 7229 2c61 7869  oor,strCoor),axi
-0004d970: 733d 3020 290d 0a20 2020 2020 2020 2073  s=0 )..        s
-0004d980: 6567 6d49 6e64 6963 6573 203d 205b 205b  egmIndices = [ [
-0004d990: 302c 335d 2c5b 312c 345d 2c5b 322c 355d  0,3],[1,4],[2,5]
-0004d9a0: 205d 0d0a 2020 2020 2020 2020 6c69 6e65   ]..        line
-0004d9b0: 203d 2043 6f6c 6f72 4c69 6e65 3344 436f   = ColorLine3DCo
-0004d9c0: 6c6c 6563 7469 6f6e 2876 6572 7465 7843  llection(vertexC
-0004d9d0: 6f6f 722c 7365 676d 496e 6469 6365 732c  oor,segmIndices,
-0004d9e0: 2063 6f6c 6f72 3d63 6f6c 6f72 2c20 6c69   color=color, li
-0004d9f0: 6e65 7769 6474 683d 7769 6474 6829 0d0a  newidth=width)..
-0004da00: 2020 2020 2020 2020 6178 6573 2e61 6464          axes.add
-0004da10: 5f63 6f6c 6c65 6374 696f 6e33 6428 206c  _collection3d( l
-0004da20: 696e 6520 290d 0a0d 0a20 2020 2070 6f73  ine )....    pos
-0004da30: 203d 206c 656e 6774 6820 2b20 7061 640d   = length + pad.
-0004da40: 0a20 2020 2061 7865 732e 7465 7874 2870  .    axes.text(p
-0004da50: 6f73 5b30 5d2c 302c 302c 6c61 6265 6c73  os[0],0,0,labels
-0004da60: 5b30 5d2c 2063 6f6c 6f72 203d 2063 6f6c  [0], color = col
-0004da70: 6f72 5b30 5d2c 2066 6f6e 7477 6569 6768  or[0], fontweigh
-0004da80: 743d 2762 6f6c 6427 2c20 666f 6e74 7369  t='bold', fontsi
-0004da90: 7a65 3d27 6c61 7267 6527 2c0d 0a20 2020  ze='large',..   
-0004daa0: 2020 2020 2020 2020 2068 6f72 697a 6f6e           horizon
-0004dab0: 7461 6c61 6c69 676e 6d65 6e74 3d27 6365  talalignment='ce
-0004dac0: 6e74 6572 272c 2076 6572 7469 6361 6c61  nter', verticala
-0004dad0: 6c69 676e 6d65 6e74 3d27 6365 6e74 6572  lignment='center
-0004dae0: 2729 0d0a 2020 2020 6178 6573 2e74 6578  ')..    axes.tex
-0004daf0: 7428 302c 706f 735b 315d 2c30 2c6c 6162  t(0,pos[1],0,lab
-0004db00: 656c 735b 315d 2c20 636f 6c6f 7220 3d20  els[1], color = 
-0004db10: 636f 6c6f 725b 315d 2c20 666f 6e74 7765  color[1], fontwe
-0004db20: 6967 6874 3d27 626f 6c64 272c 2066 6f6e  ight='bold', fon
-0004db30: 7473 697a 653d 276c 6172 6765 272c 0d0a  tsize='large',..
-0004db40: 2020 2020 2020 2020 2020 2020 686f 7269              hori
-0004db50: 7a6f 6e74 616c 616c 6967 6e6d 656e 743d  zontalalignment=
-0004db60: 2763 656e 7465 7227 2c20 7665 7274 6963  'center', vertic
-0004db70: 616c 616c 6967 6e6d 656e 743d 2763 656e  alalignment='cen
-0004db80: 7465 7227 290d 0a20 2020 2061 7865 732e  ter')..    axes.
-0004db90: 7465 7874 2830 2c30 2c70 6f73 5b32 5d2c  text(0,0,pos[2],
-0004dba0: 6c61 6265 6c73 5b32 5d2c 2063 6f6c 6f72  labels[2], color
-0004dbb0: 203d 2063 6f6c 6f72 5b32 5d2c 2066 6f6e   = color[2], fon
-0004dbc0: 7477 6569 6768 743d 2762 6f6c 6427 2c20  tweight='bold', 
-0004dbd0: 666f 6e74 7369 7a65 3d27 6c61 7267 6527  fontsize='large'
-0004dbe0: 2c0d 0a20 2020 2020 2020 2020 2020 2068  ,..            h
-0004dbf0: 6f72 697a 6f6e 7461 6c61 6c69 676e 6d65  orizontalalignme
-0004dc00: 6e74 3d27 6365 6e74 6572 272c 2076 6572  nt='center', ver
-0004dc10: 7469 6361 6c61 6c69 676e 6d65 6e74 3d27  ticalalignment='
-0004dc20: 6365 6e74 6572 2729 0d0a 2020 2020 7265  center')..    re
-0004dc30: 7475 726e 2061 7865 7320 2020 2020 0d0a  turn axes     ..
-0004dc40: 0d0a 6465 6620 7374 616e 6461 7264 4178  ..def standardAx
-0004dc50: 6973 2820 6178 6573 2c20 2a2a 6b61 7267  is( axes, **karg
-0004dc60: 7320 2920 3a0d 0a20 2020 2022 2222 0d0a  s ) :..    """..
-0004dc70: 2020 2020 4164 6420 5859 5a20 6f72 6967      Add XYZ orig
-0004dc80: 696e 2063 6f6f 7264 696e 6174 6520 6178  in coordinate ax
-0004dc90: 6973 2056 6563 746f 7233 4443 6f6c 6c65  is Vector3DColle
-0004dca0: 6374 696f 6e20 616e 640d 0a20 2020 2073  ction and..    s
-0004dcb0: 6574 2074 6865 2061 7869 7320 7669 6577  et the axis view
-0004dcc0: 696e 6720 616e 676c 652c 2070 726f 6a65  ing angle, proje
-0004dcd0: 6374 696f 6e20 7479 7065 2061 6e64 2063  ction type and c
-0004dce0: 6c65 6172 2070 6c61 6e65 732e 0d0a 2020  lear planes...  
-0004dcf0: 2020 0d0a 2020 2020 5061 7261 6d65 7465    ..    Paramete
-0004dd00: 7273 0d0a 2020 2020 2d2d 2d2d 2d2d 2d2d  rs..    --------
-0004dd10: 2d2d 0d0a 2020 2020 6178 6573 203a 204d  --..    axes : M
-0004dd20: 6174 706c 6f74 6c69 6220 3344 2061 7865  atplotlib 3D axe
-0004dd30: 7320 6f62 6a65 6374 2e0d 0a0d 0a20 2020  s object.....   
-0004dd40: 206b 6172 6773 3a20 6964 656e 7469 6361   kargs: identica
-0004dd50: 6c20 746f 2074 686f 7365 2066 6f72 2073  l to those for s
-0004dd60: 6574 7570 4178 6973 2066 756e 6374 696f  etupAxis functio
-0004dd70: 6e2e 0d0a 0d0a 2020 2020 5265 7475 726e  n.....    Return
-0004dd80: 730d 0a20 2020 202d 2d2d 2d2d 2d2d 0d0a  s..    -------..
-0004dd90: 2020 2020 6178 6573 0d0a 2020 2020 0d0a      axes..    ..
-0004dda0: 2020 2020 2222 220d 0a20 2020 2073 6574      """..    set
-0004ddb0: 7570 4178 6973 2861 7865 732c 202a 2a6b  upAxis(axes, **k
-0004ddc0: 6172 6773 290d 0a20 2020 206d 696e 6d61  args)..    minma
-0004ddd0: 7820 3d20 282d 312c 3129 0d0a 2020 2020  x = (-1,1)..    
-0004dde0: 6178 6573 2e73 6574 2878 6c69 6d3d 6d69  axes.set(xlim=mi
-0004ddf0: 6e6d 6178 2c20 796c 696d 3d6d 696e 6d61  nmax, ylim=minma
-0004de00: 782c 207a 6c69 6d3d 6d69 6e6d 6178 290d  x, zlim=minmax).
-0004de10: 0a20 2020 2061 7865 732e 7669 6577 5f69  .    axes.view_i
-0004de20: 6e69 7428 3330 2c20 3330 290d 0a20 2020  nit(30, 30)..   
-0004de30: 2061 7865 732e 7365 745f 7072 6f6a 5f74   axes.set_proj_t
-0004de40: 7970 6528 276f 7274 686f 2729 0d0a 2020  ype('ortho')..  
-0004de50: 2020 6178 6573 2e73 6574 5f61 7869 735f    axes.set_axis_
-0004de60: 6f66 6628 290d 0a20 2020 2072 6574 7572  off()..    retur
-0004de70: 6e20 6178 6573 0d0a 0d0a 6465 6620 6175  n axes....def au
-0004de80: 746f 5f73 6361 6c65 2861 7865 732c 2a6f  to_scale(axes,*o
-0004de90: 626a 3364 2c2a 2a6b 6172 6773 2920 3a0d  bj3d,**kargs) :.
-0004dea0: 0a20 2020 2022 2222 0d0a 2020 2020 5363  .    """..    Sc
-0004deb0: 616c 6520 4178 6573 3364 2075 7369 6e67  ale Axes3d using
-0004dec0: 206f 626a 6563 7420 626f 756e 6473 2e0d   object bounds..
-0004ded0: 0a0d 0a20 2020 2050 6172 616d 6574 6572  ...    Parameter
-0004dee0: 730d 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  s..    ---------
-0004def0: 2d0d 0a20 2020 2061 7865 7320 3a20 4d61  -..    axes : Ma
-0004df00: 7470 6c6f 746c 6962 2033 4420 6178 6573  tplotlib 3D axes
-0004df10: 2e0d 0a0d 0a20 2020 206f 626a 3364 203a  .....    obj3d :
-0004df20: 2070 6f73 6974 696f 6e61 6c20 6172 6775   positional argu
-0004df30: 6d65 6e74 7320 6f66 2073 3364 6c69 6220  ments of s3dlib 
-0004df40: 6f62 6a65 6374 730d 0a20 2020 200d 0a20  objects..    .. 
-0004df50: 2020 2075 7363 616c 6520 3a20 7363 616c     uscale : scal
-0004df60: 696e 6720 696e 2074 6865 2072 616e 6765  ing in the range
-0004df70: 2028 302e 352c 322e 3529 0d0a 2020 2020   (0.5,2.5)..    
-0004df80: 2020 2020 6966 206e 6569 7468 6572 2075      if neither u
-0004df90: 7363 616c 6520 6f72 2072 7363 616c 6520  scale or rscale 
-0004dfa0: 6172 6520 6465 6669 6e65 6420 2d20 0d0a  are defined - ..
-0004dfb0: 2020 2020 2020 2020 2e20 2020 2045 6163          .    Eac
-0004dfc0: 6820 6178 6573 2072 616e 6765 7320 6172  h axes ranges ar
-0004dfd0: 6520 696e 6465 7065 6e64 656e 746c 790d  e independently.
-0004dfe0: 0a20 2020 2020 2020 202e 2020 2020 7365  .        .    se
-0004dff0: 7420 6279 2073 697a 6573 206f 6620 696e  t by sizes of in
-0004e000: 7075 7420 6f62 6a65 6374 732e 0d0a 2020  put objects...  
-0004e010: 2020 2020 2020 6966 2062 6f74 6820 7573        if both us
-0004e020: 6361 6c65 2061 6e64 2072 7363 616c 6520  cale and rscale 
-0004e030: 6172 6520 6465 6669 6e65 6420 2d0d 0a20  are defined -.. 
-0004e040: 2020 2020 2020 202e 2020 2020 7573 6361         .    usca
-0004e050: 6c65 2077 696c 6c20 6265 2069 676e 6f72  le will be ignor
-0004e060: 6564 2e0d 0a20 2020 2020 2020 2069 6620  ed...        if 
-0004e070: 6465 6669 6e65 6420 7573 696e 6720 616e  defined using an
-0004e080: 2069 6e74 206f 7220 666c 6f61 7420 2d0d   int or float -.
-0004e090: 0a20 2020 2020 2020 202e 2020 2020 4561  .        .    Ea
-0004e0a0: 6368 2061 7865 7320 7261 6e67 6573 2068  ch axes ranges h
-0004e0b0: 6176 6520 7468 6520 7361 6d65 2073 6361  ave the same sca
-0004e0c0: 6c61 720d 0a20 2020 2020 2020 202e 2020  lar..        .  
-0004e0d0: 2020 6c65 6e67 7468 2c20 7365 7420 6279    length, set by
-0004e0e0: 2074 6865 2076 616c 7565 7320 6f66 2074   the values of t
-0004e0f0: 6865 206f 626a 6563 7473 2e0d 0a20 2020  he objects...   
-0004e100: 2020 2020 202e 2020 2020 4f75 7420 6f66       .    Out of
-0004e110: 2072 616e 6765 2076 616c 7565 7320 7769   range values wi
-0004e120: 6c6c 2073 6574 2074 6865 2073 6361 6c69  ll set the scali
-0004e130: 6e67 0d0a 2020 2020 2020 2020 2e20 2020  ng..        .   
-0004e140: 2074 6f20 7468 6520 6d69 6e69 6d75 6d20   to the minimum 
-0004e150: 6f72 206d 6178 696d 756d 2e0d 0a20 2020  or maximum...   
-0004e160: 2020 2020 2065 6c73 6520 2d20 7363 616c       else - scal
-0004e170: 696e 6720 6973 206f 6e65 2e0d 0a20 2020  ing is one...   
-0004e180: 200d 0a20 2020 2072 7363 616c 6520 3a20   ..    rscale : 
-0004e190: 7363 616c 696e 6720 696e 2074 6865 2072  scaling in the r
-0004e1a0: 616e 6765 2028 302e 352c 322e 3529 0d0a  ange (0.5,2.5)..
-0004e1b0: 2020 2020 2020 2020 6966 206e 6569 7468          if neith
-0004e1c0: 6572 2075 7363 616c 6520 6f72 2072 7363  er uscale or rsc
-0004e1d0: 616c 6520 6172 6520 6465 6669 6e65 6420  ale are defined 
-0004e1e0: 2d20 0d0a 2020 2020 2020 2020 2e20 2020  - ..        .   
-0004e1f0: 2045 6163 6820 6178 6573 2072 616e 6765   Each axes range
-0004e200: 7320 6172 6520 696e 6465 7065 6e64 656e  s are independen
-0004e210: 746c 790d 0a20 2020 2020 2020 202e 2020  tly..        .  
-0004e220: 2020 7365 7420 6279 2073 697a 6573 206f    set by sizes o
-0004e230: 6620 696e 7075 7420 6f62 6a65 6374 732e  f input objects.
-0004e240: 0d0a 2020 2020 2020 2020 6966 2062 6f74  ..        if bot
-0004e250: 6820 7573 6361 6c65 2061 6e64 2072 7363  h uscale and rsc
-0004e260: 616c 6520 6172 6520 6465 6669 6e65 6420  ale are defined 
-0004e270: 2d0d 0a20 2020 2020 2020 202e 2020 2020  -..        .    
-0004e280: 7573 6361 6c65 2077 696c 6c20 6265 2069  uscale will be i
-0004e290: 676e 6f72 6564 2e0d 0a20 2020 2020 2020  gnored...       
-0004e2a0: 2069 6620 6465 6669 6e65 6420 7573 696e   if defined usin
-0004e2b0: 6720 616e 2069 6e74 206f 7220 666c 6f61  g an int or floa
-0004e2c0: 7420 2d0d 0a20 2020 2020 2020 202e 2020  t -..        .  
-0004e2d0: 2020 4561 6368 2061 7865 7320 7261 6e67    Each axes rang
-0004e2e0: 6573 2068 6176 6520 7468 6520 7361 6d65  es have the same
-0004e2f0: 206d 696e 696d 756d 0d0a 2020 2020 2020   minimum..      
-0004e300: 2020 2e20 2020 2061 6e64 206d 6178 696d    .    and maxim
-0004e310: 756d 2c20 7365 7420 6279 2074 6865 2076  um, set by the v
-0004e320: 616c 7565 7320 6f66 2074 6865 0d0a 2020  alues of the..  
-0004e330: 2020 2020 2020 2e20 2020 206f 626a 6563        .    objec
-0004e340: 7473 2072 6164 6961 6c20 6578 7465 6e74  ts radial extent
-0004e350: 2066 726f 6d20 7468 6520 6f72 6967 696e   from the origin
-0004e360: 2e0d 0a20 2020 2020 2020 202e 2020 2020  ...        .    
-0004e370: 4f75 7420 6f66 2072 616e 6765 2076 616c  Out of range val
-0004e380: 7565 7320 7769 6c6c 2073 6574 2074 6865  ues will set the
-0004e390: 2073 6361 6c69 6e67 0d0a 2020 2020 2020   scaling..      
-0004e3a0: 2020 2e20 2020 2074 6f20 7468 6520 6d61    .    to the ma
-0004e3b0: 7869 6d75 6d2e 0d0a 2020 2020 2020 2020  ximum...        
-0004e3c0: 656c 7365 202d 2073 6361 6c69 6e67 2069  else - scaling i
-0004e3d0: 7320 6f6e 652e 0d0a 0d0a 2020 2020 5265  s one.....    Re
-0004e3e0: 7475 726e 730d 0a20 2020 202d 2d2d 2d2d  turns..    -----
-0004e3f0: 2d2d 0d0a 2020 2020 6178 6573 2c20 7768  --..    axes, wh
-0004e400: 6963 6820 6861 7320 6265 656e 2073 6361  ich has been sca
-0004e410: 6c65 640d 0a0d 0a20 2020 2022 2222 2020  led....    """  
-0004e420: 200d 0a20 2020 2058 2c59 2c5a 2c52 203d   ..    X,Y,Z,R =
-0004e430: 205b 5d2c 5b5d 2c5b 5d2c 5b5d 0d0a 2020   [],[],[],[]..  
-0004e440: 2020 666f 7220 6f62 6a20 696e 206f 626a    for obj in obj
-0004e450: 3364 203a 0d0a 2020 2020 2020 2020 582e  3d :..        X.
-0004e460: 6170 7065 6e64 286f 626a 2e62 6f75 6e64  append(obj.bound
-0004e470: 735b 2778 6c69 6d27 5d5b 305d 290d 0a20  s['xlim'][0]).. 
-0004e480: 2020 2020 2020 2058 2e61 7070 656e 6428         X.append(
-0004e490: 6f62 6a2e 626f 756e 6473 5b27 786c 696d  obj.bounds['xlim
-0004e4a0: 275d 5b31 5d29 0d0a 2020 2020 2020 2020  '][1])..        
-0004e4b0: 592e 6170 7065 6e64 286f 626a 2e62 6f75  Y.append(obj.bou
-0004e4c0: 6e64 735b 2779 6c69 6d27 5d5b 305d 290d  nds['ylim'][0]).
-0004e4d0: 0a20 2020 2020 2020 2059 2e61 7070 656e  .        Y.appen
-0004e4e0: 6428 6f62 6a2e 626f 756e 6473 5b27 796c  d(obj.bounds['yl
-0004e4f0: 696d 275d 5b31 5d29 0d0a 2020 2020 2020  im'][1])..      
-0004e500: 2020 5a2e 6170 7065 6e64 286f 626a 2e62    Z.append(obj.b
-0004e510: 6f75 6e64 735b 277a 6c69 6d27 5d5b 305d  ounds['zlim'][0]
-0004e520: 290d 0a20 2020 2020 2020 205a 2e61 7070  )..        Z.app
-0004e530: 656e 6428 6f62 6a2e 626f 756e 6473 5b27  end(obj.bounds['
-0004e540: 7a6c 696d 275d 5b31 5d29 0d0a 2020 2020  zlim'][1])..    
-0004e550: 2020 2020 522e 6170 7065 6e64 286f 626a      R.append(obj
-0004e560: 2e62 6f75 6e64 735b 2772 6f72 6727 5d5b  .bounds['rorg'][
-0004e570: 315d 290d 0a20 2020 200d 0a20 2020 2069  1])..    ..    i
-0004e580: 6620 2775 7363 616c 6527 2069 6e20 6b61  f 'uscale' in ka
-0004e590: 7267 7320 3a0d 0a20 2020 2020 2020 2073  rgs :..        s
-0004e5a0: 6320 3d20 6b61 7267 735b 2775 7363 616c  c = kargs['uscal
-0004e5b0: 6527 5d0d 0a20 2020 2020 2020 2069 6620  e']..        if 
-0004e5c0: 6e6f 7420 6973 696e 7374 616e 6365 2873  not isinstance(s
-0004e5d0: 632c 2869 6e74 2c66 6c6f 6174 2929 3a20  c,(int,float)): 
-0004e5e0: 7363 3d31 2e30 0d0a 2020 2020 2020 2020  sc=1.0..        
-0004e5f0: 6966 2073 6320 3e20 322e 3020 3a20 7363  if sc > 2.0 : sc
-0004e600: 203d 2032 2e30 0d0a 2020 2020 2020 2020   = 2.0..        
-0004e610: 6966 2073 6320 3c20 302e 3520 3a20 7363  if sc < 0.5 : sc
-0004e620: 203d 2030 2e35 0d0a 2020 2020 2020 2020   = 0.5..        
-0004e630: 4178 4c65 6e20 3d20 6c61 6d62 6461 2061  AxLen = lambda a
-0004e640: 203a 206d 6178 2861 292d 6d69 6e28 6129   : max(a)-min(a)
-0004e650: 0d0a 2020 2020 2020 2020 4178 4d70 7420  ..        AxMpt 
-0004e660: 3d20 6c61 6d62 6461 2061 203a 2030 2e35  = lambda a : 0.5
-0004e670: 2a28 206d 6178 2861 2920 2b20 6d69 6e28  *( max(a) + min(
-0004e680: 6129 2029 0d0a 2020 2020 2020 2020 6d61  a) )..        ma
-0004e690: 7841 6c65 6e20 3d20 7363 2a6d 6178 2820  xAlen = sc*max( 
-0004e6a0: 5b41 784c 656e 2858 292c 2041 784c 656e  [AxLen(X), AxLen
-0004e6b0: 2859 292c 2041 784c 656e 285a 295d 2020  (Y), AxLen(Z)]  
-0004e6c0: 2920 0d0a 2020 2020 2020 2020 5820 3d20  ) ..        X = 
-0004e6d0: 5b20 2841 784d 7074 2858 292d 302e 352a  [ (AxMpt(X)-0.5*
-0004e6e0: 6d61 7841 6c65 6e29 2c20 2841 784d 7074  maxAlen), (AxMpt
-0004e6f0: 2858 292b 302e 352a 6d61 7841 6c65 6e29  (X)+0.5*maxAlen)
-0004e700: 205d 0d0a 2020 2020 2020 2020 5920 3d20   ]..        Y = 
-0004e710: 5b20 2841 784d 7074 2859 292d 302e 352a  [ (AxMpt(Y)-0.5*
-0004e720: 6d61 7841 6c65 6e29 2c20 2841 784d 7074  maxAlen), (AxMpt
-0004e730: 2859 292b 302e 352a 6d61 7841 6c65 6e29  (Y)+0.5*maxAlen)
-0004e740: 205d 0d0a 2020 2020 2020 2020 5a20 3d20   ]..        Z = 
-0004e750: 5b20 2841 784d 7074 285a 292d 302e 352a  [ (AxMpt(Z)-0.5*
-0004e760: 6d61 7841 6c65 6e29 2c20 2841 784d 7074  maxAlen), (AxMpt
-0004e770: 285a 292b 302e 352a 6d61 7841 6c65 6e29  (Z)+0.5*maxAlen)
-0004e780: 205d 0d0a 0d0a 2020 2020 6966 2027 7273   ]....    if 'rs
-0004e790: 6361 6c65 2720 696e 206b 6172 6773 203a  cale' in kargs :
-0004e7a0: 0d0a 2020 2020 2020 2020 7363 203d 206b  ..        sc = k
-0004e7b0: 6172 6773 5b27 7273 6361 6c65 275d 0d0a  args['rscale']..
-0004e7c0: 2020 2020 2020 2020 6966 206e 6f74 2069          if not i
-0004e7d0: 7369 6e73 7461 6e63 6528 7363 2c28 696e  sinstance(sc,(in
-0004e7e0: 742c 666c 6f61 7429 293a 2073 633d 312e  t,float)): sc=1.
-0004e7f0: 300d 0a20 2020 2020 2020 2069 6620 7363  0..        if sc
-0004e800: 203e 2032 2e30 203a 2073 6320 3d20 322e   > 2.0 : sc = 2.
-0004e810: 300d 0a20 2020 2020 2020 2069 6620 7363  0..        if sc
-0004e820: 203c 2030 2e35 203a 2073 6320 3d20 302e   < 0.5 : sc = 0.
-0004e830: 350d 0a20 2020 2020 2020 2072 6d61 7820  5..        rmax 
-0004e840: 3d20 7363 2a6d 6178 2852 290d 0a20 2020  = sc*max(R)..   
-0004e850: 2020 2020 206d 696e 6d61 7820 3d20 282d       minmax = (-
-0004e860: 726d 6178 2c72 6d61 7829 0d0a 2020 2020  rmax,rmax)..    
-0004e870: 2020 2020 6178 6573 2e73 6574 2878 6c69      axes.set(xli
-0004e880: 6d3d 6d69 6e6d 6178 2c20 796c 696d 3d6d  m=minmax, ylim=m
-0004e890: 696e 6d61 782c 207a 6c69 6d3d 6d69 6e6d  inmax, zlim=minm
-0004e8a0: 6178 2029 0d0a 2020 2020 2020 2020 7265  ax )..        re
-0004e8b0: 7475 726e 2061 7865 7320 2020 2020 200d  turn axes      .
-0004e8c0: 0a0d 0a20 2020 2061 7865 732e 6175 746f  ...    axes.auto
-0004e8d0: 5f73 6361 6c65 5f78 797a 2858 2c59 2c5a  _scale_xyz(X,Y,Z
-0004e8e0: 290d 0a20 2020 2072 6574 7572 6e20 6178  )..    return ax
-0004e8f0: 6573 0d0a 0d0a 6465 6620 6575 6c65 7252  es....def eulerR
-0004e900: 6f74 2874 6865 7461 2c20 7068 692c 2070  ot(theta, phi, p
-0004e910: 7369 3d30 2c20 7573 6558 636f 6e76 3d54  si=0, useXconv=T
-0004e920: 7275 652c 2069 6e72 6164 3d46 616c 7365  rue, inrad=False
-0004e930: 2920 3a0d 0a20 2020 2022 2222 526f 7461  ) :..    """Rota
-0004e940: 7469 6f6e 206d 6174 7269 7820 6672 6f6d  tion matrix from
-0004e950: 2045 756c 6572 2061 6e67 6c65 732c 2058   Euler angles, X
-0004e960: 206f 7220 5920 636f 6e76 656e 7469 6f6e   or Y convention
-0004e970: 2e22 2222 0d0a 2020 2020 2320 582d 636f  ."""..    # X-co
-0004e980: 6e76 656e 7469 6f6e 2028 7a78 7a27 2920  nvention (zxz') 
-0004e990: 616e 6420 592d 636f 6e76 656e 7469 6f6e  and Y-convention
-0004e9a0: 2028 7a79 7a27 2920 726f 7461 7469 6f6e   (zyz') rotation
-0004e9b0: 732e 0d0a 2020 2020 7468 745f 5261 6420  s...    tht_Rad 
-0004e9c0: 3d20 7468 6574 610d 0a20 2020 2070 6869  = theta..    phi
-0004e9d0: 5f52 6164 203d 2020 7068 690d 0a20 2020  _Rad =  phi..   
-0004e9e0: 2070 7369 5f52 6164 203d 2020 7073 690d   psi_Rad =  psi.
-0004e9f0: 0a20 2020 2069 6620 6e6f 7420 696e 7261  .    if not inra
-0004ea00: 6420 3a0d 0a20 2020 2020 2020 2074 6874  d :..        tht
-0004ea10: 5f52 6164 203d 2074 6865 7461 2a6e 702e  _Rad = theta*np.
-0004ea20: 7069 202f 3138 302e 300d 0a20 2020 2020  pi /180.0..     
-0004ea30: 2020 2070 6869 5f52 6164 203d 2020 7068     phi_Rad =  ph
-0004ea40: 692a 6e70 2e70 6920 2f31 3830 2e30 0d0a  i*np.pi /180.0..
-0004ea50: 2020 2020 2020 2020 7073 695f 5261 6420          psi_Rad 
-0004ea60: 3d20 2070 7369 2a6e 702e 7069 202f 3138  =  psi*np.pi /18
-0004ea70: 302e 300d 0a0d 0a20 2020 2063 542c 7354  0.0....    cT,sT
-0004ea80: 203d 206e 702e 636f 7328 7468 745f 5261   = np.cos(tht_Ra
-0004ea90: 6429 2c20 206e 702e 7369 6e28 7468 745f  d),  np.sin(tht_
-0004eaa0: 5261 6429 0d0a 2020 2020 6350 2c73 5020  Rad)..    cP,sP 
-0004eab0: 3d20 6e70 2e63 6f73 2870 6869 5f52 6164  = np.cos(phi_Rad
-0004eac0: 292c 2020 6e70 2e73 696e 2870 6869 5f52  ),  np.sin(phi_R
-0004ead0: 6164 290d 0a20 2020 2063 532c 7353 203d  ad)..    cS,sS =
-0004eae0: 206e 702e 636f 7328 7073 695f 5261 6429   np.cos(psi_Rad)
-0004eaf0: 2c20 206e 702e 7369 6e28 7073 695f 5261  ,  np.sin(psi_Ra
-0004eb00: 6429 0d0a 2020 2020 545f 7420 3d20 5b20  d)..    T_t = [ 
-0004eb10: 5b20 6354 2c20 7354 2c20 3020 5d2c 205b  [ cT, sT, 0 ], [
-0004eb20: 2d73 542c 2063 542c 2030 205d 2c20 5b20  -sT, cT, 0 ], [ 
-0004eb30: 3020 2c20 3020 2c20 3120 5d20 205d 0d0a  0 , 0 , 1 ]  ]..
-0004eb40: 2020 2020 545f 5820 3d20 5b20 5b20 3120      T_X = [ [ 1 
-0004eb50: 2c20 3020 2c20 3020 5d2c 205b 2030 202c  , 0 , 0 ], [ 0 ,
-0004eb60: 2063 502c 2073 505d 2c20 5b20 3020 2c2d   cP, sP], [ 0 ,-
-0004eb70: 7350 2c20 6350 5d20 205d 0d0a 2020 2020  sP, cP]  ]..    
-0004eb80: 545f 5920 3d20 5b20 5b20 6350 2c20 3020  T_Y = [ [ cP, 0 
-0004eb90: 2c2d 7350 5d2c 205b 2030 202c 2031 202c  ,-sP], [ 0 , 1 ,
-0004eba0: 2030 205d 2c20 5b20 7350 2c20 3020 2c20   0 ], [ sP, 0 , 
-0004ebb0: 6350 5d20 205d 0d0a 2020 2020 545f 7320  cP]  ]..    T_s 
-0004ebc0: 3d20 5b20 5b20 6353 2c20 7353 2c20 3020  = [ [ cS, sS, 0 
-0004ebd0: 5d2c 205b 2d73 532c 2063 532c 2030 205d  ], [-sS, cS, 0 ]
-0004ebe0: 2c20 5b20 3020 2c20 3020 2c20 3120 5d20  , [ 0 , 0 , 1 ] 
-0004ebf0: 205d 0d0a 2020 2020 6966 2075 7365 5863   ]..    if useXc
-0004ec00: 6f6e 7620 3a20 545f 7020 3d20 545f 580d  onv : T_p = T_X.
-0004ec10: 0a20 2020 2065 6c73 653a 2020 2020 2020  .    else:      
-0004ec20: 2020 2054 5f70 203d 2054 5f59 0d0a 2020     T_p = T_Y..  
-0004ec30: 2020 4d20 3d20 6e70 2e6d 6174 6d75 6c28    M = np.matmul(
-0004ec40: 2054 5f70 2c20 545f 7420 290d 0a20 2020   T_p, T_t )..   
-0004ec50: 2069 6620 7073 6920 213d 2030 203a 204d   if psi != 0 : M
-0004ec60: 203d 206e 702e 6d61 746d 756c 2820 545f   = np.matmul( T_
-0004ec70: 732c 204d 2029 0d0a 2020 2020 7265 7475  s, M )..    retu
-0004ec80: 726e 204d 0d0a 0d0a 6465 6620 6178 6973  rn M....def axis
-0004ec90: 526f 7428 616c 7068 612c 2064 6972 6563  Rot(alpha, direc
-0004eca0: 7469 6f6e 2c20 696e 7261 643d 4661 6c73  tion, inrad=Fals
-0004ecb0: 6529 203a 0d0a 2020 2020 2222 2252 6f74  e) :..    """Rot
-0004ecc0: 6174 696f 6e20 6d61 7472 6978 2066 726f  ation matrix fro
-0004ecd0: 6d20 726f 7461 7469 6f6e 2061 626f 7574  m rotation about
-0004ece0: 2061 2064 6972 6563 7469 6f6e 616c 2061   a directional a
-0004ecf0: 7869 7322 2222 0d0a 2020 2020 2320 7365  xis"""..    # se
-0004ed00: 6520 5769 6b69 7065 6469 613a 2051 7561  e Wikipedia: Qua
-0004ed10: 7465 726e 696f 6e73 2061 6e64 2073 7061  ternions and spa
-0004ed20: 7469 616c 2072 6f74 6174 696f 6e0d 0a20  tial rotation.. 
-0004ed30: 2020 2061 6c70 5f52 6164 203d 202d 616c     alp_Rad = -al
-0004ed40: 7068 610d 0a20 2020 2069 6620 6e6f 7420  pha..    if not 
-0004ed50: 696e 7261 6420 3a0d 0a20 2020 2020 2020  inrad :..       
-0004ed60: 2061 6c70 5f52 6164 203d 202d 616c 7068   alp_Rad = -alph
-0004ed70: 612a 6e70 2e70 6920 2f31 3830 2e30 0d0a  a*np.pi /180.0..
-0004ed80: 0d0a 2020 2020 7520 3d20 6e70 2e64 6976  ..    u = np.div
-0004ed90: 6964 6528 2064 6972 6563 7469 6f6e 2c20  ide( direction, 
-0004eda0: 6e70 2e6c 696e 616c 672e 6e6f 726d 2864  np.linalg.norm(d
-0004edb0: 6972 6563 7469 6f6e 2920 290d 0a20 2020  irection) )..   
-0004edc0: 2073 5420 3d20 6e70 2e73 696e 2861 6c70   sT = np.sin(alp
-0004edd0: 5f52 6164 2f32 2e30 290d 0a20 2020 2071  _Rad/2.0)..    q
-0004ede0: 5220 3d20 6e70 2e63 6f73 2861 6c70 5f52  R = np.cos(alp_R
-0004edf0: 6164 2f32 2e30 290d 0a20 2020 2071 492c  ad/2.0)..    qI,
-0004ee00: 2071 4a2c 2071 4b20 3d20 7354 2a75 5b30   qJ, qK = sT*u[0
-0004ee10: 5d2c 2073 542a 755b 315d 2c20 7354 2a75  ], sT*u[1], sT*u
-0004ee20: 5b32 5d20 0d0a 2020 2020 4d20 3d20 5b0d  [2] ..    M = [.
-0004ee30: 0a20 2020 2020 2020 205b 2028 312d 322a  .        [ (1-2*
-0004ee40: 2871 4a2a 714a 202b 2071 4b2a 714b 2929  (qJ*qJ + qK*qK))
-0004ee50: 2c20 2020 2032 2a28 7149 2a71 4a20 2d20  ,    2*(qI*qJ - 
-0004ee60: 714b 2a71 5229 202c 2020 2020 322a 2871  qK*qR) ,    2*(q
-0004ee70: 492a 714b 202b 2071 4a2a 7152 2920 205d  I*qK + qJ*qR)  ]
-0004ee80: 202c 0d0a 2020 2020 2020 2020 5b20 2020   ,..        [   
-0004ee90: 2032 2a28 7149 2a71 4a20 2b20 714b 2a71   2*(qI*qJ + qK*q
-0004eea0: 5229 202c 2028 312d 322a 2871 492a 7149  R) , (1-2*(qI*qI
-0004eeb0: 202b 2071 4b2a 714b 2929 2c20 2020 2032   + qK*qK)),    2
-0004eec0: 2a28 714a 2a71 4b20 2d20 7149 2a71 5229  *(qJ*qK - qI*qR)
-0004eed0: 2020 5d20 2c0d 0a20 2020 2020 2020 205b    ] ,..        [
-0004eee0: 2020 2020 322a 2871 492a 714b 202d 2071      2*(qI*qK - q
-0004eef0: 4a2a 7152 2920 2c20 2020 2032 2a28 714a  J*qR) ,    2*(qJ
-0004ef00: 2a71 4b20 2b20 7149 2a71 5229 202c 2028  *qK + qI*qR) , (
-0004ef10: 312d 322a 2871 492a 7149 202b 2071 4a2a  1-2*(qI*qI + qJ*
-0004ef20: 714a 2929 205d 0d0a 2020 2020 5d0d 0a20  qJ)) ]..    ].. 
-0004ef30: 2020 2072 6574 7572 6e20 4d0d 0a0d 0a64     return M....d
-0004ef40: 6566 2076 6563 7452 6f74 2878 4469 7265  ef vectRot(xDire
-0004ef50: 6374 696f 6e2c 2069 6e5f 706c 616e 6544  ction, in_planeD
-0004ef60: 6972 6563 7469 6f6e 2920 3a0d 0a20 2020  irection) :..   
-0004ef70: 2022 2222 526f 7461 7469 6f6e 7320 6d61   """Rotations ma
-0004ef80: 7472 6978 2066 726f 6d20 7477 6f20 7665  trix from two ve
-0004ef90: 6374 6f72 7320 2222 220d 0a20 2020 2069  ctors """..    i
-0004efa0: 7044 6972 203d 206e 702e 6172 7261 7928  pDir = np.array(
-0004efb0: 696e 5f70 6c61 6e65 4469 7265 6374 696f  in_planeDirectio
-0004efc0: 6e29 0d0a 2020 2020 7844 6972 203d 206e  n)..    xDir = n
-0004efd0: 702e 6172 7261 7928 7844 6972 6563 7469  p.array(xDirecti
-0004efe0: 6f6e 290d 0a20 2020 207a 4469 7220 3d20  on)..    zDir = 
-0004eff0: 6e70 2e63 726f 7373 2878 4469 722c 6970  np.cross(xDir,ip
-0004f000: 4469 7229 0d0a 2020 2020 7944 6972 203d  Dir)..    yDir =
-0004f010: 206e 702e 6372 6f73 7328 7a44 6972 2c78   np.cross(zDir,x
-0004f020: 4469 7229 0d0a 2020 2020 7665 6374 203d  Dir)..    vect =
-0004f030: 206e 702e 6172 7261 7928 205b 7844 6972   np.array( [xDir
-0004f040: 2c79 4469 722c 7a44 6972 5d20 290d 0a20  ,yDir,zDir] ).. 
-0004f050: 2020 2076 6e6f 726d 203d 206e 702e 6c69     vnorm = np.li
-0004f060: 6e61 6c67 2e6e 6f72 6d28 7665 6374 2c61  nalg.norm(vect,a
-0004f070: 7869 733d 3129 0d0a 2020 2020 756e 6974  xis=1)..    unit
-0004f080: 5665 6374 7320 3d20 6e70 2e64 6976 6964  Vects = np.divid
-0004f090: 6528 7665 6374 2e54 2c76 6e6f 726d 292e  e(vect.T,vnorm).
-0004f0a0: 540d 0a20 2020 2072 6574 7572 6e20 756e  T..    return un
-0004f0b0: 6974 5665 6374 730d 0a0d 0a64 6566 2072  itVects....def r
-0004f0c0: 7476 2864 6972 6563 7469 6f6e 2c65 6c65  tv(direction,ele
-0004f0d0: 763d 4e6f 6e65 2c61 7a69 6d3d 4e6f 6e65  v=None,azim=None
-0004f0e0: 2920 3a0d 0a20 2020 2022 2222 5472 616e  ) :..    """Tran
-0004f0f0: 7366 6f72 6d20 6469 7265 6374 696f 6e20  sform direction 
-0004f100: 7665 6374 6f72 2027 7265 6c61 7469 7665  vector 'relative
-0004f110: 2074 6f20 7669 6577 2720 6178 6973 2076   to view' axis v
-0004f120: 6965 7769 6e67 2061 6e67 6c65 732e 2222  iewing angles.""
-0004f130: 220d 0a20 2020 2069 6620 656c 6576 2069  "..    if elev i
-0004f140: 7320 4e6f 6e65 203a 2065 6c65 7620 3d20  s None : elev = 
-0004f150: 5f44 4654 5f56 4945 575b 305d 0d0a 2020  _DFT_VIEW[0]..  
-0004f160: 2020 6966 2061 7a69 6d20 6973 204e 6f6e    if azim is Non
-0004f170: 6520 3a20 617a 696d 203d 205f 4446 545f  e : azim = _DFT_
-0004f180: 5649 4557 5b31 5d0d 0a20 2020 2061 7a69  VIEW[1]..    azi
-0004f190: 6d5f 5261 6420 3d20 617a 696d 2a6e 702e  m_Rad = azim*np.
-0004f1a0: 7069 202f 3138 302e 300d 0a20 2020 2065  pi /180.0..    e
-0004f1b0: 6c65 765f 5261 6420 3d20 656c 6576 2a6e  lev_Rad = elev*n
-0004f1c0: 702e 7069 202f 3138 302e 300d 0a20 2020  p.pi /180.0..   
-0004f1d0: 2063 412c 7341 203d 206e 702e 636f 7328   cA,sA = np.cos(
-0004f1e0: 617a 696d 5f52 6164 292c 2020 6e70 2e73  azim_Rad),  np.s
-0004f1f0: 696e 2861 7a69 6d5f 5261 6429 0d0a 2020  in(azim_Rad)..  
-0004f200: 2020 6345 2c73 4520 3d20 6e70 2e63 6f73    cE,sE = np.cos
-0004f210: 2865 6c65 765f 5261 6429 2c20 206e 702e  (elev_Rad),  np.
-0004f220: 7369 6e28 656c 6576 5f52 6164 290d 0a20  sin(elev_Rad).. 
-0004f230: 2020 2054 4d20 3d20 5b20 5b20 6345 2a63     TM = [ [ cE*c
-0004f240: 412c 2063 452a 7341 2c20 7345 205d 2c20  A, cE*sA, sE ], 
-0004f250: 205b 202d 7341 2c20 6341 2c20 302e 3020   [ -sA, cA, 0.0 
-0004f260: 5d2c 2020 5b20 202d 7345 2a63 412c 202d  ],  [  -sE*cA, -
-0004f270: 7345 2a73 412c 2063 4520 5d20 5d0d 0a20  sE*sA, cE ] ].. 
-0004f280: 2020 2072 656c 6469 7220 3d20 6e70 2e64     reldir = np.d
-0004f290: 6f74 2864 6972 6563 7469 6f6e 2c54 4d29  ot(direction,TM)
-0004f2a0: 0d0a 2020 2020 7265 7475 726e 2072 656c  ..    return rel
-0004f2b0: 6469 720d 0a0d 0a64 6566 2065 6c65 765f  dir....def elev_
-0004f2c0: 617a 696d 5f32 7665 6374 6f72 2865 6c65  azim_2vector(ele
-0004f2d0: 762c 2061 7a69 6d2c 2069 6e72 6164 3d46  v, azim, inrad=F
-0004f2e0: 616c 7365 2920 3a0d 0a20 2020 2022 2222  alse) :..    """
-0004f2f0: 556e 6974 2076 6563 746f 7220 696e 2074  Unit vector in t
-0004f300: 6865 2074 6572 6d73 206f 6620 616e 6775  he terms of angu
-0004f310: 6c61 7220 706f 7369 7469 6f6e 2e22 2222  lar position."""
-0004f320: 0d0a 2020 2020 7468 745f 5261 6420 3d20  ..    tht_Rad = 
-0004f330: 617a 696d 0d0a 2020 2020 7068 695f 5261  azim..    phi_Ra
-0004f340: 6420 3d20 6e70 2e70 692f 3220 2d20 656c  d = np.pi/2 - el
-0004f350: 6576 0d0a 2020 2020 6966 206e 6f74 2069  ev..    if not i
-0004f360: 6e72 6164 203a 0d0a 2020 2020 2020 2020  nrad :..        
-0004f370: 7468 745f 5261 6420 3d20 617a 696d 2a6e  tht_Rad = azim*n
-0004f380: 702e 7069 202f 3138 302e 300d 0a20 2020  p.pi /180.0..   
-0004f390: 2020 2020 2070 6869 5f52 6164 203d 2028       phi_Rad = (
-0004f3a0: 3930 2e30 2d65 6c65 7629 2a6e 702e 7069  90.0-elev)*np.pi
-0004f3b0: 202f 3138 302e 300d 0a20 2020 206b 203d   /180.0..    k =
-0004f3c0: 206e 702e 636f 7328 7068 695f 5261 6429   np.cos(phi_Rad)
-0004f3d0: 0d0a 2020 2020 7220 3d20 6e70 2e73 696e  ..    r = np.sin
-0004f3e0: 2870 6869 5f52 6164 290d 0a20 2020 2069  (phi_Rad)..    i
-0004f3f0: 203d 2072 2a6e 702e 636f 7328 7468 745f   = r*np.cos(tht_
-0004f400: 5261 6429 0d0a 2020 2020 6a20 3d20 722a  Rad)..    j = r*
-0004f410: 6e70 2e73 696e 2874 6874 5f52 6164 290d  np.sin(tht_Rad).
-0004f420: 0a20 2020 2072 6574 7572 6e20 6e70 2e61  .    return np.a
-0004f430: 7272 6179 2820 5b69 2c6a 2c6b 5d20 290d  rray( [i,j,k] ).
-0004f440: 0a0d 0a64 6566 2066 7261 6d65 5f74 6f5f  ...def frame_to_
-0004f450: 7661 6c75 6528 782c 202a 7661 6c4c 6973  value(x, *valLis
-0004f460: 742c 202a 2a6b 6172 6773 2920 3a0d 0a20  t, **kargs) :.. 
-0004f470: 2020 2022 2222 0d0a 2020 2020 5920 3d20     """..    Y = 
-0004f480: 6628 7829 2066 726f 6d20 6120 636f 6c6c  f(x) from a coll
-0004f490: 6563 7469 6f6e 206f 6620 6c69 6e65 6172  ection of linear
-0004f4a0: 2073 6567 6d65 6e74 2066 756e 6374 696f   segment functio
-0004f4b0: 6e73 2066 2878 290d 0a20 2020 200d 0a20  ns f(x)..    .. 
-0004f4c0: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
-0004f4d0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
-0004f4e0: 2020 2078 203a 2066 6c6f 6174 2076 616c     x : float val
-0004f4f0: 7565 2062 6574 7765 656e 2030 2061 6e64  ue between 0 and
-0004f500: 2031 2e0d 0a0d 0a20 2020 2076 616c 4c69   1.....    valLi
-0004f510: 7374 203a 206c 6973 7420 6f66 2076 616c  st : list of val
-0004f520: 7565 732c 2065 7665 6e6c 7920 7370 6163  ues, evenly spac
-0004f530: 6564 2061 6c6f 6e67 2078 2e20 466f 7220  ed along x. For 
-0004f540: 6d75 6c74 6970 6c65 206c 6973 7473 2c20  multiple lists, 
-0004f550: 616c 6c20 6d75 7374 2062 6520 7468 6520  all must be the 
-0004f560: 7361 6d65 206c 656e 6774 682e 0d0a 0d0a  same length.....
-0004f570: 2020 2020 7374 6570 7065 6420 3a20 626f      stepped : bo
-0004f580: 6f6c 6561 6e2c 2064 6566 6175 6c74 2069  olean, default i
-0004f590: 7320 4661 6c73 652e 0d0a 2020 2020 2020  s False...      
-0004f5a0: 2020 4966 2054 7275 652c 2066 756e 6374    If True, funct
-0004f5b0: 696f 6e20 6576 616c 7561 7465 2074 6f20  ion evaluate to 
-0004f5c0: 6120 636f 6e73 7461 6e74 206f 6620 7468  a constant of th
-0004f5d0: 6520 6669 7273 7420 7661 6c75 6520 6265  e first value be
-0004f5e0: 7477 6565 6e0d 0a20 2020 2020 2020 2076  tween..        v
-0004f5f0: 616c 4c69 7374 2076 616c 7565 732e 2020  alList values.  
-0004f600: 4966 2046 616c 7365 2c20 6675 6e63 7469  If False, functi
-0004f610: 6f6e 2069 7320 6c69 6e65 6172 2062 6574  on is linear bet
-0004f620: 7765 656e 2076 616c 4c69 7374 2076 616c  ween valList val
-0004f630: 7565 732e 0d0a 2020 2020 2020 2020 466f  ues...        Fo
-0004f640: 7220 5472 7565 2c20 6e75 6d62 6572 206f  r True, number o
-0004f650: 6620 6c69 6e65 6172 2073 6567 6d65 6e74  f linear segment
-0004f660: 7320 6973 2074 6865 2076 616c 4c69 7374  s is the valList
-0004f670: 206c 656e 6774 682e 0d0a 2020 2020 2020   length...      
-0004f680: 2020 466f 7220 4661 6c73 652c 206e 756d    For False, num
-0004f690: 6265 7220 6f66 206c 696e 6561 7220 7365  ber of linear se
-0004f6a0: 676d 656e 7473 2069 7320 6f6e 6520 6c65  gments is one le
-0004f6b0: 7373 2074 6861 6e20 7661 6c4c 6973 7420  ss than valList 
-0004f6c0: 6c65 6e67 7468 2e0d 0a0d 0a20 2020 2052  length.....    R
-0004f6d0: 6574 7572 6e73 0d0a 2020 2020 2d2d 2d2d  eturns..    ----
-0004f6e0: 2d2d 2d0d 0a20 2020 204c 6973 7420 6f66  ---..    List of
-0004f6f0: 2076 616c 7565 7320 6f66 2073 697a 6520   values of size 
-0004f700: 7661 6c4c 6973 7420 6172 6775 6d65 6e74  valList argument
-0004f710: 7320 6e75 6d62 6572 2e0d 0a0d 0a20 2020  s number.....   
-0004f720: 2022 2222 0d0a 2020 2020 2320 3020 3c20   """..    # 0 < 
-0004f730: 7820 3c20 310d 0a20 2020 2064 6566 2076  x < 1..    def v
-0004f740: 4672 6f6d 4c69 7374 2866 2c41 2920 3a0d  FromList(f,A) :.
-0004f750: 0a20 2020 2020 2020 206e 5365 6720 3d20  .        nSeg = 
-0004f760: 6c65 6e28 4129 202d 2031 0d0a 2020 2020  len(A) - 1..    
-0004f770: 2020 2020 6920 3d20 6d61 7468 2e66 6c6f      i = math.flo
-0004f780: 6f72 2866 2a6e 5365 6729 0d0a 2020 2020  or(f*nSeg)..    
-0004f790: 2020 2020 6966 2069 3e3d 6e53 6567 203a      if i>=nSeg :
-0004f7a0: 2072 6574 7572 6e20 415b 6e53 6567 5d0d   return A[nSeg].
-0004f7b0: 0a20 2020 2020 2020 2078 203d 2028 662a  .        x = (f*
-0004f7c0: 6e53 6567 2920 2520 310d 0a20 2020 2020  nSeg) % 1..     
-0004f7d0: 2020 2076 616c 203d 2041 5b69 5d20 2b20     val = A[i] + 
-0004f7e0: 782a 2820 415b 692b 315d 2d41 5b69 5d20  x*( A[i+1]-A[i] 
-0004f7f0: 290d 0a20 2020 2020 2020 2072 6574 7572  )..        retur
-0004f800: 6e20 7661 6c0d 0a20 2020 2064 6566 2076  n val..    def v
-0004f810: 4672 6f6d 5374 6570 2866 2c41 2920 3a0d  FromStep(f,A) :.
-0004f820: 0a20 2020 2020 2020 206e 5365 6720 3d20  .        nSeg = 
-0004f830: 6c65 6e28 4129 0d0a 2020 2020 2020 2020  len(A)..        
-0004f840: 6920 3d20 6d61 7468 2e66 6c6f 6f72 2866  i = math.floor(f
-0004f850: 2a6e 5365 6729 0d0a 2020 2020 2020 2020  *nSeg)..        
-0004f860: 6966 2069 3e3d 6e53 6567 203a 2072 6574  if i>=nSeg : ret
-0004f870: 7572 6e20 415b 6e53 6567 2d31 5d0d 0a20  urn A[nSeg-1].. 
-0004f880: 2020 2020 2020 2069 6620 693c 3020 3a20         if i<0 : 
-0004f890: 7265 7475 726e 2041 5b30 5d0d 0a20 2020  return A[0]..   
-0004f8a0: 2020 2020 2076 616c 203d 2041 5b69 5d0d       val = A[i].
-0004f8b0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0004f8c0: 7661 6c0d 0a20 2020 2073 7465 7070 6564  val..    stepped
-0004f8d0: 203d 2046 616c 7365 0d0a 2020 2020 6966   = False..    if
-0004f8e0: 2027 7374 6570 2720 696e 206b 6172 6773   'step' in kargs
-0004f8f0: 203a 2073 7465 7070 6564 203d 206b 6172   : stepped = kar
-0004f900: 6773 5b27 7374 6570 275d 2020 200d 0a20  gs['step']   .. 
-0004f910: 2020 2076 616c 7320 3d20 5b5d 0d0a 2020     vals = []..  
-0004f920: 2020 666f 7220 764c 6973 7420 696e 2076    for vList in v
-0004f930: 616c 4c69 7374 203a 0d0a 2020 2020 2020  alList :..      
-0004f940: 2020 6966 2073 7465 7070 6564 203a 2076    if stepped : v
-0004f950: 616c 732e 6170 7065 6e64 2820 7646 726f  als.append( vFro
-0004f960: 6d53 7465 7028 782c 764c 6973 7429 2029  mStep(x,vList) )
-0004f970: 0d0a 2020 2020 2020 2020 656c 7365 2020  ..        else  
-0004f980: 2020 2020 203a 2076 616c 732e 6170 7065       : vals.appe
-0004f990: 6e64 2820 7646 726f 6d4c 6973 7428 782c  nd( vFromList(x,
-0004f9a0: 764c 6973 7429 2029 0d0a 2020 2020 7265  vList) )..    re
-0004f9b0: 7475 726e 2076 616c 730d 0a0d 0a64 6566  turn vals....def
-0004f9c0: 2064 656e 7369 7479 5f66 756e 6374 696f   density_functio
-0004f9d0: 6e28 7661 6c73 2c20 6269 6e73 3d28 3130  n(vals, bins=(10
-0004f9e0: 2c31 3029 2c20 7363 616c 653d 5472 7565  ,10), scale=True
-0004f9f0: 2c20 7862 6e64 3d54 7275 652c 2079 626e  , xbnd=True, ybn
-0004fa00: 643d 5472 7565 2c20 6b69 6e64 3d27 6c69  d=True, kind='li
-0004fa10: 6e65 6172 2729 203a 0d0a 2020 2020 2222  near') :..    ""
-0004fa20: 220d 0a20 2020 2032 4420 6869 7374 6f67  "..    2D histog
-0004fa30: 7261 6d20 6465 6e73 6974 792c 2044 6174  ram density, Dat
-0004fa40: 615f 6465 6e73 6974 7920 3d20 6628 782c  a_density = f(x,
-0004fa50: 7929 2066 726f 6d20 6120 782c 7920 6461  y) from a x,y da
-0004fa60: 7461 7365 742e 0d0a 2020 2020 0d0a 2020  taset...    ..  
-0004fa70: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
-0004fa80: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
-0004fa90: 2020 7661 6c73 203a 2032 2058 204e 2061    vals : 2 X N a
-0004faa0: 7272 6179 206f 6620 782c 7920 6461 7461  rray of x,y data
-0004fab0: 2076 616c 7565 732e 0d0a 0d0a 2020 2020   values.....    
-0004fac0: 6269 6e73 203a 205b 696e 742c 696e 745d  bins : [int,int]
-0004fad0: 2c20 7468 6520 6e75 6d62 6572 206f 6620  , the number of 
-0004fae0: 6269 6e73 2066 6f72 2065 6163 6820 6469  bins for each di
-0004faf0: 6d65 6e73 696f 6e2e 0d0a 0d0a 2020 2020  mension.....    
-0004fb00: 7363 616c 6520 3a20 626f 6f6c 206f 7220  scale : bool or 
-0004fb10: 6e75 6d62 6572 2c20 6465 6661 756c 743a  number, default:
-0004fb20: 2054 7275 650d 0a20 2020 2020 2020 2049   True..        I
-0004fb30: 6620 5472 7565 2c20 6e6f 726d 616c 697a  f True, normaliz
-0004fb40: 6520 7661 6c75 6573 2074 6f20 7468 6520  e values to the 
-0004fb50: 6176 6572 6167 652e 0d0a 2020 2020 2020  average...      
-0004fb60: 2020 4966 2046 616c 7365 2c20 7363 616c    If False, scal
-0004fb70: 6520 6973 2031 2c20 7468 6520 6465 6e73  e is 1, the dens
-0004fb80: 6974 7920 7661 6c75 6520 6f66 2064 6174  ity value of dat
-0004fb90: 6120 7065 720d 0a20 2020 2020 2020 2062  a per..        b
-0004fba0: 696e 2061 7265 612e 2020 5768 656e 206e  in area.  When n
-0004fbb0: 756d 6572 6963 616c 2c20 6d75 6c74 6970  umerical, multip
-0004fbc0: 6c69 6572 2066 6f72 0d0a 2020 2020 2020  lier for..      
-0004fbd0: 2020 7468 6520 6465 6e73 6974 7920 7661    the density va
-0004fbe0: 6c75 652e 0d0a 0d0a 2020 2020 7862 6e64  lue.....    xbnd
-0004fbf0: 203a 2062 6f6f 6c2c 2064 6566 6175 6c74   : bool, default
-0004fc00: 203a 2054 7275 650d 0a20 2020 2020 2020   : True..       
-0004fc10: 2049 6620 5472 7565 2c20 7820 7661 6c75   If True, x valu
-0004fc20: 6573 2061 7265 2065 7874 656e 6465 6420  es are extended 
-0004fc30: 666f 7220 6465 6e73 6974 7920 6f66 207a  for density of z
-0004fc40: 6572 6f2e 0d0a 2020 2020 2020 2020 466f  ero...        Fo
-0004fc50: 7220 6379 636c 6963 206d 6170 7069 6e67  r cyclic mapping
-0004fc60: 2c20 7468 6973 2073 686f 756c 6420 6265  , this should be
-0004fc70: 2073 6574 2074 6f20 4661 6c73 652e 0d0a   set to False...
-0004fc80: 0d0a 2020 2020 7962 6e64 203a 2062 6f6f  ..    ybnd : boo
-0004fc90: 6c2c 2064 6566 6175 6c74 203a 2054 7275  l, default : Tru
-0004fca0: 650d 0a20 2020 2020 2020 2049 6620 5472  e..        If Tr
-0004fcb0: 7565 2c20 7920 7661 6c75 6573 2061 7265  ue, y values are
-0004fcc0: 2065 7874 656e 6465 6420 666f 7220 6465   extended for de
-0004fcd0: 6e73 6974 7920 6f66 207a 6572 6f2e 0d0a  nsity of zero...
-0004fce0: 2020 2020 2020 2020 466f 7220 6379 636c          For cycl
-0004fcf0: 6963 206d 6170 7069 6e67 2c20 7468 6973  ic mapping, this
-0004fd00: 2073 686f 756c 6420 6265 2073 6574 2074   should be set t
-0004fd10: 6f20 4661 6c73 652e 0d0a 0d0a 2020 2020  o False.....    
-0004fd20: 6b69 6e64 203a 207b e280 986c 696e 6561  kind : {...linea
-0004fd30: 72e2 8099 2c20 e280 9863 7562 6963 e280  r..., ...cubic..
-0004fd40: 992c 20e2 8098 7175 696e 7469 63e2 8099  ., ...quintic...
-0004fd50: 7d2c 2064 6566 6175 6c74 3a20 276c 696e  }, default: 'lin
-0004fd60: 6561 7227 0d0a 2020 2020 2020 2020 5468  ear'..        Th
-0004fd70: 6520 6b69 6e64 206f 6620 7370 6c69 6e65  e kind of spline
-0004fd80: 2069 6e74 6572 706f 6c61 7469 6f6e 2074   interpolation t
-0004fd90: 6f20 7573 652e 0d0a 2020 200d 0a20 2020  o use...   ..   
-0004fda0: 2052 6574 7572 6e73 0d0a 2020 2020 2d2d   Returns..    --
-0004fdb0: 2d2d 2d2d 2d0d 0a20 2020 2041 2066 756e  -----..    A fun
-0004fdc0: 6374 696f 6e20 6628 782c 7929 0d0a 0d0a  ction f(x,y)....
-0004fdd0: 2020 2020 2222 220d 0a20 2020 2076 616c      """..    val
-0004fde0: 7320 3d20 6e70 2e61 7272 6179 2876 616c  s = np.array(val
-0004fdf0: 7329 0d0a 2020 2020 6269 6e73 203d 206e  s)..    bins = n
-0004fe00: 702e 6172 7261 7928 6269 6e73 290d 0a20  p.array(bins).. 
-0004fe10: 2020 205a 7661 6c73 2c78 6564 6765 732c     Zvals,xedges,
-0004fe20: 7965 6467 6573 203d 206e 702e 6869 7374  yedges = np.hist
-0004fe30: 6f67 7261 6d32 6428 2a76 616c 732c 6269  ogram2d(*vals,bi
-0004fe40: 6e73 3d62 696e 7329 0d0a 2020 2020 582c  ns=bins)..    X,
-0004fe50: 5920 3d20 302c 3120 200d 0a20 2020 206d  Y = 0,1  ..    m
-0004fe60: 696e 7661 6c20 3d20 6e70 2e61 6d69 6e28  inval = np.amin(
-0004fe70: 7661 6c73 2c61 7869 733d 3129 0d0a 2020  vals,axis=1)..  
-0004fe80: 2020 6d61 7876 616c 203d 206e 702e 616d    maxval = np.am
-0004fe90: 6178 2876 616c 732c 6178 6973 3d31 290d  ax(vals,axis=1).
-0004fea0: 0a20 2020 2064 6174 6172 6e67 203d 2028  .    datarng = (
-0004feb0: 6d61 7876 616c 2d6d 696e 7661 6c29 0d0a  maxval-minval)..
-0004fec0: 2020 2020 6172 6561 203d 2064 6174 6172      area = datar
-0004fed0: 6e67 5b30 5d2a 6461 7461 726e 675b 315d  ng[0]*datarng[1]
-0004fee0: 0d0a 2020 2020 6465 6c74 6120 3d20 6461  ..    delta = da
-0004fef0: 7461 726e 672f 6269 6e73 0d0a 2020 2020  tarng/bins..    
-0004ff00: 656e 6476 616c 203d 206d 6178 7661 6c20  endval = maxval 
-0004ff10: 2b20 6465 6c74 612f 320d 0a20 2020 2069  + delta/2..    i
-0004ff20: 6620 7862 6e64 203a 0d0a 2020 2020 2020  f xbnd :..      
-0004ff30: 2020 7a65 726f 7320 3d20 6e70 2e7a 6572    zeros = np.zer
-0004ff40: 6f73 2820 285a 7661 6c73 2e73 6861 7065  os( (Zvals.shape
-0004ff50: 5b58 5d2b 322c 5a76 616c 732e 7368 6170  [X]+2,Zvals.shap
-0004ff60: 655b 595d 2920 290d 0a20 2020 2020 2020  e[Y]) )..       
-0004ff70: 207a 6572 6f73 5b31 3a62 696e 735b 585d   zeros[1:bins[X]
-0004ff80: 2b31 2c3a 5d20 3d20 5a76 616c 730d 0a20  +1,:] = Zvals.. 
-0004ff90: 2020 2020 2020 205a 7661 6c73 203d 207a         Zvals = z
-0004ffa0: 6572 6f73 0d0a 2020 2020 2020 2020 7865  eros..        xe
-0004ffb0: 6467 6573 203d 206e 702e 6172 7261 7928  dges = np.array(
-0004ffc0: 5b2a 2878 6564 6765 732d 6465 6c74 615b  [*(xedges-delta[
-0004ffd0: 585d 2f32 292c 656e 6476 616c 5b58 5d5d  X]/2),endval[X]]
-0004ffe0: 290d 0a20 2020 2065 6c73 6520 3a0d 0a20  )..    else :.. 
-0004fff0: 2020 2020 2020 2078 6564 6765 7320 3d20         xedges = 
-00050000: 7865 6467 6573 2b64 656c 7461 5b58 5d2f  xedges+delta[X]/
-00050010: 320d 0a20 2020 2020 2020 2078 6564 6765  2..        xedge
-00050020: 7320 3d20 7865 6467 6573 5b3a 6c65 6e28  s = xedges[:len(
-00050030: 7865 6467 6573 292d 315d 0d0a 2020 2020  xedges)-1]..    
-00050040: 6966 2079 626e 6420 3a0d 0a20 2020 2020  if ybnd :..     
-00050050: 2020 207a 6572 6f73 203d 206e 702e 7a65     zeros = np.ze
-00050060: 726f 7328 2028 5a76 616c 732e 7368 6170  ros( (Zvals.shap
-00050070: 655b 585d 2c5a 7661 6c73 2e73 6861 7065  e[X],Zvals.shape
-00050080: 5b59 5d2b 3229 2029 0d0a 2020 2020 2020  [Y]+2) )..      
-00050090: 2020 7a65 726f 735b 3a2c 313a 6269 6e73    zeros[:,1:bins
-000500a0: 5b59 5d2b 315d 203d 205a 7661 6c73 0d0a  [Y]+1] = Zvals..
-000500b0: 2020 2020 2020 2020 5a76 616c 7320 3d20          Zvals = 
-000500c0: 7a65 726f 730d 0a20 2020 2020 2020 2079  zeros..        y
-000500d0: 6564 6765 7320 3d20 6e70 2e61 7272 6179  edges = np.array
-000500e0: 285b 2a28 7965 6467 6573 2d64 656c 7461  ([*(yedges-delta
-000500f0: 5b59 5d2f 3229 2c65 6e64 7661 6c5b 595d  [Y]/2),endval[Y]
-00050100: 5d29 0d0a 2020 2020 656c 7365 203a 0d0a  ])..    else :..
-00050110: 2020 2020 2020 2020 7965 6467 6573 203d          yedges =
-00050120: 2079 6564 6765 732b 6465 6c74 615b 595d   yedges+delta[Y]
-00050130: 2f32 0d0a 2020 2020 2020 2020 7965 6467  /2..        yedg
-00050140: 6573 203d 2079 6564 6765 735b 3a6c 656e  es = yedges[:len
-00050150: 2879 6564 6765 7329 2d31 5d0d 0a20 2020  (yedges)-1]..   
-00050160: 200d 0a20 2020 2069 6620 6973 696e 7374   ..    if isinst
-00050170: 616e 6365 2873 6361 6c65 2c62 6f6f 6c29  ance(scale,bool)
-00050180: 203a 200d 0a20 2020 2020 2020 2073 6361   : ..        sca
-00050190: 6c65 203d 2061 7265 612a 2862 696e 735b  le = area*(bins[
-000501a0: 305d 2a62 696e 735b 315d 292f 6c65 6e28  0]*bins[1])/len(
-000501b0: 7661 6c73 5b30 5d29 2069 6620 7363 616c  vals[0]) if scal
-000501c0: 6520 656c 7365 2031 2e30 0d0a 0d0a 2020  e else 1.0....  
-000501d0: 2020 5a76 616c 7320 3d20 7363 616c 652a    Zvals = scale*
-000501e0: 5a76 616c 732f 6172 6561 0d0a 2020 2020  Zvals/area..    
-000501f0: 6620 3d20 696e 7465 7270 6f6c 6174 652e  f = interpolate.
-00050200: 696e 7465 7270 3264 2879 6564 6765 732c  interp2d(yedges,
-00050210: 7865 6467 6573 2c5a 7661 6c73 2c6b 696e  xedges,Zvals,kin
-00050220: 643d 6b69 6e64 290d 0a0d 0a20 2020 2064  d=kind)....    d
-00050230: 6566 2064 656e 7369 7479 2878 612c 7961  ef density(xa,ya
-00050240: 293a 0d0a 2020 2020 2020 2020 7369 7a65  ):..        size
-00050250: 203d 206d 696e 2820 6c65 6e28 7861 292c   = min( len(xa),
-00050260: 6c65 6e28 7961 2920 290d 0a20 2020 2020  len(ya) )..     
-00050270: 2020 2076 616c 7320 3d20 5b20 6628 7961     vals = [ f(ya
-00050280: 5b69 5d2c 7861 5b69 5d29 5b30 5d20 666f  [i],xa[i])[0] fo
-00050290: 7220 6920 696e 2072 616e 6765 2873 697a  r i in range(siz
-000502a0: 6529 205d 0d0a 2020 2020 2020 2020 7265  e) ]..        re
-000502b0: 7475 726e 206e 702e 6172 7261 7928 7661  turn np.array(va
-000502c0: 6c73 290d 0a0d 0a20 2020 2072 6574 7572  ls)....    retur
-000502d0: 6e20 6465 6e73 6974 790d 0a0d 0a0d 0a0d  n density.......
-000502e0: 0a0d 0a23 203d 3d3d 3d3d 3d3d 3d3d 3d3d  ...# ===========
-000502f0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00050300: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00050310: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00050320: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00050330: 3d3d 3d3d 3d3d 2b0d 0a23 204f 6e6c 7920  ======+..# Only 
-00050340: 7665 7274 6963 6573 2061 6e64 2066 6163  vertices and fac
-00050350: 6520 696e 6469 6365 7320 6172 6520 6578  e indices are ex
-00050360: 706f 7274 6564 2f69 6d70 6f72 7465 642e  ported/imported.
-00050370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00050380: 2020 2020 2020 2020 2020 2020 7c20 200d              |  .
-00050390: 0a23 2046 7574 4465 762c 2069 6e63 6c75  .# FutDev, inclu
-000503a0: 6465 203a 2020 2020 2020 2020 2020 2020  de :            
-000503b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000503c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000503d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000503e0: 2020 2020 7c0d 0a23 2020 2031 2e20 6d65      |..#   1. me
-000503f0: 7461 6461 7461 2020 2020 2020 2020 2020  tadata          
-00050400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00050410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00050420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00050430: 2020 2020 2020 2020 2020 7c0d 0a23 2020            |..#  
-00050440: 2032 2e20 6661 6365 2f76 6572 7465 7820   2. face/vertex 
-00050450: 636f 6c6f 7220 2020 2020 2020 2020 2020  color           
-00050460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00050470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00043ac0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020  ------------..  
+00043ad0: 2020 2020 2020 7365 6744 6972 203d 2073        segDir = s
+00043ae0: 656c 662e 5f67 6574 5f73 6567 6d65 6e74  elf._get_segment
+00043af0: 5f64 6972 6563 7469 6f6e 7328 7365 676d  _directions(segm
+00043b00: 656e 7473 290d 0a20 2020 2020 2020 2075  ents)..        u
+00043b10: 6e69 7444 6972 6563 7469 6f6e 203d 206e  nitDirection = n
+00043b20: 702e 6469 7669 6465 2820 6469 7265 6374  p.divide( direct
+00043b30: 696f 6e2c 206e 702e 6c69 6e61 6c67 2e6e  ion, np.linalg.n
+00043b40: 6f72 6d28 6469 7265 6374 696f 6e29 2029  orm(direction) )
+00043b50: 0d0a 2020 2020 2020 2020 7620 3d20 6e70  ..        v = np
+00043b60: 2e64 6f74 2873 6567 4469 722c 756e 6974  .dot(segDir,unit
+00043b70: 4469 7265 6374 696f 6e29 0d0a 2020 2020  Direction)..    
+00043b80: 2020 2020 6966 2069 7341 6273 203a 2076      if isAbs : v
+00043b90: 203d 202d 6e70 2e61 6273 2876 290d 0a20   = -np.abs(v).. 
+00043ba0: 2020 2020 2020 2076 6d69 6e2c 2076 6d61         vmin, vma
+00043bb0: 7820 3d20 762e 6d69 6e28 292c 2076 2e6d  x = v.min(), v.m
+00043bc0: 6178 2829 0d0a 2020 2020 2020 2020 6e6f  ax()..        no
+00043bd0: 726d 203d 2063 6f6c 6f72 732e 4e6f 726d  rm = colors.Norm
+00043be0: 616c 697a 6528 766d 696e 3d76 2e6d 696e  alize(vmin=v.min
+00043bf0: 2829 2c76 6d61 783d 762e 6d61 7828 2929  (),vmax=v.max())
+00043c00: 0d0a 0d0a 2020 2020 2020 2020 7365 6c66  ....        self
+00043c10: 2e5f 6c65 6467 6563 6f6c 6f72 7320 3d20  ._ledgecolors = 
+00043c20: 636d 5f63 6f6c 6f72 4d61 7028 6e6f 726d  cm_colorMap(norm
+00043c30: 2876 2929 2020 2320 7570 6461 7465 2066  (v))  # update f
+00043c40: 6f72 2076 5f31 2e32 2e30 0d0a 2020 2020  or v_1.2.0..    
+00043c50: 2020 2020 5247 4220 3d20 636d 5f63 6f6c      RGB = cm_col
+00043c60: 6f72 4d61 7028 6e6f 726d 2876 2929 0d0a  orMap(norm(v))..
+00043c70: 2020 2020 2020 2020 7365 6c66 2e73 6574          self.set
+00043c80: 5f63 6f6c 6f72 2852 4742 2920 2023 203c  _color(RGB)  # <
+00043c90: 3c3c 3c3c 3c3c 3c3c 3c3c 3c3c 3c3c 3c3c  <<<<<<<<<<<<<<<<
+00043ca0: 3c3c 3c3c 3c3c 2064 6562 7567 0d0a 0d0a  <<<<<< debug....
+00043cb0: 2020 2020 2020 2020 7365 6c66 2e73 6567          self.seg
+00043cc0: 5661 6c75 6573 203d 2076 0d0a 2020 2020  Values = v..    
+00043cd0: 2020 2020 7365 6c66 2e5f 626f 756e 6473      self._bounds
+00043ce0: 5b27 766c 696d 275d 203d 205b 2076 6d69  ['vlim'] = [ vmi
+00043cf0: 6e2c 2076 6d61 7820 5d20 0d0a 2020 2020  n, vmax ] ..    
+00043d00: 2020 2020 2320 2e2e 2e2e 2e2e 2e2e 2e2e      # ..........
+00043d10: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00043d20: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00043d30: 2e2e 2e0d 0a20 2020 2020 2020 2073 656c  .....        sel
+00043d40: 662e 5f6d 6170 5f63 6d61 705f 6672 6f6d  f._map_cmap_from
+00043d50: 5f64 6972 6563 7469 6f6e 5f76 6572 7428  _direction_vert(
+00043d60: 2073 656c 662e 5f6c 6564 6765 636f 6c6f   self._ledgecolo
+00043d70: 7273 2c20 7365 6c66 2e73 6567 5661 6c75  rs, self.segValu
+00043d80: 6573 2c20 7365 6c66 2e5f 626f 756e 6473  es, self._bounds
+00043d90: 5b27 766c 696d 275d 2029 2020 2320 7570  ['vlim'] )  # up
+00043da0: 6461 7465 2066 6f72 2076 5f31 2e32 2e30  date for v_1.2.0
+00043db0: 0d0a 2020 2020 2020 2020 2320 2e2e 2e2e  ..        # ....
+00043dc0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00043dd0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00043de0: 2e2e 2e2e 2e2e 2e2e 2e0d 0a20 2020 2020  ...........     
+00043df0: 2020 2072 6574 7572 6e20 7365 6c66 0d0a     return self..
+00043e00: 0d0a 2020 2020 6465 6620 6d61 705f 636d  ..    def map_cm
+00043e10: 6170 5f66 726f 6d5f 6461 7461 6772 6964  ap_from_datagrid
+00043e20: 2873 656c 662c 2064 6174 6167 7269 642c  (self, datagrid,
+00043e30: 2063 6d61 703d 4e6f 6e65 2c20 636e 616d   cmap=None, cnam
+00043e40: 653d 4e6f 6e65 2029 203a 0d0a 2020 2020  e=None ) :..    
+00043e50: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
+00043e60: 204c 696e 6520 636f 6c6f 7220 6173 7369   Line color assi
+00043e70: 676e 6d65 6e74 2075 7369 6e67 2061 2032  gnment using a 2
+00043e80: 4420 6461 7461 6772 6964 2e0d 0a0d 0a20  D datagrid..... 
+00043e90: 2020 2020 2020 2044 6174 6167 7269 6420         Datagrid 
+00043ea0: 7661 6c75 6573 2061 7265 206e 6f72 6d61  values are norma
+00043eb0: 6c69 7a65 6420 696e 2074 6865 2072 616e  lized in the ran
+00043ec0: 6765 2030 2074 6f20 312e 0d0a 0d0a 2020  ge 0 to 1.....  
+00043ed0: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+00043ee0: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
+00043ef0: 2d2d 2d2d 0d0a 2020 2020 2020 2020 6461  ----..        da
+00043f00: 7461 6772 6964 203a 2032 4420 666c 6f61  tagrid : 2D floa
+00043f10: 7420 6172 7261 790d 0a0d 0a20 2020 2020  t array....     
+00043f20: 2020 2063 6d61 7020 3a20 7374 7220 6f72     cmap : str or
+00043f30: 2043 6f6c 6f72 6d61 702c 206f 7074 696f   Colormap, optio
+00043f40: 6e61 6c0d 0a20 2020 2020 2020 2020 2020  nal..           
+00043f50: 2041 2043 6f6c 6f72 6d61 7020 696e 7374   A Colormap inst
+00043f60: 616e 6365 206f 7220 7265 6769 7374 6572  ance or register
+00043f70: 6564 2063 6f6c 6f72 6d61 7020 6e61 6d65  ed colormap name
+00043f80: 2e0d 0a20 2020 2020 2020 2020 2020 2049  ...            I
+00043f90: 6620 6e6f 7420 6173 7369 676e 6564 2c20  f not assigned, 
+00043fa0: 7468 6520 7375 7266 6163 6520 436f 6c6f  the surface Colo
+00043fb0: 726d 6170 2069 7320 7573 6564 2e0d 0a20  rmap is used... 
+00043fc0: 2020 2020 2020 2020 2020 2054 6865 2063             The c
+00043fd0: 6f6c 6f72 6d61 7020 6d61 7073 2074 6865  olormap maps the
+00043fe0: 2064 6174 6167 7269 6420 7661 6c75 6573   datagrid values
+00043ff0: 2074 6f20 636f 6c6f 7273 2e0d 0a0d 0a20   to colors..... 
+00044000: 2020 2020 2020 2063 6e61 6d65 203a 2073         cname : s
+00044010: 7472 696e 672c 206f 7074 696f 6e61 6c2c  tring, optional,
+00044020: 2064 6566 6175 6c74 3a20 4e6f 6e65 2e0d   default: None..
+00044030: 0a20 2020 2020 2020 2020 2020 2044 6573  .            Des
+00044040: 6372 6970 7469 7665 2069 6465 6e74 6966  criptive identif
+00044050: 6965 7220 666f 7220 7661 6c75 6573 2069  ier for values i
+00044060: 6e64 6963 6174 6564 2062 7920 636f 6c6f  ndicated by colo
+00044070: 722e 0d0a 0d0a 2020 2020 2020 2020 5265  r.....        Re
+00044080: 7475 726e 730d 0a20 2020 2020 2020 202d  turns..        -
+00044090: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
+000440a0: 7365 6c66 203a 206c 696e 6520 6f62 6a65  self : line obje
+000440b0: 6374 0d0a 0d0a 2020 2020 2020 2020 2222  ct....        ""
+000440c0: 220d 0a0d 0a20 2020 2020 2020 2064 6174  "....        dat
+000440d0: 6120 3d20 6461 7461 6772 6964 0d0a 2020  a = datagrid..  
+000440e0: 2020 2020 2020 646d 6178 203d 206e 702e        dmax = np.
+000440f0: 616d 6178 2864 6174 6167 7269 6429 0d0a  amax(datagrid)..
+00044100: 2020 2020 2020 2020 646d 696e 203d 206e          dmin = n
+00044110: 702e 616d 696e 2864 6174 6167 7269 6429  p.amin(datagrid)
+00044120: 0d0a 2020 2020 2020 2020 6465 6c74 6120  ..        delta 
+00044130: 3d20 646d 6178 2d64 6d69 6e0d 0a20 2020  = dmax-dmin..   
+00044140: 2020 2020 2064 6174 6120 3d20 2864 6174       data = (dat
+00044150: 6167 7269 6420 2d20 646d 696e 292f 6465  agrid - dmin)/de
+00044160: 6c74 610d 0a20 2020 2020 2020 2078 6420  lta..        xd 
+00044170: 3d20 6e70 2e6c 696e 7370 6163 6528 2d31  = np.linspace(-1
+00044180: 2c20 312c 2064 6174 612e 7368 6170 655b  , 1, data.shape[
+00044190: 305d 2029 0d0a 2020 2020 2020 2020 7964  0] )..        yd
+000441a0: 203d 206e 702e 6c69 6e73 7061 6365 282d   = np.linspace(-
+000441b0: 312c 2031 2c20 6461 7461 2e73 6861 7065  1, 1, data.shape
+000441c0: 5b31 5d20 290d 0a20 2020 2020 2020 2067  [1] )..        g
+000441d0: 203d 2020 696e 7465 7270 6f6c 6174 652e   =  interpolate.
+000441e0: 696e 7465 7270 3264 2879 642c 2078 642c  interp2d(yd, xd,
+000441f0: 2064 6174 612c 206b 696e 643d 2763 7562   data, kind='cub
+00044200: 6963 2729 0d0a 0d0a 2020 2020 2020 2020  ic')....        
+00044210: 2320 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  # --------------
+00044220: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00044230: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020  -----------..   
+00044240: 2020 2020 2069 6620 636d 6170 2069 7320       if cmap is 
+00044250: 6e6f 7420 4e6f 6e65 203a 0d0a 2020 2020  not None :..    
+00044260: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+00044270: 7461 6e63 6528 636d 6170 2c73 7472 2920  tance(cmap,str) 
+00044280: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
+00044290: 2020 2020 7365 6c66 2e73 6574 5f63 6d61      self.set_cma
+000442a0: 7028 636d 2e67 6574 5f63 6d61 7028 636d  p(cm.get_cmap(cm
+000442b0: 6170 2929 0d0a 2020 2020 2020 2020 2020  ap))..          
+000442c0: 2020 656c 7365 203a 0d0a 2020 2020 2020    else :..      
+000442d0: 2020 2020 2020 2020 2020 7365 6c66 2e73            self.s
+000442e0: 6574 5f63 6d61 7028 636d 6170 290d 0a20  et_cmap(cmap).. 
+000442f0: 2020 2020 2020 2063 6d5f 636f 6c6f 724d         cm_colorM
+00044300: 6170 203d 2073 656c 662e 6765 745f 636d  ap = self.get_cm
+00044310: 6170 2829 0d0a 0d0a 2020 2020 2020 2020  ap()....        
+00044320: 7365 6c66 2e76 616c 7565 734e 616d 6520  self.valuesName 
+00044330: 3d20 636e 616d 650d 0a0d 0a20 2020 2020  = cname....     
+00044340: 2020 2023 202d 2d2d 2d2d 2d2d 2d2d 2d2d     # -----------
+00044350: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00044360: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a  --------------..
+00044370: 2020 2020 2020 2020 7365 676d 656e 7473          segments
+00044380: 203d 2073 656c 662e 5f73 6567 6d65 6e74   = self._segment
+00044390: 7333 640d 0a20 2020 2020 2020 2069 6620  s3d..        if 
+000443a0: 6e6f 7420 7365 6c66 2e69 7353 6872 6564  not self.isShred
+000443b0: 6465 6420 3a0d 0a20 2020 2020 2020 2020  ded :..         
+000443c0: 2020 2073 6567 6d65 6e74 7320 3d20 7365     segments = se
+000443d0: 6c66 2e5f 7368 7265 6428 290d 0a20 2020  lf._shred()..   
+000443e0: 2020 2020 2023 202d 2d2d 2d2d 2d2d 2d2d       # ---------
+000443f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00044400: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00044410: 0d0a 2020 2020 2020 2020 7365 6743 6f6f  ..        segCoo
+00044420: 7220 3d20 7365 6c66 2e5f 6765 745f 7365  r = self._get_se
+00044430: 676d 656e 745f 6365 6e74 6572 7328 7365  gment_centers(se
+00044440: 676d 656e 7473 290d 0a20 2020 2020 2020  gments)..       
+00044450: 2078 2c79 2c5f 203d 206e 702e 7472 616e   x,y,_ = np.tran
+00044460: 7370 6f73 6528 7365 6743 6f6f 7229 0d0a  spose(segCoor)..
+00044470: 0d0a 2020 2020 2020 2020 2320 6e6f 726d  ..        # norm
+00044480: 616c 697a 6520 7879 2070 6c61 6e65 202d  alize xy plane -
+00044490: 3120 746f 2031 0d0a 2020 2020 2020 2020  1 to 1..        
+000444a0: 7820 3d20 6e70 2e69 6e74 6572 7028 2078  x = np.interp( x
+000444b0: 2c20 2878 2e6d 696e 2829 2c20 782e 6d61  , (x.min(), x.ma
+000444c0: 7828 2929 2c20 282d 312e 302c 2031 2e30  x()), (-1.0, 1.0
+000444d0: 2920 290d 0a20 2020 2020 2020 2079 203d  ) )..        y =
+000444e0: 206e 702e 696e 7465 7270 2820 792c 2028   np.interp( y, (
+000444f0: 792e 6d69 6e28 292c 2079 2e6d 6178 2829  y.min(), y.max()
+00044500: 292c 2028 2d31 2e30 2c20 312e 3029 2029  ), (-1.0, 1.0) )
+00044510: 0d0a 0d0a 2020 2020 2020 2020 7472 6961  ....        tria
+00044520: 6c20 3d20 5b20 6728 2078 5b69 5d2c 795b  l = [ g( x[i],y[
+00044530: 695d 295b 305d 2066 6f72 2069 2069 6e20  i])[0] for i in 
+00044540: 7261 6e67 6528 6c65 6e28 7829 2920 5d0d  range(len(x)) ].
+00044550: 0a0d 0a20 2020 2020 2020 2076 203d 206e  ...        v = n
+00044560: 702e 6172 7261 7928 7472 6961 6c29 2a64  p.array(trial)*d
+00044570: 656c 7461 202b 2064 6d69 6e0d 0a20 2020  elta + dmin..   
+00044580: 2020 2020 2076 6d69 6e2c 2076 6d61 7820       vmin, vmax 
+00044590: 3d20 762e 6d69 6e28 292c 2076 2e6d 6178  = v.min(), v.max
+000445a0: 2829 0d0a 2020 2020 2020 2020 6e6f 726d  ()..        norm
+000445b0: 203d 2063 6f6c 6f72 732e 4e6f 726d 616c   = colors.Normal
+000445c0: 697a 6528 766d 696e 3d76 2e6d 696e 2829  ize(vmin=v.min()
+000445d0: 2c76 6d61 783d 762e 6d61 7828 2929 0d0a  ,vmax=v.max())..
+000445e0: 0d0a 2020 2020 2020 2020 7365 6c66 2e5f  ..        self._
+000445f0: 6c65 6467 6563 6f6c 6f72 7320 3d20 636d  ledgecolors = cm
+00044600: 5f63 6f6c 6f72 4d61 7028 6e6f 726d 2876  _colorMap(norm(v
+00044610: 2929 2020 2320 7570 6461 7465 2066 6f72  ))  # update for
+00044620: 2076 5f31 2e32 2e30 0d0a 2020 2020 2020   v_1.2.0..      
+00044630: 2020 5247 4220 3d20 636d 5f63 6f6c 6f72    RGB = cm_color
+00044640: 4d61 7028 6e6f 726d 2876 2929 0d0a 2020  Map(norm(v))..  
+00044650: 2020 2020 2020 7365 6c66 2e73 6574 5f63        self.set_c
+00044660: 6f6c 6f72 2852 4742 2920 2023 203c 3c3c  olor(RGB)  # <<<
+00044670: 3c3c 3c3c 3c3c 3c3c 3c3c 3c3c 3c3c 3c3c  <<<<<<<<<<<<<<<<
+00044680: 3c3c 3c3c 2064 6562 7567 0d0a 0d0a 2020  <<<< debug....  
+00044690: 2020 2020 2020 7365 6c66 2e73 6567 5661        self.segVa
+000446a0: 6c75 6573 203d 2076 0d0a 2020 2020 2020  lues = v..      
+000446b0: 2020 7365 6c66 2e5f 626f 756e 6473 5b27    self._bounds['
+000446c0: 766c 696d 275d 203d 205b 2076 6d69 6e2c  vlim'] = [ vmin,
+000446d0: 2076 6d61 7820 5d20 0d0a 0d0a 2020 2020   vmax ] ....    
+000446e0: 2020 2020 2320 2e2e 2e2e 2e2e 2e2e 2e2e      # ..........
+000446f0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00044700: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00044710: 2e2e 2e0d 0a20 2020 2020 2020 2073 656c  .....        sel
+00044720: 662e 5f6d 6170 5f63 6d61 705f 6672 6f6d  f._map_cmap_from
+00044730: 5f64 6174 6167 7269 645f 7665 7274 2867  _datagrid_vert(g
+00044740: 2c20 6465 6c74 612c 2064 6d69 6e2c 2063  , delta, dmin, c
+00044750: 6d5f 636f 6c6f 724d 6170 290d 0a20 2020  m_colorMap)..   
+00044760: 2020 2020 2023 202e 2e2e 2e2e 2e2e 2e2e       # .........
+00044770: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00044780: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00044790: 2e2e 2e2e 0d0a 0d0a 2020 2020 2020 2020  ........        
+000447a0: 7265 7475 726e 2073 656c 660d 0a0d 0a20  return self.... 
+000447b0: 2020 2064 6566 206d 6170 5f63 6d61 705f     def map_cmap_
+000447c0: 6672 6f6d 5f6f 7028 2073 656c 662c 206f  from_op( self, o
+000447d0: 7065 7261 7469 6f6e 2c20 636d 6170 3d4e  peration, cmap=N
+000447e0: 6f6e 652c 2063 6e61 6d65 3d4e 6f6e 6520  one, cname=None 
+000447f0: 2920 3a0d 0a20 2020 2020 2020 2022 2222  ) :..        """
+00044800: 0d0a 2020 2020 2020 2020 4675 6e63 7469  ..        Functi
+00044810: 6f6e 616c 2061 7373 6967 6e6d 656e 7420  onal assignment 
+00044820: 6f66 2061 2063 6f6c 6f72 2066 726f 6d20  of a color from 
+00044830: 6120 636f 6c6f 7220 6d61 702e 0d0a 0d0a  a color map.....
+00044840: 2020 2020 2020 2020 4c69 6e65 2073 6567          Line seg
+00044850: 6d65 6e74 2063 656e 7465 7220 636f 6f72  ment center coor
+00044860: 6469 6e61 7465 7320 6172 6520 7573 6564  dinates are used
+00044870: 2074 6f20 6361 6c63 756c 6174 6520 6120   to calculate a 
+00044880: 7363 616c 6172 2077 6869 6368 0d0a 2020  scalar which..  
+00044890: 2020 2020 2020 6973 2074 6865 6e20 7573        is then us
+000448a0: 6564 2074 6f20 6173 7369 676e 2073 6567  ed to assign seg
+000448b0: 6d65 6e74 2063 6f6c 6f72 7320 6672 6f6d  ment colors from
+000448c0: 2061 2063 6f6c 6f72 6d61 702e 0d0a 0d0a   a colormap.....
+000448d0: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+000448e0: 7273 0d0a 2020 2020 2020 2020 2d2d 2d2d  rs..        ----
+000448f0: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
+00044900: 6f70 6572 6174 696f 6e20 3a20 6675 6e63  operation : func
+00044910: 7469 6f6e 206f 626a 6563 740d 0a20 2020  tion object..   
+00044920: 2020 2020 2020 2020 2046 756e 6374 696f           Functio
+00044930: 6e20 7468 6174 2074 616b 6573 206f 6e65  n that takes one
+00044940: 2061 7267 756d 656e 742c 0d0a 2020 2020   argument,..    
+00044950: 2020 2020 2020 2020 6120 3378 4e20 4e75          a 3xN Nu
+00044960: 6d70 7920 6172 7261 7920 6f66 206e 6174  mpy array of nat
+00044970: 6976 6520 636f 6f72 6469 6e61 7465 732e  ive coordinates.
+00044980: 0d0a 2020 2020 2020 2020 2020 2020 5468  ..            Th
+00044990: 6520 6675 6e63 7469 6f6e 2072 6574 7572  e function retur
+000449a0: 6e73 2061 204e 756d 7079 2061 7272 6179  ns a Numpy array
+000449b0: 206f 6620 7363 616c 6172 2076 616c 7565   of scalar value
+000449c0: 732e 0d0a 0d0a 2020 2020 2020 2020 636d  s.....        cm
+000449d0: 6170 203a 2073 7472 206f 7220 436f 6c6f  ap : str or Colo
+000449e0: 726d 6170 2c20 6f70 7469 6f6e 616c 2c20  rmap, optional, 
+000449f0: 6465 6661 756c 743a 2027 7669 7269 6469  default: 'viridi
+00044a00: 7327 0d0a 2020 2020 2020 2020 2020 2020  s'..            
+00044a10: 4120 436f 6c6f 726d 6170 2069 6e73 7461  A Colormap insta
+00044a20: 6e63 6520 6f72 2072 6567 6973 7465 7265  nce or registere
+00044a30: 6420 636f 6c6f 726d 6170 206e 616d 652e  d colormap name.
+00044a40: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+00044a50: 2020 2020 636e 616d 6520 3a20 7374 722c      cname : str,
+00044a60: 206f 7074 696f 6e61 6c2c 2064 6566 6175   optional, defau
+00044a70: 6c74 3a20 6675 6e63 7469 6f6e 206f 626a  lt: function obj
+00044a80: 6563 7420 6e61 6d65 0d0a 2020 2020 2020  ect name..      
+00044a90: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
+00044aa0: 2061 206c 616d 6264 6120 6675 6e63 7469   a lambda functi
+00044ab0: 6f6e 2c20 6f74 6865 7277 6973 6520 2727  on, otherwise ''
+00044ac0: 2e0d 0a20 2020 2020 2020 2020 2020 2020  ...             
+00044ad0: 2020 2049 6465 6e74 6966 6965 7220 666f     Identifier fo
+00044ae0: 7220 7468 6520 636f 6c6f 7220 7661 6c75  r the color valu
+00044af0: 6573 2e0d 0a0d 0a20 2020 2020 2020 2052  es.....        R
+00044b00: 6574 7572 6e73 0d0a 2020 2020 2020 2020  eturns..        
+00044b10: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
+00044b20: 2073 656c 6620 3a20 6c69 6e65 206f 626a   self : line obj
+00044b30: 6563 740d 0a0d 0a20 2020 2020 2020 2022  ect....        "
+00044b40: 2222 2020 2020 2020 200d 0a20 2020 2020  ""       ..     
+00044b50: 2020 2063 6e61 6d65 203d 205f 6765 7446     cname = _getF
+00044b60: 756e 6374 696f 6e4e 616d 6528 6f70 6572  unctionName(oper
+00044b70: 6174 696f 6e2c 636e 616d 6529 0d0a 2020  ation,cname)..  
+00044b80: 2020 2020 2020 6966 2063 6e61 6d65 2069        if cname i
+00044b90: 7320 6e6f 7420 4e6f 6e65 203a 2073 656c  s not None : sel
+00044ba0: 662e 7661 6c75 6573 4e61 6d65 203d 2063  f.valuesName = c
+00044bb0: 6e61 6d65 0d0a 0d0a 2020 2020 2020 2020  name....        
+00044bc0: 6966 2063 6d61 7020 6973 206e 6f74 204e  if cmap is not N
+00044bd0: 6f6e 6520 3a0d 0a20 2020 2020 2020 2020  one :..         
+00044be0: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+00044bf0: 2863 6d61 702c 7374 7229 203a 200d 0a20  (cmap,str) : .. 
+00044c00: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00044c10: 656c 662e 7365 745f 636d 6170 2863 6d2e  elf.set_cmap(cm.
+00044c20: 6765 745f 636d 6170 2863 6d61 7029 290d  get_cmap(cmap)).
+00044c30: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+00044c40: 6520 3a0d 0a20 2020 2020 2020 2020 2020  e :..           
+00044c50: 2020 2020 2073 656c 662e 7365 745f 636d       self.set_cm
+00044c60: 6170 2863 6d61 7029 0d0a 2020 2020 2020  ap(cmap)..      
+00044c70: 2020 636d 5f63 6f6c 6f72 4d61 7020 3d20    cm_colorMap = 
+00044c80: 7365 6c66 2e67 6574 5f63 6d61 7028 290d  self.get_cmap().
+00044c90: 0a0d 0a20 2020 2020 2020 2023 202d 2d2d  ...        # ---
+00044ca0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00044cb0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00044cc0: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
+00044cd0: 7365 676d 656e 7473 203d 2073 656c 662e  segments = self.
+00044ce0: 5f73 6567 6d65 6e74 7333 640d 0a20 2020  _segments3d..   
+00044cf0: 2020 2020 2069 6620 6e6f 7420 7365 6c66       if not self
+00044d00: 2e69 7353 6872 6564 6465 6420 3a0d 0a20  .isShredded :.. 
+00044d10: 2020 2020 2020 2020 2020 2073 6567 6d65             segme
+00044d20: 6e74 7320 3d20 7365 6c66 2e5f 7368 7265  nts = self._shre
+00044d30: 6428 290d 0a20 2020 2020 2020 2023 202d  d()..        # -
+00044d40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00044d50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00044d60: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
+00044d70: 2020 7365 6743 6f6f 7220 3d20 7365 6c66    segCoor = self
+00044d80: 2e5f 6765 745f 7365 676d 656e 745f 6365  ._get_segment_ce
+00044d90: 6e74 6572 7328 7365 676d 656e 7473 290d  nters(segments).
+00044da0: 0a20 2020 2020 2020 2023 202e 2e2e 2e2e  .        # .....
+00044db0: 0d0a 2020 2020 2020 2020 7879 7a20 3d20  ..        xyz = 
+00044dc0: 6e70 2e74 7261 6e73 706f 7365 2873 6567  np.transpose(seg
+00044dd0: 436f 6f72 290d 0a20 2020 2020 2020 2076  Coor)..        v
+00044de0: 203d 206e 702e 6172 7261 7928 6f70 6572   = np.array(oper
+00044df0: 6174 696f 6e28 7879 7a29 290d 0a20 2020  ation(xyz))..   
+00044e00: 2020 2020 2076 6d69 6e2c 2076 6d61 7820       vmin, vmax 
+00044e10: 3d20 762e 6d69 6e28 292c 2076 2e6d 6178  = v.min(), v.max
+00044e20: 2829 0d0a 2020 2020 2020 2020 6e6f 726d  ()..        norm
+00044e30: 203d 2063 6f6c 6f72 732e 4e6f 726d 616c   = colors.Normal
+00044e40: 697a 6528 766d 696e 3d76 2e6d 696e 2829  ize(vmin=v.min()
+00044e50: 2c76 6d61 783d 762e 6d61 7828 2929 0d0a  ,vmax=v.max())..
+00044e60: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+00044e70: 2020 7365 6c66 2e5f 6c65 6467 6563 6f6c    self._ledgecol
+00044e80: 6f72 7320 3d20 636d 5f63 6f6c 6f72 4d61  ors = cm_colorMa
+00044e90: 7028 6e6f 726d 2876 2929 2020 2320 7570  p(norm(v))  # up
+00044ea0: 6461 7465 2066 6f72 2076 5f31 2e32 2e30  date for v_1.2.0
+00044eb0: 0d0a 2020 2020 2020 2020 5247 4220 3d20  ..        RGB = 
+00044ec0: 636d 5f63 6f6c 6f72 4d61 7028 6e6f 726d  cm_colorMap(norm
+00044ed0: 2876 2929 0d0a 2020 2020 2020 2020 7365  (v))..        se
+00044ee0: 6c66 2e73 6574 5f63 6f6c 6f72 2852 4742  lf.set_color(RGB
+00044ef0: 2920 2023 203c 3c3c 3c3c 3c3c 3c3c 3c3c  )  # <<<<<<<<<<<
+00044f00: 3c3c 3c3c 3c3c 3c3c 3c3c 3c3c 2064 6562  <<<<<<<<<<<< deb
+00044f10: 7567 0d0a 0d0a 2020 2020 2020 2020 7365  ug....        se
+00044f20: 6c66 2e73 6567 5661 6c75 6573 203d 2076  lf.segValues = v
+00044f30: 0d0a 2020 2020 2020 2020 7365 6c66 2e5f  ..        self._
+00044f40: 626f 756e 6473 5b27 766c 696d 275d 203d  bounds['vlim'] =
+00044f50: 205b 2076 6d69 6e2c 2076 6d61 7820 5d20   [ vmin, vmax ] 
+00044f60: 0d0a 2020 2020 2020 2020 2320 3d3d 3d3d  ..        # ====
+00044f70: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00044f80: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00044f90: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00044fa0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00044fb0: 3d3d 3d3d 0d0a 2020 2020 2020 2020 7365  ====..        se
+00044fc0: 6c66 2e5f 6d61 705f 636d 6170 5f66 726f  lf._map_cmap_fro
+00044fd0: 6d5f 6f70 5f76 6572 7428 6f70 6572 6174  m_op_vert(operat
+00044fe0: 696f 6e2c 2063 6d5f 636f 6c6f 724d 6170  ion, cm_colorMap
+00044ff0: 290d 0a20 2020 2020 2020 2023 203d 3d3d  )..        # ===
+00045000: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00045010: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00045020: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00045030: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00045040: 3d3d 3d3d 3d0d 0a20 2020 2020 2020 2072  =====..        r
+00045050: 6574 7572 6e20 7365 6c66 2020 2020 0d0a  eturn self    ..
+00045060: 0d0a 2020 2020 6465 6620 6d61 705f 636f  ..    def map_co
+00045070: 6c6f 725f 6672 6f6d 5f6f 7028 2073 656c  lor_from_op( sel
+00045080: 662c 206f 7065 7261 7469 6f6e 2c20 7267  f, operation, rg
+00045090: 623d 5472 7565 2c20 636e 616d 653d 4e6f  b=True, cname=No
+000450a0: 6e65 2029 203a 0d0a 2020 2020 2020 2020  ne ) :..        
+000450b0: 2222 220d 0a20 2020 2020 2020 2041 7373  """..        Ass
+000450c0: 6967 6e6d 656e 7420 6f66 206c 696e 6520  ignment of line 
+000450d0: 636f 6c6f 7220 6672 6f6d 2061 2066 756e  color from a fun
+000450e0: 6374 696f 6e2e 0d0a 0d0a 2020 2020 2020  ction.....      
+000450f0: 2020 4c69 6e65 2073 6567 6d65 6e74 2063    Line segment c
+00045100: 6f6c 6f72 7320 6172 6520 6173 7369 676e  olors are assign
+00045110: 6564 2066 726f 6d20 6120 6675 6e63 7469  ed from a functi
+00045120: 6f6e 206f 6620 6c69 6e65 2020 0d0a 2020  on of line  ..  
+00045130: 2020 2020 2020 7365 676d 656e 7420 6365        segment ce
+00045140: 6e74 6572 2063 6f6f 7264 696e 6174 6573  nter coordinates
+00045150: 2e0d 0a0d 0a20 2020 2020 2020 2050 6172  .....        Par
+00045160: 616d 6574 6572 730d 0a20 2020 2020 2020  ameters..       
+00045170: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
+00045180: 2020 2020 206f 7065 7261 7469 6f6e 203a       operation :
+00045190: 2066 756e 6374 696f 6e20 6f62 6a65 6374   function object
+000451a0: 0d0a 2020 2020 2020 2020 2020 2020 4675  ..            Fu
+000451b0: 6e63 7469 6f6e 2074 6861 7420 7461 6b65  nction that take
+000451c0: 7320 6f6e 6520 6172 6775 6d65 6e74 2c0d  s one argument,.
+000451d0: 0a20 2020 2020 2020 2020 2020 2061 2033  .            a 3
+000451e0: 784e 204e 756d 7079 2061 7272 6179 206f  xN Numpy array o
+000451f0: 6620 6e61 7469 7665 2063 6f6f 7264 696e  f native coordin
+00045200: 6174 6573 2e0d 0a20 2020 2020 2020 2020  ates...         
+00045210: 2020 2054 6865 2066 756e 6374 696f 6e20     The function 
+00045220: 7265 7475 726e 7320 6120 3378 4e20 636f  returns a 3xN co
+00045230: 6c6f 7220 7661 6c75 652e 0d0a 0d0a 2020  lor value.....  
+00045240: 2020 2020 2020 7267 6220 3a20 626f 6f6c        rgb : bool
+00045250: 207b 5472 7565 2c20 4661 6c73 657d 2c20   {True, False}, 
+00045260: 6f70 7469 6f6e 616c 2c20 6465 6661 756c  optional, defaul
+00045270: 743a 2054 7275 650d 0a20 2020 2020 2020  t: True..       
+00045280: 2020 2020 2042 7920 6465 6661 756c 742c       By default,
+00045290: 2052 4742 2063 6f6c 6f72 2076 616c 7565   RGB color value
+000452a0: 7320 6172 6520 7265 7475 726e 6564 2062  s are returned b
+000452b0: 7920 7468 650d 0a20 2020 2020 2020 2020  y the..         
+000452c0: 2020 206f 7065 7261 7469 6f6e 2066 756e     operation fun
+000452d0: 6374 696f 6e2e 2020 4966 2073 6574 2046  ction.  If set F
+000452e0: 616c 7365 2c20 7468 6520 6f70 6572 6174  alse, the operat
+000452f0: 696f 6e0d 0a20 2020 2020 2020 2020 2020  ion..           
+00045300: 2072 6574 7572 6e73 2048 5356 2063 6f6c   returns HSV col
+00045310: 6f72 2076 616c 7565 732e 0d0a 2020 2020  or values...    
+00045320: 2020 2020 0d0a 2020 2020 2020 2020 636e      ..        cn
+00045330: 616d 6520 3a20 7374 722c 206f 7074 696f  ame : str, optio
+00045340: 6e61 6c2c 2064 6566 6175 6c74 3a20 6675  nal, default: fu
+00045350: 6e63 7469 6f6e 206f 626a 6563 7420 6e61  nction object na
+00045360: 6d65 0d0a 2020 2020 2020 2020 2020 2020  me..            
+00045370: 2020 2020 6966 206e 6f74 2061 206c 616d      if not a lam
+00045380: 6264 6120 6675 6e63 7469 6f6e 2c20 6f74  bda function, ot
+00045390: 6865 7277 6973 6520 2727 2e0d 0a20 2020  herwise ''...   
+000453a0: 2020 2020 2020 2020 2020 2020 2049 6465               Ide
+000453b0: 6e74 6966 6965 7220 666f 7220 7468 6520  ntifier for the 
+000453c0: 636f 6c6f 7220 7661 6c75 6573 2e0d 0a20  color values... 
+000453d0: 2020 2020 2020 2020 2020 2020 2020 200d                 .
+000453e0: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+000453f0: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
+00045400: 2d0d 0a20 2020 2020 2020 2073 656c 6620  -..        self 
+00045410: 3a20 6c69 6e65 206f 626a 6563 740d 0a0d  : line object...
+00045420: 0a20 2020 2020 2020 2022 2222 2020 2020  .        """    
+00045430: 2020 200d 0a20 2020 2020 2020 2063 6e61     ..        cna
+00045440: 6d65 203d 205f 6765 7446 756e 6374 696f  me = _getFunctio
+00045450: 6e4e 616d 6528 6f70 6572 6174 696f 6e2c  nName(operation,
+00045460: 636e 616d 6529 0d0a 2020 2020 2020 2020  cname)..        
+00045470: 6966 2063 6e61 6d65 2069 7320 6e6f 7420  if cname is not 
+00045480: 4e6f 6e65 203a 2073 656c 662e 7661 6c75  None : self.valu
+00045490: 6573 4e61 6d65 203d 2063 6e61 6d65 0d0a  esName = cname..
+000454a0: 2020 2020 2020 2020 2320 2d2d 2d2d 2d2d          # ------
+000454b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000454c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000454d0: 2d2d 2d0d 0a20 2020 2020 2020 2073 6567  ---..        seg
+000454e0: 6d65 6e74 7320 3d20 7365 6c66 2e5f 7365  ments = self._se
+000454f0: 676d 656e 7473 3364 0d0a 2020 2020 2020  gments3d..      
+00045500: 2020 6966 206e 6f74 2073 656c 662e 6973    if not self.is
+00045510: 5368 7265 6464 6564 203a 0d0a 2020 2020  Shredded :..    
+00045520: 2020 2020 2020 2020 7365 676d 656e 7473          segments
+00045530: 203d 7365 6c66 2e5f 7368 7265 6428 290d   =self._shred().
+00045540: 0a20 2020 2020 2020 2023 202d 2d2d 2d2d  .        # -----
+00045550: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00045560: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00045570: 2d2d 2d2d 0d0a 2020 2020 2020 2020 7365  ----..        se
+00045580: 6743 6f6f 7220 3d20 7365 6c66 2e5f 6765  gCoor = self._ge
+00045590: 745f 7365 676d 656e 745f 6365 6e74 6572  t_segment_center
+000455a0: 7328 7365 676d 656e 7473 290d 0a0d 0a20  s(segments).... 
+000455b0: 2020 2020 2020 2078 797a 203d 206e 702e         xyz = np.
+000455c0: 7472 616e 7370 6f73 6528 7365 6743 6f6f  transpose(segCoo
+000455d0: 7229 0d0a 2020 2020 2020 2020 636f 6c6f  r)..        colo
+000455e0: 7273 203d 206e 702e 6172 7261 7928 6f70  rs = np.array(op
+000455f0: 6572 6174 696f 6e28 7879 7a29 290d 0a20  eration(xyz)).. 
+00045600: 2020 2020 2020 2063 6f6c 6f72 7320 3d20         colors = 
+00045610: 6e70 2e74 7261 6e73 706f 7365 2863 6f6c  np.transpose(col
+00045620: 6f72 7329 0d0a 2020 2020 2020 2020 636f  ors)..        co
+00045630: 6c6f 7273 203d 206e 702e 636c 6970 2863  lors = np.clip(c
+00045640: 6f6c 6f72 732c 302c 3129 0d0a 2020 2020  olors,0,1)..    
+00045650: 2020 2020 6966 2072 6762 203a 2052 4742      if rgb : RGB
+00045660: 203d 2063 6f6c 6f72 730d 0a20 2020 2020   = colors..     
+00045670: 2020 2065 6c73 6520 3a20 2020 5247 4220     else :   RGB 
+00045680: 3d20 636d 2e63 6f6c 6f72 732e 6873 765f  = cm.colors.hsv_
+00045690: 746f 5f72 6762 2863 6f6c 6f72 7329 0d0a  to_rgb(colors)..
+000456a0: 2020 2020 2020 2020 6966 2052 4742 2e73          if RGB.s
+000456b0: 6861 7065 5b31 5d20 3d3d 2033 203a 0d0a  hape[1] == 3 :..
+000456c0: 2020 2020 2020 2020 2020 2020 6f6e 6573              ones
+000456d0: 203d 206e 702e 6f6e 6573 2852 4742 2e73   = np.ones(RGB.s
+000456e0: 6861 7065 5b30 5d29 5b3a 2c6e 702e 6e65  hape[0])[:,np.ne
+000456f0: 7761 7869 735d 0d0a 2020 2020 2020 2020  waxis]..        
+00045700: 2020 2020 5247 4220 3d20 6e70 2e63 6f6e      RGB = np.con
+00045710: 6361 7465 6e61 7465 2828 5247 422c 6f6e  catenate((RGB,on
+00045720: 6573 292c 6178 6973 3d31 290d 0a20 2020  es),axis=1)..   
+00045730: 2020 2020 200d 0a20 2020 2020 2020 2073       ..        s
+00045740: 656c 662e 5f6c 6564 6765 636f 6c6f 7273  elf._ledgecolors
+00045750: 203d 2052 4742 2020 2320 7570 6461 7465   = RGB  # update
+00045760: 2066 6f72 2076 5f31 2e32 2e30 0d0a 2020   for v_1.2.0..  
+00045770: 2020 2020 2020 7365 6c66 2e73 6574 5f63        self.set_c
+00045780: 6f6c 6f72 2852 4742 2920 2023 203c 3c3c  olor(RGB)  # <<<
+00045790: 3c3c 3c3c 3c3c 3c3c 3c3c 3c3c 3c3c 3c3c  <<<<<<<<<<<<<<<<
+000457a0: 3c3c 3c3c 2064 6562 7567 0d0a 0d0a 2020  <<<< debug....  
+000457b0: 2020 2020 2020 7365 6c66 2e73 6567 5661        self.segVa
+000457c0: 6c75 6573 203d 204e 6f6e 650d 0a20 2020  lues = None..   
+000457d0: 2020 2020 2073 656c 662e 5f62 6f75 6e64       self._bound
+000457e0: 735b 2776 6c69 6d27 5d20 3d20 5b20 302e  s['vlim'] = [ 0.
+000457f0: 302c 2031 2e30 205d 200d 0a20 2020 2020  0, 1.0 ] ..     
+00045800: 2020 2023 203d 3d3d 3d3d 3d3d 3d3d 3d3d     # ===========
+00045810: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00045820: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00045830: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00045840: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d 0a20  =============.. 
+00045850: 2020 2020 2020 2073 656c 662e 5f6d 6170         self._map
+00045860: 5f63 6f6c 6f72 5f66 726f 6d5f 6f70 5f76  _color_from_op_v
+00045870: 6572 7428 206f 7065 7261 7469 6f6e 2c20  ert( operation, 
+00045880: 7267 6220 290d 0a20 2020 2020 2020 2023  rgb )..        #
+00045890: 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d   ===============
+000458a0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000458b0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000458c0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000458d0: 3d3d 3d3d 3d3d 3d3d 3d0d 0a20 2020 2020  =========..     
+000458e0: 2020 2072 6574 7572 6e20 7365 6c66 2020     return self  
+000458f0: 2020 0d0a 0d0a 2020 2020 6465 6620 6d61    ....    def ma
+00045900: 705f 6765 6f6d 5f66 726f 6d5f 6f70 2873  p_geom_from_op(s
+00045910: 656c 662c 206f 7065 7261 7469 6f6e 2c20  elf, operation, 
+00045920: 6e61 6d65 3d4e 6f6e 6529 203a 0d0a 2020  name=None) :..  
+00045930: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
+00045940: 2020 2046 756e 6374 696f 6e61 6c20 7472     Functional tr
+00045950: 616e 7366 6f72 6d61 7469 6f6e 206f 6620  ansformation of 
+00045960: 6c69 6e65 2076 6572 7465 7820 636f 6f72  line vertex coor
+00045970: 6469 6e61 7465 732e 0d0a 0d0a 2020 2020  dinates.....    
+00045980: 2020 2020 5061 7261 6d65 7465 7273 0d0a      Parameters..
+00045990: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+000459a0: 2d2d 0d0a 2020 2020 2020 2020 6f70 6572  --..        oper
+000459b0: 6174 696f 6e20 3a20 6675 6e63 7469 6f6e  ation : function
+000459c0: 206f 626a 6563 740d 0a20 2020 2020 2020   object..       
+000459d0: 2020 2020 2043 6f6f 7264 696e 6174 6520       Coordinate 
+000459e0: 6d61 7070 696e 6720 6675 6e63 7469 6f6e  mapping function
+000459f0: 2074 6861 7420 7461 6b65 7320 6f6e 650d   that takes one.
+00045a00: 0a20 2020 2020 2020 2020 2020 2061 7267  .            arg
+00045a10: 756d 656e 742c 2061 2033 784e 204e 756d  ument, a 3xN Num
+00045a20: 7079 2061 7272 6179 206f 6620 6e61 7469  py array of nati
+00045a30: 7665 2063 6f6f 7264 696e 6174 6573 2e0d  ve coordinates..
+00045a40: 0a20 2020 2020 2020 2020 2020 2054 6865  .            The
+00045a50: 2066 756e 6374 696f 6e20 7265 7475 726e   function return
+00045a60: 7320 6120 3378 4e20 6172 7261 7920 6f66  s a 3xN array of
+00045a70: 2063 6f6f 7264 696e 6174 6573 2e0d 0a0d   coordinates....
+00045a80: 0a20 2020 2020 2020 206e 616d 6520 3a20  .        name : 
+00045a90: 7374 7269 6e67 2c20 6f70 7469 6f6e 616c  string, optional
+00045aa0: 2c20 6465 6661 756c 743a 204e 6f6e 6520  , default: None 
+00045ab0: 6f72 206f 7020 6675 6e63 7469 6f6e 206e  or op function n
+00045ac0: 616d 652e 0d0a 2020 2020 2020 2020 2020  ame...          
+00045ad0: 2020 4465 7363 7269 7074 6976 6520 6964    Descriptive id
+00045ae0: 656e 7469 6669 6572 2066 6f72 2074 6865  entifier for the
+00045af0: 2067 656f 6d65 7472 792e 0d0a 0d0a 2020   geometry.....  
+00045b00: 2020 2020 2020 5265 7475 726e 730d 0a20        Returns.. 
+00045b10: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0d0a         -------..
+00045b20: 2020 2020 2020 2020 7365 6c66 203a 206c          self : l
+00045b30: 696e 6520 6f62 6a65 6374 0d0a 0d0a 2020  ine object....  
+00045b40: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
+00045b50: 2020 206f 7267 436f 6f72 203d 2073 656c     orgCoor = sel
+00045b60: 662e 7665 7274 6578 436f 6f72 0d0a 2020  f.vertexCoor..  
+00045b70: 2020 2020 2020 7879 7a20 3d20 6e70 2e74        xyz = np.t
+00045b80: 7261 6e73 706f 7365 286f 7267 436f 6f72  ranspose(orgCoor
+00045b90: 290d 0a20 2020 2020 2020 2058 595a 203d  )..        XYZ =
+00045ba0: 206e 702e 6172 7261 7928 6f70 6572 6174   np.array(operat
+00045bb0: 696f 6e28 7879 7a29 290d 0a20 2020 2020  ion(xyz))..     
+00045bc0: 2020 2076 203d 206e 702e 7472 616e 7370     v = np.transp
+00045bd0: 6f73 6528 5859 5a29 0d0a 2020 2020 2020  ose(XYZ)..      
+00045be0: 2020 7365 6c66 2e76 6572 7465 7843 6f6f    self.vertexCoo
+00045bf0: 7220 3d20 760d 0a20 2020 2020 2020 2073  r = v..        s
+00045c00: 6567 6d65 6e74 7320 3d20 7365 6c66 2e5f  egments = self._
+00045c10: 6765 745f 7365 676d 656e 7473 2820 7365  get_segments( se
+00045c20: 6c66 2e76 6572 7465 7843 6f6f 722c 2073  lf.vertexCoor, s
+00045c30: 656c 662e 7365 676d 496e 6469 6365 7320  elf.segmIndices 
+00045c40: 2029 0d0a 2020 2020 2020 2020 7365 6c66   )..        self
+00045c50: 2e73 6574 5f73 6567 6d65 6e74 7328 7365  .set_segments(se
+00045c60: 676d 656e 7473 290d 0a20 2020 2020 2020  gments)..       
+00045c70: 2073 656c 662e 5f73 6574 5f67 656f 6d65   self._set_geome
+00045c80: 7472 6963 5f62 6f75 6e64 7328 290d 0a20  tric_bounds().. 
+00045c90: 2020 2020 2020 2069 6620 6e61 6d65 2069         if name i
+00045ca0: 7320 4e6f 6e65 203a 206e 616d 6520 3d20  s None : name = 
+00045cb0: 7365 6c66 2e5f 6765 6f6d 4e61 6d65 0d0a  self._geomName..
+00045cc0: 2020 2020 2020 2020 6e61 6d65 203d 205f          name = _
+00045cd0: 6765 7446 756e 6374 696f 6e4e 616d 6528  getFunctionName(
+00045ce0: 6f70 6572 6174 696f 6e2c 6e61 6d65 290d  operation,name).
+00045cf0: 0a20 2020 2020 2020 2069 6620 6e61 6d65  .        if name
+00045d00: 2069 7320 6e6f 7420 4e6f 6e65 203a 2073   is not None : s
+00045d10: 656c 662e 5f67 656f 6d4e 616d 6520 3d20  elf._geomName = 
+00045d20: 6e61 6d65 0d0a 2020 2020 2020 2020 7265  name..        re
+00045d30: 7475 726e 2073 656c 660d 0a0d 0a20 2020  turn self....   
+00045d40: 2064 6566 206d 6170 5f74 6f5f 706c 616e   def map_to_plan
+00045d50: 6528 7365 6c66 2c20 6469 7374 2c20 2a2a  e(self, dist, **
+00045d60: 6b61 7267 7329 203a 0d0a 2020 2020 2020  kargs) :..      
+00045d70: 2020 2222 220d 0a20 2020 2020 2020 2050    """..        P
+00045d80: 726f 6a65 6374 206c 696e 6520 6f6e 746f  roject line onto
+00045d90: 2061 206d 6170 7069 6e67 2073 7572 6661   a mapping surfa
+00045da0: 6365 2e0d 0a0d 0a20 2020 2020 2020 2050  ce.....        P
+00045db0: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
+00045dc0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
+00045dd0: 2020 2020 2020 2064 6973 7420 3a20 6e75         dist : nu
+00045de0: 6d62 6572 2c20 6f70 7469 6f6e 616c 2c20  mber, optional, 
+00045df0: 6465 6661 756c 7420 3a20 302e 3020 0d0a  default : 0.0 ..
+00045e00: 2020 2020 2020 2020 2020 2020 6469 7374              dist
+00045e10: 616e 6365 2066 726f 6d20 7468 6520 6f72  ance from the or
+00045e20: 6967 696e 2074 6f20 7468 6520 7375 7266  igin to the surf
+00045e30: 6163 652c 0d0a 2020 2020 2020 2020 2020  ace,..          
+00045e40: 2020 616c 6f6e 6720 7468 6520 6469 7265    along the dire
+00045e50: 6374 696f 6e20 7665 6374 6f72 2e0d 0a0d  ction vector....
+00045e60: 0a20 2020 2020 2020 2064 6972 6563 7469  .        directi
+00045e70: 6f6e 203a 2061 7272 6179 2d6c 696b 652c  on : array-like,
+00045e80: 206f 7074 696f 6e61 6c2c 2064 6566 6175   optional, defau
+00045e90: 6c74 3a20 5b30 2c30 2c31 5d0d 0a20 2020  lt: [0,0,1]..   
+00045ea0: 2020 2020 2020 2020 2041 2078 797a 2076           A xyz v
+00045eb0: 6563 746f 7220 6e6f 726d 616c 2074 6f20  ector normal to 
+00045ec0: 7468 6520 696e 7465 7273 6563 7469 6f6e  the intersection
+00045ed0: 2070 6c61 6e65 730d 0a20 2020 2020 2020   planes..       
+00045ee0: 2020 2020 2066 6f72 2070 6c61 6e61 7220       for planar 
+00045ef0: 6d61 7070 696e 6720 6f72 2061 7869 616c  mapping or axial
+00045f00: 2064 6972 6563 7469 6f6e 206f 6620 0d0a   direction of ..
+00045f10: 2020 2020 2020 2020 2020 2020 6120 6379              a cy
+00045f20: 6c69 6e64 6572 2066 6f72 2063 796c 696e  linder for cylin
+00045f30: 6472 6963 616c 206d 6170 7069 6e67 2e0d  drical mapping..
+00045f40: 0a0d 0a20 2020 2020 2020 2063 6f6f 7220  ...        coor 
+00045f50: 3a20 696e 7465 6765 7220 6f72 2073 7472  : integer or str
+00045f60: 696e 6720 696e 6469 6361 7469 6e67 2074  ing indicating t
+00045f70: 6865 2074 7970 6520 6f66 206d 6170 7069  he type of mappi
+00045f80: 6e67 2073 7572 6661 6365 3a0d 0a20 2020  ng surface:..   
+00045f90: 2020 2020 2020 2020 2030 2c20 702c 2050           0, p, P
+00045fa0: 2c20 7879 7a2c 706c 616e 6172 2020 2020  , xyz,planar    
+00045fb0: 2020 2020 2020 2020 2020 2020 202d 2070               - p
+00045fc0: 6c61 6e61 7220 2864 6566 6175 6c74 290d  lanar (default).
+00045fd0: 0a20 2020 2020 2020 2020 2020 2031 2c20  .            1, 
+00045fe0: 632c 2043 2c20 6379 6c69 6e64 6572 2c70  c, C, cylinder,p
+00045ff0: 706c 6172 2c63 796c 696e 6472 6963 616c  plar,cylindrical
+00046000: 202d 2063 796c 696e 6465 720d 0a20 2020   - cylinder..   
+00046010: 2020 2020 2020 2020 2032 2c20 732c 2053           2, s, S
+00046020: 2c20 7370 6865 7265 2c73 7068 6572 6963  , sphere,spheric
+00046030: 616c 2020 2020 2020 2020 2020 202d 2073  al           - s
+00046040: 7068 6572 650d 0a20 2020 2020 2020 2020  phere..         
+00046050: 2020 2033 2c20 782c 2058 2020 2020 2020     3, x, X      
+00046060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00046070: 2020 2020 2020 202d 2079 2d7a 2070 6c61         - y-z pla
+00046080: 6e65 0d0a 2020 2020 2020 2020 2020 2020  ne..            
+00046090: 342c 2079 2c20 5920 2020 2020 2020 2020  4, y, Y         
+000460a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000460b0: 2020 2020 2d20 782d 7a20 706c 616e 650d      - x-z plane.
+000460c0: 0a20 2020 2020 2020 2020 2020 2035 2c20  .            5, 
+000460d0: 7a2c 205a 2020 2020 2020 2020 2020 2020  z, Z            
+000460e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000460f0: 202d 2078 2d79 2070 6c61 6e65 0d0a 0d0a   - x-y plane....
+00046100: 2020 2020 2020 2020 5265 7475 726e 730d          Returns.
+00046110: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00046120: 0d0a 2020 2020 2020 2020 7365 6c66 203a  ..        self :
+00046130: 206c 696e 6520 6f62 6a65 6374 0d0a 0d0a   line object....
+00046140: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
+00046150: 2020 2020 2064 6972 4466 7420 3d20 7b20       dirDft = { 
+00046160: 2764 6972 6563 7469 6f6e 273a 205b 302c  'direction': [0,
+00046170: 302c 312e 305d 207d 0d0a 2020 2020 2020  0,1.0] }..      
+00046180: 2020 6b61 7267 4466 7420 3d20 7b20 2a2a    kargDft = { **
+00046190: 5f43 4f4f 525f 4b57 4152 4753 2c20 2a2a  _COOR_KWARGS, **
+000461a0: 6469 7244 6674 207d 0d0a 2020 2020 2020  dirDft }..      
+000461b0: 2020 4b57 203d 204b 5770 726f 6365 7373    KW = KWprocess
+000461c0: 6f72 2820 6b61 7267 4466 742c 2027 6d61  or( kargDft, 'ma
+000461d0: 705f 746f 5f70 6c61 6e65 272c 202a 2a6b  p_to_plane', **k
+000461e0: 6172 6773 290d 0a20 2020 2020 2020 2063  args)..        c
+000461f0: 6f6f 7220 3d20 4b57 2e67 6574 5661 6c28  oor = KW.getVal(
+00046200: 2763 6f6f 7227 290d 0a20 2020 2020 2020  'coor')..       
+00046210: 2064 6972 6563 7469 6f6e 203d 204b 572e   direction = KW.
+00046220: 6765 7456 616c 2827 6469 7265 6374 696f  getVal('directio
+00046230: 6e27 290d 0a0d 0a20 2020 2020 2020 2069  n')....        i
+00046240: 6620 636f 6f72 3d3d 3320 3a20 636f 6f72  f coor==3 : coor
+00046250: 2c20 6469 7265 6374 696f 6e20 3d20 302c  , direction = 0,
+00046260: 205b 2031 2c30 2c30 205d 0d0a 2020 2020   [ 1,0,0 ]..    
+00046270: 2020 2020 6966 2063 6f6f 723d 3d34 203a      if coor==4 :
+00046280: 2063 6f6f 722c 2064 6972 6563 7469 6f6e   coor, direction
+00046290: 203d 2030 2c20 5b20 302c 312c 3020 5d0d   = 0, [ 0,1,0 ].
+000462a0: 0a20 2020 2020 2020 2069 6620 636f 6f72  .        if coor
+000462b0: 3d3d 3520 3a20 636f 6f72 2c20 6469 7265  ==5 : coor, dire
+000462c0: 6374 696f 6e20 3d20 302c 205b 2030 2c30  ction = 0, [ 0,0
+000462d0: 2c31 205d 0d0a 0d0a 2020 2020 2020 2020  ,1 ]....        
+000462e0: 2320 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  # ..............
+000462f0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00046300: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00046310: 2e2e 2e2e 2e2e 2e2e 2e0d 0a20 2020 2020  ...........     
+00046320: 2020 2064 6566 2070 726f 6a65 6374 5f70     def project_p
+00046330: 6c61 6e65 2878 797a 2920 3a0d 0a20 2020  lane(xyz) :..   
+00046340: 2020 2020 2020 2020 2076 6572 7473 203d           verts =
+00046350: 2078 797a 2e54 0d0a 2020 2020 2020 2020   xyz.T..        
+00046360: 2020 2020 756e 6974 4469 7265 6374 696f      unitDirectio
+00046370: 6e20 3d20 6e70 2e64 6976 6964 6528 2064  n = np.divide( d
+00046380: 6972 6563 7469 6f6e 2c20 6e70 2e6c 696e  irection, np.lin
+00046390: 616c 672e 6e6f 726d 2864 6972 6563 7469  alg.norm(directi
+000463a0: 6f6e 2920 290d 0a20 2020 2020 2020 2020  on) )..         
+000463b0: 2020 2064 7072 6f64 203d 206e 702e 646f     dprod = np.do
+000463c0: 7428 2076 6572 7473 2c20 756e 6974 4469  t( verts, unitDi
+000463d0: 7265 6374 696f 6e20 290d 0a20 2020 2020  rection )..     
+000463e0: 2020 2020 2020 2076 646f 7420 3d20 6e70         vdot = np
+000463f0: 2e61 7272 6179 285b 6470 726f 645d 292e  .array([dprod]).
+00046400: 540d 0a20 2020 2020 2020 2020 2020 2064  T..            d
+00046410: 556e 6974 203d 206e 702e 7469 6c65 2875  Unit = np.tile(u
+00046420: 6e69 7444 6972 6563 7469 6f6e 2c20 286c  nitDirection, (l
+00046430: 656e 2876 6572 7473 292c 3129 2029 0d0a  en(verts),1) )..
+00046440: 2020 2020 2020 2020 2020 2020 7655 6e69              vUni
+00046450: 7420 3d20 7664 6f74 2a64 556e 6974 0d0a  t = vdot*dUnit..
+00046460: 2020 2020 2020 2020 2020 2020 6455 6e69              dUni
+00046470: 7420 3d20 6469 7374 2a64 556e 6974 0d0a  t = dist*dUnit..
+00046480: 2020 2020 2020 2020 2020 2020 7072 6f6a              proj
+00046490: 5665 7274 7320 3d20 7665 7274 7320 2b20  Verts = verts + 
+000464a0: 2864 556e 6974 202d 2076 556e 6974 290d  (dUnit - vUnit).
+000464b0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+000464c0: 7572 6e20 7072 6f6a 5665 7274 732e 540d  urn projVerts.T.
+000464d0: 0a20 2020 2020 2020 2064 6566 2070 726f  .        def pro
+000464e0: 6a65 6374 5f63 796c 2878 797a 2920 3a0d  ject_cyl(xyz) :.
+000464f0: 0a20 2020 2020 2020 2020 2020 2076 6572  .            ver
+00046500: 7473 203d 2078 797a 2e54 0d0a 2020 2020  ts = xyz.T..    
+00046510: 2020 2020 2020 2020 756e 6974 4469 7265          unitDire
+00046520: 6374 696f 6e20 3d20 6e70 2e64 6976 6964  ction = np.divid
+00046530: 6528 2064 6972 6563 7469 6f6e 2c20 6e70  e( direction, np
+00046540: 2e6c 696e 616c 672e 6e6f 726d 2864 6972  .linalg.norm(dir
+00046550: 6563 7469 6f6e 2920 290d 0a20 2020 2020  ection) )..     
+00046560: 2020 2020 2020 2064 6d61 6720 3d20 6e70         dmag = np
+00046570: 2e64 6f74 2876 6572 7473 2c75 6e69 7444  .dot(verts,unitD
+00046580: 6972 6563 7469 6f6e 290d 0a20 2020 2020  irection)..     
+00046590: 2020 2020 2020 2075 5665 6374 203d 206e         uVect = n
+000465a0: 702e 7469 6c65 2875 6e69 7444 6972 6563  p.tile(unitDirec
+000465b0: 7469 6f6e 2c28 6c65 6e28 646d 6167 292c  tion,(len(dmag),
+000465c0: 3129 2029 0d0a 2020 2020 2020 2020 2020  1) )..          
+000465d0: 2020 6456 6563 7420 3d20 6e70 2e61 7272    dVect = np.arr
+000465e0: 6179 285b 646d 6167 5d29 2e54 0d0a 2020  ay([dmag]).T..  
+000465f0: 2020 2020 2020 2020 2020 4120 3d20 7556            A = uV
+00046600: 6563 742a 6456 6563 740d 0a20 2020 2020  ect*dVect..     
+00046610: 2020 2020 2020 207a 6574 6120 3d20 7665         zeta = ve
+00046620: 7274 7320 2d20 410d 0a20 2020 2020 2020  rts - A..       
+00046630: 2020 2020 207a 6574 616e 6f72 6d20 3d20       zetanorm = 
+00046640: 6e70 2e6c 696e 616c 672e 6e6f 726d 287a  np.linalg.norm(z
+00046650: 6574 612c 6178 6973 3d31 290d 0a20 2020  eta,axis=1)..   
+00046660: 2020 2020 2020 2020 207a 6e6f 726d 203d           znorm =
+00046670: 206e 702e 7469 6c65 287a 6574 616e 6f72   np.tile(zetanor
+00046680: 6d2c 2028 332c 3129 290d 0a20 2020 2020  m, (3,1))..     
+00046690: 2020 2020 2020 2075 6e69 745a 6574 6120         unitZeta 
+000466a0: 3d20 6e70 2e64 6976 6964 6528 207a 6574  = np.divide( zet
+000466b0: 612c 207a 6e6f 726d 2e54 2920 0d0a 2020  a, znorm.T) ..  
+000466c0: 2020 2020 2020 2020 2020 2320 6162 6f76            # abov
+000466d0: 6520 6d61 7920 7265 706f 7274 206e 616e  e may report nan
+000466e0: 2077 6172 6e69 6e67 2c20 6275 7420 666f   warning, but fo
+000466f0: 6c6c 6f77 696e 6720 636f 7272 6563 7473  llowing corrects
+00046700: 2074 6865 7365 2076 616c 7565 732e 0d0a   these values...
+00046710: 2020 2020 2020 2020 2020 2020 756e 6974              unit
+00046720: 5a65 7461 5b20 7a65 7461 6e6f 726d 203c  Zeta[ zetanorm <
+00046730: 3d20 302e 302c 203a 205d 203d 205b 302e  = 0.0, : ] = [0.
+00046740: 302c 302e 302c 302e 305d 0d0a 2020 2020  0,0.0,0.0]..    
+00046750: 2020 2020 2020 2020 7072 6f6a 5665 7274          projVert
+00046760: 7320 3d20 4120 2b20 6469 7374 2a75 6e69  s = A + dist*uni
+00046770: 745a 6574 610d 0a20 2020 2020 2020 2020  tZeta..         
+00046780: 2020 2072 6574 7572 6e20 7072 6f6a 5665     return projVe
+00046790: 7274 732e 540d 0a20 2020 2020 2020 2064  rts.T..        d
+000467a0: 6566 2070 726f 6a65 6374 5f73 7068 2878  ef project_sph(x
+000467b0: 797a 2920 3a0d 0a20 2020 2020 2020 2020  yz) :..         
+000467c0: 2020 2076 6572 7473 203d 2078 797a 2e54     verts = xyz.T
+000467d0: 0d0a 2020 2020 2020 2020 2020 2020 6470  ..            dp
+000467e0: 726f 6420 3d20 6e70 2e6c 696e 616c 672e  rod = np.linalg.
+000467f0: 6e6f 726d 2876 6572 7473 2c61 7869 733d  norm(verts,axis=
+00046800: 3129 0d0a 2020 2020 2020 2020 2020 2020  1)..            
+00046810: 746e 6f72 6d20 3d20 6e70 2e74 696c 6528  tnorm = np.tile(
+00046820: 6470 726f 642c 2028 332c 3129 2029 0d0a  dprod, (3,1) )..
+00046830: 2020 2020 2020 2020 2020 2020 756e 6974              unit
+00046840: 5665 7274 7320 3d20 6e70 2e64 6976 6964  Verts = np.divid
+00046850: 6528 2076 6572 7473 2c20 746e 6f72 6d2e  e( verts, tnorm.
+00046860: 5420 290d 0a20 2020 2020 2020 2020 2020  T )..           
+00046870: 2070 726f 6a56 6572 7473 203d 2064 6973   projVerts = dis
+00046880: 7420 2a20 756e 6974 5665 7274 730d 0a20  t * unitVerts.. 
+00046890: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+000468a0: 6e20 7072 6f6a 5665 7274 732e 540d 0a20  n projVerts.T.. 
+000468b0: 2020 2020 2020 2023 202e 2e2e 2e2e 2e2e         # .......
+000468c0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+000468d0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+000468e0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+000468f0: 0d0a 2020 2020 2020 2020 7072 6f6a 6563  ..        projec
+00046900: 7420 3d20 7072 6f6a 6563 745f 706c 616e  t = project_plan
+00046910: 650d 0a20 2020 2020 2020 2069 6620 636f  e..        if co
+00046920: 6f72 203d 3d20 3120 3a20 7072 6f6a 6563  or == 1 : projec
+00046930: 7420 3d20 7072 6f6a 6563 745f 6379 6c0d  t = project_cyl.
+00046940: 0a20 2020 2020 2020 2069 6620 636f 6f72  .        if coor
+00046950: 203d 3d20 3220 3a20 7072 6f6a 6563 7420   == 2 : project 
+00046960: 3d20 7072 6f6a 6563 745f 7370 680d 0a0d  = project_sph...
+00046970: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00046980: 7365 6c66 2e6d 6170 5f67 656f 6d5f 6672  self.map_geom_fr
+00046990: 6f6d 5f6f 7028 2070 726f 6a65 6374 2029  om_op( project )
+000469a0: 0d0a 0d0a 2020 2020 6465 6620 636c 6970  ....    def clip
+000469b0: 2873 656c 662c 206f 7065 7261 7469 6f6e  (self, operation
+000469c0: 2920 3a0d 0a20 2020 2020 2020 2022 2222  ) :..        """
+000469d0: 0d0a 2020 2020 2020 2020 5265 6d6f 7665  ..        Remove
+000469e0: 2073 6567 6d65 6e74 7320 6672 6f6d 2074   segments from t
+000469f0: 6865 206c 696e 652e 0d0a 2020 2020 2020  he line...      
+00046a00: 2020 4e4f 5445 3a20 616c 6c20 6f70 6572    NOTE: all oper
+00046a10: 6174 696f 6e73 2061 7265 2069 6e20 7879  ations are in xy
+00046a20: 7a20 636f 6f72 6469 6e61 7465 732e 0d0a  z coordinates...
+00046a30: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
+00046a40: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
+00046a50: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
+00046a60: 2020 6f70 6572 6174 696f 6e20 3a20 6675    operation : fu
+00046a70: 6e63 7469 6f6e 206f 626a 6563 740d 0a20  nction object.. 
+00046a80: 2020 2020 2020 2020 2020 2046 756e 6374             Funct
+00046a90: 696f 6e20 7468 6174 2074 616b 6573 206f  ion that takes o
+00046aa0: 6e65 2061 7267 756d 656e 742c 2061 2033  ne argument, a 3
+00046ab0: 784e 204e 756d 7079 2061 7272 6179 206f  xN Numpy array o
+00046ac0: 6620 636f 6f72 6469 6e61 7465 732e 0d0a  f coordinates...
+00046ad0: 2020 2020 2020 2020 2020 2020 5468 6520              The 
+00046ae0: 6675 6e63 7469 6f6e 2072 6574 7572 6e73  function returns
+00046af0: 204e 2061 7272 6179 206f 6620 626f 6f6c   N array of bool
+00046b00: 207b 2054 7275 652c 2046 616c 7365 207d   { True, False }
+00046b10: 2069 6e64 6963 6174 696e 6720 6966 0d0a   indicating if..
+00046b20: 2020 2020 2020 2020 2020 2020 7468 6520              the 
+00046b30: 7365 676d 656e 742c 2061 7420 7468 6520  segment, at the 
+00046b40: 7365 676d 656e 7420 6365 6e74 6572 2063  segment center c
+00046b50: 6f6f 7264 696e 6174 652c 2069 7320 746f  oordinate, is to
+00046b60: 2062 6520 0d0a 2020 2020 2020 2020 2020   be ..          
+00046b70: 2020 7265 7461 696e 6564 2028 5472 7565    retained (True
+00046b80: 292e 2020 4f74 6865 7277 6973 652c 2074  ).  Otherwise, t
+00046b90: 6865 2073 6567 6d65 6e74 2069 7320 7265  he segment is re
+00046ba0: 6d6f 7665 6420 6672 6f6d 2074 6865 0d0a  moved from the..
+00046bb0: 2020 2020 2020 2020 2020 2020 6c69 6e65              line
+00046bc0: 2028 4661 6c73 6529 2e0d 0a0d 0a20 2020   (False).....   
+00046bd0: 2020 2020 2052 6574 7572 6e73 0d0a 2020       Returns..  
+00046be0: 2020 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20        -------.. 
+00046bf0: 2020 2020 2020 2073 656c 6620 3a20 6c69         self : li
+00046c00: 6e65 206f 626a 6563 740d 0a0d 0a20 2020  ne object....   
+00046c10: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
+00046c20: 2020 2320 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    # ------------
+00046c30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00046c40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20  -------------.. 
+00046c50: 2020 2020 2020 2063 6f6c 6f72 7320 3d20         colors = 
+00046c60: 7365 6c66 2e5f 6c65 6467 6563 6f6c 6f72  self._ledgecolor
+00046c70: 7320 2023 2075 7064 6174 6520 666f 7220  s  # update for 
+00046c80: 765f 312e 322e 300d 0a20 2020 2020 2020  v_1.2.0..       
+00046c90: 2073 6567 6d65 6e74 7320 3d20 7365 6c66   segments = self
+00046ca0: 2e5f 7365 676d 656e 7473 3364 0d0a 0d0a  ._segments3d....
+00046cb0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00046cc0: 7265 7374 6f72 6564 436c 6970 2069 7320  restoredClip is 
+00046cd0: 4e6f 6e65 203a 0d0a 2020 2020 2020 2020  None :..        
+00046ce0: 2020 2020 7365 6c66 2e72 6573 746f 7265      self.restore
+00046cf0: 6443 6c69 7020 3d20 7b20 0d0a 2020 2020  dClip = { ..    
+00046d00: 2020 2020 2020 2020 2020 2020 2769 6e64              'ind
+00046d10: 6963 6573 2720 3a20 7365 6c66 2e73 6567  ices' : self.seg
+00046d20: 6d49 6e64 6963 6573 2c20 0d0a 2020 2020  mIndices, ..    
+00046d30: 2020 2020 2020 2020 2020 2020 2763 6f6c              'col
+00046d40: 6f72 7327 203a 2063 6f6c 6f72 732c 0d0a  ors' : colors,..
+00046d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00046d60: 2769 7353 6872 6564 6465 6427 203a 2073  'isShredded' : s
+00046d70: 656c 662e 6973 5368 7265 6464 6564 207d  elf.isShredded }
+00046d80: 0d0a 0d0a 2020 2020 2020 2020 6966 206e  ....        if n
+00046d90: 6f74 2073 656c 662e 6973 5368 7265 6464  ot self.isShredd
+00046da0: 6564 203a 0d0a 2020 2020 2020 2020 2020  ed :..          
+00046db0: 2020 2320 2e2e 2e2e 206e 6f74 653a 636f    # .... note:co
+00046dc0: 6c6f 7273 206d 6f64 6966 6965 642c 206e  lors modified, n
+00046dd0: 6f74 2063 7265 6174 6564 0d0a 2020 2020  ot created..    
+00046de0: 2020 2020 2020 2020 636f 6c6f 7273 203d          colors =
+00046df0: 2073 656c 662e 5f73 6872 6564 5f63 6f6c   self._shred_col
+00046e00: 6f72 2829 0d0a 2020 2020 2020 2020 2020  or()..          
+00046e10: 2020 7365 676d 656e 7473 203d 2073 656c    segments = sel
+00046e20: 662e 5f73 6872 6564 2829 0d0a 2020 2020  f._shred()..    
+00046e30: 2020 2020 2020 2020 7365 6c66 2e5f 6c65          self._le
+00046e40: 6467 6563 6f6c 6f72 7320 3d20 636f 6c6f  dgecolors = colo
+00046e50: 7273 2020 2320 7570 6461 7465 2066 6f72  rs  # update for
+00046e60: 2076 5f31 2e32 2e30 0d0a 2020 2020 2020   v_1.2.0..      
+00046e70: 2020 656c 7365 203a 0d0a 2020 2020 2020    else :..      
+00046e80: 2020 2020 2020 6c65 6e43 6f6c 203d 206c        lenCol = l
+00046e90: 656e 2873 656c 662e 5f6c 6564 6765 636f  en(self._ledgeco
+00046ea0: 6c6f 7273 2920 2023 2075 7064 6174 6520  lors)  # update 
+00046eb0: 666f 7220 765f 312e 322e 300d 0a20 2020  for v_1.2.0..   
+00046ec0: 2020 2020 2020 2020 206c 656e 5365 6720           lenSeg 
+00046ed0: 3d20 6c65 6e28 7365 676d 656e 7473 290d  = len(segments).
+00046ee0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00046ef0: 6c65 6e43 6f6c 2021 3d20 6c65 6e53 6567  lenCol != lenSeg
+00046f00: 203a 2063 6f6c 6f72 7320 3d20 7365 6c66   : colors = self
+00046f10: 2e5f 7368 7265 645f 636f 6c6f 7228 290d  ._shred_color().
+00046f20: 0a20 2020 2020 2020 2023 202d 2d2d 2d2d  .        # -----
+00046f30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00046f40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00046f50: 2d2d 2d2d 0d0a 2020 2020 2020 2020 7365  ----..        se
+00046f60: 6743 6f6f 7220 3d20 7365 6c66 2e5f 6765  gCoor = self._ge
+00046f70: 745f 7365 676d 656e 745f 6365 6e74 6572  t_segment_center
+00046f80: 7328 7365 676d 656e 7473 290d 0a20 2020  s(segments)..   
+00046f90: 2020 2020 2078 797a 203d 206e 702e 7472       xyz = np.tr
+00046fa0: 616e 7370 6f73 6528 7365 6743 6f6f 7229  anspose(segCoor)
+00046fb0: 0d0a 2020 2020 2020 2020 7368 6f75 6c64  ..        should
+00046fc0: 4b65 6570 203d 206e 702e 6172 7261 7928  Keep = np.array(
+00046fd0: 6f70 6572 6174 696f 6e28 7879 7a29 290d  operation(xyz)).
+00046fe0: 0a0d 0a20 2020 2020 2020 2069 6620 6e70  ...        if np
+00046ff0: 2e61 6e79 2873 686f 756c 644b 6565 7029  .any(shouldKeep)
+00047000: 2069 7320 4e6f 6e65 203a 0d0a 2020 2020   is None :..    
+00047010: 2020 2020 2020 2020 7761 726e 696e 6773          warnings
+00047020: 2e77 6172 6e28 2757 4152 4e49 4e47 3a20  .warn('WARNING: 
+00047030: 436c 6970 7069 6e67 2072 6573 756c 7465  Clipping resulte
+00047040: 6420 696e 206e 6f20 6c69 6e65 7320 666f  d in no lines fo
+00047050: 756e 642c 206c 696e 6520 7265 7475 726e  und, line return
+00047060: 2075 6e63 6c69 7070 6564 2e27 290d 0a20   unclipped.').. 
+00047070: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00047080: 6e20 7365 6c66 0d0a 0d0a 2020 2020 2020  n self....      
+00047090: 2020 636c 6970 496e 6469 6365 7320 3d20    clipIndices = 
+000470a0: 6e70 2e61 7272 6179 2873 656c 662e 7365  np.array(self.se
+000470b0: 676d 496e 6469 6365 7329 5b73 686f 756c  gmIndices)[shoul
+000470c0: 644b 6565 705d 0d0a 2020 2020 2020 2020  dKeep]..        
+000470d0: 636c 6970 436f 6c6f 7273 203d 2063 6f6c  clipColors = col
+000470e0: 6f72 735b 7368 6f75 6c64 4b65 6570 5d0d  ors[shouldKeep].
+000470f0: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+00047100: 2020 2063 6c69 7043 6f6c 6f72 7320 3d20     clipColors = 
+00047110: 6e70 2e61 7272 6179 2863 6c69 7043 6f6c  np.array(clipCol
+00047120: 6f72 7329 0d0a 2020 2020 2020 2020 636c  ors)..        cl
+00047130: 6970 436f 6f72 203d 2073 656c 662e 7665  ipCoor = self.ve
+00047140: 7274 6578 436f 6f72 5b20 206e 702e 6172  rtexCoor[  np.ar
+00047150: 7261 7928 636c 6970 496e 6469 6365 7329  ray(clipIndices)
+00047160: 205d 2020 2023 2074 6865 206c 696e 6573   ]   # the lines
+00047170: 6574 2069 7320 7368 7265 6464 6564 2073  et is shredded s
+00047180: 6f20 6361 6e20 646f 2074 6869 732e 0d0a  o can do this...
+00047190: 2020 2020 2020 2020 7365 6c66 2e73 6574          self.set
+000471a0: 5f73 6567 6d65 6e74 7328 636c 6970 436f  _segments(clipCo
+000471b0: 6f72 290d 0a20 2020 2020 2020 2073 656c  or)..        sel
+000471c0: 662e 7365 745f 636f 6c6f 7228 636c 6970  f.set_color(clip
+000471d0: 436f 6c6f 7273 290d 0a0d 0a20 2020 2020  Colors)....     
+000471e0: 2020 2023 2046 7574 4465 763a 2027 636f     # FutDev: 'co
+000471f0: 7272 6563 7427 2064 6566 696e 6974 696f  rrect' definitio
+00047200: 6e20 7368 6f75 6c64 2075 7365 206e 7061  n should use npa
+00047210: 7272 6179 7320 666f 7220 7365 676d 496e  rrays for segmIn
+00047220: 6469 6365 7320 6e6f 7420 6c69 7374 7320  dices not lists 
+00047230: 0d0a 2020 2020 2020 2020 2320 7365 6c66  ..        # self
+00047240: 2e73 6567 6d49 6e64 6963 6573 203d 2063  .segmIndices = c
+00047250: 6c69 7049 6e64 6963 6573 2020 2e2e 2e20  lipIndices  ... 
+00047260: 6275 6720 6669 782c 2020 6a75 7374 2061  bug fix,  just a
+00047270: 2062 616e 6461 6964 2e0d 0a20 2020 2020   bandaid...     
+00047280: 2020 2073 656c 662e 7365 676d 496e 6469     self.segmIndi
+00047290: 6365 7320 3d20 636c 6970 496e 6469 6365  ces = clipIndice
+000472a0: 732e 746f 6c69 7374 2829 0d0a 0d0a 2020  s.tolist()....  
+000472b0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+000472c0: 660d 0a0d 0a20 2020 2064 6566 2063 6c69  f....    def cli
+000472d0: 705f 706c 616e 6528 7365 6c66 2c64 6973  p_plane(self,dis
+000472e0: 742c 2a2a 6b61 7267 7329 203a 0d0a 2020  t,**kargs) :..  
+000472f0: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
+00047300: 2020 2052 656d 6f76 6520 7365 676d 656e     Remove segmen
+00047310: 7473 2066 726f 6d20 7468 6520 6c69 6e65  ts from the line
+00047320: 2062 6173 6564 206f 6e20 6120 636c 6970   based on a clip
+00047330: 2073 7572 6661 6365 2e0d 0a0d 0a20 2020   surface.....   
+00047340: 2020 2020 2050 6172 616d 6574 6572 730d       Parameters.
+00047350: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00047360: 2d2d 2d0d 0a20 2020 2020 2020 2064 6973  ---..        dis
+00047370: 7420 3a20 6e75 6d62 6572 2c20 6f70 7469  t : number, opti
+00047380: 6f6e 616c 2c20 6465 6661 756c 7420 3a20  onal, default : 
+00047390: 302e 3020 0d0a 2020 2020 2020 2020 2020  0.0 ..          
+000473a0: 2020 4469 7374 616e 6365 2066 726f 6d20    Distance from 
+000473b0: 7468 6520 6f72 6967 696e 2074 6f20 7468  the origin to th
+000473c0: 6520 636c 6970 2073 7572 6661 6365 2c0d  e clip surface,.
+000473d0: 0a20 2020 2020 2020 2020 2020 2061 6c6f  .            alo
+000473e0: 6e67 2074 6865 2064 6972 6563 7469 6f6e  ng the direction
+000473f0: 2076 6563 746f 722e 0d0a 0d0a 2020 2020   vector.....    
+00047400: 2020 2020 6469 7265 6374 696f 6e20 3a20      direction : 
+00047410: 6172 7261 792d 6c69 6b65 2c20 6f70 7469  array-like, opti
+00047420: 6f6e 616c 2c20 6465 6661 756c 743a 205b  onal, default: [
+00047430: 302c 302c 315d 0d0a 2020 2020 2020 2020  0,0,1]..        
+00047440: 2020 2020 4120 7879 7a20 7665 6374 6f72      A xyz vector
+00047450: 206e 6f72 6d61 6c20 746f 2074 6865 2069   normal to the i
+00047460: 6e74 6572 7365 6374 696f 6e20 706c 616e  ntersection plan
+00047470: 650d 0a20 2020 2020 2020 2020 2020 2066  e..            f
+00047480: 6f72 2061 2070 6c61 6e61 7220 636c 6970  or a planar clip
+00047490: 2073 7572 6661 6365 206f 7220 6178 6961   surface or axia
+000474a0: 6c20 6469 7265 6374 696f 6e20 6f66 200d  l direction of .
+000474b0: 0a20 2020 2020 2020 2020 2020 2061 2063  .            a c
+000474c0: 796c 696e 6465 7220 666f 7220 6120 6379  ylinder for a cy
+000474d0: 6c69 6e64 7269 6361 6c20 636c 6970 2073  lindrical clip s
+000474e0: 7572 6661 6365 2e0d 0a0d 0a20 2020 2020  urface.....     
+000474f0: 2020 2063 6f6f 7220 3a20 696e 7465 6765     coor : intege
+00047500: 7220 6f72 2073 7472 696e 6720 696e 6469  r or string indi
+00047510: 6361 7469 6e67 2074 6865 2074 7970 6520  cating the type 
+00047520: 6f66 2063 6c69 7020 7375 7266 6163 653a  of clip surface:
+00047530: 0d0a 2020 2020 2020 2020 2020 2020 302c  ..            0,
+00047540: 2070 2c20 502c 2078 797a 2c70 6c61 6e61   p, P, xyz,plana
+00047550: 7220 2020 2020 2020 2020 2020 2020 2020  r               
+00047560: 2020 2d20 706c 616e 6172 2028 6465 6661    - planar (defa
+00047570: 756c 7429 0d0a 2020 2020 2020 2020 2020  ult)..          
+00047580: 2020 312c 2063 2c20 432c 2063 796c 696e    1, c, C, cylin
+00047590: 6465 722c 7070 6c61 722c 6379 6c69 6e64  der,pplar,cylind
+000475a0: 7269 6361 6c20 2d20 6379 6c69 6e64 6572  rical - cylinder
+000475b0: 0d0a 2020 2020 2020 2020 2020 2020 322c  ..            2,
+000475c0: 2073 2c20 532c 2073 7068 6572 652c 7370   s, S, sphere,sp
+000475d0: 6865 7269 6361 6c20 2020 2020 2020 2020  herical         
+000475e0: 2020 2d20 7370 6865 7265 0d0a 2020 2020    - sphere..    
+000475f0: 2020 2020 2020 2020 332c 2078 2c20 5820          3, x, X 
+00047600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00047610: 2020 2020 2020 2020 2020 2020 2d20 792d              - y-
+00047620: 7a20 706c 616e 650d 0a20 2020 2020 2020  z plane..       
+00047630: 2020 2020 2034 2c20 792c 2059 2020 2020       4, y, Y    
+00047640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00047650: 2020 2020 2020 2020 202d 2078 2d7a 2070           - x-z p
+00047660: 6c61 6e65 0d0a 2020 2020 2020 2020 2020  lane..          
+00047670: 2020 352c 207a 2c20 5a20 2020 2020 2020    5, z, Z       
+00047680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00047690: 2020 2020 2020 2d20 782d 7920 706c 616e        - x-y plan
+000476a0: 650d 0a0d 0a20 2020 2020 2020 2052 6574  e....        Ret
+000476b0: 7572 6e73 0d0a 2020 2020 2020 2020 2d2d  urns..        --
+000476c0: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2073  -----..        s
+000476d0: 656c 6620 3a20 6c69 6e65 206f 626a 6563  elf : line objec
+000476e0: 740d 0a0d 0a20 2020 2020 2020 2022 2222  t....        """
+000476f0: 0d0a 2020 2020 2020 2020 2023 202e 2e2e  ..         # ...
+00047700: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00047710: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00047720: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00047730: 2e2e 2e2e 2e2e 2e2e 0d0a 2020 2020 2020  ..........      
+00047740: 2020 6465 6620 636c 6970 5f6f 7028 7879    def clip_op(xy
+00047750: 7a2c 6469 7374 2c63 6f6f 722c 6469 7265  z,dist,coor,dire
+00047760: 6374 696f 6e29 203a 0d0a 2020 2020 2020  ction) :..      
+00047770: 2020 2020 2020 6162 6320 3d20 6e70 2e74        abc = np.t
+00047780: 7261 6e73 706f 7365 2878 797a 290d 0a20  ranspose(xyz).. 
+00047790: 2020 2020 2020 2020 2020 2064 6f74 7072             dotpr
+000477a0: 6f64 203d 205f 636f 6f72 5f64 6f74 7072  od = _coor_dotpr
+000477b0: 6f64 2864 6972 6563 7469 6f6e 2c63 6f6f  od(direction,coo
+000477c0: 722c 6162 6329 0d0a 2020 2020 2020 2020  r,abc)..        
+000477d0: 2020 2020 7368 6f75 6c64 636c 6970 203d      shouldclip =
+000477e0: 206e 702e 6c65 7373 2864 6f74 7072 6f64   np.less(dotprod
+000477f0: 2c6e 702e 6675 6c6c 286c 656e 2864 6f74  ,np.full(len(dot
+00047800: 7072 6f64 292c 6469 7374 2929 0d0a 2020  prod),dist))..  
+00047810: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00047820: 2073 686f 756c 6463 6c69 700d 0a20 2020   shouldclip..   
+00047830: 2020 2020 2023 202e 2e2e 2e2e 2e2e 2e2e       # .........
+00047840: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00047850: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00047860: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00047870: 2e2e 0d0a 2020 2020 2020 2020 6469 7244  ....        dirD
+00047880: 6674 203d 207b 2027 6469 7265 6374 696f  ft = { 'directio
+00047890: 6e27 3a20 5b30 2c30 2c31 2e30 5d20 7d0d  n': [0,0,1.0] }.
+000478a0: 0a20 2020 2020 2020 206b 6172 6744 6674  .        kargDft
+000478b0: 203d 207b 202a 2a5f 434f 4f52 5f4b 5741   = { **_COOR_KWA
+000478c0: 5247 532c 202a 2a64 6972 4466 7420 7d0d  RGS, **dirDft }.
+000478d0: 0a20 2020 2020 2020 204b 5720 3d20 4b57  .        KW = KW
+000478e0: 7072 6f63 6573 736f 7228 206b 6172 6744  processor( kargD
+000478f0: 6674 2c20 2763 6c69 705f 706c 616e 6527  ft, 'clip_plane'
+00047900: 2c20 2a2a 6b61 7267 7329 0d0a 2020 2020  , **kargs)..    
+00047910: 2020 2020 636f 6f72 203d 204b 572e 6765      coor = KW.ge
+00047920: 7456 616c 2827 636f 6f72 2729 0d0a 2020  tVal('coor')..  
+00047930: 2020 2020 2020 6469 7265 6374 696f 6e20        direction 
+00047940: 3d20 4b57 2e67 6574 5661 6c28 2764 6972  = KW.getVal('dir
+00047950: 6563 7469 6f6e 2729 0d0a 0d0a 2020 2020  ection')....    
+00047960: 2020 2020 6966 2063 6f6f 723d 3d33 203a      if coor==3 :
+00047970: 2063 6f6f 722c 2064 6972 6563 7469 6f6e   coor, direction
+00047980: 203d 2030 2c20 5b20 312c 302c 3020 5d0d   = 0, [ 1,0,0 ].
+00047990: 0a20 2020 2020 2020 2069 6620 636f 6f72  .        if coor
+000479a0: 3d3d 3420 3a20 636f 6f72 2c20 6469 7265  ==4 : coor, dire
+000479b0: 6374 696f 6e20 3d20 302c 205b 2030 2c31  ction = 0, [ 0,1
+000479c0: 2c30 205d 0d0a 2020 2020 2020 2020 6966  ,0 ]..        if
+000479d0: 2063 6f6f 723d 3d35 203a 2063 6f6f 722c   coor==5 : coor,
+000479e0: 2064 6972 6563 7469 6f6e 203d 2030 2c20   direction = 0, 
+000479f0: 5b20 302c 302c 3120 5d0d 0a20 2020 2020  [ 0,0,1 ]..     
+00047a00: 2020 200d 0a20 2020 2020 2020 2072 6574     ..        ret
+00047a10: 7572 6e20 7365 6c66 2e63 6c69 7028 6c61  urn self.clip(la
+00047a20: 6d62 6461 2078 797a 203a 2063 6c69 705f  mbda xyz : clip_
+00047a30: 6f70 2878 797a 2c64 6973 742c 636f 6f72  op(xyz,dist,coor
+00047a40: 2c64 6972 6563 7469 6f6e 2920 290d 0a0d  ,direction) )...
+00047a50: 0a20 2020 2064 6566 205f 7265 7374 6f72  .    def _restor
+00047a60: 655f 6672 6f6d 5f63 6c69 7028 7365 6c66  e_from_clip(self
+00047a70: 2920 3a0d 0a20 2020 2020 2020 2022 2222  ) :..        """
+00047a80: 0d0a 2020 2020 2020 2020 5265 7365 7420  ..        Reset 
+00047a90: 7365 676d 656e 7420 616e 6420 636f 6c6f  segment and colo
+00047aa0: 7273 2070 7269 6f72 2074 6f20 616e 7920  rs prior to any 
+00047ab0: 636c 6970 206f 7065 7261 7469 6f6e 2e0d  clip operation..
+00047ac0: 0a20 2020 2020 2020 2028 696e 2064 6576  .        (in dev
+00047ad0: 656c 6f70 6d65 6e74 290d 0a20 2020 2020  elopment)..     
+00047ae0: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
+00047af0: 0d0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
+00047b00: 662e 7265 7374 6f72 6564 436c 6970 2069  f.restoredClip i
+00047b10: 7320 4e6f 6e65 203a 0d0a 2020 2020 2020  s None :..      
+00047b20: 2020 2020 2020 7761 726e 696e 6773 2e77        warnings.w
+00047b30: 6172 6e28 2754 6865 7265 2061 7265 206e  arn('There are n
+00047b40: 6f20 636c 6970 7065 6420 6c69 6e65 7320  o clipped lines 
+00047b50: 746f 2072 6573 746f 7265 2e27 290d 0a20  to restore.').. 
+00047b60: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00047b70: 6e20 7365 6c66 0d0a 0d0a 2020 2020 2020  n self....      
+00047b80: 2020 7365 6c66 2e69 7353 6872 6564 6465    self.isShredde
+00047b90: 6420 3d20 7365 6c66 2e72 6573 746f 7265  d = self.restore
+00047ba0: 6443 6c69 705b 2769 7353 6872 6564 6465  dClip['isShredde
+00047bb0: 6427 5d0d 0a20 2020 2020 2020 2073 656c  d']..        sel
+00047bc0: 662e 7365 745f 636f 6c6f 7228 2073 656c  f.set_color( sel
+00047bd0: 662e 7265 7374 6f72 6564 436c 6970 5b27  f.restoredClip['
+00047be0: 636f 6c6f 7273 275d 2029 0d0a 0d0a 2020  colors'] )....  
+00047bf0: 2020 2020 2020 7365 6c66 2e73 6567 6d49        self.segmI
+00047c00: 6e64 6963 6573 203d 2073 656c 662e 7265  ndices = self.re
+00047c10: 7374 6f72 6564 436c 6970 5b27 696e 6469  storedClip['indi
+00047c20: 6365 7327 5d0d 0a20 2020 2020 2020 2073  ces']..        s
+00047c30: 6567 6d49 6e64 6963 6573 203d 2073 656c  egmIndices = sel
+00047c40: 662e 7365 676d 496e 6469 6365 730d 0a0d  f.segmIndices...
+00047c50: 0a20 2020 2020 2020 2073 6567 6d65 6e74  .        segment
+00047c60: 7320 3d20 7365 6c66 2e5f 6765 745f 7365  s = self._get_se
+00047c70: 676d 656e 7473 2820 7365 6c66 2e76 6572  gments( self.ver
+00047c80: 7465 7843 6f6f 722c 2073 6567 6d49 6e64  texCoor, segmInd
+00047c90: 6963 6573 2020 290d 0a20 2020 2020 2020  ices  )..       
+00047ca0: 2073 656c 662e 7365 745f 7365 676d 656e   self.set_segmen
+00047cb0: 7473 2873 6567 6d65 6e74 7329 2020 2020  ts(segments)    
+00047cc0: 0d0a 2020 2020 2020 2020 7365 6c66 2e72  ..        self.r
+00047cd0: 6573 746f 7265 6443 6c69 7020 3d20 4e6f  estoredClip = No
+00047ce0: 6e65 0d0a 2020 2020 2020 2020 7265 7475  ne..        retu
+00047cf0: 726e 2073 656c 660d 0a0d 0a20 2020 2064  rn self....    d
+00047d00: 6566 2073 6574 5f6c 696e 655f 616c 7068  ef set_line_alph
+00047d10: 6128 7365 6c66 2c20 616c 7068 612c 2063  a(self, alpha, c
+00047d20: 6f6e 7374 616e 743d 4661 6c73 6529 203a  onstant=False) :
+00047d30: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
+00047d40: 2020 2020 2020 2041 646a 7573 7420 7468         Adjust th
+00047d50: 6520 616c 7068 6120 7661 6c75 6520 6f66  e alpha value of
+00047d60: 2074 6865 206c 696e 6520 7365 676d 656e   the line segmen
+00047d70: 7420 636f 6c6f 7273 2e0d 0a0d 0a20 2020  t colors.....   
+00047d80: 2020 2020 2050 6172 616d 6574 6572 730d       Parameters.
+00047d90: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00047da0: 2d2d 2d0d 0a20 2020 2020 2020 2061 6c70  ---..        alp
+00047db0: 6861 203a 2073 6361 6c61 720d 0a20 2020  ha : scalar..   
+00047dc0: 2020 2020 2020 2020 2020 2041 6c70 6861             Alpha
+00047dd0: 2069 7320 696e 2074 6865 2064 6f6d 6169   is in the domai
+00047de0: 6e20 3020 746f 2031 2e0d 0a0d 0a20 2020  n 0 to 1.....   
+00047df0: 2020 2020 2063 6f6e 7374 616e 7420 3a20       constant : 
+00047e00: 626f 6f6c 207b 2054 7275 652c 2046 616c  bool { True, Fal
+00047e10: 7365 207d 2c20 6f70 7469 6f6e 616c 2c20  se }, optional, 
+00047e20: 4661 6c73 650d 0a20 2020 2020 2020 2020  False..         
+00047e30: 2020 2049 6620 4661 6c73 652c 2073 6567     If False, seg
+00047e40: 6d65 6e74 2063 6f6c 6f72 2076 616c 7565  ment color value
+00047e50: 7320 6172 6520 6d75 6c74 6970 6c69 6564  s are multiplied
+00047e60: 2062 790d 0a20 2020 2020 2020 2020 2020   by..           
+00047e70: 2061 6c70 6861 2e20 2049 6620 5472 7565   alpha.  If True
+00047e80: 2c20 616c 6c20 7365 676d 656e 7420 636f  , all segment co
+00047e90: 6c6f 7273 2061 6c70 6861 2063 6861 6e6e  lors alpha chann
+00047ea0: 656c 730d 0a20 2020 2020 2020 2020 2020  els..           
+00047eb0: 2061 7265 2061 7373 6967 6e65 6420 746f   are assigned to
+00047ec0: 2061 6c70 6861 2e0d 0a0d 0a20 2020 2020   alpha.....     
+00047ed0: 2020 2052 6574 7572 6e73 0d0a 2020 2020     Returns..    
+00047ee0: 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020      -------..   
+00047ef0: 2020 2020 2073 656c 6620 3a20 6c69 6e65       self : line
+00047f00: 206f 626a 6563 740d 0a0d 0a20 2020 2020   object....     
+00047f10: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
+00047f20: 0d0a 2020 2020 2020 2020 6966 2028 616c  ..        if (al
+00047f30: 7068 613c 302e 3029 206f 7220 2861 6c70  pha<0.0) or (alp
+00047f40: 6861 3e31 2e30 2920 3a0d 0a20 2020 2020  ha>1.0) :..     
+00047f50: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+00047f60: 7565 4572 726f 7228 276c 696e 6520 616c  ueError('line al
+00047f70: 7068 6120 6d75 7374 2062 6520 6265 7477  pha must be betw
+00047f80: 6565 6e20 3020 616e 6420 312c 2066 6f75  een 0 and 1, fou
+00047f90: 6e64 207b 7d27 2e66 6f72 6d61 7428 616c  nd {}'.format(al
+00047fa0: 7068 6129 290d 0a0d 0a20 2020 2020 2020  pha))....       
+00047fb0: 206f 7269 675f 636f 6c6f 7273 203d 2073   orig_colors = s
+00047fc0: 656c 662e 5f6c 6564 6765 636f 6c6f 7273  elf._ledgecolors
+00047fd0: 2020 2320 7570 6461 7465 2066 6f72 2076    # update for v
+00047fe0: 5f31 2e32 2e30 0d0a 2020 2020 2020 2020  _1.2.0..        
+00047ff0: 6966 2063 6f6e 7374 616e 7420 3a0d 0a20  if constant :.. 
+00048000: 2020 2020 2020 2020 2020 206e 702e 7075             np.pu
+00048010: 745f 616c 6f6e 675f 6178 6973 286f 7269  t_along_axis(ori
+00048020: 675f 636f 6c6f 7273 2c20 6e70 2e61 7272  g_colors, np.arr
+00048030: 6179 285b 5b33 5d5d 292c 2061 6c70 6861  ay([[3]]), alpha
+00048040: 2c20 6178 6973 3d31 290d 0a20 2020 2020  , axis=1)..     
+00048050: 2020 2020 2020 2063 6f6c 6f72 4d61 7020         colorMap 
+00048060: 3d20 6f72 6967 5f63 6f6c 6f72 730d 0a20  = orig_colors.. 
+00048070: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+00048080: 2020 2020 2020 2020 2020 636f 6c6f 724d            colorM
+00048090: 6170 203d 206e 702e 6d75 6c74 6970 6c79  ap = np.multiply
+000480a0: 286f 7269 675f 636f 6c6f 7273 2c6e 702e  (orig_colors,np.
+000480b0: 6172 7261 7928 5b31 2e30 2c31 2e30 2c31  array([1.0,1.0,1
+000480c0: 2e30 2c61 6c70 6861 5d29 290d 0a20 2020  .0,alpha]))..   
+000480d0: 2020 2020 200d 0a20 2020 2020 2020 2073       ..        s
+000480e0: 656c 662e 5f6c 6564 6765 636f 6c6f 7273  elf._ledgecolors
+000480f0: 203d 2063 6f6c 6f72 4d61 7020 2023 2075   = colorMap  # u
+00048100: 7064 6174 6520 666f 7220 765f 312e 322e  pdate for v_1.2.
+00048110: 300d 0a0d 0a20 2020 2020 2020 2072 6574  0....        ret
+00048120: 7572 6e20 7365 6c66 0d0a 0d0a 2020 2020  urn self....    
+00048130: 6465 6620 7368 6164 6528 7365 6c66 2c20  def shade(self, 
+00048140: 6465 7074 683d 302c 2064 6972 6563 7469  depth=0, directi
+00048150: 6f6e 3d4e 6f6e 652c 2063 6f6e 7472 6173  on=None, contras
+00048160: 743d 4e6f 6e65 2920 3a0d 0a20 2020 2020  t=None) :..     
+00048170: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
+00048180: 5265 6475 6365 206c 696e 6520 4853 5620  Reduce line HSV 
+00048190: 636f 6c6f 7220 5661 6c75 6520 6261 7365  color Value base
+000481a0: 6420 6f6e 206c 696e 6520 7365 676d 656e  d on line segmen
+000481b0: 7420 6469 7265 6374 696f 6e2e 0d0a 2020  t direction...  
+000481c0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+000481d0: 5468 6520 646f 7420 7072 6f64 7563 7420  The dot product 
+000481e0: 6f66 206c 696e 6520 7365 676d 656e 7420  of line segment 
+000481f0: 7769 7468 2074 6865 2069 6c6c 756d 696e  with the illumin
+00048200: 6174 696f 6e20 6469 7265 6374 696f 6e20  ation direction 
+00048210: 0d0a 2020 2020 2020 2020 6973 2075 7365  ..        is use
+00048220: 6420 746f 2061 646a 7573 7420 6661 6365  d to adjust face
+00048230: 2048 5356 2063 6f6c 6f72 2076 616c 7565   HSV color value
+00048240: 2e0d 0a0d 0a20 2020 2020 2020 2050 6172  .....        Par
+00048250: 616d 6574 6572 730d 0a20 2020 2020 2020  ameters..       
+00048260: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
+00048270: 2020 2020 2064 6570 7468 203a 2073 6361       depth : sca
+00048280: 6c61 722c 206f 7074 696f 6e61 6c2c 2064  lar, optional, d
+00048290: 6566 6175 6c74 3a20 300d 0a20 2020 2020  efault: 0..     
+000482a0: 2020 2020 2020 204d 696e 696d 756d 2063         Minimum c
+000482b0: 6f6c 6f72 2076 616c 7565 206f 6620 7368  olor value of sh
+000482c0: 6164 6564 206c 696e 6520 7365 676d 656e  aded line segmen
+000482d0: 7473 2e0d 0a20 2020 2020 2020 2020 2020  ts...           
+000482e0: 2044 6570 7468 2076 616c 7565 2072 616e   Depth value ran
+000482f0: 6765 7320 6672 6f6d 2030 2074 6f20 312e  ges from 0 to 1.
+00048300: 0d0a 0d0a 2020 2020 2020 2020 6469 7265  ....        dire
+00048310: 6374 696f 6e20 3a20 6172 7261 792d 6c69  ction : array-li
+00048320: 6b65 2c20 6f70 7469 6f6e 616c 2c20 6465  ke, optional, de
+00048330: 6661 756c 743a 2028 312c 302c 3129 0d0a  fault: (1,0,1)..
+00048340: 2020 2020 2020 2020 2020 2020 4120 7879              A xy
+00048350: 7a20 7665 6374 6f72 2070 6f69 6e74 696e  z vector pointin
+00048360: 6720 746f 2074 6865 2069 6c6c 756d 696e  g to the illumin
+00048370: 6174 696f 6e20 736f 7572 6365 2e20 0d0a  ation source. ..
+00048380: 0d0a 2020 2020 2020 2020 636f 6e74 7261  ..        contra
+00048390: 7374 203a 2073 6361 6c61 722c 206f 7074  st : scalar, opt
+000483a0: 696f 6e61 6c2c 2064 6566 6175 6c74 3a20  ional, default: 
+000483b0: 310d 0a20 2020 2020 2020 2020 2020 2053  1..            S
+000483c0: 6861 6469 6e67 2063 6f6e 7472 6173 7420  hading contrast 
+000483d0: 6164 6a75 7374 6d65 6e74 2066 726f 6d20  adjustment from 
+000483e0: 6c6f 7720 746f 2068 6967 6820 7769 7468  low to high with
+000483f0: 2061 2076 616c 7565 0d0a 2020 2020 2020   a value..      
+00048400: 2020 2020 2020 6f66 2031 2066 6f72 206c        of 1 for l
+00048410: 696e 6561 7220 7661 7269 6174 696f 6e73  inear variations
+00048420: 2077 6974 6820 7468 6520 6c69 6e65 2073   with the line s
+00048430: 6567 6d65 6e74 2064 6972 6563 7469 6f6e  egment direction
+00048440: 2e0d 0a20 2020 2020 2020 2020 2020 2043  ...            C
+00048450: 6f6e 7472 6173 7420 7661 6c75 6520 7261  ontrast value ra
+00048460: 6e67 6573 2066 726f 6d20 302e 3120 746f  nges from 0.1 to
+00048470: 2033 2e20 2020 2020 0d0a 2020 2020 2020   3.     ..      
+00048480: 2020 0d0a 2020 2020 2020 2020 5265 7475    ..        Retu
+00048490: 726e 730d 0a20 2020 2020 2020 202d 2d2d  rns..        ---
+000484a0: 2d2d 2d2d 0d0a 2020 2020 2020 2020 7365  ----..        se
+000484b0: 6c66 203a 206c 696e 6520 6f62 6a65 6374  lf : line object
+000484c0: 0d0a 0d0a 2020 2020 2020 2020 2222 220d  ....        """.
+000484d0: 0a0d 0a20 2020 2020 2020 2069 6620 6469  ...        if di
+000484e0: 7265 6374 696f 6e20 6973 204e 6f6e 6520  rection is None 
+000484f0: 3a20 6469 7265 6374 696f 6e20 3d20 5f49  : direction = _I
+00048500: 4c4c 554d 0d0a 2020 2020 2020 2020 6966  LLUM..        if
+00048510: 206e 702e 616e 7928 2028 6465 7074 683c   np.any( (depth<
+00048520: 3029 207c 2028 6465 7074 683e 3129 2029  0) | (depth>1) )
+00048530: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
+00048540: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+00048550: 2827 6465 7074 6820 7661 6c75 6573 2c20  ('depth values, 
+00048560: 7b7d 2c20 6d75 7374 2062 6520 6265 7477  {}, must be betw
+00048570: 6565 6e20 3020 616e 6420 3127 2e66 6f72  een 0 and 1'.for
+00048580: 6d61 7428 6465 7074 6829 290d 0a20 2020  mat(depth))..   
+00048590: 2020 2020 2069 6620 636f 6e74 7261 7374       if contrast
+000485a0: 2069 7320 6e6f 7420 4e6f 6e65 3a0d 0a20   is not None:.. 
+000485b0: 2020 2020 2020 2020 2020 2069 6620 2863             if (c
+000485c0: 6f6e 7472 6173 743c 302e 3120 6f72 2063  ontrast<0.1 or c
+000485d0: 6f6e 7472 6173 743e 3329 203a 0d0a 2020  ontrast>3) :..  
+000485e0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+000485f0: 6973 6520 5661 6c75 6545 7272 6f72 2827  ise ValueError('
+00048600: 636f 6e74 7261 7374 206d 7573 7420 6265  contrast must be
+00048610: 2062 6574 7765 656e 2030 2e31 2061 6e64   between 0.1 and
+00048620: 2033 2e20 2c20 666f 756e 6420 7b7d 272e   3. , found {}'.
+00048630: 666f 726d 6174 2863 6f6e 7472 6173 7429  format(contrast)
+00048640: 290d 0a0d 0a0d 0a20 2020 2020 2020 2023  )......        #
+00048650: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
+00048660: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00048670: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
+00048680: 2020 2020 636f 6c6f 7273 203d 2073 656c      colors = sel
+00048690: 662e 5f6c 6564 6765 636f 6c6f 7273 2020  f._ledgecolors  
+000486a0: 2320 7570 6461 7465 2066 6f72 2076 5f31  # update for v_1
+000486b0: 2e32 2e30 0d0a 2020 2020 2020 2020 7365  .2.0..        se
+000486c0: 676d 656e 7473 203d 2073 656c 662e 5f73  gments = self._s
+000486d0: 6567 6d65 6e74 7333 640d 0a20 2020 2020  egments3d..     
+000486e0: 2020 2069 6620 6e6f 7420 7365 6c66 2e69     if not self.i
+000486f0: 7353 6872 6564 6465 6420 3a0d 0a20 2020  sShredded :..   
+00048700: 2020 2020 2020 2020 2023 202e 2e2e 2e20           # .... 
+00048710: 6e6f 7465 3a63 6f6c 6f72 7320 6d6f 6469  note:colors modi
+00048720: 6669 6564 2c20 6e6f 7420 6372 6561 7465  fied, not create
+00048730: 640d 0a20 2020 2020 2020 2020 2020 2063  d..            c
+00048740: 6f6c 6f72 7320 3d20 7365 6c66 2e5f 7368  olors = self._sh
+00048750: 7265 645f 636f 6c6f 7228 290d 0a20 2020  red_color()..   
+00048760: 2020 2020 2020 2020 2073 6567 6d65 6e74           segment
+00048770: 7320 3d20 7365 6c66 2e5f 7368 7265 6428  s = self._shred(
+00048780: 290d 0a20 2020 2020 2020 2020 2020 2073  )..            s
+00048790: 656c 662e 5f6c 6564 6765 636f 6c6f 7273  elf._ledgecolors
+000487a0: 203d 2063 6f6c 6f72 7320 2023 2075 7064   = colors  # upd
+000487b0: 6174 6520 666f 7220 765f 312e 322e 300d  ate for v_1.2.0.
+000487c0: 0a20 2020 2020 2020 2065 6c73 6520 3a0d  .        else :.
+000487d0: 0a20 2020 2020 2020 2020 2020 206c 656e  .            len
+000487e0: 436f 6c20 3d20 6c65 6e28 7365 6c66 2e5f  Col = len(self._
+000487f0: 6c65 6467 6563 6f6c 6f72 7329 2020 2320  ledgecolors)  # 
+00048800: 7570 6461 7465 2066 6f72 2076 5f31 2e32  update for v_1.2
+00048810: 2e30 0d0a 2020 2020 2020 2020 2020 2020  .0..            
+00048820: 6c65 6e53 6567 203d 206c 656e 2873 6567  lenSeg = len(seg
+00048830: 6d65 6e74 7329 0d0a 2020 2020 2020 2020  ments)..        
+00048840: 2020 2020 6966 206c 656e 436f 6c20 213d      if lenCol !=
+00048850: 206c 656e 5365 6720 3a20 636f 6c6f 7273   lenSeg : colors
+00048860: 203d 2073 656c 662e 5f73 6872 6564 5f63   = self._shred_c
+00048870: 6f6c 6f72 2829 0d0a 2020 2020 2020 2020  olor()..        
+00048880: 2320 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  # --------------
+00048890: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000488a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020  -----------..   
+000488b0: 2020 2020 2073 6567 4469 7220 3d20 7365       segDir = se
+000488c0: 6c66 2e5f 6765 745f 7365 676d 656e 745f  lf._get_segment_
+000488d0: 6469 7265 6374 696f 6e73 2873 6567 6d65  directions(segme
+000488e0: 6e74 7329 0d0a 2020 2020 2020 2020 756e  nts)..        un
+000488f0: 6974 4469 7265 6374 696f 6e20 3d20 6e70  itDirection = np
+00048900: 2e64 6976 6964 6528 2064 6972 6563 7469  .divide( directi
+00048910: 6f6e 2c20 6e70 2e6c 696e 616c 672e 6e6f  on, np.linalg.no
+00048920: 726d 2864 6972 6563 7469 6f6e 2920 290d  rm(direction) ).
+00048930: 0a20 2020 2020 2020 2064 7470 726f 6420  .        dtprod 
+00048940: 3d20 6e70 2e64 6f74 2873 6567 4469 722c  = np.dot(segDir,
+00048950: 756e 6974 4469 7265 6374 696f 6e29 0d0a  unitDirection)..
+00048960: 2020 2020 2020 2020 2320 666f 7220 4c69          # for Li
+00048970: 6e65 732c 2065 6666 6563 7469 7665 2073  nes, effective s
+00048980: 6861 6465 2069 7320 6e6f 726d 616c 2074  hade is normal t
+00048990: 6f20 6c69 6e65 0d0a 2020 2020 2020 2020  o line..        
+000489a0: 6420 3d20 312d 206e 702e 6162 7328 6474  d = 1- np.abs(dt
+000489b0: 7072 6f64 290d 0a20 2020 2020 2020 2069  prod)..        i
+000489c0: 6620 636f 6e74 7261 7374 2069 7320 6e6f  f contrast is no
+000489d0: 7420 4e6f 6e65 203a 0d0a 2020 2020 2020  t None :..      
+000489e0: 2020 2020 2020 6420 3d20 2030 2e35 2a28        d =  0.5*(
+000489f0: 2031 202b 206e 702e 7369 676e 2864 7470   1 + np.sign(dtp
+00048a00: 726f 6429 2a6e 702e 706f 7765 7228 206e  rod)*np.power( n
+00048a10: 702e 6162 7328 6474 7072 6f64 2920 2c20  p.abs(dtprod) , 
+00048a20: 312f 636f 6e74 7261 7374 2920 2920 2020  1/contrast) )   
+00048a30: 2020 200d 0a20 2020 2020 2020 206f 7269     ..        ori
+00048a40: 675f 636f 6c6f 7273 203d 2063 6f6c 6f72  g_colors = color
+00048a50: 730d 0a20 2020 2020 2020 2061 6c70 6861  s..        alpha
+00048a60: 7320 3d20 6f72 6967 5f63 6f6c 6f72 735b  s = orig_colors[
+00048a70: 3a2c 333a 345d 0d0a 2020 2020 2020 2020  :,3:4]..        
+00048a80: 6663 5f6c 6573 735f 616c 7068 6120 3d20  fc_less_alpha = 
+00048a90: 6f72 6967 5f63 6f6c 6f72 735b 3a2c 3a33  orig_colors[:,:3
+00048aa0: 5d0d 0a20 2020 2020 2020 2068 7376 5f76  ]..        hsv_v
+00048ab0: 616c 7320 3d20 636d 2e63 6f6c 6f72 732e  als = cm.colors.
+00048ac0: 7267 625f 746f 5f68 7376 2866 635f 6c65  rgb_to_hsv(fc_le
+00048ad0: 7373 5f61 6c70 6861 290d 0a20 2020 2020  ss_alpha)..     
+00048ae0: 2020 2023 2061 646a 7573 7420 636f 6c6f     # adjust colo
+00048af0: 7220 7661 6c75 6520 7769 7468 206d 756c  r value with mul
+00048b00: 7469 706c 6965 722e 0d0a 2020 2020 2020  tiplier...      
+00048b10: 2020 6376 6d20 3d20 2828 312d 6465 7074    cvm = ((1-dept
+00048b20: 6829 2a64 202b 2064 6570 7468 2a6e 702e  h)*d + depth*np.
+00048b30: 6f6e 6573 286c 656e 2864 2929 295b 3a2c  ones(len(d)))[:,
+00048b40: 206e 702e 6e65 7761 7869 735d 0d0a 2020   np.newaxis]..  
+00048b50: 2020 2020 2020 6873 765f 7661 6c73 5b3a        hsv_vals[:
+00048b60: 2c32 5d20 3d20 2863 766d 2a68 7376 5f76  ,2] = (cvm*hsv_v
+00048b70: 616c 735b 3a2c 323a 335d 295b 3a2c 305d  als[:,2:3])[:,0]
+00048b80: 0d0a 2020 2020 2020 2020 7267 625f 7661  ..        rgb_va
+00048b90: 6c73 203d 2020 636d 2e63 6f6c 6f72 732e  ls =  cm.colors.
+00048ba0: 6873 765f 746f 5f72 6762 2868 7376 5f76  hsv_to_rgb(hsv_v
+00048bb0: 616c 7329 0d0a 2020 2020 2020 2020 7368  als)..        sh
+00048bc0: 6164 655f 636f 6c6f 7273 203d 206e 702e  ade_colors = np.
+00048bd0: 636f 6e63 6174 656e 6174 6528 2872 6762  concatenate((rgb
+00048be0: 5f76 616c 732c 2061 6c70 6861 7329 2c20  _vals, alphas), 
+00048bf0: 6178 6973 3d31 290d 0a20 2020 2020 2020  axis=1)..       
+00048c00: 2073 656c 662e 5f6c 6564 6765 636f 6c6f   self._ledgecolo
+00048c10: 7273 203d 2073 6861 6465 5f63 6f6c 6f72  rs = shade_color
+00048c20: 7320 2023 2075 7064 6174 6520 666f 7220  s  # update for 
+00048c30: 765f 312e 322e 300d 0a20 2020 2020 2020  v_1.2.0..       
+00048c40: 2073 656c 662e 7365 745f 636f 6c6f 7228   self.set_color(
+00048c50: 7368 6164 655f 636f 6c6f 7273 290d 0a0d  shade_colors)...
+00048c60: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00048c70: 7365 6c66 0d0a 0d0a 2020 2020 6465 6620  self....    def 
+00048c80: 6661 6465 2873 656c 662c 6465 7074 683d  fade(self,depth=
+00048c90: 302c 656c 6576 3d4e 6f6e 652c 617a 696d  0,elev=None,azim
+00048ca0: 3d4e 6f6e 652c 6178 3d4e 6f6e 6529 203a  =None,ax=None) :
+00048cb0: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
+00048cc0: 2020 2020 2020 2052 6564 7563 6520 6c69         Reduce li
+00048cd0: 6e65 206f 7061 6369 7479 2062 6173 6564  ne opacity based
+00048ce0: 206f 6e20 6c69 6e65 2073 6567 6d65 6e74   on line segment
+00048cf0: 2070 6f73 6974 696f 6e20 7265 6c61 7469   position relati
+00048d00: 7665 0d0a 2020 2020 2020 2020 746f 2074  ve..        to t
+00048d10: 6865 2076 6965 7720 6f72 6965 6e74 6174  he view orientat
+00048d20: 696f 6e2e 0d0a 2020 2020 2020 2020 0d0a  ion...        ..
+00048d30: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+00048d40: 7273 0d0a 2020 2020 2020 2020 2d2d 2d2d  rs..        ----
+00048d50: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
+00048d60: 6465 7074 6820 3a20 7363 616c 6172 2c20  depth : scalar, 
+00048d70: 6f70 7469 6f6e 616c 2c20 6465 6661 756c  optional, defaul
+00048d80: 743a 2030 0d0a 2020 2020 2020 2020 2020  t: 0..          
+00048d90: 2020 4d69 6e69 6d75 6d20 6f70 6163 6974    Minimum opacit
+00048da0: 7920 746f 2031 2066 6f72 206c 696e 6561  y to 1 for linea
+00048db0: 7220 6c69 6e65 206f 7061 6369 7479 2066  r line opacity f
+00048dc0: 726f 6d20 6261 636b 0d0a 2020 2020 2020  rom back..      
+00048dd0: 2020 2020 2020 746f 2066 726f 6e74 206c        to front l
+00048de0: 696e 6520 7365 676d 656e 7420 706f 7369  ine segment posi
+00048df0: 7469 6f6e 2e0d 0a20 2020 2020 2020 2020  tion...         
+00048e00: 2020 2044 6570 7468 2076 616c 7565 2072     Depth value r
+00048e10: 616e 6765 7320 6672 6f6d 2030 2074 6f20  anges from 0 to 
+00048e20: 312e 0d0a 0d0a 2020 2020 2020 2020 656c  1.....        el
+00048e30: 6576 203a 2073 6361 6c61 722c 206f 7074  ev : scalar, opt
+00048e40: 696f 6e61 6c2c 2064 6566 6175 6c74 3a20  ional, default: 
+00048e50: 3330 0d0a 2020 2020 2020 2020 2020 2020  30..            
+00048e60: 456c 6576 6174 696f 6e20 6f66 2074 6865  Elevation of the
+00048e70: 2061 7865 7320 7669 6577 2e0d 0a0d 0a20   axes view..... 
+00048e80: 2020 2020 2020 2061 7a69 6d20 3a20 7363         azim : sc
+00048e90: 616c 6172 2c20 6f70 7469 6f6e 616c 2c20  alar, optional, 
+00048ea0: 6465 6661 756c 743a 202d 3630 0d0a 2020  default: -60..  
+00048eb0: 2020 2020 2020 2020 2020 417a 696d 7574            Azimut
+00048ec0: 6820 6f66 2074 6865 2061 7865 7320 7669  h of the axes vi
+00048ed0: 6577 2e20 0d0a 2020 2020 2020 2020 0d0a  ew. ..        ..
+00048ee0: 2020 2020 2020 2020 6178 3a20 4d61 7470          ax: Matp
+00048ef0: 6c6f 746c 6962 2033 4420 6178 6573 2e0d  lotlib 3D axes..
+00048f00: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
+00048f10: 6e6f 7420 4e6f 6e65 2c20 656c 6576 2061  not None, elev a
+00048f20: 6e64 2061 7a69 6d20 6172 6520 7461 6b65  nd azim are take
+00048f30: 6e20 6672 6f6d 2074 6865 2061 782e 0d0a  n from the ax...
+00048f40: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+00048f50: 2020 5265 7475 726e 730d 0a20 2020 2020    Returns..     
+00048f60: 2020 202d 2d2d 2d2d 2d2d 0d0a 2020 2020     -------..    
+00048f70: 2020 2020 7365 6c66 203a 206c 696e 6520      self : line 
+00048f80: 6f62 6a65 6374 0d0a 0d0a 2020 2020 2020  object....      
+00048f90: 2020 2222 220d 0a0d 0a20 2020 2020 2020    """....       
+00048fa0: 2069 6620 6178 2069 7320 4e6f 6e65 203a   if ax is None :
+00048fb0: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+00048fc0: 2065 6c65 7620 6973 204e 6f6e 653a 2065   elev is None: e
+00048fd0: 6c65 7620 3d20 5f44 4654 5f56 4945 575b  lev = _DFT_VIEW[
+00048fe0: 305d 0d0a 2020 2020 2020 2020 2020 2020  0]..            
+00048ff0: 6966 2061 7a69 6d20 6973 204e 6f6e 653a  if azim is None:
+00049000: 2061 7a69 6d20 3d20 5f44 4654 5f56 4945   azim = _DFT_VIE
+00049010: 575b 315d 0d0a 2020 2020 2020 2020 656c  W[1]..        el
+00049020: 7365 203a 0d0a 2020 2020 2020 2020 2020  se :..          
+00049030: 2020 656c 6576 203d 2061 782e 656c 6576    elev = ax.elev
+00049040: 0d0a 2020 2020 2020 2020 2020 2020 617a  ..            az
+00049050: 696d 203d 2061 782e 617a 696d 0d0a 2020  im = ax.azim..  
+00049060: 2020 2020 2020 6469 7265 6374 696f 6e20        direction 
+00049070: 3d20 656c 6576 5f61 7a69 6d5f 3276 6563  = elev_azim_2vec
+00049080: 746f 7228 656c 6576 2c20 617a 696d 290d  tor(elev, azim).
+00049090: 0a20 2020 2020 2020 2075 6e69 7444 6972  .        unitDir
+000490a0: 6563 7469 6f6e 203d 206e 702e 6469 7669  ection = np.divi
+000490b0: 6465 2820 6469 7265 6374 696f 6e2c 206e  de( direction, n
+000490c0: 702e 6c69 6e61 6c67 2e6e 6f72 6d28 6469  p.linalg.norm(di
+000490d0: 7265 6374 696f 6e29 2029 0d0a 0d0a 2020  rection) )....  
+000490e0: 2020 2020 2020 6966 206e 702e 616e 7928        if np.any(
+000490f0: 2028 6465 7074 683c 3029 206f 7220 2864   (depth<0) or (d
+00049100: 6570 7468 3e31 2920 2920 3a0d 0a20 2020  epth>1) ) :..   
+00049110: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+00049120: 616c 7565 4572 726f 7228 2764 6570 7468  alueError('depth
+00049130: 2076 616c 7565 732c 207b 7d2c 206d 7573   values, {}, mus
+00049140: 7420 6265 2062 6574 7765 656e 2030 2061  t be between 0 a
+00049150: 6e64 2031 272e 666f 726d 6174 2864 6570  nd 1'.format(dep
+00049160: 7468 2929 0d0a 0d0a 2020 2020 2020 2020  th))....        
+00049170: 2320 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  # --------------
+00049180: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00049190: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020  -----------..   
+000491a0: 2020 2020 2023 636f 6c6f 7273 203d 2073       #colors = s
+000491b0: 656c 662e 5f65 6467 6563 6f6c 6f72 730d  elf._edgecolors.
+000491c0: 0a20 2020 2020 2020 2063 6f6c 6f72 7320  .        colors 
+000491d0: 3d20 7365 6c66 2e67 6574 5f65 6467 6563  = self.get_edgec
+000491e0: 6f6c 6f72 2829 2020 2320 7570 6461 7465  olor()  # update
+000491f0: 2066 6f72 2076 5f31 2e32 2e30 0d0a 2020   for v_1.2.0..  
+00049200: 2020 2020 2020 7365 676d 656e 7473 203d        segments =
+00049210: 2073 656c 662e 5f73 6567 6d65 6e74 7333   self._segments3
+00049220: 640d 0a20 2020 2020 2020 2069 6620 6e6f  d..        if no
+00049230: 7420 7365 6c66 2e69 7353 6872 6564 6465  t self.isShredde
+00049240: 6420 3a0d 0a20 2020 2020 2020 2020 2020  d :..           
+00049250: 2023 202e 2e2e 2e20 6e6f 7465 3a63 6f6c   # .... note:col
+00049260: 6f72 7320 6d6f 6469 6669 6564 2c20 6e6f  ors modified, no
+00049270: 7420 6372 6561 7465 640d 0a20 2020 2020  t created..     
+00049280: 2020 2020 2020 2063 6f6c 6f72 7320 3d20         colors = 
+00049290: 7365 6c66 2e5f 7368 7265 645f 636f 6c6f  self._shred_colo
+000492a0: 7228 290d 0a20 2020 2020 2020 2020 2020  r()..           
+000492b0: 2073 6567 6d65 6e74 7320 3d20 7365 6c66   segments = self
+000492c0: 2e5f 7368 7265 6428 290d 0a20 2020 2020  ._shred()..     
+000492d0: 2020 2020 2020 2023 7365 6c66 2e5f 6564         #self._ed
+000492e0: 6765 636f 6c6f 7273 203d 2063 6f6c 6f72  gecolors = color
+000492f0: 730d 0a20 2020 2020 2020 2020 2020 2073  s..            s
+00049300: 656c 662e 7365 745f 6564 6765 636f 6c6f  elf.set_edgecolo
+00049310: 7228 636f 6c6f 7273 2920 2023 2075 7064  r(colors)  # upd
+00049320: 6174 6520 666f 7220 765f 312e 322e 300d  ate for v_1.2.0.
+00049330: 0a20 2020 2020 2020 2065 6c73 6520 3a0d  .        else :.
+00049340: 0a20 2020 2020 2020 2020 2020 2023 6c65  .            #le
+00049350: 6e43 6f6c 203d 206c 656e 2873 656c 662e  nCol = len(self.
+00049360: 5f65 6467 6563 6f6c 6f72 7329 0d0a 2020  _edgecolors)..  
+00049370: 2020 2020 2020 2020 2020 6c65 6e43 6f6c            lenCol
+00049380: 203d 206c 656e 2863 6f6c 6f72 7329 2020   = len(colors)  
+00049390: 2320 7570 6461 7465 2066 6f72 2076 5f31  # update for v_1
+000493a0: 2e32 2e30 0d0a 2020 2020 2020 2020 2020  .2.0..          
+000493b0: 2020 6c65 6e53 6567 203d 206c 656e 2873    lenSeg = len(s
+000493c0: 6567 6d65 6e74 7329 0d0a 2020 2020 2020  egments)..      
+000493d0: 2020 2020 2020 6966 206c 656e 436f 6c20        if lenCol 
+000493e0: 213d 206c 656e 5365 6720 3a20 636f 6c6f  != lenSeg : colo
+000493f0: 7273 203d 2073 656c 662e 5f73 6872 6564  rs = self._shred
+00049400: 5f63 6f6c 6f72 2829 0d0a 2020 2020 2020  _color()..      
+00049410: 2020 2320 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    # ------------
+00049420: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00049430: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20  -------------.. 
+00049440: 2020 2020 2020 2073 6567 4365 6e74 6572         segCenter
+00049450: 7320 3d20 7365 6c66 2e5f 6765 745f 7365  s = self._get_se
+00049460: 676d 656e 745f 6365 6e74 6572 7328 7365  gment_centers(se
+00049470: 676d 656e 7473 290d 0a20 2020 2020 2020  gments)..       
+00049480: 2069 6620 6c65 6e28 7365 6743 656e 7465   if len(segCente
+00049490: 7273 2920 3d3d 2031 203a 2072 6574 7572  rs) == 1 : retur
+000494a0: 6e20 7365 6c66 2023 2066 6164 6520 6e6f  n self # fade no
+000494b0: 7420 6176 6169 6c61 626c 6520 666f 7220  t available for 
+000494c0: 7369 6e67 6c65 2073 6567 6d65 6e74 206c  single segment l
+000494d0: 696e 6520 0d0a 2020 2020 2020 2020 6474  ine ..        dt
+000494e0: 7072 6f64 203d 206e 702e 646f 7428 7365  prod = np.dot(se
+000494f0: 6743 656e 7465 7273 2c75 6e69 7444 6972  gCenters,unitDir
+00049500: 6563 7469 6f6e 290d 0a20 2020 2020 2020  ection)..       
+00049510: 2064 7072 616e 6765 203d 206e 702e 616d   dprange = np.am
+00049520: 6178 2864 7470 726f 6429 2d6e 702e 616d  ax(dtprod)-np.am
+00049530: 696e 2864 7470 726f 6429 0d0a 2020 2020  in(dtprod)..    
+00049540: 2020 2020 6e6f 726d 5f64 7020 3d20 2864      norm_dp = (d
+00049550: 7470 726f 6420 2d20 6e70 2e61 6d69 6e28  tprod - np.amin(
+00049560: 6474 7072 6f64 2929 2f64 7072 616e 6765  dtprod))/dprange
+00049570: 0d0a 2020 2020 2020 2020 6661 6465 7820  ..        fadex 
+00049580: 3d20 2831 2d64 6570 7468 292a 6e6f 726d  = (1-depth)*norm
+00049590: 5f64 7020 2b20 6465 7074 680d 0a0d 0a20  _dp + depth.... 
+000495a0: 2020 2020 2020 206f 7269 675f 636f 6c6f         orig_colo
+000495b0: 7273 203d 2063 6f6c 6f72 730d 0a20 2020  rs = colors..   
+000495c0: 2020 2020 2066 635f 6c65 7373 5f61 6c70       fc_less_alp
+000495d0: 6861 203d 206f 7269 675f 636f 6c6f 7273  ha = orig_colors
+000495e0: 5b3a 2c3a 335d 0d0a 2020 2020 2020 2020  [:,:3]..        
+000495f0: 6661 6465 7820 3d20 6661 6465 782a 6f72  fadex = fadex*or
+00049600: 6967 5f63 6f6c 6f72 735b 3a2c 335d 2020  ig_colors[:,3]  
+00049610: 2320 7570 6461 7465 2066 6f72 2076 5f31  # update for v_1
+00049620: 2e32 2e30 200d 0a20 2020 2020 2020 2066  .2.0 ..        f
+00049630: 6164 6564 5f63 6f6c 6f72 7320 3d20 6e70  aded_colors = np
+00049640: 2e63 6f6e 6361 7465 6e61 7465 2828 6663  .concatenate((fc
+00049650: 5f6c 6573 735f 616c 7068 612c 2066 6164  _less_alpha, fad
+00049660: 6578 5b3a 2c6e 702e 6e65 7761 7869 735d  ex[:,np.newaxis]
+00049670: 2029 2c20 6178 6973 3d31 290d 0a20 2020   ), axis=1)..   
+00049680: 2020 2020 2023 7365 6c66 2e5f 6564 6765       #self._edge
+00049690: 636f 6c6f 7273 203d 2066 6164 6564 5f63  colors = faded_c
+000496a0: 6f6c 6f72 7320 2020 0d0a 2020 2020 2020  olors   ..      
+000496b0: 2020 7365 6c66 2e73 6574 5f65 6467 6563    self.set_edgec
+000496c0: 6f6c 6f72 2866 6164 6564 5f63 6f6c 6f72  olor(faded_color
+000496d0: 7329 2020 2320 7570 6461 7465 2066 6f72  s)  # update for
+000496e0: 2076 5f31 2e32 2e30 2020 200d 0a20 2020   v_1.2.0   ..   
+000496f0: 2020 2020 2073 656c 662e 7365 745f 636f       self.set_co
+00049700: 6c6f 7228 6661 6465 645f 636f 6c6f 7273  lor(faded_colors
+00049710: 2920 2023 2075 7064 6174 6520 666f 7220  )  # update for 
+00049720: 765f 312e 322e 3020 2020 0d0a 0d0a 2020  v_1.2.0   ....  
+00049730: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00049740: 660d 0a0d 0a20 2020 2064 6566 2074 7261  f....    def tra
+00049750: 6e73 666f 726d 2873 656c 662c 2072 6f74  nsform(self, rot
+00049760: 6174 653d 4e6f 6e65 2c20 7363 616c 653d  ate=None, scale=
+00049770: 312e 302c 2074 7261 6e73 6c61 7465 3d5b  1.0, translate=[
+00049780: 302c 302c 305d 2029 2020 3a0d 0a20 2020  0,0,0] )  :..   
+00049790: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
+000497a0: 2020 4c69 6e65 6172 2074 7261 6e73 666f    Linear transfo
+000497b0: 726d 6174 696f 6e20 6f66 2074 6865 206c  rmation of the l
+000497c0: 696e 6520 6f62 6a65 6374 2e0d 0a0d 0a20  ine object..... 
+000497d0: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+000497e0: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+000497f0: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2072  -----..        r
+00049800: 6f74 6174 6520 3a20 2061 7272 6179 2d6c  otate :  array-l
+00049810: 696b 652c 206f 7074 696f 6e61 6c2c 2064  ike, optional, d
+00049820: 6566 6175 6c74 3a20 4e6f 6e65 0d0a 2020  efault: None..  
+00049830: 2020 2020 2020 2020 2020 4120 3320 6279            A 3 by
+00049840: 2033 2072 6f74 6174 696f 6e20 6d61 7472   3 rotation matr
+00049850: 6978 2e0d 0a0d 0a20 2020 2020 2020 2073  ix.....        s
+00049860: 6361 6c65 203a 2033 4420 6172 7261 7920  cale : 3D array 
+00049870: 6f72 2073 6361 6c61 722c 206f 7074 696f  or scalar, optio
+00049880: 6e61 6c2c 2064 6566 6175 6c74 3a20 312e  nal, default: 1.
+00049890: 300d 0a20 2020 2020 2020 2020 2020 204d  0..            M
+000498a0: 756c 7469 706c 6965 7273 206f 6620 7468  ultipliers of th
+000498b0: 6520 6f62 6a65 6374 2063 6f6f 7264 696e  e object coordin
+000498c0: 6174 6573 2c20 696e 0d0a 2020 2020 2020  ates, in..      
+000498d0: 2020 2020 2020 7879 7a20 636f 6f72 6469        xyz coordi
+000498e0: 6e61 7465 732e 2049 6620 6120 7369 6e67  nates. If a sing
+000498f0: 6c65 2073 6361 6c61 722c 2074 6872 6565  le scalar, three
+00049900: 0d0a 2020 2020 2020 2020 2020 2020 6d75  ..            mu
+00049910: 6c74 6970 6c69 6572 7320 6172 6520 7468  ltipliers are th
+00049920: 6520 7361 6d65 2076 616c 7565 2e0d 0a20  e same value... 
+00049930: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00049940: 2074 7261 6e73 6c61 7465 203a 2061 7272   translate : arr
+00049950: 6179 2d6c 696b 652c 206f 7074 696f 6e61  ay-like, optiona
+00049960: 6c2c 2064 6566 6175 6c74 3a20 5b30 2c30  l, default: [0,0
+00049970: 2c30 5d0d 0a20 2020 2020 2020 2020 2020  ,0]..           
+00049980: 2041 2078 797a 2074 7261 6e73 6c61 7469   A xyz translati
+00049990: 6f6e 2076 6563 746f 7220 6f66 206f 626a  on vector of obj
+000499a0: 6563 7420 6f72 6967 696e 2e20 0d0a 0d0a  ect origin. ....
+000499b0: 2020 2020 2020 2020 5265 7475 726e 730d          Returns.
+000499c0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+000499d0: 0d0a 2020 2020 2020 2020 7365 6c66 203a  ..        self :
+000499e0: 206c 696e 6520 6f62 6a65 6374 0d0a 0d0a   line object....
+000499f0: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
+00049a00: 2020 2020 2069 6620 726f 7461 7465 2069       if rotate i
+00049a10: 7320 4e6f 6e65 203a 2072 6f74 6174 6520  s None : rotate 
+00049a20: 3d20 6e70 2e69 6465 6e74 6974 7928 3329  = np.identity(3)
+00049a30: 0d0a 2020 2020 2020 2020 6966 2069 7369  ..        if isi
+00049a40: 6e73 7461 6e63 6528 7363 616c 652c 2869  nstance(scale,(i
+00049a50: 6e74 2c66 6c6f 6174 2929 203a 0d0a 2020  nt,float)) :..  
+00049a60: 2020 2020 2020 2020 2020 7363 616c 6520            scale 
+00049a70: 3d20 206e 702e 6675 6c6c 2833 2c73 6361  =  np.full(3,sca
+00049a80: 6c65 292e 6173 7479 7065 2866 6c6f 6174  le).astype(float
+00049a90: 290d 0a20 2020 2020 2020 2023 2e2e 2e2e  )..        #....
+00049aa0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00049ab0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00049ac0: 2e20 2020 200d 0a20 2020 2020 2020 2064  .    ..        d
+00049ad0: 6566 2069 734f 7274 6828 4d29 203a 0d0a  ef isOrth(M) :..
+00049ae0: 2020 2020 2020 2020 2020 2020 4d20 3d20              M = 
+00049af0: 6e70 2e61 7272 6179 284d 290d 0a20 2020  np.array(M)..   
+00049b00: 2020 2020 2020 2020 2074 6f6c 203d 2030           tol = 0
+00049b10: 2e30 3030 3031 0d0a 2020 2020 2020 2020  .00001..        
+00049b20: 2020 2020 7072 6f64 203d 206e 702e 646f      prod = np.do
+00049b30: 7428 4d2c 4d2e 5429 0d0a 2020 2020 2020  t(M,M.T)..      
+00049b40: 2020 2020 2020 6e70 2e66 696c 6c5f 6469        np.fill_di
+00049b50: 6167 6f6e 616c 2870 726f 642c 302e 3029  agonal(prod,0.0)
+00049b60: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
+00049b70: 7475 726e 206e 6f74 2028 6e70 2e61 6273  turn not (np.abs
+00049b80: 2870 726f 6429 3e74 6f6c 292e 616e 7928  (prod)>tol).any(
+00049b90: 290d 0a20 2020 2020 2020 2023 2e2e 2e2e  )..        #....
+00049ba0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00049bb0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00049bc0: 2e20 2020 200d 0a20 2020 2020 2020 2074  .    ..        t
+00049bd0: 7261 6e73 203d 206c 616d 6264 6120 562c  rans = lambda V,
+00049be0: 532c 5420 3a20 6e70 2e61 6464 2820 206e  S,T : np.add(  n
+00049bf0: 702e 646f 7428 206e 702e 6d75 6c74 6970  p.dot( np.multip
+00049c00: 6c79 2856 2c53 292c 726f 7461 7465 2920  ly(V,S),rotate) 
+00049c10: 2c54 290d 0a20 2020 2020 2020 2023 2e2e  ,T)..        #..
+00049c20: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00049c30: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00049c40: 2e2e 2e20 2020 200d 0a20 2020 2020 2020  ...    ..       
+00049c50: 2069 6620 6e6f 7420 6973 4f72 7468 2872   if not isOrth(r
+00049c60: 6f74 6174 6529 203a 0d0a 2020 2020 2020  otate) :..      
+00049c70: 2020 2020 2020 7761 726e 696e 6773 2e77        warnings.w
+00049c80: 6172 6e28 2754 7261 6e73 666f 726d 2072  arn('Transform r
+00049c90: 6f74 6174 6520 6d61 7472 6978 2069 7320  otate matrix is 
+00049ca0: 4e4f 5420 4f72 7468 6f67 696e 616c 2e27  NOT Orthoginal.'
+00049cb0: 290d 0a20 2020 2020 2020 200d 0a20 2020  )..        ..   
+00049cc0: 2020 2020 2076 203d 2074 7261 6e73 2820       v = trans( 
+00049cd0: 7365 6c66 2e76 6572 7465 7843 6f6f 722c  self.vertexCoor,
+00049ce0: 2073 6361 6c65 2c20 7472 616e 736c 6174   scale, translat
+00049cf0: 6520 2029 0d0a 2020 2020 2020 2020 7365  e  )..        se
+00049d00: 6773 203d 2073 656c 662e 5f67 6574 5f73  gs = self._get_s
+00049d10: 6567 6d65 6e74 7328 2076 2c20 7365 6c66  egments( v, self
+00049d20: 2e73 6567 6d49 6e64 6963 6573 290d 0a0d  .segmIndices)...
+00049d30: 0a20 2020 2020 2020 2073 656c 662e 7665  .        self.ve
+00049d40: 7274 6578 436f 6f72 203d 2076 0d0a 2020  rtexCoor = v..  
+00049d50: 2020 2020 2020 7365 6c66 2e73 6574 5f73        self.set_s
+00049d60: 6567 6d65 6e74 7328 7365 6773 290d 0a20  egments(segs).. 
+00049d70: 2020 2020 2020 2073 656c 662e 7363 616c         self.scal
+00049d80: 6520 3d20 7363 616c 650d 0a20 2020 2020  e = scale..     
+00049d90: 2020 2073 656c 662e 7472 616e 736c 6174     self.translat
+00049da0: 696f 6e20 3d20 7472 616e 736c 6174 650d  ion = translate.
+00049db0: 0a20 2020 2020 2020 2073 656c 662e 726f  .        self.ro
+00049dc0: 7461 7469 6f6e 203d 2072 6f74 6174 650d  tation = rotate.
+00049dd0: 0a0d 0a20 2020 2020 2020 205f 7365 745f  ...        _set_
+00049de0: 6765 6f6d 426f 756e 6473 2873 656c 662e  geomBounds(self.
+00049df0: 7665 7274 6578 436f 6f72 2c73 656c 662e  vertexCoor,self.
+00049e00: 5f62 6f75 6e64 7329 0d0a 0d0a 2020 2020  _bounds)....    
+00049e10: 2020 2020 7265 7475 726e 2073 656c 660d      return self.
+00049e20: 0a0d 0a20 2020 2064 6566 2067 6574 5f74  ...    def get_t
+00049e30: 7261 6e73 666f 726d 4178 6973 2873 656c  ransformAxis(sel
+00049e40: 662c 202a 2a6b 6172 6773 2920 3a0d 0a20  f, **kargs) :.. 
+00049e50: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
+00049e60: 2020 2020 4c69 6e65 3344 436f 6c6c 6563      Line3DCollec
+00049e70: 7469 6f6e 206f 6620 7468 6520 276c 6173  tion of the 'las
+00049e80: 7427 2074 7261 6e73 666f 726d 6564 206c  t' transformed l
+00049e90: 696e 6520 636f 6f72 6469 6e61 7465 2061  ine coordinate a
+00049ea0: 7869 732e 0d0a 2020 2020 2020 2020 0d0a  xis...        ..
+00049eb0: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+00049ec0: 7273 0d0a 2020 2020 2020 2020 2d2d 2d2d  rs..        ----
+00049ed0: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
+00049ee0: 6c65 6e6d 756c 7420 3a20 7363 616c 6172  lenmult : scalar
+00049ef0: 206f 7220 3344 2061 7272 6179 2c20 6f70   or 3D array, op
+00049f00: 7469 6f6e 616c 2c20 6465 6661 756c 743a  tional, default:
+00049f10: 2031 0d0a 2020 2020 2020 2020 2020 2020   1..            
+00049f20: 5363 616c 6172 206d 756c 7469 706c 6965  Scalar multiplie
+00049f30: 7220 6f66 2074 6865 2074 6872 6565 2063  r of the three c
+00049f40: 6f6f 7264 696e 6174 6520 6178 6973 2e0d  oordinate axis..
+00049f50: 0a0d 0a20 2020 2020 2020 2077 6964 7468  ...        width
+00049f60: 203a 2073 6361 6c61 722c 206f 7074 696f   : scalar, optio
+00049f70: 6e61 6c2c 2064 6566 6175 6c74 3a20 312e  nal, default: 1.
+00049f80: 350d 0a20 2020 2020 2020 2020 2020 204c  5..            L
+00049f90: 696e 6520 7769 6474 6820 6f66 2074 6865  ine width of the
+00049fa0: 2063 6f6f 7264 696e 6174 6520 6178 6973   coordinate axis
+00049fb0: 2e20 2020 0d0a 0d0a 2020 2020 2020 2020  .   ....        
+00049fc0: 636f 6c6f 7220 3a20 6120 436f 6c6f 7220  color : a Color 
+00049fd0: 6f72 2033 4420 6172 7261 7920 6f66 2043  or 3D array of C
+00049fe0: 6f6c 6f72 732c 206f 7074 696f 6e61 6c2c  olors, optional,
+00049ff0: 2064 6566 6175 6c74 3a20 5b27 7227 2c27   default: ['r','
+0004a000: 6727 2c27 6227 5d0d 0a0d 0a20 2020 2020  g','b']....     
+0004a010: 2020 206e 6567 6178 6973 203a 2062 6f6f     negaxis : boo
+0004a020: 6c65 616e 2c20 6f70 7469 6f6e 616c 2c20  lean, optional, 
+0004a030: 6465 6661 756c 743a 2046 616c 7365 0d0a  default: False..
+0004a040: 2020 2020 2020 2020 2020 2020 4966 2054              If T
+0004a050: 7275 652c 2069 6e63 6c75 6465 2074 6865  rue, include the
+0004a060: 206e 6567 6174 6976 6520 6178 6973 2c20   negative axis, 
+0004a070: 6f74 6865 7277 6973 6520 6178 6573 2073  otherwise axes s
+0004a080: 7461 7274 2061 7420 6f72 6967 696e 2e0d  tart at origin..
+0004a090: 0a0d 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
+0004a0a0: 6e73 0d0a 2020 2020 2020 2020 2d2d 2d2d  ns..        ----
+0004a0b0: 2d2d 2d0d 0a20 2020 2020 2020 204c 696e  ---..        Lin
+0004a0c0: 6533 4443 6f6c 6c65 6374 696f 6e20 6f62  e3DCollection ob
+0004a0d0: 6a65 6374 0d0a 0d0a 2020 2020 2020 2020  ject....        
+0004a0e0: 2222 220d 0a20 2020 2020 2020 206b 6172  """..        kar
+0004a0f0: 6744 6674 203d 207b 2027 6c65 6e6d 756c  gDft = { 'lenmul
+0004a100: 7427 3a31 2e30 2c20 2777 6964 7468 273a  t':1.0, 'width':
+0004a110: 312e 352c 2027 636f 6c6f 7227 3a5b 2772  1.5, 'color':['r
+0004a120: 272c 2767 272c 2762 275d 2c20 276e 6567  ','g','b'], 'neg
+0004a130: 6178 6973 273a 4661 6c73 6520 7d0d 0a20  axis':False }.. 
+0004a140: 2020 2020 2020 204b 5720 3d20 4b57 7072         KW = KWpr
+0004a150: 6f63 6573 736f 7228 6b61 7267 4466 742c  ocessor(kargDft,
+0004a160: 2767 6574 5f74 7261 6e73 666f 726d 4178  'get_transformAx
+0004a170: 6973 272c 2a2a 6b61 7267 7329 0d0a 2020  is',**kargs)..  
+0004a180: 2020 2020 2020 6c65 6e6d 756c 7420 3d20        lenmult = 
+0004a190: 4b57 2e67 6574 5661 6c28 276c 656e 6d75  KW.getVal('lenmu
+0004a1a0: 6c74 2729 0d0a 2020 2020 2020 2020 7769  lt')..        wi
+0004a1b0: 6474 6820 3d20 4b57 2e67 6574 5661 6c28  dth = KW.getVal(
+0004a1c0: 2777 6964 7468 2729 0d0a 2020 2020 2020  'width')..      
+0004a1d0: 2020 636f 6c6f 7220 3d20 4b57 2e67 6574    color = KW.get
+0004a1e0: 5661 6c28 2763 6f6c 6f72 2729 0d0a 2020  Val('color')..  
+0004a1f0: 2020 2020 2020 6e65 6761 7869 7320 3d20        negaxis = 
+0004a200: 4b57 2e67 6574 5661 6c28 276e 6567 6178  KW.getVal('negax
+0004a210: 6973 2729 0d0a 0d0a 2020 2020 2020 2020  is')....        
+0004a220: 7365 6c66 5072 6f70 203d 207b 0d0a 2020  selfProp = {..  
+0004a230: 2020 2020 2020 2020 2020 2773 6361 6c65            'scale
+0004a240: 2720 3a20 7365 6c66 2e73 6361 6c65 2c0d  ' : self.scale,.
+0004a250: 0a20 2020 2020 2020 2020 2020 2027 726f  .            'ro
+0004a260: 7461 7469 6f6e 2720 3a20 7365 6c66 2e72  tation' : self.r
+0004a270: 6f74 6174 696f 6e2c 0d0a 2020 2020 2020  otation,..      
+0004a280: 2020 2020 2020 2774 7261 6e73 6c61 7469        'translati
+0004a290: 6f6e 2720 3a20 7365 6c66 2e74 7261 6e73  on' : self.trans
+0004a2a0: 6c61 7469 6f6e 0d0a 2020 2020 2020 2020  lation..        
+0004a2b0: 7d0d 0a20 2020 2020 2020 2072 6574 7572  }..        retur
+0004a2c0: 6e20 5f74 7261 6e73 666f 726d 4178 6973  n _transformAxis
+0004a2d0: 2873 656c 6650 726f 702c 6c65 6e6d 756c  (selfProp,lenmul
+0004a2e0: 742c 2077 6964 7468 2c20 636f 6c6f 722c  t, width, color,
+0004a2f0: 206e 6567 6178 6973 290d 0a0d 0a20 2020   negaxis)....   
+0004a300: 2064 6566 205f 7265 6374 616e 6775 6c61   def _rectangula
+0004a310: 7465 4669 6c6c 6564 5375 7246 6163 6528  teFilledSurFace(
+0004a320: 7365 6c66 2c72 657a 2c62 6173 6556 636f  self,rez,baseVco
+0004a330: 6f72 2c62 6173 6546 6163 6556 6572 7465  or,baseFaceVerte
+0004a340: 7849 6e64 6963 6573 2c20 6d69 6456 6563  xIndices, midVec
+0004a350: 7446 756e 6329 203a 0d0a 2020 2020 2020  tFunc) :..      
+0004a360: 2020 7643 6f6f 7220 3d20 6261 7365 5663    vCoor = baseVc
+0004a370: 6f6f 722e 636f 7079 2829 0d0a 2020 2020  oor.copy()..    
+0004a380: 2020 2020 6676 496e 6469 6365 7320 3d20      fvIndices = 
+0004a390: 5b5d 0d0a 2020 2020 2020 2020 6576 496e  []..        evIn
+0004a3a0: 6469 6365 7320 3d20 5b5d 0d0a 2020 2020  dices = []..    
+0004a3b0: 2020 2020 232e 2e2e 2e2e 2e2e 2e2e 2e2e      #...........
+0004a3c0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0004a3d0: 2e2e 2e2e 2e2e 2e2e 2e2e 2020 2020 0d0a  ..........    ..
+0004a3e0: 2020 2020 2020 2020 6465 6620 6765 7456          def getV
+0004a3f0: 6572 7469 6365 734c 696e 6528 6465 6772  erticesLine(degr
+0004a400: 6565 2c20 6c65 6674 496e 6465 782c 2072  ee, leftIndex, r
+0004a410: 6967 6874 496e 6465 7829 203a 0d0a 2020  ightIndex) :..  
+0004a420: 2020 2020 2020 2020 2020 6465 6620 7265            def re
+0004a430: 6375 7273 5f65 6467 6543 6f6f 7228 6465  curs_edgeCoor(de
+0004a440: 6772 6565 2c20 696e 6465 784f 7269 6769  gree, indexOrigi
+0004a450: 6e2c 2069 7352 6967 6874 2c20 6c65 6674  n, isRight, left
+0004a460: 496e 6465 782c 2072 6967 6874 496e 6465  Index, rightInde
+0004a470: 782c 2045 696e 6465 7829 203a 0d0a 2020  x, Eindex) :..  
+0004a480: 2020 2020 2020 2020 2020 2020 2020 6d20                m 
+0004a490: 3d20 6465 6772 6565 202d 2031 0d0a 2020  = degree - 1..  
+0004a4a0: 2020 2020 2020 2020 2020 2020 2020 6465                de
+0004a4b0: 6c74 6120 3d20 696e 7428 6e70 2e70 6f77  lta = int(np.pow
+0004a4c0: 6572 2832 2c6d 2929 0d0a 2020 2020 2020  er(2,m))..      
+0004a4d0: 2020 2020 2020 2020 2020 6966 2069 7352            if isR
+0004a4e0: 6967 6874 203a 2064 656c 7461 203d 202d  ight : delta = -
+0004a4f0: 6465 6c74 610d 0a20 2020 2020 2020 2020  delta..         
+0004a500: 2020 2020 2020 2069 203d 2069 6e64 6578         i = index
+0004a510: 4f72 6967 696e 202d 2064 656c 7461 0d0a  Origin - delta..
+0004a520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004a530: 6d69 645f 636f 6f72 203d 206d 6964 5665  mid_coor = midVe
+0004a540: 6374 4675 6e63 2820 7643 6f6f 725b 6c65  ctFunc( vCoor[le
+0004a550: 6674 496e 6465 785d 2c20 7643 6f6f 725b  ftIndex], vCoor[
+0004a560: 7269 6768 7449 6e64 6578 5d20 290d 0a20  rightIndex] ).. 
+0004a570: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+0004a580: 7572 7265 6e74 436f 6f72 496e 6465 7820  urrentCoorIndex 
+0004a590: 3d20 6c65 6e28 7643 6f6f 7229 0d0a 2020  = len(vCoor)..  
+0004a5a0: 2020 2020 2020 2020 2020 2020 2020 7643                vC
+0004a5b0: 6f6f 722e 6170 7065 6e64 286d 6964 5f63  oor.append(mid_c
+0004a5c0: 6f6f 7229 0d0a 2020 2020 2020 2020 2020  oor)..          
+0004a5d0: 2020 2020 2020 4569 6e64 6578 5b69 5d20        Eindex[i] 
+0004a5e0: 3d20 6375 7272 656e 7443 6f6f 7249 6e64  = currentCoorInd
+0004a5f0: 6578 0d0a 2020 2020 2020 2020 2020 2020  ex..            
+0004a600: 2020 2020 6966 206d 203c 3d20 3020 3a0d      if m <= 0 :.
+0004a610: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0004a620: 2020 2020 2065 7649 6e64 6963 6573 2e61       evIndices.a
+0004a630: 7070 656e 6428 205b 6c65 6674 496e 6465  ppend( [leftInde
+0004a640: 782c 2063 7572 7265 6e74 436f 6f72 496e  x, currentCoorIn
+0004a650: 6465 785d 2029 2020 2020 2020 2020 2020  dex] )          
+0004a660: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+0004a670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004a680: 6576 496e 6469 6365 732e 6170 7065 6e64  evIndices.append
+0004a690: 2820 5b63 7572 7265 6e74 436f 6f72 496e  ( [currentCoorIn
+0004a6a0: 6465 782c 2072 6967 6874 496e 6465 785d  dex, rightIndex]
+0004a6b0: 2029 2020 2020 2020 2020 2020 2020 2020   )              
+0004a6c0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+0004a6d0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0004a6e0: 726e 0d0a 2020 2020 2020 2020 2020 2020  rn..            
+0004a6f0: 2020 2020 7265 6375 7273 5f65 6467 6543      recurs_edgeC
+0004a700: 6f6f 7228 6d2c 692c 4661 6c73 652c 6c65  oor(m,i,False,le
+0004a710: 6674 496e 6465 782c 6375 7272 656e 7443  ftIndex,currentC
+0004a720: 6f6f 7249 6e64 6578 2c20 4569 6e64 6578  oorIndex, Eindex
+0004a730: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0004a740: 2020 2072 6563 7572 735f 6564 6765 436f     recurs_edgeCo
+0004a750: 6f72 286d 2c69 2c54 7275 652c 6375 7272  or(m,i,True,curr
+0004a760: 656e 7443 6f6f 7249 6e64 6578 2c72 6967  entCoorIndex,rig
+0004a770: 6874 496e 6465 782c 2045 696e 6465 7829  htIndex, Eindex)
+0004a780: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0004a790: 2020 7265 7475 726e 0d0a 2020 2020 2020    return..      
+0004a7a0: 2020 2020 2020 232e 2e2e 2e2e 2e2e 2e2e        #.........
+0004a7b0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0004a7c0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2020 2020  ............    
+0004a7d0: 0d0a 2020 2020 2020 2020 2020 2020 694f  ..            iO
+0004a7e0: 7269 6769 6e20 3d20 696e 7428 6e70 2e70  rigin = int(np.p
+0004a7f0: 6f77 6572 2832 2c64 6567 7265 6529 290d  ower(2,degree)).
+0004a800: 0a20 2020 2020 2020 2020 2020 2045 696e  .            Ein
+0004a810: 6465 7820 3d20 5b4e 6f6e 655d 2a28 694f  dex = [None]*(iO
+0004a820: 7269 6769 6e2b 3129 0d0a 2020 2020 2020  rigin+1)..      
+0004a830: 2020 2020 2020 4569 6e64 6578 5b30 5d20        Eindex[0] 
+0004a840: 3d20 6c65 6674 496e 6465 780d 0a20 2020  = leftIndex..   
+0004a850: 2020 2020 2020 2020 2045 696e 6465 785b           Eindex[
+0004a860: 694f 7269 6769 6e5d 203d 2072 6967 6874  iOrigin] = right
+0004a870: 496e 6465 780d 0a20 2020 2020 2020 2020  Index..         
+0004a880: 2020 2069 6620 6465 6772 6565 3d3d 3020     if degree==0 
+0004a890: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0004a8a0: 2020 2065 7649 6e64 6963 6573 2e61 7070     evIndices.app
+0004a8b0: 656e 6428 205b 6c65 6674 496e 6465 782c  end( [leftIndex,
+0004a8c0: 2072 6967 6874 496e 6465 785d 2029 0d0a   rightIndex] )..
+0004a8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004a8e0: 7265 7475 726e 2045 696e 6465 780d 0a20  return Eindex.. 
+0004a8f0: 2020 2020 2020 2020 2020 2072 6563 7572             recur
+0004a900: 735f 6564 6765 436f 6f72 2864 6567 7265  s_edgeCoor(degre
+0004a910: 652c 2069 4f72 6967 696e 2c20 4661 6c73  e, iOrigin, Fals
+0004a920: 652c 206c 6566 7449 6e64 6578 2c20 7269  e, leftIndex, ri
+0004a930: 6768 7449 6e64 6578 2c20 4569 6e64 6578  ghtIndex, Eindex
+0004a940: 290d 0a20 2020 2020 2020 2020 2020 2072  )..            r
+0004a950: 6574 7572 6e20 4569 6e64 6578 0d0a 2020  eturn Eindex..  
+0004a960: 2020 2020 2020 232e 2e2e 2e2e 2e2e 2e2e        #.........
+0004a970: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0004a980: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2020 2020  ............    
+0004a990: 0d0a 2020 2020 2020 2020 6465 6620 7265  ..        def re
+0004a9a0: 6375 7273 5f66 6163 6549 6e64 6963 6573  curs_faceIndices
+0004a9b0: 2841 2c43 2c72 657a 293a 0d0a 2020 2020  (A,C,rez):..    
+0004a9c0: 2020 2020 2020 2020 2320 7369 6d69 6c61          # simila
+0004a9d0: 7220 746f 2069 6e6e 6572 2066 756e 6374  r to inner funct
+0004a9e0: 696f 6e20 6f66 2074 7269 616e 6775 6c61  ion of triangula
+0004a9f0: 7465 4261 7365 0d0a 2020 2020 2020 2020  teBase..        
+0004aa00: 2020 2020 6966 2072 657a 3d3d 3020 3a0d      if rez==0 :.
+0004aa10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0004aa20: 2061 6263 203d 205b 2041 5b30 5d2c 2041   abc = [ A[0], A
+0004aa30: 5b31 5d2c 2043 5b30 5d2c 2043 5b31 5d20  [1], C[0], C[1] 
+0004aa40: 5d20 2020 2020 2020 2020 2020 2020 2020  ]               
+0004aa50: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0004aa60: 2020 6676 496e 6469 6365 732e 6170 7065    fvIndices.appe
+0004aa70: 6e64 2820 6162 6320 290d 0a20 2020 2020  nd( abc )..     
+0004aa80: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0004aa90: 6e0d 0a20 2020 2020 2020 2020 2020 2023  n..            #
+0004aaa0: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
+0004aab0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0004aac0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0004aad0: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
+0004aae0: 2020 2020 4a20 3d20 696e 7428 2028 6c65      J = int( (le
+0004aaf0: 6e28 4129 2d31 292f 3220 290d 0a20 2020  n(A)-1)/2 )..   
+0004ab00: 2020 2020 2020 2020 204b 203d 204a 202b           K = J +
+0004ab10: 2031 0d0a 2020 2020 2020 2020 2020 2020   1..            
+0004ab20: 2320 7375 6469 7669 6465 2074 6865 2074  # sudivide the t
+0004ab30: 776f 2069 6e6e 6572 2071 7561 6472 6174  wo inner quadrat
+0004ab40: 6572 616c 7320 2e2e 2e2e 2e2e 2e2e 2e2e  erals ..........
+0004ab50: 2e2e 2e2e 2e2e 2e0d 0a20 2020 2020 2020  .........       
+0004ab60: 2020 2020 2072 6563 7572 735f 6661 6365       recurs_face
+0004ab70: 496e 6469 6365 7328 2041 5b3a 4b5d 2c20  Indices( A[:K], 
+0004ab80: 2043 5b4a 3a5d 2c20 7265 7a2d 3129 0d0a   C[J:], rez-1)..
+0004ab90: 2020 2020 2020 2020 2020 2020 7265 6375              recu
+0004aba0: 7273 5f66 6163 6549 6e64 6963 6573 2820  rs_faceIndices( 
+0004abb0: 435b 3a4b 5d2c 2020 415b 4a3a 5d2c 2072  C[:K],  A[J:], r
+0004abc0: 657a 2d31 290d 0a20 2020 2020 2020 2020  ez-1)..         
+0004abd0: 2020 2072 6574 7572 6e0d 0a20 2020 2020     return..     
+0004abe0: 2020 2023 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e     #............
+0004abf0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0004ac00: 2e2e 2e2e 2e2e 2e2e 2e0d 0a20 2020 2020  ...........     
+0004ac10: 2020 2069 5f70 7265 765f 3220 3d20 2d31     i_prev_2 = -1
+0004ac20: 2020 2320 6368 6563 6b20 666f 7220 6669    # check for fi
+0004ac30: 7273 7420 6661 6365 206f 6e6c 792e 0d0a  rst face only...
+0004ac40: 2020 2020 2020 2020 666f 7220 6661 6365          for face
+0004ac50: 2069 6e20 6261 7365 4661 6365 5665 7274   in baseFaceVert
+0004ac60: 6578 496e 6469 6365 7320 3a0d 0a20 2020  exIndices :..   
+0004ac70: 2020 2020 2020 2020 2069 6620 695f 7072           if i_pr
+0004ac80: 6576 5f32 203d 3d20 6661 6365 5b33 5d20  ev_2 == face[3] 
+0004ac90: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0004aca0: 2020 2042 203d 2044 5b3a 3a2d 315d 0d0a     B = D[::-1]..
+0004acb0: 2020 2020 2020 2020 2020 2020 656c 7365              else
+0004acc0: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
+0004acd0: 2020 2020 4220 3d20 6765 7456 6572 7469      B = getVerti
+0004ace0: 6365 734c 696e 6528 7265 7a2c 2066 6163  cesLine(rez, fac
+0004acf0: 655b 335d 2c66 6163 655b 305d 2029 0d0a  e[3],face[0] )..
+0004ad00: 2020 2020 2020 2020 2020 2020 695f 7072              i_pr
+0004ad10: 6576 5f32 203d 2020 6661 6365 5b32 5d0d  ev_2 =  face[2].
+0004ad20: 0a20 2020 2020 2020 2020 2020 2044 203d  .            D =
+0004ad30: 2067 6574 5665 7274 6963 6573 4c69 6e65   getVerticesLine
+0004ad40: 2872 657a 2c20 6661 6365 5b31 5d2c 6661  (rez, face[1],fa
+0004ad50: 6365 5b32 5d20 290d 0a20 2020 2020 2020  ce[2] )..       
+0004ad60: 2020 2020 2072 6563 7572 735f 6661 6365       recurs_face
+0004ad70: 496e 6469 6365 7328 422c 442c 7265 7a29  Indices(B,D,rez)
+0004ad80: 0d0a 0d0a 2020 2020 2020 2020 7665 7274  ....        vert
+0004ad90: 6578 436f 6f72 203d 206e 702e 6172 7261  exCoor = np.arra
+0004ada0: 7928 7643 6f6f 7229 200d 0a20 2020 2020  y(vCoor) ..     
+0004adb0: 2020 2069 6e64 6578 4f62 6a20 3d20 7b20     indexObj = { 
+0004adc0: 2766 6163 6527 3a20 6e70 2e61 7272 6179  'face': np.array
+0004add0: 2866 7649 6e64 6963 6573 2920 2c20 2765  (fvIndices) , 'e
+0004ade0: 6467 6527 3a20 6e70 2e61 7272 6179 2865  dge': np.array(e
+0004adf0: 7649 6e64 6963 6573 2920 7d0d 0a20 2020  vIndices) }..   
+0004ae00: 2020 2020 2072 6574 7572 6e20 696e 6465       return inde
+0004ae10: 784f 626a 202c 7665 7274 6578 436f 6f72  xObj ,vertexCoor
+0004ae20: 0d0a 0d0a 2020 2020 6465 6620 5f67 6574  ....    def _get
+0004ae30: 5f66 696c 6c65 645f 7375 7266 6163 6528  _filled_surface(
+0004ae40: 7365 6c66 2c20 6164 6465 6476 6572 7473  self, addedverts
+0004ae50: 2c20 6c72 657a 3d30 2c20 7363 6c72 3d4e  , lrez=0, sclr=N
+0004ae60: 6f6e 652c 2061 6c70 6861 3d4e 6f6e 652c  one, alpha=None,
+0004ae70: 206e 616d 653d 4e6f 6e65 2920 3a0d 0a20   name=None) :.. 
+0004ae80: 2020 2020 2020 2023 2044 7561 6c20 7075         # Dual pu
+0004ae90: 7270 6f73 6520 616c 676f 7269 7468 6d20  rpose algorithm 
+0004aea0: 666f 7220 6c69 6e65 7320 7072 6f6a 6563  for lines projec
+0004aeb0: 7465 6420 746f 2061 2070 6c61 6e65 2028  ted to a plane (
+0004aec0: 5472 7565 2920 6f72 0d0a 2020 2020 2020  True) or..      
+0004aed0: 2020 2320 5061 7261 6d65 7472 6963 206c    # Parametric l
+0004aee0: 696e 6573 2070 726f 6a65 6374 6564 2074  ines projected t
+0004aef0: 6f20 616e 6f74 6865 7220 5061 7261 6d65  o another Parame
+0004af00: 7472 6963 206c 696e 652e 0d0a 0d0a 2020  tric line.....  
+0004af10: 2020 2020 2020 232e 2e2e 2e2e 2e2e 2e2e        #.........
+0004af20: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0004af30: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 0d0a 2020  ..............  
+0004af40: 2020 2020 2020 6465 6620 7072 6570 5365        def prepSe
+0004af50: 6773 2829 203a 0d0a 2020 2020 2020 2020  gs() :..        
+0004af60: 2020 2020 2320 6465 764e 6f74 653a 2065      # devNote: e
+0004af70: 7665 6e20 6966 206c 696e 6573 2061 7265  ven if lines are
+0004af80: 206e 6f74 2073 6872 6564 6465 642c 2065   not shredded, e
+0004af90: 6163 680d 0a20 2020 2020 2020 2020 2020  ach..           
+0004afa0: 2023 206c 696e 6520 636f 756c 6420 706f   # line could po
+0004afb0: 7373 6962 6c79 2068 6176 6520 6469 6666  ssibly have diff
+0004afc0: 6572 656e 7420 636f 6c6f 7273 2e0d 0a20  erent colors... 
+0004afd0: 2020 2020 2020 2020 2020 2023 2048 656e             # Hen
+0004afe0: 6365 2c20 6d75 7374 2063 6f6e 7374 7275  ce, must constru
+0004aff0: 6374 2073 7572 6661 6365 7320 6672 6f6d  ct surfaces from
+0004b000: 2027 7368 7265 6464 6564 270d 0a20 2020   'shredded'..   
+0004b010: 2020 2020 2020 2020 2023 206c 696e 6573           # lines
+0004b020: 2077 6974 686f 7574 2061 6374 7561 6c6c   without actuall
+0004b030: 7920 7368 7265 6464 696e 6720 7468 6520  y shredding the 
+0004b040: 6c69 6e65 2e0d 0a20 2020 2020 2020 2020  line...         
+0004b050: 2020 2023 2054 6865 2063 6f6c 6f72 2061     # The color a
+0004b060: 7272 6179 2069 7320 7468 656e 2066 6f72  rray is then for
+0004b070: 2065 6163 6820 706f 6c79 676f 6e2e 0d0a   each polygon...
+0004b080: 2020 2020 2020 2020 2020 2020 2320 5468              # Th
+0004b090: 6520 666f 6c6c 6f77 696e 6720 6973 2061  e following is a
+0004b0a0: 6374 7561 6c6c 7920 736f 6d65 7768 6174  ctually somewhat
+0004b0b0: 2061 2064 7570 6c69 6361 7469 6f6e 0d0a   a duplication..
+0004b0c0: 2020 2020 2020 2020 2020 2020 2320 6f66              # of
+0004b0d0: 2074 6865 205f 7368 7265 642e 0d0a 2020   the _shred...  
+0004b0e0: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
+0004b0f0: 2073 656c 662e 6973 5368 7265 6464 6564   self.isShredded
+0004b100: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
+0004b110: 2020 2020 636f 6c6f 7220 3d20 7365 6c66      color = self
+0004b120: 2e5f 7368 7265 645f 636f 6c6f 7228 290d  ._shred_color().
+0004b130: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0004b140: 206c 696e 6573 6567 7320 3d20 7365 6c66   linesegs = self
+0004b150: 2e6c 696e 6549 6e64 6963 6573 0d0a 2020  .lineIndices..  
+0004b160: 2020 2020 2020 2020 2020 2020 2020 696e                in
+0004b170: 6469 6365 7320 3d20 5b5d 0d0a 2020 2020  dices = []..    
+0004b180: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+0004b190: 6c69 6e65 2069 6e20 6c69 6e65 7365 6773  line in linesegs
+0004b1a0: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
+0004b1b0: 2020 2020 2020 2020 6e75 6d53 6567 7320          numSegs 
+0004b1c0: 3d20 6c65 6e28 6c69 6e65 2920 2d20 310d  = len(line) - 1.
+0004b1d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0004b1e0: 2020 2020 2066 6f72 2073 6567 2069 6e20       for seg in 
+0004b1f0: 7261 6e67 6520 286e 756d 5365 6773 2920  range (numSegs) 
+0004b200: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0004b210: 2020 2020 2020 2020 2020 2074 203d 205b             t = [
+0004b220: 206c 696e 655b 7365 675d 2c6c 696e 655b   line[seg],line[
+0004b230: 7365 672b 315d 205d 0d0a 2020 2020 2020  seg+1] ]..      
+0004b240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004b250: 2020 696e 6469 6365 732e 6170 7065 6e64    indices.append
+0004b260: 2874 290d 0a20 2020 2020 2020 2020 2020  (t)..           
+0004b270: 2020 2020 2076 6572 7449 7820 3d20 6e70       vertIx = np
+0004b280: 2e61 7272 6179 2869 6e64 6963 6573 290d  .array(indices).
+0004b290: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+0004b2a0: 6520 3a0d 0a20 2020 2020 2020 2020 2020  e :..           
+0004b2b0: 2020 2020 2063 6f6c 6f72 203d 2073 656c       color = sel
+0004b2c0: 662e 5f65 6467 6563 6f6c 6f72 7320 2023  f._edgecolors  #
+0004b2d0: 2075 7064 6174 6520 666f 7220 765f 312e   update for v_1.
+0004b2e0: 322e 300d 0a20 2020 2020 2020 2020 2020  2.0..           
+0004b2f0: 2020 2020 2076 6572 7449 783d 206e 702e       vertIx= np.
+0004b300: 6172 7261 7928 7365 6c66 2e73 6567 6d49  array(self.segmI
+0004b310: 6e64 6963 6573 290d 0a20 2020 2020 2020  ndices)..       
+0004b320: 2020 2020 2072 6574 7572 6e20 7665 7274       return vert
+0004b330: 4978 2c20 636f 6c6f 720d 0a20 2020 2020  Ix, color..     
+0004b340: 2020 2023 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e     #............
+0004b350: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0004b360: 2e2e 2e2e 2e2e 2e2e 2e0d 0a20 2020 2020  ...........     
+0004b370: 2020 200d 0a20 2020 2020 2020 2074 6f70     ..        top
+0004b380: 5365 6749 6e78 2c63 6f6c 6f72 203d 2070  SegInx,color = p
+0004b390: 7265 7053 6567 7328 290d 0a0d 0a20 2020  repSegs()....   
+0004b3a0: 2020 2020 2073 7449 6e78 203d 206c 656e       stInx = len
+0004b3b0: 2873 656c 662e 7665 7274 6578 436f 6f72  (self.vertexCoor
+0004b3c0: 290d 0a20 2020 2020 2020 2062 6f74 5365  )..        botSe
+0004b3d0: 6749 6e78 203d 2074 6f70 5365 6749 6e78  gInx = topSegInx
+0004b3e0: 202b 2073 7449 6e78 0d0a 2020 2020 2020   + stInx..      
+0004b3f0: 2020 746f 7053 6567 496e 7820 3d20 6e70    topSegInx = np
+0004b400: 2e66 6c69 7028 746f 7053 6567 496e 782c  .flip(topSegInx,
+0004b410: 6178 6973 3d31 290d 0a20 2020 2020 2020  axis=1)..       
+0004b420: 2066 6349 6e64 7820 3d20 6e70 2e63 6f6e   fcIndx = np.con
+0004b430: 6361 7465 6e61 7465 2820 2862 6f74 5365  catenate( (botSe
+0004b440: 6749 6e78 2c74 6f70 5365 6749 6e78 292c  gInx,topSegInx),
+0004b450: 2061 7869 733d 3129 0d0a 2020 2020 2020   axis=1)..      
+0004b460: 2020 2020 200d 0a20 2020 2020 2020 2073       ..        s
+0004b470: 7665 7274 7320 3d20 6e70 2e63 6f6e 6361  verts = np.conca
+0004b480: 7465 6e61 7465 2828 7365 6c66 2e76 6572  tenate((self.ver
+0004b490: 7465 7843 6f6f 722c 6164 6465 6476 6572  texCoor,addedver
+0004b4a0: 7473 292c 6178 6973 3d30 290d 0a20 2020  ts),axis=0)..   
+0004b4b0: 2020 2020 2073 636f 6c6f 7220 3d20 6e70       scolor = np
+0004b4c0: 2e61 7272 6179 2863 6f6c 6f72 290d 0a0d  .array(color)...
+0004b4d0: 0a20 2020 2020 2020 2069 6620 6c72 657a  .        if lrez
+0004b4e0: 203e 2030 203a 0d0a 2020 2020 2020 2020   > 0 :..        
+0004b4f0: 2020 2020 7376 6572 7473 203d 206c 6973      sverts = lis
+0004b500: 7428 7376 6572 7473 290d 0a20 2020 2020  t(sverts)..     
+0004b510: 2020 2020 2020 2069 6e64 6578 4f62 6a20         indexObj 
+0004b520: 2c76 6572 7465 7843 6f6f 7220 3d20 7365  ,vertexCoor = se
+0004b530: 6c66 2e5f 7265 6374 616e 6775 6c61 7465  lf._rectangulate
+0004b540: 4669 6c6c 6564 5375 7246 6163 6528 6c72  FilledSurFace(lr
+0004b550: 657a 2c73 7665 7274 732c 6663 496e 6478  ez,sverts,fcIndx
+0004b560: 2c20 7365 6c66 2e5f 6d69 6456 6563 746f  , self._midVecto
+0004b570: 7246 756e 290d 0a20 2020 2020 2020 2020  rFun)..         
+0004b580: 2020 2073 7665 7274 7320 3d20 7665 7274     sverts = vert
+0004b590: 6578 436f 6f72 0d0a 2020 2020 2020 2020  exCoor..        
+0004b5a0: 2020 2020 6663 496e 6478 203d 2069 6e64      fcIndx = ind
+0004b5b0: 6578 4f62 6a5b 2766 6163 6527 5d0d 0a20  exObj['face'].. 
+0004b5c0: 2020 2020 2020 2020 2020 2073 636f 6c6f             scolo
+0004b5d0: 7220 3d20 6e70 2e72 6570 6561 7428 7363  r = np.repeat(sc
+0004b5e0: 6f6c 6f72 2c32 2a2a 6c72 657a 2c61 7869  olor,2**lrez,axi
+0004b5f0: 733d 3029 0d0a 0d0a 2020 2020 2020 2020  s=0)....        
+0004b600: 6966 2073 636c 7220 6973 206e 6f74 204e  if sclr is not N
+0004b610: 6f6e 6520 3a20 7363 6f6c 6f72 203d 2073  one : scolor = s
+0004b620: 636c 720d 0a0d 0a20 2020 2020 2020 2069  clr....        i
+0004b630: 6620 616c 7068 6120 6973 206e 6f74 204e  f alpha is not N
+0004b640: 6f6e 653a 0d0a 2020 2020 2020 2020 2020  one:..          
+0004b650: 2020 7375 7266 6163 6520 3d20 5375 7266    surface = Surf
+0004b660: 6163 6533 4443 6f6c 6c65 6374 696f 6e28  ace3DCollection(
+0004b670: 7376 6572 7473 2c20 6663 496e 6478 2c20  sverts, fcIndx, 
+0004b680: 6e61 6d65 3d6e 616d 652c 2063 6f6c 6f72  name=name, color
+0004b690: 3d73 636f 6c6f 722c 2061 6c70 6861 3d61  =scolor, alpha=a
+0004b6a0: 6c70 6861 290d 0a20 2020 2020 2020 2065  lpha)..        e
+0004b6b0: 6c73 6520 3a0d 0a20 2020 2020 2020 2020  lse :..         
+0004b6c0: 2020 2073 7572 6661 6365 203d 2053 7572     surface = Sur
+0004b6d0: 6661 6365 3344 436f 6c6c 6563 7469 6f6e  face3DCollection
+0004b6e0: 2873 7665 7274 732c 2066 6349 6e64 782c  (sverts, fcIndx,
+0004b6f0: 206e 616d 653d 6e61 6d65 2c63 6f6c 6f72   name=name,color
+0004b700: 3d73 636f 6c6f 7229 0d0a 2020 2020 2020  =scolor)..      
+0004b710: 2020 7265 7475 726e 2073 7572 6661 6365    return surface
+0004b720: 0d0a 0d0a 2020 2020 6465 6620 6765 745f  ....    def get_
+0004b730: 6669 6c6c 6564 5f73 7572 6661 6365 2873  filled_surface(s
+0004b740: 656c 662c 2a2a 6b61 7267 7329 203a 0d0a  elf,**kargs) :..
+0004b750: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
+0004b760: 2020 2020 2053 7572 6661 6365 3344 436f       Surface3DCo
+0004b770: 6c6c 6563 7469 6f6e 2066 726f 6d20 6120  llection from a 
+0004b780: 6c69 6e65 2070 726f 6a65 6374 6564 2074  line projected t
+0004b790: 6f20 6120 7375 7266 6163 652e 0d0a 0d0a  o a surface.....
+0004b7a0: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+0004b7b0: 7273 0d0a 2020 2020 2020 2020 2d2d 2d2d  rs..        ----
+0004b7c0: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
+0004b7d0: 6469 7374 203a 206e 756d 6265 722c 206f  dist : number, o
+0004b7e0: 7074 696f 6e61 6c2c 2064 6566 6175 6c74  ptional, default
+0004b7f0: 203a 2030 2e30 200d 0a20 2020 2020 2020   : 0.0 ..       
+0004b800: 2020 2020 2064 6973 7461 6e63 6520 6672       distance fr
+0004b810: 6f6d 2074 6865 206f 7269 6769 6e20 746f  om the origin to
+0004b820: 2074 6865 2070 726f 6a65 6374 6564 2073   the projected s
+0004b830: 7572 6661 6365 2c0d 0a20 2020 2020 2020  urface,..       
+0004b840: 2020 2020 2061 6c6f 6e67 2074 6865 2064       along the d
+0004b850: 6972 6563 7469 6f6e 2076 6563 746f 722e  irection vector.
+0004b860: 0d0a 0d0a 2020 2020 2020 2020 6469 7265  ....        dire
+0004b870: 6374 696f 6e20 3a20 6172 7261 792d 6c69  ction : array-li
+0004b880: 6b65 2c20 6f70 7469 6f6e 616c 2c20 6465  ke, optional, de
+0004b890: 6661 756c 743a 205b 302c 302c 315d 0d0a  fault: [0,0,1]..
+0004b8a0: 2020 2020 2020 2020 2020 2020 4120 7879              A xy
+0004b8b0: 7a20 7665 6374 6f72 206e 6f72 6d61 6c20  z vector normal 
+0004b8c0: 746f 2074 6865 2069 6e74 6572 7365 6374  to the intersect
+0004b8d0: 696f 6e20 706c 616e 650d 0a20 2020 2020  ion plane..     
+0004b8e0: 2020 2020 2020 2066 6f72 2070 6c61 6e61         for plana
+0004b8f0: 7220 7072 6f6a 6563 7469 6f6e 7320 6f72  r projections or
+0004b900: 2061 7869 616c 2064 6972 6563 7469 6f6e   axial direction
+0004b910: 206f 6620 0d0a 2020 2020 2020 2020 2020   of ..          
+0004b920: 2020 6120 6379 6c69 6e64 6572 2066 6f72    a cylinder for
+0004b930: 2063 796c 696e 6472 6963 616c 2070 726f   cylindrical pro
+0004b940: 6a65 6374 696f 6e73 2e0d 0a0d 0a20 2020  jections.....   
+0004b950: 2020 2020 2063 6f6f 7220 3a20 696e 7465       coor : inte
+0004b960: 6765 7220 6f72 2073 7472 696e 6720 696e  ger or string in
+0004b970: 6469 6361 7469 6e67 2074 6865 2074 7970  dicating the typ
+0004b980: 6520 6f66 2070 726f 6a65 6374 696f 6e20  e of projection 
+0004b990: 7375 7266 6163 653a 0d0a 2020 2020 2020  surface:..      
+0004b9a0: 2020 2020 2020 302c 2070 2c20 502c 2078        0, p, P, x
+0004b9b0: 797a 2c70 6c61 6e61 7220 2020 2020 2020  yz,planar       
+0004b9c0: 2020 2020 2020 2020 2020 2d20 706c 616e            - plan
+0004b9d0: 6172 2028 6465 6661 756c 7429 0d0a 2020  ar (default)..  
+0004b9e0: 2020 2020 2020 2020 2020 312c 2063 2c20            1, c, 
+0004b9f0: 432c 2063 796c 696e 6465 722c 7070 6c61  C, cylinder,ppla
+0004ba00: 722c 6379 6c69 6e64 7269 6361 6c20 2d20  r,cylindrical - 
+0004ba10: 6379 6c69 6e64 6572 0d0a 2020 2020 2020  cylinder..      
+0004ba20: 2020 2020 2020 322c 2073 2c20 532c 2073        2, s, S, s
+0004ba30: 7068 6572 652c 7370 6865 7269 6361 6c20  phere,spherical 
+0004ba40: 2020 2020 2020 2020 2020 2d20 7370 6865            - sphe
+0004ba50: 7265 0d0a 2020 2020 2020 2020 2020 2020  re..            
+0004ba60: 332c 2078 2c20 5820 2020 2020 2020 2020  3, x, X         
+0004ba70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004ba80: 2020 2020 2d20 792d 7a20 706c 616e 650d      - y-z plane.
+0004ba90: 0a20 2020 2020 2020 2020 2020 2034 2c20  .            4, 
+0004baa0: 792c 2059 2020 2020 2020 2020 2020 2020  y, Y            
+0004bab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004bac0: 202d 2078 2d7a 2070 6c61 6e65 0d0a 2020   - x-z plane..  
+0004bad0: 2020 2020 2020 2020 2020 352c 207a 2c20            5, z, 
+0004bae0: 5a20 2020 2020 2020 2020 2020 2020 2020  Z               
+0004baf0: 2020 2020 2020 2020 2020 2020 2020 2d20                - 
+0004bb00: 782d 7920 706c 616e 650d 0a0d 0a20 2020  x-y plane....   
+0004bb10: 2020 2020 206c 7265 7a20 3a20 706f 7369       lrez : posi
+0004bb20: 7469 7665 2069 6e74 6567 6572 2c20 6f70  tive integer, op
+0004bb30: 7469 6f6e 616c 2c20 6465 6661 756c 7420  tional, default 
+0004bb40: 3a20 300d 0a20 2020 2020 2020 2020 2020  : 0..           
+0004bb50: 2070 726f 6a65 6374 696f 6e20 7265 6375   projection recu
+0004bb60: 7273 6976 6520 7375 6264 6976 6973 696f  rsive subdivisio
+0004bb70: 6e73 2e0d 0a0d 0a20 2020 2020 2020 2063  ns.....        c
+0004bb80: 6f6c 6f72 203a 2043 6f6c 6f72 2c20 6f70  olor : Color, op
+0004bb90: 7469 6f6e 616c 2c20 6465 6661 756c 7420  tional, default 
+0004bba0: 3a20 6c69 6e65 2063 6f6c 6f72 0d0a 0d0a  : line color....
+0004bbb0: 2020 2020 2020 2020 616c 7068 6120 3a20          alpha : 
+0004bbc0: 7363 616c 6172 2c20 6f70 7469 6f6e 616c  scalar, optional
+0004bbd0: 2c20 6465 6661 756c 7420 3a20 310d 0a20  , default : 1.. 
+0004bbe0: 2020 2020 2020 2020 2020 2046 6163 6520             Face 
+0004bbf0: 636f 6c6f 7220 616c 7068 6120 7661 6c75  color alpha valu
+0004bc00: 652c 2069 6e20 7468 6520 7261 6e67 6520  e, in the range 
+0004bc10: 3020 746f 2031 2e20 0d0a 2020 2020 2020  0 to 1. ..      
+0004bc20: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+0004bc30: 6e61 6d65 203a 2073 7472 696e 672c 206f  name : string, o
+0004bc40: 7074 696f 6e61 6c2c 2064 6566 6175 6c74  ptional, default
+0004bc50: 3a20 4e6f 6e65 2e0d 0a20 2020 2020 2020  : None...       
+0004bc60: 2020 2020 2044 6573 6372 6970 7469 7665       Descriptive
+0004bc70: 2069 6465 6e74 6966 6965 7220 666f 7220   identifier for 
+0004bc80: 7468 6520 6765 6f6d 6574 7279 2e0d 0a0d  the geometry....
+0004bc90: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+0004bca0: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
+0004bcb0: 2d0d 0a20 2020 2020 2020 2053 7572 6661  -..        Surfa
+0004bcc0: 6365 3344 436f 6c6c 6563 7469 6f6e 206f  ce3DCollection o
+0004bcd0: 626a 6563 740d 0a20 2020 2020 2020 0d0a  bject..       ..
+0004bce0: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
+0004bcf0: 2020 2020 2065 7874 4466 7420 3d20 7b20       extDft = { 
+0004bd00: 2764 6972 6563 7469 6f6e 273a 5b30 2c30  'direction':[0,0
+0004bd10: 2c31 5d2c 2027 6469 7374 273a 302e 302c  ,1], 'dist':0.0,
+0004bd20: 2027 6c72 657a 273a 302c 2027 616c 7068   'lrez':0, 'alph
+0004bd30: 6127 3a4e 6f6e 652c 2027 636f 6c6f 7227  a':None, 'color'
+0004bd40: 3a4e 6f6e 652c 2027 6e61 6d65 273a 4e6f  :None, 'name':No
+0004bd50: 6e65 207d 0d0a 2020 2020 2020 2020 6b61  ne }..        ka
+0004bd60: 7267 4466 7420 3d20 7b20 2a2a 5f43 4f4f  rgDft = { **_COO
+0004bd70: 525f 4b57 4152 4753 2c20 2a2a 6578 7444  R_KWARGS, **extD
+0004bd80: 6674 207d 0d0a 2020 2020 2020 2020 4b57  ft }..        KW
+0004bd90: 203d 204b 5770 726f 6365 7373 6f72 286b   = KWprocessor(k
+0004bda0: 6172 6744 6674 2c27 6765 745f 6669 6c6c  argDft,'get_fill
+0004bdb0: 6564 5f73 7572 6661 6365 272c 2a2a 6b61  ed_surface',**ka
+0004bdc0: 7267 7329 0d0a 2020 2020 2020 2020 6472  rgs)..        dr
+0004bdd0: 6374 6e20 3d20 4b57 2e67 6574 5661 6c28  ctn = KW.getVal(
+0004bde0: 2764 6972 6563 7469 6f6e 2729 0d0a 2020  'direction')..  
+0004bdf0: 2020 2020 2020 6178 6973 203d 204b 572e        axis = KW.
+0004be00: 6765 7456 616c 2827 636f 6f72 2729 0d0a  getVal('coor')..
+0004be10: 2020 2020 2020 2020 6261 7365 203d 204b          base = K
+0004be20: 572e 6765 7456 616c 2827 6469 7374 2729  W.getVal('dist')
+0004be30: 0d0a 2020 2020 2020 2020 6c72 657a 203d  ..        lrez =
+0004be40: 204b 572e 6765 7456 616c 2827 6c72 657a   KW.getVal('lrez
+0004be50: 2729 0d0a 2020 2020 2020 2020 616c 7068  ')..        alph
+0004be60: 6120 3d20 4b57 2e67 6574 5661 6c28 2761  a = KW.getVal('a
+0004be70: 6c70 6861 2729 0d0a 2020 2020 2020 2020  lpha')..        
+0004be80: 636f 6c6f 7220 3d20 4b57 2e67 6574 5661  color = KW.getVa
+0004be90: 6c28 2763 6f6c 6f72 2729 0d0a 2020 2020  l('color')..    
+0004bea0: 2020 2020 6e61 6d65 203d 204b 572e 6765      name = KW.ge
+0004beb0: 7456 616c 2827 6e61 6d65 2729 0d0a 0d0a  tVal('name')....
+0004bec0: 2020 2020 2020 2020 6966 2062 6173 6520          if base 
+0004bed0: 6973 204e 6f6e 6520 3a20 6261 7365 203d  is None : base =
+0004bee0: 2030 2e30 0d0a 2020 2020 2020 2020 6966   0.0..        if
+0004bef0: 2061 7869 733d 3d33 203a 2061 7869 732c   axis==3 : axis,
+0004bf00: 2064 7263 746e 203d 2030 2c20 5b20 312c   drctn = 0, [ 1,
+0004bf10: 302c 3020 5d0d 0a20 2020 2020 2020 2069  0,0 ]..        i
+0004bf20: 6620 6178 6973 3d3d 3420 3a20 6178 6973  f axis==4 : axis
+0004bf30: 2c20 6472 6374 6e20 3d20 302c 205b 2030  , drctn = 0, [ 0
+0004bf40: 2c31 2c30 205d 0d0a 2020 2020 2020 2020  ,1,0 ]..        
+0004bf50: 6966 2061 7869 733d 3d35 203a 2061 7869  if axis==5 : axi
+0004bf60: 732c 2064 7263 746e 203d 2030 2c20 5b20  s, drctn = 0, [ 
+0004bf70: 302c 302c 3120 5d0d 0a0d 0a20 2020 2020  0,0,1 ]....     
+0004bf80: 2020 2073 656c 6663 6f70 7920 3d20 636f     selfcopy = co
+0004bf90: 7079 2e63 6f70 7928 7365 6c66 290d 0a20  py.copy(self).. 
+0004bfa0: 2020 2020 2020 206d 6170 7065 6473 656c         mappedsel
+0004bfb0: 6620 3d20 7365 6c66 636f 7079 2e6d 6170  f = selfcopy.map
+0004bfc0: 5f74 6f5f 706c 616e 6528 2062 6173 652c  _to_plane( base,
+0004bfd0: 2064 6972 6563 7469 6f6e 3d64 7263 746e   direction=drctn
+0004bfe0: 2c20 636f 6f72 3d61 7869 7329 0d0a 2020  , coor=axis)..  
+0004bff0: 2020 2020 2020 7375 7266 203d 2073 656c        surf = sel
+0004c000: 662e 6765 745f 7375 7266 6163 655f 746f  f.get_surface_to
+0004c010: 5f6c 696e 6528 6d61 7070 6564 7365 6c66  _line(mappedself
+0004c020: 2c20 6c72 657a 3d6c 7265 7a2c 2061 6c70  , lrez=lrez, alp
+0004c030: 6861 3d61 6c70 6861 2c20 636f 6c6f 723d  ha=alpha, color=
+0004c040: 636f 6c6f 722c 206e 616d 653d 6e61 6d65  color, name=name
+0004c050: 290d 0a20 2020 2020 2020 2072 6574 7572  )..        retur
+0004c060: 6e20 7375 7266 0d0a 0d0a 2020 2020 6465  n surf....    de
+0004c070: 6620 6765 745f 7375 7266 6163 655f 746f  f get_surface_to
+0004c080: 5f6c 696e 6528 7365 6c66 2c20 6c69 6e65  _line(self, line
+0004c090: 2c20 2a2a 6b61 7267 7329 203a 0d0a 2020  , **kargs) :..  
+0004c0a0: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
+0004c0b0: 2020 2053 7572 6661 6365 3344 436f 6c6c     Surface3DColl
+0004c0c0: 6563 7469 6f6e 2066 726f 6d20 6120 6c69  ection from a li
+0004c0d0: 6e65 2070 726f 6a65 6374 6564 2074 6f20  ne projected to 
+0004c0e0: 616e 6f74 6865 7220 6c69 6e65 2e0d 0a0d  another line....
+0004c0f0: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+0004c100: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
+0004c110: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
+0004c120: 206c 696e 6520 3a20 6c69 6e65 206f 626a   line : line obj
+0004c130: 6563 7420 7769 7468 2074 6865 2073 616d  ect with the sam
+0004c140: 6520 6e75 6d62 6572 206f 6620 7665 7274  e number of vert
+0004c150: 6963 6573 0d0a 2020 2020 2020 2020 2020  ices..          
+0004c160: 2020 6173 2074 6865 2063 616c 6c69 6e67    as the calling
+0004c170: 206f 626a 6563 742e 0d0a 0d0a 2020 2020   object.....    
+0004c180: 2020 2020 6c72 657a 203a 2070 6f73 6974      lrez : posit
+0004c190: 6976 6520 696e 7465 6765 722c 206f 7074  ive integer, opt
+0004c1a0: 696f 6e61 6c2c 2064 6566 6175 6c74 203a  ional, default :
+0004c1b0: 2030 0d0a 2020 2020 2020 2020 2020 2020   0..            
+0004c1c0: 7072 6f6a 6563 7469 6f6e 2072 6563 7572  projection recur
+0004c1d0: 7369 7665 2073 7562 6469 7669 7369 6f6e  sive subdivision
+0004c1e0: 732e 0d0a 0d0a 2020 2020 2020 2020 636f  s.....        co
+0004c1f0: 6c6f 7220 3a20 436f 6c6f 722c 206f 7074  lor : Color, opt
+0004c200: 696f 6e61 6c2c 206f 7074 696f 6e61 6c2c  ional, optional,
+0004c210: 2064 6566 6175 6c74 203a 206c 696e 6520   default : line 
+0004c220: 636f 6c6f 720d 0a0d 0a20 2020 2020 2020  color....       
+0004c230: 2061 6c70 6861 203a 2073 6361 6c61 722c   alpha : scalar,
+0004c240: 206f 7074 696f 6e61 6c2c 2064 6566 6175   optional, defau
+0004c250: 6c74 203a 204e 6f6e 6520 2831 290d 0a20  lt : None (1).. 
+0004c260: 2020 2020 2020 2020 2020 2046 6163 6520             Face 
+0004c270: 636f 6c6f 7220 616c 7068 6120 7661 6c75  color alpha valu
+0004c280: 652c 2069 6e20 7468 6520 7261 6e67 6520  e, in the range 
+0004c290: 3020 746f 2031 2e20 0d0a 2020 2020 2020  0 to 1. ..      
+0004c2a0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+0004c2b0: 6e61 6d65 203a 2073 7472 696e 672c 206f  name : string, o
+0004c2c0: 7074 696f 6e61 6c2c 2064 6566 6175 6c74  ptional, default
+0004c2d0: 3a20 4e6f 6e65 2e0d 0a20 2020 2020 2020  : None...       
+0004c2e0: 2020 2020 2044 6573 6372 6970 7469 7665       Descriptive
+0004c2f0: 2069 6465 6e74 6966 6965 7220 666f 7220   identifier for 
+0004c300: 7468 6520 6765 6f6d 6574 7279 2e0d 0a0d  the geometry....
+0004c310: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+0004c320: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
+0004c330: 2d0d 0a20 2020 2020 2020 2053 7572 6661  -..        Surfa
+0004c340: 6365 3344 436f 6c6c 6563 7469 6f6e 206f  ce3DCollection o
+0004c350: 626a 6563 740d 0a20 2020 2020 2020 0d0a  bject..       ..
+0004c360: 2020 2020 2020 2020 2222 220d 0a0d 0a20          """.... 
+0004c370: 2020 2020 2020 206b 6172 6744 6674 203d         kargDft =
+0004c380: 207b 2027 6c72 657a 273a 302c 2027 616c   { 'lrez':0, 'al
+0004c390: 7068 6127 3a4e 6f6e 652c 2027 636f 6c6f  pha':None, 'colo
+0004c3a0: 7227 3a4e 6f6e 652c 2027 6e61 6d65 273a  r':None, 'name':
+0004c3b0: 4e6f 6e65 207d 0d0a 2020 2020 2020 2020  None }..        
+0004c3c0: 4b57 203d 204b 5770 726f 6365 7373 6f72  KW = KWprocessor
+0004c3d0: 286b 6172 6744 6674 2c27 6765 745f 7375  (kargDft,'get_su
+0004c3e0: 7266 6163 655f 746f 5f6c 696e 6527 2c2a  rface_to_line',*
+0004c3f0: 2a6b 6172 6773 290d 0a20 2020 2020 2020  *kargs)..       
+0004c400: 206c 7265 7a20 3d20 4b57 2e67 6574 5661   lrez = KW.getVa
+0004c410: 6c28 276c 7265 7a27 290d 0a20 2020 2020  l('lrez')..     
+0004c420: 2020 2061 6c70 6861 203d 204b 572e 6765     alpha = KW.ge
+0004c430: 7456 616c 2827 616c 7068 6127 290d 0a20  tVal('alpha').. 
+0004c440: 2020 2020 2020 206e 616d 6520 3d20 4b57         name = KW
+0004c450: 2e67 6574 5661 6c28 276e 616d 6527 290d  .getVal('name').
+0004c460: 0a20 2020 2020 2020 2063 6f6c 6f72 3d20  .        color= 
+0004c470: 4b57 2e67 6574 5661 6c28 2763 6f6c 6f72  KW.getVal('color
+0004c480: 2729 0d0a 0d0a 2020 2020 2020 2020 6c65  ')....        le
+0004c490: 6e31 2c20 6c65 6e32 203d 206c 656e 2873  n1, len2 = len(s
+0004c4a0: 656c 662e 7665 7274 6578 436f 6f72 292c  elf.vertexCoor),
+0004c4b0: 206c 656e 286c 696e 652e 7665 7274 6578   len(line.vertex
+0004c4c0: 436f 6f72 290d 0a20 2020 2020 2020 2069  Coor)..        i
+0004c4d0: 6620 6c65 6e31 2021 3d20 6c65 6e32 203a  f len1 != len2 :
+0004c4e0: 0d0a 2020 2020 2020 2020 2020 2020 7261  ..            ra
+0004c4f0: 6973 6520 5661 6c75 6545 7272 6f72 2827  ise ValueError('
+0004c500: 4d69 736d 6161 7463 6865 6420 6c69 6e65  Mismaatched line
+0004c510: 2072 657a 2066 6f72 2050 6172 616d 6574   rez for Paramet
+0004c520: 7269 6320 4c69 6e65 733a 207b 7d20 213d  ric Lines: {} !=
+0004c530: 207b 7d27 2e66 6f72 6d61 7428 6c65 6e31   {}'.format(len1
+0004c540: 2c6c 656e 3229 290d 0a0d 0a20 2020 2020  ,len2))....     
+0004c550: 2020 2061 6464 6564 7665 7274 7320 3d20     addedverts = 
+0004c560: 6c69 6e65 2e76 6572 7465 7843 6f6f 720d  line.vertexCoor.
+0004c570: 0a0d 0a20 2020 2020 2020 2072 6574 7572  ...        retur
+0004c580: 6e20 7365 6c66 2e5f 6765 745f 6669 6c6c  n self._get_fill
+0004c590: 6564 5f73 7572 6661 6365 2861 6464 6564  ed_surface(added
+0004c5a0: 7665 7274 732c 206c 7265 7a3d 6c72 657a  verts, lrez=lrez
+0004c5b0: 2c20 7363 6c72 3d63 6f6c 6f72 2c20 616c  , sclr=color, al
+0004c5c0: 7068 613d 616c 7068 612c 206e 616d 653d  pha=alpha, name=
+0004c5d0: 6e61 6d65 290d 0a0d 0a0d 0a63 6c61 7373  name)......class
+0004c5e0: 2050 6172 616d 6574 7269 634c 696e 6528   ParametricLine(
+0004c5f0: 436f 6c6f 724c 696e 6533 4443 6f6c 6c65  ColorLine3DColle
+0004c600: 6374 696f 6e29 203a 0d0a 2020 2020 0d0a  ction) :..    ..
+0004c610: 2020 2020 6465 6620 5f5f 696e 6974 5f5f      def __init__
+0004c620: 2820 7365 6c66 2c20 7265 7a20 2c20 6f70  ( self, rez , op
+0004c630: 6572 6174 696f 6e3d 4e6f 6e65 2c20 6e61  eration=None, na
+0004c640: 6d65 3d4e 6f6e 652c 202a 2a6b 7761 7267  me=None, **kwarg
+0004c650: 7320 2920 3a0d 0a20 2020 2020 2020 2022  s ) :..        "
+0004c660: 2222 0d0a 2020 2020 2020 2020 4372 6561  ""..        Crea
+0004c670: 7465 2073 696e 676c 6520 6c69 6e65 2066  te single line f
+0004c680: 726f 6d20 6120 7061 7261 6d65 7472 6963  rom a parametric
+0004c690: 2066 756e 6374 696f 6e20 7769 7468 2064   function with d
+0004c6a0: 6f6d 6169 6e20 5b30 2c31 5d0d 0a0d 0a20  omain [0,1].... 
+0004c6b0: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+0004c6c0: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+0004c6d0: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2072  -----..        r
+0004c6e0: 657a 203a 2069 6e74 6567 6572 2c20 6f70  ez : integer, op
+0004c6f0: 7469 6f6e 616c 2c20 6465 6661 756c 743a  tional, default:
+0004c700: 2030 200d 0a20 2020 2020 2020 2020 2020   0 ..           
+0004c710: 204e 756d 6265 7220 6f66 2072 6563 7572   Number of recur
+0004c720: 7369 7665 2062 6973 6563 7469 6f6e 206f  sive bisection o
+0004c730: 6620 6c69 6e65 2073 6567 6d65 6e74 732e  f line segments.
+0004c740: 0d0a 2020 2020 2020 2020 2020 2020 5265  ..            Re
+0004c750: 7a20 7661 6c75 6573 2072 616e 6765 2066  z values range f
+0004c760: 726f 6d20 3020 746f 2037 2e20 4966 2072  rom 0 to 7. If r
+0004c770: 657a 2069 7320 6c65 7373 2074 6861 6e20  ez is less than 
+0004c780: 7a65 726f 2c0d 0a20 2020 2020 2020 2020  zero,..         
+0004c790: 2020 206e 6567 6174 6976 6520 7661 6c75     negative valu
+0004c7a0: 6520 7769 6c6c 2062 6520 7468 6520 6e75  e will be the nu
+0004c7b0: 6d62 6572 206f 6620 7365 676d 656e 7473  mber of segments
+0004c7c0: 2e0d 0a0d 0a20 2020 2020 2020 206f 7065  .....        ope
+0004c7d0: 7261 7469 6f6e 203a 2066 756e 6374 696f  ration : functio
+0004c7e0: 6e20 6f62 6a65 6374 200d 0a20 2020 2020  n object ..     
+0004c7f0: 2020 2020 2020 2046 756e 6374 696f 6e20         Function 
+0004c800: 7468 6174 2074 616b 6573 206f 6e65 2061  that takes one a
+0004c810: 7267 756d 656e 742c 2061 204e 756d 7079  rgument, a Numpy
+0004c820: 2066 6c6f 6174 0d0a 2020 2020 2020 2020   float..        
+0004c830: 2020 2020 6172 7261 792e 2054 6865 2066      array. The f
+0004c840: 756e 6374 696f 6e20 646f 6d61 696e 2069  unction domain i
+0004c850: 7320 5b30 2e30 2c20 312c 305d 2061 6e64  s [0.0, 1,0] and
+0004c860: 2072 6574 7572 6e73 0d0a 2020 2020 2020   returns..      
+0004c870: 2020 2020 2020 6120 3320 5820 4e20 6172        a 3 X N ar
+0004c880: 7261 7920 6f66 2078 797a 2063 6f6f 7264  ray of xyz coord
+0004c890: 696e 6174 6573 2e0d 0a0d 0a20 2020 2020  inates.....     
+0004c8a0: 2020 206e 616d 6520 3a20 7374 722c 206f     name : str, o
+0004c8b0: 7074 696f 6e61 6c2c 2064 6566 6175 6c74  ptional, default
+0004c8c0: 3a20 6675 6e63 7469 6f6e 206f 626a 6563  : function objec
+0004c8d0: 7420 6e61 6d65 0d0a 2020 2020 2020 2020  t name..        
+0004c8e0: 2020 2020 2020 2020 6966 206e 6f74 2061          if not a
+0004c8f0: 206c 616d 6264 6120 6675 6e63 7469 6f6e   lambda function
+0004c900: 2c20 6f74 6865 7277 6973 6520 7374 7269  , otherwise stri
+0004c910: 6e67 2027 272e 0d0a 2020 2020 2020 2020  ng ''...        
+0004c920: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+0004c930: 2020 4f74 6865 7220 5061 7261 6d65 7465    Other Paramete
+0004c940: 7273 0d0a 2020 2020 2020 2020 2d2d 2d2d  rs..        ----
+0004c950: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020  ------------..  
+0004c960: 2020 2020 2020 2a2a 6b77 6172 6773 0d0a        **kwargs..
+0004c970: 2020 2020 2020 2020 2020 2020 416c 6c20              All 
+0004c980: 6f74 6865 7220 7061 7261 6d65 7465 7273  other parameters
+0004c990: 2061 7265 2070 6173 7365 6420 6f6e 2074   are passed on t
+0004c9a0: 6f20 2773 3364 6c69 622e 7375 7266 6163  o 's3dlib.surfac
+0004c9b0: 652e 436f 6c6f 724c 696e 6533 4443 6f6c  e.ColorLine3DCol
+0004c9c0: 6c65 6374 696f 6e27 2e0d 0a0d 0a20 2020  lection'.....   
+0004c9d0: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
+0004c9e0: 2020 2320 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    # ------------
+0004c9f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0004ca00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20  -------------.. 
+0004ca10: 2020 2020 2020 2064 6566 2064 6566 6175         def defau
+0004ca20: 6c74 5f6c 696e 6528 6e75 6d56 6572 7473  lt_line(numVerts
+0004ca30: 2920 3a0d 0a20 2020 2020 2020 2020 2020  ) :..           
+0004ca40: 2023 2078 797a 2061 7865 7320 6c69 6e65   # xyz axes line
+0004ca50: 7320 5b2d 312c 315d 0d0a 2020 2020 2020  s [-1,1]..      
+0004ca60: 2020 2020 2020 6c69 6e65 5661 6c73 203d        lineVals =
+0004ca70: 206e 702e 6c69 6e73 7061 6365 282d 312e   np.linspace(-1.
+0004ca80: 302c 312e 302c 2069 6e74 286e 756d 5665  0,1.0, int(numVe
+0004ca90: 7274 7329 2029 0d0a 2020 2020 2020 2020  rts) )..        
+0004caa0: 2020 2020 7a65 726f 7320 3d20 6e70 2e7a      zeros = np.z
+0004cab0: 6572 6f73 2820 696e 7428 6e75 6d56 6572  eros( int(numVer
+0004cac0: 7473 2920 290d 0a20 2020 2020 2020 2020  ts) )..         
+0004cad0: 2020 2058 6178 6973 203d 206e 702e 6173     Xaxis = np.as
+0004cae0: 6172 7261 7928 205b 6c69 6e65 5661 6c73  array( [lineVals
+0004caf0: 2c20 7a65 726f 732c 207a 6572 6f73 205d  , zeros, zeros ]
+0004cb00: 2029 2e54 0d0a 2020 2020 2020 2020 2020   ).T..          
+0004cb10: 2020 5961 7869 7320 3d20 6e70 2e61 7361    Yaxis = np.asa
+0004cb20: 7272 6179 2820 5b7a 6572 6f73 2c20 6c69  rray( [zeros, li
+0004cb30: 6e65 5661 6c73 2c20 7a65 726f 7320 5d20  neVals, zeros ] 
+0004cb40: 292e 540d 0a20 2020 2020 2020 2020 2020  ).T..           
+0004cb50: 205a 6178 6973 203d 206e 702e 6173 6172   Zaxis = np.asar
+0004cb60: 7261 7928 205b 7a65 726f 732c 207a 6572  ray( [zeros, zer
+0004cb70: 6f73 2c20 6c69 6e65 5661 6c73 205d 2029  os, lineVals ] )
+0004cb80: 2e54 0d0a 2020 2020 2020 2020 2020 2020  .T..            
+0004cb90: 7665 7274 7320 3d20 6e70 2e76 7374 6163  verts = np.vstac
+0004cba0: 6b28 2028 5861 7869 732c 5961 7869 732c  k( (Xaxis,Yaxis,
+0004cbb0: 5a61 7869 7320 2929 0d0a 2020 2020 2020  Zaxis ))..      
+0004cbc0: 2020 2020 2020 696e 6469 6365 7320 3d20        indices = 
+0004cbd0: 5b4e 6f6e 655d 2a33 0d0a 2020 2020 2020  [None]*3..      
+0004cbe0: 2020 2020 2020 696e 6465 7820 3d20 300d        index = 0.
+0004cbf0: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+0004cc00: 2069 2069 6e20 7261 6e67 6528 302c 3329   i in range(0,3)
+0004cc10: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
+0004cc20: 2020 2020 696e 6469 6365 735b 695d 203d      indices[i] =
+0004cc30: 205b 4e6f 6e65 5d2a 286e 756d 5665 7274   [None]*(numVert
+0004cc40: 7329 0d0a 2020 2020 2020 2020 2020 2020  s)..            
+0004cc50: 2020 2020 666f 7220 6a20 696e 2072 616e      for j in ran
+0004cc60: 6765 286e 756d 5665 7274 7329 203a 0d0a  ge(numVerts) :..
+0004cc70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004cc80: 2020 2020 696e 6469 6365 735b 695d 5b6a      indices[i][j
+0004cc90: 5d20 3d20 696e 6465 780d 0a20 2020 2020  ] = index..     
+0004cca0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0004ccb0: 6e64 6578 202b 3d20 310d 0a20 2020 2020  ndex += 1..     
+0004ccc0: 2020 2020 2020 2072 6574 7572 6e20 7665         return ve
+0004ccd0: 7274 732c 2069 6e64 6963 6573 0d0a 2020  rts, indices..  
+0004cce0: 2020 2020 2020 2320 2d2d 2d2d 2d2d 2d2d        # --------
+0004ccf0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0004cd00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0004cd10: 2d0d 0a20 2020 2020 2020 2069 6620 6e6f  -..        if no
+0004cd20: 7420 6973 696e 7374 616e 6365 2872 657a  t isinstance(rez
+0004cd30: 2c69 6e74 2920 3a0d 0a20 2020 2020 2020  ,int) :..       
+0004cd40: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+0004cd50: 4572 726f 7228 2750 6172 616d 6574 7269  Error('Parametri
+0004cd60: 634c 696e 653a 2049 6e63 6f72 7265 7374  cLine: Incorrest
+0004cd70: 2072 657a 206f 6620 7b7d 2c20 6d75 7374   rez of {}, must
+0004cd80: 2062 6520 616e 2069 6e74 272e 666f 726d   be an int'.form
+0004cd90: 6174 2872 657a 2929 0d0a 2020 2020 2020  at(rez))..      
+0004cda0: 2020 6966 2028 7265 7a3e 5f4d 4158 504c    if (rez>_MAXPL
+0004cdb0: 5245 5a29 203a 0d0a 2020 2020 2020 2020  REZ) :..        
+0004cdc0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+0004cdd0: 7272 6f72 2827 5061 7261 6d65 7472 6963  rror('Parametric
+0004cde0: 4c69 6e65 3a49 6e63 6f72 7265 7374 2072  Line:Incorrest r
+0004cdf0: 657a 206f 6620 7b7d 2c20 6d75 7374 206c  ez of {}, must l
+0004ce00: 6573 7320 7468 616e 206f 7220 6571 7561  ess than or equa
+0004ce10: 6c20 746f 207b 7d27 2e66 6f72 6d61 7428  l to {}'.format(
+0004ce20: 7265 7a2c 5f4d 4158 504c 5245 5a29 290d  rez,_MAXPLREZ)).
+0004ce30: 0a20 2020 2020 2020 2069 6620 7265 7a3c  .        if rez<
+0004ce40: 3020 3a0d 0a20 2020 2020 2020 2020 2020  0 :..           
+0004ce50: 2073 656c 662e 6e75 6d53 6567 203d 202d   self.numSeg = -
+0004ce60: 7265 7a0d 0a20 2020 2020 2020 2020 2020  rez..           
+0004ce70: 2023 2046 7574 4465 763a 2073 686f 756c   # FutDev: shoul
+0004ce80: 6420 6368 6563 6b20 6966 203e 2032 2a2a  d check if > 2**
+0004ce90: 285f 4d41 5850 4c52 455a 2b31 290d 0a20  (_MAXPLREZ+1).. 
+0004cea0: 2020 2020 2020 2065 6c73 6520 3a0d 0a20         else :.. 
+0004ceb0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0004cec0: 6e75 6d53 6567 203d 2069 6e74 2832 2a2a  numSeg = int(2**
+0004ced0: 2872 657a 2b31 2929 0d0a 2020 2020 2020  (rez+1))..      
+0004cee0: 2020 6e75 6d56 6572 7473 203d 2073 656c    numVerts = sel
+0004cef0: 662e 6e75 6d53 6567 202b 2031 0d0a 2020  f.numSeg + 1..  
+0004cf00: 2020 2020 2020 6966 206f 7065 7261 7469        if operati
+0004cf10: 6f6e 2069 7320 4e6f 6e65 203a 0d0a 2020  on is None :..  
+0004cf20: 2020 2020 2020 2020 2020 7665 7274 732c            verts,
+0004cf30: 2069 6e64 6963 6573 203d 2064 6566 6175   indices = defau
+0004cf40: 6c74 5f6c 696e 6528 6e75 6d56 6572 7473  lt_line(numVerts
+0004cf50: 290d 0a20 2020 2020 2020 2065 6c73 6520  )..        else 
+0004cf60: 3a0d 0a20 2020 2020 2020 2020 2020 206e  :..            n
+0004cf70: 616d 6520 3d20 5f67 6574 4675 6e63 7469  ame = _getFuncti
+0004cf80: 6f6e 4e61 6d65 286f 7065 7261 7469 6f6e  onName(operation
+0004cf90: 2c6e 616d 6529 0d0a 2020 2020 2020 2020  ,name)..        
+0004cfa0: 2020 2020 6c69 6e65 5661 6c73 203d 206e      lineVals = n
+0004cfb0: 702e 6c69 6e73 7061 6365 2830 2e30 2c31  p.linspace(0.0,1
+0004cfc0: 2e30 2c20 7365 6c66 2e6e 756d 5365 672b  .0, self.numSeg+
+0004cfd0: 3129 0d0a 2020 2020 2020 2020 2020 2020  1)..            
+0004cfe0: 7665 7274 7320 3d20 6e70 2e61 7272 6179  verts = np.array
+0004cff0: 286f 7065 7261 7469 6f6e 286c 696e 6556  (operation(lineV
+0004d000: 616c 7329 292e 540d 0a20 2020 2020 2020  als)).T..       
+0004d010: 2020 2020 2076 6572 7473 203d 2076 6572       verts = ver
+0004d020: 7473 2e74 6f6c 6973 7428 290d 0a20 2020  ts.tolist()..   
+0004d030: 2020 2020 2020 2020 2069 6e64 6963 6573           indices
+0004d040: 203d 205b 205b 2a72 616e 6765 286c 656e   = [ [*range(len
+0004d050: 2876 6572 7473 2929 5d20 5d0d 0a20 2020  (verts))] ]..   
+0004d060: 2020 2020 2073 7570 6572 2829 2e5f 5f69       super().__i
+0004d070: 6e69 745f 5f28 7665 7274 732c 2069 6e64  nit__(verts, ind
+0004d080: 6963 6573 2c20 6e61 6d65 2c20 2a2a 6b77  ices, name, **kw
+0004d090: 6172 6773 290d 0a0d 0a20 2020 2020 2020  args)....       
+0004d0a0: 2073 656c 662e 7265 7a20 3d20 7265 7a0d   self.rez = rez.
+0004d0b0: 0a0d 0a20 2020 2064 6566 205f 6765 7453  ...    def _getS
+0004d0c0: 6c69 6365 2873 656c 662c 2067 2c20 6e75  lice(self, g, nu
+0004d0d0: 6d56 6572 7473 2c20 646f 6d61 696e 2c20  mVerts, domain, 
+0004d0e0: 7856 616c 3d4e 6f6e 652c 2079 5661 6c3d  xVal=None, yVal=
+0004d0f0: 4e6f 6e65 2020 2920 3a0d 0a20 2020 2020  None  ) :..     
+0004d100: 2020 2069 6620 7856 616c 2069 7320 4e6f     if xVal is No
+0004d110: 6e65 2061 6e64 2079 5661 6c20 6973 204e  ne and yVal is N
+0004d120: 6f6e 6520 3a20 7265 7475 726e 204e 6f6e  one : return Non
+0004d130: 652c 204e 6f6e 650d 0a20 2020 2020 2020  e, None..       
+0004d140: 206e 756d 4c69 6e65 7320 3d20 300d 0a20   numLines = 0.. 
+0004d150: 2020 2020 2020 2069 6620 7856 616c 2069         if xVal i
+0004d160: 7320 6e6f 7420 4e6f 6e65 203a 206e 756d  s not None : num
+0004d170: 4c69 6e65 7320 2b3d 2031 0d0a 2020 2020  Lines += 1..    
+0004d180: 2020 2020 6966 2079 5661 6c20 6973 206e      if yVal is n
+0004d190: 6f74 204e 6f6e 6520 3a20 6e75 6d4c 696e  ot None : numLin
+0004d1a0: 6573 202b 3d20 3120 2020 2020 2020 2020  es += 1         
+0004d1b0: 2020 0d0a 2020 2020 2020 2020 696e 6469    ..        indi
+0004d1c0: 6365 7320 3d20 5b4e 6f6e 655d 2a28 206e  ces = [None]*( n
+0004d1d0: 756d 4c69 6e65 7320 290d 0a20 2020 2020  umLines )..     
+0004d1e0: 2020 206e 756d 625f 585f 6c69 6e65 7320     numb_X_lines 
+0004d1f0: 3d20 300d 0a20 2020 2020 2020 2069 6e64  = 0..        ind
+0004d200: 6578 203d 2030 0d0a 0d0a 2020 2020 2020  ex = 0....      
+0004d210: 2020 7665 7274 7320 3d20 5b5d 0d0a 2020    verts = []..  
+0004d220: 2020 2020 2020 6966 2078 5661 6c20 6973        if xVal is
+0004d230: 206e 6f74 204e 6f6e 6520 3a0d 0a20 2020   not None :..   
+0004d240: 2020 2020 2020 2020 206e 756d 625f 585f           numb_X_
+0004d250: 6c69 6e65 7320 3d20 310d 0a20 2020 2020  lines = 1..     
+0004d260: 2020 2020 2020 206c 696e 6556 6572 7473         lineVerts
+0004d270: 5074 7320 3d20 6e70 2e6c 696e 7370 6163  Pts = np.linspac
+0004d280: 6528 646f 6d61 696e 5b27 796d 696e 275d  e(domain['ymin']
+0004d290: 2c20 646f 6d61 696e 5b27 796d 6178 275d  , domain['ymax']
+0004d2a0: 2c20 6e75 6d56 6572 7473 2029 0d0a 2020  , numVerts )..  
+0004d2b0: 2020 2020 2020 2020 2020 785f 6c69 6e65            x_line
+0004d2c0: 5665 7274 7350 7473 203d 206e 702e 6172  VertsPts = np.ar
+0004d2d0: 7261 7928 5b78 5661 6c5d 2029 0d0a 2020  ray([xVal] )..  
+0004d2e0: 2020 2020 2020 2020 2020 7a5f 585f 6c69            z_X_li
+0004d2f0: 6e65 7320 3d20 6728 785f 6c69 6e65 5665  nes = g(x_lineVe
+0004d300: 7274 7350 7473 2c6c 696e 6556 6572 7473  rtsPts,lineVerts
+0004d310: 5074 7329 0d0a 0d0a 2020 2020 2020 2020  Pts)....        
+0004d320: 2020 2020 666f 7220 6959 2069 6e20 7261      for iY in ra
+0004d330: 6e67 6528 6e75 6d56 6572 7473 2920 3a0d  nge(numVerts) :.
+0004d340: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0004d350: 2020 7665 7274 732e 6170 7065 6e64 2820    verts.append( 
+0004d360: 5b20 7856 616c 202c 206c 696e 6556 6572  [ xVal , lineVer
+0004d370: 7473 5074 735b 6959 5d2c 207a 5f58 5f6c  tsPts[iY], z_X_l
+0004d380: 696e 6573 5b69 592c 305d 205d 290d 0a0d  ines[iY,0] ])...
+0004d390: 0a20 2020 2020 2020 2020 2020 2069 6e64  .            ind
+0004d3a0: 6963 6573 5b30 5d20 3d20 5b4e 6f6e 655d  ices[0] = [None]
+0004d3b0: 2a28 6e75 6d56 6572 7473 290d 0a20 2020  *(numVerts)..   
+0004d3c0: 2020 2020 2020 2020 2066 6f72 206a 2069           for j i
+0004d3d0: 6e20 7261 6e67 6528 6e75 6d56 6572 7473  n range(numVerts
+0004d3e0: 2920 3a0d 0a20 2020 2020 2020 2020 2020  ) :..           
+0004d3f0: 2020 2020 2069 6e64 6963 6573 5b30 5d5b       indices[0][
+0004d400: 6a5d 203d 2069 6e64 6578 0d0a 2020 2020  j] = index..    
+0004d410: 2020 2020 2020 2020 2020 2020 696e 6465              inde
+0004d420: 7820 2b3d 2031 0d0a 2020 2020 2020 2020  x += 1..        
+0004d430: 0d0a 2020 2020 2020 2020 6966 2079 5661  ..        if yVa
+0004d440: 6c20 6973 206e 6f74 204e 6f6e 6520 3a0d  l is not None :.
+0004d450: 0a20 2020 2020 2020 2020 2020 206c 696e  .            lin
+0004d460: 6556 6572 7473 5074 7320 3d20 6e70 2e6c  eVertsPts = np.l
+0004d470: 696e 7370 6163 6528 646f 6d61 696e 5b27  inspace(domain['
+0004d480: 786d 696e 275d 2c20 646f 6d61 696e 5b27  xmin'], domain['
+0004d490: 786d 6178 275d 2c20 6e75 6d56 6572 7473  xmax'], numVerts
+0004d4a0: 2029 0d0a 2020 2020 2020 2020 2020 2020   )..            
+0004d4b0: 795f 6c69 6e65 5665 7274 7350 7473 203d  y_lineVertsPts =
+0004d4c0: 206e 702e 6172 7261 7928 5b79 5661 6c5d   np.array([yVal]
+0004d4d0: 2029 0d0a 2020 2020 2020 2020 2020 2020   )..            
+0004d4e0: 7a5f 595f 6c69 6e65 7320 3d20 6728 6c69  z_Y_lines = g(li
+0004d4f0: 6e65 5665 7274 7350 7473 2c20 795f 6c69  neVertsPts, y_li
+0004d500: 6e65 5665 7274 7350 7473 290d 0a20 2020  neVertsPts)..   
+0004d510: 2020 2020 2020 2020 2023 2074 6865 2066           # the f
+0004d520: 6f6c 6c6f 7769 6e67 2c20 636f 6d70 656e  ollowing, compen
+0004d530: 7361 7465 7320 666f 7220 696e 7465 7270  sates for interp
+0004d540: 3264 2066 6f72 2064 6174 6167 7269 640d  2d for datagrid.
+0004d550: 0a20 2020 2020 2020 2020 2020 2023 2077  .            # w
+0004d560: 6869 6368 2064 726f 7073 2074 6865 2066  hich drops the f
+0004d570: 6972 7374 2064 696d 656e 7369 6f6e 2c20  irst dimension, 
+0004d580: 7365 6520 6d61 705f 7879 536c 6963 655f  see map_xySlice_
+0004d590: 6672 6f6d 5f6f 7020 203f 3f3f 0d0a 2020  from_op  ???..  
+0004d5a0: 2020 2020 2020 2020 2020 7a5f 595f 6c69            z_Y_li
+0004d5b0: 6e65 7320 3d20 6e70 2e61 7272 6179 285b  nes = np.array([
+0004d5c0: 6728 6c69 6e65 5665 7274 7350 7473 2c20  g(lineVertsPts, 
+0004d5d0: 795f 6c69 6e65 5665 7274 7350 7473 295d  y_lineVertsPts)]
+0004d5e0: 290d 0a20 2020 2020 2020 2020 2020 200d  )..            .
+0004d5f0: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+0004d600: 2069 5820 696e 2072 616e 6765 286e 756d   iX in range(num
+0004d610: 5665 7274 7329 203a 0d0a 2020 2020 2020  Verts) :..      
+0004d620: 2020 2020 2020 2020 2020 2076 6572 7473             verts
+0004d630: 2e61 7070 656e 6428 205b 206c 696e 6556  .append( [ lineV
+0004d640: 6572 7473 5074 735b 6958 5d2c 2079 5661  ertsPts[iX], yVa
+0004d650: 6c2c 207a 5f59 5f6c 696e 6573 5b30 2c69  l, z_Y_lines[0,i
+0004d660: 585d 205d 290d 0a20 2020 2020 2020 2020  X] ])..         
+0004d670: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
+0004d680: 2069 6e64 6963 6573 5b6e 756d 625f 585f   indices[numb_X_
+0004d690: 6c69 6e65 735d 203d 205b 4e6f 6e65 5d2a  lines] = [None]*
+0004d6a0: 286e 756d 5665 7274 7329 0d0a 2020 2020  (numVerts)..    
+0004d6b0: 2020 2020 2020 2020 666f 7220 6a20 696e          for j in
+0004d6c0: 2072 616e 6765 286e 756d 5665 7274 7329   range(numVerts)
+0004d6d0: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
+0004d6e0: 2020 2020 696e 6469 6365 735b 6e75 6d62      indices[numb
+0004d6f0: 5f58 5f6c 696e 6573 5d5b 6a5d 203d 2069  _X_lines][j] = i
+0004d700: 6e64 6578 0d0a 2020 2020 2020 2020 2020  ndex..          
+0004d710: 2020 2020 2020 696e 6465 7820 2b3d 2031        index += 1
+0004d720: 0d0a 0d0a 2020 2020 2020 2020 7665 7274  ....        vert
+0004d730: 7320 3d20 6e70 2e61 7272 6179 2876 6572  s = np.array(ver
+0004d740: 7473 290d 0a0d 0a20 2020 2020 2020 2072  ts)....        r
+0004d750: 6574 7572 6e20 7665 7274 732c 2069 6e64  eturn verts, ind
+0004d760: 6963 6573 0d0a 0d0a 2020 2020 6465 6620  ices....    def 
+0004d770: 5f67 6574 536c 6963 6553 6574 2873 656c  _getSliceSet(sel
+0004d780: 662c 2067 2c20 6e75 6d56 6572 7473 2c20  f, g, numVerts, 
+0004d790: 646f 6d61 696e 2c20 7873 616d 706c 6573  domain, xsamples
+0004d7a0: 2c20 7973 616d 706c 6573 2029 203a 0d0a  , ysamples ) :..
+0004d7b0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+0004d7c0: 2020 6966 2078 7361 6d70 6c65 7320 6973    if xsamples is
+0004d7d0: 204e 6f6e 6520 616e 6420 7973 616d 706c   None and ysampl
+0004d7e0: 6573 2069 7320 4e6f 6e65 203a 2072 6574  es is None : ret
+0004d7f0: 7572 6e20 4e6f 6e65 2c20 4e6f 6e65 0d0a  urn None, None..
+0004d800: 2020 2020 2020 2020 6e75 6d62 5f58 5f6c          numb_X_l
+0004d810: 696e 6573 2c20 6e75 6d62 5f59 5f6c 696e  ines, numb_Y_lin
+0004d820: 6573 203d 2030 2c30 0d0a 2020 2020 2020  es = 0,0..      
+0004d830: 2020 6966 2078 7361 6d70 6c65 7320 6973    if xsamples is
+0004d840: 206e 6f74 204e 6f6e 6520 3a20 6e75 6d62   not None : numb
+0004d850: 5f58 5f6c 696e 6573 203d 2078 7361 6d70  _X_lines = xsamp
+0004d860: 6c65 730d 0a20 2020 2020 2020 2069 6620  les..        if 
+0004d870: 7973 616d 706c 6573 2069 7320 6e6f 7420  ysamples is not 
+0004d880: 4e6f 6e65 203a 206e 756d 625f 595f 6c69  None : numb_Y_li
+0004d890: 6e65 7320 3d20 7973 616d 706c 6573 0d0a  nes = ysamples..
+0004d8a0: 2020 2020 2020 2020 696e 6469 6365 7320          indices 
+0004d8b0: 3d20 5b4e 6f6e 655d 2a28 206e 756d 625f  = [None]*( numb_
+0004d8c0: 585f 6c69 6e65 7320 2b20 6e75 6d62 5f59  X_lines + numb_Y
+0004d8d0: 5f6c 696e 6573 2029 0d0a 2020 2020 2020  _lines )..      
+0004d8e0: 2020 696e 6465 7820 3d20 300d 0a0d 0a20    index = 0.... 
+0004d8f0: 2020 2020 2020 2076 6572 7473 203d 205b         verts = [
+0004d900: 5d0d 0a20 2020 2020 2020 2069 6620 7873  ]..        if xs
+0004d910: 616d 706c 6573 2069 7320 6e6f 7420 4e6f  amples is not No
+0004d920: 6e65 203a 0d0a 2020 2020 2020 2020 2020  ne :..          
+0004d930: 2020 6c69 6e65 5665 7274 7350 7473 203d    lineVertsPts =
+0004d940: 206e 702e 6c69 6e73 7061 6365 2864 6f6d   np.linspace(dom
+0004d950: 6169 6e5b 2779 6d69 6e27 5d2c 2064 6f6d  ain['ymin'], dom
+0004d960: 6169 6e5b 2779 6d61 7827 5d2c 206e 756d  ain['ymax'], num
+0004d970: 5665 7274 7320 290d 0a20 2020 2020 2020  Verts )..       
+0004d980: 2020 2020 2078 5f6c 696e 6556 6572 7473       x_lineVerts
+0004d990: 5074 7320 3d20 6e70 2e6c 696e 7370 6163  Pts = np.linspac
+0004d9a0: 6528 646f 6d61 696e 5b27 786d 696e 275d  e(domain['xmin']
+0004d9b0: 2c20 646f 6d61 696e 5b27 786d 6178 275d  , domain['xmax']
+0004d9c0: 2c20 6e75 6d62 5f58 5f6c 696e 6573 2029  , numb_X_lines )
+0004d9d0: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+0004d9e0: 2078 7361 6d70 6c65 7320 3d3d 2031 203a   xsamples == 1 :
+0004d9f0: 2078 5f6c 696e 6556 6572 7473 5074 7320   x_lineVertsPts 
+0004da00: 3d20 6e70 2e61 7361 7272 6179 285b 302e  = np.asarray([0.
+0004da10: 305d 290d 0a20 2020 2020 2020 2020 2020  0])..           
+0004da20: 207a 5f58 5f6c 696e 6573 203d 2067 2878   z_X_lines = g(x
+0004da30: 5f6c 696e 6556 6572 7473 5074 732c 6c69  _lineVertsPts,li
+0004da40: 6e65 5665 7274 7350 7473 290d 0a0d 0a20  neVertsPts).... 
+0004da50: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
+0004da60: 5820 696e 2072 616e 6765 286e 756d 625f  X in range(numb_
+0004da70: 585f 6c69 6e65 7329 203a 0d0a 2020 2020  X_lines) :..    
+0004da80: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+0004da90: 6959 2069 6e20 7261 6e67 6528 6e75 6d56  iY in range(numV
+0004daa0: 6572 7473 2920 3a0d 0a20 2020 2020 2020  erts) :..       
+0004dab0: 2020 2020 2020 2020 2020 2020 2076 6572               ver
+0004dac0: 7473 2e61 7070 656e 6428 205b 2078 5f6c  ts.append( [ x_l
+0004dad0: 696e 6556 6572 7473 5074 735b 6958 5d20  ineVertsPts[iX] 
+0004dae0: 2c20 6c69 6e65 5665 7274 7350 7473 5b69  , lineVertsPts[i
+0004daf0: 595d 2c20 7a5f 585f 6c69 6e65 735b 6959  Y], z_X_lines[iY
+0004db00: 2c69 585d 205d 290d 0a0d 0a20 2020 2020  ,iX] ])....     
+0004db10: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
+0004db20: 7261 6e67 6528 302c 6e75 6d62 5f58 5f6c  range(0,numb_X_l
+0004db30: 696e 6573 2920 3a0d 0a20 2020 2020 2020  ines) :..       
+0004db40: 2020 2020 2020 2020 2069 6e64 6963 6573           indices
+0004db50: 5b69 5d20 3d20 5b4e 6f6e 655d 2a28 6e75  [i] = [None]*(nu
+0004db60: 6d56 6572 7473 290d 0a20 2020 2020 2020  mVerts)..       
+0004db70: 2020 2020 2020 2020 2066 6f72 206a 2069           for j i
+0004db80: 6e20 7261 6e67 6528 6e75 6d56 6572 7473  n range(numVerts
+0004db90: 2920 3a0d 0a20 2020 2020 2020 2020 2020  ) :..           
+0004dba0: 2020 2020 2020 2020 2069 6e64 6963 6573           indices
+0004dbb0: 5b69 5d5b 6a5d 203d 2069 6e64 6578 0d0a  [i][j] = index..
+0004dbc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004dbd0: 2020 2020 696e 6465 7820 2b3d 2031 0d0a      index += 1..
+0004dbe0: 0d0a 2020 2020 2020 2020 6966 2079 7361  ..        if ysa
+0004dbf0: 6d70 6c65 7320 6973 206e 6f74 204e 6f6e  mples is not Non
+0004dc00: 6520 3a0d 0a20 2020 2020 2020 2020 2020  e :..           
+0004dc10: 206c 696e 6556 6572 7473 5074 7320 3d20   lineVertsPts = 
+0004dc20: 6e70 2e6c 696e 7370 6163 6528 646f 6d61  np.linspace(doma
+0004dc30: 696e 5b27 786d 696e 275d 2c20 646f 6d61  in['xmin'], doma
+0004dc40: 696e 5b27 786d 6178 275d 2c20 6e75 6d56  in['xmax'], numV
+0004dc50: 6572 7473 2029 0d0a 2020 2020 2020 2020  erts )..        
+0004dc60: 2020 2020 795f 6c69 6e65 5665 7274 7350      y_lineVertsP
+0004dc70: 7473 203d 206e 702e 6c69 6e73 7061 6365  ts = np.linspace
+0004dc80: 2864 6f6d 6169 6e5b 2779 6d69 6e27 5d2c  (domain['ymin'],
+0004dc90: 2064 6f6d 6169 6e5b 2779 6d61 7827 5d2c   domain['ymax'],
+0004dca0: 206e 756d 625f 595f 6c69 6e65 7320 290d   numb_Y_lines ).
+0004dcb0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0004dcc0: 7973 616d 706c 6573 203d 3d20 3120 3a20  ysamples == 1 : 
+0004dcd0: 795f 6c69 6e65 5665 7274 7350 7473 203d  y_lineVertsPts =
+0004dce0: 206e 702e 6173 6172 7261 7928 5b30 2e30   np.asarray([0.0
+0004dcf0: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
+0004dd00: 7a5f 595f 6c69 6e65 7320 3d20 6728 6c69  z_Y_lines = g(li
+0004dd10: 6e65 5665 7274 7350 7473 2c79 5f6c 696e  neVertsPts,y_lin
+0004dd20: 6556 6572 7473 5074 7329 0d0a 0d0a 2020  eVertsPts)....  
+0004dd30: 2020 2020 2020 2020 2020 666f 7220 6959            for iY
+0004dd40: 2069 6e20 7261 6e67 6528 6e75 6d62 5f59   in range(numb_Y
+0004dd50: 5f6c 696e 6573 2920 3a0d 0a20 2020 2020  _lines) :..     
+0004dd60: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
+0004dd70: 5820 696e 2072 616e 6765 286e 756d 5665  X in range(numVe
+0004dd80: 7274 7329 203a 0d0a 2020 2020 2020 2020  rts) :..        
+0004dd90: 2020 2020 2020 2020 2020 2020 7665 7274              vert
+0004dda0: 732e 6170 7065 6e64 2820 5b20 206c 696e  s.append( [  lin
+0004ddb0: 6556 6572 7473 5074 735b 6958 5d2c 2079  eVertsPts[iX], y
+0004ddc0: 5f6c 696e 6556 6572 7473 5074 735b 6959  _lineVertsPts[iY
+0004ddd0: 5d20 2c7a 5f59 5f6c 696e 6573 5b69 592c  ] ,z_Y_lines[iY,
+0004dde0: 6958 5d20 5d29 0d0a 0d0a 2020 2020 2020  iX] ])....      
+0004ddf0: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
+0004de00: 616e 6765 286e 756d 625f 585f 6c69 6e65  ange(numb_X_line
+0004de10: 732c 6e75 6d62 5f58 5f6c 696e 6573 2b6e  s,numb_X_lines+n
+0004de20: 756d 625f 595f 6c69 6e65 7329 203a 0d0a  umb_Y_lines) :..
+0004de30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004de40: 696e 6469 6365 735b 695d 203d 205b 4e6f  indices[i] = [No
+0004de50: 6e65 5d2a 286e 756d 5665 7274 7329 0d0a  ne]*(numVerts)..
+0004de60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004de70: 666f 7220 6a20 696e 2072 616e 6765 286e  for j in range(n
+0004de80: 756d 5665 7274 7329 203a 0d0a 2020 2020  umVerts) :..    
+0004de90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004dea0: 696e 6469 6365 735b 695d 5b6a 5d20 3d20  indices[i][j] = 
+0004deb0: 696e 6465 780d 0a20 2020 2020 2020 2020  index..         
+0004dec0: 2020 2020 2020 2020 2020 2069 6e64 6578             index
+0004ded0: 202b 3d20 310d 0a20 2020 2020 2020 200d   += 1..        .
+0004dee0: 0a20 2020 2020 2020 2076 6572 7473 203d  .        verts =
+0004def0: 206e 702e 6172 7261 7928 7665 7274 7329   np.array(verts)
+0004df00: 0d0a 0d0a 2020 2020 2020 2020 7265 7475  ....        retu
+0004df10: 726e 2076 6572 7473 2c20 696e 6469 6365  rn verts, indice
+0004df20: 730d 0a0d 0a20 2020 2064 6566 205f 6d61  s....    def _ma
+0004df30: 705f 7879 536c 6963 6528 7365 6c66 2c20  p_xySlice(self, 
+0004df40: 672c 202a 2a6b 6172 6773 2029 203a 2020  g, **kargs ) :  
+0004df50: 2020 2020 200d 0a20 2020 2020 2020 2078       ..        x
+0004df60: 706c 616e 652c 2079 706c 616e 652c 2078  plane, yplane, x
+0004df70: 7361 6d70 6c65 732c 2079 7361 6d70 6c65  samples, ysample
+0004df80: 7320 3d20 4e6f 6e65 2c4e 6f6e 652c 4e6f  s = None,None,No
+0004df90: 6e65 2c4e 6f6e 650d 0a20 2020 2020 2020  ne,None..       
+0004dfa0: 2069 6620 2778 706c 616e 6527 2069 6e20   if 'xplane' in 
+0004dfb0: 6b61 7267 7320 3a20 7870 6c61 6e65 203d  kargs : xplane =
+0004dfc0: 206b 6172 6773 5b27 7870 6c61 6e65 275d   kargs['xplane']
+0004dfd0: 0d0a 2020 2020 2020 2020 6966 2027 7970  ..        if 'yp
+0004dfe0: 6c61 6e65 2720 696e 206b 6172 6773 203a  lane' in kargs :
+0004dff0: 2079 706c 616e 6520 3d20 6b61 7267 735b   yplane = kargs[
+0004e000: 2779 706c 616e 6527 5d0d 0a20 2020 2020  'yplane']..     
+0004e010: 2020 2069 6620 2778 7365 7427 2069 6e20     if 'xset' in 
+0004e020: 6b61 7267 7320 3a20 7873 616d 706c 6573  kargs : xsamples
+0004e030: 203d 206b 6172 6773 5b27 7873 6574 275d   = kargs['xset']
+0004e040: 0d0a 2020 2020 2020 2020 6966 2027 7973  ..        if 'ys
+0004e050: 6574 2720 696e 206b 6172 6773 203a 2079  et' in kargs : y
+0004e060: 7361 6d70 6c65 7320 3d20 6b61 7267 735b  samples = kargs[
+0004e070: 2779 7365 7427 5d0d 0a0d 0a20 2020 2020  'yset']....     
+0004e080: 2020 2070 6c61 6e65 4e6f 726d 616c 203d     planeNormal =
+0004e090: 204e 6f6e 6520 2023 2062 6f74 6820 7820   None  # both x 
+0004e0a0: 616e 6420 7920 736c 6963 6520 706c 616e  and y slice plan
+0004e0b0: 6573 2061 7265 2064 6566 696e 6564 2e0d  es are defined..
+0004e0c0: 0a20 2020 2020 2020 2069 6620 2878 706c  .        if (xpl
+0004e0d0: 616e 6520 6973 204e 6f6e 6529 2061 6e64  ane is None) and
+0004e0e0: 2028 7873 616d 706c 6573 2069 7320 4e6f   (xsamples is No
+0004e0f0: 6e65 2920 3a0d 0a20 2020 2020 2020 2020  ne) :..         
+0004e100: 2020 2070 6c61 6e65 4e6f 726d 616c 203d     planeNormal =
+0004e110: 205b 302c 312c 305d 2020 2320 6d75 7374   [0,1,0]  # must
+0004e120: 2062 6520 696e 2074 6865 2078 2d7a 2070   be in the x-z p
+0004e130: 6c61 6e65 0d0a 2020 2020 2020 2020 6966  lane..        if
+0004e140: 2028 7970 6c61 6e65 2069 7320 4e6f 6e65   (yplane is None
+0004e150: 2920 616e 6420 2879 7361 6d70 6c65 7320  ) and (ysamples 
+0004e160: 6973 204e 6f6e 6529 203a 0d0a 2020 2020  is None) :..    
+0004e170: 2020 2020 2020 2020 706c 616e 654e 6f72          planeNor
+0004e180: 6d61 6c20 3d20 5b31 2c30 2c30 5d20 2023  mal = [1,0,0]  #
+0004e190: 206d 7573 7420 6265 2069 6e20 7468 6520   must be in the 
+0004e1a0: 792d 7a20 706c 616e 650d 0a0d 0a20 2020  y-z plane....   
+0004e1b0: 2020 2020 2064 6f6d 6169 6e20 3d20 7b27       domain = {'
+0004e1c0: 786d 696e 273a 2d31 2c20 2778 6d61 7827  xmin':-1, 'xmax'
+0004e1d0: 3a31 2c20 2779 6d69 6e27 3a2d 312c 2027  :1, 'ymin':-1, '
+0004e1e0: 796d 6178 273a 317d 0d0a 2020 2020 2020  ymax':1}..      
+0004e1f0: 2020 6465 6620 6368 6563 6b41 7272 2820    def checkArr( 
+0004e200: 4120 2920 3a0d 0a20 2020 2020 2020 2020  A ) :..         
+0004e210: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+0004e220: 2841 2c28 6c69 7374 2c74 7570 6c65 2929  (A,(list,tuple))
+0004e230: 203a 2072 6574 7572 6e20 415b 305d 2c20   : return A[0], 
+0004e240: 415b 315d 0d0a 2020 2020 2020 2020 2020  A[1]..          
+0004e250: 2020 656c 7365 3a20 7265 7475 726e 202d    else: return -
+0004e260: 412c 410d 0a20 2020 2020 2020 2020 2020  A,A..           
+0004e270: 2020 2020 200d 0a20 2020 2020 2020 2069       ..        i
+0004e280: 6620 2778 6c69 6d27 2069 6e20 6b61 7267  f 'xlim' in karg
+0004e290: 7320 3a20 0d0a 2020 2020 2020 2020 2020  s : ..          
+0004e2a0: 2020 646f 6d61 696e 5b27 786d 696e 275d    domain['xmin']
+0004e2b0: 2c20 646f 6d61 696e 5b27 786d 6178 275d  , domain['xmax']
+0004e2c0: 203d 2063 6865 636b 4172 7228 6b61 7267   = checkArr(karg
+0004e2d0: 735b 2778 6c69 6d27 5d29 0d0a 2020 2020  s['xlim'])..    
+0004e2e0: 2020 2020 6966 2027 796c 696d 2720 696e      if 'ylim' in
+0004e2f0: 206b 6172 6773 203a 200d 0a20 2020 2020   kargs : ..     
+0004e300: 2020 2020 2020 2064 6f6d 6169 6e5b 2779         domain['y
+0004e310: 6d69 6e27 5d2c 2064 6f6d 6169 6e5b 2779  min'], domain['y
+0004e320: 6d61 7827 5d20 3d20 6368 6563 6b41 7272  max'] = checkArr
+0004e330: 286b 6172 6773 5b27 796c 696d 275d 290d  (kargs['ylim']).
+0004e340: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0004e350: 200d 0a20 2020 2020 2020 2023 202d 2d2d   ..        # ---
+0004e360: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0004e370: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0004e380: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
+0004e390: 6966 2028 2028 7873 616d 706c 6573 2069  if ( (xsamples i
+0004e3a0: 7320 4e6f 6e65 2061 6e64 2079 7361 6d70  s None and ysamp
+0004e3b0: 6c65 7320 6973 204e 6f6e 6529 2061 6e64  les is None) and
+0004e3c0: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
+0004e3d0: 2028 7870 6c61 6e65 2020 2069 7320 4e6f   (xplane   is No
+0004e3e0: 6e65 2061 6e64 2079 706c 616e 6520 2020  ne and yplane   
+0004e3f0: 6973 204e 6f6e 6529 2029 203a 2072 6574  is None) ) : ret
+0004e400: 7572 6e20 7365 6c66 0d0a 0d0a 2020 2020  urn self....    
+0004e410: 2020 2020 6e75 6d56 6572 7473 203d 2073      numVerts = s
+0004e420: 656c 662e 6e75 6d53 6567 202b 2031 0d0a  elf.numSeg + 1..
+0004e430: 2020 2020 2020 2020 7665 7274 5369 6e67          vertSing
+0004e440: 6c65 2c69 6e64 6963 6573 5369 6e67 6c65  le,indicesSingle
+0004e450: 203d 2073 656c 662e 5f67 6574 536c 6963   = self._getSlic
+0004e460: 6528 672c 6e75 6d56 6572 7473 2c64 6f6d  e(g,numVerts,dom
+0004e470: 6169 6e2c 7870 6c61 6e65 2c20 7970 6c61  ain,xplane, ypla
+0004e480: 6e65 290d 0a20 2020 2020 2020 2076 6572  ne)..        ver
+0004e490: 7473 5365 742c 696e 6469 6365 7353 6574  tsSet,indicesSet
+0004e4a0: 203d 2073 656c 662e 5f67 6574 536c 6963   = self._getSlic
+0004e4b0: 6553 6574 2867 2c6e 756d 5665 7274 732c  eSet(g,numVerts,
+0004e4c0: 646f 6d61 696e 2c78 7361 6d70 6c65 732c  domain,xsamples,
+0004e4d0: 2079 7361 6d70 6c65 7329 0d0a 2020 2020   ysamples)..    
+0004e4e0: 2020 2020 0d0a 2020 2020 2020 2020 6966      ..        if
+0004e4f0: 2076 6572 7453 696e 676c 6520 6973 206e   vertSingle is n
+0004e500: 6f74 204e 6f6e 6520 3a0d 0a20 2020 2020  ot None :..     
+0004e510: 2020 2020 2020 2076 6572 7473 2c69 6e64         verts,ind
+0004e520: 6963 6573 203d 2076 6572 7453 696e 676c  ices = vertSingl
+0004e530: 652c 696e 6469 6365 7353 696e 676c 650d  e,indicesSingle.
+0004e540: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0004e550: 7665 7274 7353 6574 2069 7320 6e6f 7420  vertsSet is not 
+0004e560: 4e6f 6e65 203a 0d0a 2020 2020 2020 2020  None :..        
+0004e570: 2020 2020 2020 2020 7374 6172 7449 6e64          startInd
+0004e580: 6578 203d 206c 656e 2876 6572 7473 290d  ex = len(verts).
+0004e590: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0004e5a0: 2076 6572 7473 203d 206e 702e 636f 6e63   verts = np.conc
+0004e5b0: 6174 656e 6174 6528 2028 7665 7274 732c  atenate( (verts,
+0004e5c0: 7665 7274 7353 6574 292c 2061 7869 733d  vertsSet), axis=
+0004e5d0: 3029 0d0a 2020 2020 2020 2020 2020 2020  0)..            
+0004e5e0: 2020 2020 7368 6966 7465 6449 6e64 6963      shiftedIndic
+0004e5f0: 6573 5365 7420 3d20 205b 205b 2069 2b73  esSet =  [ [ i+s
+0004e600: 7461 7274 496e 6465 7820 666f 7220 6920  tartIndex for i 
+0004e610: 696e 206c 696e 6520 5d20 666f 7220 6c69  in line ] for li
+0004e620: 6e65 2069 6e20 696e 6469 6365 7353 6574  ne in indicesSet
+0004e630: 5d20 0d0a 2020 2020 2020 2020 2020 2020  ] ..            
+0004e640: 2020 2020 6e75 6d62 496e 6469 6365 5369      numbIndiceSi
+0004e650: 6e67 6c65 203d 206c 656e 2869 6e64 6963  ngle = len(indic
+0004e660: 6573 5369 6e67 6c65 290d 0a20 2020 2020  esSingle)..     
+0004e670: 2020 2020 2020 2020 2020 206e 756d 6249             numbI
+0004e680: 6e64 6963 6573 5365 7420 3d20 6c65 6e28  ndicesSet = len(
+0004e690: 7368 6966 7465 6449 6e64 6963 6573 5365  shiftedIndicesSe
+0004e6a0: 7429 0d0a 2020 2020 2020 2020 2020 2020  t)..            
+0004e6b0: 2020 2020 7465 6d70 203d 205b 4e6f 6e65      temp = [None
+0004e6c0: 5d2a 286e 756d 6249 6e64 6963 6553 696e  ]*(numbIndiceSin
+0004e6d0: 676c 6520 2b20 6e75 6d62 496e 6469 6365  gle + numbIndice
+0004e6e0: 7353 6574 290d 0a20 2020 2020 2020 2020  sSet)..         
+0004e6f0: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
+0004e700: 7261 6e67 6528 6e75 6d62 496e 6469 6365  range(numbIndice
+0004e710: 5369 6e67 6c65 2920 3a20 7465 6d70 5b69  Single) : temp[i
+0004e720: 5d20 3d20 696e 6469 6365 7353 696e 676c  ] = indicesSingl
+0004e730: 655b 695d 0d0a 2020 2020 2020 2020 2020  e[i]..          
+0004e740: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
+0004e750: 616e 6765 286e 756d 6249 6e64 6963 6573  ange(numbIndices
+0004e760: 5365 7429 203a 2074 656d 705b 692b 6e75  Set) : temp[i+nu
+0004e770: 6d62 496e 6469 6365 5369 6e67 6c65 5d20  mbIndiceSingle] 
+0004e780: 3d20 7368 6966 7465 6449 6e64 6963 6573  = shiftedIndices
+0004e790: 5365 745b 695d 0d0a 2020 2020 2020 2020  Set[i]..        
+0004e7a0: 2020 2020 2020 2020 696e 6469 6365 7320          indices 
+0004e7b0: 3d20 7465 6d70 0d0a 0d0a 2020 2020 2020  = temp....      
+0004e7c0: 2020 656c 7365 203a 200d 0a20 2020 2020    else : ..     
+0004e7d0: 2020 2020 2020 2076 6572 7473 2c69 6e64         verts,ind
+0004e7e0: 6963 6573 203d 2076 6572 7473 5365 742c  ices = vertsSet,
+0004e7f0: 696e 6469 6365 7353 6574 0d0a 0d0a 2020  indicesSet....  
+0004e800: 2020 2020 2020 7365 6c66 2e6c 696e 6549        self.lineI
+0004e810: 6e64 6963 6573 203d 2069 6e64 6963 6573  ndices = indices
+0004e820: 0d0a 2020 2020 2020 2020 7365 6c66 2e76  ..        self.v
+0004e830: 6572 7465 7843 6f6f 7220 3d20 7665 7274  ertexCoor = vert
+0004e840: 730d 0a20 2020 2020 2020 2073 656c 662e  s..        self.
+0004e850: 7365 676d 496e 6469 6365 7320 3d20 696e  segmIndices = in
+0004e860: 6469 6365 730d 0a20 2020 2020 2020 2073  dices..        s
+0004e870: 6567 7320 3d20 7365 6c66 2e5f 6765 745f  egs = self._get_
+0004e880: 7365 676d 656e 7473 2820 7665 7274 732c  segments( verts,
+0004e890: 2069 6e64 6963 6573 2020 290d 0a20 2020   indices  )..   
+0004e8a0: 2020 2020 2073 656c 662e 7365 745f 7365       self.set_se
+0004e8b0: 676d 656e 7473 2873 6567 7329 0d0a 2020  gments(segs)..  
+0004e8c0: 2020 2020 2020 6966 206c 656e 2873 656c        if len(sel
+0004e8d0: 662e 6765 745f 636f 6c6f 7228 2920 2920  f.get_color() ) 
+0004e8e0: 3d3d 2031 203a 0d0a 2020 2020 2020 2020  == 1 :..        
+0004e8f0: 2020 2020 6320 3d20 7365 6c66 2e67 6574      c = self.get
+0004e900: 5f63 6f6c 6f72 2829 5b30 5d0d 0a20 2020  _color()[0]..   
+0004e910: 2020 2020 2020 2020 2073 656c 662e 7365           self.se
+0004e920: 745f 636f 6c6f 7228 205b 635d 2a6c 656e  t_color( [c]*len
+0004e930: 2869 6e64 6963 6573 2920 2020 290d 0a0d  (indices)   )...
+0004e940: 0a20 2020 2020 2020 2073 656c 662e 5f73  .        self._s
+0004e950: 6574 5f67 656f 6d65 7472 6963 5f62 6f75  et_geometric_bou
+0004e960: 6e64 7328 290d 0a20 2020 2020 2020 2073  nds()..        s
+0004e970: 656c 662e 5f70 6c61 6e65 4e6f 726d 616c  elf._planeNormal
+0004e980: 203d 2070 6c61 6e65 4e6f 726d 616c 0d0a   = planeNormal..
+0004e990: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0004e9a0: 656c 660d 0a0d 0a20 2020 2064 6566 206d  elf....    def m
+0004e9b0: 6170 5f78 7953 6c69 6365 5f66 726f 6d5f  ap_xySlice_from_
+0004e9c0: 6f70 2873 656c 662c 206f 7065 7261 7469  op(self, operati
+0004e9d0: 6f6e 2c20 2a2a 6b61 7267 7320 2920 3a0d  on, **kargs ) :.
+0004e9e0: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
+0004e9f0: 2020 2020 2020 5573 696e 6720 6120 6675        Using a fu
+0004ea00: 6e63 7469 6f6e 616c 206f 7065 7261 7469  nctional operati
+0004ea10: 6f6e 2c20 6c69 6e65 7320 6f66 207a 3d66  on, lines of z=f
+0004ea20: 2878 2920 6f72 207a 3d66 2879 2920 696e  (x) or z=f(y) in
+0004ea30: 2064 6f6d 6169 6e20 2d31 2074 6f20 312e   domain -1 to 1.
+0004ea40: 0d0a 0d0a 2020 2020 2020 2020 5061 7261  ....        Para
+0004ea50: 6d65 7465 7273 0d0a 2020 2020 2020 2020  meters..        
+0004ea60: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
+0004ea70: 2020 2020 6f70 6572 6174 696f 6e20 3a20      operation : 
+0004ea80: 6675 6e63 7469 6f6e 206f 626a 6563 7420  function object 
+0004ea90: 0d0a 2020 2020 2020 2020 2020 2020 4675  ..            Fu
+0004eaa0: 6e63 7469 6f6e 2074 6861 7420 7461 6b65  nction that take
+0004eab0: 7320 6f6e 6520 6172 6775 6d65 6e74 2c20  s one argument, 
+0004eac0: 6120 4e75 6d70 7920 666c 6f61 740d 0a20  a Numpy float.. 
+0004ead0: 2020 2020 2020 2020 2020 2033 2058 204e             3 X N
+0004eae0: 2061 7272 6179 206f 6620 7879 7a20 636f   array of xyz co
+0004eaf0: 6f72 6469 6e61 7465 7320 696e 2074 6865  ordinates in the
+0004eb00: 2064 6f6d 6169 6e2e 0d0a 2020 2020 2020   domain...      
+0004eb10: 2020 2020 2020 5468 6520 7265 7475 726e        The return
+0004eb20: 2076 616c 7565 2069 7320 6120 3320 5820   value is a 3 X 
+0004eb30: 4e20 6172 7261 7920 6f66 2078 797a 2063  N array of xyz c
+0004eb40: 6f6f 7264 696e 6174 6573 2e0d 0a0d 0a20  oordinates..... 
+0004eb50: 2020 2020 2020 2078 706c 616e 6520 3a20         xplane : 
+0004eb60: 636f 6e74 6f75 7220 6174 2061 2063 6f6e  contour at a con
+0004eb70: 7374 616e 7420 7661 6c75 6520 6f66 2078  stant value of x
+0004eb80: 3d78 706c 616e 650d 0a0d 0a20 2020 2020  =xplane....     
+0004eb90: 2020 2079 706c 616e 6520 3a20 636f 6e74     yplane : cont
+0004eba0: 6f75 7220 6174 2061 2063 6f6e 7374 616e  our at a constan
+0004ebb0: 7420 7661 6c75 6520 6f66 2079 3d78 706c  t value of y=xpl
+0004ebc0: 616e 650d 0a0d 0a20 2020 2020 2020 2078  ane....        x
+0004ebd0: 7365 7420 3a20 2020 6e75 6d62 6572 206f  set :   number o
+0004ebe0: 6620 6576 656e 6c79 2073 7061 6365 6420  f evenly spaced 
+0004ebf0: 636f 6e74 6f75 7273 2c20 792d 6178 6973  contours, y-axis
+0004ec00: 206e 6f72 6d61 6c20 706c 616e 650d 0a0d   normal plane...
+0004ec10: 0a20 2020 2020 2020 2079 7365 7420 3a20  .        yset : 
+0004ec20: 2020 6e75 6d62 6572 206f 6620 6576 656e    number of even
+0004ec30: 6c79 2073 7061 6365 6420 636f 6e74 6f75  ly spaced contou
+0004ec40: 7273 2c20 782d 6178 6973 206e 6f72 6d61  rs, x-axis norma
+0004ec50: 6c20 706c 616e 650d 0a0d 0a20 2020 2020  l plane....     
+0004ec60: 2020 2078 6c69 6d20 3a20 2020 5820 646f     xlim :   X do
+0004ec70: 6d61 696e 206f 6620 6f70 6572 6174 696f  main of operatio
+0004ec80: 6e20 2820 6465 6661 756c 743a 205b 2d31  n ( default: [-1
+0004ec90: 2c31 5d20 290d 0a0d 0a20 2020 2020 2020  ,1] )....       
+0004eca0: 2079 6c69 6d20 3a20 2020 5920 646f 6d61   ylim :   Y doma
+0004ecb0: 696e 206f 6620 6f70 6572 6174 696f 6e20  in of operation 
+0004ecc0: 2820 6465 6661 756c 743a 205b 2d31 2c31  ( default: [-1,1
+0004ecd0: 5d20 290d 0a0d 0a20 2020 2020 2020 2052  ] )....        R
+0004ece0: 6574 7572 6e73 0d0a 2020 2020 2020 2020  eturns..        
+0004ecf0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
+0004ed00: 2073 656c 6620 3a20 5061 7261 6d65 7472   self : Parametr
+0004ed10: 6963 4c69 6e65 206f 626a 6563 740d 0a0d  icLine object...
+0004ed20: 0a20 2020 2020 2020 2022 2222 0d0a 0d0a  .        """....
+0004ed30: 2020 2020 2020 2020 6465 6620 7a56 616c          def zVal
+0004ed40: 7565 5f67 656e 6572 6174 6f72 2878 4172  ue_generator(xAr
+0004ed50: 722c 2079 4172 722c 206f 7029 203a 0d0a  r, yArr, op) :..
+0004ed60: 2020 2020 2020 2020 2020 2020 786c 656e              xlen
+0004ed70: 203d 206c 656e 2878 4172 7229 0d0a 2020   = len(xArr)..  
+0004ed80: 2020 2020 2020 2020 2020 796c 656e 203d            ylen =
+0004ed90: 206c 656e 2879 4172 7229 0d0a 2020 2020   len(yArr)..    
+0004eda0: 2020 2020 2020 2020 7863 6f6c 203d 206e          xcol = n
+0004edb0: 702e 7469 6c65 2820 5b31 2e30 2c30 2e30  p.tile( [1.0,0.0
+0004edc0: 2c30 2e30 5d2c 2028 786c 656e 2c31 2929  ,0.0], (xlen,1))
+0004edd0: 0d0a 2020 2020 2020 2020 2020 2020 7856  ..            xV
+0004ede0: 616c 203d 206e 702e 6d75 6c74 6970 6c79  al = np.multiply
+0004edf0: 2878 636f 6c2e 542c 7841 7272 292e 540d  (xcol.T,xArr).T.
+0004ee00: 0a20 2020 2020 2020 2020 2020 2078 5661  .            xVa
+0004ee10: 6c33 203d 206e 702e 7469 6c65 2878 5661  l3 = np.tile(xVa
+0004ee20: 6c2c 2028 796c 656e 2c31 2929 0d0a 2020  l, (ylen,1))..  
+0004ee30: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+0004ee40: 2020 2020 2020 2020 7963 6f6c 203d 206e          ycol = n
+0004ee50: 702e 7469 6c65 2820 5b30 2e30 2c31 2e30  p.tile( [0.0,1.0
+0004ee60: 2c30 2e30 5d20 2c20 2879 6c65 6e2c 3129  ,0.0] , (ylen,1)
+0004ee70: 290d 0a20 2020 2020 2020 2020 2020 2079  )..            y
+0004ee80: 5661 6c20 3d20 6e70 2e6d 756c 7469 706c  Val = np.multipl
+0004ee90: 7928 7963 6f6c 2e54 2c79 4172 7229 2e54  y(ycol.T,yArr).T
+0004eea0: 0d0a 2020 2020 2020 2020 2020 2020 7956  ..            yV
+0004eeb0: 616c 3320 3d20 6e70 2e72 6570 6561 7428  al3 = np.repeat(
+0004eec0: 7956 616c 2c78 6c65 6e2c 6178 6973 3d30  yVal,xlen,axis=0
+0004eed0: 290d 0a20 2020 2020 2020 2020 2020 200d  )..            .
+0004eee0: 0a20 2020 2020 2020 2020 2020 2070 7473  .            pts
+0004eef0: 203d 2078 5661 6c33 202b 2079 5661 6c33   = xVal3 + yVal3
+0004ef00: 0d0a 2020 2020 2020 2020 2020 2020 7074  ..            pt
+0004ef10: 7320 3d20 6e70 2e72 6573 6861 7065 2870  s = np.reshape(p
+0004ef20: 7473 2c28 786c 656e 2a79 6c65 6e2c 3329  ts,(xlen*ylen,3)
+0004ef30: 290d 0a20 2020 2020 2020 2020 2020 2078  )..            x
+0004ef40: 2c79 2c7a 203d 206f 7028 7074 732e 5429  ,y,z = op(pts.T)
+0004ef50: 0d0a 2020 2020 2020 2020 2020 2020 7a20  ..            z 
+0004ef60: 3d20 6e70 2e72 6573 6861 7065 287a 2c28  = np.reshape(z,(
+0004ef70: 796c 656e 2c78 6c65 6e29 290d 0a20 2020  ylen,xlen))..   
+0004ef80: 2020 2020 2020 2020 2023 2074 6865 2066           # the f
+0004ef90: 6f6c 6c6f 7769 6e67 2c20 636f 6d70 656e  ollowing, compen
+0004efa0: 7361 7465 7320 666f 7220 696e 7465 7270  sates for interp
+0004efb0: 3264 2066 6f72 2064 6174 6167 7269 640d  2d for datagrid.
+0004efc0: 0a20 2020 2020 2020 2020 2020 2023 2077  .            # w
+0004efd0: 6869 6368 2064 726f 7073 2074 6865 2066  hich drops the f
+0004efe0: 6972 7374 2064 696d 656e 7369 6f6e 2c20  irst dimension, 
+0004eff0: 7365 6520 5f67 6574 536c 6963 6520 0d0a  see _getSlice ..
+0004f000: 2020 2020 2020 2020 2020 2020 6966 2079              if y
+0004f010: 6c65 6e20 3d3d 2031 203a 207a 203d 207a  len == 1 : z = z
+0004f020: 5b30 5d0d 0a20 2020 2020 2020 2020 2020  [0]..           
+0004f030: 2072 6574 7572 6e20 7a0d 0a0d 0a20 2020   return z....   
+0004f040: 2020 2020 2064 6566 2067 2878 4172 722c       def g(xArr,
+0004f050: 2079 4172 7229 203a 0d0a 2020 2020 2020   yArr) :..      
+0004f060: 2020 2020 2020 7265 7475 726e 207a 5661        return zVa
+0004f070: 6c75 655f 6765 6e65 7261 746f 7228 7841  lue_generator(xA
+0004f080: 7272 2c20 7941 7272 2c20 6f70 6572 6174  rr, yArr, operat
+0004f090: 696f 6e29 0d0a 2020 2020 2020 2020 2320  ion)..        # 
+0004f0a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0004f0b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0004f0c0: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
+0004f0d0: 2020 206e 616d 6520 3d20 5f67 6574 4675     name = _getFu
+0004f0e0: 6e63 7469 6f6e 4e61 6d65 286f 7065 7261  nctionName(opera
+0004f0f0: 7469 6f6e 2c73 656c 662e 5f67 656f 6d4e  tion,self._geomN
+0004f100: 616d 6529 0d0a 2020 2020 2020 2020 6966  ame)..        if
+0004f110: 206e 616d 6520 6973 206e 6f74 204e 6f6e   name is not Non
+0004f120: 6520 3a20 7365 6c66 2e5f 6765 6f6d 4e61  e : self._geomNa
+0004f130: 6d65 203d 206e 616d 650d 0a20 2020 2020  me = name..     
+0004f140: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+0004f150: 6d61 705f 7879 536c 6963 6528 2067 2c20  map_xySlice( g, 
+0004f160: 2a2a 6b61 7267 7320 2029 0d0a 0d0a 2020  **kargs  )....  
+0004f170: 2020 6465 6620 6d61 705f 7879 536c 6963    def map_xySlic
+0004f180: 655f 6672 6f6d 5f64 6174 6167 7269 6428  e_from_datagrid(
+0004f190: 7365 6c66 2c20 6461 7461 6772 6964 2c20  self, datagrid, 
+0004f1a0: 7363 616c 653d 4e6f 6e65 2c20 2a2a 6b61  scale=None, **ka
+0004f1b0: 7267 7320 2029 203a 0d0a 2020 2020 2020  rgs  ) :..      
+0004f1c0: 2020 2222 220d 0a20 2020 2020 2020 2055    """..        U
+0004f1d0: 7369 6e67 2061 2064 6174 6167 7269 642c  sing a datagrid,
+0004f1e0: 206c 696e 6573 206f 6620 7a3d 6628 7829   lines of z=f(x)
+0004f1f0: 206f 7220 7a3d 6628 7929 2069 6e20 646f   or z=f(y) in do
+0004f200: 6d61 696e 205b 2d31 2c20 315d 0d0a 0d0a  main [-1, 1]....
+0004f210: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+0004f220: 7273 0d0a 2020 2020 2020 2020 2d2d 2d2d  rs..        ----
+0004f230: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
+0004f240: 6461 7461 6772 6964 203a 2032 4420 666c  datagrid : 2D fl
+0004f250: 6f61 7420 6172 7261 790d 0a0d 0a20 2020  oat array....   
+0004f260: 2020 2020 2073 6361 6c65 3a20 6d75 6c74       scale: mult
+0004f270: 6970 6c69 6572 2066 6f72 2074 6865 205a  iplier for the Z
+0004f280: 2064 6972 6563 7469 6f6e 2e0d 0a0d 0a20   direction..... 
+0004f290: 2020 2020 2020 2078 706c 616e 6520 3a20         xplane : 
+0004f2a0: 636f 6e74 6f75 7220 6174 2061 2063 6f6e  contour at a con
+0004f2b0: 7374 616e 7420 7661 6c75 6520 6f66 2078  stant value of x
+0004f2c0: 3d78 706c 616e 650d 0a0d 0a20 2020 2020  =xplane....     
+0004f2d0: 2020 2079 706c 616e 6520 3a20 636f 6e74     yplane : cont
+0004f2e0: 6f75 7220 6174 2061 2063 6f6e 7374 616e  our at a constan
+0004f2f0: 7420 7661 6c75 6520 6f66 2079 3d78 706c  t value of y=xpl
+0004f300: 616e 650d 0a0d 0a20 2020 2020 2020 2078  ane....        x
+0004f310: 7365 7420 3a20 2020 6e75 6d62 6572 206f  set :   number o
+0004f320: 6620 6576 656e 6c79 2073 7061 6365 6420  f evenly spaced 
+0004f330: 636f 6e74 6f75 7273 2c20 792d 6178 6973  contours, y-axis
+0004f340: 206e 6f72 6d61 6c20 706c 616e 650d 0a0d   normal plane...
+0004f350: 0a20 2020 2020 2020 2079 7365 7420 3a20  .        yset : 
+0004f360: 2020 6e75 6d62 6572 206f 6620 6576 656e    number of even
+0004f370: 6c79 2073 7061 6365 6420 636f 6e74 6f75  ly spaced contou
+0004f380: 7273 2c20 782d 6178 6973 206e 6f72 6d61  rs, x-axis norma
+0004f390: 6c20 706c 616e 650d 0a0d 0a20 2020 2020  l plane....     
+0004f3a0: 2020 2052 6574 7572 6e73 0d0a 2020 2020     Returns..    
+0004f3b0: 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020      -------..   
+0004f3c0: 2020 2020 2073 656c 6620 3a20 5061 7261       self : Para
+0004f3d0: 6d65 7472 6963 4c69 6e65 206f 626a 6563  metricLine objec
+0004f3e0: 740d 0a0d 0a20 2020 2020 2020 2022 2222  t....        """
+0004f3f0: 0d0a 2020 2020 2020 2020 6966 2027 786c  ..        if 'xl
+0004f400: 696d 2720 696e 206b 6172 6773 206f 7220  im' in kargs or 
+0004f410: 2779 6c69 6d27 2069 6e20 6b61 7267 7320  'ylim' in kargs 
+0004f420: 3a0d 0a20 2020 2020 2020 2020 2020 2077  :..            w
+0004f430: 6172 6e69 6e67 732e 7761 726e 2827 786c  arnings.warn('xl
+0004f440: 696d 2061 6e64 2079 6c69 6d20 6172 6773  im and ylim args
+0004f450: 2066 6f72 2044 6174 6167 7269 6420 7879   for Datagrid xy
+0004f460: 536c 6963 6520 6e6f 7420 6176 6169 6c61  Slice not availa
+0004f470: 626c 652e 2729 0d0a 2020 2020 2020 2020  ble.')..        
+0004f480: 2020 2020 7265 7475 726e 2073 656c 660d      return self.
+0004f490: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
+0004f4a0: 2020 2020 2020 2064 6174 6120 3d20 6461         data = da
+0004f4b0: 7461 6772 6964 0d0a 2020 2020 2020 2020  tagrid..        
+0004f4c0: 646d 6178 203d 206e 702e 616d 6178 2864  dmax = np.amax(d
+0004f4d0: 6174 6167 7269 6429 0d0a 2020 2020 2020  atagrid)..      
+0004f4e0: 2020 646d 696e 203d 206e 702e 616d 696e    dmin = np.amin
+0004f4f0: 2864 6174 6167 7269 6429 0d0a 2020 2020  (datagrid)..    
+0004f500: 2020 2020 6465 6c74 6120 3d20 646d 6178      delta = dmax
+0004f510: 2d64 6d69 6e0d 0a20 2020 2020 2020 2064  -dmin..        d
+0004f520: 6174 6120 3d20 2864 6174 6167 7269 6420  ata = (datagrid 
+0004f530: 2d20 646d 696e 292f 6465 6c74 610d 0a20  - dmin)/delta.. 
+0004f540: 2020 2020 2020 2078 6420 3d20 6e70 2e6c         xd = np.l
+0004f550: 696e 7370 6163 6528 2d31 2c20 312c 2064  inspace(-1, 1, d
+0004f560: 6174 612e 7368 6170 655b 305d 2029 0d0a  ata.shape[0] )..
+0004f570: 2020 2020 2020 2020 7964 203d 206e 702e          yd = np.
+0004f580: 6c69 6e73 7061 6365 282d 312c 2031 2c20  linspace(-1, 1, 
+0004f590: 6461 7461 2e73 6861 7065 5b31 5d20 290d  data.shape[1] ).
+0004f5a0: 0a20 2020 2020 2020 2067 203d 2020 696e  .        g =  in
+0004f5b0: 7465 7270 6f6c 6174 652e 696e 7465 7270  terpolate.interp
+0004f5c0: 3264 2879 642c 2078 642c 2064 6174 612c  2d(yd, xd, data,
+0004f5d0: 206b 696e 643d 2763 7562 6963 2729 0d0a   kind='cubic')..
+0004f5e0: 0d0a 2020 2020 2020 2020 2320 2d2d 2d2d  ..        # ----
+0004f5f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0004f600: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0004f610: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2073  -----..        s
+0004f620: 656c 662e 5f6d 6170 5f78 7953 6c69 6365  elf._map_xySlice
+0004f630: 2820 672c 202a 2a6b 6172 6773 2020 290d  ( g, **kargs  ).
+0004f640: 0a20 2020 2020 2020 2069 6620 7363 616c  .        if scal
+0004f650: 6520 6973 206e 6f74 204e 6f6e 6520 3a20  e is not None : 
+0004f660: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
+0004f670: 6c66 2e76 6572 7465 7843 6f6f 7220 3d20  lf.vertexCoor = 
+0004f680: 6e70 2e6d 756c 7469 706c 7928 7365 6c66  np.multiply(self
+0004f690: 2e76 6572 7465 7843 6f6f 722c 5b31 2c31  .vertexCoor,[1,1
+0004f6a0: 2c73 6361 6c65 5d29 0d0a 2020 2020 2020  ,scale])..      
+0004f6b0: 2020 2020 2020 696e 6469 6365 7320 3d20        indices = 
+0004f6c0: 7365 6c66 2e73 6567 6d49 6e64 6963 6573  self.segmIndices
+0004f6d0: 0d0a 2020 2020 2020 2020 2020 2020 7665  ..            ve
+0004f6e0: 7274 733d 2073 656c 662e 7665 7274 6578  rts= self.vertex
+0004f6f0: 436f 6f72 0d0a 2020 2020 2020 2020 2020  Coor..          
+0004f700: 2020 7365 6773 203d 2073 656c 662e 5f67    segs = self._g
+0004f710: 6574 5f73 6567 6d65 6e74 7328 2076 6572  et_segments( ver
+0004f720: 7473 2c20 696e 6469 6365 7320 2029 0d0a  ts, indices  )..
+0004f730: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0004f740: 2e73 6574 5f73 6567 6d65 6e74 7328 7365  .set_segments(se
+0004f750: 6773 290d 0a20 2020 2020 2020 2020 2020  gs)..           
+0004f760: 200d 0a20 2020 2020 2020 2072 6574 7572   ..        retur
+0004f770: 6e20 7365 6c66 0d0a 0d0a 2020 2020 6465  n self....    de
+0004f780: 6620 7363 616c 655f 6461 7461 6672 616d  f scale_datafram
+0004f790: 6528 7365 6c66 2c58 2c59 2c5a 2920 3a20  e(self,X,Y,Z) : 
+0004f7a0: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
+0004f7b0: 2020 2020 2020 2053 6361 6c69 6e67 2074         Scaling t
+0004f7c0: 6865 206c 696e 6520 6765 6f6d 6574 7279  he line geometry
+0004f7d0: 2062 6173 6564 206f 6e20 6120 6461 7461   based on a data
+0004f7e0: 6772 6964 2e0d 0a0d 0a20 2020 2020 2020  grid.....       
+0004f7f0: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
+0004f800: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
+0004f810: 0a20 2020 2020 2020 2058 2c20 592c 205a  .        X, Y, Z
+0004f820: 203a 204e 2078 204d 2061 7272 6179 730d   : N x M arrays.
+0004f830: 0a20 2020 2020 2020 2020 2020 204d 696e  .            Min
+0004f840: 696d 756d 2061 6e64 206d 6178 696d 756d  imum and maximum
+0004f850: 2076 616c 7565 7320 6f66 2074 6865 2061   values of the a
+0004f860: 7272 6179 7320 6172 6520 7573 6564 2074  rrays are used t
+0004f870: 6f20 7363 616c 650d 0a20 2020 2020 2020  o scale..       
+0004f880: 2020 2020 2061 6e64 2074 7261 6e73 6c61       and transla
+0004f890: 7465 2074 6865 2073 7572 6661 6365 2066  te the surface f
+0004f8a0: 726f 6d20 616e 2069 6e74 6961 6c20 646f  rom an intial do
+0004f8b0: 6d61 696e 206f 660d 0a20 2020 2020 2020  main of..       
+0004f8c0: 2020 2020 205b 2028 2d31 2c31 292c 2028       [ (-1,1), (
+0004f8d0: 2d31 2c31 292c 2028 302c 3129 205d 0d0a  -1,1), (0,1) ]..
+0004f8e0: 0d0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+0004f8f0: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+0004f900: 2d2d 0d0a 2020 2020 2020 2020 7365 6c66  --..        self
+0004f910: 203a 2050 6172 616d 6574 7269 634c 696e   : ParametricLin
+0004f920: 6520 6f62 6a65 6374 0d0a 0d0a 2020 2020  e object....    
+0004f930: 2020 2020 2222 220d 0a0d 0a20 2020 2020      """....     
+0004f940: 2020 2072 6574 7572 6e20 5f73 6361 6c65     return _scale
+0004f950: 5f64 6174 6166 7261 6d65 2873 656c 662c  _dataframe(self,
+0004f960: 582c 592c 5a29 0d0a 0d0a 636c 6173 7320  X,Y,Z)....class 
+0004f970: 5365 676d 656e 744c 696e 6528 436f 6c6f  SegmentLine(Colo
+0004f980: 724c 696e 6533 4443 6f6c 6c65 6374 696f  rLine3DCollectio
+0004f990: 6e29 203a 0d0a 2020 2020 0d0a 2020 2020  n) :..    ..    
+0004f9a0: 6465 6620 5f5f 696e 6974 5f5f 2820 7365  def __init__( se
+0004f9b0: 6c66 2c20 7665 7274 6578 436f 6f72 202c  lf, vertexCoor ,
+0004f9c0: 206e 616d 653d 4e6f 6e65 2c20 2a2a 6b77   name=None, **kw
+0004f9d0: 6172 6773 2029 203a 0d0a 2020 2020 2020  args ) :..      
+0004f9e0: 2020 2222 220d 0a20 2020 2020 2020 2041    """..        A
+0004f9f0: 2073 696e 676c 6520 6c69 6e65 206f 6620   single line of 
+0004fa00: 7371 7565 6e74 6961 6c20 7365 676d 656e  squential segmen
+0004fa10: 7473 2066 726f 6d20 616e 2061 7272 6179  ts from an array
+0004fa20: 206f 6620 7665 7274 6963 6573 2e0d 0a0d   of vertices....
+0004fa30: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+0004fa40: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
+0004fa50: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
+0004fa60: 2076 6572 7465 7843 6f6f 7220 3a20 5620   vertexCoor : V 
+0004fa70: 7820 3320 6e75 6d65 7269 6361 6c20 6172  x 3 numerical ar
+0004fa80: 7261 792d 6c69 6b65 2e20 0d0a 2020 2020  ray-like. ..    
+0004fa90: 2020 2020 2020 2020 416e 2061 7272 6179          An array
+0004faa0: 206f 6620 5620 6e75 6d62 6572 206f 6620   of V number of 
+0004fab0: 7879 7a20 7665 7274 6578 2063 6f6f 7264  xyz vertex coord
+0004fac0: 696e 6174 6573 2e0d 0a0d 0a20 2020 2020  inates.....     
+0004fad0: 2020 206e 616d 6520 3a20 7374 7269 6e67     name : string
+0004fae0: 2c20 6f70 7469 6f6e 616c 2c20 6465 6661  , optional, defa
+0004faf0: 756c 743a 204e 6f6e 652e 0d0a 2020 2020  ult: None...    
+0004fb00: 2020 2020 2020 2020 4465 7363 7269 7074          Descript
+0004fb10: 6976 6520 6964 656e 7469 6669 6572 2e0d  ive identifier..
+0004fb20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0004fb30: 200d 0a20 2020 2020 2020 204f 7468 6572   ..        Other
+0004fb40: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
+0004fb50: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+0004fb60: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 202a  -----..        *
+0004fb70: 2a6b 7761 7267 730d 0a20 2020 2020 2020  *kwargs..       
+0004fb80: 2020 2020 2041 6c6c 206f 7468 6572 2070       All other p
+0004fb90: 6172 616d 6574 6572 7320 6172 6520 7061  arameters are pa
+0004fba0: 7373 6564 206f 6e20 746f 2027 7333 646c  ssed on to 's3dl
+0004fbb0: 6962 2e73 7572 6661 6365 2e43 6f6c 6f72  ib.surface.Color
+0004fbc0: 4c69 6e65 3344 436f 6c6c 6563 7469 6f6e  Line3DCollection
+0004fbd0: 272e 0d0a 0d0a 2020 2020 2020 2020 2222  '.....        ""
+0004fbe0: 2220 2020 2020 2020 0d0a 2020 2020 2020  "       ..      
+0004fbf0: 2020 6c69 6e65 203d 2076 6572 7465 7843    line = vertexC
+0004fc00: 6f6f 7220 2023 203c 2d2d 2d20 7375 7065  oor  # <--- supe
+0004fc10: 7220 7769 6c6c 206d 616b 6520 7468 6973  r will make this
+0004fc20: 2074 6f20 6120 6e75 6d70 7920 666c 6f61   to a numpy floa
+0004fc30: 7420 6172 7261 790d 0a20 2020 2020 2020  t array..       
+0004fc40: 2069 6e64 6963 6573 203d 205b 205b 2a72   indices = [ [*r
+0004fc50: 616e 6765 286c 656e 286c 696e 6529 295d  ange(len(line))]
+0004fc60: 205d 0d0a 2020 2020 2020 2020 7375 7065   ]..        supe
+0004fc70: 7228 292e 5f5f 696e 6974 5f5f 286c 696e  r().__init__(lin
+0004fc80: 652c 2069 6e64 6963 6573 2c20 6e61 6d65  e, indices, name
+0004fc90: 2c20 2a2a 6b77 6172 6773 290d 0a0d 0a0d  , **kwargs).....
+0004fca0: 0a0d 0a23 203d 3d3d 3d3d 3d3d 3d3d 3d3d  ...# ===========
+0004fcb0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0004fcc0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0004fcd0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0004fce0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0004fcf0: 3d3d 3d3d 3d3d 2b0d 0a23 2044 6576 4e6f  ======+..# DevNo
+0004fd00: 7465 203a 2041 6c74 686f 7567 6820 5375  te : Although Su
+0004fd10: 7266 6163 652c 2056 6563 746f 7220 616e  rface, Vector an
+0004fd20: 6420 4c69 6e65 2063 6f6c 6c65 6374 696f  d Line collectio
+0004fd30: 6e20 636c 6173 7365 7320 6861 7665 2073  n classes have s
+0004fd40: 696d 696c 6172 2020 2020 2020 7c0d 0a23  imilar      |..#
+0004fd50: 2020 2020 2020 2020 2020 206d 6574 686f             metho
+0004fd60: 6473 2028 6567 2e20 6d61 702e 2e2e 2c20  ds (eg. map..., 
+0004fd70: 6e61 6d65 2c20 636c 6970 202e 2e29 2c20  name, clip ..), 
+0004fd80: 6469 6666 6572 656e 6365 7320 616d 6f6e  differences amon
+0004fd90: 6720 7468 6573 6520 636c 6173 7365 7320  g these classes 
+0004fda0: 2020 7c0d 0a23 2020 2020 2020 2020 2020    |..#          
+0004fdb0: 2061 7265 2073 7566 6669 6369 656e 746c   are sufficientl
+0004fdc0: 7920 6469 6666 6572 656e 7420 746f 206e  y different to n
+0004fdd0: 6f74 2077 6172 7261 6e74 2061 2063 6c61  ot warrant a cla
+0004fde0: 7373 2074 6861 7420 7468 6573 6520 7468  ss that these th
+0004fdf0: 7265 6520 2020 2020 7c0d 0a23 2020 2020  ree     |..#    
+0004fe00: 2020 2020 2020 2063 6c61 7373 6573 2063         classes c
+0004fe10: 6f75 6c64 2075 7365 2077 6974 6820 6d75  ould use with mu
+0004fe20: 6c74 6970 6c65 2069 6e68 6572 6974 656e  ltiple inheriten
+0004fe30: 6365 2e20 2049 6e73 7465 6164 2c20 7468  ce.  Instead, th
+0004fe40: 6520 666f 6c6c 6f77 696e 6720 2020 7c0d  e following   |.
+0004fe50: 0a23 2020 2020 2020 2020 2020 206d 6574  .#           met
+0004fe60: 686f 6473 2061 7265 2063 6f6d 6d6f 6e20  hods are common 
+0004fe70: 616d 6f6e 6720 7468 6573 6520 7468 7265  among these thre
+0004fe80: 6520 636c 6173 7365 732e 2020 2020 2020  e classes.      
+0004fe90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004fea0: 2020 2020 7c0d 0a23 2020 2020 2020 2020      |..#        
+0004feb0: 2020 2046 7574 4465 7620 6d61 7920 6265     FutDev may be
+0004fec0: 2075 7365 6675 6c20 746f 2064 6566 696e   useful to defin
+0004fed0: 6520 7375 6368 2061 2063 6c61 7373 2c20  e such a class, 
+0004fee0: 6275 7420 4d52 4f49 2e20 2020 2020 2020  but MROI.       
+0004fef0: 2020 2020 2020 2020 2020 7c0d 0a23 2020            |..#  
+0004ff00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004ff10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004ff20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004ff30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004ff40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004ff50: 7c0d 0a23 2020 2020 2020 2020 2020 204f  |..#           O
+0004ff60: 7665 7261 6c6c 2043 6f6c 6f72 4c69 6e65  verall ColorLine
+0004ff70: 3344 436f 6c6c 6563 7469 6f6e 2063 6c61  3DCollection cla
+0004ff80: 7373 206e 6565 6473 2061 2061 7263 6869  ss needs a archi
+0004ff90: 7465 6374 7572 616c 2063 6861 6e67 652e  tectural change.
+0004ffa0: 2020 2020 2020 7c0d 0a23 2020 2020 2020        |..#      
+0004ffb0: 2020 2020 2050 6f73 7369 626c 7920 6120       Possibly a 
+0004ffc0: 6c69 7374 206f 6620 436f 6c6f 7253 6567  list of ColorSeg
+0004ffd0: 6d65 6e74 3344 436f 6c6c 6563 7469 6f6e  ment3DCollection
+0004ffe0: 206f 626a 6563 7473 2077 6869 6368 2061   objects which a
+0004fff0: 7265 2020 2020 2020 2020 2020 7c0d 0a23  re          |..#
+00050000: 2020 2020 2020 2020 2020 2063 6f6e 7461             conta
+00050010: 696e 6564 2077 6974 6869 6e20 6561 6368  ined within each
+00050020: 2043 6f6c 6f72 4c69 6e65 3344 436f 6c6c   ColorLine3DColl
+00050030: 6563 7469 6f20 6f62 6a65 6374 2e20 4561  ectio object. Ea
+00050040: 6368 206c 6973 7420 2020 2020 2020 2020  ch list         
+00050050: 2020 7c0d 0a23 2020 2020 2020 2020 2020    |..#          
+00050060: 2069 7320 6120 6261 7369 6361 6c6c 7920   is a basically 
+00050070: 6120 6c69 6e65 2e20 2041 6e61 6c6f 676f  a line.  Analogo
+00050080: 7573 2074 6f20 5375 7266 6163 6520 636f  us to Surface co
+00050090: 6c6c 6563 7469 6f6e 7320 7768 6963 6820  llections which 
+000500a0: 2020 2020 2020 2020 7c0d 0a23 2020 2020          |..#    
+000500b0: 2020 2020 2020 2077 6869 6368 2061 7265         which are
+000500c0: 2061 2063 6f6c 6c65 6374 696f 6e20 6f66   a collection of
+000500d0: 2070 6f6c 7968 6564 726f 6e73 2e20 5468   polyhedrons. Th
+000500e0: 6973 2077 6f75 6c64 2062 6520 616e 2061  is would be an a
+000500f0: 6476 616e 7461 6765 2020 2020 2020 7c0d  dvantage      |.
+00050100: 0a23 2020 2020 2020 2020 2020 2066 6f72  .#           for
+00050110: 2077 7269 7469 6e67 2061 6e64 2072 6561   writing and rea
+00050120: 6469 6e67 2074 6f20 6669 6c65 732e 2020  ding to files.  
+00050130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00050140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00050150: 2020 2020 7c0d 0a23 2020 2020 2020 2020      |..#        
+00050160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00050170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00050180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00050190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000501a0: 2020 2020 2020 2020 2020 7c0d 0a23 2020            |..#  
+000501b0: 2020 2020 2020 2020 2042 6563 6f6d 696e           Becomin
+000501c0: 6720 6120 7072 696f 7269 7479 3a20 4e65  g a priority: Ne
+000501d0: 6564 2074 6f20 6861 7665 2073 6570 6172  ed to have separ
+000501e0: 6174 6520 6f62 6a65 6374 2070 726f 7065  ate object prope
+000501f0: 7274 6965 7320 666f 7220 2020 2020 2020  rties for       
+00050200: 7c0d 0a23 2020 2020 2020 2020 2020 2066  |..#           f
+00050210: 6163 6520 636f 6c6f 7273 2061 6e64 2065  ace colors and e
+00050220: 6467 6520 636f 6c6f 7273 2c20 616e 6420  dge colors, and 
+00050230: 646f 6e27 7420 7573 6520 7468 6520 4d61  don't use the Ma
+00050240: 7470 6c6f 746c 6962 2070 726f 7065 7274  tplotlib propert
+00050250: 6965 7320 2020 7c0d 0a23 2020 2020 2020  ies   |..#      
+00050260: 2020 2020 2066 6f72 2074 6865 7365 2069       for these i
+00050270: 6e20 506f 6c79 3344 436f 6c6c 6563 7469  n Poly3DCollecti
+00050280: 6f6e 2c20 4c69 6e65 3344 436f 6c6c 6563  on, Line3DCollec
+00050290: 7469 6f6e 2e20 546f 6f20 6d75 6368 2027  tion. Too much '
+000502a0: 6d61 6769 6327 2020 2020 2020 7c0d 0a23  magic'      |..#
+000502b0: 2020 2020 2020 2020 2020 2068 6170 7065             happe
+000502c0: 6e69 6e67 2077 6869 6368 2069 7320 6f75  ning which is ou
+000502d0: 7420 6f66 2063 6f6e 7472 6f6c 2e20 2054  t of control.  T
+000502e0: 6865 6e20 7573 6520 7365 745f 636f 6c6f  hen use set_colo
+000502f0: 7220 2020 2020 2020 2020 2020 2020 2020  r               
+00050300: 2020 7c0d 0a23 2020 2020 2020 2020 2020    |..#          
+00050310: 2077 6865 6e20 6e65 6564 6564 2e20 2054   when needed.  T
+00050320: 6869 7320 6170 706c 6965 7320 746f 2062  his applies to b
+00050330: 6f74 6820 7375 7266 6163 6520 616e 6420  oth surface and 
+00050340: 6c69 6e65 206f 626a 6563 7473 2e20 2020  line objects.   
+00050350: 2020 2020 2020 2020 7c0d 0a23 2020 2020          |..#    
+00050360: 2020 2020 2020 2054 6869 7320 616c 736f         This also
+00050370: 2077 6f75 6c64 2061 6c6c 6f77 2063 6f6e   would allow con
+00050380: 7374 7275 6374 696e 6720 636c 6173 7365  structing classe
+00050390: 7320 696e 6465 7065 6e64 656e 7420 6f66  s independent of
+000503a0: 2020 2020 2020 2020 2020 2020 2020 7c0d                |.
+000503b0: 0a23 2020 2020 2020 2020 2020 2050 6f6c  .#           Pol
+000503c0: 7933 4443 6f6c 6c65 6374 696f 6e2c 204c  y3DCollection, L
+000503d0: 696e 6533 4443 6f6c 6c65 6374 696f 6e20  ine3DCollection 
+000503e0: 666f 7220 6675 7475 7265 2064 6576 656c  for future devel
+000503f0: 6f70 656d 656e 742c 2020 2020 2020 2020  opement,        
+00050400: 2020 2020 7c0d 0a23 2020 2020 2020 2020      |..#        
+00050410: 2020 2061 6c6c 6f77 696e 6720 616e 2069     allowing an i
+00050420: 6e74 6572 6661 6365 2074 6f20 6d61 7470  nterface to matp
+00050430: 6c6f 746c 6962 2074 6f20 6265 2063 6f6e  lotlib to be con
+00050440: 7374 7275 6374 6564 2069 6e73 7465 6164  structed instead
+00050450: 2020 2020 2020 2020 2020 7c0d 0a23 2020            |..#  
+00050460: 2020 2020 2020 2020 2069 6e68 6572 6974           inherit
+00050470: 616e 6365 2e20 2020 2020 2020 2020 2020  ance.           
 00050480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00050490: 7c0d 0a23 2020 2033 2e20 7665 7274 6578  |..#   3. vertex
-000504a0: 206e 6f72 6d61 6c73 2066 6f72 2065 7874   normals for ext
-000504b0: 6572 6e61 6c20 7573 6520 666f 7220 476f  ernal use for Go
-000504c0: 7572 6175 6420 7368 6164 696e 672c 2065  uraud shading, e
-000504d0: 7463 2e20 2020 2020 2020 2020 2020 2020  tc.             
-000504e0: 2020 2020 2020 7c0d 0a23 2020 2034 2e20        |..#   4. 
-000504f0: 6c69 6e65 206f 626a 6563 7473 2020 2020  line objects    
-00050500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00050510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00050520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00050530: 2020 2020 2020 2020 2020 2020 7c0d 0a23              |..#
-00050540: 2020 2035 2e20 636f 6465 2069 6e20 7365     5. code in se
-00050550: 7061 7261 7465 2065 7869 6d70 6f72 7420  parate eximport 
-00050560: 6d6f 6475 6c65 2020 2020 2020 2020 2020  module          
-00050570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00050580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00050590: 2020 7c0d 0a23 2020 2036 2e20 6669 6c65    |..#   6. file
-000505a0: 2074 7970 6573 2028 6173 6369 692c 6269   types (ascii,bi
-000505b0: 6e61 7279 2920 3a20 7374 6c2c 2070 6c79  nary) : stl, ply
-000505c0: 2c20 5833 442c 2065 7463 2e20 2020 2020  , X3D, etc.     
-000505d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000505e0: 2020 2020 2020 2020 7c0d 0a23 203d 3d3d          |..# ===
-000505f0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00050600: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00050610: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00050620: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00050630: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 2b0d  ==============+.
-00050640: 0a0d 0a64 6566 2067 6574 5f73 7572 6667  ...def get_surfg
-00050650: 656f 6d5f 6672 6f6d 5f6f 626a 2866 696c  eom_from_obj(fil
-00050660: 652c 202a 2a6b 6172 6773 2920 3a0d 0a20  e, **kargs) :.. 
-00050670: 2020 2022 2222 2043 7265 6174 6520 7375     """ Create su
-00050680: 7266 6163 6520 6672 6f6d 206f 626a 2066  rface from obj f
-00050690: 6f72 6d61 7474 6564 2027 6669 6c65 272e  ormatted 'file'.
-000506a0: 0d0a 2020 2020 2020 2020 6b61 7267 7320  ..        kargs 
-000506b0: 7061 7373 6564 2074 6f20 696e 7374 616e  passed to instan
-000506c0: 7469 6174 6520 7375 7266 6163 6520 696e  tiate surface in
-000506d0: 2063 6f6e 7374 7275 6374 6f72 2e20 0d0a   constructor. ..
-000506e0: 2020 2020 2020 2020 2750 726f 6f66 206f          'Proof o
-000506f0: 6620 636f 6e63 6570 7427 2066 6f72 2066  f concept' for f
-00050700: 7574 7572 6520 7665 7273 696f 6e73 2e0d  uture versions..
-00050710: 0a20 2020 2022 2222 0d0a 2020 2020 2320  .    """..    # 
-00050720: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00050730: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00050740: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00050750: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00050760: 2e2e 2e2e 2e0d 0a20 2020 2064 6566 2066  .......    def f
-00050770: 696c 655f 7265 636f 7264 7328 696e 5f66  ile_records(in_f
-00050780: 696c 6529 3a0d 0a20 2020 2020 2020 2074  ile):..        t
-00050790: 7279 203a 0d0a 2020 2020 2020 2020 2020  ry :..          
-000507a0: 2020 6620 3d20 6f70 656e 2869 6e5f 6669    f = open(in_fi
-000507b0: 6c65 290d 0a20 2020 2020 2020 2020 2020  le)..           
-000507c0: 2062 7566 203d 2066 2e72 6561 6428 290d   buf = f.read().
-000507d0: 0a20 2020 2020 2020 2020 2020 2066 2e63  .            f.c
-000507e0: 6c6f 7365 2829 0d0a 2020 2020 2020 2020  lose()..        
-000507f0: 6578 6365 7074 203a 0d0a 2020 2020 2020  except :..      
-00050800: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-00050810: 6545 7272 6f72 2827 4552 524f 523a 204f  eError('ERROR: O
-00050820: 424a 2066 696c 6520 6e6f 7420 6163 6365  BJ file not acce
-00050830: 7373 6564 2021 2121 2729 0d0a 2020 2020  ssed !!!')..    
-00050840: 2020 2020 666f 7220 6220 696e 2062 7566      for b in buf
-00050850: 2e73 706c 6974 2827 5c6e 2729 3a0d 0a20  .split('\n'):.. 
-00050860: 2020 2020 2020 2020 2020 2062 203d 2027             b = '
-00050870: 2027 2e6a 6f69 6e28 622e 7370 6c69 7428   '.join(b.split(
-00050880: 2929 2023 2072 656d 6f76 6520 6578 7472  )) # remove extr
-00050890: 6120 7370 6163 6573 2e0d 0a20 2020 2020  a spaces...     
-000508a0: 2020 2020 2020 2069 6620 622e 7374 6172         if b.star
-000508b0: 7473 7769 7468 2827 7620 2729 3a0d 0a20  tswith('v '):.. 
-000508c0: 2020 2020 2020 2020 2020 2020 2020 2079                 y
-000508d0: 6965 6c64 205b 2776 272c 205b 666c 6f61  ield ['v', [floa
-000508e0: 7428 7829 2066 6f72 2078 2069 6e20 622e  t(x) for x in b.
-000508f0: 7370 6c69 7428 2220 2229 5b31 3a5d 5d5d  split(" ")[1:]]]
-00050900: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
-00050910: 6966 2062 2e73 7461 7274 7377 6974 6828  if b.startswith(
-00050920: 2766 2027 293a 0d0a 2020 2020 2020 2020  'f '):..        
-00050930: 2020 2020 2020 2020 6461 7461 6c69 7374          datalist
-00050940: 203d 205b 7820 666f 7220 7820 696e 2062   = [x for x in b
-00050950: 2e73 706c 6974 2822 2022 295b 313a 5d20  .split(" ")[1:] 
-00050960: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
-00050970: 2020 2023 206f 6e6c 7920 6765 7420 6661     # only get fa
-00050980: 6365 2069 6e64 6963 6573 2061 7420 7468  ce indices at th
-00050990: 6520 6669 7273 7420 696e 6465 782e 2e2e  e first index...
-000509a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000509b0: 2020 7969 656c 6420 5b20 2766 272c 205b    yield [ 'f', [
-000509c0: 2020 696e 7428 792e 7370 6c69 7428 222f    int(y.split("/
-000509d0: 2229 5b30 5d29 2d31 2020 2066 6f72 2079  ")[0])-1   for y
-000509e0: 2069 6e20 6461 7461 6c69 7374 5d20 2020   in datalist]   
-000509f0: 5d0d 0a20 2020 2020 2020 2020 2020 2065  ]..            e
-00050a00: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-00050a10: 2020 2020 2020 7969 656c 6420 5b27 272c        yield ['',
-00050a20: 2022 225d 2020 200d 0a20 2020 2064 6566   ""]   ..    def
-00050a30: 2067 6574 5f76 5f66 2869 6e5f 6669 6c65   get_v_f(in_file
-00050a40: 293a 0d0a 2020 2020 2020 2020 7665 7274  ):..        vert
-00050a50: 6963 6573 2c66 6163 6573 203d 205b 5d2c  ices,faces = [],
-00050a60: 5b5d 0d0a 2020 2020 2020 2020 666f 7220  []..        for 
-00050a70: 6b2c 2076 2069 6e20 6669 6c65 5f72 6563  k, v in file_rec
-00050a80: 6f72 6473 2869 6e5f 6669 6c65 293a 0d0a  ords(in_file):..
-00050a90: 2020 2020 2020 2020 2020 2020 6966 2020              if  
-00050aa0: 206b 203d 3d20 2776 273a 2076 6572 7469   k == 'v': verti
-00050ab0: 6365 732e 6170 7065 6e64 2876 290d 0a20  ces.append(v).. 
-00050ac0: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-00050ad0: 6b20 3d3d 2027 6627 3a20 6661 6365 732e  k == 'f': faces.
-00050ae0: 6170 7065 6e64 2876 290d 0a20 2020 2020  append(v)..     
-00050af0: 2020 2069 6620 6e6f 7420 6c65 6e28 6661     if not len(fa
-00050b00: 6365 7329 206f 7220 6e6f 7420 6c65 6e28  ces) or not len(
-00050b10: 7665 7274 6963 6573 293a 2020 7265 7475  vertices):  retu
-00050b20: 726e 204e 6f6e 652c 204e 6f6e 650d 0a20  rn None, None.. 
-00050b30: 2020 2020 2020 2072 6574 7572 6e20 7665         return ve
-00050b40: 7274 6963 6573 2c20 6661 6365 730d 0a20  rtices, faces.. 
-00050b50: 2020 2023 202e 2e2e 2e2e 2e2e 2e2e 2e2e     # ...........
-00050b60: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00050b70: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00050b80: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-00050b90: 2e2e 2e2e 2e2e 2e2e 2e2e 0d0a 2020 2020  ............    
-00050ba0: 762c 6620 3d20 6765 745f 765f 6628 6669  v,f = get_v_f(fi
-00050bb0: 6c65 290d 0a20 2020 2076 203d 206e 702e  le)..    v = np.
-00050bc0: 6172 7261 7928 7629 0d0a 2020 2020 7620  array(v)..    v 
-00050bd0: 3d20 765b 3a2c 5b30 2c32 2c31 5d5d 0d0a  = v[:,[0,2,1]]..
-00050be0: 2020 2020 7620 3d20 6e70 2e6d 756c 7469      v = np.multi
-00050bf0: 706c 7928 762c 5b31 2c2d 312c 315d 290d  ply(v,[1,-1,1]).
-00050c00: 0a20 2020 2069 6620 7620 6973 206e 6f74  .    if v is not
-00050c10: 204e 6f6e 653a 2020 7375 7266 6163 6520   None:  surface 
-00050c20: 3d20 5375 7266 6163 6533 4443 6f6c 6c65  = Surface3DColle
-00050c30: 6374 696f 6e28 762c 662c 2a2a 6b61 7267  ction(v,f,**karg
-00050c40: 7329 0d0a 2020 2020 656c 7365 3a20 2020  s)..    else:   
-00050c50: 2020 2020 2020 2020 2020 2073 7572 6661             surfa
-00050c60: 6365 203d 2053 7068 6572 6963 616c 5375  ce = SphericalSu
-00050c70: 7266 6163 6528 302c 2774 6574 7261 272c  rface(0,'tetra',
-00050c80: 636f 6c6f 723d 2772 2729 0d0a 2020 2020  color='r')..    
-00050c90: 7265 7475 726e 2073 7572 6661 6365 0d0a  return surface..
-00050ca0: 0d0a 6465 6620 7361 7665 5f73 7572 6667  ..def save_surfg
-00050cb0: 656f 6d5f 746f 5f6f 626a 2866 696c 652c  eom_to_obj(file,
-00050cc0: 7375 7266 6163 6529 203a 0d0a 2020 2020  surface) :..    
-00050cd0: 2222 2220 4578 706f 7274 2027 7375 7266  """ Export 'surf
-00050ce0: 6163 6527 2067 656f 6d65 7472 7920 746f  ace' geometry to
-00050cf0: 206f 626a 2066 6f72 6d61 7474 6564 2066   obj formatted f
-00050d00: 696c 652e 200d 0a20 2020 2020 2020 2027  ile. ..        '
-00050d10: 5072 6f6f 6620 6f66 2063 6f6e 6365 7074  Proof of concept
-00050d20: 2720 666f 7220 6675 7475 7265 2076 6572  ' for future ver
-00050d30: 7369 6f6e 732e 0d0a 2020 2020 2222 220d  sions...    """.
-00050d40: 0a20 2020 2076 203d 2073 7572 6661 6365  .    v = surface
-00050d50: 2e76 6572 7465 7843 6f6f 720d 0a20 2020  .vertexCoor..   
-00050d60: 2076 203d 2076 5b3a 2c5b 302c 322c 315d   v = v[:,[0,2,1]
-00050d70: 5d0d 0a20 2020 2076 203d 206e 702e 6d75  ]..    v = np.mu
-00050d80: 6c74 6970 6c79 2876 2c5b 312c 312c 2d31  ltiply(v,[1,1,-1
-00050d90: 5d29 0d0a 2020 2020 6620 3d20 7375 7266  ])..    f = surf
-00050da0: 6163 652e 6676 496e 6469 6365 732b 3120  ace.fvIndices+1 
-00050db0: 2023 206f 626a 2066 696c 6520 696e 6469   # obj file indi
-00050dc0: 6365 7320 7374 6172 7420 6174 2031 0d0a  ces start at 1..
-00050dd0: 2020 2020 7673 203d 205b 2027 7620 272b      vs = [ 'v '+
-00050de0: 6e70 2e61 7272 6179 3273 7472 696e 6728  np.array2string(
-00050df0: 782c 7072 6566 6978 3d27 272c 7375 6666  x,prefix='',suff
-00050e00: 6978 3d27 2729 5b31 3a2d 315d 2066 6f72  ix='')[1:-1] for
-00050e10: 2078 2069 6e20 7620 5d0d 0a20 2020 2066   x in v ]..    f
-00050e20: 7320 3d20 5b20 2766 2027 2b6e 702e 6172  s = [ 'f '+np.ar
-00050e30: 7261 7932 7374 7269 6e67 2878 2c70 7265  ray2string(x,pre
-00050e40: 6669 783d 2727 2c73 7566 6669 783d 2727  fix='',suffix=''
-00050e50: 295b 313a 2d31 5d20 666f 7220 7820 696e  )[1:-1] for x in
-00050e60: 2066 205d 0d0a 2020 2020 6765 6f6d 4c69   f ]..    geomLi
-00050e70: 6e65 7320 3d20 7673 202b 2066 730d 0a20  nes = vs + fs.. 
-00050e80: 2020 2077 6974 6820 6f70 656e 2866 696c     with open(fil
-00050e90: 652c 2277 2220 2920 6173 2066 696c 656f  e,"w" ) as fileo
-00050ea0: 7574 203a 0d0a 2020 2020 2020 2020 666f  ut :..        fo
-00050eb0: 7220 6c69 6e65 2069 6e20 6765 6f6d 4c69  r line in geomLi
-00050ec0: 6e65 7320 3a0d 0a20 2020 2020 2020 2020  nes :..         
-00050ed0: 2020 2066 696c 656f 7574 2e77 7269 7465     fileout.write
-00050ee0: 286c 696e 652b 275c 6e27 290d 0a20 2020  (line+'\n')..   
-00050ef0: 2020 2020 2066 696c 656f 7574 2e63 6c6f       fileout.clo
-00050f00: 7365 2829 0d0a 2020 2020 7265 7475 726e  se()..    return
-00050f10: 0d0a                                     ..
+00050490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000504a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000504b0: 7c20 2020 2020 2020 2020 2020 2020 0d0a  |             ..
+000504c0: 2320 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  # ==============
+000504d0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000504e0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000504f0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00050500: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00050510: 3d3d 3d2b 0d0a 0d0a 636c 6173 7320 4b57  ===+....class KW
+00050520: 7072 6f63 6573 736f 7228 293a 0d0a 2020  processor():..  
+00050530: 2020 2222 2220 2041 6363 6573 7320 7661    """  Access va
+00050540: 6c75 6573 2066 726f 6d20 6465 6661 756c  lues from defaul
+00050550: 7473 206f 7220 6b77 6172 6773 2e20 2222  ts or kwargs. ""
+00050560: 220d 0a0d 0a20 2020 2064 6566 205f 5f69  "....    def __i
+00050570: 6e69 745f 5f28 7365 6c66 2c76 616c 4469  nit__(self,valDi
+00050580: 6374 2c20 6d65 7468 6f64 5374 723d 4e6f  ct, methodStr=No
+00050590: 6e65 2c20 6368 6563 6b49 6e70 7574 4b65  ne, checkInputKe
+000505a0: 7973 3d54 7275 652c 202a 2a6b 6172 6773  ys=True, **kargs
+000505b0: 2920 3a0d 0a20 2020 2020 2020 2022 2222  ) :..        """
+000505c0: 0d0a 2020 2020 2020 2020 5661 6c69 6461  ..        Valida
+000505d0: 7465 2069 6e70 7574 206f 6620 6120 6d65  te input of a me
+000505e0: 7468 6f64 2773 206b 7761 7267 732e 2020  thod's kwargs.  
+000505f0: 496e 7465 726e 616c 2075 7365 204f 4e4c  Internal use ONL
+00050600: 592e 0d0a 0d0a 2020 2020 2020 2020 5061  Y.....        Pa
+00050610: 7261 6d65 7465 7273 0d0a 2020 2020 2020  rameters..      
+00050620: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
+00050630: 2020 2020 2020 7661 6c44 6963 7420 3a20        valDict : 
+00050640: 6469 6374 696f 6e61 7279 206f 6620 6172  dictionary of ar
+00050650: 6775 6d65 6e74 206e 616d 6573 2c20 6465  gument names, de
+00050660: 6661 756c 7473 2061 6e64 2076 616c 6964  faults and valid
+00050670: 2076 616c 7565 732e 0d0a 2020 2020 2020   values...      
+00050680: 2020 2020 2020 6b65 7920 2d20 2020 6b65        key -   ke
+00050690: 7977 6f72 6420 6172 6775 6d65 6e74 206e  yword argument n
+000506a0: 616d 650d 0a20 2020 2020 2020 2020 2020  ame..           
+000506b0: 2076 616c 7565 202d 2073 696e 676c 6520   value - single 
+000506c0: 6465 6661 756c 7420 7661 6c75 652c 206f  default value, o
+000506d0: 7220 6c69 7374 206f 6620 3244 206c 6973  r list of 2D lis
+000506e0: 7473 2074 6f20 6265 2076 616c 6964 6174  ts to be validat
+000506f0: 6564 3a0d 0a20 2020 2020 2020 2020 2020  ed:..           
+00050700: 2020 2020 2020 2020 2049 6620 6120 6c69           If a li
+00050710: 7374 206f 6620 6c69 7374 2c20 7468 6520  st of list, the 
+00050720: 7374 7275 6374 7572 6520 6973 3a0d 0a20  structure is:.. 
+00050730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00050740: 2020 2076 616c 7565 5b30 5d20 2d20 5b27     value[0] - ['
+00050750: 6465 6661 756c 7420 7661 6c75 6527 5d20  default value'] 
+00050760: 2020 203c 2d20 7369 6e67 6c65 2076 616c     <- single val
+00050770: 7565 0d0a 2020 2020 2020 2020 2020 2020  ue..            
+00050780: 2020 2020 2020 2020 7661 6c75 655b 315d          value[1]
+00050790: 202d 205b 2061 2c20 622c 2063 2c20 2e2e   - [ a, b, c, ..
+000507a0: 2e2e 2e20 5d20 2020 3c2d 206c 6973 7420  ... ]   <- list 
+000507b0: 6f66 2061 206c 6973 7420 6f66 2076 616c  of a list of val
+000507c0: 6964 2076 616c 7565 730d 0a0d 0a20 2020  id values....   
+000507d0: 2020 2020 206d 6574 686f 6453 7472 203a       methodStr :
+000507e0: 2073 7472 696e 672c 206f 7074 696f 6e61   string, optiona
+000507f0: 6c2c 2064 6566 6175 6c74 3a20 4e6f 6e65  l, default: None
+00050800: 0d0a 2020 2020 2020 2020 2020 2020 4964  ..            Id
+00050810: 656e 7469 6669 6572 206f 6620 7468 6520  entifier of the 
+00050820: 6d65 7468 6f64 2063 616c 6c65 6420 7768  method called wh
+00050830: 6572 6520 6120 7661 6c69 6461 7469 6f6e  ere a validation
+00050840: 2065 7272 6f72 206f 6363 7572 6564 0d0a   error occured..
+00050850: 2020 2020 2020 2020 2020 2020 7768 6963              whic
+00050860: 6820 6973 2073 686f 776e 2069 6e20 7468  h is shown in th
+00050870: 6520 6572 726f 7220 6d65 7373 6167 652e  e error message.
+00050880: 0d0a 0d0a 2020 2020 2020 2020 6368 6563  ....        chec
+00050890: 6b49 6e70 7574 4b65 7973 203a 2062 6f6f  kInputKeys : boo
+000508a0: 6c2c 2064 6566 6175 6c74 3a20 5472 7565  l, default: True
+000508b0: 0d0a 2020 2020 2020 2020 2020 2020 4966  ..            If
+000508c0: 2054 7275 652c 2063 6865 636b 2069 6620   True, check if 
+000508d0: 616c 6c20 6b61 7267 7320 6172 6520 696e  all kargs are in
+000508e0: 2074 6865 2076 616c 4469 6374 2e0d 0a20   the valDict... 
+000508f0: 2020 2020 2020 2020 2020 2055 6e6b 6e6f             Unkno
+00050900: 776e 206b 6579 7320 7769 6c6c 2070 726f  wn keys will pro
+00050910: 6475 6365 2061 2056 616c 7565 4572 726f  duce a ValueErro
+00050920: 722e 0d0a 2020 2020 2020 2020 2020 2020  r...            
+00050930: 4966 2046 616c 7365 2c20 6967 6e6f 7265  If False, ignore
+00050940: 206b 6172 6773 206e 6f74 2069 6e20 7661   kargs not in va
+00050950: 6c44 6963 742e 0d0a 0d0a 2020 2020 2020  lDict.....      
+00050960: 2020 6b61 7267 7320 3a0d 0a20 2020 2020    kargs :..     
+00050970: 2020 2020 2020 2054 6865 2064 6963 7469         The dicti
+00050980: 6f6e 6172 7920 6f62 6a65 6374 2063 6f6e  onary object con
+00050990: 7461 696e 696e 6720 7468 6520 696e 7075  taining the inpu
+000509a0: 7420 6b65 7977 6f72 643a 7661 6c75 6573  t keyword:values
+000509b0: 2074 6f20 6265 2065 7874 7261 6374 6564   to be extracted
+000509c0: 2e0d 0a0d 0a20 2020 2020 2020 2022 2222  .....        """
+000509d0: 0d0a 2020 2020 2020 2020 2320 4675 7444  ..        # FutD
+000509e0: 6576 3a20 636f 756c 6420 7573 6520 6120  ev: could use a 
+000509f0: 6469 6374 696f 6e61 7279 2066 6f72 2076  dictionary for v
+00050a00: 616c 7565 5b31 5d20 746f 2076 616c 6964  alue[1] to valid
+00050a10: 6174 6520 7261 6e67 6573 2061 6e64 2074  ate ranges and t
+00050a20: 7970 6573 2e0d 0a20 2020 2020 2020 2073  ypes...        s
+00050a30: 656c 662e 7661 6c44 6963 7420 3d20 7661  elf.valDict = va
+00050a40: 6c44 6963 740d 0a20 2020 2020 2020 2073  lDict..        s
+00050a50: 656c 662e 6b61 7267 7320 3d20 6b61 7267  elf.kargs = karg
+00050a60: 730d 0a20 2020 2020 2020 2073 656c 662e  s..        self.
+00050a70: 6d65 7468 6f64 203d 206d 6574 686f 6453  method = methodS
+00050a80: 7472 0d0a 2020 2020 2020 2020 6966 2063  tr..        if c
+00050a90: 6865 636b 496e 7075 744b 6579 7320 3a0d  heckInputKeys :.
+00050aa0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00050ab0: 6c65 6e28 6b61 7267 7329 203d 3d20 3020  len(kargs) == 0 
+00050ac0: 2020 203a 2072 6574 7572 6e0d 0a20 2020     : return..   
+00050ad0: 2020 2020 2020 2020 2069 6620 6c65 6e28           if len(
+00050ae0: 7661 6c44 6963 7429 203d 3d20 3020 203a  valDict) == 0  :
+00050af0: 2072 6574 7572 6e0d 0a20 2020 2020 2020   return..       
+00050b00: 2020 2020 2065 7272 4d73 6720 3d20 224b       errMsg = "K
+00050b10: 6579 776f 7264 2c20 7b7d 2c20 6973 206e  eyword, {}, is n
+00050b20: 6f74 2072 6563 6f67 6e69 7a65 642e 205c  ot recognized. \
+00050b30: 6e20 4c69 7374 206f 6620 706f 7373 6962  n List of possib
+00050b40: 6c65 206b 6579 7320 6172 653a 207b 7d22  le keys are: {}"
+00050b50: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+00050b60: 206d 6574 686f 6453 7472 2069 7320 6e6f   methodStr is no
+00050b70: 7420 4e6f 6e65 203a 2065 7272 4d73 6720  t None : errMsg 
+00050b80: 3d20 275b 272b 6d65 7468 6f64 5374 722b  = '['+methodStr+
+00050b90: 275d 202d 2027 202b 2065 7272 4d73 670d  '] - ' + errMsg.
+00050ba0: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+00050bb0: 206b 6579 2069 6e20 6b61 7267 732e 6b65   key in kargs.ke
+00050bc0: 7973 2829 203a 200d 0a20 2020 2020 2020  ys() : ..       
+00050bd0: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
+00050be0: 6b65 7920 696e 2076 616c 4469 6374 2e6b  key in valDict.k
+00050bf0: 6579 7328 2920 3a0d 0a20 2020 2020 2020  eys() :..       
+00050c00: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+00050c10: 7365 2056 616c 7565 4572 726f 7228 2065  se ValueError( e
+00050c20: 7272 4d73 672e 666f 726d 6174 286b 6579  rrMsg.format(key
+00050c30: 2c20 6c69 7374 2876 616c 4469 6374 2e6b  , list(valDict.k
+00050c40: 6579 7328 2929 2020 2920 290d 0a20 2020  eys())  ) )..   
+00050c50: 2020 2020 2072 6574 7572 6e20 2020 200d       return    .
+00050c60: 0a0d 0a20 2020 2064 6566 205f 6465 6656  ...    def _defV
+00050c70: 616c 2873 656c 662c 7629 203a 0d0a 2020  al(self,v) :..  
+00050c80: 2020 2020 2020 7661 6c75 6520 3d20 7365        value = se
+00050c90: 6c66 2e76 616c 4469 6374 5b76 5d0d 0a20  lf.valDict[v].. 
+00050ca0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+00050cb0: 616e 6365 2876 616c 7565 2c6c 6973 7429  ance(value,list)
+00050cc0: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
+00050cd0: 6669 7273 7456 616c 203d 2076 616c 7565  firstVal = value
+00050ce0: 5b30 5d0d 0a20 2020 2020 2020 2020 2020  [0]..           
+00050cf0: 2072 6574 7572 6e20 6669 7273 7456 616c   return firstVal
+00050d00: 5b30 5d20 6966 2069 7369 6e73 7461 6e63  [0] if isinstanc
+00050d10: 6528 6669 7273 7456 616c 2c28 6c69 7374  e(firstVal,(list
+00050d20: 2c74 7570 6c65 2929 2065 6c73 6520 7661  ,tuple)) else va
+00050d30: 6c75 650d 0a20 2020 2020 2020 2072 6574  lue..        ret
+00050d40: 7572 6e20 7661 6c75 650d 0a0d 0a20 2020  urn value....   
+00050d50: 2064 6566 205f 7661 6c75 654b 6579 776f   def _valueKeywo
+00050d60: 7264 4572 726f 7228 7365 6c66 2c6b 6579  rdError(self,key
+00050d70: 5374 722c 7573 7256 616c 2920 3a0d 0a20  Str,usrVal) :.. 
+00050d80: 2020 2020 2020 2064 6963 5661 6c20 3d20         dicVal = 
+00050d90: 7365 6c66 2e76 616c 4469 6374 5b6b 6579  self.valDict[key
+00050da0: 5374 725d 0d0a 2020 2020 2020 2020 6572  Str]..        er
+00050db0: 724c 6973 7420 3d20 6469 6356 616c 5b31  rList = dicVal[1
+00050dc0: 5d0d 0a20 2020 2020 2020 2066 6f72 2069  ]..        for i
+00050dd0: 2069 6e20 7261 6e67 6528 322c 6c65 6e28   in range(2,len(
+00050de0: 6469 6356 616c 2920 2920 3a20 6572 724c  dicVal) ) : errL
+00050df0: 6973 7420 2b3d 2064 6963 5661 6c5b 695d  ist += dicVal[i]
+00050e00: 200d 0a20 2020 2020 2020 2065 7272 4120   ..        errA 
+00050e10: 3d20 224b 6579 776f 7264 2c20 7b7d 2c20  = "Keyword, {}, 
+00050e20: 7661 6c75 6520 6f66 207b 7d20 6973 206e  value of {} is n
+00050e30: 6f74 2072 6563 6f67 6e69 7a65 642e 5c6e  ot recognized.\n
+00050e40: 204c 6973 7420 6f66 2070 6f73 7369 626c   List of possibl
+00050e50: 6520 7661 6c75 6573 2061 7265 3a20 7b7d  e values are: {}
+00050e60: 220d 0a20 2020 2020 2020 2065 7272 4220  "..        errB 
+00050e70: 3d20 224b 6579 776f 7264 2c20 7b7d 2c20  = "Keyword, {}, 
+00050e80: 7661 6c75 6520 6f66 2027 7b7d 2720 6973  value of '{}' is
+00050e90: 206e 6f74 2072 6563 6f67 6e69 7a65 642e   not recognized.
+00050ea0: 5c6e 204c 6973 7420 6f66 2070 6f73 7369  \n List of possi
+00050eb0: 626c 6520 7661 6c75 6573 2061 7265 3a20  ble values are: 
+00050ec0: 7b7d 2220 0d0a 2020 2020 2020 2020 6572  {}" ..        er
+00050ed0: 7253 7472 203d 2020 6572 7242 2069 6620  rStr =  errB if 
+00050ee0: 6973 696e 7374 616e 6365 2875 7372 5661  isinstance(usrVa
+00050ef0: 6c2c 7374 7229 2065 6c73 6520 6572 7241  l,str) else errA
+00050f00: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00050f10: 6966 2073 656c 662e 6d65 7468 6f64 2069  if self.method i
+00050f20: 7320 6e6f 7420 4e6f 6e65 203a 2065 7272  s not None : err
+00050f30: 5374 7220 3d20 275b 272b 7365 6c66 2e6d  Str = '['+self.m
+00050f40: 6574 686f 642b 275d 202d 2027 202b 2065  ethod+'] - ' + e
+00050f50: 7272 5374 720d 0a20 2020 2020 2020 2072  rrStr..        r
+00050f60: 6574 7572 6e20 6572 7253 7472 2e66 6f72  eturn errStr.for
+00050f70: 6d61 7428 6b65 7953 7472 2c73 7472 2875  mat(keyStr,str(u
+00050f80: 7372 5661 6c29 2c65 7272 4c69 7374 290d  srVal),errList).
+00050f90: 0a20 2020 2020 2020 200d 0a20 2020 2064  .        ..    d
+00050fa0: 6566 2067 6574 5661 6c28 7365 6c66 2c6b  ef getVal(self,k
+00050fb0: 6579 5374 722c 6368 6563 6b56 616c 6964  eyStr,checkValid
+00050fc0: 6974 793d 5472 7565 2920 203a 0d0a 2020  ity=True)  :..  
+00050fd0: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
+00050fe0: 2020 2052 6574 7572 6e20 7468 6520 6e61     Return the na
+00050ff0: 6d65 6420 6172 6775 6d65 6e74 2076 616c  med argument val
+00051000: 7565 2e0d 0a0d 0a20 2020 2020 2020 2050  ue.....        P
+00051010: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
+00051020: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
+00051030: 2020 2020 2020 206b 6579 5374 7220 3a20         keyStr : 
+00051040: 7374 7269 6e67 2e20 4b65 7977 6f72 640d  string. Keyword.
+00051050: 0a0d 0a20 2020 2020 2020 2063 6865 636b  ...        check
+00051060: 5661 6c69 6469 7479 203a 2062 6f6f 6c2c  Validity : bool,
+00051070: 206f 7074 696f 6e61 6c2c 2064 6566 6175   optional, defau
+00051080: 6c74 3a20 5472 7565 0d0a 2020 2020 2020  lt: True..      
+00051090: 2020 2020 2020 4966 2054 7275 652c 206b        If True, k
+000510a0: 6172 6720 7661 6c75 6520 6973 2063 6865  arg value is che
+000510b0: 636b 6564 2074 6f20 6265 2076 616c 6964  cked to be valid
+000510c0: 0d0a 2020 2020 2020 2020 2020 2020 616d  ..            am
+000510d0: 6f6e 6720 7468 6520 6c69 7374 206f 6620  ong the list of 
+000510e0: 7661 6c69 6420 7661 6c75 6573 2e0d 0a0d  valid values....
+000510f0: 0a20 2020 2020 2020 2052 6169 7365 730d  .        Raises.
+00051100: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d0d  .        ------.
+00051110: 0a20 2020 2020 2020 2056 616c 7565 4572  .        ValueEr
+00051120: 726f 720d 0a20 2020 2020 2020 2020 2020  ror..           
+00051130: 2069 6620 696e 7661 6c69 6420 6b65 7977   if invalid keyw
+00051140: 6f72 6420 6173 7369 676e 6d65 6e74 2e0d  ord assignment..
+00051150: 0a0d 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
+00051160: 6e73 0d0a 2020 2020 2020 2020 2d2d 2d2d  ns..        ----
+00051170: 2d2d 2d0d 0a20 2020 2020 2020 2020 2020  ---..           
+00051180: 2076 616c 7565 206f 6620 6b65 7977 6f72   value of keywor
+00051190: 642c 206f 7220 7468 6520 6465 6661 756c  d, or the defaul
+000511a0: 7420 7661 6c75 6520 6966 2074 6865 206b  t value if the k
+000511b0: 6579 5374 7220 6973 206e 6f74 2066 6f75  eyStr is not fou
+000511c0: 6e64 2069 6e20 6b61 7267 732e 0d0a 0d0a  nd in kargs.....
+000511d0: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
+000511e0: 2020 2020 2064 6566 206c 6973 744f 664c       def listOfL
+000511f0: 6973 7428 7629 203a 0d0a 2020 2020 2020  ist(v) :..      
+00051200: 2020 2020 2020 6966 206e 6f74 2069 7369        if not isi
+00051210: 6e73 7461 6e63 6528 762c 286c 6973 742c  nstance(v,(list,
+00051220: 7475 706c 6529 2920 3a20 7265 7475 726e  tuple)) : return
+00051230: 2046 616c 7365 0d0a 2020 2020 2020 2020   False..        
+00051240: 2020 2020 7265 7475 726e 2069 7369 6e73      return isins
+00051250: 7461 6e63 6528 765b 305d 2c28 6c69 7374  tance(v[0],(list
+00051260: 2c74 7570 6c65 2929 200d 0a20 2020 2020  ,tuple)) ..     
+00051270: 2020 206b 6172 6773 203d 2073 656c 662e     kargs = self.
+00051280: 6b61 7267 730d 0a20 2020 2020 2020 2069  kargs..        i
+00051290: 6620 6c65 6e28 6b61 7267 7329 203d 3d20  f len(kargs) == 
+000512a0: 3020 3a20 7265 7475 726e 2073 656c 662e  0 : return self.
+000512b0: 5f64 6566 5661 6c28 6b65 7953 7472 290d  _defVal(keyStr).
+000512c0: 0a20 2020 2020 2020 2069 6620 6b65 7953  .        if keyS
+000512d0: 7472 206e 6f74 2069 6e20 7365 6c66 2e76  tr not in self.v
+000512e0: 616c 4469 6374 203a 2023 206f 6e6c 7920  alDict : # only 
+000512f0: 666f 7220 6465 7665 6c6f 706d 656e 7420  for development 
+00051300: 7075 7270 6f73 6573 2e0d 0a20 2020 2020  purposes...     
+00051310: 2020 2020 2020 2070 7269 6e74 2822 2323         print("##
+00051320: 2323 2323 2323 2323 2323 2323 2323 2043  ############## C
+00051330: 4f44 4520 4552 524f 5220 4b57 3030 3120  ODE ERROR KW001 
+00051340: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00051350: 2323 2323 2322 290d 0a20 2020 2020 2020  #####")..       
+00051360: 2020 2020 2072 6574 7572 6e20 4e6f 6e65       return None
+00051370: 0d0a 2020 2020 2020 2020 6966 206b 6579  ..        if key
+00051380: 5374 7220 696e 206b 6172 6773 203a 200d  Str in kargs : .
+00051390: 0a20 2020 2020 2020 2020 2020 2064 6963  .            dic
+000513a0: 5661 6c20 3d20 7365 6c66 2e76 616c 4469  Val = self.valDi
+000513b0: 6374 5b6b 6579 5374 725d 0d0a 2020 2020  ct[keyStr]..    
+000513c0: 2020 2020 2020 2020 7573 7256 616c 203d          usrVal =
+000513d0: 206b 6172 6773 5b6b 6579 5374 725d 0d0a   kargs[keyStr]..
+000513e0: 2020 2020 2020 2020 2020 2020 6966 206c              if l
+000513f0: 6973 744f 664c 6973 7428 6469 6356 616c  istOfList(dicVal
+00051400: 2920 3a0d 0a20 2020 2020 2020 2020 2020  ) :..           
+00051410: 2020 2020 2066 6f72 2076 4c73 7420 696e       for vLst in
+00051420: 2064 6963 5661 6c20 3a0d 0a20 2020 2020   dicVal :..     
+00051430: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00051440: 6620 7573 7256 616c 2069 6e20 7365 7428  f usrVal in set(
+00051450: 764c 7374 2920 3a20 7265 7475 726e 2076  vLst) : return v
+00051460: 4c73 745b 305d 2023 3c3c 2076 616c 7565  Lst[0] #<< value
+00051470: 2069 7320 7468 6520 6669 7273 742e 0d0a   is the first...
+00051480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00051490: 6966 206e 6f74 2063 6865 636b 5661 6c69  if not checkVali
+000514a0: 6469 7479 203a 2072 6574 7572 6e20 7573  dity : return us
+000514b0: 7256 616c 0d0a 2020 2020 2020 2020 2020  rVal..          
+000514c0: 2020 2020 2020 656c 7365 203a 0d0a 2020        else :..  
+000514d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000514e0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+000514f0: 6f72 2820 7365 6c66 2e5f 7661 6c75 654b  or( self._valueK
+00051500: 6579 776f 7264 4572 726f 7228 6b65 7953  eywordError(keyS
+00051510: 7472 2c75 7372 5661 6c29 290d 0a20 2020  tr,usrVal))..   
+00051520: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00051530: 7573 7256 616c 0d0a 2020 2020 2020 2020  usrVal..        
+00051540: 7265 7475 726e 2073 656c 662e 5f64 6566  return self._def
+00051550: 5661 6c28 6b65 7953 7472 290d 0a0d 0a20  Val(keyStr).... 
+00051560: 2020 2064 6566 2066 696c 7465 7228 7365     def filter(se
+00051570: 6c66 293a 0d0a 2020 2020 2020 2020 2222  lf):..        ""
+00051580: 220d 0a20 2020 2020 2020 2052 656d 6f76  "..        Remov
+00051590: 6573 2064 6566 6175 6c74 7320 6672 6f6d  es defaults from
+000515a0: 206b 6172 6773 2e0d 0a20 2020 2020 2020   kargs...       
+000515b0: 2055 7365 2069 6d70 6c69 6573 2074 6861   Use implies tha
+000515c0: 7420 6d6f 7265 2074 6861 6e20 6465 6661  t more than defa
+000515d0: 756c 7420 6b61 7267 7320 6172 6520 746f  ult kargs are to
+000515e0: 2062 6520 7573 6564 2c0d 0a20 2020 2020   be used,..     
+000515f0: 2020 2074 6875 7320 2763 6865 636b 496e     thus 'checkIn
+00051600: 7075 744b 6579 7327 2073 686f 756c 6420  putKeys' should 
+00051610: 6265 2073 6574 2074 6f20 4661 6c73 6520  be set to False 
+00051620: 6174 205f 5f69 6e69 745f 5f2e 0d0a 2020  at __init__...  
+00051630: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
+00051640: 2020 2066 6f72 206b 6579 2069 6e20 7365     for key in se
+00051650: 6c66 2e76 616c 4469 6374 3a0d 0a20 2020  lf.valDict:..   
+00051660: 2020 2020 2020 2020 2074 7279 203a 2020           try :  
+00051670: 2064 656c 2073 656c 662e 6b61 7267 735b   del self.kargs[
+00051680: 206b 6579 205d 0d0a 2020 2020 2020 2020   key ]..        
+00051690: 2020 2020 6578 6365 7074 3a20 7061 7373      except: pass
+000516a0: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+000516b0: 2073 656c 662e 6b61 7267 730d 0a0d 0a0d   self.kargs.....
+000516c0: 0a23 2046 7574 4465 763a 2069 6e63 6c75  .# FutDev: inclu
+000516d0: 6465 2074 7261 6e73 666f 726d 0d0a 0d0a  de transform....
+000516e0: 6465 6620 5f61 7869 7355 5346 2861 7865  def _axisUSF(axe
+000516f0: 7329 203a 0d0a 2020 2020 2320 6178 6973  s) :..    # axis
+00051700: 2075 6e69 7420 7363 616c 6520 6661 6374   unit scale fact
+00051710: 6f72 0d0a 2020 2020 786c 696d 203d 2061  or..    xlim = a
+00051720: 7865 732e 6765 745f 786c 696d 2829 0d0a  xes.get_xlim()..
+00051730: 2020 2020 796c 696d 203d 2061 7865 732e      ylim = axes.
+00051740: 6765 745f 796c 696d 2829 0d0a 2020 2020  get_ylim()..    
+00051750: 7a6c 696d 203d 2061 7865 732e 6765 745f  zlim = axes.get_
+00051760: 7a6c 696d 2829 0d0a 2020 2020 7852 203d  zlim()..    xR =
+00051770: 2078 6c69 6d5b 315d 2d78 6c69 6d5b 305d   xlim[1]-xlim[0]
+00051780: 0d0a 2020 2020 7952 203d 2079 6c69 6d5b  ..    yR = ylim[
+00051790: 315d 2d79 6c69 6d5b 305d 0d0a 2020 2020  1]-ylim[0]..    
+000517a0: 7a52 203d 207a 6c69 6d5b 315d 2d7a 6c69  zR = zlim[1]-zli
+000517b0: 6d5b 305d 0d0a 2020 2020 7366 203d 206e  m[0]..    sf = n
+000517c0: 702e 6172 7261 7928 5b20 7952 2a7a 522c  p.array([ yR*zR,
+000517d0: 2078 522a 7a52 2c20 7852 2a79 5220 5d29   xR*zR, xR*yR ])
+000517e0: 0d0a 2020 2020 7265 7475 726e 2073 662f  ..    return sf/
+000517f0: 6e70 2e6c 696e 616c 672e 6e6f 726d 2873  np.linalg.norm(s
+00051800: 6629 0d0a 0d0a 6465 6620 5f63 6f6f 725f  f)....def _coor_
+00051810: 646f 7470 726f 6428 6469 7265 6374 696f  dotprod(directio
+00051820: 6e2c 6349 6e64 6578 2c72 6566 436f 6f72  n,cIndex,refCoor
+00051830: 2920 3a0d 0a20 2020 2023 2072 6566 436f  ) :..    # refCo
+00051840: 6f72 206d 6179 2062 6520 7665 7274 6578  or may be vertex
+00051850: 2863 6f6e 746f 7572 7329 206f 7220 6661  (contours) or fa
+00051860: 6365 2863 6c69 7029 2063 6f6f 7264 696e  ce(clip) coordin
+00051870: 6174 6573 2e0d 0a20 2020 2023 2064 6574  ates...    # det
+00051880: 6572 6d69 6e65 7320 7468 6520 6469 7374  ermines the dist
+00051890: 616e 6365 2066 726f 6d20 7468 6520 7265  ance from the re
+000518a0: 6643 6f6f 7220 706f 696e 7473 2074 6f20  fCoor points to 
+000518b0: 6569 7468 6572 3a0d 0a20 2020 2023 2020  either:..    #  
+000518c0: 2020 302e 2061 2070 6c61 6e65 2c20 2870    0. a plane, (p
+000518d0: 6c61 6e61 7220 636f 6f72 6469 6e61 7465  lanar coordinate
+000518e0: 7329 0d0a 2020 2020 2320 2020 2031 2e20  s)..    #    1. 
+000518f0: 6120 6c69 6e65 2c20 2028 6379 6c69 6e64  a line,  (cylind
+00051900: 7269 6361 6c20 636f 6f72 6469 6e61 7465  rical coordinate
+00051910: 7329 0d0a 2020 2020 2320 2020 2032 2e20  s)..    #    2. 
+00051920: 6120 706f 696e 742c 2028 7370 6865 7269  a point, (spheri
+00051930: 6361 6c20 636f 6f72 6469 6e61 7465 7329  cal coordinates)
+00051940: 0d0a 2020 2020 2320 7573 6564 2066 6f72  ..    # used for
+00051950: 2073 7572 6661 6365 2063 6f6e 746f 7572   surface contour
+00051960: 7320 2876 6572 7469 6365 7329 2c20 7375  s (vertices), su
+00051970: 7266 6163 6520 636c 6970 7069 6e67 2028  rface clipping (
+00051980: 6661 6365 7329 0d0a 2020 2020 2320 616e  faces)..    # an
+00051990: 6420 6c69 6e65 2063 6c69 7070 696e 6720  d line clipping 
+000519a0: 2876 6572 7469 6365 7329 2e0d 0a20 2020  (vertices)...   
+000519b0: 2076 6572 7473 203d 2072 6566 436f 6f72   verts = refCoor
+000519c0: 0d0a 2020 2020 6966 2063 496e 6465 7820  ..    if cIndex 
+000519d0: 3d3d 2031 203a 2020 2020 2020 2320 2e2e  == 1 :      # ..
+000519e0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+000519f0: 2e2e 2e20 6379 6c69 6e64 7269 6361 6c0d  ... cylindrical.
+00051a00: 0a20 2020 2020 2020 2069 6620 6469 7265  .        if dire
+00051a10: 6374 696f 6e20 6973 204e 6f6e 6520 3a0d  ction is None :.
+00051a20: 0a20 2020 2020 2020 2020 2020 2064 6f74  .            dot
+00051a30: 7072 6f64 203d 206e 702e 6c69 6e61 6c67  prod = np.linalg
+00051a40: 2e6e 6f72 6d28 7665 7274 735b 3a2c 3a32  .norm(verts[:,:2
+00051a50: 5d2c 6178 6973 3d31 2920 2023 207a 2d61  ],axis=1)  # z-a
+00051a60: 7869 7320 6465 6661 756c 740d 0a20 2020  xis default..   
+00051a70: 2020 2020 2065 6c73 6520 3a0d 0a20 2020       else :..   
+00051a80: 2020 2020 2020 2020 2075 6e69 7444 6972           unitDir
+00051a90: 6563 7469 6f6e 203d 206e 702e 6469 7669  ection = np.divi
+00051aa0: 6465 2820 6469 7265 6374 696f 6e2c 206e  de( direction, n
+00051ab0: 702e 6c69 6e61 6c67 2e6e 6f72 6d28 6469  p.linalg.norm(di
+00051ac0: 7265 6374 696f 6e29 2029 0d0a 2020 2020  rection) )..    
+00051ad0: 2020 2020 2020 2020 646d 6167 203d 206e          dmag = n
+00051ae0: 702e 646f 7428 7665 7274 732c 756e 6974  p.dot(verts,unit
+00051af0: 4469 7265 6374 696f 6e29 0d0a 2020 2020  Direction)..    
+00051b00: 2020 2020 2020 2020 7556 6563 7420 3d20          uVect = 
+00051b10: 6e70 2e74 696c 6528 756e 6974 4469 7265  np.tile(unitDire
+00051b20: 6374 696f 6e2c 286c 656e 2864 6d61 6729  ction,(len(dmag)
+00051b30: 2c31 2920 290d 0a20 2020 2020 2020 2020  ,1) )..         
+00051b40: 2020 2064 5665 6374 203d 206e 702e 6172     dVect = np.ar
+00051b50: 7261 7928 5b64 6d61 675d 292e 540d 0a20  ray([dmag]).T.. 
+00051b60: 2020 2020 2020 2020 2020 207a 6574 6120             zeta 
+00051b70: 3d20 7665 7274 7320 2d20 7556 6563 742a  = verts - uVect*
+00051b80: 6456 6563 740d 0a20 2020 2020 2020 2020  dVect..         
+00051b90: 2020 2064 6f74 7072 6f64 203d 206e 702e     dotprod = np.
+00051ba0: 6c69 6e61 6c67 2e6e 6f72 6d28 7a65 7461  linalg.norm(zeta
+00051bb0: 2c61 7869 733d 3129 200d 0a20 2020 2065  ,axis=1) ..    e
+00051bc0: 6c69 6620 6349 6e64 6578 203d 3d20 3220  lif cIndex == 2 
+00051bd0: 3a20 2020 2023 202e 2e2e 2e2e 2e2e 2e2e  :    # .........
+00051be0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2073 7068  ............ sph
+00051bf0: 6572 6963 616c 0d0a 2020 2020 2020 2020  erical..        
+00051c00: 646f 7470 726f 6420 3d20 6e70 2e6c 696e  dotprod = np.lin
+00051c10: 616c 672e 6e6f 726d 2876 6572 7473 2c61  alg.norm(verts,a
+00051c20: 7869 733d 3129 2020 2020 2020 2020 2020  xis=1)          
+00051c30: 200d 0a20 2020 2065 6c73 6520 3a20 2020   ..    else :   
+00051c40: 2020 2020 2020 2020 2020 2020 2023 202e               # .
+00051c50: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00051c60: 2e2e 2e2e 2070 6c61 6e61 720d 0a20 2020  .... planar..   
+00051c70: 2020 2020 2069 6620 6469 7265 6374 696f       if directio
+00051c80: 6e20 6973 204e 6f6e 6520 3a20 6469 7265  n is None : dire
+00051c90: 6374 696f 6e20 3d20 5b30 2c30 2c31 2e30  ction = [0,0,1.0
+00051ca0: 5d20 2023 2078 792d 706c 616e 6520 6465  ]  # xy-plane de
+00051cb0: 6661 756c 740d 0a20 2020 2020 2020 2075  fault..        u
+00051cc0: 6e69 7444 6972 6563 7469 6f6e 203d 206e  nitDirection = n
+00051cd0: 702e 6469 7669 6465 2820 6469 7265 6374  p.divide( direct
+00051ce0: 696f 6e2c 206e 702e 6c69 6e61 6c67 2e6e  ion, np.linalg.n
+00051cf0: 6f72 6d28 6469 7265 6374 696f 6e29 2029  orm(direction) )
+00051d00: 0d0a 2020 2020 2020 2020 646f 7470 726f  ..        dotpro
+00051d10: 6420 3d20 6e70 2e64 6f74 2876 6572 7473  d = np.dot(verts
+00051d20: 2c75 6e69 7444 6972 6563 7469 6f6e 290d  ,unitDirection).
+00051d30: 0a20 2020 2072 6574 7572 6e20 646f 7470  .    return dotp
+00051d40: 726f 640d 0a0d 0a64 6566 205f 6765 7446  rod....def _getF
+00051d50: 756e 6374 696f 6e4e 616d 6528 6f70 2c78  unctionName(op,x
+00051d60: 4e61 6d65 3d4e 6f6e 6529 203a 0d0a 2020  Name=None) :..  
+00051d70: 2020 6966 2078 4e61 6d65 2069 7320 6e6f    if xName is no
+00051d80: 7420 4e6f 6e65 203a 2072 6574 7572 6e20  t None : return 
+00051d90: 784e 616d 650d 0a20 2020 2023 2061 7373  xName..    # ass
+00051da0: 6967 6e20 6675 6e63 7469 6f6e 206e 616d  ign function nam
+00051db0: 6520 6966 206e 6f74 2061 206c 616d 6264  e if not a lambd
+00051dc0: 6120 6675 6e63 7469 6f6e 0d0a 2020 2020  a function..    
+00051dd0: 666f 6261 7220 3d20 6c61 6d62 6461 2078  fobar = lambda x
+00051de0: 203a 2078 0d0a 2020 2020 6966 206f 702e   : x..    if op.
+00051df0: 5f5f 6e61 6d65 5f5f 2021 3d20 666f 6261  __name__ != foba
+00051e00: 722e 5f5f 6e61 6d65 5f5f 203a 0d0a 2020  r.__name__ :..  
+00051e10: 2020 2020 2020 6e61 6d65 203d 206f 702e        name = op.
+00051e20: 5f5f 6e61 6d65 5f5f 0d0a 2020 2020 656c  __name__..    el
+00051e30: 7365 203a 0d0a 2020 2020 2020 2020 6e61  se :..        na
+00051e40: 6d65 203d 204e 6f6e 650d 0a20 2020 2072  me = None..    r
+00051e50: 6574 7572 6e20 6e61 6d65 0d0a 0d0a 6465  eturn name....de
+00051e60: 6620 5f73 6574 5f67 656f 6d42 6f75 6e64  f _set_geomBound
+00051e70: 7328 762c 626f 756e 6473 2920 3a0d 0a20  s(v,bounds) :.. 
+00051e80: 2020 2022 2222 5365 7420 5f62 6f75 6e64     """Set _bound
+00051e90: 7320 6469 6374 696f 6e61 7279 2076 616c  s dictionary val
+00051ea0: 7565 7320 6672 6f6d 2076 6572 7465 7820  ues from vertex 
+00051eb0: 636f 6f72 6469 6e61 7465 732e 2222 220d  coordinates.""".
+00051ec0: 0a0d 0a20 2020 2023 2076 203d 2073 656c  ...    # v = sel
+00051ed0: 662e 7665 7274 6578 436f 6f72 0d0a 2020  f.vertexCoor..  
+00051ee0: 2020 786c 696d 2c79 6c69 6d2c 7a6c 696d    xlim,ylim,zlim
+00051ef0: 203d 206e 702e 7472 616e 7370 6f73 6528   = np.transpose(
+00051f00: 205b 6e70 2e61 6d69 6e28 7620 2c61 7869   [np.amin(v ,axi
+00051f10: 733d 3029 2c20 6e70 2e61 6d61 7828 7620  s=0), np.amax(v 
+00051f20: 2c61 7869 733d 3029 205d 2029 0d0a 2020  ,axis=0) ] )..  
+00051f30: 2020 626f 756e 6473 5b27 786c 696d 275d    bounds['xlim']
+00051f40: 203d 2078 6c69 6d0d 0a20 2020 2062 6f75   = xlim..    bou
+00051f50: 6e64 735b 2779 6c69 6d27 5d20 3d20 796c  nds['ylim'] = yl
+00051f60: 696d 0d0a 2020 2020 626f 756e 6473 5b27  im..    bounds['
+00051f70: 7a6c 696d 275d 203d 207a 6c69 6d0d 0a20  zlim'] = zlim.. 
+00051f80: 2020 2072 6d61 785f 7879 203d 2020 6e70     rmax_xy =  np
+00051f90: 2e61 6d61 7828 206e 702e 6c69 6e61 6c67  .amax( np.linalg
+00051fa0: 2e6e 6f72 6d28 765b 3a2c 303a 325d 2c20  .norm(v[:,0:2], 
+00051fb0: 6178 6973 3d31 2920 290d 0a20 2020 2072  axis=1) )..    r
+00051fc0: 6d69 6e5f 7879 203d 2020 6e70 2e61 6d69  min_xy =  np.ami
+00051fd0: 6e28 206e 702e 6c69 6e61 6c67 2e6e 6f72  n( np.linalg.nor
+00051fe0: 6d28 765b 3a2c 303a 325d 2c20 6178 6973  m(v[:,0:2], axis
+00051ff0: 3d31 2920 290d 0a20 2020 2062 6f75 6e64  =1) )..    bound
+00052000: 735b 2772 5f78 7927 5d20 3d20 5b72 6d69  s['r_xy'] = [rmi
+00052010: 6e5f 7879 2c20 726d 6178 5f78 7920 5d20  n_xy, rmax_xy ] 
+00052020: 0d0a 2020 2020 726d 6178 5f78 797a 203d  ..    rmax_xyz =
+00052030: 206e 702e 616d 6178 2820 6e70 2e6c 696e   np.amax( np.lin
+00052040: 616c 672e 6e6f 726d 2876 2c20 6178 6973  alg.norm(v, axis
+00052050: 3d31 2920 290d 0a20 2020 2072 6d69 6e5f  =1) )..    rmin_
+00052060: 7879 7a20 3d20 6e70 2e61 6d69 6e28 206e  xyz = np.amin( n
+00052070: 702e 6c69 6e61 6c67 2e6e 6f72 6d28 762c  p.linalg.norm(v,
+00052080: 2061 7869 733d 3129 2029 0d0a 2020 2020   axis=1) )..    
+00052090: 626f 756e 6473 5b27 726f 7267 275d 203d  bounds['rorg'] =
+000520a0: 205b 726d 696e 5f78 797a 2c20 726d 6178   [rmin_xyz, rmax
+000520b0: 5f78 797a 205d 200d 0a20 2020 2062 6f75  _xyz ] ..    bou
+000520c0: 6e64 735b 2772 6c69 6d27 5d20 3d20 5b72  nds['rlim'] = [r
+000520d0: 6d61 785f 7879 2c20 726d 6178 5f78 797a  max_xy, rmax_xyz
+000520e0: 205d 2020 2320 2e2e 2076 6573 7469 6761   ]  # .. vestiga
+000520f0: 6c0d 0a20 2020 2072 6574 7572 6e20 2020  l..    return   
+00052100: 200d 0a0d 0a64 6566 205f 7363 616c 655f   ....def _scale_
+00052110: 6461 7461 6672 616d 6528 6f62 6a2c 582c  dataframe(obj,X,
+00052120: 592c 5a29 203a 0d0a 2020 2020 2222 220d  Y,Z) :..    """.
+00052130: 0a20 2020 204c 696e 6561 7220 7363 616c  .    Linear scal
+00052140: 6520 616e 6420 7472 616e 736c 6174 6520  e and translate 
+00052150: 7468 6520 6765 6f6d 6574 7279 2e0d 0a0d  the geometry....
+00052160: 0a20 2020 2055 7365 6420 666f 7220 7363  .    Used for sc
+00052170: 616c 696e 6720 6120 6765 6f6d 6574 7279  aling a geometry
+00052180: 2062 6173 6564 206f 6e20 6120 6461 7461   based on a data
+00052190: 6772 6964 2e0d 0a0d 0a20 2020 2050 6172  grid.....    Par
+000521a0: 616d 6574 6572 730d 0a20 2020 202d 2d2d  ameters..    ---
+000521b0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2058 2c20  -------..    X, 
+000521c0: 592c 205a 203a 2032 6420 6172 7261 7973  Y, Z : 2d arrays
+000521d0: 0d0a 2020 2020 2020 2020 4d69 6e69 6d75  ..        Minimu
+000521e0: 6d20 616e 6420 6d61 7869 6d75 6d20 7661  m and maximum va
+000521f0: 6c75 6573 206f 6620 7468 6520 6172 7261  lues of the arra
+00052200: 7973 2061 7265 2075 7365 6420 746f 2073  ys are used to s
+00052210: 6361 6c65 0d0a 2020 2020 2020 2020 616e  cale..        an
+00052220: 6420 7472 616e 736c 6174 6520 7468 6520  d translate the 
+00052230: 7375 7266 6163 6520 6672 6f6d 2061 6e20  surface from an 
+00052240: 696e 7469 616c 2064 6f6d 6169 6e20 6f66  intial domain of
+00052250: 0d0a 2020 2020 2020 2020 5b20 282d 312c  ..        [ (-1,
+00052260: 3129 2c20 282d 312c 3129 2c20 2830 2c31  1), (-1,1), (0,1
+00052270: 2920 5d0d 0a0d 0a20 2020 2052 6574 7572  ) ]....    Retur
+00052280: 6e73 0d0a 2020 2020 2d2d 2d2d 2d2d 2d0d  ns..    -------.
+00052290: 0a20 2020 206f 626a 203a 2020 6669 7273  .    obj :  firs
+000522a0: 7420 6361 6c6c 696e 6720 6172 6775 6d65  t calling argume
+000522b0: 6e74 2c20 6f62 6a65 6374 200d 0a0d 0a20  nt, object .... 
+000522c0: 2020 2022 2222 0d0a 0d0a 2020 2020 586d     """....    Xm
+000522d0: 696e 2c20 586d 6178 203d 206e 702e 616d  in, Xmax = np.am
+000522e0: 696e 2858 292c 206e 702e 616d 6178 2858  in(X), np.amax(X
+000522f0: 290d 0a20 2020 2059 6d69 6e2c 2059 6d61  )..    Ymin, Yma
+00052300: 7820 3d20 6e70 2e61 6d69 6e28 5929 2c20  x = np.amin(Y), 
+00052310: 6e70 2e61 6d61 7828 5929 0d0a 2020 2020  np.amax(Y)..    
+00052320: 5a6d 696e 2c20 5a6d 6178 203d 206e 702e  Zmin, Zmax = np.
+00052330: 616d 696e 285a 292c 206e 702e 616d 6178  amin(Z), np.amax
+00052340: 285a 290d 0a20 2020 2058 7363 616c 6520  (Z)..    Xscale 
+00052350: 3d20 2858 6d61 782d 586d 696e 292f 320d  = (Xmax-Xmin)/2.
+00052360: 0a20 2020 2058 3020 3d20 2858 6d61 782b  .    X0 = (Xmax+
+00052370: 586d 696e 292f 320d 0a20 2020 2059 7363  Xmin)/2..    Ysc
+00052380: 616c 6520 3d20 2859 6d61 782d 596d 696e  ale = (Ymax-Ymin
+00052390: 292f 320d 0a20 2020 2059 3020 3d20 2859  )/2..    Y0 = (Y
+000523a0: 6d61 782b 596d 696e 292f 320d 0a20 2020  max+Ymin)/2..   
+000523b0: 205a 7363 616c 6520 3d20 5a6d 6178 2d5a   Zscale = Zmax-Z
+000523c0: 6d69 6e0d 0a20 2020 205a 3020 3d20 5a6d  min..    Z0 = Zm
+000523d0: 696e 0d0a 2020 2020 6f62 6a2e 7472 616e  in..    obj.tran
+000523e0: 7366 6f72 6d28 7363 616c 653d 5b58 7363  sform(scale=[Xsc
+000523f0: 616c 652c 5973 6361 6c65 2c5a 7363 616c  ale,Yscale,Zscal
+00052400: 655d 2c74 7261 6e73 6c61 7465 3d5b 5830  e],translate=[X0
+00052410: 2c59 302c 5a30 5d29 0d0a 2020 2020 7265  ,Y0,Z0])..    re
+00052420: 7475 726e 206f 626a 0d0a 0d0a 6465 6620  turn obj....def 
+00052430: 5f74 7261 6e73 666f 726d 4178 6973 2873  _transformAxis(s
+00052440: 656c 6650 726f 702c 206c 656e 6d75 6c74  elfProp, lenmult
+00052450: 3d31 2e30 2c20 7769 6474 683d 312e 352c  =1.0, width=1.5,
+00052460: 2063 6f6c 6f72 733d 4e6f 6e65 2c20 6e65   colors=None, ne
+00052470: 6761 7869 733d 5472 7565 2920 3a0d 0a20  gaxis=True) :.. 
+00052480: 2020 2022 2222 0d0a 2020 2020 4c69 6e65     """..    Line
+00052490: 3344 436f 6c6c 6563 7469 6f6e 206f 6620  3DCollection of 
+000524a0: 6120 7472 616e 7366 6f72 6d65 6420 636f  a transformed co
+000524b0: 6f72 6469 6e61 7465 2061 7869 732e 0d0a  ordinate axis...
+000524c0: 2020 2020 0d0a 2020 2020 6a75 7374 2074      ..    just t
+000524d0: 616b 6520 6d65 7468 6f64 2066 726f 6d20  ake method from 
+000524e0: 7375 7266 6163 6520 7665 7273 696f 6e20  surface version 
+000524f0: 312e 3020 616e 6420 616c 6c6f 7720 7573  1.0 and allow us
+00052500: 6520 666f 7220 616c 6c0d 0a20 2020 206f  e for all..    o
+00052510: 7468 6572 2074 7261 6e73 666f 726d 6162  ther transformab
+00052520: 6c65 206f 626a 6563 7473 2e0d 0a20 2020  le objects...   
+00052530: 2043 616c 6c65 6420 6672 6f6d 2074 6865   Called from the
+00052540: 2069 6e74 6572 6661 6365 206d 6574 686f   interface metho
+00052550: 6420 6765 745f 7472 616e 7366 6f72 6d41  d get_transformA
+00052560: 7869 730d 0a20 2020 200d 0a20 2020 2052  xis..    ..    R
+00052570: 6574 7572 6e73 0d0a 2020 2020 2d2d 2d2d  eturns..    ----
+00052580: 2d2d 2d0d 0a20 2020 204c 696e 6533 4443  ---..    Line3DC
+00052590: 6f6c 6c65 6374 696f 6e0d 0a0d 0a20 2020  ollection....   
+000525a0: 2022 2222 0d0a 2020 2020 7365 6c66 5f73   """..    self_s
+000525b0: 6361 6c65 203d 2073 656c 6650 726f 705b  cale = selfProp[
+000525c0: 2773 6361 6c65 275d 0d0a 2020 2020 7365  'scale']..    se
+000525d0: 6c66 5f72 6f74 6174 696f 6e20 3d20 7365  lf_rotation = se
+000525e0: 6c66 5072 6f70 5b27 726f 7461 7469 6f6e  lfProp['rotation
+000525f0: 275d 0d0a 2020 2020 7365 6c66 5f74 7261  ']..    self_tra
+00052600: 6e73 6c61 7469 6f6e 203d 2073 656c 6650  nslation = selfP
+00052610: 726f 705b 2774 7261 6e73 6c61 7469 6f6e  rop['translation
+00052620: 275d 0d0a 2020 2020 7363 616c 6520 3d20  ']..    scale = 
+00052630: 6e70 2e6d 756c 7469 706c 7928 6c65 6e6d  np.multiply(lenm
+00052640: 756c 742c 7365 6c66 5f73 6361 6c65 290d  ult,self_scale).
+00052650: 0a20 2020 2064 4465 6c74 6120 3d20 6e70  .    dDelta = np
+00052660: 2e6d 756c 7469 706c 7928 6e70 2e69 6465  .multiply(np.ide
+00052670: 6e74 6974 7928 3329 2e74 6f6c 6973 7428  ntity(3).tolist(
+00052680: 292c 7363 616c 6529 2e74 6f6c 6973 7428  ),scale).tolist(
+00052690: 290d 0a20 2020 206e 7064 6f74 203d 206e  )..    npdot = n
+000526a0: 702e 646f 7428 6444 656c 7461 2c73 656c  p.dot(dDelta,sel
+000526b0: 665f 726f 7461 7469 6f6e 290d 0a20 2020  f_rotation)..   
+000526c0: 206e 7064 6f74 3220 3d20 6e70 2e65 7870   npdot2 = np.exp
+000526d0: 616e 645f 6469 6d73 286e 7064 6f74 2c61  and_dims(npdot,a
+000526e0: 7869 733d 3129 0d0a 2020 2020 6966 206e  xis=1)..    if n
+000526f0: 6567 6178 6973 203a 0d0a 2020 2020 2020  egaxis :..      
+00052700: 2020 6c69 6e65 7320 3d20 6e70 2e63 6f6e    lines = np.con
+00052710: 6361 7465 6e61 7465 2820 286e 7064 6f74  catenate( (npdot
+00052720: 322c 2d6e 7064 6f74 3229 2c61 7869 733d  2,-npdot2),axis=
+00052730: 3129 0d0a 2020 2020 656c 7365 203a 0d0a  1)..    else :..
+00052740: 2020 2020 2020 2020 6c69 6e65 7320 3d20          lines = 
+00052750: 6e70 2e69 6e73 6572 7428 6e70 646f 7432  np.insert(npdot2
+00052760: 2c30 2c5b 302c 302c 305d 2c61 7869 733d  ,0,[0,0,0],axis=
+00052770: 3129 0d0a 2020 2020 6c69 6e65 7320 3d20  1)..    lines = 
+00052780: 6e70 2e61 6464 286c 696e 6573 2c73 656c  np.add(lines,sel
+00052790: 665f 7472 616e 736c 6174 696f 6e29 0d0a  f_translation)..
+000527a0: 2020 2020 6966 2063 6f6c 6f72 7320 6973      if colors is
+000527b0: 204e 6f6e 6520 3a20 0d0a 2020 2020 2020   None : ..      
+000527c0: 2020 636f 6c6f 724d 6170 203d 205b 2772    colorMap = ['r
+000527d0: 272c 2767 272c 2762 275d 0d0a 2020 2020  ','g','b']..    
+000527e0: 656c 7365 203a 0d0a 2020 2020 2020 2020  else :..        
+000527f0: 636f 6c6f 724d 6170 203d 2063 6f6c 6f72  colorMap = color
+00052800: 730d 0a20 2020 2061 7869 7343 6f6c 203d  s..    axisCol =
+00052810: 204c 696e 6533 4443 6f6c 6c65 6374 696f   Line3DCollectio
+00052820: 6e28 6c69 6e65 732c 2063 6f6c 6f72 733d  n(lines, colors=
+00052830: 636f 6c6f 724d 6170 2c20 6c69 6e65 7769  colorMap, linewi
+00052840: 6474 6873 3d77 6964 7468 290d 0a20 2020  dths=width)..   
+00052850: 2072 6574 7572 6e20 6178 6973 436f 6c20   return axisCol 
+00052860: 2020 2020 200d 0a0d 0a64 6566 205f 6e6f       ....def _no
+00052870: 726d 4c65 6e67 7468 2820 4e2c 2065 7870  rmLength( N, exp
+00052880: 2c20 6661 632c 206c 696d 6974 6172 6561  , fac, limitarea
+00052890: 3d4e 6f6e 6529 203a 0d0a 2020 2020 2222  =None) :..    ""
+000528a0: 220d 0a20 2020 2044 6566 6175 6c74 2066  "..    Default f
+000528b0: 6163 6520 6e6f 726d 616c 2076 6563 746f  ace normal vecto
+000528c0: 7220 6c65 6e67 7468 2e0d 0a20 2020 200d  r length...    .
+000528d0: 0a20 2020 204c 656e 6774 6820 7072 6f70  .    Length prop
+000528e0: 6f72 7469 6f6e 616c 2074 6f20 7468 6520  ortional to the 
+000528f0: 6d65 616e 2074 7269 616e 6775 6c61 7465  mean triangulate
+00052900: 6420 6661 6365 2065 6467 6520 6c65 6e67  d face edge leng
+00052910: 7468 2e0d 0a20 2020 2022 2222 0d0a 2020  th...    """..  
+00052920: 2020 6966 206c 696d 6974 6172 6561 2069    if limitarea i
+00052930: 7320 4e6f 6e65 203a 206c 696d 6974 6172  s None : limitar
+00052940: 6561 203d 2034 2a6e 702e 7069 0d0a 2020  ea = 4*np.pi..  
+00052950: 2020 2320 6172 6174 696f 202d 2061 7265    # aratio - are
+00052960: 6120 7261 7469 6f20 6173 2061 2066 756e  a ratio as a fun
+00052970: 6374 696f 6e20 6f66 2074 6865 206e 756d  ction of the num
+00052980: 6265 7220 6f66 2066 6163 6573 2c20 4e2e  ber of faces, N.
+00052990: 0d0a 2020 2020 2320 6865 7572 6973 7469  ..    # heuristi
+000529a0: 6320 7661 6c75 6573 2c20 6578 7020 616e  c values, exp an
+000529b0: 6420 6661 632c 2061 7265 2061 646a 7573  d fac, are adjus
+000529c0: 746d 656e 7420 666f 7220 736d 616c 6c20  tment for small 
+000529d0: 7265 7a20 7375 7266 6163 6573 2c0d 0a20  rez surfaces,.. 
+000529e0: 2020 2023 2077 6974 6820 6172 6174 696f     # with aratio
+000529f0: 206c 696d 6974 2074 6f20 3120 666f 7220   limit to 1 for 
+00052a00: 6c61 7267 6520 4e2e 2028 636f 6e74 696e  large N. (contin
+00052a10: 756f 7573 2073 6d6f 6f74 6820 7375 7266  uous smooth surf
+00052a20: 6163 6529 0d0a 2020 2020 6172 6174 696f  ace)..    aratio
+00052a30: 203d 2031 2e30 202d 2066 6163 2a6e 702e   = 1.0 - fac*np.
+00052a40: 706f 7765 7228 4e2c 2d65 7870 290d 0a20  power(N,-exp).. 
+00052a50: 2020 2073 6320 3d20 302e 352a 2831 2e35     sc = 0.5*(1.5
+00052a60: 3230 2920 2023 2073 6361 6c65 206f 6620  20)  # scale of 
+00052a70: 6e6f 726d 616c 697a 6564 2065 6467 6520  normalized edge 
+00052a80: 6c65 6e67 7468 0d0a 2020 2020 6e4c 656e  length..    nLen
+00052a90: 203d 2073 632a 6e70 2e73 7172 7428 6172   = sc*np.sqrt(ar
+00052aa0: 6174 696f 2a6c 696d 6974 6172 6561 2f4e  atio*limitarea/N
+00052ab0: 290d 0a20 2020 2072 6574 7572 6e20 6e4c  )..    return nL
+00052ac0: 656e 0d0a 0d0a 0d0a 0d0a 2320 3d3d 3d3d  en........# ====
+00052ad0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00052ae0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00052af0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00052b00: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00052b10: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d2b 0d0a  =============+..
+00052b20: 2320 5574 696c 6974 7920 4675 6e63 7469  # Utility Functi
+00052b30: 6f6e 733a 2020 2020 2020 2020 2020 2020  ons:            
+00052b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00052b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00052b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00052b70: 2020 207c 0d0a 2320 5573 6566 756c 2066     |..# Useful f
+00052b80: 6f72 2063 6f6e 7374 7275 6374 696f 6e20  or construction 
+00052b90: 6f66 2033 4420 4d61 7470 6c6f 746c 6962  of 3D Matplotlib
+00052ba0: 2066 6967 7572 6573 2063 6f6d 706f 7365   figures compose
+00052bb0: 6420 6f66 2053 3344 6c69 6220 6f62 6a65  d of S3Dlib obje
+00052bc0: 6374 732e 2020 2020 207c 0d0a 2320 3d3d  cts.     |..# ==
+00052bd0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00052be0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00052bf0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00052c00: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00052c10: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d2b  ===============+
+00052c20: 0d0a 0d0a 6465 6620 7365 7475 7041 7869  ....def setupAxi
+00052c30: 7328 6178 6573 2c20 2a2a 6b61 7267 7320  s(axes, **kargs 
+00052c40: 2920 3a0d 0a20 2020 2022 2222 0d0a 2020  ) :..    """..  
+00052c50: 2020 4164 6420 5859 5a20 6f72 6967 696e    Add XYZ origin
+00052c60: 2063 6f6f 7264 696e 6174 6520 6178 6973   coordinate axis
+00052c70: 2056 6563 746f 7233 4443 6f6c 6c65 6374   Vector3DCollect
+00052c80: 696f 6e20 746f 2074 6865 2061 7865 732e  ion to the axes.
+00052c90: 0d0a 0d0a 2020 2020 5061 7261 6d65 7465  ....    Paramete
+00052ca0: 7273 0d0a 2020 2020 2d2d 2d2d 2d2d 2d2d  rs..    --------
+00052cb0: 2d2d 0d0a 2020 2020 6178 6573 203a 204d  --..    axes : M
+00052cc0: 6174 706c 6f74 6c69 6220 3344 2061 7865  atplotlib 3D axe
+00052cd0: 7320 6f62 6a65 6374 2e0d 0a0d 0a20 2020  s object.....   
+00052ce0: 206c 656e 6774 6820 203a 2063 6f6f 7264   length  : coord
+00052cf0: 696e 6174 6520 6178 6973 206c 656e 6774  inate axis lengt
+00052d00: 6820 2873 696e 676c 6520 6f72 2033 2d76  h (single or 3-v
+00052d10: 616c 7565 206c 6973 7429 2c20 6465 6661  alue list), defa
+00052d20: 756c 743a 2031 2e35 0d0a 0d0a 2020 2020  ult: 1.5....    
+00052d30: 636f 6c6f 7220 2020 3a20 6178 6973 2063  color   : axis c
+00052d40: 6f6c 6f72 2028 7369 6e67 6c65 206f 7220  olor (single or 
+00052d50: 332d 7661 6c75 6520 6c69 7374 292c 2064  3-value list), d
+00052d60: 6566 6175 6c74 3a20 2762 6c61 636b 270d  efault: 'black'.
+00052d70: 0a0d 0a20 2020 206f 6666 7365 7420 203a  ...    offset  :
+00052d80: 2061 7869 7320 7665 6374 6f72 206f 6666   axis vector off
+00052d90: 7365 7420 6672 6f6d 2074 6865 206f 7269  set from the ori
+00052da0: 6769 6e20 2873 696e 676c 6520 6f72 2033  gin (single or 3
+00052db0: 2d76 616c 7565 206c 6973 7429 2c20 6465  -value list), de
+00052dc0: 6661 756c 743a 2030 0d0a 0d0a 2020 2020  fault: 0....    
+00052dd0: 6c61 6265 6c73 2020 3a20 6178 6973 206c  labels  : axis l
+00052de0: 6162 656c 2028 7369 6e67 6c65 206f 7220  abel (single or 
+00052df0: 332d 7661 6c75 6520 6c69 7374 292c 2064  3-value list), d
+00052e00: 6566 6175 6c74 3a20 5b27 5827 2c27 5927  efault: ['X','Y'
+00052e10: 2c27 5a27 5d0d 0a0d 0a20 2020 2070 6164  ,'Z']....    pad
+00052e20: 2020 2020 203a 206c 6162 656c 2070 6164       : label pad
+00052e30: 6469 6e67 2066 726f 6d20 7468 6520 7665  ding from the ve
+00052e40: 6374 6f72 2061 7869 7320 6865 6164 2028  ctor axis head (
+00052e50: 7369 6e67 6c65 206f 7220 332d 7661 6c75  single or 3-valu
+00052e60: 6520 6c69 7374 292c 2064 6566 6175 6c74  e list), default
+00052e70: 3a20 302e 3135 0d0a 0d0a 2020 2020 7769  : 0.15....    wi
+00052e80: 6474 6820 2020 3a20 6178 6973 206c 696e  dth   : axis lin
+00052e90: 6520 7769 6474 6873 2c20 6465 6661 756c  e widths, defaul
+00052ea0: 743a 2032 0d0a 0d0a 2020 2020 6e65 6761  t: 2....    nega
+00052eb0: 7869 7320 3a20 7368 6f77 206e 6567 6174  xis : show negat
+00052ec0: 6976 6520 6178 6973 206c 696e 652c 2064  ive axis line, d
+00052ed0: 6566 6175 6c74 3a20 4661 6c73 650d 0a0d  efault: False...
+00052ee0: 0a20 2020 2061 6c72 2020 2020 203a 2061  .    alr     : a
+00052ef0: 7869 7320 6c65 6e67 7468 2072 6174 696f  xis length ratio
+00052f00: 2c20 6865 6164 2073 697a 6520 746f 2061  , head size to a
+00052f10: 7869 7320 6c65 6e67 7468 2c20 6465 6661  xis length, defa
+00052f20: 756c 743a 2030 2e32 0d0a 0d0a 2020 2020  ult: 0.2....    
+00052f30: 5265 7475 726e 730d 0a20 2020 202d 2d2d  Returns..    ---
+00052f40: 2d2d 2d2d 0d0a 2020 2020 6178 6573 0d0a  ----..    axes..
+00052f50: 0d0a 2020 2020 2222 220d 0a0d 0a20 2020  ..    """....   
+00052f60: 206b 6172 6744 6674 203d 207b 2027 6c65   kargDft = { 'le
+00052f70: 6e67 7468 273a 2031 2e35 2c20 2763 6f6c  ngth': 1.5, 'col
+00052f80: 6f72 273a 276b 272c 2027 6c61 6265 6c73  or':'k', 'labels
+00052f90: 273a 5b27 5827 2c27 5927 2c27 5a27 5d2c  ':['X','Y','Z'],
+00052fa0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00052fb0: 2020 276f 6666 7365 7427 3a30 2e30 2c20    'offset':0.0, 
+00052fc0: 2770 6164 273a 2030 2e31 352c 2027 7769  'pad': 0.15, 'wi
+00052fd0: 6474 6827 3a32 2c20 2761 6c72 273a 302e  dth':2, 'alr':0.
+00052fe0: 322c 2027 6e65 6761 7869 7327 3a46 616c  2, 'negaxis':Fal
+00052ff0: 7365 7d0d 0a20 2020 204b 5720 3d20 4b57  se}..    KW = KW
+00053000: 7072 6f63 6573 736f 7228 6b61 7267 4466  processor(kargDf
+00053010: 742c 2773 6574 7570 4178 6973 272c 2a2a  t,'setupAxis',**
+00053020: 6b61 7267 7329 0d0a 2020 2020 6c65 6e67  kargs)..    leng
+00053030: 7468 203d 204b 572e 6765 7456 616c 2827  th = KW.getVal('
+00053040: 6c65 6e67 7468 2729 0d0a 2020 2020 636f  length')..    co
+00053050: 6c6f 7220 3d20 4b57 2e67 6574 5661 6c28  lor = KW.getVal(
+00053060: 2763 6f6c 6f72 2729 0d0a 2020 2020 6f66  'color')..    of
+00053070: 6673 6574 203d 204b 572e 6765 7456 616c  fset = KW.getVal
+00053080: 2827 6f66 6673 6574 2729 0d0a 2020 2020  ('offset')..    
+00053090: 6c61 6265 6c73 203d 204b 572e 6765 7456  labels = KW.getV
+000530a0: 616c 2827 6c61 6265 6c73 2729 0d0a 2020  al('labels')..  
+000530b0: 2020 7061 6420 3d20 4b57 2e67 6574 5661    pad = KW.getVa
+000530c0: 6c28 2770 6164 2729 0d0a 2020 2020 7769  l('pad')..    wi
+000530d0: 6474 6820 3d20 4b57 2e67 6574 5661 6c28  dth = KW.getVal(
+000530e0: 2777 6964 7468 2729 0d0a 2020 2020 6e65  'width')..    ne
+000530f0: 6761 7869 7320 3d20 4b57 2e67 6574 5661  gaxis = KW.getVa
+00053100: 6c28 276e 6567 6178 6973 2729 0d0a 2020  l('negaxis')..  
+00053110: 2020 616c 7220 3d20 4b57 2e67 6574 5661    alr = KW.getVa
+00053120: 6c28 2761 6c72 2729 0d0a 2020 2020 0d0a  l('alr')..    ..
+00053130: 2020 2020 2320 4e6f 7465 3a20 6e6f 7420      # Note: not 
+00053140: 6368 6563 6b69 6e67 2061 7272 6179 206c  checking array l
+00053150: 656e 6774 683d 3d33 2c20 6f72 2061 2076  ength==3, or a v
+00053160: 616c 6964 2063 6f6c 6f72 2e0d 0a20 2020  alid color...   
+00053170: 2069 6620 636f 6c6f 7220 6973 204e 6f6e   if color is Non
+00053180: 6520 3a20 636f 6c6f 723d 276b 270d 0a20  e : color='k'.. 
+00053190: 2020 2069 6620 6e6f 7420 636f 6c6f 7273     if not colors
+000531a0: 2e69 735f 636f 6c6f 725f 6c69 6b65 2863  .is_color_like(c
+000531b0: 6f6c 6f72 2920 3a20 2023 2063 6865 636b  olor) :  # check
+000531c0: 2069 6620 6172 6720 6973 2061 2063 6f6c   if arg is a col
+000531d0: 6f72 2061 7272 6179 2c20 6e6f 7420 616e  or array, not an
+000531e0: 2061 7272 6179 206f 6620 636f 6c6f 7273   array of colors
+000531f0: 200d 0a20 2020 2020 2020 2063 6f6c 6f72   ..        color
+00053200: 203d 206e 702e 6172 7261 7920 2820 5b63   = np.array ( [c
+00053210: 6f6c 6f72 732e 746f 5f72 6762 6128 636f  olors.to_rgba(co
+00053220: 6c6f 725b 305d 292c 2063 6f6c 6f72 732e  lor[0]), colors.
+00053230: 746f 5f72 6762 6128 636f 6c6f 725b 315d  to_rgba(color[1]
+00053240: 292c 2063 6f6c 6f72 732e 746f 5f72 6762  ), colors.to_rgb
+00053250: 6128 636f 6c6f 725b 325d 2920 205d 2029  a(color[2])  ] )
+00053260: 0d0a 2020 2020 656c 7365 203a 0d0a 2020  ..    else :..  
+00053270: 2020 2020 2020 636f 6c6f 7220 3d20 6e70        color = np
+00053280: 2e61 7272 6179 2028 205b 636f 6c6f 7273  .array ( [colors
+00053290: 2e74 6f5f 7267 6261 2863 6f6c 6f72 292c  .to_rgba(color),
+000532a0: 2063 6f6c 6f72 732e 746f 5f72 6762 6128   colors.to_rgba(
+000532b0: 636f 6c6f 7229 2c20 636f 6c6f 7273 2e74  color), colors.t
+000532c0: 6f5f 7267 6261 2863 6f6c 6f72 295d 2020  o_rgba(color)]  
+000532d0: 290d 0a0d 0a20 2020 2069 6620 6e6f 7420  )....    if not 
+000532e0: 6973 696e 7374 616e 6365 286c 656e 6774  isinstance(lengt
+000532f0: 682c 286c 6973 742c 7475 706c 652c 6e70  h,(list,tuple,np
+00053300: 2e6e 6461 7272 6179 2929 203a 206c 656e  .ndarray)) : len
+00053310: 6774 6820 3d20 205b 6c65 6e67 7468 2c6c  gth =  [length,l
+00053320: 656e 6774 682c 6c65 6e67 7468 5d20 0d0a  ength,length] ..
+00053330: 2020 2020 6c65 6e67 7468 3d6e 702e 6172      length=np.ar
+00053340: 7261 7928 6c65 6e67 7468 290d 0a0d 0a20  ray(length).... 
+00053350: 2020 2069 6620 6e6f 7420 6973 696e 7374     if not isinst
+00053360: 616e 6365 286f 6666 7365 742c 286c 6973  ance(offset,(lis
+00053370: 742c 7475 706c 652c 6e70 2e6e 6461 7272  t,tuple,np.ndarr
+00053380: 6179 2929 203a 2020 6f66 6673 6574 203d  ay)) :  offset =
+00053390: 205b 6f66 6673 6574 2c6f 6666 7365 742c   [offset,offset,
+000533a0: 6f66 6673 6574 5d0d 0a20 2020 206f 6666  offset]..    off
+000533b0: 7365 7420 3d20 6e70 2e61 7272 6179 286f  set = np.array(o
+000533c0: 6666 7365 7429 0d0a 0d0a 2020 2020 6966  ffset)....    if
+000533d0: 206c 6162 656c 7320 6973 204e 6f6e 6520   labels is None 
+000533e0: 3a20 6c61 6265 6c73 203d 205b 2758 272c  : labels = ['X',
+000533f0: 2759 272c 275a 275d 0d0a 2020 2020 6966  'Y','Z']..    if
+00053400: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
+00053410: 6c61 6265 6c73 2c28 6c69 7374 2c74 7570  labels,(list,tup
+00053420: 6c65 2c6e 702e 6e64 6172 7261 7929 2920  le,np.ndarray)) 
+00053430: 3a20 206c 6162 656c 7320 3d20 5b6c 6162  :  labels = [lab
+00053440: 656c 732c 6c61 6265 6c73 2c6c 6162 656c  els,labels,label
+00053450: 735d 0d0a 2020 2020 0d0a 2020 2020 6966  s]..    ..    if
+00053460: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
+00053470: 7061 642c 286c 6973 742c 7475 706c 652c  pad,(list,tuple,
+00053480: 6e70 2e6e 6461 7272 6179 2929 203a 2020  np.ndarray)) :  
+00053490: 7061 6420 3d20 5b70 6164 2c70 6164 2c70  pad = [pad,pad,p
+000534a0: 6164 5d0d 0a20 2020 2070 6164 203d 206e  ad]..    pad = n
+000534b0: 702e 6172 7261 7928 7061 6429 0d0a 0d0a  p.array(pad)....
+000534c0: 2020 2020 2222 2253 6574 2058 595a 206f      """Set XYZ o
+000534d0: 7269 6769 6e20 636f 6f72 6469 6e61 7465  rigin coordinate
+000534e0: 2061 7869 7320 6172 726f 7773 2e22 2222   axis arrows."""
+000534f0: 0d0a 2020 2020 7365 676c 656e 6774 6820  ..    seglength 
+00053500: 3d20 6c65 6e67 7468 2d6f 6666 7365 740d  = length-offset.
+00053510: 0a20 2020 2065 6e64 436f 6f72 203d 206e  .    endCoor = n
+00053520: 702e 6d75 6c74 6970 6c79 286e 702e 6964  p.multiply(np.id
+00053530: 656e 7469 7479 2833 292c 7365 676c 656e  entity(3),seglen
+00053540: 6774 6829 0d0a 2020 2020 7374 7243 6f6f  gth)..    strCoo
+00053550: 7220 3d20 6e70 2e6d 756c 7469 706c 7928  r = np.multiply(
+00053560: 6e70 2e69 6465 6e74 6974 7928 3329 2c6f  np.identity(3),o
+00053570: 6666 7365 7429 0d0a 0d0a 2020 2020 7879  ffset)....    xy
+00053580: 7a20 3d20 6e70 2e74 7261 6e73 706f 7365  z = np.transpose
+00053590: 2820 7374 7243 6f6f 7220 290d 0a20 2020  ( strCoor )..   
+000535a0: 2075 7677 203d 206e 702e 7472 616e 7370   uvw = np.transp
+000535b0: 6f73 6528 2065 6e64 436f 6f72 2029 0d0a  ose( endCoor )..
+000535c0: 2020 2020 7663 6620 3d20 5665 6374 6f72      vcf = Vector
+000535d0: 3344 436f 6c6c 6563 7469 6f6e 2878 797a  3DCollection(xyz
+000535e0: 2c75 7677 2c61 6c72 3d61 6c72 2c20 636f  ,uvw,alr=alr, co
+000535f0: 6c6f 723d 636f 6c6f 725b 305d 2c20 6c69  lor=color[0], li
+00053600: 6e65 7769 6474 683d 7769 6474 6829 0d0a  newidth=width)..
+00053610: 2020 2020 7663 662e 5f73 6574 5f76 6563      vcf._set_vec
+00053620: 7443 6f6c 6f72 2863 6f6c 6f72 290d 0a20  tColor(color).. 
+00053630: 2020 2061 7865 732e 6164 645f 636f 6c6c     axes.add_coll
+00053640: 6563 7469 6f6e 3364 2820 7663 6620 290d  ection3d( vcf ).
+00053650: 0a0d 0a20 2020 2069 6620 6e65 6761 7869  ...    if negaxi
+00053660: 7320 3a0d 0a20 2020 2020 2020 2065 6e64  s :..        end
+00053670: 436f 6f72 203d 206e 702e 6d75 6c74 6970  Coor = np.multip
+00053680: 6c79 286e 702e 6964 656e 7469 7479 2833  ly(np.identity(3
+00053690: 292c 202d 312e 302a 6c65 6e67 7468 290d  ), -1.0*length).
+000536a0: 0a20 2020 2020 2020 2073 7472 436f 6f72  .        strCoor
+000536b0: 203d 206e 702e 6d75 6c74 6970 6c79 286e   = np.multiply(n
+000536c0: 702e 6964 656e 7469 7479 2833 292c 202d  p.identity(3), -
+000536d0: 312e 302a 6f66 6673 6574 290d 0a20 2020  1.0*offset)..   
+000536e0: 2020 2020 2078 797a 203d 206e 702e 7472       xyz = np.tr
+000536f0: 616e 7370 6f73 6528 2073 7472 436f 6f72  anspose( strCoor
+00053700: 2029 0d0a 2020 2020 2020 2020 7576 7720   )..        uvw 
+00053710: 3d20 6e70 2e74 7261 6e73 706f 7365 2820  = np.transpose( 
+00053720: 656e 6443 6f6f 7220 290d 0a20 2020 2020  endCoor )..     
+00053730: 2020 2076 6572 7465 7843 6f6f 7220 3d20     vertexCoor = 
+00053740: 6e70 2e63 6f6e 6361 7465 6e61 7465 2820  np.concatenate( 
+00053750: 2865 6e64 436f 6f72 2c73 7472 436f 6f72  (endCoor,strCoor
+00053760: 292c 6178 6973 3d30 2029 0d0a 2020 2020  ),axis=0 )..    
+00053770: 2020 2020 7365 676d 496e 6469 6365 7320      segmIndices 
+00053780: 3d20 5b20 5b30 2c33 5d2c 5b31 2c34 5d2c  = [ [0,3],[1,4],
+00053790: 5b32 2c35 5d20 5d0d 0a20 2020 2020 2020  [2,5] ]..       
+000537a0: 206c 696e 6520 3d20 436f 6c6f 724c 696e   line = ColorLin
+000537b0: 6533 4443 6f6c 6c65 6374 696f 6e28 7665  e3DCollection(ve
+000537c0: 7274 6578 436f 6f72 2c73 6567 6d49 6e64  rtexCoor,segmInd
+000537d0: 6963 6573 2c20 636f 6c6f 723d 636f 6c6f  ices, color=colo
+000537e0: 722c 206c 696e 6577 6964 7468 3d77 6964  r, linewidth=wid
+000537f0: 7468 290d 0a20 2020 2020 2020 2061 7865  th)..        axe
+00053800: 732e 6164 645f 636f 6c6c 6563 7469 6f6e  s.add_collection
+00053810: 3364 2820 6c69 6e65 2029 0d0a 0d0a 2020  3d( line )....  
+00053820: 2020 706f 7320 3d20 6c65 6e67 7468 202b    pos = length +
+00053830: 2070 6164 0d0a 2020 2020 6178 6573 2e74   pad..    axes.t
+00053840: 6578 7428 706f 735b 305d 2c30 2c30 2c6c  ext(pos[0],0,0,l
+00053850: 6162 656c 735b 305d 2c20 636f 6c6f 7220  abels[0], color 
+00053860: 3d20 636f 6c6f 725b 305d 2c20 666f 6e74  = color[0], font
+00053870: 7765 6967 6874 3d27 626f 6c64 272c 2066  weight='bold', f
+00053880: 6f6e 7473 697a 653d 276c 6172 6765 272c  ontsize='large',
+00053890: 0d0a 2020 2020 2020 2020 2020 2020 686f  ..            ho
+000538a0: 7269 7a6f 6e74 616c 616c 6967 6e6d 656e  rizontalalignmen
+000538b0: 743d 2763 656e 7465 7227 2c20 7665 7274  t='center', vert
+000538c0: 6963 616c 616c 6967 6e6d 656e 743d 2763  icalalignment='c
+000538d0: 656e 7465 7227 290d 0a20 2020 2061 7865  enter')..    axe
+000538e0: 732e 7465 7874 2830 2c70 6f73 5b31 5d2c  s.text(0,pos[1],
+000538f0: 302c 6c61 6265 6c73 5b31 5d2c 2063 6f6c  0,labels[1], col
+00053900: 6f72 203d 2063 6f6c 6f72 5b31 5d2c 2066  or = color[1], f
+00053910: 6f6e 7477 6569 6768 743d 2762 6f6c 6427  ontweight='bold'
+00053920: 2c20 666f 6e74 7369 7a65 3d27 6c61 7267  , fontsize='larg
+00053930: 6527 2c0d 0a20 2020 2020 2020 2020 2020  e',..           
+00053940: 2068 6f72 697a 6f6e 7461 6c61 6c69 676e   horizontalalign
+00053950: 6d65 6e74 3d27 6365 6e74 6572 272c 2076  ment='center', v
+00053960: 6572 7469 6361 6c61 6c69 676e 6d65 6e74  erticalalignment
+00053970: 3d27 6365 6e74 6572 2729 0d0a 2020 2020  ='center')..    
+00053980: 6178 6573 2e74 6578 7428 302c 302c 706f  axes.text(0,0,po
+00053990: 735b 325d 2c6c 6162 656c 735b 325d 2c20  s[2],labels[2], 
+000539a0: 636f 6c6f 7220 3d20 636f 6c6f 725b 325d  color = color[2]
+000539b0: 2c20 666f 6e74 7765 6967 6874 3d27 626f  , fontweight='bo
+000539c0: 6c64 272c 2066 6f6e 7473 697a 653d 276c  ld', fontsize='l
+000539d0: 6172 6765 272c 0d0a 2020 2020 2020 2020  arge',..        
+000539e0: 2020 2020 686f 7269 7a6f 6e74 616c 616c      horizontalal
+000539f0: 6967 6e6d 656e 743d 2763 656e 7465 7227  ignment='center'
+00053a00: 2c20 7665 7274 6963 616c 616c 6967 6e6d  , verticalalignm
+00053a10: 656e 743d 2763 656e 7465 7227 290d 0a20  ent='center').. 
+00053a20: 2020 2072 6574 7572 6e20 6178 6573 2020     return axes  
+00053a30: 2020 200d 0a0d 0a64 6566 2073 7461 6e64     ....def stand
+00053a40: 6172 6441 7869 7328 2061 7865 732c 202a  ardAxis( axes, *
+00053a50: 2a6b 6172 6773 2029 203a 0d0a 2020 2020  *kargs ) :..    
+00053a60: 2222 220d 0a20 2020 2041 6464 2058 595a  """..    Add XYZ
+00053a70: 206f 7269 6769 6e20 636f 6f72 6469 6e61   origin coordina
+00053a80: 7465 2061 7869 7320 5665 6374 6f72 3344  te axis Vector3D
+00053a90: 436f 6c6c 6563 7469 6f6e 2061 6e64 0d0a  Collection and..
+00053aa0: 2020 2020 7365 7420 7468 6520 6178 6973      set the axis
+00053ab0: 2076 6965 7769 6e67 2061 6e67 6c65 2c20   viewing angle, 
+00053ac0: 7072 6f6a 6563 7469 6f6e 2074 7970 6520  projection type 
+00053ad0: 616e 6420 636c 6561 7220 706c 616e 6573  and clear planes
+00053ae0: 2e0d 0a20 2020 200d 0a20 2020 2050 6172  ...    ..    Par
+00053af0: 616d 6574 6572 730d 0a20 2020 202d 2d2d  ameters..    ---
+00053b00: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2061 7865  -------..    axe
+00053b10: 7320 3a20 4d61 7470 6c6f 746c 6962 2033  s : Matplotlib 3
+00053b20: 4420 6178 6573 206f 626a 6563 742e 0d0a  D axes object...
+00053b30: 0d0a 2020 2020 6b61 7267 733a 2069 6465  ..    kargs: ide
+00053b40: 6e74 6963 616c 2074 6f20 7468 6f73 6520  ntical to those 
+00053b50: 666f 7220 7365 7475 7041 7869 7320 6675  for setupAxis fu
+00053b60: 6e63 7469 6f6e 2e0d 0a0d 0a20 2020 2052  nction.....    R
+00053b70: 6574 7572 6e73 0d0a 2020 2020 2d2d 2d2d  eturns..    ----
+00053b80: 2d2d 2d0d 0a20 2020 2061 7865 730d 0a20  ---..    axes.. 
+00053b90: 2020 200d 0a20 2020 2022 2222 0d0a 2020     ..    """..  
+00053ba0: 2020 7365 7475 7041 7869 7328 6178 6573    setupAxis(axes
+00053bb0: 2c20 2a2a 6b61 7267 7329 0d0a 2020 2020  , **kargs)..    
+00053bc0: 6d69 6e6d 6178 203d 2028 2d31 2c31 290d  minmax = (-1,1).
+00053bd0: 0a20 2020 2061 7865 732e 7365 7428 786c  .    axes.set(xl
+00053be0: 696d 3d6d 696e 6d61 782c 2079 6c69 6d3d  im=minmax, ylim=
+00053bf0: 6d69 6e6d 6178 2c20 7a6c 696d 3d6d 696e  minmax, zlim=min
+00053c00: 6d61 7829 0d0a 2020 2020 6178 6573 2e76  max)..    axes.v
+00053c10: 6965 775f 696e 6974 2833 302c 2033 3029  iew_init(30, 30)
+00053c20: 0d0a 2020 2020 6178 6573 2e73 6574 5f70  ..    axes.set_p
+00053c30: 726f 6a5f 7479 7065 2827 6f72 7468 6f27  roj_type('ortho'
+00053c40: 290d 0a20 2020 2061 7865 732e 7365 745f  )..    axes.set_
+00053c50: 6178 6973 5f6f 6666 2829 0d0a 2020 2020  axis_off()..    
+00053c60: 7265 7475 726e 2061 7865 730d 0a0d 0a64  return axes....d
+00053c70: 6566 2061 7574 6f5f 7363 616c 6528 6178  ef auto_scale(ax
+00053c80: 6573 2c2a 6f62 6a33 642c 2a2a 6b61 7267  es,*obj3d,**karg
+00053c90: 7329 203a 0d0a 2020 2020 2222 220d 0a20  s) :..    """.. 
+00053ca0: 2020 2053 6361 6c65 2041 7865 7333 6420     Scale Axes3d 
+00053cb0: 7573 696e 6720 6f62 6a65 6374 2062 6f75  using object bou
+00053cc0: 6e64 732e 0d0a 0d0a 2020 2020 5061 7261  nds.....    Para
+00053cd0: 6d65 7465 7273 0d0a 2020 2020 2d2d 2d2d  meters..    ----
+00053ce0: 2d2d 2d2d 2d2d 0d0a 2020 2020 6178 6573  ------..    axes
+00053cf0: 203a 204d 6174 706c 6f74 6c69 6220 3344   : Matplotlib 3D
+00053d00: 2061 7865 732e 0d0a 0d0a 2020 2020 6f62   axes.....    ob
+00053d10: 6a33 6420 3a20 706f 7369 7469 6f6e 616c  j3d : positional
+00053d20: 2061 7267 756d 656e 7473 206f 6620 7333   arguments of s3
+00053d30: 646c 6962 206f 626a 6563 7473 0d0a 2020  dlib objects..  
+00053d40: 2020 0d0a 2020 2020 7573 6361 6c65 203a    ..    uscale :
+00053d50: 2073 6361 6c69 6e67 2069 6e20 7468 6520   scaling in the 
+00053d60: 7261 6e67 6520 2830 2e35 2c32 2e35 290d  range (0.5,2.5).
+00053d70: 0a20 2020 2020 2020 2069 6620 6e65 6974  .        if neit
+00053d80: 6865 7220 7573 6361 6c65 206f 7220 7273  her uscale or rs
+00053d90: 6361 6c65 2061 7265 2064 6566 696e 6564  cale are defined
+00053da0: 202d 200d 0a20 2020 2020 2020 202e 2020   - ..        .  
+00053db0: 2020 4561 6368 2061 7865 7320 7261 6e67    Each axes rang
+00053dc0: 6573 2061 7265 2069 6e64 6570 656e 6465  es are independe
+00053dd0: 6e74 6c79 0d0a 2020 2020 2020 2020 2e20  ntly..        . 
+00053de0: 2020 2073 6574 2062 7920 7369 7a65 7320     set by sizes 
+00053df0: 6f66 2069 6e70 7574 206f 626a 6563 7473  of input objects
+00053e00: 2e0d 0a20 2020 2020 2020 2069 6620 626f  ...        if bo
+00053e10: 7468 2075 7363 616c 6520 616e 6420 7273  th uscale and rs
+00053e20: 6361 6c65 2061 7265 2064 6566 696e 6564  cale are defined
+00053e30: 202d 0d0a 2020 2020 2020 2020 2e20 2020   -..        .   
+00053e40: 2075 7363 616c 6520 7769 6c6c 2062 6520   uscale will be 
+00053e50: 6967 6e6f 7265 642e 0d0a 2020 2020 2020  ignored...      
+00053e60: 2020 6966 2064 6566 696e 6564 2075 7369    if defined usi
+00053e70: 6e67 2061 6e20 696e 7420 6f72 2066 6c6f  ng an int or flo
+00053e80: 6174 202d 0d0a 2020 2020 2020 2020 2e20  at -..        . 
+00053e90: 2020 2045 6163 6820 6178 6573 2072 616e     Each axes ran
+00053ea0: 6765 7320 6861 7665 2074 6865 2073 616d  ges have the sam
+00053eb0: 6520 7363 616c 6172 0d0a 2020 2020 2020  e scalar..      
+00053ec0: 2020 2e20 2020 206c 656e 6774 682c 2073    .    length, s
+00053ed0: 6574 2062 7920 7468 6520 7661 6c75 6573  et by the values
+00053ee0: 206f 6620 7468 6520 6f62 6a65 6374 732e   of the objects.
+00053ef0: 0d0a 2020 2020 2020 2020 2e20 2020 204f  ..        .    O
+00053f00: 7574 206f 6620 7261 6e67 6520 7661 6c75  ut of range valu
+00053f10: 6573 2077 696c 6c20 7365 7420 7468 6520  es will set the 
+00053f20: 7363 616c 696e 670d 0a20 2020 2020 2020  scaling..       
+00053f30: 202e 2020 2020 746f 2074 6865 206d 696e   .    to the min
+00053f40: 696d 756d 206f 7220 6d61 7869 6d75 6d2e  imum or maximum.
+00053f50: 0d0a 2020 2020 2020 2020 656c 7365 202d  ..        else -
+00053f60: 2073 6361 6c69 6e67 2069 7320 6f6e 652e   scaling is one.
+00053f70: 0d0a 2020 2020 0d0a 2020 2020 7273 6361  ..    ..    rsca
+00053f80: 6c65 203a 2073 6361 6c69 6e67 2069 6e20  le : scaling in 
+00053f90: 7468 6520 7261 6e67 6520 2830 2e35 2c32  the range (0.5,2
+00053fa0: 2e35 290d 0a20 2020 2020 2020 2069 6620  .5)..        if 
+00053fb0: 6e65 6974 6865 7220 7573 6361 6c65 206f  neither uscale o
+00053fc0: 7220 7273 6361 6c65 2061 7265 2064 6566  r rscale are def
+00053fd0: 696e 6564 202d 200d 0a20 2020 2020 2020  ined - ..       
+00053fe0: 202e 2020 2020 4561 6368 2061 7865 7320   .    Each axes 
+00053ff0: 7261 6e67 6573 2061 7265 2069 6e64 6570  ranges are indep
+00054000: 656e 6465 6e74 6c79 0d0a 2020 2020 2020  endently..      
+00054010: 2020 2e20 2020 2073 6574 2062 7920 7369    .    set by si
+00054020: 7a65 7320 6f66 2069 6e70 7574 206f 626a  zes of input obj
+00054030: 6563 7473 2e0d 0a20 2020 2020 2020 2069  ects...        i
+00054040: 6620 626f 7468 2075 7363 616c 6520 616e  f both uscale an
+00054050: 6420 7273 6361 6c65 2061 7265 2064 6566  d rscale are def
+00054060: 696e 6564 202d 0d0a 2020 2020 2020 2020  ined -..        
+00054070: 2e20 2020 2075 7363 616c 6520 7769 6c6c  .    uscale will
+00054080: 2062 6520 6967 6e6f 7265 642e 0d0a 2020   be ignored...  
+00054090: 2020 2020 2020 6966 2064 6566 696e 6564        if defined
+000540a0: 2075 7369 6e67 2061 6e20 696e 7420 6f72   using an int or
+000540b0: 2066 6c6f 6174 202d 0d0a 2020 2020 2020   float -..      
+000540c0: 2020 2e20 2020 2045 6163 6820 6178 6573    .    Each axes
+000540d0: 2072 616e 6765 7320 6861 7665 2074 6865   ranges have the
+000540e0: 2073 616d 6520 6d69 6e69 6d75 6d0d 0a20   same minimum.. 
+000540f0: 2020 2020 2020 202e 2020 2020 616e 6420         .    and 
+00054100: 6d61 7869 6d75 6d2c 2073 6574 2062 7920  maximum, set by 
+00054110: 7468 6520 7661 6c75 6573 206f 6620 7468  the values of th
+00054120: 650d 0a20 2020 2020 2020 202e 2020 2020  e..        .    
+00054130: 6f62 6a65 6374 7320 7261 6469 616c 2065  objects radial e
+00054140: 7874 656e 7420 6672 6f6d 2074 6865 206f  xtent from the o
+00054150: 7269 6769 6e2e 0d0a 2020 2020 2020 2020  rigin...        
+00054160: 2e20 2020 204f 7574 206f 6620 7261 6e67  .    Out of rang
+00054170: 6520 7661 6c75 6573 2077 696c 6c20 7365  e values will se
+00054180: 7420 7468 6520 7363 616c 696e 670d 0a20  t the scaling.. 
+00054190: 2020 2020 2020 202e 2020 2020 746f 2074         .    to t
+000541a0: 6865 206d 6178 696d 756d 2e0d 0a20 2020  he maximum...   
+000541b0: 2020 2020 2065 6c73 6520 2d20 7363 616c       else - scal
+000541c0: 696e 6720 6973 206f 6e65 2e0d 0a0d 0a20  ing is one..... 
+000541d0: 2020 2052 6574 7572 6e73 0d0a 2020 2020     Returns..    
+000541e0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2061 7865  -------..    axe
+000541f0: 732c 2077 6869 6368 2068 6173 2062 6565  s, which has bee
+00054200: 6e20 7363 616c 6564 0d0a 0d0a 2020 2020  n scaled....    
+00054210: 2222 2220 2020 0d0a 2020 2020 582c 592c  """   ..    X,Y,
+00054220: 5a2c 5220 3d20 5b5d 2c5b 5d2c 5b5d 2c5b  Z,R = [],[],[],[
+00054230: 5d0d 0a20 2020 2066 6f72 206f 626a 2069  ]..    for obj i
+00054240: 6e20 6f62 6a33 6420 3a0d 0a20 2020 2020  n obj3d :..     
+00054250: 2020 2058 2e61 7070 656e 6428 6f62 6a2e     X.append(obj.
+00054260: 626f 756e 6473 5b27 786c 696d 275d 5b30  bounds['xlim'][0
+00054270: 5d29 0d0a 2020 2020 2020 2020 582e 6170  ])..        X.ap
+00054280: 7065 6e64 286f 626a 2e62 6f75 6e64 735b  pend(obj.bounds[
+00054290: 2778 6c69 6d27 5d5b 315d 290d 0a20 2020  'xlim'][1])..   
+000542a0: 2020 2020 2059 2e61 7070 656e 6428 6f62       Y.append(ob
+000542b0: 6a2e 626f 756e 6473 5b27 796c 696d 275d  j.bounds['ylim']
+000542c0: 5b30 5d29 0d0a 2020 2020 2020 2020 592e  [0])..        Y.
+000542d0: 6170 7065 6e64 286f 626a 2e62 6f75 6e64  append(obj.bound
+000542e0: 735b 2779 6c69 6d27 5d5b 315d 290d 0a20  s['ylim'][1]).. 
+000542f0: 2020 2020 2020 205a 2e61 7070 656e 6428         Z.append(
+00054300: 6f62 6a2e 626f 756e 6473 5b27 7a6c 696d  obj.bounds['zlim
+00054310: 275d 5b30 5d29 0d0a 2020 2020 2020 2020  '][0])..        
+00054320: 5a2e 6170 7065 6e64 286f 626a 2e62 6f75  Z.append(obj.bou
+00054330: 6e64 735b 277a 6c69 6d27 5d5b 315d 290d  nds['zlim'][1]).
+00054340: 0a20 2020 2020 2020 2052 2e61 7070 656e  .        R.appen
+00054350: 6428 6f62 6a2e 626f 756e 6473 5b27 726f  d(obj.bounds['ro
+00054360: 7267 275d 5b31 5d29 0d0a 2020 2020 0d0a  rg'][1])..    ..
+00054370: 2020 2020 6966 2027 7573 6361 6c65 2720      if 'uscale' 
+00054380: 696e 206b 6172 6773 203a 0d0a 2020 2020  in kargs :..    
+00054390: 2020 2020 7363 203d 206b 6172 6773 5b27      sc = kargs['
+000543a0: 7573 6361 6c65 275d 0d0a 2020 2020 2020  uscale']..      
+000543b0: 2020 6966 206e 6f74 2069 7369 6e73 7461    if not isinsta
+000543c0: 6e63 6528 7363 2c28 696e 742c 666c 6f61  nce(sc,(int,floa
+000543d0: 7429 293a 2073 633d 312e 300d 0a20 2020  t)): sc=1.0..   
+000543e0: 2020 2020 2069 6620 7363 203e 2032 2e30       if sc > 2.0
+000543f0: 203a 2073 6320 3d20 322e 300d 0a20 2020   : sc = 2.0..   
+00054400: 2020 2020 2069 6620 7363 203c 2030 2e35       if sc < 0.5
+00054410: 203a 2073 6320 3d20 302e 350d 0a20 2020   : sc = 0.5..   
+00054420: 2020 2020 2041 784c 656e 203d 206c 616d       AxLen = lam
+00054430: 6264 6120 6120 3a20 6d61 7828 6129 2d6d  bda a : max(a)-m
+00054440: 696e 2861 290d 0a20 2020 2020 2020 2041  in(a)..        A
+00054450: 784d 7074 203d 206c 616d 6264 6120 6120  xMpt = lambda a 
+00054460: 3a20 302e 352a 2820 6d61 7828 6129 202b  : 0.5*( max(a) +
+00054470: 206d 696e 2861 2920 290d 0a20 2020 2020   min(a) )..     
+00054480: 2020 206d 6178 416c 656e 203d 2073 632a     maxAlen = sc*
+00054490: 6d61 7828 205b 4178 4c65 6e28 5829 2c20  max( [AxLen(X), 
+000544a0: 4178 4c65 6e28 5929 2c20 4178 4c65 6e28  AxLen(Y), AxLen(
+000544b0: 5a29 5d20 2029 200d 0a20 2020 2020 2020  Z)]  ) ..       
+000544c0: 2058 203d 205b 2028 4178 4d70 7428 5829   X = [ (AxMpt(X)
+000544d0: 2d30 2e35 2a6d 6178 416c 656e 292c 2028  -0.5*maxAlen), (
+000544e0: 4178 4d70 7428 5829 2b30 2e35 2a6d 6178  AxMpt(X)+0.5*max
+000544f0: 416c 656e 2920 5d0d 0a20 2020 2020 2020  Alen) ]..       
+00054500: 2059 203d 205b 2028 4178 4d70 7428 5929   Y = [ (AxMpt(Y)
+00054510: 2d30 2e35 2a6d 6178 416c 656e 292c 2028  -0.5*maxAlen), (
+00054520: 4178 4d70 7428 5929 2b30 2e35 2a6d 6178  AxMpt(Y)+0.5*max
+00054530: 416c 656e 2920 5d0d 0a20 2020 2020 2020  Alen) ]..       
+00054540: 205a 203d 205b 2028 4178 4d70 7428 5a29   Z = [ (AxMpt(Z)
+00054550: 2d30 2e35 2a6d 6178 416c 656e 292c 2028  -0.5*maxAlen), (
+00054560: 4178 4d70 7428 5a29 2b30 2e35 2a6d 6178  AxMpt(Z)+0.5*max
+00054570: 416c 656e 2920 5d0d 0a0d 0a20 2020 2069  Alen) ]....    i
+00054580: 6620 2772 7363 616c 6527 2069 6e20 6b61  f 'rscale' in ka
+00054590: 7267 7320 3a0d 0a20 2020 2020 2020 2073  rgs :..        s
+000545a0: 6320 3d20 6b61 7267 735b 2772 7363 616c  c = kargs['rscal
+000545b0: 6527 5d0d 0a20 2020 2020 2020 2069 6620  e']..        if 
+000545c0: 6e6f 7420 6973 696e 7374 616e 6365 2873  not isinstance(s
+000545d0: 632c 2869 6e74 2c66 6c6f 6174 2929 3a20  c,(int,float)): 
+000545e0: 7363 3d31 2e30 0d0a 2020 2020 2020 2020  sc=1.0..        
+000545f0: 6966 2073 6320 3e20 322e 3020 3a20 7363  if sc > 2.0 : sc
+00054600: 203d 2032 2e30 0d0a 2020 2020 2020 2020   = 2.0..        
+00054610: 6966 2073 6320 3c20 302e 3520 3a20 7363  if sc < 0.5 : sc
+00054620: 203d 2030 2e35 0d0a 2020 2020 2020 2020   = 0.5..        
+00054630: 726d 6178 203d 2073 632a 6d61 7828 5229  rmax = sc*max(R)
+00054640: 0d0a 2020 2020 2020 2020 6d69 6e6d 6178  ..        minmax
+00054650: 203d 2028 2d72 6d61 782c 726d 6178 290d   = (-rmax,rmax).
+00054660: 0a20 2020 2020 2020 2061 7865 732e 7365  .        axes.se
+00054670: 7428 786c 696d 3d6d 696e 6d61 782c 2079  t(xlim=minmax, y
+00054680: 6c69 6d3d 6d69 6e6d 6178 2c20 7a6c 696d  lim=minmax, zlim
+00054690: 3d6d 696e 6d61 7820 290d 0a20 2020 2020  =minmax )..     
+000546a0: 2020 2072 6574 7572 6e20 6178 6573 2020     return axes  
+000546b0: 2020 2020 0d0a 0d0a 2020 2020 6178 6573      ....    axes
+000546c0: 2e61 7574 6f5f 7363 616c 655f 7879 7a28  .auto_scale_xyz(
+000546d0: 582c 592c 5a29 0d0a 2020 2020 7265 7475  X,Y,Z)..    retu
+000546e0: 726e 2061 7865 730d 0a0d 0a64 6566 2065  rn axes....def e
+000546f0: 756c 6572 526f 7428 7468 6574 612c 2070  ulerRot(theta, p
+00054700: 6869 2c20 7073 693d 302c 2075 7365 5863  hi, psi=0, useXc
+00054710: 6f6e 763d 5472 7565 2c20 696e 7261 643d  onv=True, inrad=
+00054720: 4661 6c73 6529 203a 0d0a 2020 2020 2222  False) :..    ""
+00054730: 2252 6f74 6174 696f 6e20 6d61 7472 6978  "Rotation matrix
+00054740: 2066 726f 6d20 4575 6c65 7220 616e 676c   from Euler angl
+00054750: 6573 2c20 5820 6f72 2059 2063 6f6e 7665  es, X or Y conve
+00054760: 6e74 696f 6e2e 2222 220d 0a20 2020 2023  ntion."""..    #
+00054770: 2058 2d63 6f6e 7665 6e74 696f 6e20 287a   X-convention (z
+00054780: 787a 2729 2061 6e64 2059 2d63 6f6e 7665  xz') and Y-conve
+00054790: 6e74 696f 6e20 287a 797a 2729 2072 6f74  ntion (zyz') rot
+000547a0: 6174 696f 6e73 2e0d 0a20 2020 2074 6874  ations...    tht
+000547b0: 5f52 6164 203d 2074 6865 7461 0d0a 2020  _Rad = theta..  
+000547c0: 2020 7068 695f 5261 6420 3d20 2070 6869    phi_Rad =  phi
+000547d0: 0d0a 2020 2020 7073 695f 5261 6420 3d20  ..    psi_Rad = 
+000547e0: 2070 7369 0d0a 2020 2020 6966 206e 6f74   psi..    if not
+000547f0: 2069 6e72 6164 203a 0d0a 2020 2020 2020   inrad :..      
+00054800: 2020 7468 745f 5261 6420 3d20 7468 6574    tht_Rad = thet
+00054810: 612a 6e70 2e70 6920 2f31 3830 2e30 0d0a  a*np.pi /180.0..
+00054820: 2020 2020 2020 2020 7068 695f 5261 6420          phi_Rad 
+00054830: 3d20 2070 6869 2a6e 702e 7069 202f 3138  =  phi*np.pi /18
+00054840: 302e 300d 0a20 2020 2020 2020 2070 7369  0.0..        psi
+00054850: 5f52 6164 203d 2020 7073 692a 6e70 2e70  _Rad =  psi*np.p
+00054860: 6920 2f31 3830 2e30 0d0a 0d0a 2020 2020  i /180.0....    
+00054870: 6354 2c73 5420 3d20 6e70 2e63 6f73 2874  cT,sT = np.cos(t
+00054880: 6874 5f52 6164 292c 2020 6e70 2e73 696e  ht_Rad),  np.sin
+00054890: 2874 6874 5f52 6164 290d 0a20 2020 2063  (tht_Rad)..    c
+000548a0: 502c 7350 203d 206e 702e 636f 7328 7068  P,sP = np.cos(ph
+000548b0: 695f 5261 6429 2c20 206e 702e 7369 6e28  i_Rad),  np.sin(
+000548c0: 7068 695f 5261 6429 0d0a 2020 2020 6353  phi_Rad)..    cS
+000548d0: 2c73 5320 3d20 6e70 2e63 6f73 2870 7369  ,sS = np.cos(psi
+000548e0: 5f52 6164 292c 2020 6e70 2e73 696e 2870  _Rad),  np.sin(p
+000548f0: 7369 5f52 6164 290d 0a20 2020 2054 5f74  si_Rad)..    T_t
+00054900: 203d 205b 205b 2063 542c 2073 542c 2030   = [ [ cT, sT, 0
+00054910: 205d 2c20 5b2d 7354 2c20 6354 2c20 3020   ], [-sT, cT, 0 
+00054920: 5d2c 205b 2030 202c 2030 202c 2031 205d  ], [ 0 , 0 , 1 ]
+00054930: 2020 5d0d 0a20 2020 2054 5f58 203d 205b    ]..    T_X = [
+00054940: 205b 2031 202c 2030 202c 2030 205d 2c20   [ 1 , 0 , 0 ], 
+00054950: 5b20 3020 2c20 6350 2c20 7350 5d2c 205b  [ 0 , cP, sP], [
+00054960: 2030 202c 2d73 502c 2063 505d 2020 5d0d   0 ,-sP, cP]  ].
+00054970: 0a20 2020 2054 5f59 203d 205b 205b 2063  .    T_Y = [ [ c
+00054980: 502c 2030 202c 2d73 505d 2c20 5b20 3020  P, 0 ,-sP], [ 0 
+00054990: 2c20 3120 2c20 3020 5d2c 205b 2073 502c  , 1 , 0 ], [ sP,
+000549a0: 2030 202c 2063 505d 2020 5d0d 0a20 2020   0 , cP]  ]..   
+000549b0: 2054 5f73 203d 205b 205b 2063 532c 2073   T_s = [ [ cS, s
+000549c0: 532c 2030 205d 2c20 5b2d 7353 2c20 6353  S, 0 ], [-sS, cS
+000549d0: 2c20 3020 5d2c 205b 2030 202c 2030 202c  , 0 ], [ 0 , 0 ,
+000549e0: 2031 205d 2020 5d0d 0a20 2020 2069 6620   1 ]  ]..    if 
+000549f0: 7573 6558 636f 6e76 203a 2054 5f70 203d  useXconv : T_p =
+00054a00: 2054 5f58 0d0a 2020 2020 656c 7365 3a20   T_X..    else: 
+00054a10: 2020 2020 2020 2020 545f 7020 3d20 545f          T_p = T_
+00054a20: 590d 0a20 2020 204d 203d 206e 702e 6d61  Y..    M = np.ma
+00054a30: 746d 756c 2820 545f 702c 2054 5f74 2029  tmul( T_p, T_t )
+00054a40: 0d0a 2020 2020 6966 2070 7369 2021 3d20  ..    if psi != 
+00054a50: 3020 3a20 4d20 3d20 6e70 2e6d 6174 6d75  0 : M = np.matmu
+00054a60: 6c28 2054 5f73 2c20 4d20 290d 0a20 2020  l( T_s, M )..   
+00054a70: 2072 6574 7572 6e20 4d0d 0a0d 0a64 6566   return M....def
+00054a80: 2061 7869 7352 6f74 2861 6c70 6861 2c20   axisRot(alpha, 
+00054a90: 6469 7265 6374 696f 6e2c 2069 6e72 6164  direction, inrad
+00054aa0: 3d46 616c 7365 2920 3a0d 0a20 2020 2022  =False) :..    "
+00054ab0: 2222 526f 7461 7469 6f6e 206d 6174 7269  ""Rotation matri
+00054ac0: 7820 6672 6f6d 2072 6f74 6174 696f 6e20  x from rotation 
+00054ad0: 6162 6f75 7420 6120 6469 7265 6374 696f  about a directio
+00054ae0: 6e61 6c20 6178 6973 2222 220d 0a20 2020  nal axis"""..   
+00054af0: 2023 2073 6565 2057 696b 6970 6564 6961   # see Wikipedia
+00054b00: 3a20 5175 6174 6572 6e69 6f6e 7320 616e  : Quaternions an
+00054b10: 6420 7370 6174 6961 6c20 726f 7461 7469  d spatial rotati
+00054b20: 6f6e 0d0a 2020 2020 616c 705f 5261 6420  on..    alp_Rad 
+00054b30: 3d20 2d61 6c70 6861 0d0a 2020 2020 6966  = -alpha..    if
+00054b40: 206e 6f74 2069 6e72 6164 203a 0d0a 2020   not inrad :..  
+00054b50: 2020 2020 2020 616c 705f 5261 6420 3d20        alp_Rad = 
+00054b60: 2d61 6c70 6861 2a6e 702e 7069 202f 3138  -alpha*np.pi /18
+00054b70: 302e 300d 0a0d 0a20 2020 2075 203d 206e  0.0....    u = n
+00054b80: 702e 6469 7669 6465 2820 6469 7265 6374  p.divide( direct
+00054b90: 696f 6e2c 206e 702e 6c69 6e61 6c67 2e6e  ion, np.linalg.n
+00054ba0: 6f72 6d28 6469 7265 6374 696f 6e29 2029  orm(direction) )
+00054bb0: 0d0a 2020 2020 7354 203d 206e 702e 7369  ..    sT = np.si
+00054bc0: 6e28 616c 705f 5261 642f 322e 3029 0d0a  n(alp_Rad/2.0)..
+00054bd0: 2020 2020 7152 203d 206e 702e 636f 7328      qR = np.cos(
+00054be0: 616c 705f 5261 642f 322e 3029 0d0a 2020  alp_Rad/2.0)..  
+00054bf0: 2020 7149 2c20 714a 2c20 714b 203d 2073    qI, qJ, qK = s
+00054c00: 542a 755b 305d 2c20 7354 2a75 5b31 5d2c  T*u[0], sT*u[1],
+00054c10: 2073 542a 755b 325d 200d 0a20 2020 204d   sT*u[2] ..    M
+00054c20: 203d 205b 0d0a 2020 2020 2020 2020 5b20   = [..        [ 
+00054c30: 2831 2d32 2a28 714a 2a71 4a20 2b20 714b  (1-2*(qJ*qJ + qK
+00054c40: 2a71 4b29 292c 2020 2020 322a 2871 492a  *qK)),    2*(qI*
+00054c50: 714a 202d 2071 4b2a 7152 2920 2c20 2020  qJ - qK*qR) ,   
+00054c60: 2032 2a28 7149 2a71 4b20 2b20 714a 2a71   2*(qI*qK + qJ*q
+00054c70: 5229 2020 5d20 2c0d 0a20 2020 2020 2020  R)  ] ,..       
+00054c80: 205b 2020 2020 322a 2871 492a 714a 202b   [    2*(qI*qJ +
+00054c90: 2071 4b2a 7152 2920 2c20 2831 2d32 2a28   qK*qR) , (1-2*(
+00054ca0: 7149 2a71 4920 2b20 714b 2a71 4b29 292c  qI*qI + qK*qK)),
+00054cb0: 2020 2020 322a 2871 4a2a 714b 202d 2071      2*(qJ*qK - q
+00054cc0: 492a 7152 2920 205d 202c 0d0a 2020 2020  I*qR)  ] ,..    
+00054cd0: 2020 2020 5b20 2020 2032 2a28 7149 2a71      [    2*(qI*q
+00054ce0: 4b20 2d20 714a 2a71 5229 202c 2020 2020  K - qJ*qR) ,    
+00054cf0: 322a 2871 4a2a 714b 202b 2071 492a 7152  2*(qJ*qK + qI*qR
+00054d00: 2920 2c20 2831 2d32 2a28 7149 2a71 4920  ) , (1-2*(qI*qI 
+00054d10: 2b20 714a 2a71 4a29 2920 5d0d 0a20 2020  + qJ*qJ)) ]..   
+00054d20: 205d 0d0a 2020 2020 7265 7475 726e 204d   ]..    return M
+00054d30: 0d0a 0d0a 6465 6620 7665 6374 526f 7428  ....def vectRot(
+00054d40: 7844 6972 6563 7469 6f6e 2c20 696e 5f70  xDirection, in_p
+00054d50: 6c61 6e65 4469 7265 6374 696f 6e29 203a  laneDirection) :
+00054d60: 0d0a 2020 2020 2222 2252 6f74 6174 696f  ..    """Rotatio
+00054d70: 6e73 206d 6174 7269 7820 6672 6f6d 2074  ns matrix from t
+00054d80: 776f 2076 6563 746f 7273 2022 2222 0d0a  wo vectors """..
+00054d90: 2020 2020 6970 4469 7220 3d20 6e70 2e61      ipDir = np.a
+00054da0: 7272 6179 2869 6e5f 706c 616e 6544 6972  rray(in_planeDir
+00054db0: 6563 7469 6f6e 290d 0a20 2020 2078 4469  ection)..    xDi
+00054dc0: 7220 3d20 6e70 2e61 7272 6179 2878 4469  r = np.array(xDi
+00054dd0: 7265 6374 696f 6e29 0d0a 2020 2020 7a44  rection)..    zD
+00054de0: 6972 203d 206e 702e 6372 6f73 7328 7844  ir = np.cross(xD
+00054df0: 6972 2c69 7044 6972 290d 0a20 2020 2079  ir,ipDir)..    y
+00054e00: 4469 7220 3d20 6e70 2e63 726f 7373 287a  Dir = np.cross(z
+00054e10: 4469 722c 7844 6972 290d 0a20 2020 2076  Dir,xDir)..    v
+00054e20: 6563 7420 3d20 6e70 2e61 7272 6179 2820  ect = np.array( 
+00054e30: 5b78 4469 722c 7944 6972 2c7a 4469 725d  [xDir,yDir,zDir]
+00054e40: 2029 0d0a 2020 2020 766e 6f72 6d20 3d20   )..    vnorm = 
+00054e50: 6e70 2e6c 696e 616c 672e 6e6f 726d 2876  np.linalg.norm(v
+00054e60: 6563 742c 6178 6973 3d31 290d 0a20 2020  ect,axis=1)..   
+00054e70: 2075 6e69 7456 6563 7473 203d 206e 702e   unitVects = np.
+00054e80: 6469 7669 6465 2876 6563 742e 542c 766e  divide(vect.T,vn
+00054e90: 6f72 6d29 2e54 0d0a 2020 2020 7265 7475  orm).T..    retu
+00054ea0: 726e 2075 6e69 7456 6563 7473 0d0a 0d0a  rn unitVects....
+00054eb0: 6465 6620 7274 7628 6469 7265 6374 696f  def rtv(directio
+00054ec0: 6e2c 656c 6576 3d4e 6f6e 652c 617a 696d  n,elev=None,azim
+00054ed0: 3d4e 6f6e 6529 203a 0d0a 2020 2020 2222  =None) :..    ""
+00054ee0: 2254 7261 6e73 666f 726d 2064 6972 6563  "Transform direc
+00054ef0: 7469 6f6e 2076 6563 746f 7220 2772 656c  tion vector 'rel
+00054f00: 6174 6976 6520 746f 2076 6965 7727 2061  ative to view' a
+00054f10: 7869 7320 7669 6577 696e 6720 616e 676c  xis viewing angl
+00054f20: 6573 2e22 2222 0d0a 2020 2020 6966 2065  es."""..    if e
+00054f30: 6c65 7620 6973 204e 6f6e 6520 3a20 656c  lev is None : el
+00054f40: 6576 203d 205f 4446 545f 5649 4557 5b30  ev = _DFT_VIEW[0
+00054f50: 5d0d 0a20 2020 2069 6620 617a 696d 2069  ]..    if azim i
+00054f60: 7320 4e6f 6e65 203a 2061 7a69 6d20 3d20  s None : azim = 
+00054f70: 5f44 4654 5f56 4945 575b 315d 0d0a 2020  _DFT_VIEW[1]..  
+00054f80: 2020 617a 696d 5f52 6164 203d 2061 7a69    azim_Rad = azi
+00054f90: 6d2a 6e70 2e70 6920 2f31 3830 2e30 0d0a  m*np.pi /180.0..
+00054fa0: 2020 2020 656c 6576 5f52 6164 203d 2065      elev_Rad = e
+00054fb0: 6c65 762a 6e70 2e70 6920 2f31 3830 2e30  lev*np.pi /180.0
+00054fc0: 0d0a 2020 2020 6341 2c73 4120 3d20 6e70  ..    cA,sA = np
+00054fd0: 2e63 6f73 2861 7a69 6d5f 5261 6429 2c20  .cos(azim_Rad), 
+00054fe0: 206e 702e 7369 6e28 617a 696d 5f52 6164   np.sin(azim_Rad
+00054ff0: 290d 0a20 2020 2063 452c 7345 203d 206e  )..    cE,sE = n
+00055000: 702e 636f 7328 656c 6576 5f52 6164 292c  p.cos(elev_Rad),
+00055010: 2020 6e70 2e73 696e 2865 6c65 765f 5261    np.sin(elev_Ra
+00055020: 6429 0d0a 2020 2020 544d 203d 205b 205b  d)..    TM = [ [
+00055030: 2063 452a 6341 2c20 6345 2a73 412c 2073   cE*cA, cE*sA, s
+00055040: 4520 5d2c 2020 5b20 2d73 412c 2063 412c  E ],  [ -sA, cA,
+00055050: 2030 2e30 205d 2c20 205b 2020 2d73 452a   0.0 ],  [  -sE*
+00055060: 6341 2c20 2d73 452a 7341 2c20 6345 205d  cA, -sE*sA, cE ]
+00055070: 205d 0d0a 2020 2020 7265 6c64 6972 203d   ]..    reldir =
+00055080: 206e 702e 646f 7428 6469 7265 6374 696f   np.dot(directio
+00055090: 6e2c 544d 290d 0a20 2020 2072 6574 7572  n,TM)..    retur
+000550a0: 6e20 7265 6c64 6972 0d0a 0d0a 6465 6620  n reldir....def 
+000550b0: 656c 6576 5f61 7a69 6d5f 3276 6563 746f  elev_azim_2vecto
+000550c0: 7228 656c 6576 2c20 617a 696d 2c20 696e  r(elev, azim, in
+000550d0: 7261 643d 4661 6c73 6529 203a 0d0a 2020  rad=False) :..  
+000550e0: 2020 2222 2255 6e69 7420 7665 6374 6f72    """Unit vector
+000550f0: 2069 6e20 7468 6520 7465 726d 7320 6f66   in the terms of
+00055100: 2061 6e67 756c 6172 2070 6f73 6974 696f   angular positio
+00055110: 6e2e 2222 220d 0a20 2020 2074 6874 5f52  n."""..    tht_R
+00055120: 6164 203d 2061 7a69 6d0d 0a20 2020 2070  ad = azim..    p
+00055130: 6869 5f52 6164 203d 206e 702e 7069 2f32  hi_Rad = np.pi/2
+00055140: 202d 2065 6c65 760d 0a20 2020 2069 6620   - elev..    if 
+00055150: 6e6f 7420 696e 7261 6420 3a0d 0a20 2020  not inrad :..   
+00055160: 2020 2020 2074 6874 5f52 6164 203d 2061       tht_Rad = a
+00055170: 7a69 6d2a 6e70 2e70 6920 2f31 3830 2e30  zim*np.pi /180.0
+00055180: 0d0a 2020 2020 2020 2020 7068 695f 5261  ..        phi_Ra
+00055190: 6420 3d20 2839 302e 302d 656c 6576 292a  d = (90.0-elev)*
+000551a0: 6e70 2e70 6920 2f31 3830 2e30 0d0a 2020  np.pi /180.0..  
+000551b0: 2020 6b20 3d20 6e70 2e63 6f73 2870 6869    k = np.cos(phi
+000551c0: 5f52 6164 290d 0a20 2020 2072 203d 206e  _Rad)..    r = n
+000551d0: 702e 7369 6e28 7068 695f 5261 6429 0d0a  p.sin(phi_Rad)..
+000551e0: 2020 2020 6920 3d20 722a 6e70 2e63 6f73      i = r*np.cos
+000551f0: 2874 6874 5f52 6164 290d 0a20 2020 206a  (tht_Rad)..    j
+00055200: 203d 2072 2a6e 702e 7369 6e28 7468 745f   = r*np.sin(tht_
+00055210: 5261 6429 0d0a 2020 2020 7265 7475 726e  Rad)..    return
+00055220: 206e 702e 6172 7261 7928 205b 692c 6a2c   np.array( [i,j,
+00055230: 6b5d 2029 0d0a 0d0a 6465 6620 6672 616d  k] )....def fram
+00055240: 655f 746f 5f76 616c 7565 2878 2c20 2a76  e_to_value(x, *v
+00055250: 616c 4c69 7374 2c20 2a2a 6b61 7267 7329  alList, **kargs)
+00055260: 203a 0d0a 2020 2020 2222 220d 0a20 2020   :..    """..   
+00055270: 2059 203d 2066 2878 2920 6672 6f6d 2061   Y = f(x) from a
+00055280: 2063 6f6c 6c65 6374 696f 6e20 6f66 206c   collection of l
+00055290: 696e 6561 7220 7365 676d 656e 7420 6675  inear segment fu
+000552a0: 6e63 7469 6f6e 7320 6628 7829 0d0a 2020  nctions f(x)..  
+000552b0: 2020 0d0a 2020 2020 5061 7261 6d65 7465    ..    Paramete
+000552c0: 7273 0d0a 2020 2020 2d2d 2d2d 2d2d 2d2d  rs..    --------
+000552d0: 2d2d 0d0a 2020 2020 7820 3a20 666c 6f61  --..    x : floa
+000552e0: 7420 7661 6c75 6520 6265 7477 6565 6e20  t value between 
+000552f0: 3020 616e 6420 312e 0d0a 0d0a 2020 2020  0 and 1.....    
+00055300: 7661 6c4c 6973 7420 3a20 6c69 7374 206f  valList : list o
+00055310: 6620 7661 6c75 6573 2c20 6576 656e 6c79  f values, evenly
+00055320: 2073 7061 6365 6420 616c 6f6e 6720 782e   spaced along x.
+00055330: 2046 6f72 206d 756c 7469 706c 6520 6c69   For multiple li
+00055340: 7374 732c 2061 6c6c 206d 7573 7420 6265  sts, all must be
+00055350: 2074 6865 2073 616d 6520 6c65 6e67 7468   the same length
+00055360: 2e0d 0a0d 0a20 2020 2073 7465 7070 6564  .....    stepped
+00055370: 203a 2062 6f6f 6c65 616e 2c20 6465 6661   : boolean, defa
+00055380: 756c 7420 6973 2046 616c 7365 2e0d 0a20  ult is False... 
+00055390: 2020 2020 2020 2049 6620 5472 7565 2c20         If True, 
+000553a0: 6675 6e63 7469 6f6e 2065 7661 6c75 6174  function evaluat
+000553b0: 6520 746f 2061 2063 6f6e 7374 616e 7420  e to a constant 
+000553c0: 6f66 2074 6865 2066 6972 7374 2076 616c  of the first val
+000553d0: 7565 2062 6574 7765 656e 0d0a 2020 2020  ue between..    
+000553e0: 2020 2020 7661 6c4c 6973 7420 7661 6c75      valList valu
+000553f0: 6573 2e20 2049 6620 4661 6c73 652c 2066  es.  If False, f
+00055400: 756e 6374 696f 6e20 6973 206c 696e 6561  unction is linea
+00055410: 7220 6265 7477 6565 6e20 7661 6c4c 6973  r between valLis
+00055420: 7420 7661 6c75 6573 2e0d 0a20 2020 2020  t values...     
+00055430: 2020 2046 6f72 2054 7275 652c 206e 756d     For True, num
+00055440: 6265 7220 6f66 206c 696e 6561 7220 7365  ber of linear se
+00055450: 676d 656e 7473 2069 7320 7468 6520 7661  gments is the va
+00055460: 6c4c 6973 7420 6c65 6e67 7468 2e0d 0a20  lList length... 
+00055470: 2020 2020 2020 2046 6f72 2046 616c 7365         For False
+00055480: 2c20 6e75 6d62 6572 206f 6620 6c69 6e65  , number of line
+00055490: 6172 2073 6567 6d65 6e74 7320 6973 206f  ar segments is o
+000554a0: 6e65 206c 6573 7320 7468 616e 2076 616c  ne less than val
+000554b0: 4c69 7374 206c 656e 6774 682e 0d0a 0d0a  List length.....
+000554c0: 2020 2020 5265 7475 726e 730d 0a20 2020      Returns..   
+000554d0: 202d 2d2d 2d2d 2d2d 0d0a 2020 2020 4c69   -------..    Li
+000554e0: 7374 206f 6620 7661 6c75 6573 206f 6620  st of values of 
+000554f0: 7369 7a65 2076 616c 4c69 7374 2061 7267  size valList arg
+00055500: 756d 656e 7473 206e 756d 6265 722e 0d0a  uments number...
+00055510: 0d0a 2020 2020 2222 220d 0a20 2020 2023  ..    """..    #
+00055520: 2030 203c 2078 203c 2031 0d0a 2020 2020   0 < x < 1..    
+00055530: 6465 6620 7646 726f 6d4c 6973 7428 662c  def vFromList(f,
+00055540: 4129 203a 0d0a 2020 2020 2020 2020 6e53  A) :..        nS
+00055550: 6567 203d 206c 656e 2841 2920 2d20 310d  eg = len(A) - 1.
+00055560: 0a20 2020 2020 2020 2069 203d 206d 6174  .        i = mat
+00055570: 682e 666c 6f6f 7228 662a 6e53 6567 290d  h.floor(f*nSeg).
+00055580: 0a20 2020 2020 2020 2069 6620 693e 3d6e  .        if i>=n
+00055590: 5365 6720 3a20 7265 7475 726e 2041 5b6e  Seg : return A[n
+000555a0: 5365 675d 0d0a 2020 2020 2020 2020 7820  Seg]..        x 
+000555b0: 3d20 2866 2a6e 5365 6729 2025 2031 0d0a  = (f*nSeg) % 1..
+000555c0: 2020 2020 2020 2020 7661 6c20 3d20 415b          val = A[
+000555d0: 695d 202b 2078 2a28 2041 5b69 2b31 5d2d  i] + x*( A[i+1]-
+000555e0: 415b 695d 2029 0d0a 2020 2020 2020 2020  A[i] )..        
+000555f0: 7265 7475 726e 2076 616c 0d0a 2020 2020  return val..    
+00055600: 6465 6620 7646 726f 6d53 7465 7028 662c  def vFromStep(f,
+00055610: 4129 203a 0d0a 2020 2020 2020 2020 6e53  A) :..        nS
+00055620: 6567 203d 206c 656e 2841 290d 0a20 2020  eg = len(A)..   
+00055630: 2020 2020 2069 203d 206d 6174 682e 666c       i = math.fl
+00055640: 6f6f 7228 662a 6e53 6567 290d 0a20 2020  oor(f*nSeg)..   
+00055650: 2020 2020 2069 6620 693e 3d6e 5365 6720       if i>=nSeg 
+00055660: 3a20 7265 7475 726e 2041 5b6e 5365 672d  : return A[nSeg-
+00055670: 315d 0d0a 2020 2020 2020 2020 6966 2069  1]..        if i
+00055680: 3c30 203a 2072 6574 7572 6e20 415b 305d  <0 : return A[0]
+00055690: 0d0a 2020 2020 2020 2020 7661 6c20 3d20  ..        val = 
+000556a0: 415b 695d 0d0a 2020 2020 2020 2020 7265  A[i]..        re
+000556b0: 7475 726e 2076 616c 0d0a 2020 2020 7374  turn val..    st
+000556c0: 6570 7065 6420 3d20 4661 6c73 650d 0a20  epped = False.. 
+000556d0: 2020 2069 6620 2773 7465 7027 2069 6e20     if 'step' in 
+000556e0: 6b61 7267 7320 3a20 7374 6570 7065 6420  kargs : stepped 
+000556f0: 3d20 6b61 7267 735b 2773 7465 7027 5d20  = kargs['step'] 
+00055700: 2020 0d0a 2020 2020 7661 6c73 203d 205b    ..    vals = [
+00055710: 5d0d 0a20 2020 2066 6f72 2076 4c69 7374  ]..    for vList
+00055720: 2069 6e20 7661 6c4c 6973 7420 3a0d 0a20   in valList :.. 
+00055730: 2020 2020 2020 2069 6620 7374 6570 7065         if steppe
+00055740: 6420 3a20 7661 6c73 2e61 7070 656e 6428  d : vals.append(
+00055750: 2076 4672 6f6d 5374 6570 2878 2c76 4c69   vFromStep(x,vLi
+00055760: 7374 2920 290d 0a20 2020 2020 2020 2065  st) )..        e
+00055770: 6c73 6520 2020 2020 2020 3a20 7661 6c73  lse       : vals
+00055780: 2e61 7070 656e 6428 2076 4672 6f6d 4c69  .append( vFromLi
+00055790: 7374 2878 2c76 4c69 7374 2920 290d 0a20  st(x,vList) ).. 
+000557a0: 2020 2072 6574 7572 6e20 7661 6c73 0d0a     return vals..
+000557b0: 0d0a 6465 6620 6465 6e73 6974 795f 6675  ..def density_fu
+000557c0: 6e63 7469 6f6e 2876 616c 732c 2062 696e  nction(vals, bin
+000557d0: 733d 2831 302c 3130 292c 2073 6361 6c65  s=(10,10), scale
+000557e0: 3d54 7275 652c 2078 626e 643d 5472 7565  =True, xbnd=True
+000557f0: 2c20 7962 6e64 3d54 7275 652c 206b 696e  , ybnd=True, kin
+00055800: 643d 276c 696e 6561 7227 2920 3a0d 0a20  d='linear') :.. 
+00055810: 2020 2022 2222 0d0a 2020 2020 3244 2068     """..    2D h
+00055820: 6973 746f 6772 616d 2064 656e 7369 7479  istogram density
+00055830: 2c20 4461 7461 5f64 656e 7369 7479 203d  , Data_density =
+00055840: 2066 2878 2c79 2920 6672 6f6d 2061 2078   f(x,y) from a x
+00055850: 2c79 2064 6174 6173 6574 2e0d 0a20 2020  ,y dataset...   
+00055860: 200d 0a20 2020 2050 6172 616d 6574 6572   ..    Parameter
+00055870: 730d 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  s..    ---------
+00055880: 2d0d 0a20 2020 2076 616c 7320 3a20 3220  -..    vals : 2 
+00055890: 5820 4e20 6172 7261 7920 6f66 2078 2c79  X N array of x,y
+000558a0: 2064 6174 6120 7661 6c75 6573 2e0d 0a0d   data values....
+000558b0: 0a20 2020 2062 696e 7320 3a20 5b69 6e74  .    bins : [int
+000558c0: 2c69 6e74 5d2c 2074 6865 206e 756d 6265  ,int], the numbe
+000558d0: 7220 6f66 2062 696e 7320 666f 7220 6561  r of bins for ea
+000558e0: 6368 2064 696d 656e 7369 6f6e 2e0d 0a0d  ch dimension....
+000558f0: 0a20 2020 2073 6361 6c65 203a 2062 6f6f  .    scale : boo
+00055900: 6c20 6f72 206e 756d 6265 722c 2064 6566  l or number, def
+00055910: 6175 6c74 3a20 5472 7565 0d0a 2020 2020  ault: True..    
+00055920: 2020 2020 4966 2054 7275 652c 206e 6f72      If True, nor
+00055930: 6d61 6c69 7a65 2076 616c 7565 7320 746f  malize values to
+00055940: 2074 6865 2061 7665 7261 6765 2e0d 0a20   the average... 
+00055950: 2020 2020 2020 2049 6620 4661 6c73 652c         If False,
+00055960: 2073 6361 6c65 2069 7320 312c 2074 6865   scale is 1, the
+00055970: 2064 656e 7369 7479 2076 616c 7565 206f   density value o
+00055980: 6620 6461 7461 2070 6572 0d0a 2020 2020  f data per..    
+00055990: 2020 2020 6269 6e20 6172 6561 2e20 2057      bin area.  W
+000559a0: 6865 6e20 6e75 6d65 7269 6361 6c2c 206d  hen numerical, m
+000559b0: 756c 7469 706c 6965 7220 666f 720d 0a20  ultiplier for.. 
+000559c0: 2020 2020 2020 2074 6865 2064 656e 7369         the densi
+000559d0: 7479 2076 616c 7565 2e0d 0a0d 0a20 2020  ty value.....   
+000559e0: 2078 626e 6420 3a20 626f 6f6c 2c20 6465   xbnd : bool, de
+000559f0: 6661 756c 7420 3a20 5472 7565 0d0a 2020  fault : True..  
+00055a00: 2020 2020 2020 4966 2054 7275 652c 2078        If True, x
+00055a10: 2076 616c 7565 7320 6172 6520 6578 7465   values are exte
+00055a20: 6e64 6564 2066 6f72 2064 656e 7369 7479  nded for density
+00055a30: 206f 6620 7a65 726f 2e0d 0a20 2020 2020   of zero...     
+00055a40: 2020 2046 6f72 2063 7963 6c69 6320 6d61     For cyclic ma
+00055a50: 7070 696e 672c 2074 6869 7320 7368 6f75  pping, this shou
+00055a60: 6c64 2062 6520 7365 7420 746f 2046 616c  ld be set to Fal
+00055a70: 7365 2e0d 0a0d 0a20 2020 2079 626e 6420  se.....    ybnd 
+00055a80: 3a20 626f 6f6c 2c20 6465 6661 756c 7420  : bool, default 
+00055a90: 3a20 5472 7565 0d0a 2020 2020 2020 2020  : True..        
+00055aa0: 4966 2054 7275 652c 2079 2076 616c 7565  If True, y value
+00055ab0: 7320 6172 6520 6578 7465 6e64 6564 2066  s are extended f
+00055ac0: 6f72 2064 656e 7369 7479 206f 6620 7a65  or density of ze
+00055ad0: 726f 2e0d 0a20 2020 2020 2020 2046 6f72  ro...        For
+00055ae0: 2063 7963 6c69 6320 6d61 7070 696e 672c   cyclic mapping,
+00055af0: 2074 6869 7320 7368 6f75 6c64 2062 6520   this should be 
+00055b00: 7365 7420 746f 2046 616c 7365 2e0d 0a0d  set to False....
+00055b10: 0a20 2020 206b 696e 6420 3a20 7be2 8098  .    kind : {...
+00055b20: 6c69 6e65 6172 e280 992c 20e2 8098 6375  linear..., ...cu
+00055b30: 6269 63e2 8099 2c20 e280 9871 7569 6e74  bic..., ...quint
+00055b40: 6963 e280 997d 2c20 6465 6661 756c 743a  ic...}, default:
+00055b50: 2027 6c69 6e65 6172 270d 0a20 2020 2020   'linear'..     
+00055b60: 2020 2054 6865 206b 696e 6420 6f66 2073     The kind of s
+00055b70: 706c 696e 6520 696e 7465 7270 6f6c 6174  pline interpolat
+00055b80: 696f 6e20 746f 2075 7365 2e0d 0a20 2020  ion to use...   
+00055b90: 0d0a 2020 2020 5265 7475 726e 730d 0a20  ..    Returns.. 
+00055ba0: 2020 202d 2d2d 2d2d 2d2d 0d0a 2020 2020     -------..    
+00055bb0: 4120 6675 6e63 7469 6f6e 2066 2878 2c79  A function f(x,y
+00055bc0: 290d 0a0d 0a20 2020 2022 2222 0d0a 2020  )....    """..  
+00055bd0: 2020 7661 6c73 203d 206e 702e 6172 7261    vals = np.arra
+00055be0: 7928 7661 6c73 290d 0a20 2020 2062 696e  y(vals)..    bin
+00055bf0: 7320 3d20 6e70 2e61 7272 6179 2862 696e  s = np.array(bin
+00055c00: 7329 0d0a 2020 2020 5a76 616c 732c 7865  s)..    Zvals,xe
+00055c10: 6467 6573 2c79 6564 6765 7320 3d20 6e70  dges,yedges = np
+00055c20: 2e68 6973 746f 6772 616d 3264 282a 7661  .histogram2d(*va
+00055c30: 6c73 2c62 696e 733d 6269 6e73 290d 0a20  ls,bins=bins).. 
+00055c40: 2020 2058 2c59 203d 2030 2c31 2020 0d0a     X,Y = 0,1  ..
+00055c50: 2020 2020 6d69 6e76 616c 203d 206e 702e      minval = np.
+00055c60: 616d 696e 2876 616c 732c 6178 6973 3d31  amin(vals,axis=1
+00055c70: 290d 0a20 2020 206d 6178 7661 6c20 3d20  )..    maxval = 
+00055c80: 6e70 2e61 6d61 7828 7661 6c73 2c61 7869  np.amax(vals,axi
+00055c90: 733d 3129 0d0a 2020 2020 6461 7461 726e  s=1)..    datarn
+00055ca0: 6720 3d20 286d 6178 7661 6c2d 6d69 6e76  g = (maxval-minv
+00055cb0: 616c 290d 0a20 2020 2061 7265 6120 3d20  al)..    area = 
+00055cc0: 6461 7461 726e 675b 305d 2a64 6174 6172  datarng[0]*datar
+00055cd0: 6e67 5b31 5d0d 0a20 2020 2064 656c 7461  ng[1]..    delta
+00055ce0: 203d 2064 6174 6172 6e67 2f62 696e 730d   = datarng/bins.
+00055cf0: 0a20 2020 2065 6e64 7661 6c20 3d20 6d61  .    endval = ma
+00055d00: 7876 616c 202b 2064 656c 7461 2f32 0d0a  xval + delta/2..
+00055d10: 2020 2020 6966 2078 626e 6420 3a0d 0a20      if xbnd :.. 
+00055d20: 2020 2020 2020 207a 6572 6f73 203d 206e         zeros = n
+00055d30: 702e 7a65 726f 7328 2028 5a76 616c 732e  p.zeros( (Zvals.
+00055d40: 7368 6170 655b 585d 2b32 2c5a 7661 6c73  shape[X]+2,Zvals
+00055d50: 2e73 6861 7065 5b59 5d29 2029 0d0a 2020  .shape[Y]) )..  
+00055d60: 2020 2020 2020 7a65 726f 735b 313a 6269        zeros[1:bi
+00055d70: 6e73 5b58 5d2b 312c 3a5d 203d 205a 7661  ns[X]+1,:] = Zva
+00055d80: 6c73 0d0a 2020 2020 2020 2020 5a76 616c  ls..        Zval
+00055d90: 7320 3d20 7a65 726f 730d 0a20 2020 2020  s = zeros..     
+00055da0: 2020 2078 6564 6765 7320 3d20 6e70 2e61     xedges = np.a
+00055db0: 7272 6179 285b 2a28 7865 6467 6573 2d64  rray([*(xedges-d
+00055dc0: 656c 7461 5b58 5d2f 3229 2c65 6e64 7661  elta[X]/2),endva
+00055dd0: 6c5b 585d 5d29 0d0a 2020 2020 656c 7365  l[X]])..    else
+00055de0: 203a 0d0a 2020 2020 2020 2020 7865 6467   :..        xedg
+00055df0: 6573 203d 2078 6564 6765 732b 6465 6c74  es = xedges+delt
+00055e00: 615b 585d 2f32 0d0a 2020 2020 2020 2020  a[X]/2..        
+00055e10: 7865 6467 6573 203d 2078 6564 6765 735b  xedges = xedges[
+00055e20: 3a6c 656e 2878 6564 6765 7329 2d31 5d0d  :len(xedges)-1].
+00055e30: 0a20 2020 2069 6620 7962 6e64 203a 0d0a  .    if ybnd :..
+00055e40: 2020 2020 2020 2020 7a65 726f 7320 3d20          zeros = 
+00055e50: 6e70 2e7a 6572 6f73 2820 285a 7661 6c73  np.zeros( (Zvals
+00055e60: 2e73 6861 7065 5b58 5d2c 5a76 616c 732e  .shape[X],Zvals.
+00055e70: 7368 6170 655b 595d 2b32 2920 290d 0a20  shape[Y]+2) ).. 
+00055e80: 2020 2020 2020 207a 6572 6f73 5b3a 2c31         zeros[:,1
+00055e90: 3a62 696e 735b 595d 2b31 5d20 3d20 5a76  :bins[Y]+1] = Zv
+00055ea0: 616c 730d 0a20 2020 2020 2020 205a 7661  als..        Zva
+00055eb0: 6c73 203d 207a 6572 6f73 0d0a 2020 2020  ls = zeros..    
+00055ec0: 2020 2020 7965 6467 6573 203d 206e 702e      yedges = np.
+00055ed0: 6172 7261 7928 5b2a 2879 6564 6765 732d  array([*(yedges-
+00055ee0: 6465 6c74 615b 595d 2f32 292c 656e 6476  delta[Y]/2),endv
+00055ef0: 616c 5b59 5d5d 290d 0a20 2020 2065 6c73  al[Y]])..    els
+00055f00: 6520 3a0d 0a20 2020 2020 2020 2079 6564  e :..        yed
+00055f10: 6765 7320 3d20 7965 6467 6573 2b64 656c  ges = yedges+del
+00055f20: 7461 5b59 5d2f 320d 0a20 2020 2020 2020  ta[Y]/2..       
+00055f30: 2079 6564 6765 7320 3d20 7965 6467 6573   yedges = yedges
+00055f40: 5b3a 6c65 6e28 7965 6467 6573 292d 315d  [:len(yedges)-1]
+00055f50: 0d0a 2020 2020 0d0a 2020 2020 6966 2069  ..    ..    if i
+00055f60: 7369 6e73 7461 6e63 6528 7363 616c 652c  sinstance(scale,
+00055f70: 626f 6f6c 2920 3a20 0d0a 2020 2020 2020  bool) : ..      
+00055f80: 2020 7363 616c 6520 3d20 6172 6561 2a28    scale = area*(
+00055f90: 6269 6e73 5b30 5d2a 6269 6e73 5b31 5d29  bins[0]*bins[1])
+00055fa0: 2f6c 656e 2876 616c 735b 305d 2920 6966  /len(vals[0]) if
+00055fb0: 2073 6361 6c65 2065 6c73 6520 312e 300d   scale else 1.0.
+00055fc0: 0a0d 0a20 2020 205a 7661 6c73 203d 2073  ...    Zvals = s
+00055fd0: 6361 6c65 2a5a 7661 6c73 2f61 7265 610d  cale*Zvals/area.
+00055fe0: 0a20 2020 2066 203d 2069 6e74 6572 706f  .    f = interpo
+00055ff0: 6c61 7465 2e69 6e74 6572 7032 6428 7965  late.interp2d(ye
+00056000: 6467 6573 2c78 6564 6765 732c 5a76 616c  dges,xedges,Zval
+00056010: 732c 6b69 6e64 3d6b 696e 6429 0d0a 0d0a  s,kind=kind)....
+00056020: 2020 2020 6465 6620 6465 6e73 6974 7928      def density(
+00056030: 7861 2c79 6129 3a0d 0a20 2020 2020 2020  xa,ya):..       
+00056040: 2073 697a 6520 3d20 6d69 6e28 206c 656e   size = min( len
+00056050: 2878 6129 2c6c 656e 2879 6129 2029 0d0a  (xa),len(ya) )..
+00056060: 2020 2020 2020 2020 7661 6c73 203d 205b          vals = [
+00056070: 2066 2879 615b 695d 2c78 615b 695d 295b   f(ya[i],xa[i])[
+00056080: 305d 2066 6f72 2069 2069 6e20 7261 6e67  0] for i in rang
+00056090: 6528 7369 7a65 2920 5d0d 0a20 2020 2020  e(size) ]..     
+000560a0: 2020 2072 6574 7572 6e20 6e70 2e61 7272     return np.arr
+000560b0: 6179 2876 616c 7329 0d0a 0d0a 2020 2020  ay(vals)....    
+000560c0: 7265 7475 726e 2064 656e 7369 7479 0d0a  return density..
+000560d0: 0d0a 0d0a 0d0a 0d0a 2320 3d3d 3d3d 3d3d  ........# ======
+000560e0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000560f0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00056100: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00056110: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00056120: 3d3d 3d3d 3d3d 3d3d 3d3d 3d2b 0d0a 2320  ===========+..# 
+00056130: 4f6e 6c79 2076 6572 7469 6365 7320 616e  Only vertices an
+00056140: 6420 6661 6365 2069 6e64 6963 6573 2061  d face indices a
+00056150: 7265 2065 7870 6f72 7465 642f 696d 706f  re exported/impo
+00056160: 7274 6564 2e20 2020 2020 2020 2020 2020  rted.           
+00056170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00056180: 207c 2020 0d0a 2320 4675 7444 6576 2c20   |  ..# FutDev, 
+00056190: 696e 636c 7564 6520 3a20 2020 2020 2020  include :       
+000561a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000561b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000561c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000561d0: 2020 2020 2020 2020 207c 0d0a 2320 2020           |..#   
+000561e0: 312e 206d 6574 6164 6174 6120 2020 2020  1. metadata     
+000561f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00056200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00056210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00056220: 2020 2020 2020 2020 2020 2020 2020 207c                 |
+00056230: 0d0a 2320 2020 322e 2066 6163 652f 7665  ..#   2. face/ve
+00056240: 7274 6578 2063 6f6c 6f72 2020 2020 2020  rtex color      
+00056250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00056260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00056270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00056280: 2020 2020 207c 0d0a 2320 2020 332e 2076       |..#   3. v
+00056290: 6572 7465 7820 6e6f 726d 616c 7320 666f  ertex normals fo
+000562a0: 7220 6578 7465 726e 616c 2075 7365 2066  r external use f
+000562b0: 6f72 2047 6f75 7261 7564 2073 6861 6469  or Gouraud shadi
+000562c0: 6e67 2c20 6574 632e 2020 2020 2020 2020  ng, etc.        
+000562d0: 2020 2020 2020 2020 2020 207c 0d0a 2320             |..# 
+000562e0: 2020 342e 206c 696e 6520 6f62 6a65 6374    4. line object
+000562f0: 7320 2020 2020 2020 2020 2020 2020 2020  s               
+00056300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00056310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00056320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00056330: 207c 0d0a 2320 2020 352e 2063 6f64 6520   |..#   5. code 
+00056340: 696e 2073 6570 6172 6174 6520 6578 696d  in separate exim
+00056350: 706f 7274 206d 6f64 756c 6520 2020 2020  port module     
+00056360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00056370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00056380: 2020 2020 2020 207c 0d0a 2320 2020 362e         |..#   6.
+00056390: 2066 696c 6520 7479 7065 7320 2861 7363   file types (asc
+000563a0: 6969 2c62 696e 6172 7929 203a 2073 746c  ii,binary) : stl
+000563b0: 2c20 706c 792c 2058 3344 2c20 6574 632e  , ply, X3D, etc.
+000563c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000563d0: 2020 2020 2020 2020 2020 2020 207c 0d0a               |..
+000563e0: 2320 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  # ==============
+000563f0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00056400: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00056410: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00056420: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00056430: 3d3d 3d2b 0d0a 0d0a 6465 6620 6765 745f  ===+....def get_
+00056440: 7375 7266 6765 6f6d 5f66 726f 6d5f 6f62  surfgeom_from_ob
+00056450: 6a28 6669 6c65 2c20 2a2a 6b61 7267 7329  j(file, **kargs)
+00056460: 203a 0d0a 2020 2020 2222 2220 4372 6561   :..    """ Crea
+00056470: 7465 2073 7572 6661 6365 2066 726f 6d20  te surface from 
+00056480: 6f62 6a20 666f 726d 6174 7465 6420 2766  obj formatted 'f
+00056490: 696c 6527 2e0d 0a20 2020 2020 2020 206b  ile'...        k
+000564a0: 6172 6773 2070 6173 7365 6420 746f 2069  args passed to i
+000564b0: 6e73 7461 6e74 6961 7465 2073 7572 6661  nstantiate surfa
+000564c0: 6365 2069 6e20 636f 6e73 7472 7563 746f  ce in constructo
+000564d0: 722e 200d 0a20 2020 2020 2020 2027 5072  r. ..        'Pr
+000564e0: 6f6f 6620 6f66 2063 6f6e 6365 7074 2720  oof of concept' 
+000564f0: 666f 7220 6675 7475 7265 2076 6572 7369  for future versi
+00056500: 6f6e 732e 0d0a 2020 2020 2222 220d 0a20  ons...    """.. 
+00056510: 2020 2023 202e 2e2e 2e2e 2e2e 2e2e 2e2e     # ...........
+00056520: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00056530: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00056540: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00056550: 2e2e 2e2e 2e2e 2e2e 2e2e 0d0a 2020 2020  ............    
+00056560: 6465 6620 6669 6c65 5f72 6563 6f72 6473  def file_records
+00056570: 2869 6e5f 6669 6c65 293a 0d0a 2020 2020  (in_file):..    
+00056580: 2020 2020 7472 7920 3a0d 0a20 2020 2020      try :..     
+00056590: 2020 2020 2020 2066 203d 206f 7065 6e28         f = open(
+000565a0: 696e 5f66 696c 6529 0d0a 2020 2020 2020  in_file)..      
+000565b0: 2020 2020 2020 6275 6620 3d20 662e 7265        buf = f.re
+000565c0: 6164 2829 0d0a 2020 2020 2020 2020 2020  ad()..          
+000565d0: 2020 662e 636c 6f73 6528 290d 0a20 2020    f.close()..   
+000565e0: 2020 2020 2065 7863 6570 7420 3a0d 0a20       except :.. 
+000565f0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00056600: 2056 616c 7565 4572 726f 7228 2745 5252   ValueError('ERR
+00056610: 4f52 3a20 4f42 4a20 6669 6c65 206e 6f74  OR: OBJ file not
+00056620: 2061 6363 6573 7365 6420 2121 2127 290d   accessed !!!').
+00056630: 0a20 2020 2020 2020 2066 6f72 2062 2069  .        for b i
+00056640: 6e20 6275 662e 7370 6c69 7428 275c 6e27  n buf.split('\n'
+00056650: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+00056660: 6220 3d20 2720 272e 6a6f 696e 2862 2e73  b = ' '.join(b.s
+00056670: 706c 6974 2829 2920 2320 7265 6d6f 7665  plit()) # remove
+00056680: 2065 7874 7261 2073 7061 6365 732e 0d0a   extra spaces...
+00056690: 2020 2020 2020 2020 2020 2020 6966 2062              if b
+000566a0: 2e73 7461 7274 7377 6974 6828 2776 2027  .startswith('v '
+000566b0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+000566c0: 2020 2020 7969 656c 6420 5b27 7627 2c20      yield ['v', 
+000566d0: 5b66 6c6f 6174 2878 2920 666f 7220 7820  [float(x) for x 
+000566e0: 696e 2062 2e73 706c 6974 2822 2022 295b  in b.split(" ")[
+000566f0: 313a 5d5d 5d0d 0a20 2020 2020 2020 2020  1:]]]..         
+00056700: 2020 2065 6c69 6620 622e 7374 6172 7473     elif b.starts
+00056710: 7769 7468 2827 6620 2729 3a0d 0a20 2020  with('f '):..   
+00056720: 2020 2020 2020 2020 2020 2020 2064 6174               dat
+00056730: 616c 6973 7420 3d20 5b78 2066 6f72 2078  alist = [x for x
+00056740: 2069 6e20 622e 7370 6c69 7428 2220 2229   in b.split(" ")
+00056750: 5b31 3a5d 205d 0d0a 2020 2020 2020 2020  [1:] ]..        
+00056760: 2020 2020 2020 2020 2320 6f6e 6c79 2067          # only g
+00056770: 6574 2066 6163 6520 696e 6469 6365 7320  et face indices 
+00056780: 6174 2074 6865 2066 6972 7374 2069 6e64  at the first ind
+00056790: 6578 2e2e 2e0d 0a20 2020 2020 2020 2020  ex.....         
+000567a0: 2020 2020 2020 2079 6965 6c64 205b 2027         yield [ '
+000567b0: 6627 2c20 5b20 2069 6e74 2879 2e73 706c  f', [  int(y.spl
+000567c0: 6974 2822 2f22 295b 305d 292d 3120 2020  it("/")[0])-1   
+000567d0: 666f 7220 7920 696e 2064 6174 616c 6973  for y in datalis
+000567e0: 745d 2020 205d 0d0a 2020 2020 2020 2020  t]   ]..        
+000567f0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+00056800: 2020 2020 2020 2020 2020 2079 6965 6c64             yield
+00056810: 205b 2727 2c20 2222 5d20 2020 0d0a 2020   ['', ""]   ..  
+00056820: 2020 6465 6620 6765 745f 765f 6628 696e    def get_v_f(in
+00056830: 5f66 696c 6529 3a0d 0a20 2020 2020 2020  _file):..       
+00056840: 2076 6572 7469 6365 732c 6661 6365 7320   vertices,faces 
+00056850: 3d20 5b5d 2c5b 5d0d 0a20 2020 2020 2020  = [],[]..       
+00056860: 2066 6f72 206b 2c20 7620 696e 2066 696c   for k, v in fil
+00056870: 655f 7265 636f 7264 7328 696e 5f66 696c  e_records(in_fil
+00056880: 6529 3a0d 0a20 2020 2020 2020 2020 2020  e):..           
+00056890: 2069 6620 2020 6b20 3d3d 2027 7627 3a20   if   k == 'v': 
+000568a0: 7665 7274 6963 6573 2e61 7070 656e 6428  vertices.append(
+000568b0: 7629 0d0a 2020 2020 2020 2020 2020 2020  v)..            
+000568c0: 656c 6966 206b 203d 3d20 2766 273a 2066  elif k == 'f': f
+000568d0: 6163 6573 2e61 7070 656e 6428 7629 0d0a  aces.append(v)..
+000568e0: 2020 2020 2020 2020 6966 206e 6f74 206c          if not l
+000568f0: 656e 2866 6163 6573 2920 6f72 206e 6f74  en(faces) or not
+00056900: 206c 656e 2876 6572 7469 6365 7329 3a20   len(vertices): 
+00056910: 2072 6574 7572 6e20 4e6f 6e65 2c20 4e6f   return None, No
+00056920: 6e65 0d0a 2020 2020 2020 2020 7265 7475  ne..        retu
+00056930: 726e 2076 6572 7469 6365 732c 2066 6163  rn vertices, fac
+00056940: 6573 0d0a 2020 2020 2320 2e2e 2e2e 2e2e  es..    # ......
+00056950: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00056960: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00056970: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+00056980: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e0d  ................
+00056990: 0a20 2020 2076 2c66 203d 2067 6574 5f76  .    v,f = get_v
+000569a0: 5f66 2866 696c 6529 0d0a 2020 2020 7620  _f(file)..    v 
+000569b0: 3d20 6e70 2e61 7272 6179 2876 290d 0a20  = np.array(v).. 
+000569c0: 2020 2076 203d 2076 5b3a 2c5b 302c 322c     v = v[:,[0,2,
+000569d0: 315d 5d0d 0a20 2020 2076 203d 206e 702e  1]]..    v = np.
+000569e0: 6d75 6c74 6970 6c79 2876 2c5b 312c 2d31  multiply(v,[1,-1
+000569f0: 2c31 5d29 0d0a 2020 2020 6966 2076 2069  ,1])..    if v i
+00056a00: 7320 6e6f 7420 4e6f 6e65 3a20 2073 7572  s not None:  sur
+00056a10: 6661 6365 203d 2053 7572 6661 6365 3344  face = Surface3D
+00056a20: 436f 6c6c 6563 7469 6f6e 2876 2c66 2c2a  Collection(v,f,*
+00056a30: 2a6b 6172 6773 290d 0a20 2020 2065 6c73  *kargs)..    els
+00056a40: 653a 2020 2020 2020 2020 2020 2020 2020  e:              
+00056a50: 7375 7266 6163 6520 3d20 5370 6865 7269  surface = Spheri
+00056a60: 6361 6c53 7572 6661 6365 2830 2c27 7465  calSurface(0,'te
+00056a70: 7472 6127 2c63 6f6c 6f72 3d27 7227 290d  tra',color='r').
+00056a80: 0a20 2020 2072 6574 7572 6e20 7375 7266  .    return surf
+00056a90: 6163 650d 0a0d 0a64 6566 2073 6176 655f  ace....def save_
+00056aa0: 7375 7266 6765 6f6d 5f74 6f5f 6f62 6a28  surfgeom_to_obj(
+00056ab0: 6669 6c65 2c73 7572 6661 6365 2920 3a0d  file,surface) :.
+00056ac0: 0a20 2020 2022 2222 2045 7870 6f72 7420  .    """ Export 
+00056ad0: 2773 7572 6661 6365 2720 6765 6f6d 6574  'surface' geomet
+00056ae0: 7279 2074 6f20 6f62 6a20 666f 726d 6174  ry to obj format
+00056af0: 7465 6420 6669 6c65 2e20 0d0a 2020 2020  ted file. ..    
+00056b00: 2020 2020 2750 726f 6f66 206f 6620 636f      'Proof of co
+00056b10: 6e63 6570 7427 2066 6f72 2066 7574 7572  ncept' for futur
+00056b20: 6520 7665 7273 696f 6e73 2e0d 0a20 2020  e versions...   
+00056b30: 2022 2222 0d0a 2020 2020 7620 3d20 7375   """..    v = su
+00056b40: 7266 6163 652e 7665 7274 6578 436f 6f72  rface.vertexCoor
+00056b50: 0d0a 2020 2020 7620 3d20 765b 3a2c 5b30  ..    v = v[:,[0
+00056b60: 2c32 2c31 5d5d 0d0a 2020 2020 7620 3d20  ,2,1]]..    v = 
+00056b70: 6e70 2e6d 756c 7469 706c 7928 762c 5b31  np.multiply(v,[1
+00056b80: 2c31 2c2d 315d 290d 0a20 2020 2066 203d  ,1,-1])..    f =
+00056b90: 2073 7572 6661 6365 2e66 7649 6e64 6963   surface.fvIndic
+00056ba0: 6573 2b31 2020 2320 6f62 6a20 6669 6c65  es+1  # obj file
+00056bb0: 2069 6e64 6963 6573 2073 7461 7274 2061   indices start a
+00056bc0: 7420 310d 0a20 2020 2076 7320 3d20 5b20  t 1..    vs = [ 
+00056bd0: 2776 2027 2b6e 702e 6172 7261 7932 7374  'v '+np.array2st
+00056be0: 7269 6e67 2878 2c70 7265 6669 783d 2727  ring(x,prefix=''
+00056bf0: 2c73 7566 6669 783d 2727 295b 313a 2d31  ,suffix='')[1:-1
+00056c00: 5d20 666f 7220 7820 696e 2076 205d 0d0a  ] for x in v ]..
+00056c10: 2020 2020 6673 203d 205b 2027 6620 272b      fs = [ 'f '+
+00056c20: 6e70 2e61 7272 6179 3273 7472 696e 6728  np.array2string(
+00056c30: 782c 7072 6566 6978 3d27 272c 7375 6666  x,prefix='',suff
+00056c40: 6978 3d27 2729 5b31 3a2d 315d 2066 6f72  ix='')[1:-1] for
+00056c50: 2078 2069 6e20 6620 5d0d 0a20 2020 2067   x in f ]..    g
+00056c60: 656f 6d4c 696e 6573 203d 2076 7320 2b20  eomLines = vs + 
+00056c70: 6673 0d0a 2020 2020 7769 7468 206f 7065  fs..    with ope
+00056c80: 6e28 6669 6c65 2c22 7722 2029 2061 7320  n(file,"w" ) as 
+00056c90: 6669 6c65 6f75 7420 3a0d 0a20 2020 2020  fileout :..     
+00056ca0: 2020 2066 6f72 206c 696e 6520 696e 2067     for line in g
+00056cb0: 656f 6d4c 696e 6573 203a 0d0a 2020 2020  eomLines :..    
+00056cc0: 2020 2020 2020 2020 6669 6c65 6f75 742e          fileout.
+00056cd0: 7772 6974 6528 6c69 6e65 2b27 5c6e 2729  write(line+'\n')
+00056ce0: 0d0a 2020 2020 2020 2020 6669 6c65 6f75  ..        fileou
+00056cf0: 742e 636c 6f73 6528 290d 0a20 2020 2072  t.close()..    r
+00056d00: 6574 7572 6e0d 0a                        eturn..
```

### Comparing `s3dlib-1.1.0/LICENSE` & `s3dlib-1.2.0/LICENSE`

 * *Files 13% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 MIT License
 
-Copyright (c) 2020-2023 Frank Zaverl, Jr.
+Copyright (c) 2020-2024 Frank Zaverl, Jr.
 
 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:
```

### Comparing `s3dlib-1.1.0/README.md` & `s3dlib-1.2.0/README.md`

 * *Files identical despite different names*

### Comparing `s3dlib-1.1.0/pyproject.toml` & `s3dlib-1.2.0/pyproject.toml`

 * *Files 25% similar despite different names*

```diff
@@ -1,20 +1,35 @@
 [build-system]
 requires = ["hatchling"]
 build-backend = "hatchling.build"
 
 [project]
 name = "s3dlib"
-version = "1.1.0"
+version = "1.2.0"
 authors = [
   { name="Frank Zaverl, Jr.", email="fzaverl@s3dlib.org" },
 ]
 description = "Python classes to create 3D surface and line objects rendered in Matplotlib"
 readme = "README.md"
-requires-python = ">=3.7"
+requires-python = ">=3.11"
+dependencies = [
+  "numpy>=1.26",
+  "matplotlib>=3.8",
+  "scipy==1.11.4",
+  "scikit-image==0.20.0",
+  "colorspacious==1.1.2",
+]
+keywords = [
+    "matplotlib",
+    "3D plot",
+    "3D surface",
+    "contour lines",
+    "3D lines",
+    "colormap"
+]
 classifiers = [
     "Programming Language :: Python :: 3",
     "License :: OSI Approved :: MIT License",
     "Operating System :: OS Independent",
     "Framework :: Matplotlib",
     "Intended Audience :: Developers",
     "Intended Audience :: Education",
```

### Comparing `s3dlib-1.1.0/PKG-INFO` & `s3dlib-1.2.0/PKG-INFO`

 * *Files 15% similar despite different names*

```diff
@@ -1,29 +1,35 @@
-Metadata-Version: 2.1
+Metadata-Version: 2.3
 Name: s3dlib
-Version: 1.1.0
+Version: 1.2.0
 Summary: Python classes to create 3D surface and line objects rendered in Matplotlib
 Project-URL: Documentation, https://s3dlib.org
 Project-URL: Repository, https://github.com/fzaverl/s3dlib
 Author-email: "Frank Zaverl, Jr." <fzaverl@s3dlib.org>
 License-File: LICENSE
+Keywords: 3D lines,3D plot,3D surface,colormap,contour lines,matplotlib
 Classifier: Framework :: Matplotlib
 Classifier: Intended Audience :: Developers
 Classifier: Intended Audience :: Education
 Classifier: Intended Audience :: Information Technology
 Classifier: Intended Audience :: Science/Research
 Classifier: License :: OSI Approved :: MIT License
 Classifier: Operating System :: OS Independent
 Classifier: Programming Language :: Python :: 3
 Classifier: Topic :: Multimedia :: Graphics :: 3D Rendering
 Classifier: Topic :: Scientific/Engineering :: Information Analysis
 Classifier: Topic :: Scientific/Engineering :: Mathematics
 Classifier: Topic :: Scientific/Engineering :: Physics
 Classifier: Topic :: Scientific/Engineering :: Visualization
-Requires-Python: >=3.7
+Requires-Python: >=3.11
+Requires-Dist: colorspacious==1.1.2
+Requires-Dist: matplotlib>=3.8
+Requires-Dist: numpy>=1.26
+Requires-Dist: scikit-image==0.20.0
+Requires-Dist: scipy==1.11.4
 Description-Content-Type: text/markdown
 
 
 # S3Dlib
 
 ### Python classes to create 3D surface and line objects rendered in *Matplotlib*
```

